cscope 15 /home/dcslab/charlie/shore-kits               0003607717
	@debug-shore.cpp

1 
	#´iv©e
 
public


	)

2 
	#´Ùeùed
 
public


	)

4 
	~"w_defšes.h
"

5 
	~"w_ba£.h
"

6 
	~"w_rc.h
"

8 
	~"¡h»ad.h
"

10 
	~"Ïtch.h
"

11 
	~"basics.h
"

12 
	~"¡id_t.h
"

14 
	~"sm_ba£.h
"

15 
	~"sm_št_0.h
"

16 
	~"lid_t.h
"

17 
	~"sm_s.h
"

18 
	~"bf.h
"

19 
	~"bf_s.h
"

20 
	~"bf_cÜe.h
"

21 
	~"·ge_s.h
"

23 
	~"·ge.h
"

24 
	~"·ge_h.h
"

25 
	~"sm_št_1.h
"

26 
	~"lock.h
"

27 
	~"lock_s.h
"

29 
	~"pm­.h
"

30 
	~"sm_io.h
"

31 
	~"log.h
"

32 
	~"log»c.h
"

33 
	~"xù.h
"

34 
	~"xù_im¶.h
"

35 
	~"xù_d•’d’t.h
"

36 
	~"lock_x.h
"

37 
	~"lock_cÜe.h
"

38 
	~"kvl_t.h
"

39 
	~<s¡»am
>

40 
	~<m­
>

41 
	~<¡dio.h
>

48 şas 
	cbuck‘_t
 {

49 
	mpublic
:

51 #iâdeà
NOT_PREEMPTIVE


52 #iâdeà
ONE_MUTEX


53 
DEF_LOCK_X
;

54 
lock_x
 
	mmu‹x
;

57 
	mw_li¡_t
<
	mlock_h—d_t
> 
	mchaš
;

59 
NORET
 
	$buck‘_t
() :

60 #iâdeà
NOT_PREEMPTIVE


61 #iâdeà
ONE_MUTEX


65 
	`chaš
(
	$W_LIST_ARG
(
lock_h—d_t
, 
chaš
)) {

68 
´iv©e
:

70 
NORET
 
	`buck‘_t
(cÚ¡ 
buck‘_t
&);

71 
buck‘_t
& 
İ”©Ü
=(const bucket_t&);

72 
	}
};

74 şas 
	c·ge_m¬k_t
 {

75 
	mpublic
:

76 
št2_t
 
idx
;

77 
ušt2_t
 
	mËn
;

80 cÚ¡* 
	$·ge_g_to_¡r
(
·ge_g
) {

81 
·ge_g
) {

82 
·ge_p
::
t_exšk_p
:

84 
·ge_p
::
t_¡node_p
:

86 
·ge_p
::
t_keyed_p
:

88 
·ge_p
::
t_bŒ“_p
:

90 
·ge_p
::
t_¹»e_p
:

92 
·ge_p
::
t_fe_p
:

97 
	}
}

99 cÚ¡* 
	$´‘ty_´št
(
log»c_t
 cÚ¡* 
»c
, 
i
=0, cÚ¡* 
s
=0) {

100 
tmp_d©a
[1024];

101 
ty³_d©a
[1024];

103 
»c
->
	`ty³
()) {

104 
log»c_t
::
t_·ge_m¬k
:

105 
log»c_t
::
t_·ge_»şaim
:

107 
·ge_m¬k_t
* 
pm
 = (·ge_m¬k_t*è
»c
->
_d©a
;

108 
	`¢´štf
(
ty³_d©a
, (type_data),

111 
pm
->
idx
,…m->
Ën
);

115 
	`¢´štf
(
ty³_d©a
, (type_data), "");

119 cÚ¡* 
	t¡r
;

120 
¡r
 
undo
=(
»c
->
	`is_undo
()? "undo " : ""),

121 
»do
=(
»c
->
	`is_»do
()? "redo " : ""),

122 
ı¢
=(
»c
->
	`is_ı¢
()? "cpsn " : ""),

123 
logiÿl
=(
»c
->
	`is_logiÿl
()? "logical " : "");

124 
	`¢´štf
(
tmp_d©a
, (tmp_data),

136 
»c
->
	`Ëngth
(),

137 
»c
->
	`ty³_¡r
(), 
ty³_d©a
,

138 
logiÿl
, 
undo
, 
»do
, 
ı¢
,

139 
»c
->
	`tid
().
	`g‘_hi
(),„ec->tid().
	`g‘_lo
(),

140 
»c
->
	`cÚ¡ruù_pid
().
	`vŞ
().
vŞ
,„ec->cÚ¡ruù_pid().
	`¡Üe
(),„ec->cÚ¡ruù_pid().
·ge
,

141 
	`·ge_g_to_¡r
(
»c
->
	`g
()),

142 
»c
->
	`´ev
().
	`hi
(),„ec->´ev().
	`lo
(),

143 
»c
->
	`g‘_l¢_ck
().
	`hi
(),„ec->g‘_l¢_ck().
	`lo
()

145  
tmp_d©a
;

146 
	}
}

150 
	$sÿn_lock_poŞ
() {

151 
¡d
::
	tm­
<, > 
	tlm­
;

152 
lm­
 
Ëngths
;

153 
lock_cÜe_m
* 
cÜe
 = 
smËv–_0
::
lm
->
_cÜe
;

154 
i
=0; i < 
cÜe
->
_hbsz
; i++)

155 
Ëngths
[
cÜe
->
_hb
[
i
].
chaš
.
	`num_memb”s
()]++;

157 
	`´štf
("Bucket density histogram:\n");

158 
lm­
::
™”©Ü
 
™
=
Ëngths
.
	`begš
(); iˆ!ğËngths.
	`’d
(); ++it)

159 
	`´štf
("\t%d: %d\n", 
™
->
fœ¡
, it->
£cÚd
);

160 
	`´štf
("\n");

161 
	}
}

163 
debug_dump_wa™s_fÜ
(
w_desûnd_li¡_t
<
xù_t
, 
tid_t
>* 
xli¡
=&xù_t::
_xli¡
, 
boŞ
 
acquœe
=
çl£
) {

164 if(
acquœe
è
W_COERCE
(
xù_t
::
acquœe_xli¡_mu‹x
());

165 
	g¡d
::
m­
<
lock_h—d_t
*, > 
	glockm­
;

166 
	gw_li¡_i
<
	gxù_t
> 
i
(*
xli¡
);

167  
xù_t
* 
	gme
 = 
i
.
Ãxt
() ) {

168 ifĞ
lock_»que¡_t
* 
mše
 = 
me
->
lock_šfo
()->
wa™
 ) {

169 
lock_h—d_t
* 
lock
 = 
mše
->
g‘_lock_h—d
();

170 
o¡ršg¡»am
 
	gos
;

171 
	gos
 << 
	glock
->
	gÇme
 << 
	g’ds
 << 
	g¡d
::
æush
;

172 
	g¡d
::
¡ršg
 
¡r
 = 
os
.str();

173 cÚ¡* 
	gÊame
 = 
¡r
.
c_¡r
();

174 
´štf
("\"0x%p\" -> \"%s\"\n", 
mše
->
th»ad
, 
Êame
);

176 if(++
	glockm­
[
lock
] == 1) {

181 
w_li¡_i
<
lock_»que¡_t
> 
i2
(
lock
->
queue
);

182 
lock_»que¡_t
* 
	gtheœs
 = 
i2
.
Ãxt
()) {

183 if(
mše
->
¡©us
(è=ğ
lock_m
::
t_cÚv”tšg
 && 
theœs
->¡©us(è=ğlock_m::
t_wa™šg
)

185 if(
	gmše
->
¡©us
(è=ğ
lock_m
::
t_wa™šg
 && 
theœs
 =ğ
mše
)

188 
¡h»ad_t
* 
	gth»ad
 = 
theœs
->
th»ad
;

189 
´štf
("\"%s\" -> \"0x%p\" [ color=%s style=%s]\n",

190 
Êame
, 
th»ad
?hread : 0,

191 
theœs
->
mode
 =ğ
EX
? "red" : "blue",

192 
theœs
->
¡©us
(è=ğ
lock_m
::
t_wa™šg
? "dotted" : "solid");

198 if(
	gacquœe
è
	gxù_t
::
»Ëa£_xli¡_mu‹x
();

202 
bfcb_t
* 
	$v”ify_·ge_l¢
() {

203 
i
=0; i < 
bf_m
::
_cÜe
->
_num_bufs
; i++) {

204 
bfcb_t
 &
b
 = 
bf_m
::
_cÜe
->
_buáab
[
i
];

205 if(
b
.
pid
.
·ge
 && b.
dœty
) {

206 if(
b
.
»c_l¢
 > b.
äame
->
l¢1
)

207  &
b
;

211 
	}
}

212 cÚ¡* 
db_´‘ty_´št
(
log»c_t
 cÚ¡* 
»c
, 
i
=0, cÚ¡* 
s
=0);

214 
	gvnum_to_m©ch
 = 1;

215 
	g¢um_to_m©ch
;

216 
	g²um_to_m©ch
;

217 
	$m©ch_·ge
(
log»c_t
* 
½
) {

218 
Íid_t
 
log_pid
 = 
½
->
	`cÚ¡ruù_pid
();

219 
Íid_t
 
	`‹¡_pid
(
vnum_to_m©ch
, 
¢um_to_m©ch
, 
²um_to_m©ch
);

220 if(
log_pid
 =ğ
‹¡_pid
) {

221 
	`årštf
(
¡d”r
, "%s\n", 
	`´‘ty_´št
(
½
));

223 
	}
}

225 
	gtidhi_to_m©ch
 = 0;

226 
	gtidlo_to_m©ch
;

227 
	$m©ch_Œx
(
log»c_t
* 
½
) {

228 
tid_t
 
log_tid
 = 
½
->
	`tid
();

229 
tid_t
 
	`‹¡_tid
(
tidlo_to_m©ch
, 
tidhi_to_m©ch
);

230 if(
log_tid
 =ğ
‹¡_tid
) {

231 
	`årštf
(
¡d”r
, "%s\n", 
	`´‘ty_´št
(
½
));

233 
	}
}

234 
	$m©ch_®l
(
log»c_t
* 
½
) {

235 
	`årštf
(
¡d”r
, "%s\n", 
	`´‘ty_´št
(
½
));

236 
	}
}

237 
	$m©ch_n
(
log»c_t
* 
½
) {

238 
	}
}

240 
	g¡d
::
m­
<
Íid_t
, 
	gl¢_t
> 
	g·ge_d•s
;

241 
	g¡d
::
m­
<
tid_t
, 
	gl¢_t
> 
	gtid_d•s
;

243 
boŞ
 
	gÍid_t
::
İ”©Ü
<(
Íid_t
 cÚ¡ &
Ùh”
) const {

244  
·ge
 < 
Ùh”
.page;

247 
	slog_dump_fe
 {

248 
FILE
* 
	m_f
;

249 
log_dump_fe
(è: 
_f
(
fİ’
("logdump.dot", "w")) {

250 
årštf
(
_f
,

258 ~
log_dump_fe
(è{ 
fşo£
(
_f
); }

259 
İ”©Ü
 
	mFILE
*(è{  
	m_f
; }

260 } 
	g__log_dump_fe
;

262 
	$m©ch_®l_ªd_dump
(
log»c_t
* 
½
) {

263 
l¢_t
 
l¢
 = 
½
->
	`g‘_l¢_ck
();

264 
tid_t
 
tid
 = 
½
->
	`tid
();

265 
Íid_t
 
pid
 = 
½
->
	`cÚ¡ruù_pid
();

266 if(!
pid
.
	`v®id
(è|| 
tid
.
	`šv®id
())

269 
	`årštf
(
__log_dump_fe
,

271 
l¢
.
_d©a
,†¢.
	`hi
(),†¢.
	`lo
(), 
tid
.
	`g‘_hi
(),id.
	`g‘_lo
(),

272 
pid
.
	`vŞ
().
vŞ
,…id.
	`¡Üe
(),…id.
·ge
,

273 
l¢
.
_d©a
, 
½
->
	`´ev
()._data);

275 
l¢_t
 &
tid_´ev
 = 
tid_d•s
[
tid
];

276 if(
tid_´ev
.
	`v®id
()) {

277 
	`årštf
(
__log_dump_fe
,

279 
l¢
.
_d©a
, 
tid_´ev
._d©a, 
tid
.
	`g‘_hi
(),id.
	`g‘_lo
());

282 
l¢_t
 &
·ge_´ev
 = 
·ge_d•s
[
pid
];

283 if(
·ge_´ev
.
	`v®id
()) {

284 
	`årštf
(
__log_dump_fe
,

286 
l¢
.
_d©a
, 
·ge_´ev
._d©a, 
pid
.
	`vŞ
().
vŞ
,…id.
	`¡Üe
(),…id.
·ge
);

289 
tid_´ev
 = 
·ge_´ev
 = 
l¢
;

290 
	}
}

292 
	$m©ch_nÚ_Œª§ùiÚ®
(
log»c_t
* 
½
) {

293 
½
->
_ty³
) {

294 
log»c_t
::
t_sk
:

295 
log»c_t
::
t_chk±_begš
:

296 
log»c_t
::
t_chk±_bf_b
:

297 
log»c_t
::
t_chk±_xù_b
:

298 
log»c_t
::
t_chk±_dev_b
:

299 
log»c_t
::
t_chk±_’d
:

300 
log»c_t
::
t_mouÁ_vŞ
:

301 
log»c_t
::
t_dismouÁ_vŞ
:

302 
	`årštf
(
¡d”r
, "%s\n", 
	`´‘ty_´št
(
½
));

307 
	}
}

308 
	~<m­
>

310 
	s·ge_hi¡Üy
 {

311 
Íid_t
 
	mpid
;

312 
boŞ
 
	mfound_fÜm©
;

313 
	mÏ¡_¦Ù
;

314 
·ge_hi¡Üy
(
Íid_t
 cÚ¡ &
p
öpid_t(), 
boŞ
 
f
=
çl£
, 
l
=-1è: 
pid
Õ), 
found_fÜm©
(f), 
Ï¡_¦Ù
(l) { }

316 
	g¡d
::
	tm­
<, 
	t·ge_hi¡Üy
> 
	tphi¡_m­
;

318 
phi¡_m­
 
	g·ge_hi¡Ü›s
;

320 
	g¡d
::
	tm­
<, > 
	tsize_di¡_m­
;

321 
size_di¡_m­
 
	gsize_di¡
;

323 
	$´št_size_di¡
() {

325 
size_di¡_m­
::
™”©Ü
 
™
=
size_di¡
.
	`begš
();

326 
	`årštf
(
¡d”r
, "Log„ecÜd sizdi¡ributiÚ (%ldÙ®):\n", 
™
->
£cÚd
);

327 ++
™
 !ğ
size_di¡
.
	`’d
())

328 
	`årštf
(
¡d”r
, " %ld %ld\n", 
™
->
fœ¡
, it->
£cÚd
);

330 
size_di¡
.
	`ş—r
();

331 
	}
}

333 
	$m©ch_®l_m—su»_size_di¡
(
log»c_t
* 
½
) {

334 
size_di¡
[0]++;

335 
size_di¡
[
½
->
	`Ëngth
()]++;

336 
	}
}

338 
	$m©ch_¦Ù‹d_·ges
(
log»c_t
* 
½
, cÚ¡* 
Çme
=0) {

339 if(
½
->
	`g
(è!ğ
·ge_p
::
t_fe_p
)

342 if(!
Çme
)‚ame = "";

343 
Íid_t
 
pid
 = 
½
->
	`cÚ¡ruù_pid
();

344 
phi¡_m­
::
™”©Ü
 
™
 = 
·ge_hi¡Ü›s
.
	`fšd
(
pid
.
·ge
);

345 
½
->
	`ty³
()) {

346 
log»c_t
::
t_·ge_fÜm©
: {

347 if(
™
 !ğ
·ge_hi¡Ü›s
.
	`’d
()) {

348 
	`årštf
(
¡d”r
,

350 
Çme
, 
pid
.
	`vŞ
().
vŞ
,…id.
	`¡Üe
(),…id.
·ge
,

351 
™
->
£cÚd
.
pid
.
	`vŞ
().
vŞ
, it->£cÚd.pid.
	`¡Üe
(), it->£cÚd.pid.
·ge
, it->£cÚd.
Ï¡_¦Ù
);

353 
·ge_hi¡Ü›s
[
pid
.
·ge
] = 
	`·ge_hi¡Üy
Õid, 
Œue
, 0);

355 
log»c_t
::
t_·ge_»şaim
: {

356 
idx
 = *(*è
½
->
	`d©a
();

357 if(
™
 =ğ
·ge_hi¡Ü›s
.
	`’d
()) {

359 
·ge_hi¡Ü›s
[
pid
.
·ge
] = 
	`·ge_hi¡Üy
Õid, 
çl£
, 
idx
);

363 if(
idx
 !ğ
™
->
£cÚd
.
Ï¡_¦Ù
 + 1) {

364 
	`årštf
(
¡d”r
,

366 
Çme
, 
pid
.
	`vŞ
().
vŞ
,…id.
	`¡Üe
(),…id.
·ge
, 
™
->
£cÚd
.
Ï¡_¦Ù
, 
idx
);

368 
™
->
£cÚd
.
Ï¡_¦Ù
 = 
idx
;

374 
	}
}

	@debug_locks.cpp

54 
	#´iv©e
 
public


	)

55 
	#´Ùeùed
 
public


	)

58 
	~"w_defšes.h
"

59 
	~"¡_”rÜ_’um_g’.h
"

60 
	~"sm_št_4.h
"

61 
	~"kvl_t.h
"

62 
	~"pm­.h
"

63 
	~"sm_s.h
"

64 
	~"·ge_s.h
"

65 
	~"bf.h
"

66 
	~"·ge.h
"

67 
	~"sm_io.h
"

68 
	~"ex‹Á.h
"

69 
	~"lock.h
"

70 
	~"lock_s.h
"

71 
	~"lock_x.h
"

72 
	~"lock_cÜe.h
"

73 
	~"s.h
"

76 şas 
	cbuck‘_t
 {

77 
	mpublic
:

79 
DEF_LOCK_X_TYPE
(3);

81 
lock_x
 
	mmu‹x
;

83 
	mlock_cÜe_m
::
chaš_li¡_t
 
chaš
;

85 
NORET
 
	$buck‘_t
() :

86 
	`chaš
(
	`W_LIST_ARG
(
lock_h—d_t
, 
chaš
),

87 &
mu‹x
.mutex) {

90 
´iv©e
:

92 
NORET
 
	`buck‘_t
(cÚ¡ 
buck‘_t
&);

93 
buck‘_t
& 
İ”©Ü
=(const bucket_t&);

94 
	}
};

98 
	~<m­
>

99 
	~<s¡»am
>

102 
	$sÿn_lock_poŞ
() {

103 
¡d
::
	tm­
<, > 
	tlm­
;

104 
lm­
 
Ëngths
;

105 
lock_cÜe_m
* 
cÜe
 = 
smËv–_0
::
lm
->
_cÜe
;

106 
i
=0; i < 
cÜe
->
_hbsz
; i++)

107 
Ëngths
[
cÜe
->
_hb
[
i
].
chaš
.
	`num_memb”s
()]++;

109 
	`´štf
("Bucket density histogram:\n");

110 
lm­
::
™”©Ü
 
™
=
Ëngths
.
	`begš
(); iˆ!ğËngths.
	`’d
(); ++it)

111 
	`´štf
("\t%d: %d\n", 
™
->
fœ¡
, it->
£cÚd
);

112 
	`´štf
("\n");

113 
	}
}

116 
	$lock_wa™”s
(
boŞ
 
show_®l
) {

117 
¡d
::
	tm­
<, > 
	tlm­
;

118 
lm­
 
Ëngths
;

119 
lock_cÜe_m
* 
cÜe
 = 
smËv–_0
::
lm
->
_cÜe
;

120 
i
=0; i < 
cÜe
->
_hbsz
; i++) {

121 
lock_cÜe_m
::
chaš_li¡_i
 
	`™
(
cÜe
->
_hb
[
i
].
chaš
);

122 
lock_h—d_t
 *
lock
=
™
.
	`Ãxt
() ) {

123 ià(
nÙ
 
show_®l
 
ªd
‚Ù 
lock
->
wa™šg
)

126 
¡d
::
o¡ršg¡»am
 
os
;

127 
os
 << 
lock
->
Çme
 << 
¡d
::
’ds
 << std::
æush
;

128 cÚ¡* 
lm
 = 
lock_ba£_t
::
mode_¡r
[
lock
->
g¿Áed_mode
];

129 
	`´štf
("Lock %p: % %s:\n", 
lock
, 
os
.
	`¡r
().
	`c_¡r
(), 
lm
);

130 
lock_h—d_t
::
un§ã_queue_™”©Ü_t
 
	`™
(*
lock
);

131 
lock_»que¡_t
 *
»q
=
™
.
	`Ãxt
()) {

132 cÚ¡* 
¡
 = "";

133 cÚ¡* 
cm
 = "";

134 
»q
->
_¡©e
) {

135 
lock_m
::
t_wa™šg
:

136 
¡
 = "*";

138 
lock_m
::
t_cÚv”tšg
:

139 
¡
 = "/";

140 
cm
 = 
lock_ba£_t
::
mode_¡r
[
»q
->
	`cÚv”t_mode
()];

145 
tid_t
 
tid
 = 
»q
->
	`g‘_lock_šfo
()->
	`tid
();

146 cÚ¡* 
m
 = 
lock_ba£_t
::
mode_¡r
[
»q
->
	`mode
()];

147 
	`´štf
("\t%p: %d.%d %s%s%s\n", 
»q
, 
tid
.
	`g‘_hi
(),id.
	`g‘_lo
(), 
m
, 
¡
, 
cm
);

152 
	}
}

155 
	$debug_‹¡
() {

156  
	`årštf
(
¡d”r
, "Hi! Thadd»s oàthlock mªag” is: %p\n", &
smËv–_4
::
lm
);

157 
	}
}

	@include/dora.h

24 #iâdeà
__DORA_H


25 
	#__DORA_H


	)

27 
	~"dÜa/dÜa_”rÜ.h
"

28 
	~"dÜa/commÚ.h
"

30 
	~"dÜa/key.h
"

31 
	~"dÜa/rvp.h
"

32 
	~"dÜa/ba£_aùiÚ.h
"

33 
	~"dÜa/logiÿl_lock.h
"

34 
	~"dÜa/aùiÚ.h
"

35 
	~"dÜa/lockmª.h
"

37 
	~"dÜa/·¹™iÚ.h
"

38 
	~"dÜa/·¹_bË.h
"

40 
	~"dÜa/wÜk”.h
"

42 
	~"dÜa/¿nge_aùiÚ.h
"

43 
	~"dÜa/¿nge_·¹_bË.h
"

45 
	~"dÜa/dæush”.h
"

	@include/dora/action.h

32 #iâdeà
__DORA_ACTION_H


33 
	#__DORA_ACTION_H


	)

35 
	~<c¡dio
>

37 
	~"ut.h
"

39 
	~"dÜa/ba£_aùiÚ.h
"

40 
	~"dÜa/logiÿl_lock.h
"

43 
usšg
 
Çme¥aû
 
	gshÜe
;

45 
ENTER_NAMESPACE
(
dÜa
);

47 
	g‹m¶©e
<
ty³Çme
 
	gD©aTy³
> 
şass
 
	g·¹™iÚ_t
;

61 
	g‹m¶©e
 <
ty³Çme
 
	gD©aTy³
>

62 şas 
	caùiÚ_t
 : 
public
 
ba£_aùiÚ_t


64 
public
:

66 
key_w¿µ”_t
<
	tD©aTy³
> 
	tKey
;

68 
	m¡d
::
	tveùÜ
<
	tKey
*> 
	tKeyPŒVec
;

70 
	m·¹™iÚ_t
<
	tD©aTy³
> 
	tP¬t™iÚ
;

72 
	mKALReq_t
<
	tD©aTy³
> 
	tKALReq
;

74 
	m¡d
::
	tveùÜ
<
	tKALReq_t
<
	tD©aTy³
> > 
	tKALReqVec
;

76 
	m´Ùeùed
:

79 
KeyPŒVec
 
_keys
;

82 
KALReqVec
 
	m_»que¡s
;

85 
P¬t™iÚ
* 
	m_·¹™iÚ
;

87 
šlše
 
	$_aù_£t
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, 
rvp_t
* 
´vp
,

88 cÚ¡ 
numkeys
,

89 cÚ¡ 
boŞ
 
ro
=
çl£
)

91 
	`_ba£_£t
(
axù
,
©id
,
´vp
,
numkeys
,
ro
);

93 
	`as£¹
 (
numkeys
);

94 
_keys
.
	`»£rve
(
numkeys
);

95 
_»que¡s
.
	`»£rve
(1);

99 
public
:

101 
	$aùiÚ_t
() :

102 
	`ba£_aùiÚ_t
(), 
	$_·¹™iÚ
(
NULL
)

103 { 
	}
}

105 
	gvœtu®
 ~
	$aùiÚ_t
(è{ 
	}
}

109 
	$aùiÚ_t
(
aùiÚ_t
 cÚ¡& 
rhs
)

110 : 
	`ba£_aùiÚ_t
(
rhs
),

111 
	`_keys
(
rhs
.
_keys
), 
	`_»que¡s
Ôhs.
_»que¡s
), 
	$_·¹™iÚ
(
rhs
.
_·¹™iÚ
)

112 { 
	`as£¹
 (0); 
	}
}

114 
	gaùiÚ_t
& 
	gİ”©Ü
=(
aùiÚ_t
 cÚ¡& 
rhs
) {

115 ià(
this
 !ğ&
rhs
) {

116 
as£¹
 (0);

117 
	gba£_aùiÚ_t
::
İ”©Ü
=(
rhs
);

118 
	g_keys
 = 
rhs
.
_keys
;

119 
	g_»que¡s
 = 
rhs
.
_»que¡s
;

120 
	g_·¹™iÚ
 = 
rhs
.
_·¹™iÚ
;

122  (*
	gthis
);

128 
KeyPŒVec
* 
	$keys
(è{  (&
_keys
); 
	}
}

129 
KALReqVec
* 
	$»que¡s
(è{  (&
_»que¡s
); 
	}
}

131 
šlše
 
P¬t™iÚ
* 
	$g‘_·¹™iÚ
(ècÚ¡ {  (
_·¹™iÚ
); 
	}
}

132 
šlše
 
	$£t_·¹™iÚ
(
P¬t™iÚ
* 
­
) {

133 
	`as£¹
 (
­
); 
_·¹™iÚ
 =‡p;

134 
	}
}

139 
vœtu®
 
w_rc_t
 
Œx_exec
()=0;

141 
boŞ
 
	$Œx_acq_locks
()

143 
	`as£¹
 (
_·¹™iÚ
);

144 
	`Œx_upd_keys
();

145  (
_·¹™iÚ
->
	`acquœe
(
_»que¡s
));

146 
	}
}

148 
	$Œx_»l_locks
(
Ba£AùiÚPŒLi¡
& 
»adyLi¡
,

149 
Ba£AùiÚPŒLi¡
& 
´omÙedLi¡
)

151 
	`as£¹
 (
_·¹™iÚ
);

152 
	`as£¹
 (
_keys_£t
);

154  (
_·¹™iÚ
->
	`»Ëa£
(
this
,
»adyLi¡
,
´omÙedLi¡
));

155 
	}
}

158 
vœtu®
 
Œx_upd_keys
()=0;

160 
	$nÙify_own_·¹™iÚ
()

162 
	`as£¹
 (
_·¹™iÚ
);

163 
_·¹™iÚ
->
	`’queue_comm™
(
this
);

164 
	}
}

166 
vœtu®
 
giveback
()=0;

169 
vœtu®
 
	$£tup
()

171 
	}
}

173 
vœtu®
 
	$»£t
()

176 
_keys
.
	`”a£
(_keys.
	`begš
(),_keys.
	`’d
());

177 
_»que¡s
.
	`”a£
(_»que¡s.
	`begš
(),_»que¡s.
	`’d
());

178 
	}
}

184 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/base_action.h

32 #iâdeà
__DORA_BASE_ACTION_H


33 
	#__DORA_BASE_ACTION_H


	)

35 
	~<c¡dio
>

37 
	~"ut.h
"

39 
	~"dÜa/key.h
"

43 
ENTER_NAMESPACE
(
dÜa
);

46 
	grvp_t
;

56 şas 
	cba£_aùiÚ_t


58 
	mpublic
:

60 
¡d
::
	tveùÜ
<
	tba£_aùiÚ_t
*> 
	tBa£AùiÚPŒLi¡
;

61 
	mBa£AùiÚPŒLi¡
::
	t™”©Ü
 
	tBa£AùiÚPŒIt
;

63 
	m´Ùeùed
:

66 
rvp_t
* 
_´vp
;

69 
xù_t
* 
	m_xù
;

70 
tid_t
 
	m_tid
;

72 
	m_keys_Ãeded
;

75 
boŞ
 
	m_»ad_Úly
;

78 
boŞ
 
	m_keys_£t
;

81 
boŞ
 
	m_£cÚd¬y
;

84 #ifdeà
WORKER_VERBOSE_STATS


85 
¡İw©ch_t
 
	m_sšû_’queue
;

89 
šlše
 
	$_ba£_£t
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, 
rvp_t
* 
´vp
,

90 cÚ¡ 
numkeys
, cÚ¡ 
boŞ
 
ro
)

92 
_tid
 = 
©id
;

93 
_xù
 = 
axù
;

94 
_´vp
 = 
´vp
;

95 
_keys_Ãeded
 = 
numkeys
;

96 
_»ad_Úly
 = 
ro
;

97 
_keys_£t
 = 
çl£
;

98 
_£cÚd¬y
 =
çl£
;

101 
public
:

103 
	$ba£_aùiÚ_t
() :

104 
	`_´vp
(
NULL
), 
	`_xù
(NULL), 
	`_keys_Ãeded
(0),

105 
	`_»ad_Úly
(
çl£
), 
	`_keys_£t
(0), 
	$_£cÚd¬y
(
çl£
)

106 { 
	}
}

108 
	gvœtu®
 ~
	$ba£_aùiÚ_t
(è{ 
	}
}

112 
šlše
 
rvp_t
* 
	$rvp
(è{  (
_´vp
); 
	}
}

113 
šlše
 
xù_t
* 
	$xù
(è{  (
_xù
); 
	}
}

114 
šlše
 
tid_t
 
	$tid
(è{  (
_tid
); 
	}
}

115 
šlše
 
tid_t
 
	$tid
(ècÚ¡ {  (
_tid
); 
	}
}

118 
šlše
 
boŞ
 
	$is_»ad_Úly
(è{  (
_»ad_Úly
); 
	}
}

119 
šlše
 
	$£t_»ad_Úly
() {

120 
	`as£¹
 (!
_keys_£t
);

121 
_»ad_Úly
 = 
Œue
;

122 
	}
}

127 
šlše
 
boŞ
 
	$is_£cÚd¬y
(è{  (
_£cÚd¬y
); 
	}
}

128 
šlše
 
	$£t_£cÚd¬y
(è{ 
_£cÚd¬y
 = 
Œue
; 
	}
}

133 
šlše
 
boŞ
 
	$is_»ady
() {

136  (
_keys_Ãeded
==0);

137 
	}
}

139 
šlše
 
	$£tkeys
(cÚ¡ 
numLocks
 = 1) {

140 
	`as£¹
 (
numLocks
);

141 
_keys_Ãeded
 = 
numLocks
;

142  (
_keys_Ãeded
);

143 
	}
}

145 
šlše
 
boŞ
 
	$gÙkeys
(cÚ¡ 
numLocks
 = 1) {

151 
	`as£¹
 ((
_keys_Ãeded
-
numLocks
)>=0);

152 
_keys_Ãeded
 -ğ
numLocks
;

153  (
_keys_Ãeded
==0);

154 
	}
}

156 
šlše
 
boŞ
 
	$¬e_keys_£t
(è{  (
_keys_£t
); 
	}
}

157 
šlše
 
	$keys_£t
(cÚ¡ 
boŞ
 
¬e_£t
 = 
Œue
è{ 
_keys_£t
 =‡»_£t; 
	}
}

161 
	$ba£_aùiÚ_t
(
ba£_aùiÚ_t
 cÚ¡& 
rhs
)

162 : 
	`_´vp
(
rhs
.
_´vp
), 
	`_xù
Ôhs.
_xù
),

163 
	`_tid
(
rhs
.
_tid
), 
	`_keys_Ãeded
Ôhs.
_keys_Ãeded
),

164 
	`_»ad_Úly
(
rhs
.
_»ad_Úly
),

165 
	`_keys_£t
(
rhs
.
_keys_£t
),

166 
	$_£cÚd¬y
(
rhs
.
_£cÚd¬y
)

167 { 
	}
}

169 
	gba£_aùiÚ_t
& 
	gİ”©Ü
=(
ba£_aùiÚ_t
 cÚ¡& 
rhs
);

175 
vœtu®
 
w_rc_t
 
Œx_exec
()=0;

178 
vœtu®
 
boŞ
 
Œx_acq_locks
()=0;

181 
vœtu®
 
Œx_»l_locks
(
Ba£AùiÚPŒLi¡
& 
»adyLi¡
,

182 
Ba£AùiÚPŒLi¡
& 
´omÙedLi¡
)=0;

185 
vœtu®
 
Œx_upd_keys
()=0;

188 
vœtu®
 
nÙify_own_·¹™iÚ
()=0;

191 
vœtu®
 
giveback
()=0;

193 #ifdeà
WORKER_VERBOSE_STATS


194 
m¬k_’queue
();

195 
wa™ed
();

201 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/base_partition.h

31 #iâdeà
__DORA_BASE_PARTITION_H


32 
	#__DORA_BASE_PARTITION_H


	)

35 
	~<c¡dio
>

37 
	~"ut.h
"

39 
	~"dÜa/commÚ.h
"

40 
	~"dÜa/ba£_aùiÚ.h
"

42 
	~"sm/shÜe/shÜe_’v.h
"

43 
	~"sm/shÜe/shÜe_bË.h
"

44 
	~"sm/shÜe/¤mwqueue.h
"

46 
usšg
 
Çme¥aû
 
	gshÜe
;

49 
ENTER_NAMESPACE
(
dÜa
);

61 şas 
	cba£_·¹™iÚ_t


63 
	m´Ùeùed
:

65 
ShÜeEnv
* 
_’v
;

66 
bË_desc_t
* 
	m_bË
;

68 
ušt
 
	m_·¹_id
;

69 
eP¬t™iÚPŞicy
 
	m_·¹_pŞicy
;

72 
s_lock
 
	m_owÃr_lock
;

75 
´oûssÜid_t
 
	m_´s_id
;

77 
	mpublic
:

79 
ba£_·¹™iÚ_t
(
ShÜeEnv
* 
’v
, 
bË_desc_t
* 
±abË
,

80 cÚ¡ 
ušt
 
­¬tid
,

81 cÚ¡ 
´oûssÜid_t
 
­rsid
);

83 
	mvœtu®
 ~
ba£_·¹™iÚ_t
();

85 
ušt
 
	$·¹_id
(ècÚ¡ {  (
_·¹_id
); }

86 
	`£t_·¹_id
(cÚ¡ 
ušt
 
pid
);

87 
bË_desc_t
* 
	$bË
(ècÚ¡ {  (
_bË
); 
	}
}

90 
eP¬t™iÚPŞicy
 
g‘_·¹_pŞicy
();

91 
£t_·¹_pŞicy
(cÚ¡ 
eP¬t™iÚPŞicy
 
aP¬tPŞicy
);

96 
mcs_lock
 
	g_’queue_lock
;

99 
vœtu®
 
	$has_šput
() const=0;

100 
vœtu®
 
	$has_comm™‹d
() const=0;

103 
vœtu®
 
ba£_aùiÚ_t
* 
	`dequeue
()=0;

104 
vœtu®
 
ba£_aùiÚ_t
* 
	`dequeue_comm™
()=0;

107 
vœtu®
 
	`»£t
(cÚ¡ 
´oûssÜid_t
 
­rsid
)=0;

110 
vœtu®
 
	`abÜt_®l_’queued
()=0;

113 
vœtu®
 
	`¡İ
()=0;

116 
vœtu®
 
w_rc_t
 
	`´•¬eNewRun
()=0;

119 
vœtu®
 
	`¡©i¡ics
(
wÜk”_¡©s_t
& 
g©h”
)=0;

120 
vœtu®
 
	`¡lsize
(
ušt
& 
g©h”
)=0;

123 
vœtu®
 
	`dump
();

125 
	}
};

127 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/common.h

32 #iâdeà
__DORA_COMMON_H


33 
	#__DORA_COMMON_H


	)

35 
	~"ut.h
"

37 
	~"s.h
"

39 
	~<veùÜ
>

43 
ENTER_NAMESPACE
(
dÜa
);

46 
usšg
 
	g¡d
::
veùÜ
;

47 
usšg
 
	g¡d
::
·œ
;

55 cÚ¡ 
ušt
 
	gD_MIN_KEYS_TOUCHED
 = 10000;

58 cÚ¡ 
ušt
 
	gDF_CPU_RANGE
 = 8;

59 cÚ¡ 
ušt
 
	gDF_CPU_STARTING
 = 2;

60 cÚ¡ 
ušt
 
	gDF_CPU_STEP_TABLES
 = 16;

61 cÚ¡ 
ušt
 
	gDF_CPU_STEP_PARTITIONS
 = 2;

63 cÚ¡ 
ušt
 
	gDF_NUM_OF_PARTITIONS_PER_TABLE
 = 1;

80 
	eeDÜaLockMode
 {

81 
	mDL_CC_NOLOCK
 = 0,

82 
	mDL_CC_SHARED
 = 1,

83 
	mDL_CC_EXCL
 = 2,

85 
	mDL_CC_MODES
 = 3

99 
DÜaLockModeM©rix
[
DL_CC_MODES
][DL_CC_MODES];

123 
	eeAùiÚDecisiÚ
 { 
	mAD_UNDECIDED
 = 0x1,

124 
	mAD_ABORT
 = 0x2,

125 
	mAD_DEADLOCK
 = 0x4,

126 
	mAD_COMMIT
 = 0x8,

127 
	mAD_DIE
 = 0x10,

128 
	mAD_PROPAGATE
 = 0x20}

143 
	edÜa_ty³s_t
 { 
	mDT_PLAIN
 = 0x1,

144 
	mDT_PLP
 = 0x2

162 
	eeP¬t™iÚPŞicy
 { 
	mPP_UNDEF
 = 0x1,

163 
	mPP_RANGE
 = 0x2,

164 
	mPP_HASH
 = 0x4,

165 
	mPP_PREFIX
 = 0x8

171 cÚ¡ 
	gKEYPTR_PER_ACTION_POOL_SZ
 = 60;

172 cÚ¡ 
	gKALREQ_PER_ACTION_POOL_SZ
 = 30;

173 cÚ¡ 
	gDT_PER_ACTION_POOL_SZ
 = 360;

176 
PoŞ
* 
	tPoŞPŒ
;

178 cÚ¡ 
	gACTIONS_PER_RVP_POOL_SZ
 = 30;

184 
	#DECLARE_RVP_CACHE
(
Ty³
) \

185 
Ty³
##
_ÿche
 { \

186 
gu¬d
< 
objeù_ÿche_t
<
Ty³
> > 
_ÿche
; \

187 
Ty³
##
	`_ÿche
() { \

188 
_ÿche
 = 
Ãw
 
objeù_ÿche_t
<
Ty³
>(); } \

189 ~
Ty³
##
	`_ÿche
(è{ 
_ÿche
.
	`dÚe
(); } };

	)

192 
	#DECLARE_TLS_RVP_CACHE
(
Ty³
) \

193 
	`DECLARE_RVP_CACHE
(
Ty³
); \

194 
	`DECLARE_TLS
(
Ty³
##
_ÿche
,
my_
##Ty³##_ÿche);

	)

199 
	#DECLARE_ACTION_CACHE
(
Ty³
,
D©©y³
) \

200 
Ty³
##
_ÿche
 { \

201 
gu¬d
<
objeù_ÿche_t
<
Ty³
> > 
_ÿche
; \

202 
gu¬d
<
PoŞ
> 
_keyPŒPoŞ
; \

203 
gu¬d
<
PoŞ
> 
_k®ReqPoŞ
; \

204 
gu¬d
<
PoŞ
> 
_dtPoŞ
; \

205 
Ty³
##
	`_ÿche
() { \

206 
_ÿche
 = 
Ãw
 
objeù_ÿche_t
<
Ty³
>(); } \

207 ~
Ty³
##
	`_ÿche
(è{ 
_ÿche
.
	`dÚe
(); } };

	)

211 
	#DECLARE_TLS_ACTION_CACHE
(
Ty³
,
D©©y³
) \

212 
	`DECLARE_ACTION_CACHE
(
Ty³
,
D©©y³
); \

213 
	`DECLARE_TLS
(
Ty³
##
_ÿche
,
my_
##Ty³##_ÿche);

	)

220 
	#DECLARE_DORA_PARTS
(
abbrv
) \

221 
gu¬d
<
œpTabËIm¶
> 
_
##
abbrv
##
_œ±
; \

222 
ušt
 
_·¹s_
##
abbrv
; \

223 
šlše
 
œpTabËIm¶
* 
	`abbrv
(è{  (
_
##
abbrv
##
_œ±
.
	`g‘
()); }

	)

226 
	#GENERATE_DORA_PARTS
(
abbrv
,
bËÇme
) \

227 { 
_
##
abbrv
##
_œ±
 = 
Ãw
 
	`œpTabËIm¶
(
this
, 
bËÇme
##
	`_desc
(), 
	`dty³
(), 
iıu
, 
_ıu_¿nge
,‡bbrv##
_KEY_EST
); \

228 ià(!
_
##
abbrv
##
_œ±
) { \

229 
	`TRACE
Ğ
TRACE_ALWAYS
, "Problem in creating irp-table\n"); \

230 
	`as£¹
 (0);  (
de_GEN_TABLE
); } \

231 
_œ±p_vec
.
	`push_back
(
_
##
abbrv
##
_œ±
.
	`g‘
()); \

232 
iıu
 = 
	`_Ãxt_ıu
(iıu, 
_
##
abbrv
##
_œ±
, 
_ıu_bË_¡•
);}

	)

243 
	#DECLARE_DORA_TRX
(
Œx
) \

244 
w_rc_t
 
dÜa_
##
	`Œx
(cÚ¡ 
xù_id
, 
Œx_»suÉ_tu¶e_t
& 
©¹
, \

245 
Œx
##
_šput_t
& 
š
, cÚ¡ 
boŞ
 
bWake
); \

246 
w_rc_t
 
dÜa_
##
	`Œx
(cÚ¡ 
xù_id
, 
Œx_»suÉ_tu¶e_t
& 
©¹
, \

247 cÚ¡ 
¥ecificID
, cÚ¡ 
boŞ
 
bWake
)

	)

250 
	#DEFINE_DORA_WITHOUT_INPUT_TRX_WRAPPER
(
úame
,
Œx
) \

251 
w_rc_t
 
úame
::
dÜa_
##
	`Œx
(cÚ¡ 
xù_id
, 
Œx_»suÉ_tu¶e_t
& 
©¹
, \

252 cÚ¡ 
¥ecificID
, cÚ¡ 
boŞ
 
bWake
) { \

253 
Œx
##
_šput_t
 
š
 = 
ü—‹_
##Œx##
	`_šput
(
_sÿlšg_çùÜ
, 
¥ecificID
); \

254  (
dÜa_
##
	`Œx
(
xù_id
, 
©¹
, 
š
, 
bWake
)); }

	)

259 
	#DECLARE_ALTER_DORA_TRX
(
Œxlid
,
Œxim¶
) \

260 
w_rc_t
 
dÜa_
##
	`Œxim¶
(cÚ¡ 
xù_id
, 
Œx_»suÉ_tu¶e_t
& 
©¹
, \

261 
Œxlid
##
_šput_t
& 
š
, cÚ¡ 
boŞ
 
bWake
); \

262 
w_rc_t
 
dÜa_
##
	`Œxim¶
(cÚ¡ 
xù_id
, 
Œx_»suÉ_tu¶e_t
& 
©¹
, \

263 cÚ¡ 
¥ecificID
, cÚ¡ 
boŞ
 
bWake
)

	)

265 
	#DEFINE_ALTER_DORA_WITHOUT_INPUT_TRX_WRAPPER
(
úame
,
Œxlid
,
Œxim¶
) \

266 
w_rc_t
 
úame
::
dÜa_
##
	`Œxim¶
(cÚ¡ 
xù_id
, 
Œx_»suÉ_tu¶e_t
& 
©¹
, \

267 cÚ¡ 
¥ecificID
, cÚ¡ 
boŞ
 
bWake
) { \

268 
Œxlid
##
_šput_t
 
š
 = 
ü—‹_
##Œxlid##
	`_šput
(
_sÿlšg_çùÜ
, 
¥ecificID
); \

269  (
dÜa_
##
	`Œxim¶
(
xù_id
, 
©¹
, 
š
, 
bWake
)); }

	)

287 
	#DECLARE_DORA_MIDWAY_RVP_GEN_FUNC
(
rv²ame
,
špuŠame
) \

288 
rv²ame
* 
Ãw_
##
	`rv²ame
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, cÚ¡ 
axùid
, \

289 
Œx_»suÉ_tu¶e_t
& 
´esuÉ
, cÚ¡ 
špuŠame
& 
š
, cÚ¡ 
boŞ
 
bWake
)

	)

292 
	#DEFINE_DORA_MIDWAY_RVP_GEN_FUNC
(
rv²ame
,
špuŠame
,
şas¢ame
) \

293 
	`DECLARE_TLS_RVP_CACHE
(
rv²ame
); \

294 
rv²ame
* 
şas¢ame
::
Ãw_
##
	`rv²ame
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, cÚ¡ 
axùid
, \

295 
Œx_»suÉ_tu¶e_t
& 
´esuÉ
, cÚ¡ 
špuŠame
& 
š
, \

296 cÚ¡ 
boŞ
 
bWake
) { \

297 
rv²ame
* 
myrvp
 = 
my_
##rv²ame##
_ÿche
->_ÿche->
	`bÜrow
(); \

298 
	`as£¹
 (
myrvp
); \

299 
myrvp
->
	`£t
(
axù
,
©id
,
axùid
,
´esuÉ
,
š
,
bWake
,
this
,
my_
##
rv²ame
##
_ÿche
->_ÿche.
	`g‘
()); \

300  (
myrvp
); }

	)

306 
	#DECLARE_DORA_MIDWAY_DYNAMIC_RVP_GEN_FUNC
(
rv²ame
,
špuŠame
) \

307 
rv²ame
* 
Ãw_
##
	`rv²ame
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, cÚ¡ 
axùid
, \

308 
Œx_»suÉ_tu¶e_t
& 
´esuÉ
, cÚ¡ 
špuŠame
& 
š
, \

309 cÚ¡ 
šŒ©rx
, cÚ¡ 
tÙ®
, cÚ¡ 
boŞ
 
bWake
)

	)

312 
	#DEFINE_DORA_MIDWAY_DYNAMIC_RVP_GEN_FUNC
(
rv²ame
,
špuŠame
,
şas¢ame
) \

313 
	`DECLARE_TLS_RVP_CACHE
(
rv²ame
); \

314 
rv²ame
* 
şas¢ame
::
Ãw_
##
	`rv²ame
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, cÚ¡ 
axùid
, \

315 
Œx_»suÉ_tu¶e_t
& 
´esuÉ
, cÚ¡ 
špuŠame
& 
š
, \

316 cÚ¡ 
šŒ©rx
, cÚ¡ 
tÙ®
, \

317 cÚ¡ 
boŞ
 
bWake
) { \

318 
rv²ame
* 
myrvp
 = 
my_
##rv²ame##
_ÿche
->_ÿche->
	`bÜrow
(); \

319 
	`as£¹
 (
myrvp
); \

320 
myrvp
->
	`£t
(
axù
,
©id
,
axùid
,
´esuÉ
,
š
,
bWake
,
this
, \

321 
my_
##
rv²ame
##
_ÿche
->_ÿche.
	`g‘
(), \

322 
šŒ©rx
,
tÙ®
); \

323  (
myrvp
); }

	)

329 
	#DECLARE_DORA_MIDWAY_RVP_WITH_PREV_GEN_FUNC
(
rv²ame
,
špuŠame
) \

330 
rv²ame
* 
Ãw_
##
	`rv²ame
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, cÚ¡ 
axùid
, \

331 
Œx_»suÉ_tu¶e_t
& 
´esuÉ
, cÚ¡ 
špuŠame
& 
š
, \

332 
ba£AùiÚsLi¡
& 
aùiÚs
, cÚ¡ 
boŞ
 
bWake
)

	)

334 
	#DEFINE_DORA_MIDWAY_RVP_WITH_PREV_GEN_FUNC
(
rv²ame
,
špuŠame
,
şas¢ame
) \

335 
	`DECLARE_TLS_RVP_CACHE
(
rv²ame
); \

336 
rv²ame
* 
şas¢ame
::
Ãw_
##
	`rv²ame
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, cÚ¡ 
axùid
, \

337 
Œx_»suÉ_tu¶e_t
& 
´esuÉ
, cÚ¡ 
špuŠame
& 
š
, \

338 
ba£AùiÚsLi¡
& 
aùiÚs
, cÚ¡ 
boŞ
 
bWake
) { \

339 
rv²ame
* 
myrvp
 = 
my_
##rv²ame##
_ÿche
->_ÿche->
	`bÜrow
(); \

340 
	`as£¹
 (
myrvp
); \

341 
myrvp
->
	`£t
(
axù
,
©id
,
axùid
,
´esuÉ
,
š
,
bWake
,
this
,
my_
##
rv²ame
##
_ÿche
->_ÿche.
	`g‘
()); \

342 
myrvp
->
	`cİy_aùiÚs
(
aùiÚs
); \

343  (
myrvp
); }

	)

351 
	#DECLARE_DORA_FINAL_RVP_GEN_FUNC
(
rv²ame
) \

352 
rv²ame
* 
Ãw_
##
	`rv²ame
(
xù_t
* 
axù
, \

353 cÚ¡ 
tid_t
& 
©id
, cÚ¡ 
axùid
, \

354 
Œx_»suÉ_tu¶e_t
& 
´esuÉ
)

	)

357 
	#DEFINE_DORA_FINAL_RVP_GEN_FUNC
(
rv²ame
,
şas¢ame
) \

358 
	`DECLARE_TLS_RVP_CACHE
(
rv²ame
); \

359 
rv²ame
* 
şas¢ame
::
Ãw_
##
	`rv²ame
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, cÚ¡ 
axùid
, \

360 
Œx_»suÉ_tu¶e_t
& 
´esuÉ
) { \

361 
rv²ame
* 
myrvp
 = 
my_
##rv²ame##
_ÿche
->_ÿche->
	`bÜrow
(); \

362 
	`as£¹
 (
myrvp
); \

363 
myrvp
->
	`£t
(
axù
,
©id
,
axùid
,
´esuÉ
,
this
,
my_
##
rv²ame
##
_ÿche
->_ÿche.
	`g‘
()); \

364  (
myrvp
); }

	)

370 
	#DECLARE_DORA_FINAL_RVP_WITH_PREV_GEN_FUNC
(
rv²ame
) \

371 
rv²ame
* 
Ãw_
##
	`rv²ame
(
xù_t
* 
axù
, \

372 cÚ¡ 
tid_t
& 
©id
, cÚ¡ 
axùid
, \

373 
Œx_»suÉ_tu¶e_t
& 
´esuÉ
, 
ba£AùiÚsLi¡
& 
aùiÚs
)

	)

376 
	#DEFINE_DORA_FINAL_RVP_WITH_PREV_GEN_FUNC
(
rv²ame
,
şas¢ame
) \

377 
	`DECLARE_TLS_RVP_CACHE
(
rv²ame
); \

378 
rv²ame
* 
şas¢ame
::
Ãw_
##
	`rv²ame
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, cÚ¡ 
axùid
, \

379 
Œx_»suÉ_tu¶e_t
& 
´esuÉ
, 
ba£AùiÚsLi¡
& 
aùiÚs
) { \

380 
rv²ame
* 
myrvp
 = 
my_
##rv²ame##
_ÿche
->_ÿche->
	`bÜrow
(); \

381 
	`as£¹
 (
myrvp
); \

382 
myrvp
->
	`£t
(
axù
,
©id
,
axùid
,
´esuÉ
,
this
,
my_
##
rv²ame
##
_ÿche
->_ÿche.
	`g‘
()); \

383 
myrvp
->
	`cİy_aùiÚs
(
aùiÚs
); \

384  (
myrvp
); }

	)

390 
	#DECLARE_DORA_FINAL_DYNAMIC_RVP_GEN_FUNC
(
rv²ame
) \

391 
rv²ame
* 
Ãw_
##
	`rv²ame
(
xù_t
* 
axù
, \

392 cÚ¡ 
tid_t
& 
©id
, cÚ¡ 
axùid
, \

393 
Œx_»suÉ_tu¶e_t
& 
´esuÉ
, \

394 cÚ¡ 
šŒ©rx
)

	)

397 
	#DEFINE_DORA_FINAL_DYNAMIC_RVP_GEN_FUNC
(
rv²ame
,
şas¢ame
) \

398 
	`DECLARE_TLS_RVP_CACHE
(
rv²ame
); \

399 
rv²ame
* 
şas¢ame
::
Ãw_
##
	`rv²ame
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, cÚ¡ 
axùid
, \

400 
Œx_»suÉ_tu¶e_t
& 
´esuÉ
, \

401 cÚ¡ 
šŒ©rx
) { \

402 
rv²ame
* 
myrvp
 = 
my_
##rv²ame##
_ÿche
->_ÿche->
	`bÜrow
(); \

403 
	`as£¹
 (
myrvp
); \

404 
myrvp
->
	`£t
(
axù
,
©id
,
axùid
,
´esuÉ
,
this
, \

405 
my_
##
rv²ame
##
_ÿche
->_ÿche.
	`g‘
(), \

406 
šŒ©rx
,intratrx); \

407  (
myrvp
); }

	)

413 
	#DECLARE_DORA_FINAL_DYNAMIC_RVP_WITH_PREV_GEN_FUNC
(
rv²ame
) \

414 
rv²ame
* 
Ãw_
##
	`rv²ame
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, cÚ¡ 
axùid
, \

415 
Œx_»suÉ_tu¶e_t
& 
´esuÉ
, \

416 cÚ¡ 
šŒ©rx
, cÚ¡ 
tÙ®
, \

417 
ba£AùiÚsLi¡
& 
aùiÚs
)

	)

420 
	#DEFINE_DORA_FINAL_DYNAMIC_RVP_WITH_PREV_GEN_FUNC
(
rv²ame
,
şas¢ame
) \

421 
	`DECLARE_TLS_RVP_CACHE
(
rv²ame
); \

422 
rv²ame
* 
şas¢ame
::
Ãw_
##
	`rv²ame
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, cÚ¡ 
axùid
, \

423 
Œx_»suÉ_tu¶e_t
& 
´esuÉ
, \

424 cÚ¡ 
šŒ©rx
, cÚ¡ 
tÙ®
, \

425 
ba£AùiÚsLi¡
& 
aùiÚs
) { \

426 
rv²ame
* 
myrvp
 = 
my_
##rv²ame##
_ÿche
->_ÿche->
	`bÜrow
(); \

427 
	`as£¹
 (
myrvp
); \

428 
myrvp
->
	`£t
(
axù
,
©id
,
axùid
,
´esuÉ
,
this
, \

429 
my_
##
rv²ame
##
_ÿche
->_ÿche.
	`g‘
(), \

430 
šŒ©rx
,
tÙ®
); \

431 
myrvp
->
	`cİy_aùiÚs
(
aùiÚs
); \

432  (
myrvp
); }

	)

439 
	#DECLARE_DORA_ACTION_GEN_FUNC
(
aùiÚame
,
rv²ame
,
špuŠame
) \

440 
aùiÚame
* 
Ãw_
##
	`aùiÚame
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, 
rv²ame
* 
´vp
, cÚ¡ 
špuŠame
& 
š
)

	)

443 
	#DEFINE_DORA_ACTION_GEN_FUNC
(
aùiÚame
,
rv²ame
,
špuŠame
,
aùiÚty³
,
şas¢ame
) \

444 
	`DECLARE_TLS_ACTION_CACHE
(
aùiÚame
,
aùiÚty³
); \

445 
aùiÚame
* 
şas¢ame
::
Ãw_
##
	`aùiÚame
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, 
rv²ame
* 
´vp
, cÚ¡ 
špuŠame
& 
š
) { \

446 
aùiÚame
* 
myaùiÚ
 = 
my_
##aùiÚame##
_ÿche
->_ÿche->
	`bÜrow
(); \

447 
	`as£¹
 (
myaùiÚ
); \

448 
myaùiÚ
->
	`£t
(
axù
,
©id
,
´vp
,
š
,
this
,
my_
##
aùiÚame
##
_ÿche
->_ÿche.
	`g‘
()); \

449 
´vp
->
	`add_aùiÚ
(
myaùiÚ
); \

450  (
myaùiÚ
); }

	)

466 
	#DECLARE_DORA_FINAL_RVP_CLASS
(
úame
,
’vÇme
,
šŒ©rx
,
tÙ®
) \

467 şas 
	cúame
 : 
public
 
‹rmš®_rvp_t
 { \

468 
´iv©e
: \

469 
objeù_ÿche_t
<
	túame
> 
	trvp_ÿche
; \

470 
’vÇme
* 
_³nv
; \

471 
rvp_ÿche
* 
_ÿche
; \

472 
public
: \

473 
	$úame
(è: 
	`‹rmš®_rvp_t
(), 
	`_³nv
(
NULL
), 
	$_ÿche
(
NULL
) { } \

474 ~
	$úame
(è{ 
_ÿche
=
NULL
; 
_³nv
=NULL; 
	}
} \

475 
šlše
 
	`£t
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, \

476 cÚ¡ 
axùid
, \

477 
Œx_»suÉ_tu¶e_t
& 
´esuÉ
, 
’vÇme
* 
³nv
, 
rvp_ÿche
* 
pc
) { \

478 
	`as£¹
 (
³nv
); 
_³nv
 =…env; \

479 
	`as£¹
 (
pc
); 
_ÿche
 =…c; \

480 
	`_£t
(
³nv
->
	`db
(),³nv,
axù
,
©id
,
axùid
,
´esuÉ
,
šŒ©rx
,
tÙ®
); } \

481 
šlše
 
	$giveback
(è{ 
_ÿche
->
	`giveback
(
this
); 
	}
} \

482 
	`upd_comm™‹d_¡©s
(); \

483 
	`upd_abÜ‹d_¡©s
(); }

	)

487 
	#DECLARE_DORA_FINAL_DYNAMIC_RVP_CLASS
(
úame
,
’vÇme
) \

488 şas 
	cúame
 : 
public
 
‹rmš®_rvp_t
 { \

489 
´iv©e
: \

490 
objeù_ÿche_t
<
	túame
> 
	trvp_ÿche
; \

491 
’vÇme
* 
_³nv
; \

492 
rvp_ÿche
* 
_ÿche
; \

493 
public
: \

494 
	$úame
(è: 
	`‹rmš®_rvp_t
(), 
	`_³nv
(
NULL
), 
	$_ÿche
(
NULL
) { } \

495 ~
	$úame
(è{ 
_ÿche
=
NULL
; 
_³nv
=NULL; 
	}
} \

496 
šlše
 
	`£t
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, \

497 cÚ¡ 
axùid
, \

498 
Œx_»suÉ_tu¶e_t
& 
´esuÉ
, 
’vÇme
* 
³nv
, 
rvp_ÿche
* 
pc
, \

499 cÚ¡ 
šŒ©rx
, cÚ¡ 
tÙ®
) { \

500 
	`as£¹
 (
³nv
); 
_³nv
 =…env; \

501 
	`as£¹
 (
pc
); 
_ÿche
 =…c; \

502 
	`_£t
(
³nv
->
	`db
(),³nv,
axù
,
©id
,
axùid
,
´esuÉ
,
šŒ©rx
,
tÙ®
); } \

503 
šlše
 
	$giveback
(è{ 
_ÿche
->
	`giveback
(
this
); 
	}
} \

504 
	`upd_comm™‹d_¡©s
(); \

505 
	`upd_abÜ‹d_¡©s
(); }

	)

508 
	#DEFINE_DORA_FINAL_RVP_CLASS
(
úame
,
Œx
) \

509 
úame
::
	`upd_comm™‹d_¡©s
() { \

510 
_³nv
->
_šc_
##
Œx
##
	`_©t
(); _³nv->
	`šc_Œx_com
(); } \

511 
úame
::
	`upd_abÜ‹d_¡©s
() { \

512 
_³nv
->
_šc_
##
Œx
##
	`_©t
(); _³nv->_šc_##Œx##
	`_çed
(); \

513 
_³nv
->
	`šc_Œx_©t
(); }

	)

517 
	#DECLARE_DORA_EMPTY_MIDWAY_RVP_CLASS
(
úame
,
’vÇme
,
špuŠame
,
šŒ©rx
,
tÙ®
) \

518 şas 
	cúame
 : 
public
 
rvp_t
 { \

519 
´iv©e
: \

520 
objeù_ÿche_t
<
	túame
> 
	trvp_ÿche
; \

521 
’vÇme
* 
_³nv
; \

522 
rvp_ÿche
* 
_ÿche
; \

523 
boŞ
 
_bWake
; \

524 
public
: \

525 
	$úame
(è: 
	`rvp_t
(), 
	`_³nv
(
NULL
), 
	$_ÿche
(
NULL
) { } \

526 ~
	$úame
(è{ 
_ÿche
=
NULL
; 
_³nv
=NULL; 
	}
} \

527 
špuŠame
 
_š
; \

528 
šlše
 
	`£t
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, cÚ¡ 
axùid
, \

529 
Œx_»suÉ_tu¶e_t
& 
´esuÉ
, \

530 cÚ¡ 
špuŠame
& 
š
, cÚ¡ 
boŞ
 
bWake
, \

531 
’vÇme
* 
³nv
, 
rvp_ÿche
* 
pc
) { \

532 
_š
 = 
š
; \

533 
_bWake
 = 
bWake
; \

534 
	`as£¹
 (
³nv
); 
_³nv
 =…env; \

535 
	`as£¹
 (
pc
); 
_ÿche
 =…c; \

536 
	`_£t
(
axù
,
©id
,
axùid
,
´esuÉ
,
šŒ©rx
,
tÙ®
); } \

537 
šlše
 
	$giveback
(è{ 
_ÿche
->
	`giveback
(
this
); 
	}
} \

538 
w_rc_t
 
	`_run
(); }

	)

542 
	#DECLARE_DORA_EMPTY_MIDWAY_DYNAMIC_RVP_CLASS
(
úame
,
’vÇme
,
špuŠame
) \

543 şas 
	cúame
 : 
public
 
rvp_t
 { \

544 
´iv©e
: \

545 
objeù_ÿche_t
<
	túame
> 
	trvp_ÿche
; \

546 
’vÇme
* 
_³nv
; \

547 
rvp_ÿche
* 
_ÿche
; \

548 
boŞ
 
_bWake
; \

549 
public
: \

550 
	$úame
(è: 
	`rvp_t
(), 
	`_³nv
(
NULL
), 
	$_ÿche
(
NULL
) { } \

551 ~
	$úame
(è{ 
_ÿche
=
NULL
; 
_³nv
=NULL; 
	}
} \

552 
špuŠame
 
_š
; \

553 
šlše
 
	`£t
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, cÚ¡ 
axùid
, \

554 
Œx_»suÉ_tu¶e_t
& 
´esuÉ
, \

555 cÚ¡ 
špuŠame
& 
š
, cÚ¡ 
boŞ
 
bWake
, \

556 
’vÇme
* 
³nv
, 
rvp_ÿche
* 
pc
, \

557 cÚ¡ 
šŒ©rx
, cÚ¡ 
tÙ®
) { \

558 
_š
 = 
š
; \

559 
_bWake
 = 
bWake
; \

560 
	`as£¹
 (
³nv
); 
_³nv
 =…env; \

561 
	`as£¹
 (
pc
); 
_ÿche
 =…c; \

562 
	`_£t
(
axù
,
©id
,
axùid
,
´esuÉ
,
šŒ©rx
,
tÙ®
); } \

563 
šlše
 
	$giveback
(è{ 
_ÿche
->
	`giveback
(
this
); 
	}
} \

564 
w_rc_t
 
	`_run
(); }

	)

570 
	#DECLARE_DORA_ACTION_NO_RVP_CLASS
(
ªame
,
d©©y³
,
’vÇme
,
špuŠame
,
keyËn
) \

571 
şass
 
ªame
 : 
public
 
¿nge_aùiÚ_im¶
<
d©©y³
> { \

572 
´iv©e
: \

573 
objeù_ÿche_t
<
	tªame
> 
	taù_ÿche
; \

574 
’vÇme
* 
_³nv
; \

575 
aù_ÿche
* 
_ÿche
; \

576 
public
: \

577 
	`ªame
(è: 
¿nge_aùiÚ_im¶
<
d©©y³
>(), 
	`_³nv
(
NULL
) { } \

578 ~
	`ªame
() { } \

579 
špuŠame
 
_š
; \

580 
šlše
 
	`giveback
(è{ 
_ÿche
->giveback(
this
); } \

581 
šlše
 
	`£t
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, 
rvp_t
* 
´vp
, \

582 cÚ¡ 
špuŠame
& 
š
, 
’vÇme
* 
³nv
, 
aù_ÿche
* 
pc
) { \

583 
	`as£¹
 (
pc
); 
_ÿche
 =…c; \

584 
	`as£¹
 (
³nv
); 
_³nv
 =…env; \

585 
_š
 = 
š
; \

586 
	`_¿nge_aù_£t
(
axù
,
©id
,
´vp
,
keyËn
); } \

587 
w_rc_t
 
	`Œx_exec
(); \

588 
	`ÿlc_keys
(); }

	)

591 
	#DECLARE_DORA_ACTION_WITH_RVP_CLASS
(
ªame
,
d©©y³
,
’vÇme
,
rv²ame
,
špuŠame
,
keyËn
) \

592 
şass
 
ªame
 : 
public
 
¿nge_aùiÚ_im¶
<
d©©y³
> { \

593 
´iv©e
: \

594 
objeù_ÿche_t
<
	tªame
> 
	taù_ÿche
; \

595 
’vÇme
* 
_³nv
; \

596 
rv²ame
* 
_´vp
; \

597 
aù_ÿche
* 
_ÿche
; \

598 
public
: \

599 
	`ªame
(è: 
¿nge_aùiÚ_im¶
<
d©©y³
>(), 
	`_³nv
(
NULL
) { } \

600 ~
	`ªame
() { } \

601 
špuŠame
 
_š
; \

602 
šlše
 
	`giveback
(è{ 
_ÿche
->giveback(
this
); } \

603 
šlše
 
	`£t
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, 
rv²ame
* 
´vp
, \

604 cÚ¡ 
špuŠame
& 
š
, 
’vÇme
* 
³nv
, 
aù_ÿche
* 
pc
) { \

605 
	`as£¹
 (
pc
); 
_ÿche
 =…c; \

606 
	`as£¹
 (
´vp
); 
_´vp
 =…rvp; \

607 
	`as£¹
 (
³nv
); 
_³nv
 =…env; \

608 
_š
 = 
š
; \

609 
	`_¿nge_aù_£t
(
axù
,
©id
,
´vp
,
keyËn
); } \

610 
w_rc_t
 
	`Œx_exec
(); \

611 
	`ÿlc_keys
(); }

	)

623 
	#CHECK_MIDWAY_RVP_ABORTED
(
ÃxŒvp
) \

624 ià(
	`isAbÜ‹d
()) { \

625 
ÃxŒvp
->
	`abÜt
(); \

626 
w_rc_t
 
e
 = 
ÃxŒvp
->
	`run
(); \

627 ià(
e
.
	`is_”rÜ
()) { \

628 
	`TRACE
Ğ
TRACE_ALWAYS
, \

630 
_tid
.
	`g‘_lo
(), 
e
.
	`”r_num
()); } \

631 
ÃxŒvp
 = 
NULL
; \

632  (
e
); }

	)

635 cÚ¡ 
	gDF_ACTION_CACHE_SZ
 = 100;

638 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/dflusher.h

88 #iâdeà
__DORA_FLUSHER_H


89 
	#__DORA_FLUSHER_H


	)

91 
	~"sm/shÜe/shÜe_wÜk”.h
"

92 
	~"sm/shÜe/shÜe_æush”.h
"

94 
	~"dÜa/rvp.h
"

96 
usšg
 
Çme¥aû
 
	gshÜe
;

98 
ENTER_NAMESPACE
(
dÜa
);

101 
şass
 
	gdÜa_nÙif›r_t
;

114 şas 
	cdÜa_æush”_t
 : 
public
 
æush”_t


116 
public
:

117 
¤mwqueue
<
	t‹rmš®_rvp_t
> 
	tDÜaQueue
;

119 
	m´iv©e
:

121 
gu¬d
<
dÜa_nÙif›r_t
> 
_nÙif›r
;

123 
	mgu¬d
<
	mDÜaQueue
> 
	m_dÜa_toæush
;

124 
	mgu¬d
<
	mDÜaQueue
> 
	m_dÜa_æushšg
;

126 
	m´Ùeùed
:

128 
vœtu®
 
_´e_STOP_im¶
();

129 
vœtu®
 
_check_wa™šg
(
boŞ
& 
bSË•Next
,

130 cÚ¡ 
l¢_t
& 
du¿bËl¢
,

131 
l¢_t
& 
maxl¢
,

132 
ušt
& 
wa™šg
);

133 
vœtu®
 
_move_äom_æushšg
(cÚ¡ 
l¢_t
& 
du¿bËl¢
);

135 
	mpublic
:

137 
dÜa_æush”_t
(
ShÜeEnv
* 
³nv
, 
c_¡r
 
Šame
,

138 
´oûssÜid_t
 
­rsid
 = 
PBIND_NONE
,

139 cÚ¡ 
u£_¦i
 = 0);

140 
	mvœtu®
 ~
dÜa_æush”_t
();

142 
šlše
 
	$’queue_toæush
(
‹rmš®_rvp_t
* 
¬vp
)

144 
_dÜa_toæush
->
	`push
(
¬vp
,
Œue
);

147 
	}
};

160 şas 
	cdÜa_nÙif›r_t
 : 
public
 
ba£_wÜk”_t


162 
public
:

163 
¤mwqueue
<
	t‹rmš®_rvp_t
> 
	tDÜaQueue
;

165 
	m´iv©e
:

167 
gu¬d
<
DÜaQueue
> 
_tÚÙify
;

168 
	mgu¬d
<
	mPoŞ
> 
	m_pxù_tÚÙify_poŞ
;

170 
_´e_STOP_im¶
();

171 
_wÜk_ACTIVE_im¶
();

173 
	mpublic
:

175 
dÜa_nÙif›r_t
(
ShÜeEnv
* 
’v
, 
c_¡r
 
Šame
,

176 
´oûssÜid_t
 
­rsid
 = 
PBIND_NONE
,

177 cÚ¡ 
u£_¦i
 = 0);

178 ~
dÜa_nÙif›r_t
();

180 
šlše
 
	$’queue_tÚÙify
(
‹rmš®_rvp_t
* 
¬vp
è{ 
_tÚÙify
->
	`push
×rvp,
Œue
); }

182 
	}
};

185 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/dkey_ranges_map.h

36 #iâdeà
__DORA_DKEY_RANGES_MAP_H


37 
	#__DORA_DKEY_RANGES_MAP_H


	)

39 
	~"sm_vas.h
"

40 
	~"ut.h
"

42 
	~"dÜa/dÜa_”rÜ.h
"

43 
	~"dÜa/commÚ.h
"

45 
	~"sm/shÜe/shÜe_’v.h
"

46 
	~"sm/shÜe/shÜe_bË.h
"

48 
usšg
 
Çme¥aû
 
	g¡d
;

49 
usšg
 
Çme¥aû
 
	gshÜe
;

52 
ENTER_NAMESPACE
(
dÜa
);

66 şas 
	cdkey_¿nges_m­


68 
	m´iv©e
:

70 
boŞ
 
_i¥Í
;

71 
key_¿nges_m­
* 
	m_rm­
;

72 
sšfo_s
 
	m_sšfo
;

74 
	mpublic
:

79 
dkey_¿nges_m­
(cÚ¡ 
¡id_t
& 
¡id
,

80 cÚ¡ 
cvec_t
& 
mšKeyCV
,

81 cÚ¡ 
cvec_t
& 
maxKeyCV
,

82 cÚ¡ 
ušt
 
numP¬ts
);

83 
dkey_¿nges_m­
(cÚ¡ 
¡id_t
& 
¡id
,
key_¿nges_m­
* 
pkrm
);

84 ~
dkey_¿nges_m­
();

88 
šlše
 
w_rc_t
 
	$g‘_·¹™iÚ
(cÚ¡ 
cvec_t
& 
cvkey
, 
Íid_t
& 
Íid
) {

89 (
_rm­
->
	`g‘P¬t™iÚByUnsüambËdKey
(
_sšfo
,
cvkey
,
Íid
));

92 
w_rc_t
 
	`g‘_®l_·¹™iÚs
(
veùÜ
<
Íid_t
>& 
pidVec
);

96 
w_rc_t
 
	`add_·¹™iÚ
(cÚ¡ 
cvec_t
& 
key
, 
Íid_t
& 
Íid
);

97 
w_rc_t
 
	`d–‘e_·¹™iÚ
(cÚ¡ 
Íid_t
& 
Íid
);

100 
boŞ
 
	`is_§me
(cÚ¡ 
dkey_¿nges_m­
& 
drm
);

102 
´iv©e
:

105 
	`dkey_¿nges_m­
();

107 
	}
};

121 şas 
	c¿ngem­_smt_t
 : 
public
 
th»ad_t


123 
´iv©e
:

125 
ShÜeEnv
* 
_’v
;

126 
bË_desc_t
* 
	m_bË
;

127 
ušt
 
	m_dty³
;

129 
	mpublic
:

131 
dkey_¿nges_m­
* 
_drm
;

132 
w_rc_t
 
	m_rc
;

134 
¿ngem­_smt_t
(
ShÜeEnv
* 
’v
, 
bË_desc_t
* 
bËdesc
, 
ušt
 
dty³
);

135 ~
¿ngem­_smt_t
();

136 
wÜk
();

144 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/dora_env.h

34 #iâdeà
__DORA_ENV_H


35 
	#__DORA_ENV_H


	)

38 
	~<c¡dio
>

40 
	~"s.h
"

41 
	~"ut.h
"

42 
	~"shÜe.h
"

44 
	~"dÜa/¿nge_bË_i.h
"

46 
	~"dÜa/dæush”.h
"

48 
usšg
 
Çme¥aû
 
	gshÜe
;

50 
ENTER_NAMESPACE
(
dÜa
);

69 şas 
	cDÜaEnv


71 
	mpublic
:

73 
¿nge_bË_i
<> 
	tœpTabËIm¶
;

74 
	m¡d
::
	tveùÜ
<
	tœpTabËIm¶
*> 
	tœpTabËPŒVeùÜ
;

75 
	mœpTabËPŒVeùÜ
::
	t™”©Ü
 
	tœpTabËPŒVeùÜIt
;

77 
	m·¹™iÚ_t
<> 
	tœpIm¶
;

78 
	maùiÚ_t
<> 
	tœpAùiÚ
;

79 
	mveùÜ
<
	tba£_aùiÚ_t
*> 
	tba£AùiÚsLi¡
;

81 
	m´Ùeùed
:

85 
ušt
 
_dty³
;

88 
œpTabËPŒVeùÜ
 
	m_œ±p_vec
;

91 
	m_¡¬tšg_ıu
;

92 
	m_ıu_bË_¡•
;

93 
	m_ıu_¿nge
;

96 
ušt_t
 
	m_num_æush”s
;

99 
	m¡d
::
veùÜ
<
dÜa_æush”_t
*> 
_vec_æush”
;

101 
	mpublic
:

103 
DÜaEnv
();

105 
	mvœtu®
 ~
DÜaEnv
();

108 
ušt
 
	$dty³
() const;

109 
boŞ
 
	$is_dÜa
() const;

110 
boŞ
 
	$is_¶p
() const;

116 
šlše
 
œpIm¶
* 
	$decide_·¹
(
œpTabËIm¶
* 
©abË
, cÚ¡ 
aid
) {

117 
cvec_t
 
	`key
((*)&
aid
,());

118 
Íid_t
 
pid
;

119 
w_rc_t
 
r
 = 
©abË
->
	`g‘P¬tIdxByKey
(
key
,
pid
);

120 ià(
r
.
	`is_”rÜ
()è{ 
	`as£¹
(
çl£
);  (
NULL
); }

121  (
©abË
->
	`g‘
(
pid
.
·ge
));

125 
šlše
 
	$’queue_toæush
(
‹rmš®_rvp_t
* 
¬vp
)

127 
	`w_as£¹2
 (
¬vp
);

128 
ušt_t
 
æush”Idx
 = (
¬vp
->
	`xù_id
(è% 
_num_æush”s
);

129 
	`w_as£¹0
 (
_vec_æush”
[
æush”Idx
]);

130 
_vec_æush”
[
æush”Idx
]->
	`’queue_toæush
(
¬vp
);

131 
	}
}

133 
ušt_t
 
d‘”mšeNumFlush”s
();

135 
šlše
 
ušt_t
 
	$g‘NumFlush”s
()

137  (
_num_æush”s
);

138 
	}
}

141 
	g´Ùeùed
:

143 
ušt
 
_check_ty³
();

144 
ušt
 
upd©e_pd
(
ShÜeEnv
* 
³nv
);

146 
_po¡_¡¬t
(
ShÜeEnv
* 
³nv
);

147 
_po¡_¡İ
(
ShÜeEnv
* 
³nv
);

148 
w_rc_t
 
_Ãwrun
(
ShÜeEnv
* 
³nv
);

149 
_dump
(
ShÜeEnv
* 
³nv
);

150 
	$_šfo
(cÚ¡ 
ShÜeEnv
* 
³nv
) const;

151 
	`_¡©i¡ics
(
ShÜeEnv
* 
³nv
);

154 
´oûssÜid_t
 
	`_Ãxt_ıu
(cÚ¡…roûssÜid_t& 
­rd
,

155 cÚ¡ 
œpTabËIm¶
* 
©abË
,

156 cÚ¡ 
¡•
=
DF_CPU_STEP_TABLES
);

158 
	}
};

162 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/dora_error.h

32 #iâdeà
__DORA_ERROR_H


33 
	#__DORA_ERROR_H


	)

35 
	~"ut/Çme¥aû.h
"

37 
ENTER_NAMESPACE
(
dÜa
);

45 
	mde_GEN_WORKER
 = 0x820001,

46 
	mde_GEN_PRIMARY_WORKER
 = 0x820002,

47 
	mde_GEN_STANDBY_POOL
 = 0x820003,

48 
	mde_GEN_PARTITION
 = 0x820004,

49 
	mde_GEN_TABLE
 = 0x820005,

52 
	mde_PROBLEM_ENQUEUE
 = 0x820011,

53 
	mde_WRONG_ACTION
 = 0x820011,

54 
	mde_WRONG_PARTITION
 = 0x820012,

55 
	mde_WRONG_WORKER
 = 0x820013,

57 
	mde_WORKER_ATTACH_XCT
 = 0x820021,

58 
	mde_WORKER_DETACH_XCT
 = 0x820022,

59 
	mde_WORKER_RUN_XCT
 = 0x820023,

60 
	mde_WORKER_RUN_RVP
 = 0x820024,

62 
	mde_INTERMEDIATE_XCT
 = 0x820025,

63 
	mde_TERMINAL_XCT
 = 0x820026,

64 
	mde_NOTIFY_COMMITTED
 = 0x820028,

66 
	mde_INCOMPATIBLE_LOCKS
 = 0x820031,

67 
	mde_WRONG_IDX_DATA
 = 0x820032,

69 
	mde_EARLY_ABORT
 = 0x820041,

70 
	mde_MIDWAY_ABORT
 = 0x820042,

73 
	mde_PLP_NOT_FOUND
 = 0x820051,

74 
	mde_LPID_NOT_FOUND
 = 0x820052,

75 
	mde_PARTID_NOT_FOUND
 = 0x820053

80 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/key.h

31 #iâdeà
__DORA_KEY_H


32 
	#__DORA_KEY_H


	)

34 
	~"k_defšes.h
"

36 
	~<io¡»am
>

37 
	~<s¡»am
>

38 
	~<veùÜ
>

40 
	~"sm/shÜe/shÜe_’v.h
"

43 
ENTER_NAMESPACE
(
dÜa
);

45 
usšg
 
	g¡d
::
veùÜ
;

47 
	g‹m¶©e
<
ty³Çme
 
	gD©aTy³
> 
	gkey_w¿µ”_t
;

48 
	g‹m¶©e
<
ty³Çme
 
	gD©aTy³
> 
	g¡d
::
o¡»am
& 
İ”©Ü
<< (
¡d
::o¡»am& 
os
,

49 cÚ¡ 
	gkey_w¿µ”_t
<
	gD©aTy³
>& 
	grhs
);

53 cÚ¡ 
ušt
 
	gMAX_KEY_SIZE
 = 5;

67 
	g‹m¶©e
<
ty³Çme
 
	gD©aTy³
>

68 
	skey_w¿µ”_t


71 
	m¡d
::
	tveùÜ
<
	tD©aTy³
> 
	tD©aVec
;

72 
ty³Çme
 
	tD©aVec
::
	t™”©Ü
 
	tD©aVecIt
;

73 
ty³Çme
 
	tD©aVec
::
	tcÚ¡_™”©Ü
 
	tD©aVecC™
;

76 
D©aVec
 
	m_key_v
;

79 
key_w¿µ”_t
() { }

82 
key_w¿µ”_t
(cÚ¡ key_w¿µ”_t<
D©aTy³
>& 
rhs
)

86 
cİy_veùÜ
(
rhs
.
_key_v
);

90 
	mkey_w¿µ”_t
<
	mD©aTy³
>& 
	mİ”©Ü
=(cÚ¡ 
key_w¿µ”_t
<
D©aTy³
>& 
rhs
)

93 
cİy_veùÜ
(
rhs
.
_key_v
);

94  (*
	mthis
);

98 ~
key_w¿µ”_t
() { }

101 
šlše
 
push_back
(
D©aTy³
& 
ª™em
) {

102 
	m_key_v
.
push_back
(
ª™em
);

106 
šlše
 
»£rve
(cÚ¡ 
ušt
 
keysz
) {

107 
	m_key_v
.
»£rve
(
keysz
);

113 
šlše
 
cİy
(cÚ¡ 
key_w¿µ”_t
<
D©aTy³
>& 
rhs
) {

114 
cİy_veùÜ
(
rhs
.
_key_v
);

119 
šlše
 
cİy_veùÜ
(cÚ¡ 
D©aVec
& 
aVec
) {

120 
as£¹
 (
_key_v
.
em±y
());

121 
	m_key_v
.
»£rve
(
aVec
.
size
());

122 
	m_key_v
.
assign
(
aVec
.
begš
(),aVec.
’d
());

126 
cvec_t
 
toCVec
() const {

127 
cvec_t
 
	macv
;

128 
ušt
 
	mi
=0; i<
	m_key_v
.
size
(); ++i) {

129 
	macv
.
put
(&
_key_v
[
i
],(
D©aTy³
));

131  (
	macv
);

136 
ušt
 
»adCVec
(cÚ¡ 
cvec_t
& 
acv
) {

138 
»£t
();

141 
ušt
 
	msz
 = 
MAX_KEY_SIZE
 * (
D©aTy³
);

142 * 
	mco
 = (*)
m®loc
(
sz
);

143 
size_t
 
	mbwr™’
 = 
acv
.
cİy_to
(
co
,
sz
);

144 
size_t
 
	mb»ad
 = 0;

147 
ušt
 
	mdŒ—d
 = 0;

148 
	mb»ad
 < 
	mbwr™’
) {

149 
D©aTy³
 
	madt
 = *(D©aTy³*)(
co
[
b»ad
]);

150 
	m_key_v
.
push_back
(
adt
);

153 
	mb»ad
 +ğ(
D©aTy³
);

154 ++
	mdŒ—d
;

156 
ä“
 (
co
);

157  (
	mdŒ—d
);

161 
boŞ
 
	mİ”©Ü
<(cÚ¡ 
	mkey_w¿µ”_t
<
	mD©aTy³
>& 
	mrhs
) const;

162 
boŞ
 
	mİ”©Ü
==(cÚ¡ 
key_w¿µ”_t
<
D©aTy³
>& 
rhs
) const;

163 
boŞ
 
	mİ”©Ü
<=(cÚ¡ 
key_w¿µ”_t
<
D©aTy³
>& 
rhs
) const;

168 
š™
() { }

171 
»£t
() {

172 
	m_key_v
.
”a£
(
_key_v
.
begš
(),_key_v.
’d
());

175 
¡ršg
 
toSŒšg
() {

176 
	m¡d
::
o¡ršg¡»am
 
out
 = 
¡ršg
("");

177 
D©aVecIt
 
	m™
=
_key_v
.
begš
(); it!=_key_v.
’d
(); ++it)

178 
	mout
 << ouˆ<< (*
	m™
) << "|";

179  (
	mout
.
¡r
());

183 
	m‹m¶©e
<
şass
 
	mT
> 
ä›nd
 
	m¡d
::
o¡»am
& 
İ”©Ü
<< (
¡d
::o¡»am& 
os
,

184 cÚ¡ 
	mkey_w¿µ”_t
<
	mT
>& 
	mrhs
);

189 
	g‹m¶©e
<
ty³Çme
 
	gD©aTy³
>

190 
	g¡d
::
o¡»am
& 
İ”©Ü
<< (
¡d
::o¡»am& 
os
,

191 cÚ¡ 
	gkey_w¿µ”_t
<
	gD©aTy³
>& 
	grhs
)

193 
ty³Çme
 
	tkey_w¿µ”_t
<
	tD©aTy³
>::
	tD©aVecC™
 
	tKeyD©aIt
;

194 
KeyD©aIt
 
	g™
 = 
rhs
.
_key_v
.
begš
(); iˆ!ğrhs._key_v.
’d
(); ++it) {

195 
	gos
 << (*
	g™
) << "|";

197  (
	gos
);

217 
	g‹m¶©e
<
ty³Çme
 
	gD©aTy³
>

218 
šlše
 
boŞ
 
	gkey_w¿µ”_t
<
	gD©aTy³
>::
İ”©Ü
<(cÚ¡ 
key_w¿µ”_t
<
D©aTy³
>& 
rhs
) const

220 
as£¹
 (
_key_v
.
size
()<=
rhs
._key_v.size());

221 
ušt
 
	gi
 = 0; i <
	g_key_v
.
size
(); ++i) {

223 ià(
	g_key_v
[
i
]==
rhs
.
_key_v
[i])

225  (
	g_key_v
[
i
]<
	grhs
._key_v[i]);

227  (
	gçl£
);

231 
	g‹m¶©e
<
ty³Çme
 
	gD©aTy³
>

232 
šlše
 
boŞ
 
	gkey_w¿µ”_t
<
	gD©aTy³
>::
İ”©Ü
==(cÚ¡ 
key_w¿µ”_t
<
D©aTy³
>& 
rhs
) const

234 
as£¹
 (
_key_v
.
size
()<=
rhs
._key_v.size());

235 
ušt
 
	gi
=0; i<
	g_key_v
.
size
(); i++) {

237 ià(
	g_key_v
[
i
]==
rhs
.
_key_v
[i])

239  (
	gçl£
);

241  (
	gŒue
);

245 
	g‹m¶©e
<
ty³Çme
 
	gD©aTy³
>

246 
šlše
 
boŞ
 
	gkey_w¿µ”_t
<
	gD©aTy³
>::
İ”©Ü
<=(cÚ¡ 
key_w¿µ”_t
<
D©aTy³
>& 
rhs
) const

248 
as£¹
 (
_key_v
.
size
()<=
rhs
._key_v.size());

249 
ušt
 
	gi
=0; i<
	g_key_v
.
size
(); i++) {

251 ià(
	g_key_v
[
i
]==
rhs
.
_key_v
[i])

253  (
	g_key_v
[
i
]<
	grhs
._key_v[i]);

256  (
	gŒue
);

261 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/lockman.h

31 #iâdeà
__DORA_LOCK_MAN_H


32 
	#__DORA_LOCK_MAN_H


	)

34 
	~<c¡dio
>

35 
	~<m­
>

36 
	~<veùÜ
>

37 
	~<deque
>

39 
	~"ut/¡l_poŞed_®loc.h
"

41 
	~"dÜa/dÜa_”rÜ.h
"

42 
	~"dÜa/logiÿl_lock.h
"

43 
	~"dÜa/aùiÚ.h
"

46 
usšg
 
	g¡d
::
veùÜ
;

48 
ENTER_NAMESPACE
(
dÜa
);

50 
ba£_aùiÚ_t
* 
	tBa£AùiÚPŒ
;

51 
	g¡d
::
	tveùÜ
<
	tba£_aùiÚ_t
*> 
	tBa£AùiÚPŒLi¡
;

52 
	gBa£AùiÚPŒLi¡
::
	t™”©Ü
 
	tBa£AùiÚPŒIt
;

68 
	g‹m¶©e
<
şass
 
	gD©aTy³
>

69 
	slock_mª_t


71 
	mpublic
:

73 
aùiÚ_t
<
	tD©aTy³
> 
	tAùiÚ
;

75 
	mkey_w¿µ”_t
<
	tD©aTy³
> 
	tKey
;

77 
	mKeyLockM­
<
	tD©aTy³
> 
	tKeyLLM­
;

78 
	m¡d
::
	t·œ
<
	tKey
,
	tLogiÿlLock
> 
	tKeyLLPaœ
;

80 
	m¡d
::
	t_Rb_Œ“_node
<
	tKeyLLPaœ
> 
	tKeyLLM­Node
;

82 
	mKALReq_t
<
	tD©aTy³
> 
	tKALReq
;

84 
	m¡d
::
	tveùÜ
<
	tKALReq
> 
	tKALReqVec
;

85 
ty³Çme
 
	tKALReqVec
::
	t™”©Ü
 
	tKALReqIt
;

87 
	m´iv©e
:

90 
gu¬d
<
KeyLLM­
> 
_key_Î_m
;

92 
	mpublic
:

94 
lock_mª_t
(cÚ¡ 
keyE¡im©iÚ
)

96 
_key_Î_m
 = 
Ãw
 
KeyLLM­
(
keyE¡im©iÚ
);

99 ~
lock_mª_t
() { }

105 
šlše
 
boŞ
 
acquœe_®l
(
KALReqVec
& 
ak®rvec
)

107 
boŞ
 
	mbResuÉ
 = 
Œue
;

108 
	mi
=0;

109 
KALReqIt
 
	m™
=
ak®rvec
.
begš
(); it!÷k®rvec.
’d
(); ++it) {

111 ++
	mi
;

112 ià(!
	m_key_Î_m
->
acquœe
(*
™
)) {

130 
TRACE
Ğ
TRACE_TRX_FLOW
, "Cannot‡cquire for (%d)\n",

131 ((*
™
).
tid
()->
g‘_lo
()));

132 
	mbResuÉ
 = 
çl£
;

135 
as£¹
(
i
);

136  (
	mbResuÉ
);

143 
šlše
 
»Ëa£_®l
(
AùiÚ
* 
·ùiÚ
,

144 
Ba£AùiÚPŒLi¡
& 
»adyLi¡
,

145 
Ba£AùiÚPŒLi¡
& 
´omÙedLi¡
)

147 
as£¹
 (
·ùiÚ
);

148 
as£¹
 (
»adyLi¡
.
em±y
(è&& 
´omÙedLi¡
.empty());

149 
TRACE
Ğ
TRACE_TRX_FLOW
, "R–—sšg (%d)\n", 
·ùiÚ
->
tid
().
g‘_lo
());

152 
KALReqIt
 
	m™
=
·ùiÚ
->
»que¡s
()->
begš
(); it!õaùiÚ->»que¡s()->
’d
(); ++it) {

153 
Key
* 
	mpkey
 = (*
™
).
key
();

154 
	m_key_Î_m
->
»Ëa£
(*
pkey
,
·ùiÚ
,
´omÙedLi¡
);

158 
Ba£AùiÚPŒ
 
	m­
 = 
NULL
;

159 
ušt
 
	mi
=0; i<
	m´omÙedLi¡
.
size
(); ++i) {

162 
	m­
 = 
´omÙedLi¡
[
i
];

163 
	m­
->
gÙkeys
(1);

164 ià(
	m­
->
is_»ady
()) {

165 
TRACE
Ğ
TRACE_TRX_FLOW
, "(%d)„eady (%d)\n",

166 
·ùiÚ
->
tid
().
g‘_lo
(), 
­
->tid().get_lo());

167 
	m»adyLi¡
.
push_back
(
­
);

177 
ušt
 
key¡ouched
(ècÚ¡ {  (
	m_key_Î_m
->keystouched()); }

179 
»£t
(è{ 
	m_key_Î_m
->reset(); }

180 
dump
(è{ 
	m_key_Î_m
->dump(); }

182 
boŞ
 
is_ş—n
(
veùÜ
<
xù_t
*>& 
tßbÜt
) {

183  (
	m_key_Î_m
->
is_ş—n
(
tßbÜt
));

189 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/logical_lock.h

32 #iâdeà
__DORA_LOGICAL_LOCK_H


33 
	#__DORA_LOGICAL_LOCK_H


	)

35 
	~<c¡dio
>

36 
	~<m­
>

37 
	~<veùÜ
>

38 
	~<deque
>

40 
	~"ut/¡l_poŞed_®loc.h
"

41 
	~"ut/¡l_block_®loc.h
"

43 
	~"dÜa/commÚ.h
"

44 
	~"dÜa/dÜa_”rÜ.h
"

45 
	~"dÜa/key.h
"

46 
	~"dÜa/ba£_aùiÚ.h
"

49 
usšg
 
	g¡d
::
m­
;

50 
usšg
 
	g¡d
::
muÉim­
;

51 
usšg
 
	g¡d
::
veùÜ
;

52 
usšg
 
	g¡d
::
deque
;

54 
ENTER_NAMESPACE
(
dÜa
);

56 
ba£_aùiÚ_t
* 
	tBa£AùiÚPŒ
;

57 
	g¡d
::
	tveùÜ
<
	tba£_aùiÚ_t
*> 
	tBa£AùiÚPŒLi¡
;

58 
	gBa£AùiÚPŒLi¡
::
	t™”©Ü
 
	tBa£AùiÚPŒIt
;

60 
	gaùiÚLLEÁry
;

61 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
os
, cÚ¡ 
	gaùiÚLLEÁry
& 
	grhs
);

63 
	gLogiÿlLock
;

64 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
os
, 
	gLogiÿlLock
& 
	grhs
);

76 
	sAùiÚLockReq


78 
AùiÚLockReq
()

79 : 
_aùiÚ
(
NULL
)

82 
AùiÚLockReq
(
ba£_aùiÚ_t
* 
aùiÚ
, cÚ¡ 
tid_t
& 
©id
,

83 cÚ¡ 
eDÜaLockMode
 
adlm
 = 
DL_CC_NOLOCK
)

84 : 
_aùiÚ
(
aùiÚ
), 
_tid
(
©id
), 
_dlm
(
adlm
)

87 ~
AùiÚLockReq
()

89 
	m_aùiÚ
 = 
NULL
;

93 
AùiÚLockReq
(cÚ¡ AùiÚLockReq& 
rhs
)

94 : 
_aùiÚ
(
rhs
._aùiÚ), 
_tid
Ôhs._tid), 
_dlm
(rhs._dlm)

97 
	mAùiÚLockReq
& 
	mİ”©Ü
=(cÚ¡ 
AùiÚLockReq
& 
rhs
)

99 
_aùiÚ
 = 
rhs
._action;

100 
	m_tid
 = 
rhs
.
_tid
;

101 
	m_dlm
 = 
rhs
.
_dlm
;

102  (*
	mthis
);

106 
šlše
 
eDÜaLockMode
 
dlm
(è{  (
	m_dlm
); }

107 
šlše
 
ba£_aùiÚ_t
* 
aùiÚ
(è{  (
	m_aùiÚ
); }

108 
šlše
 
tid_t
* 
tid
(è{  (&
	m_tid
); }

110 
šlše
 
boŞ
 
isSame
(cÚ¡ 
AùiÚLockReq
& 
®r
è{  (
	m_tid
=÷Ì.
_tid
); }

113 
ä›nd
 
	m¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
os
, cÚ¡ 
	mAùiÚLockReq
& 
	mrhs
);

116 
	m´Ùeùed
:

119 
ba£_aùiÚ_t
* 
_aùiÚ
;

120 
tid_t
 
	m_tid
;

121 
eDÜaLockMode
 
	m_dlm
;

138 
	g‹m¶©e
<
şass
 
	gD©aTy³
>

139 
	gKALReq_t
 : 
public
 
AùiÚLockReq


141 
key_w¿µ”_t
<
	tD©aTy³
> 
	tKey
;

143 
KALReq_t
(cÚ¡ 
AùiÚLockReq
& 
®r
, 
Key
* 
akey
)

144 : 
AùiÚLockReq
(
®r
), 
_key
(
akey
)

147 
KALReq_t
(
ba£_aùiÚ_t
* 
aùiÚ
, cÚ¡ 
eDÜaLockMode
 
adlm
, 
Key
* 
akey
)

148 : 
AùiÚLockReq
(
aùiÚ
,aùiÚ->
tid
(),
adlm
), 
_key
(
akey
)

150 ~
KALReq_t
() { }

154 
KALReq_t
(cÚ¡ KALReq_t& 
rhs
)

155 : 
AùiÚLockReq
(
rhs
), 
_key
(rhs._key)

158 
	gKALReq_t
& 
	gİ”©Ü
=(cÚ¡ 
KALReq_t
& 
rhs
) {

159 ià(
this
!=&
rhs
) {

160 
AùiÚLockReq
::
İ”©Ü
=(
rhs
);

161 
	g_key
 = 
rhs
.
_key
;

163  (*
	gthis
);

168 
Key
* 
key
(è{  (
	g_key
); }

171 
Key
* 
	g_key
;

191 
	sLogiÿlLock


193 
	m¡d
::
	tveùÜ
<
	tAùiÚLockReq
> 
	tAùiÚLockReqVec
;

194 
	mAùiÚLockReqVec
::
	t™”©Ü
 
	tAùiÚLockReqVecIt
;

195 
	mPoŞedLi¡
<
	tAùiÚLockReq
>::
	tTy³
 
	tAùiÚLockReqLi¡
;

196 
	mAùiÚLockReqLi¡
::
	t™”©Ü
 
	tAùiÚLockReqLi¡It
;

197 
	mAùiÚLockReqLi¡
::
	tcÚ¡_™”©Ü
 
	tAùiÚLockReqLi¡C™
;

203 
LogiÿlLock
(
AùiÚLockReq
& 
ªowÃr
);

204 ~
LogiÿlLock
() { }

207 
eDÜaLockMode
 
dlm
(ècÚ¡ {  (
	m_dlm
); }

208 
	mAùiÚLockReqVec
& 
owÃrs
(è{  (
	m_owÃrs
); }

209 
	mAùiÚLockReqLi¡
& 
wa™”s
(è{  (
	m_wa™”s
); }

215 
boŞ
 
acquœe
(
AùiÚLockReq
& 
®r
);

222 
»Ëa£
(
Ba£AùiÚPŒ
 
ªowÃr
, 
Ba£AùiÚPŒLi¡
& 
´omÙedLi¡
);

227 
boŞ
 
is_ş—n
() const;

228 
boŞ
 
has_owÃrs
(ècÚ¡ {  (!
	m_owÃrs
.
em±y
()); }

229 
boŞ
 
has_wa™”s
(ècÚ¡ {  (!
	m_wa™”s
.
em±y
()); }

232 
abÜt_ªd_»£t
(
veùÜ
<
xù_t
*>& 
tßbÜt
);

234 
	m´iv©e
:

237 
eDÜaLockMode
 
_dlm
;

238 
AùiÚLockReqVec
 
	m_owÃrs
;

239 
AùiÚLockReqLi¡
 
	m_wa™”s
;

242 
boŞ
 
_h—d_ÿn_acquœe
();

245 
boŞ
 
_upd_dlm
();

269 
	#BLOCK_ALLOC_LLMAP


	)

271 cÚ¡ 
	gENTRIES_PER_KEY_LL_MAP
 = 6000;

273 
	g‹m¶©e
<
şass
 
	gD©aTy³
>

274 
	sKeyLockM­


276 
	mpublic
:

278 
key_w¿µ”_t
<
	tD©aTy³
> 
	tKey
;

280 
	m¡d
::
	tveùÜ
<
	tKey
> 
	tKeyLi¡
;

282 
	mKALReq_t
<
	tD©aTy³
> 
	tKALReq
;

284 #ifdeà
BLOCK_ALLOC_LLMAP


285 
ty³Çme
 
	tm­__block_®loc
<
	tKey
,
	tLogiÿlLock
>::
	tTy³
 
	tLLM­
;

287 
ty³Çme
 
	tPoŞedM­
<
	tKey
,
	tLogiÿlLock
>::
	tTy³
 
	tLLM­
;

290 
ty³Çme
 
	tLLM­
::
	t™”©Ü
 
	tLLM­It
;

291 
ty³Çme
 
	tLLM­
::
	tcÚ¡_™”©Ü
 
	tLLM­C™
;

293 
ty³Çme
 
	tLLM­
::
	tv®ue_ty³
 
	tLLM­VT
;

294 #iâdeà
BLOCK_ALLOC_LLMAP


295 
	m_Rb_Œ“_node
<
	tLLM­VT
> 
	tLLM­Node
;

298 
	m´Ùeùed
:

301 
gu¬d
<
LLM­
> 
_Î_m­
;

302 
LLM­It
 
	m_Î_m­_™
;

305 
	mgu¬d
<
	mPoŞ
> 
	m_keyÎ_poŞ
;

308 
	mgu¬d
< 
	mobjeù_ÿche_t
<
	mKey
> > 
	m_key_ÿche
;

310 
	mpublic
:

312 
KeyLockM­
(cÚ¡ 
keyE¡im©iÚ
)

315 
as£¹
 (
keyE¡im©iÚ
);

316 #ifdeà
BLOCK_ALLOC_LLMAP


317 
	m_Î_m­
 = 
Ãw
 
LLM­
;

319 
	m_keyÎ_poŞ
 = 
Ãw
 
PoŞ
((
LLM­Node
), 
keyE¡im©iÚ
);

320 
as£¹
 (
_keyÎ_poŞ
);

321 
	m_Î_m­
 = 
Ãw
 
LLM­
(
¡d
::
Ëss
<
Key
>(),
_keyÎ_poŞ
.
g‘
());

324 
	m_key_ÿche
 = 
Ãw
 
objeù_ÿche_t
<
Key
>();

325 
as£¹
 (
_key_ÿche
);

328 ~
KeyLockM­
()

331 
»£t
();

334 
	m_key_ÿche
.
dÚe
();

336 
	m_Î_m­
.
dÚe
();

337 
	m_keyÎ_poŞ
.
dÚe
();

343 
šlše
 
boŞ
 
acquœe
(
KALReq
& 
ak®r
)

345 
boŞ
 
	mbAcquœe
 = 
çl£
;

348 
	m_Î_m­_™
 = 
_Î_m­
->
low”_bound
(*
ak®r
.
_key
);

350 ià(
	m_Î_m­_™
!=
_Î_m­
->
’d
() &&

351 !(
_Î_m­
->
key_comp
()(*
ak®r
.
_key
,
	m_Î_m­_™
->
	mfœ¡
))) {

354 
	mbAcquœe
 = 
_Î_m­_™
->
£cÚd
.
acquœe
(
ak®r
);

360 
Key
* 
	makey
 = 
_key_ÿche
->
bÜrow
();

361 
	makey
->
cİy
(*
ak®r
.
_key
);

363 
	m_Î_m­
->
š£¹
(
_Î_m­_™
,
LLM­VT
(*
akey
,
ak®r
));

364 
	m_key_ÿche
->
giveback
(
akey
);

365 
	mbAcquœe
 = 
Œue
;

368 ià(
	mbAcquœe
è
	mak®r
.
aùiÚ
()->
gÙkeys
(1);

369  (
	mbAcquœe
);

373 
šlše
 
»Ëa£
(cÚ¡ 
Key
& 
aKey
,

374 
Ba£AùiÚPŒ
 
·ùiÚ
,

375 
Ba£AùiÚPŒLi¡
& 
´omÙedLi¡
)

383 
	m_Î_m­_™
 = 
_Î_m­
->
fšd
(
aKey
);

384 
LogiÿlLock
* 
	mÎ
 = &
_Î_m­_™
->
£cÚd
;

385 
as£¹
 (
Î
);

387 
	mrhs
 = 
Î
->
»Ëa£
(
·ùiÚ
,
´omÙedLi¡
);

389  (
	mrhs
);

396 
ş—r
(è{ 
	m_Î_m­
->clear(); }

399 
»£t
() {

401 
	mveùÜ
<
	mxù_t
*> 
	mtßbÜt
;

402 
LLM­It
 
	m™
=
_Î_m­
->
begš
(); it!=_Î_m­->
’d
(); ++it) {

403 
	m™
->
	m£cÚd
.
abÜt_ªd_»£t
(
tßbÜt
);

406 
	m_Î_m­
->
ş—r
();

410 
ušt
 
key¡ouched
(ècÚ¡ {  (
	m_Î_m­
->
size
()); }

413 
boŞ
 
is_ş—n
(
veùÜ
<
xù_t
*>& 
tßbÜt
) {

415 
boŞ
 
	misCËª
 = 
Œue
;

416 
ušt
 
	mdœtyCouÁ
 = 0;

417 
LLM­It
 
	m™
=
_Î_m­
->
begš
(); it!=_Î_m­->
’d
(); ++it) {

418 ià(!
	m™
->
	m£cÚd
.
is_ş—n
()) {

419 ++
	mdœtyCouÁ
;

422 
	m™
->
	m£cÚd
.
abÜt_ªd_»£t
(
tßbÜt
);

425 ià(
	mdœtyCouÁ
) {

426 
TRACE
Ğ
TRACE_ALWAYS
, "(%dèdœty†ocks\n", 
dœtyCouÁ
);

428  (
	misCËª
);

431 
dump
() {

432 
	msz
 = 
_Î_m­
->
size
();

433 
TRACE
Ğ
TRACE_DEBUG
, "Key (%d)\n", 
sz
);

434 
LLM­It
 
	m™
=
_Î_m­
->
begš
(); it!=_Î_m­->
’d
(); ++it) {

435 
	mcout
 << "K (" << 
	m™
->
	mfœ¡
 << ")\nL\n";

436 
	mcout
 << 
	m™
->
	m£cÚd
 << "\n";

442 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/part_table.h

36 #iâdeà
__DORA_PART_TABLE_H


37 
	#__DORA_PART_TABLE_H


	)

40 
	~<c¡dio
>

42 
	~"ut.h
"

44 
	~"sm/shÜe/shÜe_’v.h
"

45 
	~"sm/shÜe/shÜe_bË.h
"

47 
	~"dÜa/ba£_·¹™iÚ.h
"

49 
usšg
 
Çme¥aû
 
	gshÜe
;

52 
ENTER_NAMESPACE
(
dÜa
);

63 şas 
	c·¹_bË_t


65 
	mpublic
:

67 
m­
<
	tshpid_t
, 
	tba£_·¹™iÚ_t
*> 
	tBa£P¬t™iÚPŒM­
;

68 
	mm­
<
	tshpid_t
, 
	tba£_·¹™iÚ_t
*>::
	t™”©Ü
 
	tBPPM­It
;

69 
	mm­
<
	tshpid_t
, 
	tba£_·¹™iÚ_t
*>::
	tcÚ¡_™”©Ü
 
	tBPPM­CIt
;

71 
	m´Ùeùed
:

73 
ShÜeEnv
* 
_’v
;

74 
bË_desc_t
* 
	m_bË
;

77 
s_lock
 
	m_lock
;

80 
Ba£P¬t™iÚPŒM­
 
	m_bµm­
;

83 
´oûssÜid_t
 
	m_¡¬t_´s_id
;

84 
´oûssÜid_t
 
	m_Ãxt_´s_id
;

85 
ušt
 
	m_´s_¿nge
;

88 
ušt
 
	m_key_e¡im©iÚ
;

90 
	mpublic
:

92 
·¹_bË_t
(
ShÜeEnv
* 
’v
, 
bË_desc_t
* 
±abË
,

93 cÚ¡ 
´oûssÜid_t
 
­rs
,

94 cÚ¡ 
ušt
 
aıu¿nge
,

95 cÚ¡ 
ušt
 
keyE¡im©iÚ
);

97 
	mvœtu®
 ~
·¹_bË_t
();

103 
vœtu®
 
w_rc_t
 
¡İ
();

106 
vœtu®
 
w_rc_t
 
´•¬eNewRun
();

110 
vœtu®
 
w_rc_t
 
g‘P¬tIdxByKey
(cÚ¡ 
cvec_t
& 
cvkey
, 
Íid_t
& 
pid
)=0;

115 
vœtu®
 
w_rc_t
 
»·¹™iÚ
()=0;

120 
vœtu®
 
w_rc_t
 
»£t
();

123 
w_rc_t
 
move
(cÚ¡ 
´oûssÜid_t
 
­rs
, cÚ¡ 
ušt
 
aıu¿nge
);

126 
vœtu®
 
´oûssÜid_t
 
Ãxt_ıu
(cÚ¡…roûssÜid_t& 
­rd
);

128 
bË_desc_t
* 
	$bË
() const;

133 
	$¡©i¡ics
() const;

136 
	$šfo
() const;

139 
	$dump
() const;

143 
	`EXIT_NAMESPACE
(
dÜa
);

	@include/dora/partition.h

31 #iâdeà
__DORA_PARTITION_H


32 
	#__DORA_PARTITION_H


	)

35 
	~"dÜa/ba£_·¹™iÚ.h
"

37 
	~"sm/shÜe/¤mwqueue.h
"

39 
	~"dÜa/lockmª.h
"

40 
	~"dÜa/wÜk”.h
"

42 
	~"sm/shÜe/shÜe_h–³r_lßd”.h
"

45 
usšg
 
Çme¥aû
 
	gshÜe
;

48 
ENTER_NAMESPACE
(
dÜa
);

50 cÚ¡ 
	gACTIONS_PER_INPUT_QUEUE_POOL_SZ
 = 60;

51 cÚ¡ 
	gACTIONS_PER_COMMIT_QUEUE_POOL_SZ
 = 60;

62 
	g‹m¶©e
 <
şass
 
	gD©aTy³
>

63 şas 
	c·¹™iÚ_t
 : 
public
 
ba£_·¹™iÚ_t


65 
public
:

67 
aùiÚ_t
<
	tD©aTy³
> 
	tAùiÚ
;

68 
dÜa_wÜk”_t
 
	tWÜk”
;

69 
	m¤mwqueue
<
	tAùiÚ
> 
	tQueue
;

70 
	mkey_w¿µ”_t
<
	tD©aTy³
> 
	tKey
;

71 
	mlock_mª_t
<
	tD©aTy³
> 
	tLockMªag”
;

73 
	mKALReq_t
<
	tD©aTy³
> 
	tKALReq
;

74 
	m¡d
::
	tveùÜ
<
	tKALReq
> 
	tKALReqVec
;

77 
	m´Ùeùed
:

80 
WÜk”
* 
_owÃr
;

83 
	mgu¬d
<
	mLockMªag”
> 
	m_¶m
;

110 
	mgu¬d
<
	mQueue
> 
	m_šput_queue
;

114 
	mgu¬d
<
	mQueue
> 
	m_comm™‹d_queue
;

117 
	mgu¬d
<
	mPoŞ
> 
	m_aùiÚ±r_šput_poŞ
;

118 
	mgu¬d
<
	mPoŞ
> 
	m_aùiÚ±r_comm™_poŞ
;

123 
	mpublic
:

125 
·¹™iÚ_t
(
ShÜeEnv
* 
’v
, 
bË_desc_t
* 
±abË
,

126 cÚ¡ 
ušt
 
­¬tid
,

127 cÚ¡ 
´oûssÜid_t
 
­rsid
,

128 cÚ¡ 
ušt
 
keyE¡im©iÚ
);

130 
	mvœtu®
 ~
	$·¹™iÚ_t
()

132 
_šput_queue
.
	`dÚe
();

133 
_aùiÚ±r_šput_poŞ
.
	`dÚe
();

135 
_comm™‹d_queue
.
	`dÚe
();

136 
_aùiÚ±r_comm™_poŞ
.
	`dÚe
();

140 
šlše
 
LockMªag”
* 
	$¶m
(è{  (
_¶m
); 
	}
}

143 
WÜk”
* 
	$owÃr
(è{  (
_owÃr
); 
	}
}

149 
šlše
 
	$»Ëa£
(
AùiÚ
* 
aùiÚ
,

150 
Ba£AùiÚPŒLi¡
& 
»adyLi¡
,

151 
Ba£AùiÚPŒLi¡
& 
´omÙedLi¡
)

153  (
_¶m
->
	`»Ëa£_®l
(
aùiÚ
,
»adyLi¡
,
´omÙedLi¡
));

154 
	}
}

156 
šlše
 
boŞ
 
	$acquœe
(
KALReqVec
& 
ak®vec
)

158  (
_¶m
->
	`acquœe_®l
(
ak®vec
));

159 
	}
}

166 
vœtu®
 
boŞ
 
	$v”ify
(
AùiÚ
& )

170 
	`w_as£¹1
(
çl£
);

171  (
Œue
);

172 
	}
}

176 
’queue
(
AùiÚ
* 
pAùiÚ
, cÚ¡ 
boŞ
 
bWake
);

177 
vœtu®
 
ba£_aùiÚ_t
* 
dequeue
();

178 
šlše
 
	$has_šput
() const {

179  (!
_šput_queue
->
	`is_em±y
());

180 
	}
}

181 
boŞ
 
	$is_šput_owÃr
(
ba£_wÜk”_t
* 
awÜk”
) {

182  (
_šput_queue
->
	`is_cÚŒŞ
(
awÜk”
));

183 
	}
}

186 
’queue_comm™
(
AùiÚ
* 
­a
, cÚ¡ 
boŞ
 
bWake
=
Œue
);

187 
vœtu®
 
ba£_aùiÚ_t
* 
dequeue_comm™
();

188 
šlše
 
	$has_comm™‹d
() const {

189  (!
_comm™‹d_queue
->
	`is_em±y
());

190 
	}
}

191 
boŞ
 
	$is_comm™‹d_owÃr
(
ba£_wÜk”_t
* 
awÜk”
) {

192  (
_comm™‹d_queue
->
	`is_cÚŒŞ
(
awÜk”
));

193 
	}
}

197 
vœtu®
 
»£t
(cÚ¡ 
´oûssÜid_t
 
­rsid
 = 
PBIND_NONE
);

200 
vœtu®
 
abÜt_®l_’queued
();

203 
vœtu®
 
¡İ
();

206 
vœtu®
 
w_rc_t
 
´•¬eNewRun
();

209 
vœtu®
 
¡©i¡ics
(
wÜk”_¡©s_t
& 
g©h”
);

211 
vœtu®
 
dump
();

213 
¡lsize
(
ušt
& 
g©h”
);

215 
	g´iv©e
:

218 
_¡¬t_owÃr
();

219 
_¡İ_th»ads
();

220 
_g’”©e_´im¬y
();

221 
WÜk”
* 
_g’”©e_wÜk”
(cÚ¡ 
´oûssÜid_t
 
­rsid
, 
c_¡r
 
wÇme
, cÚ¡ 
u£_¦i
);

223 
	g´Ùeùed
:

225 
isF»e
(
Key
 
akey
, 
eDÜaLockMode
 
lmode
);

239 
	g‹m¶©e
 <
şass
 
	gD©aTy³
>

240 
	g·¹™iÚ_t
<
	gD©aTy³
>::
	$·¹™iÚ_t
(
ShÜeEnv
* 
’v
, 
bË_desc_t
* 
±abË
,

241 cÚ¡ 
ušt
 
­¬tid
,

242 cÚ¡ 
´oûssÜid_t
 
­rsid
,

243 cÚ¡ 
ušt
 
keyE¡im©iÚ
)

244 : 
	`ba£_·¹™iÚ_t
(
’v
,
±abË
,
­¬tid
,
­rsid
),

245 
	$_owÃr
(
NULL
)

247 
_¶m
 = 
Ãw
 
	`LockMªag”
(
keyE¡im©iÚ
);

249 
_aùiÚ±r_šput_poŞ
 = 
Ãw
 
	`PoŞ
((
AùiÚ
*),
ACTIONS_PER_INPUT_QUEUE_POOL_SZ
);

250 
_šput_queue
 = 
Ãw
 
	`Queue
(
_aùiÚ±r_šput_poŞ
.
	`g‘
());

252 
_aùiÚ±r_comm™_poŞ
 = 
Ãw
 
	`PoŞ
((
AùiÚ
*),
ACTIONS_PER_COMMIT_QUEUE_POOL_SZ
);

253 
_comm™‹d_queue
 = 
Ãw
 
	`Queue
(
_aùiÚ±r_comm™_poŞ
.
	`g‘
());

254 
	}
}

268 
	g‹m¶©e
 <
şass
 
	gD©aTy³
>

269 
	g·¹™iÚ_t
<
	gD©aTy³
>::
	$’queue
(
AùiÚ
* 
pAùiÚ
, cÚ¡ 
boŞ
 
bWake
)

272 ià(!
	`v”ify
(*
pAùiÚ
))

274 
	`TRACE
Ğ
TRACE_DEBUG
, "Tryoƒnqueueohe wrong…artition...\n");

275  (
de_WRONG_PARTITION
);

279 #ifdeà
WORKER_VERBOSE_STATS


280 
pAùiÚ
->
	`m¬k_’queue
();

283 
pAùiÚ
->
	`£t_·¹™iÚ
(
this
);

284 
_šput_queue
->
	`push
(
pAùiÚ
,
bWake
);

286 
	}
}

298 
	g‹m¶©e
 <
şass
 
	gD©aTy³
>

299 
šlše
 
ba£_aùiÚ_t
* 
	g·¹™iÚ_t
<
	gD©aTy³
>::
	$dequeue
()

301  (
_šput_queue
->
	`pİ
());

302 
	}
}

315 
	g‹m¶©e
 <
şass
 
	gD©aTy³
>

316 
	g·¹™iÚ_t
<
	gD©aTy³
>::
	$’queue_comm™
(
AùiÚ
* 
pAùiÚ
, cÚ¡ 
boŞ
 
bWake
)

318 
	`w_as£¹1
(
pAùiÚ
->
	`g‘_·¹™iÚ
()==
this
);

319 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Enq committed (%d)o (%s-%d)\n",

320 
pAùiÚ
->
	`tid
().
	`g‘_lo
(), 
_bË
->
	`Çme
(), 
_·¹_id
);

321 
_comm™‹d_queue
->
	`push
(
pAùiÚ
,
bWake
);

323 
	}
}

335 
	g‹m¶©e
 <
şass
 
	gD©aTy³
>

336 
šlše
 
ba£_aùiÚ_t
* 
	g·¹™iÚ_t
<
	gD©aTy³
>::
	$dequeue_comm™
()

338 
	`w_as£¹2
 (
nÙ
 
_comm™‹d_queue
->
	`is_»®ly_em±y
());

339  (
_comm™‹d_queue
->
	`pİ
());

340 
	}
}

354 
	g‹m¶©e
 <
şass
 
	gD©aTy³
>

355 
	g·¹™iÚ_t
<
	gD©aTy³
>::
	$¡İ
()

358 
	`_¡İ_th»ads
();

361 
_šput_queue
->
	`ş—r
();

362 
_comm™‹d_queue
->
	`ş—r
();

365 
_¶m
->
	`»£t
();

366 
	}
}

384 
	g‹m¶©e
 <
şass
 
	gD©aTy³
>

385 
	g·¹™iÚ_t
<
	gD©aTy³
>::
	$»£t
(cÚ¡ 
´oûssÜid_t
 
­rsid
)

387 
	`TRACE
Ğ
TRACE_DEBUG
, "part (%s-%d) - cpu (%d)\n",

388 
_bË
->
	`Çme
(), 
_·¹_id
, 
­rsid
);

391 
	`_¡İ_th»ads
();

394 
_šput_queue
->
	`ş—r
();

395 
_comm™‹d_queue
->
	`ş—r
();

398 
_¶m
->
	`»£t
();

402 
	`CRITICAL_SECTION
(
owÃr_cs
, 
_owÃr_lock
);

404 
_´s_id
 = 
­rsid
;

407 ià(
	`_g’”©e_´im¬y
())

409 
	`TRACE
 (
TRACE_ALWAYS
,

411 
_bË
->
	`Çme
(), 
_·¹_id
);

412 
	`w_as£¹0
(
çl£
);

413  (
de_GEN_PRIMARY_WORKER
);

417 
	`_¡¬t_owÃr
();

419 
	}
}

433 
	g‹m¶©e
 <
şass
 
	gD©aTy³
>

434 
w_rc_t
 
	g·¹™iÚ_t
<
	gD©aTy³
>::
	$´•¬eNewRun
()

438 
	`as£¹
 (
_owÃr
);

439 !
_owÃr
->
	`is_¦“pšg
()) {

441 
	`TRACE
Ğ
TRACE_ALWAYS
, "Waiting for (%s-%d)o sleep\n",

442 
_bË
->
	`Çme
(), 
_·¹_id
);

443 
ušt
 
HALF_MILLION
 = 500000;

444 
	`u¦“p
(
HALF_MILLION
);

453 !
_comm™‹d_queue
->
	`is_»®ly_em±y
()) {

454 
	`TRACE
Ğ
TRACE_ALWAYS
, "CommittedQueue of (%s-%d)‚otƒmpty\n");

455 
_owÃr
->
	`doRecov”y
();

457 
_comm™‹d_queue
->
	`ş—r
(
çl£
);

459 !
_šput_queue
->
	`is_»®ly_em±y
()) {

460 
	`TRACE
Ğ
TRACE_ALWAYS
, "InputQueue of (%s-%d)‚otƒmpty\n");

461 
_owÃr
->
	`doRecov”y
();

463 
_šput_queue
->
	`ş—r
(
çl£
);

473 
veùÜ
<
xù_t
*> 
tßbÜt
;

474 
_¶m
->
	`is_ş—n
(
tßbÜt
);

475 ià(!
tßbÜt
.
	`em±y
()) {

477 
abÜt_smt_t
* 
asmt
 = 
Ãw
 
	`abÜt_smt_t
(
	`c_¡r
(
_bË
->
	`Çme
()),
_’v
,
tßbÜt
);

478 
	`as£¹
(
asmt
);

479 
asmt
->
	`fÜk
();

480 
asmt
->
	`još
();

481 
ušt
 
abÜ‹d
 = 
asmt
->
_abÜ‹d
;

482 
	`TRACE
Ğ
TRACE_ALWAYS
, "(%dèxù abÜ‹d\n", 
abÜ‹d
);

483 
	`d–‘e
(
asmt
);

484 
asmt
 = 
NULL
;

490 ià(
_¶m
->
	`key¡ouched
(è> 
D_MIN_KEYS_TOUCHED
) {

491 
	`TRACE
Ğ
TRACE_DEBUG
, "Cleaning LockMap (%s-%d) with (%d) keys\n",

492 
_bË
->
	`Çme
(), 
_·¹_id
, 
_¶m
->
	`key¡ouched
());

493 
_¶m
->
	`»£t
();

499  (
RCOK
);

500 
	}
}

513 
	g‹m¶©e
 <
şass
 
	gD©aTy³
>

514 
	g·¹™iÚ_t
<
	gD©aTy³
>::
	$_¡¬t_owÃr
()

516 
	`as£¹
 (
_owÃr
);

517 
_owÃr
->
	`¡¬t
();

519 
	}
}

530 
	g‹m¶©e
 <
şass
 
	gD©aTy³
>

531 
	g·¹™iÚ_t
<
	gD©aTy³
>::
	$_¡İ_th»ads
()

533 
i
 = 0;

536 
	`CRITICAL_SECTION
(
owÃr_cs
, 
_owÃr_lock
);

537 ià(
_owÃr
) {

538 
_owÃr
->
	`¡İ
();

539 
_owÃr
->
	`još
();

540 
	`d–‘e
 (
_owÃr
);

541 ++
i
;

543 
_owÃr
 = 
NULL
;

546 
_šput_queue
->
	`£tqueue
(
WS_UNDEF
,
NULL
,0,0);

547 
_comm™‹d_queue
->
	`£tqueue
(
WS_UNDEF
,
NULL
,0,0);

550 
	}
}

567 
	g‹m¶©e
 <
şass
 
	gD©aTy³
>

568 
	g·¹™iÚ_t
<
	gD©aTy³
>::
	$_g’”©e_´im¬y
()

570 
	`w_as£¹1
(
_owÃr
==
NULL
);

572 
’vV¬
* 
³
 =ƒnvV¬::
	`š¡ªû
();

574 
u£_¦i
 = 
³
->
	`g‘V¬IÁ
("db-worker-sli",0);

576 
WÜk”
* 
pwÜk”
 = 
	`_g’”©e_wÜk”
(
_´s_id
,

577 
	`c_¡r
("%s-P-%d-PRI",
_bË
->
	`Çme
(), 
_·¹_id
),

578 
u£_¦i
);

579 ià(!
pwÜk”
) {

580 
	`TRACE
Ğ
TRACE_ALWAYS
, "Problem generating workerhread\n");

581  (
de_GEN_WORKER
);

584 
_owÃr
 = 
pwÜk”
;

585 
_owÃr
->
	`£t_d©a_owÃr_¡©e
(
DOS_ALONE
);

587 
lc
 = 
³
->
	`g‘V¬IÁ
("db-worker-queueloops",0);

588 
th»s_šp_q
 = 
³
->
	`g‘V¬IÁ
("dora-worker-inp-q-sz",0);

589 
th»s_com_q
 = 
³
->
	`g‘V¬IÁ
("dora-worker-com-q-sz",0);

592 
b©ch_sz
 = 
³
->
	`g‘V¬IÁ
("db-cl-batchsz",0);

593 ià(
b©ch_sz
 < 
th»s_šp_q
)hres_inp_q = batch_sz;

594 ià(
b©ch_sz
 < 
th»s_com_q
)hres_com_q = batch_sz;

597 
_šput_queue
->
	`£tqueue
(
WS_INPUT_Q
,
_owÃr
,
lc
,
th»s_šp_q
);

598 
_comm™‹d_queue
->
	`£tqueue
(
WS_COMMIT_Q
,
_owÃr
,
lc
,
th»s_com_q
);

600 
_owÃr
->
	`fÜk
();

602 
	}
}

615 
	g‹m¶©e
 <
şass
 
	gD©aTy³
>

616 
dÜa_wÜk”_t
* 
	g·¹™iÚ_t
<
	gD©aTy³
>::
	$_g’”©e_wÜk”
(cÚ¡ 
´oûssÜid_t
 
´sid
,

617 
c_¡r
 
¡ºame
,

618 cÚ¡ 
u£_¦i
)

622 
WÜk”
* 
pwÜk”
 = 
Ãw
 
	`WÜk”
(
_’v
, 
this
, 
¡ºame
, 
´sid
, 
u£_¦i
);

623  (
pwÜk”
);

624 
	}
}

635 
	g‹m¶©e
 <
şass
 
	gD©aTy³
>

636 
	g·¹™iÚ_t
<
	gD©aTy³
>::
	$abÜt_®l_’queued
()

639 
AùiÚ
* 
·
;

640 
»qs_»ad
 = 0;

641 
»qs_wr™e
 = 0;

642 
»qs_abt
 = 0;

644 
	`as£¹
 (
_owÃr
);

647 
_šput_queue
->
_»ad_pos
 !ğ_šput_queue->
_fÜ_»ad”s
->
	`’d
()) {

648 
·
 = *(
_šput_queue
->
_»ad_pos
++);

649 ++
»qs_»ad
;

650 ià(
_owÃr
->
	`abÜt_Úe_Œx
(
·
->
	`xù
()))

651 ++
»qs_abt
;

656 
	`CRITICAL_SECTION
(
q_cs
, 
_šput_queue
->
_lock
);

657 
_šput_queue
->
_»ad_pos
 = _šput_queue->
_fÜ_wr™”s
->
	`begš
();

658 
_šput_queue
->
_»ad_pos
 !ğ_šput_queue->
_fÜ_wr™”s
->
	`’d
();

659 
_šput_queue
->
_»ad_pos
++)

661 
·
 = *(
_šput_queue
->
_»ad_pos
);

662 ++
»qs_wr™e
;

663 ià(
_owÃr
->
	`abÜt_Úe_Œx
(
·
->
	`xù
()))

664 ++
»qs_abt
;

668 ià((
»qs_»ad
 + 
»qs_wr™e
) > 0) {

669 
	`TRACE
Ğ
TRACE_ALWAYS
, "(%d)‡borted before stopping. (%d) (%d)\n",

670 
»qs_abt
, 
»qs_»ad
, 
»qs_wr™e
);

672  (
»qs_abt
);

673 
	}
}

683 
	g‹m¶©e
 <
şass
 
	gD©aTy³
>

684 
	g·¹™iÚ_t
<
	gD©aTy³
>::
	$¡©i¡ics
(
wÜk”_¡©s_t
& 
g©h”
)

686 ià(
_owÃr
) {

687 
g©h”
 +ğ
_owÃr
->
	`g‘_¡©s
();

688 
_owÃr
->
	`»£t_¡©s
();

690 
	}
}

701 
	g‹m¶©e
 <
şass
 
	gD©aTy³
>

702 
	g·¹™iÚ_t
<
	gD©aTy³
>::
	$¡lsize
(
ušt
& 
g©h”
)

704 
	`as£¹
 (
_¶m
);

705 
g©h”
 +ğ
_¶m
->
	`key¡ouched
();

706 
	}
}

716 
	g‹m¶©e
 <
şass
 
	gD©aTy³
>

717 
	g·¹™iÚ_t
<
	gD©aTy³
>::
	$dump
()

719 
ba£_·¹™iÚ_t
::
	`dump
();

720 
_¶m
->
	`dump
();

721 
	}
}

724 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/range_action.h

32 #iâdeà
__DORA_RANGE_ACTION_H


33 
	#__DORA_RANGE_ACTION_H


	)

36 
	~"dÜa/aùiÚ.h
"

38 
usšg
 
Çme¥aû
 
	gshÜe
;

40 
ENTER_NAMESPACE
(
dÜa
);

55 
	g‹m¶©e
 <
şass
 
	gD©aTy³
>

56 
şass
 
	g¿nge_aùiÚ_im¶
 : 
public
 
aùiÚ_t
<
D©aTy³
>

58 
public
:

59 
key_w¿µ”_t
<
	tD©aTy³
> 
	tKey
;

60 
	gaùiÚ_t
<
	tD©aTy³
> 
	tAùiÚ
;

61 
	gKALReq_t
<
	tD©aTy³
> 
	tKALReq
;

63 
	g´Ùeùed
:

66 
boŞ
 
_isRªge
;

67 
£t_is_¿nge
(è{ 
	g_isRªge
 = 
Œue
; }

69 
Key
 
	g_down
;

70 
	gveùÜ
<
	gKey
> 
	g_key_li¡
;

72 
šlše
 
_¿nge_aù_£t
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, 
rvp_t
* 
´vp
,

73 cÚ¡ 
keyËn
)

77 
	gAùiÚ
::
_aù_£t
(
axù
,
©id
,
´vp
,2);

78 
as£¹
 (
keyËn
);

79 
	g_down
.
»£rve
(
keyËn
);

82 
	gpublic
:

86 
¿nge_aùiÚ_im¶
()

87 : 
AùiÚ
(), 
_isRªge
(
çl£
)

90 
¿nge_aùiÚ_im¶
(cÚ¡„ªge_aùiÚ_im¶& 
rhs
)

91 : 
AùiÚ
(
rhs
), 
_isRªge
(rhs._isRange),

92 
_down
(
rhs
._down), 
_key_li¡
(rhs._key_list)

93 { 
as£¹
 (0); }

95 
	g¿nge_aùiÚ_im¶
 &
	gİ”©Ü
=(cÚ¡ 
¿nge_aùiÚ_im¶
& 
rhs
)

97 ià(
this
 !ğ&
rhs
) {

98 
as£¹
 (0);

99 
	gAùiÚ
::
İ”©Ü
=(
rhs
);

100 
	g_isRªge
 = 
rhs
.
_isRªge
;

101 
	g_down
 = 
rhs
.
_down
;

102 
	g_key_li¡
 = 
rhs
.
_key_li¡
;

104  (*
	gthis
);

107 
	gvœtu®
 ~
¿nge_aùiÚ_im¶
() { }

111 
vœtu®
 
ÿlc_keys
()=0;

113 
vœtu®
 
w_rc_t
 
Œx_exec
()=0;

123 
vœtu®
 
Œx_upd_keys
()

125 ià(
	gba£_aùiÚ_t
::
¬e_keys_£t
())  (1);

128 
ÿlc_keys
();

130 
eDÜaLockMode
 
	g»q_lm
 = 
DL_CC_EXCL
;

131 ià(
	gba£_aùiÚ_t
::
is_»ad_Úly
()è
»q_lm
 = 
DL_CC_SHARED
;

133 ià(
	g_isRªge
) {

145 
ušt
 
	g¿nge
 = 
_key_li¡
.
size
();

146 
	gba£_aùiÚ_t
::
£tkeys
(
¿nge
);

147 
ušt
 
	gi
=0; i<
	g¿nge
; i++) {

148 
KALReq
 
akr
(
this
,
»q_lm
,&
_key_li¡
[
i
]);

149 
	gAùiÚ
::
_»que¡s
.
push_back
(
akr
);

151 
	gba£_aùiÚ_t
::
keys_£t
(
¿nge
);

155 
	gAùiÚ
::
_keys
.
push_back
(&
_down
);

156 
	gba£_aùiÚ_t
::
£tkeys
(1);

157 
KALReq
 
akr
(
this
,
»q_lm
,&
_down
);

158 
	gAùiÚ
::
_»que¡s
.
push_back
(
akr
);

159 
	gba£_aùiÚ_t
::
keys_£t
(
Œue
);

164 
vœtu®
 
giveback
()=0;

166 
vœtu®
 
š™
() { }

168 
vœtu®
 
»£t
()

170 
	gAùiÚ
::
»£t
();

173 
	g_down
.
»£t
();

174 
	g_key_li¡
.
ş—r
();

181 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/range_part_table.h

34 #iâdeà
__DORA_RANGE_PART_TABLE_H


35 
	#__DORA_RANGE_PART_TABLE_H


	)

37 
	~"dÜa/dkey_¿nges_m­.h
"

39 
	~"dÜa/·¹_bË.h
"

40 
	~"dÜa/ba£_·¹™iÚ.h
"

43 
usšg
 
Çme¥aû
 
	gshÜe
;

45 
ENTER_NAMESPACE
(
dÜa
);

56 şas 
	c¿nge_bË_t
 : 
public
 
·¹_bË_t


58 
public
:

60 
·¹_bË_t
 
	tP¬tTabË
;

62 
	m´Ùeùed
:

65 
ušt
 
_dty³
;

68 
	mgu¬d
<
	mdkey_¿nges_m­
> 
	m_´M­
;

70 
	mpublic
:

72 
¿nge_bË_t
(
ShÜeEnv
* 
’v
, 
bË_desc_t
* 
±abË
, cÚ¡ 
ušt
 
dty³
,

73 cÚ¡ 
´oûssÜid_t
 
­rs
,

74 cÚ¡ 
ušt
 
aıu¿nge
,

75 cÚ¡ 
ušt
 
keyE¡im©iÚ
);

77 ~
¿nge_bË_t
();

79 
vœtu®
 
w_rc_t
 
ü—‹_Úe_·¹
(cÚ¡ 
shpid_t
& 
pid
, 
ba£_·¹™iÚ_t
*& 
abp
);

85 
šlše
 
w_rc_t
 
	$g‘P¬tIdxByKey
(cÚ¡ 
cvec_t
& 
cvkey
, 
Íid_t
& 
pid
) {

86  (
_´M­
->
	`g‘_·¹™iÚ
(
cvkey
,
pid
));

92 
w_rc_t
 
	`»·¹™iÚ
();

94 
´iv©e
:

96 
w_rc_t
 
	`_g‘_upd©ed_m­
(
dkey_¿nges_m­
*& 
drm
);

98 
´Ùeùed
:

100 
vœtu®
 
w_rc_t
 
	`_ü—‹_Úe_·¹
(cÚ¡ 
shpid_t
& 
pid
, 
ba£_·¹™iÚ_t
*& 
abp
)=0;

102 
	}
};

105 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/range_table_i.h

34 #iâdeà
__DORA_RANGE_TABLE_I_H


35 
	#__DORA_RANGE_TABLE_I_H


	)

37 
	~"dÜa/key.h
"

38 
	~"dÜa/·¹™iÚ.h
"

39 
	~"dÜa/aùiÚ.h
"

40 
	~"dÜa/¿nge_·¹_bË.h
"

42 
usšg
 
Çme¥aû
 
	gshÜe
;

45 
ENTER_NAMESPACE
(
dÜa
);

56 
	g‹m¶©e
 <
şass
 
	gD©aTy³
>

57 şas 
	c¿nge_bË_i
 : 
public
 
¿nge_bË_t


59 
public
:

61 
key_w¿µ”_t
<
	tD©aTy³
> 
	tDKey
;

62 
	maùiÚ_t
<
	tD©aTy³
> 
	tAùiÚ
;

63 
	m·¹™iÚ_t
<
	tD©aTy³
> 
	t½Im¶
;

65 
	mm­
< 
	tshpid_t
, 
	t·¹™iÚ_t
<
	tD©aTy³
>* > 
	t½Im¶PŒM­
;

67 
	m´Ùeùed
:

70 
½Im¶PŒM­
 
_pm­
;

72 
	mpublic
:

74 
	$¿nge_bË_i
(
ShÜeEnv
* 
’v
, 
bË_desc_t
* 
±abË
, cÚ¡ 
ušt
 
dty³
,

75 cÚ¡ 
´oûssÜid_t
 
­rs
,

76 cÚ¡ 
ušt
 
aıu¿nge
,

77 cÚ¡ 
ušt
 
keyE¡im©iÚ
)

78 : 
	$¿nge_bË_t
(
’v
,
±abË
,
dty³
,
­rs
,
aıu¿nge
,
keyE¡im©iÚ
)

82 ~
	$¿nge_bË_i
(è{ 
	}
}

84 
½Im¶
* 
	$g‘
(cÚ¡ 
shpid_t
& 
pid
è{  (
_pm­
[pid]); 
	}
}

86 
	g´Ùeùed
:

88 
w_rc_t
 
_ü—‹_Úe_·¹
(cÚ¡ 
shpid_t
& 
pid
, 
ba£_·¹™iÚ_t
*& 
abp
);

104 
	g‹m¶©e
 <
şass
 
	gD©aTy³
>

105 
w_rc_t
 
	g¿nge_bË_i
<
	gD©aTy³
>::
	$_ü—‹_Úe_·¹
(cÚ¡ 
shpid_t
& 
pid
,

106 
ba£_·¹™iÚ_t
*& 
abp
)

109 
½Im¶
* 
´p
 = 
Ãw
 
	`½Im¶
(
P¬tTabË
::
_’v
, P¬tTabË::
_bË
, 
pid
,

110 
P¬tTabË
::
_Ãxt_´s_id
,

111 
P¬tTabË
::
_key_e¡im©iÚ
);

112 ià(!
´p
) {

113 
	`TRACE
Ğ
TRACE_ALWAYS
, "ProbËm iÀü—tšg…¬t™iÚ (%d)\n", 
pid
);

114  (
	`RC
(
de_GEN_PARTITION
));

118 
abp
 = 
´p
;

121 
_pm­
[
pid
] = 
´p
;

124 
´p
->
	`»£t
();

125  (
RCOK
);

126 
	}
}

128 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/rvp.h

32 #iâdeà
__DORA_RVP_H


33 
	#__DORA_RVP_H


	)

36 
	~"sm/shÜe/shÜe_»qs.h
"

37 
	~"sm/shÜe/shÜe_’v.h
"

38 
	~"sm/shÜe/shÜe_Œx_wÜk”.h
"

40 
	~"ut/couÁdown.h
"

42 
	~"dÜa/commÚ.h
"

43 
	~"dÜa/ba£_aùiÚ.h
"

45 
usšg
 
Çme¥aû
 
	gshÜe
;

47 
ENTER_NAMESPACE
(
dÜa
);

49 
şass
 
	gDÜaEnv
;

63 
	grvp_t
 : 
public
 
ba£_»que¡_t


65 
public
:

68 
¡d
::
	tveùÜ
<
	tdÜa
::
	tba£_aùiÚ_t
*> 
	tba£AùiÚsLi¡
;

69 
	gba£AùiÚsLi¡
::
	t™”©Ü
 
	tba£AùiÚsIt
;

71 
	g´Ùeùed
:

74 
couÁdown_t
 
_couÁdown
;

75 
ushÜt_t
 vŞ©
	g_decisiÚ
;

78 
ba£AùiÚsLi¡
 
	g_aùiÚs
;

79 
s_lock
 
	g_aùiÚs_lock
;

81 
_£t
(
xù_t
* 
pxù
, cÚ¡ 
tid_t
& 
©id
, cÚ¡ 
axùid
,

82 cÚ¡ 
Œx_»suÉ_tu¶e_t
& 
´esuÉ
,

83 cÚ¡ 
ušt
 
šŒa_Œx_út
, cÚ¡ ušˆ
tÙ®_aùiÚs
)

85 
	gba£_»que¡_t
::
£t
(
pxù
,
©id
,
axùid
,
´esuÉ
);

87 
as£¹
 (
pxù
);

88 
as£¹
 (
tÙ®_aùiÚs
>=
šŒa_Œx_út
);

89 
	g_couÁdown
.
»£t
(
šŒa_Œx_út
);

90 
	g_decisiÚ
 = 
AD_UNDECIDED
;

91 
	g_aùiÚs
.
»£rve
(
tÙ®_aùiÚs
);

94 
	gpublic
:

96 
rvp_t
();

98 
rvp_t
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, cÚ¡ 
axùid
,

99 cÚ¡ 
Œx_»suÉ_tu¶e_t
& 
´esuÉ
,

100 cÚ¡ 
ušt
 
šŒa_Œx_út
, cÚ¡ ušˆ
tÙ®_aùiÚs
);

102 
	gvœtu®
 ~
rvp_t
() { }

105 
rvp_t
(cÚ¡„vp_t& 
rhs
);

106 
	grvp_t
& 
	gİ”©Ü
=(cÚ¡ 
rvp_t
& 
rhs
);

108 
Œx_»suÉ_tu¶e_t
 
»suÉ
(è{  (
	g_»suÉ
); }

111 
cİy_aùiÚs
(cÚ¡ 
ba£AùiÚsLi¡
& 
aùiÚLi¡
);

112 
­³nd_aùiÚs
(cÚ¡ 
ba£AùiÚsLi¡
& 
aùiÚLi¡
);

113 
add_aùiÚ
(
dÜa
::
ba£_aùiÚ_t
* 
·ùiÚ
);

115 
šlše
 
boŞ
 
po¡
(boŞ 
is_”rÜ
=
çl£
) {

116 ià(
is_”rÜ
è
abÜt
();

117  (
	g_couÁdown
.
po¡
(
çl£
));

121 
šlše
 
ushÜt_t
 
abÜt
() {

122 
	g_decisiÚ
 = 
AD_ABORT
;

123  (*&
	g_decisiÚ
);

126 
šlše
 
boŞ
 
isAbÜ‹d
() {

127  (*&
	g_decisiÚ
 =ğ
AD_ABORT
);

131 
šlše
 
»size
(cÚ¡ 
ušt
 
šŒa_Œx_út
, cÚ¡ ušˆ
tÙ®_aùiÚs
) {

133 
	g_couÁdown
.
»£t
(
šŒa_Œx_út
);

134 
	g_aùiÚs
.
»£rve
(
tÙ®_aùiÚs
);

140 
vœtu®
 
w_rc_t
 
run
();

143 
vœtu®
 
giveback
()=0;

148 
š™
()

152 
»£t
()

155 
	g_aùiÚs
.
”a£
(
_aùiÚs
.
begš
(),_aùiÚs.
’d
());

156 
	g_xù
 = 
NULL
;

159 
	g´Ùeùed
:

161 
vœtu®
 
w_rc_t
 
_run
()=0;

177 şas 
	c‹rmš®_rvp_t
 : 
public
 
rvp_t


179 
´Ùeùed
:

181 
ss_m
* 
_db
;

182 
DÜaEnv
* 
	m_d’v
;

184 
	mpublic
:

186 
‹rmš®_rvp_t
();

188 
‹rmš®_rvp_t
(cÚ¡”mš®_rvp_t& 
rhs
);

189 
	m‹rmš®_rvp_t
& 
	mİ”©Ü
=(cÚ¡ 
‹rmš®_rvp_t
& 
rhs
);

191 
	mvœtu®
 ~
‹rmš®_rvp_t
();

194 
	$_£t
(
ss_m
* 
db
, 
DÜaEnv
* 
d’v
,

195 
xù_t
* 
pxù
, cÚ¡ 
tid_t
& 
©id
, cÚ¡ 
axùid
,

196 cÚ¡ 
Œx_»suÉ_tu¶e_t
& 
´esuÉ
,

197 cÚ¡ 
ušt
 
šŒa_Œx_út
, cÚ¡ ušˆ
tÙ®_aùiÚs
)

199 
rvp_t
::
	`_£t
(
pxù
,
©id
,
axùid
,
´esuÉ
,
šŒa_Œx_út
,
tÙ®_aùiÚs
);

200 
_db
 = 
db
;

201 
_d’v
 = 
d’v
;

204 
w_rc_t
 
	`run
();

206 
	`nÙify_Ú_abÜt
();

208 
	`nÙify_·¹™iÚs
();

210 
vœtu®
 
	`upd_comm™‹d_¡©s
()=0;

211 
vœtu®
 
	`upd_abÜ‹d_¡©s
()=0;

213 
´Ùeùed
:

215 
w_rc_t
 
	`_run
();

217 
	}
};

221 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/tm1/dora_tm1.h

32 #iâdeà
__DORA_TM1_H


33 
	#__DORA_TM1_H


	)

36 
	~<c¡dio
>

38 
	~"s.h
"

40 
	~"ut.h
"

41 
	~"wÜklßd/tm1/shÜe_tm1_’v.h
"

42 
	~"dÜa/dÜa_’v.h
"

43 
	~"dÜa.h
"

45 
usšg
 
Çme¥aû
 
	gshÜe
;

46 
usšg
 
Çme¥aû
 
	gtm1
;

49 
ENTER_NAMESPACE
(
dÜa
);

56 
şass
 
	gfš®_gsd_rvp
;

57 
şass
 
	gr_sub_gsd_aùiÚ
;

61 
	#TM1GND2


	)

62 #ifdeà
TM1GND2


63 
şass
 
	gfš®_gnd_rvp
;

64 
şass
 
	gmid_gnd_rvp
;

65 
şass
 
	gr_sf_gnd_aùiÚ
;

66 
şass
 
	gr_cf_gnd_aùiÚ
;

68 
şass
 
	gfš®_gnd_rvp
;

69 
şass
 
	gr_sf_gnd_aùiÚ
;

70 
şass
 
	gr_cf_gnd_aùiÚ
;

74 
şass
 
	gfš®_gad_rvp
;

75 
şass
 
	gr_ai_gad_aùiÚ
;

79 
	#TM1USD2


	)

80 #ifdeà
TM1USD2


81 
şass
 
	gfš®_usd_rvp
;

82 
şass
 
	gmid_usd_rvp
;

83 
şass
 
	gupd_sub_usd_aùiÚ
;

84 
şass
 
	gupd_sf_usd_aùiÚ
;

86 
şass
 
	gfš®_usd_rvp
;

87 
şass
 
	gupd_sub_usd_aùiÚ
;

88 
şass
 
	gupd_sf_usd_aùiÚ
;

92 
şass
 
	gfš®_usdmix_rvp
;

93 
şass
 
	gmid_usdmix_rvp
;

94 
şass
 
	gupd_sub_usdmix_aùiÚ
;

95 
şass
 
	gupd_sf_usdmix_aùiÚ
;

98 
şass
 
	gfš®_ul_rvp
;

99 
şass
 
	gupd_sub_ul_aùiÚ
;

103 
	#TM1ICF2


	)

104 #ifdeà
TM1ICF2


105 
şass
 
	gfš®_icf_rvp
;

106 
şass
 
	gmid1_icf_rvp
;

107 
şass
 
	gmid2_icf_rvp
;

108 
şass
 
	gr_sub_icf_aùiÚ
;

109 
şass
 
	gr_sf_icf_aùiÚ
;

110 
şass
 
	gšs_cf_icf_aùiÚ
;

112 
şass
 
	gfš®_icf_rvp
;

113 
şass
 
	gmid_icf_rvp
;

114 
şass
 
	gr_sub_icf_aùiÚ
;

115 
şass
 
	gr_sf_icf_aùiÚ
;

116 
şass
 
	gšs_cf_icf_aùiÚ
;

120 
şass
 
	gfš®_icfb_rvp
;

121 
şass
 
	gr_sub_icfb_aùiÚ
;

122 
şass
 
	gi_cf_icfb_aùiÚ
;

127 
şass
 
	gfš®_dcf_rvp
;

128 
şass
 
	gmid_dcf_rvp
;

129 
şass
 
	gr_sub_dcf_aùiÚ
;

130 
şass
 
	gd–_cf_dcf_aùiÚ
;

133 
şass
 
	gfš®_g¢_rvp
;

134 #iâdeà
USE_DORA_EXT_IDX


135 
şass
 
	gr_sub_g¢_aùiÚ
;

137 
şass
 
	gr_sub_g¢_acc_aùiÚ
;

149 
şass
 
	gDÜaTM1Env
 : 
public
 
ShÜeTM1Env
,…ubliø
	gDÜaEnv


151 
	gpublic
:

153 
DÜaTM1Env
();

154 
	gvœtu®
 ~
DÜaTM1Env
();

160 
¡¬t
();

161 
¡İ
();

162 
»sume
();

163 
·u£
();

164 
w_rc_t
 
Ãwrun
();

165 
£t
(
’vV¬M­
* ) { (0); };

166 
dump
();

167 
šfo
() const;

168 
¡©i¡ics
();

169 
cÚf
();

173 
w_rc_t
 
upd©e_·¹™iÚšg
();

178 
DECLARE_DORA_PARTS
(
sub
);

179 
DECLARE_DORA_PARTS
(
ai
);

180 
DECLARE_DORA_PARTS
(
sf
);

181 
DECLARE_DORA_PARTS
(
cf
);

192 
DECLARE_DORA_TRX
(
g‘_sub_d©a
);

194 
DECLARE_DORA_FINAL_RVP_GEN_FUNC
(
fš®_gsd_rvp
);

196 
DECLARE_DORA_ACTION_GEN_FUNC
(
r_sub_gsd_aùiÚ
,
rvp_t
,
g‘_sub_d©a_šput_t
);

204 
DECLARE_DORA_TRX
(
g‘_Ãw_de¡
);

206 #ifdeà
TM1GND2


207 
DECLARE_DORA_MIDWAY_RVP_GEN_FUNC
(
mid_gnd_rvp
,
g‘_Ãw_de¡_šput_t
);

208 
DECLARE_DORA_FINAL_RVP_WITH_PREV_GEN_FUNC
(
fš®_gnd_rvp
);

210 
DECLARE_DORA_ACTION_GEN_FUNC
(
r_sf_gnd_aùiÚ
,
mid_gnd_rvp
,
g‘_Ãw_de¡_šput_t
);

211 
DECLARE_DORA_ACTION_GEN_FUNC
(
r_cf_gnd_aùiÚ
,
rvp_t
,
g‘_Ãw_de¡_šput_t
);

213 
DECLARE_DORA_FINAL_RVP_GEN_FUNC
(
fš®_gnd_rvp
);

215 
DECLARE_DORA_ACTION_GEN_FUNC
(
r_sf_gnd_aùiÚ
,
rvp_t
,
g‘_Ãw_de¡_šput_t
);

216 
DECLARE_DORA_ACTION_GEN_FUNC
(
r_cf_gnd_aùiÚ
,
rvp_t
,
g‘_Ãw_de¡_šput_t
);

224 
DECLARE_DORA_TRX
(
g‘_acc_d©a
);

226 
DECLARE_DORA_FINAL_RVP_GEN_FUNC
(
fš®_gad_rvp
);

228 
DECLARE_DORA_ACTION_GEN_FUNC
(
r_ai_gad_aùiÚ
,
rvp_t
,
g‘_acc_d©a_šput_t
);

236 
DECLARE_DORA_TRX
(
upd_sub_d©a
);

238 #ifdeà
TM1USD2


239 
DECLARE_DORA_MIDWAY_RVP_GEN_FUNC
(
mid_usd_rvp
,
upd_sub_d©a_šput_t
);

240 
DECLARE_DORA_FINAL_RVP_WITH_PREV_GEN_FUNC
(
fš®_usd_rvp
);

242 
DECLARE_DORA_ACTION_GEN_FUNC
(
upd_sf_usd_aùiÚ
,
mid_usd_rvp
,
upd_sub_d©a_šput_t
);

243 
DECLARE_DORA_ACTION_GEN_FUNC
(
upd_sub_usd_aùiÚ
,
rvp_t
,
upd_sub_d©a_šput_t
);

245 
DECLARE_DORA_FINAL_RVP_GEN_FUNC
(
fš®_usd_rvp
);

247 
DECLARE_DORA_ACTION_GEN_FUNC
(
upd_sub_usd_aùiÚ
,
rvp_t
,
upd_sub_d©a_šput_t
);

248 
DECLARE_DORA_ACTION_GEN_FUNC
(
upd_sf_usd_aùiÚ
,
rvp_t
,
upd_sub_d©a_šput_t
);

259 
DECLARE_ALTER_DORA_TRX
(
upd_sub_d©a
,
upd_sub_d©a_mix
);

261 
DECLARE_DORA_MIDWAY_RVP_GEN_FUNC
(
mid_usdmix_rvp
,
upd_sub_d©a_šput_t
);

262 
DECLARE_DORA_FINAL_RVP_WITH_PREV_GEN_FUNC
(
fš®_usdmix_rvp
);

264 
DECLARE_DORA_ACTION_GEN_FUNC
(
upd_sub_usdmix_aùiÚ
,
mid_usdmix_rvp
,
upd_sub_d©a_šput_t
);

265 
DECLARE_DORA_ACTION_GEN_FUNC
(
upd_sf_usdmix_aùiÚ
,
rvp_t
,
upd_sub_d©a_šput_t
);

272 
DECLARE_DORA_TRX
(
upd_loc
);

274 
DECLARE_DORA_FINAL_RVP_GEN_FUNC
(
fš®_ul_rvp
);

276 
DECLARE_DORA_ACTION_GEN_FUNC
(
upd_sub_ul_aùiÚ
,
rvp_t
,
upd_loc_šput_t
);

284 
DECLARE_DORA_TRX
(
šs_ÿÎ_fwd
);

286 #ifdeà
TM1ICF2


287 
DECLARE_DORA_MIDWAY_RVP_GEN_FUNC
(
mid1_icf_rvp
,
šs_ÿÎ_fwd_šput_t
);

288 
DECLARE_DORA_MIDWAY_RVP_WITH_PREV_GEN_FUNC
(
mid2_icf_rvp
,
šs_ÿÎ_fwd_šput_t
);

289 
DECLARE_DORA_FINAL_RVP_WITH_PREV_GEN_FUNC
(
fš®_icf_rvp
);

291 
DECLARE_DORA_ACTION_GEN_FUNC
(
r_sub_icf_aùiÚ
,
mid1_icf_rvp
,
šs_ÿÎ_fwd_šput_t
);

292 
DECLARE_DORA_ACTION_GEN_FUNC
(
r_sf_icf_aùiÚ
,
mid2_icf_rvp
,
šs_ÿÎ_fwd_šput_t
);

293 
DECLARE_DORA_ACTION_GEN_FUNC
(
šs_cf_icf_aùiÚ
,
rvp_t
,
šs_ÿÎ_fwd_šput_t
);

295 
DECLARE_DORA_MIDWAY_RVP_GEN_FUNC
(
mid_icf_rvp
,
šs_ÿÎ_fwd_šput_t
);

296 
DECLARE_DORA_FINAL_RVP_WITH_PREV_GEN_FUNC
(
fš®_icf_rvp
);

298 
DECLARE_DORA_ACTION_GEN_FUNC
(
r_sub_icf_aùiÚ
,
mid_icf_rvp
,
šs_ÿÎ_fwd_šput_t
);

299 
DECLARE_DORA_ACTION_GEN_FUNC
(
r_sf_icf_aùiÚ
,
rvp_t
,
šs_ÿÎ_fwd_šput_t
);

300 
DECLARE_DORA_ACTION_GEN_FUNC
(
šs_cf_icf_aùiÚ
,
rvp_t
,
šs_ÿÎ_fwd_šput_t
);

309 
DECLARE_DORA_TRX
(
šs_ÿÎ_fwd_b’ch
);

311 
DECLARE_DORA_FINAL_RVP_GEN_FUNC
(
fš®_icfb_rvp
);

313 
DECLARE_DORA_ACTION_GEN_FUNC
(
r_sub_icfb_aùiÚ
,
rvp_t
,
šs_ÿÎ_fwd_b’ch_šput_t
);

314 
DECLARE_DORA_ACTION_GEN_FUNC
(
i_cf_icfb_aùiÚ
,
rvp_t
,
šs_ÿÎ_fwd_b’ch_šput_t
);

323 
DECLARE_DORA_TRX
(
d–_ÿÎ_fwd
);

325 
DECLARE_DORA_MIDWAY_RVP_GEN_FUNC
(
mid_dcf_rvp
,
d–_ÿÎ_fwd_šput_t
);

326 
DECLARE_DORA_FINAL_RVP_WITH_PREV_GEN_FUNC
(
fš®_dcf_rvp
);

328 
DECLARE_DORA_ACTION_GEN_FUNC
(
r_sub_dcf_aùiÚ
,
mid_dcf_rvp
,
d–_ÿÎ_fwd_šput_t
);

329 
DECLARE_DORA_ACTION_GEN_FUNC
(
d–_cf_dcf_aùiÚ
,
rvp_t
,
d–_ÿÎ_fwd_šput_t
);

337 
DECLARE_DORA_TRX
(
g‘_sub_nbr
);

339 
DECLARE_DORA_FINAL_DYNAMIC_RVP_GEN_FUNC
(
fš®_g¢_rvp
);

340 #iâdeà
USE_DORA_EXT_IDX


341 
DECLARE_DORA_ACTION_GEN_FUNC
(
r_sub_g¢_aùiÚ
,
rvp_t
,
g‘_sub_nbr_šput_t
);

343 
DECLARE_DORA_ACTION_GEN_FUNC
(
r_sub_g¢_acc_aùiÚ
,
rvp_t
,
g‘_sub_nbr_šput_t
);

350 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/tm1/dora_tm1_client.h

31 #iâdeà
__DORA_TM1_CLIENT_H


32 
	#__DORA_TM1_CLIENT_H


	)

35 
	~"wÜklßd/tm1/tm1_cÚ¡.h
"

36 
	~"dÜa/tm1/dÜa_tm1.h
"

38 
usšg
 
Çme¥aû
 
	gshÜe
;

41 
ENTER_NAMESPACE
(
dÜa
);

53 şas 
	cdÜa_tm1_ş›Á_t
 : 
public
 
ba£_ş›Á_t


55 
´iv©e
:

57 
DÜaTM1Env
* 
_tm1db
;

58 
	m_£lid
;

59 
	m_qf
;

61 
	mpublic
:

63 
	$dÜa_tm1_ş›Á_t
() { }

65 
	$dÜa_tm1_ş›Á_t
(
c_¡r
 
Šame
, cÚ¡ 
id
, 
DÜaTM1Env
* 
’v
,

66 cÚ¡ 
M—su»m’tTy³
 
aTy³
, cÚ¡ 
Œxid
,

67 cÚ¡ 
numOfTrxs
,

68 
´oûssÜid_t
 
­rsid
, cÚ¡ 
£lID
, cÚ¡ 
qf
)

69 : 
	`ba£_ş›Á_t
(
Šame
,
id
,
’v
,
aTy³
,
Œxid
,
numOfTrxs
,
­rsid
),

70 
	`_tm1db
(
’v
), 
	`_£lid
(
£lID
), 
	$_qf
(
qf
)

72 
	`as£¹
 (
’v
);

73 
	`as£¹
 (
_id
>=0 && 
_qf
>0);

74 
	}
}

76 ~
	$dÜa_tm1_ş›Á_t
(è{ 
	}
}

79 
lßd_sup_xù
(
m­SupTrxs
& 
m­
);

83 
w_rc_t
 
subm™_Úe
(
xù_ty³
, 
xùid
);

88 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/tm1/dora_tm1_impl.h

35 #iâdeà
__DORA_TM1_IMPL_H


36 
	#__DORA_TM1_IMPL_H


	)

39 
	~"dÜa.h
"

40 
	~"wÜklßd/tm1/shÜe_tm1_’v.h
"

41 
	~"dÜa/tm1/dÜa_tm1.h
"

43 
usšg
 
Çme¥aû
 
	gshÜe
;

44 
usšg
 
Çme¥aû
 
	gtm1
;

47 
ENTER_NAMESPACE
(
dÜa
);

57 
DECLARE_DORA_FINAL_RVP_CLASS
(
fš®_gsd_rvp
,
DÜaTM1Env
,1,1);

59 
DECLARE_DORA_ACTION_NO_RVP_CLASS
(
r_sub_gsd_aùiÚ
,,
DÜaTM1Env
,
g‘_sub_d©a_šput_t
,1);

68 #ifdeà
TM1GND2


69 
DECLARE_DORA_EMPTY_MIDWAY_RVP_CLASS
(
mid_gnd_rvp
,
DÜaTM1Env
,
g‘_Ãw_de¡_šput_t
,1,1);

70 
DECLARE_DORA_FINAL_RVP_CLASS
(
fš®_gnd_rvp
,
DÜaTM1Env
,1,2);

72 
DECLARE_DORA_ACTION_WITH_RVP_CLASS
(
r_sf_gnd_aùiÚ
,,
DÜaTM1Env
,
mid_gnd_rvp
,
g‘_Ãw_de¡_šput_t
,2);

74 
DECLARE_DORA_ACTION_NO_RVP_CLASS
(
r_cf_gnd_aùiÚ
,,
DÜaTM1Env
,
g‘_Ãw_de¡_šput_t
,3);

76 
DECLARE_DORA_FINAL_RVP_CLASS
(
fš®_gnd_rvp
,
DÜaTM1Env
,2,2);

78 
DECLARE_DORA_ACTION_NO_RVP_CLASS
(
r_sf_gnd_aùiÚ
,,
DÜaTM1Env
,
g‘_Ãw_de¡_šput_t
,2);

79 
DECLARE_DORA_ACTION_NO_RVP_CLASS
(
r_cf_gnd_aùiÚ
,,
DÜaTM1Env
,
g‘_Ãw_de¡_šput_t
,3);

89 
DECLARE_DORA_FINAL_RVP_CLASS
(
fš®_gad_rvp
,
DÜaTM1Env
,1,1);

91 
DECLARE_DORA_ACTION_NO_RVP_CLASS
(
r_ai_gad_aùiÚ
,,
DÜaTM1Env
,
g‘_acc_d©a_šput_t
,2);

100 #ifdeà
TM1USD2


101 
DECLARE_DORA_EMPTY_MIDWAY_RVP_CLASS
(
mid_usd_rvp
,
DÜaTM1Env
,
upd_sub_d©a_šput_t
,1,1);

102 
DECLARE_DORA_FINAL_RVP_CLASS
(
fš®_usd_rvp
,
DÜaTM1Env
,1,2);

104 
DECLARE_DORA_ACTION_WITH_RVP_CLASS
(
upd_sf_usd_aùiÚ
,,
DÜaTM1Env
,
mid_usd_rvp
,
upd_sub_d©a_šput_t
,2);

106 
DECLARE_DORA_ACTION_NO_RVP_CLASS
(
upd_sub_usd_aùiÚ
,,
DÜaTM1Env
,
upd_sub_d©a_šput_t
,1);

108 
DECLARE_DORA_FINAL_RVP_CLASS
(
fš®_usd_rvp
,
DÜaTM1Env
,2,2);

110 
DECLARE_DORA_ACTION_NO_RVP_CLASS
(
upd_sub_usd_aùiÚ
,,
DÜaTM1Env
,
upd_sub_d©a_šput_t
,1);

111 
DECLARE_DORA_ACTION_NO_RVP_CLASS
(
upd_sf_usd_aùiÚ
,,
DÜaTM1Env
,
upd_sub_d©a_šput_t
,2);

120 
DECLARE_DORA_EMPTY_MIDWAY_RVP_CLASS
(
mid_usdmix_rvp
,
DÜaTM1Env
,
upd_sub_d©a_šput_t
,1,1);

121 
DECLARE_DORA_FINAL_RVP_CLASS
(
fš®_usdmix_rvp
,
DÜaTM1Env
,1,2);

123 
DECLARE_DORA_ACTION_WITH_RVP_CLASS
(
upd_sub_usdmix_aùiÚ
,,
DÜaTM1Env
,
mid_usdmix_rvp
,
upd_sub_d©a_šput_t
,1);

125 
DECLARE_DORA_ACTION_NO_RVP_CLASS
(
upd_sf_usdmix_aùiÚ
,,
DÜaTM1Env
,
upd_sub_d©a_šput_t
,2);

134 
DECLARE_DORA_FINAL_RVP_CLASS
(
fš®_ul_rvp
,
DÜaTM1Env
,1,1);

136 
DECLARE_DORA_ACTION_NO_RVP_CLASS
(
upd_sub_ul_aùiÚ
,,
DÜaTM1Env
,
upd_loc_šput_t
,1);

145 #ifdeà
TM1ICF2


146 
DECLARE_DORA_EMPTY_MIDWAY_RVP_CLASS
(
mid1_icf_rvp
,
DÜaTM1Env
,
šs_ÿÎ_fwd_šput_t
,1,1);

147 
DECLARE_DORA_EMPTY_MIDWAY_RVP_CLASS
(
mid2_icf_rvp
,
DÜaTM1Env
,
šs_ÿÎ_fwd_šput_t
,1,2);

148 
DECLARE_DORA_FINAL_RVP_CLASS
(
fš®_icf_rvp
,
DÜaTM1Env
,1,3);

150 
DECLARE_DORA_ACTION_WITH_RVP_CLASS
(
r_sub_icf_aùiÚ
,,
DÜaTM1Env
,
mid1_icf_rvp
,
šs_ÿÎ_fwd_šput_t
,1);

151 
DECLARE_DORA_ACTION_WITH_RVP_CLASS
(
r_sf_icf_aùiÚ
,,
DÜaTM1Env
,
mid2_icf_rvp
,
šs_ÿÎ_fwd_šput_t
,2);

152 
DECLARE_DORA_ACTION_NO_RVP_CLASS
(
šs_cf_icf_aùiÚ
,,
DÜaTM1Env
,
šs_ÿÎ_fwd_šput_t
,3);

154 
DECLARE_DORA_EMPTY_MIDWAY_RVP_CLASS
(
mid_icf_rvp
,
DÜaTM1Env
,
šs_ÿÎ_fwd_šput_t
,1,1);

155 
DECLARE_DORA_FINAL_RVP_CLASS
(
fš®_icf_rvp
,
DÜaTM1Env
,2,3);

157 
DECLARE_DORA_ACTION_WITH_RVP_CLASS
(
r_sub_icf_aùiÚ
,,
DÜaTM1Env
,
mid_icf_rvp
,
šs_ÿÎ_fwd_šput_t
,1);

158 
DECLARE_DORA_ACTION_NO_RVP_CLASS
(
r_sf_icf_aùiÚ
,,
DÜaTM1Env
,
šs_ÿÎ_fwd_šput_t
,2);

159 
DECLARE_DORA_ACTION_NO_RVP_CLASS
(
šs_cf_icf_aùiÚ
,,
DÜaTM1Env
,
šs_ÿÎ_fwd_šput_t
,3);

170 
DECLARE_DORA_FINAL_RVP_CLASS
(
fš®_icfb_rvp
,
DÜaTM1Env
,2,2);

172 
DECLARE_DORA_ACTION_NO_RVP_CLASS
(
r_sub_icfb_aùiÚ
,,
DÜaTM1Env
,
šs_ÿÎ_fwd_b’ch_šput_t
,1);

173 
DECLARE_DORA_ACTION_NO_RVP_CLASS
(
i_cf_icfb_aùiÚ
,,
DÜaTM1Env
,
šs_ÿÎ_fwd_b’ch_šput_t
,3);

182 
DECLARE_DORA_EMPTY_MIDWAY_RVP_CLASS
(
mid_dcf_rvp
,
DÜaTM1Env
,
d–_ÿÎ_fwd_šput_t
,1,1);

183 
DECLARE_DORA_FINAL_RVP_CLASS
(
fš®_dcf_rvp
,
DÜaTM1Env
,1,2);

185 
DECLARE_DORA_ACTION_WITH_RVP_CLASS
(
r_sub_dcf_aùiÚ
,,
DÜaTM1Env
,
mid_dcf_rvp
,
d–_ÿÎ_fwd_šput_t
,1);

186 
DECLARE_DORA_ACTION_NO_RVP_CLASS
(
d–_cf_dcf_aùiÚ
,,
DÜaTM1Env
,
d–_ÿÎ_fwd_šput_t
,3);

196 
DECLARE_DORA_FINAL_DYNAMIC_RVP_CLASS
(
fš®_g¢_rvp
,
DÜaTM1Env
);

197 #iâdeà
USE_DORA_EXT_IDX


198 
DECLARE_DORA_ACTION_NO_RVP_CLASS
(
r_sub_g¢_aùiÚ
,,
DÜaTM1Env
,
g‘_sub_nbr_šput_t
,1);

200 
DECLARE_DORA_ACTION_NO_RVP_CLASS
(
r_sub_g¢_acc_aùiÚ
,,
DÜaTM1Env
,
g‘_sub_nbr_šput_t
,1);

204 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/tpcb/dora_tpcb.h

32 #iâdeà
__DORA_TPCB_H


33 
	#__DORA_TPCB_H


	)

36 
	~<c¡dio
>

38 
	~"s.h
"

40 
	~"ut.h
"

41 
	~"wÜklßd/cb/shÜe_cb_’v.h
"

42 
	~"dÜa/dÜa_’v.h
"

43 
	~"dÜa.h
"

45 
usšg
 
Çme¥aû
 
	gshÜe
;

46 
usšg
 
Çme¥aû
 
	gcb
;

49 
ENTER_NAMESPACE
(
dÜa
);

56 
şass
 
	gfš®_au_rvp
;

57 
şass
 
	gupd_br_aùiÚ
;

58 
şass
 
	gupd_ac_aùiÚ
;

59 
şass
 
	gupd_‹_aùiÚ
;

60 
şass
 
	gšs_hi_aùiÚ
;

71 
şass
 
	gDÜaTPCBEnv
 : 
public
 
ShÜeTPCBEnv
,…ubliø
	gDÜaEnv


73 
	gpublic
:

75 
DÜaTPCBEnv
();

76 
	gvœtu®
 ~
DÜaTPCBEnv
();

81 
¡¬t
();

82 
¡İ
();

83 
»sume
();

84 
·u£
();

85 
w_rc_t
 
Ãwrun
();

86 
£t
(
’vV¬M­
* ) { (0); };

87 
dump
();

88 
šfo
() const;

89 
¡©i¡ics
();

90 
cÚf
();

94 
w_rc_t
 
upd©e_·¹™iÚšg
();

99 
DECLARE_DORA_PARTS
(
br
);

100 
DECLARE_DORA_PARTS
(
‹
);

101 
DECLARE_DORA_PARTS
(
ac
);

102 
DECLARE_DORA_PARTS
(
hi
);

112 
DECLARE_DORA_TRX
(
acù_upd©e
);

114 
DECLARE_DORA_FINAL_RVP_GEN_FUNC
(
fš®_au_rvp
);

116 
DECLARE_DORA_ACTION_GEN_FUNC
(
upd_br_aùiÚ
,
rvp_t
,
acù_upd©e_šput_t
);

117 
DECLARE_DORA_ACTION_GEN_FUNC
(
upd_‹_aùiÚ
,
rvp_t
,
acù_upd©e_šput_t
);

118 
DECLARE_DORA_ACTION_GEN_FUNC
(
upd_ac_aùiÚ
,
rvp_t
,
acù_upd©e_šput_t
);

119 
DECLARE_DORA_ACTION_GEN_FUNC
(
šs_hi_aùiÚ
,
rvp_t
,
acù_upd©e_šput_t
);

124 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/tpcb/dora_tpcb_client.h

31 #iâdeà
__DORA_TPCB_CLIENT_H


32 
	#__DORA_TPCB_CLIENT_H


	)

35 
	~"dÜa/cb/dÜa_cb.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

40 
ENTER_NAMESPACE
(
dÜa
);

52 şas 
	cdÜa_cb_ş›Á_t
 : 
public
 
ba£_ş›Á_t


54 
´iv©e
:

56 
DÜaTPCBEnv
* 
_cbdb
;

57 
	m_£lid
;

58 
	m_qf
;

60 
	mpublic
:

62 
	$dÜa_cb_ş›Á_t
() { }

64 
	$dÜa_cb_ş›Á_t
(
c_¡r
 
Šame
, cÚ¡ 
id
, 
DÜaTPCBEnv
* 
’v
,

65 cÚ¡ 
M—su»m’tTy³
 
aTy³
, cÚ¡ 
Œxid
,

66 cÚ¡ 
numOfTrxs
,

67 
´oûssÜid_t
 
­rsid
, cÚ¡ 
£lID
, cÚ¡ 
qf
)

68 : 
	`ba£_ş›Á_t
(
Šame
,
id
,
’v
,
aTy³
,
Œxid
,
numOfTrxs
,
­rsid
),

69 
	`_cbdb
(
’v
), 
	`_£lid
(
£lID
), 
	$_qf
(
qf
)

71 
	`as£¹
 (
’v
);

72 
	`as£¹
 (
_id
>=0 && 
_qf
>0);

73 
	}
}

75 ~
	$dÜa_cb_ş›Á_t
(è{ 
	}
}

78 
lßd_sup_xù
(
m­SupTrxs
& 
m­
);

82 
w_rc_t
 
subm™_Úe
(
xù_ty³
, 
xùid
);

87 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/tpcb/dora_tpcb_impl.h

36 #iâdeà
__DORA_TPCB_IMPL_H


37 
	#__DORA_TPCB_IMPL_H


	)

40 
	~"dÜa.h
"

41 
	~"wÜklßd/cb/shÜe_cb_’v.h
"

42 
	~"dÜa/cb/dÜa_cb.h
"

44 
usšg
 
Çme¥aû
 
	gshÜe
;

45 
usšg
 
Çme¥aû
 
	gcb
;

48 
ENTER_NAMESPACE
(
dÜa
);

58 
DECLARE_DORA_FINAL_RVP_CLASS
(
fš®_au_rvp
,
DÜaTPCBEnv
,4,4);

60 
DECLARE_DORA_ACTION_NO_RVP_CLASS
(
upd_br_aùiÚ
,,
DÜaTPCBEnv
,
acù_upd©e_šput_t
,1);

61 
DECLARE_DORA_ACTION_NO_RVP_CLASS
(
upd_‹_aùiÚ
,,
DÜaTPCBEnv
,
acù_upd©e_šput_t
,1);

62 
DECLARE_DORA_ACTION_NO_RVP_CLASS
(
upd_ac_aùiÚ
,,
DÜaTPCBEnv
,
acù_upd©e_šput_t
,1);

63 
DECLARE_DORA_ACTION_NO_RVP_CLASS
(
šs_hi_aùiÚ
,,
DÜaTPCBEnv
,
acù_upd©e_šput_t
,1);

65 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/tpcc/dora_delivery.h

35 #iâdeà
__DORA_TPCC_DELIVERY_H


36 
	#__DORA_TPCC_DELIVERY_H


	)

39 
	~"dÜa.h
"

40 
	~"wÜklßd/cc/shÜe_cc_’v.h
"

41 
	~"dÜa/cc/dÜa_cc.h
"

43 
usšg
 
Çme¥aû
 
	gshÜe
;

44 
usšg
 
Çme¥aû
 
	gcc
;

47 
ENTER_NAMESPACE
(
dÜa
);

69 şas 
	cfš®_d–_rvp
 : 
public
 
‹rmš®_rvp_t


71 
´iv©e
:

72 
objeù_ÿche_t
<
	tfš®_d–_rvp
> 
	trvp_ÿche
;

73 
DÜaTPCCEnv
* 
	m_±pcûnv
;

74 
rvp_ÿche
* 
	m_ÿche
;

75 
	mpublic
:

76 
	$fš®_d–_rvp
(è: 
	`‹rmš®_rvp_t
(), 
	`_±pcûnv
(
NULL
), 
	$_ÿche
(
NULL
) { }

77 ~
	$fš®_d–_rvp
(è{ 
_ÿche
=
NULL
; 
_±pcûnv
=NULL; 
	}
}

80 
šlše
 
	$£t
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, cÚ¡ 
axùid
,

81 
Œx_»suÉ_tu¶e_t
& 
´esuÉ
,

82 
DÜaTPCCEnv
* 
³nv
, 
rvp_ÿche
* 
pc
)

84 
	`as£¹
 (
³nv
);

85 
_±pcûnv
 = 
³nv
;

86 
	`as£¹
 (
pc
);

87 
_ÿche
 = 
pc
;

88 
	`_£t
(
³nv
->
	`db
(),³nv,
axù
,
©id
,
axùid
,
´esuÉ
,

89 
DISTRICTS_PER_WAREHOUSE
,4*DISTRICTS_PER_WAREHOUSE);

90 
	}
}

91 
šlše
 
	$giveback
(è{ 
_ÿche
->
	`giveback
(
this
); 
	}
}

94 
w_rc_t
 
run
();

95 
upd_comm™‹d_¡©s
();

96 
upd_abÜ‹d_¡©s
();

111 şas 
	cmid1_d–_rvp
 : 
public
 
rvp_t


113 
´iv©e
:

114 
objeù_ÿche_t
<
	tmid1_d–_rvp
> 
	trvp_ÿche
;

115 
rvp_ÿche
* 
	m_ÿche
;

116 
DÜaTPCCEnv
* 
	m_±pcûnv
;

117 
boŞ
 
	m_bWake
;

119 
d–iv”y_šput_t
 
	m_dš
;

120 
	m_d_id
;

121 
	m_o_id
;

122 
fš®_d–_rvp
* 
	m_fš®_rvp
;

123 
	mpublic
:

124 
	$mid1_d–_rvp
(è: 
	`rvp_t
(), 
	`_ÿche
(
NULL
), 
	`_±pcûnv
(NULL),

125 
	`_o_id
(-1) { }

126 ~
	$mid1_d–_rvp
(è{ 
_ÿche
=
NULL
; 
_±pcûnv
=NULL;

127 
_o_id
 = -1; 
	}
}

130 
šlše
 
	$£t
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, cÚ¡ & 
axùid
,

131 
Œx_»suÉ_tu¶e_t
& 
´esuÉ
,

132 cÚ¡ 
d–iv”y_šput_t
& 
dš
, cÚ¡ 
boŞ
 
bWake
,

133 
DÜaTPCCEnv
* 
³nv
, 
rvp_ÿche
* 
pc
)

135 
_dš
 = 
dš
;

136 
_bWake
 = 
bWake
;

137 
	`as£¹
 (
³nv
);

138 
_±pcûnv
 = 
³nv
;

139 
	`as£¹
 (
pc
);

140 
_ÿche
 = 
pc
;

141 
	`_£t
(
axù
,
©id
,
axùid
,
´esuÉ
,1,1);

142 
	}
}

143 
šlše
 
	$po¡£t
(
fš®_d–_rvp
* 
´vp
, cÚ¡ 
d_id
)

145 
_d_id
 = 
d_id
;

147 
	`as£¹
 (
´vp
);

148 
_fš®_rvp
 = 
´vp
;

149 
	}
}

151 
šlše
 
	$giveback
(è{ 
_ÿche
->
	`giveback
(
this
); 
	}
}

153 
	$£t_o_id
(cÚ¡ 
aoid
è{ 
_o_id
 =‡oid; 
	}
}

156 
w_rc_t
 
_run
();

172 şas 
	cmid2_d–_rvp
 : 
public
 
rvp_t


174 
´iv©e
:

175 
objeù_ÿche_t
<
	tmid2_d–_rvp
> 
	trvp_ÿche
;

176 
rvp_ÿche
* 
	m_ÿche
;

177 
DÜaTPCCEnv
* 
	m_±pcûnv
;

178 
boŞ
 
	m_bWake
;

180 
d–iv”y_šput_t
 
	m_dš
;

181 
	m_d_id
;

182 
	m_c_id
;

183 
	m_amouÁ
;

184 
s_lock
 
	m_amouÁ_lock
;

185 
fš®_d–_rvp
* 
	m_fš®_rvp
;

187 
	mpublic
:

188 
	$mid2_d–_rvp
(è: 
	`rvp_t
(), 
	`_ÿche
(
NULL
), 
	`_±pcûnv
(NULL),

189 
	`_c_id
(-1), 
	`_amouÁ
(-1) { }

190 ~
	$mid2_d–_rvp
(è{ 
_ÿche
=
NULL
; 
_±pcûnv
=NULL;

191 
_c_id
 = -1; 
_amouÁ
 = -1; 
	}
}

194 
šlše
 
	$£t
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, cÚ¡ & 
axùid
,

195 
Œx_»suÉ_tu¶e_t
& 
´esuÉ
,

196 cÚ¡ 
d–iv”y_šput_t
& 
dš
, cÚ¡ 
boŞ
 
bWake
,

197 
DÜaTPCCEnv
* 
³nv
, 
rvp_ÿche
* 
pc
)

199 
_dš
 = 
dš
;

200 
_bWake
 = 
bWake
;

201 
_±pcûnv
 = 
³nv
;

202 
	`as£¹
 (
pc
);

203 
_ÿche
 = 
pc
;

204 
	`_£t
(
axù
,
©id
,
axùid
,
´esuÉ
,2,3);

205 
	}
}

206 
šlše
 
	$po¡£t
(cÚ¡ 
d_id
,
fš®_d–_rvp
* 
´vp
)

208 
_d_id
 = 
d_id
;

209 
_fš®_rvp
 = 
´vp
;

210 
	}
}

211 
šlše
 
	$giveback
(è{ 
_ÿche
->
	`giveback
(
this
); 
	}
}

213 
	$add_amouÁ
(cÚ¡ 
ªamouÁ
) {

214 
	`CRITICAL_SECTION
(
amouÁ_cs
, 
_amouÁ_lock
);

215 
_amouÁ
 +ğ
ªamouÁ
;

216 
	}
}

218 
	$£t_c_id
(cÚ¡ 
c_id
è{ 
_c_id
 = c_id; 
	}
}

221 
w_rc_t
 
_run
();

248 
şass
 
	gd–_aùiÚ
 : 
public
 
¿nge_aùiÚ_im¶
<>

250 
´Ùeùed
:

251 
DÜaTPCCEnv
* 
_±pcûnv
;

252 
d–iv”y_šput_t
 
	g_dš
;

253 
	g_d_id
;

255 
šlše
 
_d–_aù_£t
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, 
rvp_t
* 
´vp
,

256 cÚ¡ 
keyËn
, cÚ¡ 
d–iv”y_šput_t
& 
dš
,

257 cÚ¡ 
did
,

258 
DÜaTPCCEnv
* 
³nv
)

260 
_¿nge_aù_£t
(
axù
,
©id
,
´vp
,
keyËn
);

261 
	g_dš
 = 
dš
;

262 
	g_d_id
 = 
did
;

263 
as£¹
 (
³nv
);

264 
	g_±pcûnv
 = 
³nv
;

267 
	gpublic
:

268 
d–_aùiÚ
(è: 
¿nge_aùiÚ_im¶
<>(), 
_±pcûnv
(
NULL
) { }

269 
	gvœtu®
 ~
d–_aùiÚ
() { }

271 
vœtu®
 
w_rc_t
 
Œx_exec
()=0;

272 
vœtu®
 
ÿlc_keys
()=0;

278 şas 
	cd–_nÜd_d–_aùiÚ
 : 
public
 
d–_aùiÚ


280 
´iv©e
:

281 
objeù_ÿche_t
<
	td–_nÜd_d–_aùiÚ
> 
	taù_ÿche
;

282 
aù_ÿche
* 
	m_ÿche
;

283 
mid1_d–_rvp
* 
	m_pmid1_rvp
;

284 
	mpublic
:

285 
	$d–_nÜd_d–_aùiÚ
(è: 
	$d–_aùiÚ
() { }

286 ~
	$d–_nÜd_d–_aùiÚ
(è{ 
	}
}

287 
w_rc_t
 
Œx_exec
();

288 
	$ÿlc_keys
() {

289 
_down
.
	`push_back
(
_dš
.
_wh_id
);

290 
_down
.
	`push_back
(
_d_id
);

291 
	}
}

292 
šlše
 
	$£t
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
,

293 
mid1_d–_rvp
* 
pmid1_rvp
,

294 cÚ¡ 
d–iv”y_šput_t
& 
dš
,

295 
DÜaTPCCEnv
* 
³nv
, 
aù_ÿche
* 
pc
)

297 
	`as£¹
 (
pmid1_rvp
);

298 
_pmid1_rvp
 = 
pmid1_rvp
;

299 
	`as£¹
 (
pc
);

300 
_ÿche
 = 
pc
;

301 
	`_d–_aù_£t
(
axù
,
©id
,
pmid1_rvp
,2,
dš
,0,
³nv
);

302 
	}
}

303 
šlše
 
	$po¡£t
(cÚ¡ 
d_id
)

305 
_d_id
 = 
d_id
;

306 
	}
}

307 
šlše
 
	$giveback
(è{ 
_ÿche
->
	`giveback
(
this
); 
	}
}

314 şas 
	cupd_Üd_d–_aùiÚ
 : 
public
 
d–_aùiÚ


316 
´iv©e
:

317 
objeù_ÿche_t
<
	tupd_Üd_d–_aùiÚ
> 
	taù_ÿche
;

318 
aù_ÿche
* 
	m_ÿche
;

319 
mid2_d–_rvp
* 
	m_pmid2_rvp
;

320 
	m_o_id
;

321 
	mpublic
:

322 
	$upd_Üd_d–_aùiÚ
(è: 
	$d–_aùiÚ
() { }

323 ~
	$upd_Üd_d–_aùiÚ
(è{ 
	}
}

324 
w_rc_t
 
Œx_exec
();

325 
	$ÿlc_keys
() {

326 
_down
.
	`push_back
(
_dš
.
_wh_id
);

327 
_down
.
	`push_back
(
_d_id
);

328 
_down
.
	`push_back
(
_o_id
);

329 
_down
.
	`push_back
(
_o_id
);

330 
	}
}

331 
šlše
 
	$£t
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
,

332 
mid2_d–_rvp
* 
pmid2_rvp
,

333 cÚ¡ 
d–iv”y_šput_t
& 
dš
,

334 
DÜaTPCCEnv
* 
³nv
, 
aù_ÿche
* 
pc
)

336 
	`as£¹
 (
pmid2_rvp
);

337 
_pmid2_rvp
 = 
pmid2_rvp
;

338 
	`as£¹
 (
pc
);

339 
_ÿche
 = 
pc
;

340 
	`_d–_aù_£t
(
axù
,
©id
,
pmid2_rvp
,3,
dš
,0,
³nv
);

341 
	}
}

342 
šlše
 
	$po¡£t
(cÚ¡ 
d_id
, cÚ¡ 
o_id
)

344 
_d_id
 = 
d_id
;

345 
_o_id
 = 
o_id
;

346 
	}
}

347 
šlše
 
	$giveback
(è{ 
_ÿche
->
	`giveback
(
this
); 
	}
}

354 şas 
	cupd_Şše_d–_aùiÚ
 : 
public
 
d–_aùiÚ


356 
´iv©e
:

357 
objeù_ÿche_t
<
	tupd_Şše_d–_aùiÚ
> 
	taù_ÿche
;

358 
aù_ÿche
* 
	m_ÿche
;

359 
mid2_d–_rvp
* 
	m_pmid2_rvp
;

360 
	m_o_id
;

361 
	mpublic
:

362 
	$upd_Şše_d–_aùiÚ
(è: 
	$d–_aùiÚ
() { }

363 ~
	$upd_Şše_d–_aùiÚ
(è{ 
	}
}

364 
w_rc_t
 
Œx_exec
();

365 
	$ÿlc_keys
() {

366 
_down
.
	`push_back
(
_dš
.
_wh_id
);

367 
_down
.
	`push_back
(
_d_id
);

368 
_down
.
	`push_back
(
_o_id
);

369 
	}
}

370 
šlše
 
	$£t
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
,

371 
mid2_d–_rvp
* 
pmid2_rvp
,

372 cÚ¡ 
d–iv”y_šput_t
& 
dš
,

373 
DÜaTPCCEnv
* 
³nv
, 
aù_ÿche
* 
pc
)

375 
	`as£¹
 (
pmid2_rvp
);

376 
_pmid2_rvp
 = 
pmid2_rvp
;

377 
	`as£¹
 (
pc
);

378 
_ÿche
 = 
pc
;

379 
	`_d–_aù_£t
(
axù
,
©id
,
pmid2_rvp
,3,
dš
,0,
³nv
);

380 
	}
}

381 
šlše
 
	$po¡£t
(cÚ¡ 
d_id
, cÚ¡ 
o_id
)

383 
_d_id
 = 
d_id
;

384 
_o_id
 = 
o_id
;

385 
	}
}

386 
šlše
 
	$giveback
(è{ 
_ÿche
->
	`giveback
(
this
); 
	}
}

393 şas 
	cupd_cu¡_d–_aùiÚ
 : 
public
 
d–_aùiÚ


395 
´iv©e
:

396 
objeù_ÿche_t
<
	tupd_cu¡_d–_aùiÚ
> 
	taù_ÿche
;

397 
aù_ÿche
* 
	m_ÿche
;

398 
	m_c_id
;

399 
	m_amouÁ
;

400 
	mpublic
:

401 
	$upd_cu¡_d–_aùiÚ
(è: 
	`d–_aùiÚ
(), 
	`_c_id
(-1), 
	`_amouÁ
(-1) { }

402 ~
	$upd_cu¡_d–_aùiÚ
(è{ 
_c_id
=-1; 
_amouÁ
=-1; 
	}
}

403 
w_rc_t
 
Œx_exec
();

404 
	$ÿlc_keys
() {

405 
_down
.
	`push_back
(
_dš
.
_wh_id
);

406 
_down
.
	`push_back
(
_d_id
);

407 
_down
.
	`push_back
(
_c_id
);

408 
	}
}

409 
šlše
 
	$£t
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
,

410 
rvp_t
* 
´vp
,

411 cÚ¡ 
d–iv”y_šput_t
& 
dš
,

412 
DÜaTPCCEnv
* 
³nv
, 
aù_ÿche
* 
pc
)

414 
	`as£¹
 (
pc
);

415 
_ÿche
 = 
pc
;

416 
	`_d–_aù_£t
(
axù
,
©id
,
´vp
,3,
dš
,0,
³nv
);

417 
	}
}

418 
šlše
 
	$po¡£t
(cÚ¡ 
d_id
, cÚ¡ 
c_id
, cÚ¡ 
amouÁ
)

420 
_d_id
 = 
d_id
;

421 
_c_id
 = 
c_id
;

422 
_amouÁ
 = 
amouÁ
;

423 
	}
}

425 
šlše
 
	$giveback
(è{ 
_ÿche
->
	`giveback
(
this
); 
	}
}

431 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/tpcc/dora_mbench.h

35 #iâdeà
__DORA_MBENCHES_H


36 
	#__DORA_MBENCHES_H


	)

39 
	~"dÜa.h
"

40 
	~"wÜklßd/cc/shÜe_cc_’v.h
"

41 
	~"dÜa/cc/dÜa_cc.h
"

43 
usšg
 
Çme¥aû
 
	gshÜe
;

44 
usšg
 
Çme¥aû
 
	gcc
;

47 
ENTER_NAMESPACE
(
dÜa
);

58 
DECLARE_DORA_FINAL_RVP_CLASS
(
fš®_mb_rvp
,
DÜaTPCCEnv
,1,1);

60 
DECLARE_DORA_ACTION_NO_RVP_CLASS
(
upd_wh_mb_aùiÚ
,,
DÜaTPCCEnv
,
mb’ch_wh_šput_t
,1);

62 
DECLARE_DORA_ACTION_NO_RVP_CLASS
(
upd_cu¡_mb_aùiÚ
,,
DÜaTPCCEnv
,
mb’ch_cu¡_šput_t
,1);

65 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/tpcc/dora_new_order.h

35 #iâdeà
__DORA_TPCC_NEW_ORDER_H


36 
	#__DORA_TPCC_NEW_ORDER_H


	)

39 
	~"dÜa/cc/dÜa_cc.h
"

40 
	~"wÜklßd/cc/shÜe_cc_’v.h
"

42 
usšg
 
Çme¥aû
 
	gshÜe
;

43 
usšg
 
Çme¥aû
 
	gcc
;

46 
ENTER_NAMESPACE
(
dÜa
);

61 
DECLARE_DORA_EMPTY_MIDWAY_RVP_CLASS
(
mid1_nÜd_rvp
,
DÜaTPCCEnv
,
Ãw_Üd”_šput_t
,4,4);

62 
DECLARE_DORA_EMPTY_MIDWAY_RVP_CLASS
(
mid2_nÜd_rvp
,
DÜaTPCCEnv
,
Ãw_Üd”_šput_t
,2,6);

63 
DECLARE_DORA_EMPTY_MIDWAY_RVP_CLASS
(
mid3_nÜd_rvp
,
DÜaTPCCEnv
,
Ãw_Üd”_šput_t
,1,7);

64 
DECLARE_DORA_FINAL_RVP_CLASS
(
fš®_nÜd_rvp
,
DÜaTPCCEnv
,1,8);

82 
DECLARE_DORA_ACTION_WITH_RVP_CLASS
(
r_wh_nÜd_aùiÚ
,,
DÜaTPCCEnv
,
mid1_nÜd_rvp
,
no_™em_nÜd_šput_t
,1);

84 
DECLARE_DORA_ACTION_WITH_RVP_CLASS
(
upd_di¡_nÜd_aùiÚ
,,
DÜaTPCCEnv
,
mid1_nÜd_rvp
,
no_™em_nÜd_šput_t
,2);

87 
DECLARE_DORA_ACTION_WITH_RVP_CLASS
(
r_cu¡_nÜd_aùiÚ
,,
DÜaTPCCEnv
,
mid1_nÜd_rvp
,
no_™em_nÜd_šput_t
,2);

91 
DECLARE_DORA_ACTION_WITH_RVP_CLASS
(
r_™em_nÜd_aùiÚ
,,
DÜaTPCCEnv
,
mid1_nÜd_rvp
,
Ãw_Üd”_šput_t
,1);

102 
DECLARE_DORA_ACTION_WITH_RVP_CLASS
(
šs_Üd_nÜd_aùiÚ
,,
DÜaTPCCEnv
,
mid2_nÜd_rvp
,
no_™em_nÜd_šput_t
,2);

105 
DECLARE_DORA_ACTION_WITH_RVP_CLASS
(
šs_nÜd_nÜd_aùiÚ
,,
DÜaTPCCEnv
,
mid2_nÜd_rvp
,
no_™em_nÜd_šput_t
,2);

114 
DECLARE_DORA_ACTION_WITH_RVP_CLASS
(
šs_Ş_nÜd_aùiÚ
,,
DÜaTPCCEnv
,
mid3_nÜd_rvp
,
Ãw_Üd”_šput_t
,2);

125 
DECLARE_DORA_ACTION_NO_RVP_CLASS
(
upd_¡o_nÜd_aùiÚ
,,
DÜaTPCCEnv
,
Ãw_Üd”_šput_t
,1);

129 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/tpcc/dora_order_status.h

35 #iâdeà
__DORA_TPCC_ORDER_STATUS_H


36 
	#__DORA_TPCC_ORDER_STATUS_H


	)

39 
	~"dÜa.h
"

40 
	~"wÜklßd/cc/shÜe_cc_’v.h
"

41 
	~"dÜa/cc/dÜa_cc.h
"

43 
usšg
 
Çme¥aû
 
	gshÜe
;

44 
usšg
 
Çme¥aû
 
	gcc
;

47 
ENTER_NAMESPACE
(
dÜa
);

60 
DECLARE_DORA_EMPTY_MIDWAY_RVP_CLASS
(
mid1_Üd¡_rvp
,
DÜaTPCCEnv
,
Üd”_¡©us_šput_t
,1,1);

61 
DECLARE_DORA_EMPTY_MIDWAY_RVP_CLASS
(
mid2_Üd¡_rvp
,
DÜaTPCCEnv
,
Üd”_¡©us_šput_t
,1,2);

62 
DECLARE_DORA_FINAL_RVP_CLASS
(
fš®_Üd¡_rvp
,
DÜaTPCCEnv
,1,3);

75 
DECLARE_DORA_ACTION_WITH_RVP_CLASS
(
r_cu¡_Üd¡_aùiÚ
,,
DÜaTPCCEnv
,
mid1_Üd¡_rvp
,
Üd”_¡©us_šput_t
,2);

78 
DECLARE_DORA_ACTION_WITH_RVP_CLASS
(
r_Üd_Üd¡_aùiÚ
,,
DÜaTPCCEnv
,
mid2_Üd¡_rvp
,
Üd”_¡©us_šput_t
,2);

81 
DECLARE_DORA_ACTION_NO_RVP_CLASS
(
r_Ş_Üd¡_aùiÚ
,,
DÜaTPCCEnv
,
Üd”_¡©us_šput_t
,2);

85 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/tpcc/dora_payment.h

35 #iâdeà
__DORA_TPCC_PAYMENT_H


36 
	#__DORA_TPCC_PAYMENT_H


	)

39 
	~"dÜa.h
"

40 
	~"wÜklßd/cc/shÜe_cc_’v.h
"

41 
	~"dÜa/cc/dÜa_cc.h
"

43 
usšg
 
Çme¥aû
 
	gshÜe
;

44 
usšg
 
Çme¥aû
 
	gcc
;

47 
ENTER_NAMESPACE
(
dÜa
);

68 şas 
	cmidway_·y_rvp
 : 
public
 
rvp_t


70 
´iv©e
:

71 
objeù_ÿche_t
<
	tmidway_·y_rvp
> 
	trvp_ÿche
;

72 
rvp_ÿche
* 
	m_ÿche
;

73 
DÜaTPCCEnv
* 
	m_±pcûnv
;

74 
boŞ
 
	m_bWake
;

76 
cc_w¬ehou£_tu¶e
 
	m_awh
;

77 
cc_di¡riù_tu¶e
 
	m_adi¡
;

78 
	mpublic
:

79 
	$midway_·y_rvp
(è: 
	`rvp_t
(), 
	`_ÿche
(
NULL
), 
	$_±pcûnv
(
NULL
) { }

80 ~
	$midway_·y_rvp
(è{ 
_ÿche
=
NULL
; 
_±pcûnv
=NULL; 
	}
}

83 
šlše
 
	$£t
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, cÚ¡ & 
axùid
,

84 
Œx_»suÉ_tu¶e_t
& 
´esuÉ
,

85 cÚ¡ 
·ym’t_šput_t
& 
µš
, cÚ¡ 
boŞ
 
bWake
,

86 
DÜaTPCCEnv
* 
³nv
, 
rvp_ÿche
* 
pc
)

88 
_pš
 = 
µš
;

89 
_bWake
 = 
bWake
;

90 
	`as£¹
 (
³nv
);

91 
_±pcûnv
 = 
³nv
;

92 
	`as£¹
 (
pc
);

93 
_ÿche
 = 
pc
;

94 
	`_£t
(
axù
,
©id
,
axùid
,
´esuÉ
,3,3);

95 
	}
}

96 
šlše
 
	$giveback
(è{ 
_ÿche
->
	`giveback
(
this
); 
	}
}

98 
·ym’t_šput_t
 
	g_pš
;

99 
cc_w¬ehou£_tu¶e
* 
	$wh
(è{  (&
_awh
); 
	}
}

100 
cc_di¡riù_tu¶e
* 
	$di¡
(è{  (&
_adi¡
); 
	}
}

103 
w_rc_t
 
_run
();

117 şas 
	cfš®_·y_rvp
 : 
public
 
‹rmš®_rvp_t


119 
´iv©e
:

120 
objeù_ÿche_t
<
	tfš®_·y_rvp
> 
	trvp_ÿche
;

121 
DÜaTPCCEnv
* 
	m_±pcûnv
;

122 
rvp_ÿche
* 
	m_ÿche
;

123 
	mpublic
:

124 
	$fš®_·y_rvp
(è: 
	`‹rmš®_rvp_t
(), 
	`_±pcûnv
(
NULL
), 
	$_ÿche
(
NULL
) { }

125 ~
	$fš®_·y_rvp
(è{ 
_ÿche
=
NULL
; 
_±pcûnv
=NULL; 
	}
}

128 
šlše
 
	$£t
(
xù_t
* 
pxù
, cÚ¡ 
tid_t
& 
©id
, cÚ¡ 
axùid
,

129 
Œx_»suÉ_tu¶e_t
& 
´esuÉ
,

130 
DÜaTPCCEnv
* 
³nv
, 
rvp_ÿche
* 
pc
)

132 
	`as£¹
 (
³nv
);

133 
_±pcûnv
 = 
³nv
;

134 
	`as£¹
 (
pc
);

135 
_ÿche
 = 
pc
;

136 
	`_£t
(
³nv
->
	`db
(),³nv,
pxù
,
©id
,
axùid
,
´esuÉ
,1,4);

137 
	}
}

138 
šlše
 
	$giveback
(è{ 
_ÿche
->
	`giveback
(
this
); 
	}
}

141 
w_rc_t
 
run
();

142 
upd_comm™‹d_¡©s
();

143 
upd_abÜ‹d_¡©s
();

168 
şass
 
	g·y_aùiÚ
 : 
public
 
¿nge_aùiÚ_im¶
<>

170 
´Ùeùed
:

171 
DÜaTPCCEnv
* 
_±pcûnv
;

172 
·ym’t_šput_t
 
	g_pš
;

174 
šlše
 
_·y_aù_£t
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, 
rvp_t
* 
´vp
,

175 cÚ¡ 
keyËn
, cÚ¡ 
·ym’t_šput_t
& 
pš
,

176 
DÜaTPCCEnv
* 
³nv
)

178 
_¿nge_aù_£t
(
axù
,
©id
,
´vp
,
keyËn
);

179 
	g_pš
 = 
pš
;

180 
as£¹
 (
³nv
);

181 
	g_±pcûnv
 = 
³nv
;

184 
	gpublic
:

185 
·y_aùiÚ
(è: 
¿nge_aùiÚ_im¶
<>(), 
_±pcûnv
(
NULL
) { }

186 
	gvœtu®
 ~
·y_aùiÚ
() { }

188 
vœtu®
 
w_rc_t
 
Œx_exec
()=0;

189 
vœtu®
 
ÿlc_keys
()=0;

195 şas 
	cupd_wh_·y_aùiÚ
 : 
public
 
·y_aùiÚ


197 
´iv©e
:

198 
objeù_ÿche_t
<
	tupd_wh_·y_aùiÚ
> 
	taù_ÿche
;

199 
aù_ÿche
* 
	m_ÿche
;

200 
	mpublic
:

201 
	$upd_wh_·y_aùiÚ
(è: 
	$·y_aùiÚ
() { }

202 ~
	$upd_wh_·y_aùiÚ
(è{ 
	}
}

203 
w_rc_t
 
Œx_exec
();

204 
midway_·y_rvp
* 
	g_m_rvp
;

205 
ÿlc_keys
();

206 
šlše
 
	$£t
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
,

207 
midway_·y_rvp
* 
´vp
,

208 cÚ¡ 
·ym’t_šput_t
& 
pš
,

209 
DÜaTPCCEnv
* 
³nv
, 
aù_ÿche
* 
pc
)

211 
	`as£¹
 (
´vp
);

212 
_m_rvp
 = 
´vp
;

213 
	`as£¹
 (
pc
);

214 
_ÿche
 = 
pc
;

215 
	`_·y_aù_£t
(
axù
,
©id
,
´vp
,1,
pš
,
³nv
);

216 
	}
}

217 
šlše
 
	$giveback
(è{ 
_ÿche
->
	`giveback
(
this
); 
	}
}

223 şas 
	cupd_di¡_·y_aùiÚ
 : 
public
 
·y_aùiÚ


225 
´iv©e
:

226 
objeù_ÿche_t
<
	tupd_di¡_·y_aùiÚ
> 
	taù_ÿche
;

227 
aù_ÿche
* 
	m_ÿche
;

228 
	mpublic
:

229 
	$upd_di¡_·y_aùiÚ
(è: 
	$·y_aùiÚ
() { }

230 ~
	$upd_di¡_·y_aùiÚ
(è{ 
	}
}

231 
w_rc_t
 
Œx_exec
();

232 
midway_·y_rvp
* 
	g_m_rvp
;

233 
ÿlc_keys
();

234 
šlše
 
	$£t
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, 
midway_·y_rvp
* 
amrvp
,

235 cÚ¡ 
·ym’t_šput_t
& 
pš
,

236 
DÜaTPCCEnv
* 
³nv
, 
aù_ÿche
* 
pc
)

238 
	`as£¹
 (
amrvp
);

239 
_m_rvp
 = 
amrvp
;

240 
	`as£¹
 (
pc
);

241 
_ÿche
 = 
pc
;

242 
	`_·y_aù_£t
(
axù
,
©id
,
amrvp
,2,
pš
,
³nv
);

243 
	}
}

244 
šlše
 
	$giveback
(è{ 
_ÿche
->
	`giveback
(
this
); 
	}
}

250 şas 
	cupd_cu¡_·y_aùiÚ
 : 
public
 
·y_aùiÚ


252 
´iv©e
:

253 
objeù_ÿche_t
<
	tupd_cu¡_·y_aùiÚ
> 
	taù_ÿche
;

254 
aù_ÿche
* 
	m_ÿche
;

255 
	mpublic
:

256 
	$upd_cu¡_·y_aùiÚ
(è: 
	$·y_aùiÚ
() { }

257 ~
	$upd_cu¡_·y_aùiÚ
(è{ 
	}
}

258 
w_rc_t
 
Œx_exec
();

259 
midway_·y_rvp
* 
	g_m_rvp
;

260 
ÿlc_keys
();

261 
šlše
 
	$£t
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
,

262 
midway_·y_rvp
* 
´vp
,

263 cÚ¡ 
·ym’t_šput_t
& 
pš
,

264 
DÜaTPCCEnv
* 
³nv
, 
aù_ÿche
* 
pc
)

266 
	`as£¹
 (
´vp
);

267 
_m_rvp
 = 
´vp
;

268 
	`as£¹
 (
pc
);

269 
_ÿche
 = 
pc
;

270 
	`_·y_aù_£t
(
axù
,
©id
,
´vp
,2,
pš
,
³nv
);

271 
	}
}

272 
šlše
 
	$giveback
(è{ 
_ÿche
->
	`giveback
(
this
); 
	}
}

278 şas 
	cšs_hi¡_·y_aùiÚ
 : 
public
 
·y_aùiÚ


280 
´iv©e
:

281 
objeù_ÿche_t
<
	tšs_hi¡_·y_aùiÚ
> 
	taù_ÿche
;

282 
aù_ÿche
* 
	m_ÿche
;

283 
	mpublic
:

284 
	$šs_hi¡_·y_aùiÚ
(è: 
	$·y_aùiÚ
() { }

285 ~
	$šs_hi¡_·y_aùiÚ
(è{ 
	}
}

286 
w_rc_t
 
Œx_exec
();

287 
cc_w¬ehou£_tu¶e
 
	g_awh
;

288 
cc_di¡riù_tu¶e
 
	g_adi¡
;

289 
ÿlc_keys
();

290 
šlše
 
	$£t
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
,

291 
rvp_t
* 
´vp
,

292 cÚ¡ 
·ym’t_šput_t
& 
pš
,

293 
DÜaTPCCEnv
* 
³nv
, 
aù_ÿche
* 
pc
)

295 
	`as£¹
 (
pc
);

296 
_ÿche
 = 
pc
;

297 
	`_·y_aù_£t
(
axù
,
©id
,
´vp
,1,
pš
,
³nv
);

298 
	}
}

299 
šlše
 
	$po¡£t
(cÚ¡ 
cc_w¬ehou£_tu¶e
& 
awh
,

300 cÚ¡ 
cc_di¡riù_tu¶e
& 
adi¡
)

302 
_awh
 = 
awh
;

303 
_adi¡
 = 
adi¡
;

304 
	}
}

305 
šlše
 
	$giveback
(è{ 
_ÿche
->
	`giveback
(
this
); 
	}
}

311 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/tpcc/dora_stock_level.h

35 #iâdeà
__DORA_TPCC_STOCK_LEVEL_H


36 
	#__DORA_TPCC_STOCK_LEVEL_H


	)

39 
	~"dÜa.h
"

40 
	~"wÜklßd/cc/shÜe_cc_’v.h
"

41 
	~"dÜa/cc/dÜa_cc.h
"

43 
usšg
 
Çme¥aû
 
	gshÜe
;

44 
usšg
 
Çme¥aû
 
	gcc
;

47 
ENTER_NAMESPACE
(
dÜa
);

60 
DECLARE_DORA_EMPTY_MIDWAY_RVP_CLASS
(
mid1_¡ock_rvp
,
DÜaTPCCEnv
,
¡ock_Ëv–_šput_t
,1,1);

63 
DECLARE_DORA_EMPTY_MIDWAY_RVP_CLASS
(
mid2_¡ock_rvp
,
DÜaTPCCEnv
,
¡ock_Ëv–_šput_t
,1,2);

65 
DECLARE_DORA_FINAL_RVP_CLASS
(
fš®_¡ock_rvp
,
DÜaTPCCEnv
,1,3);

76 
DECLARE_DORA_ACTION_WITH_RVP_CLASS
(
r_di¡_¡ock_aùiÚ
,,
DÜaTPCCEnv
,
mid1_¡ock_rvp
,
¡ock_Ëv–_šput_t
,2);

79 
DECLARE_DORA_ACTION_WITH_RVP_CLASS
(
r_Ş_¡ock_aùiÚ
,,
DÜaTPCCEnv
,
mid2_¡ock_rvp
,
¡ock_Ëv–_šput_t
,2);

82 
DECLARE_DORA_ACTION_NO_RVP_CLASS
(
r_¡_¡ock_aùiÚ
,,
DÜaTPCCEnv
,
¡ock_Ëv–_šput_t
,2);

85 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/tpcc/dora_tpcc.h

32 #iâdeà
__DORA_TPCC_H


33 
	#__DORA_TPCC_H


	)

36 
	~<c¡dio
>

38 
	~"s.h
"

40 
	~"ut.h
"

41 
	~"wÜklßd/cc/shÜe_cc_’v.h
"

42 
	~"dÜa/dÜa_’v.h
"

43 
	~"dÜa.h
"

45 
usšg
 
Çme¥aû
 
	gshÜe
;

46 
usšg
 
Çme¥aû
 
	gcc
;

49 
ENTER_NAMESPACE
(
dÜa
);

55 
şass
 
	gfš®_mb_rvp
;

56 
şass
 
	gupd_wh_mb_aùiÚ
;

57 
şass
 
	gupd_cu¡_mb_aùiÚ
;

60 
şass
 
	gfš®_·y_rvp
;

61 
şass
 
	gmidway_·y_rvp
;

62 
şass
 
	gupd_wh_·y_aùiÚ
;

63 
şass
 
	gupd_di¡_·y_aùiÚ
;

64 
şass
 
	gupd_cu¡_·y_aùiÚ
;

65 
şass
 
	gšs_hi¡_·y_aùiÚ
;

68 
şass
 
	gfš®_Üd¡_rvp
;

69 
şass
 
	gmid1_Üd¡_rvp
;

70 
şass
 
	gmid2_Üd¡_rvp
;

71 
şass
 
	gr_cu¡_Üd¡_aùiÚ
;

72 
şass
 
	gr_Üd_Üd¡_aùiÚ
;

73 
şass
 
	gr_Ş_Üd¡_aùiÚ
;

77 
şass
 
	gmid1_¡ock_rvp
;

78 
şass
 
	gmid2_¡ock_rvp
;

79 
şass
 
	gfš®_¡ock_rvp
;

80 
şass
 
	gr_di¡_¡ock_aùiÚ
;

81 
şass
 
	gr_Ş_¡ock_aùiÚ
;

82 
şass
 
	gr_¡_¡ock_aùiÚ
;

85 
şass
 
	gmid1_d–_rvp
;

86 
şass
 
	gmid2_d–_rvp
;

87 
şass
 
	gfš®_d–_rvp
;

88 
şass
 
	gd–_nÜd_d–_aùiÚ
;

89 
şass
 
	gupd_Üd_d–_aùiÚ
;

90 
şass
 
	gupd_Şše_d–_aùiÚ
;

91 
şass
 
	gupd_cu¡_d–_aùiÚ
;

94 
şass
 
	gmid1_nÜd_rvp
;

95 
şass
 
	gmid2_nÜd_rvp
;

96 
şass
 
	gmid3_nÜd_rvp
;

97 
şass
 
	gfš®_nÜd_rvp
;

98 
şass
 
	gr_wh_nÜd_aùiÚ
;

99 
şass
 
	gr_cu¡_nÜd_aùiÚ
;

100 
şass
 
	gupd_di¡_nÜd_aùiÚ
;

101 
şass
 
	gr_™em_nÜd_aùiÚ
;

102 
şass
 
	gupd_¡o_nÜd_aùiÚ
;

103 
şass
 
	gšs_Üd_nÜd_aùiÚ
;

104 
şass
 
	gšs_nÜd_nÜd_aùiÚ
;

105 
şass
 
	gšs_Ş_nÜd_aùiÚ
;

117 
şass
 
	gDÜaTPCCEnv
 : 
public
 
ShÜeTPCCEnv
,…ubliø
	gDÜaEnv


119 
	gpublic
:

121 
DÜaTPCCEnv
();

122 
	gvœtu®
 ~
DÜaTPCCEnv
();

127 
¡¬t
();

128 
¡İ
();

129 
»sume
();

130 
·u£
();

131 
w_rc_t
 
Ãwrun
();

132 
£t
(
’vV¬M­
* ) { (0); };

133 
dump
();

134 
šfo
() const;

135 
¡©i¡ics
();

136 
cÚf
();

139 
w_rc_t
 
upd©e_·¹™iÚšg
();

142 
DECLARE_DORA_PARTS
(
whs
);

143 
DECLARE_DORA_PARTS
(
dis
);

144 
DECLARE_DORA_PARTS
(
cus
);

145 
DECLARE_DORA_PARTS
(
his
);

146 
DECLARE_DORA_PARTS
(
nÜ
);

147 
DECLARE_DORA_PARTS
(
Üd
);

148 
DECLARE_DORA_PARTS
(
™e
);

149 
DECLARE_DORA_PARTS
(
Şi
);

150 
DECLARE_DORA_PARTS
(
¡o
);

155 
DECLARE_DORA_TRX
(
Ãw_Üd”
);

156 
DECLARE_DORA_TRX
(
·ym’t
);

157 
DECLARE_DORA_TRX
(
Üd”_¡©us
);

158 
DECLARE_DORA_TRX
(
d–iv”y
);

159 
DECLARE_DORA_TRX
(
¡ock_Ëv–
);

161 
DECLARE_DORA_TRX
(
mb’ch_wh
);

162 
DECLARE_DORA_TRX
(
mb’ch_cu¡
);

170 
DECLARE_DORA_FINAL_RVP_GEN_FUNC
(
fš®_mb_rvp
);

173 
DECLARE_DORA_ACTION_GEN_FUNC
(
upd_wh_mb_aùiÚ
,
rvp_t
,
mb’ch_wh_šput_t
);

175 
DECLARE_DORA_ACTION_GEN_FUNC
(
upd_cu¡_mb_aùiÚ
,
rvp_t
,
mb’ch_cu¡_šput_t
);

183 
DECLARE_DORA_MIDWAY_RVP_GEN_FUNC
(
midway_·y_rvp
,
·ym’t_šput_t
);

185 
DECLARE_DORA_FINAL_RVP_WITH_PREV_GEN_FUNC
(
fš®_·y_rvp
);

188 
DECLARE_DORA_ACTION_GEN_FUNC
(
upd_wh_·y_aùiÚ
,
midway_·y_rvp
,
·ym’t_šput_t
);

189 
DECLARE_DORA_ACTION_GEN_FUNC
(
upd_di¡_·y_aùiÚ
,
midway_·y_rvp
,
·ym’t_šput_t
);

190 
DECLARE_DORA_ACTION_GEN_FUNC
(
upd_cu¡_·y_aùiÚ
,
midway_·y_rvp
,
·ym’t_šput_t
);

192 
DECLARE_DORA_ACTION_GEN_FUNC
(
šs_hi¡_·y_aùiÚ
,
rvp_t
,
·ym’t_šput_t
);

200 
DECLARE_DORA_MIDWAY_RVP_GEN_FUNC
(
mid1_Üd¡_rvp
,
Üd”_¡©us_šput_t
);

202 
DECLARE_DORA_MIDWAY_RVP_WITH_PREV_GEN_FUNC
(
mid2_Üd¡_rvp
,
Üd”_¡©us_šput_t
);

204 
DECLARE_DORA_FINAL_RVP_WITH_PREV_GEN_FUNC
(
fš®_Üd¡_rvp
);

206 
DECLARE_DORA_ACTION_GEN_FUNC
(
r_cu¡_Üd¡_aùiÚ
,
mid1_Üd¡_rvp
,
Üd”_¡©us_šput_t
);

207 
DECLARE_DORA_ACTION_GEN_FUNC
(
r_Üd_Üd¡_aùiÚ
,
mid2_Üd¡_rvp
,
Üd”_¡©us_šput_t
);

209 
DECLARE_DORA_ACTION_GEN_FUNC
(
r_Ş_Üd¡_aùiÚ
,
rvp_t
,
Üd”_¡©us_šput_t
);

216 
DECLARE_DORA_MIDWAY_RVP_GEN_FUNC
(
mid1_¡ock_rvp
,
¡ock_Ëv–_šput_t
);

217 
DECLARE_DORA_MIDWAY_RVP_WITH_PREV_GEN_FUNC
(
mid2_¡ock_rvp
,
¡ock_Ëv–_šput_t
);

219 
DECLARE_DORA_FINAL_RVP_WITH_PREV_GEN_FUNC
(
fš®_¡ock_rvp
);

221 
DECLARE_DORA_ACTION_GEN_FUNC
(
r_di¡_¡ock_aùiÚ
,
mid1_¡ock_rvp
,
¡ock_Ëv–_šput_t
);

222 
DECLARE_DORA_ACTION_GEN_FUNC
(
r_Ş_¡ock_aùiÚ
,
mid2_¡ock_rvp
,
¡ock_Ëv–_šput_t
);

224 
DECLARE_DORA_ACTION_GEN_FUNC
(
r_¡_¡ock_aùiÚ
,
rvp_t
,
¡ock_Ëv–_šput_t
);

233 
DECLARE_DORA_MIDWAY_RVP_GEN_FUNC
(
mid1_d–_rvp
,
d–iv”y_šput_t
);

237 
DECLARE_DORA_MIDWAY_RVP_WITH_PREV_GEN_FUNC
(
mid2_d–_rvp
,
d–iv”y_šput_t
);

242 
DECLARE_DORA_FINAL_RVP_GEN_FUNC
(
fš®_d–_rvp
);

245 
DECLARE_DORA_ACTION_GEN_FUNC
(
d–_nÜd_d–_aùiÚ
,
mid1_d–_rvp
,
d–iv”y_šput_t
);

248 
DECLARE_DORA_ACTION_GEN_FUNC
(
upd_Üd_d–_aùiÚ
,
mid2_d–_rvp
,
d–iv”y_šput_t
);

252 
DECLARE_DORA_ACTION_GEN_FUNC
(
upd_Şše_d–_aùiÚ
,
mid2_d–_rvp
,
d–iv”y_šput_t
);

256 
DECLARE_DORA_ACTION_GEN_FUNC
(
upd_cu¡_d–_aùiÚ
,
rvp_t
,
d–iv”y_šput_t
);

269 
DECLARE_DORA_MIDWAY_RVP_GEN_FUNC
(
mid1_nÜd_rvp
,
Ãw_Üd”_šput_t
);

271 
DECLARE_DORA_MIDWAY_RVP_WITH_PREV_GEN_FUNC
(
mid2_nÜd_rvp
,
Ãw_Üd”_šput_t
);

273 
DECLARE_DORA_MIDWAY_RVP_WITH_PREV_GEN_FUNC
(
mid3_nÜd_rvp
,
Ãw_Üd”_šput_t
);

275 
DECLARE_DORA_FINAL_RVP_WITH_PREV_GEN_FUNC
(
fš®_nÜd_rvp
);

279 
DECLARE_DORA_ACTION_GEN_FUNC
(
r_wh_nÜd_aùiÚ
,
mid1_nÜd_rvp
,
no_™em_nÜd_šput_t
);

281 
DECLARE_DORA_ACTION_GEN_FUNC
(
upd_di¡_nÜd_aùiÚ
,
mid1_nÜd_rvp
,
no_™em_nÜd_šput_t
);

283 
DECLARE_DORA_ACTION_GEN_FUNC
(
r_cu¡_nÜd_aùiÚ
,
mid1_nÜd_rvp
,
no_™em_nÜd_šput_t
);

285 
DECLARE_DORA_ACTION_GEN_FUNC
(
r_™em_nÜd_aùiÚ
,
mid1_nÜd_rvp
,
Ãw_Üd”_šput_t
);

289 
DECLARE_DORA_ACTION_GEN_FUNC
(
šs_Üd_nÜd_aùiÚ
,
mid2_nÜd_rvp
,
no_™em_nÜd_šput_t
);

291 
DECLARE_DORA_ACTION_GEN_FUNC
(
šs_nÜd_nÜd_aùiÚ
,
mid2_nÜd_rvp
,
no_™em_nÜd_šput_t
);

295 
DECLARE_DORA_ACTION_GEN_FUNC
(
šs_Ş_nÜd_aùiÚ
,
mid3_nÜd_rvp
,
Ãw_Üd”_šput_t
);

299 
DECLARE_DORA_ACTION_GEN_FUNC
(
upd_¡o_nÜd_aùiÚ
,
rvp_t
,
Ãw_Üd”_šput_t
);

306 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/tpcc/dora_tpcc_client.h

31 #iâdeà
__DORA_TPCC_CLIENT_H


32 
	#__DORA_TPCC_CLIENT_H


	)

35 
	~"wÜklßd/cc/cc_cÚ¡.h
"

36 
	~"dÜa/cc/dÜa_cc.h
"

38 
usšg
 
Çme¥aû
 
	gshÜe
;

41 
ENTER_NAMESPACE
(
dÜa
);

53 şas 
	cdÜa_cc_ş›Á_t
 : 
public
 
ba£_ş›Á_t


55 
´iv©e
:

57 
DÜaTPCCEnv
* 
_ccdb
;

58 
	m_wh
;

59 
	m_qf
;

61 
	mpublic
:

63 
	$dÜa_cc_ş›Á_t
() { }

65 
	$dÜa_cc_ş›Á_t
(
c_¡r
 
Šame
, cÚ¡ 
id
, 
DÜaTPCCEnv
* 
’v
,

66 cÚ¡ 
M—su»m’tTy³
 
aTy³
, cÚ¡ 
Œxid
,

67 cÚ¡ 
numOfTrxs
,

68 
´oûssÜid_t
 
­rsid
, cÚ¡ 
sWH
, cÚ¡ 
qf
)

69 : 
	`ba£_ş›Á_t
(
Šame
,
id
,
’v
,
aTy³
,
Œxid
,
numOfTrxs
,
­rsid
),

70 
	`_ccdb
(
’v
), 
	`_wh
(
sWH
), 
	$_qf
(
qf
)

72 
	`as£¹
 (
’v
);

73 
	`as£¹
 (
_wh
>=0 && 
_qf
>0);

74 
	}
}

76 ~
	$dÜa_cc_ş›Á_t
(è{ 
	}
}

79 
lßd_sup_xù
(
m­SupTrxs
& 
m­
);

83 
w_rc_t
 
subm™_Úe
(
xù_ty³
, 
xùid
);

89 
EXIT_NAMESPACE
(
dÜa
);

	@include/dora/worker.h

32 #iâdeà
__DORA_WORKER_H


33 
	#__DORA_WORKER_H


	)

35 
	~"sm/shÜe/shÜe_wÜk”.h
"

37 
	~"dÜa/ba£_·¹™iÚ.h
"

38 
	~"dÜa/ba£_aùiÚ.h
"

40 
usšg
 
Çme¥aû
 
	gshÜe
;

43 
ENTER_NAMESPACE
(
dÜa
);

55 şas 
	cdÜa_wÜk”_t
 : 
public
 
ba£_wÜk”_t


57 
´iv©e
:

59 
ba£_·¹™iÚ_t
* 
_·¹™iÚ
;

62 
_wÜk_ACTIVE_im¶
();

64 
_´e_STOP_im¶
();

67 
_£rve_aùiÚ
(
ba£_aùiÚ_t
* 
·ùiÚ
);

69 
	mpublic
:

71 
dÜa_wÜk”_t
(
ShÜeEnv
* 
’v
, 
ba£_·¹™iÚ_t
* 
­¬t
, 
c_¡r
 
Šame
,

72 
´oûssÜid_t
 
­rsid
 = 
PBIND_NONE
, cÚ¡ 
u£_¦i
 = 0);

74 ~
dÜa_wÜk”_t
();

80 
£t_·¹™iÚ
(
ba£_·¹™iÚ_t
* 
­¬t
);

81 
ba£_·¹™iÚ_t
* 
g‘_·¹™iÚ
();

82 
doRecov”y
();

87 
EXIT_NAMESPACE
(
dÜa
);

	@include/k_defines.h

34 #iâdeà
__KITS_DEFINES_H


35 
	#__KITS_DEFINES_H


	)

40 
	~<w_defšes.h
>

41 
	~<©omic_‹m¶©es.h
>

43 
	~"sm_vas.h
"

44 
queue_ba£d_lock_t
 
	tmcs_lock
;

46 
	~"block_®loc.h
"

48 #ifdeà
PACKAGE


49 #undeà
PACKAGE


51 #ifdeà
PACKAGE_NAME


52 #undeà
PACKAGE_NAME


54 #ifdeà
PACKAGE_STRING


55 #undeà
PACKAGE_STRING


57 #ifdeà
PACKAGE_BUGREPORT


58 #undeà
PACKAGE_BUGREPORT


60 #ifdeà
PACKAGE_TARNAME


61 #undeà
PACKAGE_TARNAME


63 #ifdeà
PACKAGE_VERSION


64 #undeà
PACKAGE_VERSION


66 #ifdeà
VERSION


67 #undeà
VERSION


69 
	~"k™s-cÚfig.h
"

71 #ifdeà
__SUNPRO_CC


72 
	~<¡dlib.h
>

73 
	~<¡dio.h
>

74 
	~<¡ršg.h
>

75 
	~<¡d¬g.h
>

77 
	~<c¡dlib
>

78 
	~<c¡dio
>

79 
	~<c¡ršg
>

80 
	~<c¡d¬g
>

84 #iâdeà
__¥¬cv9


86 
	t´oûssÜid_t
;

87 cÚ¡ 
	gPBIND_NONE
 = -1;

97 
	~<sys/ty³s.h
>

98 
	~<sys/´oûssÜ.h
>

99 
	~<sys/´oc£t.h
>

	@include/kits-config.h

8 
	#CFG_CACHES
 1

	)

32 
	#HAVE_INTTYPES_H
 1

	)

38 
	#HAVE_MEMORY_H
 1

	)

47 
	#HAVE_PTHREAD
 1

	)

50 
	#HAVE_PTHREAD_PRIO_INHERIT
 1

	)

59 
	#HAVE_STDINT_H
 1

	)

62 
	#HAVE_STDLIB_H
 1

	)

65 
	#HAVE_STRINGS_H
 1

	)

68 
	#HAVE_STRING_H
 1

	)

71 
	#HAVE_SYS_STAT_H
 1

	)

74 
	#HAVE_SYS_TYPES_H
 1

	)

77 
	#HAVE_UNISTD_H
 1

	)

80 
	#PACKAGE
 "this_is_shÜe_k™s"

	)

83 
	#PACKAGE_BUGREPORT
 ""

	)

86 
	#PACKAGE_NAME
 "THIS_IS_SHORE_KITS"

	)

89 
	#PACKAGE_STRING
 "THIS_IS_SHORE_KITS 2.1"

	)

92 
	#PACKAGE_TARNAME
 "this_is_shÜe_k™s"

	)

95 
	#PACKAGE_URL
 ""

	)

98 
	#PACKAGE_VERSION
 "2.1"

	)

105 
	#STDC_HEADERS
 1

	)

108 
	#VERSION
 "2.1"

	)

	@include/qpipe.h

24 #iâdeà
__QPIPE_H


25 
	#__QPIPE_H


	)

27 
	~"qpe/scheduËr.h
"

28 
	~"qpe/cÜe.h
"

29 
	~"qpe/¡ages.h
"

30 
	~"qpe/qcommÚ.h
"

	@include/qpipe/common/int_comparator.h

24 #iâdeà
__QPIPE_INT_COMPARATOR_H


25 
	#__QPIPE_INT_COMPARATOR_H


	)

27 
	~"qpe/cÜe.h
"

29 
ENTER_NAMESPACE
(
qpe
);

31 
	gšt_key_com·»_t
 : 
public
 
key_com·»_t
 {

32 
vœtu®
 
İ”©Ü
()(const *, const *) const {

33 
uÄ—chabË
();

35 
vœtu®
 
key_com·»_t
* 
şÚe
() const {

36  
Ãw
 
št_key_com·»_t
(*
this
);

40 
deçuÉ_key_exŒaùÜ_t
 
	tšt_key_exŒaùÜ_t
;

42 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/common/predicates.h

2 #iâdeà
__QPIPE_PREDICATES_H


3 
	#__QPIPE_PREDICATES_H


	)

5 
	~"ut.h
"

6 
	~"qpe/cÜe/tu¶e.h
"

7 
	~<veùÜ
>

8 
	~<®gÜ™hm
>

9 
	~<funùiÚ®
>

10 
	~<¡ršg
>

11 
	~<cm©h
>

12 
	~<ÿs£¹
>

14 
usšg
 
	g¡d
::
veùÜ
;

15 
usšg
 
	g¡d
::
¡ršg
;

16 
usšg
 
	g¡d
::
Ëss
;

17 
usšg
 
	g¡d
::
g»©”
;

18 
usšg
 
	g¡d
::
Ëss_equ®
;

19 
usšg
 
	g¡d
::
g»©”_equ®
;

20 
usšg
 
	g¡d
::
equ®_to
;

21 
usšg
 
	g¡d
::
nÙ_equ®_to
;

24 
ENTER_NAMESPACE
(
qpe
);

31 
	s´ediÿ‹_t
 {

32 
vœtu®
 
boŞ
 
£Ëù
(cÚ¡ 
tu¶e_t
 &
tu¶e
)=0;

34 
vœtu®
 
´ediÿ‹_t
* 
şÚe
() const=0;

36 
	mvœtu®
 ~
´ediÿ‹_t
() { }

49 
	g‹m¶©e
 <
ty³Çme
 
	gV
,em¶©e<
	gşass
> 
şass
 
	gT
=
equ®_to
>

50 şas 
	csÿÏr_´ediÿ‹_t
 : 
public
 
´ediÿ‹_t
 {

51 
V
 
_v®ue
;

52 
size_t
 
	m_off£t
;

53 
	mpublic
:

54 
	$sÿÏr_´ediÿ‹_t
(
V
 
v®ue
, 
size_t
 
off£t
)

55 : 
	`_v®ue
(
v®ue
), 
	$_off£t
(
off£t
)

58 
vœtu®
 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
tu¶e
) {

59 
V
* 
f›ld
 = 
®igÃd_ÿ¡
<V>(
tu¶e
.
d©a
 + 
_off£t
);

60  
T
<
V
>()(*
f›ld
, 
_v®ue
);

61 
	}
}

62 
vœtu®
 
sÿÏr_´ediÿ‹_t
* 
	$şÚe
() const {

63  
Ãw
 
	`sÿÏr_´ediÿ‹_t
(*
this
);

64 
	}
}

75 
	g‹m¶©e
 <‹m¶©e<
	gşass
> 
şass
 
	gT
=
equ®_to
>

76 şas 
	c¡ršg_´ediÿ‹_t
 : 
public
 
´ediÿ‹_t
 {

77 
¡ršg
 
_v®ue
;

78 
size_t
 
	m_off£t
;

79 
	mpublic
:

80 
	$¡ršg_´ediÿ‹_t
(cÚ¡ 
¡ršg
 &
v®ue
, 
size_t
 
off£t
)

81 : 
	`_v®ue
(
v®ue
), 
	$_off£t
(
off£t
)

84 
vœtu®
 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
tu¶e
) {

85 cÚ¡ * 
f›ld
 = 
tu¶e
.
d©a
 + 
_off£t
;

86  
T
<>()(
	`¡rcmp
(
f›ld
, 
_v®ue
.
	`c_¡r
()), 0);

87 
	}
}

88 
vœtu®
 
¡ršg_´ediÿ‹_t
* 
	$şÚe
() const {

89  
Ãw
 
	`¡ršg_´ediÿ‹_t
(*
this
);

90 
	}
}

97 
	g‹m¶©e
 <
boŞ
 
	gINVERTED
=
çl£
>

98 şas 
	clike_´ediÿ‹
 : 
public
 
´ediÿ‹_t
 {

99 
size_t
 
_off£t
;

102 
¡ršg
 
	m_bŞ
;

104 
¡ršg
 
	m_eŞ
;

106 
	mveùÜ
<
	t¡ršg
> 
	täagm’t_li¡
;

107 
äagm’t_li¡
 
	m_äagm’ts
;

108 
	$š™
(cÚ¡ 
¡ršg
 &
v®ue
) {

109 
size_t
 
beg
 = 0;

110 
size_t
 
’d
 = 
v®ue
.
	`fšd
('%');

113 if(
beg
 !ğ
’d
)

114 
_bŞ
 = 
v®ue
.
	`sub¡r
(
beg
, 
’d
);

118 
beg
 = 
’d
;

119 
’d
 = 
v®ue
.
	`fšd
('%',ƒnd+1);

120 if(
’d
 =ğ
¡ršg
::
Åos
)

123 
_äagm’ts
.
	`push_back
(
v®ue
.
	`sub¡r
(
beg
, 
’d
));

127 if((
beg
 + 1è!ğ
v®ue
.
	`size
())

128 
_eŞ
 = 
v®ue
.
	`sub¡r
(
beg
, v®ue.
	`size
());

130 
public
:

131 
	$like_´ediÿ‹
(cÚ¡ 
¡ršg
 &
v®ue
, 
size_t
 
off£t
)

132 : 
	$_off£t
(
off£t
)

134 
	`as£¹
(
v®ue
.
	`size
());

135 
	`š™
(
v®ue
);

136 
	}
}

137 
vœtu®
 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
tu¶e
) {

138 cÚ¡ * 
f›ld
 = 
tu¶e
.
d©a
 + 
_off£t
;

139 cÚ¡ * 
m¬k
;

142 if(
_bŞ
.
	`size
()) {

143 
m¬k
 = 
	`¡r¡r
(
f›ld
, 
_bŞ
.
	`c_¡r
());

144 if(
m¬k
 !ğ
f›ld
)

145  
INVERTED
;

148 
f›ld
 = 
m¬k
 + 
_bŞ
.
	`size
();

152 
äagm’t_li¡
::
™”©Ü
 
™
=
_äagm’ts
.
	`begš
(); iˆ!ğ_äagm’ts.
	`’d
(); ++it) {

153 
m¬k
 = 
	`¡r¡r
(
f›ld
, 
™
->
	`c_¡r
());

154 if(!
m¬k
)

155  
INVERTED
;

157 
f›ld
 = 
m¬k
 + 
™
->
	`size
();

161 if(
_eŞ
.
	`size
()) {

162 
m¬k
 = 
	`¡r¡r
(
f›ld
, 
_eŞ
.
	`c_¡r
());

164 if(!
m¬k
 || m¬k[
_eŞ
.
	`size
()])

165  
INVERTED
;

169  !
INVERTED
;

170 
	}
}

171 
vœtu®
 
like_´ediÿ‹
* 
	$şÚe
() const {

172  
Ãw
 
	`like_´ediÿ‹
(*
this
);

173 
	}
}

178 
	glike_´ediÿ‹
<
	tçl£
> 
	tlike_´ediÿ‹_t
;

179 
	glike_´ediÿ‹
<
	tŒue
> 
	tnÙ_like_´ediÿ‹_t
;

183 
	g‹m¶©e
 <
ty³Çme
 
	gV
,em¶©e<
	gşass
> 
şass
 
	gT
=
equ®_to
>

184 şas 
	cf›ld_´ediÿ‹_t
 : 
public
 
´ediÿ‹_t
 {

185 
size_t
 
_off£t1
;

186 
size_t
 
	m_off£t2
;

187 
	mpublic
:

188 
	$f›ld_´ediÿ‹_t
(
size_t
 
off£t1
, size_ˆ
off£t2
)

189 : 
	`_off£t1
(
off£t1
), 
	$_off£t2
(
off£t2
)

192 
vœtu®
 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
tu¶e
) {

193 
V
* 
f›ld1
 = 
®igÃd_ÿ¡
<V>(
tu¶e
.
d©a
 + 
_off£t1
);

194 
V
* 
f›ld2
 = 
®igÃd_ÿ¡
<V>(
tu¶e
.
d©a
 + 
_off£t2
);

195  
T
<
V
>()(*
f›ld1
, *
f›ld2
);

196 
	}
}

197 
vœtu®
 
f›ld_´ediÿ‹_t
* 
	$şÚe
() const {

198  
Ãw
 
	`f›ld_´ediÿ‹_t
(*
this
);

199 
	}
}

208 
	g‹m¶©e
<
boŞ
 
	gDISJUNCTION
>

209 şas 
	ccompound_´ediÿ‹_t
 : 
public
 
´ediÿ‹_t
 {

210 
public
:

211 
¡d
::
	tveùÜ
<
	t´ediÿ‹_t
*> 
	t´ediÿ‹_li¡_t
;

213 
	m´iv©e
:

214 
´ediÿ‹_li¡_t
 
_li¡
;

219 
	s‹¡_t
 {

220 cÚ¡ 
	mtu¶e_t
 &
	m_t
;

221 
‹¡_t
(cÚ¡ 
tu¶e_t
 &
t
è: 
_t
(t) { }

222 
boŞ
 
İ”©Ü
()(
´ediÿ‹_t
* 
p
) {

223  
p
->
£Ëù
(
_t
è=ğ
DISJUNCTION
;

228 
	sşÚe_t
 {

229 
´ediÿ‹_t
* 
İ”©Ü
()Õ»diÿ‹_t* 
	gp
) {

230  
	gp
->
şÚe
();

235 
	sd–‘e_t
 {

236 
İ”©Ü
()(
´ediÿ‹_t
* 
	gp
) {

237 
d–‘e
 
	gp
;

240 
	$şÚe_li¡
() {

242 
¡d
::
	`ŒªsfÜm
(
_li¡
.
	`begš
(), _li¡.
	`’d
(), _li¡.begš(), 
	`şÚe_t
());

243 
	}
}

245 
	gpublic
:

246 
	$add
(
´ediÿ‹_t
* 
p
) {

247 
_li¡
.
	`push_back
(
p
);

248 
	}
}

249 
vœtu®
 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
t
) {

251 
´ediÿ‹_li¡_t
::
™”©Ü
 
»suÉ
;

252 
»suÉ
 = 
¡d
::
	`fšd_if
(
_li¡
.
	`begš
(), _li¡.
	`’d
(), 
	`‹¡_t
(
t
));

256  
DISJUNCTION
? 
»suÉ
 !ğ
_li¡
.
	`’d
() :„esult == _list.end();

257 
	}
}

258 
vœtu®
 
compound_´ediÿ‹_t
* 
	$şÚe
() const {

259  
Ãw
 
	`compound_´ediÿ‹_t
(*
this
);

260 
	}
}

261 
	$compound_´ediÿ‹_t
(cÚ¡ 
compound_´ediÿ‹_t
 &
Ùh”
)

262 : 
	`´ediÿ‹_t
(
Ùh”
), 
	$_li¡
(
Ùh”
.
_li¡
)

264 
	`şÚe_li¡
();

265 
	}
}

266 
	$compound_´ediÿ‹_t
(è{ 
	}
}

267 
	gcompound_´ediÿ‹_t
 &
	gİ”©Ü
=(cÚ¡ 
compound_´ediÿ‹_t
 &
Ùh”
) {

268 
_li¡
 = 
Ùh”
._list;

269 
şÚe_li¡
();

271 
	gvœtu®
 ~
	$compound_´ediÿ‹_t
() {

272 
¡d
::
	`fÜ_—ch
(
_li¡
.
	`begš
(), _li¡.
	`’d
(), 
	`d–‘e_t
());

273 
	}
}

278 
	gcompound_´ediÿ‹_t
<
	tçl£
> 
	tªd_´ediÿ‹_t
;

279 
	gcompound_´ediÿ‹_t
<
	tŒue
> 
	tÜ_´ediÿ‹_t
;

288 şas 
	c´ediÿ‹_¿ndg’_t
 {

291 
	mINVALID
,

292 
	mUSE_THREAD_LOCAL
,

293 
	mUSE_CALLER


294 } 
	g_ty³
;

295 
¿ndg’_t
 
	g_ÿÎ”_¿ndg’
;

296 
¿ndg’_t
* 
	g_th»ad_loÿl_¿ndg’
;

300 
	$´ediÿ‹_¿ndg’_t
 ()

301 : 
	`_ty³
(
INVALID
),

302 
	`_ÿÎ”_¿ndg’
(),

303 
	$_th»ad_loÿl_¿ndg’
(
NULL
)

305 
	}
}

307 
	$´ediÿ‹_¿ndg’_t
 (
¿ndg’_t
* 
¿ndg’
)

308 : 
	`_ty³
(
USE_THREAD_LOCAL
),

309 
	`_ÿÎ”_¿ndg’
(),

310 
	$_th»ad_loÿl_¿ndg’
(
¿ndg’
)

312 
	}
}

314 
	$´ediÿ‹_¿ndg’_t
 (cÚ¡ * 
ÿÎ”_g
)

315 : 
	`_ty³
(
USE_CALLER
),

316 
	`_ÿÎ”_¿ndg’
(
	`RSHash
(
ÿÎ”_g
, 
	`¡¾’
(caller_tag))),

317 
	$_th»ad_loÿl_¿ndg’
(
NULL
)

319 
	}
}

321 
	gpublic
:

323 
¿ndg’_t
* 
	$¿ndg’
() {

324 
_ty³
) {

325 
USE_THREAD_LOCAL
:

326 
	`as£¹
(
_th»ad_loÿl_¿ndg’
 !ğ
NULL
);

327  
_th»ad_loÿl_¿ndg’
;

328 
USE_CALLER
:

329  &
_ÿÎ”_¿ndg’
;

331 
	`as£¹
(0);

333 
	}
}

335 
	$¿nd
() {

336  
	`¿ndg’
()->
	`¿nd
();

337 
	}
}

339 
	$¿nd
(
n
) {

340  
	`¿ndg’
()->
	`¿nd
(
n
);

341 
	}
}

343 
´ediÿ‹_¿ndg’_t
 
acquœe
(cÚ¡ * 
ÿÎ”_g
);

353 
	#ACQUIRE_PREDICATE_RANDGEN
(
lv®
) \

354 
´ediÿ‹_¿ndg’_t
 
lv®
õ»diÿ‹_¿ndg’_t::
	`acquœe
(
__FUNCTION__
)

	)

358 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/common/process_query.h

24 #iâdeà
__QPIPE_PROCESS_QUERY_H


25 
	#__QPIPE_PROCESS_QUERY_H


	)

27 
	~"qpe/commÚ/´oûss_tu¶e.h
"

29 
ENTER_NAMESPACE
(
qpe
);

31 
´oûss_qu”y
(
·ck‘_t
* 
roÙ
, 
´oûss_tu¶e_t
& 
±
);

33 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/common/process_tuple.h

32 #iâdeà
__QPIPE_PROCESS_TUPLE_H


33 
	#__QPIPE_PROCESS_TUPLE_H


	)

35 
	~"qpe/cÜe/tu¶e.h
"

36 
	~"qpe/cÜe/·ck‘.h
"

39 
ENTER_NAMESPACE
(
qpe
);

42 şas 
	c´oûss_tu¶e_t
 {

43 
	mpublic
:

44 
vœtu®
 
	$begš
() { }

45 
vœtu®
 
	`´oûss
(cÚ¡ 
tu¶e_t
&)=0;

46 
vœtu®
 
	$’d
(è{ 
	}
}

47 
	gvœtu®
 ~
	$´oûss_tu¶e_t
(è{ 
	}
}

51 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/core.h

24 #iâdeà
__QPIPE_CORE_H


25 
	#__QPIPE_CORE_H


	)

27 
	~"qpe/cÜe/ıu_bšd.h
"

28 
	~"qpe/cÜe/di¥©ch”.h
"

29 
	~"qpe/cÜe/funùÜs.h
"

30 
	~"qpe/cÜe/·ck‘.h
"

31 
	~"qpe/cÜe/¡age.h
"

32 
	~"qpe/cÜe/¡age_cÚš”.h
"

33 
	~"qpe/cÜe/tu¶e.h
"

34 
	~"qpe/cÜe/tu¶e_fifo.h
"

	@include/qpipe/core/cpu_bind.h

24 #iâdeà
__CPU_BIND_H


25 
	#__CPU_BIND_H


	)

27 
	~"ut.h
"

29 
ENTER_NAMESPACE
(
qpe
);

31 
şass
 
	g·ck‘_t
;

33 
	sıu_bšd
 {

34 
	mnİ
;

35 
	mpublic
:

38 
vœtu®
 
bšd
(
·ck‘_t
* 
·ck‘
)=0;

39 
	mvœtu®
 ~
ıu_bšd
() { }

42 
	gıu_bšd
::
nİ
 : 
ıu_bšd
 {

43 
vœtu®
 
bšd
(
·ck‘_t
*) {

48 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/core/dispatcher.h

24 #iâdeà
__QPIPE_DISPATCHER_H


25 
	#__QPIPE_DISPATCHER_H


	)

27 
	~"qpe/cÜe/tu¶e.h
"

28 
	~"qpe/cÜe/·ck‘.h
"

29 
	~"qpe/cÜe/¡age_cÚš”.h
"

30 
	~"ut/»sourû_deş¬e.h
"

31 
	~"ut/»sourû_»Ëa£r.h
"

32 
	~<m­
>

34 
usšg
 
	g¡d
::
m­
;

37 
ENTER_NAMESPACE
(
qpe
);

40 
DEFINE_EXCEPTION
(
Di¥©ch”Exû±iÚ
);

45 
	#TRACE_RESOURCE_RELEASE
 0

	)

46 cÚ¡ 
	gDISPATCHER_NUM_STATIC_HASH_MAP_BUCKETS
 = 64;

62 şas 
	cdi¥©ch”_t
 {

64 
	m´Ùeùed
:

68 
m­
<
c_¡r
, 
	m¡age_cÚš”_t
*> 
	m_scdœ
;

69 
	mm­
<
	mc_¡r
, 
	mboŞ
> 
	m_o¥dœ
;

72 
di¥©ch”_t
();

73 ~
di¥©ch”_t
();

77 
_»gi¡”_¡age_cÚš”
(cÚ¡ 
c_¡r
& 
·ck‘_ty³
,

78 
¡age_cÚš”_t
* 
sc
, 
boŞ
 
o¥
);

79 
_di¥©ch_·ck‘
(
·ck‘_t
* 
·ck‘
);

80 
_»£rve_wÜk”s
(cÚ¡ 
c_¡r
& 
ty³
, 
n
);

81 
_uÄe£rve_wÜk”s
(cÚ¡ 
c_¡r
& 
ty³
, 
n
);

82 
boŞ
 
_is_o¥_’abËd_fÜ_ty³
(cÚ¡ 
c_¡r
& 
·ck‘_ty³
);

85 
_£t_o¥_fÜ_ty³
(cÚ¡ 
c_¡r
& 
·ck‘_ty³
, 
boŞ
 
o¥_sw™ch
);

88 
±h»ad_mu‹x_t
 
	m_š¡ªû_lock
;

89 
di¥©ch”_t
* 
	m_š¡ªû
;

92 
di¥©ch”_t
* 
	$š¡ªû
() {

94 
ü™iÿl_£ùiÚ_t
 
	`cs
(
_š¡ªû_lock
);

95 iàĞ
_š¡ªû
 =ğ
NULL
 )

96 
_š¡ªû
 = 
Ãw
 
	`di¥©ch”_t
();

102  
_š¡ªû
;

106 
public
:

110 
şass
 
wÜk”_»£rv”_t
;

111 
şass
 
wÜk”_»Ëa£r_t
;

115 
	$š™
() {

116 
_š¡ªû
 = 
Ãw
 
	`di¥©ch”_t
();

117 
	}
}

120 
	$»gi¡”_¡age_cÚš”
(cÚ¡ 
c_¡r
 &
·ck‘_ty³
,

121 
¡age_cÚš”_t
* 
sc
, 
boŞ
 
o¥_’abËd
) {

122 
	`š¡ªû
()->
	`_»gi¡”_¡age_cÚš”
(
·ck‘_ty³
, 
sc
, 
o¥_’abËd
);

123 
	}
}

125 
boŞ
 
	$is_o¥_’abËd_fÜ_ty³
(cÚ¡ 
c_¡r
 &
·ck‘_ty³
) {

126  
	`š¡ªû
()->
	`_is_o¥_’abËd_fÜ_ty³
(
·ck‘_ty³
);

127 
	}
}

132 
	g‹m¶©e
<‹m¶©e<
	gşass
> 
şass
 
	gGu¬d
>

133 
di¥©ch_·ck‘
(
Gu¬d
<
·ck‘_t
> &
·ck‘
) {

134 
di¥©ch_·ck‘
(
·ck‘
.
»Ëa£
());

136 
	$di¥©ch_·ck‘
(
·ck‘_t
* 
·ck‘
) {

137 
	`š¡ªû
()->
	`_di¥©ch_·ck‘
(
·ck‘
);

138 
	}
}

141 
	$£t_o¥_fÜ_ty³
(cÚ¡ 
c_¡r
& 
·ck‘_ty³
, 
boŞ
 
o¥_sw™ch
) {

142  
	`š¡ªû
()->
	`_£t_o¥_fÜ_ty³
(
·ck‘_ty³
, 
o¥_sw™ch
);

143 
	}
}

146 
wÜk”_»£rv”_t
* 
»£rv”_acquœe
();

147 
»£rv”_»Ëa£
(
wÜk”_»£rv”_t
* 
wr
);

148 
wÜk”_»Ëa£r_t
* 
»Ëa£r_acquœe
();

149 
»Ëa£r_»Ëa£
(
wÜk”_»Ëa£r_t
* 
wr
);

154 şas 
	cdi¥©ch”_t
::
wÜk”_»£rv”_t
 : 
public
 
»sourû_deş¬e_t


157 
´iv©e
:

159 
di¥©ch”_t
* 
_di¥©ch”
;

160 
	mm­
<
	mc_¡r
, > 
	m_wÜk”_Ãeds
;

162 
	mpublic
:

164 
	$wÜk”_»£rv”_t
 (
di¥©ch”_t
* 
di¥©ch”
)

165 : 
	$_di¥©ch”
(
di¥©ch”
)

169 
vœtu®
 
	$deş¬e
(cÚ¡ 
c_¡r
& 
Çme
, 
couÁ
) {

170 
cu¼_Ãeds
 = 
_wÜk”_Ãeds
[
Çme
];

171 
_wÜk”_Ãeds
[
Çme
] = 
cu¼_Ãeds
 + 
couÁ
;

172 
	}
}

174 
acquœe_»sourûs
();

179 
şass
 
	gdi¥©ch”_t
::
wÜk”_»Ëa£r_t
 : 
public
 
»sourû_deş¬e_t
,…ubliø
	g»sourû_»Ëa£r_t


182 
	g´iv©e
:

184 
di¥©ch”_t
* 
_di¥©ch”
;

185 
	gm­
<
	gc_¡r
, > 
	g_wÜk”_Ãeds
;

187 
	gpublic
:

189 
wÜk”_»Ëa£r_t
 (
di¥©ch”_t
* 
di¥©ch”
)

190 : 
_di¥©ch”
(
di¥©ch”
)

194 
vœtu®
 
deş¬e
(cÚ¡ 
c_¡r
& 
Çme
, 
couÁ
) {

195 
	gcu¼_Ãeds
 = 
_wÜk”_Ãeds
[
Çme
];

196 
	g_wÜk”_Ãeds
[
Çme
] = 
cu¼_Ãeds
 + 
couÁ
;

199 
»Ëa£_»sourûs
() {

200 
	gm­
<
	gc_¡r
, >::
™”©Ü
 
™
;

201 
	g™
 = 
_wÜk”_Ãeds
.
begš
(); iˆ!ğ_wÜk”_Ãeds.
’d
(); ++it) {

202 
	gn
 = 
™
->
£cÚd
;

203 ià(
	gn
 > 0) {

204 
TRACE
(
TRACE_RESOURCE_RELEASE
 & 
TRACE_ALWAYS
,

205 "R–—sšg %d % wÜk”s\n", 
n
, 
™
->
fœ¡
.
d©a
());

206 
	g_di¥©ch”
->
_uÄe£rve_wÜk”s
(
™
->
fœ¡
, 
n
);

213 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/core/functors.h

24 #iâdeà
__QPIPE_FUNCTORS_H


25 
	#__QPIPE_FUNCTORS_H


	)

27 
	~"qpe/cÜe/tu¶e.h
"

28 
	~<®gÜ™hm
>

32 
ENTER_NAMESPACE
(
qpe
);

35 
	#ALIGNED
 
	`__©Œibu‹__
 ((
®igÃd
))

	)

44 şas 
	ctu¶e_f‹r_t
 {

46 
	m´iv©e
:

48 
size_t
 
_tu¶e_size
;

50 
	mpublic
:

53 
size_t
 
	$šput_tu¶e_size
(è{  
_tu¶e_size
; }

71 
vœtu®
 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &) {

72  
Œue
;

73 
	}
}

92 
vœtu®
 
	$´ojeù
(
tu¶e_t
 &
de¡
, cÚ¡u¶e_ˆ&
¤c
) {

93 
de¡
.
	`assign
(
¤c
);

94 
	}
}

98 
vœtu®
 
tu¶e_f‹r_t
* 
	$şÚe
() const=0;

101 
vœtu®
 
c_¡r
 
	$to_¡ršg
() const=0;

104 
	$tu¶e_f‹r_t
(
size_t
 
šput_tu¶e_size
)

105 : 
	$_tu¶e_size
(
šput_tu¶e_size
)

107 
	}
}

110 
vœtu®
 ~
	$tu¶e_f‹r_t
(è{ 
	}
}

116 
	gŒivŸl_f‹r_t
 : 
public
 
tu¶e_f‹r_t
 {

118 
vœtu®
 
tu¶e_f‹r_t
* 
şÚe
() const {

119  
Ãw
 
ŒivŸl_f‹r_t
(*
this
);

122 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

124  
	gc_¡r
::
EMPTY_STRING
;

127 
ŒivŸl_f‹r_t
(
size_t
 
šput_tu¶e_size
)

128 : 
tu¶e_f‹r_t
(
šput_tu¶e_size
)

143 
	shšt_tu¶e_·œ_t
 {

144 
	mhšt
;

145 *
	md©a
;

147 
hšt_tu¶e_·œ_t
()

148 : 
hšt
(0), 
d©a
(
NULL
)

151 
hšt_tu¶e_·œ_t
(
h
, *
d
)

152 : 
hšt
(
h
), 
d©a
(
d
)

164 
	skey_com·»_t
 {

175 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
	mkey1
, cÚ¡ * 
	mkey2
) const=0;

176 
vœtu®
 
key_com·»_t
* 
şÚe
() const=0;

178 
	mvœtu®
 ~
key_com·»_t
() { }

188 şas 
	ckey_exŒaùÜ_t
 {

190 
	m´iv©e
:

192 
size_t
 
_key_size
;

193 
size_t
 
	m_key_off£t
;

194 
	mpublic
:

195 
key_exŒaùÜ_t
(
size_t
 
key_size
=(), size_ˆ
key_off£t
=0)

196 : 
_key_size
(
key_size
), 
	$_key_off£t
(
key_off£t
)

199 
size_t
 
	$key_size
(ècÚ¡ {  
_key_size
; 
	}
}

200 
size_t
 
	$key_off£t
(ècÚ¡ {  
_key_off£t
; 
	}
}

206 cÚ¡ * 
	$exŒaù_key
(cÚ¡ 
tu¶e_t
 &
tu¶e
) const {

207  
	`exŒaù_key
(
tu¶e
.
d©a
);

208 
	}
}

209 * 
	$exŒaù_key
(
tu¶e_t
 &
tu¶e
) {

210  
	`exŒaù_key
(
tu¶e
.
d©a
);

211 
	}
}

220 cÚ¡ * 
	$exŒaù_key
(cÚ¡ * 
tu¶e_d©a
) const {

221  
tu¶e_d©a
 + 
	`key_off£t
();

222 
	}
}

224 * 
	$exŒaù_key
(* 
tu¶e_d©a
) {

225  
tu¶e_d©a
 + 
	`key_off£t
();

226 
	}
}

234 
	$exŒaù_hšt
(cÚ¡ 
tu¶e_t
 &
tu¶e
) const {

235  
	`exŒaù_hšt
(
	`exŒaù_key
(
tu¶e
));

236 
	}
}

255 
vœtu®
 
	$exŒaù_hšt
(cÚ¡ * 
key
) const {

257 if(
	`key_size
() > ())

261 
hšt
 = 0;

262 
	`memıy
(&
hšt
, 
key
, 
	`key_size
());

263  
hšt
;

264 
	}
}

268 
vœtu®
 
key_exŒaùÜ_t
* 
	$şÚe
() const=0;

271 
vœtu®
 
c_¡r
 
	$to_¡ršg
() const {

272  
	`c_¡r
("key(%zd, %zd)", 
	`key_size
(), 
	`key_off£t
());

273 
	}
}

276 
	gvœtu®
 ~
	$key_exŒaùÜ_t
(è{ 
	}
}

285 
	gdeçuÉ_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

286 
deçuÉ_key_exŒaùÜ_t
(
size_t
 
key_size
=(), size_ˆ
key_off£t
=0)

287 : 
key_exŒaùÜ_t
(
key_size
, 
key_off£t
)

290 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

291 
	g»suÉ
 = 0;

292 
memıy
(&
»suÉ
, 
key
, 
¡d
::
mš
((), 
key_size
()));

293  
	g»suÉ
;

296 
vœtu®
 
deçuÉ_key_exŒaùÜ_t
* 
şÚe
() const {

297  
Ãw
 
deçuÉ_key_exŒaùÜ_t
(*
this
);

304 
	stu¶e_com·¿tÜ_t
 {

306 
key_exŒaùÜ_t
* 
	m_exŒaù
;

307 
key_com·»_t
* 
	m_com·»
;

310 
tu¶e_com·¿tÜ_t
(
key_exŒaùÜ_t
* 
exŒaù
, 
key_com·»_t
* 
com·»
)

311 : 
_exŒaù
(
exŒaù
), 
_com·»
(
com·»
)

316 
İ”©Ü
()(cÚ¡ 
	mhšt_tu¶e_·œ_t
 &
	ma
, cÚ¡ hšt_tu¶e_·œ_ˆ&
	mb
) const {

317 
	mdiff
 = 
a
.
hšt
 - 
b
.hint;

318 if(
	m_exŒaù
->
key_size
(è<ğ(è|| 
diff
)

319  
diff
;

321 cÚ¡ * 
	makey
 = 
_exŒaù
->
exŒaù_key
(
a
.
d©a
);

322 cÚ¡ * 
	mbkey
 = 
_exŒaù
->
exŒaù_key
(
b
.
d©a
);

323  (*
	m_com·»
)(
	makey
, 
	mbkey
);

329 
	stu¶e_Ëss_t
 {

331 
tu¶e_com·¿tÜ_t
 
	m_com·»
;

333 
tu¶e_Ëss_t
(
key_exŒaùÜ_t
* 
e
, 
key_com·»_t
 *
c
)

334 : 
_com·»
(
e
, 
c
)

338 
boŞ
 
İ”©Ü
()(cÚ¡ 
	mhšt_tu¶e_·œ_t
 &
	ma
, cÚ¡ hšt_tu¶e_·œ_ˆ&
	mb
) const {

339  
_com·»
(
a
, 
b
) < 0;

351 şas 
	ctu¶e_još_t
 {

356 
size_t
 
	m_É_tu¶e_size
;

357 
size_t
 
	m_É_key_off£t
;

358 
size_t
 
	m_¹_tu¶e_size
;

359 
size_t
 
	m_¹_key_off£t
;

361 
size_t
 
	m_key_size
;

364 
size_t
 
	m_out_tu¶e_size
;

370 
	mpublic
:

372 
size_t
 
	$Ëá_tu¶e_size
(è{  
_É_tu¶e_size
; }

373 
size_t
 
	$Ëá_key_off£t
(è{  
_É_key_off£t
; 
	}
}

374 
size_t
 
	$right_tu¶e_size
(è{  
_¹_tu¶e_size
; 
	}
}

375 
size_t
 
	$right_key_off£t
(è{  
_¹_key_off£t
; 
	}
}

376 
size_t
 
	$key_size
(è{  
_key_size
; 
	}
}

377 
size_t
 
	$ouut_tu¶e_size
(è{  
_out_tu¶e_size
; 
	}
}

379 
	$tu¶e_još_t
(
size_t
 
É_tu¶e_size
,

380 
size_t
 
É_key_off£t
,

381 
size_t
 
¹_tu¶e_size
,

382 
size_t
 
¹_key_off£t
,

383 
size_t
 
k_size
,

384 
size_t
 
out_tu¶e_size
)

385 : 
	`_É_tu¶e_size
(
É_tu¶e_size
)

386 , 
	`_É_key_off£t
(
É_key_off£t
)

387 , 
	`_¹_tu¶e_size
(
¹_tu¶e_size
)

388 , 
	`_¹_key_off£t
(
¹_key_off£t
)

389 , 
	`_key_size
(
k_size
)

390 , 
	$_out_tu¶e_size
(
out_tu¶e_size
)

392 
	}
}

394 
	$tu¶e_još_t
(
tu¶e_još_t
 cÚ¡ &
Ùh”
)

395 : 
	`_É_tu¶e_size
(
Ùh”
.
_É_tu¶e_size
)

396 , 
	`_É_key_off£t
(
Ùh”
.
_É_key_off£t
)

397 , 
	`_¹_tu¶e_size
(
Ùh”
.
_¹_tu¶e_size
)

398 , 
	`_¹_key_off£t
(
Ùh”
.
_¹_key_off£t
)

399 , 
	`_key_size
(
Ùh”
.
_key_size
)

400 , 
	$_out_tu¶e_size
(
Ùh”
.
_out_tu¶e_size
)

402 
	}
}

404 cÚ¡ * 
	$Ëá_key_by‹s
(cÚ¡ * 
tup_d©a
) {

405  &
tup_d©a
[
	`Ëá_key_off£t
()];

406 
	}
}

408 cÚ¡ * 
	$right_key_by‹s
(cÚ¡ * 
tup_d©a
) {

409  &
tup_d©a
[
	`right_key_off£t
()];

410 
	}
}

412 cÚ¡ * 
	$Ëá_key
(cÚ¡ 
tu¶e_t
& 
tup
) {

413  
	`Ëá_key_by‹s
((cÚ¡ *)
tup
.
d©a
);

414 
	}
}

416 cÚ¡ * 
	$right_key
(cÚ¡ 
tu¶e_t
& 
tup
) {

417  
	`right_key_by‹s
((cÚ¡ *)
tup
.
d©a
);

418 
	}
}

434 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

435 cÚ¡ 
tu¶e_t
 &
Ëá
,

436 cÚ¡ 
tu¶e_t
 &
right
)=0;

453 
vœtu®
 
	$Ëá_ou‹r_još
(
tu¶e_t
 &,

454 cÚ¡ 
tu¶e_t
 &) {

457 
	`as£¹
(
çl£
);

458 
	}
}

460 
vœtu®
 
c_¡r
 
	$to_¡ršg
() const=0;

463 
vœtu®
 ~
	$tu¶e_još_t
(è{ 
	}
}

472 şas 
	ctu¶e_agg»g©e_t
 {

473 
size_t
 
	m_tu¶e_size
;

474 
	mpublic
:

475 
	$tu¶e_agg»g©e_t
(
size_t
 
tu¶e_size
)

476 : 
	$_tu¶e_size
(
tu¶e_size
)

485 
size_t
 
	$tu¶e_size
(è{  
_tu¶e_size
; 
	}
}

487 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
()=0;

497 
vœtu®
 
	$š™
(* 
agg_d©a
) {

498 
	`mem£t
(
agg_d©a
, 0, 
	`tu¶e_size
());

499 
	}
}

507 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
tu¶e
)=0;

517 
vœtu®
 
	$m”ge
(*, const *) {

518 
	`as£¹
(
çl£
);

519 
	}
}

530 
vœtu®
 
fšish
(
tu¶e_t
 &
de¡
, cÚ¡ * 
agg_d©a
)=0;

533 
vœtu®
 
tu¶e_agg»g©e_t
* 
	$şÚe
() const=0;

535 
vœtu®
 
c_¡r
 
	$to_¡ršg
() const=0;

537 
vœtu®
 ~
	$tu¶e_agg»g©e_t
(è{ 
	}
}

551 şas 
	ctu¶e_s›ve_t
 {

553 
size_t
 
	m_tu¶e_size
;

555 
	mpublic
:

556 
	$tu¶e_s›ve_t
(
size_t
 
tu¶e_size
)

557 : 
	$_tu¶e_size
(
tu¶e_size
)

565 
size_t
 
	$tu¶e_size
(è{  
_tu¶e_size
; 
	}
}

571 
vœtu®
 
boŞ
 
·ss
(
tu¶e_t
& 
de¡
, cÚ¡u¶e_ˆ&
¤c
)=0;

577 
vœtu®
 
boŞ
 
	$æush
(
tu¶e_t
&) {

578  
çl£
;

579 
	}
}

581 
vœtu®
 
tu¶e_s›ve_t
* 
	$şÚe
() const=0;

583 
vœtu®
 
c_¡r
 
	$to_¡ršg
() const=0;

585 
vœtu®
 ~
	$tu¶e_s›ve_t
(è{ 
	}
}

590 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/core/packet.h

24 #iâdeà
__QPIPE_PACKET_H


25 
	#__QPIPE_PACKET_H


	)

27 
	~<li¡
>

28 
	~"qpe/cÜe/tu¶e.h
"

29 
	~"qpe/cÜe/tu¶e_fifo.h
"

30 
	~"qpe/cÜe/funùÜs.h
"

31 
	~"qpe/cÜe/qu”y_¡©e.h
"

32 
	~"ut/»sourû_deş¬e.h
"

34 
usšg
 
	g¡d
::
li¡
;

37 
ENTER_NAMESPACE
(
qpe
);

40 ’um {
	mOSP_NONE
, 
	mOSP_FULL
} 
	to¥_pŞicy_t
;

41 
o¥_pŞicy_t
 
o¥_glob®_pŞicy
;

44 
boŞ
 
is_o¥_’abËd_fÜ_ty³
(cÚ¡ 
c_¡r
& 
·ck‘_ty³
);

47 
£t_o¥_fÜ_ty³
(cÚ¡ 
c_¡r
& 
·ck‘_ty³
, 
boŞ
 
o¥_sw™ch
);

53 
şass
 
	g·ck‘_t
;

54 
	gli¡
<
	t·ck‘_t
*> 
	t·ck‘_li¡_t
;

56 
	squ”y_¶ª
 {

57 
c_¡r
 
	maùiÚ
;

58 
c_¡r
 
	mf‹r
;

59 
qu”y_¶ª
 cÚ¡** 
	mchd_¶ªs
;

60 
	mchd_couÁ
;

62 
qu”y_¶ª
(cÚ¡ 
c_¡r
 &
a
, cÚ¡ c_¡¸&
f
, qu”y_¶ª cÚ¡** 
chd»n
, 
couÁ
)

63 : 
aùiÚ
(
a
), 
f‹r
(
f
), 
chd_¶ªs
(
chd»n
), 
chd_couÁ
(
couÁ
)

83 şas 
	c·ck‘_t


86 
	m´Ùeùed
:

89 
qu”y_¶ª
* 
_¶ª
;

92 
qu”y_¡©e_t
* 
	m_q¡©e
;

95 
boŞ
 
	m_m”ge_’abËd
;

99 
boŞ
 
	m_uÄe£rve_Ú_com¶‘iÚ
;

102 
boŞ
 
	$is_com·tibË
(
qu”y_¶ª
 cÚ¡* 
a
, qu”y_¶ª cÚ¡* 
b
) {

103 if(!
a
 || !
b
 || 
	`¡rcmp
×->
aùiÚ
, b->action))

104  
çl£
;

106 
	`as£¹
(
a
->
chd_couÁ
 =ğ
b
->child_count);

107 
i
=0; i < 
a
->
chd_couÁ
; i++) {

108 
qu”y_¶ª
 cÚ¡* 
ÿ
 = 
a
->
chd_¶ªs
[
i
];

109 
qu”y_¶ª
 cÚ¡* 
cb
 = 
b
->
chd_¶ªs
[
i
];

110 if(!
ÿ
 || !
cb
)

111  
çl£
;

112 if(
	`¡rcmp
(
ÿ
->
f‹r
, 
cb
->f‹rè|| !
	`is_com·tibË
(ca, cb))

113  
çl£
;

116  
Œue
;

119 
boŞ
 
	$is_com·tibË
(
·ck‘_t
* 
Ùh”
) {

121 ià(
o¥_glob®_pŞicy
 =ğ
OSP_NONE
)

122  
çl£
;

127 ià(!
	`is_o¥_’abËd_fÜ_ty³
(
_·ck‘_ty³
))

128  
çl£
;

130  
	`is_com·tibË
(
	`¶ª
(), 
Ùh”
->plan());

131 
	}
}

134 
	gpublic
:

136 
c_¡r
 
_·ck‘_id
;

137 
c_¡r
 
	g_·ck‘_ty³
;

139 
	g´iv©e
:

140 
gu¬d
<
tu¶e_fifo
> 
_ouut_bufãr
;

142 
	gpublic
:

145 
tu¶e_f‹r_t
* 
_ouut_f‹r
;

151 
	g_Ãxt_tu¶e_Ú_m”ge
;

159 
	g_Ãxt_tu¶e_Ãeded
;

163 
·ck‘_t
(cÚ¡ 
c_¡r
 &
·ck‘_id
,

164 cÚ¡ 
c_¡r
 &
·ck‘_ty³
,

165 
tu¶e_fifo
* 
ouut_bufãr
,

166 
tu¶e_f‹r_t
* 
ouut_f‹r
,

167 
qu”y_¶ª
* 
¶ª
,

168 
boŞ
 
m”ge_’abËd
,

169 
boŞ
 
uÄe£rve_Ú_com¶‘iÚ
);

172 
	gvœtu®
 ~
·ck‘_t
();

174 
tu¶e_fifo
* 
	$»Ëa£_ouut_bufãr
() {

175  
_ouut_bufãr
.
	`»Ëa£
();

176 
	}
}

178 
tu¶e_fifo
* 
	$ouut_bufãr
() {

179  
_ouut_bufãr
;

180 
	}
}

189 
boŞ
 
	$is_m”ge_’abËd
() {

191 ià(
o¥_glob®_pŞicy
 =ğ
OSP_NONE
)

192  
çl£
;

197 ià(!
	`is_o¥_’abËd_fÜ_ty³
(
_·ck‘_ty³
))

198  
çl£
;

200  
_m”ge_’abËd
;

201 
	}
}

203 
qu”y_¶ª
 cÚ¡* 
	$¶ª
() const {

204  
_¶ª
;

205 
	}
}

214 
boŞ
 
	$is_m”g—bË
(
·ck‘_t
* 
Ùh”
) {

215  
	`is_m”ge_’abËd
(è&& 
	`is_com·tibË
(
Ùh”
);

216 
	}
}

219 
	$di§bË_m”gšg
() {

220 
_m”ge_’abËd
 = 
çl£
;

221 
	}
}

224 
	$assign_qu”y_¡©e
(
qu”y_¡©e_t
* 
q¡©e
) {

225 
_q¡©e
 = 
q¡©e
;

226 
	}
}

228 
qu”y_¡©e_t
* 
	$g‘_qu”y_¡©e
() {

229  
_q¡©e
;

230 
	}
}

232 
boŞ
 
	$uÄe£rve_wÜk”_Ú_com¶‘iÚ
() {

233  
_uÄe£rve_Ú_com¶‘iÚ
;

234 
	}
}

236 
vœtu®
 
deş¬e_wÜk”_Ãeds
(
»sourû_deş¬e_t
* 
deş¬e
)=0;

240 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/core/query_state.h

24 #iâdeà
__QUERY_STATE_H


25 
	#__QUERY_STATE_H


	)

27 
	~"ut.h
"

30 
ENTER_NAMESPACE
(
qpe
);

33 
şass
 
	g·ck‘_t
;

34 
	squ”y_¡©e_t
 {

38 
	m´Ùeùed
:

39 
qu”y_¡©e_t
() { }

40 
vœtu®
 ~
qu”y_¡©e_t
() { }

42 
public
:

48 
vœtu®
 
»bšd_£lf
(
·ck‘_t
*)=0;

53 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/core/stage.h

24 #iâdeà
__QPIPE_STAGE_H


25 
	#__QPIPE_STAGE_H


	)

27 
	~"qpe/cÜe/tu¶e.h
"

28 
	~"qpe/cÜe/·ck‘.h
"

29 
	~"ut.h
"

32 
ENTER_NAMESPACE
(
qpe
);

42 şas 
	c¡age_t
 {

45 
	mpublic
:

53 
	sad­tÜ_t
 {

55 
´iv©e
:

57 
gu¬d
<
·ge
> 
_·ge
;

59 
	mpublic
:

61 
vœtu®
 cÚ¡ 
c_¡r
 &
g‘_cÚš”_Çme
()=0;

62 
vœtu®
 
·ck‘_t
* 
g‘_·ck‘
()=0;

63 
vœtu®
 
ouut
(
·ge
* 
p
)=0;

64 
vœtu®
 
¡İ_acû±šg_·ck‘s
()=0;

65 
vœtu®
 
boŞ
 
check_fÜ_ÿnûÎ©iÚ
()=0;

78 
ouut
(cÚ¡ 
tu¶e_t
 &
tu¶e
) {

79 
as£¹
(!
_·ge
->
fuÎ
());

80 
	m_·ge
->
­³nd_tu¶e
(
tu¶e
);

81 if(
	m_·ge
->
fuÎ
()) {

82 
ouut
(
_·ge
);

83 
	m_·ge
->
ş—r
();

87 
ad­tÜ_t
(
·ge
* 
p
)

88 : 
_·ge
(
p
)

90 
as£¹
(
_·ge
);

93 
	mvœtu®
 ~
ad­tÜ_t
() { }

95 
	m´Ùeùed
:

102 
æush
() {

103 if(!
_·ge
->
em±y
())

104 
ouut
(
_·ge
);

110 
	g´Ùeùed
:

112 
ad­tÜ_t
* 
_ad­tÜ
;

114 
vœtu®
 
´oûss_·ck‘
()=0;

116 
	gpublic
:

118 
	$¡age_t
()

119 : 
	$_ad­tÜ
(
NULL
)

122 
	}
}

124 
vœtu®
 ~
	$¡age_t
(è{ 
	}
}

127 
	$š™
(
ad­tÜ_t
* 
ad­tÜ
) {

128 
_ad­tÜ
 = 
ad­tÜ
;

129 
	}
}

141 
	$´oûss
() {

142 
	`as£¹
(
_ad­tÜ
 !ğ
NULL
);

146 
·ck‘_t
* 
·ck‘
 = 
_ad­tÜ
->
	`g‘_·ck‘
();

147 
qu”y_¡©e_t
* 
q¡©e
 = 
·ck‘
->
	`g‘_qu”y_¡©e
();

148 ià(
q¡©e
 !ğ
NULL
)

150 
q¡©e
->
	`»bšd_£lf
(
·ck‘
);

152 
	`´oûss_·ck‘
();

153 
	}
}

158 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/core/stage_container.h

24 #iâdeà
__QPIPE_STAGE_CONTAINTER_H


25 
	#__QPIPE_STAGE_CONTAINTER_H


	)

27 
	~"ut.h
"

28 
	~"qpe/cÜe/·ck‘.h
"

29 
	~"qpe/cÜe/¡age.h
"

31 
usšg
 
	g¡d
::
li¡
;

33 
ENTER_NAMESPACE
(
qpe
);

38 
	g¡age_çùÜy_t
;

40 şas 
	c¡age_cÚš”_t
 {

42 
	mpublic
:

44 cÚ¡ 
NEXT_TUPLE_UNINITIALIZED
;

45 cÚ¡ 
	mNEXT_TUPLE_INITIAL_VALUE
;

47 
	em”ge_t
 {

48 
	mMERGE_FAILED
,

49 
	mMERGE_SUCCESS_HOLD_RESOURCES
,

50 
	mMERGE_SUCCESS_RELEASE_RESOURCES


53 
	g´Ùeùed
:

55 
şass
 
¡age_ad­tÜ_t
;

56 
	gli¡
 <
	t·ck‘_li¡_t
*> 
	tCÚš”Queue
;

60 
debug_mu‹x_t
 
	g_cÚš”_lock
;

61 
±h»ad_cÚd_t
 
	g_cÚš”_queue_nÚem±y
;

63 
c_¡r
 
	g_cÚš”_Çme
;

64 
CÚš”Queue
 
	g_cÚš”_queue
;

65 
	gli¡
 <
	g¡age_ad­tÜ_t
*> 
	g_cÚš”_cu¼’t_¡ages
;

67 
¡age_çùÜy_t
* 
	g_¡age_mak”
;

71 
cÚš”_queue_’queue_no_m”ge
(
·ck‘_li¡_t
* 
·ck‘s
);

72 
cÚš”_queue_’queue_no_m”ge
(
·ck‘_t
* 
·ck‘
);

73 
·ck‘_li¡_t
* 
cÚš”_queue_dequeue
();

74 
ü—‹_wÜk”
();

77 
	gpublic
:

80 * 
¡©ic_run_¡age_w¿µ”
(
¡age_t
* 
¡age
,

81 
¡age_ad­tÜ_t
* 
ad­tÜ
);

83 
¡age_cÚš”_t
(cÚ¡ 
c_¡r
 &
cÚš”_Çme
, 
¡age_çùÜy_t
* 
¡age_mak”
,

84 
aùive_couÁ
, 
max_couÁ
=-1);

86 ~
¡age_cÚš”_t
();

88 cÚ¡ 
	gc_¡r
 &
	$g‘_Çme
(){  
_cÚš”_Çme
; 
	}
}

90 
’queue
(
·ck‘_t
* 
·ck‘
);

92 
»£rve
(
n
);

93 
uÄe£rve
(
n
);

95 
run
();

97 
	g´iv©e
:

99 
_»£rve
(
n
);

105 
th»ad_poŞ
 
	g_poŞ
;

111 
	g_max_th»ads
;

115 
	g_Ãxt_th»ad
;

128 
»sourû_poŞ_t
 
	g_½
;

133 şas 
	c¡age_cÚš”_t
::
¡age_ad­tÜ_t
 : 
public
 
¡age_t
::
ad­tÜ_t
 {

135 
´Ùeùed
:

138 
±h»ad_mu‹x_t
 
_¡age_ad­tÜ_lock
;

140 
¡age_cÚš”_t
* 
	m_cÚš”
;

142 
·ck‘_t
* 
	m_·ck‘
;

143 
·ck‘_li¡_t
* 
	m_·ck‘_li¡
;

145 
	m_Ãxt_tu¶e
;

146 
boŞ
 
	m_¡l_acû±šg_·ck‘s
;

147 
boŞ
 
	m_cÚšs_Ï‹_m”g”
;

151 
	mgu¬d
<
	m·ge
> 
	mout_·ge
;

155 vŞ©
boŞ
 
	m_ÿnûÎed
;

158 
	mpublic
:

160 
¡age_ad­tÜ_t
(
¡age_cÚš”_t
* 
cÚš”
,

161 
·ck‘_li¡_t
* 
·ck‘_li¡
,

162 
size_t
 
tu¶e_size
);

165 ~
	$¡age_ad­tÜ_t
() {

167 
	`as£¹
Ğ
_·ck‘
 =ğ
NULL
 );

170 
	`as£¹
Ğ
_·ck‘_li¡
 =ğ
NULL
 );

174 
vœtu®
 cÚ¡ 
c_¡r
 &
	$g‘_cÚš”_Çme
() {

175  
_cÚš”
->
	`g‘_Çme
();

176 
	}
}

179 
vœtu®
 
·ck‘_t
* 
	$g‘_·ck‘
() {

180  
_·ck‘
;

181 
	}
}

190 
vœtu®
 
	$ouut
(
·ge
* 
p
) {

191 
	`ouut_·ge
(
p
);

192 
	}
}

195 
vœtu®
 
	$¡İ_acû±šg_·ck‘s
() {

196 
ü™iÿl_£ùiÚ_t
 
	`cs
(
_¡age_ad­tÜ_lock
);

197 
_¡l_acû±šg_·ck‘s
 = 
çl£
;

198 
	}
}

201 
vœtu®
 
boŞ
 
	$check_fÜ_ÿnûÎ©iÚ
() {

202  
_ÿnûÎed
;

203 
	}
}

206 
	g¡age_cÚš”_t
::
m”ge_t
 
Œy_m”ge
(
·ck‘_t
* 
·ck‘
);

207 
run_¡age
(
¡age_t
* 
¡age
);

209 
	g´Ùeùed
:

211 
fšish_·ck‘
(
·ck‘_t
* 
·ck‘
);

212 
ş—nup
();

213 
abÜt_qu”›s
();

215 
	g´iv©e
:

217 
ouut_·ge
(
·ge
* 
p
);

220 
	s¡age_çùÜy_t
 {

221 
vœtu®
 
¡age_t
* 
ü—‹_¡age
()=0;

222 
	mvœtu®
 ~
¡age_çùÜy_t
() { }

239 
	g‹m¶©e
<
şass
 
	gSTAGE
>

240 
	g¡age_çùÜy
 : 
public
 
¡age_çùÜy_t
 {

242 
vœtu®
 
¡age_t
* 
ü—‹_¡age
() {

243  
Ãw
 
STAGE
();

246 
	gvœtu®
 ~
¡age_çùÜy
() { }

249 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/core/tuple.h

32 #iâdeà
__QPIPE_TUPLE_H


33 
	#__QPIPE_TUPLE_H


	)

36 
	~<ÿs£¹
>

37 
	~<Ãw
>

39 
	~"ut.h
"

43 
ENTER_NAMESPACE
(
qpe
);

49 cÚ¡ 
	gDEFAULT_BUFFER_PAGES
 = 100;

54 
£t_deçuÉ_·ge_size
(
size_t
 
·ge_size
);

55 
size_t
 
g‘_deçuÉ_·ge_size
();

72 şas 
	ctu¶e_t


74 
	mpublic
:

75 * 
d©a
;

76 
size_t
 
	msize
;

78 
	$tu¶e_t
() {

80 
	`š™
(
NULL
, 0);

83 
	$tu¶e_t
(* 
d
, 
size_t
 
s
) {

84 
	`š™
(
d
, 
s
);

85 
	}
}

98 
	$assign
(cÚ¡ 
tu¶e_t
 &
¤c
) {

99 
	`as£¹
(
size
 =ğ
¤c
.size);

100 
	`memıy
(
d©a
, 
¤c
.d©a, 
size
);

101 
	}
}

103 
	g´iv©e
:

113 
	$š™
(* 
d
, 
size_t
 
s
) {

114 
d©a
 = 
d
;

115 
size
 = 
s
;

116 
	}
}

121 şas 
	c·ge_poŞ


123 
size_t
 
	m_·ge_size
;

125 
	mpublic
:

126 
	$·ge_poŞ
(
size_t
 
·ge_size
)

127 : 
	$_·ge_size
(
·ge_size
)

131 
size_t
 
	$·ge_size
() const {

132  
_·ge_size
;

133 
	}
}

138 
vœtu®
 * 
®loc
()=0;

144 
vœtu®
 
ä“
(* 
·ge
)=0;

147 
	gvœtu®
 ~
	$·ge_poŞ
(è{ 
	}
}

156 
	gm®loc_·ge_poŞ
 : 
·ge_poŞ


158 
´iv©e
:

159 
m®loc_·ge_poŞ
 
_š¡ªû
;

161 
	gpublic
:

162 
m®loc_·ge_poŞ
 *
š¡ªû
() {

163  &
_š¡ªû
;

166 
m®loc_·ge_poŞ
(
size_t
 
·ge_size
 = 
g‘_deçuÉ_·ge_size
())

167 : 
·ge_poŞ
(
·ge_size
)

170 
vœtu®
 * 
®loc
() {

171 * 
±r
 = 
m®loc
(
·ge_size
());

172 if(!
	g±r
)

173 
throw
 
	g¡d
::
bad_®loc
();

175  
	g±r
;

177 
vœtu®
 
ä“
(* 
±r
) {

178 ::
ä“
(
±r
);

183 
şass
 
	gtu¶e_fifo
;

193 şas 
	c·ge


195 
·ge_poŞ
* 
	m_poŞ
;

196 
size_t
 
	m_tu¶e_size
;

197 
size_t
 
	m_·dded_size
;

198 
size_t
 
	m_ä“_couÁ
;

199 
size_t
 
	m_’d_off£t
;

200 
	mpublic
:

201 
·ge
* 
Ãxt
;

203 
	m´iv©e
:

205 #ifdeà
__GCC


206 
_d©a_¬¿y
[0];

207 * 
	$_d©a
(è{  
_d©a_¬¿y
; }

209 * 
	$_d©a
(è{  (
·ge
)+(*)
this
; 
	}
}

211 
	gpublic
:

217 
size_t
 
	$ÿ·c™y
(
size_t
 
·ge_size
, size_ˆ
tu¶e_size
) {

218  (
·ge_size
 - (
·ge
))/
tu¶e_size
;

219 
	}
}

221 
·ge
* 
®loc
(
size_t
 
tu¶e_size
, 
·ge_poŞ
* 
poŞ
=
m®loc_·ge_poŞ
::
	$š¡ªû
()) {

222  
	`Ãw
 (
poŞ
->
	`®loc
()è
	`·ge
ÕoŞ, 
tu¶e_size
);

223 
	}
}

225 
	$ä“
() {

227 
_poŞ
->
	`ä“
(
this
);

228 
	}
}

230 
size_t
 
	$·ge_size
() const {

231  
_poŞ
->
	`·ge_size
();

232 
	}
}

234 
size_t
 
	$tu¶e_size
() const {

235  
_tu¶e_size
;

236 
	}
}

245 
size_t
 
	$ÿ·c™y
() const {

246  
	`ÿ·c™y
(
	`·ge_size
(), 
	`tu¶e_size
());

247 
	}
}

249 
size_t
 
	$tu¶e_couÁ
() const {

250  
_’d_off£t
/
	`tu¶e_size
();

251 
	}
}

257 
	$ş—r
() {

258 
_ä“_couÁ
 = 
	`ÿ·c™y
();

259 
_’d_off£t
 = 0;

260 
	}
}

267 
boŞ
 
	$em±y
() const {

268  
_’d_off£t
 == 0;

269 
	}
}

276 
boŞ
 
	$fuÎ
() const {

277  
_ä“_couÁ
 == 0;

278 
	}
}

286 
tu¶e_t
 
	$g‘_tu¶e
(
size_t
 
šdex
) {

287  
	`tu¶e_t
(&
	`_d©a
()[
šdex
*
	`tu¶e_size
()],uple_size());

288 
	}
}

303 
boŞ
 
»ad_fuÎ_·ge
(
fd
);

316 
wr™e_fuÎ_·ge
(
fd
);

331 
boŞ
 
ä—d_fuÎ_·ge
(
FILE
* 
fe
);

344 
fwr™e_fuÎ_·ge
(
FILE
 *
fe
);

353 * 
	$®loÿ‹
() {

354 
	`as£¹
(!
	`fuÎ
());

355 *
»suÉ
 = &
	`_d©a
()[
_’d_off£t
];

356 
_’d_off£t
 +ğ
	`tu¶e_size
();

357 
_ä“_couÁ
--;

358  
»suÉ
;

359 
	}
}

373 
tu¶e_t
 
	$®loÿ‹_tu¶e
() {

374  
	`tu¶e_t
(
	`®loÿ‹
(), 
	`tu¶e_size
());

375 
	}
}

390 
	$­³nd_tu¶e
(cÚ¡ 
tu¶e_t
 &
tu¶e
) {

392 
	`®loÿ‹_tu¶e
().
	`assign
(
tu¶e
);

393 
	}
}

400 şas 
	c™”©Ü
 {

402 
	g´iv©e
:

403 
tu¶e_t
 
_cu¼’t
;

405 
	gpublic
:

407 
™”©Ü
()

408 : 
_cu¼’t
(
NULL
, 0)

412 
™”©Ü
(
·ge
*…age, 
size_t
 
off£t
)

413 : 
_cu¼’t
(
·ge
->
_d©a
(è+ 
off£t
,

414 
·ge
->
tu¶e_size
())

418 
™”©Ü
(
size_t
 
size
, * 
d©a
)

419 : 
_cu¼’t
(
d©a
, 
size
)

423 
boŞ
 
	gİ”©Ü
 ==(cÚ¡ 
™”©Ü
& 
Ùh”
) const {

424  
_cu¼’t
.
d©a
 =ğ
Ùh”
._current.data;

427 
boŞ
 
	gİ”©Ü
 !=(cÚ¡ 
™”©Ü
& 
Ùh”
) const {

428  !(*
this
 =ğ
Ùh”
);

431 
tu¶e_t
 
	gİ”©Ü
 *() {

432  
	g_cu¼’t
;

435 
tu¶e_t
 *
	gİ”©Ü
 ->() {

436  &
	g_cu¼’t
;

443 
tu¶e_t
 
advªû
() {

444 
tu¶e_t
 
	g»suÉ
 = **
this
;

445 ++*
	gthis
;

446  
	g»suÉ
;

449 
	g™”©Ü
 &
	gİ”©Ü
 ++() {

450 
	g_cu¼’t
.
	gd©a
 +ğ
_cu¼’t
.
size
;

451  *
	gthis
;

454 
™”©Ü
 
	gİ”©Ü
 ++() {

455 
™”©Ü
 
	gŞd
 = *
this
;

456 ++*
	gthis
;

457  
	gŞd
;

461 
™”©Ü
 
	$begš
() {

462  
	`™”©Ü
(
this
, 0);

463 
	}
}

465 
™”©Ü
 
	$’d
() {

466  
	`™”©Ü
(
this
, 
_’d_off£t
);

467 
	}
}

470 
	g´iv©e
:

471 
	$·ge
(
·ge_poŞ
* 
poŞ
, 
size_t
 
tu¶e_size
)

472 : 
	`_poŞ
(
poŞ
),

473 
	`_tu¶e_size
(
tu¶e_size
),

474 
	$Ãxt
(
NULL
)

477 
	`‹¡_®ignm’t
(
	`_d©a
(), ());

478 
	`ş—r
();

479 
	}
}

484 
·ge
(cÚ¡…ag&
Ùh”
);

486 
	g·ge
 &
	gİ”©Ü
 =(cÚ¡ 
·ge
 &
Ùh”
);

490 ~
·ge
();

495 
EXIT_NAMESPACE
(
qpe
);

504 
	g‹m¶©e
 <>

505 
šlše
 
	ggu¬d
<
	gqpe
::
·ge
>::
	$aùiÚ
(
qpe
::
·ge
* 
±r
) {

506 
±r
->
	`ä“
();

507 
	}
}

511 
ENTER_NAMESPACE
(
qpe
);

521 şas 
	c·ge_Œash_¡ack
 {

523 
	mgu¬d
<
	mqpe
::
·ge
> 
_h—d
;

524 
	m_size
;

525 
	mpublic
:

526 
	$·ge_Œash_¡ack
()

527 : 
	$_size
(0)

530 
	$add
(
qpe
::
·ge
* 
p
) {

531 
p
->
Ãxt
 = 
_h—d
.
	`»Ëa£
();

532 
_h—d
 = 
p
;

533 ++
_size
;

534 
	}
}

535 
	$ş—r
() {

537  ; 
_h—d
; _h—d = _h—d->
Ãxt
);

538 
_size
 = 0;

539 
	}
}

540 
	$size
(è{  
_size
; 
	}
}

541 ~
	$·ge_Œash_¡ack
() {

542 
	`ş—r
();

543 
	}
}

547 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/core/tuple_fifo.h

24 #iâdeà
__QPIPE_TUPLE_FIFO_H


25 
	#__QPIPE_TUPLE_FIFO_H


	)

27 
	~"qpe/cÜe/tu¶e.h
"

28 
	~<c¡dio
>

29 
	~<veùÜ
>

30 
	~<li¡
>

31 
	~<ucÚ‹xt.h
>

33 
ENTER_NAMESPACE
(
qpe
);

36 
DEFINE_EXCEPTION
(
T”mš©edBufãrExû±iÚ
);

39 
tu¶e_fifo_g’”©e_id
();

41 
	g¡d
::
	tli¡
<
	t·ge
*> 
	t·ge_li¡
;

52 şas 
	ctu¶e_fifo
 {

54 
	m´iv©e
:

58 şas 
	ctu¶e_fifo_¡©e_t
 {

59 
public
:

60 
	e_tu¶e_fifo_¡©e_t
 {

61 
INVALID
 = 0,

62 
	mIN_MEMORY
,

63 
	mIN_MEMORY_DONE_WRITING
,

64 
	mON_DISK
,

65 
	mON_DISK_DONE_WRITING
,

66 
	mTERMINATED


69 
	m´iv©e
:

70 vŞ©
_tu¶e_fifo_¡©e_t
 
_v®ue
;

72 
	mpublic
:

74 
tu¶e_fifo_¡©e_t
 ()

75 : 
_v®ue
(
INVALID
)

79 
c_¡r
 
¡©e_to_¡ršg
(cÚ¡ 
_tu¶e_fifo_¡©e_t
 
v®ue
) {

80 
v®ue
) {

81 
	#TF_STATE
(
x
èx:  #x;

	)

82 
TF_STATE
(
INVALID
);

83 
TF_STATE
(
IN_MEMORY
);

84 
TF_STATE
(
IN_MEMORY_DONE_WRITING
);

85 
TF_STATE
(
ON_DISK
);

86 
TF_STATE
(
ON_DISK_DONE_WRITING
);

87 
TF_STATE
(
TERMINATED
);

89 
as£¹
(0);

93 
c_¡r
 
to_¡ršg
() {

94  
¡©e_to_¡ršg
(
cu¼’t
());

97 
_tu¶e_fifo_¡©e_t
 
cu¼’t
() {

98  
	m_v®ue
;

101 
Œªs™iÚ
(cÚ¡ 
_tu¶e_fifo_¡©e_t
 
Ãxt
);

103 
	m´iv©e
:

105 
boŞ
 
_Œªs™iÚ_ok
(cÚ¡ 
_tu¶e_fifo_¡©e_t
 
Ãxt
);

110 
	g_fifo_id
;

113 
tu¶e_fifo_¡©e_t
 
	g_¡©e
;

116 
·ge_li¡
 
	g_·ges
;

117 
·ge_li¡
 
	g_ä“_·ges
;

118 
size_t
 
	g_·ges_š_fifo
;

119 
size_t
 
	g_·ges_š_memÜy
;

120 
size_t
 
	g_memÜy_ÿ·c™y
;

121 
size_t
 
	g_th»shŞd
;

124 
FILE
* 
	g_·ge_fe
;

125 
size_t
 
	g_Ãxt_·ge
;

126 
size_t
 
	g_fe_h—d_·ge
;

129 
size_t
 
	g_tu¶e_size
;

130 
size_t
 
	g_·ge_size
;

133 
size_t
 
	g_num_š£¹ed
;

134 
size_t
 
	g_num_»moved
;

135 
size_t
 
	g_num_wa™s_Ú_š£¹
;

136 
size_t
 
	g_num_wa™s_Ú_»move
;

139 * 
	g_»ad_’d
;

140 
	ggu¬d
<
	g·ge
> 
	g_»ad_·ge
;

141 
	g·ge
::
™”©Ü
 
_»ad_™”©Ü
;

142 
	ggu¬d
<
	g·ge
> 
	g_wr™e_·ge
;

145 
±h»ad_mu‹x_t
 
	g_lock
;

146 
±h»ad_cÚd_t
 
	g_»ad”_nÙify
;

147 
±h»ad_cÚd_t
 
	g_wr™”_nÙify
;

150 
±h»ad_t
 
	g_»ad”_tid
;

151 
±h»ad_t
 
	g_wr™”_tid
;

153 
	gpublic
:

174 
tu¶e_fifo
(
size_t
 
tu¶e_size
,

175 
size_t
 
ÿ·c™y
=
DEFAULT_BUFFER_PAGES
,

176 
size_t
 
th»shŞd
=64,

177 
size_t
 
·ge_size
=
	$g‘_deçuÉ_·ge_size
())

178 : 
	`_fifo_id
(
	`tu¶e_fifo_g’”©e_id
()),

179 
	`_·ges_š_fifo
(0),

180 
	`_·ges_š_memÜy
(0),

181 
	`_memÜy_ÿ·c™y
(
ÿ·c™y
),

182 
	`_th»shŞd
(
th»shŞd
),

183 
	`_Ãxt_·ge
(0),

184 
	`_fe_h—d_·ge
(0),

185 
	`_tu¶e_size
(
tu¶e_size
),

186 
	`_·ge_size
(
·ge_size
),

187 
	`_num_š£¹ed
(0),

188 
	`_num_»moved
(0),

189 
	`_num_wa™s_Ú_š£¹
(0),

190 
	`_num_wa™s_Ú_»move
(0),

191 
	`_lock
(
	`th»ad_mu‹x_ü—‹
()),

192 
	`_»ad”_nÙify
(
	`th»ad_cÚd_ü—‹
()),

193 
	`_wr™”_nÙify
(
	`th»ad_cÚd_ü—‹
()),

194 
	`_»ad”_tid
(0),

195 
	$_wr™”_tid
(0)

197 
	`š™
();

198 
	}
}

200 ~
	$tu¶e_fifo
() {

201 
	`de¡roy
();

202 
	}
}

206 
İ’_fifos
();

207 
ş—r_¡©s
();

208 
Œaû_¡©s
();

211 
size_t
 
	$tu¶e_size
() const {

212  
_tu¶e_size
;

213 
	}
}

216 
size_t
 
	$·ge_size
() const {

217  
_·ge_size
;

218 
	}
}

221 
wr™”_š™
();

237 
	$­³nd
(cÚ¡ 
tu¶e_t
 &
tu¶e
) {

238 
	`’su»_wr™e_»ady
();

239 
_num_š£¹ed
++;

240 
_wr™e_·ge
->
	`­³nd_tu¶e
(
tu¶e
);

241 
	}
}

259 
tu¶e_t
 
	$®loÿ‹
() {

260 
	`’su»_wr™e_»ady
();

261 
_num_š£¹ed
++;

262  
_wr™e_·ge
->
	`®loÿ‹_tu¶e
();

263 
	}
};

275 
boŞ
 
	$g‘_tu¶e
(
tu¶e_t
 &
tu¶e
) {

276 ià(!
	`’su»_»ad_»ady
())

277  
çl£
;

278 
tu¶e
 = *
_»ad_™”©Ü
++;

279 
_num_»moved
++;

280  
Œue
;

281 
	}
}

284 
boŞ
 
cİy_·ge
(
·ge
* 
d¡
, 
timeout_ms
=0);

293 
	$’su»_wr™e_»ady
() {

294 if(
_wr™e_·ge
->
	`fuÎ
())

295 
	`_æush_wr™e_·ge
(
çl£
);

296 
	}
}

307 
boŞ
 
	$’su»_»ad_»ady
(
timeout_ms
=0) {

309  (
_»ad_™”©Ü
->
d©a
 !ğ
_»ad_’d
)

310 || (
	`_g‘_»ad_·ge
(
timeout_ms
) == 1);

311 
	}
}

315 
	$check_»ad_»ady
() {

316 if(
_»ad_™”©Ü
->
d©a
 !ğ
_»ad_’d
)

318  
	`_g‘_»ad_·ge
(-1);

319 
	}
}

322 
boŞ
 
‹rmš©e
();

325 
boŞ
 
£nd_eof
();

335 
boŞ
 
	$eof
() {

336  
	`check_»ad_»ady
() < 0;

337 
	}
}

340 
	g´iv©e
:

342 
size_t
 
	$_avaabË_š_memÜy_wr™es
() {

343 
	`as£¹
(
	`is_š_memÜy
());

344  
_memÜy_ÿ·c™y
 - 
	`_avaabË_š_memÜy_»ads
();

345 
	}
}

347 
size_t
 
	$_avaabË_š_memÜy_»ads
() {

348 
	`as£¹
(
	`is_š_memÜy
());

349  
_·ges_š_memÜy
;

350 
	}
}

352 
size_t
 
	$_avaabË_fifo_»ads
() {

353  
_·ges_š_fifo
;

354 
	}
}

356 
	$_‹rmš©iÚ_check
() {

357 if(
	`is_‹rmš©ed
())

358 
	`THROW1
(
T”mš©edBufãrExû±iÚ
, "Buffer closed unexpectedly");

359 
	}
}

361 
	$_£t_»ad_·ge
(
·ge
* 
p
) {

362 
_»ad_·ge
 = 
p
;

363 
_»ad_™”©Ü
 = 
_»ad_·ge
->
	`begš
();

364 
_»ad_’d
 = 
_»ad_·ge
->
	`’d
()->
d©a
;

365 
	}
}

367 
·ge
* 
	$_®loc_·ge
() {

369 ià(
_ä“_·ges
.
	`em±y
())

371  
·ge
::
	`®loc
(
	`tu¶e_size
());

374 
·ge
* 
p
 = 
_ä“_·ges
.
	`äÚt
();

375 
_ä“_·ges
.
	`pİ_äÚt
();

376 
p
->
	`ş—r
();

377  
p
;

378 
	}
}

380 
š™
();

381 
de¡roy
();

384 
_g‘_»ad_·ge
(
timeout
);

385 
_æush_wr™e_·ge
(
boŞ
 
dÚe_wr™šg
);

388 
boŞ
 
	$is_š_memÜy
() {

390 
_¡©e
.
	`cu¼’t
(è=ğ
tu¶e_fifo_¡©e_t
::
IN_MEMORY
 ||

391 
_¡©e
.
	`cu¼’t
(è=ğ
tu¶e_fifo_¡©e_t
::
IN_MEMORY_DONE_WRITING
;

392 
	}
}

394 
boŞ
 
	$is_dÚe_wr™šg
() {

396 
_¡©e
.
	`cu¼’t
(è=ğ
tu¶e_fifo_¡©e_t
::
IN_MEMORY_DONE_WRITING
 ||

397 
_¡©e
.
	`cu¼’t
(è=ğ
tu¶e_fifo_¡©e_t
::
ON_DISK_DONE_WRITING
;

398 
	}
}

400 
boŞ
 
	$is_‹rmš©ed
() {

401  
_¡©e
.
	`cu¼’t
(è=ğ
tu¶e_fifo_¡©e_t
::
TERMINATED
;

402 
	}
}

405 
wa™_fÜ_»ad”
();

406 
’su»_»ad”_ruÂšg
();

408 
boŞ
 
wa™_fÜ_wr™”
(
timeout
);

409 
’su»_wr™”_ruÂšg
();

415 
EXIT_NAMESPACE
(
qpe
);

419 
	g‹m¶©e
<>

420 
šlše
 
	ggu¬d
<
	gqpe
::
tu¶e_fifo
>::
	$aùiÚ
(
qpe
::
tu¶e_fifo
* 
±r
) {

421 if(!
±r
->
	`‹rmš©e
()) {

422 
d–‘e
 
±r
;

424 
	}
}

	@include/qpipe/core/tuple_fifo_directory.h

24 #iâdeà
__TUPLE_FIFO_DIRECTORY_H


25 
	#__TUPLE_FIFO_DIRECTORY_H


	)

27 
	~"ut.h
"

30 
ENTER_NAMESPACE
(
qpe
);

33 
DEFINE_EXCEPTION
(
Tu¶eFifoDœeùÜyExû±iÚ
);

36 şas 
	ctu¶e_fifo_dœeùÜy_t
 {

38 
	m´iv©e
:

40 
	edœ_¡©e_t
 {

41 
TUPLE_FIFO_DIRECTORY_FIRST
,

42 
	mTUPLE_FIFO_DIRECTORY_OPEN
,

43 
	mTUPLE_FIFO_DIRECTORY_CLOSED


46 
c_¡r
 
	g_dœ_·th
;

48 
±h»ad_mu‹x_t
 
	g_dœ_mu‹x
;

50 
dœ_¡©e_t
 
	g_dœ_¡©e
;

52 
	gpublic
:

54 cÚ¡ 
c_¡r
& 
dœ_·th
();

55 
İ’_Úû
();

56 
şo£
();

57 
c_¡r
 
g’”©e_f•©h
(
id
);

59 
	g´iv©e
:

61 
boŞ
 
f’ame_f‹r
(cÚ¡ * 
·th
);

62 
ş—n_dœ
();

67 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/qcommon.h

31 #iâdeà
__QPIPE_COMMON_H


32 
	#__QPIPE_COMMON_H


	)

34 
	~"sm/shÜe/shÜe_’v.h
"

36 
	~"qpe/commÚ/´oûss_tu¶e.h
"

37 
	~"qpe/commÚ/´oûss_qu”y.h
"

38 
	~"qpe/commÚ/št_com·¿tÜ.h
"

42 
	#DECLARE_QPIPE_TRX
(
Œxlid
) \

43 
w_rc_t
 
run_qpe_
##
	`Œxlid
(
Reque¡
* 
´eque¡
, 
Œxlid
##
_šput_t
& 
š
); \

44 
w_rc_t
 
run_qpe_
##
	`Œxlid
(
Reque¡
* 
´eque¡
); \

45 
w_rc_t
 
xù_qpe_
##
	`Œxlid
(cÚ¡ 
xù_id
, 
Œxlid
##
_šput_t
& 
š
)

	)

48 
	#DEFINE_QPIPE_TRX
(
úame
,
Œxlid
) \

49 
	`DEFINE_RUN_WITHOUT_INPUT_TRX_WRAPPER
(
úame
,
Œxlid
,
qpe_
##trxlid); \

50 
	`DEFINE_RUN_WITH_INPUT_TRX_WRAPPER
(
úame
,
Œxlid
,
qpe_
##Œxlid)

	)

	@include/qpipe/scheduler.h

31 #iâdeà
__QPIPE_CPU_SCHED_H


32 
	#__QPIPE_CPU_SCHED_H


	)

34 
	~"qpe/scheduËr/ıu.h
"

35 
	~"qpe/scheduËr/ıu_£t.h
"

36 
	~"qpe/scheduËr/pŞicy.h
"

37 
	~"qpe/scheduËr/pŞicy_os.h
"

38 
	~"qpe/scheduËr/pŞicy_qu”y_ıu.h
"

39 
	~"qpe/scheduËr/pŞicy_¼_ıu.h
"

40 
	~"qpe/scheduËr/pŞicy_¼_moduË.h
"

	@include/qpipe/scheduler/cpu.h

33 #iâdeà
__QPIPE_CPU_H


34 
	#__QPIPE_CPU_H


	)

36 
	~"ut/Çme¥aû.h
"

38 
ENTER_NAMESPACE
(
qpe
);

42 
ıu_s
* 
	tıu_t
;

47 
ıu_bšd_£lf
(
ıu_t
 
ıu
);

48 
ıu_g‘_unique_id
(
ıu_t
 
ıu
);

50 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/scheduler/cpu_set.h

31 #iâdeà
__QPIPE_CPU_SET_H


32 
	#__QPIPE_CPU_SET_H


	)

34 
	~"ut/Çme¥aû.h
"

35 
	~"qpe/scheduËr/os_suµÜt.h
"

36 
	~"qpe/scheduËr/ıu.h
"

38 
ENTER_NAMESPACE
(
qpe
);

42 
ıu_£t_s
* 
	tıu_£t_p
;

46 
ıu_£t_š™
(
ıu_£t_p
 
ıu_£t
);

47 
ıu_£t_g‘_num_ıus
(
ıu_£t_p
 
ıu_£t
);

48 
ıu_t
 
ıu_£t_g‘_ıu
(
ıu_£t_p
 
ıu_£t
, 
šdex
);

49 
ıu_£t_fšish
(
ıu_£t_p
 
ıu_£t
);

51 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/scheduler/cpu_set_struct.h

35 #iâdeà
__SCHEDULER_CPU_SET_STRUCT_H


36 
	#__SCHEDULER_CPU_SET_STRUCT_H


	)

38 
	~"ut/Çme¥aû.h
"

39 
	~"qpe/scheduËr/os_suµÜt.h
"

40 
	~"qpe/scheduËr/ıu_¡ruù.h
"

42 
ENTER_NAMESPACE
(
qpe
);

50 
	sıu_£t_s


53 
	mıu£t_num_ıus
;

56 
ıu_s
* 
	mıu£t_ıus
;

60 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/scheduler/cpu_struct.h

34 #iâdeà
__QPIPE_CPU_STRUCT_H


35 
	#__QPIPE_CPU_STRUCT_H


	)

37 
	~"ut/Çme¥aû.h
"

38 
	~"qpe/scheduËr/os_suµÜt.h
"

45 
ENTER_NAMESPACE
(
qpe
);

52 
	sıu_s


57 
	mıu_unique_id
;

59 #ifdeà
FOUND_LINUX


68 
os_ıu_£t_t
 
	mıu_£t
;

79 
´oûssÜid_t
 
	mıu_id
;

84 
´oûssÜ_šfo_t
 
	mıu_´oc_šfo
;

90 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/scheduler/os_support.h

24 #iâdeà
_OS_SUPPORT_H


25 
	#_OS_SUPPORT_H


	)

27 #ifdeà 
UNSUPPORTED_OS


28 
	#UNSUPPORTED_OS
 1

	)

33 #ià
defšed
(
lšux
è|| defšed(
__lšux
)

34 
	#FOUND_LINUX


	)

36 #undeà
UNSUPPORTED_OS


37 
	#UNSUPPORTED_OS
 0

	)

39 #iâdeà
__USE_GNU


40 
	#__USE_GNU


	)

43 
	~<sched.h
>

45 
ıu_£t_t
 
	tos_ıu_£t_t
;

50 #ià
defšed
(
sun
è|| defšed(
__sun
)

51 #ià
defšed
(
__SVR4
è|| defšed(
__svr4__
)

53 #undeà
UNSUPPORTED_OS


54 
	#UNSUPPORTED_OS
 0

	)

57 
	~<sys/ty³s.h
>

58 
	~<sys/´oûssÜ.h
>

68 #ià
UNSUPPORTED_OS


	@include/qpipe/scheduler/policy.h

25 #iâdeà
__SCHEDULER_POLICY_H


26 
	#__SCHEDULER_POLICY_H


	)

28 
	~"qpe/cÜe/·ck‘.h
"

29 
	~"qpe/cÜe/qu”y_¡©e.h
"

30 
	~"qpe/scheduËr/ıu.h
"

34 
ENTER_NAMESPACE
(
qpe
);

37 
usšg
 
	gqpe
::
·ck‘_t
;

38 
usšg
 
	gqpe
::
qu”y_¡©e_t
;

41 şas 
	cpŞicy_t
 {

43 
	mpublic
:

45 
vœtu®
 
qu”y_¡©e_t
* 
qu”y_¡©e_ü—‹
()=0;

46 
vœtu®
 
qu”y_¡©e_de¡roy
(
qu”y_¡©e_t
* 
q¡©e
)=0;

47 
	mvœtu®
 ~
	$pŞicy_t
() { }

48 
	}
};

52 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/scheduler/policy_os.h

24 #iâdeà
__QPIPE_POLICY_OS_H


25 
	#__QPIPE_POLICY_OS_H


	)

27 
	~"qpe/scheduËr/pŞicy.h
"

28 
	~<c¡dlib
>

31 
ENTER_NAMESPACE
(
qpe
);

37 şas 
	cpŞicy_os_t
 : 
public
 
pŞicy_t
 {

39 
´Ùeùed
:

41 şas 
	cos_qu”y_¡©e_t
 : 
public
 
qpe
::
qu”y_¡©e_t
 {

42 
public
:

43 
os_qu”y_¡©e_t
() { }

44 
vœtu®
 ~
os_qu”y_¡©e_t
() { }

46 
vœtu®
 
»bšd_£lf
(
·ck‘_t
*) {

52 
	gpublic
:

54 
	$pŞicy_os_t
(è{ 
	}
}

55 
vœtu®
 ~
	$pŞicy_os_t
(è{
	}
}

58 
vœtu®
 
qu”y_¡©e_t
* 
	$qu”y_¡©e_ü—‹
() {

59  
Ãw
 
	`os_qu”y_¡©e_t
();

60 
	}
}

63 
vœtu®
 
	$qu”y_¡©e_de¡roy
(
qu”y_¡©e_t
* 
qs
) {

64 
os_qu”y_¡©e_t
* 
q¡©e
 = 
dyÇmic_ÿ¡
<os_qu”y_¡©e_t*>(
qs
);

65 
d–‘e
 
q¡©e
;

66 
	}
}

70 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/scheduler/policy_query_cpu.h

24 #iâdeà
__QPIPE_POLICY_QUERY_CPU_H


25 
	#__QPIPE_POLICY_QUERY_CPU_H


	)

27 
	~"ut.h
"

28 
	~"qpe/scheduËr/pŞicy.h
"

29 
	~"qpe/scheduËr/ıu_£t_¡ruù.h
"

30 
	~"qpe/scheduËr/ıu_£t.h
"

34 
ENTER_NAMESPACE
(
qpe
);

40 şas 
	cpŞicy_qu”y_ıu_t
 : 
public
 
pŞicy_t
 {

42 
´Ùeùed
:

44 
±h»ad_mu‹x_t
 
_ıu_Ãxt_mu‹x
;

45 
ıu_£t_s
 
	m_ıu_£t
;

46 
	m_ıu_Ãxt
;

47 
	m_ıu_num
;

50 şas 
	cqu”y_ıu_qu”y_¡©e_t
 : 
public
 
qpe
::
qu”y_¡©e_t
 {

52 
public
:

55 
ıu_t
 
_qıu
;

57 
qu”y_ıu_qu”y_¡©e_t
(
ıu_t
 
qıu
)

58 : 
_qıu
(
qıu
)

62 
vœtu®
 ~
qu”y_ıu_qu”y_¡©e_t
() { }

64 
vœtu®
 
»bšd_£lf
(
·ck‘_t
*) {

66 
ıu_bšd_£lf
(
_qıu
);

71 
	gpublic
:

73 
	$pŞicy_qu”y_ıu_t
()

74 : 
	`_ıu_Ãxt_mu‹x
(
	$th»ad_mu‹x_ü—‹
())

76 
	`ıu_£t_š™
(&
_ıu_£t
);

77 
_ıu_Ãxt
 = 0;

78 
_ıu_num
 = 
	`ıu_£t_g‘_num_ıus
(&
_ıu_£t
);

79 
	}
}

82 
	gvœtu®
 ~
	$pŞicy_qu”y_ıu_t
() {

83 
	`ıu_£t_fšish
(&
_ıu_£t
);

84 
	`th»ad_mu‹x_de¡roy
(
_ıu_Ãxt_mu‹x
);

85 
	}
}

88 
vœtu®
 
qu”y_¡©e_t
* 
	$qu”y_¡©e_ü—‹
() {

90 
Ãxt_ıu
;

92 
ü™iÿl_£ùiÚ_t
 
	`cs
(
_ıu_Ãxt_mu‹x
);

97 
Ãxt_ıu
 = 
_ıu_Ãxt
;

98 
_ıu_Ãxt
 = (_ıu_Ãxˆ+ 1è% 
_ıu_num
;

100 
cs
.
	`ex™
();

102  
Ãw
 
	`qu”y_ıu_qu”y_¡©e_t
Ğ
	`ıu_£t_g‘_ıu
(&
_ıu_£t
, 
Ãxt_ıu
) );

103 
	}
}

106 
vœtu®
 
	$qu”y_¡©e_de¡roy
(
qu”y_¡©e_t
* 
qs
) {

108 
qu”y_ıu_qu”y_¡©e_t
* 
q¡©e
 = 
dyÇmic_ÿ¡
<qu”y_ıu_qu”y_¡©e_t*>(
qs
);

109 
d–‘e
 
q¡©e
;

110 
	}
}

117 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/scheduler/policy_rr_cpu.h

24 #iâdeà
__QPIPE_POLICY_RR_CPU_H


25 
	#__QPIPE_POLICY_RR_CPU_H


	)

27 
	~"ut.h
"

28 
	~"qpe/scheduËr/pŞicy.h
"

29 
	~"qpe/scheduËr/ıu_£t_¡ruù.h
"

30 
	~"qpe/scheduËr/ıu_£t.h
"

34 
ENTER_NAMESPACE
(
qpe
);

40 şas 
	cpŞicy_¼_ıu_t
 : 
public
 
pŞicy_t
 {

42 
´Ùeùed
:

44 şas 
	c¼_ıu_¡©e_t
 : 
public
 
qpe
::
qu”y_¡©e_t
 {

46 
´iv©e
:

47 
pŞicy_¼_ıu_t
* 
_pŞicy
;

49 
	mpublic
:

50 
¼_ıu_¡©e_t
(
pŞicy_¼_ıu_t
* 
pŞicy
)

51 : 
_pŞicy
(
pŞicy
)

55 
vœtu®
 ~
¼_ıu_¡©e_t
() { }

57 
vœtu®
 
»bšd_£lf
(
·ck‘_t
* 
·ck‘
) {

59 
ıu_t
 
bšd_ıu
 = 
_pŞicy
->
assign
(
·ck‘
, 
this
);

60 
ıu_bšd_£lf
(
bšd_ıu
);

61 
TRACE
(
TRACE_CPU_BINDING
, "BšdšgØCPU %p\n", 
bšd_ıu
);

66 
±h»ad_mu‹x_t
 
	g_ıu_Ãxt_mu‹x
;

67 
ıu_£t_s
 
	g_ıu_£t
;

68 
	g_ıu_Ãxt
;

69 
	g_ıu_num
;

71 
vœtu®
 
ıu_t
 
	$assign
(
·ck‘_t
*, 
qu”y_¡©e_t
*) {

73 
Ãxt_ıu
;

75 
ü™iÿl_£ùiÚ_t
 
	`cs
(
_ıu_Ãxt_mu‹x
);

80 
Ãxt_ıu
 = 
_ıu_Ãxt
;

81 
_ıu_Ãxt
 = (_ıu_Ãxˆ+ 1è% 
_ıu_num
;

83 
cs
.
	`ex™
();

85  
	`ıu_£t_g‘_ıu
Ğ&
_ıu_£t
, 
Ãxt_ıu
 );

86 
	}
}

89 
	gpublic
:

91 
	$pŞicy_¼_ıu_t
()

92 : 
	`_ıu_Ãxt_mu‹x
(
	$th»ad_mu‹x_ü—‹
())

94 
	`ıu_£t_š™
(&
_ıu_£t
);

95 
_ıu_Ãxt
 = 0;

96 
_ıu_num
 = 
	`ıu_£t_g‘_num_ıus
(&
_ıu_£t
);

97 
	}
}

100 
	gvœtu®
 ~
	$pŞicy_¼_ıu_t
() {

101 
	`ıu_£t_fšish
(&
_ıu_£t
);

102 
	`th»ad_mu‹x_de¡roy
(
_ıu_Ãxt_mu‹x
);

103 
	}
}

106 
vœtu®
 
qu”y_¡©e_t
* 
	$qu”y_¡©e_ü—‹
() {

107  
Ãw
 
	`¼_ıu_¡©e_t
(
this
);

108 
	}
}

111 
vœtu®
 
	$qu”y_¡©e_de¡roy
(
qu”y_¡©e_t
* 
qs
) {

112 
¼_ıu_¡©e_t
* 
q¡©e
 = 
dyÇmic_ÿ¡
<¼_ıu_¡©e_t*>(
qs
);

113 
d–‘e
 
q¡©e
;

114 
	}
}

121 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/scheduler/policy_rr_module.h

24 #iâdeà
__QPIPE_POLICY_RR_MODULE_H


25 
	#__QPIPE_POLICY_RR_MODULE_H


	)

27 
	~"ut.h
"

28 
	~"qpe/scheduËr/pŞicy.h
"

29 
	~"qpe/scheduËr/ıu_£t_¡ruù.h
"

30 
	~"qpe/scheduËr/ıu_£t.h
"

34 
ENTER_NAMESPACE
(
qpe
);

38 
	#NUM_MODULES
 2

	)

43 şas 
	cpŞicy_¼_moduË_t
 : 
public
 
pŞicy_t
 {

45 
´Ùeùed
:

47 
	smoduË_t
 {

48 
±h»ad_mu‹x_t
 
_moduË_mu‹x
;

49 
	m_Ãxt_moduË_ıu
;

50 
moduË_t
()

51 : 
_moduË_mu‹x
(
th»ad_mu‹x_ü—‹
())

56 
±h»ad_mu‹x_t
 
	g_Ãxt_moduË_mu‹x
;

57 
	g_Ãxt_moduË
;

59 
ıu_£t_s
 
	g_ıu_£t
;

60 
moduË_t
 
	g_moduËs
[
NUM_MODULES
];

61 
	g_ıus_³r_moduË
;

63 şas 
	c¼_moduË_qu”y_¡©e_t
 : 
public
 
qpe
::
qu”y_¡©e_t
 {

65 
´iv©e
:

67 
pŞicy_¼_moduË_t
* 
_pŞicy
;

69 
	gpublic
:

71 
_moduË_šdex
;

73 
¼_moduË_qu”y_¡©e_t
(
pŞicy_¼_moduË_t
* 
pŞicy
, 
moduË_šdex
)

74 : 
_pŞicy
(
pŞicy
),

75 
_moduË_šdex
(
moduË_šdex
)

79 
	gvœtu®
 ~
¼_moduË_qu”y_¡©e_t
() { }

81 
vœtu®
 
»bšd_£lf
(
·ck‘_t
* 
·ck‘
) {

83 
ıu_bšd_£lf
Ğ
_pŞicy
->
assign
(
·ck‘
, 
this
) );

88 
vœtu®
 
ıu_t
 
	$assign
(
·ck‘_t
*, 
qu”y_¡©e_t
* 
qs
) {

91 
¼_moduË_qu”y_¡©e_t
* 
q¡©e
 = 
dyÇmic_ÿ¡
<¼_moduË_qu”y_¡©e_t*>(
qs
);

92 
moduË_šdex
 = 
q¡©e
->
_moduË_šdex
;

93 
moduË_t
* 
moduË
 = &
_moduËs
[
moduË_šdex
];

95 
Ãxt_ıu
;

96 
ü™iÿl_£ùiÚ_t
 
	`cs
(
moduË
->
_moduË_mu‹x
);

101 
Ãxt_ıu
 = 
moduË
->
_Ãxt_moduË_ıu
;

102 
moduË
->
_Ãxt_moduË_ıu
 = (
Ãxt_ıu
 + 1è% 
_ıus_³r_moduË
;

104 
cs
.
	`ex™
();

107 
	`ıu_£t_g‘_ıu
Ğ&
_ıu_£t
, 
moduË_šdex
 * 
_ıus_³r_moduË
 + 
Ãxt_ıu
 );

108 
	}
}

111 
	gpublic
:

113 
	$pŞicy_¼_moduË_t
()

114 : 
	`_Ãxt_moduË_mu‹x
(
	$th»ad_mu‹x_ü—‹
())

117 
_Ãxt_moduË
 = 0;

119 
	`ıu_£t_š™
(&
_ıu_£t
);

120 
i
 = 0; i < 
NUM_MODULES
; i++)

121 
_moduËs
[
i
].
_Ãxt_moduË_ıu
 = 0;

126 
_ıus_³r_moduË
 = 
	`ıu_£t_g‘_num_ıus
(&
_ıu_£t
è/ 
NUM_MODULES
;

127 
	}
}

130 
	gvœtu®
 ~
	$pŞicy_¼_moduË_t
() {

131 
	`ıu_£t_fšish
(&
_ıu_£t
);

132 
	`th»ad_mu‹x_de¡roy
(
_Ãxt_moduË_mu‹x
);

134 
i
 = 0; i < 
NUM_MODULES
; i++) {

135 
	`th»ad_mu‹x_de¡roy
(
_moduËs
[
i
].
_moduË_mu‹x
);

137 
	}
}

140 
vœtu®
 
qu”y_¡©e_t
* 
	$qu”y_¡©e_ü—‹
() {

141 
Ãxt_moduË
;

143 
ü™iÿl_£ùiÚ_t
 
	`cs
(
_Ãxt_moduË_mu‹x
);

147 
Ãxt_moduË
 = 
_Ãxt_moduË
;

148 
_Ãxt_moduË
 = (_Ãxt_moduË + 1è% 
NUM_MODULES
;

150 
cs
.
	`ex™
();

152  
Ãw
 
	`¼_moduË_qu”y_¡©e_t
Ğ
this
, 
Ãxt_moduË
 );

153 
	}
}

156 
vœtu®
 
	$qu”y_¡©e_de¡roy
(
qu”y_¡©e_t
* 
qs
) {

158 
¼_moduË_qu”y_¡©e_t
* 
q¡©e
 = 
dyÇmic_ÿ¡
<¼_moduË_qu”y_¡©e_t*>(
qs
);

159 
d–‘e
 
q¡©e
;

160 
	}
}

166 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/stages.h

24 #iâdeà
__QPIPE_STAGES_H


25 
	#__QPIPE_STAGES_H


	)

27 
	~"qpe/¡ages/agg»g©e.h
"

28 
	~"qpe/¡ages/bÆ_š.h
"

29 
	~"qpe/¡ages/bÆ_još.h
"

30 
	~"qpe/¡ages/fdump.h
"

31 
	~"qpe/¡ages/fsÿn.h
"

32 
	~"qpe/¡ages/func_ÿÎ.h
"

33 
	~"qpe/¡ages/hash_još.h
"

34 
	~"qpe/¡ages/sÜt_m”ge_još.h
"

35 
	~"qpe/¡ages/pe_hash_još.h
"

36 
	~"qpe/¡ages/m”ge.h
"

37 
	~"qpe/¡ages/·¹Ÿl_agg»g©e.h
"

38 
	~"qpe/¡ages/hash_agg»g©e.h
"

39 
	~"qpe/¡ages/sÜt.h
"

40 
	~"qpe/¡ages/sÜ‹d_š.h
"

41 
	~"qpe/¡ages/tsÿn.h
"

42 
	~"qpe/¡ages/echo.h
"

43 
	~"qpe/¡ages/s›ve.h
"

44 
	~"qpe/¡ages/d–ay_wr™”.h
"

45 
	~"qpe/¡ages/tu¶e_sourû.h
"

47 
	~"qpe/¡ages/»gi¡”_¡age_cÚš”s.h
"

	@include/qpipe/stages/aggregate.h

24 #iâdeà
__QPIPE_AGGREGATE_H


25 
	#__QPIPE_AGGREGATE_H


	)

27 
	~<c¡dio
>

28 
	~"qpe/cÜe.h
"

31 
ENTER_NAMESPACE
(
qpe
);

38 
	gagg»g©e_·ck‘_t
 : 
public
 
·ck‘_t


40 cÚ¡ 
c_¡r
 
PACKET_TYPE
;

42 
	ggu¬d
<
	gtu¶e_agg»g©e_t
> 
	g_agg»g©Ü
;

43 
	ggu¬d
<
	gkey_exŒaùÜ_t
> 
	g_exŒaù
;

44 
	ggu¬d
<
	g·ck‘_t
> 
	g_šput
;

45 
	ggu¬d
<
	gtu¶e_fifo
> 
	g_šput_bufãr
;

77 
agg»g©e_·ck‘_t
(cÚ¡ 
c_¡r
 &
·ck‘_id
,

78 
tu¶e_fifo
* 
ouut_bufãr
,

79 
tu¶e_f‹r_t
* 
ouut_f‹r
,

80 
tu¶e_agg»g©e_t
* 
agg»g©Ü
,

81 
key_exŒaùÜ_t
* 
exŒaù
,

82 
·ck‘_t
* 
šput
)

83 : 
·ck‘_t
(
·ck‘_id
, 
PACKET_TYPE
, 
ouut_bufãr
, 
ouut_f‹r
,

84 
ü—‹_¶ª
(
ouut_f‹r
, 
agg»g©Ü
, 
exŒaù
, 
šput
->
¶ª
()),

85 
Œue
,

86 
Œue


88 
_agg»g©Ü
(
agg»g©Ü
), 
_exŒaù
(
exŒaù
),

89 
_šput
(
šput
),

90 
_šput_bufãr
(
šput
->
ouut_bufãr
())

92 
as£¹
(
_šput
 !ğ
NULL
);

93 
as£¹
(
_šput_bufãr
 !ğ
NULL
);

96 
qu”y_¶ª
* 
ü—‹_¶ª
(
tu¶e_f‹r_t
* 
f‹r
, 
tu¶e_agg»g©e_t
* 
agg
,

97 
key_exŒaùÜ_t
* 
key
, 
qu”y_¶ª
 cÚ¡* 
chd
)

99 
c_¡r
 
aùiÚ
("%s:%s:%s", 
PACKET_TYPE
.
d©a
(),

100 
agg
->
to_¡ršg
().
d©a
(), 
key
->to_string().data());

102 
qu”y_¶ª
 cÚ¡** 
	gchd»n
 = 
Ãw
 query_plan const*[1];

103 
	gchd»n
[0] = 
chd
;

104  
Ãw
 
qu”y_¶ª
(
aùiÚ
, 
f‹r
->
to_¡ršg
(), 
chd»n
, 1);

107 
vœtu®
 
deş¬e_wÜk”_Ãeds
(
»sourû_deş¬e_t
* 
deş¬e
) {

108 
	gdeş¬e
->
deş¬e
(
_·ck‘_ty³
, 1);

109 
	g_šput
->
deş¬e_wÜk”_Ãeds
(
deş¬e
);

120 şas 
	cagg»g©e_¡age_t
 : 
public
 
¡age_t


122 
public
:

124 cÚ¡ 
c_¡r
 
DEFAULT_STAGE_NAME
;

125 
agg»g©e_·ck‘_t
 
	t¡age_·ck‘_t
;

127 
	$agg»g©e_¡age_t
() { }

129 ~
	$agg»g©e_¡age_t
(è{ 
	}
}

132 
	g´Ùeùed
:

134 
vœtu®
 
´oûss_·ck‘
();

138 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/stages/bnl_in.h

24 #iâdeà
__QPIPE_BNL_IN_H


25 
	#__QPIPE_BNL_IN_H


	)

27 
	~<c¡dio
>

28 
	~<¡ršg
>

30 
	~"qpe/cÜe.h
"

31 
	~"qpe/¡ages/tu¶e_sourû.h
"

33 
usšg
 
Çme¥aû
 
	g¡d
;

34 
usšg
 
Çme¥aû
 
	gqpe
;

44 
	gbÆ_š_·ck‘_t
 : 
public
 
·ck‘_t
 {

46 cÚ¡ 
c_¡r
 
PACKET_TYPE
;

48 
	ggu¬d
<
	g·ck‘_t
> 
	g_Ëá
;

49 
	ggu¬d
<
	gtu¶e_fifo
> 
	g_Ëá_bufãr
;

52 
	ggu¬d
<
	gtu¶e_sourû_t
> 
	g_right_sourû
;

53 
	ggu¬d
<
	gkey_exŒaùÜ_t
> 
	g_exŒaù
;

54 
	ggu¬d
<
	gkey_com·»_t
> 
	g_com·»
;

55 
boŞ
 
	g_ouut_Ú_m©ch
;

76 
bÆ_š_·ck‘_t
(cÚ¡ 
c_¡r
 &
·ck‘_id
,

77 
tu¶e_fifo
* 
ouut_bufãr
,

78 
tu¶e_f‹r_t
* 
ouut_f‹r
,

79 
·ck‘_t
* 
Ëá
,

80 
tu¶e_sourû_t
* 
right_sourû
,

81 
key_exŒaùÜ_t
* 
exŒaù
,

82 
key_com·»_t
* 
com·»
,

83 
boŞ
 
ouut_Ú_m©ch
)

84 : 
·ck‘_t
(
·ck‘_id
, 
PACKET_TYPE
, 
ouut_bufãr
, 
ouut_f‹r
, 
NULL
,

85 
çl£
,

86 
Œue


88 
_Ëá
(
Ëá
),

89 
_Ëá_bufãr
(
Ëá
->
ouut_bufãr
()),

90 
_right_sourû
(
right_sourû
),

91 
_exŒaù
(
exŒaù
),

92 
_com·»
(
com·»
),

93 
_ouut_Ú_m©ch
(
ouut_Ú_m©ch
)

97 
vœtu®
 
deş¬e_wÜk”_Ãeds
(
»sourû_deş¬e_t
*) {

98 
TRACE
(
TRACE_ALWAYS
, "UNIMPLEMENTED! Why‡re you‚ot using sorted_in?\n");

99 
as£¹
(0);

109 şas 
	cbÆ_š_¡age_t
 : 
public
 
¡age_t
 {

111 
public
:

113 cÚ¡ 
c_¡r
 
DEFAULT_STAGE_NAME
;

114 
bÆ_š_·ck‘_t
 
	t¡age_·ck‘_t
;

116 
	$bÆ_š_¡age_t
() { }

118 
vœtu®
 ~
	$bÆ_š_¡age_t
(è{ 
	}
}

120 
	g´Ùeùed
:

122 
vœtu®
 
´oûss_·ck‘
();

	@include/qpipe/stages/bnl_join.h

24 #iâdeà
__QPIPE_BNL_JOIN_H


25 
	#__QPIPE_BNL_JOIN_H


	)

27 
	~<c¡dio
>

28 
	~<¡ršg
>

30 
	~"qpe/cÜe.h
"

31 
	~"qpe/¡ages/tu¶e_sourû.h
"

35 
usšg
 
Çme¥aû
 
	g¡d
;

36 
usšg
 
Çme¥aû
 
	gqpe
;

46 
	gbÆ_još_·ck‘_t
 : 
public
 
·ck‘_t
 {

48 cÚ¡ 
c_¡r
 
PACKET_TYPE
;

50 
	ggu¬d
<
	g·ck‘_t
> 
	g_Ëá
;

51 
	ggu¬d
<
	gtu¶e_fifo
> 
	g_Ëá_bufãr
;

52 
	ggu¬d
<
	gtu¶e_sourû_t
> 
	g_right_sourû
;

53 
	ggu¬d
<
	gtu¶e_još_t
> 
	g_još
;

73 
bÆ_još_·ck‘_t
(cÚ¡ 
c_¡r
 &
·ck‘_id
,

74 
tu¶e_fifo
* 
ouut_bufãr
,

75 
tu¶e_f‹r_t
* 
ouut_f‹r
,

76 
·ck‘_t
* 
Ëá
,

77 
tu¶e_sourû_t
* 
right_sourû
,

78 
tu¶e_još_t
* 
još
)

79 : 
·ck‘_t
(
·ck‘_id
, 
PACKET_TYPE
, 
ouut_bufãr
, 
ouut_f‹r
, 
NULL
,

80 
çl£
,

81 
Œue


83 
_Ëá
(
Ëá
),

84 
_Ëá_bufãr
(
Ëá
->
ouut_bufãr
()),

85 
_right_sourû
(
right_sourû
),

86 
_još
(
još
)

90 
vœtu®
 
deş¬e_wÜk”_Ãeds
(
»sourû_deş¬e_t
*) {

91 
TRACE
(
TRACE_ALWAYS
, "UNIMPLEMENTED! Why‡re you‚ot using hash join?\n");

92 
as£¹
(0);

101 şas 
	cbÆ_još_¡age_t
 : 
public
 
¡age_t
 {

103 
public
:

105 cÚ¡ 
c_¡r
 
DEFAULT_STAGE_NAME
;

106 
bÆ_još_·ck‘_t
 
	t¡age_·ck‘_t
;

108 
	$bÆ_još_¡age_t
() { }

110 
vœtu®
 ~
	$bÆ_još_¡age_t
(è{ 
	}
}

112 
	g´Ùeùed
:

114 
vœtu®
 
´oûss_·ck‘
();

	@include/qpipe/stages/delay_writer.h

24 #iâdeà
__QPIPE_DELAY_WRITER_H


25 
	#__QPIPE_DELAY_WRITER_H


	)

27 
	~"qpe/cÜe.h
"

30 
ENTER_NAMESPACE
(
qpe
);

37 
	gd–ay_wr™”_·ck‘_t
 : 
public
 
·ck‘_t
 {

39 
public
:

41 cÚ¡ 
c_¡r
 
PACKET_TYPE
;

44 cÚ¡ 
size_t
 
	g_ouut_tu¶e_size
;

45 cÚ¡ 
	g_d–ay_us
;

46 cÚ¡ 
	g_num_tu¶es
;

52 
d–ay_wr™”_·ck‘_t
(cÚ¡ 
c_¡r
& 
·ck‘_id
,

53 
tu¶e_fifo
* 
ouut_bufãr
,

54 
tu¶e_f‹r_t
* 
ouut_f‹r
,

55 
d–ay_us
,

56 
num_tu¶es
)

57 : 
·ck‘_t
(
·ck‘_id
, 
PACKET_TYPE
, 
ouut_bufãr
, 
ouut_f‹r
,

58 
NULL
,

59 
çl£
,

60 
Œue


62 
_ouut_tu¶e_size
(
ouut_bufãr
->
tu¶e_size
()),

63 
_d–ay_us
(
d–ay_us
),

64 
_num_tu¶es
(
num_tu¶es
)

68 
vœtu®
 
deş¬e_wÜk”_Ãeds
(
»sourû_deş¬e_t
* 
deş¬e
) {

69 
	gdeş¬e
->
deş¬e
(
_·ck‘_ty³
, 1);

80 şas 
	cd–ay_wr™”_¡age_t
 : 
public
 
¡age_t
 {

82 
public
:

84 
d–ay_wr™”_·ck‘_t
 
	t¡age_·ck‘_t
;

85 cÚ¡ 
c_¡r
 
	mDEFAULT_STAGE_NAME
;

87 cÚ¡ 
size_t
 
	mDELAY_WRITER_BULK_READ_BUFFER_SIZE
;

89 
	$d–ay_wr™”_¡age_t
() { }

91 
vœtu®
 ~
	$d–ay_wr™”_¡age_t
(è{ 
	}
}

93 
	g´Ùeùed
:

95 
vœtu®
 
´oûss_·ck‘
();

99 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/stages/echo.h

24 #iâdeà
__QPIPE_ECHO_H


25 
	#__QPIPE_ECHO_H


	)

27 
	~<c¡dio
>

28 
	~"ut.h
"

29 
	~"qpe/cÜe.h
"

32 
usšg
 
Çme¥aû
 
	gqpe
;

36 
	gecho_·ck‘_t
 : 
public
 
·ck‘_t
 {

38 cÚ¡ 
c_¡r
 
PACKET_TYPE
;

40 
	ggu¬d
<
	g·ck‘_t
> 
	g_šput
;

41 
	ggu¬d
<
	gtu¶e_fifo
> 
	g_šput_bufãr
;

43 
echo_·ck‘_t
(cÚ¡ 
c_¡r
 &
·ck‘_id
,

44 
tu¶e_fifo
* 
ouut_bufãr
,

45 
tu¶e_f‹r_t
* 
ouut_f‹r
,

46 
·ck‘_t
* 
šput
)

47 : 
·ck‘_t
(
·ck‘_id
, 
PACKET_TYPE
, 
ouut_bufãr
, 
ouut_f‹r
,

48 
ü—‹_¶ª
(
ouut_f‹r
, 
šput
->
¶ª
()),

49 
Œue
,

50 
Œue


52 
_šput
(
šput
),

53 
_šput_bufãr
(
šput
->
ouut_bufãr
())

55 
as£¹
(
_šput
 !ğ
NULL
);

56 
as£¹
(
_šput_bufãr
 !ğ
NULL
);

59 
qu”y_¶ª
* 
ü—‹_¶ª
(
tu¶e_f‹r_t
* 
f‹r
, qu”y_¶ª cÚ¡* 
chd
)

61 
c_¡r
 
aùiÚ
("%s", 
PACKET_TYPE
.
d©a
());

62 
qu”y_¶ª
 cÚ¡** 
	gchd»n
 = 
Ãw
 query_plan const*[1];

63 
	gchd»n
[0] = 
chd
;

64  
Ãw
 
qu”y_¶ª
(
aùiÚ
, 
f‹r
->
to_¡ršg
(), 
chd»n
, 1);

67 
vœtu®
 
deş¬e_wÜk”_Ãeds
(
»sourû_deş¬e_t
* 
deş¬e
) {

68 
	gdeş¬e
->
deş¬e
(
_·ck‘_ty³
, 1);

69 
	g_šput
->
deş¬e_wÜk”_Ãeds
(
deş¬e
);

75 şas 
	cecho_¡age_t
 : 
public
 
¡age_t
 {

77 
public
:

79 cÚ¡ 
c_¡r
 
DEFAULT_STAGE_NAME
;

80 
echo_·ck‘_t
 
	t¡age_·ck‘_t
;

82 
	$echo_¡age_t
() { }

83 ~
	$echo_¡age_t
(è{ 
	}
}

86 
	g´Ùeùed
:

88 
vœtu®
 
´oûss_·ck‘
();

	@include/qpipe/stages/fdump.h

24 #iâdeà
__QPIPE_FDUMP_H


25 
	#__QPIPE_FDUMP_H


	)

27 
	~<c¡dio
>

29 
	~"qpe/cÜe.h
"

32 
usšg
 
Çme¥aû
 
	gqpe
;

42 
	gfdump_·ck‘_t
 : 
public
 
·ck‘_t
 {

44 
public
:

46 cÚ¡ 
c_¡r
 
PACKET_TYPE
;

48 
	ggu¬d
<
	gtu¶e_fifo
> 
	g_šput_bufãr
;

50 
c_¡r
 
	g_f’ame
;

52 
nÙify_t
* 
	g_nÙif›r
;

54 cÚ¡ 
	gc_¡r
* (*
	g_tu¶e_to_c_¡r
)(
	gtu¶e_t
*);

56 
	ggu¬d
<
	g·ck‘_t
> 
	g_chd
;

113 
fdump_·ck‘_t
(cÚ¡ 
c_¡r
 &
·ck‘_id
,

114 
tu¶e_fifo
* 
ouut_bufãr
,

115 
tu¶e_f‹r_t
* 
ouut_f‹r
,

116 
tu¶e_fifo
* 
šput_bufãr
,

117 cÚ¡ 
c_¡r
 &
f’ame
,

118 
nÙify_t
* 
nÙif›r
=
NULL
,

119 
·ck‘_t
* 
chd
=
NULL
,

120 cÚ¡ 
c_¡r
* (*
tu¶e_to_c_¡r
)(
tu¶e_t
*)=
NULL
)

121 : 
·ck‘_t
(
·ck‘_id
, 
PACKET_TYPE
, 
ouut_bufãr
, 
ouut_f‹r
,

122 
ü—‹_¶ª
(
ouut_f‹r
, 
chd
),

123 
çl£
,

124 
çl£


126 
_šput_bufãr
(
šput_bufãr
),

127 
_f’ame
(
f’ame
),

128 
_nÙif›r
(
nÙif›r
),

129 
_chd
(
chd
),

130 
_tu¶e_to_c_¡r
(
tu¶e_to_c_¡r
)

132 ià(
	g_chd
) {

133 
	g_šput_bufãr
 = 
_chd
.
g‘
()->
ouut_bufãr
();

137 
qu”y_¶ª
 * 
ü—‹_¶ª
(
tu¶e_f‹r_t
* 
f‹r
, 
·ck‘_t
* 
chd
) {

138 
c_¡r
 
aùiÚ
("%s:%s", 
PACKET_TYPE
.
d©a
(), 
chd
->
_·ck‘_ty³
.data());

139 ià(
	gchd
) {

140 
qu”y_¶ª
 cÚ¡** 
	gchd»n
 = 
Ãw
 query_plan const*[1];

141 
	gchd»n
[0] = 
chd
->
¶ª
();

142  
Ãw
 
qu”y_¶ª
(
aùiÚ
, 
f‹r
->
to_¡ršg
(), 
chd»n
, 1);

144  
	gNULL
;

148 
vœtu®
 
deş¬e_wÜk”_Ãeds
(
»sourû_deş¬e_t
 * 
deş¬e
) {

149 ià(
	g_chd
) {

150 
	gdeş¬e
->
deş¬e
(
_·ck‘_ty³
, 1);

151 
	g_chd
->
deş¬e_wÜk”_Ãeds
(
deş¬e
);

165 şas 
	cfdump_¡age_t
 : 
public
 
¡age_t
 {

167 
public
:

169 cÚ¡ 
c_¡r
 
DEFAULT_STAGE_NAME
;

170 
fdump_·ck‘_t
 
	t¡age_·ck‘_t
;

172 
	$fdump_¡age_t
() { }

174 
vœtu®
 ~
	$fdump_¡age_t
(è{ 
	}
}

176 
	g´Ùeùed
:

178 
vœtu®
 
´oûss_·ck‘
();

	@include/qpipe/stages/fscan.h

24 #iâdeà
__QPIPE_FSCAN_H


25 
	#__QPIPE_FSCAN_H


	)

27 
	~<c¡dio
>

29 
	~"qpe/cÜe.h
"

33 
usšg
 
Çme¥aû
 
	gqpe
;

40 şas 
	cfsÿn_·ck‘_t
 : 
public
 
·ck‘_t
 {

42 
public
:

44 cÚ¡ 
c_¡r
 
PACKET_TYPE
;

47 
c_¡r
 
	m_f’ame
;

75 
	$fsÿn_·ck‘_t
(cÚ¡ 
c_¡r
 &
·ck‘_id
,

76 
tu¶e_fifo
* 
ouut_bufãr
,

77 
tu¶e_f‹r_t
* 
ouut_f‹r
,

78 cÚ¡ 
c_¡r
 &
f’ame
)

79 : 
	`·ck‘_t
(
·ck‘_id
, 
PACKET_TYPE
, 
ouut_bufãr
, 
ouut_f‹r
,

80 
	`ü—‹_¶ª
(
ouut_f‹r
, 
f’ame
),

81 
çl£
,

82 
çl£


84 
	$_f’ame
(
f’ame
)

88 
qu”y_¶ª
* 
	$ü—‹_¶ª
(
tu¶e_f‹r_t
* 
f‹r
, cÚ¡ 
c_¡r
 &
fe_Çme
) {

89 
c_¡r
 
	`aùiÚ
("%s:%s", 
PACKET_TYPE
.
	`d©a
(), 
fe_Çme
.data());

90  
Ãw
 
	`qu”y_¶ª
(
aùiÚ
, 
f‹r
->
	`to_¡ršg
(), 
NULL
, 0);

91 
	}
}

93 
vœtu®
 
	$deş¬e_wÜk”_Ãeds
(
»sourû_deş¬e_t
*) {

96 
	}
}

105 şas 
	cfsÿn_¡age_t
 : 
public
 
¡age_t
 {

107 
public
:

109 cÚ¡ 
c_¡r
 
DEFAULT_STAGE_NAME
;

110 
fsÿn_·ck‘_t
 
	t¡age_·ck‘_t
;

112 
	$fsÿn_¡age_t
() { }

114 
vœtu®
 ~
	$fsÿn_¡age_t
(è{ 
	}
}

116 
	g´Ùeùed
:

118 
vœtu®
 
´oûss_·ck‘
();

	@include/qpipe/stages/func_call.h

24 #iâdeà
__QPIPE_FUNC_CALL_H


25 
	#__QPIPE_FUNC_CALL_H


	)

27 
	~<c¡dio
>

29 
	~"qpe/cÜe.h
"

33 
usšg
 
Çme¥aû
 
	gqpe
;

40 şas 
	cfunc_ÿÎ_·ck‘_t
 : 
public
 
·ck‘_t
 {

42 
public
:

44 cÚ¡ 
c_¡r
 
PACKET_TYPE
;

47 (*
_func
) (*, *);

50 * 
_func_¬g
;

53 (*
_de¡ruùÜ
) (*);

82 
	`func_ÿÎ_·ck‘_t
(cÚ¡ 
c_¡r
 &
·ck‘_id
,

83 
tu¶e_fifo
* 
ouut_bufãr
,

84 
tu¶e_f‹r_t
* 
ouut_f‹r
,

85 (*
func
) (*, *),

86 * 
func_¬g
,

87 (*
de¡ruùÜ
è(*èğ
NULL
,

88 
boŞ
 
_m”ge
=
çl£
,

89 
boŞ
 
_uÄe£rve
=
Œue
)

90 : 
	`·ck‘_t
(
·ck‘_id
, 
PACKET_TYPE
, 
ouut_bufãr
, 
ouut_f‹r
,

91 
_m”ge
 ? 
	$ü—‹_¶ª
(
ouut_f‹r
, 
func
è: 
NULL
,

92 
_m”ge
,

93 
_uÄe£rve


95 
	`_func
(
func
),

96 
	`_func_¬g
(
func_¬g
),

97 
	$_de¡ruùÜ
(
de¡ruùÜ
)

100 
	`as£¹
(
func
 !ğ
NULL
);

101 ià(
_m”ge
 && !
_uÄe£rve
) {

102 
	`TRACE
(
TRACE_ALWAYS
,

109 
vœtu®
 ~
	$func_ÿÎ_·ck‘_t
() {

111 iàĞ
_de¡ruùÜ
 !ğ
NULL
 )

112 
	`_de¡ruùÜ
(
_func_¬g
);

113 
	}
}

115 
qu”y_¶ª
* 
ü—‹_¶ª
(
tu¶e_f‹r_t
* 
f‹r
, (*
func
) (*, *)) {

116 
c_¡r
 
	`aùiÚ
("%p", 
func
);

117  
Ãw
 
	`qu”y_¶ª
(
aùiÚ
, 
f‹r
->
	`to_¡ršg
(), 
NULL
, 0);

118 
	}
}

120 
vœtu®
 
	$deş¬e_wÜk”_Ãeds
(
»sourû_deş¬e_t
*) {

123 
	}
}

132 şas 
	cfunc_ÿÎ_¡age_t
 : 
public
 
¡age_t
 {

134 
public
:

136 cÚ¡ 
c_¡r
 
DEFAULT_STAGE_NAME
;

137 
func_ÿÎ_·ck‘_t
 
	t¡age_·ck‘_t
;

139 
	$func_ÿÎ_¡age_t
() { }

141 
vœtu®
 ~
	$func_ÿÎ_¡age_t
(è{ 
	}
}

143 
	g´Ùeùed
:

145 
vœtu®
 
´oûss_·ck‘
();

	@include/qpipe/stages/hash_aggregate.h

24 #iâdeà
__QPIPE_HASH_AGGREGATE_H


25 
	#__QPIPE_HASH_AGGREGATE_H


	)

27 
	~"qpe/cÜe.h
"

28 
	~"ut/»sourû_deş¬e.h
"

30 
usšg
 
Çme¥aû
 
	gqpe
;

33 
	ghash_agg»g©e_·ck‘_t
 : 
public
 
·ck‘_t
 {

34 cÚ¡ 
c_¡r
 
PACKET_TYPE
;

35 
	ggu¬d
<
	g·ck‘_t
> 
	g_šput
;

36 
	ggu¬d
<
	gtu¶e_fifo
> 
	g_šput_bufãr
;

37 
	ggu¬d
<
	gtu¶e_agg»g©e_t
> 
	g_agg»g©e
;

38 
	ggu¬d
<
	gkey_exŒaùÜ_t
> 
	g_exŒaùÜ
;

39 
	ggu¬d
<
	gkey_com·»_t
> 
	g_com·»
;

41 
hash_agg»g©e_·ck‘_t
(cÚ¡ 
c_¡r
 &
·ck‘_id
,

42 
tu¶e_fifo
* 
out_bufãr
,

43 
tu¶e_f‹r_t
* 
out_f‹r
,

44 
·ck‘_t
* 
šput
,

45 
tu¶e_agg»g©e_t
 *
agg»g©e
,

46 
key_exŒaùÜ_t
* 
exŒaùÜ
,

47 
key_com·»_t
* 
com·»
)

48 : 
·ck‘_t
(
·ck‘_id
, 
PACKET_TYPE
, 
out_bufãr
, 
out_f‹r
,

49 
ü—‹_¶ª
(
out_f‹r
, 
agg»g©e
, 
exŒaùÜ
, 
šput
->
¶ª
()),

50 
Œue
,

51 
Œue


53 
_šput
(
šput
), 
_šput_bufãr
(šput->
ouut_bufãr
()),

54 
_agg»g©e
(
agg»g©e
), 
_exŒaùÜ
(
exŒaùÜ
), 
_com·»
(
com·»
)

59 
qu”y_¶ª
* 
ü—‹_¶ª
(
tu¶e_f‹r_t
* 
f‹r
, 
tu¶e_agg»g©e_t
* 
agg
,

60 
key_exŒaùÜ_t
* 
key
, 
qu”y_¶ª
 cÚ¡* 
chd
)

62 
c_¡r
 
aùiÚ
("%s:%s:%s", 
PACKET_TYPE
.
d©a
(),

63 
agg
->
to_¡ršg
().
d©a
(), 
key
->to_string().data());

65 
qu”y_¶ª
 cÚ¡** 
	gchd»n
 = 
Ãw
 query_plan const*[1];

66 
	gchd»n
[0] = 
chd
;

67  
Ãw
 
qu”y_¶ª
(
aùiÚ
, 
f‹r
->
to_¡ršg
(), 
chd»n
, 1);

70 
vœtu®
 
deş¬e_wÜk”_Ãeds
(
»sourû_deş¬e_t
* 
deş¬e
) {

71 
	gdeş¬e
->
deş¬e
(
_·ck‘_ty³
, 1);

72 
	g_šput
->
deş¬e_wÜk”_Ãeds
(
deş¬e
);

78 şas 
	chash_agg»g©e_¡age_t
 : 
public
 
¡age_t
 {

80 
·ge_Œash_¡ack
 
_·ge_li¡
;

81 
size_t
 
	m_·ge_couÁ
;

82 
tu¶e_agg»g©e_t
* 
	m_agg»g©e
;

83 
	mqpe
::
·ge
* 
_agg_·ge
;

84 
size_t
 
	m_tu¶e_®ign
;

85 
	mpublic
:

86 cÚ¡ 
c_¡r
 
DEFAULT_STAGE_NAME
;

87 
hash_agg»g©e_·ck‘_t
 
	t¡age_·ck‘_t
;

89 
	m´Ùeùed
:

90 
vœtu®
 
´oûss_·ck‘
();

91 
®loc_agg
(
tu¶e_t
 &
agg
, cÚ¡ * 
key
);

	@include/qpipe/stages/hash_join.h

31 #iâdeà
__QPIPE_HASH_JOIN_STAGE_H


32 
	#__QPIPE_HASH_JOIN_STAGE_H


	)

34 
	~"qpe/cÜe.h
"

35 
	~"ut/hashbË.h
"

37 #ià
defšed
(
lšux
è|| defšed(
__lšux
)

38 
	~<ext/hash_£t
>

41 
	~<¡ršg
>

43 
usšg
 
	g¡d
::
¡ršg
;

44 
usšg
 
	g¡d
::
veùÜ
;

47 
ENTER_NAMESPACE
(
qpe
);

50 
	#HASH_JOIN_STAGE_NAME
 "HASH_JOIN"

	)

51 
	#HASH_JOIN_PACKET_TYPE
 "HASH_JOIN"

	)

60 şas 
	chash_još_·ck‘_t
 : 
public
 
·ck‘_t
 {

62 
public
:

63 cÚ¡ 
c_¡r
 
PACKET_TYPE
;

65 
	mgu¬d
<
	m·ck‘_t
> 
	m_Ëá
;

66 
	mgu¬d
<
	m·ck‘_t
> 
	m_right
;

67 
	mgu¬d
<
	mtu¶e_fifo
> 
	m_Ëá_bufãr
;

68 
	mgu¬d
<
	mtu¶e_fifo
> 
	m_right_bufãr
;

70 
	mgu¬d
<
	mtu¶e_još_t
> 
	m_još
;

71 
boŞ
 
	m_ou‹r
;

72 
boŞ
 
	m_di¡šù
;

74 
	mcouÁ_out
;

75 
	mcouÁ_Ëá
;

76 
	mcouÁ_right
;

108 
	$hash_još_·ck‘_t
(cÚ¡ 
c_¡r
 &
·ck‘_id
,

109 
tu¶e_fifo
* 
out_bufãr
,

110 
tu¶e_f‹r_t
 *
ouut_f‹r
,

111 
·ck‘_t
* 
Ëá
,

112 
·ck‘_t
* 
right
,

113 
tu¶e_još_t
 *
još
,

114 
boŞ
 
ou‹r
=
çl£
,

115 
boŞ
 
di¡šù
=
çl£
)

116 : 
	`·ck‘_t
(
·ck‘_id
, 
PACKET_TYPE
, 
out_bufãr
, 
ouut_f‹r
,

117 
	`ü—‹_¶ª
(
ouut_f‹r
, 
još
, 
ou‹r
, 
di¡šù
, 
Ëá
, 
right
),

118 
Œue
,

119 
Œue


121 
	`_Ëá
(
Ëá
),

122 
	`_right
(
right
),

123 
	`_Ëá_bufãr
(
Ëá
->
	`ouut_bufãr
()),

124 
	`_right_bufãr
(
right
->
	`ouut_bufãr
()),

125 
	`_još
(
još
),

126 
	`_ou‹r
(
ou‹r
), 
	$_di¡šù
(
di¡šù
)

130 
qu”y_¶ª
* 
	$ü—‹_¶ª
(
tu¶e_f‹r_t
* 
f‹r
, 
tu¶e_još_t
* 
još
,

131 
boŞ
 
ou‹r
, boŞ 
di¡šù
,

132 
·ck‘_t
* 
Ëá
,…ack‘_t* 
right
)

134 
c_¡r
 
	`aùiÚ
("%s:%s:%d:%d", 
PACKET_TYPE
.
	`d©a
(),

135 
još
->
	`to_¡ršg
().
	`d©a
(), 
ou‹r
, 
di¡šù
);

137 
qu”y_¶ª
 cÚ¡** 
chd»n
 = 
Ãw
 query_plan const*[2];

138 
chd»n
[0] = 
Ëá
->
	`¶ª
();

139 
chd»n
[1] = 
right
->
	`¶ª
();

140  
Ãw
 
	`qu”y_¶ª
(
aùiÚ
, 
f‹r
->
	`to_¡ršg
(), 
chd»n
, 2);

141 
	}
}

143 
vœtu®
 
	$deş¬e_wÜk”_Ãeds
(
»sourû_deş¬e_t
* 
deş¬e
) {

144 
deş¬e
->
	`deş¬e
(
_·ck‘_ty³
, 1);

145 
_Ëá
->
	`deş¬e_wÜk”_Ãeds
(
deş¬e
);

146 
_right
->
	`deş¬e_wÜk”_Ãeds
(
deş¬e
);

147 
	}
}

156 şas 
	chash_još_¡age_t
 : 
public
 
¡age_t
 {

159 
´iv©e
:

168 
	sexŒaùkey_t
 {

170 
tu¶e_još_t
 *
_još
;

171 
boŞ
 
	m_right
;

173 
exŒaùkey_t
(
tu¶e_još_t
 *
još
, 
boŞ
 
right
)

174 : 
_još
(
još
)

175 , 
_right
(
right
)

179 cÚ¡ * cÚ¡ 
İ”©Ü
()(cÚ¡ * 
	mv®ue
) const {

180  
	m_right
 ? 
	m_još
->
right_key_by‹s
(
v®ue
è: 
_još
->
Ëá_key_by‹s
(value);

187 
	sequ®by‹s_t
 {

189 
size_t
 
	g_Ën
;

190 
equ®by‹s_t
(
size_t
 
Ën
)

191 : 
_Ën
(
Ën
)

195 
boŞ
 
İ”©Ü
()(cÚ¡ *
k1
, cÚ¡ *
	gk2
) const {

196  !
memcmp
(
k1
, 
k2
, 
_Ën
);

201 
	shashfú_t
 {

203 
size_t
 
	g_Ën
;

204 
hashfú_t
(
size_t
 
Ën
)

205 : 
_Ën
(
Ën
)

209 
size_t
 
İ”©Ü
()(cÚ¡ *
key
) const {

210  
âv_hash
(
key
, 
_Ën
);

214 
	ghashbË
<*,

216 
	texŒaùkey_t
,

217 
	tequ®by‹s_t
,

218 
	tequ®by‹s_t
,

219 
	thashfú_t
> 
	ttu¶e_hash_t
;

224 
	s·¹™iÚ_t
 {

226 
·ge
* 
	g_·ge
;

227 
	gsize
;

228 
FILE
 *
	gfe
;

229 
c_¡r
 
	gfe_Çme1
;

230 
c_¡r
 
	gfe_Çme2
;

232 
·¹™iÚ_t
()

233 : 
_·ge
(
NULL
), 
size
(0), 
fe
(NULL)

239 
	g¡d
::
	tveùÜ
<
	t·¹™iÚ_t
> 
	t·¹™iÚ_li¡_t
;

242 
	sËá_aùiÚ_t
 {

243 
İ”©Ü
 ()(
	g·¹™iÚ_li¡_t
::
™”©Ü
 
™
) {

244 
™
->
fe
 = 
NULL
;

249 
	sright_aùiÚ_t
 {

250 
size_t
 
	g_Ëá_tu¶e_size
;

251 
right_aùiÚ_t
(
size_t
 
Ëá_tu¶e_size
)

252 : 
_Ëá_tu¶e_size
(
Ëá_tu¶e_size
)

255 
İ”©Ü
()(
·¹™iÚ_li¡_t
::
™”©Ü
 
™
) {

257 
™
->
fe
 = 
ü—‹_tmp_fe
(™->
fe_Çme2
, "hash-join-left");

260 
	g™
->
	g_·ge
 = 
·ge
::
®loc
(
_Ëá_tu¶e_size
);

268 
	g·ge_quÙa
;

269 
	g·ge_couÁ
;

270 
tu¶e_još_t
 *
	g_još
;

271 
·¹™iÚ_li¡_t
 
	g·¹™iÚs
;

276 
‹¡_ov”æow
(
·¹™iÚ
);

278 
	g‹m¶©e
<
şass
 
	gAùiÚ
>

279 
şo£_fe
(
·¹™iÚ_li¡_t
::
™”©Ü
 
™
, 
AùiÚ
 
a
);

283 
	gpublic
:

285 
hash_još_·ck‘_t
 
	t¡age_·ck‘_t
;

287 cÚ¡ 
c_¡r
 
	gDEFAULT_STAGE_NAME
;

290 
vœtu®
 
´oûss_·ck‘
();

294 
	$hash_još_¡age_t
()

295 : 
	`·ge_quÙa
(10000)

296 , 
	`·ge_couÁ
(0)

297 , 
	$·¹™iÚs
(512)

299 
	}
}

301 ~
	$hash_još_¡age_t
() {

302 
	}
}

307 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/stages/merge.h

24 #iâdeà
__QPIPE_MERGE_H


25 
	#__QPIPE_MERGE_H


	)

27 
	~"qpe/cÜe.h
"

29 
	~<veùÜ
>

31 
usšg
 
	g¡d
::
veùÜ
;

35 
usšg
 
Çme¥aû
 
	gqpe
;

42 
	gm”ge_·ck‘_t
 : 
public
 
·ck‘_t
 {

44 cÚ¡ 
c_¡r
 
PACKET_TYPE
;

45 
	g¡d
::
	tveùÜ
<
	ttu¶e_fifo
*> 
	tbufãr_li¡_t
;

47 
bufãr_li¡_t
 
	g_šput_bufãrs
;

48 
	ggu¬d
<
	gkey_exŒaùÜ_t
> 
	g_exŒaù
;

49 
	ggu¬d
<
	gkey_com·»_t
> 
	g_com·»
;

82 
m”ge_·ck‘_t
(cÚ¡ 
c_¡r
 &
·ck‘_id
,

83 
tu¶e_fifo
* 
ouut_bufãr
,

84 
tu¶e_f‹r_t
* 
ouut_f‹r
,

85 cÚ¡ 
bufãr_li¡_t
& 
šput_bufãrs
,

86 
key_exŒaùÜ_t
* 
exŒaù
,

87 
key_com·»_t
* 
com·»
)

88 : 
·ck‘_t
(
·ck‘_id
, 
PACKET_TYPE
, 
ouut_bufãr
, 
ouut_f‹r
, 
NULL
,

89 
çl£
,

90 
çl£


92 
_šput_bufãrs
(
šput_bufãrs
),

93 
_exŒaù
(
exŒaù
),

94 
_com·»
(
com·»
)

98 ~
m”ge_·ck‘_t
() {

99 
	gbufãr_li¡_t
::
™”©Ü
 
™
=
_šput_bufãrs
.
begš
();

100 
	g™
 !ğ
_šput_bufãrs
.
’d
())

101 
d–‘e
 *
™
++;

104 
vœtu®
 
deş¬e_wÜk”_Ãeds
(
»sourû_deş¬e_t
*) {

116 şas 
	cm”ge_¡age_t
 : 
public
 
¡age_t
 {

118 
´iv©e
:

120 
	sbufãr_h—d_t
 {

122 
bufãr_h—d_t
* 
Ãxt
;

123 
tu¶e_fifo
* 
	mbufãr
;

124 
key_exŒaùÜ_t
* 
	m_exŒaù
;

125 
	m¬¿y_gu¬d_t
<> 
	md©a
;

126 
tu¶e_t
 
	mtu¶e
;

127 
hšt_tu¶e_·œ_t
 
	m™em
;

128 
bufãr_h—d_t
() { }

129 
boŞ
 
š™
(
tu¶e_fifo
* 
buf
, 
key_exŒaùÜ_t
* 
c
);

130 
boŞ
 
has_tu¶e
();

133 
bufãr_h—d_t
* 
	g_h—d_li¡
;

134 
key_com·»_t
* 
	g_com·»
;

135 
key_exŒaùÜ_t
* 
	g_exŒaù
;

137 
	gpublic
:

139 cÚ¡ 
c_¡r
 
DEFAULT_STAGE_NAME
;

140 
m”ge_·ck‘_t
 
	t¡age_·ck‘_t
;

142 
	$m”ge_¡age_t
()

143 : 
	$_h—d_li¡
(
NULL
)

145 
	}
}

147 
´Ùeùed
:

149 
vœtu®
 
´oûss_·ck‘
();

151 
	g´iv©e
:

153 
š£¹_sÜ‹d
(
bufãr_h—d_t
* 
h—d
);

154 
com·»
(cÚ¡ 
hšt_tu¶e_·œ_t
 &
a
, cÚ¡ hšt_tu¶e_·œ_ˆ&
b
);

	@include/qpipe/stages/partial_aggregate.h

24 #iâdeà
__QPIPE_PARTIAL_AGGREGATE_H


25 
	#__QPIPE_PARTIAL_AGGREGATE_H


	)

27 
	~"qpe/cÜe.h
"

29 
	~<£t
>

31 
usšg
 
Çme¥aû
 
	gqpe
;

33 
	g·¹Ÿl_agg»g©e_·ck‘_t
 : 
public
 
·ck‘_t
 {

34 cÚ¡ 
c_¡r
 
PACKET_TYPE
;

35 
	ggu¬d
<
	g·ck‘_t
> 
	g_šput
;

36 
	ggu¬d
<
	gtu¶e_fifo
> 
	g_šput_bufãr
;

37 
	ggu¬d
<
	gtu¶e_agg»g©e_t
> 
	g_agg»g©e
;

38 
	ggu¬d
<
	gkey_exŒaùÜ_t
> 
	g_exŒaùÜ
;

39 
	ggu¬d
<
	gkey_com·»_t
> 
	g_com·»
;

41 
·¹Ÿl_agg»g©e_·ck‘_t
(cÚ¡ 
c_¡r
 &
·ck‘_id
,

42 
tu¶e_fifo
* 
out_bufãr
,

43 
tu¶e_f‹r_t
* 
out_f‹r
,

44 
·ck‘_t
* 
šput
,

45 
tu¶e_agg»g©e_t
 *
agg»g©e
,

46 
key_exŒaùÜ_t
* 
exŒaùÜ
,

47 
key_com·»_t
* 
com·»
)

48 : 
·ck‘_t
(
·ck‘_id
, 
PACKET_TYPE
, 
out_bufãr
, 
out_f‹r
,

49 
ü—‹_¶ª
(
out_f‹r
, 
agg»g©e
, 
exŒaùÜ
, 
šput
->
¶ª
()),

50 
Œue
,

51 
Œue


53 
_šput
(
šput
), 
_šput_bufãr
(šput->
ouut_bufãr
()),

54 
_agg»g©e
(
agg»g©e
), 
_exŒaùÜ
(
exŒaùÜ
), 
_com·»
(
com·»
)

59 
qu”y_¶ª
* 
ü—‹_¶ª
(
tu¶e_f‹r_t
* 
f‹r
, 
tu¶e_agg»g©e_t
* 
agg
,

60 
key_exŒaùÜ_t
* 
key
, 
qu”y_¶ª
 cÚ¡* 
chd
)

62 
c_¡r
 
aùiÚ
("%s:%s:%s", 
PACKET_TYPE
.
d©a
(),

63 
agg
->
to_¡ršg
().
d©a
(), 
key
->to_string().data());

65 
qu”y_¶ª
 cÚ¡** 
	gchd»n
 = 
Ãw
 query_plan const*[1];

66 
	gchd»n
[0] = 
chd
;

67  
Ãw
 
qu”y_¶ª
(
aùiÚ
, 
f‹r
->
to_¡ršg
(), 
chd»n
, 1);

70 
vœtu®
 
deş¬e_wÜk”_Ãeds
(
»sourû_deş¬e_t
* 
deş¬e
) {

71 
	gdeş¬e
->
deş¬e
(
_·ck‘_ty³
, 1);

72 
	g_šput
->
deş¬e_wÜk”_Ãeds
(
deş¬e
);

78 şas 
	c·¹Ÿl_agg»g©e_¡age_t
 : 
public
 
¡age_t
 {

79 
¡d
::
	t£t
<
	thšt_tu¶e_·œ_t
, 
	ttu¶e_Ëss_t
> 
	ttu¶e_£t_t
;

81 
·ge_Œash_¡ack
 
	m_·ge_li¡
;

82 
size_t
 
	m_·ge_couÁ
;

83 
tu¶e_agg»g©e_t
* 
	m_agg»g©e
;

84 
	mqpe
::
·ge
* 
_agg_·ge
;

85 
size_t
 
	m_tu¶e_®ign
;

86 
	mpublic
:

87 cÚ¡ 
c_¡r
 
DEFAULT_STAGE_NAME
;

88 
·¹Ÿl_agg»g©e_·ck‘_t
 
	t¡age_·ck‘_t
;

90 
	m´Ùeùed
:

91 
vœtu®
 
´oûss_·ck‘
();

92 
®loc_agg
(
hšt_tu¶e_·œ_t
 &
agg
, cÚ¡ * 
key
);

	@include/qpipe/stages/pipe_hash_join.h

31 #iâdeà
__QPIPE_PIPE_HASH_JOIN_STAGE_H


32 
	#__QPIPE_PIPE_HASH_JOIN_STAGE_H


	)

34 
	~"qpe/cÜe.h
"

36 
	~<¡ršg
>

38 
usšg
 
	g¡d
::
¡ršg
;

39 
usšg
 
	g¡d
::
veùÜ
;

42 
ENTER_NAMESPACE
(
qpe
);

44 
	#PIPE_HASH_JOIN_STAGE_NAME
 "PIPE_HASH_JOIN"

	)

45 
	#PIPE_HASH_JOIN_PACKET_TYPE
 "PIPE_HASH_JOIN"

	)

53 şas 
	cpe_hash_još_·ck‘_t
 : 
public
 
·ck‘_t
 {

55 
public
:

56 cÚ¡ 
c_¡r
 
PACKET_TYPE
;

58 
	mgu¬d
<
	m·ck‘_t
> 
	m_Ëá
;

59 
	mgu¬d
<
	m·ck‘_t
> 
	m_right
;

60 
	mgu¬d
<
	mtu¶e_fifo
> 
	m_Ëá_bufãr
;

61 
	mgu¬d
<
	mtu¶e_fifo
> 
	m_right_bufãr
;

63 
	mgu¬d
<
	mtu¶e_još_t
> 
	m_još
;

65 
	mcouÁ_out
;

66 
	mcouÁ_Ëá
;

67 
	mcouÁ_right
;

99 
	$pe_hash_još_·ck‘_t
(cÚ¡ 
c_¡r
 &
·ck‘_id
,

100 
tu¶e_fifo
* 
out_bufãr
,

101 
tu¶e_f‹r_t
 *
ouut_f‹r
,

102 
·ck‘_t
* 
Ëá
,

103 
·ck‘_t
* 
right
,

104 
tu¶e_još_t
 *
još
)

106 : 
	`·ck‘_t
(
·ck‘_id
, 
PACKET_TYPE
, 
out_bufãr
, 
ouut_f‹r
,

107 
	`ü—‹_¶ª
(
ouut_f‹r
, 
još
, 
Ëá
, 
right
),

108 
Œue
,

109 
Œue


111 
	`_Ëá
(
Ëá
),

112 
	`_right
(
right
),

113 
	`_Ëá_bufãr
(
Ëá
->
	`ouut_bufãr
()),

114 
	`_right_bufãr
(
right
->
	`ouut_bufãr
()),

115 
	$_još
(
još
)

119 
qu”y_¶ª
* 
	$ü—‹_¶ª
(
tu¶e_f‹r_t
* 
f‹r
, 
tu¶e_još_t
* 
još
,

120 
·ck‘_t
* 
Ëá
,…ack‘_t* 
right
)

122 
c_¡r
 
	`aùiÚ
("%s:%s", 
PACKET_TYPE
.
	`d©a
(),

123 
još
->
	`to_¡ršg
().
	`d©a
());

125 
qu”y_¶ª
 cÚ¡** 
chd»n
 = 
Ãw
 query_plan const*[2];

126 
chd»n
[0] = 
Ëá
->
	`¶ª
();

127 
chd»n
[1] = 
right
->
	`¶ª
();

128  
Ãw
 
	`qu”y_¶ª
(
aùiÚ
, 
f‹r
->
	`to_¡ršg
(), 
chd»n
, 2);

129 
	}
}

131 
vœtu®
 
	$deş¬e_wÜk”_Ãeds
(
»sourû_deş¬e_t
* 
deş¬e
) {

132 
deş¬e
->
	`deş¬e
(
_·ck‘_ty³
, 1);

133 
_Ëá
->
	`deş¬e_wÜk”_Ãeds
(
deş¬e
);

134 
_right
->
	`deş¬e_wÜk”_Ãeds
(
deş¬e
);

135 
	}
}

144 şas 
	cpe_hash_još_¡age_t
 : 
public
 
¡age_t
 {

147 
´iv©e
:

153 
tu¶e_još_t
 *
_još
;

157 
	mpublic
:

159 
pe_hash_još_·ck‘_t
 
	t¡age_·ck‘_t
;

161 cÚ¡ 
c_¡r
 
	mDEFAULT_STAGE_NAME
;

164 
vœtu®
 
´oûss_·ck‘
();

170 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/stages/register_stage_containers.h

30 #iâdeà
__QPIPE_REGISTER_STAGE_CONTAINERS_H


31 
	#__QPIPE_REGISTER_STAGE_CONTAINERS_H


	)

33 
	~"qpe/cÜe.h
"

35 
ENTER_NAMESPACE
(
qpe
);

37 
	g‹m¶©e
 <
şass
 
	gSge
>

38 
	$»gi¡”_¡age
(
wÜk”_th»ads
=10, 
boŞ
 
o¥
=
Œue
)

40 
¡age_cÚš”_t
* 
sc
;

41 
c_¡r
 
	`Çme
("%s_CONTAINER", 
Sge
::
DEFAULT_STAGE_NAME
.
	`d©a
());

42 
sc
 = 
Ãw
 
	`¡age_cÚš”_t
(
Çme
,‚ew 
¡age_çùÜy
<
Sge
>, 
wÜk”_th»ads
);

43 
di¥©ch”_t
::
	`»gi¡”_¡age_cÚš”
(
Sge
::
¡age_·ck‘_t
::
PACKET_TYPE
.
	`d©a
(), 
sc
, 
o¥
);

44 
	}
}

46 
»gi¡”_¡age_cÚš”s
();

49 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/stages/sieve.h

24 #iâdeà
__QPIPE_SIEVE_H


25 
	#__QPIPE_SIEVE_H


	)

27 
	~<c¡dio
>

28 
	~"ut.h
"

29 
	~"qpe/cÜe.h
"

31 
usšg
 
Çme¥aû
 
	gqpe
;

35 
	gs›ve_·ck‘_t
 : 
public
 
·ck‘_t
 {

37 cÚ¡ 
c_¡r
 
PACKET_TYPE
;

39 
	ggu¬d
<
	gtu¶e_s›ve_t
> 
	g_s›ve
;

40 
	ggu¬d
<
	g·ck‘_t
> 
	g_šput
;

41 
	ggu¬d
<
	gtu¶e_fifo
> 
	g_šput_bufãr
;

43 
s›ve_·ck‘_t
(cÚ¡ 
c_¡r
 &
·ck‘_id
,

44 
tu¶e_fifo
* 
ouut_bufãr
,

45 
tu¶e_f‹r_t
* 
ouut_f‹r
,

46 
tu¶e_s›ve_t
* 
s›ve
,

47 
·ck‘_t
* 
šput
)

48 : 
·ck‘_t
(
·ck‘_id
, 
PACKET_TYPE
, 
ouut_bufãr
, 
ouut_f‹r
,

49 
ü—‹_¶ª
(
ouut_f‹r
, 
s›ve
, 
šput
->
¶ª
()),

50 
Œue
,

51 
Œue


53 
_s›ve
(
s›ve
),

54 
_šput
(
šput
),

55 
_šput_bufãr
(
šput
->
ouut_bufãr
())

57 
as£¹
(
_šput
 !ğ
NULL
);

58 
as£¹
(
_šput_bufãr
 !ğ
NULL
);

61 
qu”y_¶ª
* 
ü—‹_¶ª
(
tu¶e_f‹r_t
* 
f‹r
, 
tu¶e_s›ve_t
* 
s›ve
,

62 
qu”y_¶ª
 cÚ¡* 
chd
)

64 
c_¡r
 
aùiÚ
("%s:%s", 
PACKET_TYPE
.
d©a
(), 
s›ve
->
to_¡ršg
().data());

65 
qu”y_¶ª
 cÚ¡** 
	gchd»n
 = 
Ãw
 query_plan const*[1];

66 
	gchd»n
[0] = 
chd
;

67  
Ãw
 
qu”y_¶ª
(
aùiÚ
, 
f‹r
->
to_¡ršg
(), 
chd»n
, 1);

70 
vœtu®
 
deş¬e_wÜk”_Ãeds
(
»sourû_deş¬e_t
* 
deş¬e
) {

71 
	gdeş¬e
->
deş¬e
(
_·ck‘_ty³
, 1);

72 
	g_šput
->
deş¬e_wÜk”_Ãeds
(
deş¬e
);

78 şas 
	cs›ve_¡age_t
 : 
public
 
¡age_t
 {

80 
public
:

82 cÚ¡ 
c_¡r
 
DEFAULT_STAGE_NAME
;

83 
s›ve_·ck‘_t
 
	t¡age_·ck‘_t
;

85 
	$s›ve_¡age_t
() { }

86 ~
	$s›ve_¡age_t
(è{ 
	}
}

88 
	g´Ùeùed
:

90 
vœtu®
 
´oûss_·ck‘
();

	@include/qpipe/stages/sort.h

24 #iâdeà
__QPIPE_SORT_H


25 
	#__QPIPE_SORT_H


	)

27 
	~"qpe/¡ages/m”ge.h
"

28 
	~"qpe/cÜe.h
"

30 
	~<li¡
>

31 
	~<m­
>

32 
	~<deque
>

36 
usšg
 
Çme¥aû
 
	gqpe
;

37 
usšg
 
Çme¥aû
 
	g¡d
;

48 
	gsÜt_·ck‘_t
 : 
public
 
·ck‘_t
 {

50 
public
:

52 cÚ¡ 
c_¡r
 
PACKET_TYPE
;

55 
	ggu¬d
<
	gkey_exŒaùÜ_t
> 
	g_exŒaù
;

56 
	ggu¬d
<
	gkey_com·»_t
> 
	g_com·»
;

57 
	ggu¬d
<
	g·ck‘_t
> 
	g_šput
;

58 
	ggu¬d
<
	gtu¶e_fifo
> 
	g_šput_bufãr
;

90 
sÜt_·ck‘_t
(cÚ¡ 
c_¡r
 &
·ck‘_id
,

91 
tu¶e_fifo
* 
ouut_bufãr
,

92 
tu¶e_f‹r_t
* 
ouut_f‹r
,

93 
key_exŒaùÜ_t
* 
exŒaù
,

94 
key_com·»_t
* 
com·»
,

95 
·ck‘_t
* 
šput
)

96 : 
·ck‘_t
(
·ck‘_id
, 
PACKET_TYPE
, 
ouut_bufãr
, 
ouut_f‹r
,

97 
ü—‹_¶ª
(
ouut_f‹r
, 
exŒaù
, 
šput
),

98 
Œue
,

99 
Œue


101 
_exŒaù
(
exŒaù
), 
_com·»
(
com·»
),

102 
_šput
(
šput
),

103 
_šput_bufãr
(
šput
->
ouut_bufãr
())

105 
as£¹
(
_šput
 !ğ
NULL
);

106 
as£¹
(
_šput_bufãr
 !ğ
NULL
);

109 
qu”y_¶ª
* 
ü—‹_¶ª
(
tu¶e_f‹r_t
* 
f‹r
,

110 
key_exŒaùÜ_t
* 
key
, 
·ck‘_t
* 
šput
)

112 
c_¡r
 
aùiÚ
("%s:%s", 
PACKET_TYPE
.
d©a
(), 
key
->
to_¡ršg
().data());

114 
qu”y_¶ª
 cÚ¡** 
	gchd»n
 = 
Ãw
 query_plan const*[1];

115 
	gchd»n
[0] = 
šput
->
¶ª
();

116  
Ãw
 
qu”y_¶ª
(
aùiÚ
, 
f‹r
->
to_¡ršg
(), 
chd»n
, 1);

119 
vœtu®
 
deş¬e_wÜk”_Ãeds
(
»sourû_deş¬e_t
* 
deş¬e
) {

122 
	gdeş¬e
->
deş¬e
(
_·ck‘_ty³
, 1);

124 
	g_šput
->
deş¬e_wÜk”_Ãeds
(
deş¬e
);

134 şas 
	csÜt_¡age_t
 : 
public
 
¡age_t
 {

136 
´iv©e
:

139 cÚ¡ 
MERGE_FACTOR
;

140 cÚ¡ 
	mPAGES_PER_INITIAL_SORTED_RUN
;

144 
tu¶e_fifo
* 
	m_šput_bufãr
;

145 
key_exŒaùÜ_t
* 
	m_exŒaù
;

146 
key_com·»_t
* 
	m_com·»
;

147 
size_t
 
	m_tu¶e_size
;

150 
	mli¡
<
	tc_¡r
> 
	trun_li¡_t
;

154 
	sm”ge_t
 {

155 
c_¡r
 
	m_ouut
;

156 
run_li¡_t
 
	m_šputs
;

157 
tu¶e_fifo
* 
	m_sigÇl_bufãr
;

159 
m”ge_t
 () { }

160 
m”ge_t
(cÚ¡ 
c_¡r
 &
ouut
, cÚ¡ 
run_li¡_t
 &
šputs
, 
tu¶e_fifo
 * 
sigÇl_bufãr
)

161 : 
_ouut
(
ouut
),

162 
_šputs
(
šputs
),

163 
_sigÇl_bufãr
(
sigÇl_bufãr
)

169 
	g¡d
::
	tm­
<, 
	trun_li¡_t
> 
	trun_m­_t
;

170 
	g¡d
::
	tli¡
<
	tm”ge_t
> 
	tm”ge_li¡_t
;

171 
	g¡d
::
	tm­
<, 
	tm”ge_li¡_t
> 
	tm”ge_m­_t
;

172 
	gm”ge_·ck‘_t
::
	tbufãr_li¡_t
 buffer_list_t;

173 
	g¡d
::
	tveùÜ
<
	thšt_tu¶e_·œ_t
> 
	thšt_veùÜ_t
;

177 
±h»ad_t
 
	g_mÚ™Ü_th»ad
;

178 
nÙify_t
 
	g_mÚ™Ü
;

181 vŞ©
boŞ
 
	g_sÜtšg_fšished
;

185 
run_m­_t
 
	g_run_m­
;

186 
m”ge_m­_t
 
	g_m”ge_m­
;

188 
	gpublic
:

190 cÚ¡ 
c_¡r
 
DEFAULT_STAGE_NAME
;

191 
sÜt_·ck‘_t
 
	t¡age_·ck‘_t
;

194 
	$sÜt_¡age_t
()

195 : 
	`_šput_bufãr
(
NULL
), 
	`_exŒaù
(NULL), 
	`_com·»
(NULL),

196 
	`_tu¶e_size
(0), 
	$_mÚ™Ü_th»ad
(0)

198 
	}
}

201 ~
	$sÜt_¡age_t
() {

206 
ü™iÿl_£ùiÚ_t
 
	`cs
(
_mÚ™Ü
.
_lock
);

207 if(
_mÚ™Ü_th»ad
) {

208 
th»ad_još
<>(
_mÚ™Ü_th»ad
);

214 
m”ge_m­_t
::
™”©Ü
 
Ëv–_™
=
_m”ge_m­
.
	`begš
();

215 
Ëv–_™
 !ğ
_m”ge_m­
.
	`’d
()) {

216 
m”ge_li¡_t
::
™”©Ü
 
™
 = 
Ëv–_™
->
£cÚd
.
	`begš
();

217 
™
 !ğ
Ëv–_™
->
£cÚd
.
	`’d
()) {

218 
	`»move_šput_fes
(
™
->
_šputs
);

219 ++
™
;

221 ++
Ëv–_™
;

223 
	}
}

225 
	g´Ùeùed
:

227 
vœtu®
 
´oûss_·ck‘
();

229 
	g´iv©e
:

231 
boŞ
 
fš®_m”ge_»ady
();

232 
ü—‹_sÜ‹d_run
(
·ge_couÁ
);

234 
tu¶e_fifo
* 
mÚ™Ü_m”ge_·ck‘s
();

236 
check_fšished_m”ges
();

237 
¡¬t_Ãw_m”ges
();

238 
¡¬t_m”ge
(
Ãw_Ëv–
, 
run_li¡_t
& 
runs
, 
m”ge_çùÜ
);

239 
»move_šput_fes
(
run_li¡_t
& 
fes
);

242 
´št_runs
();

243 
´št_m”ges
();

	@include/qpipe/stages/sort_merge_join.h

28 #iâdeà
__QPIPE_SORT_MERGE_JOIN_STAGE_H


29 
	#__QPIPE_SORT_MERGE_JOIN_STAGE_H


	)

31 
	~"qpe/cÜe.h
"

33 
	~<¡ršg
>

35 
usšg
 
	g¡d
::
¡ršg
;

36 
usšg
 
	g¡d
::
veùÜ
;

39 
ENTER_NAMESPACE
(
qpe
);

42 
	#HASH_JOIN_STAGE_NAME
 "SORT_MERGE_JOIN"

	)

43 
	#HASH_JOIN_PACKET_TYPE
 "SORT_MERGE_JOIN"

	)

52 şas 
	csÜt_m”ge_još_·ck‘_t
 : 
public
 
·ck‘_t
 {

54 
public
:

55 cÚ¡ 
c_¡r
 
PACKET_TYPE
;

57 
	mgu¬d
<
	m·ck‘_t
> 
	m_Ëá
;

58 
	mgu¬d
<
	m·ck‘_t
> 
	m_right
;

59 
	mgu¬d
<
	mtu¶e_fifo
> 
	m_Ëá_bufãr
;

60 
	mgu¬d
<
	mtu¶e_fifo
> 
	m_right_bufãr
;

61 
	mgu¬d
<
	mkey_com·»_t
> 
	m_com·»
;

62 
	mgu¬d
<
	mtu¶e_još_t
> 
	m_još
;

103 
	$sÜt_m”ge_još_·ck‘_t
(cÚ¡ 
c_¡r
 &
·ck‘_id
,

104 
tu¶e_fifo
* 
out_bufãr
,

105 
tu¶e_f‹r_t
 *
ouut_f‹r
,

106 
·ck‘_t
* 
Ëá
,

107 
·ck‘_t
* 
right
,

108 
tu¶e_još_t
 *
još
,

109 
key_com·»_t
* 
com·»
)

110 : 
	`·ck‘_t
(
·ck‘_id
, 
PACKET_TYPE
, 
out_bufãr
, 
ouut_f‹r
,

111 
	`ü—‹_¶ª
(
ouut_f‹r
, 
još
, 
çl£
, f®£, 
Ëá
, 
right
),

112 
Œue
,

113 
Œue


115 
	`_Ëá
(
Ëá
),

116 
	`_right
(
right
),

117 
	`_Ëá_bufãr
(
Ëá
->
	`ouut_bufãr
()),

118 
	`_right_bufãr
(
right
->
	`ouut_bufãr
()),

119 
	`_još
(
još
),

120 
	$_com·»
(
com·»
)

124 
qu”y_¶ª
* 
	$ü—‹_¶ª
(
tu¶e_f‹r_t
* 
f‹r
, 
tu¶e_još_t
* 
još
,

125 
boŞ
 
ou‹r
, boŞ 
di¡šù
,

126 
·ck‘_t
* 
Ëá
,…ack‘_t* 
right
)

128 
c_¡r
 
	`aùiÚ
("%s:%s:%d:%d", 
PACKET_TYPE
.
	`d©a
(),

129 
još
->
	`to_¡ršg
().
	`d©a
(), 
ou‹r
, 
di¡šù
);

131 
qu”y_¶ª
 cÚ¡** 
chd»n
 = 
Ãw
 query_plan const*[2];

132 
chd»n
[0] = 
Ëá
->
	`¶ª
();

133 
chd»n
[1] = 
right
->
	`¶ª
();

134  
Ãw
 
	`qu”y_¶ª
(
aùiÚ
, 
f‹r
->
	`to_¡ršg
(), 
chd»n
, 2);

135 
	}
}

137 
vœtu®
 
	$deş¬e_wÜk”_Ãeds
(
»sourû_deş¬e_t
* 
deş¬e
) {

138 
deş¬e
->
	`deş¬e
(
_·ck‘_ty³
, 1);

139 
_Ëá
->
	`deş¬e_wÜk”_Ãeds
(
deş¬e
);

140 
_right
->
	`deş¬e_wÜk”_Ãeds
(
deş¬e
);

141 
	}
}

150 şas 
	csÜt_m”ge_još_¡age_t
 : 
public
 
¡age_t
 {

153 
´iv©e
:

157 
tu¶e_još_t
* 
_još
;

158 
key_com·»_t
* 
	m_com·»
;

161 
	mpublic
:

163 
sÜt_m”ge_još_·ck‘_t
 
	t¡age_·ck‘_t
;

165 cÚ¡ 
c_¡r
 
	mDEFAULT_STAGE_NAME
;

168 
vœtu®
 
´oûss_·ck‘
();

172 
	$sÜt_m”ge_još_¡age_t
()

176 ~
	$sÜt_m”ge_još_¡age_t
() {

177 
	}
}

182 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/stages/sorted_in.h

24 #iâdeà
__QPIPE_SORTED_IN_H


25 
	#__QPIPE_SORTED_IN_H


	)

27 
	~"qpe/cÜe.h
"

29 
usšg
 
Çme¥aû
 
	gqpe
;

31 
	gsÜ‹d_š_·ck‘_t
 : 
public
 
·ck‘_t
 {

32 cÚ¡ 
c_¡r
 
PACKET_TYPE
;

33 
	ggu¬d
<
	g·ck‘_t
> 
	g_Ëá
;

34 
	ggu¬d
<
	g·ck‘_t
> 
	g_right
;

35 
	ggu¬d
<
	gtu¶e_fifo
> 
	g_Ëá_šput
;

36 
	ggu¬d
<
	gtu¶e_fifo
> 
	g_right_šput
;

37 
	ggu¬d
<
	gkey_exŒaùÜ_t
> 
	g_Ëá_exŒaùÜ
;

38 
	ggu¬d
<
	gkey_exŒaùÜ_t
> 
	g_right_exŒaùÜ
;

39 
	ggu¬d
<
	gkey_com·»_t
> 
	g_com·»
;

40 
boŞ
 
	g_»jeù_m©ches
;

42 
sÜ‹d_š_·ck‘_t
(cÚ¡ 
c_¡r
 &
·ck‘_id
,

43 
tu¶e_fifo
* 
out_bufãr
,

44 
tu¶e_f‹r_t
* 
out_f‹r
,

45 
·ck‘_t
* 
Ëá
,…ack‘_t* 
right
,

46 
key_exŒaùÜ_t
* 
Ëá_exŒaùÜ
,

47 
key_exŒaùÜ_t
* 
right_exŒaùÜ
,

48 
key_com·»_t
* 
com·»
, 
boŞ
 
»jeù_m©ches
)

49 : 
·ck‘_t
(
·ck‘_id
, 
PACKET_TYPE
, 
out_bufãr
, 
out_f‹r
, 
NULL
,

50 
çl£
,

51 
Œue


53 
_Ëá
(
Ëá
), 
_right
(
right
),

54 
_Ëá_šput
(
Ëá
->
ouut_bufãr
()),

55 
_right_šput
(
right
->
ouut_bufãr
()),

56 
_Ëá_exŒaùÜ
(
Ëá_exŒaùÜ
),

57 
_right_exŒaùÜ
(
right_exŒaùÜ
),

58 
_com·»
(
com·»
), 
_»jeù_m©ches
(
»jeù_m©ches
)

62 
vœtu®
 
deş¬e_wÜk”_Ãeds
(
»sourû_deş¬e_t
* 
deş¬e
) {

63 
	gdeş¬e
->
deş¬e
(
_·ck‘_ty³
, 1);

64 
	g_Ëá
->
deş¬e_wÜk”_Ãeds
(
deş¬e
);

65 
	g_right
->
deş¬e_wÜk”_Ãeds
(
deş¬e
);

69 
	gsÜ‹d_š_¡age_t
 : 
public
 
¡age_t
 {

70 cÚ¡ 
c_¡r
 
DEFAULT_STAGE_NAME
;

71 
sÜ‹d_š_·ck‘_t
 
	t¡age_·ck‘_t
;

72 
	g´Ùeùed
:

73 
vœtu®
 
´oûss_·ck‘
();

	@include/qpipe/stages/tscan.h

32 #iâdeà
__QPIPE_TSCAN_H


33 
	#__QPIPE_TSCAN_H


	)

35 
	~"sm/shÜe/shÜe_bË_mª.h
"

37 
	~"qpe/cÜe/tu¶e_fifo.h
"

38 
	~"qpe/cÜe.h
"

40 
usšg
 
Çme¥aû
 
	gshÜe
;

42 
ENTER_NAMESPACE
(
qpe
);

51 
	gtsÿn_·ck‘_t
 : 
public
 
·ck‘_t


53 
ss_m
* 
_db
;

54 
bË_desc_t
* 
	g_bË
;

55 
xù_t
* 
	g_xù
;

56 
lock_mode_t
 
	g_lm
;

58 cÚ¡ 
c_¡r
 
	gPACKET_TYPE
;

86 
tsÿn_·ck‘_t
(cÚ¡ 
c_¡r
& 
·ck‘_id
,

87 
tu¶e_fifo
* 
ouut_bufãr
,

88 
tu¶e_f‹r_t
* 
ouut_f‹r
,

89 
ss_m
* 
db
,

90 
bË_desc_t
* 
bË
,

91 
xù_t
* 
pxù
,

92 
lock_mode_t
 
lm
=
SH
);

94 
qu”y_¶ª
* 
ü—‹_¶ª
(
tu¶e_f‹r_t
* 
f‹r
, 
bË_desc_t
* 
fe
);

95 
deş¬e_wÜk”_Ãeds
(
»sourû_deş¬e_t
* 
deş¬e
);

107 şas 
	ctsÿn_¡age_t
 : 
public
 
¡age_t


109 
public
:

111 
tsÿn_·ck‘_t
 
	t¡age_·ck‘_t
;

112 cÚ¡ 
c_¡r
 
	mDEFAULT_STAGE_NAME
;

114 cÚ¡ 
size_t
 
	mTSCAN_BULK_READ_BUFFER_SIZE
;

116 
	$tsÿn_¡age_t
() { }

117 ~
	$tsÿn_¡age_t
(è{ 
	}
}

119 
	g´Ùeùed
:

121 
vœtu®
 
´oûss_·ck‘
();

126 
EXIT_NAMESPACE
(
qpe
);

	@include/qpipe/stages/tuple_source.h

24 #iâdeà
__QPIPE_TUPLE_SOURCE_H


25 
	#__QPIPE_TUPLE_SOURCE_H


	)

27 
	~"qpe/cÜe.h
"

28 
	~<c¡dlib
>

31 
usšg
 
Çme¥aû
 
	gqpe
;

33 şas 
	ctu¶e_sourû_t
 {

35 
	mpublic
:

43 
vœtu®
 
·ck‘_t
* 
»£t
()=0;

45 
vœtu®
 
size_t
 
tu¶e_size
()=0;

47 
	mvœtu®
 ~
	$tu¶e_sourû_t
() { }

48 
	}
};

	@include/shore.h

32 #iâdeà
__SHORE_H


33 
	#__SHORE_H


	)

35 
	~"sm/shÜe/commÚ.h
"

36 
	~"sm/shÜe/shÜe_»qs.h
"

37 
	~"sm/shÜe/shÜe_wÜk”.h
"

38 
	~"sm/shÜe/¤mwqueue.h
"

40 
	~"sm/shÜe/shÜe_”rÜ.h
"

41 
	~"sm/shÜe/shÜe_toŞs.h
"

42 
	~"sm/shÜe/shÜe_fe_desc.h
"

43 
	~"sm/shÜe/shÜe_f›ld.h
"

44 
	~"sm/shÜe/shÜe_šdex.h
"

45 
	~"sm/shÜe/shÜe_™”.h
"

46 
	~"sm/shÜe/shÜe_msg.h
"

47 
	~"sm/shÜe/shÜe_row.h
"

48 
	~"sm/shÜe/shÜe_row_ÿche.h
"

49 
	~"sm/shÜe/shÜe_bË.h
"

50 
	~"sm/shÜe/shÜe_asc_sÜt_buf.h
"

51 
	~"sm/shÜe/shÜe_desc_sÜt_buf.h
"

52 
	~"sm/shÜe/shÜe_h–³r_lßd”.h
"

53 
	~"sm/shÜe/shÜe_bË_mª.h
"

54 
	~"sm/shÜe/shÜe_’v.h
"

56 
	~"sm/shÜe/shÜe_ş›Á.h
"

57 
	~"sm/shÜe/shÜe_Œx_wÜk”.h
"

58 
	~"sm/shÜe/shÜe_wÜk”.h
"

59 
	~"sm/shÜe/shÜe_sh–l.h
"

	@include/sm/shore/common.h

32 #iâdeà
__SHORE_COMMON_H


33 
	#__SHORE_COMMON_H


	)

35 
	~"sm_vas.h
"

37 
	~"ut/Çme¥aû.h
"

41 
ENTER_NAMESPACE
(
shÜe
);

46 
şass
 
	gba£_wÜk”_t
;

47 
şass
 
	gba£_aùiÚ_t
;

65 
	eeWÜk”CÚŒŞ
 { 
	mWC_PAUSED
 = 0x1,

66 
	mWC_ACTIVE
 = 0x2,

67 
	mWC_STOPPED
 = 0x4,

68 
	mWC_RECOVERY
 = 0x8

89 
	eeWÜkšgS‹
 { 
	mWS_UNDEF
 = 0x1,

90 
	mWS_LOOP
 = 0x2,

91 
	mWS_SLEEP
 = 0x4,

92 
	mWS_COMMIT_Q
 = 0x8,

93 
	mWS_INPUT_Q
 = 0x10,

94 
	mWS_FINISHED
 = 0x20

106 
	eeD©aOwÃrS‹
 { 
	mDOS_UNDEF
 = 0x1,

107 
	mDOS_ALONE
 = 0x2,

108 
	mDOS_MULTIPLE
 = 0x4

113 
EXIT_NAMESPACE
(
shÜe
);

	@include/sm/shore/shore_asc_sort_buf.h

33 #iâdeà 
__SHORE_ASC_SORT_BUF_H


34 
	#__SHORE_ASC_SORT_BUF_H


	)

36 
	~"sm/shÜe/shÜe_bË_mª.h
"

39 
ENTER_NAMESPACE
(
shÜe
);

58 
şass
 
	gasc_sÜt_™”_im¶
;

69 şas 
	casc_sÜt_bufãr_t
 : 
public
 
bË_desc_t


71 
public
:

73 
	$asc_sÜt_bufãr_t
(cÚ¡ 
ušt_t
 
f›ld_couÁ
)

74 : 
	`bË_desc_t
("ASC_SORT_BUF", 
f›ld_couÁ
, 
PD_NORMAL
)

78 ~
	$asc_sÜt_bufãr_t
()

80 
	}
}

83 
	$£tup
(cÚ¡ 
ušt_t
 
šdex
, 
sqÉy³_t
 
ty³
, cÚ¡ 
Ën
 = 0)

85 
	`as£¹
(
šdex
<
_f›ld_couÁ
);

86 
_desc
[
šdex
].
	`£tup
(
ty³
, "", 
Ën
);

87 
	`as£¹
(!
_desc
[
šdex
].
	`is_v¬ŸbË_Ëngth
());

88 
	`as£¹
(!
_desc
[
šdex
].
	`®low_nuÎ
());

89 
	}
}

104 
şass
 
	gasc_sÜt_mª_im¶
 : 
public
 
bË_mª_im¶
<
asc_sÜt_bufãr_t
>

106 
bË_row_t
 
	tsÜ‹r_tu¶e
;

107 
ä›nd
 
şass
 
	gasc_sÜt_™”_im¶
;

109 
	g´Ùeùed
:

111 * 
_sÜt_buf
;

112 
	g_tu¶e_size
;

113 
	g_tu¶e_couÁ
;

114 
	g_buf_size
;

115 
boŞ
 
	g_is_sÜ‹d
;

116 
s_lock
 
	g_sÜ‹d_lock
;

118 
»p_row_t
* 
	g_´•row
;

121 
š™
();

124 
boŞ
 
g‘_sÜ‹d
(cÚ¡ 
šdex
, 
sÜ‹r_tu¶e
* 
±u¶e
);

126 
	gpublic
:

128 
asc_sÜt_mª_im¶
(
asc_sÜt_bufãr_t
* 
aSÜtBufãrAsc
, 
»p_row_t
* 
­row
)

129 : 
bË_mª_im¶
<
asc_sÜt_bufãr_t
>(
aSÜtBufãrAsc
, 
	gçl£
),

130 
_sÜt_buf
(
NULL
), 
_tu¶e_size
(0), 
_tu¶e_couÁ
(0), 
_buf_size
(0),

131 
_is_sÜ‹d
(
çl£
), 
_´•row
(
­row
)

135 ~
asc_sÜt_mª_im¶
()

137 ià(
	g_sÜt_buf
)

138 
	gd–‘e
 [] 
	g_sÜt_buf
;

143 
add_tu¶e
(
sÜ‹r_tu¶e
& 
©u¶e
);

146 
w_rc_t
 
g‘_asc_sÜt_™”
(
ss_m
* 
db
, 
asc_sÜt_™”_im¶
* &
asc_sÜt_™”
);

147 
w_rc_t
 
g‘_sÜt_™”
(
ss_m
* 
db
, 
asc_sÜt_™”_im¶
* &
sÜt_™”
);

150 
sÜt
();

152 
šlše
 
couÁ
(è{  (
	g_tu¶e_couÁ
); }

154 
»£t
();

170 
	gtu¶e_™”_t
<
	tasc_sÜt_bufãr_t
, , 
	tbË_row_t
 > 
	tasc_sÜt_sÿn_t
;

172 şas 
	casc_sÜt_™”_im¶
 : 
public
 
asc_sÜt_sÿn_t


174 
public
:

175 
bË_row_t
 
	tbË_tu¶e
;

177 
	m´iv©e
:

179 
asc_sÜt_mª_im¶
* 
_mªag”
;

180 
	m_šdex
;

182 
	mpublic
:

184 
	$asc_sÜt_™”_im¶
(
ss_m
* 
db
, 
asc_sÜt_bufãr_t
* 
psÜtbuf
, 
asc_sÜt_mª_im¶
* 
psÜtmª
)

185 : 
tu¶e_™”_t
<
asc_sÜt_bufãr_t
, , 
bË_row_t
 >(
db
, 
psÜtbuf
, 
NL
, 
çl£
),

186 
	`_mªag”
(
psÜtmª
), 
	$_šdex
(0)

188 
	`as£¹
 (
_mªag”
);

189 
	`as£¹
 (
_fe
);

190 
	`W_COERCE
(
	`İ’_sÿn
());

198 
w_rc_t
 
	`İ’_sÿn
();

199 
w_rc_t
 
	$şo£_sÿn
(è{  (
RCOK
); 
	}
};

200 
w_rc_t
 
Ãxt
(
ss_m
* 
db
, 
boŞ
& 
eof
, 
bË_tu¶e
& 
tu¶e
);

202 
»£t
();

225 
šlše
 
w_rc_t
 
	gasc_sÜt_™”_im¶
::
	$İ’_sÿn
()

227 
	`as£¹
 (
_fe
);

228 
	`as£¹
 (
_fe
->
	`f›ld_couÁ
()>0);

230 
_mªag”
->
	`sÜt
();

232 
_šdex
 = 0;

233 
_İ’ed
 = 
Œue
;

234  (
RCOK
);

235 
	}
}

246 
šlše
 
w_rc_t
 
	gasc_sÜt_™”_im¶
::
	$Ãxt
(
ss_m
* , 
boŞ
& 
eof
, 
bË_tu¶e
& 
tu¶e
)

248 
	`as£¹
(
_İ’ed
);

250 
_mªag”
->
	`g‘_sÜ‹d
(
_šdex
, &
tu¶e
);

251 
eof
 = (++
_šdex
 > 
_mªag”
->
_tu¶e_couÁ
);

252  (
RCOK
);

253 
	}
}

264 
šlše
 
	gasc_sÜt_™”_im¶
::
	$»£t
()

267 
	`as£¹
 (
_mªag”
);

268 
_šdex
=0;

269 
	}
}

272 
EXIT_NAMESPACE
(
shÜe
);

	@include/sm/shore/shore_client.h

32 #iâdeà
__SHORE_CLIENT_H


33 
	#__SHORE_CLIENT_H


	)

35 
	~"k_defšes.h
"

37 
	~"sm/shÜe/shÜe_’v.h
"

38 
	~"sm/shÜe/shÜe_h–³r_lßd”.h
"

41 
ENTER_NAMESPACE
(
shÜe
);

45 
	eeBšdšgTy³
 { 
	mBT_NONE
=0, 
	mBT_NEXT
=1, 
	mBT_SPREAD
=2 };

55 cÚ¡ 
	gDF_SPREAD_THREADS
 = 1;

58 cÚ¡ 
	gDF_NUM_OF_THR
 = 5;

61 cÚ¡ 
	gMAX_NUM_OF_THR
 = 1000;

64 cÚ¡ 
	gDF_TRX_PER_THR
 = 100;

67 cÚ¡ 
	gDF_DURATION
 = 20;

70 cÚ¡ 
	gDF_NUM_OF_ITERS
 = 5;

73 cÚ¡ 
eBšdšgTy³
 
	gDF_BINDING_TYPE
 = 
BT_NONE
;

79 cÚ¡ 
	gDF_WARMUP_TRX_PER_THR
 = 1000;

82 cÚ¡ 
	gDF_WARMUP_DURATION
 = 20;

85 cÚ¡ 
	gDF_WARMUP_ITERS
 = 3;

90 cÚ¡ 
	gBATCH_SIZE
 = 10;

93 cÚ¡ 
	gTHINK_TIME
 = 0;

97 
š¡_‹¡_’v
(
¬gc
, * 
¬gv
[]);

98 
şo£_‹¡_’v
();

109 cÚ¡ 
	gDF_WARMUP_INTERVAL
 = 2;

111 
	eM—su»m’tTy³
 { 
	mMT_UNDEF
, 
	mMT_NUM_OF_TRXS
, 
	mMT_TIME_DUR
 };

122 şas 
	cba£_ş›Á_t
 : 
public
 
th»ad_t


124 
public
:

127 
m­
<,
	t¡ršg
> 
	tm­SupTrxs
;

128 
	mm­SupTrxs
::
	t™”©Ü
 
	tm­SupTrxsIt
;

129 
	mm­SupTrxs
::
	tcÚ¡_™”©Ü
 
	tm­SupTrxsCÚ¡It
;

131 
	m´Ùeùed
:

134 
ShÜeEnv
* 
_’v
;

137 
M—su»m’tTy³
 
	m_m—su»_ty³
;

138 
	m_Œxid
;

139 
	m_nÙrxs
;

141 
	m_thšk_time
;

144 
	mgu¬d
<
	mcÚdex_·œ
> 
	m_ı
;

147 
boŞ
 
	m_is_bound
;

148 
´oûssÜid_t
 
	m_´s_id
;

150 
	m_id
;

151 
	m_rv
;

153 
	mpublic
:

155 
	$ba£_ş›Á_t
()

156 : 
	`th»ad_t
("nÚe"), 
	`_’v
(
NULL
), 
	`_m—su»_ty³
(
MT_UNDEF
),

157 
	`_Œxid
(-1), 
	`_nÙrxs
(-1), 
	`_thšk_time
(0),

158 
	`_is_bound
(
çl£
), 
	`_´s_id
(
PBIND_NONE
),

159 
	$_rv
(1)

162 
	$ba£_ş›Á_t
(
c_¡r
 
Šame
, cÚ¡ 
id
, 
ShÜeEnv
* 
’v
,

163 cÚ¡ 
M—su»m’tTy³
 
aTy³
, cÚ¡ 
Œxid
,

164 cÚ¡ 
numOfTrxs
,

165 
´oûssÜid_t
 
­rsid
 = 
PBIND_NONE
)

166 : 
	`th»ad_t
(
Šame
), 
	`_’v
(
’v
), 
	`_m—su»_ty³
(
aTy³
),

167 
	`_Œxid
(
Œxid
), 
	`_nÙrxs
(
numOfTrxs
), 
	`_thšk_time
(0),

168 
	`_is_bound
(
çl£
), 
	`_´s_id
(
­rsid
), 
	`_id
(
id
), 
	$_rv
(0)

170 
	`as£¹
 (
_’v
);

171 
	`as£¹
 (
_m—su»_ty³
 !ğ
MT_UNDEF
);

172 
	`as£¹
 (
_nÙrxs
 || (
_m—su»_ty³
 =ğ
MT_TIME_DUR
));

173 
_ı
 = 
Ãw
 
	`cÚdex_·œ
();

174 
	}
}

176 
	gvœtu®
 ~
	$ba£_ş›Á_t
(è{ 
	}
}

180 
	$wÜk
() {

182 
	`TRY_TO_BIND
(
_´s_id
,
_is_bound
);

185 ià(!
_’v
->
	`is_š™Ÿlized
()) {

186 ià(
_’v
->
	`š™
()) {

189 
	`TRACE
Ğ
TRACE_ALWAYS
, "Couldn't initialize Shore...\n");

190 
_rv
 = 1;

196 
	`pow”run
();

197 
	}
}

200 
	$id
(è{  (
_id
); 
	}
}

201 
boŞ
 
	$is_bound
(ècÚ¡ {  (
_is_bound
); 
	}
}

202 
šlše
 
	$rv
(è{  (
_rv
); 
	}
}

205 
w_rc_t
 
run_xùs
(
xù_ty³
, 
num_xù
);

206 
	$pow”run
() {

207 
w_rc_t
 
rc
 = 
_’v
->
	`lßdd©a
();

208 if(
rc
.
	`is_”rÜ
()è„c.
	`”r_num
();

209  (
	`run_xùs
(
_Œxid
, 
_nÙrxs
).
	`”r_num
());

210 
	}
}

212 
w_rc_t
 
subm™_b©ch
(
xù_ty³
, & 
Œx_út
, cÚ¡ 
b©ch_size
);

214 
abÜt_‹¡
();

215 
»sume_‹¡
();

216 
boŞ
 
is_‹¡_abÜ‹d
();

219 
	$lßd_sup_xù
(
m­SupTrxs
& 
m­
) {

220 
m­
.
	`ş—r
();  (m­.
	`size
());

221 
	}
}

225 
vœtu®
 
w_rc_t
 
subm™_Úe
(
xù_ty³
, 
num_xù
)=0;

230 
	$´št_bËs
(è{ 
	`as£¹
 (
_’v
); _’v->
	`dump
(); 
	}
}

233 
	g´iv©e
:

236 
ba£_ş›Á_t
(base_client_t const &);

237 
	gİ”©Ü
=(
ba£_ş›Á_t
 const &);

243 
EXIT_NAMESPACE
(
shÜe
);

	@include/sm/shore/shore_desc_sort_buf.h

33 #iâdeà 
__SHORE_DESC_SORT_BUF_H


34 
	#__SHORE_DESC_SORT_BUF_H


	)

36 
	~"sm/shÜe/shÜe_bË_mª.h
"

39 
ENTER_NAMESPACE
(
shÜe
);

58 
şass
 
	gdesc_sÜt_™”_im¶
;

69 şas 
	cdesc_sÜt_bufãr_t
 : 
public
 
bË_desc_t


71 
public
:

73 
	$desc_sÜt_bufãr_t
(cÚ¡ 
ušt_t
 
f›ld_couÁ
)

74 : 
	`bË_desc_t
("DESC_SORT_BUF", 
f›ld_couÁ
, 
PD_NORMAL
)

78 ~
	$desc_sÜt_bufãr_t
()

80 
	}
}

83 
	$£tup
(cÚ¡ 
ušt_t
 
šdex
, 
sqÉy³_t
 
ty³
, cÚ¡ 
Ën
 = 0)

85 
	`as£¹
(
šdex
<
_f›ld_couÁ
);

86 
_desc
[
šdex
].
	`£tup
(
ty³
, "", 
Ën
);

87 
	`as£¹
(!
_desc
[
šdex
].
	`is_v¬ŸbË_Ëngth
());

88 
	`as£¹
(!
_desc
[
šdex
].
	`®low_nuÎ
());

89 
	}
}

104 
şass
 
	gdesc_sÜt_mª_im¶
 : 
public
 
bË_mª_im¶
<
desc_sÜt_bufãr_t
>

106 
bË_row_t
 
	tsÜ‹r_tu¶e
;

107 
ä›nd
 
şass
 
	gdesc_sÜt_™”_im¶
;

109 
	g´Ùeùed
:

111 * 
_sÜt_buf
;

112 
	g_tu¶e_size
;

113 
	g_tu¶e_couÁ
;

114 
	g_buf_size
;

115 
boŞ
 
	g_is_sÜ‹d
;

116 
s_lock
 
	g_sÜ‹d_lock
;

118 
»p_row_t
* 
	g_´•row
;

121 
š™
();

124 
boŞ
 
g‘_sÜ‹d
(cÚ¡ 
šdex
, 
sÜ‹r_tu¶e
* 
±u¶e
);

126 
	gpublic
:

128 
desc_sÜt_mª_im¶
(
desc_sÜt_bufãr_t
* 
aSÜtBufãrAsc
, 
»p_row_t
* 
­row
)

129 : 
bË_mª_im¶
<
desc_sÜt_bufãr_t
>(
aSÜtBufãrAsc
, 
	gçl£
),

130 
_sÜt_buf
(
NULL
), 
_tu¶e_size
(0), 
_tu¶e_couÁ
(0), 
_buf_size
(0),

131 
_is_sÜ‹d
(
çl£
), 
_´•row
(
­row
)

135 ~
desc_sÜt_mª_im¶
()

137 ià(
	g_sÜt_buf
)

138 
	gd–‘e
 [] 
	g_sÜt_buf
;

143 
add_tu¶e
(
sÜ‹r_tu¶e
& 
©u¶e
);

146 
w_rc_t
 
g‘_desc_sÜt_™”
(
ss_m
* 
db
, 
desc_sÜt_™”_im¶
* &
desc_sÜt_™”
);

147 
w_rc_t
 
g‘_sÜt_™”
(
ss_m
* 
db
, 
desc_sÜt_™”_im¶
* &
sÜt_™”
);

150 
sÜt
();

152 
šlše
 
couÁ
(è{  (
	g_tu¶e_couÁ
); }

154 
»£t
();

170 
	gtu¶e_™”_t
<
	tdesc_sÜt_bufãr_t
, , 
	tbË_row_t
 > 
	tdesc_sÜt_sÿn_t
;

172 şas 
	cdesc_sÜt_™”_im¶
 : 
public
 
desc_sÜt_sÿn_t


174 
public
:

175 
bË_row_t
 
	tbË_tu¶e
;

177 
	m´iv©e
:

179 
desc_sÜt_mª_im¶
* 
_mªag”
;

180 
	m_šdex
;

182 
	mpublic
:

184 
	$desc_sÜt_™”_im¶
(
ss_m
* 
db
, 
desc_sÜt_bufãr_t
* 
psÜtbuf
, 
desc_sÜt_mª_im¶
* 
psÜtmª
)

185 : 
tu¶e_™”_t
<
desc_sÜt_bufãr_t
, , 
bË_row_t
 >(
db
, 
psÜtbuf
, 
NL
, 
çl£
),

186 
	`_mªag”
(
psÜtmª
), 
	$_šdex
(0)

188 
	`as£¹
 (
_mªag”
);

189 
	`as£¹
 (
_fe
);

190 
	`W_COERCE
(
	`İ’_sÿn
());

198 
w_rc_t
 
	`İ’_sÿn
();

199 
w_rc_t
 
	$şo£_sÿn
(è{  (
RCOK
); 
	}
};

200 
w_rc_t
 
Ãxt
(
ss_m
* 
db
, 
boŞ
& 
eof
, 
bË_tu¶e
& 
tu¶e
);

202 
»£t
();

225 
šlše
 
w_rc_t
 
	gdesc_sÜt_™”_im¶
::
	$İ’_sÿn
()

227 
	`as£¹
 (
_fe
);

228 
	`as£¹
 (
_fe
->
	`f›ld_couÁ
()>0);

230 
_mªag”
->
	`sÜt
();

232 
_šdex
 = 0;

233 
_İ’ed
 = 
Œue
;

234  (
RCOK
);

235 
	}
}

246 
šlše
 
w_rc_t
 
	gdesc_sÜt_™”_im¶
::
	$Ãxt
(
ss_m
* , 
boŞ
& 
eof
, 
bË_tu¶e
& 
tu¶e
)

248 
	`as£¹
(
_İ’ed
);

250 
_mªag”
->
	`g‘_sÜ‹d
(
_šdex
, &
tu¶e
);

251 
eof
 = (++
_šdex
 > 
_mªag”
->
_tu¶e_couÁ
);

252  (
RCOK
);

253 
	}
}

264 
šlše
 
	gdesc_sÜt_™”_im¶
::
	$»£t
()

267 
	`as£¹
 (
_mªag”
);

268 
_šdex
=0;

269 
	}
}

272 
EXIT_NAMESPACE
(
shÜe
);

	@include/sm/shore/shore_env.h

31 #iâdeà
__SHORE_ENV_H


32 
	#__SHORE_ENV_H


	)

34 
	~"k_defšes.h
"

35 
	~"sm_vas.h
"

37 
	~<m­
>

39 
	~"ut.h
"

41 
	~"shÜe_»qs.h
"

42 
	~"shÜe_fe_desc.h
"

45 
ENTER_NAMESPACE
(
shÜe
);

48 
usšg
 
	g¡d
::
m­
;

53 cÚ¡ 
	gSHORE_NUM_OF_RETRIES
 = 3;

55 
	#SHORE_TABLE_DATA_DIR
 "d©aba£s"

	)

56 
	#SHORE_CONF_FILE
 "shÜe.cÚf"

	)

58 cÚ¡ 
¡ršg
 
	gCONFIG_PARAM
 = "db-config";

59 cÚ¡ 
¡ršg
 
	gCONFIG_PARAM_VALUE
 = "invalid";

70 cÚ¡ 
¡ršg
 
	gSHORE_SYS_OPTIONS
[][2] = {

78 cÚ¡ 
	gSHORE_NUM_SYS_OPTIONS
 = 5;

84 cÚ¡ 
¡ršg
 
	gSHORE_SYS_SM_OPTIONS
[][3] = {

92 cÚ¡ 
	gSHORE_NUM_SYS_SM_OPTIONS
 = 5;

98 cÚ¡ 
¡ršg
 
	gSHORE_DB_SM_OPTIONS
[][3] = {

106 cÚ¡ 
	gSHORE_NUM_DB_SM_OPTIONS
 = 5;

111 cÚ¡ 
¡ršg
 
	gSHORE_DB_OPTIONS
[][2] = {

114 { "lßd©adœ", 
SHORE_TABLE_DATA_DIR
 },

119 cÚ¡ 
	gSHORE_NUM_DB_OPTIONS
 = 5;

130 
	#DECLARE_TRX
(
Œxlid
) \

131 
w_rc_t
 
run_
##
	`Œxlid
(
Reque¡
* 
´eque¡
, 
Œxlid
##
_šput_t
& 
š
); \

132 
w_rc_t
 
run_
##
	`Œxlid
(
Reque¡
* 
´eque¡
); \

133 
w_rc_t
 
xù_
##
	`Œxlid
(cÚ¡ 
xù_id
, 
Œxlid
##
_šput_t
& 
š
); \

134 
_šc_
##
Œxlid
##
	`_©t
(); \

135 
_šc_
##
Œxlid
##
	`_çed
(); \

136 
_šc_
##
Œxlid
##
	`_dld
()

	)

139 
	#DECLARE_TABLE
(
bË
,
mªim¶
,
abbrv
) \

140 
gu¬d
<
mªim¶
> 
_p
##
abbrv
##
_mª
; \

141 
šlše
 
mªim¶
* 
abbrv
##
	`_mª
(è{  (
_p
##abbrv##
_mª
); } \

142 
gu¬d
<
bË
> 
_p
##
abbrv
##
_desc
; \

143 
šlše
 
bË
* 
abbrv
##
	`_desc
(è{  (
_p
##abbrv##
_desc
.
	`g‘
()); }

	)

158 #ifdeà
CFG_FLUSHER


161 
	#DEFINE_RUN_WITH_INPUT_TRX_WRAPPER
(
úame
,
Œxlid
,
Œxim¶
) \

162 
w_rc_t
 
úame
::
run_
##
	`Œxim¶
(
Reque¡
* 
´eque¡
, 
Œxlid
##
_šput_t
& 
š
) { \

163 
xù_id
 = 
´eque¡
->
	`xù_id
(); \

164 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "%d. % ...\n", 
xù_id
, #trximpl); \

165 
_šc_
##
Œxlid
##
	`_©t
(); \

166 
w_rc_t
 
e
 = 
xù_
##
	`Œxim¶
(
xù_id
, 
š
); \

167 ià(!
e
.
	`is_”rÜ
()) { \

168 
l¢_t
 
xùLa¡L¢
; \

169 
e
 = 
_pssm
->
	`comm™_xù
(
Œue
,&
xùLa¡L¢
); \

170 
´eque¡
->
	`£t_Ï¡_l¢
(
xùLa¡L¢
); } \

171 ià(
e
.
	`is_”rÜ
()) { \

172 ià(
e
.
	`”r_num
(è!ğ
smËv–_0
::
eDEADLOCK
) \

173 
_šc_
##
Œxlid
##
	`_çed
(); \

174 
_šc_
##
Œxlid
##
	`_dld
(); \

175 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Xù (%dèabÜ‹d [0x%x]\n", 
xù_id
, 
e
.
	`”r_num
()); \

176 
w_rc_t
 
e2
 = 
_pssm
->
	`abÜt_xù
(); \

177 if(
e2
.
	`is_”rÜ
()è
	`TRACE
Ğ
TRACE_ALWAYS
, "Xù (%dèabÜˆçed [0x%x]\n", 
xù_id
,ƒ2.
	`”r_num
()); \

178 
´eque¡
->
	`nÙify_ş›Á
(); \

179 
_»que¡_poŞ
.
	`de¡roy
(
´eque¡
); \

180 ià((*&
_m—su»
)!=
MST_MEASURE
è (
e
); \

181 
_’v_¡©s
.
	`šc_Œx_©t
(); \

182  (
e
); } \

183 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Xù (%dè(%dètØæush\n", 
xù_id
, 
´eque¡
->
	`tid
().
	`g‘_lo
()); \

184 
	`to_ba£_æush”
(
´eque¡
); \

185  (
RCOK
); }

	)

189 
	#DEFINE_RUN_WITH_INPUT_TRX_WRAPPER
(
úame
,
Œxlid
,
Œxim¶
) \

190 
w_rc_t
 
úame
::
run_
##
	`Œxim¶
(
Reque¡
* 
´eque¡
, 
Œxlid
##
_šput_t
& 
š
) { \

191 
xù_id
 = 
´eque¡
->
	`xù_id
(); \

192 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "%d. % ...\n", 
xù_id
, #trximpl); \

193 
_šc_
##
Œxlid
##
	`_©t
(); \

194 
w_rc_t
 
e
 = 
xù_
##
	`Œxim¶
(
xù_id
, 
š
); \

195 ià(!
e
.
	`is_”rÜ
()) { \

196 ià(
	`isAsynchComm™
()è
e
 = 
_pssm
->
	`comm™_xù
(
Œue
); \

197 
e
 = 
_pssm
->
	`comm™_xù
(); } \

198 ià(
e
.
	`is_”rÜ
()) { \

199 ià(
e
.
	`”r_num
(è!ğ
smËv–_0
::
eDEADLOCK
) \

200 
_šc_
##
Œxlid
##
	`_çed
(); \

201 
_šc_
##
Œxlid
##
	`_dld
(); \

202 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Xù (%dèabÜ‹d [0x%x]\n", 
xù_id
, 
e
.
	`”r_num
()); \

203 
w_rc_t
 
e2
 = 
_pssm
->
	`abÜt_xù
(); \

204 if(
e2
.
	`is_”rÜ
()è
	`TRACE
Ğ
TRACE_ALWAYS
, "Xù (%dèabÜˆçed [0x%x]\n", 
xù_id
,ƒ2.
	`”r_num
()); \

205 
´eque¡
->
	`nÙify_ş›Á
(); \

206 ià((*&
_m—su»
)!=
MST_MEASURE
è (
e
); \

207 
_’v_¡©s
.
	`šc_Œx_©t
(); \

208  (
e
); } \

209 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Xù (%dècom¶‘ed\n", 
xù_id
); \

210 
´eque¡
->
	`nÙify_ş›Á
(); \

211 ià((*&
_m—su»
)!=
MST_MEASURE
è (
RCOK
); \

212 
_’v_¡©s
.
	`šc_Œx_com
(); \

213  (
RCOK
); }

	)

218 
	#DEFINE_RUN_WITHOUT_INPUT_TRX_WRAPPER
(
úame
,
Œxlid
,
Œxim¶
) \

219 
w_rc_t
 
úame
::
run_
##
	`Œxim¶
(
Reque¡
* 
´eque¡
) { \

220 
Œxlid
##
_šput_t
 
š
 = 
ü—‹_
##Œxlid##
	`_šput
(
_qu”›d_çùÜ
, 
´eque¡
->
	`£ËùedID
()); \

221  (
run_
##
	`Œxim¶
(
´eque¡
, 
š
)); }

	)

224 
	#DEFINE_TRX_STATS
(
úame
,
Œxlid
) \

225 
úame
::
_šc_
##
Œxlid
##
	`_©t
(è{ ++
my_¡©s
.
©‹m±ed
.trxlid; } \

226 
úame
::
_šc_
##
Œxlid
##
	`_çed
(è{ ++
my_¡©s
.
çed
.trxlid; } \

227 
úame
::
_šc_
##
Œxlid
##
	`_dld
(è{ ++
my_¡©s
.
d—dlocked
.Œxlid; }

	)

231 
	#DEFINE_TRX
(
úame
,
Œx
) \

232 
	`DEFINE_RUN_WITHOUT_INPUT_TRX_WRAPPER
(
úame
,
Œx
,trx); \

233 
	`DEFINE_RUN_WITH_INPUT_TRX_WRAPPER
(
úame
,
Œx
,trx); \

234 
	`DEFINE_TRX_STATS
(
úame
,
Œx
)

	)

237 #ifdeà
USE_SHORE_6


239 
	#CHECK_XCT_RETURN
(
rc
,
Ãeded_Ãxt_time
,
»Œy
,
ENV
) \

240 ià(
rc
.
	`is_”rÜ
()) { \

241 
	`TRACE
Ğ
TRACE_ALWAYS
, "E¼Ü %x\n", 
rc
.
	`”r_num
()); \

242 
u£d
 = 
ENV
->
	`db
()->
	`xù_log_¥aû_Ãeded
(); \

243 
	`W_COERCE
(
ENV
->
	`db
()->
	`abÜt_xù
()); \

244 
rc
.
	`”r_num
()) { \

245 
smËv–_0
::
eDEADLOCK
: \

246 
»Œy
; \

247 
smËv–_0
::
eOUTOFLOGSPACE
: \

248 
Ãeded_Ãxt_time
 = 
u£d
; \

249 
»Œy
; \

251 
¡ršg¡»am
 
os
; o << 
rc
 << 
’ds
; \

252 
¡ršg
 
¡r
 = 
os
.
	`¡r
(); \

253 
	`TRACE
Ğ
TRACE_ALWAYS
, \

255 
¡r
.
	`c_¡r
()); \

256 
	`W_FATAL
(
rc
.
	`”r_num
()); \

258 }

	)

262 
	#CHECK_XCT_RETURN
(
rc
,
Ãeded_Ãxt_time
,
»Œy
,
ENV
) \

263 ià(
rc
.
	`is_”rÜ
()) { \

264 
	`TRACE
Ğ
TRACE_ALWAYS
, "E¼Ü %x\n", 
rc
.
	`”r_num
()); \

265 
u£d
 = 0; \

266 
	`W_COERCE
(
ENV
->
	`db
()->
	`abÜt_xù
()); \

267 
rc
.
	`”r_num
()) { \

268 
smËv–_0
::
eDEADLOCK
: \

269 
»Œy
; \

270 
smËv–_0
::
eOUTOFLOGSPACE
: \

271 
Ãeded_Ãxt_time
 = 
u£d
; \

272 
»Œy
; \

274 
¡ršg¡»am
 
os
; o << 
rc
 << 
’ds
; \

275 
¡ršg
 
¡r
 = 
os
.
	`¡r
(); \

276 
	`TRACE
Ğ
TRACE_ALWAYS
, \

278 
¡r
.
	`c_¡r
()); \

279 
	`W_FATAL
(
rc
.
	`”r_num
()); \

281 }

	)

295 
	s’v_¡©s_t


297 vŞ©
ušt_t
 
	m_Árx_©t
;

298 vŞ©
ušt_t
 
	m_Árx_com
;

300 
’v_¡©s_t
()

301 : 
_Árx_©t
(0), 
_Árx_com
(0)

304 ~
’v_¡©s_t
() { }

306 
´št_’v_¡©s
() const;

308 
šlše
 
ušt_t
 
šc_Œx_©t
(è{  (
©omic_šc_ušt_nv
(&
_Árx_©t
)); }

309 
šlše
 
ušt_t
 
šc_Œx_com
() {

310 
©omic_šc_ušt
(&
_Árx_©t
);

311  (
©omic_šc_ušt_nv
(&
_Árx_com
));

326 
	eeDBCÚŒŞ
 { 
	mDBC_UNDEF
 = 0x1,

327 
	mDBC_PAUSED
 = 0x2,

328 
	mDBC_ACTIVE
 = 0x4,

329 
	mDBC_STOPPED
 = 0x8

344 şas 
	cdb_içû


346 
	mpublic
:

347 
m­
<
	t¡ršg
,¡ršg> 
	t’vV¬M­
;

348 
	m’vV¬M­
::
	t™”©Ü
 
	t’vV¬It
;

349 
	m’vV¬M­
::
	tcÚ¡_™”©Ü
 
	t’vV¬CÚ¡It
;

351 
	m´iv©e
:

352 vŞ©
_dbc
;

354 
	mpublic
:

356 
	$db_içû
()

357 : 
	$_dbc
(
DBC_UNDEF
)

359 
vœtu®
 ~
	$db_içû
(è{ 
	}
}

363 
eDBCÚŒŞ
 
	$dbc
(è{  (
	`eDBCÚŒŞ
(*&
_dbc
)); 
	}
}

365 
	$£t_dbc
(cÚ¡ 
eDBCÚŒŞ
 
adbc
) {

366 
	`as£¹
 (
adbc
!=
DBC_UNDEF
);

367 
tmp
 = 
adbc
;

368 
	`©omic_sw­_ušt
(&
_dbc
, 
tmp
);

369 
	}
}

374 
vœtu®
 
cÚf
()=0;

375 
vœtu®
 
£t
(
’vV¬M­
* 
v¬s
)=0;

376 
vœtu®
 
w_rc_t
 
lßd_schema
()=0;

377 
vœtu®
 
š™
()=0;

378 
vœtu®
 
İ’
()=0;

379 
vœtu®
 
şo£
()=0;

380 
vœtu®
 
¡¬t
()=0;

381 
vœtu®
 
¡İ
()=0;

382 
vœtu®
 
»¡¬t
()=0;

383 
vœtu®
 
·u£
()=0;

384 
vœtu®
 
»sume
()=0;

385 
vœtu®
 
w_rc_t
 
Ãwrun
()=0;

386 
vœtu®
 
¡©i¡ics
()=0;

387 
vœtu®
 
dump
()=0;

388 
vœtu®
 
	$šfo
() const=0;

390 
	}
};

395 
şass
 
	gba£_wÜk”_t
;

396 
şass
 
	gŒx_wÜk”_t
;

397 
şass
 
	gæush”_t
;

398 
şass
 
	gShÜeEnv
;

403 
ShÜeEnv
* 
_g_shÜe_’v
;

405 
´ocmÚ™Ü_t
* 
_g_mÚ
;

407 
ssm_max_sm®l_»c
;

418 
	eM—su»m’tS‹
 { 
	mMST_UNDEF
 = 0x0,

419 
	mMST_WARMUP
 = 0x1,

420 
	mMST_MEASURE
 = 0x2,

421 
	mMST_DONE
 = 0x4,

422 
	mMST_PAUSE
 = 0x8

435 şas 
	cShÜeEnv
 : 
public
 
db_içû


437 
public
:

438 
¡d
::
	tm­
<
	t¡ršg
,¡ršg> 
	tP¬amM­
;

440 
Œx_»que¡_t
 
	tReque¡
;

441 
blob_poŞ
 
	tReque¡Sck
;

442 
Œx_wÜk”_t
 
	tWÜk”
;

443 
Œx_wÜk”_t
* 
	tWÜk”PŒ
;

444 
	m¡d
::
	tveùÜ
<
	tWÜk”PŒ
> 
	tWÜk”PoŞ
;

445 
	m¡d
::
	tveùÜ
<
	tWÜk”PŒ
>::
	t™”©Ü
 
	tWÜk”It
;

447 
şass
 
	mfid_lßd”_t
;

449 
	m´Ùeùed
:

451 
ss_m
* 
_pssm
;

454 
boŞ
 
	m_š™Ÿlized
;

455 
±h»ad_mu‹x_t
 
	m_š™_mu‹x
;

456 
boŞ
 
	m_lßded
;

457 
±h»ad_mu‹x_t
 
	m_lßd_mu‹x
;

459 
±h»ad_mu‹x_t
 
	m_¡©m­_mu‹x
;

460 
±h»ad_mu‹x_t
 
	m_Ï¡_¡©s_mu‹x
;

464 
devid_t
 
	m_devid
;

465 
	mgu¬d
<
	mvid_t
> 
	m_pvid
;

466 
¡id_t
 
	m_roÙ_iid
;

467 
±h»ad_mu‹x_t
 
	m_vŞ_mu‹x
;

468 
lvid_t
 
	m_lvid
;

469 
	m_vŞ_út
;

472 
	mgu¬d
<
	mİtiÚ_group_t
> 
	m_pİts
;

474 
P¬amM­
 
	m_sys_İts
;

475 
P¬amM­
 
	m_sm_İts
;

476 
P¬amM­
 
	m_dev_İts
;

479 
ušt
 
	m_max_ıu_couÁ
;

480 
ušt
 
	m_aùive_ıu_couÁ
;

484 
WÜk”PoŞ
 
	m_wÜk”s
;

485 
ušt
 
	m_wÜk”_út
;

500 
	m_sÿlšg_çùÜ
;

501 
±h»ad_mu‹x_t
 
	m_sÿlšg_mu‹x
;

502 
	m_qu”›d_çùÜ
;

503 
±h»ad_mu‹x_t
 
	m_qu”›d_mu‹x
;

507 
’v_¡©s_t
 
	m_’v_¡©s
;

508 
sm_¡©s_šfo_t
 
	m_Ï¡_sm_¡©s
;

511 vŞ©
ušt
 
	m_m—su»
;

514 
¡ršg
 
	m_sy¢ame
;

517 
ušt4_t
 
	m_pd
;

518 
boŞ
 
	m_’abË_hacks
;

522 
u§ge
(
İtiÚ_group_t
& 
İtiÚs
);

523 
»adcÚfig
();

526 vŞ©
ušt
 
	m_»c_to_acc
;

529 
	m_š£¹_äeq
;

530 
	m_d–‘e_äeq
;

531 
	m_´obe_äeq
;

534 
cÚfigu»_sm
();

535 
¡¬t_sm
();

536 
şo£_sm
();

539 vŞ©
boŞ
 
	m_bAÏrmS‘
;

540 
s_lock
 
	m_®¬m_lock
;

541 
	m_¡¬t_imb®ªû
;

542 
skew_ty³_t
 
	m_skew_ty³
;

544 
	mpublic
:

546 
ShÜeEnv
();

547 
	mvœtu®
 ~
ShÜeEnv
();

552 
vœtu®
 
cÚf
();

553 
vœtu®
 
	$£t
(
’vV¬M­
* ) { (0); };

554 
vœtu®
 
	`š™
();

555 
vœtu®
 
	$po¡_š™
(è{  (0); 
	}
};

556 
vœtu®
 
	$İ’
(è{ (0); 
	}
};

557 
vœtu®
 
şo£
();

558 
vœtu®
 
¡¬t
();

559 
vœtu®
 
¡İ
();

560 
vœtu®
 
»¡¬t
();

561 
vœtu®
 
	$·u£
(è{ (0); 
	}
};

562 
vœtu®
 
	$»sume
(è{ (0); 
	}
};

563 
vœtu®
 
w_rc_t
 
Ãwrun
()=0;

564 
vœtu®
 
¡©i¡ics
();

565 
vœtu®
 
dump
();

566 
vœtu®
 
	$šfo
() const=0;

572 
vœtu®
 
w_rc_t
 
	`lßd_schema
()=0;

574 
vœtu®
 
w_rc_t
 
	`w¬mup
()=0;

575 
vœtu®
 
w_rc_t
 
	`lßdd©a
()=0;

576 
vœtu®
 
w_rc_t
 
	`check_cÚsi¡’cy
()=0;

580 
vœtu®
 
w_rc_t
 
	`lßd_ªd_»gi¡”_fids
()=0;

583 
šlše
 
ss_m
* 
	$db
(è{ (
_pssm
); 
	}
}

584 
šlše
 
vid_t
* 
	$vid
(è{ (
_pvid
); 
	}
}

586 
boŞ
 
is_š™Ÿlized
();

587 
boŞ
 
is_lßded
();

589 
	$£t_m—su»
(cÚ¡ 
M—su»m’tS‹
 
aM—su»m’tS‹
) {

591 
tmp
 = 
aM—su»m’tS‹
;

592 
	`©omic_sw­_ušt
(&
_m—su»
, 
tmp
);

593 
	}
}

594 
šlše
 
M—su»m’tS‹
 
	$g‘_m—su»
(è{  (
	`M—su»m’tS‹
(*&
_m—su»
)); 
	}
}

597 
±h»ad_mu‹x_t
* 
	$g‘_š™_mu‹x
(è{  (&
_š™_mu‹x
); 
	}
}

598 
±h»ad_mu‹x_t
* 
	$g‘_vŞ_mu‹x
(è{  (&
_vŞ_mu‹x
); 
	}
}

599 
±h»ad_mu‹x_t
* 
	$g‘_lßd_mu‹x
(è{  (&
_lßd_mu‹x
); 
	}
}

600 
boŞ
 
	$g‘_š™_no_cs
(è{  (
_š™Ÿlized
); 
	}
}

601 
boŞ
 
	$g‘_lßded_no_cs
(è{  (
_lßded
); 
	}
}

602 
	$£t_š™_no_cs
(cÚ¡ 
boŞ
 
b_is_š™
è{ 
_š™Ÿlized
 = b_is_š™; 
	}
}

603 
	$£t_lßded_no_cs
(cÚ¡ 
boŞ
 
b_is_lßded
è{ 
_lßded
 = b_is_lßded; 
	}
}

606 
	$´št_ıus
() const;

607 
ušt
 
	$g‘_max_ıu_couÁ
() const;

608 
	`£t_max_ıu_couÁ
(cÚ¡ 
ušt
 
ıuút
);

609 
ušt
 
	$g‘_aùive_ıu_couÁ
() const;

610 
	`£t_aùive_ıu_couÁ
(cÚ¡ 
ušt
 
aùıuút
);

615 
	`£t_qf
(cÚ¡ 
aQF
);

616 
	$g‘_qf
() const;

617 
	`£t_sf
(cÚ¡ 
aSF
);

618 
	$g‘_sf
() const;

619 
	`upd_sf
();

620 
	$´št_sf
() const;

623 
ušt4_t
 
	$g‘_pd
() const;

624 
ušt4_t
 
	`£t_pd
(cÚ¡ 
physiÿl_design_t
& 
­d
);

625 
ušt4_t
 
	`add_pd
(cÚ¡ 
physiÿl_design_t
& 
­d
);

626 
boŞ
 
	`check_hacks_’abËd
();

627 
boŞ
 
	$is_hacks_’abËd
() const;

628 
vœtu®
 
w_rc_t
 
	$upd©e_·¹™iÚšg
(è{  (
RCOK
); 
	}
}

631 
£t_äeqs
(
š£¹_äeq
 = 0, 
d–‘e_äeq
 = 0, 
´obe_äeq
 = 0);

634 
vœtu®
 
£t_skew
(
¬—
, 
lßd
, 
¡¬t_imb®ªû
);

635 
vœtu®
 
»£t_skew
();

636 
vœtu®
 
¡¬t_lßd_imb®ªû
();

639 
vœtu®
 
db_´št_š™
(
num_lšes
);

640 
vœtu®
 
w_rc_t
 
	$db_´št
(
num_lšes
è{ (
RCOK
); 
	}
}

643 
vœtu®
 
db_ãtch_š™
();

644 
vœtu®
 
w_rc_t
 
	$db_ãtch
(è{ (
RCOK
); 
	}
}

647 
ušt
 
upd_wÜk”_út
();

648 
Œx_wÜk”_t
* 
wÜk”
(cÚ¡ 
ušt
 
idx
);

651 
Reque¡Sck
 
	g_»que¡_poŞ
;

654 
vœtu®
 
’v_th»ad_š™
()=0;

655 
vœtu®
 
’v_th»ad_fši
()=0;

658 
di§bË_çke_disk_Ï‹ncy
();

659 
’abË_çke_disk_Ï‹ncy
(cÚ¡ 
ad–ay
);

662 
g©h”¡©s_sm
();

665 
checkpošt
();

667 
¡ršg
 
	$sy¢ame
(è{  (
_sy¢ame
); 
	}
}

669 
’v_¡©s_t
* 
	$g‘_’v_¡©s
(è{  (&
_’v_¡©s
); 
	}
}

672 
ušt_t
 
	$g‘_Œx_©t
() const;

673 
ušt_t
 
	$g‘_Œx_com
() const;

675 
šlše
 
	$šc_Œx_©t
(è{ 
_’v_¡©s
.
	`šc_Œx_©t
(); 
	}
}

676 
šlše
 
	$šc_Œx_com
(è{ 
_’v_¡©s
.
	`šc_Œx_com
(); 
	}
}

679 
vœtu®
 
´št_throughput
(cÚ¡ 
iQu”›dSF
,

680 cÚ¡ 
iS´—d
,

681 cÚ¡ 
iNumOfTh»ads
,

682 cÚ¡ 
d–ay
,

683 cÚ¡ 
ulÚg_t
 
mioch
,

684 cÚ¡ 
avgıuu§ge
)=0;

686 
vœtu®
 
»£t_¡©s
()=0;

688 
šlše
 
ušt
 
	$g‘_»c_to_acûss
(è{  *&
_»c_to_acc
; 
	}
}

692 
vœtu®
 
w_rc_t
 
run_Úe_xù
(
Reque¡
* 
´eque¡
)=0;

697 
šlše
 
boŞ
 
	$isAsynchComm™
(ècÚ¡ {  (
_asynch_comm™
); 
	}
}

698 
£tAsynchComm™
(cÚ¡ 
boŞ
 
bAsynch
);

702 
	gpublic
:

703 
boŞ
 
	$isSLIEÇbËd
(ècÚ¡ {  (
_bU£SLI
); 
	}
}

704 
	$£tSLIEÇbËd
(cÚ¡ 
boŞ
 
bU£SLI
è{ 
_bU£SLI
 = bU£SLI; 
	}
}

705 
	g´Ùeùed
:

706 
boŞ
 
_bU£SLI
;

710 
	gpublic
:

711 
boŞ
 
	$isELREÇbËd
(ècÚ¡ {  (
_bU£ELR
); 
	}
}

712 
	$£tELREÇbËd
(cÚ¡ 
boŞ
 
bU£ELR
è{ 
_bU£ELR
 = bU£ELR; 
	}
}

713 
	g´Ùeùed
:

714 
boŞ
 
_bU£ELR
;

718 
	gpublic
:

719 
boŞ
 
	$isFlush”EÇbËd
(ècÚ¡ {  (
_bU£Flush”
); 
	}
}

720 
	$£tFlush”EÇbËd
(cÚ¡ 
boŞ
 
bU£Flush”
è{ 
_bU£Flush”
 = bU£Flush”; 
	}
}

722 
	g´Ùeùed
:

723 
boŞ
 
_bU£Flush”
;

724 
	ggu¬d
<
	gæush”_t
> 
	g_ba£_æush”
;

725 
vœtu®
 
_¡¬t_æush”
();

726 
vœtu®
 
_¡İ_æush”
();

727 
to_ba£_æush”
(
Reque¡
* 
¬
);

730 
	g´Ùeùed
:

733 
_£t_sys_·¿ms
();

734 
boŞ
 
	g_asynch_comm™
;

740 
EXIT_NAMESPACE
(
shÜe
);

	@include/sm/shore/shore_error.h

33 #iâdeà
__SHORE_ERROR_H


34 
	#__SHORE_ERROR_H


	)

36 
	~"ut/Çme¥aû.h
"

39 
ENTER_NAMESPACE
(
shÜe
);

44 
	m£_NOT_FOUND
 = 0x810001,

45 
	m£_VOLUME_NOT_FOUND
 = 0X810002,

46 
	m£_INDEX_NOT_FOUND
 = 0x810003,

47 
	m£_TABLE_NOT_FOUND
 = 0x810004,

48 
	m£_TUPLE_NOT_FOUND
 = 0x810005,

49 
	m£_NO_CURRENT_TUPLE
 = 0x810006,

50 
	m£_CANNOT_INSERT_TUPLE
 = 0x810007,

52 
	m£_SCAN_OPEN_ERROR
 = 0x810010,

53 
	m£_INCONSISTENT_INDEX
 = 0x810012,

54 
	m£_OPEN_SCAN_ERROR
 = 0x810020,

56 
	m£_LOAD_NOT_EXCLUSIVE
 = 0x810040,

57 
	m£_ERROR_IN_LOAD
 = 0x810041,

58 
	m£_ERROR_IN_IDX_LOAD
 = 0x810042,

60 
	m£_WRONG_DISK_DATA
 = 0x810050,

62 
	m£_INVALID_INPUT
 = 0x810060

67 
EXIT_NAMESPACE
(
shÜe
);

	@include/sm/shore/shore_field.h

42 #iâdeà
__SHORE_FIELD_H


43 
	#__SHORE_FIELD_H


	)

45 
	~"ut.h
"

47 
	~"sm/shÜe/shÜe_fe_desc.h
"

50 
ENTER_NAMESPACE
(
shÜe
);

63 şas 
	ctime¡amp_t


65 
	m´iv©e
:

66 
time_t
 
_time
;

68 
	mpublic
:

70 
	$time¡amp_t
(è{ 
_time
 = 
	`time
(
NULL
); }

71 ~
	$time¡amp_t
(è{ 
	}
}

73 
	$size
(è{  (
time_t
); 
	}
}

74 
	$¡ršg
(* 
de¡
, cÚ¡ 
Ën
) const {

75 #ifdeà
_POSIX_PTHREAD_SEMANTICS


76 
	`ùime_r
(&
_time
, 
de¡
);

77 #–ià
	`defšed
(
SOLARIS2
)

78 
	`ùime_r
(&
_time
, 
de¡
, 
Ën
);

80 
	`ùime_r
(&
_time
, 
de¡
);

82 
de¡
[
Ën
-1] = '\0';

83 
	}
}

97 
	esqÉy³_t


99 
	mSQL_BIT
,

100 
	mSQL_SMALLINT
,

101 
	mSQL_INT
,

102 
	mSQL_FLOAT
,

103 
	mSQL_LONG
,

104 
	mSQL_CHAR
,

105 
	mSQL_FIXCHAR
,

106 
	mSQL_VARCHAR
,

107 
	mSQL_TIME
,

109 
	mSQL_NUMERIC
,

110 
	mSQL_SNUMERIC


124 şas 
	cf›ld_desc_t
 {

125 
	m´iv©e
:

127 
s_lock
 
_f›lddesc_lock
;

128 
	m_Çme
[
MAX_FIELDNAME_LEN
];

129 
	m_keydesc
[
MAX_KEYDESC_LEN
];

131 
sqÉy³_t
 
	m_ty³
;

132 
	m_size
;

133 
boŞ
 
	m_®low_nuÎ
;

134 
boŞ
 
	m_is_£tup
;

136 cÚ¡ * 
_£t_keydesc
();

138 
	mpublic
:

144 
	$f›ld_desc_t
()

145 : 
	`_ty³
(
SQL_SMALLINT
), 
	`_size
(0),

146 
	`_®low_nuÎ
(
Œue
), 
	$_is_£tup
(
çl£
)

148 
	`mem£t
(
_Çme
, 0, 
MAX_FIELDNAME_LEN
);

149 
	`mem£t
(
_keydesc
, 0, 
MAX_KEYDESC_LEN
);

152 ~
	$f›ld_desc_t
()

154 
	}
}

161 cÚ¡ * 
	$Çme
() const {

163  (
_Çme
);

164 
	}
}

166 
šlše
 
boŞ
 
	$is_v¬ŸbË_Ëngth
(
sqÉy³_t
 
ty³
) const {

168  (
ty³
 =ğ
SQL_VARCHAR
);

169 
	}
}

171 
šlše
 
boŞ
 
	$is_v¬ŸbË_Ëngth
() const {

172  (
	`is_v¬ŸbË_Ëngth
(
_ty³
));

173 
	}
}

175 
šlše
 
ušt_t
 
	$f›ldmaxsize
() const {

177  (
_size
);

178 
	}
}

180 
šlše
 
sqÉy³_t
 
	$ty³
() const {

182  (
_ty³
);

183 
	}
}

185 
šlše
 
boŞ
 
	$®low_nuÎ
() const {

187  (
_®low_nuÎ
);

188 
	}
}

191 cÚ¡ * 
	$keydesc
() {

193 
	`CRITICAL_SECTION
(
fkd_cs
, 
_f›lddesc_lock
);

194  (
	`_£t_keydesc
());

195 
	}
}

198 
£tup
(cÚ¡ 
sqÉy³_t
 
ty³
,

199 cÚ¡ * 
Çme
,

200 cÚ¡ 
size
 = 0,

201 cÚ¡ 
boŞ
 
®low_nuÎ
 = 
çl£
);

204 
´št_desc
(
o¡»am
& 
os
 = 
cout
);

220 
	sf›ld_v®ue_t


223 
f›ld_desc_t
* 
	m_pf›ld_desc
;

224 
boŞ
 
	m_nuÎ_æag
;

227 
	us_f›ld_v®ue_t
 {

228 
boŞ
 
	m_b™
;

229 
	m_sm®lšt
;

230 
	m_ch¬
;

231 
	m_št
;

232 
	m_æßt
;

233 
	m_lÚg
;

234 
time¡amp_t
* 
	m_time
;

235 * 
	m_¡ršg
;

236 } 
	m_v®ue
;

238 * 
	m_d©a
;

239 
ušt_t
 
	m_d©a_size
;

240 
ušt_t
 
	m_»®_size
;

241 
ušt_t
 
	m_max_size
;

248 
f›ld_v®ue_t
()

249 : 
_pf›ld_desc
(
NULL
), 
_nuÎ_æag
(
Œue
), 
_d©a
(NULL),

250 
_d©a_size
(0), 
_»®_size
(0), 
_max_size
(0)

255 
f›ld_v®ue_t
(
f›ld_desc_t
* 
pfd
)

256 : 
_pf›ld_desc
(
pfd
), 
_nuÎ_æag
(
Œue
), 
_d©a
(
NULL
),

257 
_d©a_size
(0), 
_»®_size
(0), 
_max_size
(0)

259 
£tup
(
pfd
);

263 ~
f›ld_v®ue_t
() {

264 ià(
	m_d©a
) {

265 
ä“
 (
_d©a
);

266 
	m_d©a
 = 
NULL
;

276 
£tup
(
f›ld_desc_t
* 
pfd
);

279 
»£t
();

281 
šlše
 
boŞ
 
is_£tup
(è{  ( 
	m_pf›ld_desc
 ? 
	mŒue
 : 
çl£
); }

284 
šlše
 
f›ld_desc_t
* 
f›ld_desc
(è{  (
	m_pf›ld_desc
); }

285 
šlše
 
£t_f›ld_desc
(
f›ld_desc_t
* 
fd
) {

286 
as£¹
 (
fd
);

287 
	m_pf›ld_desc
 = 
fd
;

291 
šlše
 
ušt_t
 
»®size
() const {

292 
as£¹
 (
_pf›ld_desc
);

293  (
	m_»®_size
);

297 
šlše
 
ušt_t
 
maxsize
() const {

298 
as£¹
 (
_pf›ld_desc
);

299  (
	m_max_size
);

309 
®loc_¥aû
(cÚ¡ 
ušt_t
 
size
);

312 
£t_mš_v®ue
();

313 
£t_max_v®ue
();

316 
šlše
 
boŞ
 
is_nuÎ
() const {

317 
as£¹
 (
_pf›ld_desc
);

318  (
	m_nuÎ_æag
);

321 
šlše
 
£t_nuÎ
() {

322 
as£¹
 (
_pf›ld_desc
);

323 
as£¹
 (
_pf›ld_desc
->
®low_nuÎ
());

324 
	m_nuÎ_æag
 = 
Œue
;

328 
šlše
 
boŞ
 
is_v¬ŸbË_Ëngth
() {

329 
as£¹
 (
_pf›ld_desc
);

330  (
	m_pf›ld_desc
->
is_v¬ŸbË_Ëngth
());

334 
boŞ
 
cİy_v®ue
(* 
d©a
) const;

338 
£t_v®ue
(cÚ¡ * 
d©a
, cÚ¡ 
ušt
 
Ëngth
);

339 
£t_št_v®ue
(cÚ¡ 
d©a
);

340 
£t_b™_v®ue
(cÚ¡ 
boŞ
 
d©a
);

341 
£t_sm®lšt_v®ue
(cÚ¡ 
d©a
);

342 
£t_æßt_v®ue
(cÚ¡ 
d©a
);

343 
£t_lÚg_v®ue
(cÚ¡ 
d©a
);

344 
£t_decim®_v®ue
(cÚ¡ 
decim®
 
d©a
);

345 
£t_time_v®ue
(cÚ¡ 
time_t
 
d©a
);

346 
£t_t¡amp_v®ue
(cÚ¡ 
time¡amp_t
& 
d©a
);

347 
£t_ch¬_v®ue
(cÚ¡ 
d©a
);

348 
£t_fixed_¡ršg_v®ue
(cÚ¡ * 
¡ršg
, cÚ¡ 
ušt
 
Ën
);

349 
£t_v¬_¡ršg_v®ue
(cÚ¡ * 
¡ršg
, cÚ¡ 
ušt
 
Ën
);

353 
g‘_št_v®ue
() const;

354 
g‘_sm®lšt_v®ue
() const;

355 
boŞ
 
g‘_b™_v®ue
() const;

356 
g‘_ch¬_v®ue
() const;

357 
g‘_¡ršg_v®ue
(* 
¡ršg
, cÚ¡ 
ušt
 
bufsize
) const;

358 
g‘_æßt_v®ue
() const;

359 
g‘_lÚg_v®ue
() const;

360 
decim®
 
g‘_decim®_v®ue
() const;

361 
time_t
 
g‘_time_v®ue
() const;

362 
	mtime¡amp_t
& 
g‘_t¡amp_v®ue
() const;

364 
boŞ
 
lßd_v®ue_äom_fe
(
if¡»am
& 
is
, cÚ¡ 
d–im
);

371 
´št_v®ue
(
o¡»am
& 
os
 = 
cout
);

372 
g‘_debug_¡r
(* &
buf
);

393 
šlše
 
	gf›ld_desc_t
::
	$£tup
(
sqÉy³_t
 
ty³
,

394 cÚ¡ * 
Çme
,

395 
size
,

396 
boŞ
 
®low_nuÎ
)

398 
	`CRITICAL_SECTION
(
£tup_cs
, 
_f›lddesc_lock
);

401 
	`¡ºıy
(
_Çme
, 
Çme
, 
MAX_FIELDNAME_LEN
);

402 
_ty³
 = 
ty³
;

405 
_ty³
) {

406 
SQL_BIT
:

407 
_size
 = (
boŞ
);

409 
SQL_SMALLINT
:

410 
_size
 = ();

412 
SQL_CHAR
:

413 
_size
 = ();

415 
SQL_INT
:

416 
_size
 = ();

418 
SQL_FLOAT
:

419 
_size
 = ();

421 
SQL_LONG
:

422 
_size
 = ();

424 
SQL_TIME
:

425 
_size
 = (
time¡amp_t
);

427 
SQL_FIXCHAR
:

428 
SQL_NUMERIC
:

429 
SQL_SNUMERIC
:

430 
SQL_VARCHAR
:

431 
_size
 = 
size
 * ();

436 
	`_£t_keydesc
();

439 
_®low_nuÎ
 = 
®low_nuÎ
;

442 
_is_£tup
 = 
Œue
;

443 
	}
}

458 
šlše
 cÚ¡ * 
	gf›ld_desc_t
::
	$_£t_keydesc
()

460 ià(
	`¡¾’
(
_keydesc
)>1)

461  (&
_keydesc
[0]);

466 
_ty³
) {

467 
SQL_BIT
:

468 
SQL_SMALLINT
:

469 
SQL_CHAR
:

470 
SQL_INT
:

471 
	`¥rštf
(
_keydesc
, "i%d", 
_size
); ;

473 
SQL_FLOAT
:

474 
SQL_LONG
:

475 
	`¥rštf
(
_keydesc
, "f%d", 
_size
); ;

477 
SQL_VARCHAR
:

478 
	`¥rštf
(
_keydesc
, "b*%d", 
_size
); ;

480 
SQL_TIME
:

481 
SQL_FIXCHAR
:

482 
SQL_NUMERIC
:

483 
SQL_SNUMERIC
:

484 
	`¥rštf
(
_keydesc
, "b%d", 
_size
); ;

486  (&
_keydesc
[0]);

487 
	}
}

506 
šlše
 
	gf›ld_v®ue_t
::
	$£tup
(
f›ld_desc_t
* 
pfd
)

508 
	`as£¹
 (
pfd
);

511 ià(
_pf›ld_desc
 =ğ
pfd
)

514 
_pf›ld_desc
 = 
pfd
;

515 
ušt_t
 
sz
 = 0;

517 
_pf›ld_desc
->
	`ty³
()) {

518 
SQL_BIT
:

519 
_max_size
 = (
boŞ
);

521 
SQL_SMALLINT
:

522 
_max_size
 = ();

524 
SQL_CHAR
:

525 
_max_size
 = ();

527 
SQL_INT
:

528 
_max_size
 = ();

530 
SQL_FLOAT
:

531 
_max_size
 = ();

533 
SQL_LONG
:

534 
_max_size
 = ();

536 
SQL_TIME
:

537 
sz
 = (
time¡amp_t
);

538 
_d©a_size
 = 
sz
;

539 
_»®_size
 = 
sz
;

540 
_max_size
 = 
sz
;

541 ià(
_d©a
)

542 
	`ä“
 (
_d©a
);

543 
_d©a
 = (*)
	`m®loc
(
sz
);

544 
_v®ue
.
_time
 = (
time¡amp_t
*)
_d©a
;

546 
SQL_VARCHAR
:

547 
_max_size
 = 
_pf›ld_desc
->
	`f›ldmaxsize
();

549 
_»®_size
 = 0;

553 
_v®ue
.
_¡ršg
 = 
_d©a
;

555 
SQL_FIXCHAR
:

556 
SQL_NUMERIC
:

557 
SQL_SNUMERIC
:

558 
sz
 = 
_pf›ld_desc
->
	`f›ldmaxsize
();

559 
_»®_size
 = 
sz
;

560 
_max_size
 = 
sz
;

562 ià((
_d©a_size
>=
sz
è&& (
_d©a
)) {

565 
	`mem£t
(
_d©a
, 0, 
_d©a_size
);

569 ià(
_d©a
)

570 
	`ä“
 (
_d©a
);

571 
_d©a
 = (*)
	`m®loc
(
sz
);

572 
	`mem£t
(
_d©a
, 0, 
sz
);

573 
_d©a_size
 = 
sz
;

576 
_v®ue
.
_¡ršg
 = 
_d©a
;

579 
	}
}

591 
šlše
 
	gf›ld_v®ue_t
::
	$»£t
()

595 
_nuÎ_æag
 = 
Œue
;

596 
_pf›ld_desc
->
	`ty³
()) {

597 
SQL_BIT
:

598 
_v®ue
.
_b™
 = 
çl£
;

600 
SQL_SMALLINT
:

601 
_v®ue
.
_sm®lšt
 = 0;

603 
SQL_CHAR
:

604 
_v®ue
.
_ch¬
 = 0;

606 
SQL_INT
:

607 
_v®ue
.
_št
 = 0;

609 
SQL_FLOAT
:

610 
_v®ue
.
_æßt
 = 0;

612 
SQL_LONG
:

613 
_v®ue
.
_lÚg
 = 0;

615 
SQL_TIME
:

616 
SQL_VARCHAR
:

617 
SQL_FIXCHAR
:

618 
SQL_NUMERIC
:

619 
SQL_SNUMERIC
:

620 ià(
_d©a
 && 
_d©a_size
è
	`mem£t
(_data, 0, _data_size);

622 
	}
}

638 
šlše
 
	gf›ld_v®ue_t
::
	$®loc_¥aû
(cÚ¡ 
ušt_t
 
Ën
)

640 
	`as£¹
 (
_pf›ld_desc
);

641 
	`as£¹
 (
_pf›ld_desc
->
	`ty³
(è=ğ
SQL_VARCHAR
);

642 
	`as£¹
 (
Ën
 <ğ
_»®_size
);

645 ià(
_d©a_size
 >ğ
Ën
)

649 ià(
_d©a
) {

650 
	`ä“
(
_d©a
);

652 
_d©a
 = (*)
	`m®loc
(
Ën
);

653 
_d©a_size
 = 
Ën
;

656 
	`mem£t
(
_d©a
, 0, 
_d©a_size
);

659 
_v®ue
.
_¡ršg
 = 
_d©a
;

660 
	}
}

672 
šlše
 
	gf›ld_v®ue_t
::
	$£t_v®ue
(cÚ¡ * 
d©a
,

673 cÚ¡ 
ušt
 
Ëngth
)

675 
	`as£¹
 (
_pf›ld_desc
);

676 
_nuÎ_æag
 = 
çl£
;

678 
_pf›ld_desc
->
	`ty³
()) {

679 
SQL_BIT
:

680 
SQL_SMALLINT
:

681 
SQL_CHAR
:

682 
SQL_INT
:

683 
SQL_FLOAT
:

684 
SQL_LONG
:

685 
	`memıy
(&
_v®ue
, 
d©a
, 
_max_size
);

687 
SQL_TIME
:

688 
	`memıy
(
_v®ue
.
_time
, 
d©a
, 
	`MIN
(
Ëngth
, 
_»®_size
));

690 
SQL_VARCHAR
:

691 
	`£t_v¬_¡ršg_v®ue
((cÚ¡ *)
d©a
, 
Ëngth
);

693 
SQL_FIXCHAR
:

694 
SQL_NUMERIC
:

695 
SQL_SNUMERIC
:

696 
_»®_size
 = 
	`MIN
(
Ëngth
, 
_max_size
);

697 
	`as£¹
(
_d©a_size
 >ğ
_»®_size
);

699 
	`memıy
(
_v®ue
.
_¡ršg
, 
d©a
, 
_»®_size
);

702 
	}
}

714 
šlše
 
	gf›ld_v®ue_t
::
	$£t_mš_v®ue
()

716 
	`as£¹
 (
_pf›ld_desc
);

717 
_nuÎ_æag
 = 
çl£
;

719 
_pf›ld_desc
->
	`ty³
()) {

720 
SQL_BIT
:

721 
_v®ue
.
_b™
 = 
çl£
;

723 
SQL_SMALLINT
:

724 
_v®ue
.
_sm®lšt
 = 
MIN_SMALLINT
;

726 
SQL_CHAR
:

727 
_v®ue
.
_ch¬
 = 
MIN_SMALLINT
;

729 
SQL_INT
:

730 
_v®ue
.
_št
 = 
MIN_INT
;

732 
SQL_FLOAT
:

733 
_v®ue
.
_æßt
 = 
MIN_FLOAT
;

735 
SQL_LONG
:

736 
_v®ue
.
_lÚg
 = 
MIN_FLOAT
;

738 
SQL_VARCHAR
:

739 
SQL_FIXCHAR
:

740 
SQL_NUMERIC
:

741 
SQL_SNUMERIC
:

742 
_d©a
[0] = '\0';

743 
_v®ue
.
_¡ršg
 = 
_d©a
;

745 
SQL_TIME
:

748 
	}
}

751 
šlše
 
	gf›ld_v®ue_t
::
	$£t_max_v®ue
()

753 
	`as£¹
 (
_pf›ld_desc
);

755 
_nuÎ_æag
 = 
çl£
;

757 
_pf›ld_desc
->
	`ty³
()) {

758 
SQL_BIT
:

759 
_v®ue
.
_b™
 = 
Œue
;

761 
SQL_SMALLINT
:

762 
_v®ue
.
_sm®lšt
 = 
MAX_SMALLINT
;

764 
SQL_CHAR
:

765 
_v®ue
.
_ch¬
 = 'z';

767 
SQL_INT
:

768 
_v®ue
.
_št
 = 
MAX_INT
;

770 
SQL_FLOAT
:

771 
_v®ue
.
_æßt
 = 
MAX_FLOAT
;

773 
SQL_LONG
:

774 
_v®ue
.
_lÚg
 = 
MAX_FLOAT
;

776 
SQL_VARCHAR
:

777 
SQL_FIXCHAR
:

778 
	`mem£t
(
_d©a
, 'z', 
_d©a_size
);

779 
_v®ue
.
_¡ršg
 = 
_d©a
;

781 
SQL_NUMERIC
:

782 
SQL_SNUMERIC
:

783 
	`mem£t
(
_d©a
, '9', 
_d©a_size
);

784 
_v®ue
.
_¡ršg
 = 
_d©a
;

786 
SQL_TIME
:

789 
	}
}

801 
šlše
 
boŞ
 
	gf›ld_v®ue_t
::
	$cİy_v®ue
(* 
d©a
) const

803 
	`as£¹
 (
_pf›ld_desc
);

804 
	`as£¹
 (!
_nuÎ_æag
);

806 
_pf›ld_desc
->
	`ty³
()) {

807 
SQL_BIT
:

808 
	`memıy
(
d©a
, &
_v®ue
.
_b™
, 
_max_size
);

810 
SQL_SMALLINT
:

811 
	`memıy
(
d©a
, &
_v®ue
.
_sm®lšt
, 
_max_size
);

813 
SQL_CHAR
:

814 
	`memıy
(
d©a
, &
_v®ue
.
_ch¬
, 
_max_size
);

816 
SQL_INT
:

817 
	`memıy
(
d©a
, &
_v®ue
.
_št
, 
_max_size
);

819 
SQL_FLOAT
:

820 
	`memıy
(
d©a
, &
_v®ue
.
_æßt
, 
_max_size
);

822 
SQL_LONG
:

823 
	`memıy
(
d©a
, &
_v®ue
.
_lÚg
, 
_max_size
);

825 
SQL_TIME
:

826 
	`memıy
(
d©a
, 
_v®ue
.
_time
, 
_»®_size
);

828 
SQL_VARCHAR
:

829 
	`memıy
(
d©a
, 
_v®ue
.
_¡ršg
, 
_»®_size
);

831 
SQL_FIXCHAR
:

832 
SQL_NUMERIC
:

833 
SQL_SNUMERIC
:

834 
	`memıy
(
d©a
, 
_v®ue
.
_¡ršg
, 
_»®_size
);

838  (
Œue
);

839 
	}
}

851 
šlše
 
	gf›ld_v®ue_t
::
	$£t_št_v®ue
(cÚ¡ 
d©a
)

853 
	`as£¹
 (
_pf›ld_desc
);

854 
	`as£¹
 (
_pf›ld_desc
->
	`ty³
(è=ğ
SQL_INT
);

855 
_nuÎ_æag
 = 
çl£
;

856 
_v®ue
.
_št
 = 
d©a
;

857 
	}
}

860 
šlše
 
	gf›ld_v®ue_t
::
	$£t_b™_v®ue
(cÚ¡ 
boŞ
 
d©a
)

862 
	`as£¹
 (
_pf›ld_desc
);

863 
	`as£¹
 (
_pf›ld_desc
->
	`ty³
(è=ğ
SQL_BIT
);

864 
_nuÎ_æag
 = 
çl£
;

865 
_v®ue
.
_b™
 = 
d©a
;

866 
	}
}

868 
šlše
 
	gf›ld_v®ue_t
::
	$£t_sm®lšt_v®ue
(cÚ¡ 
d©a
)

870 
	`as£¹
 (
_pf›ld_desc
);

871 
	`as£¹
 (
_pf›ld_desc
->
	`ty³
(è=ğ
SQL_SMALLINT
);

872 
_nuÎ_æag
 = 
çl£
;

873 
_v®ue
.
_sm®lšt
 = 
d©a
;

874 
	}
}

876 
šlše
 
	gf›ld_v®ue_t
::
	$£t_ch¬_v®ue
(cÚ¡ 
d©a
)

878 
	`as£¹
 (
_pf›ld_desc
);

879 
	`as£¹
 (
_pf›ld_desc
->
	`ty³
(è=ğ
SQL_CHAR
);

880 
_nuÎ_æag
 = 
çl£
;

881 
_v®ue
.
_ch¬
 = 
d©a
;

882 
	}
}

884 
šlše
 
	gf›ld_v®ue_t
::
	$£t_æßt_v®ue
(cÚ¡ 
d©a
)

886 
	`as£¹
 (
_pf›ld_desc
);

887 
	`as£¹
 (
_pf›ld_desc
->
	`ty³
(è=ğ
SQL_FLOAT
);

888 
_nuÎ_æag
 = 
çl£
;

889 
_v®ue
.
_æßt
 = 
d©a
;

890 
	}
}

892 
šlše
 
	gf›ld_v®ue_t
::
	$£t_lÚg_v®ue
(cÚ¡ 
d©a
)

894 
	`as£¹
 (
_pf›ld_desc
);

895 
	`as£¹
 (
_pf›ld_desc
->
	`ty³
(è=ğ
SQL_LONG
);

896 
_nuÎ_æag
 = 
çl£
;

897 
_v®ue
.
_lÚg
 = 
d©a
;

898 
	}
}

900 
šlše
 
	gf›ld_v®ue_t
::
	$£t_decim®_v®ue
(cÚ¡ 
decim®
 
d©a
)

902 
	`as£¹
 (
_pf›ld_desc
);

903 
	`as£¹
 (
_pf›ld_desc
->
	`ty³
(è=ğ
SQL_FLOAT
);

904 
_nuÎ_æag
 = 
çl£
;

905 
_v®ue
.
_æßt
 = 
d©a
.
	`to_doubË
();

906 
	}
}

908 
šlše
 
	gf›ld_v®ue_t
::
	$£t_time_v®ue
(cÚ¡ 
time_t
 
d©a
)

910 
	`as£¹
 (
_pf›ld_desc
);

911 
	`as£¹
 (
_pf›ld_desc
->
	`ty³
(è=ğ
SQL_FLOAT
);

912 
_nuÎ_æag
 = 
çl£
;

913 
_v®ue
.
_æßt
 = 
d©a
;

914 
	}
}

916 
šlše
 
	gf›ld_v®ue_t
::
	$£t_t¡amp_v®ue
(cÚ¡ 
time¡amp_t
& 
d©a
)

918 
	`as£¹
 (
_pf›ld_desc
);

919 
	`as£¹
 (
_pf›ld_desc
->
	`ty³
(è=ğ
SQL_TIME
);

920 
_nuÎ_æag
 = 
çl£
;

921 
	`memıy
(
_v®ue
.
_time
, &
d©a
, 
_»®_size
);

922 
	}
}

933 
šlše
 
	gf›ld_v®ue_t
::
	$£t_fixed_¡ršg_v®ue
(cÚ¡ * 
¡ršg
,

934 cÚ¡ 
ušt
 
Ën
)

936 
	`as£¹
 (
_pf›ld_desc
);

937 
	`as£¹
 (
_pf›ld_desc
->
	`ty³
(è=ğ
SQL_FIXCHAR
 ||

938 
_pf›ld_desc
->
	`ty³
(è=ğ
SQL_NUMERIC
 ||

939 
_pf›ld_desc
->
	`ty³
(è=ğ
SQL_SNUMERIC
);

942 
_»®_size
 = 
	`MIN
(
Ën
, 
_max_size
);

943 
	`as£¹
 (
_d©a_size
 >ğ
_»®_size
);

944 
_nuÎ_æag
 = 
çl£
;

946 
	`memıy
(
_v®ue
.
_¡ršg
, 
¡ršg
, 
_»®_size
);

947 
	}
}

961 
šlše
 
	gf›ld_v®ue_t
::
	$£t_v¬_¡ršg_v®ue
(cÚ¡ * 
¡ršg
,

962 cÚ¡ 
ušt
 
Ën
)

964 
	`as£¹
 (
_pf›ld_desc
);

965 
	`as£¹
 (
_pf›ld_desc
->
	`ty³
(è=ğ
SQL_VARCHAR
);

966 
_»®_size
 = 
	`MIN
(
Ën
, 
_max_size
);

967 
	`®loc_¥aû
(
_»®_size
);

968 
	`as£¹
 (
_d©a_size
 >ğ
_»®_size
);

969 
_nuÎ_æag
 = 
çl£
;

970 
	`memıy
(
_v®ue
.
_¡ršg
, 
¡ršg
, 
_»®_size
);

971 
	}
}

984 
šlše
 
	gf›ld_v®ue_t
::
	$g‘_št_v®ue
() const

986 
	`as£¹
 (
_pf›ld_desc
);

987 
	`as£¹
 (
_pf›ld_desc
->
	`ty³
(è=ğ
SQL_INT
);

988  (
_v®ue
.
_št
);

989 
	}
}

991 
šlše
 
boŞ
 
	gf›ld_v®ue_t
::
	$g‘_b™_v®ue
() const

993 
	`as£¹
 (
_pf›ld_desc
);

994 
	`as£¹
 (
_pf›ld_desc
->
	`ty³
(è=ğ
SQL_BIT
);

995  (
_v®ue
.
_b™
);

996 
	}
}

998 
šlše
 
	gf›ld_v®ue_t
::
	$g‘_sm®lšt_v®ue
() const

1000 
	`as£¹
 (
_pf›ld_desc
);

1001 
	`as£¹
 (
_pf›ld_desc
->
	`ty³
(è=ğ
SQL_SMALLINT
);

1002  (
_v®ue
.
_sm®lšt
);

1003 
	}
}

1005 
šlše
 
	gf›ld_v®ue_t
::
	$g‘_ch¬_v®ue
() const

1007 
	`as£¹
 (
_pf›ld_desc
);

1008 
	`as£¹
 (
_pf›ld_desc
->
	`ty³
(è=ğ
SQL_CHAR
);

1009  (
_v®ue
.
_ch¬
);

1010 
	}
}

1012 
šlše
 
	gf›ld_v®ue_t
::
	$g‘_¡ršg_v®ue
(* 
bufãr
,

1013 cÚ¡ 
ušt
 
bufsize
) const

1015 
	`as£¹
 (
_pf›ld_desc
);

1016 
	`as£¹
 (
_pf›ld_desc
->
	`ty³
(è=ğ
SQL_FIXCHAR
 ||

1017 
_pf›ld_desc
->
	`ty³
(è=ğ
SQL_VARCHAR
 ||

1018 
_pf›ld_desc
->
	`ty³
(è=ğ
SQL_NUMERIC
 ||

1019 
_pf›ld_desc
->
	`ty³
(è=ğ
SQL_SNUMERIC
);

1020 
	`mem£t
(
bufãr
, '\0', 
bufsize
);

1021 
	`memıy
(
bufãr
, 
_v®ue
.
_¡ršg
, 
	`MIN
(
bufsize
, 
_»®_size
));

1022 
	}
}

1024 
šlše
 
	gf›ld_v®ue_t
::
	$g‘_æßt_v®ue
() const

1026 
	`as£¹
 (
_pf›ld_desc
);

1027 
	`as£¹
 (
_pf›ld_desc
->
	`ty³
(è=ğ
SQL_FLOAT
);

1028  (
_v®ue
.
_æßt
);

1029 
	}
}

1031 
šlše
 
	gf›ld_v®ue_t
::
	$g‘_lÚg_v®ue
() const

1033 
	`as£¹
 (
_pf›ld_desc
);

1034 
	`as£¹
 (
_pf›ld_desc
->
	`ty³
(è=ğ
SQL_LONG
);

1035  (
_v®ue
.
_lÚg
);

1036 
	}
}

1038 
šlše
 
decim®
 
	gf›ld_v®ue_t
::
	$g‘_decim®_v®ue
() const

1040 
	`as£¹
 (
_pf›ld_desc
);

1041 
	`as£¹
 (
_pf›ld_desc
->
	`ty³
(è=ğ
SQL_FLOAT
);

1042  (
	`decim®
(
_v®ue
.
_æßt
));

1043 
	}
}

1045 
šlše
 
time_t
 
	gf›ld_v®ue_t
::
	$g‘_time_v®ue
() const

1047 
	`as£¹
 (
_pf›ld_desc
);

1048 
	`as£¹
 (
_pf›ld_desc
->
	`ty³
(è=ğ
SQL_FLOAT
);

1049  ((
time_t
)
_v®ue
.
_æßt
);

1050 
	}
}

1052 
šlše
 
	gtime¡amp_t
& 
	gf›ld_v®ue_t
::
	$g‘_t¡amp_v®ue
() const

1054 
	`as£¹
 (
_pf›ld_desc
);

1055 
	`as£¹
 (
_pf›ld_desc
->
	`ty³
(è=ğ
SQL_TIME
);

1056  *(
_v®ue
.
_time
);

1057 
	}
}

1061 
EXIT_NAMESPACE
(
shÜe
);

	@include/sm/shore/shore_file_desc.h

33 #iâdeà
__SHORE_FILE_DESC_H


34 
	#__SHORE_FILE_DESC_H


	)

36 
	~"sm_vas.h
"

37 
	~"ut.h
"

38 
	~"sm/shÜe/shÜe_”rÜ.h
"

41 
	~<li¡
>

43 
usšg
 
	g¡d
::
li¡
;

46 
ENTER_NAMESPACE
(
shÜe
);

51 cÚ¡ 
	gMAX_FNAME_LEN
 = 40;

52 cÚ¡ 
	gMAX_TABLENAME_LEN
 = 40;

53 cÚ¡ 
	gMAX_FIELDNAME_LEN
 = 40;

55 cÚ¡ 
	gMAX_KEYDESC_LEN
 = 40;

56 cÚ¡ 
	gMAX_FILENAME_LEN
 = 100;

58 cÚ¡ 
	gMAX_BODY_SIZE
 = 1024;

60 
	#DELIM_CHAR
 '|'

	)

61 
	#ROWEND_CHAR
 '\r'

	)

63 cÚ¡ 
	gCOMMIT_ACTION_COUNT
 = 2000;

64 cÚ¡ 
	gCOMMIT_ACTION_COUNT_WITH_ITER
 = 500000;

66 
	#MIN_SMALLINT
 0

	)

67 
	#MAX_SMALLINT
 1<<15

	)

68 
	#MIN_INT
 0

	)

69 
	#MAX_INT
 1<<31

	)

70 
	#MIN_FLOAT
 0

	)

71 
	#MAX_FLOAT
 1<<10

	)

84 
	efe_ty³_t
 { 
	mFT_HEAP
 = 0x1,

85 
	mFT_PRIMARY_IDX
 = 0x2,

86 
	mFT_IDX
 = 0x4,

87 
	mFT_NONE
 = 0x8

109 
	ephysiÿl_design_t
 { 
	mPD_NORMAL
 = 0x1,

110 
	mPD_PADDED
 = 0x2,

111 
	mPD_MRBT_NORMAL
 = 0x4,

112 
	mPD_MRBT_PART
 = 0x8,

113 
	mPD_MRBT_LEAF
 = 0x10,

114 
	mPD_NOLOCK
 = 0x20,

115 
	mPD_NOLATCH
 = 0x40

129 şas 
	cfe_desc_t


131 
ä›nd
 
şass
 
	mšdex_desc_t
;

132 
	m´Ùeùed
:

134 
±h»ad_mu‹x_t
 
_fschema_mu‹x
;

135 
	m_Çme
[
MAX_FNAME_LEN
];

136 
ušt_t
 
	m_f›ld_couÁ
;

138 
vid_t
 
	m_vid
;

139 
¡id_t
 
	m_roÙ_iid
;

141 
ušt4_t
 
	m_pd
;

144 
	mpublic
:

146 
¡id_t
 
_fid
;

153 
fe_desc_t
(cÚ¡ * 
Çme
,

154 cÚ¡ 
ušt_t
 
fút
,

155 cÚ¡ 
ušt4_t
& 
­d
 = 
PD_NORMAL
);

156 
	mvœtu®
 ~
fe_desc_t
();

163 cÚ¡ * 
	$Çme
(ècÚ¡ {  
_Çme
; }

164 
šlše
 
¡id_t
& 
	$fid
(è{  (
_fid
); 
	}
}

165 
	$£t_fid
(
¡id_t
 
fid
è{ 
_fid
 = fid; 
	}
}

166 
vid_t
 
	$vid
(è{  
_vid
; 
	}
}

167 
¡id_t
 
	$roÙ_iid
(è{  
_roÙ_iid
; 
	}
}

168 
ušt_t
 
	$f›ld_couÁ
(ècÚ¡ {  
_f›ld_couÁ
; 
	}
}

170 
ušt4_t
 
	$g‘_pd
(ècÚ¡ {  
_pd
; 
	}
}

172 
boŞ
 
	$is_fid_v®id
(ècÚ¡ {  (
_fid
 !ğ
¡id_t
::
nuÎ
); 
	}
}

173 
boŞ
 
	$is_vid_v®id
(è{  (
_vid
 !ğ
vid_t
::
nuÎ
); 
	}
}

174 
boŞ
 
	$is_roÙ_v®id
(è{  (
_roÙ_iid
 !ğ
¡id_t
::
nuÎ
); 
	}
}

176 
w_rc_t
 
fšd_fid
(
ss_m
* 
db
);

177 
w_rc_t
 
fšd_roÙ_iid
(
ss_m
* 
db
);

179 
šlše
 
w_rc_t
 
	$check_fid
(
ss_m
* 
db
) {

180 ià(!
	`is_fid_v®id
()) {

181 ià(!
	`is_roÙ_v®id
())

182 
	`W_DO
(
	`fšd_roÙ_iid
(
db
));

183 
	`W_DO
(
	`fšd_fid
(
db
));

185  (
RCOK
);

186 
	}
}

202 şas 
	cfe_šfo_t


204 
	m´iv©e
:

205 
_âame
[
MAX_FNAME_LEN
];

206 
fe_ty³_t
 
	m_áy³
;

207 
	m¡d
::
·œ
<,> 
	m_»cÜd_size
;

209 
rid_t
 
	m_fœ¡_rid
;

210 
rid_t
 
	m_cur_rid
;

212 
	mpublic
:

214 
¡id_t
 
_fid
;

217 
fe_šfo_t
(cÚ¡ 
¡id_t
& 
fid
,

218 cÚ¡ * 
âame
,

219 cÚ¡ 
fe_ty³_t
 
áy³
 = 
FT_HEAP
);

220 
fe_šfo_t
();

221 ~
	$fe_šfo_t
() { }

224 
	$£t_fid
(cÚ¡ 
¡id_t
& 
fid
è{ 
_fid
 = fid; 
	}
}

225 
	g¡id_t
& 
	$fid
(è{  (
_fid
); 
	}
}

226 
	$£t_áy³
(cÚ¡ 
fe_ty³_t
& 
áy³
è{ 
_áy³
 = fty³; 
	}
}

227 
	gfe_ty³_t
& 
	$áy³
(è{  (
_áy³
); 
	}
}

228 
	$£t_fœ¡_rid
(cÚ¡ 
rid_t
 
¬id
è{ 
_fœ¡_rid
 =‡rid; 
	}
}

229 
	grid_t
& 
	$fœ¡_rid
(è{  (
_fœ¡_rid
); 
	}
}

230 
	$£t_cu¼_rid
(cÚ¡ 
rid_t
 
¬id
è{ 
_cur_rid
 =‡rid; 
	}
}

231 
	grid_t
& 
	$cu¼_rid
(è{  (
_cur_rid
); 
	}
}

232 
£t_»cÜd_size
(cÚ¡ 
¡d
::
·œ
<,> 
­aœ
è{ 
	g_»cÜd_size
 =‡pair; }

233 
	g¡d
::
·œ
<,> 
	$»cÜd_size
(è{  (
_»cÜd_size
); 
	}
}

238 
	g¡d
::
	tli¡
<
	tfe_šfo_t
> 
	tfe_li¡
;

242 
EXIT_NAMESPACE
(
shÜe
);

	@include/sm/shore/shore_flusher.h

71 #iâdeà
__SHORE_FLUSHER_H


72 
	#__SHORE_FLUSHER_H


	)

75 
	~"sm/shÜe/shÜe_Œx_wÜk”.h
"

78 
ENTER_NAMESPACE
(
shÜe
);

89 
	sæush”_¡©s_t


91 
ušt
 
	m£rved
;

92 
ušt
 
	mæushes
;

94 
	mlogsize
;

95 
ušt
 
	m®»adyFlushed
;

96 
ušt
 
	mwa™šg
;

98 
ušt
 
	mŒigByXùs
;

99 
ušt
 
	mŒigBySize
;

100 
ušt
 
	mŒigByTimeout
;

102 
æush”_¡©s_t
();

103 ~
æush”_¡©s_t
();

105 
´št
() const;

106 
»£t
();

113 
æoÜ
(
off£t
, 
block_size
è{  (
	moff£t
/
	mblock_size
)*block_size; }

114 
û
(
off£t
, 
block_size
è{  
æoÜ
(offset + block_size - 1, block_size); }

116 
	m_log·¹_sz
;

117 
_log_diff
(cÚ¡ 
l¢_t
& 
h—d
, cÚ¡†¢_t& 

);

134 cÚ¡ 
	gFLUSHER_BUFFER_EXPECTED_SZ
 = 3000;

135 cÚ¡ 
	gFLUSHER_GROUP_SIZE_THRESHOLD
 = 100;

136 cÚ¡ 
	gFLUSHER_LOG_SIZE_THRESHOLD
 = 200000;

137 cÚ¡ 
	gFLUSHER_TIME_THRESHOLD
 = 1000;

140 şas 
	cæush”_t
 : 
public
 
ba£_wÜk”_t


142 
public
:

143 
¤mwqueue
<
	tŒx_»que¡_t
> 
	tBa£Queue
;

145 
	m´iv©e
:

149 
gu¬d
<
Ba£Queue
> 
_ba£_toæush
;

150 
	mgu¬d
<
	mBa£Queue
> 
	m_ba£_æushšg
;

152 
	m´Ùeùed
:

154 
gu¬d
<
PoŞ
> 
_pxù_toæush_poŞ
;

155 
	mgu¬d
<
	mPoŞ
> 
	m_pxù_æushšg_poŞ
;

157 
æush”_¡©s_t
 
	m_¡©s
;

159 
vœtu®
 
_´e_STOP_im¶
();

160 
_wÜk_ACTIVE_im¶
();

161 
vœtu®
 
_check_wa™šg
(
boŞ
& 
bSË•Next
,

162 cÚ¡ 
l¢_t
& 
du¿bËl¢
,

163 
l¢_t
& 
maxl¢
,

164 
ušt
& 
wa™šg
);

165 
vœtu®
 
_move_äom_æushšg
(cÚ¡ 
l¢_t
& 
du¿bËl¢
);

167 
	mpublic
:

169 
æush”_t
(
ShÜeEnv
* 
’v
, 
c_¡r
 
Šame
,

170 
´oûssÜid_t
 
­rsid
 = 
PBIND_NONE
,

171 cÚ¡ 
u£_¦i
 = 0);

172 
	mvœtu®
 ~
æush”_t
();

174 
šlše
 
	$’queue_toæush
(
Œx_»que¡_t
* 
¬eq
)

176 
_ba£_toæush
->
	`push
(
¬eq
,
Œue
);

179 
	`¡©i¡ics
();

181 
	}
};

185 
EXIT_NAMESPACE
(
shÜe
);

	@include/sm/shore/shore_helper_loader.h

31 #iâdeà
__SHORE_HELPER_LOADER_H


32 
	#__SHORE_HELPER_LOADER_H


	)

34 
	~"sm_vas.h
"

35 
	~"ut.h
"

37 
	~"sm/shÜe/shÜe_bË_mª.h
"

40 
ENTER_NAMESPACE
(
shÜe
);

43 
şass
 
	gShÜeEnv
;

55 şas 
	cdb_š™_smt_t
 : 
public
 
th»ad_t


57 
´iv©e
:

58 
ShÜeEnv
* 
_’v
;

59 
	m_rv
;

61 
	mpublic
:

63 
db_š™_smt_t
(
c_¡r
 
Šame
, 
ShÜeEnv
* 
db
);

64 ~
db_š™_smt_t
();

65 
wÜk
();

66 
rv
();

80 şas 
	cdb_log_smt_t
 : 
public
 
th»ad_t


82 
´iv©e
:

83 
ShÜeEnv
* 
_’v
;

84 
	m_rv
;

86 
	mpublic
:

88 
	$db_log_smt_t
(
c_¡r
 
Šame
, 
ShÜeEnv
* 
db
)

89 : 
	`th»ad_t
(
Šame
), 
	$_’v
(
db
)

91 
	`as£¹
 (
_’v
);

94 ~
	$db_log_smt_t
(è{ 
	}
}

97 
wÜk
();

99 
šlše
 
	$rv
(è{  (
_rv
); 
	}
}

114 şas 
	cdb_lßd_smt_t
 : 
public
 
th»ad_t


116 
´iv©e
:

117 
ShÜeEnv
* 
_’v
;

118 
	m_rv
;

120 
	mpublic
:

122 
	$db_lßd_smt_t
(
c_¡r
 
Šame
, 
ShÜeEnv
* 
db
)

123 : 
	`th»ad_t
(
Šame
), 
	$_’v
(
db
)

125 
	`as£¹
 (
_’v
);

128 ~
	$db_lßd_smt_t
(è{ 
	}
}

131 
wÜk
();

132 
šlše
 
	$rv
(è{  (
_rv
); 
	}
}

133 
w_rc_t
 
	g_rc
;

148 şas 
	cbË_lßdšg_smt_t
 : 
public
 
th»ad_t


150 
´Ùeùed
:

152 
ss_m
* 
_pssm
;

153 
bË_desc_t
* 
	m_±abË
;

154 cÚ¡ 
	m_sf
;

155 cÚ¡ * 
	m_d©adœ
;

156 
	m_rv
;

158 
	mpublic
:

160 
	$bË_lßdšg_smt_t
(
c_¡r
 
Šame
, 
ss_m
* 
assm
,

161 
bË_desc_t
* 
©abË
,

162 cÚ¡ 
asf
, cÚ¡ * 
ad©adœ
)

163 : 
	`th»ad_t
(
Šame
), 
	`_pssm
(
assm
), 
	`_±abË
(
©abË
),

164 
	`_sf
(
asf
), 
	$_d©adœ
(
ad©adœ
)

166 
	`as£¹
 (
_pssm
);

167 
	`as£¹
 (
_±abË
);

168 
	`as£¹
 (
_sf
);

169 
	`as£¹
 (
_d©adœ
);

172 
vœtu®
 ~
	$bË_lßdšg_smt_t
(è{ 
	}
}

175 
vœtu®
 
wÜk
()=0;

176 
šlše
 
	$rv
(è{  (
_rv
); 
	}
}

177 
šlše
 
bË_desc_t
* 
	$bË
(è{  (
_±abË
); 
	}
}

196 
	g‹m¶©e
 <
şass
 
	gTabËDesc
>

197 şas 
	cšdex_lßdšg_smt_t
 : 
public
 
th»ad_t


199 
bË_row_t
 
	tbË_tu¶e
;

200 
	mbË_mª_im¶
<
	tTabËDesc
> 
	tbË_mªag”
;

202 
	m´iv©e
:

204 
ss_m
* 
_pssm
;

205 
bË_mªag”
* 
	m_pmªag”
;

206 
šdex_desc_t
* 
	m_pšdex
;

207 
	m_t_couÁ
;

208 
	m_rv
;

211 
	mpublic
:

213 
bË_tu¶e
* 
_±u¶e
;

214 
mcs_lock
 
	m_cs_mu‹x
;

216 
boŞ
 
	m_has_to_cÚsume
;

217 
boŞ
 
	m_¡¬t
;

218 
boŞ
 
	m_fšish
;

221 
	$šdex_lßdšg_smt_t
(
c_¡r
 
Šame
, 
ss_m
* 
assm
, 
bË_mªag”
* 
­bË_mªag”
,

222 
šdex_desc_t
* 
­šdex
, 
bË_tu¶e
* 
­tu¶e
)

223 : 
	`th»ad_t
(
Šame
), 
	`_pssm
(
assm
), 
	`_pmªag”
(
­bË_mªag”
),

224 
	`_pšdex
(
­šdex
), 
	`_t_couÁ
(0), 
	`_±u¶e
(
­tu¶e
),

225 
	`_has_to_cÚsume
(
çl£
), 
	`_¡¬t
(çl£), 
	$_fšish
(
çl£
)

227 
	`as£¹
 (
_pssm
);

228 
	`as£¹
 (
_pmªag”
);

229 
	`as£¹
 (
_pšdex
);

230 
	`as£¹
 (
_±u¶e
);

233 ~
	$šdex_lßdšg_smt_t
()

235 
	}
}

237 
šlše
 
	$rv
(è{  (
_rv
); 
	}
}

239 
w_rc_t
 
	$do_h–p
()

241 
	`as£¹
 (
_pmªag”
);

242 
	`as£¹
 (
_pšdex
);

244 * 
pde¡
 = 
NULL
;

245 
bufsz
 = 0;

246 
key_sz
 = 0;

247 
m¬k
 = 
COMMIT_ACTION_COUNT
;

248 
boŞ
 
cÚs_h­³Ãd
 = 
çl£
;

249 
i¥š
 = 0;

251 
	`CRITICAL_SECTION
(
hcs
, &
_cs_mu‹x
);

252 
hcs
.
	`·u£
();

254 !
_¡¬t
) {

255 
i¥š
++;

258 
	`W_DO
(
_pssm
->
	`begš_xù
());

260 
Œue
) {

263 
hcs
.
	`»sume
();

265 ià(
_has_to_cÚsume
) {

269 ià(
_fšish
)

274 
key_sz
 = 
_pmªag”
->
	`fÜm©_key
(
_pšdex
, 
_±u¶e
, *_±u¶e->
_»p
);

275 
	`as£¹
 (
pde¡
);

277 
²um
 = 
_pmªag”
->
	`g‘_²um
(
_pšdex
, 
_±u¶e
);

278 
	`W_DO
(
_pssm
->
	`ü—‹_assoc
(
_pšdex
->
	`fid
(
²um
),

279 
	`vec_t
(
pde¡
, 
key_sz
),

280 
	`vec_t
(&(
_±u¶e
->
_rid
), (
rid_t
))));

282 
_has_to_cÚsume
 = 
çl£
;

283 
cÚs_h­³Ãd
 = 
Œue
;

286 
hcs
.
	`·u£
();

289 ià(
cÚs_h­³Ãd
) {

291 
_t_couÁ
++;

293 ià(
_t_couÁ
 >ğ
m¬k
) {

294 
	`W_DO
(
_pssm
->
	`comm™_xù
());

296 ià((
_t_couÁ
 % 100000) == 0) {

297 
	`TRACE
Ğ
TRACE_ALWAYS
, "index(%s): %d\n",

298 
_pšdex
->
	`Çme
(), 
_t_couÁ
);

301 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "index(%s): %d\n",

302 
_pšdex
->
	`Çme
(), 
_t_couÁ
);

305 
	`W_DO
(
_pssm
->
	`begš_xù
());

306 
m¬k
 +ğ
COMMIT_ACTION_COUNT
;

308 
cÚs_h­³Ãd
 = 
çl£
;

312 
	`W_DO
(
_pssm
->
	`comm™_xù
());

315  (
RCOK
);

316 
	}
}

320 
	$wÜk
() {

321 
w_rc_t
 
e
 = 
	`do_h–p
();

322 ià(
e
.
	`is_”rÜ
()) {

323 
	`TRACE
Ğ
TRACE_ALWAYS
, "Index (%s)†oading‡borted [0x%x]\n",

324 
_pšdex
->
	`Çme
(), 
e
.
	`”r_num
());

326 
œ‘r›s
 = 0;

327 
w_rc_t
 
ab¹_rc
 = 
_pssm
->
	`abÜt_xù
();

329 !
ab¹_rc
.
	`is_”rÜ
()) {

330 
œ‘r›s
++;

331 
ab¹_rc
 = 
_pssm
->
	`abÜt_xù
();

332 ià(
œ‘r›s
 > 
SHORE_NUM_OF_RETRIES
)

336 
_rv
 = 1;

341 
	`as£¹
 (
_fšish
);

344 
_rv
 = 0;

345 
	}
}

347 
	$couÁ
(è{  (
_t_couÁ
); 
	}
}

362 şas 
	cbË_checkšg_smt_t
 : 
public
 
th»ad_t


364 
´Ùeùed
:

366 
ss_m
* 
_pssm
;

367 
bË_desc_t
* 
	m_±abË
;

369 
	mpublic
:

371 
	$bË_checkšg_smt_t
(
c_¡r
 
Šame
, 
ss_m
* 
pssm
,

372 
bË_desc_t
* 
©abË
)

373 : 
	`th»ad_t
(
Šame
), 
	`_pssm
(
pssm
), 
	$_±abË
(
©abË
)

375 
	`as£¹
 (
_pssm
);

376 
	`as£¹
 (
_±abË
);

379 
vœtu®
 ~
	$bË_checkšg_smt_t
(è{ 
	}
}

382 
vœtu®
 
wÜk
()=0;

387 
	g‹m¶©e
 <
şass
 
	gTabËDesc
>

388 şas 
	cbË_checkšg_smt_im¶
 : 
public
 
bË_checkšg_smt_t


390 
bË_row_t
 
	tbË_tu¶e
;

391 
	mbË_mª_im¶
<
	tTabËDesc
> 
	tbË_mªag”
;

393 
	m´iv©e
:

395 
bË_mªag”
* 
_pmªag”
;

397 
	mpublic
:

399 
bË_checkšg_smt_im¶
(
c_¡r
 
Šame
, 
ss_m
* 
pssm
,

400 
bË_mª_im¶
<
TabËDesc
>* 
amªag”
,

401 
bË_desc_t
* 
©abË
)

402 : 
bË_checkšg_smt_t
(
Šame
, 
pssm
, 
©abË
), 
	$_pmªag”
(
amªag”
)

404 
	`as£¹
 (
_pmªag”
);

407 ~
	$bË_checkšg_smt_im¶
(è{ 
	}
}

410 
	$wÜk
() {

411 
	`TRACE
Ğ
TRACE_DEBUG
, "Checkšg (%s)\n", 
_±abË
->
	`Çme
());

414 
w_rc_t
 
e
 = 
_pmªag”
->
	`check_®l_šdexes_tog‘h”
(
_pssm
);

415 ià(
e
.
	`is_”rÜ
()) {

416 
	`TRACE
Ğ
TRACE_DEBUG
, "IncÚsi¡’cy iÀ(%s)\n", 
_±abË
->
	`Çme
());

419 
	`TRACE
Ğ
TRACE_DEBUG
, "(%sèOK...\n", 
_±abË
->
	`Çme
());

421 
	}
}

436 şas 
	cşo£_smt_t
 : 
public
 
th»ad_t
 {

437 
´iv©e
:

438 
ShÜeEnv
* 
_’v
;

440 
	mpublic
:

441 
_rv
;

443 
	$şo£_smt_t
(
ShÜeEnv
* 
’v
, 
c_¡r
 
Šame
)

444 : 
	`th»ad_t
(
Šame
),

445 
	`_’v
(
’v
), 
	$_rv
(0)

449 ~
	$şo£_smt_t
() {

450 
	}
}

452 
wÜk
();

457 
šlše
 
	$»tv®
(è{  (
_rv
); 
	}
}

472 şas 
	cdump_smt_t
 : 
public
 
th»ad_t


474 
´iv©e
:

475 
ShÜeEnv
* 
_’v
;

477 
	mpublic
:

478 
_rv
;

480 
	$dump_smt_t
(
ShÜeEnv
* 
’v
, 
c_¡r
 
Šame
)

481 : 
	`th»ad_t
(
Šame
),

482 
	`_’v
(
’v
), 
	$_rv
(0)

486 ~
	$dump_smt_t
() {

487 
	}
}

489 
wÜk
();

494 
šlše
 
	$»tv®
(è{  (
_rv
); 
	}
}

509 şas 
	cabÜt_smt_t
 : 
public
 
th»ad_t


511 
´iv©e
:

512 
ShÜeEnv
* 
_’v
;

514 
	mpublic
:

516 
veùÜ
<
xù_t
*>* 
_tßbÜt
;

517 
ušt
 
	m_abÜ‹d
;

519 
abÜt_smt_t
(
c_¡r
 
Šame
, 
ShÜeEnv
* 
’v
, 
veùÜ
<
xù_t
*>& 
tßbÜt
);

520 ~
abÜt_smt_t
();

521 
wÜk
();

527 
EXIT_NAMESPACE
(
shÜe
);

	@include/sm/shore/shore_index.h

36 #iâdeà
__SHORE_INDEX_H


37 
	#__SHORE_INDEX_H


	)

39 
	~"sm_vas.h
"

40 
	~"ut.h
"

42 
	~"sm/shÜe/shÜe_”rÜ.h
"

43 
	~"sm/shÜe/shÜe_fe_desc.h
"

44 
	~"sm/shÜe/shÜe_™”.h
"

47 
ENTER_NAMESPACE
(
shÜe
);

50 
şass
 
	gbË_desc_t
;

64 şas 
	cšdex_desc_t


66 
ä›nd
 
şass
 
	mbË_desc_t
;

68 
	m´iv©e
:

69 
fe_desc_t
 
_ba£
;

71 
ušt
* 
	m_key
;

72 
boŞ
 
	m_unique
;

73 
boŞ
 
	m_´im¬y
;

74 
boŞ
 
	m_nŞock
;

75 
ušt
 
	m_mr
;

76 
boŞ
 
	m_ÏtchËss
;

77 
boŞ
 
	m_rm­hŞd”
;

79 
šdex_desc_t
* 
	m_Ãxt
;

81 
	m_keydesc
[
MAX_KEYDESC_LEN
];

82 
s_lock
 
	m_keydesc_lock
;

83 vŞ©
ušt_t
 
	m_maxkeysize
;

88 
	m_·¹™iÚ_couÁ
;

89 
¡id_t
* 
	m_·¹™iÚ_¡ids
;

91 
	mpublic
:

97 
šdex_desc_t
(cÚ¡ * 
Çme
, cÚ¡ 
f›ldút
,

98 
·¹™iÚs
, cÚ¡ 
ušt
* 
f›lds
,

99 
boŞ
 
unique
=
Œue
, boŞ 
´im¬y
=
çl£
,

100 cÚ¡ 
ušt4_t
& 
pd
=
PD_NORMAL
,

101 
boŞ
 
rm­hŞd”
=
çl£
);

103 ~
šdex_desc_t
();

110 cÚ¡ * 
	$Çme
(ècÚ¡ {  
_ba£
.
	`Çme
(); }

111 
ušt_t
 
	$f›ld_couÁ
(ècÚ¡ {  
_ba£
.
	`f›ld_couÁ
(); 
	}
}

119 
šlše
 
w_rc_t
 
	$check_fid
(
ss_m
* 
db
) {

120 if(!
	`is_·¹™iÚed
())

121  
_ba£
.
	`check_fid
(
db
);

124 
i
=0; i < 
_·¹™iÚ_couÁ
; i++) {

125 ià(!
	`is_fid_v®id
(
i
)) {

126 ià(!
_ba£
.
	`is_roÙ_v®id
())

127 
	`W_DO
(
_ba£
.
	`fšd_roÙ_iid
(
db
));

128 
	`W_DO
(
	`fšd_fid
(
db
, 
i
));

131  (
RCOK
);

132 
	}
}

134 
	g¡id_t
& 
	$fid
(cÚ¡ 
²um
) {

135 
	`as£¹
(
²um
 >ğ0 &&…num < 
_·¹™iÚ_couÁ
);

136  
	`is_·¹™iÚed
()? 
_·¹™iÚ_¡ids
[
²um
] : 
_ba£
.
	`fid
();

137 
	}
}

138 
w_rc_t
 
fšd_fid
(
ss_m
* 
db
, 
²um
);

140 
boŞ
 
	$is_fid_v®id
(
²um
) const {

141 
	`as£¹
(
²um
 >ğ0 &&…num < 
_·¹™iÚ_couÁ
);

142  
	`is_·¹™iÚed
()? 
_·¹™iÚ_¡ids
[
²um
] !ğ
¡id_t
::
nuÎ
 : 
_ba£
.
	`is_fid_v®id
();

143 
	}
}

144 
£t_fid
(cÚ¡ 
²um
, 
¡id_t
 cÚ¡ &
fid
);

150 
ušt4_t
 
	$g‘_pd
(ècÚ¡ {  (
_ba£
.
	`g‘_pd
()); 
	}
}

151 
šlše
 
boŞ
 
	$is_unique
(ècÚ¡ {  (
_unique
); 
	}
}

152 
šlše
 
boŞ
 
	$is_´im¬y
(ècÚ¡ {  (
_´im¬y
); 
	}
}

153 
šlše
 
boŞ
 
	$is_»Ïxed
(ècÚ¡ {  (
_nŞock
); 
	}
}

154 
šlše
 
boŞ
 
	$is_mr
(ècÚ¡ {  (
_mr
); 
	}
}

155 
šlše
 
boŞ
 
	$is_ÏtchËss
(ècÚ¡ {  (
_ÏtchËss
); 
	}
}

156 
šlše
 
boŞ
 
	$is_rm­hŞd”
(ècÚ¡ {  (
_rm­hŞd”
); 
	}
}

157 
šlše
 
boŞ
 
	$is_·¹™iÚed
(ècÚ¡ {  
_·¹™iÚ_couÁ
 > 1; 
	}
}

159 
šlše
 
	$g‘_·¹™iÚ_couÁ
(ècÚ¡ {  
_·¹™iÚ_couÁ
; 
	}
}

160 
šlše
 
	$g‘_keysize
(è{  (*&
_maxkeysize
); 
	}
}

161 
šlše
 
	$£t_keysize
(cÚ¡ 
ušt_t
 
sz
è{ 
	`©omic_sw­_ušt
(&
_maxkeysize
, sz); 
	}
}

168 
šdex_desc_t
* 
	$Ãxt
() const;

171 
	$šdex_couÁ
() const;

174 
	`š£¹
(
šdex_desc_t
* 
Ãw_node
);

177 
šdex_desc_t
* 
	`fšd_by_Çme
(cÚ¡ * 
Çme
);

179 
	$key_šdex
(cÚ¡ 
ušt_t
 
šdex
) const;

186 
	`´št_desc
(
o¡»am
& 
os
);

188 
	}
};

192 
EXIT_NAMESPACE
(
shÜe
);

	@include/sm/shore/shore_iter.h

33 #iâdeà
__SHORE_ITER_H


34 
	#__SHORE_ITER_H


	)

36 
	~"sm_vas.h
"

37 
	~"ut.h
"

39 
	~"sm/shÜe/shÜe_”rÜ.h
"

40 
	~"sm/shÜe/shÜe_fe_desc.h
"

41 
	~"sm/shÜe/shÜe_šdex.h
"

44 
ENTER_NAMESPACE
(
shÜe
);

55 şas 
	csim¶e_bË_™”_t


57 
	m´Ùeùed
:

58 
ss_m
* 
_db
;

59 
boŞ
 
	m_İ’ed
;

60 
fe_desc_t
* 
	m_fe
;

61 
lock_mode_t
 
	m_lm
;

63 
	mgu¬d
<
	msÿn_fe_i
> 
	m_sÿÂ”
;

65 
	mpublic
:

67 
sim¶e_bË_™”_t
(
ss_m
* 
db
, 
fe_desc_t
* 
fe
, 
lock_mode_t
 
®m
);

68 ~
sim¶e_bË_™”_t
();

70 
boŞ
 
	$İ’ed
(ècÚ¡ {  (
_İ’ed
); }

72 
w_rc_t
 
	`İ’_sÿn
();

74 
w_rc_t
 
	`Ãxt
(
boŞ
& 
eof
, 
pš_i
*& 
hªdË
);

76 
w_rc_t
 
	`şo£_sÿn
();

78 
pš_i
* 
	`cursÜ
();

80 
	}
};

92 
şass
 
	gšdex_desc_t
;

94 şas 
	csim¶e_šdex_™”_t


96 
	m´Ùeùed
:

97 
ss_m
* 
_db
;

98 
boŞ
 
	m_İ’ed
;

99 
šdex_desc_t
* 
	m_idx
;

100 
lock_mode_t
 
	m_lm
;

102 
ušt
 
	m_²um
;

104 
	mgu¬d
<
	msÿn_šdex_i
> 
	m_sÿÂ”
;

106 
	mpublic
:

108 
sim¶e_šdex_™”_t
(
ss_m
* 
db
, 
šdex_desc_t
* 
fe
, 
lock_mode_t
 
®m
);

109 ~
sim¶e_šdex_™”_t
();

111 
boŞ
 
	$İ’ed
(ècÚ¡ {  (
_İ’ed
); }

113 
w_rc_t
 
	`İ’_sÿn
(
ušt
 
²um
,

114 
sÿn_šdex_i
::
cmp_t
 
c1
, cÚ¡ 
cvec_t
& 
bound1
,

115 
sÿn_šdex_i
::
cmp_t
 
c2
, cÚ¡ 
cvec_t
& 
bound2
);

117 
w_rc_t
 
	`Ãxt
(
boŞ
& 
eof
, 
rid_t
& 
rid
);

119 
w_rc_t
 
	`şo£_sÿn
();

121 
	}
};

134 
	g‹m¶©e
 <
şass
 
	gfe_desc
, cÏs 
	gfe_sÿÂ”
, cÏs 
	growpoš‹r
>

135 şas 
	ctu¶e_™”_t


137 
	m´Ùeùed
:

138 
ss_m
* 
_db
;

139 
boŞ
 
	m_İ’ed
;

140 
fe_desc
* 
	m_fe
;

141 
fe_sÿÂ”
* 
	m_sÿn
;

143 
lock_mode_t
 
	m_lm
;

144 
boŞ
 
	m_shouldd–‘e
;

146 
	mpublic
:

148 
	$tu¶e_™”_t
(
ss_m
* 
db
, 
fe_desc
* 
fe
,

149 
lock_mode_t
 
®m
, 
boŞ
 
shouldd–‘e
)

151 : 
	`_db
(
db
), 
	`_İ’ed
(
çl£
), 
	`_fe
(
fe
), 
	`_sÿn
(
NULL
),

152 
	`_lm
(
®m
), 
	$_shouldd–‘e
(
shouldd–‘e
)

154 
	`as£¹
 (
_db
);

157 
vœtu®
 ~
	$tu¶e_™”_t
(è{ 
	`şo£_sÿn
(); 
	}
}

160 
boŞ
 
	$İ’ed
(ècÚ¡ {  (
_İ’ed
); 
	}
}

169 
vœtu®
 
w_rc_t
 
Ãxt
(
ss_m
* 
db
, 
boŞ
& 
eof
, 
rowpoš‹r
& 
tu¶e
)=0;

171 
w_rc_t
 
	$şo£_sÿn
() {

172 ià((
_İ’ed
è&& (
_shouldd–‘e
)) {

174 
	`as£¹
 (
_sÿn
);

175 
	`d–‘e
 (
_sÿn
);

176 
_sÿn
 = 
NULL
;

178 
_İ’ed
 = 
çl£
;

179  (
RCOK
);

180 
	}
}

186 
EXIT_NAMESPACE
(
shÜe
);

	@include/sm/shore/shore_msg.h

33 #iâdeà
__SHORE_MSG_H


34 
	#__SHORE_MSG_H


	)

36 
	~"ut.h
"

38 
ENTER_NAMESPACE
(
shÜe
);

43 
	sMes§ge
 {

44 
Mes§ge
ĞcÚ¡ * 
s
 ) {

45 
	mcout
 << "SHORE: " << 
	ms
 << 
	m’dl
;

47 
Mes§ge
ĞcÚ¡ * 
pfx
, cÚ¡ * 
s
 ) {

48 
	mcout
 << "SHORE: " << 
	mpfx
 << 
	ms
 << 
	m’dl
;

52 
	#PFX_MESSAGE
(
pfx
,
s
è{ 
Mes§ge
 
msg
 ## 
	`__LINE__
 (Õfx),(s)); }

	)

53 
	#MESSAGE
(
s
è{ 
Mes§ge
 
msg
 ## 
	`__LINE__
 ((s)); }

	)

54 
	#NEWO_MESSAGE
(
s
è{ 
Mes§ge
 
msg
 ## 
	`__LINE__
 ("APP:NO: ",(s)); }

	)

55 
	#PAY_MESSAGE
(
s
è{ 
Mes§ge
 
msg
 ## 
	`__LINE__
 ("APP:PAY: ",(s)); }

	)

56 
	#SLEV_MESSAGE
(
s
è{ 
Mes§ge
 
msg
 ## 
	`__LINE__
 ("APP:SL: ",(s)); }

	)

57 
	#DELV_MESSAGE
(
s
è{ 
Mes§ge
 
msg
 ## 
	`__LINE__
 ("APP:DEL: ",(s)); }

	)

58 
	#ORDS_MESSAGE
(
s
è{ 
Mes§ge
 
msg
 ## 
	`__LINE__
 ("APP:OS: ",(s)); }

	)

61 
EXIT_NAMESPACE
(
shÜe
);

	@include/sm/shore/shore_reqs.h

32 #iâdeà
__SHORE_REQS_H


33 
	#__SHORE_REQS_H


	)

36 
	~"sm_vas.h
"

37 
	~"ut.h
"

40 
ENTER_NAMESPACE
(
shÜe
);

43 cÚ¡ 
	gNO_VALID_TRX_ID
 = -1;

53 
	eTrxS‹
 { 
	mUNDEF
 = 0x0,

54 
	mUNSUBMITTED
 = 0x1,

55 
	mSUBMITTED
 = 0x2,

56 
	mPOISSONED
 = 0x4,

57 
	mCOMMITTED
 = 0x8,

58 
	mROLLBACKED
 = 0x10

70 şas 
	cŒx_»suÉ_tu¶e_t


72 
	m´iv©e
:

74 
TrxS‹
 
R_STATE
;

75 
	mR_ID
;

76 
cÚdex
* 
	m_nÙify
;

78 
	mpublic
:

80 
	$Œx_»suÉ_tu¶e_t
(è{ 
	`»£t
(
UNDEF
, -1, 
NULL
); }

82 
	$Œx_»suÉ_tu¶e_t
(
TrxS‹
 
aTrxS‹
, 
ªID
, 
cÚdex
* 
­cx
 = 
NULL
) {

83 
	`»£t
(
aTrxS‹
, 
ªID
, 
­cx
);

84 
	}
}

86 ~
	$Œx_»suÉ_tu¶e_t
(è{ 
	}
}

89 
	$Œx_»suÉ_tu¶e_t
(cÚ¡ 
Œx_»suÉ_tu¶e_t
& 
t
) {

90 
	`»£t
(
t
.
R_STATE
,.
R_ID
,.
_nÙify
);

91 
	}
}

94 
	gŒx_»suÉ_tu¶e_t
& 
	gİ”©Ü
=(cÚ¡ 
Œx_»suÉ_tu¶e_t
& 
t
) {

95 
»£t
(
t
.
R_STATE
,.
R_ID
,.
_nÙify
);

96  (*
	gthis
);

100 
ä›nd
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
Œx_»suÉ_tu¶e_t
& 
t
,

101 cÚ¡ 
	gŒx_»suÉ_tu¶e_t
& 
	gs
)

103  ((
	gt
.
	gR_STATE
 =ğ
s
.
R_STATE
è&& (
t
.
R_ID
 == s.R_ID));

108 
cÚdex
* 
	$g‘_nÙify
(ècÚ¡ {  (
_nÙify
); 
	}
}

109 
	$£t_nÙify
(
cÚdex
* 
nÙify
è{ 
_nÙify
 =‚Ùify; 
	}
}

111 
	$g‘_id
(ècÚ¡ {  (
R_ID
); 
	}
}

112 
	$£t_id
(cÚ¡ 
aID
è{ 
R_ID
 =‡ID; 
	}
}

114 
TrxS‹
 
	$g‘_¡©e
(è{  (
R_STATE
); 
	}
}

115 
	$£t_¡©e
(
TrxS‹
 
aS‹
) {

116 
	`as£¹
 ((
aS‹
 >ğ
UNDEF
è&& (aS‹ <ğ
ROLLBACKED
));

117 
R_STATE
 = 
aS‹
;

118 
	}
}

120 
	$»£t
(
TrxS‹
 
aTrxS‹
, 
ªID
, 
cÚdex
* 
nÙify
) {

122 
	`as£¹
 ((
aTrxS‹
 >ğ
UNDEF
è&& (aTrxS‹ <ğ
ROLLBACKED
));

123 
	`as£¹
 (
ªID
 >ğ
NO_VALID_TRX_ID
);

125 
R_STATE
 = 
aTrxS‹
;

126 
R_ID
 = 
ªID
;

127 
_nÙify
 = 
nÙify
;

128 
	}
}

142 
	sba£_»que¡_t


145 
xù_t
* 
	m_xù
;

146 
tid_t
 
	m_tid
;

147 
	m_xù_id
;

148 
Œx_»suÉ_tu¶e_t
 
	m_»suÉ
;

150 
ba£_»que¡_t
()

151 : 
_xù
(
NULL
),
_xù_id
(-1)

154 
ba£_»que¡_t
(
xù_t
* 
pxù
, cÚ¡ 
tid_t
& 
©id
, cÚ¡ 
axùid
,

155 cÚ¡ 
Œx_»suÉ_tu¶e_t
& 
¬esuÉ
)

156 : 
_xù
(
pxù
),
_tid
(
©id
),
_xù_id
(
axùid
),
_»suÉ
(
¬esuÉ
)

158 
as£¹
 (
pxù
);

161 ~
ba£_»que¡_t
()

163 
	m_xù
 = 
NULL
;

167 
šlše
 
£t
(
xù_t
* 
pxù
, cÚ¡ 
tid_t
& 
©id
, cÚ¡ 
axùid
,

168 cÚ¡ 
Œx_»suÉ_tu¶e_t
& 
¬esuÉ
)

170 
	m_xù
 = 
pxù
;

171 
	m_tid
 = 
©id
;

172 
	m_xù_id
 = 
axùid
;

173 
	m_»suÉ
 = 
¬esuÉ
;

176 
šlše
 
xù_t
* 
xù
(è{  (
	m_xù
); }

177 
šlše
 
tid_t
 
tid
(ècÚ¡ {  (
	m_tid
); }

178 
šlše
 
xù_id
(ècÚ¡ {  (
	m_xù_id
); }

180 
nÙify_ş›Á
();

182 
l¢_t
 
	m_my_Ï¡_l¢
;

183 
šlše
 
£t_Ï¡_l¢
(cÚ¡ 
l¢_t
& 
®¢
è{ 
	m_my_Ï¡_l¢
 =‡lsn; }

184 
šlše
 
l¢_t
 
my_Ï¡_l¢
(è{  (
	m_my_Ï¡_l¢
); }

198 
	gŒx_»que¡_t
 : 
public
 
ba£_»que¡_t


200 
_xù_ty³
;

201 
	g_¥ec_id
;

203 
Œx_»que¡_t
()

204 : 
ba£_»que¡_t
(), 
_xù_ty³
(-1),
_¥ec_id
(0)

207 
Œx_»que¡_t
(
xù_t
* 
pxù
, cÚ¡ 
tid_t
& 
©id
, cÚ¡ 
axùid
,

208 cÚ¡ 
Œx_»suÉ_tu¶e_t
& 
¬esuÉ
,

209 cÚ¡ 
axùty³
, cÚ¡ 
a¥ecid
)

210 : 
ba£_»que¡_t
(
pxù
,
©id
,
axùid
,
¬esuÉ
),

211 
_xù_ty³
(
axùty³
), 
_¥ec_id
(
a¥ecid
)

215 ~
Œx_»que¡_t
() { }

217 
£t
(
xù_t
* 
pxù
, cÚ¡ 
tid_t
& 
©id
, cÚ¡ 
axùid
,

218 cÚ¡ 
Œx_»suÉ_tu¶e_t
& 
¬esuÉ
,

219 cÚ¡ 
axùty³
, cÚ¡ 
a¥ecid
)

221 
	gba£_»que¡_t
::
£t
(
pxù
,
©id
,
axùid
,
¬esuÉ
);

222 
	g_xù_ty³
 = 
axùty³
;

223 
	g_¥ec_id
 = 
a¥ecid
;

226 
šlše
 
ty³
(ècÚ¡ {  (
	g_xù_ty³
); }

227 
šlše
 
£t_ty³
(cÚ¡ 
©y³
è{ 
	g_xù_ty³
 =‡type; }

228 
šlše
 
£ËùedID
(è{  (
	g_¥ec_id
); }

234 
EXIT_NAMESPACE
(
shÜe
);

	@include/sm/shore/shore_row.h

85 #iâdeà
__SHORE_ROW_H


86 
	#__SHORE_ROW_H


	)

89 
	~"k_defšes.h
"

90 
	~"ut.h
"

92 
	~"shÜe_f›ld.h
"

96 
ENTER_NAMESPACE
(
shÜe
);

110 
blob_poŞ
 
	t©s_ch¬_t
;

111 
šŒ_t
 
	toff£t_t
;

122 
	s»p_row_t


124 * 
	m_de¡
;

125 
ušt
 
	m_bufsz
;

126 
©s_ch¬_t
* 
	m_±s
;

129 
»p_row_t
();

130 
»p_row_t
(
©s_ch¬_t
* 
­ts
);

131 ~
»p_row_t
();

133 
£t
(cÚ¡ 
ušt
 
nsz
);

135 
£t_ts
(
©s_ch¬_t
* 
­ts
, cÚ¡ 
ušt
 
nsz
);

150 
şass
 
	gbË_desc_t
;

152 
	sbË_row_t


154 
bË_desc_t
* 
	m_±abË
;

156 
ušt
 
	m_f›ld_út
;

157 
boŞ
 
	m_is_£tup
;

159 
rid_t
 
	m_rid
;

160 
f›ld_v®ue_t
* 
	m_pv®ues
;

163 
off£t_t
 
	m_fixed_off£t
;

164 
off£t_t
 
	m_v¬_¦Ù_off£t
;

165 
off£t_t
 
	m_v¬_off£t
;

166 
ušt
 
	m_nuÎ_couÁ
;

168 
»p_row_t
* 
	m_»p
;

169 
»p_row_t
* 
	m_»p_key
;

176 
bË_row_t
();

177 
bË_row_t
(
bË_desc_t
* 
±d
)

178 : 
_±abË
(
NULL
),

179 
_f›ld_út
(0), 
_is_£tup
(
çl£
),

180 
_rid
(
rid_t
::
nuÎ
), 
_pv®ues
(
NULL
),

181 
_fixed_off£t
(0),
_v¬_¦Ù_off£t
(0),
_v¬_off£t
(0),
_nuÎ_couÁ
(0),

182 
_»p
(
NULL
), 
_»p_key
(NULL)

184 
as£¹
 (
±d
);

185 
£tup
(
±d
);

188 
	mvœtu®
 ~
bË_row_t
();

198 
£tup
(
bË_desc_t
* 
±d
);

205 
šlše
 
rid_t
 
rid
(ècÚ¡ {  (
	m_rid
); }

206 
šlše
 
£t_rid
(cÚ¡ 
rid_t
& 
rid
è{ 
	m_rid
 =„id; }

207 
šlše
 
boŞ
 
is_rid_v®id
(ècÚ¡ {  (
	m_rid
 !ğ
rid_t
::
nuÎ
); }

209 
šlše
 
off£t_t
 
g‘_fixed_off£t
(ècÚ¡ {  (
	m_fixed_off£t
); }

210 
šlše
 
off£t_t
 
g‘_v¬_¦Ù_off£t
(ècÚ¡ {  (
	m_v¬_¦Ù_off£t
); }

211 
šlše
 
off£t_t
 
g‘_v¬_off£t
(ècÚ¡ {  (
	m_v¬_off£t
); }

212 
šlše
 
ušt
 
g‘_nuÎ_couÁ
(ècÚ¡ {  (
	m_nuÎ_couÁ
); }

214 
ušt
 
size
() const;

221 
£t_nuÎ
(cÚ¡ 
ušt
 
idx
);

222 
£t_v®ue
(cÚ¡ 
ušt
 
idx
, cÚ¡ 
v
);

223 
£t_v®ue
(cÚ¡ 
ušt
 
idx
, cÚ¡ 
boŞ
 
v
);

224 
£t_v®ue
(cÚ¡ 
ušt
 
idx
, cÚ¡ 
v
);

225 
£t_v®ue
(cÚ¡ 
ušt
 
idx
, cÚ¡ 
v
);

226 
£t_v®ue
(cÚ¡ 
ušt
 
idx
, cÚ¡ 
v
);

227 
£t_v®ue
(cÚ¡ 
ušt
 
idx
, cÚ¡ 
decim®
 
v
);

228 
£t_v®ue
(cÚ¡ 
ušt
 
idx
, cÚ¡ 
time_t
 
v
);

229 
£t_v®ue
(cÚ¡ 
ušt
 
idx
, cÚ¡ 
v
);

230 
£t_v®ue
(cÚ¡ 
ušt
 
idx
, cÚ¡ * 
¡ršg
);

231 
£t_v®ue
(cÚ¡ 
ušt
 
idx
, cÚ¡ 
time¡amp_t
& 
time
);

238 
boŞ
 
g‘_v®ue
(cÚ¡ 
ušt
 
idx
, & 
de¡
) const;

239 
boŞ
 
g‘_v®ue
(cÚ¡ 
ušt
 
idx
, boŞ& 
de¡
) const;

240 
boŞ
 
g‘_v®ue
(cÚ¡ 
ušt
 
idx
, & 
de¡
) const;

241 
boŞ
 
g‘_v®ue
(cÚ¡ 
ušt
 
idx
, & 
de¡
) const;

242 
boŞ
 
g‘_v®ue
(cÚ¡ 
ušt
 
idx
, * 
de¡buf
, cÚ¡ ušˆ
bufsize
) const;

243 
boŞ
 
g‘_v®ue
(cÚ¡ 
ušt
 
idx
, & 
de¡
) const;

244 
boŞ
 
g‘_v®ue
(cÚ¡ 
ušt
 
idx
, & 
de¡
) const;

245 
boŞ
 
g‘_v®ue
(cÚ¡ 
ušt
 
idx
, 
decim®
& 
de¡
) const;

246 
boŞ
 
g‘_v®ue
(cÚ¡ 
ušt
 
idx
, 
time_t
& 
de¡
) const;

247 
boŞ
 
g‘_v®ue
(cÚ¡ 
ušt
 
idx
, 
time¡amp_t
& 
de¡
) const;

254 
´št_v®ues
(
o¡»am
& 
os
 = 
cout
);

255 
´št_tu¶e
();

256 
´št_tu¶e_no_Œacšg
();

266 
»£t
() {

267 
as£¹
 (
_is_£tup
);

268 
ušt_t
 
	mi
=0; i<
	m_f›ld_út
; i++)

269 
	m_pv®ues
[
i
].
»£t
();

272 
ä“v®ues
()

274 ià(
	m_pv®ues
) {

275 
	md–‘e
 [] 
	m_pv®ues
;

276 
	m_pv®ues
 = 
NULL
;

291 
	g‹m¶©e
<
şass
 
	gM
, cÏs 
	gT
=
bË_row_t
>

292 
	stu¶e_gu¬d
 {

293 
T
* 
±r
;

294 
M
* 
	mmªag”
;

295 
tu¶e_gu¬d
(
M
* 
m
)

296 : 
±r
(
m
->
g‘_tu¶e
()), 
mªag”
(mè{ 
as£¹
(ptr); }

297 ~
tu¶e_gu¬d
(è{ 
	mmªag”
->
give_tu¶e
(
±r
); }

298 
T
* 
	mİ”©Ü
->(è{  
	m±r
; }

299 
İ”©Ü
 
	mT
*(è{  
	m±r
; }

300 
	m´iv©e
:

302 
tu¶e_gu¬d
(tuple_guard&);

303 
	mİ”©Ü
=(
tu¶e_gu¬d
&);

323 
šlše
 
	gbË_row_t
::
	$£t_nuÎ
(cÚ¡ 
ušt
 
idx
)

325 
	`as£¹
 (
_is_£tup
);

326 
	`as£¹
 (
idx
 < 
_f›ld_út
);

327 
	`as£¹
 (
_pv®ues
[
idx
].
	`is_£tup
());

328 
_pv®ues
[
idx
].
	`£t_nuÎ
();

329 
	}
}

331 
šlše
 
	gbË_row_t
::
	$£t_v®ue
(cÚ¡ 
ušt
 
idx
, cÚ¡ 
v
)

333 
	`as£¹
 (
_is_£tup
);

334 
	`as£¹
 (
idx
 < 
_f›ld_út
);

335 
	`as£¹
 (
_pv®ues
[
idx
].
	`is_£tup
());

336 
_pv®ues
[
idx
].
	`£t_št_v®ue
(
v
);

337 
	}
}

339 
šlše
 
	gbË_row_t
::
	$£t_v®ue
(cÚ¡ 
ušt
 
idx
, cÚ¡ 
boŞ
 
v
)

341 
	`as£¹
 (
_is_£tup
);

342 
	`as£¹
 (
idx
 < 
_f›ld_út
);

343 
	`as£¹
 (
_pv®ues
[
idx
].
	`is_£tup
());

344 
_pv®ues
[
idx
].
	`£t_b™_v®ue
(
v
);

345 
	}
}

347 
šlše
 
	gbË_row_t
::
	$£t_v®ue
(cÚ¡ 
ušt
 
idx
, cÚ¡ 
v
)

349 
	`as£¹
 (
_is_£tup
);

350 
	`as£¹
 (
idx
 < 
_f›ld_út
);

351 
	`as£¹
 (
_pv®ues
[
idx
].
	`is_£tup
());

352 
_pv®ues
[
idx
].
	`£t_sm®lšt_v®ue
(
v
);

353 
	}
}

355 
šlše
 
	gbË_row_t
::
	$£t_v®ue
(cÚ¡ 
ušt
 
idx
, cÚ¡ 
v
)

357 
	`as£¹
 (
_is_£tup
);

358 
	`as£¹
 (
idx
 < 
_f›ld_út
);

359 
	`as£¹
 (
_pv®ues
[
idx
].
	`is_£tup
());

360 
_pv®ues
[
idx
].
	`£t_æßt_v®ue
(
v
);

361 
	}
}

363 
šlše
 
	gbË_row_t
::
	$£t_v®ue
(cÚ¡ 
ušt
 
idx
, cÚ¡ 
v
)

365 
	`as£¹
 (
_is_£tup
);

366 
	`as£¹
 (
idx
 < 
_f›ld_út
);

367 
	`as£¹
 (
_pv®ues
[
idx
].
	`is_£tup
());

368 
_pv®ues
[
idx
].
	`£t_lÚg_v®ue
(
v
);

369 
	}
}

371 
šlše
 
	gbË_row_t
::
	$£t_v®ue
(cÚ¡ 
ušt
 
idx
, cÚ¡ 
decim®
 
v
)

373 
	`as£¹
 (
_is_£tup
);

374 
	`as£¹
 (
idx
 < 
_f›ld_út
);

375 
	`as£¹
 (
_pv®ues
[
idx
].
	`is_£tup
());

376 
_pv®ues
[
idx
].
	`£t_decim®_v®ue
(
v
);

377 
	}
}

379 
šlše
 
	gbË_row_t
::
	$£t_v®ue
(cÚ¡ 
ušt
 
idx
, cÚ¡ 
time_t
 
v
)

381 
	`as£¹
 (
_is_£tup
);

382 
	`as£¹
 (
idx
 < 
_f›ld_út
);

383 
	`as£¹
 (
_pv®ues
[
idx
].
	`is_£tup
());

384 
_pv®ues
[
idx
].
	`£t_time_v®ue
(
v
);

385 
	}
}

387 
šlše
 
	gbË_row_t
::
	$£t_v®ue
(cÚ¡ 
ušt
 
idx
, cÚ¡ 
v
)

389 
	`as£¹
 (
_is_£tup
);

390 
	`as£¹
 (
idx
 < 
_f›ld_út
);

391 
	`as£¹
 (
_pv®ues
[
idx
].
	`is_£tup
());

392 
_pv®ues
[
idx
].
	`£t_ch¬_v®ue
(
v
);

393 
	}
}

395 
šlše
 
	gbË_row_t
::
	$£t_v®ue
(cÚ¡ 
ušt
 
idx
, cÚ¡ * 
¡ršg
)

397 
	`as£¹
 (
_is_£tup
);

398 
	`as£¹
 (
idx
 < 
_f›ld_út
);

399 
	`as£¹
 (
_pv®ues
[
idx
].
	`is_£tup
());

401 
sqÉy³_t
 
sqÉ
 = 
_pv®ues
[
idx
].
	`f›ld_desc
()->
	`ty³
();

402 
	`as£¹
 (
sqÉ
 =ğ
SQL_VARCHAR
 || sqÉ =ğ
SQL_FIXCHAR
 );

404 
Ën
 = 
	`¡¾’
(
¡ršg
);

405 iàĞ
sqÉ
 =ğ
SQL_VARCHAR
 ) {

407 
_pv®ues
[
idx
].
	`£t_v¬_¡ršg_v®ue
(
¡ršg
, 
Ën
);

411 
_pv®ues
[
idx
].
	`£t_fixed_¡ršg_v®ue
(
¡ršg
, 
Ën
);

413 
	}
}

415 
šlše
 
	gbË_row_t
::
	$£t_v®ue
(cÚ¡ 
ušt
 
idx
, cÚ¡ 
time¡amp_t
& 
time
)

417 
	`as£¹
 (
_is_£tup
);

418 
	`as£¹
 (
idx
 < 
_f›ld_út
);

419 
	`as£¹
 (
_pv®ues
[
idx
].
	`is_£tup
());

420 
_pv®ues
[
idx
].
	`£t_v®ue
(&
time
, 0);

421 
	}
}

431 
šlše
 
boŞ
 
	gbË_row_t
::
	$g‘_v®ue
(cÚ¡ 
ušt
 
idx
,

432 & 
de¡
) const

434 
	`as£¹
 (
_is_£tup
);

435 
	`as£¹
(
idx
 < 
_f›ld_út
);

436 ià(
_pv®ues
[
idx
].
	`is_nuÎ
()) {

437 
de¡
 = 0;

438  
çl£
;

440 
de¡
 = 
_pv®ues
[
idx
].
	`g‘_št_v®ue
();

441  
Œue
;

442 
	}
}

444 
šlše
 
boŞ
 
	gbË_row_t
::
	$g‘_v®ue
(cÚ¡ 
ušt
 
idx
,

445 
boŞ
& 
de¡
) const

447 
	`as£¹
 (
_is_£tup
);

448 
	`as£¹
(
idx
 < 
_f›ld_út
);

449 ià(
_pv®ues
[
idx
].
	`is_nuÎ
()) {

450 
de¡
 = 
çl£
;

451  
çl£
;

453 
de¡
 = 
_pv®ues
[
idx
].
	`g‘_b™_v®ue
();

454  
Œue
;

455 
	}
}

457 
šlše
 
boŞ
 
	gbË_row_t
::
	$g‘_v®ue
(cÚ¡ 
ušt
 
idx
,

458 & 
de¡
) const

460 
	`as£¹
 (
_is_£tup
);

461 
	`as£¹
(
idx
 < 
_f›ld_út
);

462 ià(
_pv®ues
[
idx
].
	`is_nuÎ
()) {

463 
de¡
 = 0;

464  
çl£
;

466 
de¡
 = 
_pv®ues
[
idx
].
	`g‘_sm®lšt_v®ue
();

467  
Œue
;

468 
	}
}

470 
šlše
 
boŞ
 
	gbË_row_t
::
	$g‘_v®ue
(cÚ¡ 
ušt
 
idx
,

471 & 
de¡
) const

473 
	`as£¹
 (
_is_£tup
);

474 
	`as£¹
(
idx
 < 
_f›ld_út
);

475 ià(
_pv®ues
[
idx
].
	`is_nuÎ
()) {

476 
de¡
 = 0;

477  
çl£
;

479 
de¡
 = 
_pv®ues
[
idx
].
	`g‘_ch¬_v®ue
();

480  
Œue
;

481 
	}
}

483 
šlše
 
boŞ
 
	gbË_row_t
::
	$g‘_v®ue
(cÚ¡ 
ušt
 
idx
,

484 * 
de¡buf
,

485 cÚ¡ 
ušt
 
bufsize
) const

487 
	`as£¹
 (
_is_£tup
);

488 
	`as£¹
(
idx
 < 
_f›ld_út
);

489 ià(
_pv®ues
[
idx
].
	`is_nuÎ
()) {

490 
de¡buf
[0] = '\0';

491  (
çl£
);

494 
ušt_t
 
sz
 = 
	`MIN
(
bufsize
-1, 
_pv®ues
[
idx
].
_max_size
);

495 
_pv®ues
[
idx
].
	`g‘_¡ršg_v®ue
(
de¡buf
, 
sz
);

496 
de¡buf
[
sz
] ='\0';

497  (
Œue
);

498 
	}
}

500 
šlše
 
boŞ
 
	gbË_row_t
::
	$g‘_v®ue
(cÚ¡ 
ušt
 
idx
,

501 & 
de¡
) const

503 
	`as£¹
 (
_is_£tup
);

504 
	`as£¹
(
idx
 < 
_f›ld_út
);

505 ià(
_pv®ues
[
idx
].
	`is_nuÎ
()) {

506 
de¡
 = 0;

507  
çl£
;

509 
de¡
 = 
_pv®ues
[
idx
].
	`g‘_æßt_v®ue
();

510  
Œue
;

511 
	}
}

513 
šlše
 
boŞ
 
	gbË_row_t
::
	$g‘_v®ue
(cÚ¡ 
ušt
 
idx
,

514 & 
de¡
) const

516 
	`as£¹
 (
_is_£tup
);

517 
	`as£¹
(
idx
 < 
_f›ld_út
);

518 ià(
_pv®ues
[
idx
].
	`is_nuÎ
()) {

519 
de¡
 = 0;

520  
çl£
;

522 
de¡
 = 
_pv®ues
[
idx
].
	`g‘_lÚg_v®ue
();

523  
Œue
;

524 
	}
}

526 
šlše
 
boŞ
 
	gbË_row_t
::
	$g‘_v®ue
(cÚ¡ 
ušt
 
idx
,

527 
decim®
& 
de¡
) const

529 
	`as£¹
 (
_is_£tup
);

530 
	`as£¹
(
idx
 < 
_f›ld_út
);

531 ià(
_pv®ues
[
idx
].
	`is_nuÎ
()) {

532 
de¡
 = 
	`decim®
(0);

533  
çl£
;

535 
de¡
 = 
_pv®ues
[
idx
].
	`g‘_decim®_v®ue
();

536  
Œue
;

537 
	}
}

539 
šlše
 
boŞ
 
	gbË_row_t
::
	$g‘_v®ue
(cÚ¡ 
ušt
 
idx
,

540 
time_t
& 
de¡
) const

542 
	`as£¹
 (
_is_£tup
);

543 
	`as£¹
(
idx
 < 
_f›ld_út
);

544 ià(
_pv®ues
[
idx
].
	`is_nuÎ
()) {

545  
çl£
;

547 
de¡
 = 
_pv®ues
[
idx
].
	`g‘_time_v®ue
();

548  
Œue
;

549 
	}
}

551 
šlše
 
boŞ
 
	gbË_row_t
::
	$g‘_v®ue
(cÚ¡ 
ušt
 
idx
,

552 
time¡amp_t
& 
de¡
) const

554 
	`as£¹
 (
_is_£tup
);

555 
	`as£¹
(
idx
 < 
_f›ld_út
);

556 ià(
_pv®ues
[
idx
].
	`is_nuÎ
()) {

557  
çl£
;

559 
de¡
 = 
_pv®ues
[
idx
].
	`g‘_t¡amp_v®ue
();

560  
Œue
;

561 
	}
}

565 
EXIT_NAMESPACE
(
shÜe
);

	@include/sm/shore/shore_row_cache.h

34 #iâdeà
__SHORE_ROW_CACHE_H


35 
	#__SHORE_ROW_CACHE_H


	)

37 
	~"k_defšes.h
"

38 
	~"block_®loc.h
"

39 
	~"sm/shÜe/shÜe_row.h
"

41 
ENTER_NAMESPACE
(
shÜe
);

43 
	g‹m¶©e
 <
şass
 
	gTabËDesc
>

44 şas 
	crow_ÿche_t


46 
	mpublic
:

47 
bË_row_t
 
	tbË_tu¶e
;

49 
	stu¶e_çùÜy
 {

51 
	mTabËDesc
* &
±abË
() {

52 
TabËDesc
* 
	m_±abË
;

53  
	m_±abË
;

55 
bË_tu¶e
* 
cÚ¡ruù
(* 
±r
) {

56  
Ãw
(
±r
è
bË_tu¶e
(
±abË
());

58 
de¡roy
(
bË_tu¶e
* 
t
è{ 
	mt
->~table_tuple(); }

60 
»£t
(
bË_tu¶e
* 
t
) {

61 
as£¹
 (
t
->
_±abË
 =ğ
±abË
());

62 
	mt
->
»£t
();

67 
bË_tu¶e
* 
š™
ÑabË_tu¶e* 
t
è{  
	mt
; }

70 
	g´iv©e
:

71 
objeù_ÿche
<
	tbË_tu¶e
, 
	ttu¶e_çùÜy
> 
	tCache
;

72 
Cache
 
	g_ÿche
;

74 
	gpublic
:

78 
bË_tu¶e
* 
	$bÜrow
(è{  
_ÿche
.
	`acquœe
(); 
	}
}

84 
	$giveback
(
bË_tu¶e
* 
±n
)

86 
	`as£¹
 (
±n
);

87 
Cache
::
	`»Ëa£
(
±n
);

88 
	}
}

93 
EXIT_NAMESPACE
(
shÜe
);

	@include/sm/shore/shore_shell.h

31 #iâdeà
__SHORE_SHELL_H


32 
	#__SHORE_SHELL_H


	)

34 
	~"k_defšes.h
"

36 
	~"ut/sh–l.h
"

38 
	~"sm/shÜe/shÜe_’v.h
"

39 
	~"sm/shÜe/shÜe_h–³r_lßd”.h
"

40 
	~"sm/shÜe/shÜe_ş›Á.h
"

43 
ENTER_NAMESPACE
(
shÜe
);

48 
usšg
 
	g¡d
::
m­
;

50 "C" 
®¬m_hªdËr
(
sig
);

52 
boŞ
 vŞ©
_g_ÿnûËd
;

54 
şass
 
	gshÜe_sh–l_t
;

58 cÚ¡ 
	gDF_SF
 = 10;

59 
_theSF
;

64 cÚ¡ 
	gDF_NUM_OF_QUERIED_SF
 = 10;

67 cÚ¡ 
	gDF_TRX_ID
 = -1;

74 
	#DECLARE_ENV_CMD
(
Çme
) \

75 
Çme
##
_cmd_t
 : 
public
 
commªd_hªdËr_t
 { \

76 
ShÜeEnv
* 
_’v
; \

77 
Çme
##
	`_cmd_t
(
ShÜeEnv
* 
aEnv
è: 
	`_’v
(aEnv) { }; \

78 ~
Çme
##
	`_cmd_t
() { } \

79 
	`£lŸ£s
(); \

80 
	`hªdË
(cÚ¡ * 
cmd
); \

81 
	`u§ge
(); \

82 
¡ršg
 
	`desc
(ècÚ¡; }

	)

85 
DECLARE_ENV_CMD
(
»¡¬t
);

86 
DECLARE_ENV_CMD
(
šfo
);

87 
DECLARE_ENV_CMD
(
¡©s
);

88 
DECLARE_ENV_CMD
(
sm¡©s
);

89 
DECLARE_ENV_CMD
(
dump
);

90 
DECLARE_ENV_CMD
(
çke_iod–ay
);

91 
DECLARE_ENV_CMD
(
äeq
);

92 
DECLARE_ENV_CMD
(
skew
);

93 
DECLARE_ENV_CMD
(
db_´št
);

94 
DECLARE_ENV_CMD
(
db_ãtch
);

95 
DECLARE_ENV_CMD
(
¡©s_v”bo£
);

96 
DECLARE_ENV_CMD
(
log
);

105 
	#DECLARE_ENV_ONOFF_CMD
(
Çme
) \

106 
Çme
##
_cmd_t
 : 
public
 
commªd_hªdËr_t
 { \

107 
ShÜeEnv
* 
_’v
; \

108 
boŞ
 
_’abËd
; \

109 
Çme
##
	`_cmd_t
(
ShÜeEnv
* 
aEnv
); \

110 ~
Çme
##
	`_cmd_t
() { } \

111 
	`£lŸ£s
(); \

112 
	`hªdË
(cÚ¡ * 
cmd
); \

113 
	`u§ge
(); \

114 
¡ršg
 
	`desc
(ècÚ¡; }

	)

117 
DECLARE_ENV_ONOFF_CMD
(
asynch
);

119 
DECLARE_ENV_ONOFF_CMD
(
¦i
);

120 
DECLARE_ENV_ONOFF_CMD
(
–r
);

122 #ifdeà
CFG_BT


123 
DECLARE_ENV_ONOFF_CMD
(
bt
);

130 
	#DECLARE_ENV_VAR_CMD
(
Çme
,
v¬ty³
) \

131 
Çme
##
_cmd_t
 : 
public
 
commªd_hªdËr_t
 { \

132 
ShÜeEnv
* 
_’v
; \

133 
v¬ty³
 
_¡©e
; \

134 
Çme
##
	`_cmd_t
(
ShÜeEnv
* 
aEnv
, cÚ¡ 
v¬ty³
 
aS‹
); \

135 ~
Çme
##
	`_cmd_t
() { } \

136 
	`£lŸ£s
(); \

137 
	`hªdË
(cÚ¡ * 
cmd
); \

138 
	`u§ge
(); \

139 
¡ršg
 
	`desc
(ècÚ¡; }

	)

145 
	#DECLARE_KIT_CMD
(
Çme
) \

146 
Çme
##
_cmd_t
 : 
public
 
commªd_hªdËr_t
 { \

147 
shÜe_sh–l_t
* 
_k™
; \

148 
Çme
##
	`_cmd_t
(
shÜe_sh–l_t
* 
aK™
è: 
	`_k™
(aKit) { }; \

149 ~
Çme
##
	`_cmd_t
() { } \

150 
	`£lŸ£s
(); \

151 
	`hªdË
(cÚ¡ * 
cmd
); \

152 
	`u§ge
(); \

153 
¡ršg
 
	`desc
(ècÚ¡; }

	)

156 
DECLARE_KIT_CMD
(
m—su»
);

157 
DECLARE_KIT_CMD
(
‹¡
);

158 
DECLARE_KIT_CMD
(
w¬mup
);

159 
DECLARE_KIT_CMD
(
lßd
);

160 
DECLARE_KIT_CMD
(
Œxs
);

182 şas 
	cshÜe_sh–l_t
 : 
public
 
sh–l_t


184 
´Ùeùed
:

186 
ShÜeEnv
* 
_’v
;

188 
´oûssÜid_t
 
	m_¡¬t_´s_id
;

189 
´oûssÜid_t
 
	m_cu¼’t_´s_id
;

192 
	mm­
<,
	t¡ršg
> 
	tm­SupTrxs
;

193 
	mm­SupTrxs
::
	t™”©Ü
 
	tm­SupTrxsIt
;

194 
	mm­SupTrxs
::
	tcÚ¡_™”©Ü
 
	tm­SupTrxsCÚ¡It
;

196 
m­SupTrxs
 
	m_sup_Œxs
;

199 
	mm­
<
	teBšdšgTy³
,
	t¡ršg
> 
	tm­BšdPŞs
;

200 
	mm­BšdPŞs
::
	t™”©Ü
 
	tm­BšdPŞsIt
;

201 
m­BšdPŞs
 
	m_sup_bps
;

205 
	mgu¬d
<
	m»¡¬t_cmd_t
> 
	m_»¡¬‹r
;

206 
	mgu¬d
<
	mšfo_cmd_t
> 
	m_šfÜm”
;

207 
	mgu¬d
<
	m¡©s_cmd_t
> 
	m_¡©”
;

208 
	mgu¬d
<
	msm¡©s_cmd_t
> 
	m_sm¡©”
;

209 
	mgu¬d
<
	mdump_cmd_t
> 
	m_dum³r
;

210 
	mgu¬d
<
	mçke_iod–ay_cmd_t
> 
	m_çkeiÛr
;

211 
	mgu¬d
<
	mäeq_cmd_t
> 
	m_äeq”
;

212 
	mgu¬d
<
	mskew_cmd_t
> 
	m_skew”
;

213 
	mgu¬d
<
	m¡©s_v”bo£_cmd_t
> 
	m_¡©s_v”bo£r
;

214 
	mgu¬d
<
	mdb_´št_cmd_t
> 
	m_db_´š‹r
;

215 
	mgu¬d
<
	mdb_ãtch_cmd_t
> 
	m_db_ãtch
;

217 
	mgu¬d
<
	mlog_cmd_t
> 
	m_logg”
;

218 
	mgu¬d
<
	masynch_cmd_t
> 
	m_asynch”
;

220 
	mgu¬d
<
	m¦i_cmd_t
> 
	m_¦›r
;

221 
	mgu¬d
<
	m–r_cmd_t
> 
	m_–»r
;

223 #ifdeà
CFG_BT


224 
	mgu¬d
<
	mbt_cmd_t
> 
	m_b‹r
;

227 
	mgu¬d
<
	mm—su»_cmd_t
> 
	m_m—su»r
;

228 
	mgu¬d
<
	m‹¡_cmd_t
> 
	m_‹¡”
;

229 
	mgu¬d
<
	mw¬mup_cmd_t
> 
	m_w¬mu³r
;

230 
	mgu¬d
<
	mlßd_cmd_t
> 
	m_lßd”
;

231 
	mgu¬d
<
	mŒxs_cmd_t
> 
	m_Œx£r
;

233 
	mpublic
:

235 
shÜe_sh–l_t
(cÚ¡ * 
´om±
,

236 cÚ¡ 
boŞ
 
Ãtmode
,

237 cÚ¡ 
ÃÜt
,

238 cÚ¡ 
boŞ
 
šputfemode
,

239 cÚ¡ 
¡ršg
 
šputfe
,

240 
´oûssÜid_t
 
aıu¡¬t
 = 
PBIND_NONE
);

241 
	mvœtu®
 ~
shÜe_sh–l_t
();

244 
šlše
 
ShÜeEnv
* 
	$db
(è{ (
_’v
); }

247 
vœtu®
 
	`´e_´oûss_cmd
();

248 
vœtu®
 
	`´št_u§ge
(cÚ¡ * 
commªd
);

249 
vœtu®
 
	`SIGINT_hªdËr
();

251 
vœtu®
 
	`»gi¡”_commªds
();

255 
vœtu®
 
	`š¡_‹¡_’v
(
¬gc
, * 
¬gv
[])=0;

258 
vœtu®
 
	`lßd_Œxs_m­
()=0;

259 
vœtu®
 
	`lßd_bp_m­
()=0;

260 
	$´št_sup_Œxs
() const;

261 
	`´št_sup_bp
();

262 cÚ¡ * 
	$Œª¦©e_Œx
(cÚ¡ 
iS–eùedTrx
) const;

263 cÚ¡ * 
	`Œª¦©e_bp
(cÚ¡ 
eBšdšgTy³
 
abt
);

267 
vœtu®
 
	`´oûss_cmd_MEASURE
(cÚ¡ * 
commªd
);

268 
vœtu®
 
	`´oûss_cmd_TEST
(cÚ¡ * 
commªd
);

269 
vœtu®
 
	`´oûss_cmd_WARMUP
(cÚ¡ * 
commªd
);

270 
vœtu®
 
	`´oûss_cmd_LOAD
(cÚ¡ * 
commªd
);

276 
vœtu®
 
	`_cmd_WARMUP_im¶
(cÚ¡ 
iQu”›dSF
, cÚ¡ 
iTrxs
,

277 cÚ¡ 
iDu¿tiÚ
, cÚ¡ 
iI‹¿tiÚs
);

278 
vœtu®
 
	`_cmd_LOAD_im¶
();

280 
vœtu®
 
	`_cmd_TEST_im¶
(cÚ¡ 
iQu”›dSF
, cÚ¡ 
iS´—d
,

281 cÚ¡ 
iNumOfTh»ads
, cÚ¡ 
iNumOfTrxs
,

282 cÚ¡ 
iS–eùedTrx
, cÚ¡ 
iI‹¿tiÚs
,

283 cÚ¡ 
eBšdšgTy³
 
abt
)=0;

284 
vœtu®
 
	`_cmd_MEASURE_im¶
(cÚ¡ 
iQu”›dSF
, cÚ¡ 
iS´—d
,

285 cÚ¡ 
iNumOfTh»ads
, cÚ¡ 
iDu¿tiÚ
,

286 cÚ¡ 
iS–eùedTrx
, cÚ¡ 
iI‹¿tiÚs
,

287 cÚ¡ 
eBšdšgTy³
 
abt
)=0;

289 
vœtu®
 
w_rc_t
 
	$´•¬eNewRun
(è{  (
RCOK
); 
	}
}

292 
vœtu®
 
´oûssÜid_t
 
Ãxt_ıu
(cÚ¡ 
eBšdšgTy³
 
abt
,

293 cÚ¡ 
´oûssÜid_t
 
­rd
);

296 
	g´Ùeùed
:

298 
´št_MEASURE_šfo
(cÚ¡ 
iQu”›dSF
, cÚ¡ 
iS´—d
,

299 cÚ¡ 
iNumOfTh»ads
, cÚ¡ 
iDu¿tiÚ
,

300 cÚ¡ 
iS–eùedTrx
, cÚ¡ 
iI‹¿tiÚs
,

301 cÚ¡ 
eBšdšgTy³
 
abt
);

303 
´št_TEST_šfo
(cÚ¡ 
iQu”›dSF
, cÚ¡ 
iS´—d
,

304 cÚ¡ 
iNumOfTh»ads
, cÚ¡ 
iNumOfTrxs
,

305 cÚ¡ 
iS–eùedTrx
, cÚ¡ 
iI‹¿tiÚs
,

306 cÚ¡ 
eBšdšgTy³
 
abt
);

311 
EXIT_NAMESPACE
(
shÜe
);

	@include/sm/shore/shore_table.h

91 #iâdeà
__SHORE_TABLE_H


92 
	#__SHORE_TABLE_H


	)

95 
	~"ut.h
"

96 
	~"sm_vas.h
"

98 
	~"shÜe_msg.h
"

99 
	~"shÜe_”rÜ.h
"

100 
	~"shÜe_fe_desc.h
"

101 
	~"shÜe_toŞs.h
"

102 
	~"shÜe_f›ld.h
"

103 
	~"shÜe_šdex.h
"

104 
	~"shÜe_row.h
"

107 
ENTER_NAMESPACE
(
shÜe
);

120 şas 
	cbË_desc_t
 : 
public
 
fe_desc_t


122 
´Ùeùed
:

128 
ss_m
* 
_db
;

130 
f›ld_desc_t
* 
	m_desc
;

132 
šdex_desc_t
* 
	m_šdexes
;

133 
šdex_desc_t
* 
	m_´im¬y_idx
;

135 vŞ©
ušt_t
 
	m_maxsize
;

138 * 
	m_sMšKey
;

139 
ušt
 
	m_sMšKeyL’
;

140 * 
	m_sMaxKey
;

141 
ušt
 
	m_sMaxKeyL’
;

142 
ušt
 
	m_numP¬ts
;

144 
	$fšd_f›ld_by_Çme
(cÚ¡ * 
f›ld_Çme
) const;

146 
public
:

152 
	`bË_desc_t
(cÚ¡ * 
Çme
, 
f›ldút
, 
ušt4_t
 
pd
);

153 
vœtu®
 ~
	`bË_desc_t
();

164 
w_rc_t
 
	`£t_·¹™iÚšg
(cÚ¡ * 
sMšKey
, 
ušt
 
Ën1
,

165 cÚ¡ * 
sMaxKey
, 
ušt
 
Ën2
,

166 
ušt
 
numP¬ts
);

169 
ušt
 
	$pút
() const;

170 * 
	$g‘MšKey
() const;

171 
ušt
 
	$g‘MšKeyL’
() const;

172 * 
	$g‘MaxKey
() const;

173 
ušt
 
	$g‘MaxKeyL’
() const;

175 
w_rc_t
 
	`g‘_maš_¿ngem­
(
key_¿nges_m­
*& 
´ªgem­
);

182 
w_rc_t
 
	`ü—‹_physiÿl_bË
(
ss_m
* 
db
);

184 
w_rc_t
 
	`ü—‹_physiÿl_šdex
(
ss_m
* 
db
, 
šdex_desc_t
* 
šdex
);

186 
w_rc_t
 
	`ü—‹_physiÿl_em±y_´im¬y_idx
();

194 
boŞ
 
	`ü—‹_šdex_desc
(cÚ¡ * 
Çme
,

195 
·¹™iÚs
,

196 cÚ¡ 
ušt
* 
f›lds
,

197 cÚ¡ 
ušt
 
num
,

198 cÚ¡ 
boŞ
 
unique
=
Œue
,

199 cÚ¡ 
boŞ
 
´im¬y
=
çl£
,

200 cÚ¡ 
ušt4_t
& 
pd
=
PD_NORMAL
);

202 
boŞ
 
	`ü—‹_´im¬y_idx_desc
(cÚ¡ * 
Çme
,

203 
·¹™iÚs
,

204 cÚ¡ 
ušt
* 
f›lds
,

205 cÚ¡ 
ušt
 
num
,

206 cÚ¡ 
ušt4_t
& 
pd
=
PD_NORMAL
);

214 
šdex_desc_t
* 
	$šdexes
(è{  (
_šdexes
); }

217 
šdex_desc_t
* 
	$fšd_šdex
(cÚ¡ * 
šdex_Çme
) {

218  (
_šdexes
 ? _šdexes->
	`fšd_by_Çme
(
šdex_Çme
è: 
NULL
);

219 
	}
}

222 
	$šdex_couÁ
(è{  (
_šdexes
->
	`šdex_couÁ
()); 
	}
}

224 
šdex_desc_t
* 
	$´im¬y_idx
(è{  (
_´im¬y_idx
); 
	}
}

225 
¡id_t
 
g‘_´im¬y_¡id
();

230 
	$£t_´im¬y
(
šdex_desc_t
* 
idx
) {

231 
	`as£¹
 (
idx
->
	`is_´im¬y
(è&& idx->
	`is_unique
());

232 
_´im¬y_idx
 = 
idx
;

233 
	}
}

235 * 
šdex_keydesc
(
šdex_desc_t
* 
idx
);

236 
	$šdex_maxkeysize
(
šdex_desc_t
* 
šdex
) const;

242 
ušt_t
 
	`maxsize
();

244 
šlše
 
f›ld_desc_t
* 
	$desc
(cÚ¡ 
ušt_t
 
descidx
) {

245 
	`as£¹
 (
descidx
<
_f›ld_couÁ
);

246 
	`as£¹
 (
_desc
);

247  (&(
_desc
[
descidx
]));

248 
	}
}

253 
	$£t_db
(
ss_m
* 
db
è{ 
_db
 = db; 
	}
}

254 
ss_m
* 
	$db
(è{  (
_db
); 
	}
}

260 
´št_desc
(
o¡»am
 & 
os
 = 
cout
);

265 
	g¡d
::
	tli¡
<
	tbË_desc_t
*> 
	tbË_li¡_t
;

277 şas 
	cbË_mª_t


279 
	m´Ùeùed
:

281 
bË_desc_t
* 
_±abË
;

283 
	mgu¬d
<
	m©s_ch¬_t
> 
	m_±s
;

285 
	mpublic
:

287 
bË_row_t
 
	tbË_tu¶e
;

289 
	$bË_mª_t
(
bË_desc_t
* 
aTabËDesc
,

290 
boŞ
 
cÚ¡ruù_ÿche
=
Œue
)

291 : 
	$_±abË
(
aTabËDesc
)

294 ià(
cÚ¡ruù_ÿche
) {

296 
_±s
 = 
Ãw
 
	`©s_ch¬_t
(
_±abË
->
	`maxsize
());

300 
vœtu®
 ~
	$bË_mª_t
(è{
	}
}

302 
mcs_lock
 
	g»gi¡”_bË_lock
;

303 
»gi¡”_bË_mª
();

304 
	g¡d
::
m­
<
¡id_t
, 
	gbË_mª_t
*> 
	g¡id_to_bËmª
;

306 
bË_desc_t
* 
	$bË
(è{  (
_±abË
); 
	}
}

308 
	$g‘_²um
(
šdex_desc_t
* 
pšdex
, 
bË_tu¶e
 cÚ¡* 
±u¶e
) const;

311 
w_rc_t
 
	`lßd_ªd_»gi¡”_fid
(
ss_m
* 
db
);

317 
©s_ch¬_t
* 
	$ts
(è{ 
	`as£¹
 (
_±s
);  (_±s); 
	}
}

325 
w_rc_t
 
šdex_´obe
(
ss_m
* 
db
,

326 
šdex_desc_t
* 
pidx
,

327 
bË_tu¶e
* 
±u¶e
,

328 cÚ¡ 
lock_mode_t
 
lock_mode
 = 
SH
,

329 cÚ¡ 
Íid_t
& 
roÙ
 =†pid_t::
nuÎ
);

332 
šlše
 
w_rc_t
 
	$šdex_´obe_fÜupd©e
(
ss_m
* 
db
,

333 
šdex_desc_t
* 
pidx
,

334 
bË_tu¶e
* 
±u¶e
,

335 cÚ¡ 
Íid_t
& 
roÙ
 =†pid_t::
nuÎ
)

337  (
	`šdex_´obe
(
db
, 
pidx
, 
±u¶e
, 
EX
, 
roÙ
));

338 
	}
}

341 
šlše
 
w_rc_t
 
	$šdex_´obe_Æ
(
ss_m
* 
db
,

342 
šdex_desc_t
* 
pidx
,

343 
bË_tu¶e
* 
±u¶e
,

344 cÚ¡ 
Íid_t
& 
roÙ
 =†pid_t::
nuÎ
)

346  (
	`šdex_´obe
(
db
, 
pidx
, 
±u¶e
, 
NL
, 
roÙ
));

347 
	}
}

350 
šlše
 
w_rc_t
 
	$šdex_´obe_´im¬y
(
ss_m
* 
db
,

351 
bË_tu¶e
* 
±u¶e
,

352 
lock_mode_t
 
lock_mode
 = 
SH
,

353 cÚ¡ 
Íid_t
& 
roÙ
 =†pid_t::
nuÎ
)

355 
	`as£¹
 (
_±abË
 && _±abË->
	`´im¬y_idx
());

356  (
	`šdex_´obe
(
db
, 
_±abË
->
	`´im¬y_idx
(), 
±u¶e
, 
lock_mode
, 
roÙ
));

357 
	}
}

364 
šlše
 
w_rc_t
 
	$šdex_´obe_by_Çme
(
ss_m
* 
db
,

365 cÚ¡ * 
idx_Çme
,

366 
bË_tu¶e
* 
±u¶e
,

367 
lock_mode_t
 
lock_mode
 = 
SH
,

368 cÚ¡ 
Íid_t
& 
roÙ
 =†pid_t::
nuÎ
)

370 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
(
idx_Çme
);

371  (
	`šdex_´obe
(
db
, 
pšdex
, 
±u¶e
, 
lock_mode
, 
roÙ
));

372 
	}
}

375 
šlše
 
w_rc_t
 
	$šdex_´obe_fÜupd©e_by_Çme
(
ss_m
* 
db
,

376 cÚ¡ * 
idx_Çme
,

377 
bË_tu¶e
* 
±u¶e
,

378 cÚ¡ 
Íid_t
& 
roÙ
 =†pid_t::
nuÎ
)

380 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
(
idx_Çme
);

381  (
	`šdex_´obe_fÜupd©e
(
db
, 
pšdex
, 
±u¶e
, 
roÙ
));

382 
	}
}

385 
šlše
 
w_rc_t
 
	$šdex_´obe_Æ_by_Çme
(
ss_m
* 
db
,

386 cÚ¡ * 
idx_Çme
,

387 
bË_tu¶e
* 
±u¶e
,

388 cÚ¡ 
Íid_t
& 
roÙ
 =†pid_t::
nuÎ
)

390 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
(
idx_Çme
);

391  (
	`šdex_´obe_Æ
(
db
, 
pšdex
, 
±u¶e
, 
roÙ
));

392 
	}
}

399 
w_rc_t
 
add_tu¶e
(
ss_m
* 
db
,

400 
bË_tu¶e
* 
±u¶e
,

401 cÚ¡ 
lock_mode_t
 
lock_mode
 = 
EX
,

402 cÚ¡ 
Íid_t
& 
´im¬y_roÙ
 =†pid_t::
nuÎ
);

404 
w_rc_t
 
add_šdex_’Œy
(
ss_m
* 
db
,

405 cÚ¡ * 
idx_Çme
,

406 
bË_tu¶e
* 
±u¶e
,

407 cÚ¡ 
lock_mode_t
 
lock_mode
 = 
EX
,

408 cÚ¡ 
Íid_t
& 
´im¬y_roÙ
 =†pid_t::
nuÎ
);

410 
w_rc_t
 
add_¶p_tu¶e
(
ss_m
* 
db
,

411 
bË_tu¶e
* 
±u¶e
,

412 cÚ¡ 
lock_mode_t
 
lock_mode
,

413 cÚ¡ 
ušt
 
sy¡em_mode
,

414 cÚ¡ 
Íid_t
& 
´im¬y_roÙ
 =†pid_t::
nuÎ
);

416 
w_rc_t
 
d–‘e_tu¶e
(
ss_m
* 
db
,

417 
bË_tu¶e
* 
±u¶e
,

418 cÚ¡ 
lock_mode_t
 
lock_mode
 = 
EX
,

419 cÚ¡ 
Íid_t
& 
´im¬y_roÙ
 =†pid_t::
nuÎ
);

421 
w_rc_t
 
d–‘e_šdex_’Œy
(
ss_m
* 
db
,

422 cÚ¡ * 
idx_Çme
,

423 
bË_tu¶e
* 
±u¶e
,

424 cÚ¡ 
lock_mode_t
 
lock_mode
 = 
EX
,

425 cÚ¡ 
Íid_t
& 
´im¬y_roÙ
 =†pid_t::
nuÎ
);

429 
w_rc_t
 
upd©e_tu¶e
(
ss_m
* 
db
,

430 
bË_tu¶e
* 
±u¶e
,

431 cÚ¡ 
lock_mode_t
 
lock_mode
 = 
EX
);

434 
w_rc_t
 
»ad_tu¶e
(
bË_tu¶e
* 
±u¶e
,

435 
lock_mode_t
 
lock_mode
 = 
SH
,

436 
Ïtch_mode_t
 
h—p_Ïtch_mode
 = 
LATCH_SH
);

445 
fÜm©
(
bË_tu¶e
* 
±u¶e
, 
»p_row_t
 &
¬•
);

448 
boŞ
 
lßd
(
bË_tu¶e
* 
±u¶e
, cÚ¡ * 
¡ršg
);

451 
	$size
(
bË_tu¶e
* 
±u¶e
) const;

454 
	`fÜm©_key
(
šdex_desc_t
* 
pšdex
,

455 
bË_tu¶e
* 
±u¶e
,

456 
»p_row_t
 &
¬•
);

459 
boŞ
 
	`lßd_key
(cÚ¡ * 
¡ršg
,

460 
šdex_desc_t
* 
pšdex
,

461 
bË_tu¶e
* 
±u¶e
);

464 
	`mš_key
(
šdex_desc_t
* 
pšdex
,

465 
bË_tu¶e
* 
±u¶e
,

466 
»p_row_t
 &
¬•
);

469 
	`max_key
(
šdex_desc_t
* 
pšdex
,

470 
bË_tu¶e
* 
±u¶e
,

471 
»p_row_t
 &
¬•
);

474 
	$key_size
(
šdex_desc_t
* 
pšdex
,

475 cÚ¡ 
bË_tu¶e
* 
±u¶e
) const;

485 
vœtu®
 
w_rc_t
 
	`check_®l_šdexes_tog‘h”
(
ss_m
* 
db
)=0;

486 
vœtu®
 
boŞ
 
	`check_®l_šdexes
(
ss_m
* 
db
)=0;

487 
vœtu®
 
w_rc_t
 
	`check_šdex
(
ss_m
* 
db
, 
šdex_desc_t
* 
pidx
)=0;

488 
vœtu®
 
w_rc_t
 
	`sÿn_®l_šdexes
(
ss_m
* 
db
)=0;

489 
vœtu®
 
w_rc_t
 
	`sÿn_šdex
(
ss_m
* 
db
, 
šdex_desc_t
* 
pidx
)=0;

495 
vœtu®
 
w_rc_t
 
	$pİuÏ‹
(
ss_m
* 
db
, 
boŞ
& 
hasNext
è{  (
RCOK
); 
	}
}

507 
vœtu®
 
w_rc_t
 
´št_bË
(
ss_m
* 
db
, 
num_lšes
)=0;

515 
vœtu®
 
w_rc_t
 
ãtch_bË
(
ss_m
* 
db
, 
lock_mode_t
 
®m
 = 
SH
);

527 
w_rc_t
 
»loÿ‹_»cÜds
(
veùÜ
<
rid_t
>& 
Şd_rids
,

528 
veùÜ
<
rid_t
>& 
Ãw_rids
);

545 
	g–_fËr_·¹
 : 
public
 
–_fËr


547 
bË_row_t
 
	tbË_tu¶e
;

549 
–_fËr_·¹
(
size_t
 
šdex’Œysz
,

550 
ss_m
* 
db
,

551 
bË_mª_t
* 
±abË
,

552 
bË_tu¶e
* 
±u¶e
,

553 
šdex_desc_t
* 
pšdex
,

554 
boŞ
 
bIgnÜeLocks
);

555 
ss_m
* 
	g_db
;

556 
bË_mª_t
* 
	g_±abËmª
;

557 
bË_tu¶e
* 
	g_±u¶e
;

558 
šdex_desc_t
* 
	g_pšdex
;

559 
boŞ
 
	g_bIgnÜeLocks
;

560 
rc_t
 
fl_–
(
vec_t
& 
–
, cÚ¡ 
Íid_t
& 
Ëaf
);

581 
šlše
 
	gbË_desc_t
::
	$fšd_f›ld_by_Çme
(cÚ¡ * 
f›ld_Çme
) const

583 
ušt_t
 
i
=0; i<
_f›ld_couÁ
; i++) {

584 ià(
	`¡rcmp
(
f›ld_Çme
, 
_desc
[
i
].
	`Çme
())==0)

585  (
i
);

588 
	}
}

601 
šlše
 * 
	gbË_desc_t
::
	$šdex_keydesc
(
šdex_desc_t
* 
idx
)

603 
	`CRITICAL_SECTION
(
idx_kd_cs
, 
idx
->
_keydesc_lock
);

604 ià(
	`¡¾’
(
idx
->
_keydesc
)>1)

605  (
idx
->
_keydesc
);

608 
ušt_t
 
i
=0; i<
idx
->
	`f›ld_couÁ
(); i++) {

609 
	`¡rÿt
(
idx
->
_keydesc
, 
_desc
[idx->
	`key_šdex
(
i
)].
	`keydesc
());

611  (
idx
->
_keydesc
);

612 
	}
}

627 
šlše
 
	gbË_desc_t
::
	$šdex_maxkeysize
(
šdex_desc_t
* 
idx
) const

629 
ušt_t
 
size
 = 0;

630 ià((
size
 = 
idx
->
	`g‘_keysize
()) > 0) {

633  (
size
);

637 
ušt_t
 
ix
 = 0;

638 
ušt_t
 
i
=0; i<
idx
->
	`f›ld_couÁ
(); i++) {

639 
ix
 = 
idx
->
	`key_šdex
(
i
);

640 
size
 +ğ
_desc
[
ix
].
	`f›ldmaxsize
();

643 
idx
->
	`£t_keysize
(
size
);

644 (
size
);

645 
	}
}

658 
šlše
 
ušt_t
 
	gbË_desc_t
::
	$maxsize
()

661 ià(*&
_maxsize
)

662  (*&
_maxsize
);

665 
ušt_t
 
size
 = 0;

666 
ušt_t
 
v¬_couÁ
 = 0;

667 
ušt_t
 
nuÎ_couÁ
 = 0;

668 
ušt_t
 
i
=0; i<
_f›ld_couÁ
; i++) {

669 
size
 +ğ
_desc
[
i
].
	`f›ldmaxsize
();

670 ià(
_desc
[
i
].
	`®low_nuÎ
()è
nuÎ_couÁ
++;

671 ià(
_desc
[
i
].
	`is_v¬ŸbË_Ëngth
()è
v¬_couÁ
++;

674 
size
 +ğ(
v¬_couÁ
*(
off£t_t
)è+ (
nuÎ_couÁ
>>3) + 1;

681 
	`as£¹
 ((*&
_maxsize
==0è|| (*&_maxsize==
size
));

683 
	`©omic_sw­_ušt
(&
_maxsize
, 
size
);

684  (*&
_maxsize
);

685 
	}
}

701 şas 
	cbË_´š‹r_t
 : 
public
 
th»ad_t


703 
´iv©e
:

705 
ShÜeEnv
* 
_’v
;

706 
	m_lšes
;

708 
	mpublic
:

710 
bË_´š‹r_t
(
ShÜeEnv
* 
_’v
, 
lšes
);

711 ~
bË_´š‹r_t
();

712 
wÜk
();

730 şas 
	cbË_ãtch”_t
 : 
public
 
th»ad_t


732 
´iv©e
:

734 
ShÜeEnv
* 
_’v
;

736 
	mpublic
:

738 
bË_ãtch”_t
(
ShÜeEnv
* 
_’v
);

739 ~
bË_ãtch”_t
();

740 
wÜk
();

745 
EXIT_NAMESPACE
(
shÜe
);

	@include/sm/shore/shore_table_man.h

49 #iâdeà
__SHORE_TABLE_MANAGER_H


50 
	#__SHORE_TABLE_MANAGER_H


	)

53 
	~"sm_vas.h
"

54 
	~"ut.h
"

56 
	~"shÜe_bË.h
"

57 
	~"shÜe_row_ÿche.h
"

60 
ENTER_NAMESPACE
(
shÜe
);

64 
	#DECLARE_TABLE_SCHEMA
(
bËÇme
) \

65 şas 
	cbËÇme
 : 
public
 
bË_desc_t
 { \

66 
public
: 
	`bËÇme
(
¡ršg
 
sy¢ame
); }

	)

69 
	#DECLARE_TABLE_SCHEMA_PD
(
bËÇme
) \

70 şas 
	cbËÇme
 : 
public
 
bË_desc_t
 { \

71 
public
: 
	`bËÇme
(cÚ¡ 
ušt4_t
& 
pd
); }

	)

80 
	g‹m¶©e
 <
şass
 
	gTabËDesc
>

81 
şass
 
	gbË_sÿn_™”_im¶
;

83 
	g‹m¶©e
 <
şass
 
	gTabËDesc
>

84 
şass
 
	gšdex_sÿn_™”_im¶
;

96 
	g‹m¶©e
 <
şass
 
	gTabËDesc
>

97 şas 
	cbË_mª_im¶
 : 
public
 
bË_mª_t


99 
public
:

100 
bË_sÿn_™”_im¶
<
	tTabËDesc
> 
	tbË_™”
;

101 
	mšdex_sÿn_™”_im¶
<
	tTabËDesc
> 
	tšdex_™”
;

102 
	mrow_ÿche_t
<
	tTabËDesc
> 
	trow_ÿche
;

104 
	m´Ùeùed
:

111 
	spÿche_lšk
 {

112 
row_ÿche
* 
s_g‘
();

113 
İ”©Ü
 
	mrow_ÿche
*(è{  
s_g‘
(); }

114 
row_ÿche
* 
	mİ”©Ü
->(è{  
s_g‘
(); }

118 
	#_DEFINE_ROW_CACHE_TLS
(
bË_mª
, 
s_Çme
) \

119 
	`DECLARE_TLS
(
bË_mª
::
row_ÿche
, 
s_Çme
); \

120 
‹m¶©e
<> 
bË_mª
::
row_ÿche
*abË_mª::
pÿche_lšk
::
	$s_g‘
(è{  
s_Çme
; 
	}

	)
}

121 
	#DEFINE_ROW_CACHE_TLS
(
ns
, 
Çme
) \

122 
	`_DEFINE_ROW_CACHE_TLS
(
ns
::
Çme
##
_mª_im¶
,‚s##Çme##
_ÿche
)

	)

124 
TabËDesc
* 
	g_p¥ecifiùabË
;

125 
pÿche_lšk
 
	g_pÿche
;

128 
	gpublic
:

134 
	$bË_mª_im¶
(
TabËDesc
* 
aTabËDesc
,

135 
boŞ
 
cÚ¡ruù_ÿche
=
Œue
)

136 : 
	`bË_mª_t
(
aTabËDesc
, 
cÚ¡ruù_ÿche
),

137 
	$_p¥ecifiùabË
(
aTabËDesc
)

139 
	`as£¹
 (
_±abË
);

140 
row_ÿche
::
tu¶e_çùÜy
::
	`±abË
(èğ
aTabËDesc
;

141 
	}
}

148 
w_rc_t
 
g‘_™”_fÜ_fe_sÿn
(
ss_m
* 
db
,

149 
bË_™”
* &
™”
,

150 
lock_mode_t
 
®m
 = 
SH
);

152 
w_rc_t
 
g‘_™”_fÜ_šdex_sÿn
(
ss_m
* 
db
,

153 
šdex_desc_t
* 
pšdex
,

154 
šdex_™”
* &
™”
,

155 
lock_mode_t
 
®m
,

156 
boŞ
 
Ãed_tu¶e
,

157 
sÿn_šdex_i
::
cmp_t
 
c1
,

158 cÚ¡ 
cvec_t
 & 
bound1
,

159 
sÿn_šdex_i
::
cmp_t
 
c2
,

160 cÚ¡ 
cvec_t
 & 
bound2
);

169 
w_rc_t
 
check_®l_šdexes_tog‘h”
(
ss_m
* 
db
);

170 
boŞ
 
check_®l_šdexes
(
ss_m
* 
db
);

171 
w_rc_t
 
check_šdex
(
ss_m
* 
db
, 
šdex_desc_t
* 
pidx
);

172 
w_rc_t
 
sÿn_®l_šdexes
(
ss_m
* 
db
);

173 
w_rc_t
 
sÿn_šdex
(
ss_m
* 
db
, 
šdex_desc_t
* 
pidx
);

180 
row_ÿche
* 
	$g‘_ÿche
(è{ 
	`as£¹
 (
_pÿche
);  (_pÿche); 
	}
}

182 
šlše
 
bË_tu¶e
* 
	$g‘_tu¶e
()

184  (
_pÿche
->
	`bÜrow
());

185 
	}
}

188 
šlše
 
	$give_tu¶e
(
bË_tu¶e
* 
±t
)

190 
_pÿche
->
	`giveback
(
±t
);

191 
	}
}

198 
w_rc_t
 
´št_bË
(
ss_m
* 
db
, 
num_lšes
);

213 
	g‹m¶©e
 <
şass
 
	gTabËDesc
>

214 
şass
 
	gbË_sÿn_™”_im¶
 :

215 
public
 
tu¶e_™”_t
<
TabËDesc
, 
	gsÿn_fe_i
, 
	gbË_row_t
 >

217 
	gpublic
:

218 
bË_row_t
 
	tbË_tu¶e
;

219 
	gbË_mª_im¶
<
	tTabËDesc
> 
	tbË_mªag”
;

220 
	gtu¶e_™”_t
<
	tTabËDesc
, 
	tsÿn_fe_i
, 
	tbË_row_t
 > 
	tbË_™”
;

222 
	g´iv©e
:

224 
bË_mªag”
* 
_pmªag”
;

226 
	gpublic
:

232 
bË_sÿn_™”_im¶
(
ss_m
* 
db
,

233 
TabËDesc
* 
±abË
,

234 
bË_mªag”
* 
pmªag”
,

235 
lock_mode_t
 
®m
)

236 : 
bË_™”
(
db
, 
±abË
, 
®m
, 
Œue
), 
_pmªag”
(
pmªag”
)

238 
as£¹
 (
_pmªag”
);

239 
W_COERCE
(
İ’_sÿn
(
db
));

242 ~
bË_sÿn_™”_im¶
() {

243 
	gtu¶e_™”_t
<
	gTabËDesc
, 
	gsÿn_fe_i
, 
	gbË_row_t
 >::
şo£_sÿn
();

251 
w_rc_t
 
İ’_sÿn
(
ss_m
* 
db
) {

252 ià(!
	gbË_™”
::
_İ’ed
) {

253 
as£¹
 (
db
);

254 
boŞ
 
	gbIgnÜeL©ches
 = (
bË_™”
::
_fe
->
g‘_pd
(è& (
PD_MRBT_LEAF
 | 
PD_MRBT_PART
è? 
Œue
 : 
çl£
);

255 
	gbË_™”
::
_sÿn
 = 
Ãw
 
sÿn_fe_i
(
bË_™”
::
_fe
->
fid
(),

256 
ss_m
::
t_cc_»cÜd
,

257 
çl£
,

258 
bË_™”
::
_lm
,

259 
bIgnÜeL©ches
);

260 
	gbË_™”
::
_İ’ed
 = 
Œue
;

262  (
	gRCOK
);

266 
pš_i
* 
cursÜ
() {

267 
pš_i
 *
	grv®
;

268 
boŞ
 
	geof
;

269 
	gbË_™”
::
_sÿn
->
cursÜ
(
rv®
, 
eof
);

270  (
	geof
? 
	gNULL
 : 
rv®
);

274 
w_rc_t
 
Ãxt
(
ss_m
* 
db
, 
boŞ
& 
eof
, 
bË_tu¶e
& 
tu¶e
) {

275 
as£¹
 (
_pmªag”
);

276 ià(!
	gbË_™”
::
_İ’ed
è
İ’_sÿn
(
db
);

277 
pš_i
* 
	ghªdË
;

278 
W_DO
(
bË_™”
::
_sÿn
->
Ãxt
(
hªdË
, 0, 
eof
));

279 ià(!
	geof
) {

280 ià(!
	g_pmªag”
->
lßd
(&
tu¶e
, 
hªdË
->
body
()))

281  
RC
(
£_WRONG_DISK_DATA
);

282 
	gtu¶e
.
£t_rid
(
hªdË
->
rid
());

284  (
	gRCOK
);

300 
	g‹m¶©e
 <
şass
 
	gTabËDesc
>

301 
şass
 
	gšdex_sÿn_™”_im¶
 :

302 
public
 
tu¶e_™”_t
<
šdex_desc_t
, 
	gsÿn_šdex_i
, 
	gbË_row_t
 >

304 
	gpublic
:

305 
bË_row_t
 
	tbË_tu¶e
;

306 
	gbË_mª_im¶
<
	tTabËDesc
> 
	tbË_mªag”
;

307 
	gtu¶e_™”_t
<
	tšdex_desc_t
, 
	tsÿn_šdex_i
, 
	tbË_row_t
 > 
	tšdex_™”
;

309 
	g´iv©e
:

310 
bË_mªag”
* 
_pmªag”
;

311 
boŞ
 
	g_Ãed_tu¶e
;

313 
	gpublic
:

319 
šdex_sÿn_™”_im¶
(
ss_m
* 
db
,

320 
šdex_desc_t
* 
pšdex
,

321 
bË_mªag”
* 
pmªag”
,

322 
lock_mode_t
 
®m
,

323 
boŞ
 
Ãed_tu¶e
)

324 : 
šdex_™”
(
db
, 
pšdex
, 
®m
, 
Œue
),

325 
_pmªag”
(
pmªag”
), 
_Ãed_tu¶e
(
Ãed_tu¶e
)

327 
as£¹
 (
_pmªag”
);

335 ~
šdex_sÿn_™”_im¶
() {

336 
	gšdex_™”
::
şo£_sÿn
();

344 
w_rc_t
 
İ’_sÿn
(
ss_m
* 
db
, 
²um
,

345 
sÿn_šdex_i
::
cmp_t
 
c1
, cÚ¡ 
cvec_t
& 
bound1
,

346 
sÿn_šdex_i
::
cmp_t
 
c2
, cÚ¡ 
cvec_t
& 
bound2
)

348 ià(!
	gšdex_™”
::
_İ’ed
) {

354 
ss_m
::
cÚcu¼’cy_t
 
cc
 = ss_m::
t_cc_im
;

355 ià(
	gšdex_™”
::
_lm
==
NL
è
cc
 = 
ss_m
::
t_cc_nÚe
;

358 
	gšdex_™”
::
_sÿn
 = 
Ãw
 
sÿn_šdex_i
(
šdex_™”
::
_fe
->
fid
(
²um
),

359 
c1
, 
bound1
, 
c2
, 
bound2
,

360 
çl£
, 
cc
,

361 
šdex_™”
::
_lm
,

362 
šdex_™”
::
_fe
->
is_ÏtchËss
());

363 
	gšdex_™”
::
_İ’ed
 = 
Œue
;

366  (
	gRCOK
);

369 
w_rc_t
 
Ãxt
(
ss_m
* , 
boŞ
& 
eof
, 
bË_tu¶e
& 
tu¶e
)

371 
as£¹
 (
šdex_™”
::
_İ’ed
);

372 
as£¹
 (
_pmªag”
);

373 
as£¹
 (
tu¶e
.
_»p
);

375 
W_DO
(
šdex_™”
::
_sÿn
->
Ãxt
(
eof
));

377 ià(!
	geof
) {

378 
	gkey_sz
 = 
_pmªag”
->
fÜm©_key
(
šdex_™”
::
_fe
,

379 &
tu¶e
, *tu¶e.
_»p
);

380 
as£¹
 (
tu¶e
.
_»p
->
_de¡
);

382 
vec_t
 
key
(
tu¶e
.
_»p
->
_de¡
, 
key_sz
);

384 
rid_t
 
	grid
;

385 
vec_t
 
»cÜd
(&
rid
, (
rid_t
));

386 
smsize_t
 
	gkËn
 = 0;

387 
smsize_t
 
	g–’
 = (
rid_t
);

389 
W_DO
(
šdex_™”
::
_sÿn
->
cu¼
(&
key
, 
kËn
, &
»cÜd
, 
–’
));

390 
	gtu¶e
.
£t_rid
(
rid
);

392 
	g_pmªag”
->
lßd_key
((cÚ¡ *)
key
.
±r
(0),

393 
šdex_™”
::
_fe
, &
tu¶e
);

396 ià(
	g_Ãed_tu¶e
) {

397 
pš_i
 
	gpš
;

398 
W_DO
(
pš
.pš(
rid
, 0, 
šdex_™”
::
_lm
, index_™”::
_fe
->
is_ÏtchËss
()));

399 ià(!
	g_pmªag”
->
lßd
(&
tu¶e
, 
pš
.
body
())) {

400 
	gpš
.
uÅš
();

401  
RC
(
£_WRONG_DISK_DATA
);

403 
	gpš
.
uÅš
();

406  (
	gRCOK
);

429 
	g‹m¶©e
 <
şass
 
	gTabËDesc
>

430 
w_rc_t
 
	gbË_mª_im¶
<
	gTabËDesc
>::
	$g‘_™”_fÜ_fe_sÿn
(
ss_m
* 
db
,

431 
bË_™”
* &
™”
,

432 
lock_mode_t
 
®m
)

434 
	`as£¹
 (
_±abË
);

435 
™”
 = 
Ãw
 
bË_sÿn_™”_im¶
<
TabËDesc
>(
db
, 
_p¥ecifiùabË
, 
this
, 
®m
);

436 ià(
™”
->
	`İ’ed
()è (
RCOK
);

437  
	`RC
(
£_OPEN_SCAN_ERROR
);

438 
	}
}

441 
	g‹m¶©e
 <
şass
 
	gTabËDesc
>

442 
w_rc_t
 
	gbË_mª_im¶
<
	gTabËDesc
>::
	$g‘_™”_fÜ_šdex_sÿn
(
ss_m
* 
db
,

443 
šdex_desc_t
* 
šdex
,

444 
šdex_™”
* &
™”
,

445 
lock_mode_t
 
®m
,

446 
boŞ
 
Ãed_tu¶e
,

447 
sÿn_šdex_i
::
cmp_t
 
c1
,

448 cÚ¡ 
cvec_t
& 
bound1
,

449 
sÿn_šdex_i
::
cmp_t
 
c2
,

450 cÚ¡ 
cvec_t
& 
bound2
)

452 
	`as£¹
 (
_±abË
);

453 
²um
 = 0;

454 if(
šdex
->
	`is_·¹™iÚed
()) {

455 
key0
 = 0;

456 
út
 = 
bound1
.
	`cİy_to
(&
key0
, ());

457 
	`as£¹
(
út
 == ());

458 
Ùh”_key0
;

459 
út
 = 
bound2
.
	`cİy_to
(&
Ùh”_key0
, ());

460 
	`as£¹
(
út
 == ());

461 
	`as£¹
(
key0
 =ğ
Ùh”_key0
);

462 
²um
 = 
key0
 % 
šdex
->
	`g‘_·¹™iÚ_couÁ
();

464 
™”
 = 
Ãw
 
šdex_sÿn_™”_im¶
<
TabËDesc
>(
db
, 
šdex
, 
this
, 
®m
, 
Ãed_tu¶e
);

465 
	`W_DO
(
™”
->
	`İ’_sÿn
(
db
, 
²um
, 
c1
, 
bound1
, 
c2
, 
bound2
));

466 ià(
™”
->
	`İ’ed
()è (
RCOK
);

467  
	`RC
(
£_OPEN_SCAN_ERROR
);

468 
	}
}

472 
	#CHECK_FOR_DEADLOCK
(
aùiÚ
, 
Ú_d—dlock
) \

474 
w_rc_t
 
rc
 = 
aùiÚ
; \

475 if(
rc
.
	`is_”rÜ
()) { \

476 
	`W_COERCE
(
db
->
	`abÜt_xù
()); \

477 if(
rc
.
	`”r_num
(è=ğ
smËv–_0
::
eDEADLOCK
) { \

478 
	`TRACE
Ğ
TRACE_ALWAYS
, "lßd(%s): %d: d—dlock d‘eùed. R‘ryšg.n", 
_±abË
->
	`Çme
(), 
tu¶e_couÁ
); \

479 
	`W_DO
(
db
->
	`begš_xù
()); \

480 
Ú_d—dlock
; \

482 
	`W_DO
(
rc
); \

487 } 1)

	)

489 
	sbË_ü—tiÚ_lock
 {

490 
±h»ad_mu‹x_t
* 
g‘_lock
() {

491 
±h»ad_mu‹x_t
 
	mlock
 = 
PTHREAD_MUTEX_INITIALIZER
;

492  &
	mlock
;

498 
EXIT_NAMESPACE
(
shÜe
);

499 
	~"shÜe_h–³r_lßd”.h
"

500 
ENTER_NAMESPACE
(
shÜe
);

513 
	g‹m¶©e
 <
şass
 
	gTabËDesc
>

514 
w_rc_t
 
	gbË_mª_im¶
<
	gTabËDesc
>::
	$check_®l_šdexes_tog‘h”
(
ss_m
* 
db
)

516 
	`as£¹
 (
_±abË
);

518 
	`TRACE
Ğ
TRACE_DEBUG
, "Checking consistency ofhe indexes onable (%s)\n",

519 
_±abË
->
	`Çme
());

521 
time_t
 
t¡¬t
 = 
	`time
(
NULL
);

523 
	`W_DO
(
db
->
	`begš_xù
());

524 
šdex_desc_t
* 
pšdex
 = 
NULL
;

527 
bË_™”
* 
™”
;

528 
	`W_DO
(
	`g‘_™”_fÜ_fe_sÿn
(
db
, 
™”
));

531 
boŞ
 
eof
 = 
çl£
;

532 
bË_tu¶e
 
	`tu¶e
(
_±abË
);

533 
	`W_DO
(
™”
->
	`Ãxt
(
db
, 
eof
, 
tu¶e
));

535 
™u¶e_út
=0;

536 
idx_út
=0;

538 !
eof
) {

540 
rid_t
 
bËrid
 = 
tu¶e
.
	`rid
();

542 
™u¶e_út
++;

545 
pšdex
 = 
_±abË
->
	`šdexes
();

546 
pšdex
) {

548 
idx_út
++;

550 
w_rc_t
 
rc
 = 
	`šdex_´obe
(
db
, 
pšdex
, &
tu¶e
);

552 ià(
rc
.
	`is_”rÜ
()) {

553 
	`TRACE
Ğ
TRACE_ALWAYS
, "Index…robeƒrror in (%s) (%s) (%d)\n",

554 
_±abË
->
	`Çme
(), 
pšdex
->Çme(), 
idx_út
);

555 
û¼
 << "DutØ" << 
rc
 << 
’dl
;

556  
	`RC
(
£_INCONSISTENT_INDEX
);

559 ià(
bËrid
 !ğ
tu¶e
.
	`rid
()) {

560 
	`TRACE
Ğ
TRACE_ALWAYS
, "Inconsistent index... (%d)",

561 
idx_út
);

562  
	`RC
(
£_INCONSISTENT_INDEX
);

564 
pšdex
 =…šdex->
	`Ãxt
();

567 
	`W_DO
(
™”
->
	`Ãxt
(
db
, 
eof
, 
tu¶e
));

569 
	`d–‘e
 (
™”
);

571 
	`W_DO
(
db
->
	`comm™_xù
());

572 
time_t
 
t¡İ
 = 
	`time
(
NULL
);

574 
	`TRACE
Ğ
TRACE_DEBUG
, "Indexes onable (%s) found consistent in (%d) secs...\n",

575 
_±abË
->
	`Çme
(), 
t¡İ
-
t¡¬t
);

577  (
RCOK
);

579 
	}
}

590 
	g‹m¶©e
 <
şass
 
	gTabËDesc
>

591 
boŞ
 
	gbË_mª_im¶
<
	gTabËDesc
>::
	$check_®l_šdexes
(
ss_m
* 
db
)

593 
	`as£¹
 (
_±abË
);

595 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`šdexes
();

597 
	`TRACE
Ğ
TRACE_DEBUG
, "Checking consistency ofhe indexes onable (%s)\n",

598 
_±abË
->
	`Çme
());

600 
pšdex
) {

601 
w_rc_t
 
rc
 = 
	`check_šdex
(
db
, 
pšdex
);

602 ià(
rc
.
	`is_”rÜ
()) {

603 
	`TRACE
Ğ
TRACE_ALWAYS
, "Index checkingƒrror in (%s) (%s)\n",

604 
_±abË
->
	`Çme
(), 
pšdex
->name());

605 
û¼
 << "DutØ" << 
rc
 << 
’dl
;

606  (
çl£
);

608 
pšdex
 =…šdex->
	`Ãxt
();

610  (
Œue
);

611 
	}
}

624 
	g‹m¶©e
 <
şass
 
	gTabËDesc
>

625 
w_rc_t
 
	gbË_mª_im¶
<
	gTabËDesc
>::
	$check_šdex
(
ss_m
* 
db
,

626 
šdex_desc_t
* 
pšdex
)

628 
	`as£¹
 (
_±abË
);

630 
	`TRACE
Ğ
TRACE_DEBUG
, "S¹Øcheck index (%s)\n", 
pšdex
->
	`Çme
());

632 
	`W_DO
(
db
->
	`begš_xù
());

634 
bË_™”
* 
™”
;

635 
	`W_DO
(
	`g‘_™”_fÜ_fe_sÿn
(
db
, 
™”
));

637 
boŞ
 
eof
 = 
çl£
;

638 
bË_tu¶e
 
	`tu¶e
(
_±abË
);

639 
	`W_DO
(
™”
->
	`Ãxt
(
db
, 
eof
, 
tu¶e
));

640 
ušt_t
 
tcouÁ
=0;

641 !
eof
) {

643 
rid_t
 
bËrid
 = 
tu¶e
.
	`rid
();

644 
	`W_DO
(
	`šdex_´obe
(
db
, 
pšdex
, &
tu¶e
));

645 ++
tcouÁ
;

646 ià(
bËrid
 !ğ
tu¶e
.
	`rid
()) {

647 
	`TRACE
Ğ
TRACE_ALWAYS
, "Inconsistent index... (%d)",

648 
tcouÁ
);

649  
	`RC
(
£_INCONSISTENT_INDEX
);

651 
	`W_DO
(
™”
->
	`Ãxt
(
db
, 
eof
, 
tu¶e
));

653 
	`d–‘e
 (
™”
);

655 
	`W_DO
(
db
->
	`comm™_xù
());

656  (
RCOK
);

657 
	}
}

674 
	g‹m¶©e
 <
şass
 
	gTabËDesc
>

675 
w_rc_t
 
	gbË_mª_im¶
<
	gTabËDesc
>::
	$sÿn_®l_šdexes
(
ss_m
* 
db
)

677 
	`as£¹
 (
_±abË
);

679 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`šdexes
();

680 
pšdex
) {

681 
	`W_DO
(
	`sÿn_šdex
(
db
, 
pšdex
));

682 
pšdex
 =…šdex->
	`Ãxt
();

684  (
RCOK
);

685 
	}
}

696 
	g‹m¶©e
 <
şass
 
	gTabËDesc
>

697 
w_rc_t
 
	gbË_mª_im¶
<
	gTabËDesc
>::
	$sÿn_šdex
(
ss_m
* 
db
,

698 
šdex_desc_t
* 
pšdex
)

700 
	`as£¹
 (
_±abË
);

701 
	`as£¹
 (
pšdex
);

702 
	`as£¹
 (!
pšdex
->
	`is_·¹™iÚed
());

704 
	`TRACE
Ğ
TRACE_DEBUG
, "Scanning index (%s) forable (%s)\n",

705 
pšdex
->
	`Çme
(), 
_±abË
->name());

708 
šdex_™”
* 
™”
;

710 
bË_tu¶e
 
	`lowtu¶e
(
_±abË
);

711 
»p_row_t
 
	`low»p
(
_±s
);

712 
lowsz
 = 
	`mš_key
(
pšdex
, &
lowtu¶e
, 
low»p
);

713 
	`as£¹
 (
low»p
.
_de¡
);

715 
bË_tu¶e
 
	`hightu¶e
(
_±abË
);

716 
»p_row_t
 
	`high»p
(
_±s
);

717 
highsz
 = 
	`max_key
(
pšdex
, &
hightu¶e
, 
high»p
);

718 
	`as£¹
 (
high»p
.
_de¡
);

720 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
,

721 
SH
,

722 
çl£
,

723 
sÿn_šdex_i
::
ge
,

724 
	`vec_t
(
low»p
.
_de¡
, 
lowsz
),

725 
sÿn_šdex_i
::
Ë
,

726 
	`vec_t
(
high»p
.
_de¡
, 
highsz
)));

729 
boŞ
 
eof
;

730 
couÁ
 = 0;

731 
bË_tu¶e
 
	`row
(
_±abË
);

733 
	`W_DO
(
™”
->
	`Ãxt
(
db
, 
eof
, 
row
));

734 !
eof
) {

735 
pš_i
 
pš
;

736 
	`W_DO
(
pš
.
	`pš
(
row
.
	`rid
(), 0));

737 ià(!
	`lßd
(&
row
, 
pš
.
	`body
())) {

738 
pš
.
	`uÅš
();

739  
	`RC
(
£_WRONG_DISK_DATA
);

741 
pš
.
	`uÅš
();

742 
row
.
	`´št_v®ues
();

744 
	`W_DO
(
™”
->
	`Ãxt
(
db
, 
eof
, 
row
));

745 
couÁ
++;

747 
d–‘e
 
™”
;

750 
	`TRACE
Ğ
TRACE_DEBUG
, "%du¶e found!\n", 
couÁ
);

751 
	`TRACE
Ğ
TRACE_DEBUG
, "Scan finished!\n");

753  (
RCOK
);

754 
	}
}

774 
	g‹m¶©e
 <
şass
 
	gTabËDesc
>

775 
w_rc_t
 
	gbË_mª_im¶
<
	gTabËDesc
>::
	$´št_bË
(
ss_m
* 
db
, 
num_lšes
)

777 
	`as£¹
 (
_±abË
);

779 
f’ame
[
MAX_FILENAME_LEN
];

780 
	`¡rıy
(
f’ame
, 
_±abË
->
	`Çme
());

781 if(
num_lšes
 > 0) {

782 
	`¡rÿt
(
f’ame
, 
	`c_¡r
("_%d",0));

784 
	`¡rÿt
(
f’ame
, ".tbl");

785 
of¡»am
 
	`fout
(
f’ame
);

787 
	`W_DO
(
db
->
	`begš_xù
());

789 
bË_™”
* 
™”
;

790 
ÿrdš®™y
 = 0;

791 
lšes
 = 0;

792 
num_fes
 = 1;

793 
	`W_DO
(
	`g‘_™”_fÜ_fe_sÿn
(
db
, 
™”
));

795 
boŞ
 
eof
 = 
çl£
;

796 
bË_tu¶e
 
	`row
(
_±abË
);

797 
	`W_DO
(
™”
->
	`Ãxt
(
db
, 
eof
, 
row
));

798 !
eof
) {

799 if(
num_lšes
 !ğ0 && 
lšes
 ==‚um_lines) {

800 
fout
.
	`æush
();

801 
fout
.
	`şo£
();

802 
	`TRACE
Ğ
TRACE_ALWAYS
, "% şo£d!\n", 
f’ame
);

803 * 
pos
 = 
	`¡¼chr
(
f’ame
, '_');

804 
pos
++;

805 
	`¡rıy
(
pos
, 
	`c_¡r
("%d.tbl",
num_fes
));

806 
fout
.
	`İ’
(
f’ame
);

807 
num_fes
++;

808 
lšes
 = 0;

810 
row
.
	`´št_v®ues
(
fout
);

812 
ÿrdš®™y
++;

813 
lšes
++;

814 
	`W_DO
(
™”
->
	`Ãxt
(
db
, 
eof
, 
row
));

816 
d–‘e
 
™”
;

818 
	`W_DO
(
db
->
	`comm™_xù
());

820 
	`TRACE
Ğ
TRACE_ALWAYS
, "% şo£d!\n", 
f’ame
);

825 
	`TRACE
Ğ
TRACE_ALWAYS
, "Table (%s)…rinted (%d)uples\n",

826 
_±abË
->
	`Çme
(), 
ÿrdš®™y
);

828 
fout
.
	`æush
();

829 
fout
.
	`şo£
();

831  (
RCOK
);

832 
	}
}

838 
EXIT_NAMESPACE
(
shÜe
);

	@include/sm/shore/shore_tools.h

31 #iâdeà
__SHORE_TOOLS_H


32 
	#__SHORE_TOOLS_H


	)

35 
	~"sm_vas.h
"

36 
	~"ut/Çme¥aû.h
"

38 
	~"sm/shÜe/shÜe_fe_desc.h
"

40 
	~"sm/shÜe/shÜe_’v.h
"

43 
ENTER_NAMESPACE
(
shÜe
);

54 
	g‹m¶©e
<
şass
 
	gIÅutCÏss
>

55 şas 
	cŒx_smth»ad_t
 : 
public
 
smth»ad_t
 {

56 
´iv©e
:

57 
	$Œx_»suÉ_tu¶e_t
 (*
	tŒxâ
)(
	tIÅutCÏss
*, cÚ¡ , 
	tShÜeEnv
*);

59 
´iv©e
:

60 
Œxâ
 
_â
;

61 
IÅutCÏss
* 
_šput
;

62 
ShÜeEnv
* 
_’v
;

63 
_id
;

64 
c_¡r
 
_Šame
;

66 
public
:

67 
Œx_»suÉ_tu¶e_t
 
_rv
;

69 
	$Œx_smth»ad_t
(
Œxâ
 
â
, 
IÅutCÏss
* 
âšput
, 
ShÜeEnv
* 
’v
,

70 cÚ¡ 
id
, 
c_¡r
 
Šame
)

71 : 
	`smth»ad_t
(
t_»guÏr
, 
Šame
.
	`d©a
()), 
	`_â
(
â
), 
	`_šput
(
âšput
),

72 
	`_’v
(
’v
), 
	`_id
(
id
), 
	`_Šame
(
Šame
), 
	`_rv
(
	$Œx_»suÉ_tu¶e_t
(
UNDEF
, 
id
))

76 ~
	$Œx_smth»ad_t
(è{ 
	}
}

79 
	$run
()

83 
	`as£¹
 (
_â
!=
NULL
);

84 
	`as£¹
 (
_šput
!=
NULL
);

85 
	`as£¹
 (
_’v
!=
NULL
);

86 
_rv
 = (*
_â
)(
_šput
, 
_id
, 
_’v
);

87 
	}
}

93 
šlše
 
Œx_»suÉ_tu¶e_t
 
	$»tv®
(è{  (
_rv
); 
	}
}

94 
šlše
 
c_¡r
 
	$Šame
(è{  (
_Šame
); 
	}
}

113 
	g‹m¶©e
<
şass
 
	gSMTh»ad
, cÏs 
	gSMTR‘uº
>

114 
	$run_smth»ad
(
SMTh»ad
* 
t
, 
SMTR‘uº
* &
r
)

116 ià(!
t
)

117 
	`W_FATAL
(
fcOUTOFMEMORY
);

119 
w_rc_t
 
e
 = 
t
->
	`fÜk
();

120 if(
e
.
	`is_”rÜ
()) {

121 
	`TRACE
Ğ
TRACE_ALWAYS
, "Error forkinghread (%s)...\n",

122 
t
->
	`Çme
());

126 
e
 = 
t
->
	`još
();

127 ià(
e
.
	`is_”rÜ
()) {

128 
	`TRACE
Ğ
TRACE_ALWAYS
, "Error joininghread (%s)...\n",

129 
t
->
	`Çme
());

133 
r
 = 
Ãw
 
	`SMTR‘uº
(
t
->
	`»tv®
());

134 
	`as£¹
 (
r
);

138 
	}
}

151 
	g‹m¶©e
<
şass
 
	gT¿n§ùiÚ
>

152 
w_rc_t
 
	$run_xù
(
ss_m
* 
ssm
, 
T¿n§ùiÚ
 &
t
) {

153 
w_rc_t
 
e
;

155 
e
 = 
ssm
->
	`begš_xù
();

156 if(
e
.
	`is_”rÜ
())

158 
e
 = 
	`t
(
ssm
);

159 if(
e
.
	`is_”rÜ
())

160 
e
 = 
ssm
->
	`abÜt_xù
();

162 
e
 = 
ssm
->
	`comm™_xù
();

163 } 
e
.
	`is_”rÜ
(è&&ƒ.
	`”r_num
(è=ğ
smËv–_0
::
eDEADLOCK
);

164  
e
;

165 
	}
}

174 
	g‹m¶©e
<
şass
 
	gP¬£r
>

175 
	sü—‹_vŞume_xù


179 
ShÜeEnv
* 
	m_³nv
;

181 cÚ¡* 
	m_bË_Çme
;

182 
	mfe_šfo_t
 &
	m_šfo
;

183 
size_t
 
	m_by‹s
;

185 
ü—‹_vŞume_xù
(cÚ¡* 
Šame
, 
fe_šfo_t
 &
šfo
,

186 
size_t
 
by‹s
, 
ShÜeEnv
* 
’v


188 : 
_bË_Çme
(
Šame
), 
_šfo
(
šfo
), 
_by‹s
(
by‹s
), 
_³nv
(
’v
)

192 
w_rc_t
 
İ”©Ü
()(
ss_m
* 
	mssm
) {

194 
CRITICAL_SECTION
(
cs
, *(
_³nv
->
g‘_vŞ_mu‹x
()));

196 
¡id_t
 
	mroÙ_iid
;

197 
vec_t
 
bË_Çme
(
_bË_Çme
, 
¡¾’
(_table_name));

198 
	msize
 = (
_šfo
);

199 
vec_t
 
bË_šfo
(&
_šfo
, 
size
);

200 
boŞ
 
	mfound
;

202 
W_DO
(
ss_m
::
vŞ_roÙ_šdex
(*(
_³nv
->
vid
()), 
roÙ_iid
));

203 
W_DO
(
ss_m
::
fšd_assoc
(
roÙ_iid
, 
bË_Çme
, &
_šfo
, 
size
, 
found
));

205 if(
	mfound
) {

206 
	mcout
 << "Removšg…»viou š¡ªû oà" << 
	m_bË_Çme
 << 
	m’dl
;

207 
W_DO
(
ss_m
::
de¡roy_fe
(
_šfo
.
fid
()));

208 
W_DO
(
ss_m
::
de¡roy_assoc
(
roÙ_iid
, 
bË_Çme
, 
bË_šfo
));

212 
	mcout
 << "C»©šgabË ``" << 
	m_bË_Çme


213 << "'' w™h " << 
	m_by‹s
 << " by‹ ³¸»cÜd" << 
	m’dl
;

214 
W_DO
(
ssm
->
ü—‹_fe
(*(
_³nv
->
vid
()), 
_šfo
.
_fid
, 
smËv–_3
::
t_»guÏr
));

215 
W_DO
(
ss_m
::
vŞ_roÙ_šdex
(*(
_³nv
->
vid
()), 
roÙ_iid
));

216 
W_DO
(
ss_m
::
ü—‹_assoc
(
roÙ_iid
, 
bË_Çme
, 
bË_šfo
));

218  (
	mRCOK
);

226 
EXIT_NAMESPACE
(
shÜe
);

	@include/sm/shore/shore_trx_worker.h

33 #iâdeà
__SHORE_TRX_WORKER_H


34 
	#__SHORE_TRX_WORKER_H


	)

37 
	~"sm/shÜe/¤mwqueue.h
"

38 
	~"sm/shÜe/shÜe_»qs.h
"

39 
	~"sm/shÜe/shÜe_wÜk”.h
"

42 
ENTER_NAMESPACE
(
shÜe
);

53 cÚ¡ 
	gREQUESTS_PER_WORKER_POOL_SZ
 = 60;

55 şas 
	cŒx_wÜk”_t
 : 
public
 
ba£_wÜk”_t


57 
public
:

58 
Œx_»que¡_t
 
	tReque¡
;

59 
	m¤mwqueue
<
	tReque¡
> 
	tQueue
;

61 
	m´iv©e
:

63 
gu¬d
<
Queue
> 
_pqueue
;

64 
	mgu¬d
<
	mPoŞ
> 
	m_aùiÚpoŞ
;

67 
_wÜk_ACTIVE_im¶
();

69 
_´e_STOP_im¶
();

72 
_£rve_aùiÚ
(
Reque¡
* 
´eque¡
);

74 
	mpublic
:

76 
Œx_wÜk”_t
(
ShÜeEnv
* 
’v
, 
c_¡r
 
Šame
,

77 
´oûssÜid_t
 
­rsid
 = 
PBIND_NONE
,

78 cÚ¡ 
u£_¦i
 = 0);

79 ~
Œx_wÜk”_t
();

82 
šlše
 
	$’queue
(
Reque¡
* 
¬eque¡
, cÚ¡ 
boŞ
 
bWake
=
Œue
) {

83 
_pqueue
->
	`push
(
¬eque¡
,
bWake
);

86 
	`š™
(cÚ¡ 
lc
);

88 
	}
};

90 
EXIT_NAMESPACE
(
shÜe
);

	@include/sm/shore/shore_worker.h

32 #iâdeà
__SHORE_WORKER_H


33 
	#__SHORE_WORKER_H


	)

35 
	~<c¡dio
>

38 
	~"k_defšes.h
"

40 
	~"ut.h
"

41 
	~"sm/shÜe/commÚ.h
"

43 
ENTER_NAMESPACE
(
shÜe
);

47 #undeà
WORKER_VERBOSE_STATS


51 #undeà
WORKER_VERY_VERBOSE_STATS


56 #undeà
ACCESS_RECORD_TRACE


59 cÚ¡ 
	gWAITING_WINDOW
 = 5;

62 cÚ¡ 
ušt
 
	gMINIMUM_PROCESSED
 = 10;

76 
	swÜk”_¡©s_t


78 
ušt
 
	m_´oûs£d
;

79 
ušt
 
	m_´obËms
;

81 
ušt
 
	m_£rved_šput
;

82 
ušt
 
	m_£rved_wa™šg
;

84 
ušt
 
	m_cÚdex_¦“p
;

85 
ušt
 
	m_çed_¦“p
;

87 
ušt
 
	m_—¾y_abÜts
;

88 
ušt
 
	m_mid_abÜts
;

90 #ifdeà
WORKER_VERBOSE_STATS


91 
upd©e_£rved
(cÚ¡ 
£rve_time_ms
);

92 
	m_£rvšg_tÙ®
;

94 
upd©e_rvp_exec_time
(cÚ¡ 
rvp_exec_time
);

95 
upd©e_rvp_nÙify_time
(cÚ¡ 
rvp_nÙify_time
);

96 
ušt
 
	m_rvp_exec
;

97 
	m_rvp_exec_time
;

98 
	m_rvp_nÙify_time
;

100 
upd©e_wa™ed
(cÚ¡ 
queue_time
);

101 
	m_wa™šg_tÙ®
;

103 #ifdeà
WORKER_VERY_VERBOSE_STATS


104 
	m_ww
[
WAITING_WINDOW
];

105 
ušt
 
	m_ww_idx
;

106 
	m_Ï¡_chªge
;

107 
¡İw©ch_t
 
	m_fÜ_Ï¡_chªge
;

111 
wÜk”_¡©s_t
()

112 : 
_´oûs£d
(0), 
_´obËms
(0),

113 
_£rved_šput
(0), 
_£rved_wa™šg
(0),

114 
_cÚdex_¦“p
(0), 
_çed_¦“p
(0),

115 
_—¾y_abÜts
(0), 
_mid_abÜts
(0)

116 #ifdeà
WORKER_VERBOSE_STATS


117 , 
_£rvšg_tÙ®
(0),

118 
_rvp_exec
(0), 
_rvp_exec_time
(0), 
_rvp_nÙify_time
(0),

119 
_wa™šg_tÙ®
(0)

120 #ifdeà
WORKER_VERY_VERBOSE_STATS


121 , 
_ww_idx
(0), 
_Ï¡_chªge
(0)

126 ~
wÜk”_¡©s_t
() { }

128 
´št_¡©s
() const;

130 
»£t
();

132 
´št_ªd_»£t
(è{ 
´št_¡©s
(); 
»£t
(); }

134 
	mwÜk”_¡©s_t
& 
	mİ”©Ü
+=(
wÜk”_¡©s_t
 cÚ¡& 
rhs
);

154 
şass
 
	gShÜeEnv
;

156 şas 
	cba£_wÜk”_t
 : 
public
 
th»ad_t


158 
´Ùeùed
:

161 vŞ©
ušt_t
 
_cÚŒŞ
;

162 vŞ©
eD©aOwÃrS‹
 
	m_d©a_owÃr
;

163 
ušt_t
 vŞ©
	m_ws
;

166 
cÚdex
 
	m_nÙify
;

169 
ShÜeEnv
* 
	m_’v
;

172 
ba£_wÜk”_t
* 
	m_Ãxt
;

173 
s_lock
 
	m_Ãxt_lock
;

176 
wÜk”_¡©s_t
 
	m_¡©s
;

179 
boŞ
 
	m_is_bound
;

180 
´oûssÜid_t
 
	m_´s_id
;

183 
	m_u£_¦i
;

186 
vœtu®
 
_wÜk_PAUSED_im¶
();

187 
vœtu®
 
_wÜk_ACTIVE_im¶
()=0;

188 
vœtu®
 
_wÜk_STOPPED_im¶
();

189 
vœtu®
 
_´e_STOP_im¶
()=0;

192 
	$_´št_¡©s_im¶
() const;

194 
public
:

196 
	$ba£_wÜk”_t
(
ShÜeEnv
* 
’v
, 
c_¡r
 
Šame
, 
´oûssÜid_t
 
­rsid
, cÚ¡ 
u£_¦i
)

197 : 
	`th»ad_t
(
Šame
),

198 
	`_cÚŒŞ
(
WC_PAUSED
), 
	`_d©a_owÃr
(
DOS_UNDEF
), 
	`_ws
(
WS_UNDEF
),

199 
	`_’v
(
’v
),

200 
	`_Ãxt
(
NULL
), 
	`_is_bound
(
çl£
), 
	`_´s_id
(
­rsid
), 
	$_u£_¦i
(
u£_¦i
)

204 
vœtu®
 ~
	$ba£_wÜk”_t
(è{ 
	}
}

209 
	$£t_Ãxt
(
ba£_wÜk”_t
* 
­wÜk”
) {

210 
	`as£¹
 (
­wÜk”
);

211 
	`CRITICAL_SECTION
(
Ãxt_cs
, 
_Ãxt_lock
);

212 
_Ãxt
 = 
­wÜk”
;

213 
	}
}

215 
ba£_wÜk”_t
* 
	$g‘_Ãxt
(è{  (
_Ãxt
); 
	}
}

218 
	$£t_d©a_owÃr_¡©e
(cÚ¡ 
eD©aOwÃrS‹
 
ados
) {

219 
	`as£¹
 ((
ados
==
DOS_ALONE
)||×dos==
DOS_MULTIPLE
));

220 
	`©omic_sw­
(&
_d©a_owÃr
, 
ados
);

221 
	}
}

223 
boŞ
 
	$is_®Úe_owÃr
(è{  (*&
_d©a_owÃr
==
DOS_ALONE
); 
	}
}

228 
šlše
 
ušt_t
 
	$£t_ws
(cÚ¡ 
ušt_t
 
Ãw_ws
) {

229 
ušt_t
 
Şd_ws
 = *&
_ws
;

230 
Şd_ws
!=
Ãw_ws
) {

233 ià((
Şd_ws
==
WS_COMMIT_Q
)&&(
Ãw_ws
!=
WS_LOOP
)) {  (old_ws); }

236 
ušt_t
 
cur_ws
 = 
	`©omic_ÿs
(&
_ws
,
Şd_ws
,
Ãw_ws
);

237 ià(
cur_ws
 =ğ
Şd_ws
) {

239 ià((
Şd_ws
==
WS_SLEEP
)&&(
Ãw_ws
!=WS_SLEEP)è{ 
	`cÚdex_wakeup
(); }

240  (
Şd_ws
);

246 
Şd_ws
 = 
cur_ws
;

248  (
Şd_ws
);

249 
	}
}

251 
šlše
 
ušt_t
 
	$g‘_ws
(è{  (*&
_ws
); 
	}
}

254 
šlše
 
boŞ
 
	$ÿn_cÚtšue
(cÚ¡ 
ušt_t
 
my_ws
) {

255  ((*&
_ws
==
my_ws
)||(*&_ws==
WS_LOOP
));

256 
	}
}

258 
šlše
 
boŞ
 
	$is_¦“pšg
() {

259  (*&
_ws
==
WS_SLEEP
);

260 
	}
}

267 
šlše
 
	$cÚdex_¦“p
() {

272 
ušt_t
 
Şd_ws
 = *&
_ws
;

273 
Şd_ws
==
WS_LOOP
) {

274 
ušt_t
 
cur_ws
 = 
	`©omic_ÿs_ušt
(&
_ws
,
Şd_ws
,(ušt_t)
WS_SLEEP
);

275 ià(
cur_ws
 =ğ
Şd_ws
) {

277 
_nÙify
.
	`wa™
();

278 ++
_¡©s
.
_cÚdex_¦“p
;

283 
Şd_ws
 = 
cur_ws
;

285 ++
_¡©s
.
_çed_¦“p
;

287 
	}
}

292 
šlše
 
	$cÚdex_wakeup
() {

294 
_nÙify
.
	`sigÇl
();

295 
	}
}

303 
šlše
 
ušt_t
 
	$g‘_cÚŒŞ
(è{  (*&
_cÚŒŞ
); 
	}
}

305 
šlše
 
boŞ
 
	$£t_cÚŒŞ
(cÚ¡ 
ušt_t
 
awc
) {

320 ià((*&
_cÚŒŞ
 =ğ
WC_PAUSED
) &&

321 ((
awc
 =ğ
WC_ACTIVE
è|| (awø=ğ
WC_STOPPED
))) {

322 
	`©omic_sw­
(&
_cÚŒŞ
, 
awc
);

323  (
Œue
);

326 ià((*&
_cÚŒŞ
 =ğ
WC_ACTIVE
) &&

327 ((
awc
 =ğ
WC_PAUSED
è|| (awø=ğ
WC_STOPPED
))) {

328 
	`©omic_sw­
(&
_cÚŒŞ
, 
awc
);

329  (
Œue
);

333 ià((*&
_cÚŒŞ
 =ğ
WC_RECOVERY
è|| (
awc
 == WC_RECOVERY)) {

334 
	`©omic_sw­
(&
_cÚŒŞ
, 
awc
);

335  (
Œue
);

338 
	`TRACE
Ğ
TRACE_DEBUG
, "Not‡llowedransition (%d)-->(%d)\n",

339 
_cÚŒŞ
, 
awc
);

340  (
çl£
);

341 
	}
}

344 
	$¡İ
() {

345 
	`£t_cÚŒŞ
(
WC_STOPPED
);

346 ià(
	`is_¦“pšg
()è
_nÙify
.
	`sigÇl
();

347 
	}
}

349 
	$¡¬t
() {

350 
	`£t_cÚŒŞ
(
WC_ACTIVE
);

351 ià(
	`is_¦“pšg
()è
_nÙify
.
	`sigÇl
();

352 
	}
}

354 
	$·u£
() {

355 
	`£t_cÚŒŞ
(
WC_PAUSED
);

356 ià(
	`is_¦“pšg
()è
_nÙify
.
	`sigÇl
();

357 
	}
}

360 
šlše
 
	$wÜk_PAUSED
(è{  (
	`_wÜk_PAUSED_im¶
()); 
	}
}

361 
šlše
 
	$wÜk_ACTIVE
(è{  (
	`_wÜk_ACTIVE_im¶
()); 
	}
}

362 
šlše
 
	$wÜk_STOPPED
(è{  (
	`_wÜk_STOPPED_im¶
()); 
	}
}

365 
wÜk
();

369 
boŞ
 
abÜt_Úe_Œx
(
xù_t
* 
axù
);

371 
¡©s
();

373 
wÜk”_¡©s_t
 
g‘_¡©s
();

375 
	$»£t_¡©s
(è{ 
_¡©s
.
	`»£t
(); 
	}
}

378 #ifdeà
ACCESS_RECORD_TRACE


379 
of¡»am
 
	g_Œaû_fe
;

380 
	gveùÜ
<
	g¡ršg
> 
	g_ev’ts
;

381 
ü—‹_Œaû_dœ
(
¡ršg
 
dœ
);

382 
İ’_Œaû_fe
();

383 
şo£_Œaû_fe
();

386 
	g´iv©e
:

389 
ba£_wÜk”_t
(base_worker_t const &);

390 
	gİ”©Ü
=(
ba£_wÜk”_t
 const &);

394 
EXIT_NAMESPACE
(
shÜe
);

	@include/sm/shore/srmwqueue.h

35 #iâdeà
__SHORE_SRMW_QUEUE_H


36 
	#__SHORE_SRMW_QUEUE_H


	)

38 
	~<¡h»ad.h
>

39 
	~<veùÜ
>

41 
	~"ut.h
"

42 
	~"sm/shÜe/commÚ.h
"

43 
	~"sm/shÜe/shÜe_wÜk”.h
"

46 
ENTER_NAMESPACE
(
shÜe
);

49 
	g‹m¶©e
<
şass
 
	gAùiÚ
>

50 
	s¤mwqueue


52 
ty³Çme
 
	tPoŞedVec
<
	tAùiÚ
*>::
	tTy³
 
	tAùiÚVec
;

53 
ty³Çme
 
	tAùiÚVec
::
	t™”©Ü
 
	tAùiÚVecIt
;

56 
ba£_wÜk”_t
* 
	m_owÃr
;

58 
	mgu¬d
<
	mAùiÚVec
> 
	m_fÜ_wr™”s
;

59 
	mgu¬d
<
	mAùiÚVec
> 
	m_fÜ_»ad”s
;

60 
AùiÚVecIt
 
	m_»ad_pos
;

61 
mcs_lock
 
	m_lock
;

62 vŞ©
	m_em±y
;

64 
eWÜkšgS‹
 
	m_my_ws
;

66 
	m_loİs
;

67 
	m_th»s
;

69 
¤mwqueue
(
PoŞ
* 
aùiÚPŒPoŞ
)

70 : 
_owÃr
(
NULL
), 
_em±y
(
Œue
), 
_my_ws
(
WS_UNDEF
),

71 
_loİs
(0), 
_th»s
(0)

73 
as£¹
 (
aùiÚPŒPoŞ
);

74 
	m_fÜ_wr™”s
 = 
Ãw
 
AùiÚVec
(
aùiÚPŒPoŞ
);

75 
	m_fÜ_»ad”s
 = 
Ãw
 
AùiÚVec
(
aùiÚPŒPoŞ
);

76 
	m_»ad_pos
 = 
_fÜ_»ad”s
->
begš
();

78 ~
¤mwqueue
() { }

82 
£tqueue
(
eWÜkšgS‹
 
aws
, 
ba£_wÜk”_t
* 
owÃr
, cÚ¡ & 
loİs
, cÚ¡ & 
th»s
)

84 
CRITICAL_SECTION
(
q_cs
, 
_lock
);

85 
	m_my_ws
 = 
aws
;

86 
	m_owÃr
 = 
owÃr
;

87 
	m_loİs
 = 
loİs
;

88 
	m_th»s
 = 
th»s
;

92 
boŞ
 
is_cÚŒŞ
(
ba£_wÜk”_t
* 
©h»ad
ècÚ¡ {  (
	m_owÃr
==athread); }

95 
šlše
 
is_em±y
() const {

96  ((
	m_»ad_pos
 =ğ
_fÜ_»ad”s
->
’d
()è&& (*&
_em±y
));

100 
boŞ
 
is_»®ly_em±y
()

102 
CRITICAL_SECTION
(
cs
, 
_lock
);

103 
boŞ
 
	misEm±y
 = ((
_»ad_pos
 =ğ
_fÜ_»ad”s
->
’d
()è&& (*&
_em±y
));

104 ià(
	misEm±y
è{ 
as£¹
 (
_fÜ_wr™”s
->
em±y
()); }

105  (
	misEm±y
);

109 
boŞ
 
wa™_fÜ_šput
()

111 
as£¹
 (
_owÃr
);

112 
	mloİút
 = 0;

113 
ušt_t
 
	mwc
 = 
WC_ACTIVE
;

116 *&
	m_em±y
) {

118 
	mwc
 = 
_owÃr
->
g‘_cÚŒŞ
();

122 ià(
	mwc
 !ğ
WC_ACTIVE
) {

123 
_owÃr
->
£t_ws
(
WS_FINISHED
);

124  (
	mçl£
);

128 ià(!
	m_owÃr
->
ÿn_cÚtšue
(
_my_ws
)è (
	mçl£
);

131 ià(++
	mloİút
 > 
	m_loİs
) {

132 
	mloİút
 = 0;

136 
	mloİút
 = 
_owÃr
->
cÚdex_¦“p
();

150 
CRITICAL_SECTION
(
cs
, 
_lock
);

151 
	m_fÜ_»ad”s
->
”a£
(
_fÜ_»ad”s
->
begš
(),_fÜ_»ad”s->
’d
());

152 
	m_fÜ_wr™”s
->
sw­
(*
_fÜ_»ad”s
);

153 
	m_em±y
 = 
Œue
;

156 
	m_»ad_pos
 = 
_fÜ_»ad”s
->
begš
();

157  (
	mŒue
);

160 
šlše
 
AùiÚ
* 
pİ
() {

162 ià((
	m_»ad_pos
 =ğ
_fÜ_»ad”s
->
’d
()è&& (!
wa™_fÜ_šput
()))

163  (
NULL
);

164  (*(
	m_»ad_pos
++));

167 
šlše
 
push
(
AùiÚ
* 
a
, cÚ¡ 
boŞ
 
bWake
) {

169 
	mqueue_sz
;

173 
CRITICAL_SECTION
(
cs
, 
_lock
);

174 
	m_fÜ_wr™”s
->
push_back
(
a
);

175 
	m_em±y
 = 
çl£
;

176 
	mqueue_sz
 = 
_fÜ_wr™”s
->
size
();

180 ià((
	mqueue_sz
 >ğ
_th»s
è|| 
bWake
) {

182 
_owÃr
->
£t_ws
(
_my_ws
);

187 
ş—r
(cÚ¡ 
boŞ
 
»moveOwÃr
=
Œue
) {

188 
CRITICAL_SECTION
(
q_cs
, 
_lock
);

191 ià(
	m»moveOwÃr
è
	m_owÃr
 = 
NULL
;

194 
	m_fÜ_wr™”s
->
”a£
(
_fÜ_wr™”s
->
begš
(),_fÜ_wr™”s->
’d
());

195 
	m_fÜ_»ad”s
->
”a£
(
_fÜ_»ad”s
->
begš
(),_fÜ_»ad”s->
’d
());

198 
	m_»ad_pos
 = 
_fÜ_»ad”s
->
begš
();

201 
	m_em±y
 = 
Œue
;

207 
EXIT_NAMESPACE
(
shÜe
);

	@include/trace/trace_force.h

32 #iâdeà
_TRACE_FORCE_H


33 
	#_TRACE_FORCE_H


	)

35 
	~<c¡d¬g
>

41 
	$Œaû_fÜû_
(cÚ¡ * 
f’ame
, 
lše_num
, cÚ¡ * 
funùiÚ_Çme
,

42 * 
fÜm©
, ...è
	`__©Œibu‹__
((
	`fÜm©
(
´štf
, 4, 5)));;

63 
	#TRACE_FORCE
(
fÜm©
, 
»¡
...è
	`Œaû_fÜû_
(
__FILE__
, 
__LINE__
, 
__FUNCTION__
, fÜm©, ##»¡)

	)

	@include/trace/trace_print_pthread.h

30 #iâdeà
_TRACE_PRINT_PTHREAD_H


31 
	#_TRACE_PRINT_PTHREAD_H


	)

33 
	~<±h»ad.h
>

34 
	~<c¡dio
>

40 
Œaû_´št_±h»ad
(
FILE
* 
out_¡»am
, 
±h»ad_t
 
th»ad
);

	@include/trace/trace_stream.h

30 #iâdeà
_TRACE_STREAM_H


31 
	#_TRACE_STREAM_H


	)

33 
	~<c¡dio
>

34 
	~<c¡d¬g
>

40 
Œaû_¡»am
(
FILE
* 
out_¡»am
,

41 cÚ¡ * 
f’ame
, 
lše_num
, cÚ¡ * 
funùiÚ_Çme
,

42 * 
fÜm©
, 
va_li¡
 
­
);

	@include/trace/trace_types.h

31 #iâdeà
__TRACE_TYPES_H


32 
	#__TRACE_TYPES_H


	)

38 
	#TRACE_COMPONENT_MASK_ALL
 (~0)

	)

39 
	#TRACE_COMPONENT_MASK_NONE
 0

	)

41 
	#TRACE_ALWAYS
 ()(1 << 0)

	)

42 
	#TRACE_TUPLE_FLOW
 ()(1 << 1)

	)

43 
	#TRACE_PACKET_FLOW
 ()(1 << 2)

	)

44 
	#TRACE_SYNC_COND
 ()(1 << 3)

	)

45 
	#TRACE_SYNC_LOCK
 ()(1 << 4)

	)

46 
	#TRACE_THREAD_LIFE_CYCLE
 ()(1 << 5)

	)

47 
	#TRACE_TEMP_FILE
 ()(1 << 6)

	)

48 
	#TRACE_CPU_BINDING
 ()(1 << 7)

	)

49 
	#TRACE_QUERY_RESULTS
 ()(1 << 8)

	)

50 
	#TRACE_QUERY_PROGRESS
 ()(1 << 9)

	)

51 
	#TRACE_STATISTICS
 ()(1 << 10)

	)

52 
	#TRACE_NETWORK
 ()(1 << 11)

	)

53 
	#TRACE_RESPONSE_TIME
 ()(1 << 12)

	)

54 
	#TRACE_WORK_SHARING
 ()(1 << 13)

	)

55 
	#TRACE_TRX_FLOW
 ()(1 << 14)

	)

56 
	#TRACE_KEY_COMP
 ()(1 << 15)

	)

57 
	#TRACE_RECORD_FLOW
 ()(1 << 16)

	)

58 
	#TRACE_DEBUG
 ()(1 << 31)

	)

	@include/util.h

24 #iâdeà
__UTIL_H


25 
	#__UTIL_H


	)

27 
	~"k_defšes.h
"

28 
	~"k™s-cÚfig.h
"

30 
	~"ut/Çme¥aû.h
"

31 
	~"ut/com·t.h
"

32 
	~"ut/c_¡r.h
"

33 
	~"ut/decim®.h
"

34 
	~"ut/exû±iÚ.h
"

35 
	~"ut/gu¬d.h
"

36 
	~"ut/¡İw©ch.h
"

37 
	~"ut/sync.h
"

38 
	~"ut/th»ad.h
"

39 
	~"ut/time_ut.h
"

40 
	~"ut/Œaû.h
"

41 
	~"ut/s£¹.h
"

42 
	~"ut/¿ndg’.h
"

43 
	~"ut/¡Üe_¡ršg.h
"

44 
	~"ut/poŞ_®loc.h
"

45 
	~"ut/fe.h
"

46 
	~"ut/´og»ss.h
"

47 
	~"ut/couÁdown.h
"

48 
	~"ut/cÚå¬£r.h
"

49 
	~"ut/’vv¬.h
"

50 
	~"ut/cÚdex.h
"

51 
	~"ut/¡l_poŞed_®loc.h
"

52 
	~"ut/¡l_poŞ.h
"

53 
	~"ut/ÿche.h
"

54 
	~"ut/¿ndom_šput.h
"

55 
	~"ut/©omic_İs.h
"

56 
	~"ut/w_¡¾ıy.h
"

57 
	~"ut/´oc¡©.h
"

58 
	~"ut/skew”.h
"

60 #ifdeà
HAVE_CPUMON


61 #ifdeà
HAVE_GLIBTOP


62 
	~"ut/lšux_´oc¡©.h
"

63 
	~"ut/tİšfo.h
"

64 #–ià
defšed
 (
HAVE_PROCFS
)

65 
	~"ut/sunos_´oc¡©.h
"

66 
	~"ut/´cšfo.h
"

70 
	~"ut/sh–l.h
"

73 #ifdeà
CFG_QPIPE


74 
	~"ut/exû±iÚ.h
"

75 
	~"ut/»sourû_poŞ.h
"

76 
	~"ut/»sourû_»Ëa£r.h
"

77 
	~"ut/»sourû_deş¬e.h
"

78 
	~"ut/hash_funùiÚs.h
"

79 
	~"ut/acouÁ”.h
"

80 
	~"ut/¡©ic_li¡.h
"

81 
	~"ut/rio.h
"

82 
	~"ut/âv.h
"

83 
	~"ut/tmpfe.h
"

84 
	~"ut/busy_d–ay.h
"

	@include/util/acounter.h

33 #iâdeà
_ACOUNTER_H


34 
	#_ACOUNTER_H


	)

36 
	~"ut/th»ad.h
"

37 
	~"ut/sync.h
"

43 şas 
	cacouÁ”_t
 {

45 
	m´iv©e
:

47 
±h»ad_mu‹x_t
 
_mu‹x
;

48 
	m_v®ue
;

50 
	mpublic
:

52 
	$acouÁ”_t
(
v®ue
=0)

53 : 
	`_mu‹x
(
	`th»ad_mu‹x_ü—‹
()),

54 
	$_v®ue
(
v®ue
)

58 ~
	$acouÁ”_t
() {

59 
	`th»ad_mu‹x_de¡roy
(
_mu‹x
);

60 
	}
}

62 
	$ãtch_ªd_šc
() {

63 
ü™iÿl_£ùiÚ_t
 
	`cs
(
_mu‹x
);

64  
_v®ue
++;

65 
	}
}

	@include/util/atomic_ops.h

32 #iâdeà
__ATOMIC_OPS_H


33 
	#__ATOMIC_OPS_H


	)

35 
	~"k_defšes.h
"

38 
	g‹m¶©e
<
şass
 
	gT
, 
	gsize
=(
T
)>

39 
	s©omic_ÿs_h–³r
 {

40 
T
 
İ”©Ü
()(T vŞ©e* 
rg‘
, T 
Şd_v®ue
, T 
Ãw_v®ue
);

44 
	g‹m¶©e
<
şass
 
	gT
>

45 
	g©omic_ÿs_h–³r
<
	gT
, (
	gušt32_t
)> {

46 
T
 
İ”©Ü
()(T vŞ©e* 
	grg‘
, T 
	gŞd_v®ue
, T 
	gÃw_v®ue
) {

47 
T
 
	g»suÉ
;

49 
T
* 
	g_t
;

50 
ušt32_t
* 
	g_i
;

51 } 
	gov
={&
Şd_v®ue
}, 
	gnv
={&
Ãw_v®ue
}, 
	gde¡
={&
»suÉ
};

52 uniÚ { 
T
 vŞ©e* 
	g_t
; 
ušt32_t
 vŞ©e* 
	g_i
; } 
	gx
={
rg‘
};

53 #ià
defšed
(
__¥¬cv9
)

54 *
	gde¡
.
	g_i
 = 
©omic_ÿs_32
(
x
.
_i
, *
ov
._i, *
nv
._i);

56 *
	gde¡
.
	g_i
 = 
__sync_v®_com·»_ªd_sw­
(
x
.
_i
, *
ov
._i, *
nv
._i);

58  *
	gde¡
.
	g_t
;

63 
	g‹m¶©e
<
şass
 
	gT
>

64 
	g©omic_ÿs_h–³r
<
	gT
, (
	gušt64_t
)> {

65 
T
 
İ”©Ü
()(T vŞ©e* 
	grg‘
, T 
	gŞd_v®ue
, T 
	gÃw_v®ue
) {

66 
T
 
	g»suÉ
;

68 
T
* 
	g_t
;

69 
ušt64_t
* 
	g_i
;

70 } 
	gov
={&
Şd_v®ue
}, 
	gnv
={&
Ãw_v®ue
}, 
	gde¡
={&
»suÉ
};

71 uniÚ { 
T
 vŞ©e* 
	g_t
; 
ušt64_t
 vŞ©e* 
	g_i
; } 
	gx
={
rg‘
};

72 #ifdeà
__¥¬cv9


73 *
	gde¡
.
	g_i
 = 
©omic_ÿs_64
(
x
.
_i
, *
ov
._i, *
nv
._i);

75 *
	gde¡
.
	g_i
 = 
__sync_v®_com·»_ªd_sw­
(
x
.
_i
, *
ov
._i, *
nv
._i);

77  *
	gde¡
.
	g_t
;

81 
	g‹m¶©e
<
şass
 
	gT
>

82 
T
 
	$©omic_ÿs
(
T
 vŞ©e* 
rg‘
, T 
Şd_v®ue
, T 
Ãw_v®ue
) {

83  
©omic_ÿs_h–³r
<
T
>()(
rg‘
, 
Şd_v®ue
, 
Ãw_v®ue
);

84 
	}
}

96 
	g‹m¶©e
<
şass
 
	gT
, 
	gsize
=(
T
)>

97 
	s©omic_sw­_h–³r
 {

98 
T
 
İ”©Ü
()(T vŞ©e* 
rg‘
, T 
Ãw_v®ue
);

102 
	g‹m¶©e
<
şass
 
	gT
>

103 
	g©omic_sw­_h–³r
<
	gT
, (
	gušt32_t
)> {

104 
T
 
İ”©Ü
()(T vŞ©e* 
	grg‘
, T 
	gÃw_v®ue
) {

105 
T
 
	g»suÉ
;

107 
T
* 
	g_t
;

108 
ušt32_t
* 
	g_i
;

109 } 
	gnv
={&
Ãw_v®ue
}, 
	gde¡
={&
»suÉ
};

110 uniÚ { 
T
 vŞ©e* 
	g_t
; 
ušt32_t
 vŞ©e* 
	g_i
; } 
	gx
={
rg‘
};

111 #ifdeà
__¥¬cv9


112 *
	gde¡
.
	g_i
 = 
©omic_sw­_32
(
x
.
_i
, *
nv
._i);

114 *
	gde¡
.
	g_i
 = 
__sync_lock_‹¡_ªd_£t
(
x
.
_i
, *
nv
._i);

116  *
	gde¡
.
	g_t
;

121 
	g‹m¶©e
<
şass
 
	gT
>

122 
	g©omic_sw­_h–³r
<
	gT
, (
	gušt64_t
)> {

123 
T
 
İ”©Ü
()(T vŞ©e* 
	grg‘
, T 
	gÃw_v®ue
) {

124 
T
 
	g»suÉ
;

126 
T
* 
	g_t
;

127 
ušt64_t
* 
	g_i
;

128 } 
	gnv
={&
Ãw_v®ue
}, 
	gde¡
={&
»suÉ
};

129 uniÚ { 
T
 vŞ©e* 
	g_t
; 
ušt64_t
 vŞ©e* 
	g_i
; } 
	gx
={
rg‘
};

130 #ifdeà
__¥¬cv9


131 *
	gde¡
.
	g_i
 = 
©omic_sw­_64
(
x
.
_i
, *
nv
._i);

133 *
	gde¡
.
	g_i
 = 
__sync_lock_‹¡_ªd_£t
(
x
.
_i
, *
nv
._i);

135  *
	gde¡
.
	g_t
;

139 
	g‹m¶©e
<
şass
 
	gT
>

140 
T
 
	$©omic_sw­
(
T
 vŞ©e* 
rg‘
, T 
Ãw_v®ue
) {

141  
©omic_sw­_h–³r
<
T
>()(
rg‘
, 
Ãw_v®ue
);

142 
	}
};

	@include/util/busy_delay.h

10 #iâdeà
_BUSY_DELAY_H


11 
	#_BUSY_DELAY_H


	)

16 
busy_d–ay_š™
();

17 
busy_d–ay_ms
(
ms
);

18 
busy_d–ay_us
(
us
);

	@include/util/c_str.h

24 #iâdeà
__C_STR_H


25 
	#__C_STR_H


	)

28 #iâdeà
_GNU_SOURCE


29 
	#_GNU_SOURCE


	)

32 
	~"k_defšes.h
"

33 
	~"ut/Çme¥aû.h
"

35 
	~"com·t.h
"

37 
	#DEBUG_C_STR
 0

	)

39 
usšg
 
Çme¥aû
 
	g¡d
;

57 
	sš™Ÿlize_®loÿtÜ
 {

58 
š™Ÿlize_®loÿtÜ
();

60 
š™Ÿlize_®loÿtÜ
 
	gc_¡r_sw©chz
;

62 şas 
	cc_¡r
 {

64 
	mc_¡r_d©a
;

65 
c_¡r_d©a
* 
	m_d©a
;

71 
»Ëa£
();

79 
assign
(cÚ¡ 
c_¡r
 &
Ùh”
);

81 
	mpublic
:

83 cÚ¡ 
c_¡r
 
EMPTY_STRING
;

86 
	$c_¡r
 (cÚ¡ 
c_¡r
 &
Ùh”
=
EMPTY_STRING
) {

87 ià(
DEBUG_C_STR
)

88 
	`´štf
("cİy cÚ¡ruùÜ w™h oth” = %s\n", 
Ùh”
.
	`d©a
());

89 
	`assign
(
Ùh”
);

94 
	$c_¡r
(cÚ¡ * 
¡r
, ...è
	`ATTRIBUTE
(
	`fÜm©
(
´štf
, 2, 3));

97 
İ”©Ü
 const *() const {

98  
	`d©a
();

99 
	}
}

102 cÚ¡ * 
	$d©a
() const;

105 ~
	$c_¡r
() {

106 ià(
DEBUG_C_STR
)

107 
	`´štf
("š c_¡¸de¡ruùÜ fÜ %s\n", 
	`d©a
());

108 
	`»Ëa£
();

109 
	}
}

112 
	gc_¡r
 &
	gİ”©Ü
=(cÚ¡ 
c_¡r
 &
Ùh”
) {

113 ià(
DEBUG_C_STR
)

114 
´štf
("š c_¡¸ğİ”©Ü,hi ğ%s, oth” = %s\n", 
d©a
(), 
Ùh”
.data());

115 if(
	g_d©a
 !ğ
Ùh”
.
_d©a
) {

116 
»Ëa£
();

117 
assign
(
Ùh”
);

119  *
	gthis
;

123 
boŞ
 
	gİ”©Ü
<(cÚ¡ 
	gc_¡r
 &
	gÙh”
) const {

124  
¡rcmp
(
d©a
(), 
Ùh”
.data()) < 0;

128 
boŞ
 
	gİ”©Ü
>(cÚ¡ 
	gc_¡r
 &
	gÙh”
) const {

129  
¡rcmp
(
d©a
(), 
Ùh”
.data()) > 0;

133 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
c_¡r
 &
Ùh”
) const {

134  
¡rcmp
(
d©a
(), 
Ùh”
.data()) == 0;

	@include/util/cache.h

31 #iâdeà
__UTIL_OBJECT_CACHE_H


32 
	#__UTIL_OBJECT_CACHE_H


	)

34 
	~"k_defšes.h
"

35 
	~"block_®loc.h
"

49 
	g‹m¶©e
 <
ty³Çme
 
	gObjeù
>

50 
şass
 
	gobjeù_ÿche_t
 : 
public
 
objeù_ÿche
<
Objeù
, 
	gobjeù_ÿche_š™Ÿlizšg_çùÜy
<
	gObjeù
> >

52 
	gpublic
:

55 
Objeù
* 
bÜrow
()

57 (
this
->
acquœe
());

62 
giveback
(
Objeù
* 
pObj
)

64 
	gthis
->
»Ëa£
(
pObj
);

	@include/util/chomp.h

24 #iâdeà
__UTIL_CHOMP_H


25 
	#__UTIL_CHOMP_H


	)

27 
chomp_Ãwlše
(* 
¡r
);

28 
chomp_ÿ¼Ÿge_»tuº
(* 
¡r
);

	@include/util/command/command_handler.h

32 #iâdeà
__CMD_HANDLER_H


33 
	#__CMD_HANDLER_H


	)

35 
	~"k_defšes.h
"

37 
	~<veùÜ
>

39 
	~"ut.h
"

41 
usšg
 
Çme¥aû
 
	g¡d
;

46 cÚ¡ 
	gSHELL_COMMAND_BUFFER_SIZE
 = 64;

47 cÚ¡ 
	gSHELL_NEXT_CONTINUE
 = 1;

48 cÚ¡ 
	gSHELL_NEXT_DISCONNECT
 = 2;

49 cÚ¡ 
	gSHELL_NEXT_QUIT
 = 3;

52 şas 
	ccommªd_hªdËr_t


54 
	mpublic
:

55 
veùÜ
<
	t¡ršg
> 
	t®ŸsLi¡
;

56 
	m®ŸsLi¡
::
	t™”©Ü
 
	t®ŸsIt
;

58 
	m´Ùeùed
:

59 
®ŸsLi¡
 
_®Ÿ£s
;

60 
¡ršg
 
	m_Çme
;

62 
	mpublic
:

64 
	$commªd_hªdËr_t
() { }

65 
vœtu®
 ~
	$commªd_hªdËr_t
(è{ 
	}
}

71 
vœtu®
 
	$š™
(è{ 
	}
};

72 
vœtu®
 
	$şo£
(è{ 
	}
};

75 
vœtu®
 
hªdË
(cÚ¡ * 
cmd
)=0;

79 
vœtu®
 
£lŸ£s
()=0;

80 
¡ršg
 
	$Çme
(ècÚ¡ {  (
_Çme
); 
	}
}

81 
®ŸsLi¡
* 
	$®Ÿ£s
(è{  (&
_®Ÿ£s
); 
	}
}

84 
vœtu®
 
	$u§ge
(è{ 
	}
};

87 
vœtu®
 
¡ršg
 
	$desc
() const=0;

89 
	}
};

	@include/util/command/printer.h

24 #iâdeà
__UTIL_CMD_PRINTER_H


25 
	#__UTIL_CMD_PRINTER_H


	)

28 
	~"ut/commªd/commªd_hªdËr.h
"

31 şas 
	c´š‹r_t
 : 
public
 
commªd_hªdËr_t


33 
public
:

34 
	$´š‹r_t
() { }

35 
vœtu®
 ~
	$´š‹r_t
(è{ 
	}
}

37 
vœtu®
 
hªdË_commªd
(cÚ¡ * 
commªd
);

39 
	$š™
(è{ 
	`as£¹
(0); 
	}
}

40 
	$şo£
(è{ 
	`as£¹
(0); 
	}
}

41 
	$hªdË
(cÚ¡ * ) {  (
SHELL_NEXT_CONTINUE
); 
	}
}

42 
	$£lŸ£s
(è{ 
	`as£¹
(0); 
	}
}

43 
	$u§ge
(è{ 
	`as£¹
(0); 
	}
}

44 
¡ršg
 
	$desc
(ècÚ¡ {  (
	`¡ršg
("")); 
	}
}

	@include/util/command/tracer.h

24 #iâdeà
__UTIL_CMD_TRACE_H


25 
	#__UTIL_CMD_TRACE_H


	)

28 
	~<m­
>

29 
	~"ut/commªd/commªd_hªdËr.h
"

30 
	~"ut.h
"

32 
usšg
 
	g¡d
::
m­
;

35 şas 
	cŒaû_cmd_t
 : 
public
 
commªd_hªdËr_t


37 
m­
<
c_¡r
, > 
	m_known_ty³s
;

39 
	mpublic
:

41 
	$Œaû_cmd_t
(è{ 
	`š™
(); }

42 ~
	$Œaû_cmd_t
(è{ 
	}
}

44 
š™
();

45 
	$şo£
(è{ 
	}
}

47 
hªdË
(cÚ¡ * 
cmd
);

49 
£lŸ£s
();

50 
u§ge
();

51 
¡ršg
 
	$desc
(ècÚ¡ {  (
	`¡ršg
("MªuÏ‹ Œacšg†ev–")); 
	}
}

53 
	g´iv©e
:

55 
’abË
(cÚ¡ * 
ty³
);

56 
di§bË
(cÚ¡ * 
ty³
);

57 
´št_’abËd_ty³s
();

58 
´št_known_ty³s
();

	@include/util/compat.h

24 #iâdeà
__COMPAT_H


25 
	#__COMPAT_H


	)

27 #ifdeà
__GCC


29 
	#ATTRIBUTE
(
x
è
	`__©Œibu‹__
((x))

	)

33 
	#ATTRIBUTE
(
x
)

	)

34 
	#__PRETTY_FUNCTION__
 
__func__


	)

35 
	#__FUNCTION__
 
__func__


	)

	@include/util/condex.h

24 #iâdeà
__UTIL_CONDEX_H


25 
	#__UTIL_CONDEX_H


	)

27 
	~<c¡dlib
>

38 
	scÚdex


40 
±h»ad_cÚd_t
 
	m_cÚd
;

41 
±h»ad_mu‹x_t
 
	m_lock
;

42 
	m_sigÇls
;

43 
	m_wa™s
;

45 
cÚdex
(è: 
_sigÇls
(0), 
_wa™s
(0) {

46 ià(
±h»ad_cÚd_š™
(&
_cÚd
,
NULL
)) {

47 
as£¹
 (0);

49 ià(
±h»ad_mu‹x_š™
(&
_lock
,
NULL
)) {

50 
as£¹
 (0);

54 ~
cÚdex
() {

55 
±h»ad_cÚd_de¡roy
(&
_cÚd
);

56 
±h»ad_mu‹x_de¡roy
(&
_lock
);

59 
sigÇl
() {

60 
CRITICAL_SECTION
(
cs
, 
_lock
);

61 
	m_sigÇls
++;

62 
±h»ad_cÚd_sigÇl
(&
_cÚd
);

65 
wa™
() {

66 
CRITICAL_SECTION
(
cs
, 
_lock
);

67 
	m_wa™s
++;

68 
	m_wa™s
 > 
	m_sigÇls
)

69 
±h»ad_cÚd_wa™
(&
_cÚd
,&
_lock
);

85 
	scÚdex_·œ


87 
cÚdex
 
	m_wa™
[2];

88 
	m_»que¡ed
;

89 
	m_wª‹d
;

90 
	m_wa™ed
;

92 
cÚdex_·œ
(è: 
_»que¡ed
(0), 
_wª‹d
(0), 
_wa™ed
(0) { }

94 ~
cÚdex_·œ
() { }

96 
¶—£_ke_Úe
() {

97 ++
	m_wª‹d
;

99 
cÚdex
* 
ke_Úe
() {

100 if(
	m_wª‹d
 > 
	m_»que¡ed
) {

101  &
	m_wa™
[
_»que¡ed
++ % 2];

103  
	mNULL
;

105 
wa™
() {

106 
w_as£¹1
(
_wa™ed
 < 
_»que¡ed
);

107 
	m_wa™
[
_wa™ed
++ %2].
wa™
();

	@include/util/config.h

24 #iâdeà
__UTIL_SERVER_CONFIG_H


25 
	#__UTIL_SERVER_CONFIG_H


	)

27 
	~"k™s-cÚfig.h
"

29 
	#SERVER_COMMAND_BUFFER_SIZE
 1024

	)

32 
	#SCLIENT_VERSION
 "v2.1"

	)

33 
	#SCLIENT_PROMPT
 "(¥¬è"

	)

37 
	#SCLIENT_DIRECTORY_NAME
 ".shÜek™s"

	)

38 
	#SCLIENT_HISTORY_FILE
 "hi¡Üy"

	)

40 
	#SCLIENT_NET_MODE_LISTEN_PORT
 10000

	)

	@include/util/confparser.h

68 #iâdeà
__UTIL_CONFPARSER_H


69 
	#__UTIL_CONFPARSER_H


	)

71 
	~"ut/Çme¥aû.h
"

73 
	~"k_defšes.h
"

75 
	~<m­
>

76 
	~<io¡»am
>

77 
	~<f¡»am
>

78 
	~<s¡»am
>

81 
usšg
 
	g¡d
::
¡ršg
;

83 
	sCÚfigO±iÚ


85 
¡ršg
 
	m_İt_Çme
;

86 
¡ršg
 
	m_İt_cÚfig_’Œy
;

87 
¡ršg
 
	m_İt_deçuÉ_v®ue
;

89 
CÚfigO±iÚ
(
¡ršg
 
Çme
, sŒšg 
’Œy
, sŒšg 
v®ue
) {

90 
	m_İt_Çme
 = 
Çme
;

91 
	m_İt_cÚfig_’Œy
 = 
’Œy
;

92 
	m_İt_deçuÉ_v®ue
 = 
v®ue
;

98 şas 
	cCÚfigFe


101 
	m´Ùeùed
:

102 
¡ršg
 
myD–im™”
;

103 
¡ršg
 
	mmyComm’t
;

104 
¡ršg
 
	mmyS’Œy
;

106 
	m¡d
::
m­
<
¡ršg
,
	m¡ršg
> 
	mmyCÚ‹Ás
;

107 
¡ršg
 
	m_âame
;

109 
	m¡d
::
	tm­
<
	t¡ršg
,¡ršg>::
	t™”©Ü
 
	tm­i
;

110 
	m¡d
::
	tm­
<
	t¡ršg
,¡ršg>::
	tcÚ¡_™”©Ü
 
	tm­ci
;

113 
	mpublic
:

114 
CÚfigFe
Ğ
¡ršg
 
f’ame
,

115 
¡ršg
 
d–im™”
 = "=",

116 
¡ršg
 
comm’t
 = "#",

117 
¡ršg
 
£Áry
 = "EndConfigFile" );

118 
CÚfigFe
();

121 
	m‹m¶©e
<
şass
 
	mT
> 
T
 
	$»ad
ĞcÚ¡ 
¡ršg
& 
key
 ) const;

122 
‹m¶©e
<
şass
 
T
> T 
	$»ad
ĞcÚ¡ 
¡ršg
& 
key
, cÚ¡ 
T
& 
v®ue
 ) const;

123 
‹m¶©e
<
şass
 
T
> 
boŞ
 
	$»adIÁo
Ğ
T
& 
v¬
, cÚ¡ 
¡ršg
& 
key
 ) const;

124 
‹m¶©e
<
şass
 
T
>

125 
boŞ
 
	$»adIÁo
Ğ
T
& 
v¬
, cÚ¡ 
¡ršg
& 
key
, cÚ¡ T& 
v®ue
 ) const;

128 
‹m¶©e
<
şass
 
T
> 
	`add
Ğ
¡ršg
 
key
, cÚ¡ T& 
v®ue
 );

129 
	`»move
ĞcÚ¡ 
¡ršg
& 
key
 );

132 
boŞ
 
	$keyExi¡s
ĞcÚ¡ 
¡ršg
& 
key
 ) const;

135 
¡ršg
 
	$g‘D–im™”
(ècÚ¡ {  
myD–im™”
; }

136 
¡ršg
 
	$g‘Comm’t
(ècÚ¡ {  
myComm’t
; 
	}
}

137 
¡ršg
 
	$g‘S’Œy
(ècÚ¡ {  
myS’Œy
; 
	}
}

139 
¡ršg
 
	$£tD–im™”
ĞcÚ¡ 
¡ršg
& 
s
 ) {

140 
¡ršg
 
Şd
 = 
myD–im™”
;

141 
myD–im™”
 = 
s
;

142  
Şd
;

143 
	}
}

145 
¡ršg
 
	$£tComm’t
ĞcÚ¡ 
¡ršg
& 
s
 ) {

146 
¡ršg
 
Şd
 = 
myComm’t
;

147 
myComm’t
 = 
s
;

148  
Şd
;

149 
	}
}

152 
§veCu¼’tCÚfig
();

155 
ä›nd
 
	g¡d
::
o¡»am
& 
İ”©Ü
<<Ğ
¡d
::o¡»am& 
os
, cÚ¡ 
	gCÚfigFe
& 
	gcf
 );

156 
ä›nd
 
	g¡d
::
i¡»am
& 
İ”©Ü
>>Ğ
¡d
::i¡»am& 
is
, 
	gCÚfigFe
& 
	gcf
 );

158 
	g´Ùeùed
:

159 
‹m¶©e
<
şass
 
T
> 
¡ršg
 
T_as_¡ršg
ĞcÚ¡ T& 
t
 );

160 
	g‹m¶©e
<
şass
 
	gT
> 
T
 
¡ršg_as_T
ĞcÚ¡ 
¡ršg
& 
s
 );

161 
Œim
Ğ
¡ršg
& 
s
 );

165 
	gpublic
:

166 
	sfe_nÙ_found
 {

167 
¡ršg
 
f’ame
;

168 
fe_nÙ_found
ĞcÚ¡ 
¡ršg
& 
f’ame_
 = string() )

169 : 
f’ame
(
f’ame_
) {} };

170 
	skey_nÙ_found
 {

171 
¡ršg
 
	gkey
;

172 
key_nÙ_found
ĞcÚ¡ 
¡ršg
& 
key_
 = string() )

173 : 
key
(
key_
) {} };

179 
	g‹m¶©e
<
şass
 
	gT
>

180 
¡ršg
 
	gCÚfigFe
::
	$T_as_¡ršg
ĞcÚ¡ 
T
& 
t
 )

184 
¡d
::
o¡ršg¡»am
 
o¡
;

185 
o¡
 << 
t
;

186  
o¡
.
	`¡r
();

187 
	}
}

191 
	g‹m¶©e
<
şass
 
	gT
>

192 
T
 
	gCÚfigFe
::
	$¡ršg_as_T
ĞcÚ¡ 
¡ršg
& 
s
 )

196 
T
 
t
;

197 
¡d
::
i¡ršg¡»am
 
	`i¡
(
s
);

198 
i¡
 >> 
t
;

199  
t
;

200 
	}
}

204 
	g‹m¶©e
<>

205 
šlše
 
¡ršg
 
	gCÚfigFe
::
¡ršg_as_T
<¡ršg>ĞcÚ¡ sŒšg& 
s
 )

209  
s
;

214 
	g‹m¶©e
<>

215 
šlše
 
boŞ
 
	gCÚfigFe
::
¡ršg_as_T
<boŞ>ĞcÚ¡ 
¡ršg
& 
s
 )

220 
boŞ
 
b
 = 
Œue
;

221 
¡ršg
 
	gsup
 = 
s
;

222  
	g¡ršg
::
™”©Ü
 
p
 = 
sup
.
begš
(); 
	gp
 !ğsup.
’d
(); ++p )

223 *
	gp
 = 
touµ”
(*
p
);

224 ifĞ
	gsup
==
¡ršg
("FALSE"è|| 
sup
==string("F") ||

225 
sup
==
¡ršg
("NO") || sup==string("N") ||

226 
sup
==
¡ršg
("0") || sup==string("NONE") )

227 
b
 = 
çl£
;

228  
	gb
;

232 
	g‹m¶©e
<
şass
 
	gT
>

233 
T
 
	gCÚfigFe
::
	$»ad
ĞcÚ¡ 
¡ršg
& 
key
 ) const

236 
m­ci
 
p
 = 
myCÚ‹Ás
.
	`fšd
(
key
);

237 ifĞ
p
 =ğ
myCÚ‹Ás
.
	`’d
(èè
throw
 
	`key_nÙ_found
(
key
);

238  
¡ršg_as_T
<
T
>Ğ
p
->
£cÚd
 );

239 
	}
}

242 
	g‹m¶©e
<
şass
 
	gT
>

243 
T
 
	gCÚfigFe
::
	$»ad
ĞcÚ¡ 
¡ršg
& 
key
, cÚ¡ 
T
& 
v®ue
 ) const

247 
m­ci
 
p
 = 
myCÚ‹Ás
.
	`fšd
(
key
);

248 ifĞ
p
 =ğ
myCÚ‹Ás
.
	`’d
(èè 
v®ue
;

249  
¡ršg_as_T
<
T
>Ğ
p
->
£cÚd
 );

250 
	}
}

253 
	g‹m¶©e
<
şass
 
	gT
>

254 
boŞ
 
	gCÚfigFe
::
	$»adIÁo
Ğ
T
& 
v¬
, cÚ¡ 
¡ršg
& 
key
 ) const

259 
m­ci
 
p
 = 
myCÚ‹Ás
.
	`fšd
(
key
);

260 
boŞ
 
found
 = ( 
p
 !ğ
myCÚ‹Ás
.
	`’d
() );

261 ifĞ
found
 ) 
v¬
 = 
¡ršg_as_T
<
T
>Ğ
p
->
£cÚd
 );

262  
found
;

263 
	}
}

266 
	g‹m¶©e
<
şass
 
	gT
>

267 
boŞ
 
	gCÚfigFe
::
	$»adIÁo
Ğ
T
& 
v¬
, cÚ¡ 
¡ršg
& 
key
, cÚ¡ T& 
v®ue
 ) const

272 
m­ci
 
p
 = 
myCÚ‹Ás
.
	`fšd
(
key
);

273 
boŞ
 
found
 = ( 
p
 !ğ
myCÚ‹Ás
.
	`’d
() );

274 ifĞ
found
 )

275 
v¬
 = 
¡ršg_as_T
<
T
>Ğ
p
->
£cÚd
 );

277 
v¬
 = 
v®ue
;

278  
found
;

279 
	}
}

282 
	g‹m¶©e
<
şass
 
	gT
>

283 
	gCÚfigFe
::
	$add
Ğ
¡ršg
 
key
, cÚ¡ 
T
& 
v®ue
 )

286 
¡ršg
 
v
 = 
	`T_as_¡ršg
Ğ
v®ue
 );

287 
	`Œim
(
key
);

288 
	`Œim
(
v
);

289 
myCÚ‹Ás
[
key
] = 
v
;

291 
	}
}

	@include/util/countdown.h

32 #iâdeà
__UTIL_COUNTDOWN_H


33 
	#__UTIL_COUNTDOWN_H


	)

35 
	~<ÿs£¹
>

37 
	~"k_defšes.h
"

39 
	scouÁdown_t


41 
	mpublic
:

44 
couÁdown_t
(
couÁ
=0è: 
_¡©e
(couÁ*
CD_NUMBER
) { }

48 
boŞ
 
po¡
(boŞ 
is_”rÜ
=
çl£
);

51 
»maššg
() const;

54 
»£t
(cÚ¡ 
ÃwcouÁ
);

56 
	m´iv©e
:

58 ’um { 
CD_ERROR
=0x1, 
	mCD_NUMBER
=0x2 };

59 vŞ©
	m_¡©e
;

62 
couÁdown_t
(countdown_t const &);

63 
	mİ”©Ü
=(
couÁdown_t
 const &);

68 
couÁdown_t
* 
	tcouÁdownPŒ
;

	@include/util/decimal.h

24 #iâdeà
__DECIMAL_H


25 
	#__DECIMAL_H


	)

27 
	~<¡dšt.h
>

32 şas 
	cdecim®
 {

33 
št64_t
 
	m_v®ue
;

34 
ex¶ic™
 
	$decim®
(
št64_t
 
v®ue
)

35 : 
	$_v®ue
(
v®ue
)

38 
public
:

39 
	$decim®
()

40 : 
	$_v®ue
(0)

42 
	}
}

43 
	$decim®
(
v®ue
)

44 : 
	`_v®ue
((
št64_t
è(
v®ue
*100))

46 
	}
}

47 
	$decim®
(
v®ue
)

48 : 
	`_v®ue
((
št64_t
è(
v®ue
*100))

50 
	}
}

51 
decim®
 &
İ”©Ü
+=(decim® cÚ¡ &
Ùh”
) {

52 
_v®ue
 +ğ
Ùh”
._value;

53  *
	gthis
;

55 
	gdecim®
 &
	gİ”©Ü
-=(
decim®
 cÚ¡ &
Ùh”
) {

56 
_v®ue
 -ğ
Ùh”
._value;

57  *
	gthis
;

59 
decim®
 
	gİ”©Ü
*=(decim® cÚ¡ &
Ùh”
) {

60 
_v®ue
 = (_v®ue*
Ùh”
._value+50)/100;

61  *
	gthis
;

63 
decim®
 
	gİ”©Ü
/=(decim® cÚ¡ &
Ùh”
) {

64 
_v®ue
 = (100*_v®ue+50)/
Ùh”
._value;

65  *
	gthis
;

68 
decim®
 
	gİ”©Ü
+(decim® cÚ¡ &
	gÙh”
) const {

69  
decim®
(*
this
è+ğ
Ùh”
;

71 
decim®
 
	gİ”©Ü
-(decim® cÚ¡ &
	gÙh”
) const {

72  
decim®
(*
this
è-ğ
Ùh”
;

74 
decim®
 
	gİ”©Ü
*(decim® cÚ¡ &
	gÙh”
) const {

75  
decim®
(*
this
è*ğ
Ùh”
;

77 
decim®
 
	gİ”©Ü
/(decim® cÚ¡ &
	gÙh”
) const {

78  
decim®
(*
this
è/ğ
Ùh”
;

81 
	gdecim®
 &
	gİ”©Ü
++() {

82 
	g_v®ue
 += 100;

83  *
	gthis
;

85 
decim®
 
	gİ”©Ü
++() {

86 
decim®
 
	gŞd
 = *
this
;

87 ++*
	gthis
;

88  
	gŞd
;

90 
	gdecim®
 &
	gİ”©Ü
--() {

91 
	g_v®ue
 -= 100;

92  *
	gthis
;

94 
decim®
 
	gİ”©Ü
--() {

95 
decim®
 
	gŞd
 = *
this
;

96 --*
	gthis
;

97  
	gŞd
;

101 
	$to_doubË
() const {

102  (()
_v®ue
/()100);

103 
	}
}

104 
	$to_lÚg
() const {

105  (
_v®ue
+50)/100;

106 
	}
}

107 
	$to_št
() const {

108  (è
	`to_lÚg
();

109 
	}
}

111 
boŞ
 
	gİ”©Ü
 <(
decim®
 cÚ¡ &
	gÙh”
) const {

112  
	g_v®ue
 < 
	gÙh”
._value;

114 
boŞ
 
	gİ”©Ü
 >(
decim®
 cÚ¡ &
	gÙh”
) const {

115  
	g_v®ue
 > 
	gÙh”
._value;

117 
boŞ
 
	gİ”©Ü
 ==(
decim®
 cÚ¡ &
Ùh”
) const {

118  
_v®ue
 =ğ
Ùh”
._value;

120 
boŞ
 
	gİ”©Ü
 <=(
decim®
 cÚ¡ &
Ùh”
) const {

121  
_v®ue
 <ğ
Ùh”
._value;

123 
boŞ
 
	gİ”©Ü
 >=(
decim®
 cÚ¡ &
Ùh”
) const {

124  
_v®ue
 >ğ
Ùh”
._value;

126 
boŞ
 
	gİ”©Ü
 !=(
decim®
 cÚ¡ &
Ùh”
) const {

127  
_v®ue
 !ğ
Ùh”
._value;

132 
šlše
 
decim®
 
	gİ”©Ü
+(
	ga
, decim® cÚ¡ &
	gb
) {

133  
decim®
(
a
è+ 
	gb
;

135 
šlše
 
decim®
 
	gİ”©Ü
-(
	ga
, decim® cÚ¡ &
	gb
) {

136  
decim®
(
a
è- 
	gb
;

138 
šlše
 
decim®
 
	gİ”©Ü
*(
	ga
, decim® cÚ¡ &
	gb
) {

139  
decim®
(
a
è* 
	gb
;

141 
šlše
 
decim®
 
	gİ”©Ü
/(
	ga
, decim® cÚ¡ &
	gb
) {

142  
decim®
(
a
è/ 
	gb
;

145 
šlše
 
decim®
 
	gİ”©Ü
+(
	ga
, decim® cÚ¡ &
	gb
) {

146  
decim®
(
a
è+ 
	gb
;

148 
šlše
 
decim®
 
	gİ”©Ü
-(
	ga
, decim® cÚ¡ &
	gb
) {

149  
decim®
(
a
è- 
	gb
;

151 
šlše
 
decim®
 
	gİ”©Ü
*(
	ga
, decim® cÚ¡ &
	gb
) {

152  
decim®
(
a
è* 
	gb
;

154 
šlše
 
decim®
 
	gİ”©Ü
/(
	ga
, decim® cÚ¡ &
	gb
) {

155  
decim®
(
a
è/ 
	gb
;

	@include/util/envvar.h

31 #iâdeà
__UTIL_ENVVAR_H


32 
	#__UTIL_ENVVAR_H


	)

34 
	~"k_defšes.h
"

36 
	~<io¡»am
>

38 
	~<m­
>

40 #ifdeà
HAVE_READLINE


41 
	~<»adlše/»adlše.h
>

42 
	~<»adlše/hi¡Üy.h
>

45 
	~<as£¹.h
>

46 
	~<sigÇl.h
>

47 
	~<”ºo.h
>

49 
	~"sm_vas.h
"

51 
	~"ut/Œaû.h
"

52 
	~"ut/gu¬d.h
"

53 
	~"ut/cÚå¬£r.h
"

55 
	~"ut.h
"

57 
usšg
 
Çme¥aû
 
	g¡d
;

81 cÚ¡ 
¡ršg
 
	gENVCONFFILE
 = "shore.conf";

82 cÚ¡ 
¡ršg
 
	gDEFAULTCONFIG
 = "tm1-1";

84 şas 
	c’vV¬


86 
	m´iv©e
:

88 
m­
<
	t¡ršg
,¡ršg> 
	t’vV¬M­
;

89 
	m’vV¬M­
::
	t™”©Ü
 
	t’vV¬It
;

90 
	m’vV¬M­
::
	tcÚ¡_™”©Ü
 
	t’vV¬CÚ¡It
;

92 
’vV¬M­
 
	m_evm
;

93 
¡ršg
 
	m_câame
;

94 
mcs_lock
 
	m_lock
;

95 
	mgu¬d
<
	mCÚfigFe
> 
	m_på¬£r
;

97 
	$’vV¬
(cÚ¡ 
¡ršg
 
sCÚfFe
=
ENVCONFFILE
)

98 : 
	$_câame
(
sCÚfFe
)

100 
	`w_as£¹0
 (!
_câame
.
	`em±y
());

101 
_på¬£r
 = 
Ãw
 
	`CÚfigFe
(
_câame
);

102 
	`w_as£¹0
 (
_på¬£r
);

104 ~
	$’vV¬
(è{ 
	}
}

108 
	g‹m¶©e
 <
şass
 
	gT
>

109 
¡ršg
 
	$_toSŒšg
(cÚ¡ 
T
& 
¬g
)

111 
o¡ršg¡»am
 
out
;

112 
out
 << 
¬g
;

113  (
out
.
	`¡r
());

114 
	}
}

118 
¡ršg
 
_»adCÚfV¬
(cÚ¡ sŒšg& 
sP¬am
, cÚ¡ sŒšg& 
sDefV®ue
);

120 
	gpublic
:

122 
’vV¬
* 
	$š¡ªû
(è{ 
’vV¬
 
_š¡ªû
;  (&_š¡ªû); 
	}
}

125 
»äeshV¬s
();

128 
£tV¬
(cÚ¡ 
¡ršg
& 
sP¬am
, cÚ¡ sŒšg& 
sV®ue
);

129 
£tV¬IÁ
(cÚ¡ 
¡ršg
& 
sP¬am
, cÚ¡ & 
iV®ue
);

134 
¡ršg
 
g‘V¬
(cÚ¡ sŒšg& 
sP¬am
, cÚ¡ sŒšg& 
sDefV®ue
);

135 
g‘V¬IÁ
(cÚ¡ 
¡ršg
& 
sP¬am
, cÚ¡ & 
iDefV®ue
);

136 
g‘V¬DoubË
(cÚ¡ 
¡ršg
& 
sP¬am
, cÚ¡ & 
iDefV®ue
);

140 
checkV¬
(cÚ¡ 
¡ršg
& 
sP¬am
);

143 
£tCÚfFe
(cÚ¡ 
¡ršg
& 
sCÚfFe
);

144 
¡ršg
 
	$g‘CÚfFe
() const;

147 
	`´štV¬s
();

150 
	`·r£OÃS‘Req
(cÚ¡ 
¡ršg
& 
š
);

153 
	`·r£S‘Req
(cÚ¡ 
¡ršg
& 
š
);

156 
	`£tCÚfigu¿tiÚ
(
¡ršg
 
sCÚfigu¿tiÚ
);

157 
¡ršg
 
	`g‘SysName
();

158 
	`£tSysName
(cÚ¡ 
¡ršg
& 
sysName
);

159 
¡ršg
 
	`g‘SysDesign
();

160 
	`£tSysDesign
(cÚ¡ 
¡ršg
& 
sysDesign
);

162 
¡ršg
 
	`g‘SysV¬
(¡ršg 
sP¬am
);

163 
	`g‘SysV¬IÁ
(
¡ršg
 
sP¬am
);

164 
	`g‘SysV¬DoubË
(
¡ršg
 
sP¬am
);

166 
	}
};

	@include/util/exception.h

2 #iâdeà
__EXCEPTION_H


3 
	#__EXCEPTION_H


	)

5 
	~<exû±iÚ
>

6 
	~<c¡ršg
>

7 
	~<û¼no
>

8 
	~<ÿs£¹
>

9 
	~<c¡dlib
>

10 
	~<c¡dio
>

12 
	~"ut/c_¡r.h
"

20 
	#EXCEPTION
(
ty³
,
__VA_ARGS__
) \

21 
	`ty³
(
__FILE__
, 
__LINE__
, 
__PRETTY_FUNCTION__
, 
	`c_¡r
(
__VA_ARGS__
))

	)

23 
	#THROW
(
ty³
, 
__VA_ARGS__
) \

24 
throw
 
	`ty³
(
__FILE__
, 
__LINE__
, 
__PRETTY_FUNCTION__
, 
	`c_¡r
(
__VA_ARGS__
)

	)

27 
	#THROW_IF
(
Exû±iÚ
, 
”r
) \

28 dØ{ if(
”r
è
throw
 
	`EXCEPTION
(
Exû±iÚ
, 
	`”ºo_to_¡r
Ó¼)); } 0)

	)

37 
	#EXCEPTION
(
ty³
) \

38 
	`ty³
(
__FILE__
, 
__LINE__
, 
__PRETTY_FUNCTION__
)

	)

39 
	#EXCEPTION1
(
ty³
, 
¬g
) \

40 
	`ty³
(
__FILE__
, 
__LINE__
, 
__PRETTY_FUNCTION__
, 
	`c_¡r
(
¬g
))

	)

41 
	#EXCEPTION2
(
ty³
, 
¬g1
, 
¬g2
) \

42 
	`ty³
(
__FILE__
, 
__LINE__
, 
__PRETTY_FUNCTION__
, 
	`c_¡r
(
¬g1
, 
¬g2
))

	)

45 
	#THROW
(
ty³
) \

47 
	`as£¹
(
çl£
); \

48 
throw
 
	`ty³
(
__FILE__
, 
__LINE__
, 
__PRETTY_FUNCTION__
, ""); \

49 } 
çl£
)

	)

50 
	#THROW1
(
ty³
, 
¬g
) \

52 
	`årštf
(
¡d”r
, 
¬g
); \

53 
	`fæush
(
¡d”r
); \

54 
	`as£¹
(
çl£
); \

55 
throw
 
	`ty³
(
__FILE__
, 
__LINE__
, 
__PRETTY_FUNCTION__
, 
	`c_¡r
(
¬g
)); \

56 } 
çl£
)

	)

58 
	#THROW2
(
ty³
, 
¬g1
, 
¬g2
) \

60 
	`årštf
(
¡d”r
, 
¬g1
, 
¬g2
); \

61 
	`fæush
(
¡d”r
); \

62 
	`as£¹
(
çl£
); \

63 
throw
 
	`ty³
(
__FILE__
, 
__LINE__
, 
__PRETTY_FUNCTION__
, 
	`c_¡r
(
¬g1
, 
¬g2
)); \

64 } 
çl£
)

	)

67 
	#THROW3
(
ty³
, 
¬g1
, 
¬g2
, 
¬g3
) \

69 
	`årštf
(
¡d”r
, 
¬g1
, 
¬g2
, 
¬g3
); \

70 
	`fæush
(
¡d”r
); \

71 
	`as£¹
(
çl£
); \

72 
throw
 
	`ty³
(
__FILE__
, 
__LINE__
, 
__PRETTY_FUNCTION__
, 
	`c_¡r
(
¬g1
, 
¬g2
, 
¬g3
)); \

73 } 
çl£
)

	)

75 
	#THROW4
(
ty³
, 
¬g1
, 
¬g2
, 
¬g3
, 
¬g4
) \

77 
	`årštf
(
¡d”r
, 
¬g1
, 
¬g2
, 
¬g3
, 
¬g4
); \

78 
	`fæush
(
¡d”r
); \

79 
	`as£¹
(
çl£
); \

80 
throw
 
	`ty³
(
__FILE__
, 
__LINE__
, 
__PRETTY_FUNCTION__
, 
	`c_¡r
(
¬g1
, 
¬g2
, 
¬g3
, 
¬g4
)); \

81 } 
çl£
)

	)

84 
	#THROW_IF
(
Exû±iÚ
, 
”r
) \

86 
	`as£¹
(!
”r
); \

87 if(
”r
) { \

88 
	`THROW1
(
Exû±iÚ
, 
	`”ºo_to_¡r
(
”r
)); \

90 } 
çl£
)

	)

97 şas 
	cQPeExû±iÚ
 : 
public
 
¡d
::
exû±iÚ


100 
´iv©e
:

102 
c_¡r
 
_mes§ge
;

104 
	mpublic
:

106 
	$QPeExû±iÚ
(cÚ¡ * 
f’ame
, 
lše_num
, cÚ¡ * 
funùiÚ_Çme
,

107 
c_¡r
 cÚ¡ &
m
)

108 : 
	`_mes§ge
(
	`c_¡r
("%s:%d (%s):%s", 
f’ame
, 
lše_num
, 
funùiÚ_Çme
, 
m
.
	$d©a
()))

112 
vœtu®
 cÚ¡ * 
	$wh©
(ècÚ¡ 
	$throw
() {

113  
_mes§ge
.
	`d©a
();

114 
	}
}

116 
	gvœtu®
 ~
	$QPeExû±iÚ
(è
	$throw
(è{ 
	}
}

119 
	#DEFINE_EXCEPTION
(
Name
) \

120 şas 
	cName
 : 
public
 
QPeExû±iÚ
 { \

121 
public
: \

122 
	`Name
(cÚ¡ * 
f’ame
, 
lše_num
, cÚ¡ * 
funùiÚ_Çme
, \

123 cÚ¡ * 
m
) \

124 : 
	`QPeExû±iÚ
(
f’ame
, 
lše_num
, 
funùiÚ_Çme
, 
m
) \

127 }

	)

129 
šlše
 
c_¡r
 
	$”ºo_to_¡r
(
”r
=
”ºo
) {

130  
	`¡»¼Ü
(
”r
);

131 
	}
}

133 
DEFINE_EXCEPTION
(
UÄ—chabË
);

134 
DEFINE_EXCEPTION
(
BadAÎoc
);

135 
DEFINE_EXCEPTION
(
OutOfRªge
);

136 
DEFINE_EXCEPTION
(
FeExû±iÚ
);

137 
DEFINE_EXCEPTION
(
BdbExû±iÚ
);

139 #ifdeà
__GCC


140 
šlše
 
	$uÄ—chabË
(è
	`ATTRIBUTE
(
nÜ‘uº
);

141 
šlše
 
	$uÄ—chabË
() {

142 
	`as£¹
(
çl£
);

143 
	`ex™
(-1);

144 
	}
}

146 
	#uÄ—chabË
(è
	`THROW
(
UÄ—chabË
)

	)

	@include/util/file.h

31 #iâdeà
__RAII_FILE_H


32 
	#__RAII_FILE_H


	)

35 
	~<c¡dlib
>

37 
	~<io¡»am
>

38 
	~<¡dexû±
>

39 
	~<sys/ty³s.h
>

42 şas 
	cfe
 {

43 
	m´iv©e
:

44 
¡d
::
FILE
* 
_fe_hªdË
 ;

48 
fe
( const file & ) ;

49 
	mfe
 & 
	mİ”©Ü
=ĞcÚ¡ 
fe
 & ) ;

51 
	mpublic
:

52 
fe
ĞcÚ¡ * 
f’ame
, cÚ¡ * 
mode
 = "r+" ) :

53 
_fe_hªdË
(
¡d
::
	$fİ’
(
f’ame
, 
mode
))

55 ifĞ!
_fe_hªdË
 )

56 
throw
 
¡d
::
	`ruÁime_”rÜ
("file open failure") ;

59 ~
	$fe
() {

60 ifĞ
¡d
::
	`fşo£
(
_fe_hªdË
) != 0 ) {

63 
	}
}

65 
	$wr™e
(cÚ¡ * 
¡r
) {

66 ifĞ
¡d
::
	`åuts
(
¡r
, 
_fe_hªdË
è=ğ
EOF
 )

67 
throw
 
¡d
::
	`ruÁime_”rÜ
("file write failure") ;

68 
	}
}

70 * 
	$»ad
(* 
de¡
, 
size_t
 
Ëngth
) {

71  (
¡d
::
	`fg‘s
(
de¡
, 
Ëngth
, 
_fe_hªdË
));

73 
	}
}

75 
	$æush
() {

76 
¡d
::
cout
 << "æushšg" << std::
’dl
;

77 
¡d
::
	`fæush
(
_fe_hªdË
);

78 
	}
}

	@include/util/fileops.h

33 #iâdeà
__UTIL_FILEOPS_H


34 
	#__UTIL_FILEOPS_H


	)

39 
	#FILEOPS_MAX_PATH_SIZE
 1024

	)

40 
	#FILEOPS_ERROR_NOT_FOUND
 -1

	)

41 
	#FILEOPS_ERROR_NOT_DIRECTORY
 -2

	)

42 
	#FILEOPS_ERROR_PATH_TOO_LONG
 -3

	)

43 
	#FILEOPS_ERROR_PERMISSION_DENIED
 -4

	)

48 
feİs_check_fe_exi¡s
 (cÚ¡ * 
·th
);

49 
feİs_check_fe_dœeùÜy
 (cÚ¡ * 
·th
);

50 
feİs_check_fe_»adabË
 (cÚ¡ * 
·th
);

51 
feİs_check_fe_wr™—bË
 (cÚ¡ * 
·th
);

52 
feİs_check_fe_execubË
(cÚ¡ * 
·th
);

54 
feİs_check_dœeùÜy_acûssibË
(cÚ¡ * 
·th
);

55 
feİs_check_fe_ü—bË
 (cÚ¡ * 
·th
);

57 
feİs_·r£_·»Á_dœeùÜy
(* 
d¡
, 
d¡_size
, cÚ¡ * 
¤c
);

	@include/util/fnv.h

76 #ià!
defšed
(
__FNV_H__
)

77 
	#__FNV_H__


	)

79 
	~<¡dlib.h
>

80 
	~<¡dšt.h
>

81 
	~<c¡ddef
>

95 cÚ¡ 
ušt32_t
 
	gFNV_INIT
 = (uint32_t) 0x811c9dc5;

98 
ušt32_t
 
âv_hash
(cÚ¡ *
buf
, 
size_t
 
Ën
, ušt32_ˆ
hashv®
=
FNV_INIT
);

	@include/util/guard.h

24 #iâdeà
__UTIL_GUARD_H


25 
	#__UTIL_GUARD_H


	)

27 
	~<c¡dio
>

28 
	~<ÿs£¹
>

29 
	~<c¡ddef
>

30 
	~<uni¡d.h
>

31 
	~"ut/Œaû.h
"

32 
	~"ut/exû±iÚ.h
"

36 
	#®ignm’tof
(
ty³
è(
®ignm’t_of
<ty³>())

	)

37 
	g‹m¶©e
<
ty³Çme
 
	gT
>

38 
šlše
 
size_t
 
	$®ignm’t_of
() {

39 
	sS
 {

40 
c
;

41 
T
 
t
;

43  
	`off£tof
(
S
, 
t
);

44 
	}
}

46 
šlše
 
	$‹¡_®ignm’t
(cÚ¡* 
±r
, 
®ign
) {

48 cÚ¡* 
p
;

49 
size_t
 
i
;

50 } 
u
;

51 
u
.
p
 = 
±r
;

54 
	`as£¹
((
®ign
 & -align) ==‡lign);

57 
	`as£¹
(((
®ign
-1è& 
u
.
i
) == 0);

58 
	}
}

60 
	g‹m¶©e
<
şass
 
	gT
>

61 
šlše
 
T
* 
	$®igÃd_ÿ¡
(cÚ¡* 
±r
) {

63 cÚ¡* 
p
;

64 
T
* 
t
;

65 
size_t
 
i
;

66 } 
u
;

67 
u
.
p
 = 
±r
;

70 
	`as£¹
(((
	`®ignm’tof
(
T
)-1è& 
u
.
i
) == 0);

71  
u
.
t
;

72 
	}
}

90 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

91 şas 
	cgu¬d
 {

92 
	m´iv©e
:

93 
T
* 
_±r
;

95 
	m´iv©e
:

98 
	$aùiÚ
(
T
* 
±r
) {

99 
d–‘e
 
±r
;

110 
public
:

112 
	$gu¬d
(
T
* 
±r
=
NULL
)

113 : 
	$_±r
(
±r
)

115 
	}
}

116 
	$gu¬d
(
gu¬d
 &
Ùh”
)

117 : 
	`_±r
(
Ùh”
.
	$»Ëa£
())

119 
	}
}

137 
gu¬d
(guard const &);

138 
	ggu¬d
 &
	gİ”©Ü
 =(cÚ¡ 
gu¬d
 &);

141 
	ggu¬d
 &
	gİ”©Ü
 =(
gu¬d
 &
Ùh”
) {

142 
assign
(
Ùh”
.
»Ëa£
());

143  *
	gthis
;

145 
	ggu¬d
 &
	gİ”©Ü
 =(
T
* 
±r
) {

146 
assign
(
±r
);

147  *
	gthis
;

150 
İ”©Ü
 
	gT
*() {

151  
g‘
();

153 
İ”©Ü
 
T
 const*() const {

154  
g‘
();

157 
	gT
 &
	gİ”©Ü
 *() {

158  *
g‘
();

160 
T
 cÚ¡ &
	gİ”©Ü
 *() const {

161  *
g‘
();

164 
T
* 
	gİ”©Ü
 ->() {

165  
g‘
();

167 
T
 cÚ¡* 
	gİ”©Ü
 ->() const {

168  
g‘
();

171 
T
* 
	$g‘
() {

172  
_±r
;

173 
	}
}

174 
T
 cÚ¡* 
	$g‘
() const {

175  
_±r
;

176 
	}
}

186 
T
* 
	$»Ëa£
() {

187 
T
* 
±r
 = 
_±r
;

188 
_±r
 = 
NULL
;

189  
±r
;

190 
	}
}

196 
	$dÚe
() {

197 
	`assign
(
NULL
);

198 
	}
}

200 ~
	$gu¬d
() {

201 
	`dÚe
();

202 
	}
}

204 
	g´iv©e
:

205 
	$assign
(
T
* 
±r
) {

206 if(
_±r
 && _±¸!ğ
±r
)

207 
	`aùiÚ
(
_±r
);

208 
_±r
 = 
±r
;

209 
	}
}

213 
	g‹m¶©e
<>

214 
šlše
 
	ggu¬d
<
	gFILE
>::
	$aùiÚ
(
FILE
* 
±r
) {

215 if(
	`fşo£
(
±r
))

216 
	`TRACE
(
TRACE_ALWAYS
, "fclose failed");

217 
	}
}

241 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gIm¶
>

242 şas 
	cgu¬d_ba£_t
 {

243 
	m´Ùeùed
:

244 
mubË
 
T
 
_obj
;

246 
	mpublic
:

247 
gu¬d_ba£_t
<
	tT
, 
	tIm¶
> 
	tBa£
;

252 
T
 
	$nuÎ_v®ue
() {

253  
NULL
;

255 
boŞ
 
	$difã»Á
(cÚ¡ 
T
 &
a
, cÚ¡ T &
b
) {

256  
a
 !ğ
b
;

257 
	}
}

259 
	$gu¬d_ba£_t
(
T
 
obj
)

260 : 
	$_obj
(
obj
)

262 
	}
}

263 
	$gu¬d_ba£_t
(cÚ¡ 
gu¬d_ba£_t
 &
Ùh”
)

264 : 
	`_obj
(
Ùh”
.
	$»Ëa£
())

266 
	}
}

267 
gu¬d_ba£_t
 &
İ”©Ü
 =(cÚ¡ gu¬d_ba£_ˆ&
Ùh”
) {

268 
assign
(
Ùh”
.
»Ëa£
());

269  *
	gthis
;

272 
İ”©Ü
 
	$T
() const {

273  
	`g‘
();

274 
	}
}

276 
T
 
	$g‘
() const {

277  
_obj
;

278 
	}
}

288 
T
 
	$»Ëa£
() const {

289 
T
 
obj
 = 
_obj
;

290 
_obj
 = 
Im¶
::
	`nuÎ_v®ue
();

291  
obj
;

292 
	}
}

298 
	$dÚe
() const {

299 
	`assign
(
Im¶
::
	`nuÎ_v®ue
());

300 
	}
}

302 ~
	$gu¬d_ba£_t
() {

303 
	`dÚe
();

304 
	}
}

306 
	g´Ùeùed
:

307 
	$assign
(
T
 
obj
) const {

308 if(
Im¶
::
	`difã»Á
(
_obj
, 
obj
)) {

310 
Im¶
::
	`gu¬d_aùiÚ
(
_obj
);

311 
_obj
 = 
obj
;

313 
	}
}

317 
	g‹m¶©e
 <
ty³Çme
 
	gT
,y³Çm
	gIm¶
>

318 
	gpoš‹r_gu¬d_ba£_t
 : 
gu¬d_ba£_t
<
T
*, 
	gIm¶
> {

319 
	ggu¬d_ba£_t
<
	tT
*, 
	tIm¶
> 
	tBa£
;

320 
poš‹r_gu¬d_ba£_t
(
T
* 
±r
)

321 : 
Ba£
(
±r
)

324 
T
 &
İ”©Ü
 *() const {

325  *
Ba£
::
g‘
();

327 
İ”©Ü
 
	gT
*() const {

328  
	gBa£
::
g‘
();

330 
T
* 
	gİ”©Ü
 ->() const {

331  
	gBa£
::
g‘
();

340 
	g‹m¶©e
 <
şass
 
	gT
>

341 
	gpoš‹r_gu¬d_t
 : 
poš‹r_gu¬d_ba£_t
<
T
,…oš‹r_gu¬d_t<
	gT
> > {

342 
poš‹r_gu¬d_t
(
T
* 
±r
=
NULL
)

343 : 
poš‹r_gu¬d_ba£_t
<
T
, 
	gpoš‹r_gu¬d_t
<
	gT
> >(
	g±r
)

346 
gu¬d_aùiÚ
(
T
* 
±r
) {

347 
d–‘e
 
	g±r
;

357 
	g‹m¶©e
 <
şass
 
	gT
>

358 
	g¬¿y_gu¬d_t
 : 
poš‹r_gu¬d_ba£_t
<
T
,‡¼ay_gu¬d_t<
	gT
> > {

359 
¬¿y_gu¬d_t
(
T
 *
±r
=
NULL
)

360 : 
poš‹r_gu¬d_ba£_t
<
T
, 
	g¬¿y_gu¬d_t
<
	gT
> >(
	g±r
)

363 
gu¬d_aùiÚ
(
T
 *
±r
) {

364 
	gd–‘e
 [] 
	g±r
;

373 
	gfe_gu¬d_t
 : 
poš‹r_gu¬d_ba£_t
<
FILE
, file_guard_t> {

374 
fe_gu¬d_t
(
FILE
 *
±r
=
NULL
)

375 : 
poš‹r_gu¬d_ba£_t
<
FILE
, 
	gfe_gu¬d_t
>(
	g±r
)

378 
gu¬d_aùiÚ
(
FILE
 *
±r
) {

379 if(
	g±r
 && 
fşo£
(
±r
)) {

380 
TRACE
(
TRACE_ALWAYS
,

389 
	gfd_gu¬d_t
 : 
gu¬d_ba£_t
<, fd_guard_t> {

390 
fd_gu¬d_t
(
fd
)

391 : 
gu¬d_ba£_t
<, 
	gfd_gu¬d_t
>(
	gfd
)

394 
gu¬d_aùiÚ
(
fd
) {

395 if(
	gfd
 >ğ0 && 
şo£
(
fd
))

396 
TRACE
(
TRACE_ALWAYS
, "close() failed in guard destructor");

398 
nuÎ_v®ue
() {

	@include/util/hash_functions.h

2 #iâdeà
__HASH_FUNCTION_H


3 
	#__HASH_FUNCTION_H


	)

8 
RSHash
 (cÚ¡ * 
¡r
, 
Ën
);

9 
JSHash
 (cÚ¡ * 
¡r
, 
Ën
);

10 
PJWHash
 (cÚ¡ * 
¡r
, 
Ën
);

11 
ELFHash
 (cÚ¡ * 
¡r
, 
Ën
);

12 
BKDRHash
(cÚ¡ * 
¡r
, 
Ën
);

13 
SDBMHash
(cÚ¡ * 
¡r
, 
Ën
);

14 
DJBHash
 (cÚ¡ * 
¡r
, 
Ën
);

15 
DEKHash
 (cÚ¡ * 
¡r
, 
Ën
);

16 
APHash
 (cÚ¡ * 
¡r
, 
Ën
);

	@include/util/hashtable.h

24 #iâdeà
__UTIL_HASHTABLE_H


25 
	#__UTIL_HASHTABLE_H


	)

27 
	~<c¡dlib
>

28 
	~<ut™y
>

29 
	~"ut/gu¬d.h
"

31 
usšg
 
	g¡d
::
·œ
;

51 
	g‹m¶©e
 <
şass
 
	gD©a
, cÏs 
	gKey
, cÏs 
	gExŒaùKey
, cÏs 
	gEqu®Key
, cÏs 
	gEqu®D©a
, cÏs 
	gHashFú
>

52 şas 
	chashbË
 {

54 
	m´iv©e
:

57 
_ÿ·c™y
;

58 
	m_size
;

59 
	m¬¿y_gu¬d_t
<
	mD©a
> 
	m_d©a
;

60 
	m¬¿y_gu¬d_t
<
	mboŞ
> 
	m_exi¡s
;

63 
ExŒaùKey
 
	m_exŒaùkey
;

64 
Equ®Key
 
	m_equ®key
;

65 
Equ®D©a
 
	m_equ®d©a
;

66 
HashFú
 
	m_hashfú
;

69 
	mpublic
:

72 
	$hashbË
(
ÿ·c™y
, 
ExŒaùKey
 
exŒaùkey
,

73 
Equ®Key
 
equ®key
, 
Equ®D©a
 
equ®d©a
, 
HashFú
 
hashfú
)

74 : 
	`_ÿ·c™y
(
ÿ·c™y
)

75 , 
	`_size
(0)

76 , 
	`_d©a
(
Ãw
 
D©a
[
ÿ·c™y
])

77 , 
	`_exi¡s
(
Ãw
 
boŞ
[
ÿ·c™y
])

78 , 
	`_exŒaùkey
(
exŒaùkey
)

79 , 
	`_equ®key
(
equ®key
)

80 , 
	`_equ®d©a
(
equ®d©a
)

81 , 
	$_hashfú
(
hashfú
)

84 
i
 = 0; i < 
ÿ·c™y
; i++) {

85 
_exi¡s
[
i
] = 
çl£
;

93 
	$š£¹_nÜesize
(
D©a
 
d
) {

96 
	`as£¹
(
_size
 < 
_ÿ·c™y
);

97 
size_t
 
hash_code
 = 
	`_hashfú
(
	`_exŒaùkey
(
d
));

98 
hash_pos
 = ()(
hash_code
 % (
size_t
)
_ÿ·c™y
);

101 
pos
;

104 
pos
 = 
hash_pos
;

105 (
pos
 < 
_ÿ·c™y
è&& 
_exi¡s
[pos];…os++);

106 ià(
pos
 =ğ
_ÿ·c™y
) {

109 
pos
 = 0;

110 (
pos
 < 
_ÿ·c™y
è&& 
_exi¡s
[pos];…os++);

115 
	`as£¹
(
pos
 !ğ
_ÿ·c™y
);

116 
	`as£¹
(! 
_exi¡s
[
pos
] );

118 
_d©a
[
pos
] = 
d
;

119 
_exi¡s
[
pos
] = 
Œue
;

120 
_size
++;

121 
	}
}

127 
boŞ
 
	$š£¹_unique_nÜesize
(
D©a
 
d
) {

130 
size_t
 
hash_code
 = 
	`_hashfú
(
	`_exŒaùkey
(
d
));

131 
hash_pos
 = ()(
hash_code
 % (
size_t
)
_ÿ·c™y
);

133 
pos
;

137 
pos
 = 
hash_pos
;

138 (
pos
 < 
_ÿ·c™y
)

139 && 
_exi¡s
[
pos
]

140 && !
	`_equ®d©a
(
_d©a
[
pos
],
d
);…os++);

141 ià(
pos
 =ğ
_ÿ·c™y
) {

144 
pos
 = 
hash_pos
;

145 (
pos
 < 
_ÿ·c™y
)

146 && 
_exi¡s
[
pos
]

147 && !
	`_equ®d©a
(
_d©a
[
pos
],
d
);…os++);

154 
	`as£¹
(
pos
 !ğ
_ÿ·c™y
);

156 ià(!
_exi¡s
[
pos
]) {

158 
_d©a
[
pos
] = 
d
;

159 
_exi¡s
[
pos
] = 
Œue
;

160 
_size
++;

161  
Œue
;

166 
	`as£¹
Ğ
	`_equ®d©a
(
_d©a
[
pos
],
d
) );

167  
çl£
;

168 
	}
}

174 
boŞ
 
	$cÚšs
(
D©a
 
d
) {

177 
size_t
 
hash_code
 = 
	`_hashfú
(
	`_exŒaùkey
(
d
));

178 
hash_pos
 = ()(
hash_code
 % (
size_t
)
_ÿ·c™y
);

180 
pos
;

184 
pos
 = 
hash_pos
;

185 (
pos
 < 
_ÿ·c™y
)

186 && 
_exi¡s
[
pos
]

187 && !
	`_equ®d©a
(
_d©a
[
pos
],
d
);…os++);

188 ià(
pos
 =ğ
_ÿ·c™y
) {

191 
pos
 = 
hash_pos
;

192 (
pos
 < 
_ÿ·c™y
)

193 && 
_exi¡s
[
pos
]

194 && !
	`_equ®d©a
(
_d©a
[
pos
],
d
);…os++);

197 ià(
pos
 =ğ
_ÿ·c™y
) {

199  
çl£
;

202 ià(!
_exi¡s
[
pos
]) {

204  
çl£
;

208 
	`as£¹
(
	`_equ®d©a
(
_d©a
[
pos
],
d
));

209  
Œue
;

210 
	}
}

213 
	$ş—r
() {

214 
i
 = 0; i < 
_ÿ·c™y
; i++)

215 
_exi¡s
[
i
] = 
çl£
;

216 
_size
 = 0;

217 
	}
}

225 şas 
	c™”©Ü
 {

227 
	g´iv©e
:

230 
hashbË
* 
_·»Á
;

233 
Key
 
	g_key
;

236 
	g_¡¬t_šdex
;

237 
	g_cu¼_šdex
;

241 
boŞ
 
	g_is_’d
;

244 
	gpublic
:

246 
™”©Ü
()

247 : 
_·»Á
(
NULL
)

248 , 
_is_’d
(
Œue
)

252 
™”©Ü
(
hashbË
* 
·»Á
)

253 : 
_·»Á
(
·»Á
)

254 , 
_is_’d
(
Œue
)

258 
™”©Ü
(
hashbË
* 
·»Á
, 
Key
 cÚ¡& 
key
, 
¡¬t_šdex
)

259 : 
_·»Á
(
·»Á
)

260 , 
_key
(
key
)

261 , 
_¡¬t_šdex
(
¡¬t_šdex
)

262 , 
_cu¼_šdex
(
¡¬t_šdex
)

263 , 
_is_’d
(
çl£
)

266 ià(!
	g·»Á
->
	g_exi¡s
[
¡¬t_šdex
]) {

267 
	g_is_’d
 = 
Œue
;

273 ià(
	g·»Á
->
_equ®key
(
key
, 
·»Á
->
_exŒaùkey
Õ¬’t->
_d©a
[
¡¬t_šdex
])))

278 ++*
	gthis
;

281 
boŞ
 
	gİ”©Ü
 ==(cÚ¡ 
™”©Ü
 &
Ùh”
) const {

284 ià(
_is_’d
)

285  
Ùh”
.
_is_’d
;

286 ià(
	gÙh”
.
	g_is_’d
)

287  
	g_is_’d
;

291 
as£¹
(
_·»Á
 =ğ
Ùh”
._parent);

296 
	g_¡¬t_šdex
 =ğ
Ùh”
.
_¡¬t_šdex


297 && 
_cu¼_šdex
 =ğ
Ùh”
._curr_index

298 && 
_·»Á
->
_equ®key
(
_key
, 
Ùh”
._key)

302 
boŞ
 
	gİ”©Ü
 !=(cÚ¡ 
™”©Ü
 &
Ùh”
) const {

303  !(*
this
 =ğ
Ùh”
);

306 
	gD©a
& 
	gİ”©Ü
*() {

307  *
g‘
();

310 
D©a
* 
	gİ”©Ü
 ->() {

311  
g‘
();

314 
D©a
* 
g‘
() {

316 
as£¹
(!
_is_’d
);

319 
TRACE
(
TRACE_ALWAYS
, "Looking‡t data %s stored‡t…osition %d\n",

320 
_·»Á
->
_d©a
[
_cu¼_šdex
],

321 
_cu¼_šdex
);

324  &
	g_·»Á
->
	g_d©a
[
_cu¼_šdex
];

327 
	g™”©Ü
 &
	gİ”©Ü
 ++() {

329 
as£¹
(!
_is_’d
);

331 
	gcu¼
 = 
_cu¼_šdex
;

339 if(++
	gcu¼
 =ğ
_·»Á
->
_ÿ·c™y
)

340 
cu¼
 = 0;

343 ià(!
	g_·»Á
->
	g_exi¡s
[
cu¼
]) {

344 
	g_is_’d
 = 
Œue
;

345  *
	gthis
;

348 ià(
	gcu¼
 =ğ
_¡¬t_šdex
) {

350 
_is_’d
 = 
Œue
;

351  *
	gthis
;

354 ià(
	g_·»Á
->
_equ®key
(
_key
, 
_·»Á
->
_exŒaùkey
(_·»Á->
_d©a
[
cu¼
]))) {

355 
	g_cu¼_šdex
 = 
cu¼
;

356  *
	gthis
;

361 
™”©Ü
 
	gİ”©Ü
 ++() {

362 
™”©Ü
 
	gŞd
 = *
this
;

363 ++*
	gthis
;

364  
	gŞd
;

369 
	g¡d
::
·œ
<
™”©Ü
, 
	g™”©Ü
> 
	$equ®_¿nge
(
Key
 cÚ¡& 
k
) {

370 
size_t
 
hash_code
 = 
	`_hashfú
(
k
);

371 
hash_pos
 = ()(
hash_code
 % (
size_t
)
_ÿ·c™y
);

372  
¡d
::
	`make_·œ
(
	`™”©Ü
(
this
, 
k
, 
hash_pos
), iterator(this));

373 
	}
}

	@include/util/history.h

24 #iâdeà
__UTIL_HISTORY_H


25 
	#__UTIL_HISTORY_H


	)

27 
	~"ut/cÚfig.h
"

30 #ià
HAVE_READLINE


32 
boŞ
 
hi¡Üy_İ’
();

33 
boŞ
 
hi¡Üy_şo£
();

	@include/util/linux_procstat.h

31 #iâdeà
__UTIL_LINUX_PROCSTAT_H


32 
	#__UTIL_LINUX_PROCSTAT_H


	)

34 
	~"ut/´oc¡©.h
"

35 
	~"ut/tİšfo.h
"

37 
	~"k_defšes.h
"

41 şas 
	clšux_´ocmÚ™Ü_t
 : 
public
 
´ocmÚ™Ü_t


43 
´iv©e
:

44 
tİšfo_t
 
_tİšfo
;

46 
	m´Ùeùed
:

47 
_£tup
(cÚ¡ 
š‹rv®_£c
);

49 
	mpublic
:

51 
lšux_´ocmÚ™Ü_t
(
shÜe
::
ShÜeEnv
* 
’v
,

52 cÚ¡ 
š‹rv®_£c
 = 1);

53 ~
lšux_´ocmÚ™Ü_t
();

57 
¡©_»£t
();

59 
g‘_avg_u§ge
(
boŞ
 
bUpd©eR—dšg
=
Œue
);

60 
´št_avg_u§ge
();

61 
´št_ext_¡©s
();

62 
ulÚg_t
 
ioch¬s
();

63 
ušt
 
g‘_num_of_ıus
();

65 
ıu_lßd_v®ues_t
 
g‘_lßd
();

	@include/util/namespace.h

24 #iâdeà
__NAMESPACE_H


25 
	#__NAMESPACE_H


	)

27 
	#ENTER_NAMESPACE
(
ns
è
Çme¥aû
‚ {

	)

29 
	#EXIT_NAMESPACE
(
ns
è}

	)

	@include/util/pool_alloc.h

24 #iâdeà
__POOL_ALLOC_H


25 
	#__POOL_ALLOC_H


	)

27 
	~<ÿs£¹
>

28 
	~<c¡dlib
>

29 
	~"ut/th»ad_loÿl.h
"

31 şas 
	cpoŞ_®loc
 {

32 
	mpublic
:

33 
poŞ_®loc
(cÚ¡* 
Çme
, 
d–
=8);

34 ~
poŞ_®loc
();

35 * 
®loc
(
size
);

36 
ä“
(* 
±r
);

39 
	tb™m­
;

40 
	ecÚ¡ªts
 {
	mBLOCK_UNITS
=64};

42 
	gh—d”
;

45 
	gblock_m­_sync
;

46 
	sblock
 {

47 
b™m­
 
	g_b™m­
;

50 cÚ¡ * 
	g_Çme
;

53 
block_m­_sync
* 
	g_live_blocks
;

55 
	g_d©a
[0];

58 
block
(cÚ¡* 
Çme
)

59 : 
_b™m­
(~0ul), 
_Çme
(
Çme
)

62 
h—d”
* 
g‘_h—d”
(
šdex
, 
b™m­
 
¿nge
);

63 
cut_loo£
();

67 
	sh—d”
 {

68 
b™m­
 
	g_¿nge
;

69 
block
* 
	g_block
;

70 
	g_d©a
[0];

71 
»Ëa£
();

74 
	gpublic
:

76 
‹m¶©e
<
şass
 
T
>

77 
poŞ_®loc
* 
	$poŞ
(cÚ¡* 
Çme
) {

78 
__th»ad
 
poŞ_®loc
* 
_poŞ
 = 
NULL
;

79  
_poŞ
? _poŞ : _poŞ = 
Ãw
 
	`poŞ_®loc
(
Çme
);

80 
	}
}

82 
	g´iv©e
:

83 cÚ¡* 
_Çme
;

84 
block
* 
	g_block
;

85 
b™m­
 
	g_Ãxt_un™
;

86 
	g_d–
;

87 
	g_off£t
;

88 
	g_®loc_couÁ
;

89 
	g_huge_couÁ
;

90 
	g_®loc_sizes
[
BLOCK_UNITS
];

91 
	g_huge_sizes
[
BLOCK_UNITS
];

92 
block_m­_sync
* 
	g_live_blocks
;

94 
Ãw_block
();

95 
h—d”
* 
®loÿ‹
(
size
);

96 
h—d”
* 
®loÿ‹_nÜm®
(
size
);

97 
h—d”
* 
®loÿ‹_huge
(
size
);

98 
disÿrd_block
();

102 
	#DECLARE_POOL_ALLOC_POOL
(
şs
) \

103 
poŞ_®loc
* 
	`poŞ
(è{ …oŞ_®loc::
poŞ
<
şs
>(#cls); } \

104 
dummy_¡ruù


	)

106 
	#DECLARE_POOL_ALLOC_NEW_AND_DELETE
(
şs
) \

107 * 
İ”©Ü
 
	`Ãw
(
size_t
 
size
è{  
	`poŞ
()->
	`®loc
(size); } \

108 
İ”©Ü
 
	`d–‘e
(* 
±r
è{ 
	`poŞ
()->
	`ä“
(ptr); } \

109 
	`DECLARE_POOL_ALLOC_POOL
(
şs
)

	)

111 
	#DECLARE_POOL_ALLOC_NEW_AND_DELETE
(
şs
è
dummy_¡ruù


	)

115 
	s¡©ic_š™Ÿlize_poŞ_®loc
 { 
¡©ic_š™Ÿlize_poŞ_®loc
(); };

116 
¡©ic_š™Ÿlize_poŞ_®loc
 
	gpoŞ_®loc_sw©chz
;

	@include/util/prcinfo.h

36 #iâdeà
__UTIL_PRCINFO_H


37 
	#__UTIL_PRCINFO_H


	)

39 
	~<sys/ty³s.h
>

40 
	~<sys/time.h
>

42 
	~<´ocfs.h
>

44 
	~<¡dio.h
>

45 
	~<uni¡d.h
>

46 
	~<fú.h
>

47 
	~<”ºo.h
>

48 
	~<m©h.h
>

50 
	~"ut/¡İw©ch.h
"

51 
	~"ut/´oc¡©.h
"

53 
	~"k_defšes.h
"

55 
	~<io¡»am
>

57 
usšg
 
Çme¥aû
 
	g¡d
;

59 
	s´oûssšfo_t


61 
	m_fd
;

63 
´u§ge_t
 
	m_Şd_´u§ge
;

64 
´u§ge_t
 
	m_´u§ge
;

65 
¡İw©ch_t
 
	m_tim”
;

67 
boŞ
 
	m_´št_©_ex™
;

68 
	m_is_ok
;

70 
ušt
 
	m_nıus
;

72 
´oûssšfo_t
(cÚ¡ 
boŞ
 
´š‹x™
 = 
çl£
);

73 ~
´oûssšfo_t
();

76 
»£t
();

77 
´št
();

78 
ulÚg_t
 
ioch¬s
();

80 
ušt
 
g‘_num_of_ıus
();

82 
ıu_lßd_v®ues_t
 
g‘_lßd
();

84 
Œªs
(
time¡ruc_t
 
©s
);

86 
hr_mš_£c
(*, );

87 
´time
(
¡ršg
 
Ïb–
, 
time¡ruc_t
* 
ts
);

88 
´time
(
¡ršg
 
Ïb–
, & 
d–ay
);

90 
t§dd
(
time¡ruc_t
* 
»suÉ
,ime¡ruc_t* 
a
,ime¡ruc_t* 
b
);

91 
tssub
(
time¡ruc_t
* 
»suÉ
,ime¡ruc_t* 
a
,ime¡ruc_t* 
b
);

	@include/util/procstat.h

44 #iâdeà
__UTIL_PROCSTAT_H


45 
	#__UTIL_PROCSTAT_H


	)

47 
	~<¡dio.h
>

48 
	~<¡ršg.h
>

50 
	~<uni¡d.h
>

51 
	~<veùÜ
>

52 
	~<±h»ad.h
>

54 
	~"ut/th»ad.h
"

55 
	~"k_defšes.h
"

67 
	sıu_lßd_v®ues_t


69 
	mrun_tm
;

70 
	mwa™_tm
;

71 
ıu_lßd_v®ues_t
(è: 
run_tm
(0), 
wa™_tm
(0) { }

72 ~
ıu_lßd_v®ues_t
() { }

86 
	sıu_m—su»m’t


88 
ušt64_t
 
	mtime¡amp
;

89 
ušt64_t
 
	mıu_n£c_idË
;

91 
	mıu_m—su»m’t
 &
	mİ”©Ü
+=(
ıu_m—su»m’t
 cÚ¡ &
Ùh”
);

92 
	mıu_m—su»m’t
 &
	mİ”©Ü
-=(
ıu_m—su»m’t
 cÚ¡ &
Ùh”
);

93 
ş—r
();

94 
£t
(
ušt64_t
 
¢­time
, ušt64_ˆ
n£c_idË
);

109 
ENTER_NAMESPACE
(
shÜe
);

110 
şass
 
	gShÜeEnv
;

111 
EXIT_NAMESPACE
(
shÜe
);

114 
	eeCPS
 { 
	mCPS_NOTSET
, 
	mCPS_RESET
, 
	mCPS_RUNNING
, 
	mCPS_PAUSE
, 
	mCPS_STOP
 };

117 şas 
	c´ocmÚ™Ü_t
 : 
public
 
th»ad_t


119 
´Ùeùed
:

121 
_š‹rv®_u£c
;

122 
	m_š‹rv®_£c
;

124 
	m_tÙ®_u§ge
;

126 vŞ©
	m_num_u§ge_»adšgs
;

127 vŞ©
	m_avg_u§ge
;

129 
±h»ad_mu‹x_t
 
	m_mu‹x
;

130 
±h»ad_cÚd_t
 
	m_cÚd
;

132 
eCPS
 vŞ©
	m_¡©e
;

133 
vœtu®
 
_£tup
(cÚ¡ 
š‹rv®_£c
);

135 
	mshÜe
::
ShÜeEnv
* 
_’v
;

136 
ušt_t
 
	m_Ï¡_»adšg
;

138 
boŞ
 
	m_´št_v”bo£
;

140 
	mpublic
:

142 
´ocmÚ™Ü_t
(cÚ¡ * 
Çme
,

143 
shÜe
::
ShÜeEnv
* 
’v
 = 
NULL
,

144 cÚ¡ 
š‹rv®_£c
 = 1);

145 
	mvœtu®
 ~
´ocmÚ™Ü_t
();

148 
wÜk
();

151 
úŒ_»£t
();

152 
úŒ_·u£
();

153 
úŒ_»sume
();

154 
úŒ_¡İ
();

156 
vœtu®
 
w_rc_t
 
ÿ£_£tup
();

157 
vœtu®
 
w_rc_t
 
ÿ£_»£t
();

158 
vœtu®
 
w_rc_t
 
ÿ£_¡İ
();

159 
vœtu®
 
w_rc_t
 
ÿ£_tick
();

161 
£tEnv
(
shÜe
::
ShÜeEnv
* 
’v
);

165 
vœtu®
 
¡©_»£t
()=0;

167 
vœtu®
 
g‘_avg_u§ge
(
boŞ
 
bUpd©eR—dšg
)=0;

168 
vœtu®
 
´št_avg_u§ge
()=0;

169 
vœtu®
 
´št_ext_¡©s
()=0;

170 
vœtu®
 
ulÚg_t
 
ioch¬s
()=0;

171 
vœtu®
 
ušt
 
g‘_num_of_ıus
()=0;

174 
vœtu®
 
ıu_lßd_v®ues_t
 
g‘_lßd
()=0;

175 
´št_lßd
(cÚ¡ 
d–ay
);

178 
´št_š‹rv®
();

181 
£t_´št_v”bo£
(
boŞ
 
´št_v”bo£
);

182 
´št_v”bo£
();

	@include/util/progress.h

31 #iâdeà
__UTIL_PROGRESS_H


32 
	#__UTIL_PROGRESS_H


	)

35 
	#PROGRESS_INTERVAL
 100000

	)

37 
	#MAX_LINE_LENGTH
 1024

	)

42 
´og»ss_»£t
(* 
šdiÿtÜ
);

43 
´og»ss_upd©e
(* 
šdiÿtÜ
);

44 
´og»ss_dÚe
(cÚ¡ * 
bËÇme
);

	@include/util/randgen.h

24 #iâdeà
__RANDGEN_H


25 
	#__RANDGEN_H


	)

27 
	~"sm_vas.h
"

29 şas 
	c¿ndg’_t


31 
	mpublic
:

33 
	$¿ndg’_t
() {

38 
	$»£t
(
£ed
) {

39 
¡h»ad_t
::
	`s_ºg
()->
	`£ed
(&
£ed
, 1);

40 
	}
}

42 
	$¿nd
() {

43  
¡h»ad_t
::
	`me
()->
	`¿nd
() & 0x7fffffff;

44 
	}
}

50 
	$¿nd
(
n
) {

51 
	`as£¹
(
n
 > 0);

52  
¡h»ad_t
::
	`me
()->
	`¿ndn
(
n
);

53 
	}
}

	@include/util/random_input.h

33 #iâdeà
__UTIL_RANDOM_INPUT_H


34 
	#__UTIL_RANDOM_INPUT_H


	)

37 
	~"ut.h
"

38 
	~"zfŸn.h
"

40 
URªd
(cÚ¡ 
low
, cÚ¡ 
high
);

41 
boŞ
 
URªdBoŞ
();

42 
URªdShÜt
(cÚ¡ 
low
, cÚ¡ 
high
);

43 
UZRªd
(cÚ¡ 
low
, cÚ¡ 
high
);

44 
ZRªd
(cÚ¡ 
low
, cÚ¡ 
high
);

46 cÚ¡ 
	gCAPS_CHAR_ARRAY
[] = { "ABCDEFGHIJKLMNOPQRSTUVWXYZ" };

47 cÚ¡ 
	gNUMBERS_CHAR_ARRAY
[] = { "012345789" };

49 
URªdFlSŒC­s
(* 
de¡
, cÚ¡ 
sz
);

50 
URªdFlSŒNumbx
(* 
de¡
, cÚ¡ 
sz
);

53 
	#STRSIZE
(
x
è(x+1)

	)

57 
boŞ
 
_g_’abËZf
;

58 
_g_ZfS
;

61 
£tZf
(cÚ¡ 
boŞ
 
isEÇbËd
, cÚ¡ 
s
);

	@include/util/resource_declare.h

24 #iâdeà
__RESOURCE_DECLARE_H


25 
	#__RESOURCE_DECLARE_H


	)

27 
	~"ut/c_¡r.h
"

39 şas 
	c»sourû_deş¬e_t


41 
	mpublic
:

42 
vœtu®
 
deş¬e
(cÚ¡ 
c_¡r
& 
Çme
, 
couÁ
)=0;

43 
	mvœtu®
 ~
	$»sourû_deş¬e_t
() { }

44 
	}
};

	@include/util/resource_pool.h

43 #iâdeà
__UTIL_RESOURCE_POOL_H


44 
	#__UTIL_RESOURCE_POOL_H


	)

46 
	~"ut/th»ad.h
"

47 
	~"ut/c_¡r.h
"

48 
	~"ut/¡©ic_li¡.h
"

49 
	~"ut/¡©ic_li¡_¡ruù.h
"

59 şas 
	c»sourû_poŞ_t


61 
	m´iv©e
:

63 
±h»ad_mu‹x_t
* 
_mu‹xp
;

65 
	m_ÿ·c™y
;

66 
	m_»£rved
;

67 
	m_nÚ_idË
;

69 
c_¡r
 
	m_Çme
;

71 
¡©ic_li¡_s
 
	m_wa™”s
;

73 
	mpublic
:

75 
	$»sourû_poŞ_t
(
±h»ad_mu‹x_t
* 
mu‹xp
, 
ÿ·c™y
, cÚ¡ 
c_¡r
& 
Çme
)

76 : 
	`_mu‹xp
(
mu‹xp
)

77 , 
	`_ÿ·c™y
(
ÿ·c™y
)

78 , 
	`_»£rved
(0)

79 , 
	`_nÚ_idË
(0)

80 , 
	$_Çme
(
Çme
)

82 
	`¡©ic_li¡_š™
(&
_wa™”s
);

85 
	`»£rve
(
n
);

86 
	`uÄe£rve
(
n
);

87 
	`nÙify_ÿ·c™y_šü—£
(
diff
);

88 
	`nÙify_idË
();

89 
	`nÙify_nÚ_idË
();

90 
	`g‘_ÿ·c™y
();

91 
	`g‘_»£rved
();

92 
	`g‘_nÚ_idË
();

94 
´iv©e
:

96 
	`wa™_fÜ_tuº
(
»q_»£rve_couÁ
);

97 
	`wa™”_wake
();

98 
	}
};

	@include/util/resource_releaser.h

24 #iâdeà
__RESOURCE_RELEASER_H


25 
	#__RESOURCE_RELEASER_H


	)

35 şas 
	c»sourû_»Ëa£r_t


37 
	mpublic
:

38 
vœtu®
 
»Ëa£_»sourûs
()=0;

39 
	mvœtu®
 ~
	$»sourû_»Ëa£r_t
() { }

40 
	}
};

	@include/util/rio.h

11 #iâdeà
_RIO_H


12 
	#_RIO_H


	)

14 
	~<sys/ty³s.h
>

25 
	#RIO_BUFSIZE
 8192

	)

38 
	mrio_fd
;

39 
ssize_t
 
	mrio_út
;

40 *
	mrio_buåŒ
;

41 
	mrio_buf
[
RIO_BUFSIZE
];

43 } 
	trio_t
;

50 
ssize_t
 
rio_»adn
 (
fd
, * 
u¤buf
, 
size_t
 
n
);

51 
ssize_t
 
rio_wr™’
(
fd
, cÚ¡ * 
u¤buf
, 
size_t
 
n
);

52 
rio_»adš™b
(
rio_t
 *
½
, 
fd
);

53 
ssize_t
 
rio_»adnb
(
rio_t
 *
½
, *
u¤buf
, 
size_t
 
n
);

54 
ssize_t
 
rio_»adlšeb
(
rio_t
 *
½
, *
u¤buf
, 
size_t
 
maxËn
);

	@include/util/shell.h

31 #iâdeà
__UTIL_SHELL_H


32 
	#__UTIL_SHELL_H


	)

34 
	~"k_defšes.h
"

36 
	~<m­
>

39 
	~<as£¹.h
>

40 
	~<sigÇl.h
>

41 
	~<”ºo.h
>

44 #ifdeà
HAVE_READLINE


45 
	~<»adlše/»adlše.h
>

46 
	~<»adlše/hi¡Üy.h
>

50 
	~<sys/ty³s.h
>

51 
	~<sys/sock‘.h
>

52 
	~<Ãtdb.h
>

55 
	~<io¡»am
>

56 
	~<f¡»am
>

57 
	~<¡ršg
>

59 
	~"ut/commªd/commªd_hªdËr.h
"

60 
	~"ut/commªd/Œaûr.h
"

62 
	~"ut.h
"

63 
	~"ut/cÚfig.h
"

65 
usšg
 
Çme¥aû
 
	g¡d
;

69 "C" 
sig_hªdËr_fwd
(
sig
);

72 
	gm­
<
	t¡ršg
,
	tcommªd_hªdËr_t
*> 
	tcmdM­
;

73 
	gcmdM­
::
	t™”©Ü
 
	tcmdM­It
;

83 
şass
 
	g’vV¬
;

87 
	#REGISTER_CMD
(
cmdty³
,
cmdÇme
) \

88 
cmdÇme
 = 
Ãw
 
	`cmdty³
(); \

89 
cmdÇme
->
	`£lŸ£s
(); \

90 
	`add_cmd
(
cmdÇme
.
	`g‘
())

	)

92 
	#REGISTER_CMD_PARAM
(
cmdty³
,
cmdÇme
,
·¿mÇme
) \

93 
cmdÇme
 = 
Ãw
 
	`cmdty³
(
·¿mÇme
); \

94 
cmdÇme
->
	`£lŸ£s
(); \

95 
	`add_cmd
(
cmdÇme
.
	`g‘
())

	)

99 
	gqu™_cmd_t
 : 
public
 
commªd_hªdËr_t
 {

100 
£lŸ£s
();

101 
hªdË
(cÚ¡ * ) {  (
	gSHELL_NEXT_QUIT
); }

102 
¡ršg
 
desc
() const {  (string("Quit")); }

106 
	gdiscÚÃù_cmd_t
 : 
public
 
commªd_hªdËr_t


108 
£lŸ£s
();

109 
hªdË
(cÚ¡ * ) {  (
	gSHELL_NEXT_DISCONNECT
); }

110 
¡ršg
 
desc
() const {  (string("Disconnect client")); }

114 
	gh–p_cmd_t
 : 
public
 
commªd_hªdËr_t


116 
cmdM­
* 
_pcmds
;

117 
h–p_cmd_t
(
cmdM­
* 
pcmds
è: 
_pcmds
Õcmdsè{ 
as£¹
(pcmds); }

118 ~
h–p_cmd_t
() { }

119 
£lŸ£s
();

120 
hªdË
(cÚ¡ * 
cmd
);

121 
u§ge
() {

122 
TRACE
Ğ
TRACE_ALWAYS
, "HELP -…rints usage\n");

123 
TRACE
Ğ
TRACE_ALWAYS
, "HELP <cmd> -…rints detailed help for <cmd>\n");

125 
¡ršg
 
desc
() const {  (string("Help - Use 'help <cmd>' for usage of specific cmd")); }

126 
li¡_cmds
();

130 
	g£t_cmd_t
 : 
public
 
commªd_hªdËr_t


132 
’vV¬
* 
ev
;

133 
š™
();

134 
£lŸ£s
();

135 
hªdË
(cÚ¡ * 
cmd
);

136 
u§ge
();

137 
¡ršg
 
desc
() const {  (string("Setsƒnv vars")); }

141 
	g’v_cmd_t
 : 
public
 
commªd_hªdËr_t


143 
’vV¬
* 
ev
;

144 
š™
();

145 
£lŸ£s
();

146 
hªdË
(cÚ¡ * 
cmd
);

147 
u§ge
();

148 
¡ršg
 
desc
() const {  (string("Printsƒnv vars")); }

152 
	gcÚf_cmd_t
 : 
public
 
commªd_hªdËr_t


154 
’vV¬
* 
ev
;

155 
š™
();

156 
£lŸ£s
();

157 
hªdË
(cÚ¡ * 
cmd
);

158 
u§ge
();

159 
¡ršg
 
desc
() const {  (string("Rereadsƒnv vars")); }

163 
	gecho_cmd_t
 : 
public
 
commªd_hªdËr_t
 {

164 
£lŸ£s
(è{ 
_Çme
 = 
¡ršg
("echo"); 
	g_®Ÿ£s
.
push_back
("echo"); }

165 
hªdË
(cÚ¡ * 
cmd
) {

166 
´štf
("%s\n", 
cmd
+
¡¾’
("echo "));

167  (
	gSHELL_NEXT_CONTINUE
);

169 
u§ge
(è{ 
TRACE
Ğ
TRACE_ALWAYS
, "usage:ƒcho <string>\n"); }

170 
¡ršg
 
desc
() const {  string("Echoes its input‡rgumentsohe screen"); }

174 
	gb»ak_cmd_t
 : 
public
 
commªd_hªdËr_t
 {

175 
£lŸ£s
(è{ 
_Çme
 = 
¡ršg
("b»ak"); 
	g_®Ÿ£s
.
push_back
("break"); }

176 
hªdË
(const * ) {

177 
¿i£
(
SIGINT
);

178  (
	gSHELL_NEXT_CONTINUE
);

180 
u§ge
(è{ 
TRACE
Ğ
TRACE_ALWAYS
, "usage: break\n"); }

181 
¡ršg
 
desc
() const {  string("Breaks into‡ debugger by„aising ^C " \

186 
	gzf_cmd_t
 : 
public
 
commªd_hªdËr_t
 {

187 
_s
;

188 
boŞ
 
	g_is_’abËd
;

189 
zf_cmd_t
(è: 
_s
(0.0), 
_is_’abËd
(
çl£
) { };

190 ~
zf_cmd_t
() { };

191 
£lŸ£s
();

192 
hªdË
(cÚ¡ * 
cmd
);

193 
u§ge
();

194 
¡ršg
 
desc
() const;

214 şas 
	csh–l_t


216 
	m´Ùeùed
:

218 
¬¿y_gu¬d_t
<> 
_cmd_´om±
;

219 
	m_cmd_couÁ”
;

221 
boŞ
 
	m_§ve_hi¡Üy
;

222 
	m_¡©e
;

224 
mcs_lock
 
	m_lock
;

225 
cmdM­
 
	m_cmds
;

226 
cmdM­
 
	m_®Ÿ£s
;

227 
boŞ
 
	m_´oûssšg_commªd
;

230 
boŞ
 
	m_Ãt_mode
;

231 
ušt_t
 
	m_Ãt_pÜt
;

234 
boŞ
 
	m_šputfe_mode
;

235 
¡ršg
 
	m_šputfe
;

236 
if¡»am
 
	m_šputfe¡»am
;

238 
fe_gu¬d_t
 
	m_š_¡»am
;

239 
	m_li¡’_fd
;

241 
sockaddr_š
 
	m_ş›Á_addr
;

242 
	m_ş›Á_Ën
;

243 
	m_cÚn_fd
;

245 
	m_Ãt_cÚn_út
;

249 
	mgu¬d
<
	mqu™_cmd_t
> 
	m_qu™”
;

250 
	mgu¬d
<
	mdiscÚÃù_cmd_t
> 
	m_discÚÃù”
;

251 
	mgu¬d
<
	mh–p_cmd_t
> 
	m_h–³r
;

252 
	mgu¬d
<
	m£t_cmd_t
> 
	m_£‹r
;

253 
	mgu¬d
<
	m’v_cmd_t
> 
	m_’v”
;

254 
	mgu¬d
<
	mcÚf_cmd_t
> 
	m_cÚãr
;

255 
	mgu¬d
<
	mŒaû_cmd_t
> 
	m_Œaûr
;

257 
	mgu¬d
<
	mecho_cmd_t
> 
	m_echÛr
;

258 
	mgu¬d
<
	mb»ak_cmd_t
> 
	m_b»ak”
;

259 
	mgu¬d
<
	mzf_cmd_t
> 
	m_zãr
;

261 
_»gi¡”_commªds
();

263 
	mpublic
:

265 
sh–l_t
(cÚ¡ * 
´om±
 = 
SCLIENT_PROMPT
,

266 cÚ¡ 
boŞ
 
§ve_hi¡Üy
 = 
Œue
,

267 cÚ¡ 
boŞ
 
Ãt_mode
 = 
çl£
,

268 cÚ¡ 
ušt_t
 
Ãt_pÜt
 = 
SCLIENT_NET_MODE_LISTEN_PORT
,

269 cÚ¡ 
boŞ
 
šputfe_mode
 = 
çl£
,

270 cÚ¡ 
¡ršg
 
šputfe
 = "");

272 
	mvœtu®
 ~
sh–l_t
();

274 
	msh–l_t
* &
	$š¡ªû
() {

275 
sh–l_t
* 
_š¡ªû
;  _instance;

278 
	$g‘_commªd_út
() {

279  (
_cmd_couÁ”
);

280 
	}
}

282 
	$sig_hªdËr
(
sig
) {

283 
	`as£¹
(
sig
 =ğ
SIGINT
 && 
	`š¡ªû
());

284 ifĞ
rv®
=
	`š¡ªû
()->
	`SIGINT_hªdËr
() )

285 
	`ex™
(
rv®
);

286 
	}
}

289 
vœtu®
 
»gi¡”_commªds
()=0;

290 
add_cmd
(
commªd_hªdËr_t
* 
acmd
);

291 
š™_cmds
();

292 
şo£_cmds
();

295 
vœtu®
 
	$SIGINT_hªdËr
(è{  (
ECANCELED
); 
	}
}

296 
¡¬t
();

299 
´oûss_»adlše
();

302 
´oûss_ÃtwÜk
();

305 
´oûss_f–še
();

308 
´oûss_Úe
(cÚ¡ * 
cmd
);

	@include/util/simics-magic-instruction.h

24 #iâdeà
_SIMICS_SIMICS_MAGIC_INSTRUCTION_H


25 
	#_SIMICS_SIMICS_MAGIC_INSTRUCTION_H


	)

28 
	#__MAGIC_CASSERT
(
p
) do { \

29 
	t__check_magic_¬gum’t
[(
p
) ? 1 : -1]; \

30 } 0)

	)

32 #ià
defšed
(
__GNUC__
)

34 #ià
defšed
(
__®pha
)

36 
	#MAGIC
(
n
) do { \

37 
	`__MAGIC_CASSERT
(!(
n
)); \

38 
__asm__
 
	`__vŞ©e__
 (".long 0x70000000"); \

39 } 0)

	)

41 #–ià
defšed
(
__¥¬c
)

43 
	#MAGIC
(
n
) do { \

44 
	`__MAGIC_CASSERT
((
n
) > 0 && (n) < (1U << 22)); \

45 
__asm__
 
	`__vŞ©e__
 ("sethi " #n ", %g0"); \

46 } 0)

	)

48 
	#MAGIC_BREAKPOINT
 
	`MAGIC
(0x40000)

	)

50 #–ià(
defšed
(
__i386
è|| defšed(
__x86_64
))

52 
	#MAGIC
(
n
) do { \

53 
	`__MAGIC_CASSERT
(!(
n
)); \

54 
__asm__
 
	`__vŞ©e__
 ("xchg %bx,%bx"); \

55 } 0)

	)

57 
	#MAGIC_BREAKPOINT
 
	`MAGIC
(0)

	)

59 #–ià
defšed
(
__Ÿ64
)

61 
	#MAGIC
(
n
) do { \

62 
	`__MAGIC_CASSERT
((
n
) >= 0 && (n) < 0x100000); \

63 
__asm__
 
	`__vŞ©e__
 ("nop (0x100000 + " #n ");;"); \

64 } 0)

	)

66 
	#MAGIC_BREAKPOINT
 
	`MAGIC
(0x40000)

	)

68 #–ià
defšed
(
__pow”pc__
)

70 
	#MAGIC
(
n
) do { \

71 
	`__MAGIC_CASSERT
((
n
) >= 0 && (n) < 32); \

72 
__asm__
 
	`__vŞ©e__
 ("fmr " #n ", " #n); \

73 } 0)

	)

75 
	#MAGIC_BREAKPOINT
 
	`MAGIC
(0)

	)

77 #–ià
defšed
(
__¬m__
)

79 
	#MAGIC
(
n
) do { \

80 
	`__MAGIC_CASSERT
((
n
) == 0); \

81 
__asm__
 
	`__vŞ©e__
 ("orreq„0,„0,„0"); \

82 } 0)

	)

84 
	#MAGIC_BREAKPOINT
 
	`MAGIC
(0)

	)

86 #–ià
defšed
(
__ms__
)

88 
	#MAGIC
(
n
) do { \

89 
	`__MAGIC_CASSERT
((
n
) >= 0 && (n) <= 0xffff); \

90 
__asm__
 
	`__vŞ©e__
 (".word 0x24000000+" #n); \

91 } 0)

	)

93 
	#MAGIC_BREAKPOINT
 
	`MAGIC
(0)

	)

99 #–ià
defšed
(
__SUNPRO_C
è|| defšed(
__SUNPRO_CC
)

101 #ià
defšed
(
__¥¬c
)

103 
	#MAGIC
(
n
) do { \

104 
	`__MAGIC_CASSERT
((
n
) > 0 && (n) < (1U << 22)); \

105 
	`asm
 ("sethi " #n ", %g0"); \

106 } 0)

	)

108 
	#MAGIC_BREAKPOINT
 
	`MAGIC
(0x40000)

	)

114 #–ià
defšed
(
__DECC
)

116 #ià
defšed
(
__®pha
)

118 
	#MAGIC
(
n
) do { \

119 
	`__MAGIC_CASSERT
(!(
n
)); \

120 
	`asm
 (".long 0x70000000"); \

121 } 0)

	)

129 #ifdeà
_MSC_VER


130 
	#MAGIC
(
n
)

	)

131 
	#MAGIC_BREAKPOINT


	)

132 #´agm¨
mes§ge
("MAGIC() macro‚eeds‡ttention!")

	@include/util/skewer.h

31 #iâdeà
__UTIL_SKEWER_H


32 
	#__UTIL_SKEWER_H


	)

34 
	~<io¡»am
>

35 
	~<veùÜ
>

49 
	eskew_ty³_t
 {

50 
	mSKEW_NONE
 = 0x0,

51 
	mSKEW_NORMAL
 = 0x1,

52 
	mSKEW_DYNAMIC
 = 0x2,

53 
	mSKEW_CHAOTIC
 = 0x4

56 
usšg
 
Çme¥aû
 
	g¡d
;

67 şas 
	cskew”_t
 {

69 
	m´iv©e
:

72 
_¬—
;

75 
	m_lßd
;

78 
	m_low”
;

79 
	m_uµ”
;

83 
	mveùÜ
<> 
	m_š‹rv®_l
;

84 
	mveùÜ
<> 
	m_š‹rv®_u
;

88 
	mveùÜ
<> 
	m_nÚ_š‹rv®_l
;

89 
	mveùÜ
<> 
	m_nÚ_š‹rv®_u
;

92 
boŞ
 
	m_is_u£d
;

94 
	mpublic
:

97 
	$skew”_t
(è{ 
_is_u£d
 = 
çl£
; }

100 
	`£t
(
¬—
, 
low”
, 
uµ”
, 
lßd
);

103 
	`ş—r
();

106 
	`»£t
(
skew_ty³_t
 
ty³
);

109 
	`g‘_šput
();

112 
boŞ
 
	`is_u£d
();

115 
	`´št_š‹rv®s
();

117 
´iv©e
:

119 
	`_£t_š‹rv®s
();

121 
	`_add_š‹rv®
(
š‹rv®_low”
, 
š‹rv®_uµ”
);

123 
	}
};

	@include/util/static_hash_map.h

20 #iâdeà
_STATIC_HASH_MAP_H


21 
	#_STATIC_HASH_MAP_H


	)

23 
	~<sys/ty³s.h
>

36 
	s¡©ic_hash_m­_s
 {

38 
¡©ic_hash_node_s
* 
	mbË_’Œ›s
;

39 
size_t
 
	mbË_size
;

41 
size_t
 (*
hf
è(cÚ¡ * 
	mkey
);

42 (*
	mcom·¿tÜ
è(cÚ¡ * 
	mkey1
, cÚ¡ * 
	mkey2
);

58 
	s¡©ic_hash_node_s
 {

61 
¡©ic_hash_node_s
* 
	m´ev
;

64 
¡©ic_hash_node_s
* 
	mÃxt
;

67 cÚ¡ * 
	mkey
;

70 cÚ¡ * 
	mv®ue
;

82 
¡©ic_hash_m­_s
* 
	t¡©ic_hash_m­_t
;

90 
¡©ic_hash_node_s
* 
	t¡©ic_hash_node_t
;

102 
¡©ic_hash_node_š™
Ğ
¡©ic_hash_node_t
 
node
, cÚ¡ * 
key
, cÚ¡ * 
v®ue
 );

104 
¡©ic_hash_m­_š™
(
¡©ic_hash_m­_t
 
ht
,

105 
¡©ic_hash_node_s
* 
bË_’Œ›s
,

106 
size_t
 
bË_size
,

107 
	$size_t
 (*
hf
è(cÚ¡ * 
key
),

108 (*
com·¿tÜ
è(cÚ¡ * 
key1
, cÚ¡ * 
key2
) );

110 
	`¡©ic_hash_m­_š£¹
(
¡©ic_hash_m­_t
 
ht
,

111 cÚ¡ * 
key
,

112 cÚ¡ * 
v®ue
,

113 
¡©ic_hash_node_t
 
node
);

115 
	`¡©ic_hash_m­_fšd
(
¡©ic_hash_m­_t
 
ht
,

116 cÚ¡ * 
key
,

117 ** 
v®ue
,

118 
¡©ic_hash_node_t
* 
node
);

120 
	`¡©ic_hash_m­_»move
(
¡©ic_hash_m­_t
 
ht
,

121 cÚ¡ * 
key
,

122 ** 
v®ue
,

123 
¡©ic_hash_node_t
* 
node
);

125 
	`¡©ic_hash_m­_cut
(
¡©ic_hash_m­_t
 
ht
, 
¡©ic_hash_node_t
 
node
);

	@include/util/static_hash_map_struct.h

19 #iâdeà
_STATIC_HASH_MAP_STRUCT_H


20 
	#_STATIC_HASH_MAP_STRUCT_H


	)

22 
	~<sys/ty³s.h
>

	@include/util/static_list.h

21 #iâdeà
_STATIC_LIST_H


22 
	#_STATIC_LIST_H


	)

24 
	~"ut/¡©ic_li¡_node.h
"

37 
¡©ic_li¡_s
* 
	t¡©ic_li¡_t
;

51 
¡©ic_li¡_š™
 (
¡©ic_li¡_t
 
li¡
);

56 
¡©ic_li¡_´•’d
 (
¡©ic_li¡_t
 
li¡
, * 
v®ue
, 
¡©ic_li¡_node_t
 
node
);

57 
¡©ic_li¡_­³nd
 (
¡©ic_li¡_t
 
li¡
, * 
v®ue
, 
¡©ic_li¡_node_t
 
node
);

62 
¡©ic_li¡_»move_node
 (
¡©ic_li¡_t
 
li¡
, 
¡©ic_li¡_node_t
 
node
);

63 
¡©ic_li¡_»move_h—d
 (
¡©ic_li¡_t
 
li¡
, ** 
»suÉ
, 
¡©ic_li¡_node_t
* 
node
);

64 
¡©ic_li¡_»move_
 (
¡©ic_li¡_t
 
li¡
, ** 
»suÉ
, 
¡©ic_li¡_node_t
* 
node
);

69 
¡©ic_li¡_g‘_h—d
 (
¡©ic_li¡_t
 
li¡
, ** 
»suÉ
);

70 
¡©ic_li¡_g‘_
 (
¡©ic_li¡_t
 
li¡
, ** 
»suÉ
);

71 
¡©ic_li¡_is_em±y
 (
¡©ic_li¡_t
 
li¡
);

76 
¡©ic_li¡_m­
 (
¡©ic_li¡_t
 
li¡
, * (*
m­
è(*,*), * 
m­_¡©e
);

77 
¡©ic_li¡_m­_»v”£
 (
¡©ic_li¡_t
 
li¡
, * (*
m­
è(*,*), * 
m­_¡©e
);

78 
¡©ic_li¡_´oûss
 (
¡©ic_li¡_t
 
li¡
, (*
´oûss
è(*,*), * 
´oûssšg_¡©e
);

79 
	`¡©ic_li¡_´oûss_»v”£
(
¡©ic_li¡_t
 
li¡
, (*
´oûss
è(*,*), * 
´oûssšg_¡©e
);

	@include/util/static_list_node.h

24 #iâdeà
_STATIC_LIST_NODE_H


25 
	#_STATIC_LIST_NODE_H


	)

38 
¡©ic_li¡_node_s
* 
	t¡©ic_li¡_node_t
;

45 
¡©ic_li¡_node_š™_em±y
(
¡©ic_li¡_node_t
 
node
);

46 
¡©ic_li¡_node_š™
(
¡©ic_li¡_node_t
 
node
, * 
·ylßd
);

47 * 
¡©ic_li¡_node_g‘_·ylßd
(
¡©ic_li¡_node_t
 
node
);

48 
¡©ic_li¡_node_t
 
¡©ic_li¡_node_g‘_´ev
(¡©ic_li¡_node_ˆ
node
);

49 
¡©ic_li¡_node_t
 
¡©ic_li¡_node_g‘_Ãxt
(¡©ic_li¡_node_ˆ
node
);

50 
¡©ic_li¡_node_£t_·ylßd
(
¡©ic_li¡_node_t
 
node
, * 
·ylßd
);

51 
¡©ic_li¡_node_š£¹_aá”
(
¡©ic_li¡_node_t
 
š£¹_aá”_this
,

52 
¡©ic_li¡_node_t
 
node_to_š£¹
);

53 
¡©ic_li¡_node_š£¹_befÜe
(
¡©ic_li¡_node_t
 
š£¹_befÜe_this
,

54 
¡©ic_li¡_node_t
 
node_to_š£¹
);

55 
¡©ic_li¡_node_is_sšgËtÚ
(
¡©ic_li¡_node_t
 
node
);

56 
¡©ic_li¡_node_cut
(
¡©ic_li¡_node_t
 
node
);

	@include/util/static_list_node_struct.h

23 #iâdeà
_STATIC_LIST_NODE_STRUCT_H


24 
	#_STATIC_LIST_NODE_STRUCT_H


	)

39 
	s¡©ic_li¡_node_s


42 
¡©ic_li¡_node_s
* 
	m´ev
;

45 
¡©ic_li¡_node_s
* 
	mÃxt
;

48 * 
	m·ylßd
;

69 
	#STATIC_LIST_NODE_INITIALIZER
(
this
,
·ylßd
è{ (this), (this), (·ylßdè}

	)

	@include/util/static_list_struct.h

24 #iâdeà
_STATIC_LIST_STRUCT_H


25 
	#_STATIC_LIST_STRUCT_H


	)

27 
	~"ut/¡©ic_li¡_node_¡ruù.h
"

43 
	s¡©ic_li¡_s


47 
¡©ic_li¡_node_s
 
	mdummy
;

68 
	#STATIC_LIST_INITIALIZER
(
this
è{ 
	`STATIC_LIST_NODE_INITIALIZER
(&Ñhis)->
dummy
,
NULL
è}

	)

	@include/util/stl_block_alloc.h

24 #iâdeà
__STL_BLOCK_ALLOC


25 
	#__STL_BLOCK_ALLOC


	)

27 
	~"block_®loc.h
"

30 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
şass
 
	gPoŞ
=
dyÅoŞ
, 
size_t
 
	gMaxBy‹s
=0>

31 şas 
	c¡l_block_®loc


33 
public
:

35 
block_poŞ
<
	tT
,
	tPoŞ
,
	tMaxBy‹s
> 
	tpoŞ_ty³
;

37 
size_t
 
	tsize_ty³
;

38 
±rdiff_t
 
	tdifã»nû_ty³
;

40 
T
 
	tv®ue_ty³
;

41 
T
* 
	tpoš‹r
;

42 
T
 cÚ¡* 
	tcÚ¡_poš‹r
;

43 
	mT
& 
	t»ã»nû
;

44 
T
 cÚ¡& 
	tcÚ¡_»ã»nû
;

47 
	m‹m¶©e
<
ty³Çme
 
	mU
>

48 
	s»bšd
 { 
	m¡l_block_®loc
<
	tU
,
	tPoŞ
,
	tMaxBy‹s
> 
	tÙh”
; };

50 
	$¡l_block_®loc
(è{ 
	}
}

52 
	g‹m¶©e
<
ty³Çme
 
	gU
,y³Çm
	gP
, 
size_t
 
	gM
>

53 
¡l_block_®loc
(¡l_block_®loc<
U
,
P
,
M
> const& ) { }

57 
size_ty³
 
	$max_size
(ècÚ¡ {  1; 
	}
}

59 
poš‹r
 
®loÿ‹
Ğ
size_ty³
 , 
¡d
::
®loÿtÜ
<>::
cÚ¡_poš‹r
 = 0 )

61  
»š‹½»t_ÿ¡
<
poš‹r
>(
_poŞ
.
acquœe
());

64 
	$d—Îoÿ‹
Ğ
poš‹r
 
block
, 
size_ty³
 ) 
	$throw
()

66 
_poŞ
.
	`»Ëa£
(
block
);

67 
	}
}

72 
	$cÚ¡ruù
Ğ
poš‹r
 
–em’t
, 
T
 cÚ¡& 
¬g
 )

74 
	`Ãw
Ğ
–em’t
 ) 
	`T
Ğ
¬g
 );

75 
	}
}

80 
	$de¡roy
Ğ
poš‹r
 
–em’t
 )

82 
–em’t
->~
	`T
();

83 
	}
}

86 
poš‹r
 
	$add»ss
Ğ
»ã»nû
 
–em’t
 ) const

88  &
–em’t
;

89 
	}
}

92 
cÚ¡_poš‹r
 
	$add»ss
Ğ
cÚ¡_»ã»nû
 
–em’t
 ) const

94  &
–em’t
;

95 
	}
}

98 
poŞ_ty³
 
	g_poŞ
;

101 
	~<m­
>

102 
	g‹m¶©e
<
ty³Çme
 
	gKey
,y³Çm
	gV®ue
, 
şass
 
	gT¿™s
=
¡d
::
Ëss
<
Key
> >

103 
	sm­__block_®loc
 {

104 
¡d
::
	tm­
<
	tKey
, 
	tV®ue
, 
	tT¿™s
, 
	t¡l_block_®loc
<
	t¡d
::
	t·œ
<Key, V®ue> > > 
	tTy³
;

106 
	g‹m¶©e
<
ty³Çme
 
	gKey
,y³Çm
	gV®ue
, 
şass
 
	gT¿™s
=
¡d
::
Ëss
<
Key
> >

107 
	smuÉim­__block_®loc
 {

108 
¡d
::
	tmuÉim­
<
	tKey
, 
	tV®ue
, 
	tT¿™s
, 
	t¡l_block_®loc
<
	t¡d
::
	t·œ
<Key, V®ue> > > 
	tTy³
;

111 
	~<li¡
>

112 
	g‹m¶©e
<
ty³Çme
 
	gV®ue
>

113 
	sli¡__block_®loc
 {

114 
	m¡d
::
	tli¡
<
	tV®ue
, 
	t¡l_block_®loc
<V®ue> > 
	tTy³
;

117 
	~<£t
>

118 
	g‹m¶©e
<
ty³Çme
 
	gV®ue
,y³Çm
	gT¿™s
 = 
¡d
::
Ëss
<
V®ue
> >

119 
	s£t__block_®loc
 {

120 
¡d
::
	t£t
<
	tV®ue
, 
	tT¿™s
, 
	t¡l_block_®loc
<V®ue> > 
	tTy³
;

123 
	~<veùÜ
>

124 
	g‹m¶©e
<
ty³Çme
 
	gV®ue
>

125 
	sveùÜ__block_®loc
 {

126 
	m¡d
::
	tveùÜ
<
	tV®ue
, 
	t¡l_block_®loc
<V®ue> > 
	tTy³
;

	@include/util/stl_pool.h

33 #iâdeà
__UTIL_STL_POOL


34 
	#__UTIL_STL_POOL


	)

36 
	~<io¡»am
>

37 
	~"ut/gu¬d.h
"

40 şas 
	cPoŞ


42 
	mpublic
:

44 
PoŞ
Ğ
size_t
 
g¿nuÏr™y
, size_ˆ
size
 );

47 ~
PoŞ
();

50 
size_t
 
	$G‘G¿nuÏr™y
(ècÚ¡ {  
m_g¿nuÏr™y
; }

53 
size_t
 
	$G‘Size
(ècÚ¡ {  
m_size
; 
	}
}

56 
size_t
 
	$G‘U£d
(ècÚ¡ {  
m_u£d
; 
	}
}

59 
size_t
 
	$G‘Ov”æow
(ècÚ¡ {  
m_ov”æow
; 
	}
}

63 * 
AÎoÿ‹
();

66 
D—Îoÿ‹
Ğ* 
block
 );

70 
	g‹m¶©e
<
ty³Çme
 
	gT
>

71 
T
* 
	$CÚ¡ruù
()

73 
	`as£¹
ĞĞ
T
 ) <ğ
m_g¿nuÏr™y
 );

74 
T
* 
block
 = 
»š‹½»t_ÿ¡
<T*>Ğ
	`AÎoÿ‹
() );

75  
	`Ãw
Ğ
block
 ) 
T
;

76 
	}
}

79 
	g‹m¶©e
<
ty³Çme
 
	gT
>

80 
	$De¡roy
Ğ
T
* 
š¡ªû
 )

82 
	`as£¹
ĞĞ
T
 ) <ğ
m_g¿nuÏr™y
 );

83 
š¡ªû
->~
	`T
();

84 
	`D—Îoÿ‹
Ğ
š¡ªû
 );

85 
	}
}

87 
	g´iv©e
:

89 
boŞ
 
	$IsFromPoŞ
ĞcÚ¡* 
š¡ªû
 ) const

91 cÚ¡* 
block
 = 
»š‹½»t_ÿ¡
<cÚ¡*>Ğ
š¡ªû
 );

92  
m_¡Üage
.
	`g‘
(è<ğ
block
 && block < ( m_¡Üage.g‘(è+ 
m_size
*
m_g¿nuÏr™y
 );

93 
	}
}

95 
size_t
 
	gm_g¿nuÏr™y
;

96 
size_t
 
	gm_size
;

97 
size_t
 vŞ©
	gm_u£d
;

98 
size_t
 vŞ©
	gm_ov”æow
;

100 
	g¬¿y_gu¬d_t
<> 
	gm_¡Üage
;

101 
	g¬¿y_gu¬d_t
<*> 
	gm_¦Ùs
;

	@include/util/stl_pooled_alloc.h

34 #iâdeà
__UTIL_STL_POOLED_ALLOC


35 
	#__UTIL_STL_POOLED_ALLOC


	)

38 
	~"¡l_poŞ.h
"

39 
	~<ÿs£¹
>

40 
	~<veùÜ
>

41 
	~<li¡
>

42 
	~<£t
>

43 
	~<m­
>

47 
	g‹m¶©e
<
ty³Çme
 
	gT
>

48 şas 
	cPoŞedAÎoÿtÜ


50 
	mpublic
:

51 
size_t
 
	tsize_ty³
;

52 
±rdiff_t
 
	tdifã»nû_ty³
;

54 
T
 
	tv®ue_ty³
;

55 
T
* 
	tpoš‹r
;

56 
T
 cÚ¡* 
	tcÚ¡_poš‹r
;

57 
	mT
& 
	t»ã»nû
;

58 
T
 cÚ¡& 
	tcÚ¡_»ã»nû
;

61 
	m‹m¶©e
<
ty³Çme
 
	mU
>

62 
	s»bšd
 { 
	mPoŞedAÎoÿtÜ
<
	tU
> 
	tÙh”
; };

67 
	$PoŞedAÎoÿtÜ
Ğ
PoŞ
* 
poŞ
 = 0 ) : 
	$m_poŞ
Ğ
poŞ
 )

69 
	`as£¹
Ğ!
m_poŞ
 || Ğ
T
 ) <ğm_poŞ->
	`G‘G¿nuÏr™y
() );

70 
	}
}

75 
	g‹m¶©e
<
ty³Çme
 
	gU
>

76 
PoŞedAÎoÿtÜ
ĞPoŞedAÎoÿtÜ<
U
> cÚ¡& 
¬g
 ) : 
	$m_poŞ
Ğ
¬g
.
m_poŞ
 )

78 
	`as£¹
Ğ!
m_poŞ
 || Ğ
T
 ) <ğm_poŞ->
	`G‘G¿nuÏr™y
() );

79 
	}
}

82 
size_ty³
 
	$max_size
(ècÚ¡ {  0xffffffff; 
	}
}

87 
poš‹r
 
®loÿ‹
Ğ
size_ty³
 
couÁ
, 
¡d
::
®loÿtÜ
<>::
cÚ¡_poš‹r
 = 0 ) const

89 ifĞ
couÁ
 =ğ1 && 
m_poŞ
 )

91  
»š‹½»t_ÿ¡
<
T
*>Ğ
m_poŞ
->
AÎoÿ‹
() );

95  
	g»š‹½»t_ÿ¡
<
	gT
*>Ğ
Ãw
 [ 
couÁ
*Ğ
T
 ) ] );

104 
	$d—Îoÿ‹
Ğ
poš‹r
 
block
, 
size_ty³
 
couÁ
 ) cÚ¡ 
	$throw
()

106 ià(!
block
) ;

108 
	`as£¹
Ğ
block
 && "null…ointer‡rgument" );

109 ifĞ
couÁ
 =ğ1 && 
m_poŞ
 )

111 
m_poŞ
->
	`D—Îoÿ‹
Ğ
block
 );

115 
d–‘e
[] 
»š‹½»t_ÿ¡
<*>Ğ
block
 );

117 
	}
}

122 
	$cÚ¡ruù
Ğ
poš‹r
 
–em’t
, 
T
 cÚ¡& 
¬g
 )

124 
	`Ãw
Ğ
–em’t
 ) 
	`T
Ğ
¬g
 );

125 
	}
}

130 
	$de¡roy
Ğ
poš‹r
 
–em’t
 )

132 
–em’t
->~
	`T
();

134 
	}
}

137 
poš‹r
 
	$add»ss
Ğ
»ã»nû
 
–em’t
 ) const

139  &
–em’t
;

140 
	}
}

143 
cÚ¡_poš‹r
 
	$add»ss
Ğ
cÚ¡_»ã»nû
 
–em’t
 ) const

145  &
–em’t
;

146 
	}
}

149 
PoŞ
* 
	gm_poŞ
;

153 
	g‹m¶©e
<>

154 
şass
 
	gPoŞedAÎoÿtÜ
<>

156 
	gpublic
:

157 
size_t
 
	tsize_ty³
;

158 
±rdiff_t
 
	tdifã»nû_ty³
;

160 
	tv®ue_ty³
;

161 * 
	tpoš‹r
;

162 cÚ¡* 
	tcÚ¡_poš‹r
;

165 
	g‹m¶©e
<
ty³Çme
 
	gU
>

166 
	s»bšd
 { 
	gPoŞedAÎoÿtÜ
<
	tU
> 
	tÙh”
; };

171 
PoŞedAÎoÿtÜ
(è: 
m_poŞ
( 0 ) {}

174 
PoŞedAÎoÿtÜ
Ğ
PoŞ
* 
poŞ
 ) : 
m_poŞ
(…ool ) {}

177 
PoŞ
* 
m_poŞ
;

182 
	g‹m¶©e
<
ty³Çme
 
	gT
,y³Çm
	gU
>

183 
boŞ
 
	gİ”©Ü
==Ğ
PoŞedAÎoÿtÜ
<
T
> cÚ¡& 
Ëá
, 
	gPoŞedAÎoÿtÜ
<
	gU
> cÚ¡& 
	gright
 )

185  
	gËá
.
	gm_poŞ
 =ğ
right
.
m_poŞ
;

190 
	g‹m¶©e
<
ty³Çme
 
	gT
,y³Çm
	gU
>

191 
boŞ
 
	gİ”©Ü
!=Ğ
PoŞedAÎoÿtÜ
<
T
> cÚ¡& 
Ëá
, 
	gPoŞedAÎoÿtÜ
<
	gU
> cÚ¡& 
	gright
 )

193  
	gËá
.
	gm_poŞ
 !ğ
right
.
m_poŞ
;

202 
	g‹m¶©e
<
ty³Çme
 
	gKey
,y³Çm
	gV®ue
, 
şass
 
	gT¿™s
 = 
¡d
::
Ëss
<
Key
> >

203 
	sPoŞedM­


205 
¡d
::
	tm­
<
	tKey
, 
	tV®ue
, 
	tT¿™s
, 
	tPoŞedAÎoÿtÜ
<
	t¡d
::
	t·œ
<Key, V®ue> > > 
	tTy³
;

210 
	g‹m¶©e
<
ty³Çme
 
	gKey
,y³Çm
	gV®ue
, 
şass
 
	gT¿™s
 = 
¡d
::
Ëss
<
Key
> >

211 
	sPoŞedMuÉiM­


213 
¡d
::
	tmuÉim­
<
	tKey
, 
	tV®ue
, 
	tT¿™s
, 
	tPoŞedAÎoÿtÜ
<
	t¡d
::
	t·œ
<Key, V®ue> > > 
	tTy³
;

218 
	g‹m¶©e
<
ty³Çme
 
	gV®ue
>

219 
	sPoŞedLi¡


221 
	m¡d
::
	tli¡
<
	tV®ue
, 
	tPoŞedAÎoÿtÜ
<V®ue> > 
	tTy³
;

225 
	g‹m¶©e
<
ty³Çme
 
	gV®ue
,y³Çm
	gT¿™s
 = 
¡d
::
Ëss
<
V®ue
> >

226 
	sPoŞedS‘


228 
¡d
::
	t£t
<
	tV®ue
, 
	tT¿™s
, 
	tPoŞedAÎoÿtÜ
<V®ue> > 
	tTy³
;

232 
	g‹m¶©e
<
ty³Çme
 
	gV®ue
>

233 
	sPoŞedVec


235 
	m¡d
::
	tveùÜ
<
	tV®ue
, 
	tPoŞedAÎoÿtÜ
<V®ue> > 
	tTy³
;

	@include/util/stopwatch.h

24 #iâdeà
__UTIL_STOPWATCH_H


25 
	#__UTIL_STOPWATCH_H


	)

27 
	~<sys/time.h
>

34 şas 
	c¡İw©ch_t
 {

35 
	m´iv©e
:

36 
timev®
 
tv
;

37 
	mm¬k
;

38 
	mpublic
:

39 
	$¡İw©ch_t
() {

40 
	`»£t
();

42 
	$time_us
() {

43 
Şd_m¬k
 = 
m¬k
;

44 
	`»£t
();

45  
m¬k
 - 
Şd_m¬k
;

46 
	}
}

47 
	$time_ms
() {

48  (()(
	`time_us
()*1e-3));

49 
	}
}

50 
	$time
() {

51  (()(
	`time_us
()*1e-6));

52 
	}
}

53 
	$now
() {

54 
	`g‘timeofday
(&
tv
, 
NULL
);

55  
tv
.
tv_u£c
 +v.
tv_£c
*1000000ll;

56 
	}
}

57 
	$»£t
() {

58 
m¬k
 = 
	`now
();

59 
	}
}

	@include/util/store_string.h

31 #iâdeà
__UTIL_STORE_STRING_H


32 
	#__UTIL_STORE_STRING_H


	)

34 
	~"k_defšes.h
"

36 
	#FILL_STRING
(
de¡
, 
¤c
è
	`¡ºıy
(de¡, src, (de¡))

	)

38 
¡Üe_¡ršg
(* 
de¡
, * 
¤c
);

40 
¡Üe_¡ršg
(* 
de¡
, cÚ¡ * 
¤c
);

	@include/util/sunos_procstat.h

34 #iâdeà
__UTIL_SUNOS_PROCSTAT_H


35 
	#__UTIL_SUNOS_PROCSTAT_H


	)

37 
	~"ut/´oc¡©.h
"

38 
	~"ut/´cšfo.h
"

40 
	~<k¡©.h
>

42 
	sk¡©_’Œy


44 
k¡©_t
* 
	mk¥
;

46 
	moff£t
;

47 
ıu_m—su»m’t
 
	mm—su»d
[2];

52 şas 
	csunos_´ocmÚ™Ü_t
 : 
public
 
´ocmÚ™Ü_t


54 
´iv©e
:

56 
´oûssšfo_t
 
_´cšfo
;

58 
k¡©_ùl_t
* 
	m_pkc
;

60 
	m¡d
::
veùÜ
<
k¡©_’Œy
> 
_’Œ›s
;

61 
	m_’Œ›s_sz
;

62 
boŞ
 
	m_fœ¡_time
;

63 
	m_Ï¡_m—su»m’t
;

64 
	m_Ãw_m—su»m’t
;

65 
ıu_m—su»m’t
 
	m_tÙ®s
;

66 
ıu_m—su»m’t
 
	m_m
;

67 
	m_šu£
;

68 
k¡©_’Œy
* 
	m_k£
;

69 
	m_kid
;

70 
k¡©_Çmed_t
* 
	m_kn
;

73 
	m´Ùeùed
:

74 
_£tup
(cÚ¡ 
š‹rv®_£c
);

76 
	mpublic
:

78 
sunos_´ocmÚ™Ü_t
(
shÜe
::
ShÜeEnv
* 
’v
,

79 cÚ¡ 
š‹rv®_£c
 = 1);

80 ~
sunos_´ocmÚ™Ü_t
();

83 
w_rc_t
 
ÿ£_£tup
();

84 
w_rc_t
 
ÿ£_tick
();

85 
w_rc_t
 
ÿ£_»£t
();

88 
´št_¡©s
();

92 
¡©_»£t
();

94 
g‘_avg_u§ge
(
boŞ
 
bUpd©eR—dšg
=
Œue
);

95 
´št_avg_u§ge
();

96 
´št_ext_¡©s
();

97 
ulÚg_t
 
ioch¬s
();

98 
ušt
 
g‘_num_of_ıus
();

101 
ıu_lßd_v®ues_t
 
g‘_lßd
();

	@include/util/sync.h

24 #iâdeà
__UTIL_SYNC_H


25 
	#__UTIL_SYNC_H


	)

27 
	~"ut/th»ad.h
"

31 
	sdebug_mu‹x_t
 {

32 
±h»ad_mu‹x_t
 
	m_lock
;

33 
±h»ad_t
 
	m_Ï¡_owÃr_tid
;

34 
debug_mu‹x_t
(
±h»ad_mu‹x_t
 cÚ¡ &
lock
)

35 : 
_lock
(
lock
), 
_Ï¡_owÃr_tid
(0)

38 
İ”©Ü
 
	m±h»ad_mu‹x_t
&() {

39  
	m_lock
;

49 
	sü™iÿl_£ùiÚ_t
 {

51 
±h»ad_mu‹x_t
* 
	m_mu‹x
;

53 
ü™iÿl_£ùiÚ_t
(
±h»ad_mu‹x_t
 &
mu‹x
)

54 : 
_mu‹x
(&
mu‹x
)

56 
th»ad_mu‹x_lock
(*
_mu‹x
);

59 
ü™iÿl_£ùiÚ_t
(
debug_mu‹x_t
 &
mu‹x
)

60 : 
_mu‹x
(&
mu‹x
.
_lock
)

62 
th»ad_mu‹x_lock
(*
_mu‹x
);

63 
	mmu‹x
.
	m_Ï¡_owÃr_tid
 = 
±h»ad_£lf
();

67 
’‹r
(
±h»ad_mu‹x_t
 &
mu‹x
) {

68 
ex™
();

69 
	m_mu‹x
 = &
mu‹x
;

70 
th»ad_mu‹x_lock
(*
_mu‹x
);

73 
’‹r
(
debug_mu‹x_t
 &
mu‹x
) {

74 
ex™
();

75 
	m_mu‹x
 = &
mu‹x
.
_lock
;

76 
th»ad_mu‹x_lock
(*
_mu‹x
);

77 
	mmu‹x
.
	m_Ï¡_owÃr_tid
 = 
±h»ad_£lf
();

80 
ex™
() {

81 if(
	m_mu‹x
) {

82 
th»ad_mu‹x_uÆock
(*
_mu‹x
);

83 
	m_mu‹x
 = 
NULL
;

87 ~
ü™iÿl_£ùiÚ_t
() {

88 
ex™
();

91 
	m´iv©e
:

92 
ü™iÿl_£ùiÚ_t
(critical_section_t const &);

93 
	mü™iÿl_£ùiÚ_t
 &
	mİ”©Ü
 =(
ü™iÿl_£ùiÚ_t
 const &);

104 
	snÙify_t
 {

106 vŞ©
boŞ
 
	m_nÙif›d
;

107 vŞ©
boŞ
 
	m_ÿnûÎed
;

108 
±h»ad_mu‹x_t
 
	m_lock
;

109 
±h»ad_cÚd_t
 
	m_nÙify
;

111 
nÙify_t
()

112 : 
_nÙif›d
(
çl£
),

113 
_ÿnûÎed
(
çl£
),

114 
_lock
(
th»ad_mu‹x_ü—‹
()),

115 
_nÙify
(
th»ad_cÚd_ü—‹
())

128 
wa™
() {

129 
ü™iÿl_£ùiÚ_t
 
cs
(
_lock
);

130  
wa™_hŞdšg_lock
();

139 
wa™_hŞdšg_lock
() {

140 !
	m_nÙif›d
 && !
	m_ÿnûÎed
)

141 
th»ad_cÚd_wa™
(
_nÙify
, 
_lock
);

143 
boŞ
 
	m»suÉ
 = 
_ÿnûÎed
;

144 
	m_nÙif›d
 = 
_ÿnûÎed
 = 
çl£
;

145  
	m»suÉ
;

154 
nÙify
() {

155 
ü™iÿl_£ùiÚ_t
 
cs
(
_lock
);

156 
nÙify_hŞdšg_lock
();

168 
nÙify_hŞdšg_lock
() {

169 
sigÇl
(
_nÙif›d
);

172 
ÿnûl
() {

173 
ü™iÿl_£ùiÚ_t
 
cs
(
_lock
);

174 
ÿnûl_hŞdšg_lock
();

177 
ÿnûl_hŞdšg_lock
() {

178 
sigÇl
(
_ÿnûÎed
);

181 
	m´Ùeùed
:

183 
sigÇl
(vŞ©
boŞ
 &
v®
) {

184 
v®
 = 
Œue
;

185 
th»ad_cÚd_sigÇl
(
_nÙify
);

	@include/util/tassert.h

24 #iâdeà
__UTIL_TASSERT_H


25 
	#__UTIL_TASSERT_H


	)

27 
	~<c¡dlib
>

28 
	~"ut/Œaû.h
"

33 
	#TASSERT
(
cÚd
) { \

34 ià(!(
cÚd
)) { \

35 
	`TRACE
(
TRACE_ALWAYS
, \

38 
	`abÜt
(); \

40 }

	)

	@include/util/tcp.h

32 #iâdeà
__UTIL_TCP_H


33 
	#__UTIL_TCP_H


	)

35 
İ’_li¡’fd
(
pÜt
);

36 
İ’_ş›Áfd
(cÚ¡ * 
ho¡Çme
, 
pÜt
);

	@include/util/thread.h

24 #iâdeà
__THREAD_H


25 
	#__THREAD_H


	)

29 
	~<±h»ad.h
>

30 
	~<c¡dio
>

32 
	~"k_defšes.h
"

34 
	~<û¼no
>

35 
	~<ÿs£¹
>

36 
	~<funùiÚ®
>

37 
	~<c¡d¬g
>

38 
	~<¡dšt.h
>

39 
	~<time.h
>

41 
	~"ut/c_¡r.h
"

42 
	~"ut/exû±iÚ.h
"

43 
	~"ut/¿ndg’.h
"

46 
DEFINE_EXCEPTION
(
Th»adExû±iÚ
);

49 #ifdeà
__¥aüv9


51 
	#TRY_TO_BIND
(
ıu
,
boundæag
) \

52 ià(
	`´oûssÜ_bšd
(
P_LWPID
, 
P_MYID
, 
ıu
, 
NULL
)) { \

53 
	`TRACE
Ğ
TRACE_CPU_BINDING
, "CªnÙ bšdØ´oûssÜ (%d)\n", 
ıu
); \

54 
boundæag
 = 
çl£
; } \

56 
	`TRACE
Ğ
TRACE_CPU_BINDING
, "BšdedØ´oûssÜ (%d)\n", 
ıu
); \

57 
boundæag
 = 
Œue
; }

	)

62 
	#TRY_TO_BIND
(
ıu
,
boundæag
) \

63 
	`TRACE
Ğ
TRACE_DEBUG
, "Should bšd mtØ(%d)\n", 
_´s_id
);

	)

67 #iâdeà
__GCC


71 
±h»ad_mu‹x_t
 
th»ad_mu‹x_ü—‹
(cÚ¡ 
±h»ad_mu‹x©Œ_t
* 
©Œ
=
NULL
);

72 
th»ad_mu‹x_lock
(
±h»ad_mu‹x_t
 &
mu‹x
);

73 
th»ad_mu‹x_uÆock
(
±h»ad_mu‹x_t
 &
mu‹x
);

74 
th»ad_mu‹x_de¡roy
(
±h»ad_mu‹x_t
 &
mu‹x
);

77 
±h»ad_cÚd_t
 
th»ad_cÚd_ü—‹
(cÚ¡ 
±h»ad_cÚd©Œ_t
* 
©Œ
=
NULL
);

78 
th»ad_cÚd_de¡roy
(
±h»ad_cÚd_t
 &
cÚd
);

79 
th»ad_cÚd_sigÇl
(
±h»ad_cÚd_t
 &
cÚd
);

80 
th»ad_cÚd_brßdÿ¡
(
±h»ad_cÚd_t
 &
cÚd
);

81 
th»ad_cÚd_wa™
(
±h»ad_cÚd_t
 &
cÚd
, 
±h»ad_mu‹x_t
 &
mu‹x
);

82 
boŞ
 
th»ad_cÚd_wa™
(
±h»ad_cÚd_t
 &
cÚd
, 
±h»ad_mu‹x_t
 &
mu‹x
,

83 
time¥ec
 &
timeout
);

84 
boŞ
 
th»ad_cÚd_wa™
(
±h»ad_cÚd_t
 &
cÚd
, 
±h»ad_mu‹x_t
 &
mu‹x
,

85 
timeout_ms
);

87 
	g‹m¶©e
 <
şass
 
	gT
>

88 
T
* 
	$th»ad_još
(
±h»ad_t
 
tid
)

93 *
p
;

94 
T
 *
v
;

95 } 
u
;

97 if(
	`±h»ad_još
(
tid
, &
u
.
p
))

98 
	`THROW
(
Th»adExû±iÚ
);

100  
u
.
v
;

101 
	}
}

117 
	sth»ad_poŞ


119 
±h»ad_mu‹x_t
 
	m_lock
;

120 
±h»ad_cÚd_t
 
	m_cÚd
;

121 
	m_max_aùive
;

122 
	m_aùive
;

124 
th»ad_poŞ
(
max_aùive
)

125 : 
_lock
(
th»ad_mu‹x_ü—‹
()),

126 
_cÚd
(
th»ad_cÚd_ü—‹
()),

127 
_max_aùive
(
max_aùive
), 
_aùive
(0)

131 
¡¬t
();

132 
¡İ
();

140 
	#USE_SMTHREAD_AS_BASE


	)

142 #ifdeà
USE_SMTHREAD_AS_BASE


143 
	~"sm_vas.h
"

159 #ifdeà
USE_SMTHREAD_AS_BASE


160 
şass
 
	gth»ad_t
 : 
public
 
smth»ad_t


162 
şass
 
th»ad_t


165 
´iv©e
:

166 
c_¡r
 
_th»ad_Çme
;

167 
¿ndg’_t
 
	g_¿ndg’
;

169 #ifdeà
USE_SMTHREAD_AS_BASE


170 
run
();

171 
th»ad_poŞ
* 
	g_µoŞ
;

172 
£tuµoŞ
(
th»ad_poŞ
* 
­oŞ
è{ 
	g_µoŞ
 =‡pool; }

173 
£tu±hr
();

176 
	g´Ùeùed
:

177 
boŞ
 
_d–‘e_me
;

179 
	gpublic
:

186 
vœtu®
 
wÜk
()=0;

188 
boŞ
 
d–‘e_me
(è{  
	g_d–‘e_me
; }

190 
c_¡r
 
th»ad_Çme
() {

191  
	g_th»ad_Çme
;

198 
¿ndg’_t
* 
¿ndg’
() {

199  &
	g_¿ndg’
;

206 
¿nd
() {

207  
	g_¿ndg’
.
¿nd
();

217 
¿nd
(
n
) {

218  
	g_¿ndg’
.
¿nd
(
n
);

221 
	gvœtu®
 ~
th»ad_t
() { }

224 
	g´Ùeùed
:

225 
th»ad_t
(cÚ¡ 
c_¡r
 &
Çme
);

230 #ifdeà
USE_SMTHREAD_AS_BASE


231 
wa™_fÜ_¡h»ad_ş›Ás
(
¡h»ad_t
** 
th»ads
, 
num_th»ad_ids
);

241 
	g‹m¶©e
 <
şass
 
	gCÏss
, cÏs 
	gFunùÜ
>

242 şas 
	cmemb”_func_th»ad_t
 : 
public
 
th»ad_t
 {

243 
CÏss
 *
_š¡ªû
;

244 
FunùÜ
 
	m_func
;

245 
	mpublic
:

246 
	$memb”_func_th»ad_t
(
CÏss
 *
š¡ªû
, 
FunùÜ
 
func
, cÚ¡ 
c_¡r
 &
th»ad_Çme
)

247 : 
	`th»ad_t
(
th»ad_Çme
),

248 
	`_š¡ªû
(
š¡ªû
),

249 
	$_func
(
func
)

253 
vœtu®
 
	$wÜk
() {

254 
	`_func
(
_š¡ªû
);

255 
	}
}

266 
	g‹m¶©e
 <
şass
 
	gR‘uº
, cÏs 
	gCÏss
>

267 
th»ad_t
* 
memb”_func_th»ad
(
CÏss
* 
š¡ªû
,

268 
R‘uº
 (
CÏss
::*
mem_func
)(),

269 cÚ¡ 
c_¡r
& 
th»ad_Çme
)

271 
	g¡d
::
	tmem_fun_t
<
	tR‘uº
, 
	tCÏss
> 
	tFunùÜ
;

272  
Ãw
 
	gmemb”_func_th»ad_t
<
	gCÏss
, 
	gFunùÜ
>(
	gš¡ªû
,

273 
FunùÜ
(
mem_func
),

274 
	gth»ad_Çme
);

281 
th»ad_š™
();

282 
th»ad_t
* 
th»ad_g‘_£lf
();

283 
±h»ad_t
 
th»ad_ü—‹
(
th»ad_t
* 
t
, 
th»ad_poŞ
* 
p
=
NULL
);

286 
	g‹m¶©e
<
ty³Çme
 
	gT
>

287 
	sth»ad_loÿl
 {

288 
±h»ad_key_t
 
	m_key
;

296 
	m‹m¶©e
<
şass
 
	mDe¡ruùÜ
>

297 
th»ad_loÿl
(
De¡ruùÜ
 
d
) {

298 
±h»ad_key_ü—‹
(&
_key
, 
d
);

300 
th»ad_loÿl
() {

301 
±h»ad_key_ü—‹
(&
_key
, 
NULL
);

303 ~
th»ad_loÿl
() {

304 
±h»ad_key_d–‘e
(
_key
);

307 
T
* 
g‘
() {

308  
	m»š‹½»t_ÿ¡
<
	mT
*>(
±h»ad_g‘¥ecific
(
_key
));

310 
£t
(
T
* 
v®
) {

311 
	m»suÉ
 = 
±h»ad_£t¥ecific
(
_key
, 
v®
);

312 
THROW_IF
(
Th»adExû±iÚ
, 
»suÉ
);

316 
	mth»ad_loÿl
 &
	mİ”©Ü
=(
T
* 
v®
) {

317 
£t
(
v®
);

318  *
	mthis
;

320 
İ”©Ü
 
	mT
*() {

321  
g‘
();

325 
__th»ad
 
th»ad_poŞ
* 
THREAD_POOL
;

	@include/util/thread_local.h

24 #iâdeà
__THREAD_LOCAL_H


25 
	#__THREAD_LOCAL_H


	)

28 
	sth»ad_loÿl_ba£
 {

29 (*
	md–‘”
)(*);

31 
	m´iv©e
:

32 
»gi¡”_objeù
(* 
±r
, 
d–‘”
 
d
);

36 
	g‹m¶©e
<
şass
 
	gT
>

37 şas 
	cth»ad_loÿl
 : 
th»ad_loÿl_ba£
 {

38 
public
:

43 
	scÚ¡ruùÜ
 {

44 
vœtu®
 
T
* 
cÚ¡ruù
()=0;

45 
	mvœtu®
 ~
cÚ¡ruùÜ
() { }

48 
	gcÚ¡ruùÜ0
 : 
cÚ¡ruùÜ
 {

49 
vœtu®
 
T
* 
cÚ¡ruù
(è{  
Ãw
 T; }

52 
	g‹m¶©e
<
şass
 
	gT1
>

53 
	gcÚ¡ruùÜ1
 : 
cÚ¡ruùÜ
 {

54 
T1
 
_p1
;

55 
cÚ¡ruùÜ1
(
T1
 
p1
è: 
_p1
(p1) { }

56 
vœtu®
 
T
* 
cÚ¡ruù
(è{  
Ãw
 T(
_p1
); }

58 
	g‹m¶©e
<
şass
 
	gT1
, cÏs 
	gT2
>

59 
	gcÚ¡ruùÜ2
 : 
cÚ¡ruùÜ
 {

60 
T1
 
_p1
;

61 
T2
 
	g_p2
;

62 
cÚ¡ruùÜ2
(
T1
 
p1
, 
T2
 
p2
è: 
_p1
Õ1), 
_p2
(p2) { }

63 
vœtu®
 
T
* 
cÚ¡ruù
(è{  
Ãw
 T(
_p1
, 
_p2
); }

65 
	g‹m¶©e
<
şass
 
	gT1
, cÏs 
	gT2
, cÏs 
	gT3
>

66 
	gcÚ¡ruùÜ3
 : 
cÚ¡ruùÜ
 {

67 
T1
 
_p1
;

68 
T2
 
	g_p2
;

69 
T3
 
	g_p3
;

70 
cÚ¡ruùÜ3
(
T1
 
p1
, 
T2
 
p2
, 
T3
 
p3
è: 
_p1
Õ1), 
_p2
Õ2), 
_p3
(p3) { }

71 
vœtu®
 
T
* 
cÚ¡ruù
(è{  
Ãw
 T(
_p1
, 
_p2
, 
_p3
); }

75 
	$d–‘e_±r
(* 
±r
è{ 
	`d–‘e
 (
T
*è±r; 
	}
}

77 
cÚ¡ruùÜ
* 
	g_c
;

80 
	gİ”©Ü
=(
th»ad_loÿl
 &
Ùh”
);

81 
th»ad_loÿl
Ñh»ad_loÿÈ&
Ùh”
);

83 
	gpublic
:

108 
	$th»ad_loÿl
(è: 
	`_c
(
Ãw
 
cÚ¡ruùÜ0
<
T
>è{ 
	}
}

110 
‹m¶©e
<
şass
 
T1
>

111 
	$th»ad_loÿl
(
T1
 
p1
è: 
	`_c
(
Ãw
 
cÚ¡ruùÜ1
<
T
, T1>Õ1)è{ 
	}
}

113 
	g‹m¶©e
<
şass
 
	gT1
, cÏs 
	gT2
>

114 
	$th»ad_loÿl
(
T1
 
p1
, 
T2
 
p2
è: 
	`_c
(
Ãw
 
cÚ¡ruùÜ2
<
T
, T1, T2>Õ1,…2)è{ 
	}
}

116 
	g‹m¶©e
<
şass
 
	gT1
, cÏs 
	gT2
, cÏs 
	gT3
>

117 
	$th»ad_loÿl
(
T1
 
p1
, 
T2
 
p2
, 
T3
 
p3
è: 
	`_c
(
Ãw
 
cÚ¡ruùÜ3
<
T
, T1, T2, T3>Õ1,…2,…3)è{ 
	}
}

123 
T
* 
	$g‘
() {

125 
__th»ad
 
T
* 
_s
 = 
NULL
;

126 if(
_s
)

127  
_s
;

129 
T
* 
±r
 = 
_c
->
	`cÚ¡ruù
();

130 
	`»gi¡”_objeù
(
±r
, &
d–‘e_±r
);

131  
_s
 = 
±r
;

132 
	}
}

133 
	gT
 &
	gİ”©Ü
=(
T
 cÚ¡ &
Ùh”
è{  *
g‘
() = other; }

134 
İ”©Ü
 
	gT
&(è{  *
g‘
(); }

	@include/util/time_util.h

31 #iâdeà
__TIME_UTIL_H


32 
	#__TIME_UTIL_H


	)

34 
	~<time.h
>

36 
	~"k_defšes.h
"

38 
	~<ùy³.h
>

43 
d©•¬t
(cÚ¡* 
¡r
, cÚ¡ 
time_t
 *
±
);

44 
time_t
 
¡r_to_tim‘
(cÚ¡* 
¡r
);

45 
tim‘_to_¡r
(* 
d¡
, 
time_t
 
time
);

56 
time_t
 
time_add_day
Ñime_ˆ
time
, 
days
);

57 
time_t
 
time_add_w“k
Ñime_ˆ
time
, 
w“ks
);

58 
time_t
 
time_add_mÚth
Ñime_ˆ
time
, 
mÚths
);

59 
time_t
 
time_add_y—r
Ñime_ˆ
time
, 
y—rs
);

62 
time_t
 
time_day_begš
Ñime_ˆ
t
);

63 
time_t
 
time_day_’d
Ñime_ˆ
t
);

	@include/util/tmpfile.h

32 #iâdeà
__UTIL_TMPFILE_H


33 
	#__UTIL_TMPFILE_H


	)

35 
	~<c¡dio
>

36 
	~"ut/c_¡r.h
"

38 
FILE
* 
ü—‹_tmp_fe
(
c_¡r
 &
Çme
, cÚ¡ c_¡¸&
´efix
);

	@include/util/topinfo.h

38 #iâdeà
__UTIL_TOPINFO_H


39 
	#__UTIL_TOPINFO_H


	)

42 
	~<sys/ty³s.h
>

43 
	~<sys/time.h
>

44 
	~<uni¡d.h
>

45 
	~<”ºo.h
>

46 
	~<m©h.h
>

48 
	~"ut/¡İw©ch.h
"

49 
	~"ut/´oc¡©.h
"

51 
	~<io¡»am
>

52 
	~<veùÜ
>

63 
	~<glibtİ.h
>

64 
	~<glibtİ/ıu.h
>

65 
	~<glibtİ/mem.h
>

66 
	~<glibtİ/´oşi¡.h
>

67 
	~<glibtİ/fsu§ge.h
>

68 
	~<glibtİ/mouÁli¡.h
>

70 
usšg
 
Çme¥aû
 
	g¡d
;

73 
	stİšfo_t


75 
	m´iv©e
:

77 
glibtİ
* 
_cÚf
;

79 
glibtİ_ıu
 
	m_ıu
;

80 
glibtİ_mem
 
	m_mem
;

81 
glibtİ_´oşi¡
 
	m_´oşi¡
;

83 
glibtİ_ıu
 
	m_Şd_ıu
;

84 
glibtİ_mem
 
	m_Şd_mem
;

85 
glibtİ_´oşi¡
 
	m_Şd_´oşi¡
;

87 
glibtİ_mouÁli¡
 
	m_mouÁ_li¡
;

88 
glibtİ_mouÁ’Œy
* 
	m_mouÁ_’Œ›s
;

91 
ušt
 
	m_»g_fs
;

92 
	mveùÜ
<
	m¡ršg
> 
	m_v_»g_mouÁ
;

93 
	mveùÜ
<
	mglibtİ_fsu§ge
> 
	m_v_fs
;

94 
	mveùÜ
<
	mglibtİ_fsu§ge
> 
	m_v_Şd_fs
;

96 
	mveùÜ
<
	t¡ršg
>::
	t™”©Ü
 
	tmouÁ_™
;

97 
	mveùÜ
<
	tglibtİ_fsu§ge
>::
	t™”©Ü
 
	tfsu§ge_™
;

99 
	mpublic
:

101 
tİšfo_t
();

102 ~
tİšfo_t
();

104 
´št_¡©s
();

107 
upd©e_ıu
();

108 
g‘_avg_u§ge
(
boŞ
 
bUpd©eR—dšg
=
Œue
);

109 
´št_avg_u§ge
();

110 
ušt
 
g‘_num_of_ıus
();

112 
ıu_lßd_v®ues_t
 
g‘_lßd
();

116 
upd©e_mem
();

117 
´št_mem
();

120 
upd©e_´oşi¡
();

121 
´št_´oşi¡
();

124 
»gi¡”_fs
(cÚ¡ 
¡ršg
& 
mouÁ·th
);

125 
upd©e_fs
();

126 
´št_fs
(cÚ¡ 
d–ay
);

128 
ulÚg_t
 
ioch¬s
();

131 
»£t
();

	@include/util/trace.h

31 #iâdeà
__UTIL_TRACE_H


32 
	#__UTIL_TRACE_H


	)

34 
	~<c¡d¬g
>

35 
	~<¡dšt.h
>

37 
	~"ut/com·t.h
"

38 
	~"Œaû/Œaû_ty³s.h
"

43 
	sŒaûr
 {

44 cÚ¡* 
	m_fe
;

45 
	m_lše
;

46 cÚ¡* 
	m_funùiÚ
;

47 
Œaûr
(cÚ¡* 
fe
, 
lše
, cÚ¡* 
funùiÚ
)

48 : 
_fe
(
fe
), 
_lše
(
lše
), 
_funùiÚ
(
funùiÚ
)

51 
İ”©Ü
()(
	mty³
, cÚ¡* 
	mfÜm©
, ...è
ATTRIBUTE
(
fÜm©
(
´štf
, 3, 4));

54 
Œaû_
(
Œaû_ty³
,

55 cÚ¡ * 
f’ame
, 
lše_num
, cÚ¡ * 
funùiÚ_Çme
,

56 cÚ¡* 
fÜm©
, ...) ;

57 
Œaû_£t
(
Œaû_ty³_mask
);

58 
Œaû_g‘
();

86 
	#TRACE
 
	`Œaûr
(
__FILE__
, 
__LINE__
, 
__FUNCTION__
)

	)

100 
	#TRACE_SET
(
ty³s
è
	`Œaû_£t
Ñy³s)

	)

114 
	#TRACE_GET
(è
	`Œaû_g‘
()

	)

	@include/util/w_strlcpy.h

47 
	~<sys/ty³s.h
>

49 #ifdeà
__SUNPRO_CC


50 
	~<¡ršg.h
>

52 
	~<c¡ršg
>

55 
size_t


56 
w_¡¾ıy
(*
d¡
, cÚ¡ *
¤c
, 
size_t
 
siz
);

	@include/util/zipfian.h

24 #iâdeà
__UTIL_ZIPFIAN_H


25 
	#__UTIL_ZIPFIAN_H


	)

28 
	~<cm©h
>

54 
	szfŸn


57 
	m_k
;

58 
	m_mk_šv
;

59 
	m_cutoff
;

60 
	m_1mcutoff
;

63 
zfŸn
(
n
, 
s
)

65 : 
_k
(1.1*
s
-1), 
_mk_šv
(-1./_k)

66 , 
_cutoff
(
pow
(
n
, -
_k
)), 
_1mcutoff
(1-_cutoff)

70 
İ”©Ü
()(
	mu
è{  
Ãxt
(
u
); }

72 
Ãxt
(
unifÜm_šput
) {

74 
	munifÜm_šput
 *ğ
_1mcutoff
;

75 
	munifÜm_šput
 +ğ
_cutoff
;

76  (è
pow
(
unifÜm_šput
, 
_mk_šv
);

	@include/workload/ssb/dbgen/bcd2.h

5 #iâdeà
SSB_DBGEN_BCD2_H


6 
	#SSB_DBGEN_BCD2_H


	)

8 
	~"ut/Çme¥aû.h
"

10 
ENTER_NAMESPACE
(
dbg’ssb
);

12 
bš_bcd2
(
bš¬y
, *
low_»s
, *
high_»s
);

13 
bcd2_bš
(*
de¡
, 
bcd
);

14 
bcd2_add
(*
bcd_low
, *
bcd_high
, 
add’d
);

15 
bcd2_sub
(*
bcd_low
, *
bcd_high
, 
sub’d
);

16 
bcd2_mul
(*
bcd_low
, *
bcd_high
, 
muÉl›r
);

17 
bcd2_div
(*
bcd_low
, *
bcd_high
, 
divisÜ
);

18 
bcd2_mod
(*
bcd_low
, *
bcd_high
, 
modulo
);

19 
bcd2_cmp
(*
bcd_low
, *
bcd_high
, 
com·»
);

21 
EXIT_NAMESPACE
(
dbg’ssb
);

	@include/workload/ssb/dbgen/config.h

51 #iâdeà
SSB_DBGEN_CONFIG_H


52 
	#SSB_DBGEN_CONFIG_H


	)

54 
	~"ut/Çme¥aû.h
"

56 
ENTER_NAMESPACE
(
dbg’ssb
);

59 
	#SSBM


	)

61 #ifdeà
DOS


62 
	#DSS_PROC
 1

	)

63 
	#PATH_SEP
 '\\'

	)

67 #ifdeà
ATT


68 
	#STDLIB_HAS_GETOPT


	)

69 #ifdeà
SQLSERVER


70 
	#WIN32


	)

73 
	#SUPPORT_64BITS


	)

74 
	#DSS_HUGE
 

	)

75 
	#HUGE_COUNT
 1

	)

76 
	#HUGE_FORMAT
 "%LLd"

	)

80 #ifdeà
DIGITAL


81 
	#DOUBLE_CAST
 ()()

	)

84 #ifdeà
HP


85 
	#_INCLUDE_POSIX_SOURCE


	)

86 
	#STDLIB_HAS_GETOPT


	)

89 #ifdeà
IBM


90 
	#_POSIX_SOURCE


	)

98 
	#STDLIB_HAS_GETOPT


	)

101 #ifdeà
ICL


102 
	#STDLIB_HAS_GETOPT


	)

105 #ifdeà
SUN


106 
	#STDLIB_HAS_GETOPT


	)

109 #ifdeà
LINUX


110 
	#STDLIB_HAS_GETOPT


	)

113 #ifdeà
SGI


114 
	#STDLIB_HAS_GETOPT


	)

115 
	#SUPPORT_64BITS


	)

116 
	#DSS_HUGE
 
__ušt64_t


	)

117 
	#HUGE_COUNT
 1

	)

120 #ifdeà
TANDEM


121 
	#EOL_HANDLING


	)

124 #ifdeà
VMS


125 
	#SPAWN
 
vfÜk


	)

126 
	#KILL
(
pid
è
	`kl
(
SIGQUIT
,…id)

	)

127 
	#SET_HANDLER
(
´oc
è
	`sigÇl
(
SIGQUIT
,…roc)

	)

128 
	#WAIT
(
»s
, 
pid
è
	`wa™
Ôes)

	)

129 
	#SIGS_DEFINED


	)

132 #ià(
defšed
(
WIN32
)&&!defšed(
_POSIX_
))

133 
	#pid_t
 

	)

134 
	#SET_HANDLER
(
´oc
è
	`sigÇl
(
SIGINT
,…roc)

	)

135 
	#KILL
(
pid
) \

136 
	`T”mš©eProûss
(
	`O³nProûss
(
PROCESS_TERMINATE
,
FALSE
,
pid
),3)

	)

137 #ià(
defšed
 (
__WATCOMC__
))

138 
	#SPAWN
(è
	`¥awnv
(
P_NOWAIT
, 
¥awn_¬gs
[0], s·wn_¬gs)

	)

139 
	#WAIT
(
»s
, 
pid
è
	`cwa™
Ôes,…id, 
WAIT_CHILD
)

	)

141 
	#SPAWN
(è
	`_¥awnv
(
_P_NOWAIT
, 
¥awn_¬gs
[0], s·wn_¬gs)

	)

142 
	#WAIT
(
»s
, 
pid
è
	`_cwa™
Ôes,…id, 
_WAIT_CHILD
)

	)

143 
	#g‘pid
 
_g‘pid


	)

145 
	#SIGS_DEFINED


	)

146 
	#PATH_SEP
 '\\'

	)

147 #iâdeà
TEST_32B


148 
	#SUPPORT_64BITS


	)

149 
	#DSS_HUGE
 
__št64


	)

150 
	#HUGE_COUNT
 1

	)

151 
	#HUGE_FORMAT
 "%I64d"

	)

156 
	#WIFEXITED
(
s
è(( & 0xFFè=ğ0)

	)

157 
	#WIFSIGNALED
(
s
è((()((
¡©us
)-1è& 0xFFFFè< 0xFF)

	)

158 
	#WIFSTOPPED
(
s
è(((sè& 0xffè=ğ0x7f)

	)

159 
	#WTERMSIG
(
s
è((sè& 0x7f)

	)

160 
	#WSTOPSIG
(
s
è(((sè& 0xff00è>> 8)

	)

163 #iâdeà
SIGS_DEFINED


164 
	#KILL
(
pid
è
	`kl
(
SIGUSR1
,…id)

	)

165 
	#SET_HANDLER
(
´oc
è
	`sigÇl
(
SIGUSR1
,…roc)

	)

166 
	#SPAWN
 
fÜk


	)

167 
	#WAIT
(
»s
, 
pid
è
	`wa™
Ôes)

	)

170 
	#DSS_PROC
 
	`g‘pid
()

	)

173 #iâdeà
DBNAME


174 
	#DBNAME
 "dss"

	)

177 #iâdeà
PATH_SEP


178 
	#PATH_SEP
 '/'

	)

181 #iâdeà
DSS_HUGE


182 
	#DSS_HUGE
 

	)

183 
	#HUGE_COUNT
 2

	)

186 #iâdeà
DOUBLE_CAST


187 
	#DOUBLE_CAST
 ()

	)

190 
EXIT_NAMESPACE
(
dbg’ssb
);

	@include/workload/ssb/dbgen/dss.h

7 #iâdeà
SSB_DBGEN_DSS_H


8 
	#SSB_DBGEN_DSS_H


	)

10 
	~"ut/Çme¥aû.h
"

11 
	~"ut/Œaû.h
"

13 
	~"wÜklßd/ssb/dbg’/cÚfig.h
"

15 #ifdeà
SSBM


16 
	#NAME
 "SSBM (S¸Schem¨B’chm¬k)"

	)

17 #undeà
VERSION


18 
	#VERSION
 1

	)

19 
	#RELEASE
 0

	)

20 
	#MODIFICATION
 0

	)

21 
	#PATCH
 ""

	)

24 
	#DATE
 4

	)

26 
	#L_SKEY_MIN
 1

	)

27 
	#L_SKEY_MAX
 (
tdefs
[
SUPP
].
ba£
 * 
sÿË
)

	)

30 #ifdeà
TPCH


31 
	#NAME
 "TPC-H"

	)

32 
	#VERSION
 1

	)

33 
	#RELEASE
 3

	)

34 
	#MODIFICATION
 0

	)

35 
	#PATCH
 ""

	)

38 #ifdeà
TPCR


39 
	#NAME
 "TPC-R"

	)

40 
	#VERSION
 1

	)

41 
	#RELEASE
 3

	)

42 
	#MODIFICATION
 0

	)

43 
	#PATCH
 ""

	)

46 #iâdeà
NAME


47 #”rÜ 
B’chm¬k
 
v”siÚ
 
mu¡
 
be
 
defšed
 
š
 
cÚfig
.
h


49 
	#TPC
 "T¿n§ùiÚ Proûssšg P”fÜmªû Counc"

	)

50 
	#C_DATES
 "1994 - 2000"

	)

52 
	~"wÜklßd/ssb/dbg’/cÚfig.h
"

53 
	~"wÜklßd/ssb/dbg’/sh¬ed.h
"

55 
	~<¡dio.h
>

56 
	~<¡dlib.h
>

57 #ifdeà
SSBM


58 
	~<m©h.h
>

62 
	#NONE
 -1

	)

63 
	#PART
 0

	)

64 
	#PSUPP
 1

	)

65 
	#SUPP
 2

	)

66 
	#CUST
 3

	)

67 
	#ORDER
 4

	)

68 
	#LINE
 5

	)

69 
	#ORDER_LINE
 6

	)

70 
	#PART_PSUPP
 7

	)

71 
	#NATION
 8

	)

72 
	#REGION
 9

	)

73 
	#UPDATE
 10

	)

74 
	#MAX_TABLE
 11

	)

75 
	#ONE_STREAM
 1

	)

76 
	#ADD_AT_END
 2

	)

78 #ifdeà
MAX


79 #undeà
MAX


81 #ifdeà
MIN


82 #undeà
MIN


84 
	#MAX
(
a
,
b
è(× > b )?a:b)

	)

85 
	#MIN
(
A
,
B
èĞ(Aè< (Bè? (Aè: (B))

	)

87 
	#INTERNAL_ERROR
(
p
è{
	`årštf
(
¡d”r
,"%s",…);
	`abÜt
();}

	)

88 
	#LN_CNT
 4

	)

89 
	gÊoi£
[4] = {'|', '/', '-', '\\' };

90 
	#LIFENOISE
(
n
, 
v¬
) \

91 ià(
v”bo£
 > 0è
	`årštf
(
¡d”r
, "%c\b", 
Êoi£
[(
v¬
%
LN_CNT
)])

	)

93 
	#MALLOC_CHECK
(
v¬
) \

94 ià((
v¬
è=ğ
NULL
) \

96 
	`årštf
(
¡d”r
, "Malloc failed‡t %s:%d\n", \

97 
__FILE__
, 
__LINE__
); \

98 
	`ex™
(1);\

99 }

	)

100 
	#OPEN_CHECK
(
v¬
, 
·th
) \

101 ià((
v¬
è=ğ
NULL
) \

103 
	`årštf
(
¡d”r
, "Open failed for %s‡t %s:%d\n", \

104 
·th
, 
__FILE__
, 
__LINE__
); \

105 
	`ex™
(1);\

106 }

	)

107 #iâdeà
MAX_CHILDREN


108 
	#MAX_CHILDREN
 1000

	)

116 #iâdeà
BITS_PER_LONG


117 
	#BITS_PER_LONG
 32

	)

118 
	#MAX_LONG
 0x7FFFFFFF

	)

120 
	#SPARSE_BITS
 2

	)

121 
	#SPARSE_KEEP
 3

	)

122 
	#MK_SPARSE
(
key
, 
£q
) \

123 (((((
key
>>3)<<2)|(
£q
 & 0x0003))<<3)|(key & 0x0007))

	)

125 
	#RANDOM
(
tgt
, 
low”
, 
uµ”
, 
¡»am
è
	`dss_¿ndom
(&tgt,†ow”, uµ”, sŒ—m)

	)

128 
ENTER_NAMESPACE
(
dbg’ssb
);

130 
ssb_dbg’_š™
();

131 
ä“_asc_d©e
();

133 #ifdeà
SSBM


135 cÚ¡ * 
	mÇme
;

136 
	m¡¬t_day
;

137 
	m¡¬t_mÚth
;

138 
	m’d_day
;

139 
	m’d_mÚth
;

140 } 
	t£asÚ
;

142 cÚ¡ * 
	mÇme
;

143 
	mmÚth
;

144 
	mday
;

145 } 
	thŞiday
;

153 
	mweight
;

154 *
	m‹xt
;

155 } 
	t£t_memb”
;

159 
	mcouÁ
;

160 
	mmax
;

161 
£t_memb”
 *
	mli¡
;

162 *
	m³rmu‹
;

163 } 
	tdi¡ributiÚ
;

168 
	#DIST_SIZE
(
d
èd->
couÁ


	)

169 
	#DIST_MEMBER
(
d
, 
i
è((
£t_memb”
 *)((d)->
li¡
 + i))->
‹xt


	)

173 cÚ¡ *
	mÇme
;

174 cÚ¡ *
	mcomm’t
;

175 
	mba£
;

176 (*
	mh—d”
è(
FILE
 *
	mf
);

177 (*
	mlßd”
[2]) (*, );

178 (*
	mg’_£ed
)(, );

179 (*
	mv”ify
) (*, );

180 
	mchd
;

181 
	mvtÙ®
;

182 } 
	ttdef
;

184 
	sSEED_T
 {

185 
	mbË
;

186 
	mv®ue
;

187 
	mu§ge
;

188 
	mbound¬y
;

189 } 
	t£ed_t
;

192 #ià
defšed
(
__STDC__
)

193 
	#PROTO
(
s
è
	)
s

195 
	#PROTO
(
s
è()

	)

199 *
’v_cÚfig
 
PROTO
((*
v¬
, *
dæt
));

200 
yes_no
 
PROTO
((*
´om±
));

201 
a_ºd
 
PROTO
((
mš
, 
max
, 
cŞumn
, *
de¡
));

202 
tx_ºd
 
PROTO
((
mš
, 
max
, 
cŞumn
, *
tgt
));

203 
julŸn
 
PROTO
((
d©e
));

204 
unjulŸn
 
PROTO
((
d©e
));

205 
FILE
 *
tbl_İ’
 
PROTO
((
tbl
, *
mode
));

206 
ds¢ÿ£cmp
 
PROTO
((*
s1
, *
s2
, 
n
));

207 
dssÿ£cmp
 
PROTO
((*
s1
, *
s2
));

208 
pick_¡r
 
PROTO
((
di¡ributiÚ
 * 
s
, 
c
, *
rg‘
));

209 
agg_¡r
 
PROTO
((
di¡ributiÚ
 *
£t
, 
couÁ
, 
cŞ
, *
de¡
));

210 
»ad_di¡
 
PROTO
((*
·th
, *
Çme
, 
di¡ributiÚ
 * 
rg‘
));

211 
embed_¡r
 
PROTO
((
di¡ributiÚ
 *
d
, 
mš
, 
max
, 
¡»am
, *
de¡
));

212 #iâdeà
STDLIB_HAS_GETOPT


213 
g‘İt
 
PROTO
((
¬g_út
, **
¬g_veù
, *
İriÚs
));

215 
£t_¡©e
 
PROTO
((
t
, 
sÿË
, 
´ocs
, 
¡•
, *
e
));

218 
NextRªd
 
PROTO
((
nS“d
));

219 
UnifIÁ
 
PROTO
((
nLow
, 
nHigh
, 
nSŒ—m
));

220 
UnifR—l
 
PROTO
((
dLow
, 
dHigh
, 
nSŒ—m
));

221 
ExpÚ’tŸl
 
PROTO
((
dM—n
, 
nSŒ—m
));

222 
dss_¿ndom
(*
tgt
, 
mš
, 
max
, 
£ed
);

223 
row_¡¬t
(
t
);

224 
row_¡İ
(
t
);

225 
dump_£eds
(
t
);

228 
	#MAX_GRAMMAR_LEN
 12

	)

229 
	#MAX_SENT_LEN
 256

	)

230 
	#RNG_PER_SENT
 27

	)

232 
dbg_‹xt
 
PROTO
((* 
t
, 
mš
, 
max
, 
s
));

234 #ifdeà
DECLARER


235 
	#EXTERN


	)

237 
	#EXTERN
 

	)

241 
EXTERN
 
di¡ributiÚ
 
ÇtiÚs
;

242 
EXTERN
 
di¡ributiÚ
 
	gÇtiÚs2
;

243 
EXTERN
 
di¡ributiÚ
 
	g»giÚs
;

244 
EXTERN
 
di¡ributiÚ
 
	go_´iÜ™y_£t
;

245 
EXTERN
 
di¡ributiÚ
 
	gl_š¡ruù_£t
;

246 
EXTERN
 
di¡ributiÚ
 
	gl_smode_£t
;

247 
EXTERN
 
di¡ributiÚ
 
	gl_ÿ‹gÜy_£t
;

248 
EXTERN
 
di¡ributiÚ
 
	gl_ræag_£t
;

249 
EXTERN
 
di¡ributiÚ
 
	gc_m£g_£t
;

250 
EXTERN
 
di¡ributiÚ
 
	gcŞÜs
;

251 
EXTERN
 
di¡ributiÚ
 
	gp_ty³s_£t
;

252 
EXTERN
 
di¡ributiÚ
 
	gp_úŒ_£t
;

255 
EXTERN
 
di¡ributiÚ
 
	g¬tişes
;

256 
EXTERN
 
di¡ributiÚ
 
	gnouns
;

257 
EXTERN
 
di¡ributiÚ
 
	gadjeùives
;

258 
EXTERN
 
di¡ributiÚ
 
	gadv”bs
;

259 
EXTERN
 
di¡ributiÚ
 
	g´•os™iÚs
;

260 
EXTERN
 
di¡ributiÚ
 
	gv”bs
;

261 
EXTERN
 
di¡ributiÚ
 
	g‹rmš©Üs
;

262 
EXTERN
 
di¡ributiÚ
 
	gauxÏr›s
;

263 
EXTERN
 
di¡ributiÚ
 
	gÅ
;

264 
EXTERN
 
di¡ributiÚ
 
	gvp
;

265 
EXTERN
 
di¡ributiÚ
 
	gg¿mm¬
;

268 
EXTERN
 
	gsÿË
;

269 
EXTERN
 
	g»äesh
;

270 
EXTERN
 
	g»sume
;

271 
EXTERN
 
	gv”bo£
;

272 
EXTERN
 
	gfÜû
;

273 
EXTERN
 
	gh—d”
;

274 
EXTERN
 
	gcŞumÇr
;

275 
EXTERN
 
	gdœeù
;

276 
EXTERN
 
	gupd©es
;

277 
EXTERN
 
	gbË
;

278 
EXTERN
 
	gchd»n
;

279 
EXTERN
 
	gâames
;

280 
EXTERN
 
	gg’_sql
;

281 
EXTERN
 
	gg’_ºg
;

282 
EXTERN
 *
	gdb_Çme
;

283 
EXTERN
 
	g¡•
;

284 
EXTERN
 
	g£t_£eds
;

285 
EXTERN
 
	gv®id©e
;

286 
EXTERN
 *
	gd_·th
;

289 
EXTERN
 
	gš£¹_£gm’ts
;

290 
EXTERN
 
	gd–‘e_£gm’ts
;

291 
EXTERN
 
	gš£¹_Üd”s_£gm’t
;

292 
EXTERN
 
	gš£¹_lše™em_£gm’t
;

293 
EXTERN
 
	gd–‘e_£gm’t
;

296 #iâdeà
DECLARER


297 
tdef
 
tdefs
[];

313 
	#P_SIZE
 126

	)

314 #ifdeà
SSBM


315 
	#P_NAME_SCL
 3

	)

317 
	#P_NAME_SCL
 5

	)

319 
	#P_MFG_TAG
 "Mªuçùu»r#"

	)

320 
	#P_MFG_FMT
 "%s%01d"

	)

321 
	#P_MFG_MIN
 1

	)

322 
	#P_MFG_MAX
 5

	)

323 
	#P_BRND_TAG
 "B¿nd#"

	)

324 
	#P_BRND_FMT
 "%s%02d"

	)

325 
	#P_BRND_MIN
 1

	)

330 
	#P_BRND_MAX
 40

	)

333 
	#P_SIZE_MIN
 1

	)

334 
	#P_SIZE_MAX
 50

	)

335 
	#P_MCST_MIN
 100

	)

336 
	#P_MCST_MAX
 99900

	)

337 
	#P_MCST_SCL
 100.0

	)

338 
	#P_RCST_MIN
 90000

	)

339 
	#P_RCST_MAX
 200000

	)

340 
	#P_RCST_SCL
 100.0

	)

344 
	#S_SIZE
 145

	)

345 
	#S_NAME_TAG
 "Suµl›r#"

	)

346 
	#S_NAME_FMT
 "%s%09ld"

	)

347 
	#S_ABAL_MIN
 -99999

	)

348 
	#S_ABAL_MAX
 999999

	)

349 
	#S_CMNT_MAX
 101

	)

350 
	#S_CMNT_BBB
 10

	)

351 
	#BBB_DEADBEATS
 50

	)

352 
	#BBB_BASE
 "Cu¡om” "

	)

353 
	#BBB_COMPLAIN
 "Com¶ašts"

	)

354 
	#BBB_COMMEND
 "Recomm’ds"

	)

355 
	#BBB_CMNT_LEN
 19

	)

356 
	#BBB_BASE_LEN
 9

	)

357 
	#BBB_TYPE_LEN
 10

	)

362 
	#PS_SIZE
 145

	)

363 
	#PS_SKEY_MIN
 0

	)

364 
	#PS_SKEY_MAX
 ((
tdefs
[
SUPP
].
ba£
 - 1è* 
sÿË
)

	)

365 
	#PS_SCST_MIN
 100

	)

366 
	#PS_SCST_MAX
 100000

	)

367 
	#PS_QTY_MIN
 1

	)

368 
	#PS_QTY_MAX
 9999

	)

372 
	#C_SIZE
 165

	)

373 
	#C_NAME_TAG
 "Cu¡om”#"

	)

374 
	#C_NAME_FMT
 "%s%09ld"

	)

375 
	#C_MSEG_MAX
 5

	)

376 
	#C_ABAL_MIN
 -99999

	)

377 
	#C_ABAL_MAX
 999999

	)

381 
	#O_SIZE
 109

	)

382 
	#O_CKEY_MIN
 1

	)

383 
	#O_CKEY_MAX
 ()(
tdefs
[
CUST
].
ba£
 * 
sÿË
)

	)

384 
	#O_ODATE_MIN
 
STARTDATE


	)

385 
	#O_ODATE_MAX
 (
STARTDATE
 + 
TOTDATE
 - \

386 (
L_SDTE_MAX
 + 
L_RDTE_MAX
è- 1)

	)

387 
	#O_CLRK_TAG
 "CËrk#"

	)

388 
	#O_CLRK_FMT
 "%s%09d"

	)

389 
	#O_CLRK_SCL
 1000

	)

390 
	#O_LCNT_MIN
 1

	)

391 
	#O_LCNT_MAX
 7

	)

396 
	#L_SIZE
 144L

	)

397 
	#L_QTY_MIN
 1

	)

398 
	#L_QTY_MAX
 50

	)

399 
	#L_TAX_MIN
 0

	)

400 
	#L_TAX_MAX
 8

	)

401 
	#L_DCNT_MIN
 0

	)

402 
	#L_DCNT_MAX
 10

	)

403 
	#L_PKEY_MIN
 1

	)

405 #ifdeà
SSBM


407 
	#L_PKEY_MAX
 (
tdefs
[
PART
].
ba£
 * (
	`æoÜ
(
	`log
(()
sÿË
))+1))

	)

409 
	#L_PKEY_MAX
 (
tdefs
[
PART
].
ba£
 * 
sÿË
)

	)

412 
	#L_SDTE_MIN
 1

	)

413 
	#L_SDTE_MAX
 121

	)

414 
	#L_CDTE_MIN
 30

	)

415 
	#L_CDTE_MAX
 90

	)

416 
	#L_RDTE_MIN
 1

	)

417 
	#L_RDTE_MAX
 30

	)

421 
	#T_SIZE
 30

	)

422 
	#T_START_DAY
 3

	)

423 
	#LEAP
(
y
è((!(y % 4è&& (y % 100))?1:0)

	)

432 
	#SUPP_PER_PART
 4

	)

433 
	#ORDERS_PER_CUST
 10

	)

434 
	#CUST_MORTALITY
 3

	)

435 
	#NATIONS_MAX
 90

	)

436 
	#PHONE_FMT
 "%02d-%03d-%03d-%04d"

	)

437 
	#STARTDATE
 92001

	)

438 
	#CURRENTDATE
 95168

	)

439 
	#ENDDATE
 98365

	)

440 
	#TOTDATE
 2557

	)

441 
	#UPD_PCT
 10

	)

442 
	#MAX_STREAM
 47

	)

443 
	#V_STR_LOW
 0.4

	)

444 
	#PENNIES
 100

	)

445 
	#Q11_FRACTION
 ()0.0001

	)

449 
	#MIN_SCALE
 1.0

	)

450 
	#MAX_SCALE
 1000.0

	)

454 
	#MAX_32B_SCALE
 1000.0

	)

455 
	#INIT_HUGE
(
v
) { \

456 
v
 = (
DSS_HUGE
 *)
	`m®loc
((DSS_HUGEè* 
HUGE_COUNT
); \

457 
	`MALLOC_CHECK
(
v
); \

458 }

	)

459 
	#FREE_HUGE
(
v
è
	`ä“
(v)

	)

460 #ifdeà
SUPPORT_64BITS


461 
	#LONG2HUGE
(
¤c
, 
d¡
è*d¡ = (
DSS_HUGE
)
	)
src

462 
	#HUGE2LONG
(
¤c
, 
d¡
è*d¡ = ()
	)
src

463 
	#HUGE_SET
(
¤c
, 
d¡
è*d¡ = *
	)
src

464 
	#HUGE_MUL
(
İ1
, 
İ2
è*İ1 *ğ
	)
op2

465 
	#HUGE_DIV
(
İ1
, 
İ2
è*İ1 /ğ
	)
op2

466 
	#HUGE_ADD
(
İ1
, 
İ2
, 
d¡
è*d¡ = *İ1 + 
	)
op2

467 
	#HUGE_SUB
(
İ1
, 
İ2
, 
d¡
è*d¡ = *İ1 - 
	)
op2

468 
	#HUGE_MOD
(
İ1
, 
İ2
è*İ1 % 
	)
op2

469 
	#HUGE_CMP
(
İ1
, 
İ2
è(*İ1 =ğ*İ2)?0:(*İ1 < *İ2)-1:1

	)

471 
	#LONG2HUGE
(
¤c
, 
d¡
è{*d¡ = src; *(d¡ + 1èğ0;}

	)

472 
	#HUGE2LONG
(
¤c
, 
d¡
) { dst=0 ; \

473 
	`bcd2_bš
(
d¡
, (
¤c
 + 1)); \

474 
	`bcd2_bš
(
d¡
, 
¤c
); }

	)

475 
	#HUGE_SET
(
¤c
, 
d¡
è{ *d¡ = *¤ø; *(d¡ + 1èğ*(¤ø+ 1); }

	)

476 
	#HUGE_MUL
(
İ1
,
İ2
è
	`bcd2_mul
(İ1, (İ1 + 1), op2)

	)

477 
	#HUGE_DIV
(
İ1
,
İ2
è
	`bcd2_div
(İ1, (İ1 + 1), op2)

	)

478 
	#HUGE_ADD
(
İ1
,
İ2
,
d
) { \

479 
	`HUGE_SET
(
İ1
, 
d
); \

480 
	`bcd2_add
(
d
, (d + 1), 
İ2
); \

481 }

	)

482 
	#HUGE_SUB
(
İ1
,
İ2
,
d
) { \

483 
	`HUGE_SET
(
İ1
, 
d
); \

484 
	`bcd2_sub
(
d
, (d + 1), 
İ2
); \

485 }

	)

486 
	#HUGE_MOD
(
İ1
, 
İ2
è
	`bcd2_mod
(İ1, (İ1 + 1), op2)

	)

487 
	#HUGE_CMP
(
İ1
, 
İ2
è(
	`bcd2_cmp
(op1, (op1 + 1), op2) == 0)?0:\

488 ((
	`bcd2_cmp
(
İ1
, (İ1 + 1), 
İ2
è< 0)?-1:1)

	)

492 
	#DIST_TAG
 "DSS_DIST"

	)

493 
	#DIST_DFLT
 "di¡s.dss"

	)

494 
	#PATH_TAG
 "DSS_PATH"

	)

495 
	#PATH_DFLT
 "."

	)

496 
	#CONFIG_TAG
 "DSS_CONFIG"

	)

497 
	#CONFIG_DFLT
 "šşude/wÜklßd/ssb/dbg’"

	)

498 
	#ADHOC_TAG
 "DSS_ADHOC"

	)

499 
	#ADHOC_DFLT
 "adhoc.dss"

	)

502 #iâdeà
SEPARATOR


503 
	#SEPARATOR
 '|'

	)

506 
	#DT_STR
 0

	)

507 #iâdeà
MVS


508 
	#DT_VSTR
 
DT_STR


	)

510 
	#DT_VSTR
 1

	)

512 
	#DT_INT
 2

	)

513 
	#DT_HUGE
 3

	)

514 
	#DT_KEY
 4

	)

515 
	#DT_MONEY
 5

	)

517 #undeà
DT_CHR


518 
	#DT_CHR
 6

	)

520 
dbg_´št
(
dt
, 
FILE
 *
tgt
, *
d©a
, 
Ën
, 
eŞ
);

521 
	#PR_STR
(
f
, 
¡r
, 
Ën
è
	`dbg_´št
(
DT_STR
, f, (*)¡r,†’, 1)

	)

522 
	#PR_VSTR
(
f
, 
¡r
, 
Ën
è
	`dbg_´št
(
DT_VSTR
, f, (*)¡r,†’, 1)

	)

523 
	#PR_VSTR_LAST
(
f
, 
¡r
, 
Ën
è
	`dbg_´št
(
DT_VSTR
, f, (*)¡r,†’, 0)

	)

524 
	#PR_INT
(
f
, 
¡r
è
	`dbg_´št
(
DT_INT
, f, (*)¡r, 0, 1)

	)

525 
	#PR_HUGE
(
f
, 
¡r
è
	`dbg_´št
(
DT_HUGE
, f, (*)¡r, 0, 1)

	)

526 
	#PR_KEY
(
f
, 
¡r
è
	`dbg_´št
(
DT_KEY
, f, (*)¡r, 0, -1)

	)

527 
	#PR_MONEY
(
f
, 
¡r
è
	`dbg_´št
(
DT_MONEY
, f, (*)¡r, 0, 1)

	)

528 
	#PR_CHR
(
f
, 
¡r
è
	`dbg_´št
(
DT_CHR
, f, (*)¡r, 0, 1)

	)

529 
	#PR_STRT
(
å
è

	)

530 
	#PR_END
(
å
è
	`årštf
(å, "\n"è

	)

532 #ifdeà
SSBM


533 
	#PR_DATE
(
tgt
, 
yr
, 
mn
, 
dy
) \

534 
	`¥rštf
(
tgt
, "19%02ld%02ld%02ld", 
yr
, 
mn
, 
dy
)

	)

536 #ifdeà
MDY_DATE


537 
	#PR_DATE
(
tgt
, 
yr
, 
mn
, 
dy
) \

538 
	`¥rštf
(
tgt
, "%02ld-%02ld-19%02ld", 
mn
, 
dy
, 
yr
)

	)

540 
	#PR_DATE
(
tgt
, 
yr
, 
mn
, 
dy
) \

541 
	`¥rštf
(
tgt
, "19%02ld-%02ld-%02ld", 
yr
, 
mn
, 
dy
)

	)

547 
	#VRF_STR
(
t
, 
d
è{*
xx
 = d; *xxè
tdefs
[t].
vtÙ®
 +ğ*xx++;}

	)

548 
	#VRF_INT
(
t
,
d
è
tdefs
[t].
vtÙ®
 +ğ
	)
d

549 #ifdeà
SUPPORT_64BITS


550 
	#VRF_HUGE
(
t
,
d
è
tdefs
[t].
vtÙ®
 = *((*)&dè+ *((*)(&d + 1))

	)

552 
	#VRF_HUGE
(
t
,
d
è
tdefs
[t].
vtÙ®
 +ğd[0] + d[1]

	)

555 
	#VRF_MONEY
(
t
,
d
è
tdefs
[t].
vtÙ®
 = *((*)&dè+ *((*)(&d + 1))

	)

556 
	#VRF_CHR
(
t
,
d
è
tdefs
[t].
vtÙ®
 +ğ
	)
d

557 
	#VRF_STRT
(
t
)

	)

558 
	#VRF_END
(
t
)

	)

561 
	#UNIFORM
 0

	)

566 
	#P_MFG_SD
 0

	)

567 
	#P_BRND_SD
 1

	)

568 
	#P_TYPE_SD
 2

	)

569 
	#P_SIZE_SD
 3

	)

570 
	#P_CNTR_SD
 4

	)

571 
	#P_RCST_SD
 5

	)

572 
	#PS_QTY_SD
 7

	)

573 
	#PS_SCST_SD
 8

	)

574 
	#O_SUPP_SD
 10

	)

575 
	#O_CLRK_SD
 11

	)

576 
	#O_ODATE_SD
 13

	)

577 
	#L_QTY_SD
 14

	)

578 
	#L_DCNT_SD
 15

	)

579 
	#L_TAX_SD
 16

	)

580 
	#L_SHIP_SD
 17

	)

581 
	#L_SMODE_SD
 18

	)

582 
	#L_PKEY_SD
 19

	)

583 
	#L_SKEY_SD
 20

	)

584 
	#L_SDTE_SD
 21

	)

585 
	#L_CDTE_SD
 22

	)

586 
	#L_RDTE_SD
 23

	)

587 
	#L_RFLG_SD
 24

	)

588 
	#C_NTRG_SD
 27

	)

589 
	#C_PHNE_SD
 28

	)

590 
	#C_ABAL_SD
 29

	)

591 
	#C_MSEG_SD
 30

	)

592 
	#S_NTRG_SD
 33

	)

593 
	#S_PHNE_SD
 34

	)

594 
	#S_ABAL_SD
 35

	)

595 
	#P_NAME_SD
 37

	)

596 
	#O_PRIO_SD
 38

	)

597 
	#HVAR_SD
 39

	)

598 
	#O_CKEY_SD
 40

	)

599 
	#N_CMNT_SD
 41

	)

600 
	#R_CMNT_SD
 42

	)

601 
	#O_LCNT_SD
 43

	)

602 
	#BBB_JNK_SD
 44

	)

603 
	#BBB_TYPE_SD
 45

	)

604 
	#BBB_CMNT_SD
 46

	)

605 
	#BBB_OFFSET_SD
 47

	)

609 
EXIT_NAMESPACE
(
dbg’ssb
);

	@include/workload/ssb/dbgen/dsstypes.h

9 #iâdeà
SSB_DBGEN_DSSTYPES_H


10 
	#SSB_DBGEN_DSSTYPES_H


	)

12 
	~"ut/Çme¥aû.h
"

14 
ENTER_NAMESPACE
(
dbg’ssb
);

19 #ifdeà
SSBM


22 
	mcu¡key
;

23 
	mÇme
[
C_NAME_LEN
 + 1];

24 
	mÆ’
;

25 
	madd»ss
[
C_ADDR_MAX
 + 1];

26 
	m®’
;

27 
	mc™y
[
CITY_FIX
+1];

28 
	mÇtiÚ_Çme
[
C_NATION_NAME_LEN
+1];

29 
	m»giÚ_key
;

30 
	m»giÚ_Çme
[
C_REGION_NAME_LEN
+1];

31 
	mphÚe
[
PHONE_LEN
 + 1];

32 
	mmkt£gm’t
[
MAXAGG_LEN
 + 1];

33 } 
	tcu¡om”_t
;

37 
	mcu¡key
;

38 
	mÇme
[
C_NAME_LEN
 + 1];

39 
	madd»ss
[
C_ADDR_MAX
 + 1];

40 
	m®’
;

41 
	mÇtiÚ_code
;

42 
	mphÚe
[
PHONE_LEN
 + 1];

43 
	macùb®
;

44 
	mmkt£gm’t
[
MAXAGG_LEN
 + 1];

45 
	mcomm’t
[
C_CMNT_MAX
 + 1];

46 
	mş’
;

47 } 
	tcu¡om”_t
;

51 
mk_cu¡
 
PROTO
((
n_cu¡
, 
cu¡om”_t
 * 
c
));

52 
´_cu¡
 
PROTO
((
cu¡om”_t
 * 
c
, 
mode
));

53 
ld_cu¡
 
PROTO
((
cu¡om”_t
 * 
c
, 
mode
));

55 #ifdeà
SSBM


59 
DSS_HUGE
 *
	mokey
;

60 
	mlš’umb”
;

61 
	mcu¡key
;

62 
	m·¹key
;

63 
	msuµkey
;

64 
	mÜd”d©e
[
DATE_LEN
];

65 
	mİriÜ™y
[
MAXAGG_LEN
 + 1];

66 
	msh_´iÜ™y
;

67 
	mquªt™y
;

68 
	mex‹nded_´iû
;

69 
	mÜd”_tÙ®´iû
;

70 
	mdiscouÁ
;

71 
	m»v’ue
;

72 
	msuµ_co¡
;

73 
	mx
;

74 
	mcomm™_d©e
[
DATE_LEN
] ;

75 
	mshmode
[
O_SHIP_MODE_LEN
 + 1];

76 } 
	tlšeÜd”_t
;

80 
DSS_HUGE
 *
	mokey
;

81 
	m·¹key
;

82 
	msuµkey
;

83 
	mlút
;

84 
	mquªt™y
;

85 
	m•riû
;

86 
	mdiscouÁ
;

87 
	mx
;

88 
	mræag
[1];

89 
	ml¡©us
[1];

90 
	mcd©e
[
DATE_LEN
];

91 
	msd©e
[
DATE_LEN
];

92 
	mrd©e
[
DATE_LEN
];

93 
	mshš¡ruù
[
MAXAGG_LEN
 + 1];

94 
	mshmode
[
MAXAGG_LEN
 + 1];

95 
	mcomm’t
[
L_CMNT_MAX
 + 1];

96 
	mş’
;

97 } 
	tlše_t
;

100 #ifdeà
SSBM


103 
DSS_HUGE
 *
	mokey
;

104 
	mcu¡key
;

105 
	mtÙ®´iû
;

106 
	mod©e
[
DATE_LEN
];

107 
	mİriÜ™y
[
MAXAGG_LEN
 + 1];

108 
	mş”k
[
O_CLRK_LEN
 + 1];

109 
	m¥riÜ™y
;

110 
	mlšes
;

111 
lšeÜd”_t
 
	mlšeÜd”s
[
O_LCNT_MAX
];

112 } 
	tÜd”_t
;

116 
DSS_HUGE
 *
	mokey
;

117 
	mcu¡key
;

118 
	mÜd”¡©us
;

119 
	mtÙ®´iû
;

120 
	mod©e
[
DATE_LEN
];

121 
	mİriÜ™y
[
MAXAGG_LEN
 + 1];

122 
	mş”k
[
O_CLRK_LEN
 + 1];

123 
	m¥riÜ™y
;

124 
	mlšes
;

125 
	mcomm’t
[
O_CMNT_MAX
 + 1];

126 
	mş’
;

127 
lše_t
 
	ml
[
O_LCNT_MAX
];

128 } 
	tÜd”_t
;

132 
mk_Üd”
 
PROTO
((
šdex
, 
Üd”_t
 * 
o
, 
upd_num
));

133 
´_Üd”
 
PROTO
((
Üd”_t
 * 
o
, 
mode
));

134 
ld_Üd”
 
PROTO
((
Üd”_t
 * 
o
, 
mode
));

135 
ez_¥¬£
 
PROTO
((
šdex
, 
DSS_HUGE
 *
ok
, 
£q
));

136 #iâdeà
SUPPORT_64BITS


137 
hd_¥¬£
 
PROTO
((
šdex
, 
DSS_HUGE
 *
ok
, 
£q
));

140 #ifdeà
SSBM


145 
	m·¹key
;

146 
	msuµkey
;

147 
	mqty
;

148 
	msco¡
;

149 
	mcomm’t
[
PS_CMNT_MAX
 + 1];

150 
	mş’
;

151 } 
	t·¹suµ_t
;

154 #ifdeà
SSBM


157 
	m·¹key
;

158 
	mÇme
[
P_NAME_LEN
 + 1];

159 
	mÆ’
;

160 
	mmfgr
[
P_MFG_LEN
 + 1];

161 
	mÿ‹gÜy
[
P_CAT_LEN
 + 1];

162 
	mb¿nd
[
P_BRND_LEN
 + 1];

163 
	mcŞÜ
[
P_COLOR_MAX
 + 1];

164 
	mş’
;

165 
	mty³
[
P_TYPE_MAX
 + 1];

166 
	m’
;

167 
	msize
;

168 
	mcÚš”
[
P_CNTR_LEN
 + 1];

169 } 
	t·¹_t
;

173 
	m·¹key
;

174 
	mÇme
[
P_NAME_LEN
 + 1];

175 
	mÆ’
;

176 
	mmfgr
[
P_MFG_LEN
 + 1];

177 
	mb¿nd
[
P_BRND_LEN
 + 1];

178 
	mty³
[
P_TYPE_LEN
 + 1];

179 
	m’
;

180 
	msize
;

181 
	mcÚš”
[
P_CNTR_LEN
 + 1];

182 
	m»´iû
;

183 
	mcomm’t
[
P_CMNT_MAX
 + 1];

184 
	mş’
;

185 
·¹suµ_t
 
	ms
[
SUPP_PER_PART
];

186 } 
	t·¹_t
;

190 
mk_·¹
 
PROTO
((
šdex
, 
·¹_t
 * 
p
));

191 
´_·¹
 
PROTO
((
·¹_t
 * 
·¹
, 
mode
));

192 
ld_·¹
 
PROTO
((
·¹_t
 * 
·¹
, 
mode
));

194 #ifdeà
SSBM


197 
	msuµkey
;

198 
	mÇme
[
S_NAME_LEN
 + 1];

199 
	madd»ss
[
S_ADDR_MAX
 + 1];

200 
	m®’
;

201 
	mc™y
[
CITY_FIX
 +1];

202 
	mÇtiÚ_Çme
[
S_NATION_NAME_LEN
+1];

203 
	m»giÚ_key
;

204 
	m»giÚ_Çme
[
S_REGION_NAME_LEN
+1];

205 
	mphÚe
[
PHONE_LEN
 + 1];

206 } 
	tsuµl›r_t
;

210 
	msuµkey
;

211 
	mÇme
[
S_NAME_LEN
 + 1];

212 
	madd»ss
[
S_ADDR_MAX
 + 1];

213 
	m®’
;

214 
	mÇtiÚ_code
;

215 
	mphÚe
[
PHONE_LEN
 + 1];

216 
	macùb®
;

217 
	mcomm’t
[
S_CMNT_MAX
 + 1];

218 
	mş’
;

219 } 
	tsuµl›r_t
;

223 
mk_suµ
 
PROTO
((
šdex
, 
suµl›r_t
 * 
s
));

224 
´_suµ
 
PROTO
((
suµl›r_t
 * 
suµ
, 
mode
));

225 
ld_suµ
 
PROTO
((
suµl›r_t
 * 
suµ
, 
mode
));

227 #ifdeà
SSBM


232 
	md©ekey
;

233 
	md©e
[
D_DATE_LEN
+1];

234 
	mdayofw“k
[
D_DAYWEEK_LEN
+1] ;

235 
	mmÚth
[
D_MONTH_LEN
+1];

236 
	my—r
;

237 
	my—rmÚthnum
;

238 
	my—rmÚth
[
D_YEARMONTH_LEN
+1];

239 
	mdaynumšw“k
;

240 
	mdaynumšmÚth
;

241 
	mdaynumšy—r
;

242 
	mmÚthnumšy—r
;

243 
	mw“knumšy—r
;

244 
	m£Îšg£asÚ
[
D_SEASON_LEN
 + 1];

245 
	m¦’
;

246 
	mÏ¡dayšw“kæ
[2];

247 
	mÏ¡dayšmÚthæ
[2];

248 
	mhŞidayæ
[2];

249 
	mw“kdayæ
[2];

250 } 
	td©e_t
;

254 
mk_d©e
 
PROTO
((
šdex
, 
d©e_t
 * 
d
));

255 
´_d©e
 
PROTO
((* 
d©e
, 
mode
));

256 
ld_d©e
 
PROTO
((* 
d©e
, 
mode
));

262 
	mtimekey
;

263 
	m®pha
[
DATE_LEN
];

264 
	my—r
;

265 
	mmÚth
;

266 
	mw“k
;

267 
	mday
;

268 } 
	tdss_time_t
;

271 
mk_time
 
PROTO
((
šdex
, 
dss_time_t
 * 
t
));

280 
	mcode
;

281 *
	m‹xt
;

282 
	mjoš
;

283 
	mcomm’t
[
N_CMNT_MAX
 + 1];

284 
	mş’
;

285 } 
	tcode_t
;

288 
mk_ÇtiÚ
 
PROTO
((
i
, 
code_t
 * 
c
));

289 
´_ÇtiÚ
 
PROTO
((
code_t
 * 
c
, 
mode
));

290 
ld_ÇtiÚ
 
PROTO
((
code_t
 * 
c
, 
mode
));

291 
mk_»giÚ
 
PROTO
((
i
, 
code_t
 * 
c
));

292 
´_»giÚ
 
PROTO
((
code_t
 * 
c
, 
mode
));

293 
ld_»giÚ
 
PROTO
((
code_t
 * 
c
, 
mode
));

295 
EXIT_NAMESPACE
(
dbg’ssb
);

	@include/workload/ssb/dbgen/permute.h

4 #iâdeà
SSB_DBGEN_PERMUTE_H


5 
	#SSB_DBGEN_PERMUTE_H


	)

7 
	~"ut/Çme¥aû.h
"

9 
ENTER_NAMESPACE
(
dbg’ssb
);

11 
	g³rmutiÚ
[41][22] =

56 
EXIT_NAMESPACE
(
dbg’ssb
);

	@include/workload/ssb/dbgen/rnd.h

8 #iâdeà
SSB_DBGEN_RND_H


9 
	#SSB_DBGEN_RND_H


	)

11 
	~"ut/Çme¥aû.h
"

13 
ENTER_NAMESPACE
(
dbg’ssb
);

16 
NextRªd
 
PROTO
(());

17 
UnifIÁ
 
PROTO
((, , ));

18 
UnifR—l
 
PROTO
((, , ));

19 
ExpÚ’tŸl
 
PROTO
((, ));

21 
	gnA
 = 16807;

22 
	gnM
 = 2147483647;

23 
	gnQ
 = 127773;

24 
	gnR
 = 2836;

26 
	gdM
 = 2147483647.0;

36 
	#VSTR_MAX
(
Ën
è()Ö’ / 5 + (ËÀ% 5 =ğ0)?0:1 + 1)

	)

37 
£ed_t
 
	gS“d
[
MAX_STREAM
 + 1] =

39 {
PART
, 1, 0, 1},

40 {
PART
, 46831694, 0, 1},

41 {
PART
, 1841581359, 0, 1},

42 {
PART
, 1193163244, 0, 1},

43 {
PART
, 727633698, 0, 1},

44 {
NONE
, 933588178, 0, 1},

45 {
PART
, 804159733, 0, 
RNG_PER_SENT
 * 3},

46 {
PSUPP
, 1671059989, 0, 
SUPP_PER_PART
},

47 {
PSUPP
, 1051288424, 0, 
SUPP_PER_PART
},

48 {
PSUPP
, 1961692154, 0, 
SUPP_PER_PART
 * 
RNG_PER_SENT
 * 20},

49 {
ORDER
, 1227283347, 0, 1},

50 {
ORDER
, 1171034773, 0, 1},

51 {
ORDER
, 276090261, 0, 
RNG_PER_SENT
 * 8},

52 {
ORDER
, 1066728069, 0, 1},

53 {
LINE
, 209208115, 0, 
O_LCNT_MAX
},

54 {
LINE
, 554590007, 0, 
O_LCNT_MAX
},

55 {
LINE
, 721958466, 0, 
O_LCNT_MAX
},

56 {
LINE
, 1371272478, 0, 
O_LCNT_MAX
},

57 {
LINE
, 675466456, 0, 
O_LCNT_MAX
},

58 {
LINE
, 1808217256, 0, 
O_LCNT_MAX
},

59 {
LINE
, 2095021727, 0, 
O_LCNT_MAX
},

60 {
LINE
, 1769349045, 0, 
O_LCNT_MAX
},

61 {
LINE
, 904914315, 0, 
O_LCNT_MAX
},

62 {
LINE
, 373135028, 0, 
O_LCNT_MAX
},

63 {
LINE
, 717419739, 0, 
O_LCNT_MAX
},

64 {
LINE
, 1095462486, 0, 
O_LCNT_MAX
 * 
RNG_PER_SENT
 * 5},

65 {
CUST
, 881155353, 0, 9},

66 {
CUST
, 1489529863, 0, 1},

67 {
CUST
, 1521138112, 0, 3},

68 {
CUST
, 298370230, 0, 1},

69 {
CUST
, 1140279430, 0, 1},

70 {
CUST
, 1335826707, 0, 
RNG_PER_SENT
 * 12},

71 {
SUPP
, 706178559, 0, 9},

72 {
SUPP
, 110356601, 0, 1},

73 {
SUPP
, 884434366, 0, 3},

74 {
SUPP
, 962338209, 0, 1},

75 {
SUPP
, 1341315363, 0, 
RNG_PER_SENT
 * 11},

76 {
PART
, 709314158, 0, 92},

77 {
ORDER
, 591449447, 0, 1},

78 {
LINE
, 431918286, 0, 1},

79 {
ORDER
, 851767375, 0, 1},

80 {
NATION
, 606179079, 0, 
RNG_PER_SENT
 * 16},

81 {
REGION
, 1500869201, 0, 
RNG_PER_SENT
 * 16},

82 {
ORDER
, 1434868289, 0, 1},

83 {
SUPP
, 263032577, 0, 1},

84 {
SUPP
, 753643799, 0, 1},

85 {
SUPP
, 202794285, 0, 1},

86 {
SUPP
, 715851524, 0, 1}

89 
EXIT_NAMESPACE
(
dbg’ssb
);

	@include/workload/ssb/dbgen/shared.h

6 #iâdeà
SSB_DBGEN_SHARED_H


7 
	#SSB_DBGEN_SHARED_H


	)

9 
	~"ut/Çme¥aû.h
"

11 
ENTER_NAMESPACE
(
dbg’ssb
);

13 
	#N_CMNT_LEN
 72

	)

14 
	#N_CMNT_MAX
 152

	)

15 
	#R_CMNT_LEN
 72

	)

16 
	#R_CMNT_MAX
 152

	)

17 
	#MONEY_SCL
 0.01

	)

18 
	#V_STR_HGH
 1.6

	)

20 #ifdeà
SSBM


21 
	#P_NAME_LEN
 22

	)

22 
	#P_MFG_LEN
 6

	)

23 
	#P_COLOR_LEN
 3

	)

24 
	#P_COLOR_MAX
 11

	)

25 
	#P_TYPE_MAX
 25

	)

26 
	#P_CAT_LEN
 7

	)

27 
	#P_CAT_MIN
 1

	)

28 
	#P_CAT_MAX
 5

	)

29 
	#P_CAT_SD
 97

	)

30 
	#S_NATION_NAME_LEN
 15

	)

31 
	#S_REGION_NAME_LEN
 12

	)

32 
	#C_NATION_NAME_LEN
 15

	)

33 
	#C_REGION_NAME_LEN
 12

	)

34 
	#C_NAT_SD
 16

	)

35 
	#C_REG_SD
 3

	)

36 
	#O_SHIP_STRU_LEN
 25

	)

37 
	#O_SHIP_MODE_LEN
 10

	)

38 
	#O_SHIP_PRIO_LEN
 1

	)

39 
	#D_DATE_LEN
 18

	)

40 
	#D_DAYWEEK_LEN
 9

	)

41 
	#D_YEARMONTH_LEN
 7

	)

42 
	#D_SEASON_LEN
 12

	)

43 
	#D_MONTH_LEN
 9

	)

44 
	#D_STARTDATE
 694245661

	)

45 
	#NAMTION_BRIEF_LEN
 9

	)

46 
	#CITY_CODE_SEED
 15

	)

47 
	#NUM_DAYS
 2556

	)

48 
	#NUM_SEASONS
 5

	)

49 
	#NUM_HOLIDAYS
 10

	)

50 
	#CITY_FIX
 10

	)

53 
	#P_NAME_LEN
 55

	)

54 
	#P_MFG_LEN
 25

	)

58 
	#P_BRND_LEN
 10

	)

60 #ifdeà
SSBM


61 
	#P_TYPE_LEN
 12

	)

65 
	#P_TYPE_LEN
 25

	)

69 
	#P_CNTR_LEN
 10

	)

70 
	#P_CMNT_LEN
 14

	)

71 
	#P_CMNT_MAX
 23

	)

72 
	#P_CAT_SEED
 25

	)

74 
	#S_NAME_LEN
 25

	)

76 #ifdeà
SSBM


77 
	#S_ADDR_LEN
 15

	)

78 
	#S_ADDR_MAX
 25

	)

81 
	#S_ADDR_LEN
 25

	)

82 
	#S_ADDR_MAX
 40

	)

85 
	#S_CMNT_LEN
 63

	)

86 
	#S_CMNT_MAX
 101

	)

87 
	#PS_CMNT_LEN
 124

	)

88 
	#PS_CMNT_MAX
 199

	)

90 #ifdeà
SSBM


91 
	#C_NAME_LEN
 25

	)

92 
	#C_MSEG_MIN
 1

	)

93 
	#C_MSEG_MAX
 5

	)

94 
	#C_ADDR_LEN
 15

	)

95 
	#C_ADDR_MAX
 25

	)

97 
	#C_NAME_LEN
 18

	)

98 
	#C_ADDR_LEN
 25

	)

99 
	#C_ADDR_MAX
 40

	)

102 
	#C_MSEG_LEN
 10

	)

103 
	#C_CMNT_LEN
 73

	)

104 
	#C_CMNT_MAX
 117

	)

106 #ifdeà
SSBM


107 
	#O_OPRIO_LEN
 8

	)

110 
	#O_OPRIO_LEN
 15

	)

114 
	#O_CLRK_LEN
 15

	)

115 
	#O_CMNT_LEN
 49

	)

116 
	#O_CMNT_MAX
 79

	)

117 
	#L_CMNT_LEN
 27

	)

118 
	#L_CMNT_MAX
 44

	)

119 
	#L_INST_LEN
 25

	)

120 
	#L_SMODE_LEN
 10

	)

121 
	#T_ALPHA_LEN
 10

	)

122 
	#DATE_LEN
 13

	)

123 
	#NATION_LEN
 25

	)

124 
	#REGION_LEN
 25

	)

125 
	#PHONE_LEN
 15

	)

127 #ifdeà
SSBM


128 
	#MAXAGG_LEN
 10

	)

131 
	#MAXAGG_LEN
 20

	)

135 
	#P_CMNT_SD
 6

	)

136 
	#PS_CMNT_SD
 9

	)

137 
	#O_CMNT_SD
 12

	)

138 
	#C_ADDR_SD
 26

	)

139 
	#C_CMNT_SD
 31

	)

140 
	#S_ADDR_SD
 32

	)

141 
	#S_CMNT_SD
 36

	)

142 
	#L_CMNT_SD
 25

	)

147 
EXIT_NAMESPACE
(
dbg’ssb
);

	@include/workload/ssb/dbgen/tpcd.h

10 #iâdeà
SSB_DBGEN_TPCD_H


11 
	#SSB_DBGEN_TPCD_H


	)

13 
	~"ut/Çme¥aû.h
"

15 
ENTER_NAMESPACE
(
dbg’ssb
);

17 
	#DFLT
 0x0001

	)

18 
	#OUTPUT
 0x0002

	)

19 
	#EXPLAIN
 0x0004

	)

20 
	#DBASE
 0x0008

	)

21 
	#VERBOSE
 0x0010

	)

22 
	#TIMING
 0x0020

	)

23 
	#LOG
 0x0040

	)

24 
	#QUERY
 0x0080

	)

25 
	#REFRESH
 0x0100

	)

26 
	#ANSI
 0x0200

	)

27 
	#SEED
 0x0400

	)

28 
	#COMMENT
 0x0800

	)

29 
	#INIT
 0x1000

	)

30 
	#TERMINATE
 0x2000

	)

31 
	#DFLT_NUM
 0x4000

	)

36 
	#VTAG
 ':'

	)

37 
	#oå
 
¡dout


	)

38 
	#QDIR_TAG
 "DSS_QUERY"

	)

39 
	#QDIR_DFLT
 "."

	)

44 #ifdeà
DB2


45 
	#GEN_QUERY_PLAN
 "SET CURRENT EXPLAIN SNAPSHOT ON;"

	)

46 
	#START_TRAN
 ""

	)

47 
	#END_TRAN
 "COMMIT WORK;"

	)

48 
	#SET_OUTPUT
 ""

	)

49 
	#SET_ROWCOUNT
 "--#SET ROWS_FETCH %d\n"

	)

50 
	#SET_DBASE
 "CONNECT TO % ;\n"

	)

53 #ifdeà
INFORMIX


54 
	#GEN_QUERY_PLAN
 "SET EXPLAIN ON;"

	)

55 
	#START_TRAN
 "BEGIN WORK;"

	)

56 
	#END_TRAN
 "COMMIT WORK;"

	)

57 
	#SET_OUTPUT
 "OUTPUT TO "

	)

58 
	#SET_ROWCOUNT
 "FIRST %d"

	)

59 
	#SET_DBASE
 "d©aba£ % ;\n"

	)

62 #ifdeà 
SQLSERVER


63 
	#GEN_QUERY_PLAN
 "£ˆshow¶ª on\n£ˆnÛxeøÚ\ngo\n"

	)

64 
	#START_TRAN
 "begš¿n§ùiÚ\ngo\n"

	)

65 
	#END_TRAN
 "comm™¿n§ùiÚ\ngo\n"

	)

66 
	#SET_OUTPUT
 ""

	)

67 
	#SET_ROWCOUNT
 "£ˆrowcouÁ %d\ngo\n\n"

	)

68 
	#SET_DBASE
 "u£ %s\ngo\n"

	)

71 #ifdeà 
SYBASE


72 
	#GEN_QUERY_PLAN
 "£ˆshow¶ª on\n£ˆnÛxeøÚ\ngo\n"

	)

73 
	#START_TRAN
 "begš¿n§ùiÚ\ngo\n"

	)

74 
	#END_TRAN
 "comm™¿n§ùiÚ\ngo\n"

	)

75 
	#SET_OUTPUT
 ""

	)

76 
	#SET_ROWCOUNT
 "£ˆrowcouÁ %d\ngo\n\n"

	)

77 
	#SET_DBASE
 "u£ %s\ngo\n"

	)

80 #ifdeà
TDAT


81 
	#GEN_QUERY_PLAN
 "EXPLAIN"

	)

82 
	#START_TRAN
 "BEGIN TRANSACTION"

	)

83 
	#END_TRAN
 "END TRANSACTION"

	)

84 
	#SET_OUTPUT
 ".SET FORMAT OFF\n.EXPORT REPORT fe="

	)

85 
	#SET_ROWCOUNT
 ".SET RETCANCEL ON\n.SET RETLIMIT %d\n"

	)

86 
	#SET_DBASE
 ".LOGON %s\n"

	)

89 
	#MAX_VARS
 8

	)

90 
	#QLEN_MAX
 2048

	)

91 
	#QUERIES_PER_SET
 22

	)

92 
	#MAX_PIDS
 50

	)

94 
EXTERN
 
	gæags
;

95 
EXTERN
 
	gs_út
;

96 
EXTERN
 *
	gosuff
;

97 
EXTERN
 
	g¡»am
;

98 
EXTERN
 *
	glfe
;

99 
EXTERN
 *
	gife
;

100 
EXTERN
 *
	gtfe
;

102 
	#MAX_PERMUTE
 41

	)

103 #ifdeà
DECLARER


104 
	growút_dæt
[
QUERIES_PER_SET
 + 1] =

106 
	growút
;

107 
	#SEQUENCE
(
¡»am
, 
qu”y
è
³rmutiÚ
[¡»am % 
MAX_PERMUTE
][qu”y - 1]

	)

109 
rowút_dæt
[];

110 
rowút
;

113 
EXIT_NAMESPACE
(
dbg’ssb
);

	@include/workload/ssb/shore_ssb_client.h

31 #iâdeà
__SHORE_SSB_CLIENT_H


32 
	#__SHORE_SSB_CLIENT_H


	)

34 
	~"sm/shÜe/shÜe_ş›Á.h
"

36 
	~"wÜklßd/ssb/ssb_cÚ¡.h
"

37 
	~"wÜklßd/ssb/shÜe_ssb_’v.h
"

40 
ENTER_NAMESPACE
(
ssb
);

42 
usšg
 
Çme¥aû
 
	gshÜe
;

53 şas 
	cba£lše_ssb_ş›Á_t
 : 
public
 
ba£_ş›Á_t


55 
´iv©e
:

56 
_£lid
;

57 
Œx_wÜk”_t
* 
	m_wÜk”
;

58 
	m_qf
;

60 
	mpublic
:

62 
	$ba£lše_ssb_ş›Á_t
() { }

64 
	`ba£lše_ssb_ş›Á_t
(
c_¡r
 
Šame
, cÚ¡ 
id
, 
ShÜeSSBEnv
* 
’v
,

65 cÚ¡ 
M—su»m’tTy³
 
aTy³
, cÚ¡ 
Œxid
,

66 cÚ¡ 
numOfTrxs
,

67 
´oûssÜid_t
 
­rsid
, cÚ¡ 
£lID
, cÚ¡ 
qf
);

69 ~
	$ba£lše_ssb_ş›Á_t
(è{ 
	}
}

72 
lßd_sup_xù
(
m­SupTrxs
& 
m­
);

76 
w_rc_t
 
subm™_Úe
(
xù_ty³
, 
xùid
);

81 
EXIT_NAMESPACE
(
ssb
);

	@include/workload/ssb/shore_ssb_env.h

31 #iâdeà
__SHORE_SSB_ENV_H


32 
	#__SHORE_SSB_ENV_H


	)

34 
	~"sm_vas.h
"

35 
	~"ut.h
"

37 
	~"sm/shÜe/shÜe_’v.h
"

38 
	~"sm/shÜe/shÜe_asc_sÜt_buf.h
"

39 
	~"sm/shÜe/shÜe_Œx_wÜk”.h
"

41 
	~"wÜklßd/ssb/ssb_cÚ¡.h
"

43 
	~"wÜklßd/ssb/shÜe_ssb_schema_mª.h
"

44 
	~"wÜklßd/ssb/ssb_šput.h
"

46 #ifdeà
CFG_QPIPE


47 
	~"qpe.h
"

50 
	~<m­
>

52 
usšg
 
Çme¥aû
 
	gshÜe
;

55 
ENTER_NAMESPACE
(
ssb
);

58 
usšg
 
	g¡d
::
m­
;

65 cÚ¡ 
	gSSB_SCALING_FACTOR
 = 1;

71 cÚ¡ 
	gLO_POP_UNIT
 = 10;

81 
	sShÜeSSBTrxCouÁ


83 
ušt
 
	mqd©e
;

84 
ušt
 
	mq·¹
;

85 
ušt
 
	mqsuµl›r
;

86 
ušt
 
	mqcu¡om”
;

87 
ušt
 
	mqlšeÜd”
;

88 
ušt
 
	mq‹¡
;

89 
ušt
 
	mq1_1
;

90 
ušt
 
	mq1_2
;

91 
ušt
 
	mq1_3
;

92 
ušt
 
	mq2_1
;

93 
ušt
 
	mq2_2
;

94 
ušt
 
	mq2_3
;

95 
ušt
 
	mq3_1
;

96 
ušt
 
	mq3_2
;

97 
ušt
 
	mq3_3
;

98 
ušt
 
	mq3_4
;

99 
ušt
 
	mq4_1
;

100 
ušt
 
	mq4_2
;

101 
ušt
 
	mq4_3
;

103 
ušt
 
	mqNP
;

106 
	mShÜeSSBTrxCouÁ
& 
	mİ”©Ü
+=(
ShÜeSSBTrxCouÁ
 cÚ¡& 
rhs
) {

107 
qd©e
 +ğ
rhs
.qdate;

108 
	mq·¹
 +ğ
rhs
.
q·¹
;

109 
	mqsuµl›r
 +ğ
rhs
.
qsuµl›r
;

110 
	mqcu¡om”
 +ğ
rhs
.
qcu¡om”
;

111 
	mqlšeÜd”
 +ğ
rhs
.
qlšeÜd”
;

112 
	mq‹¡
 +ğ
rhs
.
q‹¡
;

113 
	mq1_1
 +ğ
rhs
.
q1_1
;

114 
	mq1_2
 +ğ
rhs
.
q1_2
;

115 
	mq1_3
 +ğ
rhs
.
q1_3
;

116 
	mq2_1
 +ğ
rhs
.
q2_1
;

117 
	mq2_2
 +ğ
rhs
.
q2_2
;

118 
	mq2_3
 +ğ
rhs
.
q2_3
;

119 
	mq3_1
 +ğ
rhs
.
q3_1
;

120 
	mq3_2
 +ğ
rhs
.
q3_2
;

121 
	mq3_3
 +ğ
rhs
.
q3_3
;

122 
	mq3_4
 +ğ
rhs
.
q3_4
;

123 
	mq4_1
 +ğ
rhs
.
q4_1
;

124 
	mq4_2
 +ğ
rhs
.
q4_2
;

125 
	mq4_3
 +ğ
rhs
.
q4_3
;

127 
	mqNP
 +ğ
rhs
.
qNP
;

129  (*
	mthis
);

132 
	mShÜeSSBTrxCouÁ
& 
	mİ”©Ü
-=(
ShÜeSSBTrxCouÁ
 cÚ¡& 
rhs
) {

133 
qd©e
 -ğ
rhs
.qdate;

134 
	mq·¹
 -ğ
rhs
.
q·¹
;

135 
	mqsuµl›r
 -ğ
rhs
.
qsuµl›r
;

136 
	mqcu¡om”
 -ğ
rhs
.
qcu¡om”
;

137 
	mqlšeÜd”
 -ğ
rhs
.
qlšeÜd”
;

138 
	mq‹¡
 -ğ
rhs
.
q‹¡
;

139 
	mq1_1
 -ğ
rhs
.
q1_1
;

140 
	mq1_2
 -ğ
rhs
.
q1_2
;

141 
	mq1_3
 -ğ
rhs
.
q1_3
;

142 
	mq2_1
 -ğ
rhs
.
q2_1
;

143 
	mq2_2
 -ğ
rhs
.
q2_2
;

144 
	mq2_3
 -ğ
rhs
.
q2_3
;

145 
	mq3_1
 -ğ
rhs
.
q3_1
;

146 
	mq3_2
 -ğ
rhs
.
q3_2
;

147 
	mq3_3
 -ğ
rhs
.
q3_3
;

148 
	mq3_4
 -ğ
rhs
.
q3_4
;

149 
	mq4_1
 -ğ
rhs
.
q4_1
;

150 
	mq4_2
 -ğ
rhs
.
q4_2
;

151 
	mq4_3
 -ğ
rhs
.
q4_3
;

153 
	mqNP
 -ğ
rhs
.
qNP
;

155  (*
	mthis
);

160 
ušt
 
tÙ®
() const {

162 (
	mqlšeÜd”
+
	mqcu¡om”
+
	mqsuµl›r
+
	mq·¹
+
	mqd©e
+
	mq‹¡
+

163 
	mq1_1
+
	mq1_2
+
	mq1_3
+
	mq2_1
+
	mq2_2
+
	mq2_3
+
	mq3_1
+
	mq3_2
+
	mq3_3
+
	mq3_4
+
	mq4_1
+
	mq4_2
+
	mq4_3
+
	mqNP
);

169 
	sShÜeSSBTrxSts


171 
ShÜeSSBTrxCouÁ
 
	m©‹m±ed
;

172 
ShÜeSSBTrxCouÁ
 
	mçed
;

173 
ShÜeSSBTrxCouÁ
 
	md—dlocked
;

175 
	mShÜeSSBTrxSts
& 
	mİ”©Ü
+=(
ShÜeSSBTrxSts
 cÚ¡& 
Ùh”
) {

176 
©‹m±ed
 +ğ
Ùh”
.attempted;

177 
	mçed
 +ğ
Ùh”
.
çed
;

178 
	md—dlocked
 +ğ
Ùh”
.
d—dlocked
;

179  (*
	mthis
);

182 
	mShÜeSSBTrxSts
& 
	mİ”©Ü
-=(
ShÜeSSBTrxSts
 cÚ¡& 
Ùh”
) {

183 
©‹m±ed
 -ğ
Ùh”
.attempted;

184 
	mçed
 -ğ
Ùh”
.
çed
;

185 
	md—dlocked
 -ğ
Ùh”
.
d—dlocked
;

186  (*
	mthis
);

200 şas 
	cShÜeSSBEnv
 : 
public
 
ShÜeEnv


202 
public
:

203 
¡d
::
	tm­
<
	t±h»ad_t
, 
	tShÜeSSBTrxSts
*> 
	t¡©m­_t
;

205 
şass
 
	mbË_bud”_t
;

206 
şass
 
	mbË_ü—tÜ_t
;

207 
	mcheckpoš‹r_t
;

209 
	m´iv©e
:

211 
w_rc_t
 
_po¡_š™_im¶
();

216 
w_rc_t
 
_g’_Úe_suµl›r
(cÚ¡ 
id
, 
»p_row_t
& 
¬•row
);

217 
w_rc_t
 
_g’_Úe_d©e
(cÚ¡ 
id
, 
»p_row_t
& 
¬•row
);

218 
w_rc_t
 
_g’_Úe_·¹
(cÚ¡ 
id
, 
»p_row_t
& 
¬•row
);

219 
w_rc_t
 
_g’_Úe_cu¡om”
(cÚ¡ 
id
, 
»p_row_t
& 
¬•row
);

220 
w_rc_t
 
_g’_Úe_lšeÜd”
(cÚ¡ 
id
, 
»p_row_t
& 
¬•row
);

225 
	mpublic
:

227 
ShÜeSSBEnv
();

228 
	mvœtu®
 ~
ShÜeSSBEnv
();

232 
vœtu®
 
	$£t
(
’vV¬M­
* ) { (0); };

233 
vœtu®
 
	$İ’
(è{ (0); 
	}
};

234 
vœtu®
 
	$·u£
(è{ (0); 
	}
};

235 
vœtu®
 
	$»sume
(è{ (0); 
	}
};

236 
vœtu®
 
w_rc_t
 
	$Ãwrun
(è{ (
RCOK
); 
	}
};

238 
vœtu®
 
po¡_š™
();

239 
vœtu®
 
w_rc_t
 
lßd_schema
();

241 
vœtu®
 
w_rc_t
 
lßd_ªd_»gi¡”_fids
();

243 
vœtu®
 
cÚf
();

244 
vœtu®
 
¡¬t
();

245 
vœtu®
 
¡İ
();

246 
vœtu®
 
	$šfo
() const;

247 
vœtu®
 
	`¡©i¡ics
();

249 
w_rc_t
 
	`w¬mup
();

250 
w_rc_t
 
	`check_cÚsi¡’cy
();

252 
	`dump
();

254 
vœtu®
 
	`´št_throughput
(cÚ¡ 
iQu”›dSF
,

255 cÚ¡ 
iS´—d
,

256 cÚ¡ 
iNumOfTh»ads
,

257 cÚ¡ 
d–ay
,

258 cÚ¡ 
ulÚg_t
 
mioch
,

259 cÚ¡ 
avgıuu§ge
);

264 
w_rc_t
 
	`lßdd©a
();

267 
	`DECLARE_TABLE
(
·¹_t
,
·¹_mª_im¶
,
·¹
);

268 
	`DECLARE_TABLE
(
suµl›r_t
,
suµl›r_mª_im¶
,
suµl›r
);

269 
	`DECLARE_TABLE
(
d©e_t
,
d©e_mª_im¶
,
d©e
);

270 
	`DECLARE_TABLE
(
cu¡om”_t
,
cu¡om”_mª_im¶
,
cu¡om”
);

271 
	`DECLARE_TABLE
(
lšeÜd”_t
,
lšeÜd”_mª_im¶
,
lšeÜd”
);

276 
w_rc_t
 
	`run_Úe_xù
(
Reque¡
* 
´eque¡
);

279 
	`DECLARE_TRX
(
q·¹
);

280 
	`DECLARE_TRX
(
qd©e
);

281 
	`DECLARE_TRX
(
qsuµl›r
);

282 
	`DECLARE_TRX
(
qcu¡om”
);

283 
	`DECLARE_TRX
(
qlšeÜd”
);

284 
	`DECLARE_TRX
(
q‹¡
);

285 
	`DECLARE_TRX
(
q1_1
);

286 
	`DECLARE_TRX
(
q1_2
);

287 
	`DECLARE_TRX
(
q1_3
);

288 
	`DECLARE_TRX
(
q2_1
);

289 
	`DECLARE_TRX
(
q2_2
);

290 
	`DECLARE_TRX
(
q2_3
);

291 
	`DECLARE_TRX
(
q3_1
);

292 
	`DECLARE_TRX
(
q3_2
);

293 
	`DECLARE_TRX
(
q3_3
);

294 
	`DECLARE_TRX
(
q3_4
);

295 
	`DECLARE_TRX
(
q4_1
);

296 
	`DECLARE_TRX
(
q4_2
);

297 
	`DECLARE_TRX
(
q4_3
);

300 
	`DECLARE_TRX
(
qNP
);

303 
	`DECLARE_TRX
(
pİuÏ‹_ba£lše
);

304 
	`DECLARE_TRX
(
pİuÏ‹_some_lšeÜd”s
);

309 #ifdeà
CFG_QPIPE


310 
´iv©e
:

311 
gu¬d
<
pŞicy_t
> 
_sched_pŞicy
;

313 
public
:

314 
pŞicy_t
* 
	`g‘_sched_pŞicy
();

315 
pŞicy_t
* 
	`£t_sched_pŞicy
(cÚ¡ * 
¥Şicy
);

316 
w_rc_t
 
	`run_Úe_qpe_xù
(
Reque¡
* 
´eque¡
);

319 
	`DECLARE_QPIPE_TRX
(
q·¹
);

320 
	`DECLARE_QPIPE_TRX
(
qd©e
);

321 
	`DECLARE_QPIPE_TRX
(
qsuµl›r
);

322 
	`DECLARE_QPIPE_TRX
(
qcu¡om”
);

323 
	`DECLARE_QPIPE_TRX
(
qlšeÜd”
);

324 
	`DECLARE_QPIPE_TRX
(
q‹¡
);

325 
	`DECLARE_QPIPE_TRX
(
q1_1
);

326 
	`DECLARE_QPIPE_TRX
(
q1_2
);

327 
	`DECLARE_QPIPE_TRX
(
q1_3
);

328 
	`DECLARE_QPIPE_TRX
(
q2_1
);

329 
	`DECLARE_QPIPE_TRX
(
q2_2
);

330 
	`DECLARE_QPIPE_TRX
(
q2_3
);

331 
	`DECLARE_QPIPE_TRX
(
q3_1
);

332 
	`DECLARE_QPIPE_TRX
(
q3_2
);

333 
	`DECLARE_QPIPE_TRX
(
q3_3
);

334 
	`DECLARE_QPIPE_TRX
(
q3_4
);

335 
	`DECLARE_QPIPE_TRX
(
q4_1
);

336 
	`DECLARE_QPIPE_TRX
(
q4_2
);

337 
	`DECLARE_QPIPE_TRX
(
q4_3
);

342 
vœtu®
 
	`’v_th»ad_š™
();

343 
vœtu®
 
	`’v_th»ad_fši
();

346 
¡©m­_t
 
_¡©m­
;

349 
ShÜeSSBTrxSts
 
_Ï¡_¡©s
;

350 
vœtu®
 
	`»£t_¡©s
();

351 
ShÜeSSBTrxSts
 
	`_g‘_¡©s
();

353 
	}
};

356 
EXIT_NAMESPACE
(
ssb
);

	@include/workload/ssb/shore_ssb_schema.h

32 #iâdeà
__SHORE_SSB_SCHEMA_H


33 
	#__SHORE_SSB_SCHEMA_H


	)

35 
	~<m©h.h
>

37 
	~"sm_vas.h
"

38 
	~"ut.h
"

40 
	~"wÜklßd/ssb/ssb_cÚ¡.h
"

41 
	~"sm/shÜe/shÜe_bË_mª.h
"

43 
usšg
 
Çme¥aû
 
	gshÜe
;

46 
ENTER_NAMESPACE
(
ssb
);

57 
DECLARE_TABLE_SCHEMA_PD
(
suµl›r_t
);

58 
DECLARE_TABLE_SCHEMA_PD
(
·¹_t
);

59 
DECLARE_TABLE_SCHEMA_PD
(
d©e_t
);

60 
DECLARE_TABLE_SCHEMA_PD
(
cu¡om”_t
);

61 
DECLARE_TABLE_SCHEMA_PD
(
lšeÜd”_t
);

64 
EXIT_NAMESPACE
(
ssb
);

	@include/workload/ssb/shore_ssb_schema_man.h

32 #iâdeà
__SHORE_SSB_SCHEMA_MANAGER_H


33 
	#__SHORE_SSB_SCHEMA_MANAGER_H


	)

35 
	~"wÜklßd/ssb/ssb_¡ruù.h
"

36 
	~"wÜklßd/ssb/shÜe_ssb_schema.h
"

39 
usšg
 
Çme¥aû
 
	gshÜe
;

42 
ENTER_NAMESPACE
(
ssb
);

53 
şass
 
	g·¹_mª_im¶
 : 
public
 
bË_mª_im¶
<
·¹_t
>

55 
bË_row_t
 
	t·¹_tu¶e
;

57 
	gpublic
:

59 
·¹_mª_im¶
(
·¹_t
* 
aP¬tDesc
)

60 : 
bË_mª_im¶
<
·¹_t
>(
aP¬tDesc
)

63 ~
·¹_mª_im¶
() { }

65 
w_rc_t
 
p_šdex_´obe
(
ss_m
* 
db
,

66 
·¹_tu¶e
* 
±u¶e
,

67 cÚ¡ 
p_·¹key
);

72 
şass
 
	gd©e_mª_im¶
 : 
public
 
bË_mª_im¶
<
d©e_t
>

74 
bË_row_t
 
	td©e_tu¶e
;

76 
	gpublic
:

78 
d©e_mª_im¶
(
d©e_t
* 
aP¬tDesc
)

79 : 
bË_mª_im¶
<
d©e_t
>(
aP¬tDesc
)

82 ~
d©e_mª_im¶
() { }

84 
w_rc_t
 
d_šdex_´obe
(
ss_m
* 
db
,

85 
d©e_tu¶e
* 
±u¶e
,

86 cÚ¡ 
d_d©ekey
);

92 
şass
 
	gsuµl›r_mª_im¶
 : 
public
 
bË_mª_im¶
<
suµl›r_t
>

94 
bË_row_t
 
	tsuµl›r_tu¶e
;

96 
	gpublic
:

98 
suµl›r_mª_im¶
(
suµl›r_t
* 
aSuµl›rDesc
)

99 : 
bË_mª_im¶
<
suµl›r_t
>(
aSuµl›rDesc
)

103 ~
suµl›r_mª_im¶
()

108 
w_rc_t
 
s_šdex_´obe
(
ss_m
* 
db
,

109 
suµl›r_tu¶e
* 
±u¶e
,

110 cÚ¡ 
s_suµkey
);

117 
şass
 
	gcu¡om”_mª_im¶
 : 
public
 
bË_mª_im¶
<
cu¡om”_t
>

119 
bË_row_t
 
	tcu¡om”_tu¶e
;

121 
	gpublic
:

123 
cu¡om”_mª_im¶
(
cu¡om”_t
* 
aCu¡om”Desc
)

124 : 
bË_mª_im¶
<
cu¡om”_t
>(
aCu¡om”Desc
)

127 ~
cu¡om”_mª_im¶
() { }

140 
w_rc_t
 
c_šdex_´obe
(
ss_m
* 
db
,

141 
cu¡om”_tu¶e
* 
±u¶e
,

142 cÚ¡ 
c_cu¡key
);

157 
şass
 
	glšeÜd”_mª_im¶
 : 
public
 
bË_mª_im¶
<
lšeÜd”_t
>

159 
bË_row_t
 
	tlšeÜd”_tu¶e
;

161 
	gpublic
:

163 
lšeÜd”_mª_im¶
(
lšeÜd”_t
* 
aLšeÜd”Desc
)

164 : 
bË_mª_im¶
<
lšeÜd”_t
>(
aLšeÜd”Desc
)

168 ~
lšeÜd”_mª_im¶
()

173 
w_rc_t
 
lo_šdex_´obe
(
ss_m
* 
db
,

174 
lšeÜd”_tu¶e
* 
±u¶e
,

175 cÚ¡ 
lo_Üd”key
,

176 cÚ¡ 
lo_lš’umb”
);

207 
EXIT_NAMESPACE
(
ssb
);

	@include/workload/ssb/ssb_const.h

31 #iâdeà
__SSB_CONST_H


32 
	#__SSB_CONST_H


	)

35 
	~"ut/Çme¥aû.h
"

38 
ENTER_NAMESPACE
(
ssb
);

56 cÚ¡ 
	gSSB_PART_FCOUNT
 = 9;

57 cÚ¡ 
	gSSB_SUPPLIER_FCOUNT
 = 7;

58 cÚ¡ 
	gSSB_DATE_FCOUNT
 = 17;

59 cÚ¡ 
	gSSB_CUSTOMER_FCOUNT
 = 8;

60 cÚ¡ 
	gSSB_LINEORDER_FCOUNT
 = 17;

64 cÚ¡ 
	gSHORE_SSB_TABLES
 = 5;

70 cÚ¡ 
	gXCT_SSB_MIX
 = 80;

71 cÚ¡ 
	gXCT_SSB_Q1_1
 = 81;

72 cÚ¡ 
	gXCT_SSB_Q1_2
 = 82;

73 cÚ¡ 
	gXCT_SSB_Q1_3
 = 83;

74 cÚ¡ 
	gXCT_SSB_Q2_1
 = 84;

75 cÚ¡ 
	gXCT_SSB_Q2_2
 = 85;

76 cÚ¡ 
	gXCT_SSB_Q2_3
 = 86;

77 cÚ¡ 
	gXCT_SSB_Q3_1
 = 87;

78 cÚ¡ 
	gXCT_SSB_Q3_2
 = 88;

79 cÚ¡ 
	gXCT_SSB_Q3_3
 = 89;

80 cÚ¡ 
	gXCT_SSB_Q3_4
 = 90;

81 cÚ¡ 
	gXCT_SSB_Q4_1
 = 91;

82 cÚ¡ 
	gXCT_SSB_Q4_2
 = 92;

83 cÚ¡ 
	gXCT_SSB_Q4_3
 = 93;

84 cÚ¡ 
	gXCT_SSB_QPART
 = 94;

85 cÚ¡ 
	gXCT_SSB_QDATE
 = 95;

86 cÚ¡ 
	gXCT_SSB_QSUPPLIER
 = 96;

87 cÚ¡ 
	gXCT_SSB_QCUSTOMER
 = 97;

88 cÚ¡ 
	gXCT_SSB_QLINEORDER
 = 98;

89 cÚ¡ 
	gXCT_SSB_QTEST
 = 99;

92 cÚ¡ 
	gXCT_QPIPE_SSB_MIX
 = 1080;

95 
EXIT_NAMESPACE
(
ssb
);

	@include/workload/ssb/ssb_input.h

32 #iâdeà
__SSB_INPUT_H


33 
	#__SSB_INPUT_H


	)

35 
	~"wÜklßd/ssb/ssb_cÚ¡.h
"

36 
	~"wÜklßd/ssb/ssb_¡ruù.h
"

39 
ENTER_NAMESPACE
(
ssb
);

43 
	sqcu¡om”_šput_t
 { };

44 
	sqsuµl›r_šput_t
 { };

45 
	sq·¹_šput_t
 { };

46 
	sqd©e_šput_t
 { };

47 
	sqlšeÜd”_šput_t
 { };

48 
	sq‹¡_šput_t
 { };

63 
qcu¡om”_šput_t
 
ü—‹_qcu¡om”_šput
 (cÚ¡ 
sf
, cÚ¡ 
¥ecificWH
);

64 
qsuµl›r_šput_t
 
ü—‹_qsuµl›r_šput
 (cÚ¡ 
sf
, cÚ¡ 
¥ecificWH
);

65 
qd©e_šput_t
 
ü—‹_qd©e_šput
 (cÚ¡ 
sf
, cÚ¡ 
¥ecificWH
);

66 
q·¹_šput_t
 
ü—‹_q·¹_šput
 (cÚ¡ 
sf
, cÚ¡ 
¥ecificWH
);

67 
qlšeÜd”_šput_t
 
ü—‹_qlšeÜd”_šput
(cÚ¡ 
sf
, cÚ¡ 
¥ecificWH
);

68 
q‹¡_šput_t
 
ü—‹_q‹¡_šput
(cÚ¡ 
sf
, cÚ¡ 
¥ecificWH
);

111 
	sq1_1_šput_t


113 
	md_y—r
;

114 
	mlo_discouÁ_lo
;

115 
	mlo_discouÁ_hi
;

116 
	mlo_quªt™y
;

118 
	mq1_1_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q1_1_šput_t
& 
rhs
);

121 
q1_1_šput_t
 
ü—‹_q1_1_šput
(cÚ¡ 
sf
,

122 cÚ¡ 
¥ecificWH
 = 0);

130 
	sq1_2_šput_t


132 
	md_y—rmÚthnum
;

133 
	mlo_discouÁ_lo
;

134 
	mlo_discouÁ_hi
;

135 
	mlo_quªt™y_lo
;

136 
	mlo_quªt™y_hi
;

138 
	mq1_2_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q1_2_šput_t
& 
rhs
);

141 
q1_2_šput_t
 
ü—‹_q1_2_šput
(cÚ¡ 
sf
,

142 cÚ¡ 
¥ecificWH
 = 0);

150 
	sq1_3_šput_t


152 
	md_w“knumšy—r
;

153 
	md_y—r
;

154 
	mlo_discouÁ_lo
;

155 
	mlo_discouÁ_hi
;

156 
	mlo_quªt™y_lo
;

157 
	mlo_quªt™y_hi
;

159 
	mq1_3_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q1_3_šput_t
& 
rhs
);

162 
q1_3_šput_t
 
ü—‹_q1_3_šput
(cÚ¡ 
sf
,

163 cÚ¡ 
¥ecificWH
 = 0);

171 
	sq2_1_šput_t


173 
	mp_ÿ‹gÜy
[8];

174 
	ms_»giÚ
[13];

176 
	mq2_1_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q2_1_šput_t
& 
rhs
);

179 
q2_1_šput_t
 
ü—‹_q2_1_šput
(cÚ¡ 
sf
,

180 cÚ¡ 
¥ecificWH
 = 0);

188 
	sq2_2_šput_t


190 
	mp_b¿nd_1
[10];

191 
	mp_b¿nd_2
[10];

192 
	ms_»giÚ
[13];

194 
	mq2_2_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q2_2_šput_t
& 
rhs
);

197 
q2_2_šput_t
 
ü—‹_q2_2_šput
(cÚ¡ 
sf
,

198 cÚ¡ 
¥ecificWH
 = 0);

206 
	sq2_3_šput_t


208 
	mp_b¿nd
[10];

209 
	ms_»giÚ
[13];

211 
	mq2_3_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q2_3_šput_t
& 
rhs
);

214 
q2_3_šput_t
 
ü—‹_q2_3_šput
(cÚ¡ 
sf
,

215 cÚ¡ 
¥ecificWH
 = 0);

223 
	sq3_1_šput_t


225 
	m_y—r_lo
;

226 
	m_y—r_hi
;

227 
	mc_»giÚ
[13];

228 
	ms_»giÚ
[13];

230 
	mq3_1_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q3_1_šput_t
& 
rhs
);

233 
q3_1_šput_t
 
ü—‹_q3_1_šput
(cÚ¡ 
sf
,

234 cÚ¡ 
¥ecificWH
 = 0);

242 
	sq3_2_šput_t


244 
	m_y—r_lo
;

245 
	m_y—r_hi
;

246 
	m_ÇtiÚ
[16];

248 
	mq3_2_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q3_2_šput_t
& 
rhs
);

251 
q3_2_šput_t
 
ü—‹_q3_2_šput
(cÚ¡ 
sf
,

252 cÚ¡ 
¥ecificWH
 = 0);

261 
	sq3_3_šput_t


263 
	m_y—r_lo
;

264 
	m_y—r_hi
;

265 
	mc_c™y_1
[11];

266 
	mc_c™y_2
[11];

267 
	ms_c™y_1
[11];

268 
	ms_c™y_2
[11];

271 
	mq3_3_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q3_3_šput_t
& 
rhs
);

274 
q3_3_šput_t
 
ü—‹_q3_3_šput
(cÚ¡ 
sf
,

275 cÚ¡ 
¥ecificWH
 = 0);

283 
	sq3_4_šput_t


285 
	mc_c™y_1
[11];

286 
	mc_c™y_2
[11];

287 
	ms_c™y_1
[11];

288 
	ms_c™y_2
[11];

289 
	md_y—rmÚth
[8];

292 
	mq3_4_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q3_4_šput_t
& 
rhs
);

295 
q3_4_šput_t
 
ü—‹_q3_4_šput
(cÚ¡ 
sf
,

296 cÚ¡ 
¥ecificWH
 = 0);

304 
	sq4_1_šput_t


306 
	mc_»giÚ
[13];

307 
	ms_»giÚ
[13];

308 
	mp_mfgr_1
[7];

309 
	mp_mfgr_2
[7];

312 
	mq4_1_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q4_1_šput_t
& 
rhs
);

315 
q4_1_šput_t
 
ü—‹_q4_1_šput
(cÚ¡ 
sf
,

316 cÚ¡ 
¥ecificWH
 = 0);

324 
	sq4_2_šput_t


326 
	md_y—r_1
;

327 
	md_y—r_2
;

328 
	mc_»giÚ
[13];

329 
	ms_»giÚ
[13];

330 
	mp_mfgr_1
[7];

331 
	mp_mfgr_2
[7];

334 
	mq4_2_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q4_2_šput_t
& 
rhs
);

337 
q4_2_šput_t
 
ü—‹_q4_2_šput
(cÚ¡ 
sf
,

338 cÚ¡ 
¥ecificWH
 = 0);

346 
	sq4_3_šput_t


348 
	md_y—r_1
;

349 
	md_y—r_2
;

350 
	ms_ÇtiÚ
[16];

351 
	mp_ÿ‹gÜy
[8];

354 
	mq4_3_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q4_3_šput_t
& 
rhs
);

357 
q4_3_šput_t
 
ü—‹_q4_3_šput
(cÚ¡ 
sf
,

358 cÚ¡ 
¥ecificWH
 = 0);

367 
	sqNP_šput_t


369 
	m_cu¡id
;

371 
	mqNP_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
qNP_šput_t
& 
rhs
);

374 
qNP_šput_t
 
ü—‹_qNP_šput
(cÚ¡ 
sf
,

375 cÚ¡ 
¥ecificWH
 = 0);

386 
	spİuÏ‹_ba£lše_šput_t


388 
	m_sf
;

389 
	m_lßd”_couÁ
;

390 
	m_divisÜ
;

391 
	m_lšeÜd”_³r_th»ad
;

396 
	spİuÏ‹_some_lšeÜd”s_šput_t


398 
	m_Üd”id
;

401 
EXIT_NAMESPACE
(
ssb
);

	@include/workload/ssb/ssb_random.h

34 #iâdeà
__SSB_COMMON_H


35 
	#__SSB_COMMON_H


	)

37 
	~"ut.h
"

40 
ENTER_NAMESPACE
(
ssb
);

54 
NURªd
(
A
, 
low
, 
high
);

56 
EXIT_NAMESPACE
(
ssb
);

	@include/workload/ssb/ssb_struct.h

34 #iâdeà
__SSB_STRUCT_H


35 
	#__SSB_STRUCT_H


	)

37 
	~<c¡dlib
>

38 
	~<uni¡d.h
>

39 
	~<sys/time.h
>

40 
	~"ut.h
"

43 
ENTER_NAMESPACE
(
ssb
);

47 
	#STRSIZE
(
x
è(x+1)

	)

52 
	essb_l_shmode
 {

53 
	mREG_AIR
,

54 
	mAIR
,

55 
	mRAIL
,

56 
	mTRUCK
,

57 
	mMAIL
,

58 
	mFOB
,

59 
	mSHIP
,

60 
	mEND_SHIPMODE


63 
	essb_ÇtiÚ
{

64 
	mALGERIA
,

65 
	mARGENTINA
,

66 
	mBRAZIL
,

67 
	mCANADA
,

68 
	mCHINA
,

69 
	mEGYPT
,

70 
	mETHIOPIA
,

71 
	mFRANCE
,

72 
	mGERMANY
,

73 
	mINDIA
,

74 
	mINDONESIA
,

75 
	mIRAN
,

76 
	mIRAQ
,

77 
	mJAPAN
,

78 
	mJORDAN
,

79 
	mKENYA
,

80 
	mMOROCCO
,

81 
	mMOZAMBIQUE
,

82 
	mPERU
,

83 
	mROMANIA
,

84 
	mRUSSIA
,

85 
	mSAUDI_ARABIA
,

86 
	mUNITED_KINGDOM
,

87 
	mUNITED_STATES
,

88 
	mVIETNAM


94 cÚ¡ 
	gSUPPLIER_PER_SF
 = 2000;

95 cÚ¡ 
	gCUSTOMER_PER_SF
 = 30000;

96 cÚ¡ 
	gPART_PER_SF
 = 200000;

97 cÚ¡ 
	gLINEORDER_PER_SF
 = 1500000;

98 cÚ¡ 
	gNO_DATE
 = 2556;

107 
	sssb_·¹_tu¶e


109 
	mP_PARTKEY
;

110 
	mP_NAME
 [
STRSIZE
(22)];

111 
	mP_MFGR
 [
STRSIZE
(6)];

112 
	mP_CATEGORY
 [
STRSIZE
(7)];

113 
	mP_BRAND
 [
STRSIZE
(9)];

114 
	mP_COLOR
 [
STRSIZE
(11)];

115 
	mP_TYPE
 [
STRSIZE
(25)];

116 
	mP_SIZE
;

117 
	mP_CONTAINER
 [
STRSIZE
(10)];

122 
	sssb_·¹_tu¶e_key
 {

123 
	mP_PARTKEY
;

125 
boŞ
 
	mİ”©Ü
==(cÚ¡ 
ssb_·¹_tu¶e_key
& 
rhs
) const {

126  
P_PARTKEY
 =ğ
rhs
.P_PARTKEY;

129 
boŞ
 
	mİ”©Ü
<(cÚ¡ 
	mssb_·¹_tu¶e_key
& 
	mrhs
) const {

130  
	mP_PARTKEY
 < 
	mrhs
.P_PARTKEY;

134 
	sssb_·¹_tu¶e_body


136 
	mS_SUPPKEY
;

137 
	mS_NAME
 [
STRSIZE
(25)];

138 
	mS_ADDRESS
 [
STRSIZE
(40)];

139 
	mS_PHONE
 [
STRSIZE
(15)];

140 
decim®
 
	mS_ACCTBAL
;

141 
	mS_COMMENT
 [
STRSIZE
(101)];

149 
	sssb_suµl›r_tu¶e


151 
	mS_SUPPKEY
;

152 
	mS_NAME
 [
STRSIZE
(25)];

153 
	mS_ADDRESS
 [
STRSIZE
(25)];

154 
	mS_CITY
 [
STRSIZE
(10)];

155 
	mS_NATION
 [
STRSIZE
(15)];

156 
	mS_REGION
 [
STRSIZE
(12)];

157 
	mS_PHONE
 [
STRSIZE
(15)];

160 
	sssb_suµl›r_tu¶e_key


162 
	mS_SUPPKEY
;

164 
boŞ
 
	mİ”©Ü
==(cÚ¡ 
ssb_suµl›r_tu¶e_key
& 
rhs
) const {

165  
S_SUPPKEY
 =ğ
rhs
.S_SUPPKEY;

168 
boŞ
 
	mİ”©Ü
<(cÚ¡ 
	mssb_suµl›r_tu¶e_key
& 
	mrhs
) const {

169  
	mS_SUPPKEY
 < 
	mrhs
.S_SUPPKEY;

174 
	sssb_suµl›r_tu¶e_body


176 
	mS_SUPPKEY
;

177 
	mS_NAME
 [
STRSIZE
(25)];

178 
	mS_ADDRESS
 [
STRSIZE
(25)];

179 
	mS_CITY
 [
STRSIZE
(10)];

180 
	mS_NATION
 [
STRSIZE
(15)];

181 
	mS_REGION
 [
STRSIZE
(12)];

182 
	mS_PHONE
 [
STRSIZE
(15)];

188 
	sssb_d©e_tu¶e


190 
	mD_DATEKEY
;

191 
	mD_DATE
 [
STRSIZE
(18)];

192 
	mD_DAYOFWEEK
 [
STRSIZE
(9)];

193 
	mD_MONTH
 [
STRSIZE
(9)];

194 
	mD_YEAR
;

195 
	mD_YEARMONTHNUM
;

196 
	mD_YEARMONTH
 [
STRSIZE
(7)];

197 
	mD_DAYNUMINWEEK
;

198 
	mD_DAYNUMINMONTH
;

199 
	mD_DAYNUMINYEAR
;

200 
	mD_MONTHNUMINYEAR
;

201 
	mD_WEEKNUMINYEAR
;

202 
	mD_SELLINGSEASON
 [
STRSIZE
(12)];

203 
	mD_LASTDAYINWEEKFL
[2];

204 
	mD_LASTDAYINMONTHFL
[2];

205 
	mD_HOLIDAYFL
[2];

206 
	mD_WEEKDAYFL
[2];

210 
	sssb_d©e_tu¶e_key


212 
	mD_DATEKEY
;

214 
boŞ
 
	mİ”©Ü
==(cÚ¡ 
ssb_d©e_tu¶e_key
& 
rhs
) const {

215  (
D_DATEKEY
 =ğ
rhs
.D_DATEKEY);

219 
boŞ
 
	mİ”©Ü
<(cÚ¡ 
	mssb_d©e_tu¶e_key
& 
	mrhs
) const {

220  (
	mD_DATEKEY
 < 
	mrhs
.D_DATEKEY);

233 
	sssb_cu¡om”_tu¶e


235 
	mC_CUSTKEY
;

236 
	mC_NAME
 [
STRSIZE
(25)];

237 
	mC_ADDRESS
 [
STRSIZE
(25)];

238 
	mC_CITY
 [
STRSIZE
(10)];

239 
	mC_NATION
 [
STRSIZE
(15)];

240 
	mC_REGION
 [
STRSIZE
(12)];

241 
	mC_PHONE
 [
STRSIZE
(15)];

242 
	mC_MKTSEGMENT
 [
STRSIZE
(10)];

245 
c_¡r
 
tu¶e_to_¡r
() {

246  (
c_¡r
("CUST = %d|%s|%s|%s|%s|%s|%s -",

247 
C_CUSTKEY
, 
C_NAME
, 
C_ADDRESS
,

248 
C_NATION
, 
C_REGION
, 
C_PHONE
, 
C_MKTSEGMENT
));

255 
	sssb_cu¡om”_tu¶e_key
 {

256 
	mC_CUSTKEY
;

258 
boŞ
 
	mİ”©Ü
==(cÚ¡ 
ssb_cu¡om”_tu¶e_key
& 
rhs
) const {

259  ((
C_CUSTKEY
 =ğ
rhs
.C_CUSTKEY));

262 
boŞ
 
	mİ”©Ü
<(cÚ¡ 
	mssb_cu¡om”_tu¶e_key
& 
	mrhs
) const {

263 ià((
	mC_CUSTKEY
 < 
	mrhs
.C_CUSTKEY))

264  (
	mŒue
);

266  (
	mçl£
);

271 
	sssb_cu¡om”_tu¶e_body


273 
	mC_NAME
 [
STRSIZE
(25)];

274 
	mC_ADDRESS
 [
STRSIZE
(40)];

275 
	mC_PHONE
 [
STRSIZE
(15)];

276 
decim®
 
	mC_ACCTBAL
;

277 
	mC_MKTSEGMENT
 [
STRSIZE
(10)];

278 
	mC_COMMENT
 [
STRSIZE
(117)];

287 
	sssb_lšeÜd”_tu¶e


289 
	mLO_ORDERKEY
;

290 
	mLO_LINENUMBER
;

291 
	mLO_CUSTKEY
;

292 
	mLO_PARTKEY
;

293 
	mLO_SUPPKEY
;

294 
	mLO_ORDERDATE
;

295 
	mLO_ORDERPRIORITY
 [
STRSIZE
(15)];

296 
	mLO_SHIPPRIORITY
;

297 
	mLO_QUANTITY
;

298 
	mLO_EXTENDEDPRICE
;

299 
	mLO_ORDTOTALPRICE
;

300 
	mLO_DISCOUNT
;

301 
	mLO_REVENUE
;

302 
	mLO_SUPPLYCOST
;

303 
	mLO_TAX
;

304 
	mLO_COMMIDATE
;

305 
	mLO_SHIPMODE
 [
STRSIZE
(10)];

307 
c_¡r
 
tu¶e_to_¡r
() {

308 (
c_¡r
("LO = %d|%d|%d|%d|%d|%d|%s -",

309 
LO_ORDERKEY
, 
LO_LINENUMBER
, 
LO_CUSTKEY
, 
LO_PARTKEY
,

310 
LO_SUPPKEY
, 
LO_ORDERDATE
, 
LO_ORDERPRIORITY
));

313 
c_¡r
 
key_to_¡r
() {

314 (
c_¡r
("LO = %d|%d -",

315 
LO_ORDERKEY
, 
LO_LINENUMBER
));

321 
	sssb_lše™em_tu¶e_key


323 
	mLO_ORDERKEY
;

324 
	mLO_LINENUMBER
;

326 
boŞ
 
	mİ”©Ü
==(cÚ¡ 
ssb_lše™em_tu¶e_key
& 
rhs
) const {

327  (
LO_ORDERKEY
 =ğ
rhs
.LO_ORDERKEY) &&

328 (
LO_LINENUMBER
 =ğ
rhs
.LO_LINENUMBER);

331 
boŞ
 
	mİ”©Ü
<(cÚ¡ 
	mssb_lše™em_tu¶e_key
& 
	mrhs
) const {

332  (
	mLO_ORDERKEY
 < 
	mrhs
.LO_ORDERKEY) ||

333 ((
	mLO_ORDERKEY
 =ğ
rhs
.
LO_ORDERKEY
) &&

334 (
LO_LINENUMBER
 =ğ
rhs
.LO_LINENUMBER));

339 
	sssb_lše™em_tu¶e_body


341 
	mLO_ORDERKEY
;

342 
	mLO_LINENUMBER
;

343 
	mLO_CUSTKEY
;

344 
	mLO_PARTKEY
;

345 
	mLO_SUPPKEY
;

346 
	mLO_ORDERDATE
;

347 
	mLO_ORDERPRIORITY
 [
STRSIZE
(15)];

348 
	mLO_SHIPPRIORITY
;

349 
	mLO_QUANTITY
;

350 
	mLO_EXTENDEDPRICE
;

351 
	mLO_ORDTOTALPRICE
;

352 
	mLO_DISCOUNT
;

353 
	mLO_REVENUE
;

354 
	mLO_SUPPLYCOST
;

355 
	mLO_TAX
;

356 
	mLO_COMMIDATE
;

357 
	mLO_SHIPMODE
 [
STRSIZE
(10)];

360 
EXIT_NAMESPACE
(
ssb
);

	@include/workload/ssb/ssb_util.h

1 #iâdeà
__SSB_UTIL_H


2 
	#__SSB_UTIL_H


	)

4 
	~"wÜklßd/ssb/ssb_¡ruù.h
"

6 
ENTER_NAMESPACE
(
ssb
);

8 
ssb_l_shmode
 
¡r_to_shmode
(* 
shmode
);

9 
shmode_to_¡r
(* 
¡r
, 
ssb_l_shmode
 
shmode
);

10 
g‘_ÇtiÚ
(* 
ÇtiÚ_Çme
, 
ssb_ÇtiÚ
 
ÇtiÚ_id
);

12 
EXIT_NAMESPACE
(
ssb
);

	@include/workload/tm1/shore_tm1_client.h

31 #iâdeà
__SHORE_TM1_CLIENT_H


32 
	#__SHORE_TM1_CLIENT_H


	)

35 
	~"sm/shÜe/shÜe_ş›Á.h
"

37 
	~"wÜklßd/tm1/shÜe_tm1_’v.h
"

39 
usšg
 
Çme¥aû
 
	gshÜe
;

42 
ENTER_NAMESPACE
(
tm1
);

54 şas 
	cba£lše_tm1_ş›Á_t
 : 
public
 
ba£_ş›Á_t


56 
´iv©e
:

57 
_£lid
;

58 
Œx_wÜk”_t
* 
	m_wÜk”
;

59 
	m_qf
;

61 
	mpublic
:

63 
	$ba£lše_tm1_ş›Á_t
() { }

65 
	`ba£lše_tm1_ş›Á_t
(
c_¡r
 
Šame
, cÚ¡ 
id
, 
ShÜeTM1Env
* 
’v
,

66 cÚ¡ 
M—su»m’tTy³
 
aTy³
, cÚ¡ 
Œxid
,

67 cÚ¡ 
numOfTrxs
,

68 
´oûssÜid_t
 
­rsid
, cÚ¡ 
£lID
, cÚ¡ 
qf
);

70 ~
	$ba£lše_tm1_ş›Á_t
(è{ 
	}
}

73 
lßd_sup_xù
(
m­SupTrxs
& 
m­
);

77 
w_rc_t
 
subm™_Úe
(
xù_ty³
, 
xùid
);

83 
EXIT_NAMESPACE
(
tm1
);

	@include/workload/tm1/shore_tm1_env.h

31 #iâdeà
__SHORE_TM1_ENV_H


32 
	#__SHORE_TM1_ENV_H


	)

35 
	~"sm_vas.h
"

36 
	~"ut.h
"

38 
	~"wÜklßd/tm1/tm1_cÚ¡.h
"

39 
	~"wÜklßd/tm1/tm1_šput.h
"

41 
	~"sm/shÜe/shÜe_’v.h
"

42 
	~"sm/shÜe/shÜe_Œx_wÜk”.h
"

44 
	~"wÜklßd/tm1/shÜe_tm1_schema_mª.h
"

46 
	~<m­
>

48 
usšg
 
	g¡d
::
m­
;

49 
usšg
 
Çme¥aû
 
	gshÜe
;

52 
ENTER_NAMESPACE
(
tm1
);

64 
	sShÜeTM1TrxCouÁ


66 
ušt
 
	mg‘_sub_d©a
;

67 
ušt
 
	mg‘_Ãw_de¡
;

68 
ušt
 
	mg‘_acc_d©a
;

69 
ušt
 
	mupd_sub_d©a
;

70 
ušt
 
	mupd_loc
;

71 
ušt
 
	mšs_ÿÎ_fwd
;

72 
ušt
 
	md–_ÿÎ_fwd
;

74 
ušt
 
	mg‘_sub_nbr
;

76 
ušt
 
	mšs_ÿÎ_fwd_b’ch
;

77 
ušt
 
	md–_ÿÎ_fwd_b’ch
;

79 
	mShÜeTM1TrxCouÁ
& 
	mİ”©Ü
+=(
ShÜeTM1TrxCouÁ
 cÚ¡& 
rhs
) {

80 
g‘_sub_d©a
 +ğ
rhs
.get_sub_data;

81 
	mg‘_Ãw_de¡
 +ğ
rhs
.
g‘_Ãw_de¡
;

82 
	mg‘_acc_d©a
 +ğ
rhs
.
g‘_acc_d©a
;

83 
	mupd_sub_d©a
 +ğ
rhs
.
upd_sub_d©a
;

84 
	mupd_loc
 +ğ
rhs
.
upd_loc
;

85 
	mšs_ÿÎ_fwd
 +ğ
rhs
.
šs_ÿÎ_fwd
;

86 
	md–_ÿÎ_fwd
 +ğ
rhs
.
d–_ÿÎ_fwd
;

88 
	mg‘_sub_nbr
 +ğ
rhs
.
g‘_sub_nbr
;

90 
	mšs_ÿÎ_fwd_b’ch
 +ğ
rhs
.
šs_ÿÎ_fwd_b’ch
;

91 
	md–_ÿÎ_fwd_b’ch
 +ğ
rhs
.
d–_ÿÎ_fwd_b’ch
;

93  (*
	mthis
);

96 
	mShÜeTM1TrxCouÁ
& 
	mİ”©Ü
-=(
ShÜeTM1TrxCouÁ
 cÚ¡& 
rhs
) {

97 
g‘_sub_d©a
 -ğ
rhs
.get_sub_data;

98 
	mg‘_Ãw_de¡
 -ğ
rhs
.
g‘_Ãw_de¡
;

99 
	mg‘_acc_d©a
 -ğ
rhs
.
g‘_acc_d©a
;

100 
	mupd_sub_d©a
 -ğ
rhs
.
upd_sub_d©a
;

101 
	mupd_loc
 -ğ
rhs
.
upd_loc
;

102 
	mšs_ÿÎ_fwd
 -ğ
rhs
.
šs_ÿÎ_fwd
;

103 
	md–_ÿÎ_fwd
 -ğ
rhs
.
d–_ÿÎ_fwd
;

105 
	mg‘_sub_nbr
 -ğ
rhs
.
g‘_sub_nbr
;

107 
	mšs_ÿÎ_fwd_b’ch
 -ğ
rhs
.
šs_ÿÎ_fwd_b’ch
;

108 
	md–_ÿÎ_fwd_b’ch
 -ğ
rhs
.
d–_ÿÎ_fwd_b’ch
;

110  (*
	mthis
);

113 
ušt
 
tÙ®
() const {

114  (
	mg‘_sub_d©a
+
	mg‘_Ãw_de¡
+
	mg‘_acc_d©a
+

115 
	mupd_sub_d©a
+
	mupd_loc
+
	mšs_ÿÎ_fwd
+
	md–_ÿÎ_fwd
+

116 
	mg‘_sub_nbr
+
	mšs_ÿÎ_fwd_b’ch
+
	md–_ÿÎ_fwd_b’ch
);

122 
	sShÜeTM1TrxSts


124 
ShÜeTM1TrxCouÁ
 
	m©‹m±ed
;

125 
ShÜeTM1TrxCouÁ
 
	mçed
;

126 
ShÜeTM1TrxCouÁ
 
	md—dlocked
;

128 
	mShÜeTM1TrxSts
& 
	mİ”©Ü
+=(
ShÜeTM1TrxSts
 cÚ¡& 
Ùh”
) {

129 
©‹m±ed
 +ğ
Ùh”
.attempted;

130 
	mçed
 +ğ
Ùh”
.
çed
;

131 
	md—dlocked
 +ğ
Ùh”
.
d—dlocked
;

132  (*
	mthis
);

135 
	mShÜeTM1TrxSts
& 
	mİ”©Ü
-=(
ShÜeTM1TrxSts
 cÚ¡& 
Ùh”
) {

136 
©‹m±ed
 -ğ
Ùh”
.attempted;

137 
	mçed
 -ğ
Ùh”
.
çed
;

138 
	md—dlocked
 -ğ
Ùh”
.
d—dlocked
;

139  (*
	mthis
);

155 şas 
	cShÜeTM1Env
 : 
public
 
ShÜeEnv


157 
public
:

159 
¡d
::
	tm­
<
	t±h»ad_t
, 
	tShÜeTM1TrxSts
*> 
	t¡©m­_t
;

161 
şass
 
	mbË_bud”_t
;

162 
şass
 
	mbË_ü—tÜ_t
;

164 
	m´iv©e
:

165 
w_rc_t
 
_po¡_š™_im¶
();

167 
	mpublic
:

169 
ShÜeTM1Env
();

170 
	mvœtu®
 ~
ShÜeTM1Env
();

174 
vœtu®
 
	$£t
(
’vV¬M­
* ) { (0); };

175 
vœtu®
 
	$İ’
(è{ (0); 
	}
};

176 
vœtu®
 
	$·u£
(è{ (0); 
	}
};

177 
vœtu®
 
	$»sume
(è{ (0); 
	}
};

178 
vœtu®
 
w_rc_t
 
	$Ãwrun
(è{ (
RCOK
); 
	}
};

180 
vœtu®
 
po¡_š™
();

181 
vœtu®
 
w_rc_t
 
lßd_schema
();

183 
vœtu®
 
w_rc_t
 
lßd_ªd_»gi¡”_fids
();

185 
vœtu®
 
cÚf
();

186 
vœtu®
 
¡¬t
();

187 
vœtu®
 
¡İ
();

188 
vœtu®
 
	$šfo
() const;

189 
vœtu®
 
	`¡©i¡ics
();

191 
vœtu®
 
w_rc_t
 
	$w¬mup
(è{ (
RCOK
); 
	}
};

192 
vœtu®
 
w_rc_t
 
	$check_cÚsi¡’cy
(è{ (
RCOK
); 
	}
};

194 
vœtu®
 
´št_throughput
(cÚ¡ 
iQu”›dSF
,

195 cÚ¡ 
iS´—d
,

196 cÚ¡ 
iNumOfTh»ads
,

197 cÚ¡ 
d–ay
,

198 cÚ¡ 
ulÚg_t
 
mioch
,

199 cÚ¡ 
avgıuu§ge
);

204 
vœtu®
 
w_rc_t
 
lßdd©a
();

205 
w_rc_t
 
xù_pİuÏ‹_Úe
(cÚ¡ 
sub_id
);

208 
DECLARE_TABLE
(
subsüib”_t
,
sub_mª_im¶
,
sub
);

209 
DECLARE_TABLE
(
acûss_šfo_t
,
ai_mª_im¶
,
ai
);

210 
DECLARE_TABLE
(
¥ecŸl_çc™y_t
,
sf_mª_im¶
,
sf
);

211 
DECLARE_TABLE
(
ÿÎ_fÜw¬dšg_t
,
cf_mª_im¶
,
cf
);

216 
w_rc_t
 
run_Úe_xù
(
Reque¡
* 
´eque¡
);

218 
DECLARE_TRX
(
g‘_sub_d©a
);

219 
DECLARE_TRX
(
g‘_Ãw_de¡
);

220 
DECLARE_TRX
(
g‘_acc_d©a
);

221 
DECLARE_TRX
(
upd_sub_d©a
);

222 
DECLARE_TRX
(
upd_loc
);

223 
DECLARE_TRX
(
šs_ÿÎ_fwd
);

224 
DECLARE_TRX
(
d–_ÿÎ_fwd
);

226 
DECLARE_TRX
(
g‘_sub_nbr
);

228 
DECLARE_TRX
(
šs_ÿÎ_fwd_b’ch
);

229 
DECLARE_TRX
(
d–_ÿÎ_fwd_b’ch
);

232 
vœtu®
 
w_rc_t
 
upd©e_·¹™iÚšg
();

235 
vœtu®
 
’v_th»ad_š™
();

236 
vœtu®
 
’v_th»ad_fši
();

239 
¡©m­_t
 
	g_¡©m­
;

242 
ShÜeTM1TrxSts
 
	g_Ï¡_¡©s
;

243 
vœtu®
 
»£t_¡©s
();

244 
ShÜeTM1TrxSts
 
_g‘_¡©s
();

247 
£t_skew
(
¬—
, 
lßd
, 
¡¬t_imb®ªû
);

248 
¡¬t_lßd_imb®ªû
();

249 
»£t_skew
();

252 
w_rc_t
 
db_´št
(
lšes
);

255 
w_rc_t
 
db_ãtch
();

261 
EXIT_NAMESPACE
(
tm1
);

	@include/workload/tm1/shore_tm1_schema.h

31 #iâdeà
__SHORE_TM1_SCHEMA_H


32 
	#__SHORE_TM1_SCHEMA_H


	)

35 
	~<m©h.h
>

37 
	~"sm_vas.h
"

38 
	~"ut.h
"

40 
	~"wÜklßd/tm1/tm1_cÚ¡.h
"

42 
	~"sm/shÜe/shÜe_bË_mª.h
"

44 
usšg
 
Çme¥aû
 
	gshÜe
;

47 
ENTER_NAMESPACE
(
tm1
);

58 
DECLARE_TABLE_SCHEMA_PD
(
subsüib”_t
);

59 
DECLARE_TABLE_SCHEMA_PD
(
acûss_šfo_t
);

60 
DECLARE_TABLE_SCHEMA_PD
(
¥ecŸl_çc™y_t
);

61 
DECLARE_TABLE_SCHEMA_PD
(
ÿÎ_fÜw¬dšg_t
);

64 
EXIT_NAMESPACE
(
tm1
);

	@include/workload/tm1/shore_tm1_schema_man.h

32 #iâdeà
__SHORE_TM1_SCHEMA_MANAGER_H


33 
	#__SHORE_TM1_SCHEMA_MANAGER_H


	)

36 
	~"wÜklßd/tm1/shÜe_tm1_schema.h
"

38 
usšg
 
Çme¥aû
 
	gshÜe
;

41 
ENTER_NAMESPACE
(
tm1
);

50 
şass
 
	gsub_mª_im¶
 : 
public
 
bË_mª_im¶
<
subsüib”_t
>

52 
bË_row_t
 
	tsub_tu¶e
;

53 
	gšdex_sÿn_™”_im¶
<
	tsubsüib”_t
> 
	tsub_idx_™”
;

55 
	gpublic
:

57 
sub_mª_im¶
(
subsüib”_t
* 
aSubsüib”Desc
)

58 : 
bË_mª_im¶
<
subsüib”_t
>(
aSubsüib”Desc
)

60 ~
sub_mª_im¶
() { }

63 
w_rc_t
 
sub_idx_´obe
(
ss_m
* 
db
,

64 
sub_tu¶e
* 
±u¶e
,

65 cÚ¡ 
s_id
);

67 
w_rc_t
 
sub_idx_upd
(
ss_m
* 
db
,

68 
sub_tu¶e
* 
±u¶e
,

69 cÚ¡ 
s_id
);

71 
w_rc_t
 
sub_idx_Æ
(
ss_m
* 
db
,

72 
sub_tu¶e
* 
±u¶e
,

73 cÚ¡ 
s_id
);

76 
w_rc_t
 
sub_nbr_idx_´obe
(
ss_m
* 
db
,

77 
sub_tu¶e
* 
±u¶e
,

78 cÚ¡ * 
s_nbr
);

80 
w_rc_t
 
sub_nbr_idx_upd
(
ss_m
* 
db
,

81 
sub_tu¶e
* 
±u¶e
,

82 cÚ¡ * 
s_nbr
);

84 
w_rc_t
 
sub_nbr_idx_Æ
(
ss_m
* 
db
,

85 
sub_tu¶e
* 
±u¶e
,

86 cÚ¡ * 
s_nbr
);

91 
w_rc_t
 
sub_g‘_idx_™”
(
ss_m
* 
db
,

92 
sub_idx_™”
* &
™”
,

93 
sub_tu¶e
* 
±u¶e
,

94 
»p_row_t
 &
»¶ow
,

95 
»p_row_t
 &
»phigh
,

96 cÚ¡ 
sub_id
,

97 cÚ¡ 
ušt
 
¿nge
,

98 
lock_mode_t
 
®m
 = 
SH
,

99 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

106 
şass
 
	gai_mª_im¶
 : 
public
 
bË_mª_im¶
<
acûss_šfo_t
>

108 
bË_row_t
 
	tai_tu¶e
;

110 
	gpublic
:

112 
ai_mª_im¶
(
acûss_šfo_t
* 
aAIDesc
)

113 : 
bË_mª_im¶
<
acûss_šfo_t
>(
aAIDesc
)

115 ~
ai_mª_im¶
() { }

118 
w_rc_t
 
ai_idx_´obe
(
ss_m
* 
db
,

119 
ai_tu¶e
* 
±u¶e
,

120 cÚ¡ 
s_id
, cÚ¡ 
ai_ty³
);

122 
w_rc_t
 
ai_idx_upd
(
ss_m
* 
db
,

123 
ai_tu¶e
* 
±u¶e
,

124 cÚ¡ 
s_id
, cÚ¡ 
ai_ty³
);

126 
w_rc_t
 
ai_idx_Æ
(
ss_m
* 
db
,

127 
ai_tu¶e
* 
±u¶e
,

128 cÚ¡ 
s_id
, cÚ¡ 
ai_ty³
);

134 
şass
 
	gsf_mª_im¶
 : 
public
 
bË_mª_im¶
<
¥ecŸl_çc™y_t
>

136 
bË_row_t
 
	tsf_tu¶e
;

137 
	gšdex_sÿn_™”_im¶
<
	t¥ecŸl_çc™y_t
> 
	tsf_idx_™”
;

139 
	gpublic
:

141 
sf_mª_im¶
(
¥ecŸl_çc™y_t
* 
aSFDesc
)

142 : 
bË_mª_im¶
<
¥ecŸl_çc™y_t
>(
aSFDesc
)

144 ~
sf_mª_im¶
() { }

148 
w_rc_t
 
sf_idx_´obe
(
ss_m
* 
db
,

149 
sf_tu¶e
* 
±u¶e
,

150 cÚ¡ 
s_id
, cÚ¡ 
sf_ty³
);

152 
w_rc_t
 
sf_idx_upd
(
ss_m
* 
db
,

153 
sf_tu¶e
* 
±u¶e
,

154 cÚ¡ 
s_id
, cÚ¡ 
sf_ty³
);

156 
w_rc_t
 
sf_idx_Æ
(
ss_m
* 
db
,

157 
sf_tu¶e
* 
±u¶e
,

158 cÚ¡ 
s_id
, cÚ¡ 
sf_ty³
);

162 
w_rc_t
 
sf_g‘_idx_™”
(
ss_m
* 
db
,

163 
sf_idx_™”
* &
™”
,

164 
sf_tu¶e
* 
±u¶e
,

165 
»p_row_t
 &
»¶ow
,

166 
»p_row_t
 &
»phigh
,

167 cÚ¡ 
sub_id
,

168 
lock_mode_t
 
®m
 = 
SH
,

169 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

171 
w_rc_t
 
sf_g‘_idx_™”_Æ
(
ss_m
* 
db
,

172 
sf_idx_™”
* &
™”
,

173 
sf_tu¶e
* 
±u¶e
,

174 
»p_row_t
 &
»¶ow
,

175 
»p_row_t
 &
»phigh
,

176 cÚ¡ 
sub_id
,

177 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

183 
şass
 
	gcf_mª_im¶
 : 
public
 
bË_mª_im¶
<
ÿÎ_fÜw¬dšg_t
>

185 
bË_row_t
 
	tcf_tu¶e
;

186 
	gšdex_sÿn_™”_im¶
<
	tÿÎ_fÜw¬dšg_t
> 
	tcf_idx_™”
;

188 
	gpublic
:

190 
cf_mª_im¶
(
ÿÎ_fÜw¬dšg_t
* 
aCFDesc
)

191 : 
bË_mª_im¶
<
ÿÎ_fÜw¬dšg_t
>(
aCFDesc
)

193 ~
cf_mª_im¶
() { }

197 
w_rc_t
 
cf_idx_´obe
(
ss_m
* 
db
,

198 
cf_tu¶e
* 
±u¶e
,

199 cÚ¡ 
s_id
, cÚ¡ 
sf_ty³
, cÚ¡ 
¡ime
);

201 
w_rc_t
 
cf_idx_upd
(
ss_m
* 
db
,

202 
cf_tu¶e
* 
±u¶e
,

203 cÚ¡ 
s_id
, cÚ¡ 
sf_ty³
, cÚ¡ 
¡ime
);

205 
w_rc_t
 
cf_idx_Æ
(
ss_m
* 
db
,

206 
cf_tu¶e
* 
±u¶e
,

207 cÚ¡ 
s_id
, cÚ¡ 
sf_ty³
, cÚ¡ 
¡ime
);

211 
w_rc_t
 
cf_g‘_idx_™”
(
ss_m
* 
db
,

212 
cf_idx_™”
* &
™”
,

213 
cf_tu¶e
* 
±u¶e
,

214 
»p_row_t
 &
»¶ow
,

215 
»p_row_t
 &
»phigh
,

216 cÚ¡ 
sub_id
,

217 cÚ¡ 
sf_ty³
,

218 cÚ¡ 
s_time
,

219 
lock_mode_t
 
®m
 = 
SH
,

220 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

222 
w_rc_t
 
cf_g‘_idx_™”_Æ
(
ss_m
* 
db
,

223 
cf_idx_™”
* &
™”
,

224 
cf_tu¶e
* 
±u¶e
,

225 
»p_row_t
 &
»¶ow
,

226 
»p_row_t
 &
»phigh
,

227 cÚ¡ 
sub_id
,

228 cÚ¡ 
sf_ty³
,

229 cÚ¡ 
s_time
,

230 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

237 
EXIT_NAMESPACE
(
tm1
);

	@include/workload/tm1/tm1_const.h

31 #iâdeà
__TM1_CONST_H


32 
	#__TM1_CONST_H


	)

35 
	~"ut/Çme¥aû.h
"

38 
ENTER_NAMESPACE
(
tm1
);

42 #undeà
USE_DORA_EXT_IDX


49 cÚ¡ 
	gTM1_SUBS_PER_SF
 = 10000;

51 cÚ¡ 
	gTM1_DEF_SF
 = 10;

52 cÚ¡ 
	gTM1_DEF_QF
 = 10;

56 cÚ¡ 
	gTM1_LOADING_COMMIT_INTERVAL
 = 1000;

57 cÚ¡ 
	gTM1_LOADING_TRACE_INTERVAL
 = 10000;

62 cÚ¡ 
	gTM1_LOADERS_TO_USE
 = 1;

63 cÚ¡ 
	gTM1_MAX_NUM_OF_LOADERS
 = 128;

64 cÚ¡ 
	gTM1_SUBS_TO_PRELOAD
 = 2000;

69 cÚ¡ 
	gTM1_MIN_AI_PER_SUBSCR
 = 1;

70 cÚ¡ 
	gTM1_MAX_AI_PER_SUBSCR
 = 4;

72 cÚ¡ 
	gTM1_MIN_SF_PER_SUBSCR
 = 1;

73 cÚ¡ 
	gTM1_MAX_SF_PER_SUBSCR
 = 4;

75 cÚ¡ 
	gTM1_MIN_CF_PER_SF
 = 0;

76 cÚ¡ 
	gTM1_MAX_CF_PER_SF
 = 3;

78 cÚ¡ 
	gTM1_PROB_ACTIVE_SF_YES
 = 85;

79 cÚ¡ 
	gTM1_PROB_ACTIVE_SF_NO
 = 15;

87 cÚ¡ 
	gTM1_SUB_FCOUNT
 = 34;

88 cÚ¡ 
	gTM1_AI_FCOUNT
 = 6;

89 cÚ¡ 
	gTM1_SF_FCOUNT
 = 6;

90 cÚ¡ 
	gTM1_CF_FCOUNT
 = 5;

94 cÚ¡ 
	gTM1_SUB_NBR_SZ
 = 16;

95 cÚ¡ 
	gTM1_AI_DATA3_SZ
 = 3;

96 cÚ¡ 
	gTM1_AI_DATA4_SZ
 = 5;

97 cÚ¡ 
	gTM1_SF_DATA_B_SZ
 = 5;

98 cÚ¡ 
	gTM1_CF_NUMBERX_SZ
 = 15;

107 cÚ¡ 
	gXCT_TM1_MIX
 = 20;

108 cÚ¡ 
	gXCT_TM1_GET_SUB_DATA
 = 21;

109 cÚ¡ 
	gXCT_TM1_GET_NEW_DEST
 = 22;

110 cÚ¡ 
	gXCT_TM1_GET_ACC_DATA
 = 23;

111 cÚ¡ 
	gXCT_TM1_UPD_SUB_DATA
 = 24;

112 cÚ¡ 
	gXCT_TM1_UPD_LOCATION
 = 25;

113 cÚ¡ 
	gXCT_TM1_CALL_FWD_MIX
 = 26;

115 cÚ¡ 
	gXCT_TM1_INS_CALL_FWD
 = 27;

116 cÚ¡ 
	gXCT_TM1_DEL_CALL_FWD
 = 28;

118 cÚ¡ 
	gXCT_TM1_GET_SUB_NBR
 = 29;

120 cÚ¡ 
	gXCT_TM1_CALL_FWD_MIX_BENCH
 = 30;

121 cÚ¡ 
	gXCT_TM1_INS_CALL_FWD_BENCH
 = 31;

122 cÚ¡ 
	gXCT_TM1_DEL_CALL_FWD_BENCH
 = 32;

130 cÚ¡ 
	gPROB_TM1_GET_SUB_DATA
 = 35;

131 cÚ¡ 
	gPROB_TM1_GET_NEW_DEST
 = 10;

132 cÚ¡ 
	gPROB_TM1_GET_ACC_DATA
 = 35;

135 cÚ¡ 
	gPROB_TM1_UPD_SUB_DATA
 = 2;

136 cÚ¡ 
	gPROB_TM1_UPD_LOCATION
 = 14;

137 cÚ¡ 
	gPROB_TM1_INS_CALL_FWD
 = 2;

138 cÚ¡ 
	gPROB_TM1_DEL_CALL_FWD
 = 2;

142 
EXIT_NAMESPACE
(
tm1
);

	@include/workload/tm1/tm1_input.h

32 #iâdeà
__TM1_INPUT_H


33 
	#__TM1_INPUT_H


	)

35 
	~"ut/¿ndom_šput.h
"

37 
	~"wÜklßd/tm1/tm1_cÚ¡.h
"

41 
ENTER_NAMESPACE
(
tm1
);

45 
skew”_t
 
s_skew”
;

46 
boŞ
 
_chªge_lßd
;

50 
	stm1_sub_t


52 
	mS_ID
;

53 
	mSUB_NBR
[
STRSIZE
(
TM1_SUB_NBR_SZ
)];

54 
boŞ
 
	mBIT_XX
[10];

55 
	mHEX_XX
[10];

56 
	mBYTE2_XX
[10];

57 
	mMSC_LOCATION
;

58 
	mVLR_LOCATION
;

62 
	stm1_ai_t


64 
	mS_ID
;

65 
	mAI_TYPE
;

66 
	mDATA1
;

67 
	mDATA2
;

68 
	mDATA3
[
STRSIZE
(
TM1_AI_DATA3_SZ
)];

69 
	mDATA4
[
STRSIZE
(
TM1_AI_DATA4_SZ
)];

73 
	stm1_sf_t


75 
	mS_ID
;

76 
	mSF_TYPE
;

77 
boŞ
 
	mIS_ACTIVE
;

78 
	mERROR_CNTRL
;

79 
	mDATA_A
;

80 
	mDATA_B
[
STRSIZE
(
TM1_SF_DATA_B_SZ
)];

84 
	stm1_cf_t


86 
	mS_ID
;

87 
	mSF_TYPE
;

88 
	mSTART_TIME
;

89 
	mEND_TIME
;

90 
	mNUMBERX
[
STRSIZE
(
TM1_CF_NUMBERX_SZ
)];

102 
	sg‘_sub_d©a_šput_t


110 
	m_s_id
;

112 
	mg‘_sub_d©a_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
g‘_sub_d©a_šput_t
& 
rhs
);

126 
	sg‘_Ãw_de¡_šput_t


137 
	m_s_id
;

138 
	m_sf_ty³
;

139 
	m_s_time
;

140 
	m_e_time
;

142 
	mg‘_Ãw_de¡_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
g‘_Ãw_de¡_šput_t
& 
rhs
);

156 
	sg‘_acc_d©a_šput_t


165 
	m_s_id
;

166 
	m_ai_ty³
;

168 
	mg‘_acc_d©a_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
g‘_acc_d©a_šput_t
& 
rhs
);

182 
	supd_sub_d©a_šput_t


193 
	m_s_id
;

194 
	m_sf_ty³
;

195 
boŞ
 
	m_a_b™
;

196 
	m_a_d©a
;

198 
	mupd_sub_d©a_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
upd_sub_d©a_šput_t
& 
rhs
);

212 
	supd_loc_šput_t


222 
	m_s_id
;

223 
	m_sub_nbr
[16];

224 
	m_vÌ_loc
;

226 
	mupd_loc_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
upd_loc_šput_t
& 
rhs
);

240 
	sšs_ÿÎ_fwd_šput_t


253 
	m_s_id
;

254 
	m_sub_nbr
[16];

255 
	m_sf_ty³
;

256 
	m_s_time
;

257 
	m_e_time
;

258 
	m_numb”x
[16];

260 
	mšs_ÿÎ_fwd_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
šs_ÿÎ_fwd_šput_t
& 
rhs
);

274 
	sd–_ÿÎ_fwd_šput_t


285 
	m_s_id
;

286 
	m_sub_nbr
[16];

287 
	m_sf_ty³
;

288 
	m_s_time
;

290 
	md–_ÿÎ_fwd_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
d–_ÿÎ_fwd_šput_t
& 
rhs
);

304 
	sg‘_sub_nbr_šput_t


312 
	m_s_id
;

313 
ušt
 
	m_¿nge
;

315 #ifdeà
USE_DORA_EXT_IDX


317 
	mveùÜ
< 
	m·œ
<,
	mrid_t
> > 
	m_·œs
;

320 
	mg‘_sub_nbr_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
g‘_sub_nbr_šput_t
& 
rhs
);

334 
	sšs_ÿÎ_fwd_b’ch_šput_t


347 
	m_s_id
;

348 
	m_sub_nbr
[16];

349 
	m_sf_ty³
;

350 
	m_s_time
;

351 
	m_e_time
;

352 
	m_numb”x
[16];

354 
	mšs_ÿÎ_fwd_b’ch_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
šs_ÿÎ_fwd_b’ch_šput_t
& 
rhs
);

368 
	sd–_ÿÎ_fwd_b’ch_šput_t


379 
	m_s_id
;

380 
	m_sub_nbr
[16];

381 
	m_sf_ty³
;

382 
	m_s_time
;

384 
	md–_ÿÎ_fwd_b’ch_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
d–_ÿÎ_fwd_b’ch_šput_t
& 
rhs
);

398 
g‘_sub_d©a_šput_t
 
ü—‹_g‘_sub_d©a_šput
(
SF
,

399 
¥ecificSub
 = 0);

402 
g‘_Ãw_de¡_šput_t
 
ü—‹_g‘_Ãw_de¡_šput
(
SF
,

403 
¥ecificSub
 = 0);

406 
g‘_acc_d©a_šput_t
 
ü—‹_g‘_acc_d©a_šput
(
SF
,

407 
¥ecificSub
 = 0);

410 
upd_sub_d©a_šput_t
 
ü—‹_upd_sub_d©a_šput
(
SF
,

411 
¥ecificSub
 = 0);

414 
upd_loc_šput_t
 
ü—‹_upd_loc_šput
(
SF
,

415 
¥ecificSub
 = 0);

418 
šs_ÿÎ_fwd_šput_t
 
ü—‹_šs_ÿÎ_fwd_šput
(
SF
,

419 
¥ecificSub
 = 0);

422 
d–_ÿÎ_fwd_šput_t
 
ü—‹_d–_ÿÎ_fwd_šput
(
SF
,

423 
¥ecificSub
 = 0);

425 
g‘_sub_nbr_šput_t
 
ü—‹_g‘_sub_nbr_šput
(
SF
,

426 
¥ecificSub
 = 0);

429 
šs_ÿÎ_fwd_b’ch_šput_t
 
ü—‹_šs_ÿÎ_fwd_b’ch_šput
(
SF
,

430 
¥ecificSub
 = 0);

433 
d–_ÿÎ_fwd_b’ch_šput_t
 
ü—‹_d–_ÿÎ_fwd_b’ch_šput
(
SF
,

434 
¥ecificSub
 = 0);

440 
¿ndom_tm1_xù_ty³
(cÚ¡ 
£Ëùed
);

443 
EXIT_NAMESPACE
(
tm1
);

	@include/workload/tpcb/shore_tpcb_client.h

31 #iâdeà
__SHORE_TPCB_CLIENT_H


32 
	#__SHORE_TPCB_CLIENT_H


	)

35 
	~"sm/shÜe/shÜe_ş›Á.h
"

37 
	~"wÜklßd/cb/shÜe_cb_’v.h
"

39 
usšg
 
Çme¥aû
 
	gshÜe
;

41 
ENTER_NAMESPACE
(
cb
);

52 şas 
	cba£lše_cb_ş›Á_t
 : 
public
 
ba£_ş›Á_t


54 
´iv©e
:

55 
_£lid
;

56 
Œx_wÜk”_t
* 
	m_wÜk”
;

57 
	m_qf
;

59 
	mpublic
:

61 
	$ba£lše_cb_ş›Á_t
() { }

63 
	`ba£lše_cb_ş›Á_t
(
c_¡r
 
Šame
, cÚ¡ 
id
, 
ShÜeTPCBEnv
* 
’v
,

64 cÚ¡ 
M—su»m’tTy³
 
aTy³
, cÚ¡ 
Œxid
,

65 cÚ¡ 
numOfTrxs
,

66 
´oûssÜid_t
 
­rsid
, cÚ¡ 
£lID
, cÚ¡ 
qf
);

68 ~
	$ba£lše_cb_ş›Á_t
(è{ 
	}
}

71 
lßd_sup_xù
(
m­SupTrxs
& 
m­
);

75 
w_rc_t
 
subm™_Úe
(
xù_ty³
, 
xùid
);

80 
EXIT_NAMESPACE
(
cb
);

	@include/workload/tpcb/shore_tpcb_env.h

33 #iâdeà
__SHORE_TPCB_ENV_H


34 
	#__SHORE_TPCB_ENV_H


	)

37 
	~"sm_vas.h
"

38 
	~"ut.h
"

40 
	~"wÜklßd/cb/cb_šput.h
"

42 
	~"sm/shÜe/shÜe_’v.h
"

43 
	~"sm/shÜe/shÜe_Œx_wÜk”.h
"

45 
	~"wÜklßd/cb/shÜe_cb_schema_mª.h
"

47 
	~<m­
>

49 
usšg
 
Çme¥aû
 
	gshÜe
;

52 
ENTER_NAMESPACE
(
cb
);

55 
usšg
 
	g¡d
::
m­
;

68 
	sShÜeTPCBTrxCouÁ


70 
ušt
 
	macù_upd©e
;

71 
ušt
 
	mpİuÏ‹_db
;

73 
ušt
 
	mmb’ch_š£¹_Úly
;

74 
ušt
 
	mmb’ch_d–‘e_Úly
;

75 
ušt
 
	mmb’ch_´obe_Úly
;

76 
ušt
 
	mmb’ch_š£¹_d–‘e
;

77 
ušt
 
	mmb’ch_š£¹_´obe
;

78 
ušt
 
	mmb’ch_d–‘e_´obe
;

79 
ušt
 
	mmb’ch_mix
;

81 
	mShÜeTPCBTrxCouÁ
& 
	mİ”©Ü
+=(
ShÜeTPCBTrxCouÁ
 cÚ¡& 
rhs
) {

82 
acù_upd©e
 +ğ
rhs
.acct_update;

84 
	mmb’ch_š£¹_Úly
 +ğ
rhs
.
mb’ch_š£¹_Úly
;

85 
	mmb’ch_d–‘e_Úly
 +ğ
rhs
.
mb’ch_d–‘e_Úly
;

86 
	mmb’ch_´obe_Úly
 +ğ
rhs
.
mb’ch_´obe_Úly
;

87 
	mmb’ch_š£¹_d–‘e
 +ğ
rhs
.
mb’ch_š£¹_d–‘e
;

88 
	mmb’ch_š£¹_´obe
 +ğ
rhs
.
mb’ch_š£¹_´obe
;

89 
	mmb’ch_d–‘e_´obe
 +ğ
rhs
.
mb’ch_d–‘e_´obe
;

90 
	mmb’ch_mix
 +ğ
rhs
.
mb’ch_mix
;

92  (*
	mthis
);

95 
	mShÜeTPCBTrxCouÁ
& 
	mİ”©Ü
-=(
ShÜeTPCBTrxCouÁ
 cÚ¡& 
rhs
) {

96 
acù_upd©e
 -ğ
rhs
.acct_update;

98 
	mmb’ch_š£¹_Úly
 -ğ
rhs
.
mb’ch_š£¹_Úly
;

99 
	mmb’ch_d–‘e_Úly
 -ğ
rhs
.
mb’ch_d–‘e_Úly
;

100 
	mmb’ch_´obe_Úly
 -ğ
rhs
.
mb’ch_´obe_Úly
;

101 
	mmb’ch_š£¹_d–‘e
 -ğ
rhs
.
mb’ch_š£¹_d–‘e
;

102 
	mmb’ch_š£¹_´obe
 -ğ
rhs
.
mb’ch_š£¹_´obe
;

103 
	mmb’ch_d–‘e_´obe
 -ğ
rhs
.
mb’ch_d–‘e_´obe
;

104 
	mmb’ch_mix
 -ğ
rhs
.
mb’ch_mix
;

106  (*
	mthis
);

109 
ušt
 
tÙ®
() const {

110  (
	macù_upd©e
+

111 
	mmb’ch_š£¹_Úly
+
	mmb’ch_d–‘e_Úly
+
	mmb’ch_´obe_Úly
+

112 
	mmb’ch_š£¹_d–‘e
+
	mmb’ch_š£¹_´obe
+
	mmb’ch_d–‘e_´obe
+
	mmb’ch_mix
);

118 
	sShÜeTPCBTrxSts


120 
ShÜeTPCBTrxCouÁ
 
	m©‹m±ed
;

121 
ShÜeTPCBTrxCouÁ
 
	mçed
;

122 
ShÜeTPCBTrxCouÁ
 
	md—dlocked
;

124 
	mShÜeTPCBTrxSts
& 
	mİ”©Ü
+=(
ShÜeTPCBTrxSts
 cÚ¡& 
Ùh”
) {

125 
©‹m±ed
 +ğ
Ùh”
.attempted;

126 
	mçed
 +ğ
Ùh”
.
çed
;

127 
	md—dlocked
 +ğ
Ùh”
.
d—dlocked
;

128  (*
	mthis
);

131 
	mShÜeTPCBTrxSts
& 
	mİ”©Ü
-=(
ShÜeTPCBTrxSts
 cÚ¡& 
Ùh”
) {

132 
©‹m±ed
 -ğ
Ùh”
.attempted;

133 
	mçed
 -ğ
Ùh”
.
çed
;

134 
	md—dlocked
 -ğ
Ùh”
.
d—dlocked
;

135  (*
	mthis
);

150 şas 
	cShÜeTPCBEnv
 : 
public
 
ShÜeEnv


152 
public
:

154 
¡d
::
	tm­
<
	t±h»ad_t
, 
	tShÜeTPCBTrxSts
*> 
	t¡©m­_t
;

156 
şass
 
	mbË_bud”_t
;

157 
şass
 
	mbË_ü—tÜ_t
;

158 
	mcheckpoš‹r_t
;

159 
şass
 
	mfid_lßd”_t
;

161 
	m´iv©e
:

163 
w_rc_t
 
_po¡_š™_im¶
();

165 
w_rc_t
 
_·d_BRANCHES
();

166 
w_rc_t
 
_·d_TELLERS
();

168 
	mpublic
:

170 
ShÜeTPCBEnv
();

171 
	mvœtu®
 ~
ShÜeTPCBEnv
();

176 
vœtu®
 
	$£t
(
’vV¬M­
* ) { (0); };

177 
vœtu®
 
	$İ’
(è{ (0); 
	}
};

178 
vœtu®
 
	$·u£
(è{ (0); 
	}
};

179 
vœtu®
 
	$»sume
(è{ (0); 
	}
};

180 
vœtu®
 
w_rc_t
 
	$Ãwrun
(è{ (
RCOK
); 
	}
};

182 
vœtu®
 
po¡_š™
();

183 
vœtu®
 
w_rc_t
 
lßd_schema
();

185 
vœtu®
 
w_rc_t
 
lßd_ªd_»gi¡”_fids
();

187 
vœtu®
 
cÚf
();

188 
vœtu®
 
¡¬t
();

189 
vœtu®
 
¡İ
();

190 
vœtu®
 
	$šfo
() const;

191 
vœtu®
 
	`¡©i¡ics
();

193 
	`dump
();

195 
vœtu®
 
	`´št_throughput
(cÚ¡ 
iQu”›dSF
,

196 cÚ¡ 
iS´—d
,

197 cÚ¡ 
iNumOfTh»ads
,

198 cÚ¡ 
d–ay
,

199 cÚ¡ 
ulÚg_t
 
mioch
,

200 cÚ¡ 
avgıuu§ge
);

206 
w_rc_t
 
	`lßdd©a
();

207 
w_rc_t
 
	`w¬mup
();

208 
w_rc_t
 
	`check_cÚsi¡’cy
();

212 
	`DECLARE_TABLE
(
b¿nch_t
,
b¿nch_mª_im¶
,
b¿nch
);

213 
	`DECLARE_TABLE
(
‹Î”_t
,
‹Î”_mª_im¶
,
‹Î”
);

214 
	`DECLARE_TABLE
(
accouÁ_t
,
accouÁ_mª_im¶
,
accouÁ
);

215 
	`DECLARE_TABLE
(
hi¡Üy_t
,
hi¡Üy_mª_im¶
,
hi¡Üy
);

220 
w_rc_t
 
	`run_Úe_xù
(
Reque¡
* 
´eque¡
);

223 
	`DECLARE_TRX
(
acù_upd©e
);

226 
	`DECLARE_TRX
(
mb’ch_š£¹_Úly
);

227 
	`DECLARE_TRX
(
mb’ch_d–‘e_Úly
);

228 
	`DECLARE_TRX
(
mb’ch_´obe_Úly
);

229 
	`DECLARE_TRX
(
mb’ch_š£¹_d–‘e
);

230 
	`DECLARE_TRX
(
mb’ch_š£¹_´obe
);

231 
	`DECLARE_TRX
(
mb’ch_d–‘e_´obe
);

232 
	`DECLARE_TRX
(
mb’ch_mix
);

235 
	`DECLARE_TRX
(
pİuÏ‹_db
);

238 
vœtu®
 
w_rc_t
 
	`upd©e_·¹™iÚšg
();

241 
vœtu®
 
	`’v_th»ad_š™
();

242 
vœtu®
 
	`’v_th»ad_fši
();

245 
¡©m­_t
 
_¡©m­
;

248 
ShÜeTPCBTrxSts
 
_Ï¡_¡©s
;

249 
vœtu®
 
	`»£t_¡©s
();

250 
ShÜeTPCBTrxSts
 
	`_g‘_¡©s
();

253 
	`£t_skew
(
¬—
, 
lßd
, 
¡¬t_imb®ªû
);

254 
	`¡¬t_lßd_imb®ªû
();

255 
	`»£t_skew
();

258 
w_rc_t
 
	`db_´št
(
lšes
);

261 
w_rc_t
 
	`db_ãtch
();

263 
	}
};

267 
EXIT_NAMESPACE
(
cb
);

	@include/workload/tpcb/shore_tpcb_schema.h

33 #iâdeà
__SHORE_TPCB_SCHEMA_H


34 
	#__SHORE_TPCB_SCHEMA_H


	)

37 
	~<m©h.h
>

39 
	~"sm_vas.h
"

40 
	~"ut.h
"

42 
	~"sm/shÜe/shÜe_bË_mª.h
"

44 
usšg
 
Çme¥aû
 
	gshÜe
;

47 
ENTER_NAMESPACE
(
cb
);

58 
DECLARE_TABLE_SCHEMA_PD
(
b¿nch_t
);

59 
DECLARE_TABLE_SCHEMA_PD
(
‹Î”_t
);

60 
DECLARE_TABLE_SCHEMA_PD
(
accouÁ_t
);

61 
DECLARE_TABLE_SCHEMA_PD
(
hi¡Üy_t
);

64 
EXIT_NAMESPACE
(
cb
);

	@include/workload/tpcb/shore_tpcb_schema_man.h

32 #iâdeà
__SHORE_TPCB_SCHEMA_MANAGER_H


33 
	#__SHORE_TPCB_SCHEMA_MANAGER_H


	)

36 
	~"wÜklßd/cb/shÜe_cb_schema.h
"

38 
usšg
 
Çme¥aû
 
	gshÜe
;

41 
ENTER_NAMESPACE
(
cb
);

50 
şass
 
	gb¿nch_mª_im¶
 : 
public
 
bË_mª_im¶
<
b¿nch_t
>

52 
bË_row_t
 
	tb¿nch_tu¶e
;

54 
	gpublic
:

56 
b¿nch_mª_im¶
(
b¿nch_t
* 
aB¿nchDesc
)

57 : 
bË_mª_im¶
<
b¿nch_t
>(
aB¿nchDesc
)

60 ~
b¿nch_mª_im¶
() { }

63 
w_rc_t
 
b_šdex_´obe
(
ss_m
* 
db
,

64 
b¿nch_tu¶e
* 
±u¶e
,

65 cÚ¡ 
b_id
);

67 
w_rc_t
 
b_šdex_´obe_fÜupd©e
(
ss_m
* 
db
,

68 
b¿nch_tu¶e
* 
±u¶e
,

69 cÚ¡ 
b_id
);

71 
w_rc_t
 
b_idx_Æ
(
ss_m
* 
db
,

72 
b¿nch_tu¶e
* 
±u¶e
,

73 cÚ¡ 
b_id
);

79 
şass
 
	g‹Î”_mª_im¶
 : 
public
 
bË_mª_im¶
<
‹Î”_t
>

81 
bË_row_t
 
	t‹Î”_tu¶e
;

83 
	gpublic
:

85 
‹Î”_mª_im¶
(
‹Î”_t
* 
aT–ËrDesc
)

86 : 
bË_mª_im¶
<
‹Î”_t
>(
aT–ËrDesc
)

89 ~
‹Î”_mª_im¶
() { }

92 
w_rc_t
 
t_šdex_´obe_fÜupd©e
(
ss_m
* 
db
,

93 
‹Î”_tu¶e
* 
±u¶e
,

94 cÚ¡ 
t_id
);

96 
w_rc_t
 
t_idx_Æ
(
ss_m
* 
db
,

97 
‹Î”_tu¶e
* 
±u¶e
,

98 cÚ¡ 
t_id
);

104 
şass
 
	gaccouÁ_mª_im¶
 : 
public
 
bË_mª_im¶
<
accouÁ_t
>

106 
bË_row_t
 
	taccouÁ_tu¶e
;

107 
	gbË_sÿn_™”_im¶
<
	taccouÁ_t
> 
	taccouÁ_bË_™”
;

108 
	gšdex_sÿn_™”_im¶
<
	taccouÁ_t
> 
	taccouÁ_šdex_™”
;

110 
	gpublic
:

112 
accouÁ_mª_im¶
(
accouÁ_t
* 
aAccouÁDesc
)

113 : 
bË_mª_im¶
<
accouÁ_t
>(
aAccouÁDesc
)

116 ~
accouÁ_mª_im¶
() { }

119 
w_rc_t
 
a_šdex_´obe_fÜupd©e
(
ss_m
* 
db
,

120 
accouÁ_tu¶e
* 
±u¶e
,

121 cÚ¡ 
a_id
,

122 cÚ¡ 
b_id
 = 0,

123 cÚ¡ 
b®ªû
 = 0);

125 
w_rc_t
 
a_d–‘e_by_šdex
(
ss_m
* 
db
,

126 
accouÁ_tu¶e
* 
±u¶e
,

127 cÚ¡ 
a_id
,

128 cÚ¡ 
b_id
 = 0,

129 cÚ¡ 
b®ªû
 = 0);

131 
w_rc_t
 
a_šdex_´obe
(
ss_m
* 
db
,

132 
accouÁ_tu¶e
* 
±u¶e
,

133 cÚ¡ 
a_id
,

134 cÚ¡ 
b_id
 = 0,

135 cÚ¡ 
b®ªû
 = 0);

137 
w_rc_t
 
a_idx_Æ
(
ss_m
* 
db
,

138 
accouÁ_tu¶e
* 
±u¶e
,

139 cÚ¡ 
a_id
,

140 cÚ¡ 
b_id
 = 0,

141 cÚ¡ 
b®ªû
 = 0);

148 
şass
 
	ghi¡Üy_mª_im¶
 : 
public
 
bË_mª_im¶
<
hi¡Üy_t
>

150 
bË_row_t
 
	thi¡Üy_tu¶e
;

152 
	gpublic
:

154 
hi¡Üy_mª_im¶
(
hi¡Üy_t
* 
aHi¡ÜyDesc
)

155 : 
bË_mª_im¶
<
hi¡Üy_t
>(
aHi¡ÜyDesc
)

158 ~
hi¡Üy_mª_im¶
() { }

164 
EXIT_NAMESPACE
(
cb
);

	@include/workload/tpcb/tpcb_input.h

32 #iâdeà
__TPCB_INPUT_H


33 
	#__TPCB_INPUT_H


	)

35 
	~"ut.h
"

38 
ENTER_NAMESPACE
(
cb
);

42 cÚ¡ 
	gXCT_TPCB_ACCT_UPDATE
 = 31;

43 cÚ¡ 
	gXCT_TPCB_POPULATE_DB
 = 39;

46 cÚ¡ 
	gXCT_TPCB_MBENCH_INSERT_ONLY
 = 41;

47 cÚ¡ 
	gXCT_TPCB_MBENCH_DELETE_ONLY
 = 42;

48 cÚ¡ 
	gXCT_TPCB_MBENCH_PROBE_ONLY
 = 43;

49 cÚ¡ 
	gXCT_TPCB_MBENCH_INSERT_DELETE
 = 44;

50 cÚ¡ 
	gXCT_TPCB_MBENCH_INSERT_PROBE
 = 45;

51 cÚ¡ 
	gXCT_TPCB_MBENCH_DELETE_PROBE
 = 46;

52 cÚ¡ 
	gXCT_TPCB_MBENCH_MIX
 = 47;

55 ’um { 
	mTPCB_TELLERS_PER_BRANCH
=10 };

56 ’um { 
	mTPCB_ACCOUNTS_PER_BRANCH
=100000 };

57 ’um { 
	mTPCB_ACCOUNTS_CREATED_PER_POP_XCT
=10000 };

62 
skew”_t
 
b_skew”
;

63 
skew”_t
 
t_skew”
;

64 
skew”_t
 
a_skew”
;

65 
boŞ
 
_chªge_lßd
;

79 
	sacù_upd©e_šput_t


81 
	mb_id
;

82 
	mt_id
;

83 
	ma_id
;

84 
	md–
;

86 
acù_upd©e_šput_t
() { }

90 
	spİuÏ‹_db_šput_t


92 
	m_sf
;

93 
	m_fœ¡_a_id
;

95 
pİuÏ‹_db_šput_t
(
sf
, 
a_id
è: 
_sf
(sf), 
_fœ¡_a_id
(a_id) { }

99 
	smb’ch_š£¹_Úly_šput_t


101 
	mb_id
;

102 
	ma_id
;

103 
	mb®ªû
;

105 
mb’ch_š£¹_Úly_šput_t
() { }

107 
´št
();

110 
	smb’ch_d–‘e_Úly_šput_t


112 
	mb_id
;

113 
	ma_id
;

114 
	mb®ªû
;

116 
mb’ch_d–‘e_Úly_šput_t
() { }

118 
´št
();

121 
	smb’ch_´obe_Úly_šput_t


123 
	mb_id
;

124 
	ma_id
;

125 
	mb®ªû
;

127 
mb’ch_´obe_Úly_šput_t
() { }

129 
´št
();

132 
	smb’ch_š£¹_d–‘e_šput_t


134 
	mb_id
;

135 
	ma_id
;

136 
	mb®ªû
;

138 
mb’ch_š£¹_d–‘e_šput_t
() { }

141 
	smb’ch_š£¹_´obe_šput_t


143 
	mb_id
;

144 
	ma_id
;

145 
	mb®ªû
;

147 
mb’ch_š£¹_´obe_šput_t
() { }

150 
	smb’ch_d–‘e_´obe_šput_t


152 
	mb_id
;

153 
	ma_id
;

154 
	mb®ªû
;

156 
mb’ch_d–‘e_´obe_šput_t
() { }

159 
	smb’ch_mix_šput_t


161 
	mb_id
;

162 
	ma_id
;

163 
	mb®ªû
;

165 
mb’ch_mix_šput_t
() { }

177 
acù_upd©e_šput_t
 
ü—‹_acù_upd©e_šput
(
SF
,

178 
¥ecificBr
 = 0);

181 
pİuÏ‹_db_šput_t
 
ü—‹_pİuÏ‹_db_šput
(
SF
,

182 
¥ecificBr
 = 0);

185 
mb’ch_š£¹_Úly_šput_t
 
ü—‹_mb’ch_š£¹_Úly_šput
(
SF
,

186 
¥ecificBr
 = 0);

189 
mb’ch_d–‘e_Úly_šput_t
 
ü—‹_mb’ch_d–‘e_Úly_šput
(
SF
,

190 
¥ecificBr
 = 0);

193 
mb’ch_´obe_Úly_šput_t
 
ü—‹_mb’ch_´obe_Úly_šput
(
SF
,

194 
¥ecificBr
 = 0);

197 
mb’ch_š£¹_d–‘e_šput_t
 
ü—‹_mb’ch_š£¹_d–‘e_šput
(
SF
,

198 
¥ecificBr
 = 0);

201 
mb’ch_š£¹_´obe_šput_t
 
ü—‹_mb’ch_š£¹_´obe_šput
(
SF
,

202 
¥ecificBr
 = 0);

205 
mb’ch_d–‘e_´obe_šput_t
 
ü—‹_mb’ch_d–‘e_´obe_šput
(
SF
,

206 
¥ecificBr
 = 0);

209 
mb’ch_mix_šput_t
 
ü—‹_mb’ch_mix_šput
(
SF
,

210 
¥ecificBr
 = 0);

213 
EXIT_NAMESPACE
(
cb
);

	@include/workload/tpcc/shore_tpcc_client.h

31 #iâdeà
__SHORE_TPCC_CLIENT_H


32 
	#__SHORE_TPCC_CLIENT_H


	)

35 
	~"sm/shÜe/shÜe_ş›Á.h
"

37 
	~"wÜklßd/cc/cc_cÚ¡.h
"

38 
	~"wÜklßd/cc/shÜe_cc_’v.h
"

40 
usšg
 
Çme¥aû
 
	gshÜe
;

42 
ENTER_NAMESPACE
(
cc
);

53 şas 
	cba£lše_cc_ş›Á_t
 : 
public
 
ba£_ş›Á_t


55 
´iv©e
:

57 
_wh
;

58 
Œx_wÜk”_t
* 
	m_wÜk”
;

59 
	m_qf
;

62 
	mpublic
:

64 
	$ba£lše_cc_ş›Á_t
() { }

66 
	`ba£lše_cc_ş›Á_t
(
c_¡r
 
Šame
, cÚ¡ 
id
, 
ShÜeTPCCEnv
* 
’v
,

67 cÚ¡ 
M—su»m’tTy³
 
aTy³
, cÚ¡ 
Œxid
,

68 cÚ¡ 
numOfTrxs
,

69 
´oûssÜid_t
 
­rsid
, cÚ¡ 
sWH
, cÚ¡ 
qf
);

71 ~
	$ba£lše_cc_ş›Á_t
(è{ 
	}
}

74 
lßd_sup_xù
(
m­SupTrxs
& 
m­
);

78 
w_rc_t
 
subm™_Úe
(
xù_ty³
, 
xùid
);

83 
EXIT_NAMESPACE
(
cc
);

	@include/workload/tpcc/shore_tpcc_env.h

31 #iâdeà
__SHORE_TPCC_ENV_H


32 
	#__SHORE_TPCC_ENV_H


	)

35 
	~"sm_vas.h
"

36 
	~"ut.h
"

38 
	~"sm/shÜe/shÜe_’v.h
"

39 
	~"sm/shÜe/shÜe_asc_sÜt_buf.h
"

40 
	~"sm/shÜe/shÜe_Œx_wÜk”.h
"

42 
	~"wÜklßd/cc/cc_cÚ¡.h
"

44 
	~"wÜklßd/cc/shÜe_cc_schema_mª.h
"

45 
	~"wÜklßd/cc/cc_šput.h
"

47 
	~<m­
>

49 
usšg
 
	g¡d
::
m­
;

50 
usšg
 
Çme¥aû
 
	gshÜe
;

53 
ENTER_NAMESPACE
(
cc
);

56 
	#TPCC_SCALING_FACTOR
 100

	)

57 
	#QUERIED_TPCC_SCALING_FACTOR
 100

	)

69 
	sShÜeTPCCTrxCouÁ


71 
ušt
 
	mÃw_Üd”
;

72 
ušt
 
	m·ym’t
;

73 
ušt
 
	mÜd”_¡©us
;

74 
ušt
 
	md–iv”y
;

75 
ušt
 
	m¡ock_Ëv–
;

77 
ušt
 
	mmb’ch_wh
;

78 
ušt
 
	mmb’ch_cu¡
;

80 
	mShÜeTPCCTrxCouÁ
& 
	mİ”©Ü
+=(
ShÜeTPCCTrxCouÁ
 cÚ¡& 
rhs
) {

81 
Ãw_Üd”
 +ğ
rhs
.new_order;

82 
	m·ym’t
 +ğ
rhs
.
·ym’t
;

83 
	mÜd”_¡©us
 +ğ
rhs
.
Üd”_¡©us
;

84 
	md–iv”y
 +ğ
rhs
.
d–iv”y
;

85 
	m¡ock_Ëv–
 +ğ
rhs
.
¡ock_Ëv–
;

86 
	mmb’ch_wh
 +ğ
rhs
.
mb’ch_wh
;

87 
	mmb’ch_cu¡
 +ğ
rhs
.
mb’ch_cu¡
;

88  (*
	mthis
);

91 
	mShÜeTPCCTrxCouÁ
& 
	mİ”©Ü
-=(
ShÜeTPCCTrxCouÁ
 cÚ¡& 
rhs
) {

92 
Ãw_Üd”
 -ğ
rhs
.new_order;

93 
	m·ym’t
 -ğ
rhs
.
·ym’t
;

94 
	mÜd”_¡©us
 -ğ
rhs
.
Üd”_¡©us
;

95 
	md–iv”y
 -ğ
rhs
.
d–iv”y
;

96 
	m¡ock_Ëv–
 -ğ
rhs
.
¡ock_Ëv–
;

97 
	mmb’ch_wh
 -ğ
rhs
.
mb’ch_wh
;

98 
	mmb’ch_cu¡
 -ğ
rhs
.
mb’ch_cu¡
;

99  (*
	mthis
);

102 
ušt
 
tÙ®
() const {

103  (
	mÃw_Üd”
+
	m·ym’t
+
	mÜd”_¡©us
+
	md–iv”y
+
	m¡ock_Ëv–
+

104 
	mmb’ch_wh
+
	mmb’ch_cu¡
);

111 
	sShÜeTPCCTrxSts


113 
ShÜeTPCCTrxCouÁ
 
	m©‹m±ed
;

114 
ShÜeTPCCTrxCouÁ
 
	mçed
;

115 
ShÜeTPCCTrxCouÁ
 
	md—dlocked
;

117 
	mShÜeTPCCTrxSts
& 
	mİ”©Ü
+=(
ShÜeTPCCTrxSts
 cÚ¡& 
Ùh”
) {

118 
©‹m±ed
 +ğ
Ùh”
.attempted;

119 
	mçed
 +ğ
Ùh”
.
çed
;

120 
	md—dlocked
 +ğ
Ùh”
.
d—dlocked
;

121  (*
	mthis
);

124 
	mShÜeTPCCTrxSts
& 
	mİ”©Ü
-=(
ShÜeTPCCTrxSts
 cÚ¡& 
Ùh”
) {

125 
©‹m±ed
 -ğ
Ùh”
.attempted;

126 
	mçed
 -ğ
Ùh”
.
çed
;

127 
	md—dlocked
 -ğ
Ùh”
.
d—dlocked
;

128  (*
	mthis
);

144 cÚ¡ 
	gNORD_PER_UNIT
 = 9;

145 cÚ¡ 
	gCUST_PER_UNIT
 = 30;

146 cÚ¡ 
	gHIST_PER_UNIT
 = 30;

147 cÚ¡ 
	gORDERS_PER_UNIT
 = 30;

148 cÚ¡ 
	gSTOCK_PER_UNIT
 = 100;

149 cÚ¡ 
	gUNIT_PER_WH
 = 1000;

150 cÚ¡ 
	gUNIT_PER_DIST
 = 100;

151 cÚ¡ 
	gORDERS_PER_DIST
 = 3000;

154 şas 
	cShÜeTPCCEnv
 : 
public
 
ShÜeEnv


156 
public
:

158 
¡d
::
	tm­
<
	t±h»ad_t
, 
	tShÜeTPCCTrxSts
*> 
	t¡©m­_t
;

160 
şass
 
	mbË_bud”_t
;

161 
şass
 
	mbË_ü—tÜ_t
;

162 
şass
 
	mcheckpoš‹r_t
;

164 
	m´iv©e
:

165 
w_rc_t
 
_po¡_š™_im¶
();

167 
	mpublic
:

169 
ShÜeTPCCEnv
();

170 
	mvœtu®
 ~
ShÜeTPCCEnv
();

175 
vœtu®
 
	$£t
(
’vV¬M­
* ) { (0); };

176 
vœtu®
 
	$İ’
(è{ (0); 
	}
};

177 
vœtu®
 
	$·u£
(è{ (0); 
	}
};

178 
vœtu®
 
	$»sume
(è{ (0); 
	}
};

179 
vœtu®
 
w_rc_t
 
	$Ãwrun
(è{ (
RCOK
); 
	}
};

181 
vœtu®
 
po¡_š™
();

182 
vœtu®
 
w_rc_t
 
lßd_schema
();

184 
vœtu®
 
w_rc_t
 
lßd_ªd_»gi¡”_fids
();

186 
vœtu®
 
cÚf
();

187 
vœtu®
 
¡¬t
();

188 
vœtu®
 
¡İ
();

189 
vœtu®
 
	$šfo
() const;

190 
vœtu®
 
	`¡©i¡ics
();

192 
	`dump
();

194 
vœtu®
 
	`´št_throughput
(cÚ¡ 
iQu”›dSF
,

195 cÚ¡ 
iS´—d
,

196 cÚ¡ 
iNumOfTh»ads
,

197 cÚ¡ 
d–ay
,

198 cÚ¡ 
ulÚg_t
 
mioch
,

199 cÚ¡ 
avgıuu§ge
);

206 
w_rc_t
 
	`lßdd©a
();

207 
w_rc_t
 
	`w¬mup
();

208 
w_rc_t
 
	`check_cÚsi¡’cy
();

212 
	`DECLARE_TABLE
(
w¬ehou£_t
,
w¬ehou£_mª_im¶
,
w¬ehou£
);

213 
	`DECLARE_TABLE
(
di¡riù_t
,
di¡riù_mª_im¶
,
di¡riù
);

214 
	`DECLARE_TABLE
(
cu¡om”_t
,
cu¡om”_mª_im¶
,
cu¡om”
);

215 
	`DECLARE_TABLE
(
hi¡Üy_t
,
hi¡Üy_mª_im¶
,
hi¡Üy
);

216 
	`DECLARE_TABLE
(
Ãw_Üd”_t
,
Ãw_Üd”_mª_im¶
,
Ãw_Üd”
);

217 
	`DECLARE_TABLE
(
Üd”_t
,
Üd”_mª_im¶
,
Üd”
);

218 
	`DECLARE_TABLE
(
Üd”_lše_t
,
Üd”_lše_mª_im¶
,
Üd”_lše
);

219 
	`DECLARE_TABLE
(
™em_t
,
™em_mª_im¶
,
™em
);

220 
	`DECLARE_TABLE
(
¡ock_t
,
¡ock_mª_im¶
,
¡ock
);

225 
w_rc_t
 
	`run_Úe_xù
(
Reque¡
* 
´eque¡
);

227 
	`DECLARE_TRX
(
Ãw_Üd”
);

228 
	`DECLARE_TRX
(
·ym’t
);

229 
	`DECLARE_TRX
(
Üd”_¡©us
);

230 
	`DECLARE_TRX
(
d–iv”y
);

231 
	`DECLARE_TRX
(
¡ock_Ëv–
);

233 
	`DECLARE_TRX
(
mb’ch_wh
);

234 
	`DECLARE_TRX
(
mb’ch_cu¡
);

237 
	`DECLARE_TRX
(
pİuÏ‹_ba£lše
);

238 
	`DECLARE_TRX
(
pİuÏ‹_Úe_un™
);

241 
w_rc_t
 
	`_xù_d–iv”y_h–³r
(cÚ¡ 
xù_id
, 
d–iv”y_šput_t
& 
pdš
,

242 
¡d
::
veùÜ
<>& 
dli¡
, & 
d_id
,

243 cÚ¡ 
boŞ
 
SPLIT_TRX
);

246 
vœtu®
 
w_rc_t
 
	`upd©e_·¹™iÚšg
();

249 
vœtu®
 
	`’v_th»ad_š™
();

250 
vœtu®
 
	`’v_th»ad_fši
();

253 
¡©m­_t
 
_¡©m­
;

256 
ShÜeTPCCTrxSts
 
_Ï¡_¡©s
;

257 
vœtu®
 
	`»£t_¡©s
();

258 
ShÜeTPCCTrxSts
 
	`_g‘_¡©s
();

261 
	`£t_skew
(
¬—
, 
lßd
, 
¡¬t_imb®ªû
);

262 
	`¡¬t_lßd_imb®ªû
();

263 
	`»£t_skew
();

266 
w_rc_t
 
	`db_´št
(
lšes
);

269 
w_rc_t
 
	`db_ãtch
();

271 
	}
};

275 
EXIT_NAMESPACE
(
cc
);

	@include/workload/tpcc/shore_tpcc_schema.h

32 #iâdeà
__SHORE_TPCC_SCHEMA_H


33 
	#__SHORE_TPCC_SCHEMA_H


	)

36 
	~<m©h.h
>

38 
	~"sm_vas.h
"

39 
	~"ut.h
"

41 
	~"wÜklßd/cc/cc_cÚ¡.h
"

42 
	~"sm/shÜe/shÜe_bË_mª.h
"

44 
usšg
 
Çme¥aû
 
	gshÜe
;

47 
ENTER_NAMESPACE
(
cc
);

59 
DECLARE_TABLE_SCHEMA_PD
(
w¬ehou£_t
);

60 
DECLARE_TABLE_SCHEMA_PD
(
di¡riù_t
);

61 
DECLARE_TABLE_SCHEMA_PD
(
¡ock_t
);

62 
DECLARE_TABLE_SCHEMA_PD
(
Üd”_lše_t
);

63 
DECLARE_TABLE_SCHEMA_PD
(
cu¡om”_t
);

64 
DECLARE_TABLE_SCHEMA_PD
(
hi¡Üy_t
);

65 
DECLARE_TABLE_SCHEMA_PD
(
Üd”_t
);

66 
DECLARE_TABLE_SCHEMA_PD
(
Ãw_Üd”_t
);

67 
DECLARE_TABLE_SCHEMA_PD
(
™em_t
);

70 
EXIT_NAMESPACE
(
cc
);

	@include/workload/tpcc/shore_tpcc_schema_man.h

32 #iâdeà
__SHORE_TPCC_SCHEMA_MANAGER_H


33 
	#__SHORE_TPCC_SCHEMA_MANAGER_H


	)

36 
	~"wÜklßd/cc/cc_¡ruù.h
"

37 
	~"wÜklßd/cc/shÜe_cc_schema.h
"

39 
usšg
 
Çme¥aû
 
	gshÜe
;

42 
ENTER_NAMESPACE
(
cc
);

51 
şass
 
	gw¬ehou£_mª_im¶
 : 
public
 
bË_mª_im¶
<
w¬ehou£_t
>

53 
bË_row_t
 
	tw¬ehou£_tu¶e
;

55 
	gpublic
:

57 
w¬ehou£_mª_im¶
(
w¬ehou£_t
* 
aW¬ehou£Desc
)

58 : 
bË_mª_im¶
<
w¬ehou£_t
>(
aW¬ehou£Desc
)

61 ~
w¬ehou£_mª_im¶
() { }

64 
w_rc_t
 
wh_šdex_´obe
(
ss_m
* 
db
,

65 
w¬ehou£_tu¶e
* 
±u¶e
,

66 cÚ¡ 
w_id
);

68 
w_rc_t
 
wh_šdex_´obe_fÜupd©e
(
ss_m
* 
db
,

69 
w¬ehou£_tu¶e
* 
±u¶e
,

70 cÚ¡ 
w_id
);

72 
w_rc_t
 
wh_šdex_´obe_Æ
(
ss_m
* 
db
,

73 
w¬ehou£_tu¶e
* 
±u¶e
,

74 cÚ¡ 
w_id
);

78 
w_rc_t
 
wh_upd©e_ytd
(
ss_m
* 
db
,

79 
w¬ehou£_tu¶e
* 
±u¶e
,

80 cÚ¡ 
h_amouÁ
,

81 
lock_mode_t
 
lm
 = 
EX
);

83 
w_rc_t
 
wh_upd©e_ytd_Æ
(
ss_m
* 
db
,

84 
w¬ehou£_tu¶e
* 
±u¶e
,

85 cÚ¡ 
h_amouÁ
);

91 
şass
 
	gdi¡riù_mª_im¶
 : 
public
 
bË_mª_im¶
<
di¡riù_t
>

93 
bË_row_t
 
	tdi¡riù_tu¶e
;

95 
	gpublic
:

97 
di¡riù_mª_im¶
(
di¡riù_t
* 
aDi¡riùDesc
)

98 : 
bË_mª_im¶
<
di¡riù_t
>(
aDi¡riùDesc
)

101 ~
di¡riù_mª_im¶
() { }

104 
w_rc_t
 
di¡_šdex_´obe
(
ss_m
* 
db
,

105 
di¡riù_tu¶e
* 
±u¶e
,

106 cÚ¡ 
w_id
,

107 cÚ¡ 
d_id
);

109 
w_rc_t
 
di¡_šdex_´obe_fÜupd©e
(
ss_m
* 
db
,

110 
di¡riù_tu¶e
* 
±u¶e
,

111 cÚ¡ 
w_id
,

112 cÚ¡ 
d_id
);

114 
w_rc_t
 
di¡_šdex_´obe_Æ
(
ss_m
* 
db
,

115 
di¡riù_tu¶e
* 
±u¶e
,

116 cÚ¡ 
w_id
,

117 cÚ¡ 
d_id
);

121 
w_rc_t
 
di¡_upd©e_ytd
(
ss_m
* 
db
,

122 
di¡riù_tu¶e
* 
±u¶e
,

123 cÚ¡ 
h_amouÁ
,

124 
lock_mode_t
 
lm
 = 
EX
);

126 
w_rc_t
 
di¡_upd©e_ytd_Æ
(
ss_m
* 
db
,

127 
di¡riù_tu¶e
* 
±u¶e
,

128 cÚ¡ 
h_amouÁ
);

131 
w_rc_t
 
di¡_upd©e_Ãxt_o_id
(
ss_m
* 
db
,

132 
di¡riù_tu¶e
* 
±u¶e
,

133 cÚ¡ 
Ãxt_o_id
,

134 
lock_mode_t
 
lm
 = 
EX
);

136 
w_rc_t
 
di¡_upd©e_Ãxt_o_id_Æ
(
ss_m
* 
db
,

137 
di¡riù_tu¶e
* 
±u¶e
,

138 cÚ¡ 
Ãxt_o_id
);

144 
şass
 
	gcu¡om”_mª_im¶
 : 
public
 
bË_mª_im¶
<
cu¡om”_t
>

146 
bË_row_t
 
	tcu¡om”_tu¶e
;

147 
	gbË_sÿn_™”_im¶
<
	tcu¡om”_t
> 
	tcu¡om”_bË_™”
;

148 
	gšdex_sÿn_™”_im¶
<
	tcu¡om”_t
> 
	tcu¡om”_šdex_™”
;

150 
	gpublic
:

152 
cu¡om”_mª_im¶
(
cu¡om”_t
* 
aCu¡om”Desc
)

153 : 
bË_mª_im¶
<
cu¡om”_t
>(
aCu¡om”Desc
)

156 ~
cu¡om”_mª_im¶
() { }

159 
w_rc_t
 
cu¡_g‘_™”_by_šdex
(
ss_m
* 
db
,

160 
cu¡om”_šdex_™”
* &
™”
,

161 
cu¡om”_tu¶e
* 
±u¶e
,

162 
»p_row_t
 &
»¶ow
,

163 
»p_row_t
 &
»phigh
,

164 cÚ¡ 
w_id
,

165 cÚ¡ 
d_id
,

166 cÚ¡ * 
c_Ï¡
,

167 
lock_mode_t
 
®m
 = 
SH
,

168 
boŞ
 
Ãed_tu¶e
 = 
çl£
);

170 
w_rc_t
 
cu¡_g‘_™”_by_šdex_Æ
(
ss_m
* 
db
,

171 
cu¡om”_šdex_™”
* &
™”
,

172 
cu¡om”_tu¶e
* 
±u¶e
,

173 
»p_row_t
 &
»¶ow
,

174 
»p_row_t
 &
»phigh
,

175 cÚ¡ 
w_id
,

176 cÚ¡ 
d_id
,

177 cÚ¡ * 
c_Ï¡
,

178 
boŞ
 
Ãed_tu¶e
 = 
çl£
);

181 
w_rc_t
 
cu¡_šdex_´obe
(
ss_m
* 
db
,

182 
cu¡om”_tu¶e
* 
±u¶e
,

183 cÚ¡ 
w_id
,

184 cÚ¡ 
d_id
,

185 cÚ¡ 
c_id
);

187 
w_rc_t
 
cu¡_šdex_´obe_by_Çme
(
ss_m
* 
db
,

188 cÚ¡ * 
idx_Çme
,

189 
cu¡om”_tu¶e
* 
±u¶e
,

190 cÚ¡ 
w_id
,

191 cÚ¡ 
d_id
,

192 cÚ¡ 
c_id
);

194 
w_rc_t
 
cu¡_šdex_´obe_fÜupd©e
(
ss_m
* 
db
,

195 
cu¡om”_tu¶e
* 
±u¶e
,

196 cÚ¡ 
w_id
,

197 cÚ¡ 
d_id
,

198 cÚ¡ 
c_id
);

199 
w_rc_t
 
cu¡_šdex_´obe_Æ
(
ss_m
* 
db
,

200 
cu¡om”_tu¶e
* 
±u¶e
,

201 cÚ¡ 
w_id
,

202 cÚ¡ 
d_id
,

203 cÚ¡ 
c_id
);

207 
w_rc_t
 
cu¡_upd©e_tu¶e
(
ss_m
* 
db
,

208 
cu¡om”_tu¶e
* 
±u¶e
,

209 cÚ¡ 
cc_cu¡om”_tu¶e
& 
acu¡om”
,

210 cÚ¡ * 
ad©a1
 = 
NULL
,

211 cÚ¡ * 
ad©a2
 = 
NULL
,

212 
lock_mode_t
 
lm
 = 
EX
);

214 
w_rc_t
 
cu¡_upd©e_tu¶e_Æ
(
ss_m
* 
db
,

215 
cu¡om”_tu¶e
* 
±u¶e
,

216 cÚ¡ 
cc_cu¡om”_tu¶e
& 
acu¡om”
,

217 cÚ¡ * 
ad©a1
 = 
NULL
,

218 cÚ¡ * 
ad©a2
 = 
NULL
);

221 
w_rc_t
 
cu¡_upd©e_discouÁ_b®ªû
(
ss_m
* 
db
,

222 
cu¡om”_tu¶e
* 
±u¶e
,

223 cÚ¡ 
decim®
 
discouÁ
,

224 cÚ¡ 
decim®
 
b®ªû
,

225 
lock_mode_t
 
lm
 = 
EX
);

227 
w_rc_t
 
cu¡_upd©e_discouÁ_b®ªû_Æ
(
ss_m
* 
db
,

228 
cu¡om”_tu¶e
* 
±u¶e
,

229 cÚ¡ 
decim®
 
discouÁ
,

230 cÚ¡ 
decim®
 
b®ªû
);

237 
şass
 
	ghi¡Üy_mª_im¶
 : 
public
 
bË_mª_im¶
<
hi¡Üy_t
>

239 
bË_row_t
 
	thi¡Üy_tu¶e
;

241 
	gpublic
:

243 
hi¡Üy_mª_im¶
(
hi¡Üy_t
* 
aHi¡ÜyDesc
)

244 : 
bË_mª_im¶
<
hi¡Üy_t
>(
aHi¡ÜyDesc
)

247 ~
hi¡Üy_mª_im¶
() { }

252 
şass
 
	gÃw_Üd”_mª_im¶
 : 
public
 
bË_mª_im¶
<
Ãw_Üd”_t
>

254 
bË_row_t
 
	tÃw_Üd”_tu¶e
;

255 
	gbË_sÿn_™”_im¶
<
	tÃw_Üd”_t
> 
	tÃw_Üd”_bË_™”
;

256 
	gšdex_sÿn_™”_im¶
<
	tÃw_Üd”_t
> 
	tÃw_Üd”_šdex_™”
;

258 
	gpublic
:

260 
Ãw_Üd”_mª_im¶
(
Ãw_Üd”_t
* 
aNewOrd”Desc
)

261 : 
bË_mª_im¶
<
Ãw_Üd”_t
>(
aNewOrd”Desc
)

265 ~
Ãw_Üd”_mª_im¶
()

270 
w_rc_t
 
no_g‘_™”_by_šdex
(
ss_m
* 
db
,

271 
Ãw_Üd”_šdex_™”
* &
™”
,

272 
Ãw_Üd”_tu¶e
* 
±u¶e
,

273 
»p_row_t
 &
»¶ow
,

274 
»p_row_t
 &
»phigh
,

275 cÚ¡ 
w_id
,

276 cÚ¡ 
d_id
,

277 
lock_mode_t
 
®m
 = 
SH
,

278 
boŞ
 
Ãed_tu¶e
 = 
çl£
);

280 
w_rc_t
 
no_g‘_™”_by_šdex_Æ
(
ss_m
* 
db
,

281 
Ãw_Üd”_šdex_™”
* &
™”
,

282 
Ãw_Üd”_tu¶e
* 
±u¶e
,

283 
»p_row_t
 &
»¶ow
,

284 
»p_row_t
 &
»phigh
,

285 cÚ¡ 
w_id
,

286 cÚ¡ 
d_id
,

287 
boŞ
 
Ãed_tu¶e
 = 
çl£
);

290 
w_rc_t
 
no_d–‘e_by_šdex
(
ss_m
* 
db
,

291 
Ãw_Üd”_tu¶e
* 
±u¶e
,

292 cÚ¡ 
w_id
,

293 cÚ¡ 
d_id
,

294 cÚ¡ 
o_id
);

296 
w_rc_t
 
no_d–‘e_by_šdex_Æ
(
ss_m
* 
db
,

297 
Ãw_Üd”_tu¶e
* 
±u¶e
,

298 cÚ¡ 
w_id
,

299 cÚ¡ 
d_id
,

300 cÚ¡ 
o_id
);

305 
şass
 
	gÜd”_mª_im¶
 : 
public
 
bË_mª_im¶
<
Üd”_t
>

307 
bË_row_t
 
	tÜd”_tu¶e
;

308 
	gbË_sÿn_™”_im¶
<
	tÜd”_t
> 
	tÜd”_bË_™”
;

309 
	gšdex_sÿn_™”_im¶
<
	tÜd”_t
> 
	tÜd”_šdex_™”
;

311 
	gpublic
:

313 
Üd”_mª_im¶
(
Üd”_t
* 
aOrd”Desc
)

314 : 
bË_mª_im¶
<
Üd”_t
>(
aOrd”Desc
)

318 ~
Üd”_mª_im¶
()

323 
w_rc_t
 
Üd_g‘_™”_by_šdex
(
ss_m
* 
db
,

324 
Üd”_šdex_™”
* &
™”
,

325 
Üd”_tu¶e
* 
±u¶e
,

326 
»p_row_t
 &
»¶ow
,

327 
»p_row_t
 &
»phigh
,

328 cÚ¡ 
w_id
,

329 cÚ¡ 
d_id
,

330 cÚ¡ 
c_id
,

331 
lock_mode_t
 
®m
 = 
SH
,

332 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

334 
w_rc_t
 
Üd_g‘_™”_by_šdex_Æ
(
ss_m
* 
db
,

335 
Üd”_šdex_™”
* &
™”
,

336 
Üd”_tu¶e
* 
±u¶e
,

337 
»p_row_t
 &
»¶ow
,

338 
»p_row_t
 &
»phigh
,

339 cÚ¡ 
w_id
,

340 cÚ¡ 
d_id
,

341 cÚ¡ 
c_id
,

342 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

345 
w_rc_t
 
Üd_upd©e_ÿ¼›r_by_šdex
(
ss_m
* 
db
,

346 
Üd”_tu¶e
* 
±u¶e
,

347 cÚ¡ 
ÿ¼›r_id
);

349 
w_rc_t
 
Üd_upd©e_ÿ¼›r_by_šdex_Æ
(
ss_m
* 
db
,

350 
Üd”_tu¶e
* 
±u¶e
,

351 cÚ¡ 
ÿ¼›r_id
);

357 
şass
 
	gÜd”_lše_mª_im¶
 : 
public
 
bË_mª_im¶
<
Üd”_lše_t
>

359 
bË_row_t
 
	tÜd”_lše_tu¶e
;

360 
	gbË_sÿn_™”_im¶
<
	tÜd”_lše_t
> 
	tÜd”_lše_bË_™”
;

361 
	gšdex_sÿn_™”_im¶
<
	tÜd”_lše_t
> 
	tÜd”_lše_šdex_™”
;

363 
	gpublic
:

365 
Üd”_lše_mª_im¶
(
Üd”_lše_t
* 
aOrd”LšeDesc
)

366 : 
bË_mª_im¶
<
Üd”_lše_t
>(
aOrd”LšeDesc
)

370 ~
Üd”_lše_mª_im¶
()

375 
w_rc_t
 
Ş_g‘_¿nge_™”_by_šdex
(
ss_m
* 
db
,

376 
Üd”_lše_šdex_™”
* &
™”
,

377 
Üd”_lše_tu¶e
* 
±u¶e
,

378 
»p_row_t
 &
»¶ow
,

379 
»p_row_t
 &
»phigh
,

380 cÚ¡ 
w_id
,

381 cÚ¡ 
d_id
,

382 cÚ¡ 
low_o_id
,

383 cÚ¡ 
high_o_id
,

384 
lock_mode_t
 
®m
 = 
SH
,

385 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

387 
w_rc_t
 
Ş_g‘_¿nge_™”_by_šdex_Æ
(
ss_m
* 
db
,

388 
Üd”_lše_šdex_™”
* &
™”
,

389 
Üd”_lše_tu¶e
* 
±u¶e
,

390 
»p_row_t
 &
»¶ow
,

391 
»p_row_t
 &
»phigh
,

392 cÚ¡ 
w_id
,

393 cÚ¡ 
d_id
,

394 cÚ¡ 
low_o_id
,

395 cÚ¡ 
high_o_id
,

396 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

398 
w_rc_t
 
Ş_g‘_´obe_™”_by_šdex
(
ss_m
* 
db
,

399 
Üd”_lše_šdex_™”
* &
™”
,

400 
Üd”_lše_tu¶e
* 
±u¶e
,

401 
»p_row_t
 &
»¶ow
,

402 
»p_row_t
 &
»phigh
,

403 cÚ¡ 
w_id
,

404 cÚ¡ 
d_id
,

405 cÚ¡ 
o_id
,

406 
lock_mode_t
 
®m
 = 
SH
,

407 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

409 
w_rc_t
 
Ş_g‘_´obe_™”_by_šdex_Æ
(
ss_m
* 
db
,

410 
Üd”_lše_šdex_™”
* &
™”
,

411 
Üd”_lše_tu¶e
* 
±u¶e
,

412 
»p_row_t
 &
»¶ow
,

413 
»p_row_t
 &
»phigh
,

414 cÚ¡ 
w_id
,

415 cÚ¡ 
d_id
,

416 cÚ¡ 
o_id
,

417 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

423 
şass
 
	g™em_mª_im¶
 : 
public
 
bË_mª_im¶
<
™em_t
>

425 
bË_row_t
 
	t™em_tu¶e
;

426 
	gbË_sÿn_™”_im¶
<
	t™em_t
> 
	t™em_bË_™”
;

427 
	gšdex_sÿn_™”_im¶
<
	t™em_t
> 
	t™em_šdex_™”
;

429 
	gpublic
:

431 
™em_mª_im¶
(
™em_t
* 
aI‹mDesc
)

432 : 
bË_mª_im¶
<
™em_t
>(
aI‹mDesc
)

436 ~
™em_mª_im¶
()

441 
w_rc_t
 
™_šdex_´obe
(
ss_m
* 
ddb
,

442 
™em_tu¶e
* 
±u¶e
,

443 cÚ¡ 
i_id
);

445 
w_rc_t
 
™_šdex_´obe_fÜupd©e
(
ss_m
* 
db
,

446 
™em_tu¶e
* 
±u¶e
,

447 cÚ¡ 
i_id
);

449 
w_rc_t
 
™_šdex_´obe_Æ
(
ss_m
* 
db
,

450 
™em_tu¶e
* 
±u¶e
,

451 cÚ¡ 
i_id
);

457 
şass
 
	g¡ock_mª_im¶
 : 
public
 
bË_mª_im¶
<
¡ock_t
>

459 
bË_row_t
 
	t¡ock_tu¶e
;

460 
	gbË_sÿn_™”_im¶
<
	t¡ock_t
> 
	t¡ock_bË_™”
;

461 
	gšdex_sÿn_™”_im¶
<
	t¡ock_t
> 
	t¡ock_šdex_™”
;

463 
	gpublic
:

465 
¡ock_mª_im¶
(
¡ock_t
* 
aStockDesc
)

466 : 
bË_mª_im¶
<
¡ock_t
>(
aStockDesc
)

470 ~
¡ock_mª_im¶
()

475 
w_rc_t
 
¡_šdex_´obe
(
ss_m
* 
db
,

476 
¡ock_tu¶e
* 
±u¶e
,

477 cÚ¡ 
w_id
,

478 cÚ¡ 
i_id
);

480 
w_rc_t
 
¡_šdex_´obe_fÜupd©e
(
ss_m
* 
db
,

481 
¡ock_tu¶e
* 
±u¶e
,

482 cÚ¡ 
w_id
,

483 cÚ¡ 
i_id
);

485 
w_rc_t
 
¡_šdex_´obe_Æ
(
ss_m
* 
db
,

486 
¡ock_tu¶e
* 
±u¶e
,

487 cÚ¡ 
w_id
,

488 cÚ¡ 
i_id
);

491 
w_rc_t
 
¡_upd©e_tu¶e
(
ss_m
* 
db
,

492 
¡ock_tu¶e
* 
±u¶e
,

493 cÚ¡ 
cc_¡ock_tu¶e
* 
p¡ock
,

494 
lock_mode_t
 
lm
 = 
EX
);

496 
w_rc_t
 
¡_upd©e_tu¶e_Æ
(
ss_m
* 
db
,

497 
¡ock_tu¶e
* 
±u¶e
,

498 cÚ¡ 
cc_¡ock_tu¶e
* 
p¡ock
);

503 
EXIT_NAMESPACE
(
cc
);

	@include/workload/tpcc/tpcc_const.h

32 #iâdeà
__TPCC_CONST_H


33 
	#__TPCC_CONST_H


	)

36 
	~"ut/Çme¥aû.h
"

39 
ENTER_NAMESPACE
(
cc
);

42 cÚ¡ 
	gTPCC_C_LAST_SZ
 = 16;

43 cÚ¡ 
	gTPCC_C_FIRST_SZ
 = 16;

49 cÚ¡ 
	gDISTRICTS_PER_WAREHOUSE
 = 10;

50 cÚ¡ 
	gCUSTOMERS_PER_DISTRICT
 = 3000;

51 cÚ¡ 
	gITEMS
 = 100000;

52 cÚ¡ 
	gSTOCK_PER_WAREHOUSE
 = 
ITEMS
;

53 cÚ¡ 
	gMIN_OL_PER_ORDER
 = 5;

54 cÚ¡ 
	gMAX_OL_PER_ORDER
 = 15;

55 cÚ¡ 
	gNU_ORDERS_PER_DISTRICT
 = 900;

57 cÚ¡ 
	gMAX_TABLENAM_LENGTH
 = 20;

58 cÚ¡ 
	gMAX_RECORD_LENGTH
 = 512;

63 cÚ¡ 
	gTPCC_WAREHOUSE_FCOUNT
 = 9;

64 cÚ¡ 
	gTPCC_DISTRICT_FCOUNT
 = 11;

65 cÚ¡ 
	gTPCC_CUSTOMER_FCOUNT
 = 22;

66 cÚ¡ 
	gTPCC_HISTORY_FCOUNT
 = 8;

67 cÚ¡ 
	gTPCC_NEW_ORDER_FCOUNT
 = 3;

68 cÚ¡ 
	gTPCC_ORDER_FCOUNT
 = 8;

69 cÚ¡ 
	gTPCC_ORDER_LINE_FCOUNT
 = 10;

70 cÚ¡ 
	gTPCC_ITEM_FCOUNT
 = 5;

71 cÚ¡ 
	gTPCC_STOCK_FCOUNT
 = 17;

75 cÚ¡ 
	gSHORE_TPCC_TABLES
 = 9;

83 cÚ¡ 
	gXCT_MIX
 = 0;

84 cÚ¡ 
	gXCT_NEW_ORDER
 = 1;

85 cÚ¡ 
	gXCT_PAYMENT
 = 2;

86 cÚ¡ 
	gXCT_ORDER_STATUS
 = 3;

87 cÚ¡ 
	gXCT_DELIVERY
 = 4;

88 cÚ¡ 
	gXCT_STOCK_LEVEL
 = 5;

90 cÚ¡ 
	gXCT_LITTLE_MIX
 = 9;

93 cÚ¡ 
	gXCT_MBENCH_WH
 = 11;

94 cÚ¡ 
	gXCT_MBENCH_CUST
 = 12;

99 cÚ¡ 
	gPROB_NEWORDER
 = 45;

100 cÚ¡ 
	gPROB_PAYMENT
 = 43;

101 cÚ¡ 
	gPROB_ORDER_STATUS
 = 4;

102 cÚ¡ 
	gPROB_DELIVERY
 = 4;

103 cÚ¡ 
	gPROB_STOCK_LEVEL
 = 4;

110 
¿ndom_xù_ty³
(
£Ëùed
);

113 
EXIT_NAMESPACE
(
cc
);

	@include/workload/tpcc/tpcc_input.h

32 #iâdeà
__TPCC_INPUT_H


33 
	#__TPCC_INPUT_H


	)

35 
	~"wÜklßd/cc/cc_cÚ¡.h
"

36 
	~"wÜklßd/cc/cc_¡ruù.h
"

39 
ENTER_NAMESPACE
(
cc
);

43 
skew”_t
 
w_skew”
;

44 
boŞ
 
_chªge_lßd
;

58 
	gno_™em_nÜd_šput_t
;

59 
	gw™h_™em_nÜd_šput_t
;

61 
	sŞ_™em_šfo


63 
	m_Ş_i_id
;

64 
	m_Ş_suµly_wh_£Ëù
;

65 
	m_Ş_suµly_wh_id
;

66 
	m_Ş_quªt™y
;

68 
	m_™em_amouÁ
;

70 
cc_¡ock_tu¶e
 
	m_a¡ock
;

71 
cc_™em_tu¶e
 
	m_a™em
;

74 
	mŞ_™em_šfo
& 
	mİ”©Ü
ğ(cÚ¡ 
Ş_™em_šfo
& 
rhs
);

79 
	sÃw_Üd”_šput_t


81 
	m_wh_id
;

82 
	m_d_id
;

83 
	m_c_id
;

84 
	m_Ş_út
;

85 
	m_rbk
;

87 
time_t
 
	m_t¡amp
;

88 
	m_®l_loÿl
;

89 
	m_d_Ãxt_o_id
;

91 
cc_w¬ehou£_tu¶e
 
	m_awh
;

92 
cc_cu¡om”_tu¶e
 
	m_acu¡
;

93 
cc_di¡riù_tu¶e
 
	m_adi¡
;

95 
Ş_™em_šfo
 
	m™ems
[
MAX_OL_PER_ORDER
];

100 
Ãw_Üd”_šput_t
()

101 : 
_wh_id
(0), 
_d_id
(0), 
_c_id
(0), 
_Ş_út
(0), 
_rbk
(0), 
_t¡amp
(0), 
_®l_loÿl
(1), 
_d_Ãxt_o_id
(-1)

104 ~
Ãw_Üd”_šput_t
() { };

107 
	mÃw_Üd”_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
Ãw_Üd”_šput_t
& 
rhs
);

110 
g‘_no_™em_šput
(
no_™em_nÜd_šput_t
& 
ªoš
);

111 
g‘_w™h_™em_šput
(
w™h_™em_nÜd_šput_t
& 
awš
, cÚ¡ 
idx
);

123 
	sno_™em_nÜd_šput_t


125 
	m_wh_id
;

126 
	m_d_id
;

127 
	m_c_id
;

128 
	m_Ş_út
;

129 
	m_rbk
;

131 
time_t
 
	m_t¡amp
;

132 
	m_®l_loÿl
;

133 
	m_d_Ãxt_o_id
;

136 
	mno_™em_nÜd_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
no_™em_nÜd_šput_t
& 
rhs
);

141 
	sw™h_™em_nÜd_šput_t


143 
	m_wh_id
;

144 
	m_d_id
;

145 
	m_c_id
;

146 
	m_Ş_út
;

147 
	m_rbk
;

149 
time_t
 
	m_t¡amp
;

150 
	m_®l_loÿl
;

151 
	m_d_Ãxt_o_id
;

153 
	m_Ş_idx
;

155 
Ş_™em_šfo
 
	m™em
;

158 
	mw™h_™em_nÜd_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
w™h_™em_nÜd_šput_t
& 
rhs
);

171 
	s·ym’t_šput_t


188 
	m_home_wh_id
;

189 
	m_home_d_id
;

190 
	m_v_cu¡_wh_£ËùiÚ
;

191 
	m_»mÙe_wh_id
;

192 
	m_»mÙe_d_id
;

193 
	m_v_cu¡_id’t_£ËùiÚ
;

194 
	m_c_id
;

195 
	m_c_Ï¡
[16];

196 
	m_h_amouÁ
;

197 
	m_h_d©e
;

200 
·ym’t_šput_t
()

201 : 
_home_wh_id
(0), 
_home_d_id
(0), 
_v_cu¡_wh_£ËùiÚ
(0),

202 
_»mÙe_wh_id
(0), 
_»mÙe_d_id
(0), 
_v_cu¡_id’t_£ËùiÚ
(0),

203 
_c_id
(0), 
_h_amouÁ
(0), 
_h_d©e
(0)

205 
mem£t
(
_c_Ï¡
, '\0', 16);

208 ~
·ym’t_šput_t
() { };

210 
	m·ym’t_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
·ym’t_šput_t
& 
rhs
);

224 
	sÜd”_¡©us_šput_t


226 
	m_wh_id
;

227 
	m_d_id
;

228 
	m_c_£Ëù
;

229 
	m_c_id
;

230 
	m_c_Ï¡
[16];

233 
	m_o_id
;

234 
	m_o_Ş_út
;

238 
Üd”_¡©us_šput_t
()

239 : 
_wh_id
(0), 
_d_id
(0), 
_c_£Ëù
(0), 
_c_id
(0),

240 
_o_id
(0), 
_o_Ş_út
(0)

242 
mem£t
(
_c_Ï¡
, '\0', 16);

245 ~
Üd”_¡©us_šput_t
() { };

248 
	mÜd”_¡©us_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
Üd”_¡©us_šput_t
& 
rhs
);

262 
	sd–iv”y_šput_t


264 
	m_wh_id
;

265 
	m_ÿ¼›r_id
;

269 
d–iv”y_šput_t
()

270 : 
_wh_id
(0),
_ÿ¼›r_id
(0)

273 ~
d–iv”y_šput_t
() { };

277 
	md–iv”y_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
d–iv”y_šput_t
& 
rhs
);

291 
	gveùÜ
<
	t·œ
<,> > 
	tTwoIÁVec
;

292 
	gTwoIÁVec
::
	t™”©Ü
 
	tTwoIÁVecIt
;

294 
	s¡ock_Ëv–_šput_t


296 
	m_wh_id
;

297 
	m_d_id
;

298 
	m_th»shŞd
;

301 
	m_Ãxt_o_id
;

302 
	m_o_Ş_út
;

303 
TwoIÁVec
* 
	m_pvwi
;

307 
¡ock_Ëv–_šput_t
()

308 : 
_wh_id
(0), 
_d_id
(0), 
_th»shŞd
(0),

309 
_o_Ş_út
(0), 
_pvwi
(
NULL
)

313 ~
¡ock_Ëv–_šput_t
() { };

317 
	m¡ock_Ëv–_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
¡ock_Ëv–_šput_t
& 
rhs
);

331 
	smb’ch_wh_šput_t


333 
	m_wh_id
;

334 
	m_amouÁ
;

337 
mb’ch_wh_šput_t
()

338 : 
_wh_id
(0), 
_amouÁ
(0)

341 ~
mb’ch_wh_šput_t
() { };

344 
	mmb’ch_wh_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
mb’ch_wh_šput_t
& 
rhs
);

358 
	smb’ch_cu¡_šput_t


360 
	m_wh_id
;

361 
	m_d_id
;

362 
	m_c_id
;

363 
	m_amouÁ
;

366 
mb’ch_cu¡_šput_t
()

367 : 
_wh_id
(0), 
_d_id
(0), 
_c_id
(0), 
_amouÁ
(0)

370 ~
mb’ch_cu¡_šput_t
() { };

373 
	mmb’ch_cu¡_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
mb’ch_cu¡_šput_t
& 
rhs
);

387 
	spİuÏ‹_ba£lše_šput_t


389 
	m_wh
;

392 
	spİuÏ‹_Úe_un™_šput_t


394 
	m_un™
;

395 * 
	m_cids
;

411 
·ym’t_šput_t
 
ü—‹_·ym’t_šput
(
sf
,

412 
¥ecificWH
 = 0);

414 
Ãw_Üd”_šput_t
 
ü—‹_Ãw_Üd”_šput
(
sf
,

415 
¥ecificWH
 = 0);

417 
Üd”_¡©us_šput_t
 
ü—‹_Üd”_¡©us_šput
(
sf
,

418 
¥ecificWH
 = 0);

420 
d–iv”y_šput_t
 
ü—‹_d–iv”y_šput
(
sf
,

421 
¥ecificWH
 = 0);

423 
¡ock_Ëv–_šput_t
 
ü—‹_¡ock_Ëv–_šput
(
sf
,

424 
¥ecificWH
 = 0);

426 
mb’ch_wh_šput_t
 
ü—‹_mb’ch_wh_šput
(
sf
,

427 
¥ecificWH
 = 0);

429 
mb’ch_cu¡_šput_t
 
ü—‹_mb’ch_cu¡_šput
(
sf
,

430 
¥ecificWH
 = 0);

437 
EXIT_NAMESPACE
(
cc
);

	@include/workload/tpcc/tpcc_random.h

32 #iâdeà
__TPCC_COMMON_H


33 
	#__TPCC_COMMON_H


	)

35 
	~"ut.h
"

38 
ENTER_NAMESPACE
(
cc
);

52 
NURªd
(
A
, 
low
, 
high
);

54 
g’”©e_cu¡_Ï¡
(
£Ëù
, * 
de¡
);

56 
EXIT_NAMESPACE
(
cc
);

	@include/workload/tpcc/tpcc_struct.h

32 #iâdeà
__TPCC_STRUCT_H


33 
	#__TPCC_STRUCT_H


	)

35 
	~<c¡dlib
>

36 
	~<uni¡d.h
>

37 
	~<sys/time.h
>

38 
	~"ut.h
"

41 
ENTER_NAMESPACE
(
cc
);

45 
	#STRSIZE
(
x
)(x+1)

	)

54 
	scc_cu¡om”_tu¶e
 {

55 
	mC_C_ID
;

56 
	mC_D_ID
;

57 
	mC_W_ID
;

58 
	mC_FIRST
 [
STRSIZE
(16)];

59 
	mC_MIDDLE
 [
STRSIZE
(2)];

60 
	mC_LAST
 [
STRSIZE
(16)];

61 
	mC_STREET_1
 [
STRSIZE
(20)];

62 
	mC_STREET_2
 [
STRSIZE
(20)];

63 
	mC_CITY
 [
STRSIZE
(20)];

64 
	mC_STATE
 [
STRSIZE
(2)];

65 
	mC_ZIP
 [
STRSIZE
(9)];

66 
	mC_PHONE
 [
STRSIZE
(16)];

67 
time_t
 
	mC_SINCE
;

68 
	mC_CREDIT
 [
STRSIZE
(2)];

69 
decim®
 
	mC_CREDIT_LIM
;

70 
decim®
 
	mC_DISCOUNT
;

71 
decim®
 
	mC_BALANCE
;

72 
decim®
 
	mC_YTD_PAYMENT
;

73 
decim®
 
	mC_LAST_PAYMENT
;

74 
	mC_PAYMENT_CNT
;

75 
	mC_DATA_1
 [
STRSIZE
(250)];

76 
	mC_DATA_2
 [
STRSIZE
(250)];

78 
c_¡r
 
tu¶e_to_¡r
() {

79 (
c_¡r
("CUST = %d|%d|%d|%s|%s|%s|%s|%s|%s|%s|%s|%s|%.2f|%s -",

80 
C_C_ID
, 
C_D_ID
, 
C_W_ID
, 
C_FIRST
, 
C_MIDDLE
, 
C_LAST
,

81 
C_STREET_1
, 
C_STREET_2
, 
C_CITY
, 
C_STATE
, 
C_ZIP
,

82 
C_PHONE
, 
C_SINCE
, 
C_CREDIT
));

89 
	scc_cu¡om”_tu¶e_key
 {

90 
	mC_C_ID
;

91 
	mC_D_ID
;

92 
	mC_W_ID
;

94 
boŞ
 
	mİ”©Ü
==(cÚ¡ 
cc_cu¡om”_tu¶e_key
& 
rhs
) const {

95  ((
C_C_ID
 =ğ
rhs
.C_C_ID) &&

96 (
C_D_ID
 =ğ
rhs
.C_D_ID) &&

97 (
C_W_ID
 =ğ
rhs
.C_W_ID));

100 
boŞ
 
	mİ”©Ü
<(cÚ¡ 
	mcc_cu¡om”_tu¶e_key
& 
	mrhs
) const {

101 ià((
	mC_C_ID
 < 
	mrhs
.C_C_ID) ||

102 ((
	mC_C_ID
 =ğ
rhs
.
C_C_ID
è&& (
C_D_ID
 <„hs.C_D_ID)) ||

103 ((
C_C_ID
 =ğ
rhs
.C_C_IDè&& (
C_D_ID
 =ğrhs.C_D_IDè&& (
C_W_ID
 <„hs.C_W_ID)))

104  (
Œue
);

106  (
	mçl£
);

111 
	scc_cu¡om”_tu¶e_body
 {

112 
	mC_FIRST
 [
STRSIZE
(16)];

113 
	mC_MIDDLE
 [
STRSIZE
(2)];

114 
	mC_LAST
 [
STRSIZE
(16)];

115 
	mC_STREET_1
 [
STRSIZE
(20)];

116 
	mC_STREET_2
 [
STRSIZE
(20)];

117 
	mC_CITY
 [
STRSIZE
(20)];

118 
	mC_STATE
 [
STRSIZE
(2)];

119 
	mC_ZIP
 [
STRSIZE
(9)];

120 
	mC_PHONE
 [
STRSIZE
(16)];

121 
time_t
 
	mC_SINCE
;

122 
	mC_CREDIT
 [
STRSIZE
(2)];

123 
decim®
 
	mC_CREDIT_LIM
;

124 
decim®
 
	mC_DISCOUNT
;

125 
decim®
 
	mC_BALANCE
;

126 
decim®
 
	mC_YTD_PAYMENT
;

127 
decim®
 
	mC_LAST_PAYMENT
;

128 
	mC_PAYMENT_CNT
;

129 
	mC_DATA_1
 [
STRSIZE
(250)];

130 
	mC_DATA_2
 [
STRSIZE
(250)];

136 
	scc_di¡riù_tu¶e
 {

137 
	mD_ID
;

138 
	mD_W_ID
;

139 
	mD_NAME
 [
STRSIZE
(10)];

140 
	mD_STREET_1
 [
STRSIZE
(20)];

141 
	mD_STREET_2
 [
STRSIZE
(20)];

142 
	mD_CITY
 [
STRSIZE
(20)];

143 
	mD_STATE
 [
STRSIZE
(2)];

144 
	mD_ZIP
 [
STRSIZE
(9)];

145 
decim®
 
	mD_TAX
;

146 
decim®
 
	mD_YTD
;

147 
	mD_NEXT_O_ID
;

150 
c_¡r
 
tu¶e_to_¡r
() {

151 (
c_¡r
("DISTR = %d|%d|%s|%s|%s|%s|%s|%s|%.2f|%.2f|%d",

152 
D_ID
, 
D_W_ID
, 
D_NAME
, 
D_STREET_1
, 
D_STREET_2
,

153 
D_CITY
, 
D_STATE
, 
D_ZIP
,

154 
D_TAX
.
to_doubË
(), 
D_YTD
.to_doubË(), 
D_NEXT_O_ID
));

160 
	scc_di¡riù_tu¶e_key
 {

161 
	mD_ID
;

162 
	mD_W_ID
;

169 
	scc_hi¡Üy_tu¶e
 {

170 
	mH_C_ID
;

171 
	mH_C_D_ID
;

172 
	mH_C_W_ID
;

173 
	mH_D_ID
;

174 
	mH_W_ID
;

175 
time_t
 
	mH_DATE
;

176 
decim®
 
	mH_AMOUNT
;

177 
	mH_DATA
 [
STRSIZE
(25)];

179 
c_¡r
 
tu¶e_to_¡r
() {

180 (
c_¡r
("HIST = %d|%d|%d|%d|%d|%.2f|%.2f|%s",

181 
H_C_ID
, 
H_C_D_ID
, 
H_C_W_ID
, 
H_D_ID
,

182 
H_W_ID
, 
H_DATE
, 
H_AMOUNT
.
to_doubË
(),

183 
H_DATA
));

189 
	scc_hi¡Üy_tu¶e_key
 {

190 
	mH_C_ID
;

191 
	mH_C_D_ID
;

192 
	mH_C_W_ID
;

193 
	mH_D_ID
;

194 
	mH_W_ID
;

195 
time_t
 
	mH_DATE
;

197 
boŞ
 
	mİ”©Ü
==(cÚ¡ 
cc_hi¡Üy_tu¶e_key
& 
rhs
) const {

198  ((
H_C_ID
 =ğ
rhs
.H_C_ID) &&

199 (
H_C_D_ID
 =ğ
rhs
.H_C_D_ID) &&

200 (
H_C_W_ID
 =ğ
rhs
.H_C_W_ID) &&

201 (
H_D_ID
 =ğ
rhs
.H_D_ID) &&

202 (
H_W_ID
 =ğ
rhs
.H_W_ID) &&

203 (
H_DATE
 =ğ
rhs
.H_DATE));

206 
boŞ
 
	mİ”©Ü
<(cÚ¡ 
	mcc_hi¡Üy_tu¶e_key
& 
	mrhs
) const {

207 ià((
	mH_C_ID
 < 
	mrhs
.H_C_ID) ||

208 ((
	mH_C_ID
 =ğ
rhs
.
H_C_ID
è&& (
H_C_D_ID
 <„hs.H_C_D_ID)) ||

209 ((
H_C_ID
 =ğ
rhs
.H_C_IDè&& (
H_C_D_ID
 ==„hs.H_C_D_ID) &&

210 (
H_C_W_ID
 < 
rhs
.H_C_W_ID)) ||

211 ((
H_C_ID
 =ğ
rhs
.H_C_IDè&& (
H_C_D_ID
 ==„hs.H_C_D_ID) &&

212 (
H_C_W_ID
 =ğ
rhs
.H_C_W_IDè&& (
H_D_ID
 <„hs.H_D_ID)) ||

213 ((
H_C_ID
 =ğ
rhs
.H_C_IDè&& (
H_C_D_ID
 ==„hs.H_C_D_ID) &&

214 (
H_C_W_ID
 =ğ
rhs
.H_C_W_IDè&& (
H_D_ID
 ==„hs.H_D_ID) &&

215 (
H_W_ID
 < 
rhs
.H_W_ID)) ||

216 ((
H_C_ID
 =ğ
rhs
.H_C_IDè&& (
H_C_D_ID
 ==„hs.H_C_D_ID) &&

217 (
H_C_W_ID
 =ğ
rhs
.H_C_W_IDè&& (
H_D_ID
 ==„hs.H_D_ID) &&

218 (
H_W_ID
 =ğ
rhs
.H_W_IDè&& (
H_DATE
 ==„hs.H_DATE))

220  (
Œue
);

222  (
	mçl£
);

227 
	scc_hi¡Üy_tu¶e_body
 {

228 
decim®
 
	mH_AMOUNT
;

229 
	mH_DATA
 [
STRSIZE
(25)];

235 
	scc_™em_tu¶e
 {

236 
	mI_ID
;

237 
	mI_IM_ID
;

238 
	mI_NAME
 [
STRSIZE
(24)];

239 
	mI_PRICE
;

240 
	mI_DATA
 [
STRSIZE
(50)];

245 
	scc_™em_tu¶e_key
 {

246 
	mI_ID
;

253 
	scc_Ãw_Üd”_tu¶e
 {

254 
	mNO_O_ID
;

255 
	mNO_D_ID
;

256 
	mNO_W_ID
;

262 
	scc_Üd”_tu¶e
 {

263 
	mO_ID
;

264 
	mO_C_ID
;

265 
	mO_D_ID
;

266 
	mO_W_ID
;

267 
time_t
 
	mO_ENTRY_D
;

268 
	mO_CARRIER_ID
;

269 
	mO_OL_CNT
;

270 
	mO_ALL_LOCAL
;

274 
	scc_Üd”_tu¶e_key
 {

275 
	mO_ID
;

276 
	mO_C_ID
;

277 
	mO_D_ID
;

278 
	mO_W_ID
;

282 
	scc_Üd”_tu¶e_body
 {

283 
time_t
 
	mO_ENTRY_D
;

284 
	mO_CARRIER_ID
;

285 
	mO_OL_CNT
;

286 
	mO_ALL_LOCAL
;

294 
	scc_Üd”lše_tu¶e
 {

295 
	mOL_O_ID
;

296 
	mOL_D_ID
;

297 
	mOL_W_ID
;

298 
	mOL_NUMBER
;

299 
	mOL_I_ID
;

300 
	mOL_SUPPLY_W_ID
;

301 
time_t
 
	mOL_DELIVERY_D
;

302 
	mOL_QUANTITY
;

303 
	mOL_AMOUNT
;

304 
	mOL_DIST_INFO
 [
STRSIZE
(25)];

308 
	scc_Üd”lše_tu¶e_key
 {

309 
	mOL_O_ID
;

310 
	mOL_D_ID
;

311 
	mOL_W_ID
;

312 
	mOL_NUMBER
;

316 
	scc_Üd”lše_tu¶e_body
 {

317 
	mOL_I_ID
;

318 
	mOL_SUPPLY_W_ID
;

319 
time_t
 
	mOL_DELIVERY_D
;

320 
	mOL_QUANTITY
;

321 
	mOL_AMOUNT
;

322 
	mOL_DIST_INFO
 [
STRSIZE
(25)];

329 
	scc_¡ock_tu¶e
 {

330 
	mS_I_ID
;

331 
	mS_W_ID
;

332 
	mS_REMOTE_CNT
;

333 
	mS_QUANTITY
;

334 
	mS_ORDER_CNT
;

335 
	mS_YTD
;

337 
	mS_DIST
[10][
STRSIZE
(24)];

340 
	mS_DIST_01
 [
STRSIZE
(24)];

341 
	mS_DIST_02
 [
STRSIZE
(24)];

342 
	mS_DIST_03
 [
STRSIZE
(24)];

343 
	mS_DIST_04
 [
STRSIZE
(24)];

344 
	mS_DIST_05
 [
STRSIZE
(24)];

345 
	mS_DIST_06
 [
STRSIZE
(24)];

346 
	mS_DIST_07
 [
STRSIZE
(24)];

347 
	mS_DIST_08
 [
STRSIZE
(24)];

348 
	mS_DIST_09
 [
STRSIZE
(24)];

349 
	mS_DIST_10
 [
STRSIZE
(24)];

352 
	mS_DATA
 [
STRSIZE
(50)];

356 
	scc_¡ock_tu¶e_key
 {

357 
	mS_I_ID
;

358 
	mS_W_ID
;

364 
	scc_w¬ehou£_tu¶e
 {

365 
	mW_ID
;

366 
	mW_NAME
 [
STRSIZE
(10)];

367 
	mW_STREET_1
 [
STRSIZE
(20)];

368 
	mW_STREET_2
 [
STRSIZE
(20)];

369 
	mW_CITY
 [
STRSIZE
(20)];

370 
	mW_STATE
 [
STRSIZE
(2)];

371 
	mW_ZIP
 [
STRSIZE
(9)];

372 
decim®
 
	mW_TAX
;

373 
decim®
 
	mW_YTD
;

375 
c_¡r
 
tu¶e_to_¡r
() {

376 (
c_¡r
("WH= %d|%s|%s|%s|%s|%s|%s|%.2f|%.2f",

377 
W_ID
, 
W_NAME
, 
W_STREET_1
, 
W_STREET_2
,

378 
W_CITY
, 
W_STATE
, 
W_ZIP
,

379 
W_TAX
.
to_doubË
(), 
W_YTD
.to_double()));

383 
	scc_w¬ehou£_tu¶e_key
 {

384 
	mW_ID
;

387 
EXIT_NAMESPACE
(
cc
);

	@include/workload/tpce/MEESUT.h

32 #iâdeà
MEE_SUT_H


33 
	#MEE_SUT_H


	)

35 
	~"sm/shÜe/shÜe_’v.h
"

36 
	~"sm/shÜe/shÜe_Œx_wÜk”.h
"

37 
	~"wÜklßd/û/eg’/MEESUTIÁ”çû.h
"

39 
usšg
 
Çme¥aû
 
	gTPCE
;

41 
ENTER_NAMESPACE
(
û
);

42 cÚ¡ 
	gmax_bufãr
 = 512000;

44 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

45 şas 
	cIÅutBufãr


47 
mcs_lock
 
	ma_lock
;

48 
T
* 
	mbufãr
[
max_bufãr
];

49 
	msize
, 
	mfœ¡
, 
	mÏ¡
;

51 
	mpublic
:

52 
	$IÅutBufãr
():
	`size
(0), 
	`fœ¡
(0), 
	$Ï¡
(0)

54 
boŞ
 
	$isEm±y
(){

56 
	`CRITICAL_SECTION
(
cs
, 
a_lock
);

58 if(
size
==0è 
Œue
;

61  
çl£
;

64 
	}
}

65 
T
* 
	$g‘
(){

67 
	`CRITICAL_SECTION
(
cs
, 
a_lock
);

68 ià(
size
==0è 
NULL
;

69 
T
* 
tmp
=
bufãr
[
fœ¡
];

70 
size
--;

71 
fœ¡
=(fœ¡+1)%
max_bufãr
;

73  
tmp
;

75 
	}
}

77 
	$put
(
T
* 
tmp
){

79 
	`CRITICAL_SECTION
(
cs
, 
a_lock
);

81 if(
size
 < 
max_bufãr
) {

82 
bufãr
[
Ï¡
]=
tmp
;

83 
Ï¡
=Öa¡+1)%
max_bufãr
;

84 
size
++;

87 
	}
}

90 
şass
 
	gMFBufãr
: 
public
 
IÅutBufãr
<
TM¬k‘F“dTxnIÅut
>{

93 
şass
 
	gTRBufãr
: 
public
 
IÅutBufãr
<
TT¿deResuÉTxnIÅut
>{

96 
MFBufãr
* 
M¬k‘F“dIÅutBufãr
;

97 
TRBufãr
* 
T¿deResuÉIÅutBufãr
;

100 şas 
	cCMEESUT
: 
public
 
CMEESUTIÁ”çû


102 
MFBufãr
* 
MFQueue
;

103 
TRBufãr
* 
	mTRQueue
;

105 
	mpublic
:

106 
	$£tMFQueue
(
MFBufãr
* 
p
){ 
MFQueue
 =…;}

107 
	$£tTRQueue
(
TRBufãr
* 
p
){ 
TRQueue
 =…;
	}
}

109 
boŞ
 
	$T¿deResuÉ
Ğ
PT¿deResuÉTxnIÅut
 
pTxnIÅut
 ) {

110 
PT¿deResuÉTxnIÅut
 
ŒIÅut
ğ
Ãw
 
	`TT¿deResuÉTxnIÅut
();

111 
	`memıy
(
ŒIÅut
, 
pTxnIÅut
, (
TT¿deResuÉTxnIÅut
));

112 
TRQueue
->
	`put
(
ŒIÅut
);

113  
Œue
;

114 
	}
}

116 
boŞ
 
	$M¬k‘F“d
Ğ
PM¬k‘F“dTxnIÅut
 
pTxnIÅut
 ){

117 
PM¬k‘F“dTxnIÅut
 
mfIÅut
ğ
Ãw
 
	`TM¬k‘F“dTxnIÅut
();

118 
	`memıy
(
mfIÅut
, 
pTxnIÅut
, (
TM¬k‘F“dTxnIÅut
));

119 
MFQueue
->
	`put
(
mfIÅut
);

120  
Œue
;

121 
	}
}

125 
EXIT_NAMESPACE
(
û
);

	@include/workload/tpce/egen/AddressTable.h

41 #iâdeà
ADDRESS_TABLE_H


42 
	#ADDRESS_TABLE_H


	)

44 
	~"EG’TabËs_commÚ.h
"

46 
Çme¥aû
 
	gTPCE


49 
şass
 
	gCAdd»ssTabË
 : 
public
 
TabËTem¶©e
<
ADDRESS_ROW
>

51 
´iv©e
:

52 
CD©eTime
 
m_d©e_time
;

53 
CCom·nyFe
* 
	gm_com·n›s
;

54 
TSŒ“tNamesFe
* 
	gm_SŒ“t
;

55 
TSŒ“tSuffixFe
* 
	gm_SŒ“tSuffix
;

56 
TZCodeFe
* 
	gm_ZCode
;

57 
TId’t
 
	gm_iS¹FromCu¡om”
;

58 
TId’t
 
	gm_iCu¡om”CouÁ
;

59 
boŞ
 
	gm_bCu¡om”Add»s£sOÆy
;

60 
boŞ
 
	gm_bCu¡om”Add»ss
;

61 
TId’t
 
	gm_iCom·nyCouÁ
;

62 
UINT
 
	gm_iExchªgeCouÁ
;

63 
TId’t
 
	gm_iTÙ®Add»ssCouÁ
;

64 
boŞ
 
	gm_bCacheEÇbËd
;

65 
	gm_iCacheSize
;

66 
TId’t
 
	gm_iCacheOff£t
;

67 cÚ¡ 
TZCodeIÅutRow
** 
	gm_CacheZCode
;

79 
G’”©eAD_LINE_1
();

90 
G’”©eAD_LINE_2
();

102 
G‘TownDivisiÚZCodeTh»shŞd
(
TId’t
 
ADID
);

112 
UINT
 
G‘CouÁryCode
ĞcÚ¡ *
pZCode
 );

124 
G’”©eAD_ZC_CODE_CTRY
();

126 
	gpublic
:

142 
CAdd»ssTabË
(
CIÅutFes
 
šputFes
,

143 
TId’t
 
iCu¡om”CouÁ
,

144 
TId’t
 
iS¹FromCu¡om”
,

145 
boŞ
 
bCu¡om”Add»s£sOÆy
 = 
çl£
,

146 
boŞ
 
bCacheEÇbËd
 = 
çl£


158 ~
CAdd»ssTabË
();

169 
In™NextLßdUn™
();

183 
TId’t
 
G’”©eNextAD_ID
();

194 
TId’t
 
G‘AD_IDFÜCu¡om”
(TId’ˆ
C_ID
);

208 
G‘DivisiÚAndCouÁryCodesFÜAdd»ss
(
TId’t
 
AD_ID
, 
UINT
 &
iDivCode
, UINT &
iCŒyCode
);

221 
G‘DivisiÚAndCouÁryCodes
(
UINT
 &
iDivCode
, UINT &
iCŒyCode
)

223 
G‘DivisiÚAndCouÁryCodesFÜAdd»ss
(
m_row
.
AD_ID
, 
iDivCode
, 
iCŒyCode
);

237 
boŞ
 
G’”©eNextRecÜd
();

	@include/workload/tpce/egen/BaseLoader.h

41 #iâdeà
BASE_LOADER_H


42 
	#BASE_LOADER_H


	)

44 
Çme¥aû
 
	gTPCE


47 
	g‹m¶©e
 <
ty³Çme
 
	gT
> cÏs 
	cCBa£Lßd”


50 
	gpublic
:

51 cÚ¡ 
	tT
* 
	tPT
;

63 
	gvœtu®
 ~
CBa£Lßd”
() {};

77 
vœtu®
 
In™
() {};

94 
vœtu®
 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
) = 0;

107 
vœtu®
 
Comm™
() {};

121 
vœtu®
 
FšishLßd
() = 0;

	@include/workload/tpce/egen/BaseLoaderFactory.h

42 #iâdeà
BASE_LOADER_FACTORY_H


43 
	#BASE_LOADER_FACTORY_H


	)

45 
	~"Ba£Lßd”.h
"

46 
	~"TabË_Defs.h
"

48 
Çme¥aû
 
	gTPCE


51 şas 
	cCBa£Lßd”FaùÜy


54 
	gpublic
:

66 
vœtu®
 ~
CBa£Lßd”FaùÜy
() {};

78 
vœtu®
 
	gCBa£Lßd”
<
	gACCOUNT_PERMISSION_ROW
>* 
C»©eAccouÁP”missiÚLßd”
() = 0;

90 
vœtu®
 
	gCBa£Lßd”
<
	gADDRESS_ROW
>* 
C»©eAdd»ssLßd”
() = 0;

102 
vœtu®
 
	gCBa£Lßd”
<
	gBROKER_ROW
>* 
C»©eBrok”Lßd”
() = 0;

114 
vœtu®
 
	gCBa£Lßd”
<
	gCASH_TRANSACTION_ROW
>* 
C»©eCashT¿n§ùiÚLßd”
() = 0;

126 
vœtu®
 
	gCBa£Lßd”
<
	gCHARGE_ROW
>* 
C»©eCh¬geLßd”
() = 0;

138 
vœtu®
 
	gCBa£Lßd”
<
	gCOMMISSION_RATE_ROW
>* 
C»©eCommissiÚR©eLßd”
() = 0;

150 
vœtu®
 
	gCBa£Lßd”
<
	gCOMPANY_COMPETITOR_ROW
>* 
C»©eCom·nyCom³t™ÜLßd”
() = 0;

162 
vœtu®
 
	gCBa£Lßd”
<
	gCOMPANY_ROW
>* 
C»©eCom·nyLßd”
() = 0;

174 
vœtu®
 
	gCBa£Lßd”
<
	gCUSTOMER_ACCOUNT_ROW
>* 
C»©eCu¡om”AccouÁLßd”
() = 0;

186 
vœtu®
 
	gCBa£Lßd”
<
	gCUSTOMER_ROW
>* 
C»©eCu¡om”Lßd”
() = 0;

198 
vœtu®
 
	gCBa£Lßd”
<
	gCUSTOMER_TAXRATE_ROW
>* 
C»©eCu¡om”Tax¿‹Lßd”
() = 0;

210 
vœtu®
 
	gCBa£Lßd”
<
	gDAILY_MARKET_ROW
>* 
C»©eDayM¬k‘Lßd”
() = 0;

222 
vœtu®
 
	gCBa£Lßd”
<
	gEXCHANGE_ROW
>* 
C»©eExchªgeLßd”
() = 0;

234 
vœtu®
 
	gCBa£Lßd”
<
	gFINANCIAL_ROW
>* 
C»©eFšªcŸlLßd”
() = 0;

246 
vœtu®
 
	gCBa£Lßd”
<
	gHOLDING_ROW
>* 
C»©eHŞdšgLßd”
() = 0;

258 
vœtu®
 
	gCBa£Lßd”
<
	gHOLDING_HISTORY_ROW
>* 
C»©eHŞdšgHi¡ÜyLßd”
() = 0;

270 
vœtu®
 
	gCBa£Lßd”
<
	gHOLDING_SUMMARY_ROW
>* 
C»©eHŞdšgSumm¬yLßd”
() = 0;

282 
vœtu®
 
	gCBa£Lßd”
<
	gINDUSTRY_ROW
>* 
C»©eIndu¡ryLßd”
() = 0;

294 
vœtu®
 
	gCBa£Lßd”
<
	gLAST_TRADE_ROW
>* 
C»©eLa¡T¿deLßd”
() = 0;

306 
vœtu®
 
	gCBa£Lßd”
<
	gNEWS_ITEM_ROW
>* 
C»©eNewsI‹mLßd”
() = 0;

318 
vœtu®
 
	gCBa£Lßd”
<
	gNEWS_XREF_ROW
>* 
C»©eNewsXRefLßd”
() = 0;

330 
vœtu®
 
	gCBa£Lßd”
<
	gSECTOR_ROW
>* 
C»©eSeùÜLßd”
() = 0;

342 
vœtu®
 
	gCBa£Lßd”
<
	gSECURITY_ROW
>* 
C»©eSecur™yLßd”
() = 0;

354 
vœtu®
 
	gCBa£Lßd”
<
	gSETTLEMENT_ROW
>* 
C»©eS‘em’tLßd”
() = 0;

366 
vœtu®
 
	gCBa£Lßd”
<
	gSTATUS_TYPE_ROW
>* 
C»©eStusTy³Lßd”
() = 0;

378 
vœtu®
 
	gCBa£Lßd”
<
	gTAXRATE_ROW
>* 
C»©eTax¿‹Lßd”
() = 0;

390 
vœtu®
 
	gCBa£Lßd”
<
	gTRADE_HISTORY_ROW
>* 
C»©eT¿deHi¡ÜyLßd”
() = 0;

402 
vœtu®
 
	gCBa£Lßd”
<
	gTRADE_ROW
>* 
C»©eT¿deLßd”
() = 0;

414 
vœtu®
 
	gCBa£Lßd”
<
	gTRADE_REQUEST_ROW
>* 
C»©eT¿deReque¡Lßd”
() = 0;

426 
vœtu®
 
	gCBa£Lßd”
<
	gTRADE_TYPE_ROW
>* 
C»©eT¿deTy³Lßd”
() = 0;

438 
vœtu®
 
	gCBa£Lßd”
<
	gWATCH_ITEM_ROW
>* 
C»©eW©chI‹mLßd”
() = 0;

450 
vœtu®
 
	gCBa£Lßd”
<
	gWATCH_LIST_ROW
>* 
C»©eW©chLi¡Lßd”
() = 0;

462 
vœtu®
 
	gCBa£Lßd”
<
	gZIP_CODE_ROW
>* 
C»©eZCodeLßd”
() = 0;

	@include/workload/tpce/egen/BaseLogFormatter.h

42 #iâdeà
BASE_LOG_FORMATTER_H


43 
	#BASE_LOG_FORMATTER_H


	)

45 
	~<¡ršg
>

46 
	~"Driv”P¬amS‘tšgs.h
"

48 
Çme¥aû
 
	gTPCE


51 
	eeLogFÜm©


53 
	geLogTab
,

54 
	geLogCu¡om


57 şas 
	cCBa£LogFÜm©‹r


59 
	gpublic
:

70 
vœtu®
 ~
CBa£LogFÜm©‹r
() {};

72 
vœtu®
 
¡ršg
 
G‘LogOuut
(
CBrok”VŞumeS‘tšgs
& 
·rms
) = 0;

73 
vœtu®
 
¡ršg
 
G‘LogOuut
(
CCu¡om”Pos™iÚS‘tšgs
& 
·rms
) = 0;

74 
vœtu®
 
¡ršg
 
G‘LogOuut
(
CM¬k‘W©chS‘tšgs
& 
·rms
) = 0;

75 
vœtu®
 
¡ršg
 
G‘LogOuut
(
CSecur™yD‘aS‘tšgs
& 
·rms
) = 0;

76 
vœtu®
 
¡ršg
 
G‘LogOuut
(
CT¿deLookupS‘tšgs
& 
·rms
) = 0;

77 
vœtu®
 
¡ršg
 
G‘LogOuut
(
CT¿deOrd”S‘tšgs
& 
·rms
) = 0;

78 
vœtu®
 
¡ršg
 
G‘LogOuut
(
CT¿deUpd©eS‘tšgs
& 
·rms
) = 0;

79 
vœtu®
 
¡ršg
 
G‘LogOuut
(
CTxnMixG’”©ÜS‘tšgs
& 
·rms
) = 0;

80 
vœtu®
 
¡ršg
 
G‘LogOuut
(
CLßd”S‘tšgs
& 
·rms
) = 0;

81 
vœtu®
 
¡ršg
 
G‘LogOuut
(
CDriv”Glob®S‘tšgs
& 
·rms
) = 0;

82 
vœtu®
 
¡ršg
 
G‘LogOuut
(
CDriv”CES‘tšgs
& 
·rms
) = 0;

83 
vœtu®
 
¡ršg
 
G‘LogOuut
(
CDriv”CEP¬t™iÚS‘tšgs
& 
·rms
) = 0;

84 
vœtu®
 
¡ršg
 
G‘LogOuut
(
CDriv”MEES‘tšgs
& 
·rms
) = 0;

85 
vœtu®
 
¡ršg
 
G‘LogOuut
(
CDriv”DMS‘tšgs
& 
·rms
) = 0;

	@include/workload/tpce/egen/BaseLogger.h

41 #iâdeà
BASE_LOGGER_H


42 
	#BASE_LOGGER_H


	)

44 
	~"EG’Snd¬dTy³s.h
"

45 
	~"Driv”Ty³s.h
"

46 
	~"Driv”P¬amS‘tšgs.h
"

47 
	~"Ba£LogFÜm©‹r.h
"

49 
Çme¥aû
 
	gTPCE


54 şas 
	cCBa£Logg”


56 
	g´iv©e
:

57 
m_P»fix
[64];

58 
CBa£LogFÜm©‹r
* 
	gm_pLogFÜm©‹r
;

60 
boŞ
 
S’dToLogg”
(cÚ¡ *
szP»fix
, cÚ¡ *
szMsg
);

62 
	g´Ùeùed
:

63 
CBa£Logg”
(
eDriv”Ty³
 
drvTy³
, 
INT32
 
UniqueId
, 
CBa£LogFÜm©‹r
* 
pFÜm©‹r
);

64 
vœtu®
 
boŞ
 
S’dToLogg”Im¶
(cÚ¡ *
szP»fix
, cÚ¡ *
szTime¡amp
, cÚ¡ *
szMsg
) = 0;

66 
	gpublic
:

68 
vœtu®
 ~
CBa£Logg”
() {}

71 
boŞ
 
S’dToLogg”
(cÚ¡ *
¡r
);

72 
boŞ
 
S’dToLogg”
(
¡ršg
 
¡r
);

75 
boŞ
 
S’dToLogg”
(
CLßd”S‘tšgs
& 
·rms
);

76 
boŞ
 
S’dToLogg”
(
CDriv”Glob®S‘tšgs
& 
·rms
);

77 
boŞ
 
S’dToLogg”
(
CDriv”CES‘tšgs
& 
·rms
);

78 
boŞ
 
S’dToLogg”
(
CDriv”CEP¬t™iÚS‘tšgs
& 
·rms
);

79 
boŞ
 
S’dToLogg”
(
CDriv”MEES‘tšgs
& 
·rms
);

80 
boŞ
 
S’dToLogg”
(
CDriv”DMS‘tšgs
& 
·rms
);

81 
boŞ
 
S’dToLogg”
(
CBrok”VŞumeS‘tšgs
& 
·rms
);

82 
boŞ
 
S’dToLogg”
(
CCu¡om”Pos™iÚS‘tšgs
& 
·rms
);

83 
boŞ
 
S’dToLogg”
(
CM¬k‘W©chS‘tšgs
& 
·rms
);

84 
boŞ
 
S’dToLogg”
(
CSecur™yD‘aS‘tšgs
& 
·rms
);

85 
boŞ
 
S’dToLogg”
(
CT¿deLookupS‘tšgs
& 
·rms
);

86 
boŞ
 
S’dToLogg”
(
CT¿deOrd”S‘tšgs
& 
·rms
);

87 
boŞ
 
S’dToLogg”
(
CT¿deUpd©eS‘tšgs
& 
·rms
);

88 
boŞ
 
S’dToLogg”
(
CTxnMixG’”©ÜS‘tšgs
& 
·rms
);

89 
boŞ
 
S’dToLogg”
(
TDriv”CETxnS‘tšgs
& 
·rms
);

	@include/workload/tpce/egen/BigMath.h

37 #iâdeà
BIGMATH_H


38 
	#BIGMATH_H


	)

40 
	~"EG’Snd¬dTy³s.h
"

42 
Çme¥aû
 
	gTPCE


46 
	#BIT63
 
	`UINT64_CONST
(0x8000000000000000)

	)

47 
	#CARRY32
 
	`UINT64_CONST
(0x100000000)

	)

48 
	#MASK32
 
	`UINT64_CONST
(0xFFFFFFFF)

	)

49 
	#UPPER32
 32

	)

53 
šlše
 
UINT
 
Mul6432W™hShiáRight64
(
UINT64
 
£ed
, UINT 
¿nge
)

55 
UINT64
 
	gSL
 = (
£ed
 & 
MASK32
),

56 
	gSU
 = (
£ed
 >> 
UPPER32
),

57 
	gRL
 = 
¿nge
;

59 
UINT64
 
	gp0
 = (
SL
 * 
RL
),

60 
	gp1
 = (
SU
 * 
RL
),

61 
	gs
;

63 
	gs
 = 
p0
;

64 
	gs
 >>ğ
UPPER32
;

65 
	gs
 +ğ
p1
;

66 
	gs
 >>ğ
UPPER32
;

68  (
	gUINT
)
	gs
;

73 
šlše
 
UINT64
 
Mul6464W™hShiáRight64
(UINT64 
£ed
, UINT64 
¿nge
)

75 
UINT64
 
	gSL
 = (
£ed
 & 
MASK32
),

76 
	gSU
 = (
£ed
 >> 
UPPER32
),

77 
	gRL
 = (
¿nge
 & 
MASK32
),

78 
	gRU
 = (
¿nge
 >> 
UPPER32
);

80 
UINT64
 
	gp0
 = (
SL
 * 
RL
),

81 
	gp1
 = (
SU
 * 
RL
),

82 
	gp2
 = (
SL
 * 
RU
),

83 
	gp3
 = (
SU
 * 
RU
),

84 
	gp12_ÿ¼y
 = 0,

85 
	gs
;

87 
	gs
 = 
p0
;

88 
	gs
 >>ğ
UPPER32
;

89 
	gs
 +ğ
p1
;

90 
	gp12_ÿ¼y
 = ( ( ( (
p1
 & 
BIT63
è|| (
s
 & BIT63èè&& (
p2
 & BIT63èè? 
CARRY32
 : 0 );

91 
	gs
 +ğ
p2
;

92 
	gs
 >>ğ
UPPER32
;

93 
	gs
 +ğ
p12_ÿ¼y
;

94 
	gs
 +ğ
p3
;

96  
	gs
;

	@include/workload/tpce/egen/Brokers.h

40 #iâdeà
BROKERS_H


41 
	#BROKERS_H


	)

43 
	~<¡dio.h
>

44 
	~"EG’TabËs_commÚ.h
"

45 
	~"Cu¡om”AccouÁsAndP”missiÚsTabË.h
"

47 
Çme¥aû
 
	gTPCE


50 cÚ¡ 
TId’t
 
	giBrok”NameIDShiá
 = 1000*1000;

52 cÚ¡ 
	giBrok”In™ŸlT¿desYTDMš
 = 10000;

53 cÚ¡ 
	giBrok”In™ŸlT¿desYTDMax
 = 100000;

55 cÚ¡ 
	gfBrok”In™ŸlCommissiÚYTDMš
 = 10000.0;

56 cÚ¡ 
	gfBrok”In™ŸlCommissiÚYTDMax
 = 100000.0;

58 
şass
 
	gCBrok”sTabË
 : 
public
 
TabËTem¶©e
<
BROKER_ROW
>

60 
TId’t
 
m_iTÙ®Brok”s
;

61 
TId’t
 
	gm_iS¹FromBrok”
;

62 
TId’t
 
	gm_iS¹FromCu¡om”
;

63 
CP”sÚ
 
	gm_³rsÚ
;

64 
TStusTy³Fe
* 
	gm_StusTy³Fe
;

65 * 
	gm_pNumT¿des
;

66 * 
	gm_pCommTÙ®
;

69 
	gpublic
:

81 
CBrok”sTabË
(
CIÅutFes
 
šputFes
, 
TId’t
 
iCu¡om”CouÁ
, TId’ˆ
iS¹FromCu¡om”
)

82 : 
TabËTem¶©e
<
BROKER_ROW
>()

83 , 
m_iTÙ®Brok”s
(
iCu¡om”CouÁ
 / 
iBrok”sDiv
)

84 , 
m_iS¹FromBrok”
((
iS¹FromCu¡om”
 / 
iBrok”sDiv
è+ 
iS¹šgBrok”ID
 + 
iTId’tShiá
)

85 , 
m_iS¹FromCu¡om”
(
iS¹FromCu¡om”
)

86 , 
m_³rsÚ
(
šputFes
, 
iBrok”NameIDShiá
, 
Œue
)

87 , 
m_StusTy³Fe
(
šputFes
.
StusTy³
)

88 , 
m_pNumT¿des
(
NULL
)

89 , 
m_pCommTÙ®
(
NULL
)

102 ~
CBrok”sTabË
()

104 ià(
	gm_pNumT¿des
 !ğ
NULL
)

106 
d–‘e
[] 
m_pNumT¿des
;

109 ià(
	gm_pCommTÙ®
 !ğ
NULL
)

111 
d–‘e
[] 
m_pCommTÙ®
;

127 
In™FÜG’
(
TId’t
 
iCu¡om”CouÁ
, TId’ˆ
iS¹FromCu¡om”
)

129 
TId’t
 
	gi
;

131 ià(
	gm_iTÙ®Brok”s
 !ğ
iCu¡om”CouÁ
 / 
iBrok”sDiv
 ||

132 
m_pNumT¿des
 =ğ
NULL
 ||

133 
m_pCommTÙ®
 =ğ
NULL


140 
m_iTÙ®Brok”s
 = 
iCu¡om”CouÁ
 / 
iBrok”sDiv
;

142 ià(
	gm_pNumT¿des
 !ğ
NULL
)

144 
d–‘e
[] 
m_pNumT¿des
;

147 
	gm_pNumT¿des
 = 
Ãw
 [(
size_t
)
m_iTÙ®Brok”s
];

149 ià(
	gm_pCommTÙ®
 !ğ
NULL
)

151 
d–‘e
[] 
m_pCommTÙ®
;

154 
	gm_pCommTÙ®
 = 
Ãw
 [(
size_t
)
m_iTÙ®Brok”s
];

159 ià(
	gm_pNumT¿des
 !ğ
NULL
)

161 
i
 = 0; 
	gi
 < 
	gm_iTÙ®Brok”s
; ++i)

163 
	gm_pNumT¿des
[
i
] = 0;

169 ià(
	gm_pCommTÙ®
 !ğ
NULL
)

171 
i
 = 0; 
	gi
 < 
	gm_iTÙ®Brok”s
; ++i)

173 
	gm_pCommTÙ®
[
i
] = 0.0;

177 ià(
	gm_iS¹FromBrok”
 !ğ((
iS¹FromCu¡om”
 / 
iBrok”sDiv
è+ 
iS¹šgBrok”ID
 + 
iTId’tShiá
))

185 
m_iS¹FromBrok”
 = (
iS¹FromCu¡om”
 / 
iBrok”sDiv
è+ 
iS¹šgBrok”ID
 + 
iTId’tShiá
;

188 
	gm_iLa¡RowNumb”
 = 0;

190 
CË¬RecÜd
();

193 ià(
	gm_iS¹FromCu¡om”
 !ğ
iS¹FromCu¡om”
)

195 
m_³rsÚ
.
In™NextLßdUn™
(
iDeçuÉLßdUn™Size
/
iBrok”sDiv
);

211 
Upd©eT¿deAndCommissiÚYTD
(
TId’t
 
B_ID
, 
iT¿deInüem’t
, 
fCommissiÚInüem’t
)

213 iàĞ(
	gB_ID
 >ğ
m_iS¹FromBrok”
)

214 && (
B_ID
 < (
m_iS¹FromBrok”
 + 
m_iTÙ®Brok”s
)))

216 
m_pNumT¿des
[
B_ID
 - 
m_iS¹FromBrok”
] +ğ
iT¿deInüem’t
;

217 
	gm_pCommTÙ®
[
B_ID
 - 
m_iS¹FromBrok”
] +ğ
fCommissiÚInüem’t
;

233 
TId’t
 
G’”©eRªdomBrok”Id
(
CRªdom
* 
pRnd
)

235  
	gpRnd
->
RndIÁ64Rªge
(
m_iS¹FromBrok”
, m_iS¹FromBrok” + 
m_iTÙ®Brok”s
 - 1);

250 
G’”©eBrok”Name
(
TId’t
 
B_ID
, *
B_NAME
, 
size_t
 
B_NAME_Ën
)

252 
¢´štf
(
B_NAME
, 
B_NAME_Ën
, "%s %c. %s",

253 
m_³rsÚ
.
G‘Fœ¡Name
(
B_ID
 + 
iBrok”NameIDShiá
),

254 
m_³rsÚ
.
G‘MiddËName
(
B_ID
 + 
iBrok”NameIDShiá
),

255 
m_³rsÚ
.
G‘La¡Name
(
B_ID
 + 
iBrok”NameIDShiá
));

268 
TId’t
 
G‘Brok”CouÁ
()

270  
	gm_iTÙ®Brok”s
;

284 
boŞ
 
G’”©eNextRecÜd
()

286 
	gm_row
.
	gB_ID
 = 
m_iS¹FromBrok”
 + 
m_iLa¡RowNumb”
;

287 
¡ºıy
(
m_row
.
B_ST_ID
, 
m_StusTy³Fe
->
G‘RecÜd
(
eAùive
)->
ST_ID
, (m_row.B_ST_ID));

289 
G’”©eBrok”Name
(
m_row
.
B_ID
, m_row.
B_NAME
, 
¡©ic_ÿ¡
<>((m_row.B_NAME)));

291 
	gm_row
.
	gB_NUM_TRADES
 = 
m_pNumT¿des
[
m_row
.
B_ID
 - 
m_iS¹FromBrok”
];

292 
	gm_row
.
	gB_COMM_TOTAL
 = 
m_pCommTÙ®
[
m_row
.
B_ID
 - 
m_iS¹FromBrok”
];

296 ++
	gm_iLa¡RowNumb”
;

297 
	gm_bMÜeRecÜds
 = 
m_iLa¡RowNumb”
 < 
m_iTÙ®Brok”s
;

300  (
MÜeRecÜds
());

	@include/workload/tpce/egen/CE.h

106 #iâdeà
CE_H


107 
	#CE_H


	)

109 
	~"EG’Ut™›s_¡dafx.h
"

110 
	~"CETxnIÅutG’”©Ü.h
"

111 
	~"CETxnMixG’”©Ü.h
"

112 
	~"CESUTIÁ”çû.h
"

113 
	~"Ba£Logg”.h
"

114 
	~"Driv”P¬amS‘tšgs.h
"

116 
Çme¥aû
 
	gTPCE


119 şas 
	cCCE


121 
	g´iv©e
:

123 
CDriv”Glob®S‘tšgs
 
m_Driv”Glob®S‘tšgs
;

124 
CDriv”CES‘tšgs
 
	gm_Driv”CES‘tšgs
;

125 
CDriv”CEP¬t™iÚS‘tšgs
 
	gm_Driv”CEP¬t™iÚS‘tšgs
;

126 
TDriv”CETxnS‘tšgs
 
	gm_Driv”CETxnS‘tšgs
;

128 
CCESUTIÁ”çû
* 
	gm_pSUT
;

129 
CBa£Logg”
* 
	gm_pLogg”
;

130 
CCETxnMixG’”©Ü
 
	gm_TxnMixG’”©Ü
;

131 
CCETxnIÅutG’”©Ü
 
	gm_TxnIÅutG’”©Ü
;

133 
TBrok”VŞumeTxnIÅut
 
	gm_Brok”VŞumeTxnIÅut
;

134 
TCu¡om”Pos™iÚTxnIÅut
 
	gm_Cu¡om”Pos™iÚTxnIÅut
;

135 
TM¬k‘W©chTxnIÅut
 
	gm_M¬k‘W©chTxnIÅut
;

136 
TSecur™yD‘aTxnIÅut
 
	gm_Secur™yD‘aTxnIÅut
;

137 
TT¿deLookupTxnIÅut
 
	gm_T¿deLookupTxnIÅut
;

138 
TT¿deOrd”TxnIÅut
 
	gm_T¿deOrd”TxnIÅut
;

139 
TT¿deStusTxnIÅut
 
	gm_T¿deStusTxnIÅut
;

140 
TT¿deUpd©eTxnIÅut
 
	gm_T¿deUpd©eTxnIÅut
;

143 
boŞ
 
	gm_bCË¬BufãrBefÜeG’”©iÚ
;

146 
In™Ÿlize
Ğ
PDriv”CETxnS‘tšgs
 
pTxnP¬amS‘tšgs
 );

149 
AutoS‘RNGS“ds
Ğ
UINT32
 
UniqueId
 );

160 
Z”oIÅutBufãr
(
iTxnTy³
);

162 
	gpublic
:

163 cÚ¡ 
INT32
 
INVALID_TRANSACTION_TYPE
 = 
CCETxnMixG’”©Ü
::INVALID_TRANSACTION_TYPE;

164 cÚ¡ 
INT32
 
	gSECURITY_DETAIL
 = 
CCETxnMixG’”©Ü
::
SECURITY_DETAIL
;

165 cÚ¡ 
INT32
 
	gBROKER_VOLUME
 = 
CCETxnMixG’”©Ü
::
BROKER_VOLUME
;

166 cÚ¡ 
INT32
 
	gCUSTOMER_POSITION
 = 
CCETxnMixG’”©Ü
::
CUSTOMER_POSITION
;

167 cÚ¡ 
INT32
 
	gMARKET_WATCH
 = 
CCETxnMixG’”©Ü
::
MARKET_WATCH
;

168 cÚ¡ 
INT32
 
	gTRADE_STATUS
 = 
CCETxnMixG’”©Ü
::
TRADE_STATUS
;

169 cÚ¡ 
INT32
 
	gTRADE_LOOKUP
 = 
CCETxnMixG’”©Ü
::
TRADE_LOOKUP
;

170 cÚ¡ 
INT32
 
	gTRADE_ORDER
 = 
CCETxnMixG’”©Ü
::
TRADE_ORDER
;

171 cÚ¡ 
INT32
 
	gTRADE_UPDATE
 = 
CCETxnMixG’”©Ü
::
TRADE_UPDATE
;

173 cÚ¡ 
INT32
 
	gMARKET_FEED
 = 
CCETxnMixG’”©Ü
::
MARKET_FEED
;

174 cÚ¡ 
INT32
 
	gTRADE_RESULT
 = 
CCETxnMixG’”©Ü
::
TRADE_RESULT
;

177 
CCE
Ğ
CCESUTIÁ”çû
 *
pSUT
, 
CBa£Logg”
 *
pLogg”
, cÚ¡ 
CIÅutFes
 &
šputFes
,

178 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
,

179 
INT32
 
iSÿËFaùÜ
, INT32 
iDaysOfIn™ŸlT¿des
,

180 
UINT32
 
UniqueId
,

181 cÚ¡ 
PDriv”CETxnS‘tšgs
 
pP¬am‘”S‘tšgs
 = 
NULL
 );

184 
CCE
Ğ
CCESUTIÁ”çû
 *
pSUT
, 
CBa£Logg”
 *
pLogg”
, cÚ¡ 
CIÅutFes
 &
šputFes
,

185 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
,

186 
INT32
 
iSÿËFaùÜ
, INT32 
iDaysOfIn™ŸlT¿des
,

187 
UINT32
 
UniqueId
,

188 
RNGSEED
 
TxnMixRNGS“d
,

189 
RNGSEED
 
TxnIÅutRNGS“d
,

190 cÚ¡ 
PDriv”CETxnS‘tšgs
 
pP¬am‘”S‘tšgs
 = 
NULL
 );

193 
CCE
Ğ
CCESUTIÁ”çû
 *
pSUT
, 
CBa£Logg”
 *
pLogg”
, cÚ¡ 
CIÅutFes
 &
šputFes
,

194 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
,

195 
TId’t
 
iMyS¹šgCu¡om”Id
, TId’ˆ
iMyCu¡om”CouÁ
, 
INT32
 
iP¬t™iÚP”ûÁ
,

196 
INT32
 
iSÿËFaùÜ
, INT32 
iDaysOfIn™ŸlT¿des
,

197 
UINT32
 
UniqueId
,

198 cÚ¡ 
PDriv”CETxnS‘tšgs
 
pP¬am‘”S‘tšgs
 = 
NULL
 );

201 
CCE
Ğ
CCESUTIÁ”çû
 *
pSUT
, 
CBa£Logg”
 *
pLogg”
, cÚ¡ 
CIÅutFes
 &
šputFes
,

202 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
,

203 
TId’t
 
iMyS¹šgCu¡om”Id
, TId’ˆ
iMyCu¡om”CouÁ
, 
INT32
 
iP¬t™iÚP”ûÁ
,

204 
INT32
 
iSÿËFaùÜ
, INT32 
iDaysOfIn™ŸlT¿des
,

205 
UINT32
 
UniqueId
,

206 
RNGSEED
 
TxnMixRNGS“d
,

207 
RNGSEED
 
TxnIÅutRNGS“d
,

208 cÚ¡ 
PDriv”CETxnS‘tšgs
 
pP¬am‘”S‘tšgs
 = 
NULL
 );

210 ~
CCE
( );

212 
RNGSEED
 
G‘TxnIÅutG’”©ÜRNGS“d
( );

213 
RNGSEED
 
G‘TxnMixG’”©ÜRNGS“d
( );

214 
boŞ
 
S‘TxnTuÇbËs
ĞcÚ¡ 
PDriv”CETxnS‘tšgs
 
pTxnP¬amS‘tšgs
 );

216 
DoTxn
( );

230 
S‘CË¬BufãrO±iÚ
(
boŞ
 
bCË¬BufãrBefÜeG’”©iÚ
);

	@include/workload/tpce/egen/CESUTInterface.h

43 #iâdeà
CE_SUT_INTERFACE_H


44 
	#CE_SUT_INTERFACE_H


	)

46 
	~"TxnH¬ÃssSŒuùs.h
"

48 
Çme¥aû
 
	gTPCE


51 şas 
	cCCESUTIÁ”çû


53 
	gpublic
:

64 
vœtu®
 ~
CCESUTIÁ”çû
() {};

66 
vœtu®
 
boŞ
 
Brok”VŞume
Ğ
PBrok”VŞumeTxnIÅut
 
pTxnIÅut
 ) = 0;

67 
vœtu®
 
boŞ
 
Cu¡om”Pos™iÚ
Ğ
PCu¡om”Pos™iÚTxnIÅut
 
pTxnIÅut
 ) = 0;

68 
vœtu®
 
boŞ
 
M¬k‘W©ch
Ğ
PM¬k‘W©chTxnIÅut
 
pTxnIÅut
 ) = 0;

69 
vœtu®
 
boŞ
 
Secur™yD‘a
Ğ
PSecur™yD‘aTxnIÅut
 
pTxnIÅut
 ) = 0;

70 
vœtu®
 
boŞ
 
T¿deLookup
Ğ
PT¿deLookupTxnIÅut
 
pTxnIÅut
 ) = 0;

71 
vœtu®
 
boŞ
 
T¿deOrd”
Ğ
PT¿deOrd”TxnIÅut
 
pTxnIÅut
, 
INT32
 
iT¿deTy³
, boŞ 
bExecutÜIsAccouÁOwÃr
 ) = 0;

72 
vœtu®
 
boŞ
 
T¿deStus
Ğ
PT¿deStusTxnIÅut
 
pTxnIÅut
 ) = 0;

73 
vœtu®
 
boŞ
 
T¿deUpd©e
Ğ
PT¿deUpd©eTxnIÅut
 
pTxnIÅut
 ) = 0;

	@include/workload/tpce/egen/CETxnInputGenerator.h

41 #iâdeà
CE_TXN_INPUT_GENERATOR_H


42 
	#CE_TXN_INPUT_GENERATOR_H


	)

44 
	~"EG’Lßd”_¡dafx.h
"

45 
	~"EG’Ut™›s_¡dafx.h
"

46 
	~"TxnH¬ÃssSŒuùs.h
"

47 
	~"Driv”P¬amS‘tšgs.h
"

48 
	~"EG’Logg”.h
"

50 
Çme¥aû
 
	gTPCE


53 şas 
	cCCETxnIÅutG’”©Ü


55 
CRªdom
 
	gm_ºd
;

56 
CP”sÚ
 
	gm_P”sÚ
;

57 
CCu¡om”S–eùiÚ
 
	gm_Cu¡om”S–eùiÚ
;

58 
CCu¡om”AccouÁsAndP”missiÚsTabË
 
	gm_AccsAndP”ms
;

59 
CHŞdšgsAndT¿desTabË
 
	gm_HŞdšgs
;

60 
CBrok”sTabË
 
	gm_Brok”s
;

61 
CCom·nyFe
* 
	gm_pCom·n›s
;

62 
CSecur™yFe
* 
	gm_pSecur™›s
;

63 
TIndu¡ryFe
* 
	gm_pIndu¡r›s
;

64 
TSeùÜFe
* 
	gm_pSeùÜs
;

65 
TStusTy³Fe
* 
	gm_pStusTy³
;

66 
TT¿deTy³Fe
* 
	gm_pT¿deTy³
;

67 
PDriv”CETxnS‘tšgs
 
	gm_pDriv”CETxnS‘tšgs
;

68 
CBa£Logg”
* 
	gm_pLogg”
;

70 
TId’t
 
	gm_iCÚfigu»dCu¡om”CouÁ
;

71 
TId’t
 
	gm_iAùiveCu¡om”CouÁ
;

73 
TId’t
 
	gm_iMyS¹šgCu¡om”Id
;

74 
TId’t
 
	gm_iMyCu¡om”CouÁ
;

75 
INT32
 
	gm_iP¬t™iÚP”ûÁ
;

77 
INT32
 
	gm_iSÿËFaùÜ
;

78 
INT32
 
	gm_iHoursOfIn™ŸlT¿des
;

79 
INT64
 
	gm_iMaxAùiveP»PİuÏ‹dT¿deID
;

81 
INT64
 
	gm_iT¿deLookupF¿me2MaxTimeInMliSecÚds
;

82 
INT64
 
	gm_iT¿deLookupF¿me3MaxTimeInMliSecÚds
;

83 
INT64
 
	gm_iT¿deLookupF¿me4MaxTimeInMliSecÚds
;

85 
INT64
 
	gm_iT¿deUpd©eF¿me2MaxTimeInMliSecÚds
;

86 
INT64
 
	gm_iT¿deUpd©eF¿me3MaxTimeInMliSecÚds
;

89 
TId’t
 
	gm_iAùiveSecur™yCouÁ
;

90 
TId’t
 
	gm_iAùiveCom·nyCouÁ
;

92 
INT32
 
	gm_iIndu¡ryCouÁ
;

94 
INT32
 
	gm_iSeùÜCouÁ
;

96 
TId’t
 
	gm_iS¹FromCom·ny
;

97 
CD©eTime
 
	gm_S¹Time
;

98 
CD©eTime
 
	gm_EndTime
;

101 
INT32
 
	gm_iT¿deOrd”RŞlbackLim™
;

102 
INT32
 
	gm_iT¿deOrd”RŞlbackLev–
;

113 
In™Ÿlize
();

125 
G’”©eNÚUnifÜmRªdomCu¡om”Id
(
TId’t
 &
iCu¡om”Id
, 
eCu¡om”T›r
 &
iCu¡om”T›r
);

136 
TId’t
 
G’”©eRªdomCu¡om”AccouÁId
();

148 
TT¿de
 
G’”©eNÚUnifÜmT¿deID
(
INT32
 
AV®ue
, INT32 
SV®ue
);

162 
G’”©eNÚUnifÜmT¿deDTS
(
TIMESTAMP_STRUCT
 &
dts
, 
INT64
 
MaxTimeInMliSecÚds
, 
INT32
 
AV®ue
, INT32 
SV®ue
);

164 
	gpublic
:

180 
CCETxnIÅutG’”©Ü
ĞcÚ¡ 
CIÅutFes
 &
šputFes
,

181 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
,

182 
INT32
 
iSÿËFaùÜ
, INT32 
iHoursOfIn™ŸlT¿des
,

183 
CBa£Logg”
 *
pLogg”
,

184 cÚ¡ 
PDriv”CETxnS‘tšgs
 
pDriv”CETxnTuÇbËs
 );

205 
CCETxnIÅutG’”©Ü
ĞcÚ¡ 
CIÅutFes
 &
šputFes
,

206 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
,

207 
INT32
 
iSÿËFaùÜ
, INT32 
iHoursOfIn™ŸlT¿des
,

208 
RNGSEED
 
RNGS“d
,

209 
CBa£Logg”
 *
pLogg”
,

210 cÚ¡ 
PDriv”CETxnS‘tšgs
 
pDriv”CETxnTuÇbËs
 );

230 
CCETxnIÅutG’”©Ü
ĞcÚ¡ 
CIÅutFes
 &
šputFes
,

231 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
,

232 
INT32
 
iSÿËFaùÜ
, INT32 
iHoursOfIn™ŸlT¿des
,

233 
TId’t
 
iMyS¹šgCu¡om”Id
, TId’ˆ
iMyCu¡om”CouÁ
, 
INT32
 
iP¬t™iÚP”ûÁ
,

234 
CBa£Logg”
 *
pLogg”
,

235 cÚ¡ 
PDriv”CETxnS‘tšgs
 
pDriv”CETxnTuÇbËs
 );

258 
CCETxnIÅutG’”©Ü
ĞcÚ¡ 
CIÅutFes
 &
šputFes
,

259 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
,

260 
INT32
 
iSÿËFaùÜ
, INT32 
iHoursOfIn™ŸlT¿des
,

261 
TId’t
 
iMyS¹šgCu¡om”Id
, TId’ˆ
iMyCu¡om”CouÁ
, 
INT32
 
iP¬t™iÚP”ûÁ
,

262 
RNGSEED
 
RNGS“d
,

263 
CBa£Logg”
 *
pLogg”
,

264 cÚ¡ 
PDriv”CETxnS‘tšgs
 
pDriv”CETxnTuÇbËs
 );

275 
RNGSEED
 
G‘RNGS“d
( );

286 
S‘RNGS“d
Ğ
RNGSEED
 
RNGS“d
 );

299 
Upd©eTuÇbËs
();

310 
G’”©eBrok”VŞumeIÅut
(
TBrok”VŞumeTxnIÅut
 &
TxnReq
);

321 
G’”©eCu¡om”Pos™iÚIÅut
(
TCu¡om”Pos™iÚTxnIÅut
 &
TxnReq
);

332 
G’”©eM¬k‘W©chIÅut
(
TM¬k‘W©chTxnIÅut
 &
TxnReq
);

343 
G’”©eSecur™yD‘aIÅut
(
TSecur™yD‘aTxnIÅut
 &
TxnReq
);

354 
G’”©eT¿deLookupIÅut
(
TT¿deLookupTxnIÅut
 &
TxnReq
);

367 
G’”©eT¿deOrd”IÅut
(
TT¿deOrd”TxnIÅut
 &
TxnReq
, 
INT32
 &
iT¿deTy³
, 
boŞ
 &
bExecutÜIsAccouÁOwÃr
);

378 
G’”©eT¿deStusIÅut
(
TT¿deStusTxnIÅut
 &
TxnReq
);

389 
G’”©eT¿deUpd©eIÅut
(
TT¿deUpd©eTxnIÅut
 &
TxnReq
);

	@include/workload/tpce/egen/CETxnMixGenerator.h

42 #iâdeà
CE_TXN_MIX_GENERATOR_H


43 
	#CE_TXN_MIX_GENERATOR_H


	)

45 
	~"EG’Ut™›s_¡dafx.h
"

46 
	~"Driv”P¬amS‘tšgs.h
"

47 
	~"EG’Logg”.h
"

49 
Çme¥aû
 
	gTPCE


52 şas 
	cCCETxnMixG’”©Ü


54 
	g´iv©e
:

55 cÚ¡ 
PDriv”CETxnS‘tšgs
 
m_pDriv”CETxnS‘tšgs
;

56 
CRªdom
 
	gm_ºd
;

57 
CBa£Logg”
* 
	gm_pLogg”
;

65 
INT32
 
	gm_CET¿n§ùiÚMixTÙ®
;

79 
INT32
 
	gm_iTxnA¼ayCu¼’tIndex
;

80 * 
	gm_pTxnA¼ay
;

82 
	gpublic
:

83 cÚ¡ 
INT32
 
INVALID_TRANSACTION_TYPE
 = -1;

84 cÚ¡ 
INT32
 
	gSECURITY_DETAIL
 = 0;

85 cÚ¡ 
INT32
 
	gBROKER_VOLUME
 = 1;

86 cÚ¡ 
INT32
 
	gCUSTOMER_POSITION
 = 2;

87 cÚ¡ 
INT32
 
	gMARKET_WATCH
 = 3;

88 cÚ¡ 
INT32
 
	gTRADE_STATUS
 = 4;

89 cÚ¡ 
INT32
 
	gTRADE_LOOKUP
 = 5;

90 cÚ¡ 
INT32
 
	gTRADE_ORDER
 = 6;

91 cÚ¡ 
INT32
 
	gTRADE_UPDATE
 = 7;

93 cÚ¡ 
INT32
 
	gMARKET_FEED
 = 8;

94 cÚ¡ 
INT32
 
	gTRADE_RESULT
 = 9;

96 
CCETxnMixG’”©Ü
ĞcÚ¡ 
PDriv”CETxnS‘tšgs
 
pTxnP¬amS‘tšgs
, 
CBa£Logg”
 *
pLogg”
 );

97 
CCETxnMixG’”©Ü
ĞcÚ¡ 
PDriv”CETxnS‘tšgs
 
pTxnP¬amS‘tšgs
, 
RNGSEED
 
RNGS“d
, 
CBa£Logg”
 *
pLogg”
);

98 ~
CCETxnMixG’”©Ü
();

100 
RNGSEED
 
G‘RNGS“d
( );

101 
S‘RNGS“d
Ğ
RNGSEED
 
RNGS“d
 );

103 
Upd©eTuÇbËs
( );

104 
G’”©eNextTxnTy³
( );

	@include/workload/tpce/egen/ChargeTable.h

40 #iâdeà
CHARGE_TABLE_H


41 
	#CHARGE_TABLE_H


	)

43 
	~"EG’TabËs_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCCh¬geTabË
 : 
public
 
TabËTem¶©e
<
CHARGE_ROW
>

50 
if¡»am
 
InFe
;

52 
	gpublic
:

53 
CCh¬geTabË
Ğ*
szDœName
 )

54 : 
TabËTem¶©e
<
CHARGE_ROW
>()

56 
szFeName
[
iMaxP©h
];

58 
¡ºıy
(
szFeName
, 
szDœName
, (szFileName));

59 
¡ºÿt
(
szFeName
, "Ch¬ge.txt", (szFeNameè- 
¡¾’
(
szDœName
) - 1);

61 
	gInFe
.
İ’
Ğ
szFeName
 );

64 ~
CCh¬geTabË
( )

66 
	gInFe
.
şo£
();

72 
boŞ
 
G’”©eNextRecÜd
()

74 ifĞ
	gInFe
.
good
() )

76 
	gm_row
.
Lßd
(
InFe
);

79  ( 
	gInFe
.
eof
() );

	@include/workload/tpce/egen/CommissionRateTable.h

40 #iâdeà
COMMISSION_RATE_TABLE_H


41 
	#COMMISSION_RATE_TABLE_H


	)

43 
	~"EG’TabËs_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCCommissiÚR©eTabË
 : 
public
 
TabËTem¶©e
<
COMMISSION_RATE_ROW
>

50 
if¡»am
 
InFe
;

52 
	gpublic
:

53 
CCommissiÚR©eTabË
Ğ*
szDœName
 )

54 : 
TabËTem¶©e
<
COMMISSION_RATE_ROW
>()

56 
szFeName
[
iMaxP©h
];

58 
¡ºıy
(
szFeName
, 
szDœName
, (szFileName));

59 
¡ºÿt
(
szFeName
, "CommissiÚR©e.txt", (szFeNameè- 
¡¾’
(
szDœName
) - 1);

61 
	gInFe
.
İ’
Ğ
szFeName
 );

64 ~
CCommissiÚR©eTabË
( )

66 
	gInFe
.
şo£
();

72 
boŞ
 
G’”©eNextRecÜd
()

74 ifĞ
	gInFe
.
good
() )

76 
	gm_row
.
Lßd
(
InFe
);

79  ( 
	gInFe
.
eof
() );

	@include/workload/tpce/egen/CompanyCompetitorFile.h

42 #iâdeà
COMPANY_COMPETITOR_FILE_H


43 
	#COMPANY_COMPETITOR_FILE_H


	)

45 
	~<¡ršg
>

46 
	~"EG’Snd¬dTy³s.h
"

47 
	~"TabËCÚ¡s.h
"

48 
	~"IÅutFÏtFesDeş¬©iÚs.h
"

49 
	~"FÏtFe.h
"

51 
usšg
 
Çme¥aû
 
	g¡d
;

53 
Çme¥aû
 
	gTPCE


56 
şass
 
	gCCom·nyCom³t™ÜFe
 : 
public
 
CFÏtFe
<
TCom·nyCom³t™ÜIÅutRow
, 
	gTCom·nyCom³t™ÜLim™s
>

61 
TId’t
 
	gm_iCÚfigu»dCom·nyCom³t™ÜCouÁ
;

62 
TId’t
 
	gm_iAùiveCom·nyCom³t™ÜCouÁ
;

66 
UINT
 
	gm_iBa£Com·nyCouÁ
;

68 
	gpublic
:

81 
CCom·nyCom³t™ÜFe
(cÚ¡ *
szLi¡Fe
, 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
)

82 : 
CFÏtFe
<
TCom·nyCom³t™ÜIÅutRow
, 
	gTCom·nyCom³t™ÜLim™s
>(
	gszLi¡Fe
)

84 
TCom·nyLim™s
 
	gCom·nyIÅutFeLim™s
;

86 
S‘CÚfigu»dCom·nyCom³t™ÜCouÁ
(
iCÚfigu»dCu¡om”CouÁ
);

87 
S‘AùiveCom·nyCom³t™ÜCouÁ
(
iAùiveCu¡om”CouÁ
);

89 
	gm_iBa£Com·nyCouÁ
 = 
Com·nyIÅutFeLim™s
.
m_iTÙ®EËm’ts
;

103 
CCom·nyCom³t™ÜFe
(cÚ¡ 
¡ršg
 &
¡r
, 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
)

104 : 
CFÏtFe
<
TCom·nyCom³t™ÜIÅutRow
, 
	gTCom·nyCom³t™ÜLim™s
>(
	g¡r
)

106 
TCom·nyLim™s
 
	gCom·nyIÅutFeLim™s
;

108 
S‘CÚfigu»dCom·nyCom³t™ÜCouÁ
(
iCÚfigu»dCu¡om”CouÁ
);

109 
S‘AùiveCom·nyCom³t™ÜCouÁ
(
iAùiveCu¡om”CouÁ
);

111 
	gm_iBa£Com·nyCouÁ
 = 
Com·nyIÅutFeLim™s
.
m_iTÙ®EËm’ts
;

125 
S‘CÚfigu»dCom·nyCom³t™ÜCouÁ
(
TId’t
 
iCÚfigu»dCu¡om”CouÁ
)

127 
	gm_iCÚfigu»dCom·nyCom³t™ÜCouÁ
 = 
C®cuÏ‹Com·nyCom³t™ÜCouÁ
(
iCÚfigu»dCu¡om”CouÁ
);

141 
S‘AùiveCom·nyCom³t™ÜCouÁ
(
TId’t
 
iAùiveCu¡om”CouÁ
)

143 
	gm_iAùiveCom·nyCom³t™ÜCouÁ
 = 
C®cuÏ‹Com·nyCom³t™ÜCouÁ
(
iAùiveCu¡om”CouÁ
);

156 
TId’t
 
C®cuÏ‹Com·nyCom³t™ÜCouÁ
(TId’ˆ
iCu¡om”CouÁ
)

158  
	giCu¡om”CouÁ
 / 
iDeçuÉLßdUn™Size
 * 
	giOÃLßdUn™Com·nyCom³t™ÜCouÁ
;

170 
TId’t
 
C®cuÏ‹S¹FromCom·nyCom³t™Ü
(TId’ˆ
iS¹FromCu¡om”
)

172  
	giS¹FromCu¡om”
 / 
iDeçuÉLßdUn™Size
 * 
	giOÃLßdUn™Com·nyCom³t™ÜCouÁ
;

185 
TId’t
 
G‘Com·nyId
(TId’ˆ
iIndex
)

189  
	gm_li¡
[ ()(
iIndex
 % 
m_li¡
.
size
()è].
	gCP_CO_ID
 + 
	giTId’tShiá


190 + 
	giIndex
 / 
	gm_li¡
.
size
(è* 
	gm_iBa£Com·nyCouÁ
;

203 
TId’t
 
G‘Com·nyCom³t™ÜId
(TId’ˆ
iIndex
)

207  
	gm_li¡
[ ()(
iIndex
 % 
m_li¡
.
size
()è].
	gCP_COMP_CO_ID
 + 
	giTId’tShiá


208 + 
	giIndex
 / 
	gm_li¡
.
size
(è* 
	gm_iBa£Com·nyCouÁ
;

221 * 
G‘Indu¡ryId
(
TId’t
 
iIndex
)

225  
	gm_li¡
[ ()(
iIndex
 % 
m_li¡
.
size
()è].
	gCP_IN_ID
;

238 
TId’t
 
G‘CÚfigu»dCom·nyCom³t™ÜCouÁ
()

240  
	gm_iCÚfigu»dCom·nyCom³t™ÜCouÁ
;

253 
TId’t
 
G‘AùiveCom·nyCom³t™ÜCouÁ
()

255  
	gm_iAùiveCom·nyCom³t™ÜCouÁ
;

268 
TCom·nyCom³t™ÜIÅutRow
* 
G‘RecÜd
(
TId’t
 
šdex
è{  &
	gm_li¡
[()(šdex % 
m_li¡
.
size
())]; };

	@include/workload/tpce/egen/CompanyCompetitorTable.h

40 #iâdeà
COMPANY_COMPETITOR_TABLE_H


41 
	#COMPANY_COMPETITOR_TABLE_H


	)

43 
	~"EG’TabËs_commÚ.h
"

44 
	~"Com·nyCom³t™ÜFe.h
"

46 
Çme¥aû
 
	gTPCE


49 
şass
 
	gCCom·nyCom³t™ÜTabË
 : 
public
 
TabËTem¶©e
<
COMPANY_COMPETITOR_ROW
>

51 
CCom·nyCom³t™ÜFe
* 
m_pCom·nyCom³t™ÜFe
;

52 
TId’t
 
	gm_iCom·nyCom³t™ÜCouÁ
;

53 
TId’t
 
	gm_iS¹FromCom·nyCom³t™Ü
;

54 
TId’t
 
	gm_iCom·nyCom³t™ÜCouÁFÜOÃLßdUn™
;

65 
In™NextLßdUn™
()

69 
CË¬RecÜd
();

72 
	gpublic
:

73 
CCom·nyCom³t™ÜTabË
(
CIÅutFes
 
šputFes
,

74 
TId’t
 
iCu¡om”CouÁ
,

75 
TId’t
 
iS¹FromCu¡om”
)

76 : 
TabËTem¶©e
<
COMPANY_COMPETITOR_ROW
>()

77 , 
m_pCom·nyCom³t™ÜFe
(
šputFes
.
Com·nyCom³t™Ü
)

79 
	gm_iCom·nyCom³t™ÜCouÁ
 = 
m_pCom·nyCom³t™ÜFe
->
C®cuÏ‹Com·nyCom³t™ÜCouÁ
(
iCu¡om”CouÁ
);

80 
	gm_iS¹FromCom·nyCom³t™Ü
 = 
m_pCom·nyCom³t™ÜFe
->
C®cuÏ‹S¹FromCom·nyCom³t™Ü
(
iS¹FromCu¡om”
);

82 
	gm_iLa¡RowNumb”
 = 
m_iS¹FromCom·nyCom³t™Ü
;

84 
	gm_iCom·nyCom³t™ÜCouÁFÜOÃLßdUn™
 = 
m_pCom·nyCom³t™ÜFe
->
C®cuÏ‹Com·nyCom³t™ÜCouÁ
(
iDeçuÉLßdUn™Size
);

90 
boŞ
 
G’”©eNextRecÜd
()

92 ià(
	gm_iLa¡RowNumb”
 % 
	gm_iCom·nyCom³t™ÜCouÁFÜOÃLßdUn™
 == 0)

94 
In™NextLßdUn™
();

97 
	gm_row
.
	gCP_CO_ID
 = 
m_pCom·nyCom³t™ÜFe
->
G‘Com·nyId
(
m_iLa¡RowNumb”
);

99 
	gm_row
.
	gCP_COMP_CO_ID
 = 
m_pCom·nyCom³t™ÜFe
->
G‘Com·nyCom³t™ÜId
(
m_iLa¡RowNumb”
);

101 
¡ºıy
(
m_row
.
CP_IN_ID
,

102 
m_pCom·nyCom³t™ÜFe
->
G‘Indu¡ryId
(
m_iLa¡RowNumb”
),

103 (
m_row
.
CP_IN_ID
));

105 ++
	gm_iLa¡RowNumb”
;

107 
	gm_bMÜeRecÜds
 = 
m_iLa¡RowNumb”
 < 
m_iS¹FromCom·nyCom³t™Ü
 + 
m_iCom·nyCom³t™ÜCouÁ
;

109  (
MÜeRecÜds
());

	@include/workload/tpce/egen/CompanyFile.h

42 #iâdeà
COMPANY_FILE_H


43 
	#COMPANY_FILE_H


	)

45 
	~<¡ršg
>

46 
	~"EG’Snd¬dTy³s.h
"

47 
	~"TabËCÚ¡s.h
"

48 
	~"IÅutFÏtFesDeş¬©iÚs.h
"

49 
	~"FÏtFe.h
"

51 
usšg
 
Çme¥aû
 
	g¡d
;

53 
Çme¥aû
 
	gTPCE


56 
şass
 
	gCCom·nyFe
 : 
public
 
CFÏtFe
<
TCom·nyIÅutRow
, 
	gTCom·nyLim™s
>

61 
TId’t
 
	gm_iCÚfigu»dCom·nyCouÁ
;

62 
TId’t
 
	gm_iAùiveCom·nyCouÁ
;

64 
	gpublic
:

77 
CCom·nyFe
(cÚ¡ *
szLi¡Fe
, 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
)

78 : 
CFÏtFe
<
TCom·nyIÅutRow
, 
	gTCom·nyLim™s
>(
	gszLi¡Fe
)

80 
S‘CÚfigu»dCom·nyCouÁ
(
iCÚfigu»dCu¡om”CouÁ
);

81 
S‘AùiveCom·nyCouÁ
(
iAùiveCu¡om”CouÁ
);

95 
CCom·nyFe
(cÚ¡ 
¡ršg
 &
¡r
, 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
)

96 : 
CFÏtFe
<
TCom·nyIÅutRow
, 
	gTCom·nyLim™s
>(
	g¡r
)

98 
S‘CÚfigu»dCom·nyCouÁ
(
iCÚfigu»dCu¡om”CouÁ
);

99 
S‘AùiveCom·nyCouÁ
(
iAùiveCu¡om”CouÁ
);

113 
S‘CÚfigu»dCom·nyCouÁ
(
TId’t
 
iCÚfigu»dCu¡om”CouÁ
)

115 
	gm_iCÚfigu»dCom·nyCouÁ
 = 
C®cuÏ‹Com·nyCouÁ
(
iCÚfigu»dCu¡om”CouÁ
);

129 
S‘AùiveCom·nyCouÁ
(
TId’t
 
iAùiveCu¡om”CouÁ
)

131 
	gm_iAùiveCom·nyCouÁ
 = 
C®cuÏ‹Com·nyCouÁ
(
iAùiveCu¡om”CouÁ
);

144 
TId’t
 
C®cuÏ‹Com·nyCouÁ
(TId’ˆ
iCu¡om”CouÁ
)

146  
	giCu¡om”CouÁ
 / 
iDeçuÉLßdUn™Size
 * 
	giOÃLßdUn™Com·nyCouÁ
;

158 
TId’t
 
C®cuÏ‹S¹FromCom·ny
(TId’ˆ
iS¹FromCu¡om”
)

160  
	giS¹FromCu¡om”
 / 
iDeçuÉLßdUn™Size
 * 
	giOÃLßdUn™Com·nyCouÁ
;

175 
C»©eName
(
TId’t
 
iIndex
,

176 * 
szOuut
,

177 
size_t
 
iOuutL’
)

179 
TId’t
 
	giFeIndex
 = 
iIndex
 % 
CFÏtFe
<
TCom·nyIÅutRow
, 
	gTCom·nyLim™s
>::
G‘Size
();

180 
TId’t
 
	giAdd
 = 
iIndex
 / 
CFÏtFe
<
TCom·nyIÅutRow
, 
	gTCom·nyLim™s
>::
G‘Size
();

182 ià(
	giAdd
 > 0)

184 
¢´štf
Ğ
szOuut
, 
iOuutL’
, "% #%Îd", 
G‘RecÜd
(
iFeIndex
)->
CO_NAME
, 
iAdd
 );

188 
¡ºıy
(
szOuut
, 
G‘RecÜd
(
iFeIndex
)->
CO_NAME
, 
iOuutL’
);

202 
TId’t
 
G‘Com·nyId
(TId’ˆ
iIndex
)

206  
	gm_li¡
[ ()(
iIndex
 % 
m_li¡
.
size
()è].
	gCO_ID
 + 
	giTId’tShiá


207 + 
	giIndex
 / 
	gm_li¡
.
size
() * m_list.size();

220 
TId’t
 
G‘Size
()

222  
	gm_iCÚfigu»dCom·nyCouÁ
;

235 
TId’t
 
G‘CÚfigu»dCom·nyCouÁ
()

237  
	gm_iCÚfigu»dCom·nyCouÁ
;

250 
TId’t
 
G‘AùiveCom·nyCouÁ
()

252  
	gm_iAùiveCom·nyCouÁ
;

265 
TCom·nyIÅutRow
* 
G‘RecÜd
(
TId’t
 
šdex
è{  &
	gm_li¡
[()(šdex % 
m_li¡
.
size
())]; };

	@include/workload/tpce/egen/CompanyTable.h

40 #iâdeà
COMPANY_TABLE_H


41 
	#COMPANY_TABLE_H


	)

43 
	~"EG’TabËs_commÚ.h
"

44 
	~"Com·nyFe.h
"

46 
Çme¥aû
 
	gTPCE


49 cÚ¡ 
	giCEOMuÉ
=1000;

54 cÚ¡ 
	giRNGSkOÃRowCom·ny
 = 2;

56 
şass
 
	gCCom·nyTabË
 : 
public
 
TabËTem¶©e
<
COMPANY_ROW
>

58 
CCom·nyFe
* 
m_Com·nyFe
;

59 
TCom·nySPR©eFe
* 
	gm_Com·nySPR©eFe
;

60 
CP”sÚ
 
	gm_³rsÚ
;

61 
CD©eTime
 
	gm_d©e
;

62 
TId’t
 
	gm_iCO_AD_ID_START
;

63 
	gm_iJª1_1800_DayNo
;

64 
	gm_iJª2_2000_DayNo
;

65 
	gm_iCu¼’tDayNo
;

66 
TId’t
 
	gm_iCom·nyCouÁFÜOÃLßdUn™
;

67 
TId’t
 
	gm_iCom·nyCouÁ
;

68 
TId’t
 
	gm_iS¹FromCom·ny
;

79 
G‘Com·nySPR©eTh»shŞd
()

81 
RNGSEED
 
	gOldS“d
;

82 
	giCom·nySPR©eTh»shŞd
;

84 
	gOldS“d
 = 
m_ºd
.
G‘S“d
();

85 
	gm_ºd
.
S‘S“d
Ğ
m_ºd
.
RndNthEËm’t
Ğ
RNGS“dBa£SPR©e
,

86 (
RNGSEED
è
m_row
.
CO_ID
 ));

87 
	giCom·nySPR©eTh»shŞd
 = 
m_ºd
.
RndIÁRªge
(0, 
m_Com·nySPR©eFe
->
G‘G»©e¡Key
()-1);

88 
	gm_ºd
.
S‘S“d
Ğ
OldS“d
 );

89 Ğ
	giCom·nySPR©eTh»shŞd
 );

102 
G’”©eCom·nySPR©e
()

104 
	giTh»shŞd
 = 
G‘Com·nySPR©eTh»shŞd
();

107 cÚ¡ 
TCom·nySPR©eIÅutRow
* 
	gpCom·nySPR©eIÅutRow
 = 
m_Com·nySPR©eFe
->
G‘RecÜd
(
iTh»shŞd
);

108 
¡ºıy
Ğ
m_row
.
CO_SP_RATE
, 
pCom·nySPR©eIÅutRow
->CO_SP_RATE, (m_row.CO_SP_RATE));

120 
In™NextLßdUn™
()

122 
	gm_ºd
.
S‘S“d
(
m_ºd
.
RndNthEËm’t
(
RNGS“dTabËDeçuÉ
,

123 (
RNGSEED
è
m_iLa¡RowNumb”
 * 
iRNGSkOÃRowCom·ny
));

125 
CË¬RecÜd
();

128 
	gpublic
:

140 
CCom·nyTabË
Ğ
CIÅutFes
 
šputFes
,

141 
TId’t
 
iCu¡om”CouÁ
,

142 
TId’t
 
iS¹FromCu¡om”
)

143 : 
TabËTem¶©e
<
COMPANY_ROW
>()

144 , 
m_Com·nyFe
(
šputFes
.
Com·ny
)

145 , 
m_Com·nySPR©eFe
(
šputFes
.
Com·nySPR©e
)

146 , 
m_³rsÚ
(
šputFes
, 0, 
çl£
)

148 
	gm_iJª1_1800_DayNo
 = 
CD©eTime
::
YMDtoDayno
(1800, 1, 1);

149 
	gm_iJª2_2000_DayNo
 = 
CD©eTime
::
YMDtoDayno
(2000, 1, 2);

150 
	gm_iCu¼’tDayNo
 = 
m_d©e
.
DayNo
();

152 
	gm_iCom·nyCouÁFÜOÃLßdUn™
 = 
m_Com·nyFe
->
C®cuÏ‹Com·nyCouÁ
(
iDeçuÉLßdUn™Size
);

154 
	gm_iCom·nyCouÁ
 = 
m_Com·nyFe
->
C®cuÏ‹Com·nyCouÁ
(
iCu¡om”CouÁ
);

155 
	gm_iS¹FromCom·ny
 = 
m_Com·nyFe
->
C®cuÏ‹S¹FromCom·ny
(
iS¹FromCu¡om”
);

157 
	gm_iLa¡RowNumb”
 = 
m_iS¹FromCom·ny
;

160 
	gm_iCO_AD_ID_START
 = 
šputFes
.
Exchªge
->
G‘Size
(è+ 
m_iS¹FromCom·ny
 + 
iTId’tShiá
;

174 
boŞ
 
G’”©eNextCO_ID
()

176 ++
	gm_iLa¡RowNumb”
;

177 
	gm_bMÜeRecÜds
 = 
m_iLa¡RowNumb”
 < (
m_iS¹FromCom·ny
 + 
m_iCom·nyCouÁ
);

179  (
MÜeRecÜds
());

192 
TId’t
 
G‘Cu¼’tCO_ID
()

194  (
	gm_Com·nyFe
->
G‘Com·nyId
(
m_iLa¡RowNumb”
));

208 
boŞ
 
G’”©eNextRecÜd
()

210 
	giFoundDayNo
;

214 ià(
	gm_iLa¡RowNumb”
 % 
	gm_iCom·nyCouÁFÜOÃLßdUn™
 == 0)

216 
In™NextLßdUn™
();

219 
	gm_row
.
	gCO_ID
 = 
G‘Cu¼’tCO_ID
();

221 
¡ºıy
(
m_row
.
CO_ST_ID
,

222 
m_Com·nyFe
->
G‘RecÜd
(
m_iLa¡RowNumb”
)->
CO_ST_ID
,

223 (
m_row
.
CO_ST_ID
));

225 
	gm_Com·nyFe
->
C»©eName
Ğ
m_iLa¡RowNumb”
,

226 
m_row
.
CO_NAME
,

227 
¡©ic_ÿ¡
<>((
m_row
.
CO_NAME
)));

229 
¡ºıy
(
m_row
.
CO_IN_ID
,

230 
m_Com·nyFe
->
G‘RecÜd
(
m_iLa¡RowNumb”
)->
CO_IN_ID
,

231 (
m_row
.
CO_IN_ID
));

233 
G’”©eCom·nySPR©e
();

235 
¢´štf
(
m_row
.
CO_CEO
, (m_row.CO_CEO), "%s %s",

236 
m_³rsÚ
.
G‘Fœ¡Name
(
iCEOMuÉ
*
m_row
.
CO_ID
),

237 
m_³rsÚ
.
G‘La¡Name
(
iCEOMuÉ
*
m_row
.
CO_ID
));

239 
¡ºıy
(
m_row
.
CO_DESC
,

240 
m_Com·nyFe
->
G‘RecÜd
(
m_iLa¡RowNumb”
)->
CO_DESC
,

241 (
m_row
.
CO_DESC
));

243 
	gm_row
.
	gCO_AD_ID
 = ++
m_iCO_AD_ID_START
;

245 
	giFoundDayNo
 = 
m_ºd
.
RndIÁRªge
(
m_iJª1_1800_DayNo
, 
m_iJª2_2000_DayNo
);

247 
	gm_row
.
	gCO_OPEN_DATE
.
S‘
(
iFoundDayNo
);

250  
G’”©eNextCO_ID
();

	@include/workload/tpce/egen/CustomerAccountsAndPermissionsTable.h

40 #iâdeà
CUSTOMER_ACCOUNTS_AND_PERMISSIONS_TABLE_H


41 
	#CUSTOMER_ACCOUNTS_AND_PERMISSIONS_TABLE_H


	)

43 
	~"EG’TabËs_commÚ.h
"

44 
	~"Cu¡om”TabË.h
"

45 
	~"Add»ssTabË.h
"

47 
Çme¥aû
 
	gTPCE


49 cÚ¡ 
UINT
 
	giMaxCAP”ms
=3;

50 cÚ¡ 
UINT
 
	giMšAccouÁsP”Cu¡Rªge
[3] = {1, 2, 5};

51 cÚ¡ 
UINT
 
	giMaxAccouÁsP”Cu¡Rªge
[3] = {4, 8, 10};

52 cÚ¡ 
UINT
 
	giMaxAccouÁsP”Cu¡
 = 10;

53 cÚ¡ 
TId’t
 
	giS¹šgBrok”ID
 = 1;

63 cÚ¡ 
TId’t
 
	giAccouÁP”missiÚIDRªge
 = 
INT64_CONST
(4024è* 1024 * 1024 - 
iDeçuÉS¹FromCu¡om”
;

65 cÚ¡ 
UINT
 
	giP”ûÁAccouÁsW™hPos™iveIn™ŸlB®ªû
 = 80;

67 cÚ¡ 
	gfAccouÁIn™ŸlPos™iveB®ªûMax
 = 9999999.99;

68 cÚ¡ 
	gfAccouÁIn™ŸlNeg©iveB®ªûMš
 = -9999999.99;

70 cÚ¡ 
UINT
 
	giP”ûÁAccouÁAdd™iÚ®P”missiÚs_0
 = 60;

71 cÚ¡ 
UINT
 
	giP”ûÁAccouÁAdd™iÚ®P”missiÚs_1
 = 38;

72 cÚ¡ 
UINT
 
	giP”ûÁAccouÁAdd™iÚ®P”missiÚs_2
 = 2;

74 cÚ¡ 
UINT
 
	giP”ûÁAccouÁTaxStusNÚTaxabË
 = 20;

75 cÚ¡ 
UINT
 
	giP”ûÁAccouÁTaxStusTaxabËAndW™hhŞd
 = 50;

76 cÚ¡ 
UINT
 
	giP”ûÁAccouÁTaxStusTaxabËAndDÚtW™hhŞd
 = 30;

80 cÚ¡ 
UINT
 
	giRNGSkOÃRowCu¡om”AccouÁ
 = 10;

82 
	eeTaxStus


84 
	geNÚe
 = -1,

85 
	geNÚTaxabË
 = 0,

86 
	geTaxabËAndW™hhŞd
,

87 
	geTaxabËAndDÚtW™hhŞd


90 
	sCUSTOMER_ACCOUNT_AND_PERMISSION_ROW


92 
CUSTOMER_ACCOUNT_ROW
 
	gm_ÿ
;

93 
ACCOUNT_PERMISSION_ROW
 
	gm_³rm
[
iMaxCAP”ms
+1];

94 } *
	tPCUSTOMER_ACCOUNT_AND_PERMISSION_ROW
;

96 
şass
 
	gCCu¡om”AccouÁsAndP”missiÚsTabË
 : 
public
 
TabËTem¶©e
<
CUSTOMER_ACCOUNT_AND_PERMISSION_ROW
>

98 
TTaxabËAccouÁNameFe
* 
m_pTaxabËAccouÁName
;

99 
TNÚTaxabËAccouÁNameFe
* 
	gm_pNÚTaxabËAccouÁName
;

100 
TId’t
 
	gm_iS¹FromCu¡om”
;

101 
TId’t
 
	gm_iCu¡om”CouÁ
;

102 
TId’t
 
	gm_iS¹šgCA_ID
;

103 
UINT
 
	gm_iRowsToG’FÜCu¡
;

104 
UINT
 
	gm_iRowsG’”©edFÜCu¡
;

105 
CCu¡om”TabË
 
	gm_cu¡
;

106 
CP”sÚ
 
	gm_³rsÚ
;

107 
UINT
 
	gm_iP”msFÜCA
;

108 
TId’t
 
	gm_iBrok”sCouÁ
;

109 
CAdd»ssTabË
 
	gm_addr
;

110 
UINT
 
	gm_iLßdUn™Size
;

111 
CCu¡om”S–eùiÚ
 
	gm_Cu¡om”S–eùiÚ
;

112 
boŞ
 
	gm_bCacheEÇbËd
;

113 
	gm_iCacheSizeNA
;

114 
TId’t
 
	gm_iCacheOff£tNA
;

115 
UINT
* 
	gm_CacheNA
;

116 
	gm_iCacheSizeTS
;

117 
TId’t
 
	gm_iCacheOff£tTS
;

118 
eTaxStus
* 
	gm_CacheTS
;

129 
G’”©eCARow
()

131 
	giAcùTy³
;

135 
G’”©eNextCA_AD
();

137 
	gm_row
.
	gm_ÿ
.
	gCA_C_ID
 = 
G‘Cu¼’tC_ID
();

140 
	gm_row
.
	gm_ÿ
.
	gCA_B_ID
 = 
G’”©eBrok”IdFÜAccouÁ
(
m_row
.
m_ÿ
.
CA_ID
);

143 ià((
	gm_row
.
	gm_ÿ
.
	gCA_TAX_ST
 = ()
G‘AccouÁTaxStus
(
m_row
.
m_ÿ
.
CA_ID
)è=ğ
eNÚTaxabË
)

145 
iAcùTy³
 = (è
m_row
.
m_ÿ
.
CA_ID
 % 
m_pNÚTaxabËAccouÁName
->
G‘Size
();

147 
¢´štf
(
m_row
.
m_ÿ
.
CA_NAME
,

148 (
m_row
.
m_ÿ
.
CA_NAME
),

150 
m_³rsÚ
.
G‘Fœ¡Name
(
m_row
.
m_ÿ
.
CA_C_ID
),

151 
m_³rsÚ
.
G‘La¡Name
(
m_row
.
m_ÿ
.
CA_C_ID
),

152 (
m_pNÚTaxabËAccouÁName
->
G‘RecÜd
(
iAcùTy³
))->
NAME
);

156 
	giAcùTy³
 = (è
m_row
.
m_ÿ
.
CA_ID
 % 
m_pTaxabËAccouÁName
->
G‘Size
();

158 
¢´štf
(
m_row
.
m_ÿ
.
CA_NAME
,

159 (
m_row
.
m_ÿ
.
CA_NAME
),

161 
m_³rsÚ
.
G‘Fœ¡Name
(
m_row
.
m_ÿ
.
CA_C_ID
),

162 
m_³rsÚ
.
G‘La¡Name
(
m_row
.
m_ÿ
.
CA_C_ID
),

163 (
m_pTaxabËAccouÁName
->
G‘RecÜd
(
iAcùTy³
))->
NAME
);

166 ià(
	gm_ºd
.
RndP”ûÁ
Ğ
iP”ûÁAccouÁsW™hPos™iveIn™ŸlB®ªû
 ))

168 
	gm_row
.
	gm_ÿ
.
	gCA_BAL
 = 
m_ºd
.
RndDoubËInüRªge
(0.00, 
fAccouÁIn™ŸlPos™iveB®ªûMax
, 0.01);

172 
	gm_row
.
	gm_ÿ
.
	gCA_BAL
 = 
m_ºd
.
RndDoubËInüRªge
(
fAccouÁIn™ŸlNeg©iveB®ªûMš
, 0.00, 0.01);

188 
FlAPRow
(
TId’t
 
CA_ID
, TId’ˆ
C_ID
, cÚ¡ *
szACL
, 
ACCOUNT_PERMISSION_ROW
 &
row
)

190 
	grow
.
	gAP_CA_ID
 = 
CA_ID
;

191 
	gm_cu¡
.
G‘C_TAX_ID
(
C_ID
, 
row
.
AP_TAX_ID
);

192 
¡ºıy
(
row
.
AP_L_NAME
, 
m_³rsÚ
.
G‘La¡Name
(
C_ID
), (row.AP_L_NAME));

193 
¡ºıy
(
row
.
AP_F_NAME
, 
m_³rsÚ
.
G‘Fœ¡Name
(
C_ID
), (row.AP_F_NAME));

194 
¡ºıy
(
row
.
AP_ACL
, 
szACL
, (row.AP_ACL));

206 
G’”©eAPRows
()

208 
	giAdd™iÚ®P”ms
;

209 
TId’t
 
	gCID_1
, 
	gCID_2
;

214 
FlAPRow
(
m_row
.
m_ÿ
.
CA_ID
, m_row.m_ÿ.
CA_C_ID
, "0000", m_row.
m_³rm
[0]);

216 
	giAdd™iÚ®P”ms
 = 
G‘NumP”msFÜCA
(
m_row
.
m_ÿ
.
CA_ID
);

217 
	giAdd™iÚ®P”ms
)

220 
m_iP”msFÜCA
 = 1;

223 
G‘CIDsFÜP”missiÚs
(
m_row
.
m_ÿ
.
CA_ID
, m_row.m_ÿ.
CA_C_ID
, &
CID_1
, 
NULL
);

224 
	gm_iP”msFÜCA
 = 2;

226 
FlAPRow
(
m_row
.
m_ÿ
.
CA_ID
, 
CID_1
, "0001", m_row.
m_³rm
[1]);

229 
G‘CIDsFÜP”missiÚs
(
m_row
.
m_ÿ
.
CA_ID
, m_row.m_ÿ.
CA_C_ID
, &
CID_1
, &
CID_2
);

230 
	gm_iP”msFÜCA
 = 3;

232 
FlAPRow
(
m_row
.
m_ÿ
.
CA_ID
, 
CID_1
, "0001", m_row.
m_³rm
[1]);

234 
FlAPRow
(
m_row
.
m_ÿ
.
CA_ID
, 
CID_2
, "0011", m_row.
m_³rm
[2]);

240 
	gpublic
:

253 
CCu¡om”AccouÁsAndP”missiÚsTabË
(
CIÅutFes
 
šputFes
,

254 
UINT
 
iLßdUn™Size
,

255 
TId’t
 
iCu¡om”CouÁ
,

256 
TId’t
 
iS¹FromCu¡om”
,

257 
boŞ
 
bCacheEÇbËd
 = 
çl£


259 : 
TabËTem¶©e
<
CUSTOMER_ACCOUNT_AND_PERMISSION_ROW
>()

260 , 
m_pTaxabËAccouÁName
(
šputFes
.
TaxabËAccouÁName
)

261 , 
m_pNÚTaxabËAccouÁName
(
šputFes
.
NÚTaxabËAccouÁName
)

262 , 
m_iS¹FromCu¡om”
(
iS¹FromCu¡om”
)

263 , 
m_iCu¡om”CouÁ
(
iCu¡om”CouÁ
)

264 , 
m_iRowsToG’FÜCu¡
(0), 
m_iRowsG’”©edFÜCu¡
(0)

265 , 
m_cu¡
(
šputFes
, 
iCu¡om”CouÁ
, 
iS¹FromCu¡om”
)

266 , 
m_³rsÚ
(
šputFes
, 
iS¹FromCu¡om”
, 
bCacheEÇbËd
)

267 , 
m_iP”msFÜCA
(0)

268 , 
m_iBrok”sCouÁ
(
iLßdUn™Size
 / 
iBrok”sDiv
)

269 , 
m_addr
(
šputFes
, 
iCu¡om”CouÁ
, 
iS¹FromCu¡om”
, 
bCacheEÇbËd
)

270 , 
m_iLßdUn™Size
(
iLßdUn™Size
)

271 , 
m_bCacheEÇbËd
(
bCacheEÇbËd
)

273 ià(
	gm_bCacheEÇbËd
)

275 
	gm_iCacheSizeNA
 = 
iDeçuÉLßdUn™Size
;

276 
	gm_iCacheOff£tNA
 = 
iS¹FromCu¡om”
 + 
iTId’tShiá
;

277 
	gm_CacheNA
 = 
Ãw
 
UINT
[
m_iCacheSizeNA
];

278 
	gi
=0; i<
	gm_iCacheSizeNA
; i++)

280 
	gm_CacheNA
[
i
] = 0;

283 
	gm_iCacheSizeTS
 = 
iDeçuÉLßdUn™Size
 * 
iMaxAccouÁsP”Cu¡
;

284 
	gm_iCacheOff£tTS
 = ((
iS¹FromCu¡om”
-1è+ 
iTId’tShiá
è* 
iMaxAccouÁsP”Cu¡
;

285 
	gm_CacheTS
 = 
Ãw
 
eTaxStus
[
m_iCacheSizeTS
];

286 
	gi
=0; i<
	gm_iCacheSizeTS
; i++)

288 
	gm_CacheTS
[
i
] = 
eNÚe
;

296 ~
CCu¡om”AccouÁsAndP”missiÚsTabË
()

298 ià(
	gm_bCacheEÇbËd
)

300 
	gd–‘e
[] 
	gm_CacheNA
;

301 
	gd–‘e
[] 
	gm_CacheTS
;

314 
In™NextLßdUn™
()

316 
	gm_ºd
.
S‘S“d
(
m_ºd
.
RndNthEËm’t
(
RNGS“dTabËDeçuÉ
,

317 (
RNGSEED
)(
G‘Cu¼’tC_ID
(è* 
iMaxAccouÁsP”Cu¡
 *

318 
iRNGSkOÃRowCu¡om”AccouÁ
)));

320 
CË¬RecÜd
();

322 ià(
	gm_bCacheEÇbËd
)

324 
	gm_iCacheOff£tNA
 +ğ
iDeçuÉLßdUn™Size
;

325 
	gi
=0; i<
	gm_iCacheSizeNA
; i++)

327 
	gm_CacheNA
[
i
] = 0;

329 
	gm_iCacheOff£tTS
 +ğ
iDeçuÉLßdUn™Size
 * 
iMaxAccouÁsP”Cu¡
;

330 
	gi
=0; i<
	gm_iCacheSizeTS
; i++)

332 
	gm_CacheTS
[
i
] = 
eNÚe
;

347 
UINT
 
G‘Numb”OfAccouÁs
(
TId’t
 
CID
, 
eCu¡om”T›r
 
iCu¡om”T›r
)

349 
UINT
 
	giNumAccouÁs
 = 0;

354 
TId’t
 
	gšdex
 = 
CID
 - 
m_iCacheOff£tNA
;

355 
boŞ
 
	gbCheckCache
 = (
šdex
 >ğ0 && index < 
m_iCacheSizeNA
);

356 ià(
	gm_bCacheEÇbËd
 && 
	gbCheckCache
)

358 
	giNumAccouÁs
 = 
m_CacheNA
[
šdex
];

361 ià(
	giNumAccouÁs
 == 0)

363 
UINT
 
iMšAccouÁCouÁ
;

364 
UINT
 
	giMod
;

365 
UINT
 
	giInv”£CID
;

367 
	giMšAccouÁCouÁ
 = 
iMšAccouÁsP”Cu¡Rªge
[
iCu¡om”T›r
 - 
eCu¡om”T›rOÃ
];

368 
	giMod
 = 
iMaxAccouÁsP”Cu¡Rªge
[
iCu¡om”T›r
 - 
eCu¡om”T›rOÃ
] - 
iMšAccouÁCouÁ
 + 1;

369 
	giInv”£CID
 = 
m_Cu¡om”S–eùiÚ
.
G‘Inv”£CID
(
CID
);

373 ià(
	giInv”£CID
 < 200)

375 
	giNumAccouÁs
 = (
iInv”£CID
 % 
iMod
è+ 
iMšAccouÁCouÁ
;

379 ià(
	giInv”£CID
 < 800)

381 
	giNumAccouÁs
 = ((
iInv”£CID
 - 200 + 1è% 
iMod
è+ 
iMšAccouÁCouÁ
;

385 
	giNumAccouÁs
 = ((
iInv”£CID
 - 800 + 2è% 
iMod
è+ 
iMšAccouÁCouÁ
;

389 ià(
	gm_bCacheEÇbËd
 && 
	gbCheckCache
)

391 
	gm_CacheNA
[
šdex
] = 
iNumAccouÁs
;

394  
	giNumAccouÁs
;

411 
G’”©eRªdomAccouÁId
(
CRªdom
& 
RND
,

412 
TId’t
 
iCu¡om”Id
,

413 
eCu¡om”T›r
 
iCu¡om”T›r
,

414 
TId’t
* 
piCu¡om”AccouÁ
,

415 * 
piAccouÁCouÁ
)

417 
TId’t
 
	giCu¡om”AccouÁ
;

418 
	giAccouÁCouÁ
;

419 
TId’t
 
	giS¹šgAccouÁ
;

421 
	giAccouÁCouÁ
 = 
G‘Numb”OfAccouÁs
(
iCu¡om”Id
, 
iCu¡om”T›r
);

423 
	giS¹šgAccouÁ
 = 
G‘S¹šgCA_ID
(
iCu¡om”Id
);

427 
	giCu¡om”AccouÁ
 = 
RND
.
RndIÁ64Rªge
(
iS¹šgAccouÁ
,

428 
iS¹šgAccouÁ
 + 
iAccouÁCouÁ
 - 1);

430 ià(
	gpiCu¡om”AccouÁ
 !ğ
NULL
)

432 *
piCu¡om”AccouÁ
 = 
iCu¡om”AccouÁ
;

435 ià(
	gpiAccouÁCouÁ
 !ğ
NULL
)

437 *
piAccouÁCouÁ
 = 
iAccouÁCouÁ
;

452 
TId’t
 
G’”©eRªdomAccouÁId
Ğ
CRªdom
& 
RND
, TId’ˆ
iCu¡om”Id
,

453 
eCu¡om”T›r
 
iCu¡om”T›r
)

455 
TId’t
 
	giAccouÁOff£t
;

456 
INT32
 
	giAccouÁCouÁ
;

457 
TId’t
 
	giS¹šgAccouÁ
;

459 
	giAccouÁCouÁ
 = 
G‘Numb”OfAccouÁs
(
iCu¡om”Id
, 
iCu¡om”T›r
);

461 
	giS¹šgAccouÁ
 = 
G‘S¹šgCA_ID
(
iCu¡om”Id
);

463 
	giAccouÁOff£t
 = (
TId’t
è
RND
.
RndIÁ64Rªge
( 0,

464 (
INT64
è
iAccouÁCouÁ
 - 1 );

466 Ğ
	giS¹šgAccouÁ
 + 
	giAccouÁOff£t
 );

479 
TId’t
 
G‘S¹šgCA_ID
(TId’ˆ
CID
)

482  ((
	gCID
-1è* 
	giMaxAccouÁsP”Cu¡
 + 1);

495 
TId’t
 
G‘EndšgCA_ID
(TId’ˆ
CID
)

497  (
	gCID
 + 
	giTId’tShiá
è* 
	giMaxAccouÁsP”Cu¡
;

512 
TId’t
 
G’”©eNextCA_AD
()

514 ià(
G‘Cu¼’tC_ID
(è% 
	giDeçuÉLßdUn™Size
 == 0)

516 
In™NextLßdUn™
();

519 ++
	gm_iLa¡RowNumb”
;

521 ià(
	gm_iRowsG’”©edFÜCu¡
 =ğ
m_iRowsToG’FÜCu¡
)

523 
m_cu¡
.
G’”©eNextC_ID
();

524 
	gm_addr
.
G’”©eNextAD_ID
();

525 
	gm_iRowsG’”©edFÜCu¡
 = 0;

527 
	gm_iRowsToG’FÜCu¡
 = 
G‘Numb”OfAccouÁs
(
m_cu¡
.
G‘Cu¼’tC_ID
(),

528 
m_cu¡
.
G‘C_TIER
(m_cu¡.
G‘Cu¼’tC_ID
()));

530 
	gm_iS¹šgCA_ID
 = 
G‘S¹šgCA_ID
(
m_cu¡
.
G‘Cu¼’tC_ID
());

533 
	gm_row
.
	gm_ÿ
.
	gCA_ID
 = 
m_iS¹šgCA_ID
 + 
m_iRowsG’”©edFÜCu¡
;

535 ++
	gm_iRowsG’”©edFÜCu¡
;

538 
	gm_bMÜeRecÜds
 = 
m_cu¡
.
MÜeRecÜds
(è|| 
m_iRowsG’”©edFÜCu¡
 < 
m_iRowsToG’FÜCu¡
;

540  
	gm_row
.
	gm_ÿ
.
	gCA_ID
;

553 
G‘NumP”msFÜCA
(
TId’t
 
CA_ID
)

555 
RNGSEED
 
	gOldS“d
;

556 
UINT
 
	giTh»shŞd
;

557 
UINT
 
	giNumb”OfP”missiÚs
;

559 
	gOldS“d
 = 
m_ºd
.
G‘S“d
();

561 
	gm_ºd
.
S‘S“d
Ğ
m_ºd
.
RndNthEËm’t
(

562 
RNGS“dBa£Numb”OfAccouÁP”missiÚs
, (
RNGSEED
)
CA_ID
 ));

564 
	giTh»shŞd
 = 
m_ºd
.
RndG’”©eIÁeg”P”ûÁage
();

566 ià(
	giTh»shŞd
 <ğ
iP”ûÁAccouÁAdd™iÚ®P”missiÚs_0
)

568 
iNumb”OfP”missiÚs
 = 0;

572 ià(
	giTh»shŞd
 <ğ
iP”ûÁAccouÁAdd™iÚ®P”missiÚs_0
 +

573 
iP”ûÁAccouÁAdd™iÚ®P”missiÚs_1
)

575 
iNumb”OfP”missiÚs
 = 1;

579 
	giNumb”OfP”missiÚs
 = 2;

583 
	gm_ºd
.
S‘S“d
Ğ
OldS“d
 );

584 Ğ
	giNumb”OfP”missiÚs
 );

600 
G‘CIDsFÜP”missiÚs
(
TId’t
 
CA_ID
, TId’ˆ
OwÃr_CID
, TId’ˆ*
CID_1
, TId’ˆ*
CID_2
)

602 
RNGSEED
 
	gOldS“d
;

604 ià(
	gCID_1
 =ğ
NULL
)

607 
	gOldS“d
 = 
m_ºd
.
G‘S“d
();

608 
	gm_ºd
.
S‘S“d
Ğ
m_ºd
.
RndNthEËm’t
Ğ
RNGS“dBa£CIDFÜP”missiÚ1
, (
RNGSEED
è
CA_ID
 ));

614 *
	gCID_1
 = 
m_ºd
.
RndIÁ64RªgeExşude
(
iDeçuÉS¹FromCu¡om”
,

615 
iDeçuÉS¹FromCu¡om”
 + 
iAccouÁP”missiÚIDRªge
,

616 
OwÃr_CID
);

618 ià(
	gCID_2
 !ğ
NULL
)

625 
m_ºd
.
S‘S“d
Ğm_ºd.
RndNthEËm’t
Ğ
RNGS“dBa£CIDFÜP”missiÚ2
, (
RNGSEED
è
CA_ID
 ));

628 *
	gCID_2
 = 
m_ºd
.
RndIÁ64RªgeExşude
(
iDeçuÉS¹FromCu¡om”
,

629 
iDeçuÉS¹FromCu¡om”
 + 
iAccouÁP”missiÚIDRªge
,

630 
OwÃr_CID
);

632 *
	gCID_2
 =ğ*
CID_1
);

635 
	gm_ºd
.
S‘S“d
Ğ
OldS“d
 );

648 
eTaxStus
 
G‘AccouÁTaxStus
(
TId’t
 
iCA_ID
)

650 
eTaxStus
 
	geCATaxStus
 = 
eNÚe
;

655 
TId’t
 
	gšdex
 = 
iCA_ID
 - 
m_iCacheOff£tTS
;

656 
boŞ
 
	gbCheckCache
 = (
šdex
 >ğ0 && index < 
m_iCacheSizeTS
);

657 ià(
	gm_bCacheEÇbËd
 && 
	gbCheckCache
)

659 
	geCATaxStus
 = 
m_CacheTS
[
šdex
];

662 ià(
	geCATaxStus
 =ğ
eNÚe
)

664 
RNGSEED
 
OldS“d
;

665 
UINT
 
	giTh»shŞd
;

667 
	gOldS“d
 = 
m_ºd
.
G‘S“d
();

669 
	gm_ºd
.
S‘S“d
Ğ
m_ºd
.
RndNthEËm’t
Ğ
RNGS“dBa£AccouÁTaxStus
, (
RNGSEED
è
iCA_ID
 ));

671 
	giTh»shŞd
 = 
m_ºd
.
RndG’”©eIÁeg”P”ûÁage
();

672 ià(
	giTh»shŞd
 <ğ
iP”ûÁAccouÁTaxStusNÚTaxabË
)

674 
eCATaxStus
 = 
eNÚTaxabË
;

678 ià(
	giTh»shŞd
 <ğ
iP”ûÁAccouÁTaxStusNÚTaxabË
 + 
iP”ûÁAccouÁTaxStusTaxabËAndW™hhŞd
)

680 
eCATaxStus
 = 
eTaxabËAndW™hhŞd
;

684 
	geCATaxStus
 = 
eTaxabËAndDÚtW™hhŞd
;

687 
	gm_ºd
.
S‘S“d
Ğ
OldS“d
 );

689 ià(
	gm_bCacheEÇbËd
 && 
	gbCheckCache
)

691 
	gm_CacheTS
[
šdex
] = 
eCATaxStus
;

694  
	geCATaxStus
;

710 
G‘DivisiÚAndCouÁryCodesFÜCu¼’tAccouÁ
(
UINT
 &
iDivCode
, UINT &
iCŒyCode
)

712 
	gm_addr
.
G‘DivisiÚAndCouÁryCodes
(
iDivCode
, 
iCŒyCode
);

725 
TId’t
 
G’”©eBrok”IdFÜAccouÁ
(TId’ˆ
iCA_ID
)

729 
TId’t
 
	giCu¡om”Id
 = ((
iCA_ID
 - 1è/ 
iMaxAccouÁsP”Cu¡
è- 
iTId’tShiá
;

733 
TId’t
 
	giS¹FromBrok”
 = (
iCu¡om”Id
 / 
m_iLßdUn™Size
è* 
m_iBrok”sCouÁ
 + 
iS¹šgBrok”ID
 + 
iTId’tShiá
;

737  
	gm_ºd
.
RndNthIÁ64Rªge
(
RNGS“dBa£Brok”Id
, (
RNGSEED
è
iCA_ID
 - (10 * 
iTId’tShiá
),

738 
iS¹FromBrok”
,

739 
iS¹FromBrok”
 + 
m_iBrok”sCouÁ
 - 1);

753 
boŞ
 
G’”©eNextRecÜd
()

755 
G’”©eCARow
();

756 
G’”©eAPRows
();

759  (
MÜeRecÜds
());

771 
PCUSTOMER_ACCOUNT_ROW
 
G‘CARow
(è{ &
	gm_row
.
	gm_ÿ
;}

781 
PACCOUNT_PERMISSION_ROW
 
G‘APRow
(
UINT
 
i
)

783 ià(
	gi
<
	gm_iP”msFÜCA
)

784  &
	gm_row
.
	gm_³rm
[
i
];

786  
	gNULL
;

798 
UINT
 
G‘CAP”msCouÁ
(è{ 
	gm_iP”msFÜCA
;}

809 
TId’t
 
G‘Cu¼’tC_ID
(è{ 
	gm_cu¡
.GetCurrentC_ID();}

819 
eCu¡om”T›r
 
G‘Cu¼’tC_TIER
(è{ 
	gm_cu¡
.
G‘C_TIER
(
m_cu¡
.
G‘Cu¼’tC_ID
());}

	@include/workload/tpce/egen/CustomerSelection.h

47 #iâdeà
CUSTOMER_SELECTION_H


48 
	#CUSTOMER_SELECTION_H


	)

50 
	~"Rªdom.h
"

52 
Çme¥aû
 
	gTPCE


58 
	eeCu¡om”T›r


60 
	geCu¡om”T›rOÃ
 = 1,

61 
	geCu¡om”T›rTwo
,

62 
	geCu¡om”T›rTh»e


65 şas 
	cCCu¡om”S–eùiÚ


67 
CRªdom
* 
	gm_pRND
;

69 
TId’t
 
	gm_iS¹FromCu¡om”
;

70 
TId’t
 
	gm_iCu¡om”CouÁ
;

75 
boŞ
 
	gm_bP¬t™iÚByCID
;

76 
	gm_iP¬t™iÚP”ûÁ
;

77 
TId’t
 
	gm_iMyS¹FromCu¡om”
;

78 
TId’t
 
	gm_iMyCu¡om”CouÁ
;

83 
TId’t
 
P”mu‹
(TId’ˆ
iLow
, TId’ˆ
iHigh
);

88 
TId’t
 
Inv”£P”mu‹
(TId’ˆ
iLow
, TId’ˆ
iHigh
);

93 
šlše
 
TId’t
 
CLow
(TId’ˆ
C_ID
è{  ((
	gC_ID
 - 1) % 1000); }

98 
šlše
 
TId’t
 
CHigh
(TId’ˆ
C_ID
è{  ((
	gC_ID
 - 1) / 1000); }

100 
	gpublic
:

105 
CCu¡om”S–eùiÚ
();

110 
CCu¡om”S–eùiÚ
Ğ
CRªdom
* 
pRND
,

111 
TId’t
 
iS¹FromCu¡om”
,

112 
TId’t
 
iCu¡om”CouÁ
);

117 
CCu¡om”S–eùiÚ
Ğ
CRªdom
* 
pRND
,

118 
TId’t
 
iS¹FromCu¡om”
,

119 
TId’t
 
iCu¡om”CouÁ
,

120 
iP¬t™iÚP”ûÁ
,

121 
TId’t
 
iMyS¹FromCu¡om”
,

122 
TId’t
 
iMyCu¡om”CouÁ
);

127 
S‘P¬t™iÚRªge
(
TId’t
 
iS¹FromCu¡om”
, TId’ˆ
iCu¡om”CouÁ
);

132 
UINT
 
G‘Inv”£CID
(
TId’t
 
C_ID
);

137 
eCu¡om”T›r
 
G‘T›r
(
TId’t
 
C_ID
);

142 
G’”©eRªdomCu¡om”
(
TId’t
 &
C_ID
, 
eCu¡om”T›r
 &
C_TIER
);

	@include/workload/tpce/egen/CustomerTable.h

40 #iâdeà
CUSTOMER_TABLE_H


41 
	#CUSTOMER_TABLE_H


	)

43 
	~"EG’TabËs_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


47 cÚ¡ 
	giNumEMAIL_DOMAINs
 = 6;

49 
şass
 
	gCCu¡om”TabË
 : 
public
 
TabËTem¶©e
<
CUSTOMER_ROW
>

51 
´iv©e
:

52 
TId’t
 
m_iRowsToG’”©e
;

53 
CP”sÚ
 
	gm_³rsÚ
;

54 
TA»aCodeFe
* 
	gm_PhÚes
;

55 
TId’t
 
	gm_iS¹FromCu¡om”
;

56 
TId’t
 
	gm_iCu¡om”CouÁ
;

57 
TId’t
 
	gm_iCom·nyCouÁ
;

58 
	gm_iExchªgeCouÁ
;

59 
TStusTy³Fe
* 
	gm_StusTy³Fe
;

60 
CCu¡om”S–eùiÚ
 
	gm_Cu¡om”S–eùiÚ
;

62 
G’”©eC_ST_ID
();

63 
G’”©eP”sÚInfo
();

64 
G’”©eC_DOB
();

65 
G’”©eC_AD_ID
();

66 
G’”©eC_CTRY_1
();

67 
G’”©eC_LOCAL_1
();

68 
G’”©eC_AREA_1
();

69 
G’”©eC_EXT_1
();

70 
G’”©eC_CTRY_2
();

71 
G’”©eC_LOCAL_2
();

72 
G’”©eC_AREA_2
();

73 
G’”©eC_EXT_2
();

74 
G’”©eC_CTRY_3
();

75 
G’”©eC_LOCAL_3
();

76 
G’”©eC_AREA_3
();

77 
G’”©eC_EXT_3
();

78 
G’”©eC_EMAIL_1_ªd_C_EMAIL_2
();

83 
In™NextLßdUn™
();

85 
	gpublic
:

94 
CCu¡om”TabË
(
CIÅutFes
 
šputFes
, 
TId’t
 
iCu¡om”CouÁ
, TId’ˆ
iS¹FromCu¡om”
);

96 
TId’t
 
G’”©eNextC_ID
();

97 
TId’t
 
G‘Cu¼’tC_ID
();

99 
G‘C_TAX_ID
(
TId’t
 
C_ID
, *
szOuut
);

100 
eCu¡om”T›r
 
G‘C_TIER
(
TId’t
 
C_ID
);

102 
boŞ
 
G’”©eNextRecÜd
();

	@include/workload/tpce/egen/CustomerTaxratesTable.h

40 #iâdeà
CUSTOMER_TAXRATES_TABLE_H


41 
	#CUSTOMER_TAXRATES_TABLE_H


	)

43 
	~"EG’TabËs_commÚ.h
"

44 
	~"Cu¡om”TabË.h
"

45 
	~"Add»ssTabË.h
"

47 
Çme¥aû
 
	gTPCE


50 cÚ¡ 
UINT
 
	giTaxR©esP”Cu¡
 = 2;

51 cÚ¡ 
	giMaxDivOrCŒyName
 = 6;

55 cÚ¡ 
	giRNGSkOÃRowCu¡om”Tax¿‹
 = 5;

57 
	sCUSTOMER_TAXRATE_ROWS


59 
CUSTOMER_TAXRATE_ROW
 
	gm_row
[
iTaxR©esP”Cu¡
];

60 } *
	tPCUSTOMER_TAXRATE_ROWS
;

62 
şass
 
	gCCu¡om”Tax¿‹sTabË
 : 
public
 
TabËTem¶©e
<
CUSTOMER_TAXRATE_ROWS
>

64 
CCu¡om”TabË
 
m_cu¡
;

65 
CAdd»ssTabË
 
	gm_addr
;

66 
	gCIÅutFeNoWeight
<
	gTTaxR©eIÅutRow
> *
	gm_divisiÚ_¿‹s
;

67 
	gCIÅutFeNoWeight
<
	gTTaxR©eIÅutRow
> *
	gm_couÁry_¿‹s
;

72 
In™NextLßdUn™
()

74 
	gm_ºd
.
S‘S“d
(
m_ºd
.
RndNthEËm’t
(
RNGS“dTabËDeçuÉ
,

75 (
RNGSEED
è
m_cu¡
.
G‘Cu¼’tC_ID
() *

76 
iRNGSkOÃRowCu¡om”Tax¿‹
));

78 
CË¬RecÜd
();

82 
TTaxR©eIÅutRow
 
G‘TaxRow
(
TId’t
 
C_ID
, 
UINT
 
iCode
, 
boŞ
 
bCŒy
)

84 
RNGSEED
 
	gOldS“d
;

85 
UINT
 
	giTh»shŞd
;

86 cÚ¡ 
	gveùÜ
<
	gTTaxR©eIÅutRow
> *
	gpR©es
;

88 
	gOldS“d
 = 
m_ºd
.
G‘S“d
();

90 
	gm_ºd
.
S‘S“d
Ğ
m_ºd
.
RndNthEËm’t
Ğ
RNGS“dBa£TaxR©eRow
,

91 (
RNGSEED
)
C_ID
 ));

93 ià(
	gbCŒy
)

94 
	gpR©es
 = 
m_couÁry_¿‹s
->
G‘RecÜd
(
iCode
-1);

96 
	gpR©es
 = 
m_divisiÚ_¿‹s
->
G‘RecÜd
(
iCode
-1);

98 
	giTh»shŞd
 = (
UINT
è
m_ºd
.
RndIÁRªge
(0, ()
pR©es
->
size
()-1);

100 
	gm_ºd
.
S‘S“d
Ğ
OldS“d
 );

102  (*
	gpR©es
)[
iTh»shŞd
];

105 
	gpublic
:

106 
CCu¡om”Tax¿‹sTabË
(
CIÅutFes
 
šputFes
,

107 
TId’t
 
iCu¡om”CouÁ
,

108 
TId’t
 
iS¹FromCu¡om”
,

109 
boŞ
 
bCacheEÇbËd
 = 
çl£


111 : 
TabËTem¶©e
<
CUSTOMER_TAXRATE_ROWS
>(),

112 
m_cu¡
(
šputFes
, 
iCu¡om”CouÁ
, 
iS¹FromCu¡om”
),

113 
m_addr
(
šputFes
, 
iCu¡om”CouÁ
, 
iS¹FromCu¡om”
, 
Œue
, 
bCacheEÇbËd
),

114 
m_divisiÚ_¿‹s
(
šputFes
.
TaxR©esDivisiÚ
),

115 
m_couÁry_¿‹s
(
šputFes
.
TaxR©esCouÁry
)

122 
boŞ
 
G’”©eNextRecÜd
()

124 
UINT
 
	giDivCode
, 
	giCŒyCode
;

126 ià(
	gm_cu¡
.
G‘Cu¼’tC_ID
(è% 
	giDeçuÉLßdUn™Size
 == 0)

128 
In™NextLßdUn™
();

131 ++
	gm_iLa¡RowNumb”
;

133 
	gm_cu¡
.
G’”©eNextC_ID
();

134 
	gm_addr
.
G’”©eNextAD_ID
();

135 
	gm_addr
.
G‘DivisiÚAndCouÁryCodes
(
iDivCode
, 
iCŒyCode
);

137 
	gm_row
.m_row[0].
	gCX_C_ID
 = 
m_cu¡
.
G‘Cu¼’tC_ID
();

139 
¡ºıy
(
m_row
.m_row[0].
CX_TX_ID
, 
G‘CouÁryTaxRow
(
m_cu¡
.
G‘Cu¼’tC_ID
(), 
iCŒyCode
).
TAX_ID
,

140 (
m_row
.m_row[0].
CX_TX_ID
));

143 
	gm_row
.m_row[1].
	gCX_C_ID
 = 
m_cu¡
.
G‘Cu¼’tC_ID
();

145 
¡ºıy
(
m_row
.m_row[1].
CX_TX_ID
, 
G‘DivisiÚTaxRow
(
m_cu¡
.
G‘Cu¼’tC_ID
(), 
iDivCode
).
TAX_ID
,

146 (
m_row
.m_row[0].
CX_TX_ID
));

148 
	gm_bMÜeRecÜds
 = 
m_cu¡
.
MÜeRecÜds
();

150  (
MÜeRecÜds
());

153 
PCUSTOMER_TAXRATE_ROW
 
G‘RowByIndex
(
UINT
 
i
) {

154 ià(
	gi
<
	giTaxR©esP”Cu¡
)

155  &
	gm_row
.m_row[
i
];

157  
	gNULL
;

160 
UINT
 
G‘TaxR©esCouÁ
(è{ 
	giTaxR©esP”Cu¡
;}

163 
TTaxR©eIÅutRow
 
G‘CouÁryTaxRow
(
TId’t
 
C_ID
, 
UINT
 
iCŒyCode
)

165  
G‘TaxRow
(
C_ID
, 
iCŒyCode
, 
Œue
);

169 
TTaxR©eIÅutRow
 
G‘DivisiÚTaxRow
(
TId’t
 
C_ID
, 
UINT
 
iDivCode
)

171  
G‘TaxRow
(
C_ID
, 
iDivCode
, 
çl£
);

	@include/workload/tpce/egen/DM.h

69 #iâdeà
DM_H


70 
	#DM_H


	)

72 
	~"EG’Lßd”_¡dafx.h
"

73 
	~"EG’Ut™›s_¡dafx.h
"

74 
	~"TxnH¬ÃssSŒuùs.h
"

75 
	~"DMSUTIÁ”çû.h
"

76 
	~"Ba£Logg”.h
"

77 
	~"Driv”P¬amS‘tšgs.h
"

79 
Çme¥aû
 
	gTPCE


82 şas 
	cCDM


84 
	g´iv©e
:

85 
CDriv”Glob®S‘tšgs
 
m_Driv”Glob®S‘tšgs
;

86 
CDriv”DMS‘tšgs
 
	gm_Driv”DMS‘tšgs
;

88 
CRªdom
 
	gm_ºd
;

89 
CCu¡om”S–eùiÚ
 
	gm_Cu¡om”S–eùiÚ
;

90 
CCu¡om”AccouÁsAndP”missiÚsTabË
 
	gm_AccsAndP”ms
;

91 
CSecur™yFe
* 
	gm_pSecur™›s
;

92 
CCom·nyFe
* 
	gm_pCom·n›s
;

93 
TTaxR©esDivisiÚFe
* 
	gm_pTaxR©esDivisiÚ
;

94 
TStusTy³Fe
* 
	gm_pStusTy³
;

95 
TId’t
 
	gm_iSecur™yCouÁ
;

96 
TId’t
 
	gm_iCom·nyCouÁ
;

97 
TId’t
 
	gm_iS¹FromCom·ny
;

98 
INT32
 
	gm_iDivisiÚTaxCouÁ
;

99 
TId’t
 
	gm_iS¹FromCu¡om”
;

101 
INT32
 
	gm_D©aMaš‹ÇnûTabËNum
;

103 
TD©aMaš‹ÇnûTxnIÅut
 
	gm_TxnIÅut
;

104 
TT¿deCËªupTxnIÅut
 
	gm_CËªupTxnIÅut
;

105 
CDMSUTIÁ”çû
* 
	gm_pSUT
;

106 
CBa£Logg”
* 
	gm_pLogg”
;

109 
AutoS‘RNGS“ds
Ğ
UINT32
 
UniqueId
 );

111 
TId’t
 
G’”©eRªdomCu¡om”Id
();

113 
TId’t
 
G’”©eRªdomCu¡om”AccouÁId
();

115 
TId’t
 
G’”©eRªdomCom·nyId
();

117 
TId’t
 
G’”©eRªdomSecur™yId
();

120 
In™Ÿlize
();

122 
	gpublic
:

124 
CDM
Ğ
CDMSUTIÁ”çû
 *
pSUT
, 
CBa£Logg”
 *
pLogg”
, 
CIÅutFes
 &
šputFes
, 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
, 
INT32
 
iSÿËFaùÜ
, INT32 
iDaysOfIn™ŸlT¿des
, 
UINT32
 
UniqueId
 );

127 
CDM
Ğ
CDMSUTIÁ”çû
 *
pSUT
, 
CBa£Logg”
 *
pLogg”
, 
CIÅutFes
 &
šputFes
, 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
, 
INT32
 
iSÿËFaùÜ
, INT32 
iDaysOfIn™ŸlT¿des
, 
UINT32
 
UniqueId
, 
RNGSEED
 
RNGS“d
 );

129 ~
CDM
( );

131 
RNGSEED
 
G‘RNGS“d
( );

132 
DoTxn
( );

133 
DoCËªupTxn
( );

134 
TD©aMaš‹ÇnûTxnIÅut
* 
ü—‹DMIÅut
();

135 
TT¿deCËªupTxnIÅut
* 
ü—‹TCIÅut
();

	@include/workload/tpce/egen/DMSUTInterface.h

42 #iâdeà
DM_SUT_INTERFACE_H


43 
	#DM_SUT_INTERFACE_H


	)

45 
	~"TxnH¬ÃssSŒuùs.h
"

47 
Çme¥aû
 
	gTPCE


50 şas 
	cCDMSUTIÁ”çû


52 
	gpublic
:

63 
vœtu®
 ~
CDMSUTIÁ”çû
() {};

65 
vœtu®
 
boŞ
 
D©aMaš‹Çnû
Ğ
PD©aMaš‹ÇnûTxnIÅut
 
pTxnIÅut
 ) = 0;

66 
vœtu®
 
boŞ
 
T¿deCËªup
Ğ
PT¿deCËªupTxnIÅut
 
pTxnIÅut
 ) = 0;

	@include/workload/tpce/egen/DailyMarketTable.h

40 #iâdeà
DAILY_MARKET_TABLE_H


41 
	#DAILY_MARKET_TABLE_H


	)

43 
	~"EG’TabËs_commÚ.h
"

44 
	~"Secur™yFe.h
"

45 
	~"Secur™yPriûRªge.h
"

47 
Çme¥aû
 
	gTPCE


50 cÚ¡ 
	giT¿deDaysInY—r
 = 261;

51 cÚ¡ 
	giDayM¬k‘Y—rs
 = 5;

52 cÚ¡ 
	giDayM¬k‘TÙ®Rows
 = 
iDayM¬k‘Y—rs
 * 
iT¿deDaysInY—r
;

54 cÚ¡ 
	gfDayM¬k‘Clo£Mš
 = 
fMšSecPriû
;

55 cÚ¡ 
	gfDayM¬k‘Clo£Max
 = 
fMaxSecPriû
;

57 cÚ¡ 
	gfDayM¬k‘HighR–©iveToClo£
 = 1.05;

58 cÚ¡ 
	gfDayM¬k‘LowR–©iveToClo£
 = 0.92;

60 cÚ¡ 
INT64
 
	giDayM¬k‘VŞumeMax
 = 10000;

61 cÚ¡ 
INT64
 
	giDayM¬k‘VŞumeMš
 = 1000;

63 cÚ¡ 
	giRNGSkOÃRowDayM¬k‘
 = 2;

65 
	sDAILY_MARKET_GEN_ROW


68 
DAILY_MARKET_ROW
 
	gm_day_m¬k‘
[
iDayM¬k‘TÙ®Rows
];

69 } *
	tPDAILY_MARKET_GEN_ROW
;

71 
şass
 
	gCDayM¬k‘TabË
 : 
public
 
TabËTem¶©e
<
DAILY_MARKET_GEN_ROW
>

73 
TId’t
 
m_iS¹FromSecur™y
;

74 
TId’t
 
	gm_iSecur™yCouÁ
;

75 
CSecur™yFe
* 
	gm_Secur™yFe
;

76 
CD©eTime
 
	gm_S¹FromD©e
;

77 
	gm_iDayM¬k‘TÙ®Rows
;

80 
	gm_iRowsG’”©edP”Secur™y
;

83 
boŞ
 
	gm_bMÜeSecur™›s
;

84 
TId’t
 
	gm_iSecur™yCouÁFÜOÃLßdUn™
;

89 
G’”©eDayM¬k‘Rows
()

91 
	gi
;

92 
	giDayNo
 = 0;

93 
	gszSymbŞ
[
cSYMBOL_Ën
 + 1];

97 
	gm_Secur™yFe
->
C»©eSymbŞ
(
m_iLa¡RowNumb”
, 
szSymbŞ
, 
¡©ic_ÿ¡
<>((szSymbol)));

99 
	gi
 = 0; i < 
	gm_iDayM¬k‘TÙ®Rows
; ++i)

102 
¡ºıy
(
m_row
.
m_day_m¬k‘
[
i
].
DM_S_SYMB
, 
szSymbŞ
, (m_row.m_daily_market[i].DM_S_SYMB));

105 
	gm_row
.
	gm_day_m¬k‘
[
i
].
	gDM_DATE
 = 
m_S¹FromD©e
;

106 
	gm_row
.
	gm_day_m¬k‘
[
i
].
	gDM_DATE
.
Add
(
iDayNo
, 0);

109 
	gm_row
.
	gm_day_m¬k‘
[
i
].
	gDM_CLOSE
 = 
m_ºd
.
RndDoubËInüRªge
(
fDayM¬k‘Clo£Mš
, 
fDayM¬k‘Clo£Max
, 0.01);

110 
	gm_row
.
	gm_day_m¬k‘
[
i
].
	gDM_HIGH
 = 
m_row
.
m_day_m¬k‘
[i].
DM_CLOSE
 * 
fDayM¬k‘HighR–©iveToClo£
;

111 
	gm_row
.
	gm_day_m¬k‘
[
i
].
	gDM_LOW
 = 
m_row
.
m_day_m¬k‘
[i].
DM_CLOSE
 * 
fDayM¬k‘LowR–©iveToClo£
;

114 
	gm_row
.
	gm_day_m¬k‘
[
i
].
	gDM_VOL
 = 
m_ºd
.
RndIÁ64Rªge
(
iDayM¬k‘VŞumeMš
, 
iDayM¬k‘VŞumeMax
);

116 ++
	giDayNo
;

118 ià((
	giDayNo
 % 
	gDaysP”W“k
è=ğ
DaysP”WÜkW“k
è
iDayNo
 += 2;

131 
In™NextLßdUn™
()

133 
	gm_ºd
.
S‘S“d
(
m_ºd
.
RndNthEËm’t
(
RNGS“dTabËDeçuÉ
,

134 (
RNGSEED
)
m_iLa¡RowNumb”
 * 
iRNGSkOÃRowDayM¬k‘
));

136 
CË¬RecÜd
();

139 
	gpublic
:

143 
CDayM¬k‘TabË
Ğ
CIÅutFes
 
šputFes
,

144 
TId’t
 
iCu¡om”CouÁ
,

145 
TId’t
 
iS¹FromCu¡om”
)

146 : 
TabËTem¶©e
<
DAILY_MARKET_GEN_ROW
>()

147 , 
m_Secur™yFe
(
šputFes
.
Secur™›s
)

148 , 
m_iDayM¬k‘TÙ®Rows
((
m_row
.
m_day_m¬k‘
)/(m_row.m_daily_market[0]))

149 , 
m_iRowsG’”©edP”Secur™y
((
m_row
.
m_day_m¬k‘
)/(m_row.m_daily_market[0]))

150 , 
m_bMÜeSecur™›s
(
Œue
)

154 
	gm_S¹FromD©e
.
S‘
(
iDayM¬k‘Ba£Y—r
, 
iDayM¬k‘Ba£MÚth
,

155 
iDayM¬k‘Ba£Day
, 
iDayM¬k‘Ba£Hour
,

156 
iDayM¬k‘Ba£Mšu‹
, 
iDayM¬k‘Ba£SecÚd
, 
iDayM¬k‘Ba£M£c
);

158 
	gm_bMÜeRecÜds
 = 
Œue
;

160 
	gm_iSecur™yCouÁ
 = 
m_Secur™yFe
->
C®cuÏ‹Secur™yCouÁ
(
iCu¡om”CouÁ
);

161 
	gm_iS¹FromSecur™y
 = 
m_Secur™yFe
->
C®cuÏ‹S¹FromSecur™y
(
iS¹FromCu¡om”
);

163 
	gm_iSecur™yCouÁFÜOÃLßdUn™
 = 
šputFes
.
Secur™›s
->
C®cuÏ‹Secur™yCouÁ
(
iDeçuÉLßdUn™Size
);

165 
	gm_iLa¡RowNumb”
 = 
m_iS¹FromSecur™y
;

168 
boŞ
 
G’”©eNextRecÜd
()

170 ++
	gm_iRowsG’”©edP”Secur™y
;

172 ià(
	gm_iRowsG’”©edP”Secur™y
 >ğ
m_iDayM¬k‘TÙ®Rows
)

174 ià(
m_bMÜeSecur™›s
)

178 ià(
m_iLa¡RowNumb”
 % 
m_iSecur™yCouÁFÜOÃLßdUn™
 == 0)

180 
In™NextLßdUn™
();

183 
G’”©eDayM¬k‘Rows
();

185 ++
	gm_iLa¡RowNumb”
;

188 
	gm_bMÜeSecur™›s
 = 
m_iLa¡RowNumb”
 < (
m_iS¹FromSecur™y
 + 
m_iSecur™yCouÁ
);

190 
	gm_iRowsG’”©edP”Secur™y
 = 0;

195 ià(!
	gm_bMÜeSecur™›s
 && (
	gm_iRowsG’”©edP”Secur™y
 =ğ
m_iDayM¬k‘TÙ®Rows
 - 1))

197 
m_bMÜeRecÜds
 = 
çl£
;

200  (
MÜeRecÜds
());

203 
PDAILY_MARKET_ROW
 
G‘Row
()

205  &
	gm_row
.
	gm_day_m¬k‘
[
m_iRowsG’”©edP”Secur™y
];

	@include/workload/tpce/egen/DateTime.h

37 #iâdeà
DATE_TIME_H


38 
	#DATE_TIME_H


	)

40 #ifdeà
COMPILE_ODBC_LOAD


42 
	~<sql.h
>

43 
	~<sqËxt.h
>

44 
	~<odbcss.h
>

47 
	~"EG’Snd¬dTy³s.h
"

49 
Çme¥aû
 
	gTPCE


55 
	sgTIMESTAMP_STRUCT


57 
INT16
 
	gy—r
;

58 
UINT16
 
	gmÚth
;

59 
UINT16
 
	gday
;

60 
UINT16
 
	ghour
;

61 
UINT16
 
	gmšu‹
;

62 
UINT16
 
	g£cÚd
;

63 
UINT32
 
	gäaùiÚ
;

64 } 
	tTIMESTAMP_STRUCT
;

67 cÚ¡ 
	gNsP”SecÚdDivisÜ
 = 1000000000.0;

68 cÚ¡ 
INT32
 
	gNsP”SecÚd
 = 1000000000;

69 cÚ¡ 
	gMsP”SecÚdDivisÜ
 = 1000.000;

70 cÚ¡ 
INT32
 
	gMsP”SecÚd
 = 1000;

71 cÚ¡ 
INT32
 
	gSecÚdsP”Mšu‹
 = 60;

72 cÚ¡ 
INT32
 
	gMšu‹sP”Hour
 = 60;

73 cÚ¡ 
INT32
 
	gHoursP”Day
 = 24;

74 cÚ¡ 
INT32
 
	gHoursP”WÜkDay
 = 8;

75 cÚ¡ 
INT32
 
	gDaysP”WÜkW“k
 = 5;

76 cÚ¡ 
INT32
 
	gDaysP”W“k
 = 7;

78 cÚ¡ 
INT32
 
	gSecÚdsP”Hour
 = 
SecÚdsP”Mšu‹
 * 
Mšu‹sP”Hour
;

79 cÚ¡ 
INT32
 
	gSecÚdsP”Day
 = 
SecÚdsP”Mšu‹
 * 
Mšu‹sP”Hour
 * 
HoursP”Day
;

80 cÚ¡ 
INT32
 
	gSecÚdsP”WÜkDay
 = 
SecÚdsP”Mšu‹
 * 
Mšu‹sP”Hour
 * 
HoursP”WÜkDay
;

81 cÚ¡ 
INT32
 
	gMsP”Day
 = 
SecÚdsP”Day
 * 
MsP”SecÚd
;

82 cÚ¡ 
INT32
 
	gMsP”WÜkDay
 = 
SecÚdsP”WÜkDay
 * 
MsP”SecÚd
;

84 
	#RoundToN—»¡N£c
(
d_SecÚds
è(Ğ(
INT64
)ĞĞ(d_SecÚdsè* 
NsP”SecÚd
è+ 0.5)è/ 
NsP”SecÚdDivisÜ
)

	)

86 şas 
	cCD©eTime


88 
	g´iv©e
:

89 
INT32
 
m_dayno
;

90 
INT32
 
	gm_m£c
;

91 * 
	gm_szText
;

93 
ä›nd
 
boŞ
 
	gİ”©Ü
 >(cÚ¡ 
	gCD©eTime
& 
	gl_dt
, cÚ¡ CD©eTime& 
	gr_dt
);

95 
	gpublic
:

96 
CD©eTime
();

97 
CD©eTime
(
INT32
 
dayno
);

98 
CD©eTime
(
INT32
 
y—r
, INT32 
mÚth
, INT32 
day
);

99 
CD©eTime
(
INT32
 
y—r
, INT32 
mÚth
, INT32 
day
, INT32 
hour
, INT32 
mšu‹
, INT32 
£cÚd
, INT32 
m£c
);

101 
CD©eTime
(
TIMESTAMP_STRUCT
 *
ts
);

103 
CD©eTime
(cÚ¡ CD©eTime& 
dt
);

104 ~
CD©eTime
();

106 
S‘ToCu¼’t
();

107 
S‘
(
INT32
 
dayno
);

108 
S‘
(
INT32
 
y—r
, INT32 
mÚth
, INT32 
day
);

109 
S‘
(
INT32
 
y—r
, INT32 
mÚth
, INT32 
day
, INT32 
hour
, INT32 
mšu‹
, INT32 
£cÚd
, INT32 
m£c
);

110 
S‘HMS
(
INT32
 
hour
, INT32 
mšu‹
, INT32 
£cÚd
, INT32 
m£c
);

112 
šlše
 
UINT32
 
DayNo
(è{  (
	gUINT32
)
	gm_dayno
; };

113 
šlše
 
UINT32
 
MSec
(è{  (
	gUINT32
)
	gm_m£c
; };

114 
G‘YMD
(
INT32
* 
y—r
, INT32* 
mÚth
, INT32* 
day
);

115 
G‘YMDHMS
(
INT32
* 
y—r
, INT32* 
mÚth
, INT32* 
day
, INT32* 
hour
, INT32* 
mšu‹
, INT32* 
£cÚd
, INT32* 
m£c
);

116 
G‘HMS
(
INT32
* 
hour
, INT32* 
mšu‹
, INT32* 
£cÚd
, INT32* 
m£c
);

118 
G‘TimeSmp
(
TIMESTAMP_STRUCT
* 
ts
);

120 #ifdeà
COMPILE_ODBC_LOAD


121 
G‘DBDATETIME
(
DBDATETIME
* 
dt
);

124 
INT32
 
YMDtoDayno
ĞINT32 
yr
, INT32 
mm
, INT32 
dd
 );

125 * 
ToSŒ
Ğ
INT32
 
¡yË
 );

127 
Add
(
INT32
 
days
, INT32 
m£c
, 
boŞ
 
adju¡_w“k’d
 = 
çl£
);

128 
AddMšu‹s
(
INT32
 
Mšu‹s
);

129 
AddWÜkMs
(
INT64
 
WÜkMs
);

131 
boŞ
 
	gİ”©Ü
 <(cÚ¡ 
	gCD©eTime
&);

132 
boŞ
 
	gİ”©Ü
 <=(cÚ¡ 
CD©eTime
&);

134 
boŞ
 
	gİ”©Ü
 >=(cÚ¡ 
CD©eTime
&);

135 
boŞ
 
	gİ”©Ü
 ==(cÚ¡ 
CD©eTime
&);

139 
	gİ”©Ü
 -(cÚ¡ 
	gCD©eTime
& 
	gdt
);

140 
INT32
 
DiffInMliSecÚds
ĞcÚ¡ 
CD©eTime
& 
Ba£Time
 );

141 
INT32
 
DiffInMliSecÚds
Ğ
CD©eTime
* 
pBa£Time
 );

143 
	gCD©eTime
& 
	gİ”©Ü
 +ğ(cÚ¡ 
CD©eTime
& 
dt
);

145 
	gCD©eTime
& 
	gİ”©Ü
 = (cÚ¡ 
CD©eTime
& 
dt
);

147 
boŞ
 
IsV®id
Ğ
INT32
 
y—r
, INT32 
mÚth
, INT32 
day
, INT32 
hour
, INT32 
mšu‹
, INT32 
£cÚd
, INT32 
m£c
 );

	@include/workload/tpce/egen/DriverParamSettings.h

44 #iâdeà
DRIVER_PARAM_SETTINGS_H


45 
	#DRIVER_PARAM_SETTINGS_H


	)

47 
	~<io¡»am
>

48 
	~<iomª
>

49 
	~<s¡»am
>

51 
	~"EG’Ut™›s_¡dafx.h
"

53 
Çme¥aû
 
	gTPCE


59 
	#DRIVERPARAM_CHECK_EQUAL
(
Çme
, 
lhs
, 
rhs
) \

60 ià((
lhs
è!ğ(
rhs
)) { \

61 
¡d
::
o¡ršg¡»am
 
¡rm
; \

62 
¡rm
 << #lh << "(" << (
lhs
è<< "è!ğ" << #rh << "(" << (
rhs
) << ")"; \

63 
throw
 
	`CCheckE¼
(
Çme
, 
¡rm
.
	`¡r
()); \

64 }

	)

66 
	#DRIVERPARAM_CHECK_GE
(
Çme
, 
lhs
, 
rhs
) \

67 ià((
lhs
è< (
rhs
)) { \

68 
¡d
::
o¡ršg¡»am
 
¡rm
; \

69 
¡rm
 << #lh << "(" << (
lhs
è<< "è< " << #rh << "(" << (
rhs
) << ")"; \

70 
throw
 
	`CCheckE¼
(
Çme
, 
¡rm
.
	`¡r
()); \

71 }

	)

73 
	#DRIVERPARAM_CHECK_LE
(
Çme
, 
lhs
, 
rhs
 ) \

74 ià((
lhs
è> (
rhs
)) { \

75 
¡d
::
o¡ršg¡»am
 
¡rm
; \

76 
¡rm
 << #lh << "(" << (
lhs
è<< "è> " << #rh << "(" << (
rhs
) << ")"; \

77 
throw
 
	`CCheckE¼
(
Çme
, 
¡rm
.
	`¡r
()); \

78 }

	)

80 
	#DRIVERPARAM_CHECK_BETWEEN
(
Çme
, 
lhs
, 
mšv®
, 
maxv®
 ) \

81 
	`DRIVERPARAM_CHECK_GE
(
Çme
, 
lhs
, 
mšv®
 ) \

82 
	`DRIVERPARAM_CHECK_LE
(
Çme
, 
lhs
, 
maxv®
 )

	)

84 
	#DRIVERPARAM_CHECK_DEFAULT
(
Çme
) \

85 ià(
cur
.
Çme
 !ğ
dá
.name) { \

86 
¡d
::
o¡ršg¡»am
 
¡rm
; \

87 
¡rm
 << #Çm<< "(" << 
cur
.
Çme
 << "è!ğ" << 
dá
.name; \

88 
throw
 
	`CCheckE¼
(#Çme, 
¡rm
.
	`¡r
()); \

89 }

	)

95 
	g‹m¶©e
 < 
ty³Çme
 
	gT
 > cÏs 
	cCP¬am‘”sW™houtDeçuÉs


97 
	gpublic
:

98 
T
 
cur
;

100 
CP¬am‘”sW™houtDeçuÉs
() {}

111 
	gvœtu®
 ~
CP¬am‘”sW™houtDeçuÉs
() {};

113 
vœtu®
 
CheckV®id
() = 0;

114 
vœtu®
 
CheckCom¶ŸÁ
() = 0;

115 
boŞ
 
IsV®id
() {

116 
	gŒy
 {

117 
CheckV®id
();

118  
	gŒue
;

119 } 
ÿtch
(...) {

120  
	gçl£
;

124 
boŞ
 
IsCom¶ŸÁ
() {

126 
	gŒy
 {

127 
CheckCom¶ŸÁ
();

128  
	gŒue
;

129 } 
ÿtch
(...) {

130  
	gçl£
;

136 
	g‹m¶©e
 < 
ty³Çme
 
	gT
,y³Çm
	gT2
 > cÏs 
	cCP¬am‘”sW™hDeçuÉs


139 
	gpublic
:

140 
T
 
dá
;

141 
T2
 
	g¡©e
;

143 
	gpublic
:

144 
T
 
cur
;

146 
CP¬am‘”sW™hDeçuÉs
() {}

157 
	gvœtu®
 ~
CP¬am‘”sW™hDeçuÉs
() {};

159 
In™Ÿlize
()

161 
In™ŸlizeDeçuÉs
();

162 
S‘ToDeçuÉs
();

165 
S‘ToDeçuÉs
()

167 
	gcur
 = 
dá
;

168 
CheckDeçuÉs
();

171 
vœtu®
 
In™ŸlizeDeçuÉs
() {}

172 
vœtu®
 
CheckDeçuÉs
() {}

173 
vœtu®
 
CheckV®id
() = 0;

174 
vœtu®
 
CheckCom¶ŸÁ
() = 0;

175 
boŞ
 
IsV®id
() {

176 
	gŒy
 {

177 
CheckV®id
();

178  
	gŒue
;

179 } 
ÿtch
(...) {

180  
	gçl£
;

184 
boŞ
 
IsCom¶ŸÁ
() {

185 
	gŒy
 {

186 
CheckCom¶ŸÁ
();

187  
	gŒue
;

188 } 
ÿtch
(...) {

189  
	gçl£
;

197 
	sTBrok”VŞumeS‘tšgs


199 } *
	gPBrok”VŞumeS‘tšgs
;

201 
	sTCu¡om”Pos™iÚS‘tšgs


203 
INT32
 
	gby_cu¡_id
;

204 
INT32
 
	gby_x_id
;

205 
INT32
 
	gg‘_hi¡Üy
;

206 } *
	tPCu¡om”Pos™iÚS‘tšgs
;

208 
	sTM¬k‘W©chS‘tšgs


210 
INT32
 
	gby_acù_id
;

211 
INT32
 
	gby_šdu¡ry
;

212 
INT32
 
	gby_w©ch_li¡
;

213 } *
	tPM¬k‘W©chS‘tšgs
;

215 
	sTSecur™yD‘aS‘tšgs


217 
INT32
 
	gLOBAcûssP”ûÁage
;

218 } *
	tPSecur™yD‘aS‘tšgs
;

220 
	sTT¿deLookupS‘tšgs


222 
INT32
 
	gdo_äame1
;

223 
INT32
 
	gdo_äame2
;

224 
INT32
 
	gdo_äame3
;

225 
INT32
 
	gdo_äame4
;

227 
INT32
 
	gMaxRowsF¿me1
;

229 
INT32
 
	gBackOffFromEndTimeF¿me2
;

230 
INT32
 
	gMaxRowsF¿me2
;

232 
INT32
 
	gBackOffFromEndTimeF¿me3
;

233 
INT32
 
	gMaxRowsF¿me3
;

235 
INT32
 
	gBackOffFromEndTimeF¿me4
;

236 
INT32
 
	gMaxRowsF¿me4
;

237 } *
	tPT¿deLookupS‘tšgs
;

239 
	sTT¿deOrd”S‘tšgs


241 
INT32
 
	gm¬k‘
;

242 
INT32
 
	glim™
;

243 
INT32
 
	g¡İ_loss
;

244 
INT32
 
	g£cur™y_by_Çme
;

245 
INT32
 
	g£cur™y_by_symbŞ
;

246 
INT32
 
	gbuy_Üd”s
;

247 
INT32
 
	g£Î_Üd”s
;

248 
INT32
 
	glifo
;

249 
INT32
 
	gexec_is_owÃr
;

250 
INT32
 
	grŞlback
;

251 
INT32
 
	gty³_is_m¬gš
;

252 } *
	tPT¿deOrd”S‘tšgs
;

254 
	sTT¿deUpd©eS‘tšgs


256 
INT32
 
	gdo_äame1
;

257 
INT32
 
	gdo_äame2
;

258 
INT32
 
	gdo_äame3
;

260 
INT32
 
	gMaxRowsF¿me1
;

261 
INT32
 
	gMaxRowsToUpd©eF¿me1
;

263 
INT32
 
	gBackOffFromEndTimeF¿me2
;

264 
INT32
 
	gMaxRowsF¿me2
;

265 
INT32
 
	gMaxRowsToUpd©eF¿me2
;

267 
INT32
 
	gBackOffFromEndTimeF¿me3
;

268 
INT32
 
	gMaxRowsF¿me3
;

269 
INT32
 
	gMaxRowsToUpd©eF¿me3
;

270 } *
	tPT¿deUpd©eS‘tšgs
;

272 
	sTTxnMixG’”©ÜS‘tšgs


278 
INT32
 
	gBrok”VŞumeMixLev–
;

279 
INT32
 
	gCu¡om”Pos™iÚMixLev–
;

280 
INT32
 
	gM¬k‘F“dMixLev–
;

281 
INT32
 
	gM¬k‘W©chMixLev–
;

282 
INT32
 
	gSecur™yD‘aMixLev–
;

283 
INT32
 
	gT¿deLookupMixLev–
;

284 
INT32
 
	gT¿deOrd”MixLev–
;

285 
INT32
 
	gT¿deResuÉMixLev–
;

286 
INT32
 
	gT¿deStusMixLev–
;

287 
INT32
 
	gT¿deUpd©eMixLev–
;

290 
INT32
 
	gT¿n§ùiÚMixTÙ®
;

291 } *
	tPTxnMixG’”©ÜS‘tšgs
;

293 
	sTLßd”S‘tšgs


295 
TId’t
 
	giCÚfigu»dCu¡om”CouÁ
;

296 
TId’t
 
	giAùiveCu¡om”CouÁ
;

297 
INT32
 
	giSÿËFaùÜ
;

298 
INT32
 
	giDaysOfIn™ŸlT¿des
;

299 
TId’t
 
	giS¹šgCu¡om”
;

300 
TId’t
 
	giCu¡om”CouÁ
;

301 } *
	tpLßd”S‘tšgs
;

303 
	sTDriv”Glob®S‘tšgs


305 
TId’t
 
	giCÚfigu»dCu¡om”CouÁ
;

306 
TId’t
 
	giAùiveCu¡om”CouÁ
;

307 
INT32
 
	giSÿËFaùÜ
;

308 
INT32
 
	giDaysOfIn™ŸlT¿des
;

309 } *
	tPDriv”Glob®S‘tšgs
;

311 
	sTDriv”CES‘tšgs


313 
UINT32
 
	gUniqueId
;

314 
RNGSEED
 
	gTxnMixRNGS“d
;

315 
RNGSEED
 
	gTxnIÅutRNGS“d
;

316 } *
	tPDriv”CES‘tšgs
;

318 
	sTDriv”CEP¬t™iÚS‘tšgs


320 
TId’t
 
	giMyS¹šgCu¡om”Id
;

321 
TId’t
 
	giMyCu¡om”CouÁ
;

322 
INT32
 
	giP¬t™iÚP”ûÁ
;

323 } *
	tPDriv”CEP¬t™iÚS‘tšgs
;

325 
	sTDriv”MEES‘tšgs


327 
UINT32
 
	gUniqueId
;

328 
RNGSEED
 
	gRNGS“d
;

329 
RNGSEED
 
	gTick”T­eRNGS“d
;

330 
RNGSEED
 
	gT¿dšgFloÜRNGS“d
;

331 } *
	tPDriv”MEES‘tšgs
;

333 
	sTDriv”DMS‘tšgs


335 
UINT32
 
	gUniqueId
;

336 
RNGSEED
 
	gRNGS“d
;

337 } *
	tPDriv”DMS‘tšgs
;

342 
	sTBrok”VŞumeS‘tšgsS‹


346 
	sTCu¡om”Pos™iÚS‘tšgsS‹


348 
boŞ
 
	gby_cu¡_id
;

349 
boŞ
 
	gby_x_id
;

350 
boŞ
 
	gg‘_hi¡Üy
;

353 
	sTM¬k‘W©chS‘tšgsS‹


355 
boŞ
 
	gby_acù_id
;

356 
boŞ
 
	gby_šdu¡ry
;

357 
boŞ
 
	gby_w©ch_li¡
;

360 
	sTSecur™yD‘aS‘tšgsS‹


362 
boŞ
 
	gLOBAcûssP”ûÁage
;

365 
	sTT¿deLookupS‘tšgsS‹


367 
boŞ
 
	gdo_äame1
;

368 
boŞ
 
	gdo_äame2
;

369 
boŞ
 
	gdo_äame3
;

370 
boŞ
 
	gdo_äame4
;

372 
boŞ
 
	gMaxRowsF¿me1
;

374 
boŞ
 
	gBackOffFromEndTimeF¿me2
;

375 
boŞ
 
	gMaxRowsF¿me2
;

377 
boŞ
 
	gBackOffFromEndTimeF¿me3
;

378 
boŞ
 
	gMaxRowsF¿me3
;

380 
boŞ
 
	gBackOffFromEndTimeF¿me4
;

381 
boŞ
 
	gMaxRowsF¿me4
;

384 
	sTT¿deOrd”S‘tšgsS‹


386 
boŞ
 
	gm¬k‘
;

387 
boŞ
 
	glim™
;

388 
boŞ
 
	g¡İ_loss
;

389 
boŞ
 
	g£cur™y_by_Çme
;

390 
boŞ
 
	g£cur™y_by_symbŞ
;

391 
boŞ
 
	gbuy_Üd”s
;

392 
boŞ
 
	g£Î_Üd”s
;

393 
boŞ
 
	glifo
;

394 
boŞ
 
	gexec_is_owÃr
;

395 
boŞ
 
	grŞlback
;

396 
boŞ
 
	gty³_is_m¬gš
;

399 
	sTT¿deUpd©eS‘tšgsS‹


401 
boŞ
 
	gdo_äame1
;

402 
boŞ
 
	gdo_äame2
;

403 
boŞ
 
	gdo_äame3
;

405 
boŞ
 
	gMaxRowsF¿me1
;

406 
boŞ
 
	gMaxRowsToUpd©eF¿me1
;

408 
boŞ
 
	gBackOffFromEndTimeF¿me2
;

409 
boŞ
 
	gMaxRowsF¿me2
;

410 
boŞ
 
	gMaxRowsToUpd©eF¿me2
;

412 
boŞ
 
	gBackOffFromEndTimeF¿me3
;

413 
boŞ
 
	gMaxRowsF¿me3
;

414 
boŞ
 
	gMaxRowsToUpd©eF¿me3
;

417 
	sTTxnMixG’”©ÜS‘tšgsS‹


419 
boŞ
 
	gBrok”VŞumeMixLev–
;

420 
boŞ
 
	gCu¡om”Pos™iÚMixLev–
;

421 
boŞ
 
	gM¬k‘W©chMixLev–
;

422 
boŞ
 
	gSecur™yD‘aMixLev–
;

423 
boŞ
 
	gT¿deLookupMixLev–
;

424 
boŞ
 
	gT¿deOrd”MixLev–
;

425 
boŞ
 
	gT¿deStusMixLev–
;

426 
boŞ
 
	gT¿deUpd©eMixLev–
;

427 
boŞ
 
	gT¿n§ùiÚMixTÙ®
;

430 
	sTLßd”S‘tšgsS‹


432 
boŞ
 
	giCÚfigu»dCu¡om”CouÁ
;

433 
boŞ
 
	giAùiveCu¡om”CouÁ
;

434 
boŞ
 
	giSÿËFaùÜ
;

435 
boŞ
 
	giDaysOfIn™ŸlT¿des
;

436 
boŞ
 
	giS¹šgCu¡om”
;

437 
boŞ
 
	giCu¡om”CouÁ
;

440 
	sTDriv”CEP¬t™iÚS‘tšgsS‹


442 
boŞ
 
	giP¬t™iÚP”ûÁ
;

445 
	sTDriv”Glob®S‘tšgsS‹


447 
boŞ
 
	giCÚfigu»dCu¡om”CouÁ
;

448 
boŞ
 
	giAùiveCu¡om”CouÁ
;

449 
boŞ
 
	giSÿËFaùÜ
;

450 
boŞ
 
	giDaysOfIn™ŸlT¿des
;

456 
şass
 
	gCBrok”VŞumeS‘tšgs
 : 
public
 
CP¬am‘”sW™hDeçuÉs
< 
TBrok”VŞumeS‘tšgs
, 
	gTBrok”VŞumeS‘tšgsS‹
 >

458 
	gpublic
:

460 
CBrok”VŞumeS‘tšgs
()

462 
In™Ÿlize
();

465 
In™ŸlizeDeçuÉs
()

469 
CheckDeçuÉs
()

473 
CheckV®id
()

477 
CheckCom¶ŸÁ
()

482 
şass
 
	gCCu¡om”Pos™iÚS‘tšgs
 : 
public
 
CP¬am‘”sW™hDeçuÉs
< 
TCu¡om”Pos™iÚS‘tšgs
, 
	gTCu¡om”Pos™iÚS‘tšgsS‹
 >

484 
	gpublic
:

485 
CCu¡om”Pos™iÚS‘tšgs
()

487 
In™Ÿlize
();

490 
In™ŸlizeDeçuÉs
()

492 
	gdá
.
	gby_cu¡_id
 = 50;

493 
	gdá
.
	gby_x_id
 = 50;

494 
	gdá
.
	gg‘_hi¡Üy
 = 50;

497 
CheckDeçuÉs
()

499 
	g¡©e
.
	gby_cu¡_id
 = (
cur
.
by_cu¡_id
 =ğ
dá
.by_cust_id);

500 
	g¡©e
.
	gby_x_id
 = (
cur
.
by_x_id
 =ğ
dá
.by_tax_id);

501 
	g¡©e
.
	gg‘_hi¡Üy
 = (
cur
.
g‘_hi¡Üy
 =ğ
dá
.get_history);

504 
CheckV®id
() {

505 
DRIVERPARAM_CHECK_BETWEEN
Ğ"by_cu¡_id", 
cur
.
by_cu¡_id
, 0, 100);

506 
DRIVERPARAM_CHECK_BETWEEN
Ğ"by_x_id", 
cur
.
by_x_id
, 0, 100);

507 
DRIVERPARAM_CHECK_EQUAL
Ğ"by_*_idÙ®", 
cur
.
by_cu¡_id
 + cur.
by_x_id
, 100);

508 
DRIVERPARAM_CHECK_BETWEEN
Ğ"g‘_hi¡Üy", 
cur
.
g‘_hi¡Üy
, 0, 100);

511 
CheckCom¶ŸÁ
() {

512 
CheckV®id
();

513 
DRIVERPARAM_CHECK_DEFAULT
Ğ
by_cu¡_id
 );

514 
DRIVERPARAM_CHECK_DEFAULT
Ğ
by_x_id
 );

515 
DRIVERPARAM_CHECK_DEFAULT
Ğ
g‘_hi¡Üy
 );

519 
şass
 
	gCM¬k‘W©chS‘tšgs
 : 
public
 
CP¬am‘”sW™hDeçuÉs
< 
TM¬k‘W©chS‘tšgs
, 
	gTM¬k‘W©chS‘tšgsS‹
 >

521 
	gpublic
:

522 
CM¬k‘W©chS‘tšgs
()

524 
In™Ÿlize
();

527 
In™ŸlizeDeçuÉs
()

529 
	gdá
.
	gby_acù_id
 = 35;

530 
	gdá
.
	gby_šdu¡ry
 = 5;

531 
	gdá
.
	gby_w©ch_li¡
 = 60;

534 
CheckDeçuÉs
()

536 
	g¡©e
.
	gby_acù_id
 = (
cur
.
by_acù_id
 =ğ
dá
.by_acct_id);

537 
	g¡©e
.
	gby_šdu¡ry
 = (
cur
.
by_šdu¡ry
 =ğ
dá
.by_industry);

538 
	g¡©e
.
	gby_w©ch_li¡
 = (
cur
.
by_w©ch_li¡
 =ğ
dá
.by_watch_list);

541 
CheckV®id
() {

542 
DRIVERPARAM_CHECK_BETWEEN
Ğ"by_acù_id", 
cur
.
by_acù_id
, 0, 100);

543 
DRIVERPARAM_CHECK_BETWEEN
Ğ"by_šdu¡ry", 
cur
.
by_šdu¡ry
, 0, 100);

544 
DRIVERPARAM_CHECK_BETWEEN
Ğ"by_w©ch_li¡", 
cur
.
by_w©ch_li¡
, 0, 100);

545 
DRIVERPARAM_CHECK_EQUAL
Ğ"by_*Ù®", 
cur
.
by_acù_id
 + cur.
by_šdu¡ry
 + cur.
by_w©ch_li¡
, 100);

548 
CheckCom¶ŸÁ
() {

549 
CheckV®id
();

550 
DRIVERPARAM_CHECK_DEFAULT
Ğ
by_acù_id
 );

551 
DRIVERPARAM_CHECK_DEFAULT
Ğ
by_šdu¡ry
 );

552 
DRIVERPARAM_CHECK_DEFAULT
Ğ
by_w©ch_li¡
 );

556 
şass
 
	gCSecur™yD‘aS‘tšgs
 : 
public
 
CP¬am‘”sW™hDeçuÉs
< 
TSecur™yD‘aS‘tšgs
, 
	gTSecur™yD‘aS‘tšgsS‹
 >

558 
	gpublic
:

559 
CSecur™yD‘aS‘tšgs
()

561 
In™Ÿlize
();

564 
In™ŸlizeDeçuÉs
()

566 
	gdá
.
	gLOBAcûssP”ûÁage
 = 1;

569 
CheckDeçuÉs
()

571 
	g¡©e
.
	gLOBAcûssP”ûÁage
 = (
cur
.
LOBAcûssP”ûÁage
 =ğ
dá
.LOBAccessPercentage);

574 
CheckV®id
() {

575 
DRIVERPARAM_CHECK_BETWEEN
Ğ"LOBAcûssP”ûÁage", 
cur
.
LOBAcûssP”ûÁage
, 0, 100);

578 
CheckCom¶ŸÁ
() {

579 
CheckV®id
();

580 
DRIVERPARAM_CHECK_DEFAULT
Ğ
LOBAcûssP”ûÁage
 );

584 
şass
 
	gCT¿deLookupS‘tšgs
 : 
public
 
CP¬am‘”sW™hDeçuÉs
< 
TT¿deLookupS‘tšgs
, 
	gTT¿deLookupS‘tšgsS‹
 >

586 
	gpublic
:

587 
CT¿deLookupS‘tšgs
()

589 
In™Ÿlize
();

592 
In™ŸlizeDeçuÉs
()

594 
	gdá
.
	gdo_äame1
 = 30;

595 
	gdá
.
	gdo_äame2
 = 30;

596 
	gdá
.
	gdo_äame3
 = 30;

597 
	gdá
.
	gdo_äame4
 = 10;

598 
	gdá
.
	gMaxRowsF¿me1
 = 20;

599 
	gdá
.
	gBackOffFromEndTimeF¿me2
 = 4 * 8 * 3600;

600 
	gdá
.
	gMaxRowsF¿me2
 = 20;

601 
	gdá
.
	gBackOffFromEndTimeF¿me3
 = 200 * 60;

602 
	gdá
.
	gMaxRowsF¿me3
 = 20;

603 
	gdá
.
	gBackOffFromEndTimeF¿me4
 = 500 * 60;

604 
	gdá
.
	gMaxRowsF¿me4
 = 20;

607 
CheckDeçuÉs
()

609 
	g¡©e
.
	gdo_äame1
 = (
cur
.
do_äame1
 =ğ
dá
.do_frame1);

610 
	g¡©e
.
	gdo_äame2
 = (
cur
.
do_äame2
 =ğ
dá
.do_frame2);

611 
	g¡©e
.
	gdo_äame3
 = (
cur
.
do_äame3
 =ğ
dá
.do_frame3);

612 
	g¡©e
.
	gdo_äame4
 = (
cur
.
do_äame4
 =ğ
dá
.do_frame4);

613 
	g¡©e
.
	gMaxRowsF¿me1
 = (
cur
.
MaxRowsF¿me1
 =ğ
dá
.MaxRowsFrame1);

614 
	g¡©e
.
	gBackOffFromEndTimeF¿me2
 = (
cur
.
BackOffFromEndTimeF¿me2
 =ğ
dá
.BackOffFromEndTimeFrame2);

615 
	g¡©e
.
	gMaxRowsF¿me2
 = (
cur
.
MaxRowsF¿me2
 =ğ
dá
.MaxRowsFrame2);

616 
	g¡©e
.
	gBackOffFromEndTimeF¿me3
 = (
cur
.
BackOffFromEndTimeF¿me3
 =ğ
dá
.BackOffFromEndTimeFrame3);

617 
	g¡©e
.
	gMaxRowsF¿me3
 = (
cur
.
MaxRowsF¿me3
 =ğ
dá
.MaxRowsFrame3);

618 
	g¡©e
.
	gBackOffFromEndTimeF¿me4
 = (
cur
.
BackOffFromEndTimeF¿me4
 =ğ
dá
.BackOffFromEndTimeFrame4);

619 
	g¡©e
.
	gMaxRowsF¿me4
 = (
cur
.
MaxRowsF¿me4
 =ğ
dá
.MaxRowsFrame4);

622 
CheckV®id
() {

623 
DRIVERPARAM_CHECK_BETWEEN
Ğ"do_äame1", 
cur
.
do_äame1
, 0, 100);

624 
DRIVERPARAM_CHECK_BETWEEN
Ğ"do_äame2", 
cur
.
do_äame2
, 0, 100);

625 
DRIVERPARAM_CHECK_BETWEEN
Ğ"do_äame3", 
cur
.
do_äame3
, 0, 100);

626 
DRIVERPARAM_CHECK_BETWEEN
Ğ"do_äame4", 
cur
.
do_äame4
, 0, 100);

627 
DRIVERPARAM_CHECK_EQUAL
Ğ"do_äame*Ù®", 
cur
.
do_äame1
 + cur.
do_äame2
 + cur.
do_äame3
 + cur.
do_äame4
, 100);

628 
DRIVERPARAM_CHECK_LE
Ğ"MaxRowsF¿me1", 
cur
.
MaxRowsF¿me1
, 
T¿deLookupF¿me1MaxRows
);

629 
DRIVERPARAM_CHECK_LE
Ğ"MaxRowsF¿me2", 
cur
.
MaxRowsF¿me2
, 
T¿deLookupF¿me2MaxRows
);

630 
DRIVERPARAM_CHECK_LE
Ğ"MaxRowsF¿me3", 
cur
.
MaxRowsF¿me3
, 
T¿deLookupF¿me3MaxRows
);

631 
DRIVERPARAM_CHECK_LE
Ğ"MaxRowsF¿me4", 
cur
.
MaxRowsF¿me4
, 
T¿deLookupF¿me4MaxRows
);

634 
CheckCom¶ŸÁ
() {

635 
CheckV®id
();

636 
DRIVERPARAM_CHECK_DEFAULT
Ğ
do_äame1
 );

637 
DRIVERPARAM_CHECK_DEFAULT
Ğ
do_äame2
 );

638 
DRIVERPARAM_CHECK_DEFAULT
Ğ
do_äame3
 );

639 
DRIVERPARAM_CHECK_DEFAULT
Ğ
do_äame4
 );

640 
DRIVERPARAM_CHECK_DEFAULT
Ğ
MaxRowsF¿me1
 );

641 
DRIVERPARAM_CHECK_DEFAULT
Ğ
BackOffFromEndTimeF¿me2
 );

642 
DRIVERPARAM_CHECK_DEFAULT
Ğ
MaxRowsF¿me2
 );

643 
DRIVERPARAM_CHECK_DEFAULT
Ğ
BackOffFromEndTimeF¿me3
 );

644 
DRIVERPARAM_CHECK_DEFAULT
Ğ
MaxRowsF¿me3
 );

645 
DRIVERPARAM_CHECK_DEFAULT
Ğ
BackOffFromEndTimeF¿me4
 );

646 
DRIVERPARAM_CHECK_DEFAULT
Ğ
MaxRowsF¿me4
 );

650 
şass
 
	gCT¿deOrd”S‘tšgs
 : 
public
 
CP¬am‘”sW™hDeçuÉs
< 
TT¿deOrd”S‘tšgs
, 
	gTT¿deOrd”S‘tšgsS‹
 >

652 
	gpublic
:

653 
CT¿deOrd”S‘tšgs
()

655 
In™Ÿlize
();

658 
In™ŸlizeDeçuÉs
()

660 
	gdá
.
	gm¬k‘
 = 60;

661 
	gdá
.
	glim™
 = 40;

662 
	gdá
.
	g¡İ_loss
 = 50;

663 
	gdá
.
	g£cur™y_by_Çme
 = 40;

664 
	gdá
.
	g£cur™y_by_symbŞ
 = 60;

665 
	gdá
.
	gbuy_Üd”s
 = 50;

666 
	gdá
.
	g£Î_Üd”s
 = 50;

667 
	gdá
.
	glifo
 = 35;

668 
	gdá
.
	gexec_is_owÃr
 = 90;

669 
	gdá
.
	grŞlback
 = 1;

670 
	gdá
.
	gty³_is_m¬gš
 = 8;

673 
CheckDeçuÉs
()

675 
	g¡©e
.
	gm¬k‘
 = (
cur
.
m¬k‘
 =ğ
dá
.market);

676 
	g¡©e
.
	glim™
 = (
cur
.
lim™
 =ğ
dá
.limit);

677 
	g¡©e
.
	g¡İ_loss
 = (
cur
.
¡İ_loss
 =ğ
dá
.stop_loss);

678 
	g¡©e
.
	g£cur™y_by_Çme
 = (
cur
.
£cur™y_by_Çme
 =ğ
dá
.security_by_name);

679 
	g¡©e
.
	g£cur™y_by_symbŞ
 = (
cur
.
£cur™y_by_symbŞ
 =ğ
dá
.security_by_symbol);

680 
	g¡©e
.
	gbuy_Üd”s
 = (
cur
.
buy_Üd”s
 =ğ
dá
.buy_orders);

681 
	g¡©e
.
	g£Î_Üd”s
 = (
cur
.
£Î_Üd”s
 =ğ
dá
.sell_orders);

682 
	g¡©e
.
	glifo
 = (
cur
.
lifo
 =ğ
dá
.lifo);

683 
	g¡©e
.
	gexec_is_owÃr
 = (
cur
.
exec_is_owÃr
 =ğ
dá
.exec_is_owner);

684 
	g¡©e
.
	grŞlback
 = (
cur
.
rŞlback
 =ğ
dá
.rollback);

685 
	g¡©e
.
	gty³_is_m¬gš
 = (
cur
.
ty³_is_m¬gš
 =ğ
dá
.type_is_margin);

688 
CheckV®id
() {

689 
DRIVERPARAM_CHECK_BETWEEN
Ğ"m¬k‘", 
cur
.
m¬k‘
, 0, 100);

690 
DRIVERPARAM_CHECK_BETWEEN
Ğ"lim™", 
cur
.
lim™
, 0, 100);

691 
DRIVERPARAM_CHECK_EQUAL
Ğ"m¬k‘ o¸lim™Ù®", 
cur
.
m¬k‘
 + cur.
lim™
, 100);

692 
DRIVERPARAM_CHECK_BETWEEN
Ğ"¡İ_loss", 
cur
.
¡İ_loss
, 0, 100);

693 
DRIVERPARAM_CHECK_BETWEEN
Ğ"£cur™y_by_Çme", 
cur
.
£cur™y_by_Çme
, 0, 100);

694 
DRIVERPARAM_CHECK_BETWEEN
Ğ"£cur™y_by_symbŞ", 
cur
.
£cur™y_by_symbŞ
, 0, 100);

695 
DRIVERPARAM_CHECK_EQUAL
Ğ"£cur™y_by_*Ù®", 
cur
.
£cur™y_by_Çme
 + cur.
£cur™y_by_symbŞ
, 100);

696 
DRIVERPARAM_CHECK_BETWEEN
Ğ"buy_Üd”s", 
cur
.
buy_Üd”s
, 0, 100);

697 
DRIVERPARAM_CHECK_BETWEEN
Ğ"£Î_Üd”s", 
cur
.
£Î_Üd”s
, 0, 100);

698 
DRIVERPARAM_CHECK_EQUAL
Ğ"*_Üd” tÙ®", 
cur
.
buy_Üd”s
 + cur.
£Î_Üd”s
, 100);

699 
DRIVERPARAM_CHECK_BETWEEN
Ğ"lifo", 
cur
.
lifo
, 0, 100);

700 
DRIVERPARAM_CHECK_BETWEEN
Ğ"exec_is_owÃr", 
cur
.
exec_is_owÃr
, 0, 100);

701 
DRIVERPARAM_CHECK_BETWEEN
Ğ"rŞlback", 
cur
.
rŞlback
, 0, 100);

702 
DRIVERPARAM_CHECK_BETWEEN
Ğ"ty³_is_m¬gš", 
cur
.
ty³_is_m¬gš
, 0, 100);

705 
CheckCom¶ŸÁ
() {

706 
CheckV®id
();

707 
DRIVERPARAM_CHECK_BETWEEN
Ğ"exec_is_owÃr", 
cur
.
exec_is_owÃr
, 60, 100);

708 
DRIVERPARAM_CHECK_DEFAULT
Ğ
m¬k‘
 );

709 
DRIVERPARAM_CHECK_DEFAULT
Ğ
lim™
 );

710 
DRIVERPARAM_CHECK_DEFAULT
Ğ
¡İ_loss
 );

711 
DRIVERPARAM_CHECK_DEFAULT
Ğ
£cur™y_by_Çme
 );

712 
DRIVERPARAM_CHECK_DEFAULT
Ğ
£cur™y_by_symbŞ
 );

713 
DRIVERPARAM_CHECK_DEFAULT
Ğ
buy_Üd”s
 );

714 
DRIVERPARAM_CHECK_DEFAULT
Ğ
£Î_Üd”s
 );

715 
DRIVERPARAM_CHECK_DEFAULT
Ğ
lifo
 );

716 
DRIVERPARAM_CHECK_DEFAULT
Ğ
exec_is_owÃr
 );

717 
DRIVERPARAM_CHECK_DEFAULT
Ğ
rŞlback
 );

718 
DRIVERPARAM_CHECK_DEFAULT
Ğ
ty³_is_m¬gš
 );

722 
şass
 
	gCT¿deUpd©eS‘tšgs
 : 
public
 
CP¬am‘”sW™hDeçuÉs
< 
TT¿deUpd©eS‘tšgs
, 
	gTT¿deUpd©eS‘tšgsS‹
 >

724 
	gpublic
:

725 
CT¿deUpd©eS‘tšgs
()

727 
In™Ÿlize
();

730 
In™ŸlizeDeçuÉs
()

732 
	gdá
.
	gdo_äame1
 = 33;

733 
	gdá
.
	gdo_äame2
 = 33;

734 
	gdá
.
	gdo_äame3
 = 34;

735 
	gdá
.
	gMaxRowsF¿me1
 = 20;

736 
	gdá
.
	gMaxRowsToUpd©eF¿me1
 = 20;

737 
	gdá
.
	gMaxRowsF¿me2
 = 20;

738 
	gdá
.
	gMaxRowsToUpd©eF¿me2
 = 20;

739 
	gdá
.
	gBackOffFromEndTimeF¿me2
 = 4 * 8 * 3600;

740 
	gdá
.
	gMaxRowsF¿me3
 = 20;

741 
	gdá
.
	gMaxRowsToUpd©eF¿me3
 = 20;

742 
	gdá
.
	gBackOffFromEndTimeF¿me3
 = 200 * 60;

745 
CheckDeçuÉs
()

747 
	g¡©e
.
	gdo_äame1
 = (
cur
.
do_äame1
 =ğ
dá
.do_frame1);

748 
	g¡©e
.
	gdo_äame2
 = (
cur
.
do_äame2
 =ğ
dá
.do_frame2);

749 
	g¡©e
.
	gdo_äame3
 = (
cur
.
do_äame3
 =ğ
dá
.do_frame3);

750 
	g¡©e
.
	gMaxRowsF¿me1
 = (
cur
.
MaxRowsF¿me1
 =ğ
dá
.MaxRowsFrame1);

751 
	g¡©e
.
	gMaxRowsToUpd©eF¿me1
 = (
cur
.
MaxRowsToUpd©eF¿me1
 =ğ
dá
.MaxRowsToUpdateFrame1);

752 
	g¡©e
.
	gMaxRowsF¿me2
 = (
cur
.
MaxRowsF¿me2
 =ğ
dá
.MaxRowsFrame2);

753 
	g¡©e
.
	gMaxRowsToUpd©eF¿me2
 = (
cur
.
MaxRowsToUpd©eF¿me2
 =ğ
dá
.MaxRowsToUpdateFrame2);

754 
	g¡©e
.
	gBackOffFromEndTimeF¿me2
 = (
cur
.
BackOffFromEndTimeF¿me2
 =ğ
dá
.BackOffFromEndTimeFrame2);

755 
	g¡©e
.
	gMaxRowsF¿me3
 = (
cur
.
MaxRowsF¿me3
 =ğ
dá
.MaxRowsFrame3);

756 
	g¡©e
.
	gMaxRowsToUpd©eF¿me3
 = (
cur
.
MaxRowsToUpd©eF¿me3
 =ğ
dá
.MaxRowsToUpdateFrame3);

757 
	g¡©e
.
	gBackOffFromEndTimeF¿me3
 = (
cur
.
BackOffFromEndTimeF¿me3
 =ğ
dá
.BackOffFromEndTimeFrame3);

760 
CheckV®id
() {

761 
DRIVERPARAM_CHECK_BETWEEN
Ğ"do_äame1", 
cur
.
do_äame1
, 0, 100);

762 
DRIVERPARAM_CHECK_BETWEEN
Ğ"do_äame2", 
cur
.
do_äame2
, 0, 100);

763 
DRIVERPARAM_CHECK_BETWEEN
Ğ"do_äame3", 
cur
.
do_äame3
, 0, 100);

764 
DRIVERPARAM_CHECK_EQUAL
Ğ"do_äame*Ù®", 
cur
.
do_äame1
 + cur.
do_äame2
 + cur.
do_äame3
, 100);

765 
DRIVERPARAM_CHECK_LE
Ğ"MaxRowsF¿me1", 
cur
.
MaxRowsF¿me1
, 
T¿deUpd©eF¿me1MaxRows
);

766 
DRIVERPARAM_CHECK_LE
Ğ"MaxRowsF¿me2", 
cur
.
MaxRowsF¿me2
, 
T¿deUpd©eF¿me2MaxRows
);

767 
DRIVERPARAM_CHECK_LE
Ğ"MaxRowsF¿me3", 
cur
.
MaxRowsF¿me3
, 
T¿deUpd©eF¿me3MaxRows
);

768 
DRIVERPARAM_CHECK_LE
Ğ"MaxRowsToUpd©eF¿me1", 
cur
.
MaxRowsToUpd©eF¿me1
, 
T¿deUpd©eF¿me1MaxRows
);

769 
DRIVERPARAM_CHECK_LE
Ğ"MaxRowsToUpd©eF¿me2", 
cur
.
MaxRowsToUpd©eF¿me2
, 
T¿deUpd©eF¿me2MaxRows
);

770 
DRIVERPARAM_CHECK_LE
Ğ"MaxRowsToUpd©eF¿me3", 
cur
.
MaxRowsToUpd©eF¿me3
, 
T¿deUpd©eF¿me3MaxRows
);

773 
CheckCom¶ŸÁ
() {

774 
CheckV®id
();

776 
DRIVERPARAM_CHECK_DEFAULT
Ğ
do_äame1
 );

777 
DRIVERPARAM_CHECK_DEFAULT
Ğ
do_äame2
 );

778 
DRIVERPARAM_CHECK_DEFAULT
Ğ
do_äame3
 );

779 
DRIVERPARAM_CHECK_DEFAULT
Ğ
MaxRowsF¿me1
 );

780 
DRIVERPARAM_CHECK_DEFAULT
Ğ
MaxRowsToUpd©eF¿me1
 );

781 
DRIVERPARAM_CHECK_DEFAULT
Ğ
MaxRowsF¿me2
 );

782 
DRIVERPARAM_CHECK_DEFAULT
Ğ
MaxRowsToUpd©eF¿me2
 );

783 
DRIVERPARAM_CHECK_DEFAULT
Ğ
BackOffFromEndTimeF¿me2
 );

784 
DRIVERPARAM_CHECK_DEFAULT
Ğ
MaxRowsF¿me3
 );

785 
DRIVERPARAM_CHECK_DEFAULT
Ğ
MaxRowsToUpd©eF¿me3
 );

786 
DRIVERPARAM_CHECK_DEFAULT
Ğ
BackOffFromEndTimeF¿me3
 );

790 
şass
 
	gCTxnMixG’”©ÜS‘tšgs
 : 
public
 
CP¬am‘”sW™hDeçuÉs
< 
TTxnMixG’”©ÜS‘tšgs
, 
	gTTxnMixG’”©ÜS‘tšgsS‹
 >

792 
	gpublic
:

793 
CTxnMixG’”©ÜS‘tšgs
()

795 
In™Ÿlize
();

798 
In™ŸlizeDeçuÉs
()

800 
	gdá
.
	gBrok”VŞumeMixLev–
 = 49;

801 
	gdá
.
	gCu¡om”Pos™iÚMixLev–
 = 130;

802 
	gdá
.
	gM¬k‘W©chMixLev–
 = 180;

803 
	gdá
.
	gSecur™yD‘aMixLev–
 = 140;

804 
	gdá
.
	gT¿deLookupMixLev–
 = 80;

805 
	gdá
.
	gT¿deOrd”MixLev–
 = 101;

806 
	gdá
.
	gT¿deStusMixLev–
 = 190;

807 
	gdá
.
	gT¿deUpd©eMixLev–
 = 20;

810 
CheckDeçuÉs
()

812 
	g¡©e
.
	gBrok”VŞumeMixLev–
 = (
cur
.
Brok”VŞumeMixLev–
 =ğ
dá
.BrokerVolumeMixLevel);

813 
	g¡©e
.
	gCu¡om”Pos™iÚMixLev–
 = (
cur
.
Cu¡om”Pos™iÚMixLev–
 =ğ
dá
.CustomerPositionMixLevel);

814 
	g¡©e
.
	gM¬k‘W©chMixLev–
 = (
cur
.
M¬k‘W©chMixLev–
 =ğ
dá
.MarketWatchMixLevel);

815 
	g¡©e
.
	gSecur™yD‘aMixLev–
 = (
cur
.
Secur™yD‘aMixLev–
 =ğ
dá
.SecurityDetailMixLevel);

816 
	g¡©e
.
	gT¿deLookupMixLev–
 = (
cur
.
T¿deLookupMixLev–
 =ğ
dá
.TradeLookupMixLevel);

817 
	g¡©e
.
	gT¿deOrd”MixLev–
 = (
cur
.
T¿deOrd”MixLev–
 =ğ
dá
.TradeOrderMixLevel);

818 
	g¡©e
.
	gT¿deStusMixLev–
 = (
cur
.
T¿deStusMixLev–
 =ğ
dá
.TradeStatusMixLevel);

819 
	g¡©e
.
	gT¿deUpd©eMixLev–
 = (
cur
.
T¿deUpd©eMixLev–
 =ğ
dá
.TradeUpdateMixLevel);

822 
CheckV®id
() {

823 
DRIVERPARAM_CHECK_GE
Ğ"Brok”VŞumeMixLev–", 
cur
.
Brok”VŞumeMixLev–
, 0 );

824 
DRIVERPARAM_CHECK_GE
Ğ"Cu¡om”Pos™iÚMixLev–", 
cur
.
Cu¡om”Pos™iÚMixLev–
, 0 );

825 
DRIVERPARAM_CHECK_GE
Ğ"M¬k‘W©chMixLev–", 
cur
.
M¬k‘W©chMixLev–
, 0 );

826 
DRIVERPARAM_CHECK_GE
Ğ"Secur™yD‘aMixLev–", 
cur
.
Secur™yD‘aMixLev–
, 0 );

827 
DRIVERPARAM_CHECK_GE
Ğ"T¿deLookupMixLev–", 
cur
.
T¿deLookupMixLev–
, 0 );

828 
DRIVERPARAM_CHECK_GE
Ğ"T¿deOrd”MixLev–", 
cur
.
T¿deOrd”MixLev–
, 0 );

829 
DRIVERPARAM_CHECK_GE
Ğ"T¿deStusMixLev–", 
cur
.
T¿deStusMixLev–
, 0 );

830 
DRIVERPARAM_CHECK_GE
Ğ"T¿deUpd©eMixLev–", 
cur
.
T¿deUpd©eMixLev–
, 0 );

833 
CheckCom¶ŸÁ
() {

834 
CheckV®id
();

835 
DRIVERPARAM_CHECK_DEFAULT
Ğ
Brok”VŞumeMixLev–
 );

836 
DRIVERPARAM_CHECK_DEFAULT
Ğ
Cu¡om”Pos™iÚMixLev–
 );

837 
DRIVERPARAM_CHECK_DEFAULT
Ğ
M¬k‘W©chMixLev–
 );

838 
DRIVERPARAM_CHECK_DEFAULT
Ğ
Secur™yD‘aMixLev–
 );

839 
DRIVERPARAM_CHECK_DEFAULT
Ğ
T¿deLookupMixLev–
 );

840 
DRIVERPARAM_CHECK_DEFAULT
Ğ
T¿deOrd”MixLev–
 );

841 
DRIVERPARAM_CHECK_DEFAULT
Ğ
T¿deStusMixLev–
 );

842 
DRIVERPARAM_CHECK_DEFAULT
Ğ
T¿deUpd©eMixLev–
 );

846 
şass
 
	gCLßd”S‘tšgs
 : 
public
 
CP¬am‘”sW™hDeçuÉs
< 
TLßd”S‘tšgs
, 
	gTLßd”S‘tšgsS‹
 >

848 
	gpublic
:

849 
CLßd”S‘tšgs
Ğ
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
,

850 
TId’t
 
iS¹šgCu¡om”
, TId’ˆ
iCu¡om”CouÁ
,

851 
INT32
 
iSÿËFaùÜ
, INT32 
iDaysOfIn™ŸlT¿des
 )

853 
In™Ÿlize
();

855 
	gcur
.
	giCÚfigu»dCu¡om”CouÁ
 = 
iCÚfigu»dCu¡om”CouÁ
;

856 
	gcur
.
	giAùiveCu¡om”CouÁ
 = 
iAùiveCu¡om”CouÁ
;

857 
	gcur
.
	giS¹šgCu¡om”
 = 
iS¹šgCu¡om”
;

858 
	gcur
.
	giCu¡om”CouÁ
 = 
iCu¡om”CouÁ
;

859 
	gcur
.
	giSÿËFaùÜ
 = 
iSÿËFaùÜ
;

860 
	gcur
.
	giDaysOfIn™ŸlT¿des
 = 
iDaysOfIn™ŸlT¿des
;

862 
CheckDeçuÉs
();

865 
CLßd”S‘tšgs
()

867 
In™Ÿlize
();

870 
In™ŸlizeDeçuÉs
()

874 
	gdá
.
	giCÚfigu»dCu¡om”CouÁ
 = 5000;

875 
	gdá
.
	giAùiveCu¡om”CouÁ
 = 5000;

876 
	gdá
.
	giS¹šgCu¡om”
 = 1;

877 
	gdá
.
	giCu¡om”CouÁ
 = 5000;

878 
	gdá
.
	giSÿËFaùÜ
 = 500;

879 
	gdá
.
	giDaysOfIn™ŸlT¿des
 = 300;

882 
CheckDeçuÉs
()

884 
	g¡©e
.
	giCÚfigu»dCu¡om”CouÁ
 = 
Œue
;

885 
	g¡©e
.
	giAùiveCu¡om”CouÁ
 = 
Œue
;

886 
	g¡©e
.
	giS¹šgCu¡om”
 = 
Œue
;

887 
	g¡©e
.
	giCu¡om”CouÁ
 = 
Œue
;

888 
	g¡©e
.
	giSÿËFaùÜ
 = (
cur
.
iSÿËFaùÜ
 =ğ
dá
.iScaleFactor);

889 
	g¡©e
.
	giDaysOfIn™ŸlT¿des
 = (
cur
.
iDaysOfIn™ŸlT¿des
 =ğ
dá
.iDaysOfInitialTrades);

892 
CheckV®id
() {

893 
DRIVERPARAM_CHECK_GE
Ğ"iCÚfigu»dCu¡om”CouÁ", 
cur
.
iCÚfigu»dCu¡om”CouÁ
, 1000);

894 
DRIVERPARAM_CHECK_GE
Ğ"iAùiveCu¡om”CouÁ", 
cur
.
iAùiveCu¡om”CouÁ
, 1000);

895 
DRIVERPARAM_CHECK_LE
Ğ"iAùiveCu¡om”CouÁ", 
cur
.
iAùiveCu¡om”CouÁ
, cur.
iCÚfigu»dCu¡om”CouÁ
);

896 
DRIVERPARAM_CHECK_EQUAL
Ğ"iCÚfigu»dCu¡om”CouÁ", 
cur
.
iCÚfigu»dCu¡om”CouÁ
 % 1000, 0);

897 
DRIVERPARAM_CHECK_GE
Ğ"iS¹šgCu¡om”", 
cur
.
iS¹šgCu¡om”
, 1)

898 
DRIVERPARAM_CHECK_EQUAL
Ğ"iS¹šgCu¡om”", 
cur
.
iS¹šgCu¡om”
 % 1000, 1);

899 
DRIVERPARAM_CHECK_EQUAL
Ğ"iCu¡om”CouÁ", 
cur
.
iCu¡om”CouÁ
 % 1000, 0);

900 
DRIVERPARAM_CHECK_LE
Ğ"iCu¡om”CouÁ", 
cur
.
iCu¡om”CouÁ
 + cur.
iS¹šgCu¡om”
 - 1, cur.
iCÚfigu»dCu¡om”CouÁ
);

903 
CheckCom¶ŸÁ
() {

904 
CheckV®id
();

905 
DRIVERPARAM_CHECK_GE
Ğ"iCÚfigu»dCu¡om”CouÁ", 
cur
.
iCÚfigu»dCu¡om”CouÁ
, 5000);

906 
DRIVERPARAM_CHECK_GE
Ğ"iAùiveCu¡om”CouÁ", 
cur
.
iAùiveCu¡om”CouÁ
, 5000);

907 
DRIVERPARAM_CHECK_EQUAL
Ğ"iAùiveCu¡om”CouÁ", 
cur
.
iAùiveCu¡om”CouÁ
, cur.
iCÚfigu»dCu¡om”CouÁ
);

908 
DRIVERPARAM_CHECK_DEFAULT
Ğ
iSÿËFaùÜ
 );

909 
DRIVERPARAM_CHECK_DEFAULT
Ğ
iDaysOfIn™ŸlT¿des
 );

913 
şass
 
	gCDriv”Glob®S‘tšgs
 : 
public
 
CP¬am‘”sW™hDeçuÉs
< 
TDriv”Glob®S‘tšgs
, 
	gTDriv”Glob®S‘tšgsS‹
 >

915 
	gpublic
:

916 
CDriv”Glob®S‘tšgs
Ğ
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
, 
INT32
 
iSÿËFaùÜ
, INT32 
iDaysOfIn™ŸlT¿des
 )

918 
In™Ÿlize
();

920 
	gcur
.
	giCÚfigu»dCu¡om”CouÁ
 = 
iCÚfigu»dCu¡om”CouÁ
;

921 
	gcur
.
	giAùiveCu¡om”CouÁ
 = 
iAùiveCu¡om”CouÁ
;

922 
	gcur
.
	giSÿËFaùÜ
 = 
iSÿËFaùÜ
;

923 
	gcur
.
	giDaysOfIn™ŸlT¿des
 = 
iDaysOfIn™ŸlT¿des
;

925 
CheckDeçuÉs
();

928 
CDriv”Glob®S‘tšgs
()

930 
In™Ÿlize
();

933 
In™ŸlizeDeçuÉs
()

938 
	gdá
.
	giCÚfigu»dCu¡om”CouÁ
 = 5000;

939 
	gdá
.
	giAùiveCu¡om”CouÁ
 = 5000;

940 
	gdá
.
	giSÿËFaùÜ
 = 500;

941 
	gdá
.
	giDaysOfIn™ŸlT¿des
 = 300;

944 
CheckDeçuÉs
()

946 
	g¡©e
.
	giCÚfigu»dCu¡om”CouÁ
 = 
Œue
;

947 
	g¡©e
.
	giAùiveCu¡om”CouÁ
 = 
Œue
;

948 
	g¡©e
.
	giSÿËFaùÜ
 = (
cur
.
iSÿËFaùÜ
 =ğ
dá
.iScaleFactor);

949 
	g¡©e
.
	giDaysOfIn™ŸlT¿des
 = (
cur
.
iDaysOfIn™ŸlT¿des
 =ğ
dá
.iDaysOfInitialTrades);

953 
CheckV®id
() {

954 
DRIVERPARAM_CHECK_GE
Ğ"iCÚfigu»dCu¡om”CouÁ", 
cur
.
iCÚfigu»dCu¡om”CouÁ
, 1000);

955 
DRIVERPARAM_CHECK_GE
Ğ"iAùiveCu¡om”CouÁ", 
cur
.
iAùiveCu¡om”CouÁ
, 1000);

956 
DRIVERPARAM_CHECK_LE
Ğ"iAùiveCu¡om”CouÁ", 
cur
.
iAùiveCu¡om”CouÁ
, cur.
iCÚfigu»dCu¡om”CouÁ
);

957 
DRIVERPARAM_CHECK_EQUAL
Ğ"iCÚfigu»dCu¡om”CouÁ", 
cur
.
iCÚfigu»dCu¡om”CouÁ
 % 1000, 0);

960 
CheckCom¶ŸÁ
() {

961 
CheckV®id
();

962 
DRIVERPARAM_CHECK_GE
Ğ"iCÚfigu»dCu¡om”CouÁ", 
cur
.
iCÚfigu»dCu¡om”CouÁ
, 5000);

963 
DRIVERPARAM_CHECK_GE
Ğ"iAùiveCu¡om”CouÁ", 
cur
.
iAùiveCu¡om”CouÁ
, 5000);

964 
DRIVERPARAM_CHECK_EQUAL
Ğ"iAùiveCu¡om”CouÁ", 
cur
.
iAùiveCu¡om”CouÁ
, cur.
iCÚfigu»dCu¡om”CouÁ
);

965 
DRIVERPARAM_CHECK_DEFAULT
Ğ
iSÿËFaùÜ
 );

966 
DRIVERPARAM_CHECK_DEFAULT
Ğ
iDaysOfIn™ŸlT¿des
 );

970 
şass
 
	gCDriv”CES‘tšgs
 : 
public
 
CP¬am‘”sW™houtDeçuÉs
< 
TDriv”CES‘tšgs
 >

972 
public
:

973 
CDriv”CES‘tšgs
Ğ
UINT32
 
UniqueId
, 
RNGSEED
 
TxnMixRNGS“d
, RNGSEED 
TxnIÅutRNGS“d
 )

975 
	gcur
.
	gUniqueId
 = 
UniqueId
;

976 
	gcur
.
	gTxnMixRNGS“d
 = 
TxnMixRNGS“d
;

977 
	gcur
.
	gTxnIÅutRNGS“d
 = 
TxnIÅutRNGS“d
;

980 
CDriv”CES‘tšgs
() {} ;

982 
CheckV®id
()

986 
CheckCom¶ŸÁ
()

991 
şass
 
	gCDriv”CEP¬t™iÚS‘tšgs
 : 
public
 
CP¬am‘”sW™hDeçuÉs
< 
TDriv”CEP¬t™iÚS‘tšgs
, 
	gTDriv”CEP¬t™iÚS‘tšgsS‹
 >

993 
	gpublic
:

994 
CDriv”CEP¬t™iÚS‘tšgs
Ğ
TId’t
 
iMyS¹šgCu¡om”Id
, TId’ˆ
iMyCu¡om”CouÁ
, 
INT32
 
iP¬t™iÚP”ûÁ
 )

996 
In™Ÿlize
();

998 
	gcur
.
	giMyS¹šgCu¡om”Id
 = 
iMyS¹šgCu¡om”Id
;

999 
	gcur
.
	giMyCu¡om”CouÁ
 = 
iMyCu¡om”CouÁ
;

1000 
	gcur
.
	giP¬t™iÚP”ûÁ
 = 
iP¬t™iÚP”ûÁ
;

1002 
CheckDeçuÉs
();

1007 
CDriv”CEP¬t™iÚS‘tšgs
( )

1009 
In™Ÿlize
();

1011 
	gcur
.
	giMyS¹šgCu¡om”Id
 = 0;

1012 
	gcur
.
	giMyCu¡om”CouÁ
 = 0;

1013 
	gcur
.
	giP¬t™iÚP”ûÁ
 = 0;

1015 
CheckDeçuÉs
();

1018 
In™ŸlizeDeçuÉs
()

1020 
	gdá
.
	giMyS¹šgCu¡om”Id
 = 1;

1021 
	gdá
.
	giMyCu¡om”CouÁ
 = 5000;

1022 
	gdá
.
	giP¬t™iÚP”ûÁ
 = 50;

1025 
CheckDeçuÉs
()

1027 
	g¡©e
.
	giP¬t™iÚP”ûÁ
 = (
cur
.
iP¬t™iÚP”ûÁ
 =ğ
dá
.iPartitionPercent);

1030 
CheckV®id
() {

1031 
DRIVERPARAM_CHECK_BETWEEN
Ğ"iP¬t™iÚP”ûÁ", 
cur
.
iP¬t™iÚP”ûÁ
, 0, 100);

1032 iàĞ
	gcur
.
	giMyS¹šgCu¡om”Id
 =ğ0 && 
cur
.
iMyCu¡om”CouÁ
 =ğ0 && cur.
iP¬t™iÚP”ûÁ
 == 0 ) {

1042 
DRIVERPARAM_CHECK_EQUAL
Ğ"iMyS¹šgCu¡om”Id", 
cur
.
iMyS¹šgCu¡om”Id
 % 1000, 1 );

1043 
DRIVERPARAM_CHECK_GE
Ğ"iMyCu¡om”CouÁ", 
cur
.
iMyCu¡om”CouÁ
, 1000 );

1044 
DRIVERPARAM_CHECK_EQUAL
Ğ"iMyCu¡om”CouÁ", 
cur
.
iMyCu¡om”CouÁ
 % 1000, 0 );

1048 
CheckCom¶ŸÁ
() {

1049 
CheckV®id
();

1051 iàĞ
	gcur
.
	giMyS¹šgCu¡om”Id
 =ğ0 && 
cur
.
iMyCu¡om”CouÁ
 =ğ0 && cur.
iP¬t™iÚP”ûÁ
 == 0 ) {

1055 
DRIVERPARAM_CHECK_DEFAULT
Ğ
iP¬t™iÚP”ûÁ
 );

1060 
şass
 
	gCDriv”MEES‘tšgs
 : 
public
 
CP¬am‘”sW™houtDeçuÉs
< 
TDriv”MEES‘tšgs
 >

1062 
public
:

1063 
CDriv”MEES‘tšgs
Ğ
UINT32
 
UniqueId
, 
RNGSEED
 
RNGS“d
, RNGSEED 
Tick”T­eRNGS“d
, RNGSEED 
T¿dšgFloÜRNGS“d
 )

1065 
	gcur
.
	gUniqueId
 = 
UniqueId
;

1066 
	gcur
.
	gRNGS“d
 = 
RNGS“d
;

1067 
	gcur
.
	gTick”T­eRNGS“d
 = 
Tick”T­eRNGS“d
;

1068 
	gcur
.
	gT¿dšgFloÜRNGS“d
 = 
T¿dšgFloÜRNGS“d
;

1071 
CDriv”MEES‘tšgs
() {} ;

1073 
CheckV®id
()

1077 
CheckCom¶ŸÁ
()

1082 
şass
 
	gCDriv”DMS‘tšgs
 : 
public
 
CP¬am‘”sW™houtDeçuÉs
< 
TDriv”DMS‘tšgs
 >

1084 
public
:

1085 
CDriv”DMS‘tšgs
Ğ
UINT32
 
UniqueId
, 
RNGSEED
 
RNGS“d
 )

1087 
	gcur
.
	gUniqueId
 = 
UniqueId
;

1088 
	gcur
.
	gRNGS“d
 = 
RNGS“d
;

1091 
CDriv”DMS‘tšgs
() {};

1093 
CheckV®id
()

1097 
CheckCom¶ŸÁ
()

1102 
	sTDriv”CETxnS‘tšgs


1104 
CBrok”VŞumeS‘tšgs
 
	gBV_£‰šgs
;

1105 
CCu¡om”Pos™iÚS‘tšgs
 
	gCP_£‰šgs
;

1106 
CM¬k‘W©chS‘tšgs
 
	gMW_£‰šgs
;

1107 
CSecur™yD‘aS‘tšgs
 
	gSD_£‰šgs
;

1108 
CT¿deLookupS‘tšgs
 
	gTL_£‰šgs
;

1109 
CT¿deOrd”S‘tšgs
 
	gTO_£‰šgs
;

1110 
CT¿deUpd©eS‘tšgs
 
	gTU_£‰šgs
;

1112 
CTxnMixG’”©ÜS‘tšgs
 
	gTxnMixG’”©Ü_£‰šgs
;

1114 
boŞ
 
IsV®id
() {

1115 
	gŒy
 {

1116 
CheckV®id
();

1117  
	gŒue
;

1118 } 
ÿtch
(...) {

1119  
	gçl£
;

1123 
boŞ
 
IsCom¶ŸÁ
() {

1124 
	gŒy
 {

1125 
CheckCom¶ŸÁ
();

1126  
	gŒue
;

1127 } 
ÿtch
(...) {

1128  
	gçl£
;

1132 
CheckV®id
()

1134 
	gBV_£‰šgs
.
CheckV®id
();

1135 
	gCP_£‰šgs
.
CheckV®id
();

1136 
	gMW_£‰šgs
.
CheckV®id
();

1137 
	gSD_£‰šgs
.
CheckV®id
();

1138 
	gTL_£‰šgs
.
CheckV®id
();

1139 
	gTO_£‰šgs
.
CheckV®id
();

1140 
	gTU_£‰šgs
.
CheckV®id
();

1141 
	gTxnMixG’”©Ü_£‰šgs
.
CheckV®id
();

1144 
CheckCom¶ŸÁ
()

1146 
	gBV_£‰šgs
.
CheckCom¶ŸÁ
();

1147 
	gCP_£‰šgs
.
CheckCom¶ŸÁ
();

1148 
	gMW_£‰šgs
.
CheckCom¶ŸÁ
();

1149 
	gSD_£‰šgs
.
CheckCom¶ŸÁ
();

1150 
	gTL_£‰šgs
.
CheckCom¶ŸÁ
();

1151 
	gTO_£‰šgs
.
CheckCom¶ŸÁ
();

1152 
	gTU_£‰šgs
.
CheckCom¶ŸÁ
();

1153 
	gTxnMixG’”©Ü_£‰šgs
.
CheckCom¶ŸÁ
();

1155 } *
	tPDriv”CETxnS‘tšgs
;

	@include/workload/tpce/egen/DriverTypes.h

41 #iâdeà
DRIVER_TYPES_H


42 
	#DRIVER_TYPES_H


	)

44 
Çme¥aû
 
	gTPCE


47 
	eeDriv”Ty³


49 
	geDriv”EG’Lßd”
,

50 
	geDriv”AÎ
,

51 
	geDriv”CE
,

52 
	geDriv”MEE
,

53 
	geDriv”DM
,

54 
	geDriv”Max


57 
szDriv”Ty³Names
[
eDriv”Max
][14];

	@include/workload/tpce/egen/EGenBaseLoader_stdafx.h

37 #iâdeà
EGEN_BASELOADER_STDAFX_H


38 
	#EGEN_BASELOADER_STDAFX_H


	)

40 
	~"Ba£Lßd”.h
"

41 
	~"Ba£Lßd”FaùÜy.h
"

	@include/workload/tpce/egen/EGenError.h

41 #iâdeà
EGEN_ERROR_H


42 
	#EGEN_ERROR_H


	)

44 
	~<¡ršg
>

46 
usšg
 
Çme¥aû
 
	g¡d
;

48 
Çme¥aû
 
	gTPCE


51 şas 
	cCEG’E¼ÜMes§ges


53 
	g´iv©e
:

54 
public
:

57 şas 
	cCEG’E¼ÜExû±iÚ


59 
	g´iv©e
:

60 
¡ršg
 
m_Msg
;

62 
	gpublic
:

63 
CEG’E¼ÜExû±iÚ
Ğ
¡ršg
 
Msg
 )

65 
m_Msg
 = 
Msg
;

68 ~
CEG’E¼ÜExû±iÚ
( )

72 
AddMsg
Ğ
¡ršg
 
Msg
 )

74 
	gm_Msg
 +ğ
Msg
;

77 
¡ršg
 
Msg
( )

79 Ğ
	gm_Msg
 );

	@include/workload/tpce/egen/EGenGenerateAndLoad.h

43 #iâdeà
EGEN_GENERATE_AND_LOAD_H


44 
	#EGEN_GENERATE_AND_LOAD_H


	)

46 
	~"EG’Snd¬dTy³s.h
"

47 
	~"EG’G’”©eAndLßdBa£Ouut.h
"

48 
	~"MiscCÚ¡s.h
"

49 
	~"IÅutFÏtFesSŒuùu».h
"

50 
	~"Ba£Lßd”FaùÜy.h
"

51 
	~"Ba£Logg”.h
"

53 
Çme¥aû
 
	gTPCE


58 şas 
	cCG’”©eAndLßd


61 
CIÅutFes
 
	gm_šputFes
;

63 
TId’t
 
	gm_iS¹FromCu¡om”
;

65 
TId’t
 
	gm_iCu¡om”CouÁ
;

67 
TId’t
 
	gm_iTÙ®Cu¡om”s
;

69 
UINT
 
	gm_iLßdUn™Size
;

71 
UINT
 
	gm_iSÿËFaùÜ
;

73 
UINT
 
	gm_iHoursOfIn™ŸlT¿des
;

75 
CBa£Lßd”FaùÜy
* 
	gm_pLßd”FaùÜy
;

77 
CG’”©eAndLßdBa£Ouut
* 
	gm_pOuut
;

79 
	gm_szInDœ
[
iMaxP©h
];

81 
CBa£Logg”
* 
	gm_pLogg”
;

83 
CLßd”S‘tšgs
 
	gm_Lßd”S‘tšgs
;

85 
boŞ
 
	gm_bCacheEÇbËd
;

90 
CAdd»ssTabË
* 
	gadd»ssTabË
;

91 
CCh¬geTabË
* 
	gch¬geTabË
;

92 
CCommissiÚR©eTabË
* 
	gcommissiÚR©eTabË
;

93 
CCom·nyTabË
* 
	gcom·nyTabË
;

94 
CCom·nyCom³t™ÜTabË
* 
	gcom·nyCom³t™ÜTabË
;

95 
CCu¡om”TabË
* 
	gcu¡om”TabË
;

96 
CCu¡om”AccouÁsAndP”missiÚsTabË
* 
	gcu¡om”AccouÁsAndP”missiÚsTabË
;

97 
CCu¡om”Tax¿‹sTabË
* 
	gcu¡om”Tax¿‹sTabË
;

98 
CDayM¬k‘TabË
* 
	gdayM¬k‘TabË
;

99 
CExchªgeTabË
* 
	gexchªgeTabË
;

100 
CFšªcŸlTabË
* 
	gfšªcŸlTabË
;

102 
CIndu¡ryTabË
* 
	gšdu¡ryTabË
;

103 
CLa¡T¿deTabË
* 
	gÏ¡T¿deTabË
;

104 
CNewsI‹mAndXRefTabË
* 
	gÃwsI‹mAndXRefTabË
;

105 
CSeùÜTabË
* 
	g£ùÜTabË
;

106 
CSecur™yTabË
* 
	g£cur™yTabË
;

107 
CStusTy³TabË
* 
	g¡©usTy³TabË
;

108 
CTax¿‹TabË
* 
	gx¿‹TabË
;

109 
CT¿deTy³TabË
* 
	gŒadeTy³TabË
;

110 
CW©chLi¡sAndI‹msTabË
* 
	gw©chLi¡sAndI‹msTabË
;

111 
CZCodeTabË
* 
	gzCodeTabË
;

114 
CT¿deG’
* 
	gpT¿deG’
;

118 
	gpublic
:

139 
CG’”©eAndLßd
(
CIÅutFes
 
šputFes
,

140 
TId’t
 
iCu¡om”CouÁ
,

141 
TId’t
 
iS¹FromCu¡om”
,

142 
TId’t
 
iTÙ®Cu¡om”s
,

143 
UINT
 
iLßdUn™Size
,

144 
UINT
 
iSÿËFaùÜ
,

145 
UINT
 
iDaysOfIn™ŸlT¿des
,

146 
CBa£Lßd”FaùÜy
* 
pLßd”FaùÜy
,

147 
CBa£Logg”
* 
pLogg”
,

148 
CG’”©eAndLßdBa£Ouut
* 
pOuut
,

149 * 
szInDœ
,

150 
boŞ
 
bCacheEÇbËd
 = 
çl£


162 
G’”©eAndLßdAdd»ss
();

172 
G’”©eAndLßdCh¬ge
();

182 
G’”©eAndLßdCommissiÚR©e
();

192 
G’”©eAndLßdCom·nyCom³t™Ü
();

202 
G’”©eAndLßdCom·ny
();

212 
G’”©eAndLßdCu¡om”AccouÁAndAccouÁP”missiÚ
();

222 
G’”©eAndLßdCu¡om”
();

232 
G’”©eAndLßdCu¡om”Tax¿‹
();

242 
G’”©eAndLßdDayM¬k‘
();

252 
G’”©eAndLßdExchªge
();

262 
G’”©eAndLßdFšªcŸl
();

272 
G’”©eAndLßdHŞdšgAndT¿de
();

282 
G’”©eAndLßdIndu¡ry
();

292 
G’”©eAndLßdLa¡T¿de
();

302 
G’”©eAndLßdNewsI‹mAndNewsXRef
();

312 
G’”©eAndLßdSeùÜ
();

322 
G’”©eAndLßdSecur™y
();

332 
G’”©eAndLßdStusTy³
();

342 
G’”©eAndLßdTax¿‹
();

352 
G’”©eAndLßdT¿deTy³
();

362 
G’”©eAndLßdW©chLi¡AndW©chI‹m
();

372 
G’”©eAndLßdZCode
();

385 
G’”©eAndLßdFixedTabËs
();

399 
G’”©eAndLßdSÿlšgTabËs
();

413 
G’”©eAndLßdGrowšgTabËs
();

418 
In™Add»ss
();

419 
In™Ch¬ge
();

420 
In™CommissiÚR©e
();

421 
In™Com·nyCom³t™Ü
();

422 
In™Com·ny
();

423 
In™Cu¡om”AccouÁAndAccouÁP”missiÚ
();

424 
In™Cu¡om”
();

425 
In™Cu¡om”Tax¿‹
();

426 
In™DayM¬k‘
();

427 
In™Exchªge
();

428 
In™FšªcŸl
();

429 
In™HŞdšgAndT¿de
();

430 
In™Indu¡ry
();

431 
In™La¡T¿de
();

432 
In™NewsI‹mAndNewsXRef
();

433 
In™SeùÜ
();

434 
In™Secur™y
();

435 
In™StusTy³
();

436 
In™Tax¿‹
();

437 
In™T¿deTy³
();

438 
In™W©chLi¡AndW©chI‹m
();

439 
In™ZCode
();

441 
R–—£Add»ss
();

442 
R–—£Ch¬ge
();

443 
R–—£CommissiÚR©e
();

444 
R–—£Com·nyCom³t™Ü
();

445 
R–—£Com·ny
();

446 
R–—£Cu¡om”AccouÁAndAccouÁP”missiÚ
();

447 
R–—£Cu¡om”
();

448 
R–—£Cu¡om”Tax¿‹
();

449 
R–—£DayM¬k‘
();

450 
R–—£Exchªge
();

451 
R–—£FšªcŸl
();

452 
R–—£HŞdšgAndT¿de
();

453 
R–—£Indu¡ry
();

454 
R–—£La¡T¿de
();

455 
R–—£NewsI‹mAndNewsXRef
();

456 
R–—£SeùÜ
();

457 
R–—£Secur™y
();

458 
R–—£StusTy³
();

459 
R–—£Tax¿‹
();

460 
R–—£T¿deTy³
();

461 
R–—£W©chLi¡AndW©chI‹m
();

462 
R–—£ZCode
();

464 
PADDRESS_ROW
 
g‘Add»ssRow
();

465 
PCHARGE_ROW
 
g‘Ch¬geRow
();

466 
PCOMMISSION_RATE_ROW
 
g‘CommissiÚR©eRow
();

467 
PCOMPANY_ROW
 
g‘Com·nyRow
();

468 
PCOMPANY_COMPETITOR_ROW
 
g‘Com·nyCom³t™ÜRow
();

469 
PCUSTOMER_ROW
 
g‘Cu¡om”Row
();

470 
PCUSTOMER_ACCOUNT_ROW
 
g‘Cu¡om”AccouÁRow
();

471 
PACCOUNT_PERMISSION_ROW
 
g‘AccouÁP”missiÚRow
(
i
);

472 
PCUSTOMER_TAXRATE_ROW
 
g‘Cu¡om”Tax¿‹Row
(
i
);

473 
PDAILY_MARKET_ROW
 
g‘DayM¬k‘Row
();

474 
PEXCHANGE_ROW
 
g‘ExchªgeRow
();

475 
PFINANCIAL_ROW
 
g‘FšªcŸlRow
();

476 
PINDUSTRY_ROW
 
g‘Indu¡ryRow
();

477 
PLAST_TRADE_ROW
 
g‘La¡T¿deRow
();

478 
PNEWS_ITEM_ROW
 
g‘NewsI‹mRow
();

479 
PNEWS_XREF_ROW
 
g‘NewsXRefRow
();

480 
PSECTOR_ROW
 
g‘SeùÜRow
();

481 
PSECURITY_ROW
 
g‘Secur™yRow
();

482 
PSTATUS_TYPE_ROW
 
g‘StusTy³Row
();

483 
PTAXRATE_ROW
 
g‘Tax¿‹Row
();

484 
PTRADE_TYPE_ROW
 
g‘T¿deTy³Row
();

485 
PWATCH_LIST_ROW
 
g‘W©chLi¡Row
();

486 
PWATCH_ITEM_ROW
 
g‘W©chI‹mRow
(
i
);

487 
PZIP_CODE_ROW
 
g‘ZCodeRow
();

491 
PTRADE_ROW
 
g‘T¿deRow
();

492 
PTRADE_REQUEST_ROW
 
g‘T¿deReque¡Row
();

493 
PTRADE_HISTORY_ROW
 
g‘T¿deHi¡ÜyRow
(
i
);

494 
PCASH_TRANSACTION_ROW
 
g‘CashT¿n§ùiÚRow
();

495 
PSETTLEMENT_ROW
 
g‘S‘em’tRow
 ();

496 
PHOLDING_HISTORY_ROW
 
g‘HŞdšgHi¡ÜyRow
(
i
);

497 
PHOLDING_SUMMARY_ROW
 
g‘HŞdšgSumm¬yRow
();

498 
PBROKER_ROW
 
g‘Brok”Row
();

499 
PHOLDING_ROW
 
g‘HŞdšgRow
();

503 
boŞ
 
hasNextAdd»ss
();

504 
boŞ
 
isLa¡Ch¬ge
();

505 
boŞ
 
isLa¡CommissiÚR©e
();

506 
boŞ
 
hasNextCom·nyCom³t™Ü
();

507 
boŞ
 
hasNextCom·ny
();

508 
boŞ
 
hasNextCu¡om”AccouÁ
();

509 
P”missiÚsP”Cu¡om”
();

510 
boŞ
 
hasNextCu¡om”
();

511 
boŞ
 
hasNextCu¡om”Tax¿‹
();

512 
g‘Tax¿‹sCouÁ
();

513 
boŞ
 
hasNextDayM¬k‘
();

514 
boŞ
 
isLa¡Exchªge
();

515 
boŞ
 
hasNextFšªcŸl
();

516 
boŞ
 
isLa¡Indu¡ry
();

517 
boŞ
 
hasNextLa¡T¿de
();

518 
boŞ
 
hasNextNewsI‹mAndNewsXRef
();

519 
boŞ
 
isLa¡SeùÜ
();

520 
boŞ
 
hasNextSecur™y
();

521 
boŞ
 
isLa¡StusTy³
();

522 
boŞ
 
hasNextTax¿‹
();

523 
boŞ
 
isLa¡T¿deTy³
();

524 
boŞ
 
hasNextW©chLi¡
();

525 
I‹msP”W©chLi¡
();

526 
boŞ
 
hasNextZCode
();

528 
boŞ
 
hasNextLßdUn™
();

529 
boŞ
 
hasNextT¿de
();

530 
boŞ
 
shouldProûssT¿deReque¡Row
();

531 
g‘T¿deHi¡ÜyRowCouÁ
();

532 
boŞ
 
shouldProûssCashT¿n§ùiÚRow
();

533 
boŞ
 
shouldProûssS‘em’tRow
();

534 
boŞ
 
hasNextHŞdšg
();

535 
g‘HŞdšgHi¡ÜyRowCouÁ
();

536 
boŞ
 
hasNextHŞdšgSumm¬y
();

537 
boŞ
 
hasNextBrok”
();

541 
In™FixedTabËs
();

545 
In™SÿlšgTabËs
();

548 
In™GrowšgTabËs
();

	@include/workload/tpce/egen/EGenGenerateAndLoadBaseOutput.h

42 #iâdeà
EGEN_GENERATE_AND_LOAD_BASE_OUTPUT_H


43 
	#EGEN_GENERATE_AND_LOAD_BASE_OUTPUT_H


	)

45 
	~<¡ršg
>

47 
usšg
 
Çme¥aû
 
	g¡d
;

49 
Çme¥aû
 
	gTPCE


52 şas 
	cCG’”©eAndLßdBa£Ouut


54 
	gpublic
:

65 
vœtu®
 ~
CG’”©eAndLßdBa£Ouut
() {};

76 
vœtu®
 
OuutS¹
(
¡ršg
 
szMsg
) = 0;

87 
vœtu®
 
OuutProg»ss
(
¡ršg
 
szMsg
) = 0;

98 
vœtu®
 
OuutCom¶‘e
(
¡ršg
 
szMsg
) = 0;

109 
vœtu®
 
OuutNewlše
() = 0;

	@include/workload/tpce/egen/EGenGenerateAndLoadStandardOutput.h

41 #iâdeà
EGEN_GENERATE_AND_LOAD_STANDARD_OUTPUT_H


42 
	#EGEN_GENERATE_AND_LOAD_STANDARD_OUTPUT_H


	)

44 
	~<c¡dio
>

45 
	~<¡ršg
>

46 
	~"EG’G’”©eAndLßdBa£Ouut.h
"

48 
usšg
 
Çme¥aû
 
	g¡d
;

50 
Çme¥aû
 
	gTPCE


53 * 
­³ndZ”o
(
¡ršg
 &
s
);

55 şas 
	cCG’”©eAndLßdSnd¬dOuut
 : 
public
 
CG’”©eAndLßdBa£Ouut


57 
public
:

68 
OuutS¹
(
¡ršg
 
szMsg
)

70 * 
c
ğ
Ãw
 [
szMsg
.
size
()+1];

71 
memıy
(
c
,&
szMsg
,szMsg.
size
());

72 
	gc
[
szMsg
.
size
()]=0;

73 
	gcout
<<
	gc
;

74 
fæush
(
¡dout
);

86 
OuutProg»ss
(
¡ršg
 
szMsg
)

88 * 
	gc
ğ
Ãw
 [
szMsg
.
size
()+1];

89 
memıy
(
c
,&
szMsg
,szMsg.
size
());

90 
	gc
[
szMsg
.
size
()]=0;

91 
	gcout
<<
	gc
;

92 
fæush
(
¡dout
);

104 
OuutCom¶‘e
(
¡ršg
 
szMsg
)

106 * 
	gc
ğ
Ãw
 [
szMsg
.
size
()+1];

107 
memıy
(
c
,&
szMsg
,szMsg.
size
());

108 
	gc
[
szMsg
.
size
()]=0;

109 
	gcout
<<
	gc
;

110 
fæush
(
¡dout
);

122 
OuutNewlše
()

124 
´štf
("\n");

	@include/workload/tpce/egen/EGenGenerateAndLoad_stdafx.h

37 #iâdeà
EGEN_GENERATE_AND_LOAD_STDAFX_H


38 
	#EGEN_GENERATE_AND_LOAD_STDAFX_H


	)

40 
	#WIN32_LEAN_AND_MEAN


41 
	~<c¡dio
>

	)

42 
	~<ÿs£¹
>

43 
	~<f¡»am
>

44 
	~<£t
>

45 
	~<m­
>

46 
	~<io¡»am
>

47 
	~<®gÜ™hm
>

48 
	~<¡ršg
>

49 
	~<veùÜ
>

51 
usšg
 
Çme¥aû
 
	g¡d
;

53 
	~"EG’TabËs_¡dafx.h
"

54 
	~"EG’Ba£Lßd”_¡dafx.h
"

55 
	~"EG’G’”©eAndLßdBa£Ouut.h
"

56 
	~"EG’G’”©eAndLßdSnd¬dOuut.h
"

57 
	~"Driv”P¬amS‘tšgs.h
"

58 
	~"EG’Logg”.h
"

59 
	~"EG’G’”©eAndLßd.h
"

	@include/workload/tpce/egen/EGenLoader_stdafx.h

37 #iâdeà
EGEN_LOADER_STDAFX_H


38 
	#EGEN_LOADER_STDAFX_H


	)

40 
	#WIN32_LEAN_AND_MEAN


41 

	)

42 
	~<c¡dio
>

43 
	~<ÿs£¹
>

44 
	~<f¡»am
>

45 
	~<£t
>

46 
	~<m­
>

47 
	~<io¡»am
>

48 
	~<®gÜ™hm
>

49 
	~<¡ršg
>

50 
	~<veùÜ
>

52 #ifdeà
COMPILE_ODBC_LOAD


53 #ifdeà
WIN32


54 
	~<wšdows.h
>

57 
	~<sql.h
>

58 
	~<sqËxt.h
>

59 
	~<odbcss.h
>

63 
usšg
 
Çme¥aû
 
	g¡d
;

65 
	~"EG’TabËs_¡dafx.h
"

66 
	~"EG’Ba£Lßd”_¡dafx.h
"

67 
	~"EG’G’”©eAndLßd_¡dafx.h
"

70 
	~"NuÎLßd_¡dafx.h
"

71 #ifdeà
COMPILE_FLAT_FILE_LOAD


72 
	~"FÏtFeLßd_¡dafx.h
"

74 #ifdeà
COMPILE_ODBC_LOAD


75 
	~"wš/ODBCLßd_¡dafx.h
"

77 #ifdeà
COMPILE_CUSTOM_LOAD


78 
	~"cu¡om/Cu¡omLßd_¡dafx.h
"

80 #ifdeà
CUSTOM_LOAD_INCLUDE


81 
	#COMPILE_CUSTOM_LOAD


	)

82 #šşud
CUSTOM_LOAD_INCLUDE


86 
	#ERROR_BAD_OPTION
 1

	)

87 
	#ERROR_INPUT_FILE
 2

	)

88 
	#ERROR_INVALID_OPTION_VALUE
 3

	)

	@include/workload/tpce/egen/EGenLogFormatterTab.h

42 #iâdeà
EGEN_LOG_FORMATTER_H


43 
	#EGEN_LOG_FORMATTER_H


	)

45 
	~<io¡»am
>

46 
	~<iomª
>

47 
	~<s¡»am
>

49 
	~"EG’Ut™›s_¡dafx.h
"

50 
	~"Driv”P¬amS‘tšgs.h
"

51 
	~"Ba£LogFÜm©‹r.h
"

53 
Çme¥aû
 
	gTPCE


56 şas 
	cCLogFÜm©Tab
 : 
public
 
CBa£LogFÜm©‹r


58 
ä›nd
 
şass
 
EG’Logg”
;

60 
	g´iv©e
:

61 
o¡ršg¡»am
 
logmsg
;

63 
	gpublic
:

69 
¡ršg
 
G‘LogOuut
(
CBrok”VŞumeS‘tšgs
& 
·rms
);

71 
¡ršg
 
G‘LogOuut
(
CCu¡om”Pos™iÚS‘tšgs
& 
·rms
);

73 
¡ršg
 
G‘LogOuut
(
CM¬k‘W©chS‘tšgs
& 
·rms
);

75 
¡ršg
 
G‘LogOuut
(
CSecur™yD‘aS‘tšgs
& 
·rms
);

77 
¡ršg
 
G‘LogOuut
(
CT¿deLookupS‘tšgs
& 
·rms
);

79 
¡ršg
 
G‘LogOuut
(
CT¿deOrd”S‘tšgs
& 
·rms
);

81 
¡ršg
 
G‘LogOuut
(
CT¿deUpd©eS‘tšgs
& 
·rms
);

87 
¡ršg
 
G‘LogOuut
(
CTxnMixG’”©ÜS‘tšgs
& 
·rms
);

93 
¡ršg
 
G‘LogOuut
(
CLßd”S‘tšgs
& 
·rms
);

99 
¡ršg
 
G‘LogOuut
(
CDriv”Glob®S‘tšgs
& 
·rms
);

101 
¡ršg
 
G‘LogOuut
(
CDriv”CES‘tšgs
& 
·rms
);

103 
¡ršg
 
G‘LogOuut
(
CDriv”CEP¬t™iÚS‘tšgs
& 
·rms
);

105 
¡ršg
 
G‘LogOuut
(
CDriv”MEES‘tšgs
& 
·rms
);

107 
¡ršg
 
G‘LogOuut
(
CDriv”DMS‘tšgs
& 
·rms
);

	@include/workload/tpce/egen/EGenLogger.h

41 #iâdeà
EGEN_LOGGER_H


42 
	#EGEN_LOGGER_H


	)

44 
	~<s¡»am
>

45 
	~<f¡»am
>

47 
	~"EG’Snd¬dTy³s.h
"

48 
	~"Driv”P¬amS‘tšgs.h
"

49 
	~"EG’V”siÚ.h
"

50 
	~"Ba£Logg”.h
"

51 
	~"EG’LogFÜm©‹rTab.h
"

53 
Çme¥aû
 
	gTPCE


56 şas 
	cCEG’Logg”
 : 
public
 
CBa£Logg”


58 
´iv©e
:

59 
m_F’ame
[
iMaxP©h
];

60 
of¡»am
 
	gm_Log
;

61 
CMu‹x
 
	gm_LogLock
;

63 
boŞ
 
S’dToLogg”Im¶
(cÚ¡ *
szP»fix
, cÚ¡ *
szTime¡amp
, cÚ¡ *
szMsg
)

65 
	gm_LogLock
.
lock
();

66 
	gm_Log
 << 
	gszP»fix
 << " " << 
	gszTime¡amp
 << " " << 
	gszMsg
 << 
	g’dl
;

67 
	gm_Log
.
æush
();

68 ià(!
	gm_Log
)

70 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CEGenLogger::SendToLoggerImpl");

72 
	gm_LogLock
.
uÆock
();

73  
	gŒue
;

76 
	gpublic
:

77 
CEG’Logg”
(
eDriv”Ty³
 
drvTy³
, 
UINT32
 
UniqueId
, cÚ¡ *
szF’ame
, 
CBa£LogFÜm©‹r
* 
pLogFÜm©‹r
)

78 : 
CBa£Logg”
(
drvTy³
, 
UniqueId
, 
pLogFÜm©‹r
)

81 
¡ºıy
(
m_F’ame
, 
szF’ame
, (m_Filename));

84 
	gm_Log
.
İ’
(
m_F’ame
);

85 ià(!
	gm_Log
)

87 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eC»©eFe
, "CEGenLogger::CEGenLogger");

	@include/workload/tpce/egen/EGenNullLoader_stdafx.h

42 #iâdeà
EGEN_NULLLOADER_STDAFX_H


43 
	#EGEN_NULLLOADER_STDAFX_H


	)

45 
	~"NuÎLßd”.h
"

46 
	~"NuÎLßd”FaùÜy.h
"

	@include/workload/tpce/egen/EGenStandardTypes.h

43 #iâdeà
EGEN_STANDARD_TYPES_H


44 
	#EGEN_STANDARD_TYPES_H


	)

47 
	~<c¡ršg
>

49 
usšg
 
Çme¥aû
 
	g¡d
;

55 
	tUINT
;

78 #ifdeà
WIN32


79 
	~<wšdows.h
>

100 
	#PRId64
 "I64d"

	)

105 
	#INT64_CONST
(
x
èx ## 
I64


	)

106 
	#UINT64_CONST
(
x
èx ## 
uI64


	)

112 
HANDLE
 
	tTTh»ad
;

113 
CRITICAL_SECTION
 
	tTMu‹x
;

118 
	#¢´štf
 
_¢´štf


	)

122 #ià
defšed
 (
__unix
è|| (
_AIX
)

124 
	~<š‰y³s.h
>

126 
št8_t
 
	tINT8
, *
	tPINT8
;

127 
št16_t
 
	tINT16
, *
	tPINT16
;

128 
št32_t
 
	tINT32
, *
	tPINT32
;

129 
št64_t
 
	tINT64
, *
	tPINT64
;

131 
ušt8_t
 
	tUINT8
, *
	tPUINT8
;

132 
ušt16_t
 
	tUINT16
, *
	tPUINT16
;

133 
ušt32_t
 
	tUINT32
, *
	tPUINT32
;

134 
ušt64_t
 
	tUINT64
, *
	tPUINT64
;

145 
	#INT64_CONST
(
x
è
	`INT64_C
(x)

	)

146 
	#UINT64_CONST
(
x
è
	`UINT64_C
(x)

	)

152 
	~<±h»ad.h
>

154 
±h»ad_t
 
	tTTh»ad
;

155 
±h»ad_©Œ_t
 
	tTTh»adA‰r
;

156 
±h»ad_mu‹x_t
 
	tTMu‹x
;

164 #ià
defšed
(
DB2
)

167 
UINT16
 
	tDB_INDICATOR
;

169 #–ià
defšed
(
MSSQL
)

172 
	tDB_INDICATOR
;

174 #–ià
defšed
(
ORACLE
)

177 
sb2
 
	tDB_INDICATOR
;

182 
INT32
 
	tDB_INDICATOR
;

189 
	tTId’t
;

195 
	tTT¿de
;

	@include/workload/tpce/egen/EGenTables_common.h

37 #iâdeà
EGEN_TABLES_COMMON_H


38 
	#EGEN_TABLES_COMMON_H


	)

40 
	#WIN32_LEAN_AND_MEAN


41 

	)

42 
	~<ÿs£¹
>

43 
	~<cm©h
>

44 
	~<f¡»am
>

45 
	~<s¡»am
>

46 
	~<£t
>

47 
	~<m­
>

48 
	~<io¡»am
>

49 
	~<®gÜ™hm
>

50 
	~<¡ršg
>

51 
	~<veùÜ
>

52 
	~<queue
>

54 
usšg
 
Çme¥aû
 
	g¡d
;

56 
	~"EG’Snd¬dTy³s.h
"

57 
	~"EG’Ut™›s_¡dafx.h
"

58 
	~"TabË_Defs.h
"

59 
	~"TabËTem¶©e.h
"

60 
	~"IÅutFÏtFesDeş¬©iÚs.h
"

61 
	~"IÅutFÏtFesSŒuùu».h
"

62 
	~"IÅutFeNoWeight.h
"

63 
	~"P”sÚ.h
"

64 
	~"Cu¡om”S–eùiÚ.h
"

	@include/workload/tpce/egen/EGenTables_stdafx.h

37 #iâdeà
EGEN_TABLES_STDAFX_H


38 
	#EGEN_TABLES_STDAFX_H


	)

40 
	#WIN32_LEAN_AND_MEAN


41 

	)

42 
	~<ÿs£¹
>

43 
	~<cm©h
>

44 
	~<f¡»am
>

45 
	~<£t
>

46 
	~<m­
>

47 
	~<io¡»am
>

48 
	~<®gÜ™hm
>

49 
	~<¡ršg
>

50 
	~<veùÜ
>

51 
	~<queue
>

54 
usšg
 
Çme¥aû
 
	g¡d
;

56 
	~"EG’Snd¬dTy³s.h
"

57 
	~"EG’Ut™›s_¡dafx.h
"

58 
	~"IÅutFe.h
"

59 
	~"IÅutFeNoWeight.h
"

60 
	~"FÏtFe.h
"

61 
	~"TabË_Defs.h
"

62 
	~"IÅutFÏtFesDeş¬©iÚs.h
"

63 
	~"Secur™yFe.h
"

64 
	~"Com·nyFe.h
"

65 
	~"Com·nyCom³t™ÜFe.h
"

66 
	~"IÅutFÏtFesSŒuùu».h
"

67 
	~"TabËTem¶©e.h
"

68 
	~"P”sÚ.h
"

69 
	~"Cu¡om”S–eùiÚ.h
"

70 
	~"Cu¡om”TabË.h
"

71 
	~"Com·nyTabË.h
"

72 
	~"FšªcŸlTabË.h
"

73 
	~"Add»ssTabË.h
"

74 
	~"Cu¡om”AccouÁsAndP”missiÚsTabË.h
"

75 
	~"Cu¡om”Tax¿‹sTabË.h
"

76 
	~"HŞdšgsAndT¿desTabË.h
"

77 
	~"W©chLi¡sAndI‹msTabË.h
"

78 
	~"Secur™yTabË.h
"

79 
	~"DayM¬k‘TabË.h
"

80 
	~"Brok”s.h
"

81 
	~"SeùÜTabË.h
"

82 
	~"Ch¬geTabË.h
"

83 
	~"ExchªgeTabË.h
"

84 
	~"CommissiÚR©eTabË.h
"

85 
	~"Indu¡ryTabË.h
"

86 
	~"StusTy³TabË.h
"

87 
	~"Tax¿‹TabË.h
"

88 
	~"T¿deTy³TabË.h
"

89 
	~"Com·nyCom³t™ÜTabË.h
"

90 
	~"ZCodeTabË.h
"

91 
	~"NewsI‹mAndXRefTabË.h
"

92 
	~"MEESecur™y.h
"

93 
	~"La¡T¿deTabË.h
"

94 
	~"T¿deG’.h
"

	@include/workload/tpce/egen/EGenUtilities_stdafx.h

37 #iâdeà
EGEN_UTILITIES_STDAFX_H


38 
	#EGEN_UTILITIES_STDAFX_H


	)

40 
	#WIN32_LEAN_AND_MEAN


41 

	)

42 
	~<c¡ddef
>

43 
	~<c¡dio
>

44 #ifdeà
WIN32


45 
	~<wšdows.h
>

47 
	~<û¼no
>

48 
	~<sys/time.h
>

50 
	~<ùime
>

51 
	~<ÿs£¹
>

52 
	~<li¡
>

53 
	~<io¡»am
>

54 
	~<s¡»am
>

55 
	~<f¡»am
>

56 
	~<¡ršg
>

57 
	~<veùÜ
>

59 #ifdeà
NEED_STDIO_H


60 
	~<¡dio.h
>

63 #ifdeà
__SUNPRO_CC


64 
	~<¡dio.h
>

67 
usšg
 
Çme¥aû
 
	g¡d
;

70 
	~"EG’Snd¬dTy³s.h
"

71 
	~"D©eTime.h
"

72 
	~"Rªdom.h
"

73 
	~"”rÜ.h
"

74 
	~"TabËCÚ¡s.h
"

75 
	~"MiscCÚ¡s.h
"

76 
	~"FixedM­.h
"

77 
	~"FixedA¼ay.h
"

79 
	~"lockšg.h
"

80 
	~"RNGS“ds.h
"

81 
	~"EG’V”siÚ.h
"

82 
	~"MÚey.h
"

	@include/workload/tpce/egen/EGenVersion.h

42 #iâdeà
EGEN_VERSION_H


43 
	#EGEN_VERSION_H


	)

45 
	~"EG’Snd¬dTy³s.h
"

47 
Çme¥aû
 
	gTPCE


52 
G‘EG’V”siÚ_C
(
INT32
 &
iMajÜV”siÚ
, INT32 &
iMšÜV”siÚ
, INT32 &
iRevisiÚNumb”
, INT32 &
iB‘aLev–
);

53 
G‘EG’V”siÚSŒšg_C
(* 
szOuut
, 
size_t
 
iOuutBufãrL’
);

54 
PrštEG’V”siÚ_C
();

55 
G‘EG’V”siÚUpd©eTime¡amp_C
(* 
szOuut
, 
size_t
 
iOuutBufãrL’
);

70 
G‘EG’V”siÚ
(
INT32
 &
iMajÜV”siÚ
, INT32 &
iMšÜV”siÚ
, INT32 &
iRevisiÚNumb”
, INT32 &
iB‘aLev–
);

76 
G‘EG’V”siÚSŒšg
(* 
szOuut
, 
size_t
 
iOuutBufãrL’
);

80 
PrštEG’V”siÚ
();

84 
G‘EG’V”siÚUpd©eTime¡amp
(* 
szOuut
, 
size_t
 
iOuutBufãrL’
);

	@include/workload/tpce/egen/ExchangeTable.h

40 #iâdeà
EXCHANGE_TABLE_H


41 
	#EXCHANGE_TABLE_H


	)

43 
	~"EG’TabËs_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 cÚ¡ 
	giSecur™yCouÁs
[4][11] = { { 0, 153, 307, 491, 688, 859, 1028, 1203, 1360, 1532, 1704 },

53 
şass
 
	gCExchªgeTabË
 : 
public
 
TabËTem¶©e
<
EXCHANGE_ROW
>

55 
if¡»am
 
InFe
;

56 
TId’t
 
	gm_iCurExchªge
;

57 
INT32
 
	gm_iNumSecur™›s
[4];

64 
Compu‹NumSecur™›s
Ğ
TId’t
 
iCu¡om”CouÁ
 )

66 
INT32
 
	gnumLU
 = 
¡©ic_ÿ¡
<INT32>(
iCu¡om”CouÁ
 / 1000);

67 
INT32
 
	gnumLU_T’s
 = 
numLU
 / 10;

68 
INT32
 
	gnumLU_OÃs
 = 
numLU
 % 10;

70 
	gi
=0; i<4; i++)

72 
	gm_iNumSecur™›s
[
i
] = 
iSecur™yCouÁs
[i][10] * 
numLU_T’s
 + iSecur™yCouÁs[i][
numLU_OÃs
];

76 
	gpublic
:

77 
CExchªgeTabË
Ğ*
szDœName
, 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
 )

78 : 
TabËTem¶©e
<
EXCHANGE_ROW
>()

80 
szFeName
[
iMaxP©h
];

82 
¡ºıy
(
szFeName
, 
szDœName
, (szFileName));

83 
¡ºÿt
(
szFeName
, "Exchªge.txt", (szFeNameè- 
¡¾’
(
szDœName
) - 1);

85 
	gInFe
.
İ’
Ğ
szFeName
 );

87 
Compu‹NumSecur™›s
(
iCÚfigu»dCu¡om”CouÁ
);

89 
	gm_iCurExchªge
 = 1;

92 ~
CExchªgeTabË
( )

94 
	gInFe
.
şo£
();

100 
boŞ
 
G’”©eNextRecÜd
()

102 ifĞ
	gInFe
.
good
() )

104 
	gm_row
.
Lßd
(
InFe
);

105 
	gm_row
.
	gEX_AD_ID
 +ğ
iTId’tShiá
;

106 
	gm_row
.
	gEX_NUM_SYMB
 = 
m_iNumSecur™›s
[
m_iCurExchªge
-1];

108 
	gm_iCurExchªge
++;

111 
boŞ
 
	gxx
 =
InFe
.
eof
();

112  ( 
	gxx
 );

	@include/workload/tpce/egen/FinalTransform.h

45 #iâdeà
FINAL_TRANSFORM_H


46 
	#FINAL_TRANSFORM_H


	)

48 
	~"EG’TabËs_¡dafx.h
"

50 
Çme¥aû
 
	gTPCE


53 şas 
	cCFš®T¿nsfÜm


55 
	gpublic
:

57 
T¿nsfÜm
(
PACCOUNT_PERMISSION_ROW
 
pRow
)

59 
pRow
->
AP_CA_ID
 +ğ
iTId’tShiá
;

62 
T¿nsfÜm
(
PADDRESS_ROW
 
pRow
)

64 
	gpRow
->
	gAD_ID
 +ğ
iTId’tShiá
;

67 
T¿nsfÜm
(
PBROKER_ROW
 
pRow
)

69 
	gpRow
->
	gB_ID
 +ğ
iTId’tShiá
;

72 
T¿nsfÜm
(
PCASH_TRANSACTION_ROW
 
pRow
)

74 
	gpRow
->
	gCT_T_ID
 +ğ
iTT¿deShiá
;

77 
T¿nsfÜm
(
PCHARGE_ROW
 
pRow
)

82 
T¿nsfÜm
(
PCOMMISSION_RATE_ROW
 
pRow
)

87 
T¿nsfÜm
(
PCOMPANY_ROW
 
pRow
)

89 
	gpRow
->
	gCO_ID
 +ğ
iTId’tShiá
;

90 
	gpRow
->
	gCO_AD_ID
 +ğ
iTId’tShiá
;

93 
T¿nsfÜm
(
PCOMPANY_COMPETITOR_ROW
 
pRow
)

95 
	gpRow
->
	gCP_CO_ID
 +ğ
iTId’tShiá
;

96 
	gpRow
->
	gCP_COMP_CO_ID
 +ğ
iTId’tShiá
;

99 
T¿nsfÜm
(
PCUSTOMER_ROW
 
pRow
)

101 
	gpRow
->
	gC_ID
 +ğ
iTId’tShiá
;

102 
	gpRow
->
	gC_AD_ID
 +ğ
iTId’tShiá
;

105 
T¿nsfÜm
(
PCUSTOMER_ACCOUNT_ROW
 
pRow
)

107 
	gpRow
->
	gCA_ID
 +ğ
iTId’tShiá
;

108 
	gpRow
->
	gCA_B_ID
 +ğ
iTId’tShiá
;

109 
	gpRow
->
	gCA_C_ID
 +ğ
iTId’tShiá
;

112 
T¿nsfÜm
(
PCUSTOMER_TAXRATE_ROW
 
pRow
)

114 
	gpRow
->
	gCX_C_ID
 +ğ
iTId’tShiá
;

117 
T¿nsfÜm
(
PDAILY_MARKET_ROW
 
pRow
)

122 
T¿nsfÜm
(
PEXCHANGE_ROW
 
pRow
)

124 
	gpRow
->
	gEX_AD_ID
 +ğ
iTId’tShiá
;

127 
T¿nsfÜm
(
PFINANCIAL_ROW
 
pRow
)

129 
	gpRow
->
	gFI_CO_ID
 +ğ
iTId’tShiá
;

132 
T¿nsfÜm
(
PHOLDING_ROW
 
pRow
)

134 
	gpRow
->
	gH_T_ID
 +ğ
iTT¿deShiá
;

135 
	gpRow
->
	gH_CA_ID
 +ğ
iTId’tShiá
;

138 
T¿nsfÜm
(
PHOLDING_HISTORY_ROW
 
pRow
)

140 
	gpRow
->
	gHH_H_T_ID
 +ğ
iTT¿deShiá
;

141 
	gpRow
->
	gHH_T_ID
 +ğ
iTT¿deShiá
;

144 
T¿nsfÜm
(
PHOLDING_SUMMARY_ROW
 
pRow
)

146 
	gpRow
->
	gHS_CA_ID
 +ğ
iTId’tShiá
;

149 
T¿nsfÜm
(
PINDUSTRY_ROW
 
pRow
)

154 
T¿nsfÜm
(
PLAST_TRADE_ROW
 
pRow
)

159 
T¿nsfÜm
(
PNEWS_ITEM_ROW
 
pRow
)

161 
	gpRow
->
	gNI_ID
 +ğ
iTId’tShiá
;

164 
T¿nsfÜm
(
PNEWS_XREF_ROW
 
pRow
)

166 
	gpRow
->
	gNX_NI_ID
 +ğ
iTId’tShiá
;

167 
	gpRow
->
	gNX_CO_ID
 +ğ
iTId’tShiá
;

170 
T¿nsfÜm
(
PSECTOR_ROW
 
pRow
)

175 
T¿nsfÜm
(
PSECURITY_ROW
 
pRow
)

177 
	gpRow
->
	gS_CO_ID
 +ğ
iTId’tShiá
;

180 
T¿nsfÜm
(
PSETTLEMENT_ROW
 
pRow
)

182 
	gpRow
->
	gSE_T_ID
 +ğ
iTT¿deShiá
;

185 
T¿nsfÜm
(
PSTATUS_TYPE_ROW
 
pRow
)

190 
T¿nsfÜm
(
PTAXRATE_ROW
 
pRow
)

195 
T¿nsfÜm
(
PTRADE_ROW
 
pRow
)

197 
	gpRow
->
	gT_ID
 +ğ
iTT¿deShiá
;

198 
	gpRow
->
	gT_CA_ID
 +ğ
iTId’tShiá
;

201 
T¿nsfÜm
(
PTRADE_HISTORY_ROW
 
pRow
)

203 
	gpRow
->
	gTH_T_ID
 +ğ
iTT¿deShiá
;

206 
T¿nsfÜm
(
PTRADE_REQUEST_ROW
 
pRow
)

208 
	gpRow
->
	gTR_T_ID
 +ğ
iTT¿deShiá
;

209 
	gpRow
->
	gTR_B_ID
 +ğ
iTId’tShiá
;

212 
T¿nsfÜm
(
PTRADE_TYPE_ROW
 
pRow
)

217 
T¿nsfÜm
(
PWATCH_ITEM_ROW
 
pRow
)

219 
	gpRow
->
	gWI_WL_ID
 +ğ
iTId’tShiá
;

222 
T¿nsfÜm
(
PWATCH_LIST_ROW
 
pRow
)

224 
	gpRow
->
	gWL_ID
 +ğ
iTId’tShiá
;

225 
	gpRow
->
	gWL_C_ID
 +ğ
iTId’tShiá
;

228 
T¿nsfÜm
(
PZIP_CODE_ROW
 
pRow
)

235 
T¿nsfÜmCu¡om”Id
(
TId’t
* 
pC_ID
)

237 *
	gpC_ID
 +ğ
iTId’tShiá
;

240 
T¿nsfÜmCu¡om”AccouÁId
(
TId’t
* 
pCA_ID
)

242 *
	gpCA_ID
 +ğ
iTId’tShiá
;

245 
T¿nsfÜmT¿deId
(
TT¿de
* 
pT_ID
)

247 *
	gpT_ID
 +ğ
iTT¿deShiá
;

	@include/workload/tpce/egen/FinancialTable.h

40 #iâdeà
FINANCIAL_TABLE_H


41 
	#FINANCIAL_TABLE_H


	)

43 
	~"EG’TabËs_commÚ.h
"

44 
	~"Com·nyTabË.h
"

45 
	~"MÚey.h
"

47 
Çme¥aû
 
	gTPCE


50 cÚ¡ 
	giY—rsFÜFšs
 = 5;

51 cÚ¡ 
	giQu¬‹rsInY—r
 = 4;

52 cÚ¡ 
	giFšsP”Com·ny
 = 
iY—rsFÜFšs
 * 
iQu¬‹rsInY—r
;

55 cÚ¡ 
	gfDu‹dSh¬esMuÉl›r
 = 1.1;

58 cÚ¡ 
	gfFšD©aDownMuÉ
 = 0.9;

59 cÚ¡ 
	gfFšD©aUpMuÉ
 = 1.15;

60 cÚ¡ 
	gfFšD©aInü
 = 0.00000000000001;

62 cÚ¡ 
	gfFšªcŸlRev’ueMš
 = 100000.00;

63 cÚ¡ 
	gfFšªcŸlRev’ueMax
 = 16000000000.00;

65 cÚ¡ 
	gfFšªcŸlE¬nšgsMš
 = -300000000.00;

66 cÚ¡ 
	gfFšªcŸlE¬nšgsMax
 = 3000000000.00;

68 cÚ¡ 
INT64
 
	giFšªcŸlOutBasicMš
 = 400000;

69 cÚ¡ 
INT64
 
	giFšªcŸlOutBasicMax
 = 9500000000;

71 cÚ¡ 
	gfFšªcŸlInv’tMš
 = 0.00;

72 cÚ¡ 
	gfFšªcŸlInv’tMax
 = 2000000000.00;

74 cÚ¡ 
	gfFšªcŸlAs£tsMš
 = 100000.00;

75 cÚ¡ 
	gfFšªcŸlAs£tsMax
 = 65000000000.00;

77 cÚ¡ 
	gfFšªcŸlLŸbMš
 = 100000.00;

78 cÚ¡ 
	gfFšªcŸlLŸbMax
 = 35000000000.00;

83 cÚ¡ 
	giRNGSkOÃRowFšªcŸl
 = 6 + 
iFšsP”Com·ny
 * 6;

85 
	sFINANCIAL_GEN_ROW


87 
FINANCIAL_ROW
 
	gm_fšªcŸls
[ 
iFšsP”Com·ny
 ];

88 } *
	tPFINANCIAL_GEN_ROW
;

90 
şass
 
	gCFšªcŸlTabË
 : 
public
 
TabËTem¶©e
<
FINANCIAL_GEN_ROW
>

92 
CCom·nyTabË
 
m_Com·nyTabË
;

93 
	gm_iFšY—r
;

94 
	gm_iFšQu¬‹r
;

97 
	gm_iRowsG’”©edP”Com·ny
;

100 
boŞ
 
	gm_bMÜeCom·n›s
;

101 
TId’t
 
	gm_iFšªcŸlCouÁFÜOÃLßdUn™
;

108 
boŞ
 
G’”©eFšªcŸlRows
()

110 
TId’t
 
	gFI_CO_ID
;

111 
	giFšY—r
, 
	giFšQu¬‹r
;

112 
	gi
;

113 
CMÚey
 
	gfRev
, 
	gfE¬n
, 
	gfInv’t
, 
	gfAs£ts
, 
	gfLŸb
, 
	gfBasicEPS
, 
	gfDutEPS
, 
	gfM¬gš
;

114 
INT64
 
	giOutBasic
, 
	giOutDut
;

117 
	gFI_CO_ID
 = 
m_Com·nyTabË
.
G‘Cu¼’tCO_ID
();

118 
	giFšY—r
 = 
m_iFšY—r
;

119 
	giFšQu¬‹r
 = 
m_iFšQu¬‹r
;

121 
	gfRev
 = 
m_ºd
.
RndDoubËInüRªge
Ğ
fFšªcŸlRev’ueMš
, 
fFšªcŸlRev’ueMax
, 0.01 );

122 
	gfE¬n
 = 
m_ºd
.
RndDoubËInüRªge
Ğ
fFšªcŸlE¬nšgsMš
,

123 
fRev
 < 
fFšªcŸlE¬nšgsMax
 ? fRev.
DŞÏrAmouÁ
() : fFinancialEarningsMax,

125 
	giOutBasic
 = 
m_ºd
.
RndIÁ64Rªge
Ğ
iFšªcŸlOutBasicMš
, 
iFšªcŸlOutBasicMax
 );

126 
	giOutDut
 = 0;

127 
	gfInv’t
 = 
m_ºd
.
RndDoubËInüRªge
Ğ
fFšªcŸlInv’tMš
, 
fFšªcŸlInv’tMax
, 0.01 );

128 
	gfAs£ts
 = 
m_ºd
.
RndDoubËInüRªge
Ğ
fFšªcŸlAs£tsMš
, 
fFšªcŸlAs£tsMax
, 0.01 );

129 
	gfLŸb
 = 
m_ºd
.
RndDoubËInüRªge
Ğ
fFšªcŸlLŸbMš
, 
fFšªcŸlLŸbMax
, 0.01 );

130 
	gfBasicEPS
 = 0.00;

131 
	gfDutEPS
 = 0.00;

132 
	gfM¬gš
 = 0.00;

134 
	gi
 = 0; i<
	giFšsP”Com·ny
; ++i)

137 
	gfRev
 = 
fRev
 * 
m_ºd
.
RndDoubËInüRªge
(
fFšD©aDownMuÉ
, 
fFšD©aUpMuÉ
, 
fFšD©aInü
);

138 
	gfE¬n
 = 
fE¬n
 * 
m_ºd
.
RndDoubËInüRªge
(
fFšD©aDownMuÉ
, 
fFšD©aUpMuÉ
, 
fFšD©aInü
);

139 ià(
	gfE¬n
 >ğ
fRev
)

141 
fE¬n
 = fE¬À* 
fFšD©aDownMuÉ
;

143 
	giOutBasic
 = (
INT64
)(()
iOutBasic
 * 
m_ºd
.
RndDoubËInüRªge
(
fFšD©aDownMuÉ
, 
fFšD©aUpMuÉ
, 
fFšD©aInü
));

144 
	giOutDut
 = (
INT64
)(()
iOutBasic
 * 
fDu‹dSh¬esMuÉl›r
);

145 
	gfInv’t
 = 
fInv’t
 * 
m_ºd
.
RndDoubËInüRªge
(
fFšD©aDownMuÉ
, 
fFšD©aUpMuÉ
, 
fFšD©aInü
);

146 
	gfAs£ts
 = 
fAs£ts
 * 
m_ºd
.
RndDoubËInüRªge
(
fFšD©aDownMuÉ
, 
fFšD©aUpMuÉ
, 
fFšD©aInü
);

147 
	gfLŸb
 = 
fLŸb
 * 
m_ºd
.
RndDoubËInüRªge
(
fFšD©aDownMuÉ
, 
fFšD©aUpMuÉ
, 
fFšD©aInü
);

148 
	gfBasicEPS
 = 
fE¬n
 / ()
iOutBasic
;

149 
	gfDutEPS
 = 
fE¬n
 / ()
iOutDut
;

150 
	gfM¬gš
 = 
fE¬n
 / 
fRev
.
DŞÏrAmouÁ
();

153 
	gm_row
.
	gm_fšªcŸls
[
i
].
	gFI_CO_ID
 = 
FI_CO_ID
;

154 
	gm_row
.
	gm_fšªcŸls
[
i
].
	gFI_YEAR
 = 
iFšY—r
;

155 
	gm_row
.
	gm_fšªcŸls
[
i
].
	gFI_QTR
 = 
iFšQu¬‹r
 + 1;

156 
	gm_row
.
	gm_fšªcŸls
[
i
].
	gFI_QTR_START_DATE
.
S‘
(
iFšY—r
, 
iFšQu¬‹r
 * 3 + 1, 1);

157 
	gm_row
.
	gm_fšªcŸls
[
i
].
	gFI_REVENUE
 = 
fRev
.
DŞÏrAmouÁ
();

158 
	gm_row
.
	gm_fšªcŸls
[
i
].
	gFI_NET_EARN
 = 
fE¬n
.
DŞÏrAmouÁ
();

159 
	gm_row
.
	gm_fšªcŸls
[
i
].
	gFI_OUT_BASIC
 = 
iOutBasic
;

160 
	gm_row
.
	gm_fšªcŸls
[
i
].
	gFI_OUT_DILUT
 = 
iOutDut
;

161 
	gm_row
.
	gm_fšªcŸls
[
i
].
	gFI_INVENTORY
 = 
fInv’t
.
DŞÏrAmouÁ
();

162 
	gm_row
.
	gm_fšªcŸls
[
i
].
	gFI_ASSETS
 = 
fAs£ts
.
DŞÏrAmouÁ
();

163 
	gm_row
.
	gm_fšªcŸls
[
i
].
	gFI_LIABILITY
 = 
fLŸb
.
DŞÏrAmouÁ
();

164 
	gm_row
.
	gm_fšªcŸls
[
i
].
	gFI_BASIC_EPS
 = 
fBasicEPS
.
DŞÏrAmouÁ
();

165 
	gm_row
.
	gm_fšªcŸls
[
i
].
	gFI_DILUT_EPS
 = 
fDutEPS
.
DŞÏrAmouÁ
();

166 
	gm_row
.
	gm_fšªcŸls
[
i
].
	gFI_MARGIN
 = 
fM¬gš
.
DŞÏrAmouÁ
();

169 
	giFšQu¬‹r
++;

170 ià(
	giFšQu¬‹r
 =ğ
iQu¬‹rsInY—r
)

172 
iFšQu¬‹r
 = 0;

173 ++
	giFšY—r
;

177  
	gm_Com·nyTabË
.
G’”©eNextCO_ID
();

189 
In™NextLßdUn™
()

191 
	gm_ºd
.
S‘S“d
(
m_ºd
.
RndNthEËm’t
(
RNGS“dTabËDeçuÉ
,

192 (
RNGSEED
)
m_iLa¡RowNumb”
 * 
iRNGSkOÃRowFšªcŸl
));

194 
CË¬RecÜd
();

197 
	gpublic
:

198 
CFšªcŸlTabË
(
CIÅutFes
 
šputFes
,

199 
TId’t
 
iCu¡om”CouÁ
,

200 
TId’t
 
iS¹FromCu¡om”
)

201 : 
TabËTem¶©e
<
FINANCIAL_GEN_ROW
>()

202 , 
m_Com·nyTabË
(
šputFes
, 
iCu¡om”CouÁ
, 
iS¹FromCu¡om”
)

203 , 
m_iRowsG’”©edP”Com·ny
(
iFšsP”Com·ny
)

204 , 
m_bMÜeCom·n›s
(
Œue
)

208 
	gm_iFšY—r
 = 
iDayM¬k‘Ba£Y—r
;

209 
	gm_iFšQu¬‹r
 = 
iDayM¬k‘Ba£MÚth
 / 3;

211 
	gm_bMÜeRecÜds
 = 
Œue
;

213 
	gm_iFšªcŸlCouÁFÜOÃLßdUn™
 = 
šputFes
.
Com·ny
->
C®cuÏ‹Com·nyCouÁ
(
iDeçuÉLßdUn™Size
è* 
iFšsP”Com·ny
;

215 
	gm_iLa¡RowNumb”
 = 
šputFes
.
Com·ny
->
C®cuÏ‹S¹FromCom·ny
(
iS¹FromCu¡om”
è* 
iFšsP”Com·ny
;

218 
boŞ
 
G’”©eNextRecÜd
()

222 ià(
	gm_iLa¡RowNumb”
 % 
	gm_iFšªcŸlCouÁFÜOÃLßdUn™
 == 0)

224 
In™NextLßdUn™
();

227 ++
	gm_iLa¡RowNumb”
;

229 ++
	gm_iRowsG’”©edP”Com·ny
;

231 ià(
	gm_iRowsG’”©edP”Com·ny
 >ğ
iFšsP”Com·ny
)

233 ià(
m_bMÜeCom·n›s
)

237 
m_bMÜeCom·n›s
 = 
G’”©eFšªcŸlRows
();

239 
	gm_iRowsG’”©edP”Com·ny
 = 0;

244 ià(!
	gm_bMÜeCom·n›s
 && (
	gm_iRowsG’”©edP”Com·ny
 =ğ
iFšsP”Com·ny
 - 1))

246 
m_bMÜeRecÜds
 = 
çl£
;

249  
MÜeRecÜds
();

252 
PFINANCIAL_ROW
 
G‘Row
()

254  &
	gm_row
.
	gm_fšªcŸls
[
m_iRowsG’”©edP”Com·ny
];

	@include/workload/tpce/egen/FixedArray.h

41 #iâdeà
FIXED_ARRAY_H


42 
	#FIXED_ARRAY_H


	)

44 
	~"EG’Ut™›s_¡dafx.h
"

46 
Çme¥aû
 
	gTPCE


49 şas 
	cCFixedA¼ayE¼
 : 
public
 
CBa£E¼


51 
public
:

52 
	eeFixedA¼ayE¼s


54 
eNÙEnoughMemÜy
,

55 
	geIndexOutOfRªge
,

56 
	geOv”æow


59 
CFixedA¼ayE¼
Ğ
eFixedA¼ayE¼s
 
iE¼
, cÚ¡ *
szLoc
è: 
CBa£E¼
(iErr, szLoc) {};

60 
E¼ÜTy³
(è{ 
	gERR_TYPE_FIXED_ARRAY
;};

62 cÚ¡ *
E¼ÜText
() const

64 
	gi
;

65 cÚ¡ * 
	gszE¼s
[] = {

72 
	gi
 = 0; 
	gszE¼s
[
i
][0]; i++)

75 iàĞ
	gi
 =ğ
m_idMsg
 )

79 (
	gszE¼s
[
i
][0] ? szE¼s[i] : 
ERR_UNKNOWN
);

91 
	g‹m¶©e
 <
ty³Çme
 
	gTD©a
,y³Çm
	gTEËm’tsLim™s
>

92 şas 
	cCFixedA¼ay


95 
TEËm’tsLim™s
 
	gm_sLim™s
;

96 
	gm_iTÙ®EËm’ts
;

97 
	gm_iCu¼’tEËm’ts
;

98 
TD©a
 *
	gm_pD©a
;

100 
	gpublic
:

101 
TD©a
* 
	tPD©a
;

104 
CFixedA¼ay
()

105 : 
m_iCu¼’tEËm’ts
(0)

107 
m_iTÙ®EËm’ts
 = 
m_sLim™s
.
TÙ®EËm’ts
();

109 
	gm_pD©a
 = 
Ãw
 
TD©a
[
m_iTÙ®EËm’ts
];

112 ~
CFixedA¼ay
()

114 ià(
	gm_pD©a
 !ğ
NULL
)

115 
d–‘e
 [] 
m_pD©a
;

120 
Add
(
TD©a
 *
pD©a
)

122 ià(
	gm_iCu¼’tEËm’ts
 < 
	gm_iTÙ®EËm’ts
)

125 
	gm_pD©a
[
m_iCu¼’tEËm’ts
] = *
pD©a
;

127 ++
	gm_iCu¼’tEËm’ts
;

132 
throw
 
CFixedA¼ayE¼
(CFixedA¼ayE¼::
eOv”æow
, "CFixedArray::Add");

137 
	gTD©a
& 
	gİ”©Ü
[](
	giIndex
)

139 
as£¹
(
iIndex
>=0 && iIndex < 
m_iTÙ®EËm’ts
);

141  
	gm_pD©a
[
iIndex
];

145 
size
(è{ 
	gm_iTÙ®EËm’ts
;}

	@include/workload/tpce/egen/FixedMap.h

43 #iâdeà
FIXED_MAP_H


44 
	#FIXED_MAP_H


	)

46 
	~"EG’Ut™›s_¡dafx.h
"

48 
Çme¥aû
 
	gTPCE


51 şas 
	cCFixedM­E¼
 : 
public
 
CBa£E¼


53 
public
:

54 
	eeFixedM­E¼s


56 
eNÙEnoughMemÜy
,

57 
	geKeyOutOfRªge
,

58 
	geOv”æow


61 
CFixedM­E¼
Ğ
eFixedM­E¼s
 
iE¼
, cÚ¡ *
szLoc
è: 
CBa£E¼
(iErr, szLoc) {};

62 
E¼ÜTy³
(è{ 
	gERR_TYPE_FIXED_MAP
;};

64 cÚ¡ *
E¼ÜText
() const

66 
	gi
;

67 cÚ¡ * 
	gszE¼s
[] = {

74 
	gi
 = 0; 
	gszE¼s
[
i
][0]; i++)

77 iàĞ
	gi
 =ğ
m_idMsg
 )

81 (
	gszE¼s
[
i
][0] ? szE¼s[i] : 
ERR_UNKNOWN
);

96 
	g‹m¶©e
 <
ty³Çme
 
	gTD©a
,y³Çm
	gTKeyAndEËm’tsLim™s
>

97 şas 
	cCFixedM­


102 
TKeyAndEËm’tsLim™s
 
	gm_sLim™s
;

103 
	gm_iHighe¡Key
;

104 
UINT
 
	gm_iCu¼’tEËm’ts
;

105 
TD©a
 *
	gm_pD©a
;

106 
UINT
 *
	gm_keys
;

111 
	gpublic
:

112 
TD©a
* 
	tPD©a
;

115 
CFixedM­
()

116 : 
m_iCu¼’tEËm’ts
(0)

118 
m_iHighe¡Key
 = 
m_sLim™s
.
Highe¡Key
();

120 
	gm_keys
 = 
Ãw
 
UINT
[
m_iHighe¡Key
];

122 
	gm_pD©a
 = 
Ãw
 
TD©a
[
m_sLim™s
.
TÙ®EËm’ts
()];

125 ~
CFixedM­
()

127 ià(
	gm_keys
 !ğ
NULL
)

128 
d–‘e
 [] 
m_keys
;

130 ià(
	gm_pD©a
 !ğ
NULL
)

131 
d–‘e
 [] 
m_pD©a
;

138 
Add
(
iKey
, 
TD©a
 *
pD©a
, 
iP»vKeysToFl
 = 1)

140 ià(
m_iCu¼’tEËm’ts
 < 
m_sLim™s
.
TÙ®EËm’ts
())

142 ià(
iKey
>=0 && iKey < 
m_iHighe¡Key
)

145 
j
 = 0; 
	gj
 < 
	giP»vKeysToFl
 && (
	giKey
 - j)>=0; ++j)

146 
	gm_keys
[
iKey
 - 
j
] = 
m_iCu¼’tEËm’ts
;

148 
	gm_pD©a
[
m_iCu¼’tEËm’ts
] = *
pD©a
;

150 ++
	gm_iCu¼’tEËm’ts
;

154 
throw
 
CFixedM­E¼
(CFixedM­E¼::
eKeyOutOfRªge
, "CFixedMap::Add");

160 
throw
 
CFixedM­E¼
(CFixedM­E¼::
eOv”æow
, "CFixedMap::Add");

166 
TD©a
* 
G‘EËm’t
(
iKey
)

168 
as£¹
(
iKey
>=0 && iKey < 
m_iHighe¡Key
);

170  &
	gm_pD©a
[
m_keys
[
iKey
]];

174 
TD©a
* 
G‘EËm’tByPassKey
Ğ
UINT
 
EËm’tID
 )

176 
as£¹
Ğ
EËm’tID
 < 
m_iCu¼’tEËm’ts
 );

177 Ğ&
	gm_pD©a
[
EËm’tID
] );

181 
UINT
 
EËm’tCouÁ
( )

183  
	gm_iCu¼’tEËm’ts
;

187 
G‘Highe¡Key
(è{ 
	gm_iHighe¡Key
;}

	@include/workload/tpce/egen/FlatAccountPermissionLoad.h

41 #iâdeà
FLAT_ACCOUNT_PERMISSION_LOAD_H


42 
	#FLAT_ACCOUNT_PERMISSION_LOAD_H


	)

44 
	~"FÏtFeLßd_commÚ.h
"

46 
Çme¥aû
 
	gTPCE


49 
şass
 
	gCFÏtAccouÁP”missiÚLßd
 : 
public
 
CFÏtFeLßd”
 <
ACCOUNT_PERMISSION_ROW
>

51 
public
:

52 
CFÏtAccouÁP”missiÚLßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
è: 
CFÏtFeLßd”
<
ACCOUNT_PERMISSION_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

57 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

59 
	grc
 = 
årštf
Ğ
hOutFe
, 
AccouÁP”missiÚRowFmt
,

60 
Ãxt_»cÜd
->
AP_CA_ID
,

61 
Ãxt_»cÜd
->
AP_ACL
,

62 
Ãxt_»cÜd
->
AP_TAX_ID
,

63 
Ãxt_»cÜd
->
AP_L_NAME
,

64 
Ãxt_»cÜd
->
AP_F_NAME


67 ià(
	grc
 < 0) {

68 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatAccountPermissionLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatAddressLoad.h

41 #iâdeà
FLAT_ADDRESS_LOAD_H


42 
	#FLAT_ADDRESS_LOAD_H


	)

44 
	~"FÏtFeLßd_commÚ.h
"

46 
Çme¥aû
 
	gTPCE


49 
şass
 
	gCFÏtAdd»ssLßd
 : 
public
 
CFÏtFeLßd”
 <
ADDRESS_ROW
>

51 
public
:

52 
CFÏtAdd»ssLßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
ADDRESS_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

57 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

59 
	grc
 = 
årštf
Ğ
hOutFe
, 
Add»ssRowFmt
,

60 
Ãxt_»cÜd
->
AD_ID
,

61 
Ãxt_»cÜd
->
AD_LINE1
,

62 
Ãxt_»cÜd
->
AD_LINE2
,

63 
Ãxt_»cÜd
->
AD_ZC_CODE
,

64 
Ãxt_»cÜd
->
AD_CTRY


67 ià(
	grc
 < 0) {

68 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatAddressLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatBrokerLoad.h

41 #iâdeà
FLAT_BROKER_LOAD_H


42 
	#FLAT_BROKER_LOAD_H


	)

44 
	~"FÏtFeLßd_commÚ.h
"

46 
Çme¥aû
 
	gTPCE


49 
şass
 
	gCFÏtBrok”Lßd
 : 
public
 
CFÏtFeLßd”
 <
BROKER_ROW
>

51 
public
:

52 
CFÏtBrok”Lßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
BROKER_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

57 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

59 
	grc
 = 
årštf
Ğ
hOutFe
, 
Brok”RowFmt
,

60 
Ãxt_»cÜd
->
B_ID
,

61 
Ãxt_»cÜd
->
B_ST_ID
,

62 
Ãxt_»cÜd
->
B_NAME
,

63 
Ãxt_»cÜd
->
B_NUM_TRADES
,

64 
Ãxt_»cÜd
->
B_COMM_TOTAL


67 ià(
	grc
 < 0) {

68 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatBrokerLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatCashTransactionLoad.h

40 #iâdeà
FLAT_CASH_TRANSACTION_LOAD_H


41 
	#FLAT_CASH_TRANSACTION_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtCashT¿n§ùiÚLßd
 : 
public
 
CFÏtFeLßd”
 <
CASH_TRANSACTION_ROW
>

50 
´iv©e
:

51 
CD©eTime
 
FÏt_CT_DTS
;

52 
	gpublic
:

53 
CFÏtCashT¿n§ùiÚLßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
CASH_TRANSACTION_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

58 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

60 
	gFÏt_CT_DTS
 = 
Ãxt_»cÜd
->
CT_DTS
;

61 
	grc
 = 
årštf
Ğ
hOutFe
, 
CashT¿n§ùiÚRowFmt
,

62 
Ãxt_»cÜd
->
CT_T_ID
,

63 
FÏt_CT_DTS
.
ToSŒ
(
FÏtFeD©eTimeFÜm©
),

64 
Ãxt_»cÜd
->
CT_AMT
,

65 
Ãxt_»cÜd
->
CT_NAME


68 ià(
	grc
 < 0) {

69 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatCashTransactionLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatChargeLoad.h

40 #iâdeà
FLAT_CHARGE_LOAD_H


41 
	#FLAT_CHARGE_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtCh¬geLßd
 : 
public
 
CFÏtFeLßd”
 <
CHARGE_ROW
>

50 
public
:

51 
CFÏtCh¬geLßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
CHARGE_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

56 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

58 
	grc
 = 
årštf
Ğ
hOutFe
, 
Ch¬geRowFmt
,

59 
Ãxt_»cÜd
->
CH_TT_ID
,

60 
Ãxt_»cÜd
->
CH_C_TIER
,

61 
Ãxt_»cÜd
->
CH_CHRG


63 ià(
	grc
 < 0) {

64 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatChargeLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatCommissionRateLoad.h

40 #iâdeà
FLAT_COMMISSION_RATE_LOAD_H


41 
	#FLAT_COMMISSION_RATE_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtCommissiÚR©eLßd
 : 
public
 
CFÏtFeLßd”
 <
COMMISSION_RATE_ROW
>

50 
public
:

51 
CFÏtCommissiÚR©eLßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
COMMISSION_RATE_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

56 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

58 
	grc
 = 
årštf
Ğ
hOutFe
, 
CommissiÚR©eRowFmt
,

59 
Ãxt_»cÜd
->
CR_C_TIER
,

60 
Ãxt_»cÜd
->
CR_TT_ID
,

61 
Ãxt_»cÜd
->
CR_EX_ID
,

62 
Ãxt_»cÜd
->
CR_FROM_QTY
,

63 
Ãxt_»cÜd
->
CR_TO_QTY
,

64 
Ãxt_»cÜd
->
CR_RATE


66 ià(
	grc
 < 0) {

67 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatCommissionRateLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatCompanyCompetitorLoad.h

40 #iâdeà
FLAT_COMPANY_COMPETITOR_LOAD_H


41 
	#FLAT_COMPANY_COMPETITOR_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtCom·nyCom³t™ÜLßd
 : 
public
 
CFÏtFeLßd”
 <
COMPANY_COMPETITOR_ROW
>

50 
public
:

51 
CFÏtCom·nyCom³t™ÜLßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
COMPANY_COMPETITOR_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

56 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

58 
	grc
 = 
årštf
Ğ
hOutFe
, 
Com·nyCom³t™ÜRowFmt
,

59 
Ãxt_»cÜd
->
CP_CO_ID
,

60 
Ãxt_»cÜd
->
CP_COMP_CO_ID
,

61 
Ãxt_»cÜd
->
CP_IN_ID


63 ià(
	grc
 < 0) {

64 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatCompanyCompetitorLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatCompanyLoad.h

40 #iâdeà
FLAT_COMPANY_LOAD_H


41 
	#FLAT_COMPANY_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtCom·nyLßd
 : 
public
 
CFÏtFeLßd”
 <
COMPANY_ROW
>

50 
´iv©e
:

51 
CD©eTime
 
FÏt_CO_OPEN_DATE
;

52 
	gpublic
:

53 
CFÏtCom·nyLßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
COMPANY_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

58 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

60 
	gFÏt_CO_OPEN_DATE
 = 
Ãxt_»cÜd
->
CO_OPEN_DATE
;

61 
	grc
 = 
årštf
Ğ
hOutFe
, 
Com·nyRowFmt
,

62 
Ãxt_»cÜd
->
CO_ID
,

63 
Ãxt_»cÜd
->
CO_ST_ID
,

64 
Ãxt_»cÜd
->
CO_NAME
,

65 
Ãxt_»cÜd
->
CO_IN_ID
,

66 
Ãxt_»cÜd
->
CO_SP_RATE
,

67 
Ãxt_»cÜd
->
CO_CEO
,

68 
Ãxt_»cÜd
->
CO_AD_ID
,

69 
Ãxt_»cÜd
->
CO_DESC
,

70 
FÏt_CO_OPEN_DATE
.
ToSŒ
(
FÏtFeD©eFÜm©
)

72 ià(
	grc
 < 0) {

73 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatCompanyLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatCustomerAccountLoad.h

40 #iâdeà
FLAT_CUSTOMER_ACCOUNT_LOAD_H


41 
	#FLAT_CUSTOMER_ACCOUNT_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtCu¡om”AccouÁLßd
 : 
public
 
CFÏtFeLßd”
 <
CUSTOMER_ACCOUNT_ROW
>

50 
public
:

51 
CFÏtCu¡om”AccouÁLßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
CUSTOMER_ACCOUNT_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

56 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

58 
	grc
 = 
årštf
Ğ
hOutFe
, 
Cu¡om”AccouÁRowFmt
,

59 
Ãxt_»cÜd
->
CA_ID
,

60 
Ãxt_»cÜd
->
CA_B_ID
,

61 
Ãxt_»cÜd
->
CA_C_ID
,

62 
Ãxt_»cÜd
->
CA_NAME
,

63 ()
Ãxt_»cÜd
->
CA_TAX_ST
,

64 
Ãxt_»cÜd
->
CA_BAL


66 ià(
	grc
 < 0) {

67 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatCustomerAccountLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatCustomerLoad.h

41 #iâdeà
FLAT_CUSTOMER_LOAD_H


42 
	#FLAT_CUSTOMER_LOAD_H


	)

44 
	~"FÏtFeLßd_commÚ.h
"

46 
Çme¥aû
 
	gTPCE


49 
şass
 
	gCFÏtCu¡om”Lßd
 : 
public
 
CFÏtFeLßd”
 <
CUSTOMER_ROW
>

51 
´iv©e
:

52 
CD©eTime
 
FÏt_C_DOB
;

53 
	gpublic
:

54 
CFÏtCu¡om”Lßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
CUSTOMER_ROW
>(szFeName, 
	gFÏtFeOuutMode
) {};

59 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

61 
	gFÏt_C_DOB
 = 
Ãxt_»cÜd
->
C_DOB
;

62 
	grc
 = 
årštf
Ğ
hOutFe
, 
Cu¡om”RowFmt
,

63 
Ãxt_»cÜd
->
C_ID
,

64 
Ãxt_»cÜd
->
C_TAX_ID
,

65 
Ãxt_»cÜd
->
C_ST_ID
,

66 
Ãxt_»cÜd
->
C_L_NAME
,

67 
Ãxt_»cÜd
->
C_F_NAME
,

68 
Ãxt_»cÜd
->
C_M_NAME
,

69 
Ãxt_»cÜd
->
C_GNDR
,

70 ()
Ãxt_»cÜd
->
C_TIER
,

71 
FÏt_C_DOB
.
ToSŒ
(
FÏtFeD©eFÜm©
),

72 
Ãxt_»cÜd
->
C_AD_ID
,

73 
Ãxt_»cÜd
->
C_CTRY_1
,

74 
Ãxt_»cÜd
->
C_AREA_1
,

75 
Ãxt_»cÜd
->
C_LOCAL_1
,

76 
Ãxt_»cÜd
->
C_EXT_1
,

77 
Ãxt_»cÜd
->
C_CTRY_2
,

78 
Ãxt_»cÜd
->
C_AREA_2
,

79 
Ãxt_»cÜd
->
C_LOCAL_2
,

80 
Ãxt_»cÜd
->
C_EXT_2
,

81 
Ãxt_»cÜd
->
C_CTRY_3
,

82 
Ãxt_»cÜd
->
C_AREA_3
,

83 
Ãxt_»cÜd
->
C_LOCAL_3
,

84 
Ãxt_»cÜd
->
C_EXT_3
,

85 
Ãxt_»cÜd
->
C_EMAIL_1
,

86 
Ãxt_»cÜd
->
C_EMAIL_2


88 ià(
	grc
 < 0) {

89 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatCustomerLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatCustomerTaxrateLoad.h

40 #iâdeà
FLAT_CUSTOMER_TAXRATE_LOAD_H


41 
	#FLAT_CUSTOMER_TAXRATE_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtCu¡om”Tax¿‹Lßd
 : 
public
 
CFÏtFeLßd”
 <
CUSTOMER_TAXRATE_ROW
>

50 
public
:

51 
CFÏtCu¡om”Tax¿‹Lßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
CUSTOMER_TAXRATE_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

56 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

58 
	grc
 = 
årštf
Ğ
hOutFe
, 
Cu¡om”Tax¿‹RowFmt
,

59 
Ãxt_»cÜd
->
CX_TX_ID
,

60 
Ãxt_»cÜd
->
CX_C_ID


62 ià(
	grc
 < 0) {

63 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatCustomerTaxrateLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatDailyMarketLoad.h

40 #iâdeà
FLAT_DAILY_MARKET_LOAD_H


41 
	#FLAT_DAILY_MARKET_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtDayM¬k‘Lßd
 : 
public
 
CFÏtFeLßd”
 <
DAILY_MARKET_ROW
>

50 
´iv©e
:

51 
CD©eTime
 
FÏt_DM_DATE
;

52 
	gpublic
:

53 
CFÏtDayM¬k‘Lßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
DAILY_MARKET_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

58 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

60 
	gFÏt_DM_DATE
 = 
Ãxt_»cÜd
->
DM_DATE
;

61 
	grc
 = 
årštf
Ğ
hOutFe
, 
DayM¬k‘RowFmt
,

62 
FÏt_DM_DATE
.
ToSŒ
(
FÏtFeD©eFÜm©
),

63 
Ãxt_»cÜd
->
DM_S_SYMB
,

64 
Ãxt_»cÜd
->
DM_CLOSE
,

65 
Ãxt_»cÜd
->
DM_HIGH
,

66 
Ãxt_»cÜd
->
DM_LOW
,

67 
Ãxt_»cÜd
->
DM_VOL


70 ià(
	grc
 < 0) {

71 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatDailyMarketLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatExchangeLoad.h

40 #iâdeà
FLAT_EXCHANGE_LOAD_H


41 
	#FLAT_EXCHANGE_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtExchªgeLßd
 : 
public
 
CFÏtFeLßd”
 <
EXCHANGE_ROW
>

50 
public
:

51 
CFÏtExchªgeLßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
EXCHANGE_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

56 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

58 
	grc
 = 
årštf
Ğ
hOutFe
, 
ExchªgeRowFmt
,

59 
Ãxt_»cÜd
->
EX_ID
,

60 
Ãxt_»cÜd
->
EX_NAME
,

61 
Ãxt_»cÜd
->
EX_NUM_SYMB
,

62 
Ãxt_»cÜd
->
EX_OPEN
,

63 
Ãxt_»cÜd
->
EX_CLOSE
,

64 
Ãxt_»cÜd
->
EX_DESC
,

65 
Ãxt_»cÜd
->
EX_AD_ID


68 ià(
	grc
 < 0) {

69 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatExchangeLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatFile.h

40 #iâdeà
FLAT_FILE_H


41 
	#FLAT_FILE_H


	)

43 
	~"EG’Ut™›s_¡dafx.h
"

45 
Çme¥aû
 
	gTPCE


48 
	g‹m¶©e
 <
ty³Çme
 
	gT
,y³Çm
	gTKeyAndEËm’tsLim™s
> cÏs 
	cCFÏtFe


50 
	g´Ùeùed
:

52 
CFixedA¼ay
<
	tT
, 
	tTKeyAndEËm’tsLim™s
> 
	tCFeInMemÜyLi¡
;

54 
CFeInMemÜyLi¡
 
	gm_li¡
;

56 
R—dLi¡
(cÚ¡ *
szLi¡Fe
)

58 
if¡»am
 
	gtmpFe
;

60 ià(
	gszLi¡Fe
)

62 
	gtmpFe
.
İ’
(
szLi¡Fe
, 
ios_ba£
::
š
);

63 ià(
	gtmpFe
)

65 
R—dLi¡
(
tmpFe
);

66 
	gtmpFe
.
şo£
();

70 
	gtmpFe
.
şo£
();

71 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eC»©eFe
, "CFlatFile::ReadList");

76 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eC»©eFe
, "CFlatFile::ReadList");

80 
R—dLi¡
(cÚ¡ 
¡ršg
 &
¡r
)

82 
i¡ršg¡»am
 
tmpFe
(
¡r
);

83 
R—dLi¡
(
tmpFe
);

86 
R—dLi¡
(
i¡»am
 &
tmpFe
)

88 
T
 
	grow
;

89 
mem£t
(&
row
, 0, (row));

91 
	gtmpFe
.
good
())

93 
	grow
.
Lßd
(
tmpFe
);

96 ifĞ! 
	gtmpFe
.
eof
() )

98 
	gm_li¡
.
Add
(&
row
);

105 
	gpublic
:

108 
CFÏtFe
(cÚ¡ *
szLi¡Fe
)

110 
R—dLi¡
(
szLi¡Fe
);

113 
CFÏtFe
(cÚ¡ 
¡ršg
 &
¡r
)

115 
R—dLi¡
(
¡r
);

117 
	gvœtu®
 ~
CFÏtFe
() {}

120 
T
* 
G‘RecÜd
(
šdex
è{  &
	gm_li¡
[index]; };

123 
UINT
 
G‘Size
(è{ (
	gUINT
)
	gm_li¡
.
size
();}

	@include/workload/tpce/egen/FlatFileLoad_common.h

37 #iâdeà
FLAT_FILE_LOAD_COMMON_H


38 
	#FLAT_FILE_LOAD_COMMON_H


	)

40 
	#WIN32_LEAN_AND_MEAN


41 

	)

42 
	~<io¡»am
>

43 
	~<f¡»am
>

44 
	~<c¡dio
>

46 
	~"FÏtFeLßd”.h
"

47 
	~"TabË_Defs.h
"

48 
	~"D©eTime.h
"

49 
	~"”rÜ.h
"

	@include/workload/tpce/egen/FlatFileLoad_stdafx.h

37 #iâdeà
FLAT_FILE_LOAD_STDAFX_H


38 
	#FLAT_FILE_LOAD_STDAFX_H


	)

40 
	#WIN32_LEAN_AND_MEAN


41 

	)

42 
	~<io¡»am
>

43 
	~<f¡»am
>

44 
	~<c¡dio
>

46 
	~"EG’Ut™›s_¡dafx.h
"

47 
	~"TabË_Defs.h
"

48 
	~"EG’Ba£Lßd”_¡dafx.h
"

49 
	~"FÏtFeLßd”.h
"

50 
	~"FÏtAccouÁP”missiÚLßd.h
"

51 
	~"FÏtAdd»ssLßd.h
"

52 
	~"FÏtBrok”Lßd.h
"

53 
	~"FÏtCashT¿n§ùiÚLßd.h
"

54 
	~"FÏtCh¬geLßd.h
"

55 
	~"FÏtCommissiÚR©eLßd.h
"

56 
	~"FÏtCom·nyLßd.h
"

57 
	~"FÏtCom·nyCom³t™ÜLßd.h
"

58 
	~"FÏtCu¡om”Lßd.h
"

59 
	~"FÏtCu¡om”AccouÁLßd.h
"

60 
	~"FÏtCu¡om”Tax¿‹Lßd.h
"

61 
	~"FÏtDayM¬k‘Lßd.h
"

62 
	~"FÏtExchªgeLßd.h
"

63 
	~"FÏtFšªcŸlLßd.h
"

64 
	~"FÏtHŞdšgLßd.h
"

65 
	~"FÏtHŞdšgHi¡ÜyLßd.h
"

66 
	~"FÏtHŞdšgSumm¬yLßd.h
"

67 
	~"FÏtIndu¡ryLßd.h
"

68 
	~"FÏtLa¡T¿deLßd.h
"

69 
	~"FÏtNewsI‹mLßd.h
"

70 
	~"FÏtNewsXRefLßd.h
"

71 
	~"FÏtSeùÜLßd.h
"

72 
	~"FÏtSecur™yLßd.h
"

73 
	~"FÏtS‘em’tLßd.h
"

74 
	~"FÏtStusTy³Lßd.h
"

75 
	~"FÏtTax¿‹Lßd.h
"

76 
	~"FÏtT¿deLßd.h
"

77 
	~"FÏtT¿deHi¡ÜyLßd.h
"

78 
	~"FÏtT¿deReque¡Lßd.h
"

79 
	~"FÏtT¿deTy³Lßd.h
"

80 
	~"FÏtW©chI‹mLßd.h
"

81 
	~"FÏtW©chLi¡Lßd.h
"

82 
	~"FÏtZCodeLßd.h
"

83 
	~"FÏtLßd”FaùÜy.h
"

	@include/workload/tpce/egen/FlatFileLoader.h

40 #iâdeà
FLAT_FILE_LOADER_H


41 
	#FLAT_FILE_LOADER_H


	)

43 
	~<c¡dio
>

44 
	~"Ba£Lßd”.h
"

45 
	~"unu£dæag.h
"

47 
usšg
 
Çme¥aû
 
	g¡d
;

49 
Çme¥aû
 
	gTPCE


53 #iâdeà
DATETIME_FORMAT


54 
	#DATETIME_FORMAT
 12

56 

	)

57 #iâdeà
TIME_FORMAT


58 
	#TIME_FORMAT
 01

60 

	)

61 #iâdeà
DATE_FORMAT


62 
	#DATE_FORMAT
 10

64 

	)

65 #iâdeà
BOOLEAN_TRUE


66 
	#BOOLEAN_TRUE
 "1"

	)

69 #iâdeà
BOOLEAN_FALSE


70 
	#BOOLEAN_FALSE
 "0"

	)

73 #iâdeà
BUFFER_SIZE


74 
	#BUFFER_SIZE
 0

	)

78 cÚ¡ 
	gFÏtFeD©eTimeFÜm©
 = 
DATETIME_FORMAT
;

79 cÚ¡ 
	gFÏtFeTimeFÜm©
 = 
TIME_FORMAT
;

80 cÚ¡ 
	gFÏtFeD©eFÜm©
 = 
DATE_FORMAT
;

81 cÚ¡ * cÚ¡ 
	gFÏtFeBoŞTrue
 = 
BOOLEAN_TRUE
;

82 cÚ¡ * cÚ¡ 
	gFÏtFeBoŞF®£
 = 
BOOLEAN_FALSE
;

85 cÚ¡ 
	gFÏtFeBufãrSize
 = 
BUFFER_SIZE
;

88 
	eFÏtFeOuutModes
 {

89 
	gFLAT_FILE_OUTPUT_APPEND
 = 0,

90 
	gFLAT_FILE_OUTPUT_OVERWRITE


96 
	g‹m¶©e
 <
ty³Çme
 
	gT
> 
şass
 
	gCFÏtFeLßd”
 : 
public
 
CBa£Lßd”
<
T
>

98 
´Ùeùed
:

99 
FILE
 *
hOutFe
;

101 
	gpublic
:

103 
CFÏtFeLßd”
(*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
);

104 ~
CFÏtFeLßd”
();

106 
vœtu®
 
Wr™eNextRecÜd
(cÚ¡ 
T
* 
Ãxt_»cÜd
 
UNUSED
) = 0;

107 
FšishLßd
();

114 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

115 
	gCFÏtFeLßd”
<
	gT
>::
CFÏtFeLßd”
(*
szFeName
, 
FÏtFeOuutModes
 
æ©FeOuutMode
)

117 ifĞ
	gFLAT_FILE_OUTPUT_APPEND
 =ğ
æ©FeOuutMode
 )

119 
hOutFe
 = 
fİ’
Ğ
szFeName
, "a" );

121 ifĞ
	gFLAT_FILE_OUTPUT_OVERWRITE
 =ğ
æ©FeOuutMode
 )

123 
hOutFe
 = 
fİ’
Ğ
szFeName
, "w" );

126 ià(!
	ghOutFe
)

128 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eC»©eFe
, "CFlatFileLoader<T>::CFlatFileLoader");

131 ià(
	gFÏtFeBufãrSize
 > 0)

133 ià(
£tvbuf
(
hOutFe
, 
NULL
, 
_IOFBF
, 
FÏtFeBufãrSize
))

135 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eC»©eFe
, "CFlatFileLoader<T>::CFlatFileLoader");

143 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

144 
	gCFÏtFeLßd”
<
	gT
>::~
CFÏtFeLßd”
()

146 
fşo£
(
hOutFe
);

153 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

154 
	gCFÏtFeLßd”
<
	gT
>::
FšishLßd
()

156 
fæush
(
hOutFe
);

	@include/workload/tpce/egen/FlatFinancialLoad.h

40 #iâdeà
FLAT_FINANCIAL_LOAD_H


41 
	#FLAT_FINANCIAL_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtFšªcŸlLßd
 : 
public
 
CFÏtFeLßd”
 <
FINANCIAL_ROW
>

50 
´iv©e
:

51 
CD©eTime
 
FÏt_FI_QTR_START_DATE
;

52 
	gpublic
:

53 
CFÏtFšªcŸlLßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
FINANCIAL_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

58 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

60 
	gFÏt_FI_QTR_START_DATE
 = 
Ãxt_»cÜd
->
FI_QTR_START_DATE
;

61 
	grc
 = 
årštf
Ğ
hOutFe
, 
FšªcŸlRowFmt
,

62 
Ãxt_»cÜd
->
FI_CO_ID
,

63 
Ãxt_»cÜd
->
FI_YEAR
,

64 
Ãxt_»cÜd
->
FI_QTR
,

65 
FÏt_FI_QTR_START_DATE
.
ToSŒ
(
FÏtFeD©eFÜm©
),

66 
Ãxt_»cÜd
->
FI_REVENUE
,

67 
Ãxt_»cÜd
->
FI_NET_EARN
,

68 
Ãxt_»cÜd
->
FI_BASIC_EPS
,

69 
Ãxt_»cÜd
->
FI_DILUT_EPS
,

70 
Ãxt_»cÜd
->
FI_MARGIN
,

71 
Ãxt_»cÜd
->
FI_INVENTORY
,

72 
Ãxt_»cÜd
->
FI_ASSETS
,

73 
Ãxt_»cÜd
->
FI_LIABILITY
,

74 
Ãxt_»cÜd
->
FI_OUT_BASIC
,

75 
Ãxt_»cÜd
->
FI_OUT_DILUT


77 ià(
	grc
 < 0) {

78 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatFinancialLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatHoldingHistoryLoad.h

40 #iâdeà
FLAT_HOLDING_HISTORY_LOAD_H


41 
	#FLAT_HOLDING_HISTORY_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtHŞdšgHi¡ÜyLßd
 : 
public
 
CFÏtFeLßd”
 <
HOLDING_HISTORY_ROW
>

50 
public
:

51 
CFÏtHŞdšgHi¡ÜyLßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
HOLDING_HISTORY_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

56 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

58 
	grc
 = 
årštf
Ğ
hOutFe
, 
HŞdšgHi¡ÜyRowFmt
,

59 
Ãxt_»cÜd
->
HH_H_T_ID
,

60 
Ãxt_»cÜd
->
HH_T_ID
,

61 
Ãxt_»cÜd
->
HH_BEFORE_QTY
,

62 
Ãxt_»cÜd
->
HH_AFTER_QTY


64 ià(
	grc
 < 0) {

65 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatHoldingHistoryLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatHoldingLoad.h

40 #iâdeà
FLAT_HOLDING_LOAD_H


41 
	#FLAT_HOLDING_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtHŞdšgLßd
 : 
public
 
CFÏtFeLßd”
 <
HOLDING_ROW
>

50 
´iv©e
:

51 
CD©eTime
 
FÏt_H_DTS
;

52 
	gpublic
:

53 
CFÏtHŞdšgLßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
HOLDING_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

58 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

60 
	gFÏt_H_DTS
 = 
Ãxt_»cÜd
->
H_DTS
;

61 
	grc
 = 
årštf
Ğ
hOutFe
, 
HŞdšgRowFmt
,

62 
Ãxt_»cÜd
->
H_T_ID
,

63 
Ãxt_»cÜd
->
H_CA_ID
,

64 
Ãxt_»cÜd
->
H_S_SYMB
,

65 
FÏt_H_DTS
.
ToSŒ
(
FÏtFeD©eTimeFÜm©
),

66 
Ãxt_»cÜd
->
H_PRICE
,

67 
Ãxt_»cÜd
->
H_QTY


69 ià(
	grc
 < 0) {

70 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatHoldingLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatHoldingSummaryLoad.h

40 #iâdeà
FLAT_HOLDING_SUMMARY_LOAD_H


41 
	#FLAT_HOLDING_SUMMARY_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtHŞdšgSumm¬yLßd
 : 
public
 
CFÏtFeLßd”
 <
HOLDING_SUMMARY_ROW
>

50 
public
:

51 
CFÏtHŞdšgSumm¬yLßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
HOLDING_SUMMARY_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

56 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

58 
	grc
 = 
årštf
Ğ
hOutFe
, 
HŞdšgSumm¬yRowFmt
,

59 
Ãxt_»cÜd
->
HS_CA_ID
,

60 
Ãxt_»cÜd
->
HS_S_SYMB
,

61 
Ãxt_»cÜd
->
HS_QTY


63 ià(
	grc
 < 0) {

64 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatHoldingSummaryLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatIndustryLoad.h

40 #iâdeà
FLAT_INDUSTRY_LOAD_H


41 
	#FLAT_INDUSTRY_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtIndu¡ryLßd
 : 
public
 
CFÏtFeLßd”
 <
INDUSTRY_ROW
>

50 
public
:

51 
CFÏtIndu¡ryLßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
INDUSTRY_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

56 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

58 
	grc
 = 
årštf
Ğ
hOutFe
, 
Indu¡ryRowFmt
,

59 
Ãxt_»cÜd
->
IN_ID
,

60 
Ãxt_»cÜd
->
IN_NAME
,

61 
Ãxt_»cÜd
->
IN_SC_ID


63 ià(
	grc
 < 0) {

64 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatIndustryLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatLastTradeLoad.h

40 #iâdeà
FLAT_LAST_TRADE_LOAD_H


41 
	#FLAT_LAST_TRADE_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtLa¡T¿deLßd
 : 
public
 
CFÏtFeLßd”
 <
LAST_TRADE_ROW
>

50 
´iv©e
:

51 
CD©eTime
 
FÏt_LT_DTS
;

52 
	gpublic
:

53 
CFÏtLa¡T¿deLßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
LAST_TRADE_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

58 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

60 
	gFÏt_LT_DTS
 = 
Ãxt_»cÜd
->
LT_DTS
;

61 
	grc
 = 
årštf
Ğ
hOutFe
, 
La¡T¿deRowFmt
,

62 
Ãxt_»cÜd
->
LT_S_SYMB
,

63 
FÏt_LT_DTS
.
ToSŒ
(
FÏtFeD©eTimeFÜm©
),

64 
Ãxt_»cÜd
->
LT_PRICE
,

65 
Ãxt_»cÜd
->
LT_OPEN_PRICE
,

66 
Ãxt_»cÜd
->
LT_VOL


68 ià(
	grc
 < 0) {

69 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatLastTradeLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatLoaderFactory.h

41 #iâdeà
FLAT_LOADER_FACTORY_H


42 
	#FLAT_LOADER_FACTORY_H


	)

44 
	~"FÏtFeLßd_¡dafx.h
"

46 
Çme¥aû
 
	gTPCE


49 şas 
	cCFÏtLßd”FaùÜy
 : 
public
 
CBa£Lßd”FaùÜy


51 
m_szOutDœ
[
iMaxP©h
];

52 
	gm_szFuÎFeName
[
iMaxP©h
];

53 
FÏtFeOuutModes
 
	gm_eOuutMode
;

55 
S‘FeName
(cÚ¡ * 
szFeName
)

57 
¢´štf
(
m_szFuÎFeName
, (m_szFuÎFeName), "%s%s", 
m_szOutDœ
, 
szFeName
);

60 
	gpublic
:

62 
CFÏtLßd”FaùÜy
(*
szOutDœ
, 
FÏtFeOuutModes
 
eOuutMode
)

63 : 
m_eOuutMode
(
eOuutMode
)

65 
as£¹
(
szOutDœ
);

67 
¡ºıy
(
m_szOutDœ
, 
szOutDœ
, (m_szOutDir));

72 
vœtu®
 
	gCBa£Lßd”
<
	gACCOUNT_PERMISSION_ROW
>* 
C»©eAccouÁP”missiÚLßd”
()

74 
S‘FeName
("AccountPermission.txt");

76  
Ãw
 
CFÏtAccouÁP”missiÚLßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

78 
vœtu®
 
	gCBa£Lßd”
<
	gADDRESS_ROW
>* 
C»©eAdd»ssLßd”
()

80 
S‘FeName
("Address.txt");

82  
Ãw
 
CFÏtAdd»ssLßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

84 
vœtu®
 
	gCBa£Lßd”
<
	gBROKER_ROW
>* 
C»©eBrok”Lßd”
()

86 
S‘FeName
("Broker.txt");

88  
Ãw
 
CFÏtBrok”Lßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

90 
vœtu®
 
	gCBa£Lßd”
<
	gCASH_TRANSACTION_ROW
>* 
C»©eCashT¿n§ùiÚLßd”
()

92 
S‘FeName
("CashTransaction.txt");

94  
Ãw
 
CFÏtCashT¿n§ùiÚLßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

96 
vœtu®
 
	gCBa£Lßd”
<
	gCHARGE_ROW
>* 
C»©eCh¬geLßd”
()

98 
S‘FeName
("Charge.txt");

100  
Ãw
 
CFÏtCh¬geLßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

103 
vœtu®
 
	gCBa£Lßd”
<
	gCOMMISSION_RATE_ROW
>* 
C»©eCommissiÚR©eLßd”
()

105 
S‘FeName
("CommissionRate.txt");

107  
Ãw
 
CFÏtCommissiÚR©eLßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

110 
vœtu®
 
	gCBa£Lßd”
<
	gCOMPANY_COMPETITOR_ROW
>* 
C»©eCom·nyCom³t™ÜLßd”
()

112 
S‘FeName
("CompanyCompetitor.txt");

114  
Ãw
 
CFÏtCom·nyCom³t™ÜLßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

117 
vœtu®
 
	gCBa£Lßd”
<
	gCOMPANY_ROW
>* 
C»©eCom·nyLßd”
()

119 
S‘FeName
("Company.txt");

121  
Ãw
 
CFÏtCom·nyLßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

124 
vœtu®
 
	gCBa£Lßd”
<
	gCUSTOMER_ACCOUNT_ROW
>* 
C»©eCu¡om”AccouÁLßd”
()

126 
S‘FeName
("CustomerAccount.txt");

128  
Ãw
 
CFÏtCu¡om”AccouÁLßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

131 
vœtu®
 
	gCBa£Lßd”
<
	gCUSTOMER_ROW
>* 
C»©eCu¡om”Lßd”
()

133 
S‘FeName
("Customer.txt");

135  
Ãw
 
CFÏtCu¡om”Lßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

137 
vœtu®
 
	gCBa£Lßd”
<
	gCUSTOMER_TAXRATE_ROW
>* 
C»©eCu¡om”Tax¿‹Lßd”
()

139 
S‘FeName
("CustomerTaxrate.txt");

141  
Ãw
 
CFÏtCu¡om”Tax¿‹Lßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

143 
vœtu®
 
	gCBa£Lßd”
<
	gDAILY_MARKET_ROW
>* 
C»©eDayM¬k‘Lßd”
()

145 
S‘FeName
("DailyMarket.txt");

147  
Ãw
 
CFÏtDayM¬k‘Lßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

149 
vœtu®
 
	gCBa£Lßd”
<
	gEXCHANGE_ROW
>* 
C»©eExchªgeLßd”
()

151 
S‘FeName
("Exchange.txt");

153  
Ãw
 
CFÏtExchªgeLßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

155 
vœtu®
 
	gCBa£Lßd”
<
	gFINANCIAL_ROW
>* 
C»©eFšªcŸlLßd”
()

157 
S‘FeName
("Financial.txt");

159  
Ãw
 
CFÏtFšªcŸlLßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

161 
vœtu®
 
	gCBa£Lßd”
<
	gHOLDING_ROW
>* 
C»©eHŞdšgLßd”
()

163 
S‘FeName
("Holding.txt");

165  
Ãw
 
CFÏtHŞdšgLßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

167 
vœtu®
 
	gCBa£Lßd”
<
	gHOLDING_HISTORY_ROW
>* 
C»©eHŞdšgHi¡ÜyLßd”
()

169 
S‘FeName
("HoldingHistory.txt");

171  
Ãw
 
CFÏtHŞdšgHi¡ÜyLßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

173 
vœtu®
 
	gCBa£Lßd”
<
	gHOLDING_SUMMARY_ROW
>* 
C»©eHŞdšgSumm¬yLßd”
()

175 
S‘FeName
("HoldingSummary.txt");

177  
Ãw
 
CFÏtHŞdšgSumm¬yLßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

179 
vœtu®
 
	gCBa£Lßd”
<
	gINDUSTRY_ROW
>* 
C»©eIndu¡ryLßd”
()

181 
S‘FeName
("Industry.txt");

183  
Ãw
 
CFÏtIndu¡ryLßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

185 
vœtu®
 
	gCBa£Lßd”
<
	gLAST_TRADE_ROW
>* 
C»©eLa¡T¿deLßd”
()

187 
S‘FeName
("LastTrade.txt");

189  
Ãw
 
CFÏtLa¡T¿deLßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

191 
vœtu®
 
	gCBa£Lßd”
<
	gNEWS_ITEM_ROW
>* 
C»©eNewsI‹mLßd”
()

193 
S‘FeName
("NewsItem.txt");

195  
Ãw
 
CFÏtNewsI‹mLßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

197 
vœtu®
 
	gCBa£Lßd”
<
	gNEWS_XREF_ROW
>* 
C»©eNewsXRefLßd”
()

199 
S‘FeName
("NewsXRef.txt");

201  
Ãw
 
CFÏtNewsXRefLßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

203 
vœtu®
 
	gCBa£Lßd”
<
	gSECTOR_ROW
>* 
C»©eSeùÜLßd”
()

205 
S‘FeName
("Sector.txt");

207  
Ãw
 
CFÏtSeùÜLßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

209 
vœtu®
 
	gCBa£Lßd”
<
	gSECURITY_ROW
>* 
C»©eSecur™yLßd”
()

211 
S‘FeName
("Security.txt");

213  
Ãw
 
CFÏtSecur™yLßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

215 
vœtu®
 
	gCBa£Lßd”
<
	gSETTLEMENT_ROW
>* 
C»©eS‘em’tLßd”
()

217 
S‘FeName
("Settlement.txt");

219  
Ãw
 
CFÏtS‘em’tLßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

221 
vœtu®
 
	gCBa£Lßd”
<
	gSTATUS_TYPE_ROW
>* 
C»©eStusTy³Lßd”
()

223 
S‘FeName
("StatusType.txt");

225  
Ãw
 
CFÏtStusTy³Lßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

227 
vœtu®
 
	gCBa£Lßd”
<
	gTAXRATE_ROW
>* 
C»©eTax¿‹Lßd”
()

229 
S‘FeName
("Taxrate.txt");

231  
Ãw
 
CFÏtTax¿‹Lßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

233 
vœtu®
 
	gCBa£Lßd”
<
	gTRADE_HISTORY_ROW
>* 
C»©eT¿deHi¡ÜyLßd”
()

235 
S‘FeName
("TradeHistory.txt");

237  
Ãw
 
CFÏtT¿deHi¡ÜyLßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

239 
vœtu®
 
	gCBa£Lßd”
<
	gTRADE_ROW
>* 
C»©eT¿deLßd”
()

241 
S‘FeName
("Trade.txt");

243  
Ãw
 
CFÏtT¿deLßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

245 
vœtu®
 
	gCBa£Lßd”
<
	gTRADE_REQUEST_ROW
>* 
C»©eT¿deReque¡Lßd”
()

247 
S‘FeName
("TradeRequest.txt");

249  
Ãw
 
CFÏtT¿deReque¡Lßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

251 
vœtu®
 
	gCBa£Lßd”
<
	gTRADE_TYPE_ROW
>* 
C»©eT¿deTy³Lßd”
()

253 
S‘FeName
("TradeType.txt");

255  
Ãw
 
CFÏtT¿deTy³Lßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

257 
vœtu®
 
	gCBa£Lßd”
<
	gWATCH_ITEM_ROW
>* 
C»©eW©chI‹mLßd”
()

259 
S‘FeName
("WatchItem.txt");

261  
Ãw
 
CFÏtW©chI‹mLßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

264 
vœtu®
 
	gCBa£Lßd”
<
	gWATCH_LIST_ROW
>* 
C»©eW©chLi¡Lßd”
()

266 
S‘FeName
("WatchList.txt");

268  
Ãw
 
CFÏtW©chLi¡Lßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

271 
vœtu®
 
	gCBa£Lßd”
<
	gZIP_CODE_ROW
>* 
C»©eZCodeLßd”
()

273 
S‘FeName
("ZipCode.txt");

275  
Ãw
 
CFÏtZCodeLßd
(
m_szFuÎFeName
, 
m_eOuutMode
);

	@include/workload/tpce/egen/FlatNewsItemLoad.h

40 #iâdeà
FLAT_NEWS_ITEM_LOAD_H


41 
	#FLAT_NEWS_ITEM_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtNewsI‹mLßd
 : 
public
 
CFÏtFeLßd”
 <
NEWS_ITEM_ROW
>

50 
´iv©e
:

51 
CD©eTime
 
FÏt_NI_DTS
;

52 
	gpublic
:

53 
CFÏtNewsI‹mLßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
NEWS_ITEM_ROW
>(szFeName, 
	gFÏtFeOuutMode
) {};

58 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

60 
	gFÏt_NI_DTS
 = 
Ãxt_»cÜd
->
NI_DTS
;

61 
	grc
 = 
årštf
Ğ
hOutFe
, 
NewsI‹mRowFmt
,

62 
Ãxt_»cÜd
->
NI_ID
,

63 
Ãxt_»cÜd
->
NI_HEADLINE
,

64 
Ãxt_»cÜd
->
NI_SUMMARY
,

65 
Ãxt_»cÜd
->
NI_ITEM
,

66 
FÏt_NI_DTS
.
ToSŒ
(
FÏtFeD©eTimeFÜm©
),

67 
Ãxt_»cÜd
->
NI_SOURCE
,

68 
Ãxt_»cÜd
->
NI_AUTHOR


70 ià(
	grc
 < 0) {

71 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatNewsItemLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatNewsXRefLoad.h

40 #iâdeà
FLAT_NEWS_XREF_LOAD_H


41 
	#FLAT_NEWS_XREF_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtNewsXRefLßd
 : 
public
 
CFÏtFeLßd”
 <
NEWS_XREF_ROW
>

50 
public
:

51 
CFÏtNewsXRefLßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
NEWS_XREF_ROW
>(szFeName, 
	gFÏtFeOuutMode
) {};

56 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

58 
	grc
 = 
årštf
Ğ
hOutFe
, 
NewsXRefRowFmt
,

59 
Ãxt_»cÜd
->
NX_NI_ID
,

60 
Ãxt_»cÜd
->
NX_CO_ID


62 ià(
	grc
 < 0) {

63 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatNewsXRefLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatSectorLoad.h

40 #iâdeà
FLAT_SECTOR_LOAD_H


41 
	#FLAT_SECTOR_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtSeùÜLßd
 : 
public
 
CFÏtFeLßd”
 <
SECTOR_ROW
>

50 
public
:

51 
CFÏtSeùÜLßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
SECTOR_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

56 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

58 
	grc
 = 
årštf
Ğ
hOutFe
, 
SeùÜRowFmt
,

59 
Ãxt_»cÜd
->
SC_ID
,

60 
Ãxt_»cÜd
->
SC_NAME


62 ià(
	grc
 < 0) {

63 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatSectorLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatSecurityLoad.h

40 #iâdeà
FLAT_SECURITY_LOAD_H


41 
	#FLAT_SECURITY_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtSecur™yLßd
 : 
public
 
CFÏtFeLßd”
 <
SECURITY_ROW
>

50 
´iv©e
:

51 
CD©eTime
 
FÏt_S_START_DATE
;

52 
CD©eTime
 
	gFÏt_S_EXCH_DATE
;

53 
CD©eTime
 
	gFÏt_S_52WK_HIGH_DATE
;

54 
CD©eTime
 
	gFÏt_S_52WK_LOW_DATE
;

55 
	gpublic
:

56 
CFÏtSecur™yLßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
SECURITY_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

61 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

63 
	gFÏt_S_START_DATE
 = 
Ãxt_»cÜd
->
S_START_DATE
;

64 
	gFÏt_S_EXCH_DATE
 = 
Ãxt_»cÜd
->
S_EXCH_DATE
;

65 
	gFÏt_S_52WK_HIGH_DATE
 = 
Ãxt_»cÜd
->
S_52WK_HIGH_DATE
;

66 
	gFÏt_S_52WK_LOW_DATE
 = 
Ãxt_»cÜd
->
S_52WK_LOW_DATE
;

67 
	grc
 = 
årštf
Ğ
hOutFe
, 
Secur™yRowFmt
,

68 
Ãxt_»cÜd
->
S_SYMB
,

69 
Ãxt_»cÜd
->
S_ISSUE
,

70 
Ãxt_»cÜd
->
S_ST_ID
,

71 
Ãxt_»cÜd
->
S_NAME
,

72 
Ãxt_»cÜd
->
S_EX_ID
,

73 
Ãxt_»cÜd
->
S_CO_ID
,

74 
Ãxt_»cÜd
->
S_NUM_OUT
,

75 
FÏt_S_START_DATE
.
ToSŒ
(
FÏtFeD©eFÜm©
),

76 
FÏt_S_EXCH_DATE
.
ToSŒ
(
FÏtFeD©eFÜm©
),

77 
Ãxt_»cÜd
->
S_PE
,

78 
Ãxt_»cÜd
->
S_52WK_HIGH
,

79 
FÏt_S_52WK_HIGH_DATE
.
ToSŒ
(
FÏtFeD©eFÜm©
),

80 
Ãxt_»cÜd
->
S_52WK_LOW
,

81 
FÏt_S_52WK_LOW_DATE
.
ToSŒ
(
FÏtFeD©eFÜm©
),

82 
Ãxt_»cÜd
->
S_DIVIDEND
,

83 
Ãxt_»cÜd
->
S_YIELD


86 ià(
	grc
 < 0) {

87 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatSecurityLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatSettlementLoad.h

40 #iâdeà
FLAT_SETTLEMENT_LOAD_H


41 
	#FLAT_SETTLEMENT_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtS‘em’tLßd
 : 
public
 
CFÏtFeLßd”
 <
SETTLEMENT_ROW
>

50 
´iv©e
:

51 
CD©eTime
 
FÏt_SE_CASH_DUE_DATE
;

52 
	gpublic
:

53 
CFÏtS‘em’tLßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
SETTLEMENT_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

58 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

60 
	gFÏt_SE_CASH_DUE_DATE
 = 
Ãxt_»cÜd
->
SE_CASH_DUE_DATE
;

61 
	grc
 = 
årštf
Ğ
hOutFe
, 
S‘em’tRowFmt
,

62 
Ãxt_»cÜd
->
SE_T_ID
,

63 
Ãxt_»cÜd
->
SE_CASH_TYPE
,

64 
FÏt_SE_CASH_DUE_DATE
.
ToSŒ
(
FÏtFeD©eFÜm©
),

65 
Ãxt_»cÜd
->
SE_AMT


67 ià(
	grc
 < 0) {

68 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatSettlementLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatStatusTypeLoad.h

40 #iâdeà
FLAT_STATUS_TYPE_LOAD_H


41 
	#FLAT_STATUS_TYPE_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtStusTy³Lßd
 : 
public
 
CFÏtFeLßd”
 <
STATUS_TYPE_ROW
>

50 
public
:

51 
CFÏtStusTy³Lßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
STATUS_TYPE_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

56 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

58 
	grc
 = 
årštf
Ğ
hOutFe
, 
StusTy³RowFmt
,

59 
Ãxt_»cÜd
->
ST_ID
,

60 
Ãxt_»cÜd
->
ST_NAME


62 ià(
	grc
 < 0) {

63 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatStatusType::WriteNextRecord");

	@include/workload/tpce/egen/FlatTaxrateLoad.h

40 #iâdeà
FLAT_TAXRATE_LOAD_H


41 
	#FLAT_TAXRATE_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtTax¿‹Lßd
 : 
public
 
CFÏtFeLßd”
 <
TAXRATE_ROW
>

50 
public
:

51 
CFÏtTax¿‹Lßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
TAXRATE_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

56 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

58 
	grc
 = 
årštf
Ğ
hOutFe
, 
Tax¿‹RowFmt
,

59 
Ãxt_»cÜd
->
TX_ID
,

60 
Ãxt_»cÜd
->
TX_NAME
,

61 
Ãxt_»cÜd
->
TX_RATE


63 ià(
	grc
 < 0) {

64 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatTaxrateLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatTradeHistoryLoad.h

40 #iâdeà
FLAT_TRADE_HISTORY_H


41 
	#FLAT_TRADE_HISTORY_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtT¿deHi¡ÜyLßd
 : 
public
 
CFÏtFeLßd”
 <
TRADE_HISTORY_ROW
>

50 
´iv©e
:

51 
CD©eTime
 
FÏt_TH_DTS
;

52 
	gpublic
:

53 
CFÏtT¿deHi¡ÜyLßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
TRADE_HISTORY_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

58 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

60 
	gFÏt_TH_DTS
 = 
Ãxt_»cÜd
->
TH_DTS
;

61 
	grc
 = 
årštf
Ğ
hOutFe
, 
T¿deHi¡ÜyRowFmt
,

62 
Ãxt_»cÜd
->
TH_T_ID
,

63 
FÏt_TH_DTS
.
ToSŒ
(
FÏtFeD©eTimeFÜm©
),

64 
Ãxt_»cÜd
->
TH_ST_ID


66 ià(
	grc
 < 0) {

67 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatTradeHistory::WriteNextRecord");

	@include/workload/tpce/egen/FlatTradeLoad.h

40 #iâdeà
FLAT_TRADE_LOAD_H


41 
	#FLAT_TRADE_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtT¿deLßd
 : 
public
 
CFÏtFeLßd”
 <
TRADE_ROW
>

50 
´iv©e
:

51 
CD©eTime
 
FÏt_T_DTS
;

52 
	gpublic
:

53 
CFÏtT¿deLßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
TRADE_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

58 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

60 
	gFÏt_T_DTS
 = 
Ãxt_»cÜd
->
T_DTS
;

61 
	grc
 = 
årštf
Ğ
hOutFe
, 
T¿deRowFmt
,

62 
Ãxt_»cÜd
->
T_ID
,

63 
FÏt_T_DTS
.
ToSŒ
(
FÏtFeD©eTimeFÜm©
),

64 
Ãxt_»cÜd
->
T_ST_ID
,

65 
Ãxt_»cÜd
->
T_TT_ID
,

66 (
Ãxt_»cÜd
->
T_IS_CASH
 ? 
FÏtFeBoŞTrue
 : 
FÏtFeBoŞF®£
),

67 
Ãxt_»cÜd
->
T_S_SYMB
,

68 
Ãxt_»cÜd
->
T_QTY
,

69 
Ãxt_»cÜd
->
T_BID_PRICE
,

70 
Ãxt_»cÜd
->
T_CA_ID
,

71 
Ãxt_»cÜd
->
T_EXEC_NAME
,

72 
Ãxt_»cÜd
->
T_TRADE_PRICE
,

73 
Ãxt_»cÜd
->
T_CHRG
,

74 
Ãxt_»cÜd
->
T_COMM
,

75 
Ãxt_»cÜd
->
T_TAX
,

76 (
Ãxt_»cÜd
->
T_LIFO
 ? 
FÏtFeBoŞTrue
 : 
FÏtFeBoŞF®£
)

78 ià(
	grc
 < 0) {

79 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatTradeLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatTradeRequestLoad.h

40 #iâdeà
FLAT_TRADE_REQUEST_LOAD_H


41 
	#FLAT_TRADE_REQUEST_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtT¿deReque¡Lßd
 : 
public
 
CFÏtFeLßd”
 <
TRADE_REQUEST_ROW
>

50 
public
:

51 
CFÏtT¿deReque¡Lßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
TRADE_REQUEST_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

56 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

58 
	grc
 = 
årštf
Ğ
hOutFe
, 
T¿deReque¡RowFmt
,

59 
Ãxt_»cÜd
->
TR_T_ID
,

60 
Ãxt_»cÜd
->
TR_TT_ID
,

61 
Ãxt_»cÜd
->
TR_S_SYMB
,

62 
Ãxt_»cÜd
->
TR_QTY
,

63 
Ãxt_»cÜd
->
TR_BID_PRICE
,

64 
Ãxt_»cÜd
->
TR_B_ID


66 ià(
	grc
 < 0) {

67 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatTradeRequestLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatTradeTypeLoad.h

40 #iâdeà
FLAT_TRADE_TYPE_LOAD_H


41 
	#FLAT_TRADE_TYPE_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtT¿deTy³Lßd
 : 
public
 
CFÏtFeLßd”
 <
TRADE_TYPE_ROW
>

50 
public
:

51 
CFÏtT¿deTy³Lßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
TRADE_TYPE_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

56 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

58 
	grc
 = 
årštf
Ğ
hOutFe
, 
T¿deTy³RowFmt
,

59 
Ãxt_»cÜd
->
TT_ID
,

60 
Ãxt_»cÜd
->
TT_NAME
,

61 (
Ãxt_»cÜd
->
TT_IS_SELL
 ? 
FÏtFeBoŞTrue
 : 
FÏtFeBoŞF®£
),

62 (
Ãxt_»cÜd
->
TT_IS_MRKT
 ? 
FÏtFeBoŞTrue
 : 
FÏtFeBoŞF®£
)

64 ià(
	grc
 < 0) {

65 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatTradeTypeLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatWatchItemLoad.h

40 #iâdeà
FLAT_WATCH_ITEM_LOAD_H


41 
	#FLAT_WATCH_ITEM_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtW©chI‹mLßd
 : 
public
 
CFÏtFeLßd”
 <
WATCH_ITEM_ROW
>

50 
public
:

51 
CFÏtW©chI‹mLßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
WATCH_ITEM_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

56 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

58 
	grc
 = 
årštf
Ğ
hOutFe
, 
W©chI‹mRowFmt
,

59 
Ãxt_»cÜd
->
WI_WL_ID
,

60 
Ãxt_»cÜd
->
WI_S_SYMB


62 ià(
	grc
 < 0) {

63 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatWatchItemLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatWatchListLoad.h

40 #iâdeà
FLAT_WATCH_LIST_LOAD_H


41 
	#FLAT_WATCH_LIST_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtW©chLi¡Lßd
 : 
public
 
CFÏtFeLßd”
 <
WATCH_LIST_ROW
>

50 
public
:

51 
CFÏtW©chLi¡Lßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
WATCH_LIST_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

56 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

58 
	grc
 = 
årštf
Ğ
hOutFe
, 
W©chLi¡RowFmt
,

59 
Ãxt_»cÜd
->
WL_ID
,

60 
Ãxt_»cÜd
->
WL_C_ID


62 ià(
	grc
 < 0) {

63 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatWatchListLoad::WriteNextRecord");

	@include/workload/tpce/egen/FlatZipCodeLoad.h

40 #iâdeà
FLAT_ZIP_CODE_LOAD_H


41 
	#FLAT_ZIP_CODE_LOAD_H


	)

43 
	~"FÏtFeLßd_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCFÏtZCodeLßd
 : 
public
 
CFÏtFeLßd”
 <
ZIP_CODE_ROW
>

50 
public
:

51 
CFÏtZCodeLßd
Ğ*
szFeName
, 
FÏtFeOuutModes
 
FÏtFeOuutMode
 ) : 
CFÏtFeLßd”
<
ZIP_CODE_ROW
>(szFeName, 
	gFÏtFeOuutMode
){};

56 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
)

58 
	grc
 = 
årštf
Ğ
hOutFe
, 
ZCodeRowFmt
,

59 
Ãxt_»cÜd
->
ZC_CODE
,

60 
Ãxt_»cÜd
->
ZC_TOWN
,

61 
Ãxt_»cÜd
->
ZC_DIV


63 ià(
	grc
 < 0) {

64 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eWr™eFe
, "CFlatZipCodeLoad::WriteNextRecord");

	@include/workload/tpce/egen/HoldingsAndTradesTable.h

40 #iâdeà
HOLDINGS_AND_TRADES_TABLE_H


41 
	#HOLDINGS_AND_TRADES_TABLE_H


	)

43 
	~"EG’TabËs_commÚ.h
"

44 
	~"Cu¡om”AccouÁsAndP”missiÚsTabË.h
"

45 
	~"Secur™yPriûRªge.h
"

47 
Çme¥aû
 
	gTPCE


56 cÚ¡ 
	giMšSecur™›sP”AccouÁRªge
[3][10] =

60 cÚ¡ 
	giMaxSecur™›sP”AccouÁRªge
[3][10] =

64 cÚ¡ 
	giMaxSecur™›sP”AccouÁ
 = 18;

71 cÚ¡ 
	gcM¬k‘BuyLßdTh»shŞd
 = 30;

72 cÚ¡ 
	gcM¬k‘S–lLßdTh»shŞd
 = 
cM¬k‘BuyLßdTh»shŞd
 + 30;

73 cÚ¡ 
	gcLim™BuyLßdTh»shŞd
 = 
cM¬k‘S–lLßdTh»shŞd
 + 20;

74 cÚ¡ 
	gcLim™S–lLßdTh»shŞd
 = 
cLim™BuyLßdTh»shŞd
 + 10;

75 cÚ¡ 
	gcStİLossLßdTh»shŞd
 = 
cLim™S–lLßdTh»shŞd
 + 10;

77 cÚ¡ 
	giP”ûÁBuysOnM¬gš
 = 16;

80 cÚ¡ 
	gcNUM_TRADE_QTY_SIZES
 = 4;

81 cÚ¡ 
	gcTRADE_QTY_SIZES
[
cNUM_TRADE_QTY_SIZES
] = {100, 200, 400, 800};

85 cÚ¡ 
	giP”ûÁT¿deIsLIFO
 = 35;

88 cÚ¡ 
	giRNGSkOÃT¿de
 = 11;

90 şas 
	cCHŞdšgsAndT¿desTabË


92 
CRªdom
 
	gm_ºd
;

93 
CCu¡om”AccouÁsAndP”missiÚsTabË
 
	gm_Cu¡om”AccouÁTabË
;

95 
TId’t
 
	gm_iSecCouÁ
;

96 
UINT
 
	gm_iMaxSecur™›sP”CA
;

97 
TId’t
 
	gm_Secur™yIds
[
iMaxSecur™›sP”AccouÁ
];

98 
boŞ
 
	gm_bCacheEÇbËd
;

99 
TId’t
 
	gm_iCacheOff£tNS
;

100 
	gm_iCacheSizeNS
;

101 * 
	gm_CacheNS
;

102 
TId’t
 
	gm_iCacheOff£tSFFI
;

103 
	gm_iCacheSizeSFFI
;

104 
TId’t
* 
	gm_CacheSFFI
;

106 
	gpublic
:

108 
CHŞdšgsAndT¿desTabË
(
CIÅutFes
 
šputFes
,

109 
UINT
 
iLßdUn™Size
,

110 
TId’t
 
iCu¡om”CouÁ
,

111 
TId’t
 
iS¹FromCu¡om”
 = 
iDeçuÉS¹FromCu¡om”
,

112 
boŞ
 
bCacheEÇbËd
 = 
çl£


114 : 
m_ºd
(
RNGS“dTabËDeçuÉ
)

115 , 
m_Cu¡om”AccouÁTabË
(
šputFes
, 
iLßdUn™Size
, 
iCu¡om”CouÁ
, 
iS¹FromCu¡om”
, 
bCacheEÇbËd
)

116 , 
m_bCacheEÇbËd
(
bCacheEÇbËd
)

118 
	gm_iSecCouÁ
 = 
šputFes
.
Secur™›s
->
G‘CÚfigu»dSecur™yCouÁ
();

122 
	gm_iMaxSecur™›sP”CA
 = 
iMaxSecur™›sP”AccouÁ
;

124 ià(
	gm_bCacheEÇbËd
)

126 
	gm_iCacheSizeNS
 = 
iDeçuÉLßdUn™Size
 * 
iMaxAccouÁsP”Cu¡
;

127 
	gm_iCacheOff£tNS
 = 
m_Cu¡om”AccouÁTabË
.
G‘S¹šgCA_ID
(
iS¹FromCu¡om”
è+ (
iTId’tShiá
 * 
iMaxAccouÁsP”Cu¡
);

128 
	gm_CacheNS
 = 
Ãw
 [
m_iCacheSizeNS
];

129 
	gi
=0; i<
	gm_iCacheSizeNS
; i++)

131 
	gm_CacheNS
[
i
] = 0;

134 
	gm_iCacheSizeSFFI
 = 
iDeçuÉLßdUn™Size
 * 
iMaxAccouÁsP”Cu¡
 * 
iMaxSecur™›sP”AccouÁ
;

135 
	gm_iCacheOff£tSFFI
 = 
m_Cu¡om”AccouÁTabË
.
G‘S¹šgCA_ID
(
iS¹FromCu¡om”
è+ (
iTId’tShiá
 * 
iMaxAccouÁsP”Cu¡
);

136 
	gm_CacheSFFI
 = 
Ãw
 
TId’t
[
m_iCacheSizeSFFI
];

137 
	gi
=0; i<
	gm_iCacheSizeSFFI
; i++)

139 
	gm_CacheSFFI
[
i
] = -1;

145 ~
CHŞdšgsAndT¿desTabË
()

147 ià(
	gm_bCacheEÇbËd
)

149 
	gd–‘e
[] 
	gm_CacheNS
;

150 
	gd–‘e
[] 
	gm_CacheSFFI
;

158 
In™NextLßdUn™
(
INT64
 
T¿desToSk
, 
TId’t
 
iS¹šgAccouÁID
)

160 
	gm_ºd
.
S‘S“d
(
m_ºd
.
RndNthEËm’t
(
RNGS“dTabËDeçuÉ
,

162 (
RNGSEED
è
T¿desToSk
));

163 ià(
	gm_bCacheEÇbËd
)

165 
	gm_iCacheOff£tNS
 = 
iS¹šgAccouÁID
;

166 
	gi
=0; i<
	gm_iCacheSizeNS
; i++)

168 
	gm_CacheNS
[
i
] = 0;

171 
	gm_iCacheOff£tSFFI
 = 
iS¹šgAccouÁID
;

172 
	gi
=0; i<
	gm_iCacheSizeSFFI
; i++)

174 
	gm_CacheSFFI
[
i
] = -1;

178 
	gm_Cu¡om”AccouÁTabË
.
In™NextLßdUn™
();

184 
G‘Numb”OfSecur™›s
(
TId’t
 
iCA_ID
, 
eCu¡om”T›r
 
iT›r
, 
iAccouÁCouÁ
)

186 
	giNumb”OfSecur™›s
 = 0;

191 
TId’t
 
	gšdex
 = 
iCA_ID
 - 
m_iCacheOff£tNS
;

192 
boŞ
 
	gbCheckCache
 = (
šdex
 >ğ0 && index < 
m_iCacheSizeNS
);

193 ià(
	gm_bCacheEÇbËd
 && 
	gbCheckCache
)

195 
	giNumb”OfSecur™›s
 = 
m_CacheNS
[
šdex
];

198 ià(
	giNumb”OfSecur™›s
 == 0)

200 
RNGSEED
 
OldS“d
;

201 
	giMšRªge
, 
	giMaxRªge
;

203 
	giMšRªge
 = 
iMšSecur™›sP”AccouÁRªge
[
iT›r
 - 
eCu¡om”T›rOÃ
][
iAccouÁCouÁ
 - 1];

204 
	giMaxRªge
 = 
iMaxSecur™›sP”AccouÁRªge
[
iT›r
 - 
eCu¡om”T›rOÃ
][
iAccouÁCouÁ
 - 1];

206 
	gOldS“d
 = 
m_ºd
.
G‘S“d
();

207 
	gm_ºd
.
S‘S“d
Ğ
m_ºd
.
RndNthEËm’t
Ğ
RNGS“dBa£Numb”OfSecur™›s
, (
RNGSEED
è
iCA_ID
 ));

208 
	giNumb”OfSecur™›s
 = 
m_ºd
.
RndIÁRªge
(
iMšRªge
, 
iMaxRªge
);

209 
	gm_ºd
.
S‘S“d
Ğ
OldS“d
 );

211 ià(
	gm_bCacheEÇbËd
 && 
	gbCheckCache
)

213 
	gm_CacheNS
[
šdex
] = 
iNumb”OfSecur™›s
;

216  
	giNumb”OfSecur™›s
;

222 
RNGSEED
 
G‘S¹šgSecIDS“d
(
TId’t
 
iCA_ID
)

224 Ğ
	gm_ºd
.
RndNthEËm’t
Ğ
RNGS“dBa£S¹šgSecur™yID
, (
RNGSEED
è
iCA_ID
 * 
m_iMaxSecur™›sP”CA
 ));

238 
TId’t
 
G‘Secur™yFÏtFeIndex
(

239 
TId’t
 
iCu¡om”AccouÁ
,

240 
UINT
 
iSecur™yAccouÁIndex
)

242 
TId’t
 
	giSecur™yFÏtFeIndex
 = -1;

247 
TId’t
 
	gšdex
 = (
iCu¡om”AccouÁ
 - 
m_iCacheOff£tSFFI
è* 
iMaxSecur™›sP”AccouÁ
 + 
iSecur™yAccouÁIndex
 - 1;

248 
boŞ
 
	gbCheckCache
 = (
šdex
 >ğ0 && index < 
m_iCacheSizeSFFI
);

249 ià(
	gm_bCacheEÇbËd
 && 
	gbCheckCache
)

251 
	giSecur™yFÏtFeIndex
 = 
m_CacheSFFI
[
šdex
];

254 ià(
	giSecur™yFÏtFeIndex
 == -1)

256 
RNGSEED
 
OldS“d
;

257 
UINT
 
	giG’”©edIndexCouÁ
 = 0;

258 
UINT
 
	gi
;

260 
	gOldS“d
 = 
m_ºd
.
G‘S“d
();

261 
	gm_ºd
.
S‘S“d
Ğ
G‘S¹šgSecIDS“d
Ğ
iCu¡om”AccouÁ
 ));

263 
	giG’”©edIndexCouÁ
 = 0;

265 
	giG’”©edIndexCouÁ
 < 
	giSecur™yAccouÁIndex
)

267 
	giSecur™yFÏtFeIndex
 = 
m_ºd
.
RndIÁ64Rªge
(0, 
m_iSecCouÁ
-1);

269 
	gi
 = 0; i < 
	giG’”©edIndexCouÁ
; ++i)

271 ià(
	gm_Secur™yIds
[
i
] =ğ
iSecur™yFÏtFeIndex
)

278 
	gm_Secur™yIds
[
i
] = 
iSecur™yFÏtFeIndex
;

282 ià(
	gi
 =ğ
iG’”©edIndexCouÁ
)

284 ++
iG’”©edIndexCouÁ
;

288 
	gm_ºd
.
S‘S“d
Ğ
OldS“d
 );

290 ià(
	gm_bCacheEÇbËd
 && 
	gbCheckCache
)

292 
	gm_CacheSFFI
[
šdex
] = 
iSecur™yFÏtFeIndex
;

295  
	giSecur™yFÏtFeIndex
;

304 
G’”©eRªdomAccouÁSecur™y
(

305 
TId’t
 
iCu¡om”
,

306 
eCu¡om”T›r
 
iT›r
,

307 
TId’t
* 
piCu¡om”AccouÁ
,

308 
TId’t
* 
piSecur™yFÏtFeIndex
,

309 
UINT
* 
piSecur™yAccouÁIndex
)

311 
TId’t
 
	giCu¡om”AccouÁ
;

312 
	giAccouÁCouÁ
;

313 
	giTÙ®AccouÁSecur™›s
;

314 
UINT
 
	giSecur™yAccouÁIndex
;

315 
TId’t
 
	giSecur™yFÏtFeIndex
;

319 
	gm_Cu¡om”AccouÁTabË
.
G’”©eRªdomAccouÁId
Ğ
m_ºd
, 
iCu¡om”
, 
iT›r
,

320 &
iCu¡om”AccouÁ
, &
iAccouÁCouÁ
);

322 
	giTÙ®AccouÁSecur™›s
 = 
G‘Numb”OfSecur™›s
(
iCu¡om”AccouÁ
, 
iT›r
, 
iAccouÁCouÁ
);

326 
	giSecur™yAccouÁIndex
 = (
UINT
è
m_ºd
.
RndIÁRªge
(1, 
iTÙ®AccouÁSecur™›s
);

328 
	giSecur™yFÏtFeIndex
 = 
G‘Secur™yFÏtFeIndex
(
iCu¡om”AccouÁ
, 
iSecur™yAccouÁIndex
);

332 *
	gpiCu¡om”AccouÁ
 = 
iCu¡om”AccouÁ
;

333 *
	gpiSecur™yFÏtFeIndex
 = 
iSecur™yFÏtFeIndex
;

334 ià(
	gpiSecur™yAccouÁIndex
 !ğ
NULL
)

336 *
piSecur™yAccouÁIndex
 = 
iSecur™yAccouÁIndex
;

340 
boŞ
 
IsAbÜ‹dT¿de
(
TId’t
 
T¿deId
)

342 
boŞ
 
	gbResuÉ
 = 
çl£
;

343 ifĞ
	giAbÜ‹dT¿deModFaùÜ
 =ğ
T¿deId
 % 
iAbÜtT¿de
 )

345 
bResuÉ
 = 
Œue
;

347  
	gbResuÉ
;

	@include/workload/tpce/egen/IndustryTable.h

40 #iâdeà
INDUSTRY_TABLE_H


41 
	#INDUSTRY_TABLE_H


	)

43 
	~"EG’TabËs_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCIndu¡ryTabË
 : 
public
 
TabËTem¶©e
<
INDUSTRY_ROW
>

50 
if¡»am
 
InFe
;

52 
	gpublic
:

53 
CIndu¡ryTabË
Ğ*
szDœName
 )

54 : 
TabËTem¶©e
<
INDUSTRY_ROW
>()

56 
szFeName
[
iMaxP©h
];

58 
¡ºıy
(
szFeName
, 
szDœName
, (szFileName));

59 
¡ºÿt
(
szFeName
, "Indu¡ry.txt", (szFeNameè- 
¡¾’
(
szDœName
) - 1);

61 
	gInFe
.
İ’
Ğ
szFeName
 );

64 ~
CIndu¡ryTabË
( )

66 
	gInFe
.
şo£
();

72 
boŞ
 
G’”©eNextRecÜd
()

74 ifĞ
	gInFe
.
good
() )

76 
	gm_row
.
Lßd
(
InFe
);

79  ( 
	gInFe
.
eof
() );

	@include/workload/tpce/egen/InputFile.h

41 #iâdeà
INPUT_FILE_H


42 
	#INPUT_FILE_H


	)

44 
	~"EG’Ut™›s_¡dafx.h
"

46 
Çme¥aû
 
	gTPCE


49 
	g‹m¶©e
 <
ty³Çme
 
	gT
,y³Çm
	gTKeyAndEËm’tsLim™s
> cÏs 
	cCIÅutFe


52 
	gCFixedM­
<
	tT
, 
	tTKeyAndEËm’tsLim™s
> 
	tCFeInMemÜyLi¡
;

54 
CFeInMemÜyLi¡
 
	gm_li¡
;

56 
R—dLi¡
(cÚ¡ *
szLi¡Fe
)

58 
if¡»am
 
	gtmpFe
;

60 ià(
	gszLi¡Fe
)

62 
	gtmpFe
.
İ’
(
szLi¡Fe
, 
ios_ba£
::
š
);

63 ià(
	gtmpFe
)

65 
R—dLi¡
(
tmpFe
);

66 
	gtmpFe
.
şo£
();

70 
	gtmpFe
.
şo£
();

71 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eC»©eFe
, "CInputFile::ReadList");

76 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eC»©eFe
, "CInputFile::ReadList");

80 
R—dLi¡
(cÚ¡ 
¡ršg
 &
¡r
)

82 
i¡ršg¡»am
 
tmpFe
(
¡r
);

83 
R—dLi¡
(
tmpFe
);

86 
R—dLi¡
(
i¡»am
 &
tmpFe
) {

87 
T
 
	grow
;

88 
mem£t
(&
row
, 0, (row));

89 
	giTh»shŞd
 = 0, 
	giWeight
;

90 
	gtmpFe
.
good
())

92 
	gtmpFe
>>
	giWeight
;

95 ifĞ! 
	gtmpFe
.
eof
() )

97 
	grow
.
Lßd
(
tmpFe
);

98 
	giTh»shŞd
 +ğ
iWeight
;

99 
	gm_li¡
.
Add
(
iTh»shŞd
-1 , &
row
, 
iWeight
);

104 
	gpublic
:

111 
CIÅutFe
(cÚ¡ *
szLi¡Fe
)

113 
R—dLi¡
(
szLi¡Fe
);

116 
CIÅutFe
(cÚ¡ 
¡ršg
 &
¡r
)

118 
R—dLi¡
(
¡r
);

123 
T
* 
G‘RecÜd
(
key
è{  
	gm_li¡
.
G‘EËm’t
(key); }

126 
T
* 
G‘RecÜdByPassKey
Ğ
UINT
 
iEËm’tID
 )

128 Ğ
	gm_li¡
.
G‘EËm’tByPassKey
Ğ
iEËm’tID
 ));

132 
UINT
 
RecÜdCouÁ
( )

134  
	gm_li¡
.
EËm’tCouÁ
();

138 
G‘G»©e¡Key
(è{  
	gm_li¡
.
G‘Highe¡Key
(); }

	@include/workload/tpce/egen/InputFileNoWeight.h

41 #iâdeà
INPUT_FILE_NO_WEIGHT_H


42 
	#INPUT_FILE_NO_WEIGHT_H


	)

44 
	~"EG’Ut™›s_¡dafx.h
"

46 
Çme¥aû
 
	gTPCE


49 
	g‹m¶©e
 <
ty³Çme
 
	gT
> cÏs 
	cCIÅutFeNoWeight


51 
	gveùÜ
<
	tT
>* 
	tPVeùÜT
;

53 
	gveùÜ
<
	tPVeùÜT
> 
	tCFeInMemÜyLi¡
;

55 
CFeInMemÜyLi¡
 
	gm_li¡
;

57 
R—dLi¡
(cÚ¡ *
szLi¡Fe
)

59 
if¡»am
 
	gtmpFe
;

61 ià(
	gszLi¡Fe
)

63 
	gtmpFe
.
İ’
(
szLi¡Fe
, 
ios_ba£
::
š
);

64 ià(
	gtmpFe
)

66 
R—dLi¡
(
tmpFe
);

67 
	gtmpFe
.
şo£
();

71 
	gtmpFe
.
şo£
();

72 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eC»©eFe
, "CInputFileNoWeight::ReadList");

77 
throw
 
CSy¡emE¼
(CSy¡emE¼::
eC»©eFe
, "CInputFileNoWeight::ReadList");

81 
R—dLi¡
(cÚ¡ 
¡ršg
 &
¡r
)

83 
i¡ršg¡»am
 
tmpFe
(
¡r
);

84 
R—dLi¡
(
tmpFe
);

87 
R—dLi¡
(
i¡»am
 &
tmpFe
)

89 
T
 
	grow
;

90 
mem£t
(&
row
, 0, (row));

91 
	giIndex
;

92 
	giLa¡Index
 = -1;

94 
	gtmpFe
.
good
())

96 
	gtmpFe
>>
	giIndex
;

97 ifĞ! 
	gtmpFe
.
eof
() )

99 
	grow
.
Lßd
(
tmpFe
);

100 ià(
	giIndex
!=
iLa¡Index
)

102 
PVeùÜT
 
·¼ay_row
 = 
Ãw
 
veùÜ
<
T
>;

103 ià(
	g·¼ay_row
!=
NULL
)

104 
m_li¡
.
push_back
(
·¼ay_row
);

106 
throw
 
CMemÜyE¼
("CInputFileNoWeight::ReadFile");

107 
	giLa¡Index
 = 
iIndex
;

110 
	gm_li¡
[(
UINT
)(
iIndex
-1)]->
push_back
(
row
);

115 
	gpublic
:

118 
CIÅutFeNoWeight
(cÚ¡ *
szLi¡Fe
)

120 
R—dLi¡
(
szLi¡Fe
);

123 
CIÅutFeNoWeight
(cÚ¡ 
¡ršg
 &
¡r
)

125 
R—dLi¡
(
¡r
);

129 ~
CIÅutFeNoWeight
()

131 
size_t
 
	gi
=0; i<
	gm_li¡
.
size
(); ++i)

132 
d–‘e
 
	gm_li¡
[
i
];

136 
PVeùÜT
 
G‘RecÜd
(
UINT
 
šdex
è{  
	gm_li¡
[index]; };

139 
UINT
 
G‘Size
(è{  (
	gUINT
)
	gm_li¡
.
size
(); }

	@include/workload/tpce/egen/InputFlatFilesDeclarations.h

41 #iâdeà
INPUT_FLAT_FILE_DECLARATIONS_H


42 
	#INPUT_FLAT_FILE_DECLARATIONS_H


	)

44 
	~<io¡»am
>

45 
	~"TabËCÚ¡s.h
"

46 
	~"TabË_Defs.h
"

47 
	~"T¿deTy³IDs.h
"

48 
	~"FÏtFe.h
"

49 
	~"IÅutFe.h
"

50 
	~"IÅutFeNoWeight.h
"

52 
usšg
 
Çme¥aû
 
	g¡d
;

56 
Çme¥aû
 
	gTPCE


58 cÚ¡ 
	gcWORD_Ën
 = 30;

61 
	gTAccouÁNameIÅutRow
 : 
	tpublic
 
	tTBa£IÅutRow


63 
NAME
[ 
cCA_NAME_Ën
+1 ];

65 
Lßd
(
i¡»am
 &
fe
);

66 } *
	tPAccouÁNameIÅutRow
;

69 
	gTA»aCodeIÅutRow
 : 
	tpublic
 
	tTBa£IÅutRow


72 
AREA_CODE
[ 
cAREA_Ën
+1 ];

74 
Lßd
(
i¡»am
 &
fe
);

75 } *
	tPA»aCodeIÅutRow
;

78 
	gTCom·nyIÅutRow
 : 
	tpublic
 
	tTBa£IÅutRow


80 
TId’t
 
CO_ID
;

81 
	gCO_ST_ID
[ 
cST_ID_Ën
+1 ];

82 
	gCO_NAME
[ 
cCO_NAME_Ën
+1 ];

83 
	gCO_IN_ID
[ 
cIN_ID_Ën
+1 ];

84 
	gCO_DESC
[ 
cCO_DESC_Ën
+1 ];

86 
Lßd
(
i¡»am
 &
fe
);

87 } *
	tPCom·nyIÅutRow
;

90 
	gTCom·nyCom³t™ÜIÅutRow
 : 
	tpublic
 
	tTBa£IÅutRow


92 
TId’t
 
CP_CO_ID
;

93 
TId’t
 
	gCP_COMP_CO_ID
;

94 
	gCP_IN_ID
[
cIN_ID_Ën
+1];

96 
Lßd
(
i¡»am
 &
fe
);

97 } *
	tPCom·nyCom³t™ÜIÅutRow
;

100 
	gTCom·nySPR©eIÅutRow
 : 
	tpublic
 
	tTBa£IÅutRow


103 
CO_SP_RATE
[ 
cCO_SP_RATE_Ën
+1 ];

105 
Lßd
(
i¡»am
 &
fe
);

106 } *
	tPCom·nySPR©eIÅutRow
;

109 
	gTFœ¡NameIÅutRow
 : 
	tpublic
 
	tTBa£IÅutRow


111 
FIRST_NAME
[
cF_NAME_Ën
+1];

113 
Lßd
(
i¡»am
 &
fe
);

114 } *
	tPFœ¡NameIÅutRow
;

118 
	gTLa¡NameIÅutRow
 : 
	tpublic
 
	tTBa£IÅutRow


120 
LAST_NAME
[
cL_NAME_Ën
+1];

122 
Lßd
(
i¡»am
 &
fe
);

123 } *
	tPLa¡NameIÅutRow
;

126 
	gTNewsIÅutRow
 : 
	tpublic
 
	tTBa£IÅutRow


128 
WORD
[
cWORD_Ën
+1];

130 
Lßd
(
i¡»am
 &
fe
);

131 } *
	tPNewsIÅutRow
;

134 
	gTSŒ“tNameIÅutRow
 : 
	tpublic
 
	tTBa£IÅutRow


136 
STREET
[ 
cAD_LINE_Ën
+1 ];

138 
Lßd
(
i¡»am
 &
fe
);

139 } *
	tPSŒ“tNameIÅutRow
;

142 
	gTSŒ“tSuffixIÅutRow
 : 
	tpublic
 
	tTBa£IÅutRow


144 
SUFFIX
[ 
cAD_LINE_Ën
+1 ];

146 
Lßd
(
i¡»am
 &
fe
);

147 } *
	tPSŒ“tSuffixIÅutRow
;

150 
	gTSecur™yIÅutRow
 : 
	tpublic
 
	tTBa£IÅutRow


152 
TId’t
 
S_ID
;

153 
	gS_ISSUE
[ 
cS_ISSUE_Ën
+1 ];

154 
	gS_ST_ID
[ 
cST_ID_Ën
+1 ];

155 
	gS_SYMB
[ 
cSYMBOL_Ën
+1 ];

156 
	gS_EX_ID
[ 
cEX_ID_Ën
+1];

157 
TId’t
 
	gS_CO_ID
;

159 
Lßd
(
i¡»am
 &
fe
);

160 } *
	tPSecur™›sIÅutRow
;

163 
	gTTaxR©eIÅutRow
 : 
	tpublic
 
	tTBa£IÅutRow


165 
TAX_ID
[ 
cTX_ID_Ën
+1 ];

166 
	gTAX_NAME
[ 
cTX_NAME_Ën
+1 ];

167 
	gTAX_RATE
;

169 
Lßd
(
i¡»am
 &
fe
);

170 } *
	tPTaxR©eIÅutRow
;

173 
	gTZCodeIÅutRow
 : 
	tpublic
 
	tTBa£IÅutRow


175 
UINT
 
iDivisiÚTaxKey
;

176 
	gZC_CODE
[
cZC_CODE_Ën
+1];

177 
	gZC_TOWN
[
cZC_TOWN_Ën
+1];

178 
	gZC_DIV
[
cZC_DIV_Ën
+1];

180 
Lßd
(
i¡»am
 &
fe
);

181 } *
	tPZCodeIÅutRow
;

193 
	sTBa£EËm’tsLim™s


195 
UINT
 
	gm_iTÙ®EËm’ts
;

198 
TBa£EËm’tsLim™s
()

199 : 
m_iTÙ®EËm’ts
(0)

203 
UINT
 
TÙ®EËm’ts
(è{ 
	gm_iTÙ®EËm’ts
;}

204 
	gvœtu®
 ~
TBa£EËm’tsLim™s
() {}

205 } *
	tPBa£EËm’tsLim™s
;

207 
	gTBa£KeyEËm’tsLim™s
 : 
	tpublic
 
	tTBa£EËm’tsLim™s


209 
m_iHighe¡Key
;

212 
TBa£KeyEËm’tsLim™s
()

213 : 
TBa£EËm’tsLim™s
(), 
m_iHighe¡Key
(0)

217 
Highe¡Key
(è{ 
	gm_iHighe¡Key
;}

218 } *
	tPBa£KeyEËm’tsLim™s
;

221 
	gTA»aCodesLim™s
 : 
	tpublic
 
	tTBa£KeyEËm’tsLim™s


223 
TA»aCodesLim™s
()

225 
m_iHighe¡Key
 = 306;

226 
	gm_iTÙ®EËm’ts
 = 284;

228 } *
	tPA»aCodesLim™s
;

231 
	gTCh¬geLim™s
 : 
	tpublic
 
	tTBa£EËm’tsLim™s


233 
TCh¬geLim™s
()

235 
m_iTÙ®EËm’ts
 = 15;

237 } *
	tPCh¬geLim™s
;

240 
	gTCommissiÚR©eLim™s
 : 
	tpublic
 
	tTBa£EËm’tsLim™s


242 
TCommissiÚR©eLim™s
()

244 
m_iTÙ®EËm’ts
 = 240;

246 } *
	tPCommissiÚR©eLim™s
;

249 
	gTCom·nyLim™s
 : 
	tpublic
 
	tTBa£EËm’tsLim™s


251 
TCom·nyLim™s
()

253 
m_iTÙ®EËm’ts
 = 5000;

255 } *
	tPCom·nyLim™s
;

258 
	gTCom·nyCom³t™ÜLim™s
 : 
	tpublic
 
	tTBa£EËm’tsLim™s


260 
TCom·nyCom³t™ÜLim™s
()

262 
m_iTÙ®EËm’ts
 = 15000;

264 } *
	tPCom·nyCom³t™ÜLim™s
;

267 
	gTCom·nySPR©eLim™s
 : 
	tpublic
 
	tTBa£KeyEËm’tsLim™s


269 
TCom·nySPR©eLim™s
()

271 
m_iHighe¡Key
 = 39;

272 
	gm_iTÙ®EËm’ts
 = 39;

274 } *
	tPCom·nySPR©eLim™s
;

277 
	gTExchªgeLim™s
 : 
	tpublic
 
	tTBa£EËm’tsLim™s


279 
TExchªgeLim™s
()

281 
m_iTÙ®EËm’ts
 = 4;

283 } *
	tPExchªgeLim™s
;

286 
	gTFem®eFœ¡NamesLim™s
 : 
	tpublic
 
	tTBa£KeyEËm’tsLim™s


288 
TFem®eFœ¡NamesLim™s
()

290 
m_iHighe¡Key
 = 11890;

291 
	gm_iTÙ®EËm’ts
 = 4275;

293 } *
	tPFem®eFœ¡NamesLim™s
;

296 
	gTIndu¡ryLim™s
 : 
	tpublic
 
	tTBa£EËm’tsLim™s


298 
TIndu¡ryLim™s
()

300 
m_iTÙ®EËm’ts
 = 102;

302 } *
	tPIndu¡ryLim™s
;

305 
	gTLa¡NamesLim™s
 : 
	tpublic
 
	tTBa£KeyEËm’tsLim™s


307 
TLa¡NamesLim™s
()

309 
m_iHighe¡Key
 = 69195;

310 
	gm_iTÙ®EËm’ts
 = 65000;

312 } *
	tPLa¡NamesLim™s
;

315 
	gTM®eFœ¡NamesLim™s
 : 
	tpublic
 
	tTBa£KeyEËm’tsLim™s


317 
TM®eFœ¡NamesLim™s
()

319 
m_iHighe¡Key
 = 9554;

320 
	gm_iTÙ®EËm’ts
 = 1220;

322 } *
	tPM®eFœ¡NamesLim™s
;

325 
	gTNewsLim™s
 : 
	tpublic
 
	tTBa£KeyEËm’tsLim™s


327 
TNewsLim™s
()

329 
m_iHighe¡Key
 = 69195;

330 
	gm_iTÙ®EËm’ts
 = 65000;

332 } *
	tPNewsLim™s
;

335 
	gTSeùÜLim™s
 : 
	tpublic
 
	tTBa£EËm’tsLim™s


337 
TSeùÜLim™s
()

339 
m_iTÙ®EËm’ts
 = 12;

341 } *
	tPSeùÜLim™s
;

344 
	gTSecur™yLim™s
 : 
	tpublic
 
	tTBa£EËm’tsLim™s


346 
TSecur™yLim™s
()

348 
m_iTÙ®EËm’ts
 = 6850;

350 } *
	tPSecur™yLim™s
;

353 
	gTStusTy³Lim™s
 : 
	tpublic
 
	tTBa£EËm’tsLim™s


355 
TStusTy³Lim™s
()

357 
m_iTÙ®EËm’ts
 = 5;

359 } *
	tPStusTy³Lim™s
;

363 
	gTSŒ“tNamesLim™s
 : 
	tpublic
 
	tTBa£KeyEËm’tsLim™s


365 
TSŒ“tNamesLim™s
()

367 
m_iHighe¡Key
 = 1000;

368 
	gm_iTÙ®EËm’ts
 = 1000;

370 } *
	tPSŒ“tNamesLim™s
;

373 
	gTSŒ“tSuffixLim™s
 : 
	tpublic
 
	tTBa£KeyEËm’tsLim™s


375 
TSŒ“tSuffixLim™s
()

377 
m_iHighe¡Key
 = 17;

378 
	gm_iTÙ®EËm’ts
 = 17;

380 } *
	tPSŒ“tSuffixLim™s
;

383 
	gTTaxabËAccouÁNameLim™s
 : 
	tpublic
 
	tTBa£EËm’tsLim™s


385 
TTaxabËAccouÁNameLim™s
()

387 
m_iTÙ®EËm’ts
 = 13;

389 } *
	tPTaxabËAccouÁNameLim™s
;

392 
	gTNÚTaxabËAccouÁNameLim™s
 : 
	tpublic
 
	tTBa£EËm’tsLim™s


394 
TNÚTaxabËAccouÁNameLim™s
()

396 
m_iTÙ®EËm’ts
 = 11;

398 } *
	tPNÚTaxabËAccouÁNameLim™s
;

401 
	gTTax¿‹Lim™s
 : 
	tpublic
 
	tTBa£EËm’tsLim™s


403 
TTax¿‹Lim™s
()

405 
m_iTÙ®EËm’ts
 = 320;

407 } *
	tPTax¿‹Lim™s
;

410 
	gTT¿deTy³Lim™s
 : 
	tpublic
 
	tTBa£EËm’tsLim™s


412 
TT¿deTy³Lim™s
()

414 
m_iTÙ®EËm’ts
 = 5;

416 } *
	tPT¿deTy³Lim™s
;

419 
	gTZCodeLim™s
 : 
	tpublic
 
	tTBa£KeyEËm’tsLim™s


421 
TZCodeLim™s
()

423 
m_iHighe¡Key
 = 23121;

424 
	gm_iTÙ®EËm’ts
 = 14741;

426 } *
	tPZCodeLim™s
;

434 
	eeStusTy³ID


436 
	geCom¶‘ed
 = 0,

437 
	geAùive
,

438 
	geSubm™‹d
,

439 
	geP’dšg
,

440 
	geCªûËd
,

442 
	geMaxStusTy³ID


448 
	eeExchªgeID


450 
	geNYSE
 = 0,

451 
	geNASDAQ
,

452 
	geAMEX
,

453 
	gePCX


458 cÚ¡ 
	giBa£Com·nyCouÁ
 = 5000;

459 cÚ¡ 
	giBa£Com·nyCom³t™ÜCouÁ
 = 3 * 
iBa£Com·nyCouÁ
;

460 cÚ¡ 
	giOÃLßdUn™Com·nyCouÁ
 = 500;

461 cÚ¡ 
	giOÃLßdUn™Secur™yCouÁ
 = 685;

462 cÚ¡ 
	giOÃLßdUn™Com·nyCom³t™ÜCouÁ
 = 3 * 
iOÃLßdUn™Com·nyCouÁ
;

470 
	gCIÅutFe
<
	tTA»aCodeIÅutRow
, 
	tTA»aCodesLim™s
> 
	tTA»aCodeFe
;

471 
	gCIÅutFe
<
	tTCom·nySPR©eIÅutRow
, 
	tTCom·nySPR©eLim™s
> 
	tTCom·nySPR©eFe
;

472 
	gCIÅutFe
<
	tTFœ¡NameIÅutRow
, 
	tTFem®eFœ¡NamesLim™s
> 
	tTFem®eFœ¡NamesFe
;

473 
	gCIÅutFe
<
	tTLa¡NameIÅutRow
, 
	tTLa¡NamesLim™s
> 
	tTLa¡NamesFe
;

474 
	gCIÅutFe
<
	tTFœ¡NameIÅutRow
, 
	tTM®eFœ¡NamesLim™s
> 
	tTM®eFœ¡NamesFe
;

475 
	gCIÅutFe
<
	tTNewsIÅutRow
, 
	tTNewsLim™s
> 
	tTNewsFe
;

476 
	gCIÅutFe
<
	tTSŒ“tNameIÅutRow
, 
	tTSŒ“tNamesLim™s
> 
	tTSŒ“tNamesFe
;

477 
	gCIÅutFe
<
	tTSŒ“tSuffixIÅutRow
, 
	tTSŒ“tSuffixLim™s
> 
	tTSŒ“tSuffixFe
;

478 
	gCIÅutFe
<
	tTZCodeIÅutRow
, 
	tTZCodeLim™s
> 
	tTZCodeFe
;

480 
	gCIÅutFeNoWeight
<
	tTTaxR©eIÅutRow
> 
	tTTaxR©esCouÁryFe
;

481 
	gCIÅutFeNoWeight
<
	tTTaxR©eIÅutRow
> 
	tTTaxR©esDivisiÚFe
;

483 
	gCFÏtFe
<
	tCHARGE_ROW
, 
	tTCh¬geLim™s
> 
	tTCh¬geFe
;

484 
	gCFÏtFe
<
	tCOMMISSION_RATE_ROW
, 
	tTCommissiÚR©eLim™s
> 
	tTCommissiÚR©eFe
;

485 
	gCFÏtFe
<
	tEXCHANGE_ROW
, 
	tTExchªgeLim™s
> 
	tTExchªgeFe
;

486 
	gCFÏtFe
<
	tINDUSTRY_ROW
, 
	tTIndu¡ryLim™s
> 
	tTIndu¡ryFe
;

487 
	gCFÏtFe
<
	tSECTOR_ROW
, 
	tTSeùÜLim™s
> 
	tTSeùÜFe
;

488 
	gCFÏtFe
<
	tSTATUS_TYPE_ROW
, 
	tTStusTy³Lim™s
> 
	tTStusTy³Fe
;

489 
	gCFÏtFe
<
	tTAccouÁNameIÅutRow
, 
	tTTaxabËAccouÁNameLim™s
> 
	tTTaxabËAccouÁNameFe
;

490 
	gCFÏtFe
<
	tTAccouÁNameIÅutRow
, 
	tTNÚTaxabËAccouÁNameLim™s
> 
	tTNÚTaxabËAccouÁNameFe
;

491 
	gCFÏtFe
<
	tTAXRATE_ROW
, 
	tTTax¿‹Lim™s
> 
	tTTax¿‹Fe
;

492 
	gCFÏtFe
<
	tTRADE_TYPE_ROW
, 
	tTT¿deTy³Lim™s
> 
	tTT¿deTy³Fe
;

	@include/workload/tpce/egen/InputFlatFilesStructure.h

42 #iâdeà
INPUT_FLAT_FILE_STRUCTURE_H


43 
	#INPUT_FLAT_FILE_STRUCTURE_H


	)

45 
	~"EG’Snd¬dTy³s.h
"

46 
	~"Driv”Ty³s.h
"

47 
	~"IÅutFÏtFesDeş¬©iÚs.h
"

48 
	~"Com·nyFe.h
"

49 
	~"Com·nyCom³t™ÜFe.h
"

50 
	~"Secur™yFe.h
"

52 
Çme¥aû
 
	gTPCE


55 
	eeOuutV”bos™y


57 
	geOuutQu›t
,

58 
	geOuutV”bo£


62 şas 
	cCIÅutFes


64 
	gpublic
:

65 
TA»aCodeFe
 *
A»aCodes
;

66 
TCh¬geFe
 *
	gCh¬ge
;

67 
TCommissiÚR©eFe
 *
	gCommissiÚR©e
;

68 
CCom·nyFe
 *
	gCom·ny
;

69 
CCom·nyCom³t™ÜFe
 *
	gCom·nyCom³t™Ü
;

70 
TCom·nySPR©eFe
 *
	gCom·nySPR©e
;

71 
TExchªgeFe
 *
	gExchªge
;

72 
TFem®eFœ¡NamesFe
 *
	gFem®eFœ¡Names
;

73 
TIndu¡ryFe
 *
	gIndu¡ry
;

74 
TLa¡NamesFe
 *
	gLa¡Names
;

75 
TM®eFœ¡NamesFe
 *
	gM®eFœ¡Names
;

76 
TNewsFe
 *
	gNews
;

77 
TSeùÜFe
 *
	gSeùÜs
;

78 
CSecur™yFe
 *
	gSecur™›s
;

79 
TStusTy³Fe
 *
	gStusTy³
;

80 
TSŒ“tNamesFe
 *
	gSŒ“t
;

81 
TSŒ“tSuffixFe
 *
	gSŒ“tSuffix
;

82 
TTaxabËAccouÁNameFe
 *
	gTaxabËAccouÁName
;

83 
TNÚTaxabËAccouÁNameFe
 *
	gNÚTaxabËAccouÁName
;

84 
TTaxR©esCouÁryFe
 *
	gTaxR©esCouÁry
;

85 
TTaxR©esDivisiÚFe
 *
	gTaxR©esDivisiÚ
;

86 
TT¿deTy³Fe
 *
	gT¿deTy³
;

87 
TZCodeFe
 *
	gZCode
;

89 
CIÅutFes
()

90 : 
A»aCodes
(
NULL
)

91 , 
Ch¬ge
(
NULL
)

92 , 
CommissiÚR©e
(
NULL
)

93 , 
Com·ny
(
NULL
)

94 , 
Com·nyCom³t™Ü
(
NULL
)

95 , 
Com·nySPR©e
(
NULL
)

96 , 
Exchªge
(
NULL
)

97 , 
Fem®eFœ¡Names
(
NULL
)

98 , 
Indu¡ry
(
NULL
)

99 , 
La¡Names
(
NULL
)

100 , 
M®eFœ¡Names
(
NULL
)

101 , 
News
(
NULL
)

102 , 
SeùÜs
(
NULL
)

103 , 
Secur™›s
(
NULL
)

104 , 
StusTy³
(
NULL
)

105 , 
SŒ“t
(
NULL
)

106 , 
SŒ“tSuffix
(
NULL
)

107 , 
TaxabËAccouÁName
(
NULL
)

108 , 
NÚTaxabËAccouÁName
(
NULL
)

109 , 
TaxR©esCouÁry
(
NULL
)

110 , 
TaxR©esDivisiÚ
(
NULL
)

111 , 
T¿deTy³
(
NULL
)

112 , 
ZCode
(
NULL
)

114 ~
CIÅutFes
() {};

116 
boŞ
 
In™Ÿlize
(
eDriv”Ty³
 
eTy³
, 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
, cÚ¡ *
szP©hName
);

	@include/workload/tpce/egen/LastTradeTable.h

40 #iâdeà
LAST_TRADE_TABLE_H


41 
	#LAST_TRADE_TABLE_H


	)

43 
	~"EG’TabËs_commÚ.h
"

44 
	~"Secur™yFe.h
"

45 
	~"MEESecur™y.h
"

47 
Çme¥aû
 
	gTPCE


50 
şass
 
	gCLa¡T¿deTabË
 : 
public
 
TabËTem¶©e
<
LAST_TRADE_ROW
>

52 
TId’t
 
m_iSecur™yCouÁ
;

53 
TId’t
 
	gm_iS¹FromSecur™y
;

54 
CSecur™yFe
* 
	gm_Secur™yFe
;

55 
CD©eTime
 
	gm_d©e
;

56 
CMEESecur™y
 
	gm_MEESecur™y
;

57 
	gm_iHoursOfIn™ŸlT¿des
;

58 
TId’t
 
	gm_iSecur™yCouÁFÜOÃLßdUn™
;

63 
G’”©eLa¡T¿deRow
()

65 
	gm_Secur™yFe
->
C»©eSymbŞ
(
m_iLa¡RowNumb”
, 
m_row
.
LT_S_SYMB
, 
¡©ic_ÿ¡
<>((m_row.LT_S_SYMB)));

67 
	gm_row
.
	gLT_DTS
 = 
m_d©e
;

69 
	gm_MEESecur™y
.
In™
(
m_iHoursOfIn™ŸlT¿des
 * 
SecÚdsP”Hour
, 
NULL
, NULL, 0);

71 
	gm_row
.
	gLT_PRICE
 = 
m_MEESecur™y
.
C®cuÏ‹Priû
(
m_iLa¡RowNumb”
, 0).
DŞÏrAmouÁ
();

73 
	gm_row
.
	gLT_OPEN_PRICE
 = 
m_MEESecur™y
.
C®cuÏ‹Priû
(
m_iLa¡RowNumb”
, 0).
DŞÏrAmouÁ
();

77 
	gm_row
.
	gLT_VOL
 = 0;

89 
In™NextLßdUn™
()

93 
CË¬RecÜd
();

96 
	gpublic
:

100 
CLa¡T¿deTabË
(
CIÅutFes
 
šputFes
,

101 
TId’t
 
iCu¡om”CouÁ
,

102 
TId’t
 
iS¹FromCu¡om”
,

103 
INT32
 
iHoursOfIn™ŸlT¿des
)

104 : 
TabËTem¶©e
<
LAST_TRADE_ROW
>()

105 , 
m_Secur™yFe
(
šputFes
.
Secur™›s
)

106 , 
m_iHoursOfIn™ŸlT¿des
Ğ
iHoursOfIn™ŸlT¿des
 )

108 
	gm_iSecur™yCouÁ
 = 
m_Secur™yFe
->
C®cuÏ‹Secur™yCouÁ
(
iCu¡om”CouÁ
);

109 
	gm_iS¹FromSecur™y
 = 
m_Secur™yFe
->
C®cuÏ‹S¹FromSecur™y
(
iS¹FromCu¡om”
);

111 
	gm_iLa¡RowNumb”
 = 
m_iS¹FromSecur™y
;

115 
	gm_d©e
.
S‘
Ğ
In™ŸlT¿dePİuÏtiÚBa£Y—r
, 
In™ŸlT¿dePİuÏtiÚBa£MÚth
,

116 
In™ŸlT¿dePİuÏtiÚBa£Day
, 
In™ŸlT¿dePİuÏtiÚBa£Hour
,

117 
In™ŸlT¿dePİuÏtiÚBa£Mšu‹
, 
In™ŸlT¿dePİuÏtiÚBa£SecÚd
,

118 
In™ŸlT¿dePİuÏtiÚBa£F¿ùiÚ
);

119 
	gm_d©e
.
Add
(
m_iHoursOfIn™ŸlT¿des
 / 
HoursP”WÜkDay
, 0, 
Œue
);

121 
	gm_iSecur™yCouÁFÜOÃLßdUn™
 = 
m_Secur™yFe
->
C®cuÏ‹Secur™yCouÁ
(
iDeçuÉLßdUn™Size
);

125 
boŞ
 
G’”©eNextRecÜd
()

127 ià(
	gm_iLa¡RowNumb”
 % 
	gm_iSecur™yCouÁFÜOÃLßdUn™
 == 0)

129 
In™NextLßdUn™
();

132 
G’”©eLa¡T¿deRow
();

134 ++
	gm_iLa¡RowNumb”
;

137 
	gm_bMÜeRecÜds
 = 
m_iLa¡RowNumb”
 < (
m_iS¹FromSecur™y
 + 
m_iSecur™yCouÁ
);

139  (
MÜeRecÜds
());

	@include/workload/tpce/egen/MEE.h

87 #iâdeà
MEE_H


88 
	#MEE_H


	)

90 
	~"EG’Ut™›s_¡dafx.h
"

91 
	~"MEET¿deReque¡AùiÚs.h
"

92 
	~"TxnH¬ÃssSŒuùs.h
"

93 
	~"MEEPriûBßrd.h
"

94 
	~"MEETick”T­e.h
"

95 
	~"MEET¿dšgFloÜ.h
"

96 
	~"MEESUTIÁ”çû.h
"

97 
	~"Ba£Logg”.h
"

98 
	~"Driv”P¬amS‘tšgs.h
"

100 
Çme¥aû
 
	gTPCE


103 şas 
	cCMEE


105 
	g´iv©e
:

107 
CDriv”MEES‘tšgs
 
m_Driv”MEES‘tšgs
;

109 
CMEESUTIÁ”çû
* 
	gm_pSUT
;

110 
CBa£Logg”
* 
	gm_pLogg”
;

111 
CMEEPriûBßrd
 
	gm_PriûBßrd
;

112 
CMEETick”T­e
 
	gm_Tick”T­e
;

113 
CMEET¿dšgFloÜ
 
	gm_T¿dšgFloÜ
;

114 
CD©eTime
 
	gm_Ba£Time
;

115 
CD©eTime
 
	gm_Cu¼’tTime
;

117 
CMu‹x
 
	gm_MEELock
;

120 
AutoS‘RNGS“ds
Ğ
UINT32
 
UniqueId
 );

122 
	gpublic
:

123 cÚ¡ 
INT32
 
NO_OUTSTANDING_TRADES
 = 
CMEET¿dšgFloÜ
::NO_OUTSTANDING_TRADES;

126 
CMEE
Ğ
INT32
 
T¿dšgTimeSoF¬
, 
CMEESUTIÁ”çû
 *
pSUT
, 
CBa£Logg”
 *
pLogg”
, cÚ¡ 
CIÅutFes
 &
šputFes
, 
UINT32
 
UniqueId
 );

129 
CMEE
Ğ
INT32
 
T¿dšgTimeSoF¬
, 
CMEESUTIÁ”çû
 *
pSUT
, 
CBa£Logg”
 *
pLogg”
, cÚ¡ 
CIÅutFes
 &
šputFes
, 
UINT32
 
UniqueId
, 
RNGSEED
 
Tick”T­eRNGS“d
, RNGSEED 
T¿dšgFloÜRNGS“d
 );

131 ~
CMEE
();

133 
RNGSEED
 
G‘Tick”T­eRNGS“d
( );

134 
RNGSEED
 
G‘T¿dšgFloÜRNGS“d
( );

136 
S‘Ba£Time
( );

138 
INT32
 
Subm™T¿deReque¡
Ğ
PT¿deReque¡
 
pT¿deReque¡
 );

139 
INT32
 
G’”©eT¿deResuÉ
( );

141 
boŞ
 
EÇbËTick”T­e
( );

142 
boŞ
 
Di§bËTick”T­e
( );

	@include/workload/tpce/egen/MEEPriceBoard.h

43 #iâdeà
MEE_PRICE_BOARD_H


44 
	#MEE_PRICE_BOARD_H


	)

46 
	~"EG’Ut™›s_¡dafx.h
"

47 
	~"EG’TabËs_¡dafx.h
"

48 
	~"MEESecur™y.h
"

50 
Çme¥aû
 
	gTPCE


53 şas 
	cCMEEPriûBßrd


56 
	g´iv©e
:

61 
m_fM—nInTheMÚeySubmissiÚD–ay
;

62 
CMEESecur™y
 
	gm_Secur™y
;

63 
CSecur™yFe
* 
	gm_pSecur™yFe
;

65 
	gpublic
:

66 
TId’t
 
m_iNumb”OfSecur™›s
;

68 
CMEEPriûBßrd
Ğ
INT32
 
T¿dšgTimeSoF¬
,

69 
CD©eTime
* 
pBa£Time
,

70 
CD©eTime
* 
pCu¼’tTime
,

71 cÚ¡ 
CIÅutFes
& 
šputFes


73 ~
CMEEPriûBßrd
( );

75 
G‘SymbŞ
Ğ
TId’t
 
Secur™yIndex
,

76 * 
szOuut
,

77 
size_t
 
iOuutL’
);

79 
CMÚey
 
G‘MšPriû
();

81 
CMÚey
 
G‘MaxPriû
();

83 
CMÚey
 
G‘Cu¼’tPriû
Ğ
TId’t
 
Secur™yIndex
 );

84 
CMÚey
 
G‘Cu¼’tPriû
Ğ* 
pSecur™ySymbŞ
 );

86 
CMÚey
 
C®cuÏ‹Priû
Ğ* 
pSecur™ySymbŞ
, 
fTime
 );

88 
G‘SubmissiÚTime
(

89 * 
pSecur™ySymbŞ
,

90 
fP’dšgTime
,

91 
CMÚey
 
fLim™Priû
,

92 
eT¿deTy³ID
 
T¿deTy³


94 
G‘SubmissiÚTime
(

95 
TId’t
 
Secur™yIndex
,

96 
fP’dšgTime
,

97 
CMÚey
 
fLim™Priû
,

98 
eT¿deTy³ID
 
T¿deTy³


100 
G‘Com¶‘iÚTime
(

101 
TId’t
 
Secur™yIndex
,

102 
fSubmissiÚTime
,

103 
CMÚey
* 
pCom¶‘iÚPriû


	@include/workload/tpce/egen/MEESUTInterface.h

48 #iâdeà
MEE_SUT_INTERFACE_H


49 
	#MEE_SUT_INTERFACE_H


	)

51 
	~"TxnH¬ÃssSŒuùs.h
"

53 
Çme¥aû
 
	gTPCE


56 şas 
	cCMEESUTIÁ”çû


58 
	gpublic
:

69 
vœtu®
 ~
CMEESUTIÁ”çû
() {};

71 
vœtu®
 
boŞ
 
T¿deResuÉ
Ğ
PT¿deResuÉTxnIÅut
 
pTxnIÅut
 ) = 0;

72 
vœtu®
 
boŞ
 
M¬k‘F“d
Ğ
PM¬k‘F“dTxnIÅut
 
pTxnIÅut
 ) = 0;

	@include/workload/tpce/egen/MEESecurity.h

48 #iâdeà
MEE_SECURITY_H


49 
	#MEE_SECURITY_H


	)

51 
	~"EG’Ut™›s_¡dafx.h
"

52 
	~"T¿deTy³IDs.h
"

53 
	~"Secur™yPriûRªge.h
"

55 
Çme¥aû
 
	gTPCE


58 şas 
	cCMEESecur™y


60 
	g´iv©e
:

61 
CRªdom
 
m_ºd
;

62 
CMÚey
 
	gm_fRªgeLow
;

63 
CMÚey
 
	gm_fRªgeHigh
;

64 
CMÚey
 
	gm_fRªge
;

65 
	gm_iP”iod
;

66 
INT32
 
	gm_T¿dšgTimeSoF¬
;

69 
CD©eTime
* 
	gm_pBa£Time
;

70 
CD©eTime
* 
	gm_pCu¼’tTime
;

80 
	gm_fM—nInTheMÚeySubmissiÚD–ay
;

95 
šlše
 
In™ŸlTime
Ğ
TId’t
 
Secur™yIndex
 );

107 
šlše
 
NegExp
(
fM—n
);

121 
C®cuÏ‹Time
Ğ
CMÚey
 
fS¹Priû
,

122 
CMÚey
 
fEndPriû
,

123 
iS¹DœeùiÚ
);

125 
	gpublic
:

136 
CMEESecur™y
();

152 
In™
(
INT32
 
T¿dšgTimeSoF¬
, 
CD©eTime
 *
pBa£Time
, CD©eTim*
pCu¼’tTime
, 
fM—nInTheMÚeySubmissiÚD–ay
);

165 
CMÚey
 
C®cuÏ‹Priû
(
TId’t
 
Secur™yIndex
, 
fTime
);

176 
CMÚey
 
G‘Cu¼’tPriû
Ğ
TId’t
 
Secur™yIndex
 );

187 
CMÚey
 
G‘MšPriû
( );

198 
CMÚey
 
G‘MaxPriû
( );

212 
G‘SubmissiÚTime
Ğ
TId’t
 
Secur™yIndex
,

213 
fP’dšgTime
,

214 
CMÚey
 
fLim™Priû
,

215 
eT¿deTy³ID
 
T¿deTy³


239 
G‘Com¶‘iÚTime
Ğ
TId’t
 
Secur™yIndex
,

240 
fSubmissiÚTime
,

241 
CMÚey
* 
pCom¶‘iÚPriû


	@include/workload/tpce/egen/MEETickerTape.h

46 #iâdeà
MEE_TICKER_TAPE_H


47 
	#MEE_TICKER_TAPE_H


	)

49 
	~"EG’Ut™›s_¡dafx.h
"

50 
	~"TxnH¬ÃssSŒuùs.h
"

51 
	~"Tim”Wh“l.h
"

52 
	~"MEESUTIÁ”çû.h
"

53 
	~"MEEPriûBßrd.h
"

55 
Çme¥aû
 
	gTPCE


58 şas 
	cCMEETick”T­e


60 
	g´iv©e
:

61 
CMEESUTIÁ”çû
* 
m_pSUT
;

62 
CMEEPriûBßrd
* 
	gm_pPriûBßrd
;

63 
TM¬k‘F“dTxnIÅut
 
	gm_TxnIÅut
;

64 
INT32
 
	gm_B©chIndex
;

65 
INT32
 
	gm_B©chDu¶iÿ‹s
;

66 
CRªdom
 
	gm_ºd
;

67 
boŞ
 
	gm_EÇbËd
;

68 
TStusTy³Fe
* 
	gm_pStusTy³
;

69 
TT¿deTy³Fe
* 
	gm_pT¿deTy³
;

71 cÚ¡ 
	gLIMIT_TRIGGER_TRADE_QTY
;

72 cÚ¡ 
	gRANDOM_TRADE_QTY_1
;

73 cÚ¡ 
	gRANDOM_TRADE_QTY_2
;

75 
	gCTim”Wh“l
< 
	gTTick”EÁry
, 
	gCMEETick”T­e
, 900, 1000 > 
	gm_Lim™Ord”Tim”s
;

76 
	gqueue
<
	gPTick”EÁry
> 
	gm_InTheMÚeyLim™Ord”Q
;

78 
CD©eTime
* 
	gm_pBa£Time
;

79 
CD©eTime
* 
	gm_pCu¼’tTime
;

81 
AddToB©ch
Ğ
PTick”EÁry
 
pTick”EÁry
 );

82 
AddA¹ificŸlEÁr›s
( );

83 
AddLim™Trigg”
Ğ
PTick”EÁry
 
pTick”EÁry
 );

86 
In™Ÿlize
( );

88 
	gpublic
:

90 
CMEETick”T­e
Ğ
CMEESUTIÁ”çû
* 
pSUT
, 
CMEEPriûBßrd
* 
pPriûBßrd
, 
CD©eTime
* 
pBa£Time
, CD©eTime* 
pCu¼’tTime
, cÚ¡ 
CIÅutFes
 &
šputFes
 );

93 
CMEETick”T­e
Ğ
CMEESUTIÁ”çû
* 
pSUT
, 
CMEEPriûBßrd
* 
pPriûBßrd
, 
CD©eTime
* 
pBa£Time
, CD©eTime* 
pCu¼’tTime
, 
RNGSEED
 
RNGS“d
, cÚ¡ 
CIÅutFes
 &
šputFes
 );

95 ~
CMEETick”T­e
( );

97 
AddEÁry
Ğ
PTick”EÁry
 
pTick”EÁry
 );

98 
Po¡Lim™Ord”
Ğ
PT¿deReque¡
 
pT¿deReque¡
 );

99 
boŞ
 
Di§bËTick”
( );

100 
boŞ
 
EÇbËTick”
( );

101 
eT¿deTy³ID
 
CÚv”tT¿deTy³IdToEnum
Ğ* 
pT¿deTy³
 );

103 
RNGSEED
 
G‘RNGS“d
( );

104 
S‘RNGS“d
Ğ
RNGSEED
 
RNGS“d
 );

	@include/workload/tpce/egen/MEETradeRequestActions.h

42 #iâdeà
MEE_TRADE_REQUEST_ACTIONS_H


43 
	#MEE_TRADE_REQUEST_ACTIONS_H


	)

45 
Çme¥aû
 
	gTPCE


48 
	eeMEET¿deReque¡AùiÚ


50 
	geMEEProûssOrd”
 = 0,

51 
	geMEES‘Lim™Ord”Trigg”


	@include/workload/tpce/egen/MEETradingFloor.h

46 #iâdeà
MEE_TRADING_FLOOR_H


47 
	#MEE_TRADING_FLOOR_H


	)

49 
	~"EG’Ut™›s_¡dafx.h
"

50 
	~"TxnH¬ÃssSŒuùs.h
"

51 
	~"Tim”Wh“l.h
"

52 
	~"MEESUTIÁ”çû.h
"

53 
	~"MEEPriûBßrd.h
"

54 
	~"MEETick”T­e.h
"

56 
Çme¥aû
 
	gTPCE


59 şas 
	cCMEET¿dšgFloÜ


61 
	g´iv©e
:

62 
CMEESUTIÁ”çû
* 
m_pSUT
;

63 
CMEEPriûBßrd
* 
	gm_pPriûBßrd
;

64 
CMEETick”T­e
* 
	gm_pTick”T­e
;

66 
CD©eTime
* 
	gm_pBa£Time
;

67 
CD©eTime
* 
	gm_pCu¼’tTime
;

69 
	gCTim”Wh“l
< 
	gTT¿deReque¡
, 
	gCMEET¿dšgFloÜ
, 5, 1 > 
	gm_Ord”Tim”s
;

70 
CRªdom
 
	gm_ºd
;

71 
	gm_Ord”ProûssšgD–ayM—n
;

72 cÚ¡ 
INT32
 
	gm_MaxOrd”ProûssšgD–ay
 = 5;

74 
G’ProûssšgD–ay
Ğ
fM—n
 );

75 
S’dT¿deResuÉ
Ğ
PT¿deReque¡
 
pT¿deReque¡
 );

77 
	gpublic
:

78 cÚ¡ 
INT32
 
NO_OUTSTANDING_TRADES
 = 
CTim”Wh“l
< 
TT¿deReque¡
, 
	gCMEET¿dšgFloÜ
, 5, 1 >::
NO_OUTSTANDING_TIMERS
;

81 
CMEET¿dšgFloÜ
Ğ
CMEESUTIÁ”çû
* 
pSUT
, 
CMEEPriûBßrd
* 
pPriûBßrd
, 
CMEETick”T­e
* 
pTick”T­e
, 
CD©eTime
* 
pBa£Time
, CD©eTime* 
pCu¼’tTime
 );

84 
CMEET¿dšgFloÜ
Ğ
CMEESUTIÁ”çû
* 
pSUT
, 
CMEEPriûBßrd
* 
pPriûBßrd
, 
CMEETick”T­e
* 
pTick”T­e
, 
CD©eTime
* 
pBa£Time
, CD©eTime* 
pCu¼’tTime
, 
RNGSEED
 
RNGS“d
 );

86 ~
CMEET¿dšgFloÜ
( );

88 
INT32
 
Subm™T¿deReque¡
Ğ
PT¿deReque¡
 
pT¿deReque¡
 );

89 
INT32
 
G’”©eT¿deResuÉ
( );

91 
RNGSEED
 
G‘RNGS“d
( );

92 
S‘RNGS“d
Ğ
RNGSEED
 
RNGS“d
 );

	@include/workload/tpce/egen/MiscConsts.h

40 #iâdeà
MISC_CONSTS_H


41 
	#MISC_CONSTS_H


	)

43 
	~"EG’Snd¬dTy³s.h
"

45 
Çme¥aû
 
	gTPCE


48 cÚ¡ 
TId’t
 
	giDeçuÉS¹FromCu¡om”
 = 1;

54 cÚ¡ 
TId’t
 
	giDeçuÉCu¡om”CouÁ
 = 5000;

56 cÚ¡ 
TId’t
 
	giBrok”sDiv
 = 100;

62 cÚ¡ 
TId’t
 
	giDeçuÉLßdUn™Size
 = 1000;

66 cÚ¡ 
TId’t
 
	giTId’tShiá
 = 
INT64_CONST
(4300000000);

70 cÚ¡ 
TT¿de
 
	giTT¿deShiá
 = 
INT64_CONST
(200000000000000);

72 cÚ¡ 
	giMaxHo¡Çme
 = 64;

73 cÚ¡ 
	giMaxDBName
 = 64;

74 cÚ¡ 
	giMaxP©h
 = 512;

79 cÚ¡ 
INT16
 
	gIn™ŸlT¿dePİuÏtiÚBa£Y—r
 = 2005;

80 cÚ¡ 
UINT16
 
	gIn™ŸlT¿dePİuÏtiÚBa£MÚth
 = 1;

81 cÚ¡ 
UINT16
 
	gIn™ŸlT¿dePİuÏtiÚBa£Day
 = 3;

82 cÚ¡ 
UINT16
 
	gIn™ŸlT¿dePİuÏtiÚBa£Hour
 = 9;

83 cÚ¡ 
UINT16
 
	gIn™ŸlT¿dePİuÏtiÚBa£Mšu‹
 = 0;

84 cÚ¡ 
UINT16
 
	gIn™ŸlT¿dePİuÏtiÚBa£SecÚd
 = 0;

85 cÚ¡ 
UINT32
 
	gIn™ŸlT¿dePİuÏtiÚBa£F¿ùiÚ
 = 0;

91 cÚ¡ 
	giAbÜtT¿de
 = 101;

96 cÚ¡ 
	giAbÜ‹dT¿deModFaùÜ
 = 51;

100 cÚ¡ 
	giDayM¬k‘Ba£Y—r
 = 2000;

101 cÚ¡ 
	giDayM¬k‘Ba£MÚth
 = 1;

102 cÚ¡ 
	giDayM¬k‘Ba£Day
 = 3;

103 cÚ¡ 
	giDayM¬k‘Ba£Hour
 = 0;

104 cÚ¡ 
	giDayM¬k‘Ba£Mšu‹
 = 0;

105 cÚ¡ 
	giDayM¬k‘Ba£SecÚd
 = 0;

106 cÚ¡ 
	giDayM¬k‘Ba£M£c
 = 0;

109 cÚ¡ 
	giSecur™yD‘aMšRows
 = 5;

110 cÚ¡ 
	giSecur™yD‘aMaxRows
 = 20;

113 cÚ¡ 
INT32
 
	gT¿deLookupMaxT¿deHi¡ÜyRowsR‘uºed
 = 3;

114 cÚ¡ 
INT32
 
	gT¿deLookupMaxRows
 = 20;

115 cÚ¡ 
INT32
 
	gT¿deLookupF¿me1MaxRows
 = 
T¿deLookupMaxRows
;

116 cÚ¡ 
INT32
 
	gT¿deLookupF¿me2MaxRows
 = 
T¿deLookupMaxRows
;

117 cÚ¡ 
INT32
 
	gT¿deLookupF¿me3MaxRows
 = 
T¿deLookupMaxRows
;

118 cÚ¡ 
INT32
 
	gT¿deLookupF¿me4MaxRows
 = 
T¿deLookupMaxRows
;

121 cÚ¡ 
INT32
 
	gT¿deUpd©eMaxT¿deHi¡ÜyRowsR‘uºed
 = 3;

122 cÚ¡ 
INT32
 
	gT¿deUpd©eMaxRows
 = 20;

123 cÚ¡ 
INT32
 
	gT¿deUpd©eF¿me1MaxRows
 = 
T¿deUpd©eMaxRows
;

124 cÚ¡ 
INT32
 
	gT¿deUpd©eF¿me2MaxRows
 = 
T¿deUpd©eMaxRows
;

125 cÚ¡ 
INT32
 
	gT¿deUpd©eF¿me3MaxRows
 = 
T¿deUpd©eMaxRows
;

128 cÚ¡ 
	gUµ”Ca£L‘‹rs
[] = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";

129 cÚ¡ 
	gLow”Ca£L‘‹rs
[] = "abcdefghijklmnopqrstuvwxyz";

130 cÚ¡ 
	gNum”®s
[] = "0123456789";

131 cÚ¡ 
	gMaxLow”Ca£L‘‹rs
 = (
Low”Ca£L‘‹rs
) - 1;

138 cÚ¡ 
INT32
 
	gT¿deLookupAV®ueFÜT¿deIDG’F¿me1
 = 65535;

139 cÚ¡ 
INT32
 
	gT¿deLookupSV®ueFÜT¿deIDG’F¿me1
 = 7;

140 cÚ¡ 
INT32
 
	gT¿deLookupAV®ueFÜTimeG’F¿me2
 = 4095;

141 cÚ¡ 
INT32
 
	gT¿deLookupSV®ueFÜTimeG’F¿me2
 = 16;

142 cÚ¡ 
INT32
 
	gT¿deLookupAV®ueFÜSymbŞF¿me3
 = 0;

143 cÚ¡ 
INT32
 
	gT¿deLookupSV®ueFÜSymbŞF¿me3
 = 0;

144 cÚ¡ 
INT32
 
	gT¿deLookupAV®ueFÜTimeG’F¿me3
 = 4095;

145 cÚ¡ 
INT32
 
	gT¿deLookupSV®ueFÜTimeG’F¿me3
 = 16;

146 cÚ¡ 
INT32
 
	gT¿deLookupAV®ueFÜTimeG’F¿me4
 = 4095;

147 cÚ¡ 
INT32
 
	gT¿deLookupSV®ueFÜTimeG’F¿me4
 = 16;

149 cÚ¡ 
INT32
 
	gT¿deUpd©eAV®ueFÜT¿deIDG’F¿me1
 = 65535;

150 cÚ¡ 
INT32
 
	gT¿deUpd©eSV®ueFÜT¿deIDG’F¿me1
 = 7;

151 cÚ¡ 
INT32
 
	gT¿deUpd©eAV®ueFÜTimeG’F¿me2
 = 4095;

152 cÚ¡ 
INT32
 
	gT¿deUpd©eSV®ueFÜTimeG’F¿me2
 = 16;

153 cÚ¡ 
INT32
 
	gT¿deUpd©eAV®ueFÜSymbŞF¿me3
 = 0;

154 cÚ¡ 
INT32
 
	gT¿deUpd©eSV®ueFÜSymbŞF¿me3
 = 0;

155 cÚ¡ 
INT32
 
	gT¿deUpd©eAV®ueFÜTimeG’F¿me3
 = 4095;

156 cÚ¡ 
INT32
 
	gT¿deUpd©eSV®ueFÜTimeG’F¿me3
 = 16;

	@include/workload/tpce/egen/Money.h

43 #iâdeà
MONEY_H


44 
	#MONEY_H


	)

46 
	~"EG’Snd¬dTy³s.h
"

48 
Çme¥aû
 
	gTPCE


51 şas 
	cCMÚey


53 
INT64
 
	gm_iAmouÁInC’ts
;

57 
ä›nd
 
CMÚey
 
	gİ”©Ü
 *(
	gl_i
, CMÚey 
	gr_m
);

58 
ä›nd
 
CMÚey
 
	gİ”©Ü
 *(
	gl_f
, CMÚey 
	gr_m
);

59 
ä›nd
 
	gİ”©Ü
 /(
	gl_f
, 
CMÚey
 
	gr_m
);

61 
	gpublic
:

64 
CMÚey
()

65 : 
m_iAmouÁInC’ts
(0)

71 
CMÚey
(CMÚey* 
m
)

72 : 
m_iAmouÁInC’ts
(
m
->m_iAmountInCents)

78 
CMÚey
(
fAmouÁ
)

79 : 
m_iAmouÁInC’ts
((
INT64
)(100.0 * 
fAmouÁ
 + 0.5))

85 
DŞÏrAmouÁ
()

87  
m_iAmouÁInC’ts
 / 100.0;

91 
INT64
 
C’tsAmouÁ
()

93  
	gm_iAmouÁInC’ts
;

98 
CMÚey
 
	gİ”©Ü
 +(cÚ¡ 
	gCMÚey
& 
	gm
)

100 
CMÚey
 
»t
(
this
);

102 
	g»t
.
	gm_iAmouÁInC’ts
 +ğ
m
.
m_iAmouÁInC’ts
;

104  
	g»t
;

107 
	gCMÚey
& 
	gİ”©Ü
 +=(cÚ¡ 
CMÚey
& 
m
)

109 
m_iAmouÁInC’ts
 +ğ
m
.m_iAmountInCents;

111  *
	gthis
;

114 
CMÚey
 
	gİ”©Ü
 -(cÚ¡ 
	gCMÚey
& 
	gm
)

116 
CMÚey
 
»t
(
this
);

118 
	g»t
.
	gm_iAmouÁInC’ts
 -ğ
m
.
m_iAmouÁInC’ts
;

120  
	g»t
;

123 
	gCMÚey
& 
	gİ”©Ü
 -=(cÚ¡ 
CMÚey
& 
m
)

125 
m_iAmouÁInC’ts
 -ğ
m
.m_iAmountInCents;

127  *
	gthis
;

130 
CMÚey
 
	gİ”©Ü
 *(cÚ¡ 
	gCMÚey
& 
	gm
)

132 
CMÚey
 
»t
(
this
);

134 
	g»t
.
	gm_iAmouÁInC’ts
 *ğ
m
.
m_iAmouÁInC’ts
;

136  
	g»t
;

139 
CMÚey
 
	gİ”©Ü
 /(cÚ¡ 
	gCMÚey
& 
	gm
)

141 
CMÚey
 
»t
(
this
);

143 
	g»t
.
	gm_iAmouÁInC’ts
 /ğ
m
.
m_iAmouÁInC’ts
;

145  
	g»t
;

150 
CMÚey
 
	gİ”©Ü
 *(
	gi
)

152 
CMÚey
 
»t
(
this
);

154 
	g»t
.
	gm_iAmouÁInC’ts
 *ğ
i
;

156  
	g»t
;

161 
CMÚey
 
	gİ”©Ü
 +(
	gf
)

163 
CMÚey
 
»t
(
this
);

165 
	g»t
.
	gm_iAmouÁInC’ts
 +ğ(
INT64
)(100.0 * 
f
 + 0.5);

167  
	g»t
;

170 
CMÚey
 
	gİ”©Ü
 -(
	gf
)

172 
CMÚey
 
»t
(
this
);

174 
	g»t
.
	gm_iAmouÁInC’ts
 -ğ(
INT64
)(100.0 * 
f
 + 0.5);

176  
	g»t
;

179 
	gCMÚey
& 
	gİ”©Ü
 -=(
f
)

181 
m_iAmouÁInC’ts
 -ğ(
INT64
)(100.0 * 
f
 + 0.5);

183  *
	gthis
;

186 
CMÚey
 
	gİ”©Ü
 *(
	gf
)

188 
CMÚey
 
»t
(
this
);

193 ià(
	g»t
.
	gm_iAmouÁInC’ts
 > 0)

195 
	g»t
.
	gm_iAmouÁInC’ts
 = (
INT64
)(
»t
.
m_iAmouÁInC’ts
 * 
f
 + 0.5);

199 
	g»t
.
	gm_iAmouÁInC’ts
 = (
INT64
)(
»t
.
m_iAmouÁInC’ts
 * 
f
 - 0.5);

202  
	g»t
;

205 
CMÚey
 
	gİ”©Ü
 /(
	gf
)

207 
CMÚey
 
»t
(
this
);

209 ià(
	g»t
.
	gm_iAmouÁInC’ts
 > 0)

211 
	g»t
.
	gm_iAmouÁInC’ts
 = (
INT64
)(
»t
.
m_iAmouÁInC’ts
 / 
f
 + 0.5);

215 
	g»t
.
	gm_iAmouÁInC’ts
 = (
INT64
)(
»t
.
m_iAmouÁInC’ts
 / 
f
 - 0.5);

218  
	g»t
;

223 
	gCMÚey
& 
	gİ”©Ü
=(
f
)

225 
m_iAmouÁInC’ts
 = (
INT64
)(100.0 * 
f
 + 0.5);

227  *
	gthis
;

232 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
CMÚey
& 
m
)

234  
m_iAmouÁInC’ts
 =ğ
m
.m_iAmountInCents;

237 
boŞ
 
	gİ”©Ü
>(cÚ¡ 
	gCMÚey
& 
	gm
)

239  
	gm_iAmouÁInC’ts
 > 
	gm
.m_iAmountInCents;

241 
boŞ
 
	gİ”©Ü
>=(cÚ¡ 
CMÚey
& 
m
)

243  
m_iAmouÁInC’ts
 >ğ
m
.m_iAmountInCents;

247 
boŞ
 
	gİ”©Ü
<(cÚ¡ 
	gCMÚey
& 
	gm
)

249  
	gm_iAmouÁInC’ts
 < 
	gm
.m_iAmountInCents;

251 
boŞ
 
	gİ”©Ü
<=(cÚ¡ 
CMÚey
& 
m
)

253  
m_iAmouÁInC’ts
 <ğ
m
.m_iAmountInCents;

	@include/workload/tpce/egen/NewsItemAndXRefTable.h

40 #iâdeà
NEWS_ITEM_AND_XREG_TABLE_H


41 
	#NEWS_ITEM_AND_XREG_TABLE_H


	)

43 
	~"EG’TabËs_commÚ.h
"

44 
	~"Com·nyTabË.h
"

46 
Çme¥aû
 
	gTPCE


49 cÚ¡ 
	giNewsI‹msP”Com·ny
 = 2;

50 cÚ¡ 
	giNewsI‹mMaxDaysAgo
 = 50;

52 cÚ¡ 
	giRNGSkOÃRowNews
 = 4 + 
cNI_ITEM_Ën
;

54 
	sNEWS_ITEM_AND_XREF_ROW


56 
NEWS_ITEM_ROW
 
	gÃws_™em
;

57 
NEWS_XREF_ROW
 
	gÃws_x»f
;

58 } *
	tPNEWS_ITEM_AND_XREF_ROW
;

60 
şass
 
	gCNewsI‹mAndXRefTabË
 : 
public
 
TabËTem¶©e
<
NEWS_ITEM_AND_XREF_ROW
>

62 
CCom·nyTabË
 
m_Com·nyTabË
;

63 
TNewsFe
* 
	gm_pNews
;

64 
TLa¡NamesFe
* 
	gm_pLa¡Names
;

65 
CD©eTime
 
	gm_NewsBa£D©e
;

66 
	gm_iNewsI‹msG’”©edFÜCom·ny
;

67 
TId’t
 
	gm_iNewsCouÁFÜOÃLßdUn™
;

69 
G’”©eNewsI‹mH—dlšeAndSumm¬y
(
NEWS_ITEM_ROW
 &
Ãws_™em
)

71 
	giTh»shŞd
;

72 
	giL’
 = 0;

73 *
	gszWÜd
;

75 
	giL’
 < (
	gÃws_™em
.
	gNI_ITEM
) - 1)

77 
	giTh»shŞd
 = 
m_ºd
.
RndIÁRªge
(0, 
m_pNews
->
G‘G»©e¡Key
() - 1);

79 
	gszWÜd
 = (
m_pNews
->
G‘RecÜd
(
iTh»shŞd
))->
WORD
;

81 
	gszWÜd
 && *szWÜd && (
	giL’
 < (
	gÃws_™em
.
	gNI_ITEM
) - 1))

83 
	gÃws_™em
.
	gNI_ITEM
[
iL’
++] = *
szWÜd
++;

86 ià(
	giL’
 < (
	gÃws_™em
.
	gNI_ITEM
) - 1)

88 
	gÃws_™em
.
	gNI_ITEM
[
iL’
++] = ' ';

92 
	gÃws_™em
.
	gNI_ITEM
[
iL’
] = '\0';

95 
memıy
(
Ãws_™em
.
NI_HEADLINE
,‚ews_™em.
NI_ITEM
, (news_item.NI_HEADLINE)-1);

100 
memıy
(
Ãws_™em
.
NI_SUMMARY
,‚ews_™em.
NI_ITEM
, (news_item.NI_SUMMARY)-1);

114 
In™NextLßdUn™
()

116 
	gm_ºd
.
S‘S“d
(
m_ºd
.
RndNthEËm’t
(
RNGS“dTabËDeçuÉ
,

117 (
RNGSEED
)
m_iLa¡RowNumb”
 * 
iRNGSkOÃRowNews
));

119 
CË¬RecÜd
();

122 
	gpublic
:

123 
CNewsI‹mAndXRefTabË
Ğ
CIÅutFes
 
šputFes
,

124 
TId’t
 
iCu¡om”CouÁ
,

125 
TId’t
 
iS¹FromCu¡om”
,

126 
INT32
 
iHoursOfIn™ŸlT¿des
)

127 : 
m_Com·nyTabË
(
šputFes
, 
iCu¡om”CouÁ
, 
iS¹FromCu¡om”
)

128 , 
m_pNews
(
šputFes
.
News
)

129 , 
m_pLa¡Names
(
šputFes
.
La¡Names
)

130 , 
m_iNewsI‹msG’”©edFÜCom·ny
(0)

132 
	gm_iLa¡RowNumb”
 = 
iNewsI‹msP”Com·ny
 * 
šputFes
.
Com·ny
->
C®cuÏ‹S¹FromCom·ny
(
iS¹FromCu¡om”
);

137 
	gm_NewsBa£D©e
.
S‘
Ğ
In™ŸlT¿dePİuÏtiÚBa£Y—r
, 
In™ŸlT¿dePİuÏtiÚBa£MÚth
,

138 
In™ŸlT¿dePİuÏtiÚBa£Day
, 
In™ŸlT¿dePİuÏtiÚBa£Hour
,

139 
In™ŸlT¿dePİuÏtiÚBa£Mšu‹
, 
In™ŸlT¿dePİuÏtiÚBa£SecÚd
,

140 
In™ŸlT¿dePİuÏtiÚBa£F¿ùiÚ
);

141 
	gm_NewsBa£D©e
.
Add
(
iHoursOfIn™ŸlT¿des
 / 
HoursP”WÜkDay
, 0, 
Œue
);

143 
	gm_iNewsCouÁFÜOÃLßdUn™
 = 
šputFes
.
Com·ny
->
C®cuÏ‹Com·nyCouÁ
(
iDeçuÉLßdUn™Size
è* 
iNewsI‹msP”Com·ny
;

149 
boŞ
 
G’”©eNextRecÜd
()

151 
	giAddDayNo
, 
	giAddMSec
, 
	giTh»shŞd
;

155 ià(
	gm_iLa¡RowNumb”
 % 
	gm_iNewsCouÁFÜOÃLßdUn™
 == 0)

157 
In™NextLßdUn™
();

161 
	gm_row
.
	gÃws_™em
.
	gNI_ID
 = 
m_iLa¡RowNumb”
 + 1;

162 
G’”©eNewsI‹mH—dlšeAndSumm¬y
(
m_row
.
Ãws_™em
);

163 
	giAddDayNo
 = 
m_ºd
.
RndIÁRªge
(0, 
iNewsI‹mMaxDaysAgo
);

164 
	giAddMSec
 = 
m_ºd
.
RndIÁRªge
(0, 
MsP”Day
);

165 
	gm_row
.
	gÃws_™em
.
	gNI_DTS
 = 
m_NewsBa£D©e
;

166 
	gm_row
.
	gÃws_™em
.
	gNI_DTS
.
Add
((-1è* 
iAddDayNo
, (-1è* 
iAddMSec
);

168 
	giTh»shŞd
 = 
m_ºd
.
RndIÁRªge
(0, 
m_pLa¡Names
->
G‘G»©e¡Key
() - 1);

169 
¡ºıy
(
m_row
.
Ãws_™em
.
NI_AUTHOR
, (
m_pLa¡Names
->
G‘RecÜd
(
iTh»shŞd
))->
LAST_NAME
,

170 (
m_row
.
Ãws_™em
.
NI_AUTHOR
));

172 
	giTh»shŞd
 = 
m_ºd
.
RndIÁRªge
(0, 
m_pLa¡Names
->
G‘G»©e¡Key
() - 1);

173 
¡ºıy
(
m_row
.
Ãws_™em
.
NI_SOURCE
, (
m_pLa¡Names
->
G‘RecÜd
(
iTh»shŞd
))->
LAST_NAME
,

174 (
m_row
.
Ãws_™em
.
NI_SOURCE
));

177 
	gm_row
.
	gÃws_x»f
.
	gNX_NI_ID
 = 
m_row
.
Ãws_™em
.
NI_ID
;

178 
	gm_row
.
	gÃws_x»f
.
	gNX_CO_ID
 = 
m_Com·nyTabË
.
G‘Cu¼’tCO_ID
();

180 ++
	gm_iNewsI‹msG’”©edFÜCom·ny
;

182 ++
	gm_iLa¡RowNumb”
;

184 ià(
	gm_iNewsI‹msG’”©edFÜCom·ny
 >ğ
iNewsI‹msP”Com·ny
)

186 
m_bMÜeRecÜds
 = 
m_Com·nyTabË
.
G’”©eNextCO_ID
();

187 
	gm_iNewsI‹msG’”©edFÜCom·ny
 = 0;

191 
	gm_bMÜeRecÜds
 = 
Œue
;

194  (
MÜeRecÜds
());

199 
PNEWS_ITEM_ROW
 
G‘NewsI‹mRow
(è{  &
	gm_row
.
	gÃws_™em
; }

200 
PNEWS_XREF_ROW
 
G‘NewsXRefRow
(è{  &
	gm_row
.
	gÃws_x»f
; }

	@include/workload/tpce/egen/NullLoad_stdafx.h

37 #iâdeà
EGEN_NULLLOADER_STDAFX_H


38 
	#EGEN_NULLLOADER_STDAFX_H


	)

40 
	~"NuÎLßd”.h
"

41 
	~"NuÎLßd”FaùÜy.h
"

	@include/workload/tpce/egen/NullLoader.h

42 #iâdeà
NULL_LOADER_H


43 
	#NULL_LOADER_H


	)

45 
	~"Ba£Lßd”.h
"

46 
	~"unu£dæag.h
"

48 
Çme¥aû
 
	gTPCE


51 
	g‹m¶©e
 <
ty³Çme
 
	gT
> 
şass
 
	gCNuÎLßd”
 : 
public
 
CBa£Lßd”
<
T
>

54 
public
:

55 cÚ¡ 
	tT
* 
	tPT
;

67 
vœtu®
 
Wr™eNextRecÜd
(
PT
 
Ãxt_»cÜd
 
UNUSED
) {};

79 
vœtu®
 
FšishLßd
() {};

	@include/workload/tpce/egen/NullLoaderFactory.h

41 #iâdeà
NULL_LOADER_FACTORY_H


42 
	#NULL_LOADER_FACTORY_H


	)

44 
	~"Ba£Lßd”.h
"

45 
	~"Ba£Lßd”FaùÜy.h
"

46 
	~"NuÎLßd”.h
"

47 
	~"TabË_Defs.h
"

49 
Çme¥aû
 
	gTPCE


52 şas 
	cCNuÎLßd”FaùÜy
 : 
public
 
CBa£Lßd”FaùÜy


55 
public
:

59 
vœtu®
 
CBa£Lßd”
<
ACCOUNT_PERMISSION_ROW
>* 
C»©eAccouÁP”missiÚLßd”
()

61  
Ãw
 
CNuÎLßd”
<
ACCOUNT_PERMISSION_ROW
>();

64 
vœtu®
 
	gCBa£Lßd”
<
	gADDRESS_ROW
>* 
C»©eAdd»ssLßd”
()

66  
Ãw
 
	gCNuÎLßd”
<
	gADDRESS_ROW
>();

69 
vœtu®
 
	gCBa£Lßd”
<
	gBROKER_ROW
>* 
C»©eBrok”Lßd”
()

71  
Ãw
 
	gCNuÎLßd”
<
	gBROKER_ROW
>();

74 
vœtu®
 
	gCBa£Lßd”
<
	gCASH_TRANSACTION_ROW
>* 
C»©eCashT¿n§ùiÚLßd”
()

76  
Ãw
 
	gCNuÎLßd”
<
	gCASH_TRANSACTION_ROW
>();

79 
vœtu®
 
	gCBa£Lßd”
<
	gCHARGE_ROW
>* 
C»©eCh¬geLßd”
()

81  
Ãw
 
	gCNuÎLßd”
<
	gCHARGE_ROW
>();

84 
vœtu®
 
	gCBa£Lßd”
<
	gCOMMISSION_RATE_ROW
>* 
C»©eCommissiÚR©eLßd”
()

86  
Ãw
 
	gCNuÎLßd”
<
	gCOMMISSION_RATE_ROW
>();

89 
vœtu®
 
	gCBa£Lßd”
<
	gCOMPANY_COMPETITOR_ROW
>* 
C»©eCom·nyCom³t™ÜLßd”
()

91  
Ãw
 
	gCNuÎLßd”
<
	gCOMPANY_COMPETITOR_ROW
>();

94 
vœtu®
 
	gCBa£Lßd”
<
	gCOMPANY_ROW
>* 
C»©eCom·nyLßd”
()

96  
Ãw
 
	gCNuÎLßd”
<
	gCOMPANY_ROW
>();

99 
vœtu®
 
	gCBa£Lßd”
<
	gCUSTOMER_ACCOUNT_ROW
>* 
C»©eCu¡om”AccouÁLßd”
()

101  
Ãw
 
	gCNuÎLßd”
<
	gCUSTOMER_ACCOUNT_ROW
>();

104 
vœtu®
 
	gCBa£Lßd”
<
	gCUSTOMER_ROW
>* 
C»©eCu¡om”Lßd”
()

106  
Ãw
 
	gCNuÎLßd”
<
	gCUSTOMER_ROW
>();

108 
vœtu®
 
	gCBa£Lßd”
<
	gCUSTOMER_TAXRATE_ROW
>* 
C»©eCu¡om”Tax¿‹Lßd”
()

110  
Ãw
 
	gCNuÎLßd”
<
	gCUSTOMER_TAXRATE_ROW
>();

112 
vœtu®
 
	gCBa£Lßd”
<
	gDAILY_MARKET_ROW
>* 
C»©eDayM¬k‘Lßd”
()

114  
Ãw
 
	gCNuÎLßd”
<
	gDAILY_MARKET_ROW
>();

116 
vœtu®
 
	gCBa£Lßd”
<
	gEXCHANGE_ROW
>* 
C»©eExchªgeLßd”
()

118  
Ãw
 
	gCNuÎLßd”
<
	gEXCHANGE_ROW
>();

120 
vœtu®
 
	gCBa£Lßd”
<
	gFINANCIAL_ROW
>* 
C»©eFšªcŸlLßd”
()

122  
Ãw
 
	gCNuÎLßd”
<
	gFINANCIAL_ROW
>();

124 
vœtu®
 
	gCBa£Lßd”
<
	gHOLDING_ROW
>* 
C»©eHŞdšgLßd”
()

126  
Ãw
 
	gCNuÎLßd”
<
	gHOLDING_ROW
>();

128 
vœtu®
 
	gCBa£Lßd”
<
	gHOLDING_HISTORY_ROW
>* 
C»©eHŞdšgHi¡ÜyLßd”
()

130  
Ãw
 
	gCNuÎLßd”
<
	gHOLDING_HISTORY_ROW
>();

132 
vœtu®
 
	gCBa£Lßd”
<
	gHOLDING_SUMMARY_ROW
>* 
C»©eHŞdšgSumm¬yLßd”
()

134  
Ãw
 
	gCNuÎLßd”
<
	gHOLDING_SUMMARY_ROW
>();

136 
vœtu®
 
	gCBa£Lßd”
<
	gINDUSTRY_ROW
>* 
C»©eIndu¡ryLßd”
()

138  
Ãw
 
	gCNuÎLßd”
<
	gINDUSTRY_ROW
>();

140 
vœtu®
 
	gCBa£Lßd”
<
	gLAST_TRADE_ROW
>* 
C»©eLa¡T¿deLßd”
()

142  
Ãw
 
	gCNuÎLßd”
<
	gLAST_TRADE_ROW
>();

144 
vœtu®
 
	gCBa£Lßd”
<
	gNEWS_ITEM_ROW
>* 
C»©eNewsI‹mLßd”
()

146  
Ãw
 
	gCNuÎLßd”
<
	gNEWS_ITEM_ROW
>();

148 
vœtu®
 
	gCBa£Lßd”
<
	gNEWS_XREF_ROW
>* 
C»©eNewsXRefLßd”
()

150  
Ãw
 
	gCNuÎLßd”
<
	gNEWS_XREF_ROW
>();

152 
vœtu®
 
	gCBa£Lßd”
<
	gSECTOR_ROW
>* 
C»©eSeùÜLßd”
()

154  
Ãw
 
	gCNuÎLßd”
<
	gSECTOR_ROW
>();

156 
vœtu®
 
	gCBa£Lßd”
<
	gSECURITY_ROW
>* 
C»©eSecur™yLßd”
()

158  
Ãw
 
	gCNuÎLßd”
<
	gSECURITY_ROW
>();

160 
vœtu®
 
	gCBa£Lßd”
<
	gSETTLEMENT_ROW
>* 
C»©eS‘em’tLßd”
()

162  
Ãw
 
	gCNuÎLßd”
<
	gSETTLEMENT_ROW
>();

164 
vœtu®
 
	gCBa£Lßd”
<
	gSTATUS_TYPE_ROW
>* 
C»©eStusTy³Lßd”
()

166  
Ãw
 
	gCNuÎLßd”
<
	gSTATUS_TYPE_ROW
>();

168 
vœtu®
 
	gCBa£Lßd”
<
	gTAXRATE_ROW
>* 
C»©eTax¿‹Lßd”
()

170  
Ãw
 
	gCNuÎLßd”
<
	gTAXRATE_ROW
>();

172 
vœtu®
 
	gCBa£Lßd”
<
	gTRADE_HISTORY_ROW
>* 
C»©eT¿deHi¡ÜyLßd”
()

174  
Ãw
 
	gCNuÎLßd”
<
	gTRADE_HISTORY_ROW
>();

176 
vœtu®
 
	gCBa£Lßd”
<
	gTRADE_ROW
>* 
C»©eT¿deLßd”
()

178  
Ãw
 
	gCNuÎLßd”
<
	gTRADE_ROW
>();

180 
vœtu®
 
	gCBa£Lßd”
<
	gTRADE_REQUEST_ROW
>* 
C»©eT¿deReque¡Lßd”
()

182  
Ãw
 
	gCNuÎLßd”
<
	gTRADE_REQUEST_ROW
>();

184 
vœtu®
 
	gCBa£Lßd”
<
	gTRADE_TYPE_ROW
>* 
C»©eT¿deTy³Lßd”
()

186  
Ãw
 
	gCNuÎLßd”
<
	gTRADE_TYPE_ROW
>();

188 
vœtu®
 
	gCBa£Lßd”
<
	gWATCH_ITEM_ROW
>* 
C»©eW©chI‹mLßd”
()

190  
Ãw
 
	gCNuÎLßd”
<
	gWATCH_ITEM_ROW
>();

193 
vœtu®
 
	gCBa£Lßd”
<
	gWATCH_LIST_ROW
>* 
C»©eW©chLi¡Lßd”
()

195  
Ãw
 
	gCNuÎLßd”
<
	gWATCH_LIST_ROW
>();

198 
vœtu®
 
	gCBa£Lßd”
<
	gZIP_CODE_ROW
>* 
C»©eZCodeLßd”
()

200  
Ãw
 
	gCNuÎLßd”
<
	gZIP_CODE_ROW
>();

	@include/workload/tpce/egen/Person.h

40 #iâdeà
PERSON_H


41 
	#PERSON_H


	)

43 
	~"EG’Snd¬dTy³s.h
"

44 
	~"Rªdom.h
"

45 
	~"IÅutFÏtFesDeş¬©iÚs.h
"

46 
	~"IÅutFÏtFesSŒuùu».h
"

48 
Çme¥aû
 
	gTPCE


52 cÚ¡ 
	gTaxIDFmt_Ën
 = 14;

53 cÚ¡ 
	gTaxIDFmt
[
TaxIDFmt_Ën
+1] = "nnnaannnnaannn";

55 şas 
	cCP”sÚ


57 
	g´iv©e
:

59 
TLa¡NamesFe
 *
m_La¡Names
;

60 
TM®eFœ¡NamesFe
 *
	gm_M®eFœ¡Names
;

61 
TFem®eFœ¡NamesFe
 *
	gm_Fem®eFœ¡Names
;

63 
CRªdom
 
	gm_ºd
;

64 
boŞ
 
	gm_bCacheEÇbËd
;

65 
	gm_iCacheSize
;

66 
TId’t
 
	gm_iCacheOff£t
;

67 ** 
	gm_CacheFœ¡Name
;

68 ** 
	gm_CacheLa¡Name
;

70 
	gpublic
:

71 
CP”sÚ
(
CIÅutFes
 
šputFes
, 
TId’t
 
iS¹FromCu¡om”
, 
boŞ
 
bCacheEÇbËd
 = 
çl£
);

73 ~
CP”sÚ
();

74 
In™NextLßdUn™
(
TId’t
 
iCacheOff£tInüem’t
 = 
iDeçuÉLßdUn™Size
);

76 * 
G‘La¡Name
(
TId’t
 
CID
);

77 * 
G‘Fœ¡Name
(
TId’t
 
CID
);

78 
G‘MiddËName
(
TId’t
 
CID
);

79 
G‘G’d”
(
TId’t
 
CID
);

80 
boŞ
 
IsM®eG’d”
(
TId’t
 
CID
);

81 
G‘TaxID
(
TId’t
 
CID
, *
buf
);

84 
G‘Fœ¡La¡AndTaxID
(
TId’t
 
C_ID
, *
szFœ¡Name
, *
szLa¡Name
, *
szTaxID
);

	@include/workload/tpce/egen/RNGSeeds.h

41 #iâdeà
RNGSEEDS_H


42 
	#RNGSEEDS_H


	)

44 
	~"Rªdom.h
"

46 
Çme¥aû
 
	gTPCE


49 cÚ¡ 
RNGSEED
 
	gRNGS“dTabËDeçuÉ
 = 37039940;

53 cÚ¡ 
RNGSEED
 
	gRNGS“dBa£TownDivZ
 = 26778071;

56 cÚ¡ 
RNGSEED
 
	gRNGS“dBa£C_TIER
 = 16225173;

59 cÚ¡ 
RNGSEED
 
	gRNGS“dBa£C_AREA_1
 = 97905013;

60 cÚ¡ 
RNGSEED
 
	gRNGS“dBa£C_AREA_2
 = 68856487;

61 cÚ¡ 
RNGSEED
 
	gRNGS“dBa£C_AREA_3
 = 67142295;

64 cÚ¡ 
RNGSEED
 
	gRNGS“dBa£Fœ¡Name
 = 95066470;

65 cÚ¡ 
RNGSEED
 
	gRNGS“dBa£MiddËIn™Ÿl
 = 71434514;

66 cÚ¡ 
RNGSEED
 
	gRNGS“dBa£La¡Name
 = 35846049;

69 cÚ¡ 
RNGSEED
 
	gRNGS“dBa£G’d”
 = 9568922;

72 cÚ¡ 
RNGSEED
 
	gRNGS“dBa£TaxID
 = 8731255;

78 cÚ¡ 
RNGSEED
 
	gRNGS“dBa£Numb”OfAccouÁP”missiÚs
 = 27794203;

81 cÚ¡ 
RNGSEED
 
	gRNGS“dBa£CIDFÜP”missiÚ1
 = 76103629;

82 cÚ¡ 
RNGSEED
 
	gRNGS“dBa£CIDFÜP”missiÚ2
 = 103275149;

85 cÚ¡ 
RNGSEED
 
	gRNGS“dBa£AccouÁTaxStus
 = 34376701;

88 cÚ¡ 
RNGSEED
 
	gRNGS“dBa£Brok”Id
 = 75607774;

91 cÚ¡ 
RNGSEED
 
	gRNGS“dBa£TaxR©eRow
 = 92740731;

94 cÚ¡ 
RNGSEED
 
	gRNGS“dBa£Numb”OfSecur™›s
 = 23361736;

98 cÚ¡ 
RNGSEED
 
	gRNGS“dBa£S¹šgSecur™yID
 = 12020070;

101 cÚ¡ 
RNGSEED
 
	gRNGS“dBa£SPR©e
 = 56593330;

104 cÚ¡ 
RNGSEED
 
	gRNGS“dT¿deG’
 = 32900134;

107 cÚ¡ 
RNGSEED
 
	gRNGS“dBa£MEESecur™y
 = 75791232;

110 cÚ¡ 
RNGSEED
 
	gRNGS“dCu¡om”S–eùiÚ
 = 9270899;

113 cÚ¡ 
RNGSEED
 
	gRNGS“dBa£MEETick”T­e
 = 42065035;

116 cÚ¡ 
RNGSEED
 
	gRNGS“dBa£MEET¿dšgFloÜ
 = 25730774;

119 cÚ¡ 
RNGSEED
 
	gRNGS“dBa£TxnMixG’”©Ü
 = 87944308;

122 cÚ¡ 
RNGSEED
 
	gRNGS“dBa£TxnIÅutG’”©Ü
 = 80534927;

	@include/workload/tpce/egen/Random.h

37 #iâdeà
RANDOM_H


38 
	#RANDOM_H


	)

40 
	~"EG’Snd¬dTy³s.h
"

41 
	~"BigM©h.h
"

42 
	~<cm©h
>

74 
Çme¥aû
 
	gTPCE


78 
	#UIÁ64Rªd_A_MULTIPLIER
 
	`UINT64_CONST
(6364136223846793005)

	)

79 
	#UIÁ64Rªd_C_INCREMENT
 
	`UINT64_CONST
(1)

	)

80 
	#UIÁ64Rªd_ONE
 
	`UINT64_CONST
(1)

	)

83 
UINT64
 
	tRNGSEED
;

85 #ifdeà
EGEN_USE_DEPRECATED_CODE


88 
	#UIÁ64Rªd_RECIPROCAL_2_POWER_64
 (5.421010862427522e-20)

	)

92 şas 
	cCRªdom


94 
	g´iv©e
:

95 
RNGSEED
 
m_£ed
;

96 
šlše
 
RNGSEED
 
UIÁ64Rªd
();

98 
	gpublic
:

99 
CRªdom
();

100 
CRªdom
(
RNGSEED
 
£ed
);

101 ~
CRªdom
() { };

103 
S‘S“d
(
RNGSEED
 
£ed
);

104 
šlše
 
RNGSEED
 
G‘S“d
(è{  
	gm_£ed
; };

105 
RNGSEED
 
RndNthEËm’t
ĞRNGSEED 
nS“d
, RNGSEED 
nCouÁ
);

108 
RndIÁRªge
(
mš
, 
max
);

111 
INT64
 
RndIÁ64Rªge
(INT64 
mš
, INT64 
max
);

114 
INT64
 
RndIÁ64RªgeExşude
(INT64 
low
, INT64 
high
, INT64 
exşude
);

117 
RndNthIÁRªge
(
RNGSEED
 
S“d
, RNGSEED 
N
, 
mš
, 
max
);

120 
INT64
 
RndNthIÁ64Rªge
(
RNGSEED
 
S“d
, RNGSEED 
N
, INT64 
mš
, INT64 
max
);

123 
RndIÁRªgeExşude
(
low
, 
high
, 
exşude
);

125 #ifdeà
EGEN_USE_DEPRECATED_CODE


130 
RndDoubË
();

133 
RndNthDoubË
(
RNGSEED
 
S“d
, RNGSEED 
N
);

138 
RndDoubËRªge
(
mš
, 
max
);

141 
RndDoubËInüRªge
(
mš
, 
max
, 
šü
);

144 
RndDoubËNegExp
(
m—n
);

147 
šlše
 
boŞ
 
RndP”ûÁ
(
³rûÁ
)

148 {  (
RndIÁRªge
(1, 100è<ğ
³rûÁ
); };

151 
šlše
 
UINT
 
RndG’”©eIÁeg”P”ûÁage
( )

153 Ğ(
	gUINT
è
RndIÁRªge
( 1, 100 ));

177 
INT64
 
NURnd
ĞINT64 
P
, INT64 
Q
, 
INT32
 
A
, INT32 
s
 );

183 
RndAÍhaNumFÜm©‹d
(*
szR‘uºSŒšg
, cÚ¡ *
szFÜm©
);

	@include/workload/tpce/egen/SectorTable.h

40 #iâdeà
SECTOR_TABLE_H


41 
	#SECTOR_TABLE_H


	)

43 
	~"EG’TabËs_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCSeùÜTabË
 : 
public
 
TabËTem¶©e
<
SECTOR_ROW
>

50 
if¡»am
 
InFe
;

52 
	gpublic
:

53 
CSeùÜTabË
Ğ*
szDœName
 )

54 : 
TabËTem¶©e
<
SECTOR_ROW
>()

56 
szFeName
[
iMaxP©h
];

58 
¡ºıy
(
szFeName
, 
szDœName
, (szFileName));

59 
¡ºÿt
(
szFeName
, "SeùÜ.txt", (szFeNameè- 
¡¾’
(
szDœName
) - 1);

61 
	gInFe
.
İ’
Ğ
szFeName
 );

64 ~
CSeùÜTabË
( )

66 
	gInFe
.
şo£
();

72 
boŞ
 
G’”©eNextRecÜd
()

74 ifĞ
	gInFe
.
good
() )

76 
	gm_row
.
Lßd
(
InFe
);

79  ( 
	gInFe
.
eof
() );

	@include/workload/tpce/egen/SecurityFile.h

42 #iâdeà
SECURITY_FILE_H


43 
	#SECURITY_FILE_H


	)

45 
	~<m­
>

46 
	~"Com·nyFe.h
"

48 
usšg
 
Çme¥aû
 
	g¡d
;

50 
Çme¥aû
 
	gTPCE


55 cÚ¡ 
UINT
 
	gPow”26
[] = { 1, 26, 676, 17576, 456976, 11881376, 308915776 };

58 cÚ¡ 
UINT64
 
	gPow”26Sum
[] = { 0, 1, 27, 703, 18279, 475255, 12356631, 321272407, 
UINT64_CONST
(8353082583) };

60 
şass
 
	gCSecur™yFe
 : 
public
 
CFÏtFe
<
TSecur™yIÅutRow
, 
	gTSecur™yLim™s
>

65 
TId’t
 
	gm_iCÚfigu»dSecur™yCouÁ
;

66 
TId’t
 
	gm_iAùiveSecur™yCouÁ
;

70 
UINT
 
	gm_iBa£Com·nyCouÁ
;

73 
boŞ
 
	gm_SymbŞToIdM­IsLßded
;

74 
	gm­
< 
	g¡ršg
, 
	gTId’t
 > 
	gm_SymbŞToIdM­
;

75 
	gm­
< , > 
	gm_Low”Ca£L‘‹rToIÁM­
;

76 
	gm_SUFFIX_SEPARATOR
;

78 
C»©eSuffix
Ğ
TId’t
 
MuÉl›r
, * 
pBuf
, 
size_t
 
BufSize
 )

80 
size_t
 
Ch¬CouÁ
( 0 );

81 
INT64
 
Off£t
( 0 );

82 
INT64
 
LCLIndex
( 0 );

84  (
	gUINT64
)
	gMuÉl›r
 >ğ
Pow”26Sum
[
Ch¬CouÁ
+1] )

86 
Ch¬CouÁ
++;

89 ifĞ
	gCh¬CouÁ
 + 2 <ğ
BufSize
 )

91 *
pBuf
 = 
m_SUFFIX_SEPARATOR
;

92 
	gpBuf
++;

98 
	gOff£t
 = 
MuÉl›r
 - 
Pow”26Sum
[
Ch¬CouÁ
];

100  
	gCh¬CouÁ
 > 0 )

102 
	gLCLIndex
 = 
Off£t
 / 
Pow”26
[ 
Ch¬CouÁ
-1 ];

103 *
	gpBuf
 = 
Low”Ca£L‘‹rs
[ 
LCLIndex
 ];

104 
	gpBuf
++;

105 
	gOff£t
 -ğĞ
LCLIndex
 * 
Pow”26
[ 
Ch¬CouÁ
-1 ] );

106 
	gCh¬CouÁ
--;

108 *
	gpBuf
 = '\0';

113 
	gCh¬CouÁ
 = 
BufSize
 - 1;

114  
	gCh¬CouÁ
 > 0 )

116 *
	gpBuf
 = 
m_SUFFIX_SEPARATOR
;

117 
	gpBuf
++;

118 
	gCh¬CouÁ
--;

120 *
	gpBuf
 = '\0';

124 
INT64
 
P¬£Suffix
ĞcÚ¡ * 
pSymbŞ
 )

126 
Ch¬CouÁ
( 0 );

127 
INT64
 
MuÉl›r
( 0 );

129 
	gCh¬CouÁ
 = (è
¡¾’
Ğ
pSymbŞ
 );

131 
	gMuÉl›r
 = 
Pow”26Sum
[
Ch¬CouÁ
];

133  
	gCh¬CouÁ
 > 0 )

135 
	gMuÉl›r
 +ğ(
INT64
)
Pow”26
[ 
Ch¬CouÁ
-1 ] *

136 
m_Low”Ca£L‘‹rToIÁM­
[ *
pSymbŞ
 ];

137 
	gCh¬CouÁ
--;

138 
	gpSymbŞ
++;

140 Ğ
	gMuÉl›r
 );

143 
	gpublic
:

147 
CSecur™yFe
(cÚ¡ *
szLi¡Fe
, 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
)

148 : 
CFÏtFe
<
TSecur™yIÅutRow
, 
	gTSecur™yLim™s
>(
	gszLi¡Fe
)

149 , 
m_SymbŞToIdM­IsLßded
Ğ
çl£
 )

151 
TCom·nyLim™s
 
	gCom·nyIÅutFeLim™s
;

153 
	gm_SUFFIX_SEPARATOR
 = '-';

154 
S‘CÚfigu»dSecur™yCouÁ
(
iCÚfigu»dCu¡om”CouÁ
);

155 
S‘AùiveSecur™yCouÁ
(
iAùiveCu¡om”CouÁ
);

157 
	gm_iBa£Com·nyCouÁ
 = 
Com·nyIÅutFeLim™s
.
m_iTÙ®EËm’ts
;

162 
CSecur™yFe
(cÚ¡ 
¡ršg
 &
¡r
, 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
)

163 : 
CFÏtFe
<
TSecur™yIÅutRow
, 
	gTSecur™yLim™s
>(
	g¡r
)

164 , 
m_SymbŞToIdM­IsLßded
Ğ
çl£
 )

166 
TCom·nyLim™s
 
	gCom·nyIÅutFeLim™s
;

168 
	gm_SUFFIX_SEPARATOR
 = '-';

169 
S‘CÚfigu»dSecur™yCouÁ
(
iCÚfigu»dCu¡om”CouÁ
);

170 
S‘AùiveSecur™yCouÁ
(
iAùiveCu¡om”CouÁ
);

172 
	gm_iBa£Com·nyCouÁ
 = 
Com·nyIÅutFeLim™s
.
m_iTÙ®EËm’ts
;

179 
S‘CÚfigu»dSecur™yCouÁ
(
TId’t
 
iCÚfigu»dCu¡om”CouÁ
)

181 
	gm_iCÚfigu»dSecur™yCouÁ
 = 
C®cuÏ‹Secur™yCouÁ
(
iCÚfigu»dCu¡om”CouÁ
);

188 
S‘AùiveSecur™yCouÁ
(
TId’t
 
iAùiveCu¡om”CouÁ
)

190 
	gm_iAùiveSecur™yCouÁ
 = 
C®cuÏ‹Secur™yCouÁ
(
iAùiveCu¡om”CouÁ
);

196 
TId’t
 
C®cuÏ‹Secur™yCouÁ
(TId’ˆ
iCu¡om”CouÁ
)

198  
	giCu¡om”CouÁ
 / 
iDeçuÉLßdUn™Size
 * 
	giOÃLßdUn™Secur™yCouÁ
;

203 
TId’t
 
C®cuÏ‹S¹FromSecur™y
(TId’ˆ
iS¹FromCu¡om”
)

205  
	giS¹FromCu¡om”
 / 
iDeçuÉLßdUn™Size
 * 
	giOÃLßdUn™Secur™yCouÁ
;

213 
C»©eSymbŞ
Ğ
TId’t
 
iIndex
,

214 * 
szOuut
,

215 
size_t
 
iOuutL’
)

217 
TId’t
 
	giFeIndex
 = 
iIndex
 % 
CFÏtFe
<
TSecur™yIÅutRow
, 
	gTSecur™yLim™s
>::
G‘Size
();

218 
TId’t
 
	giAdd
 = 
iIndex
 / 
CFÏtFe
<
TSecur™yIÅutRow
, 
	gTSecur™yLim™s
>::
G‘Size
();

219 
size_t
 
	giNewL’
;

222 
¡ºıy
(
szOuut
, 
G‘RecÜd
(
iFeIndex
)->
S_SYMB
, 
iOuutL’
);

224 
	gszOuut
[
iOuutL’
 - 1] = '\0';

227 ià(
	giAdd
 > 0)

229 
	giNewL’
 = 
¡¾’
Ğ
szOuut
 );

230 
C»©eSuffix
Ğ
iAdd
, &
szOuut
[
iNewL’
], 
iOuutL’
 - iNewLen );

237 
TId’t
 
G‘Com·nyId
(TId’ˆ
iIndex
)

241  
	gm_li¡
[ ()(
iIndex
 % 
m_li¡
.
size
()è].
	gS_CO_ID
 + 
	giTId’tShiá


242 + 
	giIndex
 / 
	gm_li¡
.
size
(è* 
	gm_iBa£Com·nyCouÁ
;

245 
TId’t
 
G‘Com·nyIndex
ĞTId’ˆ
Index
 )

248 Ğ
G‘Com·nyId
Ğ
Index
 ) - 1 - 
	giTId’tShiá
);

254 
TId’t
 
G‘Size
()

256  
	gm_iCÚfigu»dSecur™yCouÁ
;

262 
TId’t
 
G‘CÚfigu»dSecur™yCouÁ
()

264  
	gm_iCÚfigu»dSecur™yCouÁ
;

270 
TId’t
 
G‘AùiveSecur™yCouÁ
()

272  
	gm_iAùiveSecur™yCouÁ
;

278 
TSecur™yIÅutRow
* 
G‘RecÜd
(
TId’t
 
šdex
è{  &
	gm_li¡
[()(šdex % 
m_li¡
.
size
())]; };

281 
boŞ
 
LßdSymbŞToIdM­
( )

283 ifĞ! 
	gm_SymbŞToIdM­IsLßded
 )

285 
	gii
;

287  
	gii
 = 0; i˜< 
	gm_li¡
.
size
(); ii++ )

289 
¡ršg
 
sSymbŞ
Ğ
m_li¡
[
ii
].
S_SYMB
 );

290 
	gm_SymbŞToIdM­
[ 
sSymbŞ
 ] = 
m_li¡
[
ii
].
S_ID
;

292 
	gm_SymbŞToIdM­IsLßded
 = 
Œue
;

294  
	gii
 = 0; i˜< 
	gMaxLow”Ca£L‘‹rs
; ii++ )

296 
	gm_Low”Ca£L‘‹rToIÁM­
[ 
Low”Ca£L‘‹rs
[
ii
] ] = ii;

299 Ğ
	gm_SymbŞToIdM­IsLßded
 );

302 
TId’t
 
G‘Id
Ğ* 
pSymbŞ
 )

304 * 
pS•¬©Ü
Ğ
NULL
 );

306 ifĞ!
	gm_SymbŞToIdM­IsLßded
 )

308 
LßdSymbŞToIdM­
();

310 ifĞ
	gNULL
 =ğĞ
pS•¬©Ü
 = 
¡rchr
Ğ
pSymbŞ
, 
m_SUFFIX_SEPARATOR
 )))

313 
¡ršg
 
sSymbŞ
(
pSymbŞ
);

314 Ğ
	gm_SymbŞToIdM­
[ 
sSymbŞ
 ] );

319 * 
pSuffix
Ğ
NULL
 );

320 
TId’t
 
Ba£Id
( 0 );

321 
TId’t
 
MuÉl›r
( 0 );

323 
¡ršg
 
sSymbŞ
(
pSymbŞ
, 
¡©ic_ÿ¡
<
size_t
>(
pS•¬©Ü
-pSymbol));

324 
	gBa£Id
 = 
m_SymbŞToIdM­
[ 
sSymbŞ
 ];

326 
	gpSuffix
 = 
pS•¬©Ü
 + 1;

327 
	gMuÉl›r
 = ()
P¬£Suffix
Ğ
pSuffix
 );

329 (Ğ
MuÉl›r
 * 
	gm_li¡
.
size
(èè+ 
	gBa£Id
 );

333 
TId’t
 
G‘Index
Ğ* 
pSymbŞ
 )

336 Ğ
G‘Id
Ğ
pSymbŞ
 ) - 1 );

339 
eExchªgeID
 
G‘ExchªgeIndex
Ğ
TId’t
 
šdex
 )

342 *
	gpExchªge
 = 
m_li¡
[()(
šdex
 % m_li¡.
size
())].
S_EX_ID
;

343 
eExchªgeID
 
	geExchªgeIndex
;

345 ià(!
¡rcmp
(
pExchªge
, "NYSE"))

347 
	geExchªgeIndex
 = 
eNYSE
;

349 ià(!
¡rcmp
(
pExchªge
, "NASDAQ"))

351 
	geExchªgeIndex
 = 
eNASDAQ
;

353 ià(!
¡rcmp
(
pExchªge
, "AMEX"))

355 
	geExchªgeIndex
 = 
eAMEX
;

357 ià(!
¡rcmp
(
pExchªge
, "PCX"))

359 
	geExchªgeIndex
 = 
ePCX
;

363 
as£¹
(
çl£
);

366  
	geExchªgeIndex
;

	@include/workload/tpce/egen/SecurityPriceRange.h

41 #iâdeà
SECURITY_PRICE_RANGE_H


42 
	#SECURITY_PRICE_RANGE_H


	)

44 
Çme¥aû
 
	gTPCE


47 cÚ¡ 
	gfMšSecPriû
 = 20.00;

48 cÚ¡ 
	gfMaxSecPriû
 = 30.00;

	@include/workload/tpce/egen/SecurityTable.h

40 #iâdeà
SECURITY_TABLE_H


41 
	#SECURITY_TABLE_H


	)

43 
	~<¡dio.h
>

44 
	~"EG’TabËs_commÚ.h
"

45 
	~"Com·nyFe.h
"

46 
	~"Secur™yFe.h
"

47 
	~"Secur™yPriûRªge.h
"

49 
Çme¥aû
 
	gTPCE


52 cÚ¡ 
INT64
 
	giS_NUM_OUTMš
 = 
INT64_CONST
(4000000);

53 cÚ¡ 
INT64
 
	giS_NUM_OUTMax
 = 
INT64_CONST
(9500000000);

55 cÚ¡ 
	gfS_PEMš
 = 1.0;

56 cÚ¡ 
	gfS_PEMax
 = 120.0;

58 cÚ¡ 
	gfS_DIVIDNÚZ”oMš
 = 0.01;

59 cÚ¡ 
	gfS_DIVIDMax
 = 10.0;

61 cÚ¡ 
	gfS_YIELDNÚZ”oMš
 = 0.01;

62 cÚ¡ 
	gfS_YIELDMax
 = 120.0;

64 cÚ¡ 
	giW“ksP”Y—r
 = 52;

65 cÚ¡ 
	giDaysP”W“k
 = 7;

67 cÚ¡ 
	giP”ûÁCom·n›sW™hNÚZ”oDivid’d
 = 60;

69 cÚ¡ 
	giRNGSkOÃRowSecur™y
 = 11;

71 
şass
 
	gCSecur™yTabË
 : 
public
 
TabËTem¶©e
<
SECURITY_ROW
>

73 
TId’t
 
m_iSecur™yCouÁ
;

74 
TId’t
 
	gm_iS¹FromSecur™y
;

75 
CCom·nyFe
* 
	gm_Com·nyFe
;

76 
CSecur™yFe
* 
	gm_Secur™yFe
;

77 
CD©eTime
 
	gm_d©e
;

78 
	gm_iCu¼’tDayNo
;

79 
	gm_iJª1_1900DayNo
;

80 
	gm_iJª2_2000DayNo
;

81 
TId’t
 
	gm_iSecur™yCouÁFÜOÃLßdUn™
;

86 
G’”©eSecur™yRow
()

88 
	giS¹DayNo
, 
	giExchªgeDayNo
, 
	gi52HighDayNo
, 
	gi52LowDayNo
;

90 
¡ºıy
(
m_row
.
S_ST_ID
, 
m_Secur™yFe
->
G‘RecÜd
(
m_iLa¡RowNumb”
)->S_ST_ID, (m_row.S_ST_ID));

91 
¡ºıy
(
m_row
.
S_ISSUE
, 
m_Secur™yFe
->
G‘RecÜd
(
m_iLa¡RowNumb”
)->S_ISSUE, (m_row.S_ISSUE));

93 
C»©eName
(
m_iLa¡RowNumb”
, 
m_row
.
S_NAME
, 
¡©ic_ÿ¡
<>((m_row.S_NAME)));

95 
	gm_Secur™yFe
->
C»©eSymbŞ
(
m_iLa¡RowNumb”
, 
m_row
.
S_SYMB
, 
¡©ic_ÿ¡
<>((m_row.S_SYMB)));

96 
¡ºıy
(
m_row
.
S_EX_ID
, 
m_Secur™yFe
->
G‘RecÜd
(
m_iLa¡RowNumb”
)->S_EX_ID, (m_row.S_EX_ID));

97 
	gm_row
.
	gS_CO_ID
 = 
m_Secur™yFe
->
G‘Com·nyId
(
m_iLa¡RowNumb”
);

98 
	gm_row
.
	gS_NUM_OUT
 = 
m_ºd
.
RndIÁ64Rªge
(
iS_NUM_OUTMš
, 
iS_NUM_OUTMax
);

100 
	giS¹DayNo
 = 
m_ºd
.
RndIÁRªge
(
m_iJª1_1900DayNo
, 
m_iJª2_2000DayNo
);

101 
	gm_row
.
	gS_START_DATE
.
S‘
(
iS¹DayNo
);

102 
	giExchªgeDayNo
 = 
m_ºd
.
RndIÁRªge
(
iS¹DayNo
, 
m_iJª2_2000DayNo
);

103 
	gm_row
.
	gS_EXCH_DATE
.
S‘
(
iExchªgeDayNo
);

104 
	gm_row
.
	gS_PE
 = 
m_ºd
.
RndDoubËInüRªge
(
fS_PEMš
, 
fS_PEMax
, 0.01);

108 
	gm_row
.
	gS_52WK_HIGH
 = ()
m_ºd
.
RndDoubËInüRªge
Ğ
fMšSecPriû
 + (Ğ
fMaxSecPriû
 - fMinSecPrice) / 2 ), fMaxSecPrice, 0.01);

109 
	gi52HighDayNo
 = 
m_ºd
.
RndIÁRªge
(
m_iCu¼’tDayNo
 - 
iDaysP”W“k
 * 
iW“ksP”Y—r
, m_iCurrentDayNo);

110 
	gm_row
.
	gS_52WK_HIGH_DATE
.
S‘
(
i52HighDayNo
);

113 
	gm_row
.
	gS_52WK_LOW
 = ()
m_ºd
.
RndDoubËInüRªge
Ğ
fMšSecPriû
, 
m_row
.
S_52WK_HIGH
, 0.01 );

114 
	gi52LowDayNo
 = 
m_ºd
.
RndIÁRªge
(
m_iCu¼’tDayNo
 - 
iDaysP”W“k
 * 
iW“ksP”Y—r
, m_iCurrentDayNo);

115 
	gm_row
.
	gS_52WK_LOW_DATE
.
S‘
(
i52LowDayNo
);

117 ià(
	gm_ºd
.
RndP”ûÁ
Ğ
iP”ûÁCom·n›sW™hNÚZ”oDivid’d
 ))

119 
	gm_row
.
	gS_YIELD
 = 
m_ºd
.
RndDoubËInüRªge
(
fS_YIELDNÚZ”oMš
, 
fS_YIELDMax
, 0.01);

120 
	gm_row
.
	gS_DIVIDEND
 = 
m_ºd
.
RndDoubËInüRªge
(Ğ
m_row
.
S_YIELD
 * 0.20 ), ( m_row.S_YIELD * 0.30 ), 0.01);

124 
	gm_row
.
	gS_DIVIDEND
 = 0.0;

125 
	gm_row
.
	gS_YIELD
 = 0.0;

138 
In™NextLßdUn™
()

140 
	gm_ºd
.
S‘S“d
(
m_ºd
.
RndNthEËm’t
(
RNGS“dTabËDeçuÉ
,

141 (
RNGSEED
)
m_iLa¡RowNumb”
 * 
iRNGSkOÃRowSecur™y
));

143 
CË¬RecÜd
();

146 
	gpublic
:

147 
CSecur™yTabË
Ğ
CIÅutFes
 
šputFes
,

148 
TId’t
 
iCu¡om”CouÁ
,

149 
TId’t
 
iS¹FromCu¡om”
)

150 : 
TabËTem¶©e
<
SECURITY_ROW
>()

151 , 
m_Com·nyFe
(
šputFes
.
Com·ny
)

152 , 
m_Secur™yFe
(
šputFes
.
Secur™›s
)

154 
	gm_iCu¼’tDayNo
 = 
CD©eTime
::
YMDtoDayno
(
In™ŸlT¿dePİuÏtiÚBa£Y—r
,

155 
In™ŸlT¿dePİuÏtiÚBa£MÚth
,

156 
In™ŸlT¿dePİuÏtiÚBa£Day
);

157 
	gm_iJª1_1900DayNo
 = 
CD©eTime
::
YMDtoDayno
(1900, 1, 1);

158 
	gm_iJª2_2000DayNo
 = 
CD©eTime
::
YMDtoDayno
(2000, 1, 2);

160 
	gm_iSecur™yCouÁ
 = 
m_Secur™yFe
->
C®cuÏ‹Secur™yCouÁ
(
iCu¡om”CouÁ
);

161 
	gm_iS¹FromSecur™y
 = 
m_Secur™yFe
->
C®cuÏ‹S¹FromSecur™y
(
iS¹FromCu¡om”
);

163 
	gm_iSecur™yCouÁFÜOÃLßdUn™
 = 
šputFes
.
Secur™›s
->
C®cuÏ‹Secur™yCouÁ
(
iDeçuÉLßdUn™Size
);

165 
	gm_iLa¡RowNumb”
 = 
m_iS¹FromSecur™y
;

168 
boŞ
 
G’”©eNextRecÜd
()

172 ià(
	gm_iLa¡RowNumb”
 % 
	gm_iSecur™yCouÁFÜOÃLßdUn™
 == 0)

174 
In™NextLßdUn™
();

177 
G’”©eSecur™yRow
();

179 ++
	gm_iLa¡RowNumb”
;

182 
	gm_bMÜeRecÜds
 = 
m_iLa¡RowNumb”
 < (
m_iS¹FromSecur™y
 + 
m_iSecur™yCouÁ
);

184  (
MÜeRecÜds
());

187 
C»©eName
Ğ
TId’t
 
iIndex
,

188 * 
szOuut
,

189 
size_t
 
iOuutL’
)

191 
	gCom·nyName
[
cCO_NAME_Ën
+1];

193 
	gm_Com·nyFe
->
C»©eName
Ğ
m_Secur™yFe
->
G‘Com·nyIndex
Ğ
iIndex
 ), 
Com·nyName
, 
¡©ic_ÿ¡
<>(( CompanyName )));

194 
¢´štf
Ğ
szOuut
, 
iOuutL’
, "% oà%s", 
m_Secur™yFe
->
G‘RecÜd
(
iIndex
)->
S_ISSUE
, 
Com·nyName
 );

	@include/workload/tpce/egen/StatusTypeTable.h

40 #iâdeà
STATUS_TYPE_H


41 
	#STATUS_TYPE_H


	)

43 
	~"EG’TabËs_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCStusTy³TabË
 : 
public
 
TabËTem¶©e
<
STATUS_TYPE_ROW
>

50 
if¡»am
 
InFe
;

52 
	gpublic
:

53 
CStusTy³TabË
Ğ*
szDœName
 )

54 : 
TabËTem¶©e
<
STATUS_TYPE_ROW
>()

56 
szFeName
[
iMaxP©h
];

58 
¡ºıy
(
szFeName
, 
szDœName
, (szFileName));

59 
¡ºÿt
(
szFeName
, "StusTy³.txt", (szFeNameè- 
¡¾’
(
szDœName
) - 1);

61 
	gInFe
.
İ’
Ğ
szFeName
 );

64 ~
CStusTy³TabË
( )

66 
	gInFe
.
şo£
();

72 
boŞ
 
G’”©eNextRecÜd
()

74 ifĞ
	gInFe
.
good
() )

76 
	gm_row
.
Lßd
(
InFe
);

79  ( 
	gInFe
.
eof
() );

	@include/workload/tpce/egen/SyncLockInterface.h

37 #iâdeà
SYNCLOCK_H


38 
	#SYNCLOCK_H


	)

40 
	~<±h»ad.h
>

46 
Çme¥aû
 
	gTPCE


49 şas 
	cCSyncLock


51 
±h»ad_mu‹x_t
 
	gmu‹x
;

52 
	gpublic
:

53 
CSyncLock
() {

54 
±h»ad_mu‹x_š™
(&
mu‹x
, 
NULL
);

56 ~
CSyncLock
() {

57 
±h»ad_mu‹x_de¡roy
(&
mu‹x
);

61 
CÏimLock
() {

62 
±h»ad_mu‹x_lock
(&
mu‹x
);

66 
R–—£Lock
() {

67 
±h»ad_mu‹x_uÆock
(&
mu‹x
);

	@include/workload/tpce/egen/TableConsts.h

41 #iâdeà
TABLE_CONSTS_H


42 
	#TABLE_CONSTS_H


	)

44 
	~"EG’Snd¬dTy³s.h
"

46 
Çme¥aû
 
	gTPCE


50 cÚ¡ 
	gcTOWN_Ën
 = 80;

51 cÚ¡ 
	gcDIV_Ën
 = 80;

52 cÚ¡ 
	gcCODE_Ën
 = 12;

55 cÚ¡ 
	gcACL_Ën
 = 4;

58 cÚ¡ 
	gcAD_NAME_Ën
 = 80;

59 cÚ¡ 
	gcAD_LINE_Ën
 = 80;

60 cÚ¡ 
	gcAD_TOWN_Ën
 = 
cTOWN_Ën
;

61 cÚ¡ 
	gcAD_DIV_Ën
 = 
cDIV_Ën
;

62 cÚ¡ 
	gcAD_ZIP_Ën
 = 
cCODE_Ën
;

63 cÚ¡ 
	gcAD_CTRY_Ën
 = 80;

66 cÚ¡ 
	gcCT_NAME_Ën
 = 100;

69 cÚ¡ 
	gcL_NAME_Ën
 = 25;

70 cÚ¡ 
	gcF_NAME_Ën
 = 20;

71 cÚ¡ 
	gcM_NAME_Ën
 = 1;

72 cÚ¡ 
	gcDOB_Ën
 = 30;

73 cÚ¡ 
	gcTAX_ID_Ën
 = 20;

74 cÚ¡ 
	gcGNDR_Ën
 = 1;

75 cÚ¡ 
	gcCTRY_Ën
 = 3;

76 cÚ¡ 
	gcAREA_Ën
 = 3;

77 cÚ¡ 
	gcLOCAL_Ën
 = 10;

78 cÚ¡ 
	gcEXT_Ën
 = 5;

79 cÚ¡ 
	gcEMAIL_Ën
 = 50;

82 cÚ¡ 
	gcB_NAME_Ën
 = 
cF_NAME_Ën
 + 
cM_NAME_Ën
 + 
cL_NAME_Ën
 + 3;

85 cÚ¡ 
	gcCO_NAME_Ën
 = 60;

86 cÚ¡ 
	gcSP_RATE_Ën
 = 4;

87 cÚ¡ 
	gcCEO_NAME_Ën
 = 
cF_NAME_Ën
 + 
cL_NAME_Ën
 + 1;

88 cÚ¡ 
	gcCO_DESC_Ën
 = 150;

89 cÚ¡ 
	gcCO_SP_RATE_Ën
 = 4;

92 cÚ¡ 
	gcCA_NAME_Ën
 = 50;

95 cÚ¡ 
	gcEX_ID_Ën
 = 6;

96 cÚ¡ 
	gcEX_NAME_Ën
 = 100;

97 cÚ¡ 
	gcEX_DESC_Ën
 = 150;

102 cÚ¡ 
	gcH_BUY_DTS_Ën
 = 30;

105 cÚ¡ 
	gcIN_ID_Ën
 = 2;

106 cÚ¡ 
	gcIN_NAME_Ën
 = 50;

109 cÚ¡ 
	gcNI_HEADLINE_Ën
 = 80;

110 cÚ¡ 
	gcNI_SUMMARY_Ën
 = 255;

111 cÚ¡ 
	gcNI_ITEM_Ën
 = 100 * 1000;

112 cÚ¡ 
	gcNI_SOURCE_Ën
 = 30;

113 cÚ¡ 
	gcNI_AUTHOR_Ën
 = 30;

116 cÚ¡ 
	gcS_NAME_Ën
 = 70;

117 cÚ¡ 
	gcSYMBOL_Ën
 = 7 + 1 + 7;

118 cÚ¡ 
	gcS_ISSUE_Ën
 = 6;

121 cÚ¡ 
	gcSE_CASH_TYPE_Ën
 = 40;

124 cÚ¡ 
	gcSC_NAME_Ën
 = 30;

125 cÚ¡ 
	gcSC_ID_Ën
 = 2;

128 cÚ¡ 
	gcST_ID_Ën
 = 4;

129 cÚ¡ 
	gcST_NAME_Ën
 = 10;

132 cÚ¡ 
	gcTX_ID_Ën
 = 4;

133 cÚ¡ 
	gcTX_NAME_Ën
 = 50;

136 cÚ¡ 
	gcEXEC_NAME_Ën
 = 
cF_NAME_Ën
 + 
cM_NAME_Ën
 + 
cL_NAME_Ën
 + 3;

139 cÚ¡ 
	gcTH_ST_ID_Ën
 = 
cST_ID_Ën
;

142 cÚ¡ 
	gcTT_ID_Ën
 = 3;

143 cÚ¡ 
	gcTT_NAME_Ën
 = 12;

146 cÚ¡ 
	gcZC_TOWN_Ën
 = 
cTOWN_Ën
;

147 cÚ¡ 
	gcZC_DIV_Ën
 = 
cDIV_Ën
;

148 cÚ¡ 
	gcZC_CODE_Ën
 = 
cCODE_Ën
;

	@include/workload/tpce/egen/TableTemplate.h

41 #iâdeà
TABLE_TEMPLATE_H


42 
	#TABLE_TEMPLATE_H


	)

44 
	~"EG’Snd¬dTy³s.h
"

45 
	~"Rªdom.h
"

46 
	~"RNGS“ds.h
"

48 
Çme¥aû
 
	gTPCE


51 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

52 şas 
	cTabËTem¶©e


54 
	g´Ùeùed
:

55 
T
 
m_row
;

56 
TId’t
 
	gm_iLa¡RowNumb”
;

57 
boŞ
 
	gm_bMÜeRecÜds
;

58 
CRªdom
 
	gm_ºd
;

59 
	gpublic
:

69 
TabËTem¶©e
()

70 : 
m_iLa¡RowNumb”
(0)

71 , 
m_bMÜeRecÜds
(
çl£
)

73 
CË¬RecÜd
();

75 
	gm_ºd
.
S‘S“d
(
RNGS“dTabËDeçuÉ
);

88 
	gvœtu®
 ~
TabËTem¶©e
() {};

100 
vœtu®
 
boŞ
 
G’”©eNextRecÜd
() = 0;

112 
boŞ
 
MÜeRecÜds
(è{ 
	gm_bMÜeRecÜds
;}

123 
T
 cÚ¡ * 
G‘Row
(è{  &
	gm_row
; }

141 
CË¬RecÜd
(è{ 
mem£t
(&
m_row
, 0, (m_row)); }

	@include/workload/tpce/egen/Table_Defs.h

41 #iâdeà
TABLE_DEFS_H


42 
	#TABLE_DEFS_H


	)

44 
	~<io¡»am
>

45 
	~"EG’Snd¬dTy³s.h
"

46 
	~"TabËCÚ¡s.h
"

47 
	~"D©eTime.h
"

49 
usšg
 
Çme¥aû
 
	g¡d
;

51 
Çme¥aû
 
	gTPCE


56 
	sTBa£IÅutRow


58 
Lßd
(
i¡»am
 &
fe
);

59 
	gvœtu®
 ~
TBa£IÅutRow
() {}

60 } *
	tPBa£IÅutRow
;

63 
	sACCOUNT_PERMISSION_ROW


65 
TId’t
 
	gAP_CA_ID
;

66 
	gAP_ACL
[ 
cACL_Ën
+1 ];

67 
	gAP_TAX_ID
[ 
cTAX_ID_Ën
+1 ];

68 
	gAP_L_NAME
[ 
cL_NAME_Ën
+1 ];

69 
	gAP_F_NAME
[ 
cF_NAME_Ën
+1 ];

70 } *
	tPACCOUNT_PERMISSION_ROW
;

71 cÚ¡ 
	gAccouÁP”missiÚRowFmt
[] = "%" 
PRId64
 "|%s|%s|%s|%s\n";

74 
	sADDRESS_ROW


76 
TId’t
 
	gAD_ID
;

77 
	gAD_LINE1
[ 
cAD_LINE_Ën
+1];

78 
	gAD_LINE2
[ 
cAD_LINE_Ën
+1];

79 
	gAD_ZC_CODE
[ 
cAD_ZIP_Ën
+1 ];

80 
	gAD_CTRY
[ 
cAD_CTRY_Ën
+1 ];

81 } *
	tPADDRESS_ROW
;

82 cÚ¡ 
	gAdd»ssRowFmt
[] = "%" 
PRId64
 "|%s|%s|%s|%s\n";

85 
	sBROKER_ROW


87 
TId’t
 
	gB_ID
;

88 
	gB_ST_ID
[ 
cST_ID_Ën
+1 ];

89 
	gB_NAME
[ 
cB_NAME_Ën
+1 ];

90 
	gB_NUM_TRADES
;

91 
	gB_COMM_TOTAL
;

92 } *
	tPBROKER_ROW
;

93 cÚ¡ 
	gBrok”RowFmt
[] = "%" 
PRId64
 "|%s|%s|%d|%.2f\n";

96 
	sCASH_TRANSACTION_ROW


98 
TT¿de
 
	gCT_T_ID
;

99 
CD©eTime
 
	gCT_DTS
;

100 
	gCT_AMT
;

101 
	gCT_NAME
[
cCT_NAME_Ën
+1];

102 } *
	tPCASH_TRANSACTION_ROW
;

103 cÚ¡ 
	gCashT¿n§ùiÚRowFmt
[] = "%" 
PRId64
 "|%s|%.2f|%s\n";

106 
	gCHARGE_ROW
 : 
	tpublic
 
	tTBa£IÅutRow


108 
CH_TT_ID
[
cTT_ID_Ën
+1];

109 
	gCH_C_TIER
;

110 
	gCH_CHRG
;

112 
Lßd
(
i¡»am
 &
fe
);

113 } *
	tPCHARGE_ROW
;

114 cÚ¡ 
	gCh¬geRowFmt
[] = "%s|%d|%.2f\n";

117 
	gCOMMISSION_RATE_ROW
 : 
	tpublic
 
	tTBa£IÅutRow


119 
CR_C_TIER
;

120 
	gCR_TT_ID
[
cTT_ID_Ën
+1];

121 
	gCR_EX_ID
[
cEX_ID_Ën
+1];

122 
	gCR_FROM_QTY
;

123 
	gCR_TO_QTY
;

124 
	gCR_RATE
;

126 
Lßd
(
i¡»am
 &
fe
);

127 } *
	tPCOMMISSION_RATE_ROW
;

128 cÚ¡ 
	gCommissiÚR©eRowFmt
[] = "%d|%s|%s|%.0f|%.0f|%.2f\n";

131 
	sCOMPANY_ROW


133 
TId’t
 
	gCO_ID
;

134 
	gCO_ST_ID
[ 
cST_ID_Ën
+1 ];

135 
	gCO_NAME
[ 
cCO_NAME_Ën
+1 ];

136 
	gCO_IN_ID
[ 
cIN_ID_Ën
+1 ];

137 
	gCO_SP_RATE
[ 
cSP_RATE_Ën
+1 ];

138 
	gCO_CEO
[ 
cCEO_NAME_Ën
+1 ];

139 
TId’t
 
	gCO_AD_ID
;

140 
	gCO_DESC
[ 
cCO_DESC_Ën
+1 ];

141 
CD©eTime
 
	gCO_OPEN_DATE
;

142 } *
	tPCOMPANY_ROW
;

143 cÚ¡ 
	gCom·nyRowFmt
[] = "%" 
PRId64
 "|%s|%s|%s|%s|%s|%" PRId64 "|%s|%s\n";

146 
	gCOMPANY_COMPETITOR_ROW
 : 
	tpublic
 
	tTBa£IÅutRow


148 
TId’t
 
CP_CO_ID
;

149 
TId’t
 
	gCP_COMP_CO_ID
;

150 
	gCP_IN_ID
[
cIN_ID_Ën
+1];

151 } *
	tPCOMPANY_COMPETITOR_ROW
;

152 cÚ¡ 
	gCom·nyCom³t™ÜRowFmt
[] = "%" 
PRId64
 "|%" PRId64 "|%s\n";

155 
	sCUSTOMER_ROW


157 
TId’t
 
	gC_ID
;

158 
	gC_TAX_ID
[ 
cTAX_ID_Ën
+1 ];

159 
	gC_ST_ID
[ 
cST_ID_Ën
+1 ];

160 
	gC_L_NAME
[ 
cL_NAME_Ën
+1 ];

161 
	gC_F_NAME
[ 
cF_NAME_Ën
+1 ];

162 
	gC_M_NAME
[ 
cM_NAME_Ën
+1 ];

163 
	gC_GNDR
;

164 
	gC_TIER
;

165 
CD©eTime
 
	gC_DOB
;

166 
TId’t
 
	gC_AD_ID
;

167 
	gC_CTRY_1
[ 
cCTRY_Ën
+1 ];

168 
	gC_AREA_1
[ 
cAREA_Ën
+1 ];

169 
	gC_LOCAL_1
[ 
cLOCAL_Ën
+1 ];

170 
	gC_EXT_1
[ 
cEXT_Ën
+1 ];

171 
	gC_CTRY_2
[ 
cCTRY_Ën
+1 ];

172 
	gC_AREA_2
[ 
cAREA_Ën
+1 ];

173 
	gC_LOCAL_2
[ 
cLOCAL_Ën
+1 ];

174 
	gC_EXT_2
[ 
cEXT_Ën
+1 ];

175 
	gC_CTRY_3
[ 
cCTRY_Ën
+1 ];

176 
	gC_AREA_3
[ 
cAREA_Ën
+1 ];

177 
	gC_LOCAL_3
[ 
cLOCAL_Ën
+1 ];

178 
	gC_EXT_3
[ 
cEXT_Ën
+1 ];

179 
	gC_EMAIL_1
[ 
cEMAIL_Ën
+1 ];

180 
	gC_EMAIL_2
[ 
cEMAIL_Ën
+1 ];

182 
CUSTOMER_ROW
()

183 : 
C_ID
(0)

186 } *
	tPCUSTOMER_ROW
;

187 cÚ¡ 
	gCu¡om”RowFmt
[] = "%" 
PRId64
 "|%s|%s|%s|%s|%s|%c|%d|%s|%" PRId64 "|%s|%s|%s|%s|%s|%s|%s|%s|%s|%s|%s|%s|%s|%s\n";

190 
	sCUSTOMER_ACCOUNT_ROW


192 
TId’t
 
	gCA_ID
;

193 
TId’t
 
	gCA_B_ID
;

194 
TId’t
 
	gCA_C_ID
;

195 
	gCA_NAME
[ 
cCA_NAME_Ën
+1 ];

196 
	gCA_TAX_ST
;

197 
	gCA_BAL
;

198 } *
	tPCUSTOMER_ACCOUNT_ROW
;

199 cÚ¡ 
	gCu¡om”AccouÁRowFmt
[] = "%" 
PRId64
 "|%" PRId64 "|%" PRId64 "|%s|%d|%.2f\n";

202 
	sCUSTOMER_TAXRATE_ROW


204 
	gCX_TX_ID
[ 
cTX_ID_Ën
+1 ];

205 
TId’t
 
	gCX_C_ID
;

206 } *
	tPCUSTOMER_TAXRATE_ROW
;

207 cÚ¡ 
	gCu¡om”Tax¿‹RowFmt
[] = "%s|%" 
PRId64
 "\n";

210 
	sDAILY_MARKET_ROW


212 
CD©eTime
 
	gDM_DATE
;

213 
	gDM_S_SYMB
[
cSYMBOL_Ën
+1];

214 
	gDM_CLOSE
;

215 
	gDM_HIGH
;

216 
	gDM_LOW
;

217 
INT64
 
	gDM_VOL
;

218 } *
	tPDAILY_MARKET_ROW
;

219 cÚ¡ 
	gDayM¬k‘RowFmt
[] = "%s|%s|%.2f|%.2f|%.2f|%" 
PRId64
 "\n";

222 
	sEXCHANGE_ROW


224 
	gEX_ID
[ 
cEX_ID_Ën
+1 ];

225 
	gEX_NAME
[ 
cEX_NAME_Ën
+1 ];

226 
	gEX_NUM_SYMB
;

227 
	gEX_OPEN
;

228 
	gEX_CLOSE
;

229 
	gEX_DESC
[ 
cEX_DESC_Ën
+1 ];

230 
TId’t
 
	gEX_AD_ID
;

232 
Lßd
(
i¡»am
 &
fe
);

233 } *
	tPEXCHANGE_ROW
;

234 cÚ¡ 
	gExchªgeRowFmt
[] = "%s|%s|%d|%d|%d|%s|%" 
PRId64
 "\n";

237 
	sFINANCIAL_ROW


239 
TId’t
 
	gFI_CO_ID
;

240 
	gFI_YEAR
;

241 
	gFI_QTR
;

242 
CD©eTime
 
	gFI_QTR_START_DATE
;

243 
	gFI_REVENUE
;

244 
	gFI_NET_EARN
;

245 
	gFI_BASIC_EPS
;

246 
	gFI_DILUT_EPS
;

247 
	gFI_MARGIN
;

248 
	gFI_INVENTORY
;

249 
	gFI_ASSETS
;

250 
	gFI_LIABILITY
;

251 
INT64
 
	gFI_OUT_BASIC
;

252 
INT64
 
	gFI_OUT_DILUT
;

253 } *
	tPFINANCIAL_ROW
;

254 cÚ¡ 
	gFšªcŸlRowFmt
[] = "%" 
PRId64
 "|%d|%d|%s|%.2f|%.2f|%.2f|%.2f|%.2f|%.2f|%.2f|%.2f|%" PRId64 "|%" PRId64 "\n";

257 
	sHOLDING_ROW


259 
TT¿de
 
	gH_T_ID
;

260 
TId’t
 
	gH_CA_ID
;

261 
	gH_S_SYMB
[ 
cSYMBOL_Ën
+1 ];

262 
CD©eTime
 
	gH_DTS
;

263 
	gH_PRICE
;

264 
	gH_QTY
;

265 } *
	tPHOLDING_ROW
;

266 cÚ¡ 
	gHŞdšgRowFmt
[] = "%" 
PRId64
 "|%" PRId64 "|%s|%s|%.2f|%d\n";

269 
	sHOLDING_HISTORY_ROW


271 
TT¿de
 
	gHH_H_T_ID
;

272 
TT¿de
 
	gHH_T_ID
;

273 
	gHH_BEFORE_QTY
;

274 
	gHH_AFTER_QTY
;

275 } *
	tPHOLDING_HISTORY_ROW
;

276 cÚ¡ 
	gHŞdšgHi¡ÜyRowFmt
[] = "%" 
PRId64
 "|%" PRId64 "|%d|%d\n";

279 
	sHOLDING_SUMMARY_ROW


281 
TId’t
 
	gHS_CA_ID
;

282 
	gHS_S_SYMB
[ 
cSYMBOL_Ën
+1 ];

283 
	gHS_QTY
;

284 } *
	tPHOLDING_SUMMARY_ROW
;

285 cÚ¡ 
	gHŞdšgSumm¬yRowFmt
[] = "%" 
PRId64
 "|%s|%d\n";

288 
	gINDUSTRY_ROW
 : 
	tpublic
 
	tTBa£IÅutRow


290 
IN_ID
[
cIN_ID_Ën
+1];

291 
	gIN_NAME
[
cIN_NAME_Ën
+1];

292 
	gIN_SC_ID
[
cSC_ID_Ën
+1];

294 
Lßd
(
i¡»am
 &
fe
);

295 } *
	tPINDUSTRY_ROW
;

296 cÚ¡ 
	gIndu¡ryRowFmt
[] = "%s|%s|%s\n";

299 
	sLAST_TRADE_ROW


301 
	gLT_S_SYMB
[
cSYMBOL_Ën
+1];

302 
CD©eTime
 
	gLT_DTS
;

303 
	gLT_PRICE
;

304 
	gLT_OPEN_PRICE
;

305 
INT64
 
	gLT_VOL
;

306 } *
	tPLAST_TRADE_ROW
;

307 cÚ¡ 
	gLa¡T¿deRowFmt
[] = "%s|%s|%.2f|%.2f|%" 
PRId64
 "\n";

310 
	sNEWS_ITEM_ROW


312 
TId’t
 
	gNI_ID
;

313 
	gNI_HEADLINE
[
cNI_HEADLINE_Ën
+1];

314 
	gNI_SUMMARY
[
cNI_SUMMARY_Ën
+1];

315 
	gNI_ITEM
[
cNI_ITEM_Ën
+1];

316 
CD©eTime
 
	gNI_DTS
;

317 
	gNI_SOURCE
[
cNI_SOURCE_Ën
+1];

318 
	gNI_AUTHOR
[
cNI_AUTHOR_Ën
+1];

319 } *
	tPNEWS_ITEM_ROW
;

320 cÚ¡ 
	gNewsI‹mRowFmt
[] = "%" 
PRId64
 "|%s|%s|%s|%s|%s|%s\n";

323 
	sNEWS_XREF_ROW


325 
TId’t
 
	gNX_NI_ID
;

326 
TId’t
 
	gNX_CO_ID
;

327 } *
	tPNEWS_XREF_ROW
;

328 cÚ¡ 
	gNewsXRefRowFmt
[] = "%" 
PRId64
 "|%" PRId64 "\n";

331 
	gSECTOR_ROW
 : 
	tpublic
 
	tTBa£IÅutRow


333 
SC_ID
[
cSC_ID_Ën
+1];

334 
	gSC_NAME
[
cSC_NAME_Ën
+1];

336 
Lßd
(
i¡»am
 &
fe
);

337 } *
	tPSECTOR_ROW
;

338 cÚ¡ 
	gSeùÜRowFmt
[] = "%s|%s\n";

341 
	sSECURITY_ROW


343 
	gS_SYMB
[ 
cSYMBOL_Ën
+1 ];

344 
	gS_ISSUE
[ 
cS_ISSUE_Ën
+1 ];

345 
	gS_ST_ID
[ 
cST_ID_Ën
+1 ];

346 
	gS_NAME
[ 
cS_NAME_Ën
+1 ];

347 
	gS_EX_ID
[ 
cEX_ID_Ën
+1 ];

348 
TId’t
 
	gS_CO_ID
;

349 
INT64
 
	gS_NUM_OUT
;

350 
CD©eTime
 
	gS_START_DATE
;

351 
CD©eTime
 
	gS_EXCH_DATE
;

352 
	gS_PE
;

353 
	gS_52WK_HIGH
;

354 
CD©eTime
 
	gS_52WK_HIGH_DATE
;

355 
	gS_52WK_LOW
;

356 
CD©eTime
 
	gS_52WK_LOW_DATE
;

357 
	gS_DIVIDEND
;

358 
	gS_YIELD
;

359 } *
	tPSECURITY_ROW
;

360 cÚ¡ 
	gSecur™yRowFmt
[] = "%s|%s|%s|%s|%s|%" 
PRId64
 "|%" PRId64 "|%s|%s|%.2f|%.2f|%s|%.2f|%s|%.2f|%.2f\n";

363 
	sSETTLEMENT_ROW


365 
TT¿de
 
	gSE_T_ID
;

366 
	gSE_CASH_TYPE
[
cSE_CASH_TYPE_Ën
+1];

367 
CD©eTime
 
	gSE_CASH_DUE_DATE
;

368 
	gSE_AMT
;

369 } *
	tPSETTLEMENT_ROW
;

370 cÚ¡ 
	gS‘em’tRowFmt
[] = "%" 
PRId64
 "|%s|%s|%.2f\n";

373 
	gSTATUS_TYPE_ROW
 : 
	tpublic
 
	tTBa£IÅutRow


375 
ST_ID
[
cST_ID_Ën
+1];

376 
	gST_NAME
[
cST_NAME_Ën
+1];

378 
Lßd
(
i¡»am
 &
fe
);

379 } *
	tPSTATUS_TYPE_ROW
;

380 cÚ¡ 
	gStusTy³RowFmt
[] = "%s|%s\n";

383 
	sTAXRATE_ROW


385 
	gTX_ID
[ 
cTX_ID_Ën
+1 ];

386 
	gTX_NAME
[ 
cTX_NAME_Ën
+1 ];

387 
	gTX_RATE
;

388 } *
	tPTAXRATE_ROW
;

389 cÚ¡ 
	gTax¿‹RowFmt
[] = "%s|%s|%.5f\n";

392 
	sTRADE_ROW


394 
TT¿de
 
	gT_ID
;

395 
CD©eTime
 
	gT_DTS
;

396 
	gT_ST_ID
[ 
cST_ID_Ën
+1 ];

397 
	gT_TT_ID
[ 
cTT_ID_Ën
+1 ];

398 
boŞ
 
	gT_IS_CASH
;

399 
	gT_S_SYMB
[ 
cSYMBOL_Ën
+1 ];

400 
	gT_QTY
;

401 
	gT_BID_PRICE
;

402 
TId’t
 
	gT_CA_ID
;

403 
	gT_EXEC_NAME
[ 
cEXEC_NAME_Ën
+1 ];

404 
	gT_TRADE_PRICE
;

405 
	gT_CHRG
;

406 
	gT_COMM
;

407 
	gT_TAX
;

408 
boŞ
 
	gT_LIFO
;

409 } *
	tPTRADE_ROW
;

410 cÚ¡ 
	gT¿deRowFmt
[] = "%" 
PRId64
 "|%s|%s|%s|%s|%s|%d|%.2f|%" PRId64 "|%s|%.2f|%.2f|%.2f|%.2f|%s\n";

413 
	sTRADE_HISTORY_ROW


415 
TT¿de
 
	gTH_T_ID
;

416 
CD©eTime
 
	gTH_DTS
;

417 
	gTH_ST_ID
[
cST_ID_Ën
+1];

418 } *
	tPTRADE_HISTORY_ROW
;

419 cÚ¡ 
	gT¿deHi¡ÜyRowFmt
[] = "%" 
PRId64
 "|%s|%s\n";

422 
	sTRADE_REQUEST_ROW


424 
TT¿de
 
	gTR_T_ID
;

425 
	gTR_TT_ID
[ 
cTT_ID_Ën
+1 ];

426 
	gTR_S_SYMB
[ 
cSYMBOL_Ën
+1 ];

427 
	gTR_QTY
;

428 
	gTR_BID_PRICE
;

429 
TId’t
 
	gTR_B_ID
;

430 } *
	tPTRADE_REQUEST_ROW
;

431 cÚ¡ 
	gT¿deReque¡RowFmt
[] = "%" 
PRId64
 "|%s|%s|%d|%.2f|%" PRId64 "\n";

434 
	sTRADE_TYPE_ROW


436 
	gTT_ID
[ 
cTT_ID_Ën
+1 ];

437 
	gTT_NAME
[ 
cTT_NAME_Ën
+1 ];

438 
boŞ
 
	gTT_IS_SELL
;

439 
boŞ
 
	gTT_IS_MRKT
;

441 
Lßd
(
i¡»am
 &
fe
);

442 } *
	tPTRADE_TYPE_ROW
;

443 cÚ¡ 
	gT¿deTy³RowFmt
[] = "%s|%s|%s|%s\n";

446 
	sWATCH_ITEM_ROW


448 
TId’t
 
	gWI_WL_ID
;

449 
	gWI_S_SYMB
[ 
cSYMBOL_Ën
+1 ];

450 } *
	tPWATCH_ITEM_ROW
;

451 cÚ¡ 
	gW©chI‹mRowFmt
[] = "%" 
PRId64
 "|%s\n";

454 
	sWATCH_LIST_ROW


456 
TId’t
 
	gWL_ID
;

457 
TId’t
 
	gWL_C_ID
;

458 } *
	tPWATCH_LIST_ROW
;

459 cÚ¡ 
	gW©chLi¡RowFmt
[] = "%" 
PRId64
 "|%" PRId64 "\n";

462 
	gZIP_CODE_ROW
 : 
	tpublic
 
	tTBa£IÅutRow


464 
ZC_CODE
[
cZC_CODE_Ën
+1];

465 
	gZC_TOWN
[
cZC_TOWN_Ën
+1];

466 
	gZC_DIV
[
cZC_DIV_Ën
+1];

468 
Lßd
(
i¡»am
 &
fe
);

469 } *
	tPZIP_CODE_ROW
;

470 cÚ¡ 
	gZCodeRowFmt
[] = "%s|%s|%s\n";

	@include/workload/tpce/egen/TaxrateTable.h

40 #iâdeà
TAXRATE_TABLE_H


41 
	#TAXRATE_TABLE_H


	)

43 
	~"EG’TabËs_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCTax¿‹TabË
 : 
public
 
TabËTem¶©e
<
TAXRATE_ROW
>

50 
TTaxR©esCouÁryFe
 *
m_pCouÁry
;

51 
TTaxR©esDivisiÚFe
 *
	gm_pDivisiÚ
;

52 
UINT
 
	gm_iCouÁryIndex
;

53 
UINT
 
	gm_iDivisiÚIndex
;

54 
UINT
 
	gm_iCouÁrySubIndex
;

55 
UINT
 
	gm_iDivisiÚSubIndex
;

57 
	gpublic
:

58 
CTax¿‹TabË
Ğ
CIÅutFes
 
šputFes
 )

59 : 
TabËTem¶©e
<
TAXRATE_ROW
>(),

60 
m_pCouÁry
(
šputFes
.
TaxR©esCouÁry
),

61 
m_pDivisiÚ
(
šputFes
.
TaxR©esDivisiÚ
),

62 
m_iCouÁryIndex
(0),

63 
m_iDivisiÚIndex
(0),

64 
m_iCouÁrySubIndex
(0),

65 
m_iDivisiÚSubIndex
(0)

72 
boŞ
 
G’”©eNextRecÜd
()

74 cÚ¡ 
	gveùÜ
<
	gTTaxR©eIÅutRow
> *
	gpR©esRecÜd
;

76 ++
	gm_iLa¡RowNumb”
;

79 ià(
	gm_iCouÁryIndex
 < 
	gm_pCouÁry
->
G‘Size
())

81 
	gpR©esRecÜd
 = 
m_pCouÁry
->
G‘RecÜd
(
m_iCouÁryIndex
);

84 
¡ºıy
(
m_row
.
TX_ID
, (*
pR©esRecÜd
)[
m_iCouÁrySubIndex
].
TAX_ID
, (m_row.TX_ID));

85 
¡ºıy
(
m_row
.
TX_NAME
, (*
pR©esRecÜd
)[
m_iCouÁrySubIndex
].
TAX_NAME
, (m_row.TX_NAME));

86 
	gm_row
.
	gTX_RATE
 = (*
pR©esRecÜd
)[
m_iCouÁrySubIndex
].
TAX_RATE
;

88 ++
	gm_iCouÁrySubIndex
;

90 ià(
	gm_iCouÁrySubIndex
 >ğ
m_pCouÁry
->
G‘RecÜd
(
m_iCouÁryIndex
)->
size
())

93 ++
m_iCouÁryIndex
;

94 
	gm_iCouÁrySubIndex
 = 0;

99 ià(
	gm_iDivisiÚIndex
 < 
	gm_pDivisiÚ
->
G‘Size
())

101 
	gpR©esRecÜd
 = 
m_pDivisiÚ
->
G‘RecÜd
(
m_iDivisiÚIndex
);

104 
¡ºıy
(
m_row
.
TX_ID
, (*
pR©esRecÜd
)[
m_iDivisiÚSubIndex
].
TAX_ID
, (m_row.TX_ID));

105 
¡ºıy
(
m_row
.
TX_NAME
, (*
pR©esRecÜd
)[
m_iDivisiÚSubIndex
].
TAX_NAME
, (m_row.TX_NAME));

106 
	gm_row
.
	gTX_RATE
 = (*
pR©esRecÜd
)[
m_iDivisiÚSubIndex
].
TAX_RATE
;

108 ++
	gm_iDivisiÚSubIndex
;

110 ià(
	gm_iDivisiÚSubIndex
 >ğ
m_pDivisiÚ
->
G‘RecÜd
(
m_iDivisiÚIndex
)->
size
())

113 ++
m_iDivisiÚIndex
;

114 
	gm_iDivisiÚSubIndex
 = 0;

120 
	gm_bMÜeRecÜds
 = (
m_iCouÁryIndex
 < 
m_pCouÁry
->
G‘Size
()è|| (
m_iDivisiÚIndex
 < 
m_pDivisiÚ
->GetSize());

122  ( 
MÜeRecÜds
() );

	@include/workload/tpce/egen/TimerWheel.h

42 #iâdeà
TIMER_WHEEL_H


43 
	#TIMER_WHEEL_H


	)

45 
	~"EG’Ut™›s_¡dafx.h
"

46 
	~"MiscCÚ¡s.h
"

47 
	~"Wh“l.h
"

48 
	~"Wh“lTime.h
"

49 
	~"Tim”Wh“lTim”.h
"

51 
Çme¥aû
 
	gTPCE


54 
	g‹m¶©e
 < 
şass
 
	gT
, cÏs 
	gT2
, 
INT32
 
	gP”iod
, INT32 
	gResŞutiÚ
 >

55 şas 
	cCTim”Wh“l


58 
	g´iv©e
:

59 
CD©eTime
 
m_Ba£Time
;

61 
CWh“lTime
 
	gm_La¡Time
;

62 
CWh“lTime
 
	gm_Cu¼’tTime
;

63 
CWh“lTime
 
	gm_NextTime
;

65 
TWh“lCÚfig
 
	gm_Wh“lCÚfig
;

67 
	gli¡
< 
	gCTim”Wh“lTim”
< 
	gT
, 
	gT2
 >* > 
	gm_Tim”Wh“l
[ ( 
P”iod
 * ( 
MsP”SecÚd
 / 
ResŞutiÚ
 )) ];

69 
INT32
 
	gm_Numb”OfTim”s
;

71 
INT32
 
ExpœyProûssšg
( );

72 
ProûssTim”Li¡
Ğ
li¡
< 
CTim”Wh“lTim”
< 
T
, 
T2
 >* >* 
pLi¡
 );

73 
INT32
 
S‘NextTime
( );

75 
	gpublic
:

76 cÚ¡ 
INT32
 
NO_OUTSTANDING_TIMERS
 = -1;

78 
CTim”Wh“l
( );

79 ~
CTim”Wh“l
( );

81 
boŞ
 
Em±y
( );

82 
INT32
 
ProûssExpœedTim”s
( );

83 
INT32
 
S¹Tim”
Ğ
Off£t
, 
T2
* 
pExpœyObjeù
, (T2::* 
pExpœyFunùiÚ
èĞ
T
* ), T* 
pExpœyD©a
 );

87 
	g‹m¶©e
 < 
şass
 
	gT
, cÏs 
	gT2
, 
INT32
 
	gP”iod
, INT32 
	gResŞutiÚ
 >

88 
	gCTim”Wh“l
< 
	gT
, 
	gT2
, 
	gP”iod
, 
	gResŞutiÚ
 >::
	$CTim”Wh“l
( )

89 : 
	`m_Ba£Time
()

90 , 
	`m_La¡Time
Ğ&
m_Wh“lCÚfig
, 0, 0 )

91 , 
	`m_Cu¼’tTime
Ğ&
m_Wh“lCÚfig
, 0, 0 )

92 , 
	`m_NextTime
Ğ&
m_Wh“lCÚfig
, 
MaxWh“lCyşes
, ( 
P”iod
 * ( 
MsP”SecÚd
 / 
ResŞutiÚ
 )) - 1 )

93 , 
	`m_Wh“lCÚfig
(Ğ
P”iod
 * ( 
MsP”SecÚd
 / 
ResŞutiÚ
 )), Resolution )

94 , 
	$m_Numb”OfTim”s
( 0 )

96 
m_Ba£Time
.
	`S‘ToCu¼’t
();

97 
	}
}

99 
	g‹m¶©e
 < 
şass
 
	gT
, cÏs 
	gT2
, 
INT32
 
	gP”iod
, INT32 
	gResŞutiÚ
 >

100 
	gCTim”Wh“l
< 
	gT
, 
	gT2
, 
	gP”iod
, 
	gResŞutiÚ
 >::~
	$CTim”Wh“l
( )

102 
ty³Çme
 
li¡
< 
CTim”Wh“lTim”
<
T
, 
T2
>* >::
™”©Ü
 
ExpœedTim”
;

104  
INT32
 
ii
=0; i˜< ( 
P”iod
 * ( 
MsP”SecÚd
 / 
ResŞutiÚ
 )); ii++ )

106 ifĞ! 
m_Tim”Wh“l
[
ii
].
	`em±y
() )

108 
ExpœedTim”
 = 
m_Tim”Wh“l
[
ii
].
	`begš
();

109  
ExpœedTim”
 !ğ
m_Tim”Wh“l
[
ii
].
	`’d
() )

111 
d–‘e
 *
ExpœedTim”
;

112 
m_Numb”OfTim”s
--;

113 
ExpœedTim”
++;

115 
m_Tim”Wh“l
[
ii
].
	`ş—r
();

118 
	}
}

120 
	g‹m¶©e
 < 
şass
 
	gT
, cÏs 
	gT2
, 
INT32
 
	gP”iod
, INT32 
	gResŞutiÚ
 >

121 
boŞ
 
	gCTim”Wh“l
< 
	gT
, 
	gT2
, 
	gP”iod
, 
	gResŞutiÚ
 >::
	$Em±y
( )

123 Ğ
m_Numb”OfTim”s
 =ğ0 ? 
Œue
 : 
çl£
 );

124 
	}
}

126 
	g‹m¶©e
 < 
şass
 
	gT
, cÏs 
	gT2
, 
INT32
 
	gP”iod
, INT32 
	gResŞutiÚ
 >

127 
INT32
 
	gCTim”Wh“l
< 
	gT
, 
	gT2
, 
	gP”iod
, 
	gResŞutiÚ
 >::
S¹Tim”
Ğ
Off£t
, 
T2
* 
pExpœyObjeù
, (T2::* 
pExpœyFunùiÚ
èĞ
T
* ), T* 
pExpœyD©a
 )

129 
CD©eTime
 
Now
;

130 
CWh“lTime
 
	`Reque¡edTime
Ğ&
m_Wh“lCÚfig
 , 
m_Ba£Time
, 
Now
, (
INT32
è(
Off£t
 * ( 
MsP”SecÚd
 / 
ResŞutiÚ
 )));

131 
CTim”Wh“lTim”
<
T
, 
T2
>* 
pNewTim”
 = 
Ãw
 CTim”Wh“lTim”<T, T2>Ğ
pExpœyObjeù
, 
pExpœyFunùiÚ
, 
pExpœyD©a
 );

134 
m_Cu¼’tTime
.
	`S‘
Ğ
m_Ba£Time
, 
Now
 );

138 
	`ExpœyProûssšg
();

140 
m_Tim”Wh“l
[ 
Reque¡edTime
.
	`Index
(è].
	`push_back
Ğ
pNewTim”
 );

141 
m_Numb”OfTim”s
++;

143 ifĞ
Reque¡edTime
 < 
m_NextTime
 )

145 
m_NextTime
 = 
Reque¡edTime
;

148 Ğ
m_NextTime
.
	`Off£t
Ğ
m_Cu¼’tTime
 ));

149 
	}
}

151 
	g‹m¶©e
 < 
şass
 
	gT
, cÏs 
	gT2
, 
INT32
 
	gP”iod
, INT32 
	gResŞutiÚ
 >

152 
INT32
 
	gCTim”Wh“l
< 
	gT
, 
	gT2
, 
	gP”iod
, 
	gResŞutiÚ
 >::
	$ProûssExpœedTim”s
( )

154 
CD©eTime
 
Now
;

157 
m_Cu¼’tTime
.
	`S‘
Ğ
m_Ba£Time
, 
Now
 );

159 Ğ
	`ExpœyProûssšg
() );

160 
	}
}

162 
	g‹m¶©e
 < 
şass
 
	gT
, cÏs 
	gT2
, 
INT32
 
	gP”iod
, INT32 
	gResŞutiÚ
 >

163 
INT32
 
	gCTim”Wh“l
< 
	gT
, 
	gT2
, 
	gP”iod
, 
	gResŞutiÚ
 >::
	$ExpœyProûssšg
( )

165  
m_La¡Time
 < 
m_Cu¼’tTime
 )

167 
m_La¡Time
++;

168 ifĞ! 
m_Tim”Wh“l
[ 
m_La¡Time
.
	`Index
(è].
	`em±y
() )

170 
	`ProûssTim”Li¡
Ğ&
m_Tim”Wh“l
[ 
m_La¡Time
.
	`Index
() ] );

173 Ğ
	`S‘NextTime
() );

174 
	}
}

176 
	g‹m¶©e
 < 
şass
 
	gT
, cÏs 
	gT2
, 
INT32
 
	gP”iod
, INT32 
	gResŞutiÚ
 >

177 
	gCTim”Wh“l
< 
	gT
, 
	gT2
, 
	gP”iod
, 
	gResŞutiÚ
 >::
ProûssTim”Li¡
Ğ
li¡
< 
CTim”Wh“lTim”
<
T
,
T2
>* >* 
pLi¡
 )

179 
ty³Çme
 
	gli¡
< 
	gCTim”Wh“lTim”
<
	gT
,
	gT2
>* >::
™”©Ü
 
ExpœedTim”
;

182 
	gExpœedTim”
 = 
pLi¡
->
begš
();

183  
	gExpœedTim”
 !ğ
pLi¡
->
’d
() )

185 (((*
ExpœedTim”
)->
m_pExpœyObjeù
)->*((*ExpœedTim”)->
m_pExpœyFunùiÚ
)èĞ(*ExpœedTim”)->
m_pExpœyD©a
 );

186 
d–‘e
 *
	gExpœedTim”
;

187 
	gm_Numb”OfTim”s
--;

188 
	gExpœedTim”
++;

190 
	gpLi¡
->
ş—r
();

193 
	g‹m¶©e
 < 
şass
 
	gT
, cÏs 
	gT2
, 
INT32
 
	gP”iod
, INT32 
	gResŞutiÚ
 >

194 
INT32
 
	gCTim”Wh“l
< 
	gT
, 
	gT2
, 
	gP”iod
, 
	gResŞutiÚ
 >::
	$S‘NextTime
( )

196 ifĞ0 =ğ
m_Numb”OfTim”s
 )

198 
m_NextTime
.
	`S‘
Ğ
MaxWh“lCyşes
, ( 
P”iod
 * ( 
MsP”SecÚd
 / 
ResŞutiÚ
 )) - 1 );

199 Ğ
NO_OUTSTANDING_TIMERS
 );

203 
m_NextTime
 = 
m_Cu¼’tTime
;

204  
m_Tim”Wh“l
[ 
m_NextTime
.
	`Index
(è].
	`em±y
() )

206 
m_NextTime
++;

208 Ğ
m_NextTime
.
	`Off£t
Ğ
m_Cu¼’tTime
 ));

210 
	}
}

	@include/workload/tpce/egen/TimerWheelTimer.h

41 #iâdeà
TIMER_WHEEL_TIMER_H


42 
	#TIMER_WHEEL_TIMER_H


	)

44 
Çme¥aû
 
	gTPCE


47 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gT2
>

48 şas 
	cCTim”Wh“lTim”


51 
	g´iv©e
:

53 
public
:

55 
T
* 
m_pExpœyD©a
;

56 
T2
* 
	gm_pExpœyObjeù
;

57 (
	gT2
::* 
m_pExpœyFunùiÚ
èĞ
T
* );

59 
CTim”Wh“lTim”
Ğ
T2
* 
pExpœyObjeù
, (T2::* 
pExpœyFunùiÚ
èĞ
T
* ), T* 
pExpœyD©a
 );

61 ~
CTim”Wh“lTim”
();

65 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gT2
>

66 
	gCTim”Wh“lTim”
<
	gT
,
	gT2
>::
CTim”Wh“lTim”
Ğ
T2
* 
pExpœyObjeù
, (T2::* 
pExpœyFunùiÚ
èĞ
T
* ), T* 
pExpœyD©a
 )

68 
m_pExpœyD©a
 = 
pExpœyD©a
;

69 
m_pExpœyObjeù
 = 
pExpœyObjeù
;

70 
m_pExpœyFunùiÚ
 = 
pExpœyFunùiÚ
;

71 
	}
}

73 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gT2
>

74 
	gCTim”Wh“lTim”
<
	gT
,
	gT2
>::~
	$CTim”Wh“lTim”
()

76 
	}
}

	@include/workload/tpce/egen/TradeGen.h

47 #iâdeà
TRADE_GEN_H


48 
	#TRADE_GEN_H


	)

50 
	~<queue
>

51 
	~"EG’Snd¬dTy³s.h
"

52 
	~"MÚey.h
"

53 
	~"IÅutFÏtFesDeş¬©iÚs.h
"

54 
	~"IÅutFÏtFesSŒuùu».h
"

55 
	~"MEESecur™y.h
"

56 
	~"Cu¡om”AccouÁsAndP”missiÚsTabË.h
"

57 
	~"Add»ssTabË.h
"

58 
	~"Cu¡om”TabË.h
"

59 
	~"Cu¡om”Tax¿‹sTabË.h
"

60 
	~"Cu¡om”S–eùiÚ.h
"

61 
	~"HŞdšgsAndT¿desTabË.h
"

62 
	~"Brok”s.h
"

63 
	~"Secur™yTabË.h
"

64 
	~"P”sÚ.h
"

65 
	~"Com·nyFe.h
"

66 
	~"Secur™yFe.h
"

68 
usšg
 
Çme¥aû
 
	g¡d
;

70 
Çme¥aû
 
	gTPCE


80 cÚ¡ 
	giMaxHŞdšgHi¡ÜyRowsP”T¿de
 = 800 / 100;

85 
	sTT¿deInfo


87 
TT¿de
 
	giT¿deId
;

88 
eT¿deTy³ID
 
	geT¿deTy³
;

89 
eStusTy³ID
 
	geT¿deStus
;

90 
	gP’dšgTime
;

91 
	gSubmissiÚTime
;

92 
	gCom¶‘iÚTime
;

93 
TId’t
 
	giSymbŞIndex
;

94 
UINT
 
	giSymbŞIndexInAccouÁ
;

95 
	giT¿deQty
;

96 
CMÚey
 
	gfBidPriû
;

97 
CMÚey
 
	gfT¿dePriû
;

98 
TId’t
 
	giCu¡om”
;

99 
eCu¡om”T›r
 
	giCu¡om”T›r
;

100 
TId’t
 
	giCu¡om”AccouÁ
;

101 
boŞ
 
	gbIsLifo
;

102 } *
	tPT¿deInfo
;

106 
	sTAdd™iÚ®T¿deInfo


110 
CMÚey
 
	gfBuyV®ue
;

113 
CMÚey
 
	gfS–lV®ue
;

117 
TId’t
 
	giCu¼’tBrok”Id
;

119 
eTaxStus
 
	geAccouÁTaxStus
;

125 
CMÚey
 
	gCommissiÚ
;

126 
CMÚey
 
	gCh¬ge
;

127 
CMÚey
 
	gTax
;

128 
CMÚey
 
	gS‘em’tAmouÁ
;

129 } *
	tPAdd™iÚ®T¿deInfo
;

135 
	sTHŞdšgInfo


137 
TT¿de
 
	giT¿deId
;

138 
	giT¿deQty
;

139 
CMÚey
 
	gfT¿dePriû
;

140 
CD©eTime
 
	gBuyDTS
;

141 
TId’t
 
	giSymbŞIndex
;

142 } *
	tPHŞdšgInfo
;

148 
	sTT¿deRow


150 
TRADE_ROW
 
	gm_T¿de
;

151 
TRADE_REQUEST_ROW
 
	gm_T¿deReque¡
;

152 
TRADE_HISTORY_ROW
 
	gm_T¿deHi¡Üy
[3];

153 
SETTLEMENT_ROW
 
	gm_S‘em’t
;

154 
CASH_TRANSACTION_ROW
 
	gm_CashT¿n§ùiÚ
;

155 
HOLDING_HISTORY_ROW
 
	gm_HŞdšgHi¡Üy
[
iMaxHŞdšgHi¡ÜyRowsP”T¿de
];

156 } *
	tPT¿deRow
;

160 
	gli¡
<
	tTHŞdšgInfo
> 
	tTHŞdšgLi¡
;

161 
THŞdšgLi¡
 
	tTCu¡om”HŞdšgA¼ay
[
iMaxSecur™›sP”AccouÁ
];

163 şas 
	cCT¿deG’


167 
CRªdom
 
	gm_ºd
;

172 
CAdd»ssTabË
 
	gm_Add»ssTabË
;

176 
CCu¡om”S–eùiÚ
 
	gm_Cu¡om”S–eùiÚ
;

180 
CCu¡om”TabË
 
	gm_Cu¡om”TabË
;

184 
CCu¡om”Tax¿‹sTabË
 
	gm_Cu¡Tax¿‹TabË
;

188 
CCu¡om”AccouÁsAndP”missiÚsTabË
 
	gm_Cu¡om”AccouÁTabË
;

192 
CHŞdšgsAndT¿desTabË
 
	gm_HŞdšgTabË
;

196 
CBrok”sTabË
 
	gm_Brok”TabË
;

200 
CSecur™yTabË
 
	gm_Secur™yTabË
;

204 
CP”sÚ
 
	gm_P”sÚ
;

208 
CCom·nyFe
* 
	gm_Com·nyFe
;

209 
CSecur™yFe
* 
	gm_Secur™yFe
;

210 
TCh¬geFe
* 
	gm_Ch¬geFe
;

211 
TCommissiÚR©eFe
* 
	gm_CommissiÚR©eFe
;

212 
TStusTy³Fe
* 
	gm_StusTy³Fe
;

213 
TT¿deTy³Fe
* 
	gm_T¿deTy³Fe
;

214 
TExchªgeFe
* 
	gm_ExchªgeFe
;

218 
TId’t
 
	gm_iS¹FromCu¡om”
;

221 
TId’t
 
	gm_iS¹FromAccouÁ
;

224 
TId’t
 
	gm_iCu¡om”CouÁ
;

227 
TId’t
 
	gm_iTÙ®Cu¡om”s
;

230 
	gm_iLßdUn™Size
;

233 
	gm_iLßdUn™AccouÁCouÁ
;

236 
	gm_iSÿËFaùÜ
;

239 
	gm_iHoursOfIn™ŸlT¿des
;

243 
	gm_fM—nTimeB‘w“nT¿des
;

248 
	gm_fM—nInTheMÚeySubmissiÚD–ay
;

255 
CD©eTime
 
	gm_S¹Time
;

268 
	gm_Cu¼’tSimuÏ‹dTime
;

279 
	g´iÜ™y_queue
< 
	gTT¿deInfo
,

280 
	gveùÜ
<
	gTT¿deInfo
>,

281 
	gg»©”
<
	gTT¿deInfo
> > 
	gm_Cu¼’tT¿des
;

286 
TT¿de
 
	gm_iCu¼’tCom¶‘edT¿des
;

291 
TT¿de
 
	gm_iTÙ®T¿des
;

297 
TT¿de
 
	gm_iCu¼’tIn™Ÿ‹dT¿des
;

302 
	gm_iT¿desP”WÜkDay
;

314 
TCu¡om”HŞdšgA¼ay
* 
	gm_pCu¡om”HŞdšgs
;

319 
TT¿deInfo
 
	gm_NewT¿de
;

324 
TAdd™iÚ®T¿deInfo
 
	gm_Com¶‘edT¿deInfo
;

332 
TT¿deRow
 
	gm_T¿deRow
;

333 
HOLDING_ROW
 
	gm_HŞdšgRow
;

337 
HOLDING_SUMMARY_ROW
 
	gm_HŞdšgSumm¬yRow
;

341 
	gm_iT¿deHi¡ÜyRowCouÁ
;

345 
	gm_iCashT¿n§ùiÚRowCouÁ
;

349 
	gm_iS‘em’tRowCouÁ
;

354 
	gm_iHŞdšgHi¡ÜyRowCouÁ
;

357 
CMEESecur™y
 
	gm_MEESecur™y
;

362 
	gm_iCu¼’tAccouÁFÜHŞdšg
;

363 
	gm_iCu¼’tSecur™yFÜHŞdšg
;

364 
	gli¡
<
	gTHŞdšgInfo
>::
™”©Ü
 
m_pCu¼’tSecur™yHŞdšg
;

369 
	gm_iCu¼’tAccouÁFÜHŞdšgSumm¬y
;

370 
	gm_iCu¼’tSecur™yFÜHŞdšgSumm¬y
;

375 
TT¿de
 
	gm_iCu¼’tT¿deId
;

379 
	gm_iCu¼’tLßdUn™
;

389 
G’”©eNewT¿de
();

395 
G’”©eCom¶‘eT¿de
();

400 
šlše
 
G’”©eD–ayB‘w“nT¿des
();

405 
šlše
 
THŞdšgLi¡
* 
G‘HŞdšgLi¡FÜCu¼’tT¿de
();

410 
	gli¡
<
	gTHŞdšgInfo
>::
™”©Ü
 
Pos™iÚAtHŞdšgLi¡
(

411 
THŞdšgLi¡
* 
pHŞdšgLi¡
,

412 
IsLifo
);

417 
Upd©eHŞdšgs
();

424 
boŞ
 
FšdNextHŞdšg
();

429 
boŞ
 
FšdNextHŞdšgLi¡
();

434 
TT¿de
 
G’”©eNextT¿deId
();

438 
eT¿deTy³ID
 
G’”©eT¿deTy³
();

444 
G’”©eCom¶‘edT¿deInfo
();

448 
G’”©eT¿deRow
();

450 
G’”©eT¿deCh¬ge
();

452 
G’”©eT¿deCommissiÚ
();

454 
G’”©eT¿deTax
();

458 
G’”©eS‘em’tAmouÁ
();

462 
G’”©eT¿deHi¡ÜyRow
();

466 
G’”©eCashT¿n§ùiÚRow
();

470 
G’”©eS‘em’tRow
();

474 
G’”©eHŞdšgHi¡ÜyRow
(
TT¿de
 
iHŞdšgT¿deID
,

475 
TT¿de
 
iT¿deT¿deID
,

476 
iBefÜeQty
,

477 
iAá”Qty
);

480 
TId’t
 
G‘Cu¼’tCu¡ID
(è{  
	gm_NewT¿de
.
	giCu¡om”
; }

482 
G‘Cu¼’tCu¡T›r
(è{  
	gm_NewT¿de
.
	giCu¡om”T›r
; }

484 
TId’t
 
G‘Cu¼’tAccID
(è{  
	gm_NewT¿de
.
	giCu¡om”AccouÁ
; }

486 
TT¿de
 
G‘Cu¼’tT¿deID
(è{  
	gm_NewT¿de
.
	giT¿deId
; }

488 
CMÚey
 
G‘Cu¼’tBidPriû
(è{  
	gm_NewT¿de
.
	gfBidPriû
; }

490 
CMÚey
 
G‘Cu¼’tT¿dePriû
(è{  
	gm_NewT¿de
.
	gfT¿dePriû
; }

492 
G‘Cu¼’tT¿deQty
(è{  
	gm_NewT¿de
.
	giT¿deQty
; }

494 
eT¿deTy³ID
 
G‘Cu¼’tT¿deTy³
(è{  
	gm_NewT¿de
.
	geT¿deTy³
; }

496 
eStusTy³ID
 
G‘Cu¼’tT¿deStus
(è{  
	gm_NewT¿de
.
	geT¿deStus
; }

498 
G‘Cu¼’tT¿deIsCash
(è{  
	gm_T¿deRow
.
	gm_T¿de
.
	gT_IS_CASH
; }

500 
TId’t
 
G‘Cu¼’tSecur™yIndex
(è{  
	gm_NewT¿de
.
	giSymbŞIndex
; }

502 
UINT
 
G‘Cu¼’tSecur™yAccouÁIndex
(è{  
	gm_NewT¿de
.
	giSymbŞIndexInAccouÁ
; }

504 
CD©eTime
 
G‘Cu¼’tT¿deP’dšgTime
() {

505 
CD©eTime
 
	gR‘uºTime
 = 
m_S¹Time
;

506 
	giDays
, 
	giMs
;

510 
	giDays
 = ()(
m_NewT¿de
.
P’dšgTime
 / 
SecÚdsP”Day
);

511 
	giMs
 = ()((
m_NewT¿de
.
P’dšgTime
 - 
iDays
 * 
SecÚdsP”Day
è* 
MsP”SecÚd
);

512 
	gR‘uºTime
.
Add
(
iDays
, 
iMs
, 
Œue
);

514  
	gR‘uºTime
;

517 
CD©eTime
 
G‘Cu¼’tT¿deSubmissiÚTime
() {

518 
CD©eTime
 
	gR‘uºTime
 = 
m_S¹Time
;

519 
	giDays
, 
	giMs
;

523 
	giDays
 = ()(
m_NewT¿de
.
SubmissiÚTime
 / 
SecÚdsP”Day
);

524 
	giMs
 = ()((
m_NewT¿de
.
SubmissiÚTime
 - 
iDays
 * 
SecÚdsP”Day
è* 
MsP”SecÚd
);

525 
	gR‘uºTime
.
Add
(
iDays
, 
iMs
, 
Œue
);

527  
	gR‘uºTime
;

530 
CD©eTime
 
G‘Cu¼’tT¿deCom¶‘iÚTime
() {

531 
CD©eTime
 
	gR‘uºTime
 = 
m_S¹Time
;

533 
	giDays
, 
	giMs
;

537 
	giDays
 = ()(
m_NewT¿de
.
Com¶‘iÚTime
 / 
SecÚdsP”Day
);

538 
	giMs
 = ()((
m_NewT¿de
.
Com¶‘iÚTime
 - 
iDays
 * 
SecÚdsP”Day
è* 
MsP”SecÚd
);

539 
	gR‘uºTime
.
Add
(
iDays
, 
iMs
, 
Œue
);

541  
	gR‘uºTime
;

544 
boŞ
 
G‘Cu¼’tT¿deIsLifo
(è{  
	gm_NewT¿de
.
	gbIsLifo
; }

546 
CMÚey
 
G‘Cu¼’tT¿deS–lV®ue
(è{  
	gm_Com¶‘edT¿deInfo
.
	gfS–lV®ue
; }

548 
CMÚey
 
G‘Cu¼’tT¿deBuyV®ue
(è{  
	gm_Com¶‘edT¿deInfo
.
	gfBuyV®ue
; }

550 
TId’t
 
G‘Cu¼’tBrok”Id
(è{  
	gm_Com¶‘edT¿deInfo
.
	giCu¼’tBrok”Id
; }

552 
eTaxStus
 
G‘Cu¼’tTaxStus
(è{  
	gm_Com¶‘edT¿deInfo
.
	geAccouÁTaxStus
; }

554 
CMÚey
 
G‘Cu¼’tT¿deCh¬ge
(è{  
	gm_Com¶‘edT¿deInfo
.
	gCh¬ge
; }

556 
CMÚey
 
G‘Cu¼’tT¿deCommissiÚ
(è{  
	gm_Com¶‘edT¿deInfo
.
	gCommissiÚ
; }

558 
CMÚey
 
G‘Cu¼’tT¿deTax
(è{  
	gm_Com¶‘edT¿deInfo
.
	gTax
; }

560 
CMÚey
 
G‘Cu¼’tS‘em’tAmouÁ
(è{  
	gm_Com¶‘edT¿deInfo
.
	gS‘em’tAmouÁ
; }

562 
	gpublic
:

565 
CT¿deG’
(

566 
CIÅutFes
 
šputFes
,

567 
TId’t
 
iCu¡om”CouÁ
,

568 
TId’t
 
iS¹FromCu¡om”
,

569 
TId’t
 
iTÙ®Cu¡om”s
,

570 
UINT
 
iLßdUn™Size
,

571 
UINT
 
iSÿËFaùÜ
,

572 
UINT
 
iHoursOfIn™ŸlT¿des
,

573 
boŞ
 
bCacheEÇbËd
 = 
çl£


578 ~
CT¿deG’
();

589 
boŞ
 
G’”©eNextT¿de
();

594 
boŞ
 
G’”©eNextHŞdšgSumm¬yRow
();

603 
boŞ
 
G’”©eNextHŞdšg
();

611 
boŞ
 
In™NextLßdUn™
();

615 
PTRADE_ROW
 
G‘T¿deRow
(è{  &
	gm_T¿deRow
.
	gm_T¿de
; }

616 
G‘T¿deHi¡ÜyRowCouÁ
(è{  
	gm_iT¿deHi¡ÜyRowCouÁ
; }

617 
PTRADE_HISTORY_ROW
 
G‘T¿deHi¡ÜyRow
(
i
è{  &
	gm_T¿deRow
.
	gm_T¿deHi¡Üy
[i]; }

618 
G‘S‘em’tRowCouÁ
(è{  
	gm_iS‘em’tRowCouÁ
; }

619 
PSETTLEMENT_ROW
 
G‘S‘em’tRow
(è{  &
	gm_T¿deRow
.
	gm_S‘em’t
; }

620 
G‘CashT¿n§ùiÚRowCouÁ
(è{  
	gm_iCashT¿n§ùiÚRowCouÁ
; }

621 
PCASH_TRANSACTION_ROW
 
G‘CashT¿n§ùiÚRow
(è{  &
	gm_T¿deRow
.
	gm_CashT¿n§ùiÚ
; }

622 
HOLDING_ROW
 cÚ¡ *
G‘HŞdšgRow
(è{  &
	gm_HŞdšgRow
; }

623 
G‘HŞdšgHi¡ÜyRowCouÁ
(è{  
	gm_iHŞdšgHi¡ÜyRowCouÁ
; }

624 
PHOLDING_HISTORY_ROW
 
G‘HŞdšgHi¡ÜyRow
(
i
è{  &
	gm_T¿deRow
.
	gm_HŞdšgHi¡Üy
[i]; }

625 
HOLDING_SUMMARY_ROW
 cÚ¡ *
G‘HŞdšgSumm¬yRow
(è{  &
	gm_HŞdšgSumm¬yRow
; }

627 
boŞ
 
G’”©eNextBrok”RecÜd
(è{  
	gm_Brok”TabË
.
G’”©eNextRecÜd
(); }

628 
BROKER_ROW
 cÚ¡ * 
G‘Brok”Row
(è{  
	gm_Brok”TabË
.
G‘Row
(); }

	@include/workload/tpce/egen/TradeTypeIDs.h

44 #iâdeà
TRADE_TYPE_IDS_H


45 
	#TRADE_TYPE_IDS_H


	)

47 
Çme¥aû
 
	gTPCE


50 
	eeT¿deTy³ID


52 
	geM¬k‘Buy
 = 0,

53 
	geM¬k‘S–l
,

54 
	geStİLoss
,

55 
	geLim™S–l
,

56 
	geLim™Buy
,

58 
	geMaxT¿deTy³ID


	@include/workload/tpce/egen/TradeTypeTable.h

40 #iâdeà
TRADE_TYPE_TABLE_H


41 
	#TRADE_TYPE_TABLE_H


	)

43 
	~"EG’TabËs_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCT¿deTy³TabË
 : 
public
 
TabËTem¶©e
<
TRADE_TYPE_ROW
>

50 
if¡»am
 
InFe
;

52 
	gpublic
:

53 
CT¿deTy³TabË
Ğ*
szDœName
 )

54 : 
TabËTem¶©e
<
TRADE_TYPE_ROW
>()

56 
szFeName
[
iMaxP©h
];

58 
¡ºıy
(
szFeName
, 
szDœName
, (szFileName));

59 
¡ºÿt
(
szFeName
, "T¿deTy³.txt", (szFeNameè- 
¡¾’
(
szDœName
) - 1);

61 
	gInFe
.
İ’
Ğ
szFeName
 );

64 ~
CT¿deTy³TabË
( )

66 
	gInFe
.
şo£
();

72 
boŞ
 
G’”©eNextRecÜd
()

74 ifĞ
	gInFe
.
good
() )

76 
	gm_row
.
Lßd
(
InFe
);

79  ( 
	gInFe
.
eof
() );

	@include/workload/tpce/egen/TxnHarnessBrokerVolume.h

37 #iâdeà
TXN_HARNESS_BROKER_VOLUME_H


38 
	#TXN_HARNESS_BROKER_VOLUME_H


	)

40 
	~"TxnH¬ÃssDBIÁ”çû.h
"

42 
Çme¥aû
 
	gTPCE


45 şas 
	cCBrok”VŞume


47 
CBrok”VŞumeDBIÁ”çû
* 
	gm_db
;

49 
	gpublic
:

50 
CBrok”VŞume
(
CBrok”VŞumeDBIÁ”çû
 *
pDB
)

51 : 
m_db
(
pDB
)

55 
DoTxn
Ğ
PBrok”VŞumeTxnIÅut
 
pTxnIÅut
, 
PBrok”VŞumeTxnOuut
 
pTxnOuut
 )

58 
TBrok”VŞumeF¿me1Ouut
 
	gF¿me1Ouut
;

59 
mem£t
(&
F¿me1Ouut
, 0, ( Frame1Output ));

61 
	gTXN_HARNESS_SET_STATUS_SUCCESS
;

64 
	gm_db
->
DoBrok”VŞumeF¿me1
Ğ
pTxnIÅut
, &
F¿me1Ouut
 );

67 ià(
	gF¿me1Ouut
.
	gli¡_Ën
 < 0 || F¿me1Ouut.li¡_ËÀ> 
	gmax_brok”_li¡_Ën
)

69 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
BVF1_ERROR1
);

73 
	gpTxnOuut
->
	gli¡_Ën
 = 
F¿me1Ouut
.
li¡_Ën
;

74 
	gi
=0; i < 
	gF¿me1Ouut
.
	gli¡_Ën
 && i < 
	gmax_brok”_li¡_Ën
; i++)

76 
	gpTxnOuut
->
	gvŞume
[
i
] = 
F¿me1Ouut
.
vŞume
[i];

	@include/workload/tpce/egen/TxnHarnessCustomerPosition.h

41 #iâdeà
TXN_HARNESS_CUSTOMER_POSITION_H


42 
	#TXN_HARNESS_CUSTOMER_POSITION_H


	)

44 
	~"TxnH¬ÃssDBIÁ”çû.h
"

46 
Çme¥aû
 
	gTPCE


49 şas 
	cCCu¡om”Pos™iÚ


51 
CCu¡om”Pos™iÚDBIÁ”çû
* 
	gm_db
;

53 
	gpublic
:

54 
CCu¡om”Pos™iÚ
(
CCu¡om”Pos™iÚDBIÁ”çû
 *
pDB
)

55 : 
m_db
(
pDB
)

59 
DoTxn
Ğ
PCu¡om”Pos™iÚTxnIÅut
 
pTxnIÅut
, 
PCu¡om”Pos™iÚTxnOuut
 
pTxnOuut
)

62 
TCu¡om”Pos™iÚF¿me1IÅut
 
	gF¿me1IÅut
;

63 
TCu¡om”Pos™iÚF¿me1Ouut
 
	gF¿me1Ouut
;

64 
TCu¡om”Pos™iÚF¿me2IÅut
 
	gF¿me2IÅut
;

65 
TCu¡om”Pos™iÚF¿me2Ouut
 
	gF¿me2Ouut
;

67 
mem£t
(&
F¿me1IÅut
, 0, (Frame1Input));

68 
mem£t
(&
F¿me1Ouut
, 0, (Frame1Output));

69 
mem£t
(&
F¿me2IÅut
, 0, (Frame2Input));

70 
mem£t
(&
F¿me2Ouut
, 0, (Frame2Output));

72 
	gTXN_HARNESS_SET_STATUS_SUCCESS
;

75 
	gF¿me1IÅut
.
	gcu¡_id
 = 
pTxnIÅut
->
cu¡_id
;

76 
¡ºıy
(
F¿me1IÅut
.
x_id
, 
pTxnIÅut
->tax_id, (Frame1Input.tax_id));

79 
	gm_db
->
DoCu¡om”Pos™iÚF¿me1
(&
F¿me1IÅut
, &
F¿me1Ouut
);

82 ià((
	gF¿me1Ouut
.
	gacù_Ën
 < 1) ||

83 (
	gF¿me1Ouut
.
	gacù_Ën
 > 
	gmax_acù_Ën
))

85 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
CPF1_ERROR1
);

89 
	gpTxnOuut
->
	gacù_Ën
 = 
F¿me1Ouut
.
acù_Ën
;

90 
	gpTxnOuut
->
	gc_ad_id
 = 
F¿me1Ouut
.
c_ad_id
;

91 
¡ºıy
(
pTxnOuut
->
c_¬—_1
, 
F¿me1Ouut
.c_area_1, (pTxnOutput->c_area_1));

92 
¡ºıy
(
pTxnOuut
->
c_¬—_2
, 
F¿me1Ouut
.c_area_2, (pTxnOutput->c_area_2));

93 
¡ºıy
(
pTxnOuut
->
c_¬—_3
, 
F¿me1Ouut
.c_area_3, (pTxnOutput->c_area_3));

94 
¡ºıy
(
pTxnOuut
->
c_ùry_1
, 
F¿me1Ouut
.c_ctry_1, (pTxnOutput->c_ctry_1));

95 
¡ºıy
(
pTxnOuut
->
c_ùry_2
, 
F¿me1Ouut
.c_ctry_2, (pTxnOutput->c_ctry_2));

96 
¡ºıy
(
pTxnOuut
->
c_ùry_3
, 
F¿me1Ouut
.c_ctry_3, (pTxnOutput->c_ctry_3));

97 
	gpTxnOuut
->
	gc_dob
 = 
F¿me1Ouut
.
c_dob
;

98 
¡ºıy
(
pTxnOuut
->
c_ema_1
, 
F¿me1Ouut
.c_email_1, (pTxnOutput->c_email_1));

99 
¡ºıy
(
pTxnOuut
->
c_ema_2
, 
F¿me1Ouut
.c_email_2, (pTxnOutput->c_email_2));

100 
¡ºıy
(
pTxnOuut
->
c_ext_1
, 
F¿me1Ouut
.c_ext_1, (pTxnOutput->c_ext_1));

101 
¡ºıy
(
pTxnOuut
->
c_ext_2
, 
F¿me1Ouut
.c_ext_2, (pTxnOutput->c_ext_2));

102 
¡ºıy
(
pTxnOuut
->
c_ext_3
, 
F¿me1Ouut
.c_ext_3, (pTxnOutput->c_ext_3));

103 
¡ºıy
(
pTxnOuut
->
c_f_Çme
, 
F¿me1Ouut
.c_f_name, (pTxnOutput->c_f_name));

104 
¡ºıy
(
pTxnOuut
->
c_gndr
, 
F¿me1Ouut
.c_gndr, (pTxnOutput->c_gndr));

105 
¡ºıy
(
pTxnOuut
->
c_l_Çme
, 
F¿me1Ouut
.c_l_name, (pTxnOutput->c_l_name));

106 
¡ºıy
(
pTxnOuut
->
c_loÿl_1
, 
F¿me1Ouut
.c_local_1, (pTxnOutput->c_local_1));

107 
¡ºıy
(
pTxnOuut
->
c_loÿl_2
, 
F¿me1Ouut
.c_local_2, (pTxnOutput->c_local_2));

108 
¡ºıy
(
pTxnOuut
->
c_loÿl_3
, 
F¿me1Ouut
.c_local_3, (pTxnOutput->c_local_3));

109 
¡ºıy
(
pTxnOuut
->
c_m_Çme
, 
F¿me1Ouut
.c_m_name, (pTxnOutput->c_m_name));

110 
¡ºıy
(
pTxnOuut
->
c_¡_id
, 
F¿me1Ouut
.c_st_id, (pTxnOutput->c_st_id));

111 
	gpTxnOuut
->
	gc_t›r
 = 
F¿me1Ouut
.
c_t›r
;

114 
	gi
=0; i < 
	gF¿me1Ouut
.
	gacù_Ën
 && i < 
	gmax_acù_Ën
; i++)

116 
	gpTxnOuut
->
	gacù_id
[
i
] = 
F¿me1Ouut
.
acù_id
[i];

117 
	gpTxnOuut
->
	gas£t_tÙ®
[
i
] = 
F¿me1Ouut
.
as£t_tÙ®
[i];

118 
	gpTxnOuut
->
	gÿsh_b®
[
i
] = 
F¿me1Ouut
.
ÿsh_b®
[i];

121 ià(
	gpTxnIÅut
->
	gg‘_hi¡Üy
)

124 
	gF¿me2IÅut
.
	gacù_id
 = 
F¿me1Ouut
.
acù_id
[ 
pTxnIÅut
->
acù_id_idx
 ];

127 
	gm_db
->
DoCu¡om”Pos™iÚF¿me2
(&
F¿me2IÅut
, &
F¿me2Ouut
);

130 ià((
	gF¿me2Ouut
.
	ghi¡_Ën
 < 
	gmš_hi¡_Ën
) ||

131 (
	gF¿me2Ouut
.
	ghi¡_Ën
 > 
	gmax_hi¡_Ën
))

133 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
CPF2_ERROR1
);

137 
	gpTxnOuut
->
	ghi¡_Ën
 = 
F¿me2Ouut
.
hi¡_Ën
;

138 
	gi
=0; i < 
	gF¿me2Ouut
.
	ghi¡_Ën
 && i < 
	gmax_hi¡_Ën
; i++)

140 
	gpTxnOuut
->
	ghi¡_dts
[
i
] = 
F¿me2Ouut
.
hi¡_dts
[i];

141 
	gpTxnOuut
->
	gqty
[
i
] = 
F¿me2Ouut
.
qty
[i];

142 
¡ºıy
(
pTxnOuut
->
symbŞ
[
i
], 
F¿me2Ouut
.symbol[i], (pTxnOutput->symbol[i]));

143 
	gpTxnOuut
->
	gŒade_id
[
i
] = 
F¿me2Ouut
.
Œade_id
[i];

144 
¡ºıy
(
pTxnOuut
->
Œade_¡©us
[
i
], 
F¿me2Ouut
.trade_status[i], (pTxnOutput->trade_status[i]));

150 
	gm_db
->
DoCu¡om”Pos™iÚF¿me3
();

153 
	gpTxnOuut
->
	ghi¡_Ën
 = 0;

	@include/workload/tpce/egen/TxnHarnessDBInterface.h

41 #iâdeà
DBINTERFACE_H_INCLUDED


42 
	#DBINTERFACE_H_INCLUDED


	)

44 
	~<¡ršg
>

45 
	~<ÿs£¹
>

46 
	~<c¡dio
>

47 
	~"TxnH¬ÃssSŒuùs.h
"

48 
	~"TxnH¬ÃssS’dToM¬k‘IÁ”çû.h
"

49 
	~"”rÜ.h
"

51 
usšg
 
Çme¥aû
 
	g¡d
;

53 
Çme¥aû
 
	gTPCE
 {

55 şas 
	cCT¿deOrd”DBIÁ”çû
 {

56 
	gpublic
:

57 
vœtu®
 
DoT¿deOrd”F¿me1
(cÚ¡ 
TT¿deOrd”F¿me1IÅut
 *
pIn
, 
TT¿deOrd”F¿me1Ouut
 *
pOut
) = 0;

58 
vœtu®
 
DoT¿deOrd”F¿me2
(cÚ¡ 
TT¿deOrd”F¿me2IÅut
 *
pIn
, 
TT¿deOrd”F¿me2Ouut
 *
pOut
) = 0;

59 
vœtu®
 
DoT¿deOrd”F¿me3
(cÚ¡ 
TT¿deOrd”F¿me3IÅut
 *
pIn
, 
TT¿deOrd”F¿me3Ouut
 *
pOut
) = 0;

60 
vœtu®
 
DoT¿deOrd”F¿me4
(cÚ¡ 
TT¿deOrd”F¿me4IÅut
 *
pIn
, 
TT¿deOrd”F¿me4Ouut
 *
pOut
) = 0;

61 
vœtu®
 
DoT¿deOrd”F¿me5
() = 0;

62 
vœtu®
 
DoT¿deOrd”F¿me6
() = 0;

63 
	gvœtu®
 ~
CT¿deOrd”DBIÁ”çû
 () { }

66 şas 
	cCT¿deStusDBIÁ”çû
 {

67 
	gpublic
:

68 
vœtu®
 
DoT¿deStusF¿me1
(cÚ¡ 
TT¿deStusF¿me1IÅut
 *
pIn
, 
TT¿deStusF¿me1Ouut
 *
pOut
) = 0;

69 
	gvœtu®
 ~
CT¿deStusDBIÁ”çû
 () { }

72 şas 
	cCCu¡om”Pos™iÚDBIÁ”çû
 {

73 
	gpublic
:

74 
vœtu®
 
DoCu¡om”Pos™iÚF¿me1
(cÚ¡ 
TCu¡om”Pos™iÚF¿me1IÅut
 *
pIn
, 
TCu¡om”Pos™iÚF¿me1Ouut
 *
pOut
) = 0;

75 
vœtu®
 
DoCu¡om”Pos™iÚF¿me2
(cÚ¡ 
TCu¡om”Pos™iÚF¿me2IÅut
 *
pIn
, 
TCu¡om”Pos™iÚF¿me2Ouut
 *
pOut
) = 0;

76 
vœtu®
 
DoCu¡om”Pos™iÚF¿me3
() = 0;

77 
	gvœtu®
 ~
CCu¡om”Pos™iÚDBIÁ”çû
 () { }

80 şas 
	cCBrok”VŞumeDBIÁ”çû
 {

81 
	gpublic
:

82 
vœtu®
 
DoBrok”VŞumeF¿me1
(cÚ¡ 
TBrok”VŞumeF¿me1IÅut
 *
pIn
, 
TBrok”VŞumeF¿me1Ouut
 *
pOut
) = 0;

83 
	gvœtu®
 ~
CBrok”VŞumeDBIÁ”çû
 () { }

86 şas 
	cCSecur™yD‘aDBIÁ”çû
 {

87 
	gpublic
:

88 
vœtu®
 
DoSecur™yD‘aF¿me1
(cÚ¡ 
TSecur™yD‘aF¿me1IÅut
 *
pIn
, 
TSecur™yD‘aF¿me1Ouut
 *
pOut
) = 0;

89 
	gvœtu®
 ~
CSecur™yD‘aDBIÁ”çû
 () { }

92 şas 
	cCM¬k‘W©chDBIÁ”çû
 {

93 
	gpublic
:

94 
vœtu®
 
DoM¬k‘W©chF¿me1
 (cÚ¡ 
TM¬k‘W©chF¿me1IÅut
 *
pIn
, 
TM¬k‘W©chF¿me1Ouut
 *
pOut
) = 0;

95 
	gvœtu®
 ~
CM¬k‘W©chDBIÁ”çû
 () { }

98 şas 
	cCT¿deLookupDBIÁ”çû
 {

99 
	gpublic
:

100 
vœtu®
 
DoT¿deLookupF¿me1
(cÚ¡ 
TT¿deLookupF¿me1IÅut
 *
pIn
, 
TT¿deLookupF¿me1Ouut
 *
pOut
) = 0;

101 
vœtu®
 
DoT¿deLookupF¿me2
(cÚ¡ 
TT¿deLookupF¿me2IÅut
 *
pIn
, 
TT¿deLookupF¿me2Ouut
 *
pOut
) = 0;

102 
vœtu®
 
DoT¿deLookupF¿me3
(cÚ¡ 
TT¿deLookupF¿me3IÅut
 *
pIn
, 
TT¿deLookupF¿me3Ouut
 *
pOut
) = 0;

103 
vœtu®
 
DoT¿deLookupF¿me4
(cÚ¡ 
TT¿deLookupF¿me4IÅut
 *
pIn
, 
TT¿deLookupF¿me4Ouut
 *
pOut
) = 0;

104 
	gvœtu®
 ~
CT¿deLookupDBIÁ”çû
 () { }

107 şas 
	cCT¿deUpd©eDBIÁ”çû
 {

108 
	gpublic
:

109 
vœtu®
 
DoT¿deUpd©eF¿me1
(cÚ¡ 
TT¿deUpd©eF¿me1IÅut
 *
pIn
, 
TT¿deUpd©eF¿me1Ouut
 *
pOut
) = 0;

110 
vœtu®
 
DoT¿deUpd©eF¿me2
(cÚ¡ 
TT¿deUpd©eF¿me2IÅut
 *
pIn
, 
TT¿deUpd©eF¿me2Ouut
 *
pOut
) = 0;

111 
vœtu®
 
DoT¿deUpd©eF¿me3
(cÚ¡ 
TT¿deUpd©eF¿me3IÅut
 *
pIn
, 
TT¿deUpd©eF¿me3Ouut
 *
pOut
) = 0;

112 
	gvœtu®
 ~
CT¿deUpd©eDBIÁ”çû
 () { }

115 şas 
	cCT¿deResuÉDBIÁ”çû
 {

116 
	gpublic
:

117 
vœtu®
 
DoT¿deResuÉF¿me1
(cÚ¡ 
TT¿deResuÉF¿me1IÅut
 *
pIn
, 
TT¿deResuÉF¿me1Ouut
 *
pOut
) = 0;

118 
vœtu®
 
DoT¿deResuÉF¿me2
(cÚ¡ 
TT¿deResuÉF¿me2IÅut
 *
pIn
, 
TT¿deResuÉF¿me2Ouut
 *
pOut
) = 0;

119 
vœtu®
 
DoT¿deResuÉF¿me3
(cÚ¡ 
TT¿deResuÉF¿me3IÅut
 *
pIn
, 
TT¿deResuÉF¿me3Ouut
 *
pOut
) = 0;

120 
vœtu®
 
DoT¿deResuÉF¿me4
(cÚ¡ 
TT¿deResuÉF¿me4IÅut
 *
pIn
, 
TT¿deResuÉF¿me4Ouut
 *
pOut
) = 0;

121 
vœtu®
 
DoT¿deResuÉF¿me5
(cÚ¡ 
TT¿deResuÉF¿me5IÅut
 *
pIn
 ) = 0;

122 
vœtu®
 
DoT¿deResuÉF¿me6
(cÚ¡ 
TT¿deResuÉF¿me6IÅut
 *
pIn
, 
TT¿deResuÉF¿me6Ouut
 *
pOut
) = 0;

123 
	gvœtu®
 ~
CT¿deResuÉDBIÁ”çû
 () { }

126 şas 
	cCM¬k‘F“dDBIÁ”çû
 {

127 
	gpublic
:

128 
vœtu®
 
DoM¬k‘F“dF¿me1
(cÚ¡ 
TM¬k‘F“dF¿me1IÅut
 *
pIn
, 
TM¬k‘F“dF¿me1Ouut
 *
pOut
, 
CS’dToM¬k‘IÁ”çû
 *
pS’dToM¬k‘
) = 0;

129 
	gvœtu®
 ~
CM¬k‘F“dDBIÁ”çû
 () { }

132 şas 
	cCD©aMaš‹ÇnûDBIÁ”çû
 {

133 
	gpublic
:

134 
vœtu®
 
DoD©aMaš‹ÇnûF¿me1
(cÚ¡ 
TD©aMaš‹ÇnûF¿me1IÅut
 *
pIn
) = 0;

135 
	gvœtu®
 ~
CD©aMaš‹ÇnûDBIÁ”çû
 () { }

138 şas 
	cCT¿deCËªupDBIÁ”çû
 {

139 
	gpublic
:

140 
vœtu®
 
DoT¿deCËªupF¿me1
(cÚ¡ 
TT¿deCËªupF¿me1IÅut
 *
pIn
) = 0;

141 
	gvœtu®
 ~
CT¿deCËªupDBIÁ”çû
 () { }

	@include/workload/tpce/egen/TxnHarnessDataMaintenance.h

37 #iâdeà
TXN_HARNESS_DATA_MAINTENANCE_H


38 
	#TXN_HARNESS_DATA_MAINTENANCE_H


	)

40 
	~"TxnH¬ÃssDBIÁ”çû.h
"

42 
Çme¥aû
 
	gTPCE


45 şas 
	cCD©aMaš‹Çnû


47 
CD©aMaš‹ÇnûDBIÁ”çû
* 
	gm_db
;

49 
	gpublic
:

50 
CD©aMaš‹Çnû
(
CD©aMaš‹ÇnûDBIÁ”çû
 *
pDB
)

51 : 
m_db
(
pDB
)

55 
DoTxn
Ğ
PD©aMaš‹ÇnûTxnIÅut
 
pTxnIÅut
, 
PD©aMaš‹ÇnûTxnOuut
 
pTxnOuut
 )

57 
	gTXN_HARNESS_SET_STATUS_SUCCESS
;

60 
	gm_db
->
DoD©aMaš‹ÇnûF¿me1
(
pTxnIÅut
);

	@include/workload/tpce/egen/TxnHarnessMarketFeed.h

37 #iâdeà
TXN_HARNESS_MARKET_FEED_H


38 
	#TXN_HARNESS_MARKET_FEED_H


	)

40 
	~"TxnH¬ÃssDBIÁ”çû.h
"

42 
Çme¥aû
 
	gTPCE


45 şas 
	cCM¬k‘F“d


47 
CM¬k‘F“dDBIÁ”çû
* 
	gm_db
;

48 
CS’dToM¬k‘IÁ”çû
* 
	gm_pS’dToM¬k‘
;

50 
	gpublic
:

51 
CM¬k‘F“d
(
CM¬k‘F“dDBIÁ”çû
 *
pDB
, 
CS’dToM¬k‘IÁ”çû
 *
pS’dToM¬k‘
)

52 : 
m_db
(
pDB
)

53 , 
m_pS’dToM¬k‘
(
pS’dToM¬k‘
)

57 
DoTxn
Ğ
PM¬k‘F“dTxnIÅut
 
pTxnIÅut
, 
PM¬k‘F“dTxnOuut
 
pTxnOuut
 )

60 
TM¬k‘F“dF¿me1IÅut
 
	gF¿me1IÅut
;

61 
TM¬k‘F“dF¿me1Ouut
 
	gF¿me1Ouut
;

63 
mem£t
(&
F¿me1IÅut
, 0, ( Frame1Input ));

64 
mem£t
(&
F¿me1Ouut
, 0, ( Frame1Output ));

66 
	gTXN_HARNESS_SET_STATUS_SUCCESS
;

69 
	gF¿me1IÅut
.
	gStusAndT¿deTy³
 = 
pTxnIÅut
->
StusAndT¿deTy³
;

70 
	gi
=0; i<
	gmax_ãed_Ën
; i++)

72 
	gF¿me1IÅut
.
	gEÁr›s
[0] = 
pTxnIÅut
->
EÁr›s
[0];

76 
	gm_db
->
DoM¬k‘F“dF¿me1
(&
F¿me1IÅut
, &
F¿me1Ouut
, 
m_pS’dToM¬k‘
);

79 ià(
	gF¿me1Ouut
.
	gnum_upd©ed
 < 
	gpTxnIÅut
->
	gunique_symbŞs
)

81 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
MFF1_ERROR1
);

85 
	gpTxnOuut
->
	g£nd_Ën
 = 
F¿me1Ouut
.
£nd_Ën
;

	@include/workload/tpce/egen/TxnHarnessMarketWatch.h

37 #iâdeà
TXN_HARNESS_MARKET_WATCH_H


38 
	#TXN_HARNESS_MARKET_WATCH_H


	)

40 
	~"TxnH¬ÃssDBIÁ”çû.h
"

42 
Çme¥aû
 
	gTPCE


45 şas 
	cCM¬k‘W©ch


47 
CM¬k‘W©chDBIÁ”çû
* 
	gm_db
;

49 
	gpublic
:

50 
CM¬k‘W©ch
(
CM¬k‘W©chDBIÁ”çû
 *
pDB
)

51 : 
m_db
(
pDB
)

55 
DoTxn
(
PM¬k‘W©chTxnIÅut
 
pTxnIÅut
, 
PM¬k‘W©chTxnOuut
 
pTxnOuut
)

57 
	gTXN_HARNESS_SET_STATUS_SUCCESS
;

59 iàĞ
	gpTxnIÅut
->
	gacù_id
 != 0 ||

60 
pTxnIÅut
->
c_id
 != 0 ||

61 
pTxnIÅut
->
šdu¡ry_Çme
[0] != '\0')

64 
TM¬k‘W©chF¿me1Ouut
 
F¿me1Ouut
;

65 
mem£t
(&
F¿me1Ouut
, 0, (Frame1Output));

68 
	gm_db
->
DoM¬k‘W©chF¿me1
(
pTxnIÅut
, &
F¿me1Ouut
);

71 
	gpTxnOuut
->
	gpù_chªge
 = 
F¿me1Ouut
.
pù_chªge
;

75 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
MWF1_ERROR1
);

	@include/workload/tpce/egen/TxnHarnessSecurityDetail.h

37 #iâdeà
TXN_HARNESS_SECURITY_DETAIL_H


38 
	#TXN_HARNESS_SECURITY_DETAIL_H


	)

40 
	~"TxnH¬ÃssDBIÁ”çû.h
"

42 
Çme¥aû
 
	gTPCE


45 şas 
	cCSecur™yD‘a


47 
CSecur™yD‘aDBIÁ”çû
* 
	gm_db
;

49 
	gpublic
:

50 
CSecur™yD‘a
(
CSecur™yD‘aDBIÁ”çû
 *
pDB
)

51 : 
m_db
(
pDB
)

55 
DoTxn
Ğ
PSecur™yD‘aTxnIÅut
 
pTxnIÅut
, 
PSecur™yD‘aTxnOuut
 
pTxnOuut
 )

58 
TSecur™yD‘aF¿me1Ouut
 
	gF¿me1Ouut
;

63 
	gpTxnOuut
->
	gÏ¡_vŞ
 = 0;

64 
	gpTxnOuut
->
	gÃws_Ën
 = 0;

65 
	gTXN_HARNESS_SET_STATUS_SUCCESS
;

68 
	gm_db
->
DoSecur™yD‘aF¿me1
(
pTxnIÅut
, &
F¿me1Ouut
);

71 ià((
	gF¿me1Ouut
.
	gday_Ën
 < 
	gmš_day_Ën
) ||

72 (
	gF¿me1Ouut
.
	gday_Ën
 > 
	gmax_day_Ën
))

74 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
SDF1_ERROR1
);

76 ià(
	gF¿me1Ouut
.
	gfš_Ën
 !ğ
max_fš_Ën
)

78 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
SDF1_ERROR2
);

80 ià(
	gF¿me1Ouut
.
	gÃws_Ën
 !ğ
max_Ãws_Ën
)

82 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
SDF1_ERROR3
);

86 
	gpTxnOuut
->
	gÏ¡_vŞ
 = 
F¿me1Ouut
.
Ï¡_vŞ
;

87 
	gpTxnOuut
->
	gÃws_Ën
 = 
F¿me1Ouut
.
Ãws_Ën
;

	@include/workload/tpce/egen/TxnHarnessSendToMarketInterface.h

42 #iâdeà
TXN_HARNESS_SEND_TO_MARKET_INTERFACE_H


43 
	#TXN_HARNESS_SEND_TO_MARKET_INTERFACE_H


	)

45 
	~"TxnH¬ÃssSŒuùs.h
"

46 
	~"MEET¿deReque¡AùiÚs.h
"

48 
Çme¥aû
 
	gTPCE


51 şas 
	cCS’dToM¬k‘IÁ”çû


53 
	gpublic
:

64 
vœtu®
 ~
CS’dToM¬k‘IÁ”çû
() {};

66 
boŞ
 
S’dToM¬k‘FromF¿me
(
TT¿deReque¡
 &
Œade_mes
)

68 
	gŒade_mes
.
	geAùiÚ
 = 
eMEEProûssOrd”
;

69  
S’dToM¬k‘
(
Œade_mes
);

72 
boŞ
 
S’dToM¬k‘FromH¬Ãss
(
TT¿deReque¡
 &
Œade_mes
)

74  
S’dToM¬k‘
(
Œade_mes
);

77 
	g´Ùeùed
:

78 
vœtu®
 
boŞ
 
S’dToM¬k‘
(
TT¿deReque¡
 &
Œade_mes
) = 0;

	@include/workload/tpce/egen/TxnHarnessStructs.h

40 #iâdeà
TXN_HARNESS_STRUCTS_H


41 
	#TXN_HARNESS_STRUCTS_H


	)

43 
	~"EG’Snd¬dTy³s.h
"

44 
	~"D©eTime.h
"

45 
	~"MiscCÚ¡s.h
"

46 
	~"TabËCÚ¡s.h
"

47 
	~"MEET¿deReque¡AùiÚs.h
"

48 
	~"Cu¡om”AccouÁsAndP”missiÚsTabË.h
"

50 
Çme¥aû
 
	gTPCE


54 
boŞ
 
	gİ”©Ü
< (cÚ¡ 
	gTIMESTAMP_STRUCT
& 
	gts1
, cÚ¡ TIMESTAMP_STRUCT& 
	gts2
);

56 cÚ¡ 
INT32
 
	giFšY—rs
 = 5;

57 cÚ¡ 
INT32
 
	giFšQŒP”Y—r
 = 4;

58 cÚ¡ 
INT32
 
	giMaxDayHi¡Üy
 = 10;

59 cÚ¡ 
INT32
 
	giMaxNews
 = 10;

62 cÚ¡ 
INT32
 
	gmš_brok”_li¡_Ën
 = 20;

63 cÚ¡ 
INT32
 
	gmax_brok”_li¡_Ën
 = 40;

66 cÚ¡ 
INT32
 
	gmax_acù_Ën
 = 
iMaxAccouÁsP”Cu¡
;

67 cÚ¡ 
INT32
 
	gmš_hi¡_Ën
 = 10 * 1;

68 cÚ¡ 
INT32
 
	gmax_hi¡_Ën
 = 10 * 3;

71 cÚ¡ 
INT32
 
	gmax_ãed_Ën
 = 20;

74 cÚ¡ 
INT32
 
	gmš_day_Ën
 = 5;

75 cÚ¡ 
INT32
 
	gmax_day_Ën
 = 20;

76 cÚ¡ 
INT32
 
	gmax_fš_Ën
 = 20;

77 cÚ¡ 
INT32
 
	gmax_Ãws_Ën
 = 2;

78 cÚ¡ 
INT32
 
	gmax_comp_Ën
 = 3;

81 cÚ¡ 
INT32
 
	gmax_Œade_¡©us_Ën
 = 50;

84 cÚ¡ 
INT32
 
	gmax_bË_Çme
 = 30;

90 
	#TXN_HARNESS_PROPAGATE_STATUS
(
code
) \

91 ià((
pTxnOuut
->
¡©us
 >ğ0è&& ((
code
) < 0)) \

94 
pTxnOuut
->
¡©us
 = (
code
); \

96 ià((
pTxnOuut
->
¡©us
 =ğ0è&& ((
code
) > 0)) \

99 
pTxnOuut
->
¡©us
 = (
code
); \

100 }

	)

102 
	#TXN_HARNESS_SET_STATUS_SUCCESS
 \

103 
pTxnOuut
->
¡©us
 = 
CBa£TxnE¼
::
SUCCESS
;

	)

108 
	sTBrok”VŞumeTxnIÅut


111 
	gbrok”_li¡
[
max_brok”_li¡_Ën
][
cB_NAME_Ën
+1];

112 
	g£ùÜ_Çme
[
cSC_NAME_Ën
+1];

113 } *
	tPBrok”VŞumeTxnIÅut
,

114 
	tTBrok”VŞumeF¿me1IÅut
,

115 *
	tPBrok”VŞumeF¿me1IÅut
;

117 
	sTBrok”VŞumeTxnOuut


120 
	gvŞume
[
max_brok”_li¡_Ën
];

121 
INT32
 
	gli¡_Ën
;

122 
INT32
 
	g¡©us
;

123 } *
	tPBrok”VŞumeTxnOuut
;

125 
	sTBrok”VŞumeF¿me1Ouut


128 
	gvŞume
[
max_brok”_li¡_Ën
];

129 
INT32
 
	gli¡_Ën
;

130 
	gbrok”_Çme
[
max_brok”_li¡_Ën
][
cB_NAME_Ën
+1];

131 } *
	tPBrok”VŞumeF¿me1Ouut
;

135 
	sTCu¡om”Pos™iÚTxnIÅut


137 
TId’t
 
	gacù_id_idx
;

138 
TId’t
 
	gcu¡_id
;

139 
boŞ
 
	gg‘_hi¡Üy
;

140 
	gx_id
[
cTAX_ID_Ën
+1];

141 } *
	tPCu¡om”Pos™iÚTxnIÅut
;

143 
	sTCu¡om”Pos™iÚTxnOuut


145 
	gas£t_tÙ®
[
max_acù_Ën
];

146 
	gÿsh_b®
[
max_acù_Ën
];

147 
TId’t
 
	gacù_id
[
max_acù_Ën
];

148 
TT¿de
 
	gŒade_id
[
max_hi¡_Ën
];

149 
TId’t
 
	gc_ad_id
;

150 
INT32
 
	gqty
[
max_hi¡_Ën
];

151 
INT32
 
	gacù_Ën
;

152 
INT32
 
	ghi¡_Ën
;

153 
INT32
 
	g¡©us
;

154 
TIMESTAMP_STRUCT
 
	ghi¡_dts
[
max_hi¡_Ën
];

155 
TIMESTAMP_STRUCT
 
	gc_dob
;

156 
	gsymbŞ
[
max_hi¡_Ën
][
cSYMBOL_Ën
+1];

157 
	gŒade_¡©us
[
max_hi¡_Ën
][
cST_NAME_Ën
+1];

158 
	gc_¬—_1
[
cAREA_Ën
+1];

159 
	gc_¬—_2
[
cAREA_Ën
+1];

160 
	gc_¬—_3
[
cAREA_Ën
+1];

161 
	gc_ùry_1
[
cCTRY_Ën
+1];

162 
	gc_ùry_2
[
cCTRY_Ën
+1];

163 
	gc_ùry_3
[
cCTRY_Ën
+1];

164 
	gc_ema_1
[
cEMAIL_Ën
+1];

165 
	gc_ema_2
[
cEMAIL_Ën
+1];

166 
	gc_ext_1
[
cEXT_Ën
+1];

167 
	gc_ext_2
[
cEXT_Ën
+1];

168 
	gc_ext_3
[
cEXT_Ën
+1];

169 
	gc_f_Çme
[
cF_NAME_Ën
+1];

170 
	gc_gndr
[
cGNDR_Ën
+1];

171 
	gc_l_Çme
[
cL_NAME_Ën
+1];

172 
	gc_loÿl_1
[
cLOCAL_Ën
+1];

173 
	gc_loÿl_2
[
cLOCAL_Ën
+1];

174 
	gc_loÿl_3
[
cLOCAL_Ën
+1];

175 
	gc_m_Çme
[
cM_NAME_Ën
+1];

176 
	gc_¡_id
[
cST_ID_Ën
+1];

177 
	gc_t›r
;

178 } *
	tPCu¡om”Pos™iÚTxnOuut
;

180 
	sTCu¡om”Pos™iÚF¿me1IÅut


182 
TId’t
 
	gcu¡_id
;

183 
	gx_id
[
cTAX_ID_Ën
+1];

184 } *
	tPCu¡om”Pos™iÚF¿me1IÅut
;

186 
	sTCu¡om”Pos™iÚF¿me1Ouut


188 
	gas£t_tÙ®
[
max_acù_Ën
];

189 
	gÿsh_b®
[
max_acù_Ën
];

190 
TId’t
 
	gacù_id
[
max_acù_Ën
];

191 
TId’t
 
	gc_ad_id
;

192 
TId’t
 
	gcu¡_id
;

193 
INT32
 
	gacù_Ën
;

194 
TIMESTAMP_STRUCT
 
	gc_dob
;

195 
	gc_¬—_1
[
cAREA_Ën
+1];

196 
	gc_¬—_2
[
cAREA_Ën
+1];

197 
	gc_¬—_3
[
cAREA_Ën
+1];

198 
	gc_ùry_1
[
cCTRY_Ën
+1];

199 
	gc_ùry_2
[
cCTRY_Ën
+1];

200 
	gc_ùry_3
[
cCTRY_Ën
+1];

201 
	gc_ema_1
[
cEMAIL_Ën
+1];

202 
	gc_ema_2
[
cEMAIL_Ën
+1];

203 
	gc_ext_1
[
cEXT_Ën
+1];

204 
	gc_ext_2
[
cEXT_Ën
+1];

205 
	gc_ext_3
[
cEXT_Ën
+1];

206 
	gc_f_Çme
[
cF_NAME_Ën
+1];

207 
	gc_gndr
[
cGNDR_Ën
+1];

208 
	gc_l_Çme
[
cL_NAME_Ën
+1];

209 
	gc_loÿl_1
[
cLOCAL_Ën
+1];

210 
	gc_loÿl_2
[
cLOCAL_Ën
+1];

211 
	gc_loÿl_3
[
cLOCAL_Ën
+1];

212 
	gc_m_Çme
[
cM_NAME_Ën
+1];

213 
	gc_¡_id
[
cST_ID_Ën
+1];

214 
	gc_t›r
;

215 } *
	tPCu¡om”Pos™iÚF¿me1Ouut
;

217 
	sTCu¡om”Pos™iÚF¿me2IÅut


219 
TId’t
 
	gacù_id
;

220 } *
	tPCu¡om”Pos™iÚF¿me2IÅut
;

222 
	sTCu¡om”Pos™iÚF¿me2Ouut


224 
TT¿de
 
	gŒade_id
[
max_hi¡_Ën
];

225 
INT32
 
	gqty
[
max_hi¡_Ën
];

226 
INT32
 
	ghi¡_Ën
;

227 
TIMESTAMP_STRUCT
 
	ghi¡_dts
[
max_hi¡_Ën
];

228 
	gsymbŞ
[
max_hi¡_Ën
][
cSYMBOL_Ën
+1];

229 
	gŒade_¡©us
[
max_hi¡_Ën
][
cST_NAME_Ën
+1];

230 } *
	tPCu¡om”Pos™iÚF¿me2Ouut
;

237 
	sTD©aMaš‹ÇnûTxnIÅut


239 
TId’t
 
	gacù_id
;

240 
TId’t
 
	gc_id
;

241 
TId’t
 
	gco_id
;

242 
INT32
 
	gday_of_mÚth
;

243 
INT32
 
	gvŞ_šü
;

244 
	gsymbŞ
[
cSYMBOL_Ën
+1];

245 
	gbË_Çme
[
max_bË_Çme
+1];

246 
	gtx_id
[
cTX_ID_Ën
+1];

247 } *
	tPD©aMaš‹ÇnûTxnIÅut
,

248 
	tTD©aMaš‹ÇnûF¿me1IÅut
,

249 *
	tPD©aMaš‹ÇnûF¿me1IÅut
;

251 
	sTD©aMaš‹ÇnûTxnOuut


253 
INT32
 
	g¡©us
;

254 } *
	tPD©aMaš‹ÇnûTxnOuut
;

260 
	sTStusAndT¿deTy³


262 
	g¡©us_subm™‹d
[
cST_ID_Ën
+1];

263 
	gty³_lim™_buy
[
cTT_ID_Ën
+1];

264 
	gty³_lim™_£Î
[
cTT_ID_Ën
+1];

265 
	gty³_¡İ_loss
[
cTT_ID_Ën
+1];

266 } *
	tPTStusAndT¿deTy³
;

269 
	sTT¿deReque¡


271 
	g´iû_quÙe
;

272 
TT¿de
 
	gŒade_id
;

273 
INT32
 
	gŒade_qty
;

274 
eMEET¿deReque¡AùiÚ
 
	geAùiÚ
;

275 
	gsymbŞ
[
cSYMBOL_Ën
+1];

276 
	gŒade_ty³_id
[
cTT_ID_Ën
+1];

277 } *
	tPT¿deReque¡
;

280 
	sTTick”EÁry


282 
	g´iû_quÙe
;

283 
INT32
 
	gŒade_qty
;

284 
	gsymbŞ
[
cSYMBOL_Ën
+1];

285 } *
	tPTick”EÁry
;

288 
	sTM¬k‘F“dTxnIÅut


290 
INT32
 
	gunique_symbŞs
;

291 
	gzz_·ddšg1
[4];

292 
TStusAndT¿deTy³
 
	gStusAndT¿deTy³
;

293 
	gzz_·ddšg2
[4];

294 
TTick”EÁry
 
	gEÁr›s
[
max_ãed_Ën
];

295 } *
	tPM¬k‘F“dTxnIÅut
;

297 
	sTM¬k‘F“dTxnOuut


299 
INT32
 
	g£nd_Ën
;

300 
INT32
 
	g¡©us
;

301 } *
	tPM¬k‘F“dTxnOuut
;

303 
	sTM¬k‘F“dF¿me1IÅut


305 
TStusAndT¿deTy³
 
	gStusAndT¿deTy³
;

306 
	gzz_·ddšg
[4];

307 
TTick”EÁry
 
	gEÁr›s
[
max_ãed_Ën
];

308 } *
	tPM¬k‘F“dF¿me1IÅut
;

310 
	sTM¬k‘F“dF¿me1Ouut


312 
INT32
 
	gnum_upd©ed
;

313 
INT32
 
	g£nd_Ën
;

314 } *
	tPM¬k‘F“dF¿me1Ouut
;

320 
	sTM¬k‘W©chTxnIÅut


322 
TId’t
 
	gacù_id
;

323 
TId’t
 
	gc_id
;

324 
TId’t
 
	g’dšg_co_id
;

325 
TId’t
 
	g¡¬tšg_co_id
;

326 
TIMESTAMP_STRUCT
 
	g¡¬t_day
;

327 
	gšdu¡ry_Çme
[
cIN_NAME_Ën
+1];

328 } *
	tPM¬k‘W©chTxnIÅut
,

329 
	tTM¬k‘W©chF¿me1IÅut
,

330 *
	tPM¬k‘W©chF¿me1IÅut
;

332 
	sTM¬k‘W©chTxnOuut


334 
	gpù_chªge
;

335 
INT32
 
	g¡©us
;

336 } *
	tPM¬k‘W©chTxnOuut
;

338 
	sTM¬k‘W©chF¿me1Ouut


340 
	gpù_chªge
;

341 } *
	tPM¬k‘W©chF¿me1Ouut
;

347 
	sTFšInfo


349 
	gas£ts
;

350 
	gbasic_•s
;

351 
	gdut_•s
;

352 
	gšv’t
;

353 
	glŸb
;

354 
	gm¬gš
;

355 
	gÃt_—º
;

356 
	gout_basic
;

357 
	gout_dut
;

358 
	g»v
;

359 
INT32
 
	gqŒ
;

360 
INT32
 
	gy—r
;

361 
TIMESTAMP_STRUCT
 
	g¡¬t_d©e
;

362 
DB_INDICATOR
 
	gas£ts_šd
;

363 
DB_INDICATOR
 
	gbasic_•s_šd
;

364 
DB_INDICATOR
 
	gdut_•s_šd
;

365 
DB_INDICATOR
 
	gšv’t_šd
;

366 
DB_INDICATOR
 
	glŸb_šd
;

367 
DB_INDICATOR
 
	gm¬gš_šd
;

368 
DB_INDICATOR
 
	gÃt_—º_šd
;

369 
DB_INDICATOR
 
	gout_basic_šd
;

370 
DB_INDICATOR
 
	gout_dut_šd
;

371 
DB_INDICATOR
 
	gqŒ_šd
;

372 
DB_INDICATOR
 
	g»v_šd
;

373 
DB_INDICATOR
 
	g¡¬t_d©e_šd
;

374 
DB_INDICATOR
 
	gy—r_šd
;

375 } *
	tPFšInfo
;

377 
	sTDayHi¡Üy


379 
	gşo£
;

380 
	ghigh
;

381 
	glow
;

382 
INT64
 
	gvŞ
;

383 
TIMESTAMP_STRUCT
 
	gd©e
;

384 
DB_INDICATOR
 
	gşo£_šd
;

385 
DB_INDICATOR
 
	gd©e_šd
;

386 
DB_INDICATOR
 
	ghigh_šd
;

387 
DB_INDICATOR
 
	glow_šd
;

388 
DB_INDICATOR
 
	gvŞ_šd
;

389 } *
	tPDayHi¡Üy
;

391 
	sTNews


393 
TIMESTAMP_STRUCT
 
	gdts
;

394 
	gauth
[
cNI_AUTHOR_Ën
+1];

395 
	gh—dlše
[
cNI_HEADLINE_Ën
+1];

396 
	g™em
[
cNI_ITEM_Ën
+1];

397 
	g¤c
[
cNI_SOURCE_Ën
+1];

398 
	gsumm¬y
[
cNI_SUMMARY_Ën
+1];

399 
DB_INDICATOR
 
	gauth_šd
;

400 } *
	tPNews
;

402 
	sTSecur™yD‘aTxnIÅut


404 
INT32
 
	gmax_rows_to_»tuº
;

405 
boŞ
 
	gacûss_lob_æag
;

406 
TIMESTAMP_STRUCT
 
	g¡¬t_day
;

407 
	gsymbŞ
[
cSYMBOL_Ën
+1];

408 } *
	tPSecur™yD‘aTxnIÅut
,

409 
	tTSecur™yD‘aF¿me1IÅut
,

410 *
	tPSecur™yD‘aF¿me1IÅut
;

412 
	sTSecur™yD‘aTxnOuut


414 
INT64
 
	gÏ¡_vŞ
;

415 
INT32
 
	gÃws_Ën
;

416 
INT32
 
	g¡©us
;

417 } *
	tPSecur™yD‘aTxnOuut
;

419 
	sTSecur™yD‘aF¿me1Ouut


421 
	gdivid
;

422 
	gÏ¡_İ’
;

423 
	gÏ¡_´iû
;

424 
	g³_¿tio
;

425 
	gs52_wk_high
;

426 
	gs52_wk_low
;

427 
	gy›ld
;

428 
INT64
 
	gÏ¡_vŞ
;

429 
INT64
 
	gnum_out
;

430 
INT32
 
	gday_Ën
;

431 
INT32
 
	gex_şo£
;

432 
INT32
 
	gex_num_symb
;

433 
INT32
 
	gex_İ’
;

434 
INT32
 
	gfš_Ën
;

435 
INT32
 
	gÃws_Ën
;

436 
TIMESTAMP_STRUCT
 
	gex_d©e
;

437 
TIMESTAMP_STRUCT
 
	gİ’_d©e
;

438 
TIMESTAMP_STRUCT
 
	gs52_wk_high_d©e
;

439 
TIMESTAMP_STRUCT
 
	gs52_wk_low_d©e
;

440 
TIMESTAMP_STRUCT
 
	g¡¬t_d©e
;

441 
TDayHi¡Üy
 
	gday
[
max_day_Ën
];

442 
TFšInfo
 
	gfš
[
max_fš_Ën
];

443 
TNews
 
	gÃws
[
max_Ãws_Ën
];

444 
	gı_co_Çme
[
max_comp_Ën
][
cCO_NAME_Ën
+1];

445 
	gı_š_Çme
[
max_comp_Ën
][
cIN_NAME_Ën
+1];

446 
	gûo_Çme
[
cCEO_NAME_Ën
+1];

447 
	gco_ad_ùy
[
cAD_CTRY_Ën
+1];

448 
	gco_ad_div
[
cAD_DIV_Ën
+1];

449 
	gco_ad_lše1
[
cAD_LINE_Ën
+1];

450 
	gco_ad_lše2
[
cAD_LINE_Ën
+1];

451 
	gco_ad_town
[
cAD_TOWN_Ën
+1];

452 
	gco_ad_z
[
cAD_ZIP_Ën
+1];

453 
	gco_desc
[
cCO_DESC_Ën
+1];

454 
	gco_Çme
[
cCO_NAME_Ën
+1];

455 
	gco_¡_id
[
cST_ID_Ën
+1];

456 
	gex_ad_ùy
[
cAD_CTRY_Ën
+1];

457 
	gex_ad_div
[
cAD_DIV_Ën
+1];

458 
	gex_ad_lše1
[
cAD_LINE_Ën
+1];

459 
	gex_ad_lše2
[
cAD_LINE_Ën
+1];

460 
	gex_ad_town
[
cAD_TOWN_Ën
+1];

461 
	gex_ad_z
[
cAD_ZIP_Ën
+1];

462 
	gex_desc
[
cEX_DESC_Ën
+1];

463 
	gex_Çme
[
cEX_NAME_Ën
+1];

464 
	gs_Çme
[
cS_NAME_Ën
+1];

465 
	g¥_¿‹
[
cSP_RATE_Ën
+1];

466 } *
	tPSecur™yD‘aF¿me1Ouut
;

472 
	sTT¿deLookupTxnIÅut


474 
TT¿de
 
	gŒade_id
[
T¿deLookupF¿me1MaxRows
];

475 
TId’t
 
	gacù_id
;

476 
TId’t
 
	gmax_acù_id
;

477 
INT32
 
	gäame_to_execu‹
;

478 
INT32
 
	gmax_Œades
;

479 
TIMESTAMP_STRUCT
 
	g’d_Œade_dts
;

480 
TIMESTAMP_STRUCT
 
	g¡¬t_Œade_dts
;

481 
	gsymbŞ
[
cSYMBOL_Ën
+1];

482 } *
	tPT¿deLookupTxnIÅut
;

483 
	sTT¿deLookupTxnOuut


485 
TT¿de
 
	gŒade_li¡
[
T¿deLookupMaxRows
];

486 
INT32
 
	gäame_execu‹d
;

487 
INT32
 
	gnum_found
;

488 
INT32
 
	g¡©us
;

489 
boŞ
 
	gis_ÿsh
[
T¿deLookupMaxRows
];

490 
boŞ
 
	gis_m¬k‘
[
T¿deLookupMaxRows
];

491 } *
	tPT¿deLookupTxnOuut
;

493 
	sTT¿deLookupF¿me1IÅut


495 
TT¿de
 
	gŒade_id
[
T¿deLookupF¿me1MaxRows
];

496 
INT32
 
	gmax_Œades
;

497 } *
	tPT¿deLookupF¿me1IÅut
;

501 
	sTT¿deLookupF¿me1T¿deInfo


503 
	gbid_´iû
;

504 
	gÿsh_Œª§ùiÚ_amouÁ
;

505 
	g£‰Ëm’t_amouÁ
;

506 
	gŒade_´iû
;

507 
boŞ
 
	gis_ÿsh
;

508 
boŞ
 
	gis_m¬k‘
;

509 
TIMESTAMP_STRUCT
 
	gŒade_hi¡Üy_dts
[
T¿deLookupMaxT¿deHi¡ÜyRowsR‘uºed
];

510 
TIMESTAMP_STRUCT
 
	gÿsh_Œª§ùiÚ_dts
;

511 
TIMESTAMP_STRUCT
 
	g£‰Ëm’t_ÿsh_due_d©e
;

512 
	gŒade_hi¡Üy_¡©us_id
[
T¿deLookupMaxT¿deHi¡ÜyRowsR‘uºed
][
cTH_ST_ID_Ën
+1];

513 
	gÿsh_Œª§ùiÚ_Çme
[
cCT_NAME_Ën
+1];

514 
	gexec_Çme
[
cEXEC_NAME_Ën
+1];

515 
	g£‰Ëm’t_ÿsh_ty³
[
cSE_CASH_TYPE_Ën
+1];

516 
DB_INDICATOR
 
	gŒade_hi¡Üy_dts_šd
[
T¿deLookupMaxT¿deHi¡ÜyRowsR‘uºed
];

517 
DB_INDICATOR
 
	gŒade_hi¡Üy_¡©us_id_šd
[
T¿deLookupMaxT¿deHi¡ÜyRowsR‘uºed
];

518 
DB_INDICATOR
 
	gbid_´iû_šd
;

519 
DB_INDICATOR
 
	gÿsh_Œª§ùiÚ_amouÁ_šd
;

520 
DB_INDICATOR
 
	gÿsh_Œª§ùiÚ_dts_šd
;

521 
DB_INDICATOR
 
	gÿsh_Œª§ùiÚ_Çme_šd
;

522 
DB_INDICATOR
 
	gexec_Çme_šd
;

523 
DB_INDICATOR
 
	gis_ÿsh_šd
;

524 
DB_INDICATOR
 
	gis_m¬k‘_šd
;

525 
DB_INDICATOR
 
	g£‰Ëm’t_amouÁ_šd
;

526 
DB_INDICATOR
 
	g£‰Ëm’t_ÿsh_due_d©e_šd
;

527 
DB_INDICATOR
 
	g£‰Ëm’t_ÿsh_ty³_šd
;

528 
DB_INDICATOR
 
	gŒade_´iû_šd
;

529 } *
	tPT¿deLookupF¿me1T¿deInfo
;

531 
	sTT¿deLookupF¿me1Ouut


533 
INT32
 
	gnum_found
;

534 
TT¿deLookupF¿me1T¿deInfo
 
	gŒade_šfo
[
T¿deLookupF¿me1MaxRows
];

535 } *
	tPT¿deLookupF¿me1Ouut
;

537 
	sTT¿deLookupF¿me2IÅut


539 
TId’t
 
	gacù_id
;

540 
INT32
 
	gmax_Œades
;

541 
TIMESTAMP_STRUCT
 
	g’d_Œade_dts
;

542 
TIMESTAMP_STRUCT
 
	g¡¬t_Œade_dts
;

543 } *
	tPT¿deLookupF¿me2IÅut
;

547 
	sTT¿deLookupF¿me2T¿deInfo


549 
	gbid_´iû
;

550 
	gÿsh_Œª§ùiÚ_amouÁ
;

551 
	g£‰Ëm’t_amouÁ
;

552 
	gŒade_´iû
;

553 
TT¿de
 
	gŒade_id
;

554 
boŞ
 
	gis_ÿsh
;

555 
TIMESTAMP_STRUCT
 
	gŒade_hi¡Üy_dts
[
T¿deLookupMaxT¿deHi¡ÜyRowsR‘uºed
];

556 
TIMESTAMP_STRUCT
 
	gÿsh_Œª§ùiÚ_dts
;

557 
TIMESTAMP_STRUCT
 
	g£‰Ëm’t_ÿsh_due_d©e
;

558 
	gŒade_hi¡Üy_¡©us_id
[
T¿deLookupMaxT¿deHi¡ÜyRowsR‘uºed
][
cTH_ST_ID_Ën
+1];

559 
	gÿsh_Œª§ùiÚ_Çme
[
cCT_NAME_Ën
+1];

560 
	gexec_Çme
[
cEXEC_NAME_Ën
+1];

561 
	g£‰Ëm’t_ÿsh_ty³
[
cSE_CASH_TYPE_Ën
+1];

562 
DB_INDICATOR
 
	gŒade_hi¡Üy_dts_šd
[
T¿deLookupMaxT¿deHi¡ÜyRowsR‘uºed
];

563 
DB_INDICATOR
 
	gŒade_hi¡Üy_¡©us_id_šd
[
T¿deLookupMaxT¿deHi¡ÜyRowsR‘uºed
];

564 
DB_INDICATOR
 
	gbid_´iû_šd
;

565 
DB_INDICATOR
 
	gÿsh_Œª§ùiÚ_amouÁ_šd
;

566 
DB_INDICATOR
 
	gÿsh_Œª§ùiÚ_dts_šd
;

567 
DB_INDICATOR
 
	gÿsh_Œª§ùiÚ_Çme_šd
;

568 
DB_INDICATOR
 
	gexec_Çme_šd
;

569 
DB_INDICATOR
 
	gis_ÿsh_šd
;

570 
DB_INDICATOR
 
	g£‰Ëm’t_amouÁ_šd
;

571 
DB_INDICATOR
 
	g£‰Ëm’t_ÿsh_due_d©e_šd
;

572 
DB_INDICATOR
 
	g£‰Ëm’t_ÿsh_ty³_šd
;

573 
DB_INDICATOR
 
	gŒade_id_šd
;

574 
DB_INDICATOR
 
	gŒade_´iû_šd
;

575 } *
	tPT¿deLookupF¿me2T¿deInfo
;

577 
	sTT¿deLookupF¿me2Ouut


579 
INT32
 
	gnum_found
;

580 
TT¿deLookupF¿me2T¿deInfo
 
	gŒade_šfo
[
T¿deLookupF¿me2MaxRows
];

581 } *
	tPT¿deLookupF¿me2Ouut
;

583 
	sTT¿deLookupF¿me3IÅut


585 
TId’t
 
	gmax_acù_id
;

586 
INT32
 
	gmax_Œades
;

587 
TIMESTAMP_STRUCT
 
	g’d_Œade_dts
;

588 
TIMESTAMP_STRUCT
 
	g¡¬t_Œade_dts
;

589 
	gsymbŞ
[
cSYMBOL_Ën
+1];

590 } *
	tPT¿deLookupF¿me3IÅut
;

594 
	sTT¿deLookupF¿me3T¿deInfo


596 
	gÿsh_Œª§ùiÚ_amouÁ
;

597 
	g´iû
;

598 
	g£‰Ëm’t_amouÁ
;

599 
TId’t
 
	gacù_id
;

600 
TT¿de
 
	gŒade_id
;

601 
INT32
 
	gquªt™y
;

602 
boŞ
 
	gis_ÿsh
;

603 
TIMESTAMP_STRUCT
 
	gŒade_hi¡Üy_dts
[
T¿deLookupMaxT¿deHi¡ÜyRowsR‘uºed
];

604 
TIMESTAMP_STRUCT
 
	gÿsh_Œª§ùiÚ_dts
;

605 
TIMESTAMP_STRUCT
 
	g£‰Ëm’t_ÿsh_due_d©e
;

606 
TIMESTAMP_STRUCT
 
	gŒade_dts
;

607 
	gŒade_hi¡Üy_¡©us_id
[
T¿deLookupMaxT¿deHi¡ÜyRowsR‘uºed
][
cTH_ST_ID_Ën
+1];

608 
	gÿsh_Œª§ùiÚ_Çme
[
cCT_NAME_Ën
+1];

609 
	gexec_Çme
[
cEXEC_NAME_Ën
+1];

610 
	g£‰Ëm’t_ÿsh_ty³
[
cSE_CASH_TYPE_Ën
+1];

611 
	gŒade_ty³
[
cTT_ID_Ën
+1];

612 
DB_INDICATOR
 
	gŒade_hi¡Üy_dts_šd
[
T¿deLookupMaxT¿deHi¡ÜyRowsR‘uºed
];

613 
DB_INDICATOR
 
	gŒade_hi¡Üy_¡©us_id_šd
[
T¿deLookupMaxT¿deHi¡ÜyRowsR‘uºed
];

614 
DB_INDICATOR
 
	gacù_id_šd
;

615 
DB_INDICATOR
 
	gÿsh_Œª§ùiÚ_amouÁ_šd
;

616 
DB_INDICATOR
 
	gÿsh_Œª§ùiÚ_dts_šd
;

617 
DB_INDICATOR
 
	gÿsh_Œª§ùiÚ_Çme_šd
;

618 
DB_INDICATOR
 
	gexec_Çme_šd
;

619 
DB_INDICATOR
 
	gis_ÿsh_šd
;

620 
DB_INDICATOR
 
	g´iû_šd
;

621 
DB_INDICATOR
 
	gquªt™y_šd
;

622 
DB_INDICATOR
 
	g£‰Ëm’t_amouÁ_šd
;

623 
DB_INDICATOR
 
	g£‰Ëm’t_ÿsh_due_d©e_šd
;

624 
DB_INDICATOR
 
	g£‰Ëm’t_ÿsh_ty³_šd
;

625 
DB_INDICATOR
 
	gŒade_dts_šd
;

626 
DB_INDICATOR
 
	gŒade_id_šd
;

627 
DB_INDICATOR
 
	gŒade_ty³_šd
;

628 } *
	tPT¿deLookupF¿me3T¿deInfo
;

630 
	sTT¿deLookupF¿me3Ouut


632 
INT32
 
	gnum_found
;

633 
TT¿deLookupF¿me3T¿deInfo
 
	gŒade_šfo
[
T¿deLookupF¿me3MaxRows
];

634 } *
	tPT¿deLookupF¿me3Ouut
;

636 
	sTT¿deLookupF¿me4IÅut


638 
TId’t
 
	gacù_id
;

639 
TIMESTAMP_STRUCT
 
	gŒade_dts
;

640 } *
	tPT¿deLookupF¿me4IÅut
;

644 
	sTT¿deLookupF¿me4T¿deInfo


646 
TT¿de
 
	ghŞdšg_hi¡Üy_id
;

647 
TT¿de
 
	ghŞdšg_hi¡Üy_Œade_id
;

648 
INT32
 
	gquªt™y_aá”
;

649 
INT32
 
	gquªt™y_befÜe
;

650 
DB_INDICATOR
 
	ghŞdšg_hi¡Üy_id_šd
;

651 
DB_INDICATOR
 
	ghŞdšg_hi¡Üy_Œade_id_šd
;

652 
DB_INDICATOR
 
	gquªt™y_aá”_šd
;

653 
DB_INDICATOR
 
	gquªt™y_befÜe_šd
;

654 } *
	tPT¿deLookupF¿me4T¿deInfo
;

656 
	sTT¿deLookupF¿me4Ouut


658 
TT¿de
 
	gŒade_id
;

659 
INT32
 
	gnum_found
;

660 
INT32
 
	gnum_Œades_found
;

661 
TT¿deLookupF¿me4T¿deInfo
 
	gŒade_šfo
[
T¿deLookupF¿me4MaxRows
];

662 } *
	tPT¿deLookupF¿me4Ouut
;

669 
	sTT¿deOrd”TxnIÅut


671 
	g»que¡ed_´iû
;

672 
TId’t
 
	gacù_id
;

673 
INT32
 
	gis_lifo
;

674 
INT32
 
	grŞl_™_back
;

675 
INT32
 
	gŒade_qty
;

676 
INT32
 
	gty³_is_m¬gš
;

677 
	gco_Çme
[
cCO_NAME_Ën
+1];

678 
	gexec_f_Çme
[
cF_NAME_Ën
+1];

679 
	gexec_l_Çme
[
cL_NAME_Ën
+1];

680 
	gexec_x_id
[
cTAX_ID_Ën
+1];

681 
	gissue
[
cS_ISSUE_Ën
+1];

682 
	g¡_³ndšg_id
[
cST_ID_Ën
+1];

683 
	g¡_subm™‹d_id
[
cST_ID_Ën
+1];

684 
	gsymbŞ
[
cSYMBOL_Ën
+1];

685 
	gŒade_ty³_id
[
cTT_ID_Ën
+1];

686 } *
	tPT¿deOrd”TxnIÅut
;

687 
	sTT¿deOrd”TxnOuut


689 
	gbuy_v®ue
;

690 
	g£Î_v®ue
;

691 
	gx_amouÁ
;

692 
TT¿de
 
	gŒade_id
;

693 
INT32
 
	g¡©us
;

694 } *
	tPT¿deOrd”TxnOuut
;

696 
	sTT¿deOrd”F¿me1IÅut


698 
TId’t
 
	gacù_id
;

699 } *
	tPT¿deOrd”F¿me1IÅut
;

701 
	sTT¿deOrd”F¿me1Ouut


703 
TId’t
 
	gbrok”_id
;

704 
TId’t
 
	gcu¡_id
;

705 
INT32
 
	gcu¡_t›r
;

706 
INT32
 
	gnum_found
;

707 
INT32
 
	gx_¡©us
;

708 
	gacù_Çme
[
cCA_NAME_Ën
+1];

709 
	gbrok”_Çme
[
cB_NAME_Ën
+1];

710 
	gcu¡_f_Çme
[
cF_NAME_Ën
+1];

711 
	gcu¡_l_Çme
[
cL_NAME_Ën
+1];

712 
	gx_id
[
cTAX_ID_Ën
+1];

713 } *
	tPT¿deOrd”F¿me1Ouut
;

715 
	sTT¿deOrd”F¿me2IÅut


717 
TId’t
 
	gacù_id
;

718 
	gexec_f_Çme
[
cF_NAME_Ën
+1];

719 
	gexec_l_Çme
[
cL_NAME_Ën
+1];

720 
	gexec_x_id
[
cTAX_ID_Ën
+1];

721 } *
	tPT¿deOrd”F¿me2IÅut
;

723 
	sTT¿deOrd”F¿me2Ouut


725 
	g­_aş
[
cACL_Ën
+1];

726 } *
	tPT¿deOrd”F¿me2Ouut
;

728 
	sTT¿deOrd”F¿me3IÅut


730 
	g»que¡ed_´iû
;

731 
TId’t
 
	gacù_id
;

732 
TId’t
 
	gcu¡_id
;

733 
INT32
 
	gcu¡_t›r
;

734 
INT32
 
	gis_lifo
;

735 
INT32
 
	gx_¡©us
;

736 
INT32
 
	gŒade_qty
;

737 
INT32
 
	gty³_is_m¬gš
;

738 
	gco_Çme
[
cCO_NAME_Ën
+1];

739 
	gissue
[
cS_ISSUE_Ën
+1];

740 
	g¡_³ndšg_id
[
cST_ID_Ën
+1];

741 
	g¡_subm™‹d_id
[
cST_ID_Ën
+1];

742 
	gsymbŞ
[
cSYMBOL_Ën
+1];

743 
	gŒade_ty³_id
[
cTT_ID_Ën
+1];

744 } *
	tPT¿deOrd”F¿me3IÅut
;

746 
	sTT¿deOrd”F¿me3Ouut


748 
	gacù_as£ts
;

749 
	gbuy_v®ue
;

750 
	gch¬ge_amouÁ
;

751 
	gcomm_¿‹
;

752 
	gm¬k‘_´iû
;

753 
	g»que¡ed_´iû
;

754 
	g£Î_v®ue
;

755 
	gx_amouÁ
;

756 
INT32
 
	gty³_is_m¬k‘
;

757 
INT32
 
	gty³_is_£Î
;

758 
	gco_Çme
[
cCO_NAME_Ën
+1];

759 
	gs_Çme
[
cS_NAME_Ën
+1];

760 
	g¡©us_id
[
cST_ID_Ën
+1];

761 
	gsymbŞ
[
cSYMBOL_Ën
+1];

762 } *
	tPT¿deOrd”F¿me3Ouut
;

764 
	sTT¿deOrd”F¿me4IÅut


766 
	gch¬ge_amouÁ
;

767 
	gcomm_amouÁ
;

768 
	g»que¡ed_´iû
;

769 
TId’t
 
	gacù_id
;

770 
TId’t
 
	gbrok”_id
;

771 
INT32
 
	gis_ÿsh
;

772 
INT32
 
	gis_lifo
;

773 
INT32
 
	gŒade_qty
;

774 
INT32
 
	gty³_is_m¬k‘
;

775 
	gexec_Çme
[
cEXEC_NAME_Ën
+1];

776 
	g¡©us_id
[
cST_ID_Ën
+1];

777 
	gsymbŞ
[
cSYMBOL_Ën
+1];

778 
	gŒade_ty³_id
[
cTT_ID_Ën
+1];

779 } *
	tPT¿deOrd”F¿me4IÅut
;

781 
	sTT¿deOrd”F¿me4Ouut


783 
TT¿de
 
	gŒade_id
;

784 } *
	tPT¿deOrd”F¿me4Ouut
;

791 
	sTT¿deResuÉTxnIÅut


793 
	gŒade_´iû
;

794 
TT¿de
 
	gŒade_id
;

795 } *
	tPT¿deResuÉTxnIÅut
;

797 
	sTT¿deResuÉTxnOuut


799 
	gacù_b®
;

800 
TId’t
 
	gacù_id
;

801 
INT32
 
	glßd_un™
;

802 
INT32
 
	g¡©us
;

803 } *
	tPT¿deResuÉTxnOuut
;

805 
	sTT¿deResuÉF¿me1IÅut


807 
TT¿de
 
	gŒade_id
;

808 } *
	tPT¿deResuÉF¿me1IÅut
;

810 
	sTT¿deResuÉF¿me1Ouut


812 
	gch¬ge
;

813 
TId’t
 
	gacù_id
;

814 
INT32
 
	ghs_qty
;

815 
INT32
 
	gis_lifo
;

816 
INT32
 
	gnum_found
;

817 
INT32
 
	gŒade_is_ÿsh
;

818 
INT32
 
	gŒade_qty
;

819 
INT32
 
	gty³_is_m¬k‘
;

820 
INT32
 
	gty³_is_£Î
;

821 
	gsymbŞ
[
cSYMBOL_Ën
+1];

822 
	gty³_id
[
cTT_ID_Ën
+1];

823 
	gty³_Çme
[
cTT_NAME_Ën
+1];

824 } *
	tPT¿deResuÉF¿me1Ouut
;

826 
	sTT¿deResuÉF¿me2IÅut


828 
	gŒade_´iû
;

829 
TId’t
 
	gacù_id
;

830 
TT¿de
 
	gŒade_id
;

831 
INT32
 
	ghs_qty
;

832 
INT32
 
	gis_lifo
;

833 
INT32
 
	gŒade_qty
;

834 
INT32
 
	gty³_is_£Î
;

835 
	gsymbŞ
[
cSYMBOL_Ën
+1];

836 } *
	tPT¿deResuÉF¿me2IÅut
;

838 
	sTT¿deResuÉF¿me2Ouut


840 
	gbuy_v®ue
;

841 
	g£Î_v®ue
;

842 
TId’t
 
	gbrok”_id
;

843 
TId’t
 
	gcu¡_id
;

844 
INT32
 
	gx_¡©us
;

845 
TIMESTAMP_STRUCT
 
	gŒade_dts
;

846 } *
	tPT¿deResuÉF¿me2Ouut
;

848 
	sTT¿deResuÉF¿me3IÅut


850 
	gbuy_v®ue
;

851 
	g£Î_v®ue
;

852 
TId’t
 
	gcu¡_id
;

853 
TT¿de
 
	gŒade_id
;

854 } *
	tPT¿deResuÉF¿me3IÅut
;

856 
	sTT¿deResuÉF¿me3Ouut


858 
	gx_amouÁ
;

859 } *
	tPT¿deResuÉF¿me3Ouut
;

861 
	sTT¿deResuÉF¿me4IÅut


863 
TId’t
 
	gcu¡_id
;

864 
INT32
 
	gŒade_qty
;

865 
	gsymbŞ
[
cSYMBOL_Ën
+1];

866 
	gty³_id
[
cTT_ID_Ën
+1];

867 } *
	tPT¿deResuÉF¿me4IÅut
;

869 
	sTT¿deResuÉF¿me4Ouut


871 
	gcomm_¿‹
;

872 
	gs_Çme
[
cS_NAME_Ën
+1];

873 } *
	tPT¿deResuÉF¿me4Ouut
;

875 
	sTT¿deResuÉF¿me5IÅut


877 
	gcomm_amouÁ
;

878 
	gŒade_´iû
;

879 
TId’t
 
	gbrok”_id
;

880 
TT¿de
 
	gŒade_id
;

881 
TIMESTAMP_STRUCT
 
	gŒade_dts
;

882 
	g¡_com¶‘ed_id
[
cST_ID_Ën
+1];

883 } *
	tPT¿deResuÉF¿me5IÅut
;

885 
	sTT¿deResuÉF¿me6IÅut


887 
	g£_amouÁ
;

888 
TId’t
 
	gacù_id
;

889 
TT¿de
 
	gŒade_id
;

890 
INT32
 
	gŒade_is_ÿsh
;

891 
INT32
 
	gŒade_qty
;

892 
TIMESTAMP_STRUCT
 
	gdue_d©e
;

893 
TIMESTAMP_STRUCT
 
	gŒade_dts
;

894 
	gs_Çme
[
cS_NAME_Ën
+1];

895 
	gty³_Çme
[
cTT_NAME_Ën
+1];

896 } *
	tPT¿deResuÉF¿me6IÅut
;

898 
	sTT¿deResuÉF¿me6Ouut


900 
	gacù_b®
;

901 } *
	tPT¿deResuÉF¿me6Ouut
;

907 
	sTT¿deStusTxnIÅut


909 
TId’t
 
	gacù_id
;

910 } *
	tPT¿deStusTxnIÅut
,

911 
	tTT¿deStusF¿me1IÅut
,

912 *
	tPT¿deStusF¿me1IÅut
;

914 
	sTT¿deStusTxnOuut


916 
TT¿de
 
	gŒade_id
[
max_Œade_¡©us_Ën
];

917 
INT32
 
	g¡©us
;

918 
	g¡©us_Çme
[
max_Œade_¡©us_Ën
][
cST_NAME_Ën
+1];

919 } *
	tPT¿deStusTxnOuut
;

921 
	sTT¿deStusF¿me1Ouut


923 
	gch¬ge
[
max_Œade_¡©us_Ën
];

924 
TT¿de
 
	gŒade_id
[
max_Œade_¡©us_Ën
];

925 
INT32
 
	gŒade_qty
[
max_Œade_¡©us_Ën
];

926 
INT32
 
	gnum_found
;

927 
TIMESTAMP_STRUCT
 
	gŒade_dts
[
max_Œade_¡©us_Ën
];

928 
	gex_Çme
[
max_Œade_¡©us_Ën
][
cEX_NAME_Ën
+1];

929 
	gexec_Çme
[
max_Œade_¡©us_Ën
][
cEXEC_NAME_Ën
+1];

930 
	gs_Çme
[
max_Œade_¡©us_Ën
][
cS_NAME_Ën
+1];

931 
	g¡©us_Çme
[
max_Œade_¡©us_Ën
][
cST_NAME_Ën
+1];

932 
	gsymbŞ
[
max_Œade_¡©us_Ën
][
cSYMBOL_Ën
+1];

933 
	gty³_Çme
[
max_Œade_¡©us_Ën
][
cTT_NAME_Ën
+1];

934 
	gbrok”_Çme
[
cB_NAME_Ën
+1];

935 
	gcu¡_f_Çme
[
cF_NAME_Ën
+1];

936 
	gcu¡_l_Çme
[
cL_NAME_Ën
+1];

937 } *
	tPT¿deStusF¿me1Ouut
;

943 
	sTT¿deUpd©eTxnIÅut


945 
TT¿de
 
	gŒade_id
[
T¿deUpd©eF¿me1MaxRows
];

946 
TId’t
 
	gacù_id
;

947 
TId’t
 
	gmax_acù_id
;

948 
INT32
 
	gäame_to_execu‹
;

949 
INT32
 
	gmax_Œades
;

950 
INT32
 
	gmax_upd©es
;

951 
TIMESTAMP_STRUCT
 
	g’d_Œade_dts
;

952 
TIMESTAMP_STRUCT
 
	g¡¬t_Œade_dts
;

953 
	gsymbŞ
[
cSYMBOL_Ën
+1];

954 } *
	tPT¿deUpd©eTxnIÅut
;

955 
	sTT¿deUpd©eTxnOuut


957 
TT¿de
 
	gŒade_li¡
[
T¿deUpd©eMaxRows
];

958 
INT32
 
	gäame_execu‹d
;

959 
INT32
 
	gnum_found
;

960 
INT32
 
	gnum_upd©ed
;

961 
INT32
 
	g¡©us
;

962 
boŞ
 
	gis_ÿsh
[
T¿deUpd©eMaxRows
];

963 
boŞ
 
	gis_m¬k‘
[
T¿deUpd©eMaxRows
];

964 } *
	tPT¿deUpd©eTxnOuut
;

966 
	sTT¿deUpd©eF¿me1IÅut


968 
TT¿de
 
	gŒade_id
[
T¿deUpd©eF¿me1MaxRows
];

969 
INT32
 
	gmax_Œades
;

970 
INT32
 
	gmax_upd©es
;

971 } *
	tPT¿deUpd©eF¿me1IÅut
;

973 
	sTT¿deUpd©eF¿me1T¿deInfo


975 
	gbid_´iû
;

976 
	gÿsh_Œª§ùiÚ_amouÁ
;

977 
	g£‰Ëm’t_amouÁ
;

978 
	gŒade_´iû
;

979 
boŞ
 
	gis_ÿsh
;

980 
boŞ
 
	gis_m¬k‘
;

981 
TIMESTAMP_STRUCT
 
	gŒade_hi¡Üy_dts
[
T¿deUpd©eMaxT¿deHi¡ÜyRowsR‘uºed
];

982 
TIMESTAMP_STRUCT
 
	gÿsh_Œª§ùiÚ_dts
;

983 
TIMESTAMP_STRUCT
 
	g£‰Ëm’t_ÿsh_due_d©e
;

984 
	gŒade_hi¡Üy_¡©us_id
[
T¿deUpd©eMaxT¿deHi¡ÜyRowsR‘uºed
][
cTH_ST_ID_Ën
+1];

985 
	gÿsh_Œª§ùiÚ_Çme
[
cCT_NAME_Ën
+1];

986 
	gexec_Çme
[
cEXEC_NAME_Ën
+1];

987 
	g£‰Ëm’t_ÿsh_ty³
[
cSE_CASH_TYPE_Ën
+1];

988 
DB_INDICATOR
 
	gŒade_hi¡Üy_dts_šd
[
T¿deUpd©eMaxT¿deHi¡ÜyRowsR‘uºed
];

989 
DB_INDICATOR
 
	gŒade_hi¡Üy_¡©us_id_šd
[
T¿deUpd©eMaxT¿deHi¡ÜyRowsR‘uºed
];

990 
DB_INDICATOR
 
	gbid_´iû_šd
;

991 
DB_INDICATOR
 
	gÿsh_Œª§ùiÚ_amouÁ_šd
;

992 
DB_INDICATOR
 
	gÿsh_Œª§ùiÚ_dts_šd
;

993 
DB_INDICATOR
 
	gÿsh_Œª§ùiÚ_Çme_šd
;

994 
DB_INDICATOR
 
	gexec_Çme_šd
;

995 
DB_INDICATOR
 
	gis_ÿsh_šd
;

996 
DB_INDICATOR
 
	gis_m¬k‘_šd
;

997 
DB_INDICATOR
 
	g£‰Ëm’t_amouÁ_šd
;

998 
DB_INDICATOR
 
	g£‰Ëm’t_ÿsh_due_d©e_šd
;

999 
DB_INDICATOR
 
	g£‰Ëm’t_ÿsh_ty³_šd
;

1000 
DB_INDICATOR
 
	gŒade_´iû_šd
;

1001 } *
	tPT¿deUpd©eF¿me1T¿deInfo
;

1003 
	sTT¿deUpd©eF¿me1Ouut


1005 
INT32
 
	gnum_found
;

1006 
INT32
 
	gnum_upd©ed
;

1007 
TT¿deUpd©eF¿me1T¿deInfo
 
	gŒade_šfo
[
T¿deUpd©eF¿me1MaxRows
];

1008 } *
	tPT¿deUpd©eF¿me1Ouut
;

1010 
	sTT¿deUpd©eF¿me2IÅut


1012 
TId’t
 
	gacù_id
;

1013 
INT32
 
	gmax_Œades
;

1014 
INT32
 
	gmax_upd©es
;

1015 
TIMESTAMP_STRUCT
 
	g’d_Œade_dts
;

1016 
TIMESTAMP_STRUCT
 
	g¡¬t_Œade_dts
;

1017 } *
	tPT¿deUpd©eF¿me2IÅut
;

1019 
	sTT¿deUpd©eF¿me2T¿deInfo


1021 
	gbid_´iû
;

1022 
	gÿsh_Œª§ùiÚ_amouÁ
;

1023 
	g£‰Ëm’t_amouÁ
;

1024 
	gŒade_´iû
;

1025 
TT¿de
 
	gŒade_id
;

1026 
boŞ
 
	gis_ÿsh
;

1027 
TIMESTAMP_STRUCT
 
	gŒade_hi¡Üy_dts
[
T¿deUpd©eMaxT¿deHi¡ÜyRowsR‘uºed
];

1028 
TIMESTAMP_STRUCT
 
	gÿsh_Œª§ùiÚ_dts
;

1029 
TIMESTAMP_STRUCT
 
	g£‰Ëm’t_ÿsh_due_d©e
;

1030 
	gŒade_hi¡Üy_¡©us_id
[
T¿deUpd©eMaxT¿deHi¡ÜyRowsR‘uºed
][
cTH_ST_ID_Ën
+1];

1031 
	gÿsh_Œª§ùiÚ_Çme
[
cCT_NAME_Ën
+1];

1032 
	gexec_Çme
[
cEXEC_NAME_Ën
+1];

1033 
	g£‰Ëm’t_ÿsh_ty³
[
cSE_CASH_TYPE_Ën
+1];

1034 
DB_INDICATOR
 
	gŒade_hi¡Üy_dts_šd
[
T¿deUpd©eMaxT¿deHi¡ÜyRowsR‘uºed
];

1035 
DB_INDICATOR
 
	gŒade_hi¡Üy_¡©us_id_šd
[
T¿deUpd©eMaxT¿deHi¡ÜyRowsR‘uºed
];

1036 
DB_INDICATOR
 
	gbid_´iû_šd
;

1037 
DB_INDICATOR
 
	gÿsh_Œª§ùiÚ_amouÁ_šd
;

1038 
DB_INDICATOR
 
	gÿsh_Œª§ùiÚ_dts_šd
;

1039 
DB_INDICATOR
 
	gÿsh_Œª§ùiÚ_Çme_šd
;

1040 
DB_INDICATOR
 
	gexec_Çme_šd
;

1041 
DB_INDICATOR
 
	gis_ÿsh_šd
;

1042 
DB_INDICATOR
 
	g£‰Ëm’t_amouÁ_šd
;

1043 
DB_INDICATOR
 
	g£‰Ëm’t_ÿsh_due_d©e_šd
;

1044 
DB_INDICATOR
 
	g£‰Ëm’t_ÿsh_ty³_šd
;

1045 
DB_INDICATOR
 
	gŒade_id_šd
;

1046 
DB_INDICATOR
 
	gŒade_´iû_šd
;

1047 } *
	tPT¿deUpd©eF¿me2T¿deInfo
;

1049 
	sTT¿deUpd©eF¿me2Ouut


1051 
INT32
 
	gnum_found
;

1052 
INT32
 
	gnum_upd©ed
;

1053 
TT¿deUpd©eF¿me2T¿deInfo
 
	gŒade_šfo
[
T¿deUpd©eF¿me2MaxRows
];

1054 } *
	tPT¿deUpd©eF¿me2Ouut
;

1056 
	sTT¿deUpd©eF¿me3IÅut


1058 
TId’t
 
	gmax_acù_id
;

1059 
INT32
 
	gmax_Œades
;

1060 
INT32
 
	gmax_upd©es
;

1061 
TIMESTAMP_STRUCT
 
	g’d_Œade_dts
;

1062 
TIMESTAMP_STRUCT
 
	g¡¬t_Œade_dts
;

1063 
	gsymbŞ
[
cSYMBOL_Ën
+1];

1064 } *
	tPT¿deUpd©eF¿me3IÅut
;

1066 
	sTT¿deUpd©eF¿me3T¿deInfo


1068 
	gÿsh_Œª§ùiÚ_amouÁ
;

1069 
	g´iû
;

1070 
	g£‰Ëm’t_amouÁ
;

1071 
TId’t
 
	gacù_id
;

1072 
TT¿de
 
	gŒade_id
;

1073 
INT32
 
	gquªt™y
;

1074 
boŞ
 
	gis_ÿsh
;

1075 
TIMESTAMP_STRUCT
 
	gŒade_hi¡Üy_dts
[
T¿deUpd©eMaxT¿deHi¡ÜyRowsR‘uºed
];

1076 
TIMESTAMP_STRUCT
 
	gÿsh_Œª§ùiÚ_dts
;

1077 
TIMESTAMP_STRUCT
 
	g£‰Ëm’t_ÿsh_due_d©e
;

1078 
TIMESTAMP_STRUCT
 
	gŒade_dts
;

1079 
	gŒade_hi¡Üy_¡©us_id
[
T¿deUpd©eMaxT¿deHi¡ÜyRowsR‘uºed
][
cTH_ST_ID_Ën
+1];

1080 
	gÿsh_Œª§ùiÚ_Çme
[
cCT_NAME_Ën
+1];

1081 
	gexec_Çme
[
cEXEC_NAME_Ën
+1];

1082 
	gs_Çme
[
cS_NAME_Ën
+1];

1083 
	g£‰Ëm’t_ÿsh_ty³
[
cSE_CASH_TYPE_Ën
+1];

1084 
	gŒade_ty³
[
cTT_ID_Ën
+1];

1085 
	gty³_Çme
[
cTT_NAME_Ën
+1];

1086 
DB_INDICATOR
 
	gŒade_hi¡Üy_dts_šd
[
T¿deUpd©eMaxT¿deHi¡ÜyRowsR‘uºed
];

1087 
DB_INDICATOR
 
	gŒade_hi¡Üy_¡©us_id_šd
[
T¿deUpd©eMaxT¿deHi¡ÜyRowsR‘uºed
];

1088 
DB_INDICATOR
 
	gacù_id_šd
;

1089 
DB_INDICATOR
 
	gÿsh_Œª§ùiÚ_amouÁ_šd
;

1090 
DB_INDICATOR
 
	gÿsh_Œª§ùiÚ_dts_šd
;

1091 
DB_INDICATOR
 
	gÿsh_Œª§ùiÚ_Çme_šd
;

1092 
DB_INDICATOR
 
	gexec_Çme_šd
;

1093 
DB_INDICATOR
 
	gis_ÿsh_šd
;

1094 
DB_INDICATOR
 
	g´iû_šd
;

1095 
DB_INDICATOR
 
	gquªt™y_šd
;

1096 
DB_INDICATOR
 
	gs_Çme_šd
;

1097 
DB_INDICATOR
 
	g£‰Ëm’t_amouÁ_šd
;

1098 
DB_INDICATOR
 
	g£‰Ëm’t_ÿsh_due_d©e_šd
;

1099 
DB_INDICATOR
 
	g£‰Ëm’t_ÿsh_ty³_šd
;

1100 
DB_INDICATOR
 
	gŒade_dts_šd
;

1101 
DB_INDICATOR
 
	gŒade_id_šd
;

1102 
DB_INDICATOR
 
	gŒade_ty³_šd
;

1103 
DB_INDICATOR
 
	gty³_Çme_šd
;

1104 } *
	tPT¿deUpd©eF¿me3T¿deInfo
;

1106 
	sTT¿deUpd©eF¿me3Ouut


1108 
INT32
 
	gnum_found
;

1109 
INT32
 
	gnum_upd©ed
;

1110 
TT¿deUpd©eF¿me3T¿deInfo
 
	gŒade_šfo
[
T¿deUpd©eF¿me3MaxRows
];

1111 } *
	tPT¿deUpd©eF¿me3Ouut
;

1116 
	sTT¿deCËªupTxnIÅut


1118 
TT¿de
 
	g¡¬t_Œade_id
;

1119 
	g¡_ÿnûËd_id
[
cST_ID_Ën
+1];

1120 
	g¡_³ndšg_id
[
cST_ID_Ën
+1];

1121 
	g¡_subm™‹d_id
[
cST_ID_Ën
+1];

1122 } *
	tPT¿deCËªupTxnIÅut
,

1123 
	tTT¿deCËªupF¿me1IÅut
,

1124 *
	tPT¿deCËªupF¿me1IÅut
;

1126 
	sTT¿deCËªupTxnOuut


1128 
INT32
 
	g¡©us
;

1129 } *
	tPT¿deCËªupTxnOuut
;

	@include/workload/tpce/egen/TxnHarnessTradeCleanup.h

37 #iâdeà
TXN_HARNESS_TRADE_CLEANUP_H


38 
	#TXN_HARNESS_TRADE_CLEANUP_H


	)

40 
	~"TxnH¬ÃssDBIÁ”çû.h
"

42 
Çme¥aû
 
	gTPCE


45 şas 
	cCT¿deCËªup


47 
CT¿deCËªupDBIÁ”çû
* 
	gm_db
;

49 
	gpublic
:

50 
CT¿deCËªup
(
CT¿deCËªupDBIÁ”çû
 *
pDB
)

51 : 
m_db
(
pDB
)

55 
DoTxn
Ğ
PT¿deCËªupTxnIÅut
 
pTxnIÅut
, 
PT¿deCËªupTxnOuut
 
pTxnOuut
)

57 
	gTXN_HARNESS_SET_STATUS_SUCCESS
;

59 
	gm_db
->
DoT¿deCËªupF¿me1
(
pTxnIÅut
);

	@include/workload/tpce/egen/TxnHarnessTradeLookup.h

37 #iâdeà
TXN_HARNESS_TRADE_LOOKUP_H


38 
	#TXN_HARNESS_TRADE_LOOKUP_H


	)

40 
	~"TxnH¬ÃssDBIÁ”çû.h
"

42 
Çme¥aû
 
	gTPCE


45 şas 
	cCT¿deLookup


47 
CT¿deLookupDBIÁ”çû
* 
	gm_db
;

49 
	gpublic
:

50 
CT¿deLookup
(
CT¿deLookupDBIÁ”çû
 *
pDB
)

51 : 
m_db
(
pDB
)

55 
DoTxn
Ğ
PT¿deLookupTxnIÅut
 
pTxnIÅut
, 
PT¿deLookupTxnOuut
 
pTxnOuut
 )

57 
	gTXN_HARNESS_SET_STATUS_SUCCESS
;

59  
	gpTxnIÅut
->
	gäame_to_execu‹
 )

63 
TT¿deLookupF¿me1IÅut
 
F¿me1IÅut
;

64 
TT¿deLookupF¿me1Ouut
 
	gF¿me1Ouut
;

65 
mem£t
(&
F¿me1IÅut
, 0, ( Frame1Input ));

66 
mem£t
(&
F¿me1Ouut
, 0, ( Frame1Output ));

69 
	gF¿me1IÅut
.
	gmax_Œades
 = 
pTxnIÅut
->
max_Œades
;

70 
memıy
Ğ
F¿me1IÅut
.
Œade_id
, 
pTxnIÅut
->trade_id, ( Frame1Input.trade_id ));

73 
	gm_db
->
DoT¿deLookupF¿me1
Ğ&
F¿me1IÅut
, &
F¿me1Ouut
 );

76 ià(
	gF¿me1Ouut
.
	gnum_found
 !ğ
pTxnIÅut
->
max_Œades
)

78 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
TLF1_ERROR1
);

82 
	gpTxnOuut
->
	gäame_execu‹d
 = 1;

83 
	gi
=0; i < 
	gF¿me1Ouut
.
	gnum_found
 && i < 
	gT¿deLookupF¿me1MaxRows
; i++)

85 
	gpTxnOuut
->
	gis_ÿsh
[
i
] = 
F¿me1Ouut
.
Œade_šfo
[i].
is_ÿsh
;

86 
	gpTxnOuut
->
	gis_m¬k‘
[
i
] = 
F¿me1Ouut
.
Œade_šfo
[i].
is_m¬k‘
;

88 
	gpTxnOuut
->
	gnum_found
 = 
F¿me1Ouut
.
num_found
;

94 
TT¿deLookupF¿me2IÅut
 
F¿me2IÅut
;

95 
TT¿deLookupF¿me2Ouut
 
	gF¿me2Ouut
;

96 
mem£t
(&
F¿me2IÅut
, 0, ( Frame2Input ));

97 
mem£t
(&
F¿me2Ouut
, 0, ( Frame2Output ));

100 
	gF¿me2IÅut
.
	gacù_id
 = 
pTxnIÅut
->
acù_id
;

101 
	gF¿me2IÅut
.
	gmax_Œades
 = 
pTxnIÅut
->
max_Œades
;

102 
	gF¿me2IÅut
.
	g¡¬t_Œade_dts
 = 
pTxnIÅut
->
¡¬t_Œade_dts
;

103 
	gF¿me2IÅut
.
	g’d_Œade_dts
 = 
pTxnIÅut
->
’d_Œade_dts
;

106 
	gm_db
->
DoT¿deLookupF¿me2
Ğ&
F¿me2IÅut
, &
F¿me2Ouut
 );

109 ià(
	gF¿me2Ouut
.
	gnum_found
 < 0 || F¿me2Ouut.num_found > 
	gF¿me2IÅut
.
	gmax_Œades
)

111 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
TLF2_ERROR1
);

113 ià(
	gF¿me2Ouut
.
	gnum_found
 == 0)

115 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
TLF2_WARN1
);

119 
	gpTxnOuut
->
	gäame_execu‹d
 = 2;

120 
	gi
=0; i < 
	gF¿me2Ouut
.
	gnum_found
 && i < 
	gT¿deLookupF¿me2MaxRows
; i++)

122 
	gpTxnOuut
->
	gis_ÿsh
[
i
] = 
F¿me2Ouut
.
Œade_šfo
[i].
is_ÿsh
;

123 
	gpTxnOuut
->
	gŒade_li¡
[
i
] = 
F¿me2Ouut
.
Œade_šfo
[i].
Œade_id
;

125 
	gpTxnOuut
->
	gnum_found
 = 
F¿me2Ouut
.
num_found
;

131 
TT¿deLookupF¿me3IÅut
 
F¿me3IÅut
;

132 
TT¿deLookupF¿me3Ouut
 
	gF¿me3Ouut
;

133 
mem£t
(&
F¿me3IÅut
, 0, ( Frame3Input ));

134 
mem£t
(&
F¿me3Ouut
, 0, ( Frame3Output ));

137 
	gF¿me3IÅut
.
	gmax_Œades
 = 
pTxnIÅut
->
max_Œades
;

138 
¡ºıy
Ğ
F¿me3IÅut
.
symbŞ
, 
pTxnIÅut
->symbol, ( Frame3Input.symbol ));

139 
	gF¿me3IÅut
.
	g¡¬t_Œade_dts
 = 
pTxnIÅut
->
¡¬t_Œade_dts
;

140 
	gF¿me3IÅut
.
	g’d_Œade_dts
 = 
pTxnIÅut
->
’d_Œade_dts
;

141 
	gF¿me3IÅut
.
	gmax_acù_id
 = 
pTxnIÅut
->
max_acù_id
;

144 
	gm_db
->
DoT¿deLookupF¿me3
Ğ&
F¿me3IÅut
, &
F¿me3Ouut
 );

147 ià(
	gF¿me3Ouut
.
	gnum_found
 < 0 || F¿me3Ouut.num_found > 
	gF¿me3IÅut
.
	gmax_Œades
)

149 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
TLF3_ERROR1
);

151 ià(
	gF¿me3Ouut
.
	gnum_found
 == 0)

153 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
TLF3_WARN1
);

157 
	gpTxnOuut
->
	gäame_execu‹d
 = 3;

158 
	gpTxnOuut
->
	gnum_found
 = 
F¿me3Ouut
.
num_found
;

159 
	gi
=0; i < 
	gF¿me3Ouut
.
	gnum_found
 && i < 
	gT¿deLookupF¿me3MaxRows
; i++)

161 
	gpTxnOuut
->
	gis_ÿsh
[
i
] = 
F¿me3Ouut
.
Œade_šfo
[i].
is_ÿsh
;

162 
	gpTxnOuut
->
	gŒade_li¡
[
i
] = 
F¿me3Ouut
.
Œade_šfo
[i].
Œade_id
;

169 
TT¿deLookupF¿me4IÅut
 
F¿me4IÅut
;

170 
TT¿deLookupF¿me4Ouut
 
	gF¿me4Ouut
;

171 
mem£t
(&
F¿me4IÅut
, 0, ( Frame4Input ));

172 
mem£t
(&
F¿me4Ouut
, 0, ( Frame4Output ));

175 
	gF¿me4IÅut
.
	gacù_id
 = 
pTxnIÅut
->
acù_id
;

176 
	gF¿me4IÅut
.
	gŒade_dts
 = 
pTxnIÅut
->
¡¬t_Œade_dts
;

179 
	gm_db
->
DoT¿deLookupF¿me4
Ğ&
F¿me4IÅut
, &
F¿me4Ouut
 );

184 ià(
	gF¿me4Ouut
.
	gnum_Œades_found
 < 0 || Frame4Output.num_trades_found > 1)

186 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
TLF4_ERROR1
);

188 ià(
	gF¿me4Ouut
.
	gnum_Œades_found
 == 0)

190 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
TLF4_WARN1
);

192 ià(
	gF¿me4Ouut
.
	gnum_found
 < 1 || F¿me4Ouut.num_found > 
	gT¿deLookupF¿me4MaxRows
)

194 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
TLF4_ERROR2
);

198 
	gpTxnOuut
->
	gäame_execu‹d
 = 4;

199 
	gpTxnOuut
->
	gnum_found
 = 
F¿me4Ouut
.
num_found
;

200 
	gpTxnOuut
->
	gŒade_li¡
[0] = 
F¿me4Ouut
.
Œade_id
;

206 
as£¹
Ğ
çl£
 );

	@include/workload/tpce/egen/TxnHarnessTradeOrder.h

41 #iâdeà
TXN_HARNESS_TRADE_ORDER_H


42 
	#TXN_HARNESS_TRADE_ORDER_H


	)

44 
	~"TxnH¬ÃssDBIÁ”çû.h
"

46 
Çme¥aû
 
	gTPCE


49 şas 
	cCT¿deOrd”


51 
CT¿deOrd”DBIÁ”çû
* 
	gm_db
;

52 
CS’dToM¬k‘IÁ”çû
* 
	gm_pS’dToM¬k‘
;

54 
	gpublic
:

55 
CT¿deOrd”
(
CT¿deOrd”DBIÁ”çû
 *
pDB
, 
CS’dToM¬k‘IÁ”çû
 *
pS’dToM¬k‘
)

56 : 
m_db
(
pDB
),

57 
m_pS’dToM¬k‘
(
pS’dToM¬k‘
)

61 
DoTxn
Ğ
PT¿deOrd”TxnIÅut
 
pTxnIÅut
, 
PT¿deOrd”TxnOuut
 
pTxnOuut
 )

64 
TT¿deOrd”F¿me1IÅut
 
	gF¿me1IÅut
;

65 
TT¿deOrd”F¿me1Ouut
 
	gF¿me1Ouut
;

66 
mem£t
(&
F¿me1IÅut
, 0, ( Frame1Input ));

67 
mem£t
(&
F¿me1Ouut
, 0, ( Frame1Output ));

69 
TT¿deOrd”F¿me2IÅut
 
	gF¿me2IÅut
;

70 
TT¿deOrd”F¿me2Ouut
 
	gF¿me2Ouut
;

71 
mem£t
(&
F¿me2IÅut
, 0, ( Frame2Input ));

72 
mem£t
(&
F¿me2Ouut
, 0, ( Frame2Output ));

74 
TT¿deOrd”F¿me3IÅut
 
	gF¿me3IÅut
;

75 
TT¿deOrd”F¿me3Ouut
 
	gF¿me3Ouut
;

76 
mem£t
(&
F¿me3IÅut
, 0, ( Frame3Input ));

77 
mem£t
(&
F¿me3Ouut
, 0, ( Frame3Output ));

79 
TT¿deOrd”F¿me4IÅut
 
	gF¿me4IÅut
;

80 
TT¿deOrd”F¿me4Ouut
 
	gF¿me4Ouut
;

81 
mem£t
(&
F¿me4IÅut
, 0, ( Frame4Input ));

82 
mem£t
(&
F¿me4Ouut
, 0, ( Frame4Output ));

84 
TT¿deReque¡
 
	gT¿deReque¡FÜMEE
;

86 
	gTXN_HARNESS_SET_STATUS_SUCCESS
;

93 
	gF¿me1IÅut
.
	gacù_id
 = 
pTxnIÅut
->
acù_id
;

96 
	gm_db
->
DoT¿deOrd”F¿me1
(&
F¿me1IÅut
, &
F¿me1Ouut
 );

99 ià(
	gF¿me1Ouut
.
	gnum_found
 != 1)

101 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
TOF1_ERROR1
);

108 ià(
¡rcmp
(
pTxnIÅut
->
exec_l_Çme
, 
F¿me1Ouut
.
cu¡_l_Çme
)

109 || 
¡rcmp
(
pTxnIÅut
->
exec_f_Çme
, 
F¿me1Ouut
.
cu¡_f_Çme
)

110 || 
¡rcmp
(
pTxnIÅut
->
exec_x_id
, 
F¿me1Ouut
.
x_id
))

113 
	gF¿me2Ouut
.
	g­_aş
[0] = '\0';

114 
	gF¿me2IÅut
.
	gacù_id
 = 
pTxnIÅut
->
acù_id
;

115 
¡ºıy
(
F¿me2IÅut
.
exec_f_Çme
, 
pTxnIÅut
->exec_f_name, (Frame2Input.exec_f_name));

116 
¡ºıy
(
F¿me2IÅut
.
exec_l_Çme
, 
pTxnIÅut
->exec_l_name, (Frame2Input.exec_l_name));

117 
¡ºıy
(
F¿me2IÅut
.
exec_x_id
, 
pTxnIÅut
->exec_tax_id, (Frame2Input.exec_tax_id));

120 
	gm_db
->
DoT¿deOrd”F¿me2
(&
F¿me2IÅut
, &
F¿me2Ouut
);

123 ià(
	gF¿me2Ouut
.
	g­_aş
[0] == '\0')

125 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
TOF2_ERROR1
);

128 
	gm_db
->
DoT¿deOrd”F¿me5
();

138 
	gF¿me3IÅut
.
	gacù_id
 = 
pTxnIÅut
->
acù_id
;

139 
	gF¿me3IÅut
.
	gcu¡_id
 = 
F¿me1Ouut
.
cu¡_id
;

140 
	gF¿me3IÅut
.
	gcu¡_t›r
 = 
F¿me1Ouut
.
cu¡_t›r
;

141 
	gF¿me3IÅut
.
	gis_lifo
 = 
pTxnIÅut
->
is_lifo
;

142 
¡ºıy
(
F¿me3IÅut
.
issue
, 
pTxnIÅut
->issue, (Frame3Input.issue));

143 
¡ºıy
(
F¿me3IÅut
.
¡_³ndšg_id
, 
pTxnIÅut
->st_pending_id, (Frame3Input.st_pending_id));

144 
¡ºıy
(
F¿me3IÅut
.
¡_subm™‹d_id
, 
pTxnIÅut
->st_submitted_id, (Frame3Input.st_submitted_id));

145 
	gF¿me3IÅut
.
	gx_¡©us
 = 
F¿me1Ouut
.
x_¡©us
;

146 
	gF¿me3IÅut
.
	gŒade_qty
 = 
pTxnIÅut
->
Œade_qty
;

147 
¡ºıy
(
F¿me3IÅut
.
Œade_ty³_id
, 
pTxnIÅut
->trade_type_id, (Frame3Input.trade_type_id));

148 
	gF¿me3IÅut
.
	gty³_is_m¬gš
 = 
pTxnIÅut
->
ty³_is_m¬gš
;

149 
¡ºıy
(
F¿me3IÅut
.
co_Çme
, 
pTxnIÅut
->co_name, (Frame3Input.co_name));

150 
	gF¿me3IÅut
.
	g»que¡ed_´iû
 = 
pTxnIÅut
->
»que¡ed_´iû
;

151 
¡ºıy
(
F¿me3IÅut
.
symbŞ
, 
pTxnIÅut
->symbol, (Frame3Input.symbol));

154 
	gm_db
->
DoT¿deOrd”F¿me3
(&
F¿me3IÅut
, &
F¿me3Ouut
);

157 iàĞ
	gF¿me3Ouut
.
	g£Î_v®ue
 > F¿me3Ouut.
	gbuy_v®ue


158 && ((
	gF¿me3IÅut
.
	gx_¡©us
 =ğ1è|| (
F¿me3IÅut
.
x_¡©us
 == 2))

159 && 
F¿me3Ouut
.
x_amouÁ
 == 0.00)

161 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
TOF3_ERROR1
);

163 ià(
	gF¿me3Ouut
.
	gcomm_¿‹
 == 0.0000)

165 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
TOF3_ERROR2
);

167 ià(
	gF¿me3Ouut
.
	gch¬ge_amouÁ
 == 0.00)

169 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
TOF3_ERROR3
);

173 
	gpTxnOuut
->
	gbuy_v®ue
 = 
F¿me3Ouut
.
buy_v®ue
;

174 
	gpTxnOuut
->
	g£Î_v®ue
 = 
F¿me3Ouut
.
£Î_v®ue
;

175 
	gpTxnOuut
->
	gx_amouÁ
 = 
F¿me3Ouut
.
x_amouÁ
;

182 
	gF¿me4IÅut
.
	gacù_id
 = 
pTxnIÅut
->
acù_id
;

183 
	gF¿me4IÅut
.
	gbrok”_id
 = 
F¿me1Ouut
.
brok”_id
;

184 
	gF¿me4IÅut
.
	gch¬ge_amouÁ
 = 
F¿me3Ouut
.
ch¬ge_amouÁ
;

185 
	gF¿me4IÅut
.
	gcomm_amouÁ
 = 
F¿me3Ouut
.
comm_¿‹
 / 100

186 * 
pTxnIÅut
->
Œade_qty


187 * 
F¿me3Ouut
.
»que¡ed_´iû
;

189 
	gF¿me4IÅut
.
	gcomm_amouÁ
 = ()(()(100.00 * 
F¿me4IÅut
.
comm_amouÁ
 + 0.5)) / 100.00;

191 
¢´štf
(
F¿me4IÅut
.
exec_Çme
, (F¿me4IÅut.exec_Çme), "% %s", 
pTxnIÅut
->
exec_f_Çme
,…TxnIÅut->
exec_l_Çme
);

192 
	gF¿me4IÅut
.
	gis_ÿsh
 = !
F¿me3IÅut
.
ty³_is_m¬gš
;

193 
	gF¿me4IÅut
.
	gis_lifo
 = 
pTxnIÅut
->
is_lifo
;

194 
	gF¿me4IÅut
.
	g»que¡ed_´iû
 = 
F¿me3Ouut
.
»que¡ed_´iû
;

195 
¡ºıy
(
F¿me4IÅut
.
¡©us_id
, 
F¿me3Ouut
.status_id, (Frame4Input.status_id));

196 
¡ºıy
(
F¿me4IÅut
.
symbŞ
, 
F¿me3Ouut
.symbol, (Frame4Input.symbol));

197 
	gF¿me4IÅut
.
	gŒade_qty
 = 
pTxnIÅut
->
Œade_qty
;

198 
¡ºıy
(
F¿me4IÅut
.
Œade_ty³_id
, 
pTxnIÅut
->trade_type_id, (Frame4Input.trade_type_id));

199 
	gF¿me4IÅut
.
	gty³_is_m¬k‘
 = 
F¿me3Ouut
.
ty³_is_m¬k‘
;

202 
	gm_db
->
DoT¿deOrd”F¿me4
(&
F¿me4IÅut
, &
F¿me4Ouut
);

205 
	gpTxnOuut
->
	gŒade_id
 = 
F¿me4Ouut
.
Œade_id
;

211 ià(
	gpTxnIÅut
->
	grŞl_™_back
)

214 
	gm_db
->
DoT¿deOrd”F¿me5
();

216 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
EXPECTED_ROLLBACK
);

221 
	gm_db
->
DoT¿deOrd”F¿me6
();

226 
	gT¿deReque¡FÜMEE
.
	g´iû_quÙe
 = 
F¿me4IÅut
.
»que¡ed_´iû
;

227 
¡ºıy
(
T¿deReque¡FÜMEE
.
symbŞ
, 
F¿me4IÅut
.symbol, (TradeRequestForMEE.symbol));

228 
	gT¿deReque¡FÜMEE
.
	gŒade_id
 = 
F¿me4Ouut
.
Œade_id
;

229 
	gT¿deReque¡FÜMEE
.
	gŒade_qty
 = 
F¿me4IÅut
.
Œade_qty
;

230 
¡ºıy
Ğ
T¿deReque¡FÜMEE
.
Œade_ty³_id
, 
pTxnIÅut
->trade_type_id, ( TradeRequestForMEE.trade_type_id ));

232 ifĞ
	gF¿me4IÅut
.
	gty³_is_m¬k‘
 )

234 
	gT¿deReque¡FÜMEE
.
	geAùiÚ
 = 
eMEEProûssOrd”
;

238 
	gT¿deReque¡FÜMEE
.
	geAùiÚ
 = 
eMEES‘Lim™Ord”Trigg”
;

241 
	gm_pS’dToM¬k‘
->
S’dToM¬k‘FromH¬Ãss
(
T¿deReque¡FÜMEE
);

	@include/workload/tpce/egen/TxnHarnessTradeResult.h

41 #iâdeà
TXN_HARNESS_TRADE_RESULT_H


42 
	#TXN_HARNESS_TRADE_RESULT_H


	)

44 
	~"TxnH¬ÃssDBIÁ”çû.h
"

46 
Çme¥aû
 
	gTPCE


49 şas 
	cCT¿deResuÉ


51 
CT¿deResuÉDBIÁ”çû
* 
	gm_db
;

53 
	gpublic
:

54 
CT¿deResuÉ
(
CT¿deResuÉDBIÁ”çû
 *
pDB
)

55 : 
m_db
(
pDB
)

59 
DoTxn
Ğ
PT¿deResuÉTxnIÅut
 
pTxnIÅut
, 
PT¿deResuÉTxnOuut
 
pTxnOuut
 )

62 
TT¿deResuÉF¿me1IÅut
 
	gF¿me1IÅut
;

63 
TT¿deResuÉF¿me1Ouut
 
	gF¿me1Ouut
;

64 
mem£t
(&
F¿me1IÅut
, 0, ( Frame1Input ));

65 
mem£t
(&
F¿me1Ouut
, 0, ( Frame1Output ));

67 
TT¿deResuÉF¿me2IÅut
 
	gF¿me2IÅut
;

68 
TT¿deResuÉF¿me2Ouut
 
	gF¿me2Ouut
;

69 
mem£t
(&
F¿me2IÅut
, 0, ( Frame2Input ));

70 
mem£t
(&
F¿me2Ouut
, 0, ( Frame2Output ));

72 
TT¿deResuÉF¿me3IÅut
 
	gF¿me3IÅut
;

73 
TT¿deResuÉF¿me3Ouut
 
	gF¿me3Ouut
;

74 
mem£t
(&
F¿me3IÅut
, 0, ( Frame3Input ));

75 
mem£t
(&
F¿me3Ouut
, 0, ( Frame3Output ));

77 
TT¿deResuÉF¿me4IÅut
 
	gF¿me4IÅut
;

78 
TT¿deResuÉF¿me4Ouut
 
	gF¿me4Ouut
;

79 
mem£t
(&
F¿me4IÅut
, 0, ( Frame4Input ));

80 
mem£t
(&
F¿me4Ouut
, 0, ( Frame4Output ));

82 
TT¿deResuÉF¿me5IÅut
 
	gF¿me5IÅut
;

83 
mem£t
(&
F¿me5IÅut
, 0, ( Frame5Input ));

85 
TT¿deResuÉF¿me6IÅut
 
	gF¿me6IÅut
;

86 
TT¿deResuÉF¿me6Ouut
 
	gF¿me6Ouut
;

87 
mem£t
(&
F¿me6IÅut
, 0, ( Frame6Input ));

88 
mem£t
(&
F¿me6Ouut
, 0, ( Frame6Output ));

90 
	gTXN_HARNESS_SET_STATUS_SUCCESS
;

97 
	gF¿me1IÅut
.
	gŒade_id
 = 
pTxnIÅut
->
Œade_id
;

100 
	gm_db
->
DoT¿deResuÉF¿me1
(&
F¿me1IÅut
, &
F¿me1Ouut
);

103 ià(
	gF¿me1Ouut
.
	gnum_found
 != 1)

105 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
TRF1_ERROR1
);

113 
	gF¿me2IÅut
.
	gacù_id
 = 
F¿me1Ouut
.
acù_id
;

114 
	gF¿me2IÅut
.
	ghs_qty
 = 
F¿me1Ouut
.
hs_qty
;

115 
	gF¿me2IÅut
.
	gis_lifo
 = 
F¿me1Ouut
.
is_lifo
;

116 
¡ºıy
(
F¿me2IÅut
.
symbŞ
, 
F¿me1Ouut
.symbol, (Frame2Input.symbol));

117 
	gF¿me2IÅut
.
	gŒade_id
 = 
pTxnIÅut
->
Œade_id
;

118 
	gF¿me2IÅut
.
	gŒade_´iû
 = 
pTxnIÅut
->
Œade_´iû
;

119 
	gF¿me2IÅut
.
	gŒade_qty
 = 
F¿me1Ouut
.
Œade_qty
;

120 
	gF¿me2IÅut
.
	gty³_is_£Î
 = 
F¿me1Ouut
.
ty³_is_£Î
;

123 
	gm_db
->
DoT¿deResuÉF¿me2
(&
F¿me2IÅut
, &
F¿me2Ouut
);

129 
	gF¿me3Ouut
.
	gx_amouÁ
 = 0.0;

130 ià(Ğ
	gF¿me2Ouut
.
	gx_¡©us
 =ğ1 || 
F¿me2Ouut
.
x_¡©us
 == 2 ) &&

131 Ğ
F¿me2Ouut
.
£Î_v®ue
 > F¿me2Ouut.
buy_v®ue
 ))

134 
F¿me3IÅut
.
buy_v®ue
 = 
F¿me2Ouut
.buy_value;

135 
	gF¿me3IÅut
.
	gcu¡_id
 = 
F¿me2Ouut
.
cu¡_id
;

136 
	gF¿me3IÅut
.
	g£Î_v®ue
 = 
F¿me2Ouut
.
£Î_v®ue
;

137 
	gF¿me3IÅut
.
	gŒade_id
 = 
pTxnIÅut
->
Œade_id
;

140 
	gm_db
->
DoT¿deResuÉF¿me3
(&
F¿me3IÅut
, &
F¿me3Ouut
);

143 ià(
	gF¿me3Ouut
.
	gx_amouÁ
 < 0.00)

145 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
TRF3_ERROR1
);

154 
	gF¿me4IÅut
.
	gcu¡_id
 = 
F¿me2Ouut
.
cu¡_id
;

155 
¡ºıy
(
F¿me4IÅut
.
symbŞ
, 
F¿me1Ouut
.symbol, (Frame4Input.symbol));

156 
	gF¿me4IÅut
.
	gŒade_qty
 = 
F¿me1Ouut
.
Œade_qty
;

157 
¡ºıy
(
F¿me4IÅut
.
ty³_id
, 
F¿me1Ouut
.type_id, (Frame4Input.type_id));

160 
	gm_db
->
DoT¿deResuÉF¿me4
(&
F¿me4IÅut
, &
F¿me4Ouut
);

163 ià(
	gF¿me4Ouut
.
	gcomm_¿‹
 <= 0.0000)

165 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
TRF4_ERROR1
);

173 
	gF¿me5IÅut
.
	gbrok”_id
 = 
F¿me2Ouut
.
brok”_id
;

174 
	gF¿me5IÅut
.
	gcomm_amouÁ
 = ( 
F¿me4Ouut
.
comm_¿‹
 / 100.00 ) * ( 
F¿me1Ouut
.
Œade_qty
 * 
pTxnIÅut
->
Œade_´iû
 );

176 
	gF¿me5IÅut
.
	gcomm_amouÁ
 = ()(()(100.00 * 
F¿me5IÅut
.
comm_amouÁ
 + 0.5)) / 100.00;

178 
¡ºıy
Ğ
F¿me5IÅut
.
¡_com¶‘ed_id
, "CMPT", ( Frame5Input.st_completed_id ));

179 
	gF¿me5IÅut
.
	gŒade_dts
 = 
F¿me2Ouut
.
Œade_dts
;

180 
	gF¿me5IÅut
.
	gŒade_id
 = 
pTxnIÅut
->
Œade_id
;

181 
	gF¿me5IÅut
.
	gŒade_´iû
 = 
pTxnIÅut
->
Œade_´iû
;

184 
	gm_db
->
DoT¿deResuÉF¿me5
(&
F¿me5IÅut
);

191 
CD©eTime
 
due_d©e_time
Ğ&
F¿me2Ouut
.
Œade_dts
 );

192 
	gdue_d©e_time
.
Add
(2, 0);

193 
	gdue_d©e_time
.
S‘HMS
(0,0,0,0);

195 ià(
	gF¿me1Ouut
.
	gty³_is_£Î
)

197 
	gF¿me6IÅut
.
	g£_amouÁ
 = 
F¿me1Ouut
.
Œade_qty
 * 
pTxnIÅut
->
Œade_´iû


198 - 
F¿me1Ouut
.
ch¬ge


199 - 
F¿me5IÅut
.
comm_amouÁ
;

203 
	gF¿me6IÅut
.
	g£_amouÁ
 = -1 * ( 
F¿me1Ouut
.
Œade_qty
 * 
pTxnIÅut
->
Œade_´iû


204 + 
F¿me1Ouut
.
ch¬ge


205 + 
F¿me5IÅut
.
comm_amouÁ
);

209 ià(
	gF¿me2Ouut
.
	gx_¡©us
 == 1)

211 
F¿me6IÅut
.
£_amouÁ
 -ğ
F¿me3Ouut
.
x_amouÁ
;

215 
	gF¿me6IÅut
.
	gacù_id
 = 
F¿me1Ouut
.
acù_id
;

216 
	gdue_d©e_time
.
G‘TimeSmp
(&
F¿me6IÅut
.
due_d©e
);

217 
¡ºıy
(
F¿me6IÅut
.
s_Çme
, 
F¿me4Ouut
.s_name, (Frame6Input.s_name));

218 
	gF¿me6IÅut
.
	gŒade_dts
 = 
F¿me2Ouut
.
Œade_dts
;

219 
	gF¿me6IÅut
.
	gŒade_id
 = 
pTxnIÅut
->
Œade_id
;

220 
	gF¿me6IÅut
.
	gŒade_is_ÿsh
 = 
F¿me1Ouut
.
Œade_is_ÿsh
;

221 
	gF¿me6IÅut
.
	gŒade_qty
 = 
F¿me1Ouut
.
Œade_qty
;

222 
¡ºıy
(
F¿me6IÅut
.
ty³_Çme
, 
F¿me1Ouut
.type_name, (Frame6Input.type_name));

225 
	gm_db
->
DoT¿deResuÉF¿me6
(&
F¿me6IÅut
, &
F¿me6Ouut
);

228 
	gpTxnOuut
->
	gacù_id
 = 
F¿me1Ouut
.
acù_id
;

229 
	gpTxnOuut
->
	gacù_b®
 = 
F¿me6Ouut
.
acù_b®
;

230 
	gpTxnOuut
->
	glßd_un™
 = (
INT32
)((
F¿me2Ouut
.
cu¡_id
 - 
iTId’tShiá
 - 1è/ 
iDeçuÉLßdUn™Size
) + 1;

	@include/workload/tpce/egen/TxnHarnessTradeStatus.h

37 #iâdeà
TXN_HARNESS_TRADE_STATUS_H


38 
	#TXN_HARNESS_TRADE_STATUS_H


	)

40 
	~"TxnH¬ÃssDBIÁ”çû.h
"

42 
Çme¥aû
 
	gTPCE


45 şas 
	cCT¿deStus


47 
CT¿deStusDBIÁ”çû
* 
	gm_db
;

49 
	gpublic
:

50 
CT¿deStus
(
CT¿deStusDBIÁ”çû
 *
pDB
)

51 : 
m_db
(
pDB
)

55 
DoTxn
Ğ
PT¿deStusTxnIÅut
 
pTxnIÅut
, 
PT¿deStusTxnOuut
 
pTxnOuut
)

58 
TT¿deStusF¿me1Ouut
 
	gF¿me1Ouut
;

59 
mem£t
(&
F¿me1Ouut
, 0, ( Frame1Output ));

61 
	gTXN_HARNESS_SET_STATUS_SUCCESS
;

64 
	gm_db
->
DoT¿deStusF¿me1
(
pTxnIÅut
, &
F¿me1Ouut
);

67 ià(
	gF¿me1Ouut
.
	gnum_found
 !ğ
max_Œade_¡©us_Ën
)

69 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
TSF1_ERROR1
);

73 
	gi
=0; i < 
	gF¿me1Ouut
.
	gnum_found
 && i < 
	gmax_Œade_¡©us_Ën
; i++)

75 
¡ºıy
Ğ
pTxnOuut
->
¡©us_Çme
[
i
], 
F¿me1Ouut
.status_name[i], (…TxnOutput->status_name[i] ));

76 
	gpTxnOuut
->
	gŒade_id
[
i
] = 
F¿me1Ouut
.
Œade_id
[i];

	@include/workload/tpce/egen/TxnHarnessTradeUpdate.h

41 #iâdeà
TXN_HARNESS_TRADE_UPDATE_H


42 
	#TXN_HARNESS_TRADE_UPDATE_H


	)

44 
	~"TxnH¬ÃssDBIÁ”çû.h
"

46 
Çme¥aû
 
	gTPCE


49 şas 
	cCT¿deUpd©e


51 
CT¿deUpd©eDBIÁ”çû
* 
	gm_db
;

53 
	gpublic
:

54 
CT¿deUpd©e
(
CT¿deUpd©eDBIÁ”çû
 *
pDB
)

55 : 
m_db
(
pDB
)

59 
DoTxn
Ğ
PT¿deUpd©eTxnIÅut
 
pTxnIÅut
, 
PT¿deUpd©eTxnOuut
 
pTxnOuut
 )

61 
	gTXN_HARNESS_SET_STATUS_SUCCESS
;

63  
	gpTxnIÅut
->
	gäame_to_execu‹
 )

67 
TT¿deUpd©eF¿me1IÅut
 
F¿me1IÅut
;

68 
TT¿deUpd©eF¿me1Ouut
 
	gF¿me1Ouut
;

69 
mem£t
(&
F¿me1IÅut
, 0, ( Frame1Input ));

70 
mem£t
(&
F¿me1Ouut
, 0, ( Frame1Output ));

73 
	gF¿me1IÅut
.
	gmax_Œades
 = 
pTxnIÅut
->
max_Œades
;

74 
	gF¿me1IÅut
.
	gmax_upd©es
 = 
pTxnIÅut
->
max_upd©es
;

75 
memıy
Ğ
F¿me1IÅut
.
Œade_id
, 
pTxnIÅut
->trade_id, ( Frame1Input.trade_id ));

78 
	gm_db
->
DoT¿deUpd©eF¿me1
Ğ&
F¿me1IÅut
, &
F¿me1Ouut
 );

81 iàĞ
	gF¿me1Ouut
.
	gnum_found
 !ğ
pTxnIÅut
->
max_Œades


82 || 
F¿me1Ouut
.
num_upd©ed
 !ğ
pTxnIÅut
->
max_upd©es
)

84 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
TUF1_ERROR1
);

88 
	gpTxnOuut
->
	gäame_execu‹d
 = 1;

89 
	gi
=0; i < 
	gF¿me1Ouut
.
	gnum_found
 && i < 
	gT¿deUpd©eF¿me1MaxRows
; i++)

91 
	gpTxnOuut
->
	gis_ÿsh
[
i
] = 
F¿me1Ouut
.
Œade_šfo
[i].
is_ÿsh
;

92 
	gpTxnOuut
->
	gis_m¬k‘
[
i
] = 
F¿me1Ouut
.
Œade_šfo
[i].
is_m¬k‘
;

94 
	gpTxnOuut
->
	gnum_found
 = 
F¿me1Ouut
.
num_found
;

95 
	gpTxnOuut
->
	gnum_upd©ed
 = 
F¿me1Ouut
.
num_upd©ed
;

101 
TT¿deUpd©eF¿me2IÅut
 
F¿me2IÅut
;

102 
TT¿deUpd©eF¿me2Ouut
 
	gF¿me2Ouut
;

103 
mem£t
(&
F¿me2IÅut
, 0, ( Frame2Input ));

104 
mem£t
(&
F¿me2Ouut
, 0, ( Frame2Output ));

107 
	gF¿me2IÅut
.
	gacù_id
 = 
pTxnIÅut
->
acù_id
;

108 
	gF¿me2IÅut
.
	gmax_Œades
 = 
pTxnIÅut
->
max_Œades
;

109 
	gF¿me2IÅut
.
	gmax_upd©es
 = 
pTxnIÅut
->
max_upd©es
;

110 
	gF¿me2IÅut
.
	g¡¬t_Œade_dts
 = 
pTxnIÅut
->
¡¬t_Œade_dts
;

111 
	gF¿me2IÅut
.
	g’d_Œade_dts
 = 
pTxnIÅut
->
’d_Œade_dts
;

114 
	gm_db
->
DoT¿deUpd©eF¿me2
Ğ&
F¿me2IÅut
, &
F¿me2Ouut
 );

127 iàĞ
	gF¿me2Ouut
.
	gnum_upd©ed
 !ğ
F¿me2Ouut
.
num_found


128 || 
F¿me2Ouut
.
num_found
 < 0 || F¿me2Ouut.num_found > 
F¿me2IÅut
.
max_Œades
)

130 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
TUF2_ERROR1
);

132 ià(
	gF¿me2Ouut
.
	gnum_upd©ed
 == 0)

134 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
TUF2_WARN1
);

138 
	gpTxnOuut
->
	gäame_execu‹d
 = 2;

139 
	gi
=0; i < 
	gF¿me2Ouut
.
	gnum_found
 && i < 
	gT¿deUpd©eF¿me2MaxRows
; i++)

141 
	gpTxnOuut
->
	gis_ÿsh
[
i
] = 
F¿me2Ouut
.
Œade_šfo
[i].
is_ÿsh
;

142 
	gpTxnOuut
->
	gŒade_li¡
[
i
] = 
F¿me2Ouut
.
Œade_šfo
[i].
Œade_id
;

144 
	gpTxnOuut
->
	gnum_found
 = 
F¿me2Ouut
.
num_found
;

145 
	gpTxnOuut
->
	gnum_upd©ed
 = 
F¿me2Ouut
.
num_upd©ed
;

150 
TT¿deUpd©eF¿me3IÅut
 
F¿me3IÅut
;

151 
TT¿deUpd©eF¿me3Ouut
 
	gF¿me3Ouut
;

152 
mem£t
(&
F¿me3IÅut
, 0, ( Frame3Input ));

153 
mem£t
(&
F¿me3Ouut
, 0, ( Frame3Output ));

156 
	gF¿me3IÅut
.
	gmax_Œades
 = 
pTxnIÅut
->
max_Œades
;

157 
	gF¿me3IÅut
.
	gmax_upd©es
 = 
pTxnIÅut
->
max_upd©es
;

158 
¡ºıy
Ğ
F¿me3IÅut
.
symbŞ
, 
pTxnIÅut
->symbol, ( Frame3Input.symbol ));

159 
	gF¿me3IÅut
.
	g¡¬t_Œade_dts
 = 
pTxnIÅut
->
¡¬t_Œade_dts
;

160 
	gF¿me3IÅut
.
	g’d_Œade_dts
 = 
pTxnIÅut
->
’d_Œade_dts
;

161 
	gF¿me3IÅut
.
	gmax_acù_id
 = 
pTxnIÅut
->
max_acù_id
;

164 
	gm_db
->
DoT¿deUpd©eF¿me3
Ğ&
F¿me3IÅut
, &
F¿me3Ouut
 );

178 ià((
	gF¿me3Ouut
.
	gnum_found
 < 0 || F¿me3Ouut.num_found > 
	gF¿me3IÅut
.
	gmax_Œades
) ||

179 
	gF¿me3Ouut
.
	gnum_upd©ed
 > F¿me3Ouut.
	gnum_found
)

181 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
TUF3_ERROR1
);

183 ià(
	gF¿me3Ouut
.
	gnum_upd©ed
 == 0)

185 
TXN_HARNESS_PROPAGATE_STATUS
(
CBa£TxnE¼
::
TUF3_WARN1
);

189 
	gpTxnOuut
->
	gäame_execu‹d
 = 3;

190 
	gpTxnOuut
->
	gnum_found
 = 
F¿me3Ouut
.
num_found
;

191 
	gpTxnOuut
->
	gnum_upd©ed
 = 
F¿me3Ouut
.
num_upd©ed
;

192 
	gi
=0; i < 
	gF¿me3Ouut
.
	gnum_found
 && i < 
	gT¿deUpd©eF¿me3MaxRows
; i++)

194 
	gpTxnOuut
->
	gis_ÿsh
[
i
] = 
F¿me3Ouut
.
Œade_šfo
[i].
is_ÿsh
;

195 
	gpTxnOuut
->
	gŒade_li¡
[
i
] = 
F¿me3Ouut
.
Œade_šfo
[i].
Œade_id
;

202 
as£¹
Ğ
çl£
 );

	@include/workload/tpce/egen/WatchListsAndItemsTable.h

40 #iâdeà
WATCH_LIST_AND_ITEMS_TABLE_H


41 
	#WATCH_LIST_AND_ITEMS_TABLE_H


	)

43 
	~"EG’TabËs_commÚ.h
"

44 
	~"Cu¡om”TabË.h
"

45 
	~"Secur™yFe.h
"

47 
Çme¥aû
 
	gTPCE


51 cÚ¡ 
UINT
 
	giMšSecIdx
 = 0;

54 cÚ¡ 
UINT
 
	giMšI‹msInWL
 = 50;

57 cÚ¡ 
UINT
 
	giMaxI‹msInWL
 = 150;

60 cÚ¡ 
UINT
 
	giP”ûÁW©chLi¡
 = 100;

63 cÚ¡ 
UINT
 
	giW©chLi¡IdPrime
 = 631;

64 cÚ¡ 
UINT
 
	giW©chLi¡IdOff£t
 = 97;

68 cÚ¡ 
UINT
 
	giRNGSkOÃRowW©chLi¡AndW©chI‹m
 = 15;

71 
	sWATCH_LIST_AND_ITEM_ROW


73 
WATCH_LIST_ROW
 
	gm_w©ch_li¡
;

74 
WATCH_ITEM_ROW
 
	gm_w©ch_™ems
[
iMaxI‹msInWL
+1];

75 } *
	tPWATCH_LIST_AND_ITEM_ROW
;

77 
	g£t
<
	tTId’t
> 
	tIÁS‘
;

79 
şass
 
	gCW©chLi¡sAndI‹msTabË
 : 
public
 
TabËTem¶©e
<
WATCH_LIST_AND_ITEM_ROW
>

81 
UINT
 
m_iRowsToG’FÜWL
;

82 
UINT
 
	gm_iRowsG’”©edFÜWL
;

83 
CCu¡om”TabË
 
	gm_cu¡
;

84 
IÁS‘
 
	gm_£t
;

85 
UINT
 
	gm_iWICouÁ
;

86 
TId’t
 
	gm_iMšSecIdx
;

87 
TId’t
 
	gm_iMaxSecIdx
;

88 
CSecur™yFe
* 
	gm_Secur™yFe
;

89 
boŞ
 
	gm_bIn™NextLßdUn™
;

94 
G’”©eNextWL_ID
()

96 
TId’t
 
	giCu¡om”IdFÜC®c
 = 
m_cu¡
.
G‘Cu¼’tC_ID
(è- 
iDeçuÉS¹FromCu¡om”
;

98 
	gm_row
.
	gm_w©ch_li¡
.
	gWL_ID
 =

99 (
iCu¡om”IdFÜC®c
 / 
iDeçuÉLßdUn™Size
) * iDefaultLoadUnitSize +

100 (
iCu¡om”IdFÜC®c
 * 
iW©chLi¡IdPrime
 + 
iW©chLi¡IdOff£t
)

101 % 
iDeçuÉLßdUn™Size
 + 
iDeçuÉS¹FromCu¡om”
;

107 
In™NextLßdUn™
()

109 
	gm_ºd
.
S‘S“d
(
m_ºd
.
RndNthEËm’t
(
RNGS“dTabËDeçuÉ
,

110 (
RNGSEED
)
m_cu¡
.
G‘Cu¼’tC_ID
()

111 * 
iRNGSkOÃRowW©chLi¡AndW©chI‹m
));

113 
CË¬RecÜd
();

116 
	gpublic
:

117 
CW©chLi¡sAndI‹msTabË
(
CIÅutFes
 
šputFes
,

118 
TId’t
 
iCu¡om”CouÁ
,

119 
TId’t
 
iS¹FromCu¡om”
)

120 : 
TabËTem¶©e
<
WATCH_LIST_AND_ITEM_ROW
>()

121 , 
m_iRowsToG’FÜWL
(0)

122 , 
m_iRowsG’”©edFÜWL
(0)

123 , 
m_cu¡
(
šputFes
, 
iCu¡om”CouÁ
, 
iS¹FromCu¡om”
)

124 , 
m_iWICouÁ
(0)

125 , 
m_iMšSecIdx
(
iMšSecIdx
)

126 , 
m_Secur™yFe
(
šputFes
.
Secur™›s
)

127 , 
m_bIn™NextLßdUn™
(
çl£
)

129 
	gm_iMaxSecIdx
 = 
m_Secur™yFe
->
G‘CÚfigu»dSecur™yCouÁ
()-1;

135 ià(
	gm_cu¡
.
G‘Cu¼’tC_ID
(è% 
	giDeçuÉLßdUn™Size
 == 0)

137 
m_bIn™NextLßdUn™
 = 
Œue
;

140 
	gm_cu¡
.
G’”©eNextC_ID
();

142 } !
	gm_ºd
.
RndP”ûÁ
(
iP”ûÁW©chLi¡
è&& 
	gm_cu¡
.
MÜeRecÜds
());

149 
boŞ
 
G’”©eNextRecÜd
()

151 
TId’t
 
	giCu¡om”Id
;

152 
boŞ
 
	gbR‘
 = 
çl£
;

154 ià(
	gm_bIn™NextLßdUn™
)

156 
In™NextLßdUn™
();

158 
	gm_bIn™NextLßdUn™
 = 
çl£
;

161 ++
	gm_iLa¡RowNumb”
;

163 
	giCu¡om”Id
 = 
m_cu¡
.
G‘Cu¼’tC_ID
();

165 
G’”©eNextWL_ID
();

168 
	gm_row
.
	gm_w©ch_li¡
.
	gWL_C_ID
 = 
iCu¡om”Id
;

171 
	gm_iWICouÁ
 = (
UINT
è
m_ºd
.
RndIÁRªge
(
iMšI‹msInWL
,

172 
iMaxI‹msInWL
);

173 
	gm_£t
.
ş—r
(); m_£t.
size
(è< 
	gm_iWICouÁ
; )

176 
TId’t
 
	giSecur™yIndex
 = 
m_ºd
.
RndIÁ64Rªge
(
m_iMšSecIdx
, 
m_iMaxSecIdx
);

177 
	gm_£t
.
š£¹
(
iSecur™yIndex
);

180 
	gi
;

181 
	gIÁS‘
::
™”©Ü
 
pos
;

183 
	gi
=0, 
	gpos
=
m_£t
.
begš
();…os!=m_£t.
’d
(); ++i, ++pos)

185 
	gm_row
.
	gm_w©ch_™ems
[
i
].
	gWI_WL_ID
 = 
m_row
.
m_w©ch_li¡
.
WL_ID
;

187 
	gm_Secur™yFe
->
C»©eSymbŞ
Ğ*
pos
, 
m_row
.
m_w©ch_™ems
[
i
].
WI_S_SYMB
, 
¡©ic_ÿ¡
<>((m_row.m_watch_items[i].WI_S_SYMB)));

190 
	gbR‘
 = 
çl£
;

193 !
	gbR‘
 && 
	gm_cu¡
.
MÜeRecÜds
())

195 ià(
	gm_cu¡
.
G‘Cu¼’tC_ID
(è% 
	giDeçuÉLßdUn™Size
 == 0)

197 
m_bIn™NextLßdUn™
 = 
Œue
;

200 
	gm_cu¡
.
G’”©eNextC_ID
();

202 
	gbR‘
 = 
m_ºd
.
RndP”ûÁ
(
iP”ûÁW©chLi¡
);

207 ià(
	gbR‘
)

209 
	gm_bMÜeRecÜds
 = 
Œue
;

213 
	gm_bMÜeRecÜds
 = 
çl£
;

217  (
MÜeRecÜds
());

220 
PWATCH_LIST_ROW
 
G‘WLRow
(è{ &
	gm_row
.
	gm_w©ch_li¡
;}

221 
PWATCH_ITEM_ROW
 
G‘WIRow
(
UINT
 
i
)

223 ià(
	gi
<
	gm_iWICouÁ
)

224 (&
	gm_row
.
	gm_w©ch_™ems
[
i
]);

226 (
	gNULL
);

228 
UINT
 
G‘WICouÁ
(è{ 
	gm_iWICouÁ
;}

	@include/workload/tpce/egen/Wheel.h

42 #iâdeà
WHEEL_H


43 
	#WHEEL_H


	)

46 
	~"EG’Snd¬dTy³s.h
"

48 
Çme¥aû
 
	gTPCE


53 cÚ¡ 
INT32
 
	gMaxWh“lCyşes
 = 999999999;

55 
	sTWh“lCÚfig


57 
INT32
 
	gWh“lSize
;

58 
INT32
 
	gWh“lResŞutiÚ
;

60 
TWh“lCÚfig
Ğ
INT32
 
Size
, INT32 
ResŞutiÚ
 )

61 : 
Wh“lSize
Ğ
Size
 )

62 , 
Wh“lResŞutiÚ
Ğ
ResŞutiÚ
 )

65 } *
	tPWh“lCÚfig
;

	@include/workload/tpce/egen/WheelTime.h

42 #iâdeà
WHEEL_TIME_H


43 
	#WHEEL_TIME_H


	)

45 
	~"EG’Ut™›s_¡dafx.h
"

46 
	~"Wh“l.h
"

48 
Çme¥aû
 
	gTPCE


51 şas 
	cCWh“lTime


54 
	g´iv©e
:

55 
PWh“lCÚfig
 
m_pWh“lCÚfig
;

56 
INT32
 
	gm_Cyşes
;

57 
INT32
 
	gm_Index
;

59 
	gpublic
:

60 
CWh“lTime
Ğ
PWh“lCÚfig
 
pWh“lCÚfig
 );

61 
CWh“lTime
Ğ
PWh“lCÚfig
 
pWh“lCÚfig
, 
INT32
 
cyşes
, INT32 
šdex
 );

62 
CWh“lTime
Ğ
PWh“lCÚfig
 
pWh“lCÚfig
, 
CD©eTime
& 
Ba£
, CD©eTime& 
Now
, 
INT32
 
Off£t
 );

63 ~
CWh“lTime
( );

65 
šlše
 
INT32
 
Cyşes
Ğè{  
	gm_Cyşes
; };

66 
šlše
 
INT32
 
Index
Ğè{  
	gm_Index
; };

68 
Add
Ğ
INT32
 
IÁ”v®
 );

70 
INT32
 
Off£t
ĞcÚ¡ 
CWh“lTime
& 
Time
 );

72 
S‘
Ğ
INT32
 
cyşes
, INT32 
šdex
 );

73 
S‘
Ğ
CD©eTime
& 
Ba£
, CD©eTime& 
Now
 );

74 
S‘
Ğ
CD©eTime
* 
pBa£
, CD©eTime* 
pNow
 );

76 
	gCWh“lTime
& 
	gİ”©Ü
 = (cÚ¡ 
CWh“lTime
& 
Time
);

77 
boŞ
 
	gİ”©Ü
 <(cÚ¡ 
	gCWh“lTime
& 
	gTime
);

78 
	gCWh“lTime
& 
	gİ”©Ü
 +ğĞcÚ¡ 
INT32
& 
IÁ”v®
 );

79 
CWh“lTime
 
	gİ”©Ü
 ++ ( 
	gINT32
 );

	@include/workload/tpce/egen/ZipCodeTable.h

40 #iâdeà
ZIP_CODE_TABLE_H


41 
	#ZIP_CODE_TABLE_H


	)

43 
	~"EG’TabËs_commÚ.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCZCodeTabË
 : 
public
 
TabËTem¶©e
<
ZIP_CODE_ROW
>

50 
´iv©e
:

51 
TZCodeFe
* 
m_ZCode
;

52 
TZCodeIÅutRow
* 
	gm_NextRow
;

53 
UINT32
 
	gm_NextUniqueRecÜdID
;

55 
	gpublic
:

56 
CZCodeTabË
Ğ
CIÅutFes
 
šputFes
 )

57 : 
TabËTem¶©e
<
ZIP_CODE_ROW
>()

58 , 
m_ZCode
Ğ
šputFes
.
ZCode
 )

59 , 
m_NextUniqueRecÜdID
( 0 )

68 
boŞ
 
G’”©eNextRecÜd
()

70 ifĞ
	gm_NextUniqueRecÜdID
 < 
	gm_ZCode
->
RecÜdCouÁ
( ))

72 
¡ºıy
Ğ
m_row
.
ZC_CODE
, (
m_ZCode
->
G‘RecÜdByPassKey
Ğ
m_NextUniqueRecÜdID
 ))->ZC_CODE, ( m_row.ZC_CODE ) );

73 
¡ºıy
Ğ
m_row
.
ZC_TOWN
, (
m_ZCode
->
G‘RecÜdByPassKey
Ğ
m_NextUniqueRecÜdID
 ))->ZC_TOWN, ( m_row.ZC_TOWN ) );

74 
¡ºıy
Ğ
m_row
.
ZC_DIV
, (
m_ZCode
->
G‘RecÜdByPassKey
Ğ
m_NextUniqueRecÜdID
 ))->ZC_DIV, ( m_row.ZC_DIV ) );

75 
	gm_NextUniqueRecÜdID
++;

76 Ğ
	gŒue
 );

80  ( 
	gçl£
 );

	@include/workload/tpce/egen/bucketsimulator.h

37 #iâdeà
BUCKETSIM_H_INCLUDED


38 
	#BUCKETSIM_H_INCLUDED


	)

40 
	~"EG’TabËs_¡dafx.h
"

41 
	~"Cu¡om”S–eùiÚ.h
"

43 
	~"´og»ssm‘”.h
"

45 
Çme¥aû
 
	gTPCE


48 
şass
 
	gCRªdom
;

50 şas 
	cBuck‘Prog»ss
 : 
public
 
Prog»ssM‘”


52 
´iv©e
:

53 
acû±abË_¡ddev_
;

54 
	gmax_¡ddev_
;

56 
	gpublic
:

57 
Buck‘Prog»ss
(
acû±abË_¡ddev
, 
tÙ®
, 
v”bos™y
 = 0, 
¡d
::
o¡»am
* 
ouut
=&¡d::
cout
);

58 
vœtu®
 
di¥Ïy_mes§ge
(
¡d
::
o¡»am
& 
out
) const;

59 
boŞ
 
»pÜt
(
¡ddev
);

60 
max_¡ddev
();

67 şas 
	cBuck‘SimuÏtÜ
 {

68 
	g´iv©e
:

69 
CRªdom
 
m_ºd
;

70 
INT64
* 
	gm_buck‘s
;

71 
TId’t
 
	gm_cu¡couÁ
;

72 
	gm_™”¡¬t
;

73 
	gm_™”couÁ
;

74 
	gTPCE
::
RNGSEED
 
m_ba££ed
;

75 
TT¿de
 
	gm_simÜd”s
;

76 
	gm_maxbuck‘
;

77 
	gBuck‘Prog»ss
& 
	gm_´og»ss
;

79 cÚ¡ 
UINT
 
	gRND_STEP_PER_ORDER
 = 1;

81 
	gpublic
:

86 
Buck‘SimuÏtÜ
(

87 
™”¡¬t
,

88 
™”couÁ
,

89 
TId’t
 
iCu¡om”CouÁ
,

90 
TT¿de
 
m_simÜd”s
,

91 
TPCE
::
RNGSEED
 
ba£_£ed
,

92 
Buck‘Prog»ss
& 
´og
);

93 ~
Buck‘SimuÏtÜ
();

95 
ÿlc_¡ddev
();

99 
simuÏ‹_Ú”un
(
INT64
 
™”©iÚs
);

100 
simuÏ‹
();

102 
run
(* 
th»ad
);

	@include/workload/tpce/egen/error.h

37 #iâdeà
ERROR_H


38 
	#ERROR_H


	)

40 
	~<¡ršg
>

42 
Çme¥aû
 
	gTPCE


45 
	#ERR_TYPE_LOGIC
 -1

46 
	#ERR_SUCCESS
 0

47 
	#ERR_TYPE_OS
 11

48 
	#ERR_TYPE_MEMORY
 12

49 
	#ERR_TYPE_FIXED_MAP
 27

50 
	#ERR_TYPE_FIXED_ARRAY
 28

51 
	#ERR_TYPE_CHECK
 29

52 

	)

53 
	#ERR_INS_MEMORY
 "Insuffic›Á MemÜyØcÚtšue."

	)

54 
	#ERR_UNKNOWN
 "UnknowÀ”rÜ."

	)

55 
	#ERR_MSG_BUF_SIZE
 512

	)

56 
	#INV_ERROR_CODE
 -1

	)

58 şas 
	cCBa£E¼
 : 
public
 
¡d
::
exû±iÚ


60 
´Ùeùed
:

61 
¡d
::
¡ršg
 
m_loÿtiÚ
;

62 
	gm_idMsg
;

64 
	gpublic
:

65 
CBa£E¼
()

66 : 
m_loÿtiÚ
()

67 , 
m_idMsg
(
INV_ERROR_CODE
)

71 
CBa£E¼
(cÚ¡ * 
szLoc
)

72 : 
m_loÿtiÚ
(
szLoc
)

73 , 
m_idMsg
(
INV_ERROR_CODE
)

77 
CBa£E¼
(
idMsg
)

78 : 
m_loÿtiÚ
()

79 , 
m_idMsg
(
idMsg
)

83 
CBa£E¼
(
idMsg
, cÚ¡ * 
szLoc
)

84 : 
m_loÿtiÚ
(
szLoc
)

85 , 
m_idMsg
(
idMsg
)

89 ~
CBa£E¼
(è
throw
()

93 
vœtu®
 cÚ¡ * 
wh©
(ècÚ¡ 
throw
() {

94  
E¼ÜText
();

97 
vœtu®
 
E¼ÜNum
(è{  
	gm_idMsg
; }

98 
vœtu®
 
E¼ÜTy³
() = 0;

100 
vœtu®
 cÚ¡ *
E¼ÜText
() const = 0;

101 
vœtu®
 cÚ¡ *
E¼ÜLoc
(è{  
	gm_loÿtiÚ
.
c_¡r
(); }

104 şas 
	cCMemÜyE¼
 : 
public
 
CBa£E¼


106 
public
:

107 
CMemÜyE¼
()

108 : 
CBa£E¼
()

112 
CMemÜyE¼
(cÚ¡ * 
szLoc
)

113 : 
CBa£E¼
(
szLoc
)

117 
E¼ÜTy³
(è{ 
ERR_TYPE_MEMORY
;}

118 cÚ¡ *
E¼ÜText
(ècÚ¡ { 
	gERR_INS_MEMORY
;}

121 şas 
	cCSy¡emE¼
 : 
public
 
CBa£E¼


123 
public
:

124 
	eAùiÚ


126 
eNÚe
 = 0,

127 
	geT¿n§ùNamedPe
,

128 
	geWa™NamedPe
,

129 
	geS‘NamedPeHªdËS‹
,

130 
	geC»©eFe
,

131 
	geC»©eProûss
,

132 
	geC®lNamedPe
,

133 
	geC»©eEv’t
,

134 
	geC»©eTh»ad
,

135 
	geVœtu®AÎoc
,

136 
	geR—dFe
 = 10,

137 
	geWr™eFe
,

138 
	geM­V›wOfFe
,

139 
	geC»©eFeM­pšg
,

140 
	geIn™ŸlizeSecur™yDesütÜ
,

141 
	geS‘Secur™yDesütÜDaş
,

142 
	geC»©eNamedPe
,

143 
	geCÚÃùNamedPe
,

144 
	geWa™FÜSšgËObjeù
,

145 
	geRegO³nKeyEx
,

146 
	geRegQu”yV®ueEx
 = 20,

147 
	gebegšth»ad
,

148 
	geRegEnumV®ue
,

149 
	geRegS‘V®ueEx
,

150 
	geRegC»©eKeyEx
,

151 
	geWa™FÜMuÉËObjeùs
,

152 
	geRegi¡”CÏssEx
,

153 
	geC»©eWšdow
,

154 
	geC»©eSem­hÜe
,

155 
	geR–—£Sem­hÜe
,

156 
	geFS“k
,

157 
	geFR—d
,

158 
	geFWr™e
,

159 
	geTmpFe
,

160 
	geS‘FePoš‹r
,

161 
	geNew
,

162 
	geClo£HªdË
,

163 
	geC»©eMu‹x
,

164 
	geR–—£Mu‹x


167 
CSy¡emE¼
(
AùiÚ
 
eAùiÚ
, cÚ¡ * 
szLoÿtiÚ
);

168 
CSy¡emE¼
(
iE¼Ü
, 
AùiÚ
 
eAùiÚ
, cÚ¡ * 
szLoÿtiÚ
);

169 
E¼ÜTy³
(è{  
	gERR_TYPE_OS
;};

170 cÚ¡ *
E¼ÜText
() const;

172 
AùiÚ
 
	gm_eAùiÚ
;

174 ~
CSy¡emE¼
(è
throw
()

180 şas 
	cCBa£TxnE¼


182 
	gpublic
:

186 
SUCCESS
 = 0,

187 
	gEXPECTED_ROLLBACK
 = 1,

193 
	gBVF1_ERROR1
 = -111,

195 
	gCPF1_ERROR1
 = -211,

196 
	gCPF2_ERROR1
 = -221,

198 
	gMFF1_ERROR1
 = -311,

200 
	gMWF1_ERROR1
 = -411,

202 
	gSDF1_ERROR1
 = -511,

203 
	gSDF1_ERROR2
 = -512,

204 
	gSDF1_ERROR3
 = -513,

206 
	gTLF1_ERROR1
 = -611,

207 
	gTLF2_ERROR1
 = -621,

208 
	gTLF2_WARN1
 = +621,

209 
	gTLF3_ERROR1
 = -631,

210 
	gTLF3_WARN1
 = +631,

211 
	gTLF4_ERROR1
 = -641,

212 
	gTLF4_WARN1
 = +641,

213 
	gTLF4_ERROR2
 = -642,

215 
	gTOF1_ERROR1
 = -711,

216 
	gTOF2_ERROR1
 = -721,

217 
	gTOF3_ERROR1
 = -731,

218 
	gTOF3_ERROR2
 = -732,

219 
	gTOF3_ERROR3
 = -733,

221 
	gTRF1_ERROR1
 = -811,

222 
	gTRF3_ERROR1
 = -831,

223 
	gTRF4_ERROR1
 = -841,

225 
	gTSF1_ERROR1
 = -911,

227 
	gTUF1_ERROR1
 = -1011,

228 
	gTUF2_ERROR1
 = -1021,

229 
	gTUF2_WARN1
 = +1021,

230 
	gTUF3_ERROR1
 = -1031,

231 
	gTUF3_WARN1
 = +1031,

233 } 
	gmE¼Code
;

236 şas 
	cCCheckE¼
 : 
public
 
CBa£E¼


238 
´iv©e
:

239 
¡d
::
¡ršg
 
Çme_
;

240 
	g¡d
::
¡ršg
 
msg_
;

241 
	gpublic
:

242 
CCheckE¼
()

243 : 
CBa£E¼
()

247 ~
CCheckE¼
(è
throw
()

251 
CCheckE¼
(cÚ¡ *
Çme
, cÚ¡ 
¡d
::
¡ršg
& 
msg
)

252 : 
CBa£E¼
(
Çme
)

253 , 
msg_
(
msg
)

257 
E¼ÜTy³
(è{ 
	gERR_TYPE_CHECK
;}

258 cÚ¡ *
E¼ÜText
() const {

259  
	gmsg_
.
c_¡r
();

	@include/workload/tpce/egen/locking.h

37 #iâdeà
LOCKING_H_INCLUDED


38 
	#LOCKING_H_INCLUDED


	)

40 
	~"EG’Snd¬dTy³s.h
"

42 
Çme¥aû
 
	gTPCE


46 şas 
	cCMu‹x


48 
	g´iv©e
:

49 
TMu‹x
 
mu‹x_
;

50 
TMu‹x
* 
mu‹x
();

51 
	gpublic
:

52 
CMu‹x
();

53 ~
CMu‹x
();

54 
lock
();

55 
uÆock
();

60 
	g‹m¶©e
<
ty³Çme
 
	gT
>

61 şas 
	cLock”


63 
	g´iv©e
:

64 
T
& 
mu‹x_
;

66 
	gpublic
:

67 
ex¶ic™
 
Lock”
<
T
>(T& 
mu‹x
)

68 : 
mu‹x_
(
mu‹x
)

70 
mu‹x_
.
lock
();

73 ~
	gLock”
<
	gT
>() {

74 
	gmu‹x_
.
uÆock
();

	@include/workload/tpce/egen/progressmeter.h

41 #iâdeà
PROGRESSMETER_H_INCLUDED


42 
	#PROGRESSMETER_H_INCLUDED


	)

44 
	~<io¡»am
>

46 
	~"D©eTime.h
"

47 
	~"´og»ssm‘”š‹rçû.h
"

48 
	~"lockšg.h
"

50 
Çme¥aû
 
	gTPCE


53 şas 
	cProg»ssM‘”
 : 
public
 
Prog»ssM‘”IÁ”çû


55 
´iv©e
:

56 
m_tÙ®
;

57 
	gm_cu¼’t
;

58 
	gm_di¥Ïy_š‹rv®
;

59 
CD©eTime
 
	gm_¡¬t_time
;

60 
CD©eTime
 
	gm_Ï¡_time
;

61 
	g¡d
::
o¡»am
* 
m_ouut
;

62 
	gm_v”bos™y
;

63 
mubË
 
CMu‹x
 
	gm_mu‹x
;

65 
	gpublic
:

67 
Prog»ssM‘”
(
tÙ®
, 
v”bos™y
 = 0, 
¡d
::
o¡»am
* 
ouut
=&¡d::
cout
);

71 
£t_di¥Ïy_š‹rv®
(
v®
);

72 
di¥Ïy_š‹rv®
() const;

76 
vœtu®
 
di¥Ïy
() const;

81 
vœtu®
 
di¥Ïy_mes§ge
(
¡d
::
o¡»am
& 
out
) const;

89 
šc
(
couÁ
=1);

92 
cu¼’t
() const;

95 
tÙ®
() const;

97 
lock
() const;

98 
uÆock
() const;

104 
vœtu®
 
mes§ge
(cÚ¡ 
¡d
::
¡ršg
& 
mesg
, 
Ëv–
=0);

	@include/workload/tpce/egen/progressmeterinterface.h

37 #iâdeà
PROGRESSMETERINTERFACE_H_INCLUDED


38 
	#PROGRESSMETERINTERFACE_H_INCLUDED


	)

40 
	~<¡ršg
>

42 
Çme¥aû
 
	gTPCE


47 şas 
	cProg»ssM‘”IÁ”çû


49 
	gpublic
:

50 
vœtu®
 ~
Prog»ssM‘”IÁ”çû
();

53 
vœtu®
 
di¥Ïy
() const;

57 
vœtu®
 
šc
(
couÁ
=1);

62 
vœtu®
 
mes§ge
(cÚ¡ 
¡d
::
¡ršg
& 
mesg
, 
Ëv–
=0);

	@include/workload/tpce/egen/strutil.h

41 #iâdeà
STRUTIL_H_INCLUDED


42 
	#STRUTIL_H_INCLUDED


	)

44 
	~<¡ršg
>

45 
	~"EG’Snd¬dTy³s.h
"

47 
usšg
 
Çme¥aû
 
	g¡d
;

49 
Çme¥aû
 
	gTPCE


54 
INT64
 
¡¹ošt64
 (cÚ¡ *
±r
);

58 
¡¹odbl
 (cÚ¡ *
±r
);

63 
INT64
 
time¡¹ošt64
 (cÚ¡ *
±r
);

67 
¡d
::
¡ršg
 
št64tÙime¡r
 (
INT64
 
v®
);

	@include/workload/tpce/egen/threading.h

37 #iâdeà
THREADING_H_INCLUDED


38 
	#THREADING_H_INCLUDED


	)

40 
	~<memÜy
>

41 
	~<s¡»am
>

42 
	~<¡dexû±
>

44 
	~"EG’Snd¬dTy³s.h
"

46 
Çme¥aû
 
	gTPCE


52 şas 
	cTh»adBa£


54 
	gpublic
:

55 
vœtu®
 ~
Th»adBa£
();

56 
vœtu®
 
švoke
() = 0;

60 #ifdeà
WIN32


61 
DWORD
 
WINAPI
 
¡¬t_th»ad
(
LPVOID
 
¬g
);

64 * 
¡¬t_th»ad
(*
¬g
);

69 
	g‹m¶©e
<
ty³Çme
 
	gT
>

70 şas 
	cTh»ad
 : 
public
 
Th»adBa£


72 
´iv©e
:

73 
¡d
::
auto_±r
<
T
> 
obj_
;

74 
TTh»ad
 
	gtid_
;

75 #iâdeà
WIN32


76 
TTh»adA‰r
 
	g©Œ_
;

78 
	g¡acksize_
;

79 
	gpublic
:

80 
Th»ad
(
¡d
::
auto_±r
<
T
> 
throbj
)

81 : 
obj_
(
throbj
)

82 , 
tid_
()

83 #iâdeà
WIN32


84 , 
©Œ_
()

86 , 
¡acksize_
(0)

88 #iâdeà
WIN32


89 
±h»ad_©Œ_š™
(&
©Œ_
);

92 
Th»ad
(
¡d
::
auto_±r
<
T
> 
throbj
, 
¡acksize
)

93 : 
obj_
(
throbj
)

94 , 
tid_
()

95 #iâdeà
WIN32


96 , 
©Œ_
()

98 , 
¡acksize_
(
¡acksize
)

100 #iâdeà
WIN32


101 
±h»ad_©Œ_š™
(&
©Œ_
);

104 
T
* 
obj
() {

105  
	gobj_
.
g‘
();

107 
švoke
() {

108 
	gobj_
->
run
(
this
);

110 
¡¬t
();

111 
¡İ
();

118 #ifdeà
WIN32


120 
	g‹m¶©e
<
ty³Çme
 
	gT
>

121 
	gTh»ad
<
	gT
>::
	$¡¬t
()

123 
tid_
 = 
	`C»©eTh»ad
(
NULL
, 
¡acksize_
, 
¡¬t_th»ad
, 
this
, NULL, NULL);

124 ià(
tid_
 =ğ
NULL
) {

125 
¡d
::
o¡ršg¡»am
 
¡rm
;

126 
¡rm
 << "C»©eTh»adƒ¼Ü: " << 
	`G‘La¡E¼Ü
();

127 
throw
 
¡d
::
	`ruÁime_”rÜ
(
¡rm
.
	`¡r
());

129 
	}
}

131 
	g‹m¶©e
<
ty³Çme
 
	gT
>

132 
	gTh»ad
<
	gT
>::
	$¡İ
()

134 
DWORD
 
rc
 = 
	`Wa™FÜSšgËObjeù
(
tid_
, 
INFINITE
);

135 ià(
rc
 != 0) {

136 
¡d
::
o¡ršg¡»am
 
¡rm
;

137 
¡rm
 << "Wa™FÜSšgËObjeùƒ¼Ü: " << 
	`G‘La¡E¼Ü
();

138 
throw
 
¡d
::
	`ruÁime_”rÜ
(
¡rm
.
	`¡r
());

140 
	}
}

148 
	g‹m¶©e
<
ty³Çme
 
	gT
>

149 
	gTh»ad
<
	gT
>::
	$¡¬t
()

151 
rc
 = 0;

153 ià(
¡acksize_
 > 0)

155 
rc
 = 
	`±h»ad_©Œ_£t¡acksize
(&
©Œ_
, 
¡acksize_
);

156 ià(
rc
 != 0) {

157 
¡d
::
o¡ršg¡»am
 
¡rm
;

158 
¡rm
 << "±h»ad_©Œ_£t¡acksiz”rÜ: " << 
	`¡»¼Ü
(
rc
) << "(" <<„c << ")";

159 
throw
 
¡d
::
	`ruÁime_”rÜ
(
¡rm
.
	`¡r
());

163 
rc
 = 
	`±h»ad_ü—‹
(&
tid_
, &
©Œ_
, 
¡¬t_th»ad
, 
this
);

164 ià(
rc
 != 0) {

165 
¡d
::
o¡ršg¡»am
 
¡rm
;

166 
¡rm
 << "±h»ad_ü—‹ƒ¼Ü: " << 
	`¡»¼Ü
(
rc
) << "(" <<„c << ")";

167 
throw
 
¡d
::
	`ruÁime_”rÜ
(
¡rm
.
	`¡r
());

169 
	}
}

171 
	g‹m¶©e
<
ty³Çme
 
	gT
>

172 
	gTh»ad
<
	gT
>::
	$¡İ
()

174 
rc
 = 
	`±h»ad_još
(
tid_
, 
NULL
);

175 ià(
rc
 != 0) {

176 
¡d
::
o¡ršg¡»am
 
¡rm
;

177 
¡rm
 << "±h»ad_jošƒ¼Ü: " << 
	`¡»¼Ü
(
rc
) << "(" <<„c << ")";

178 
throw
 
¡d
::
	`ruÁime_”rÜ
(
¡rm
.
	`¡r
());

180 
	}
}

	@include/workload/tpce/egen/threading_pthread.h

44 #iâdeà
THREADING_PTHREAD_H_INCLUDED


45 
	#THREADING_PTHREAD_H_INCLUDED


	)

47 
	~<±h»ad.h
>

48 
	~<memÜy
>

49 
	~<s¡»am
>

50 
	~<¡dexû±
>

52 
Çme¥aû
 
	gTPCE


55 
şass
 
	gCCÚd™iÚ
;

58 şas 
	cCMu‹x


60 
	g´iv©e
:

61 
±h»ad_mu‹x_t
 
mu‹x_
;

62 
±h»ad_mu‹x_t
* 
mu‹x
();

63 
	gpublic
:

64 
CMu‹x
();

65 
lock
();

66 
uÆock
();

68 
ä›nd
 
şass
 
	gCCÚd™iÚ
;

72 şas 
	cCCÚd™iÚ


74 
	g´iv©e
:

75 
CMu‹x
& 
mu‹x_
;

76 
mubË
 
±h»ad_cÚd_t
 
	gcÚd_
;

77 
	g´Ùeùed
:

78 
CMu‹x
& 
mu‹x
();

79 
	gpublic
:

80 
CCÚd™iÚ
(
CMu‹x
& 
mu‹x
);

81 
wa™
() const;

82 
lock
();

83 
uÆock
();

84 
boŞ
 
timedwa™
(cÚ¡ 
time¥ec
& 
timeout
) const;

85 
boŞ
 
timedwa™
(
timeout
=-1 ) const;

86 
sigÇl
();

87 
brßdÿ¡
();

92 
	g‹m¶©e
<
ty³Çme
 
	gT
>

93 şas 
	cLock”


95 
	g´iv©e
:

96 
T
& 
mu‹x_
;

98 
	gpublic
:

99 
ex¶ic™
 
Lock”
<
T
>(T& 
mu‹x
)

100 : 
mu‹x_
(
mu‹x
)

102 
mu‹x_
.
lock
();

105 ~
	gLock”
<
	gT
>() {

106 
	gmu‹x_
.
uÆock
();

113 şas 
	cTh»adBa£


115 
	gpublic
:

116 
vœtu®
 ~
Th»adBa£
();

117 
vœtu®
 
švoke
() = 0;

121 "C" * 
¡¬t_th»ad
(*
¬g
);

125 
	g‹m¶©e
<
ty³Çme
 
	gT
>

126 şas 
	cTh»ad
 : 
public
 
Th»adBa£


128 
´iv©e
:

129 
¡d
::
auto_±r
<
T
> 
obj_
;

130 
±h»ad_t
 
	gtid_
;

131 
	gpublic
:

132 
Th»ad
(
¡d
::
auto_±r
<
T
> 
throbj
)

133 : 
obj_
(
throbj
)

134 , 
tid_
()

137 
¡¬t
() {

138 
	grc
 = 
±h»ad_ü—‹
(&
tid_
, 
NULL
, 
¡¬t_th»ad
, 
this
);

139 ià(
	grc
 != 0) {

140 
¡d
::
o¡ršg¡»am
 
¡rm
;

141 
	g¡rm
 << "±h»ad_ü—‹ƒ¼Ü: " << 
¡»¼Ü
(
rc
è<< "(" << 
	grc
 << ")";

142 
throw
 
	g¡d
::
ruÁime_”rÜ
(
¡rm
.
¡r
());

145 
¡İ
() {

146 
	grc
 = 
±h»ad_još
(
tid_
, 
NULL
);

147 ià(
	grc
 != 0) {

148 
¡d
::
o¡ršg¡»am
 
¡rm
;

149 
	g¡rm
 << "±h»ad_jošƒ¼Ü: " << 
¡»¼Ü
(
rc
è<< "(" << 
	grc
 << ")";

150 
throw
 
	g¡d
::
ruÁime_”rÜ
(
¡rm
.
¡r
());

153 
švoke
() {

154 
	gobj_
->
run
(
this
);

156 
T
* 
obj
() {

157  
	gobj_
.
g‘
();

	@include/workload/tpce/egen/threading_single.h

42 #iâdeà
THREADING_SINGLE_H_INCLUDED


43 
	#THREADING_SINGLE_H_INCLUDED


	)

45 
	~<memÜy
>

47 
Çme¥aû
 
	gTPCE


52 
şass
 
	gCCÚd™iÚ
;

53 şas 
	cCMu‹x


55 
	gpublic
:

56 
CMu‹x
();

57 
lock
();

58 
uÆock
();

60 
ä›nd
 
şass
 
	gCCÚd™iÚ
;

63 şas 
	cCCÚd™iÚ


65 
	g´iv©e
:

66 
CMu‹x
& 
mu‹x_
;

67 
	g´Ùeùed
:

68 
CMu‹x
& 
mu‹x
();

69 
	gpublic
:

70 
CCÚd™iÚ
(
CMu‹x
& 
mu‹x
);

71 
lock
();

72 
uÆock
();

73 
wa™
() const;

74 
boŞ
 
timedwa™
(cÚ¡ 
time¥ec
& 
timeout
) const;

75 
boŞ
 
timedwa™
(
timeout
=-1 ) const;

76 
sigÇl
();

77 
brßdÿ¡
();

82 
	g‹m¶©e
<
ty³Çme
 
	gT
>

83 şas 
	cLock”


85 
	g´iv©e
:

86 
T
& 
mu‹x_
;

88 
	gpublic
:

89 
ex¶ic™
 
Lock”
<
T
>(T& 
mu‹x
)

90 : 
mu‹x_
(
mu‹x
)

92 
mu‹x_
.
lock
();

95 ~
	gLock”
<
	gT
>() {

96 
	gmu‹x_
.
uÆock
();

103 şas 
	cTh»adBa£


105 
	gpublic
:

106 
vœtu®
 ~
Th»adBa£
();

107 
vœtu®
 
run
() = 0;

112 
	g‹m¶©e
<
ty³Çme
 
	gT
>

113 şas 
	cTh»ad
 : 
public
 
Th»adBa£


115 
´iv©e
:

116 
¡d
::
auto_±r
<
T
> 
obj_
;

117 
	gpublic
:

118 
Th»ad
(
¡d
::
auto_±r
<
T
> 
obj
)

119 : 
obj_
(
obj
)

122 
¡¬t
() {

123 
obj_
->
run
(
this
);

125 
¡İ
() {

127 
run
() {

129 
T
* 
obj
() {

130  
	gobj_
.
g‘
();

	@include/workload/tpce/egen/unusedflag.h

40 #iâdeà
UNUSEDFLAG_H_INCLUDED


41 
	#UNUSEDFLAG_H_INCLUDED


	)

42 #ifdeà
__GNUC__


43 
	#UNUSED
 
	`__©Œibu‹__
((
unu£d
))

	)

45 
	#UNUSED


	)

	@include/workload/tpce/shore_tpce_client.h

31 #iâdeà
__SHORE_TPCE_CLIENT_H


32 
	#__SHORE_TPCE_CLIENT_H


	)

34 
	~"sm/shÜe/shÜe_ş›Á.h
"

36 
	~"wÜklßd/û/shÜe_û_’v.h
"

38 
usšg
 
Çme¥aû
 
	gshÜe
;

40 
ENTER_NAMESPACE
(
û
);

51 şas 
	cba£lše_û_ş›Á_t
 : 
public
 
ba£_ş›Á_t


53 
´iv©e
:

55 
_£lid
;

56 
Œx_wÜk”_t
* 
	m_wÜk”
;

57 
	m_qf
;

60 
	mpublic
:

62 
	$ba£lše_û_ş›Á_t
() { }

64 
	`ba£lše_û_ş›Á_t
(
c_¡r
 
Šame
, cÚ¡ 
id
, 
ShÜeTPCEEnv
* 
’v
,

65 cÚ¡ 
M—su»m’tTy³
 
aTy³
, cÚ¡ 
Œxid
,

66 cÚ¡ 
numOfTrxs
,

67 
´oûssÜid_t
 
­rsid
, cÚ¡ 
£lID
, cÚ¡ 
qf
);

69 ~
	$ba£lše_û_ş›Á_t
(è{ 
	}
}

72 cÚ¡ 
lßd_sup_xù
(
m­SupTrxs
& 
m­
);

76 
w_rc_t
 
subm™_Úe
(
xù_ty³
, 
xùid
);

81 
EXIT_NAMESPACE
(
û
);

	@include/workload/tpce/shore_tpce_egen.h

31 #iâdeà
__SHORE_TPCE_EGEN_H


32 
	#__SHORE_TPCE_EGEN_H


	)

34 
	~"wÜklßd/û/eg’/EG’Lßd”_¡dafx.h
"

35 
	~"wÜklßd/û/eg’/EG’Snd¬dTy³s.h
"

36 
	~"wÜklßd/û/eg’/EG’TabËs_¡dafx.h
"

37 
	~"wÜklßd/û/eg’/TabË_Defs.h
"

40 
usšg
 
Çme¥aû
 
	gTPCE
;

42 
ENTER_NAMESPACE
(
û
);

44 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

45 şas 
	cEg’Tu¶eCÚš”


47 
	msize
;

48 
	mÿ·c™y
;

49 
	mút
;

50 
T
* 
	mbufãr
;

51 
boŞ
 
	mmÜeToR—d
;

54 
	mpublic
:

55 
	$g‘Size
(è{ 
size
;}

56 
	$£tSize
(
k
è{
size
 = k;
	}
}

57 
	$g‘C­ac™y
(è{ 
ÿ·c™y
;
	}
}

58 
	$g‘RowSize
(è{ (
T
);
	}
}

59 
	$g‘CÁ
(è{ 
út
;
	}
}

61 
	$Eg’Tu¶eCÚš”
 (
ÿp
): 
	`size
(0), 
	$ÿ·c™y
(
ÿp
){

62 
bufãr
 = 
Ãw
 
T
 [
ÿ·c™y
];

63 
mÜeToR—d
=
Œue
;

64 
út
 = 0;

65 
	}
}

66 
T
* 
	$g‘
(
i
){
út
++;  &
bufãr
[i]; 
	}
}

67 
	$­³nd
(
T
* 
row
è{
	`memıy
(&
bufãr
[
size
++],row, (T)); 
	}
}

68 
boŞ
 
	$hasS·û
(){ (
size
<
ÿ·c™y
-2);
	}
}

69 
boŞ
 
	$hasMÜeToR—d
(è{ 
mÜeToR—d
;
	}
}

70 
	$£tMÜeToR—d
(
boŞ
 
x
è{
mÜeToR—d
 = x;
	}
}

71 
	$»£t
(è{
size
=0;
	}
}

72 
	$»Ëa£
(è{ 
	}
}

73 
	$ÃwLßdUn™
(){
size
=0; 
mÜeToR—d
=
Œue
;
	}
}

76 
şass
 
	gAccouÁP”missiÚBufãr
: 
public
 
Eg’Tu¶eCÚš”
<
ACCOUNT_PERMISSION_ROW
>{

77 
public
:

78 
AccouÁP”missiÚBufãr
(
c
): 
Eg’Tu¶eCÚš”
<
ACCOUNT_PERMISSION_ROW
>(c){}

80 
şass
 
	gCu¡om”Bufãr
: 
public
 
Eg’Tu¶eCÚš”
<
CUSTOMER_ROW
>{

81 
public
:

82 
Cu¡om”Bufãr
(
c
): 
Eg’Tu¶eCÚš”
<
CUSTOMER_ROW
>(c){}

84 
şass
 
	gCu¡om”AccouÁBufãr
: 
public
 
Eg’Tu¶eCÚš”
<
CUSTOMER_ACCOUNT_ROW
>{

85 
public
:

86 
Cu¡om”AccouÁBufãr
(
c
): 
Eg’Tu¶eCÚš”
<
CUSTOMER_ACCOUNT_ROW
>(c){}

88 
şass
 
	gCu¡om”Tax¿‹Bufãr
: 
public
 
Eg’Tu¶eCÚš”
<
CUSTOMER_TAXRATE_ROW
>{

89 
public
:

90 
Cu¡om”Tax¿‹Bufãr
(
c
): 
Eg’Tu¶eCÚš”
<
CUSTOMER_TAXRATE_ROW
>(c){}

92 
şass
 
	gHŞdšgBufãr
: 
public
 
Eg’Tu¶eCÚš”
<
HOLDING_ROW
>{

93 
public
:

94 
HŞdšgBufãr
(
c
): 
Eg’Tu¶eCÚš”
<
HOLDING_ROW
>(c){}

96 
şass
 
	gHŞdšgHi¡ÜyBufãr
: 
public
 
Eg’Tu¶eCÚš”
<
HOLDING_HISTORY_ROW
>{

97 
public
:

98 
HŞdšgHi¡ÜyBufãr
(
c
): 
Eg’Tu¶eCÚš”
<
HOLDING_HISTORY_ROW
>(c){}

100 
şass
 
	gHŞdšgSumm¬yBufãr
: 
public
 
Eg’Tu¶eCÚš”
<
HOLDING_SUMMARY_ROW
>{

101 
public
:

102 
HŞdšgSumm¬yBufãr
(
c
): 
Eg’Tu¶eCÚš”
<
HOLDING_SUMMARY_ROW
>(c){}

104 
şass
 
	gW©chI‹mBufãr
: 
public
 
Eg’Tu¶eCÚš”
<
WATCH_ITEM_ROW
>{

105 
public
:

106 
W©chI‹mBufãr
(
c
): 
Eg’Tu¶eCÚš”
<
WATCH_ITEM_ROW
>(c){}

108 
şass
 
	gW©chLi¡Bufãr
: 
public
 
Eg’Tu¶eCÚš”
<
WATCH_LIST_ROW
>{

109 
public
:

110 
W©chLi¡Bufãr
(
c
): 
Eg’Tu¶eCÚš”
<
WATCH_LIST_ROW
>(c){}

113 
şass
 
	gBrok”Bufãr
: 
public
 
Eg’Tu¶eCÚš”
<
BROKER_ROW
>{

114 
public
:

115 
Brok”Bufãr
(
c
): 
Eg’Tu¶eCÚš”
<
BROKER_ROW
>(c){}

117 
şass
 
	gCashT¿n§ùiÚBufãr
: 
public
 
Eg’Tu¶eCÚš”
<
CASH_TRANSACTION_ROW
>{

118 
public
:

119 
CashT¿n§ùiÚBufãr
(
c
): 
Eg’Tu¶eCÚš”
<
CASH_TRANSACTION_ROW
>(c){}

121 
şass
 
	gCh¬geBufãr
: 
public
 
Eg’Tu¶eCÚš”
<
CHARGE_ROW
>{

122 
public
:

123 
Ch¬geBufãr
(
c
): 
Eg’Tu¶eCÚš”
<
CHARGE_ROW
>(c){}

125 
şass
 
	gCommissiÚR©eBufãr
: 
public
 
Eg’Tu¶eCÚš”
<
COMMISSION_RATE_ROW
>{

126 
public
:

127 
CommissiÚR©eBufãr
(
c
): 
Eg’Tu¶eCÚš”
<
COMMISSION_RATE_ROW
>(c){}

129 
şass
 
	gS‘em’tBufãr
: 
public
 
Eg’Tu¶eCÚš”
<
SETTLEMENT_ROW
>{

130 
public
:

131 
S‘em’tBufãr
(
c
): 
Eg’Tu¶eCÚš”
<
SETTLEMENT_ROW
>(c){}

133 
şass
 
	gT¿deBufãr
: 
public
 
Eg’Tu¶eCÚš”
<
TRADE_ROW
>{

134 
public
:

135 
T¿deBufãr
(
c
): 
Eg’Tu¶eCÚš”
<
TRADE_ROW
>(c){}

137 
şass
 
	gT¿deHi¡ÜyBufãr
: 
public
 
Eg’Tu¶eCÚš”
<
TRADE_HISTORY_ROW
>{

138 
public
:

139 
T¿deHi¡ÜyBufãr
(
c
): 
Eg’Tu¶eCÚš”
<
TRADE_HISTORY_ROW
>(c){}

141 
şass
 
	gT¿deReque¡Bufãr
: 
public
 
Eg’Tu¶eCÚš”
<
TRADE_REQUEST_ROW
>{

142 
public
:

143 
T¿deReque¡Bufãr
(
c
): 
Eg’Tu¶eCÚš”
<
TRADE_REQUEST_ROW
>(c){}

145 
şass
 
	gT¿deTy³Bufãr
: 
public
 
Eg’Tu¶eCÚš”
<
TRADE_TYPE_ROW
>{

146 
public
:

147 
T¿deTy³Bufãr
(
c
): 
Eg’Tu¶eCÚš”
<
TRADE_TYPE_ROW
>(c){}

149 
şass
 
	gCom·nyBufãr
: 
public
 
Eg’Tu¶eCÚš”
<
COMPANY_ROW
>{

150 
public
:

151 
Com·nyBufãr
(
c
): 
Eg’Tu¶eCÚš”
<
COMPANY_ROW
>(c){}

153 
şass
 
	gCom·nyCom³t™ÜBufãr
: 
public
 
Eg’Tu¶eCÚš”
<
COMPANY_COMPETITOR_ROW
>{

154 
public
:

155 
Com·nyCom³t™ÜBufãr
(
c
): 
Eg’Tu¶eCÚš”
<
COMPANY_COMPETITOR_ROW
>(c){}

157 
şass
 
	gDayM¬k‘Bufãr
: 
public
 
Eg’Tu¶eCÚš”
<
DAILY_MARKET_ROW
>{

158 
public
:

159 
DayM¬k‘Bufãr
(
c
): 
Eg’Tu¶eCÚš”
<
DAILY_MARKET_ROW
>(c){}

161 
şass
 
	gExchªgeBufãr
: 
public
 
Eg’Tu¶eCÚš”
<
EXCHANGE_ROW
>{

162 
public
:

163 
ExchªgeBufãr
(
c
): 
Eg’Tu¶eCÚš”
<
EXCHANGE_ROW
>(c){}

165 
şass
 
	gFšªcŸlBufãr
: 
public
 
Eg’Tu¶eCÚš”
<
FINANCIAL_ROW
>{

166 
public
:

167 
FšªcŸlBufãr
(
c
): 
Eg’Tu¶eCÚš”
<
FINANCIAL_ROW
>(c){}

169 
şass
 
	gIndu¡ryBufãr
: 
public
 
Eg’Tu¶eCÚš”
<
INDUSTRY_ROW
>{

170 
public
:

171 
Indu¡ryBufãr
(
c
): 
Eg’Tu¶eCÚš”
<
INDUSTRY_ROW
>(c){}

173 
şass
 
	gLa¡T¿deBufãr
: 
public
 
Eg’Tu¶eCÚš”
<
LAST_TRADE_ROW
>{

174 
public
:

175 
La¡T¿deBufãr
(
c
): 
Eg’Tu¶eCÚš”
<
LAST_TRADE_ROW
>(c){}

178 
şass
 
	gNewsI‹mBufãr
: 
public
 
Eg’Tu¶eCÚš”
<
NEWS_ITEM_ROW
>{

179 
public
:

180 
NewsI‹mBufãr
(
c
): 
Eg’Tu¶eCÚš”
<
NEWS_ITEM_ROW
>(c){}

183 
şass
 
	gNewsXRefBufãr
: 
public
 
Eg’Tu¶eCÚš”
<
NEWS_XREF_ROW
>{

184 
public
:

185 
NewsXRefBufãr
(
c
): 
Eg’Tu¶eCÚš”
<
NEWS_XREF_ROW
>(c){}

188 
şass
 
	gSeùÜBufãr
: 
public
 
Eg’Tu¶eCÚš”
<
SECTOR_ROW
>{

189 
public
:

190 
SeùÜBufãr
(
c
): 
Eg’Tu¶eCÚš”
<
SECTOR_ROW
>(c){}

193 
şass
 
	gSecur™yBufãr
: 
public
 
Eg’Tu¶eCÚš”
<
SECURITY_ROW
>{

194 
public
:

195 
Secur™yBufãr
(
c
): 
Eg’Tu¶eCÚš”
<
SECURITY_ROW
>(c){}

199 
şass
 
	gAdd»ssBufãr
: 
public
 
Eg’Tu¶eCÚš”
<
ADDRESS_ROW
>{

200 
public
:

201 
Add»ssBufãr
(
c
): 
Eg’Tu¶eCÚš”
<
ADDRESS_ROW
>(c){}

203 
şass
 
	gStusTy³Bufãr
: 
public
 
Eg’Tu¶eCÚš”
<
STATUS_TYPE_ROW
>{

204 
public
:

205 
StusTy³Bufãr
(
c
): 
Eg’Tu¶eCÚš”
<
STATUS_TYPE_ROW
>(c){}

208 
şass
 
	gTax¿‹Bufãr
: 
public
 
Eg’Tu¶eCÚš”
<
TAXRATE_ROW
>{

209 
public
:

210 
Tax¿‹Bufãr
(
c
): 
Eg’Tu¶eCÚš”
<
TAXRATE_ROW
>(c){}

213 
şass
 
	gZCodeBufãr
: 
public
 
Eg’Tu¶eCÚš”
<
ZIP_CODE_ROW
>{

214 
public
:

215 
ZCodeBufãr
(
c
): 
Eg’Tu¶eCÚš”
<
ZIP_CODE_ROW
>(c){}

219 
EXIT_NAMESPACE
(
û
);

	@include/workload/tpce/shore_tpce_env.h

32 #iâdeà
__SHORE_TPCE_ENV_H


33 
	#__SHORE_TPCE_ENV_H


	)

36 
	~"sm_vas.h
"

37 
	~"ut.h
"

39 
	~"wÜklßd/û/û_šput.h
"

41 
	~"sm/shÜe/shÜe_’v.h
"

42 
	~"sm/shÜe/shÜe_asc_sÜt_buf.h
"

43 
	~"sm/shÜe/shÜe_desc_sÜt_buf.h
"

44 
	~"sm/shÜe/shÜe_Œx_wÜk”.h
"

46 
	~"wÜklßd/û/shÜe_û_schema_mª.h
"

47 
	~"wÜklßd/û/eg’/EG’Lßd”_¡dafx.h
"

48 
	~"wÜklßd/û/eg’/EG’Snd¬dTy³s.h
"

49 
	~"wÜklßd/û/eg’/EG’TabËs_¡dafx.h
"

50 
	~"wÜklßd/û/eg’/TabË_Defs.h
"

51 
	~"wÜklßd/û/shÜe_û_eg’.h
"

52 
	~"wÜklßd/û/û_šput.h
"

53 
	~"wÜklßd/û/eg’/DM.h
"

55 
	~<m­
>

57 
usšg
 
Çme¥aû
 
	gshÜe
;

58 
usšg
 
Çme¥aû
 
	gTPCE
;

63 
eg’_š™
(
¬gc
, * 
¬gv
[]);

64 
eg’_»Ëa£
();

65 
CG’”©eAndLßd
* 
pG’”©eAndLßd
;

67 
ENTER_NAMESPACE
(
û
);

69 
usšg
 
	g¡d
::
m­
;

71 
AccouÁP”missiÚBufãr
 
accouÁP”missiÚBufãr
;

72 
Cu¡om”Bufãr
 
cu¡om”Bufãr
 ;

73 
Cu¡om”AccouÁBufãr
 
cu¡om”AccouÁBufãr
 ;

74 
Cu¡om”Tax¿‹Bufãr
 
cu¡om”Tax¿‹Bufãr
 ;

75 
HŞdšgBufãr
 
hŞdšgBufãr
;

76 
HŞdšgHi¡ÜyBufãr
 
hŞdšgHi¡ÜyBufãr
;

77 
HŞdšgSumm¬yBufãr
 
hŞdšgSumm¬yBufãr
;

78 
W©chI‹mBufãr
 
w©chI‹mBufãr
 ;

79 
W©chLi¡Bufãr
 
w©chLi¡Bufãr
;

81 
Brok”Bufãr
 
brok”Bufãr
;

82 
CashT¿n§ùiÚBufãr
 
ÿshT¿n§ùiÚBufãr
;

83 
Ch¬geBufãr
 
ch¬geBufãr
;

84 
CommissiÚR©eBufãr
 
commissiÚR©eBufãr
;

85 
S‘em’tBufãr
 
£‰Ëm’tBufãr
;

86 
T¿deBufãr
 
ŒadeBufãr
;

87 
T¿deHi¡ÜyBufãr
 
ŒadeHi¡ÜyBufãr
;

88 
T¿deTy³Bufãr
 
ŒadeTy³Bufãr
;

91 
Com·nyBufãr
 
com·nyBufãr
 ;

92 
Com·nyCom³t™ÜBufãr
 
com·nyCom³t™ÜBufãr
;

93 
DayM¬k‘Bufãr
 
dayM¬k‘Bufãr
;

94 
ExchªgeBufãr
 
exchªgeBufãr
;

95 
FšªcŸlBufãr
 
fšªcŸlBufãr
;

96 
Indu¡ryBufãr
 
šdu¡ryBufãr
;

97 
La¡T¿deBufãr
 
Ï¡T¿deBufãr
;

98 
NewsI‹mBufãr
 
ÃwsI‹mBufãr
;

99 
NewsXRefBufãr
 
ÃwsXRefBufãr
;

100 
SeùÜBufãr
 
£ùÜBufãr
;

101 
Secur™yBufãr
 
£cur™yBufãr
;

104 
Add»ssBufãr
 
add»ssBufãr
;

105 
StusTy³Bufãr
 
¡©usTy³Bufãr
;

106 
Tax¿‹Bufãr
 
x¿‹Bufãr
 ;

107 
ZCodeBufãr
 
zCodeBufãr
 ;

110 #ifdeà
TESTING_TPCE


111 
Œxs_út_execu‹d
[];

112 
Œxs_út_çed
[];

115 
T¿deOrd”CÁ
;

126 
	sShÜeTPCETrxCouÁ


128 
ušt
 
	mbrok”_vŞume
;

129 
ušt
 
	mcu¡om”_pos™iÚ
;

130 
ušt
 
	mm¬k‘_ãed
;

131 
ušt
 
	mm¬k‘_w©ch
;

132 
ušt
 
	m£cur™y_d‘a
;

133 
ušt
 
	mŒade_lookup
;

134 
ušt
 
	mŒade_Üd”
;

135 
ušt
 
	mŒade_»suÉ
;

136 
ušt
 
	mŒade_¡©us
;

137 
ušt
 
	mŒade_upd©e
;

138 
ušt
 
	md©a_maš‹Çnû
;

139 
ušt
 
	mŒade_ş—nup
;

141 
	mShÜeTPCETrxCouÁ
& 
	mİ”©Ü
+=(
ShÜeTPCETrxCouÁ
 cÚ¡& 
rhs
) {

142 
brok”_vŞume
 +ğ
rhs
.broker_volume;

143 
	mcu¡om”_pos™iÚ
 +ğ
rhs
.
cu¡om”_pos™iÚ
;

144 
	mm¬k‘_ãed
 +ğ
rhs
.
m¬k‘_ãed
;

145 
	mm¬k‘_w©ch
 +ğ
rhs
.
m¬k‘_w©ch
;

146 
	m£cur™y_d‘a
 +ğ
rhs
.
£cur™y_d‘a
;

147 
	mŒade_lookup
 +ğ
rhs
.
Œade_lookup
;

148 
	mŒade_Üd”
 +ğ
rhs
.
Œade_Üd”
;

149 
	mŒade_»suÉ
 +ğ
rhs
.
Œade_»suÉ
;

150 
	mŒade_¡©us
 +ğ
rhs
.
Œade_¡©us
;

151 
	mŒade_upd©e
 +ğ
rhs
.
Œade_upd©e
;

152 
	md©a_maš‹Çnû
 +ğ
rhs
.
d©a_maš‹Çnû
;

153 
	mŒade_ş—nup
 +ğ
rhs
.
Œade_ş—nup
;

155  (*
	mthis
);

158 
	mShÜeTPCETrxCouÁ
& 
	mİ”©Ü
-=(
ShÜeTPCETrxCouÁ
 cÚ¡& 
rhs
) {

159 
brok”_vŞume
 -ğ
rhs
.broker_volume;

160 
	mcu¡om”_pos™iÚ
 -ğ
rhs
.
cu¡om”_pos™iÚ
;

161 
	mm¬k‘_ãed
 -ğ
rhs
.
m¬k‘_ãed
;

162 
	mm¬k‘_w©ch
 -ğ
rhs
.
m¬k‘_w©ch
;

163 
	m£cur™y_d‘a
 -ğ
rhs
.
£cur™y_d‘a
;

164 
	mŒade_lookup
 -ğ
rhs
.
Œade_lookup
;

165 
	mŒade_Üd”
 -ğ
rhs
.
Œade_Üd”
;

166 
	mŒade_»suÉ
 -ğ
rhs
.
Œade_»suÉ
;

167 
	mŒade_¡©us
 -ğ
rhs
.
Œade_¡©us
;

168 
	mŒade_upd©e
 -ğ
rhs
.
Œade_upd©e
;

169 
	md©a_maš‹Çnû
 -ğ
rhs
.
d©a_maš‹Çnû
;

170 
	mŒade_ş—nup
 -ğ
rhs
.
Œade_ş—nup
;

172  (*
	mthis
);

175 cÚ¡ 
tÙ®
() const {

176  (
	mbrok”_vŞume
 + 
	mcu¡om”_pos™iÚ
 + 
	mm¬k‘_ãed
 +

177 
	mm¬k‘_w©ch
 + 
	m£cur™y_d‘a
 + 
	mŒade_lookup
 +

178 
	mŒade_Üd”
 + 
	mŒade_»suÉ
 + 
	mŒade_¡©us
 +

179 
	mŒade_upd©e
 + 
	md©a_maš‹Çnû
 + 
	mŒade_ş—nup
);

185 
	sShÜeTPCETrxSts


187 
ShÜeTPCETrxCouÁ
 
	m©‹m±ed
;

188 
ShÜeTPCETrxCouÁ
 
	mçed
;

189 
ShÜeTPCETrxCouÁ
 
	md—dlocked
;

191 
	mShÜeTPCETrxSts
& 
	mİ”©Ü
+=(
ShÜeTPCETrxSts
 cÚ¡& 
Ùh”
) {

192 
©‹m±ed
 +ğ
Ùh”
.attempted;

193 
	mçed
 +ğ
Ùh”
.
çed
;

194 
	md—dlocked
 +ğ
Ùh”
.
d—dlocked
;

195  (*
	mthis
);

198 
	mShÜeTPCETrxSts
& 
	mİ”©Ü
-=(
ShÜeTPCETrxSts
 cÚ¡& 
Ùh”
) {

199 
©‹m±ed
 -ğ
Ùh”
.attempted;

200 
	mçed
 -ğ
Ùh”
.
çed
;

201 
	md—dlocked
 -ğ
Ùh”
.
d—dlocked
;

202  (*
	mthis
);

217 şas 
	cShÜeTPCEEnv
 : 
public
 
ShÜeEnv


219 
public
:

220 
¡d
::
	tm­
<
	t±h»ad_t
, 
	tShÜeTPCETrxSts
*> 
	t¡©m­_t
;

222 
şass
 
	mbË_bud”_t
;

223 
şass
 
	mbË_ü—tÜ_t
;

224 
	mcheckpoš‹r_t
;

226 
	m´Ùeùed
:

235 
_cu¡om”s
;

236 
	m_wÜkšg_days
;

237 
	m_sÿlšg_çùÜ_û
;

239 
	m´iv©e
:

240 
w_rc_t
 
_po¡_š™_im¶
();

243 
w_rc_t
 
_lßd_Úe_£ùÜ
(
»p_row_t
& 
¬•row
, 
PSECTOR_ROW
 
»cÜd
);

244 
w_rc_t
 
_lßd_Úe_ch¬ge
Ğ
»p_row_t
& 
¬•row
, 
PCHARGE_ROW
 
»cÜd
);

245 
w_rc_t
 
_lßd_Úe_commissiÚ_¿‹
(
»p_row_t
& 
¬•row
, 
PCOMMISSION_RATE_ROW
 
»cÜd
);

246 
w_rc_t
 
_lßd_Úe_exchªge
(
»p_row_t
& 
¬•row
, 
PEXCHANGE_ROW
 
»cÜd
);

247 
w_rc_t
 
_lßd_Úe_šdu¡ry
(
»p_row_t
& 
¬•row
, 
PINDUSTRY_ROW
 
»cÜd
);

248 
w_rc_t
 
_lßd_Úe_¡©us_ty³
(
»p_row_t
& 
¬•row
, 
PSTATUS_TYPE_ROW
 
»cÜd
);

249 
w_rc_t
 
_lßd_Úe_x¿‹
(
»p_row_t
& 
¬•row
, 
PTAXRATE_ROW
 
»cÜd
);

250 
w_rc_t
 
_lßd_Úe_Œade_ty³
(
»p_row_t
& 
¬•row
, 
PTRADE_TYPE_ROW
 
»cÜd
);

251 
w_rc_t
 
_lßd_Úe_z_code
(
»p_row_t
& 
¬•row
, 
PZIP_CODE_ROW
 
»cÜd
);

253 
w_rc_t
 
_lßd_Úe_ÿsh_Œª§ùiÚ
(
»p_row_t
& 
¬•row
, 
PCASH_TRANSACTION_ROW
 
»cÜd
);

254 
w_rc_t
 
_lßd_Úe_£‰Ëm’t
(
»p_row_t
& 
¬•row
, 
PSETTLEMENT_ROW
 
»cÜd
);

255 
w_rc_t
 
_lßd_Úe_Œade
(
»p_row_t
& 
¬•row
, 
PTRADE_ROW
 
»cÜd
);

256 
w_rc_t
 
_lßd_Úe_Œade_hi¡Üy
(
»p_row_t
& 
¬•row
, 
PTRADE_HISTORY_ROW
 
»cÜd
);

257 
w_rc_t
 
_lßd_Úe_Œade_»que¡
(
»p_row_t
& 
¬•row
, 
PTRADE_REQUEST_ROW
 
»cÜd
);

259 
w_rc_t
 
_lßd_Úe_accouÁ_³rmissiÚ
(
»p_row_t
& 
¬•row
, 
PACCOUNT_PERMISSION_ROW
 
»cÜd
);

260 
w_rc_t
 
_lßd_Úe_brok”
(
»p_row_t
& 
¬•row
, 
PBROKER_ROW
 
»cÜd
);

261 
w_rc_t
 
_lßd_Úe_com·ny
(
»p_row_t
& 
¬•row
, 
PCOMPANY_ROW
 
»cÜd
);

262 
w_rc_t
 
_lßd_Úe_cu¡om”
(
»p_row_t
& 
¬•row
, 
PCUSTOMER_ROW
 
»cÜd
);

263 
w_rc_t
 
_lßd_Úe_com·ny_com³t™Ü
(
»p_row_t
& 
¬•row
, 
PCOMPANY_COMPETITOR_ROW
 
»cÜd
);

264 
w_rc_t
 
_lßd_Úe_£cur™y
(
»p_row_t
& 
¬•row
, 
PSECURITY_ROW
 
»cÜd
);

265 
w_rc_t
 
_lßd_Úe_cu¡om”_accouÁ
(
»p_row_t
& 
¬•row
, 
PCUSTOMER_ACCOUNT_ROW
 
»cÜd
);

266 
w_rc_t
 
_lßd_Úe_day_m¬k‘
(
»p_row_t
& 
¬•row
, 
PDAILY_MARKET_ROW
 
»cÜd
);

267 
w_rc_t
 
_lßd_Úe_cu¡om”_x¿‹
(
»p_row_t
& 
¬•row
, 
PCUSTOMER_TAXRATE_ROW
 
»cÜd
);

268 
w_rc_t
 
_lßd_Úe_hŞdšg
(
»p_row_t
& 
¬•row
, 
PHOLDING_ROW
 
»cÜd
);

269 
w_rc_t
 
_lßd_Úe_fšªcŸl
(
»p_row_t
& 
¬•row
, 
PFINANCIAL_ROW
 
»cÜd
);

270 
w_rc_t
 
_lßd_Úe_hŞdšg_hi¡Üy
(
»p_row_t
& 
¬•row
, 
PHOLDING_HISTORY_ROW
 
»cÜd
);

271 
w_rc_t
 
_lßd_Úe_add»ss
(
»p_row_t
& 
¬•row
, 
PADDRESS_ROW
 
»cÜd
);

272 
w_rc_t
 
_lßd_Úe_hŞdšg_summ¬y
(
»p_row_t
& 
¬•row
, 
PHOLDING_SUMMARY_ROW
 
»cÜd
);

273 
w_rc_t
 
_lßd_Úe_Ï¡_Œade
(
»p_row_t
& 
¬•row
, 
PLAST_TRADE_ROW
 
»cÜd
);

274 
w_rc_t
 
_lßd_Úe_w©ch_™em
(
»p_row_t
& 
¬•row
, 
PWATCH_ITEM_ROW
 
»cÜd
);

275 
w_rc_t
 
_lßd_Úe_Ãws_™em
(
»p_row_t
& 
¬•row
, 
PNEWS_ITEM_ROW
 
»cÜd
);

276 
w_rc_t
 
_lßd_Úe_w©ch_li¡
(
»p_row_t
& 
¬•row
, 
PWATCH_LIST_ROW
 
»cÜd
);

277 
w_rc_t
 
_lßd_Úe_Ãws_x»f
(
»p_row_t
& 
¬•row
, 
PNEWS_XREF_ROW
 
»cÜd
);

280 
_»ad_£ùÜ
();

281 
_»ad_ch¬ge
();

282 
_»ad_commissiÚ_¿‹
();

283 
_»ad_exchªge
();

284 
_»ad_šdu¡ry
();

285 
_»ad_¡©us_ty³
();

286 
_»ad_x¿‹
();

287 
_»ad_Œade_ty³
();

288 
_»ad_z_code
();

290 
_»ad_ÿsh_Œª§ùiÚ
();

291 
_»ad_£‰Ëm’t
();

292 
_»ad_Œade
();

293 
_»ad_Œade_hi¡Üy
();

295 
_»ad_ÿ_ªd_­
();

296 
_»ad_brok”
();

297 
_»ad_com·ny
();

298 
_»ad_cu¡om”
();

299 
_»ad_com·ny_com³t™Ü
();

300 
_»ad_£cur™y
();

301 
_»ad_day_m¬k‘
();

302 
_»ad_cu¡om”_x¿‹
();

303 
_»ad_hŞdšg
();

304 
_»ad_fšªcŸl
();

305 
_»ad_hŞdšg_hi¡Üy
();

306 
_»ad_add»ss
();

307 
_»ad_hŞdšg_summ¬y
();

308 
_»ad_Ï¡_Œade
();

309 
_»ad_wl_ªd_wi
();

310 
_»ad_ni_ªd_nx
();

311 
_»ad_Œade_un™
();

314 
	mpublic
:

317 
ShÜeTPCEEnv
();

319 
	mvœtu®
 ~
ShÜeTPCEEnv
();

323 
vœtu®
 
	$£t
(
’vV¬M­
* ) { (0); };

324 
vœtu®
 
	$İ’
(è{ (0); 
	}
};

325 
vœtu®
 
	$·u£
(è{ (0); 
	}
};

326 
vœtu®
 
	$»sume
(è{ (0); 
	}
};

327 
vœtu®
 
w_rc_t
 
	$Ãwrun
(è{ (
RCOK
); 
	}
};

329 
vœtu®
 
po¡_š™
();

330 
vœtu®
 
w_rc_t
 
lßd_schema
();

332 
vœtu®
 
w_rc_t
 
lßd_ªd_»gi¡”_fids
();

334 
vœtu®
 
cÚf
();

335 
vœtu®
 
¡¬t
();

336 
vœtu®
 
¡İ
();

337 
vœtu®
 
	$šfo
() const;

338 
vœtu®
 
	`¡©i¡ics
();

340 
	`dump
();

343 
	`£t_cu¡
(cÚ¡ 
aC
);

344 
šlše
 
	$g‘_cu¡
(è{  (
_cu¡om”s
); 
	}
}

346 
£t_wd
(cÚ¡ 
awd
);

347 
šlše
 
	$g‘_wd
(è{  (
_wÜkšg_days
); 
	}
}

349 
£t_sã
(cÚ¡ 
asf
);

350 
šlše
 
	$g‘_sã
(è{  (
_sÿlšg_çùÜ_û
); 
	}
}

355 
ušt
 
	g_num_šv®id_šput
;

356 
vœtu®
 
´št_throughput
(cÚ¡ 
iQu”›dSF
,

357 cÚ¡ 
iS´—d
,

358 cÚ¡ 
iNumOfTh»ads
,

359 cÚ¡ 
d–ay
,

360 cÚ¡ 
ulÚg_t
 
mioch
,

361 cÚ¡ 
avgıuu§ge
);

363 
	$»ad_sm®l
(){

364 
pG’”©eAndLßd
->
	`In™Ch¬ge
();

365 
	`_»ad_ch¬ge
();

366 
pG’”©eAndLßd
->
	`In™CommissiÚR©e
();

367 
	`_»ad_commissiÚ_¿‹
();

368 
pG’”©eAndLßd
->
	`In™Exchªge
();

369 
	`_»ad_exchªge
();

370 
pG’”©eAndLßd
->
	`In™Indu¡ry
();

371 
	`_»ad_šdu¡ry
();

372 
pG’”©eAndLßd
->
	`In™SeùÜ
();

373 
	`_»ad_£ùÜ
();

374 
pG’”©eAndLßd
->
	`In™StusTy³
();

375 
	`_»ad_¡©us_ty³
();

376 
pG’”©eAndLßd
->
	`In™Tax¿‹
();

377 
	`_»ad_x¿‹
();

378 
pG’”©eAndLßd
->
	`In™T¿deTy³
();

379 
	`_»ad_Œade_ty³
();

380 
pG’”©eAndLßd
->
	`In™ZCode
();

381 
	`_»ad_z_code
();

382 
	}
}

384 
	$»Ëa£_sm®l
(){

385 
ch¬geBufãr
.
	`»Ëa£
();

386 
commissiÚR©eBufãr
.
	`»Ëa£
();

387 
exchªgeBufãr
.
	`»Ëa£
();

388 
šdu¡ryBufãr
.
	`»Ëa£
();

389 
£ùÜBufãr
.
	`»Ëa£
();

390 
¡©usTy³Bufãr
.
	`»Ëa£
();

391 
x¿‹Bufãr
.
	`»Ëa£
();

392 
ŒadeTy³Bufãr
.
	`»Ëa£
();

393 
zCodeBufãr
.
	`»Ëa£
();

394 
	}
}

396 
pİuÏ‹_cu¡om”
();

397 
pİuÏ‹_add»ss
();

398 
pİuÏ‹_ÿ_ªd_­
();

399 
pİuÏ‹_wl_ªd_wi
();

400 
pİuÏ‹_ni_ªd_nx
();

401 
pİuÏ‹_Ï¡_Œade
();

402 
pİuÏ‹_com·ny
();

403 
pİuÏ‹_com·ny_com³t™Ü
();

404 
pİuÏ‹_day_m¬k‘
();

405 
pİuÏ‹_fšªcŸl
();

406 
pİuÏ‹_£cur™y
();

407 
pİuÏ‹_cu¡om”_x¿‹
();

408 
pİuÏ‹_brok”
();

409 
pİuÏ‹_hŞdšg
();

410 
pİuÏ‹_hŞdšg_summ¬y
();

411 
pİuÏ‹_un™_Œade
();

412 
pİuÏ‹_growšg
();

413 
fšd_maxŒade_id
();

417 
w_rc_t
 
lßdd©a
();

418 
w_rc_t
 
w¬mup
();

419 
w_rc_t
 
check_cÚsi¡’cy
();

425 
DECLARE_TABLE
(
£ùÜ_t
,
£ùÜ_mª_im¶
,
£ùÜ
);

426 
DECLARE_TABLE
(
ch¬ge_t
,
ch¬ge_mª_im¶
,
ch¬ge
);

427 
DECLARE_TABLE
(
commissiÚ_¿‹_t
,
commissiÚ_¿‹_mª_im¶
,
commissiÚ_¿‹
);

428 
DECLARE_TABLE
(
exchªge_t
,
exchªge_mª_im¶
,
exchªge
);

429 
DECLARE_TABLE
(
šdu¡ry_t
,
šdu¡ry_mª_im¶
,
šdu¡ry
);

430 
DECLARE_TABLE
(
¡©us_ty³_t
,
¡©us_ty³_mª_im¶
,
¡©us_ty³
);

431 
DECLARE_TABLE
(
x¿‹_t
,
x¿‹_mª_im¶
,
x¿‹
);

432 
DECLARE_TABLE
(
Œade_ty³_t
,
Œade_ty³_mª_im¶
,
Œade_ty³
);

433 
DECLARE_TABLE
(
z_code_t
,
z_code_mª_im¶
,
z_code
);

436 
DECLARE_TABLE
(
ÿsh_Œª§ùiÚ_t
,
ÿsh_Œª§ùiÚ_mª_im¶
,
ÿsh_Œª§ùiÚ
);

437 
DECLARE_TABLE
(
£‰Ëm’t_t
,
£‰Ëm’t_mª_im¶
,
£‰Ëm’t
);

438 
DECLARE_TABLE
(
Œade_t
,
Œade_mª_im¶
,
Œade
);

439 
DECLARE_TABLE
(
Œade_hi¡Üy_t
,
Œade_hi¡Üy_mª_im¶
,
Œade_hi¡Üy
);

440 
DECLARE_TABLE
(
Œade_»que¡_t
,
Œade_»que¡_mª_im¶
,
Œade_»que¡
);

443 
DECLARE_TABLE
(
accouÁ_³rmissiÚ_t
,
accouÁ_³rmissiÚ_mª_im¶
,
accouÁ_³rmissiÚ
);

444 
DECLARE_TABLE
(
brok”_t
,
brok”_mª_im¶
,
brok”
);

445 
DECLARE_TABLE
(
com·ny_t
,
com·ny_mª_im¶
,
com·ny
);

446 
DECLARE_TABLE
(
cu¡om”_t
,
cu¡om”_mª_im¶
,
cu¡om”
);

447 
DECLARE_TABLE
(
com·ny_com³t™Ü_t
,
com·ny_com³t™Ü_mª_im¶
,
com·ny_com³t™Ü
);

448 
DECLARE_TABLE
(
£cur™y_t
,
£cur™y_mª_im¶
,
£cur™y
);

449 
DECLARE_TABLE
(
cu¡om”_accouÁ_t
,
cu¡om”_accouÁ_mª_im¶
,
cu¡om”_accouÁ
);

450 
DECLARE_TABLE
(
day_m¬k‘_t
,
day_m¬k‘_mª_im¶
,
day_m¬k‘
);

451 
DECLARE_TABLE
(
cu¡om”_x¿‹_t
,
cu¡om”_x¿‹_mª_im¶
,
cu¡om”_x¿‹
);

452 
DECLARE_TABLE
(
hŞdšg_t
,
hŞdšg_mª_im¶
,
hŞdšg
);

453 
DECLARE_TABLE
(
fšªcŸl_t
,
fšªcŸl_mª_im¶
,
fšªcŸl
);

454 
DECLARE_TABLE
(
hŞdšg_hi¡Üy_t
,
hŞdšg_hi¡Üy_mª_im¶
,
hŞdšg_hi¡Üy
);

455 
DECLARE_TABLE
(
add»ss_t
,
add»ss_mª_im¶
,
add»ss
);

456 
DECLARE_TABLE
(
hŞdšg_summ¬y_t
,
hŞdšg_summ¬y_mª_im¶
,
hŞdšg_summ¬y
);

457 
DECLARE_TABLE
(
Ï¡_Œade_t
,
Ï¡_Œade_mª_im¶
,
Ï¡_Œade
);

458 
DECLARE_TABLE
(
w©ch_li¡_t
,
w©ch_li¡_mª_im¶
,
w©ch_li¡
);

459 
DECLARE_TABLE
(
w©ch_™em_t
,
w©ch_™em_mª_im¶
,
w©ch_™em
);

460 
DECLARE_TABLE
(
Ãws_™em_t
,
Ãws_™em_mª_im¶
,
Ãws_™em
);

461 
DECLARE_TABLE
(
Ãws_x»f_t
,
Ãws_x»f_mª_im¶
,
Ãws_x»f
);

466 
w_rc_t
 
run_Úe_xù
(
Reque¡
* 
´eque¡
);

469 
DECLARE_TRX
(
brok”_vŞume
);

470 
DECLARE_TRX
(
cu¡om”_pos™iÚ
);

471 
DECLARE_TRX
(
m¬k‘_ãed
);

472 
DECLARE_TRX
(
m¬k‘_w©ch
);

473 
DECLARE_TRX
(
£cur™y_d‘a
);

474 
DECLARE_TRX
(
Œade_lookup
);

475 
DECLARE_TRX
(
Œade_Üd”
);

476 
DECLARE_TRX
(
Œade_»suÉ
);

477 
DECLARE_TRX
(
Œade_¡©us
);

478 
DECLARE_TRX
(
Œade_upd©e
);

479 
DECLARE_TRX
(
d©a_maš‹Çnû
);

480 
DECLARE_TRX
(
Œade_ş—nup
);

484 
DECLARE_TRX
(
pİuÏ‹_sm®l
);

485 
DECLARE_TRX
(
pİuÏ‹_cu¡om”
);

486 
DECLARE_TRX
(
pİuÏ‹_add»ss
);

487 
DECLARE_TRX
(
pİuÏ‹_ÿ_ªd_­
);

488 
DECLARE_TRX
(
pİuÏ‹_wl_ªd_wi
);

489 
DECLARE_TRX
(
pİuÏ‹_com·ny
);

490 
DECLARE_TRX
(
pİuÏ‹_com·ny_com³t™Ü
);

491 
DECLARE_TRX
(
pİuÏ‹_day_m¬k‘
);

492 
DECLARE_TRX
(
pİuÏ‹_fšªcŸl
);

493 
DECLARE_TRX
(
pİuÏ‹_Ï¡_Œade
);

494 
DECLARE_TRX
(
pİuÏ‹_ni_ªd_nx
);

495 
DECLARE_TRX
(
pİuÏ‹_£cur™y
);

496 
DECLARE_TRX
(
pİuÏ‹_cu¡om”_x¿‹
);

497 
DECLARE_TRX
(
pİuÏ‹_brok”
);

498 
DECLARE_TRX
(
pİuÏ‹_hŞdšg
);

499 
DECLARE_TRX
(
pİuÏ‹_hŞdšg_summ¬y
);

500 
DECLARE_TRX
(
pİuÏ‹_un™_Œade
);

503 
DECLARE_TRX
(
fšd_maxŒade_id
);

506 
vœtu®
 
’v_th»ad_š™
();

507 
vœtu®
 
’v_th»ad_fši
();

510 
¡©m­_t
 
	g_¡©m­
;

513 
ShÜeTPCETrxSts
 
	g_Ï¡_¡©s
;

514 
vœtu®
 
»£t_¡©s
();

515 
ShÜeTPCETrxSts
 
_g‘_¡©s
();

518 
w_rc_t
 
db_´št
(
lšes
);

521 
w_rc_t
 
db_ãtch
();

527 
EXIT_NAMESPACE
(
û
);

	@include/workload/tpce/shore_tpce_schema.h

32 #iâdeà
__SHORE_TPCE_SCHEMA_H


33 
	#__SHORE_TPCE_SCHEMA_H


	)

35 
	~<m©h.h
>

37 
	~"sm_vas.h
"

38 
	~"ut.h
"

40 
	~"sm/shÜe/shÜe_bË_mª.h
"

41 
	~"wÜklßd/û/û_cÚ¡.h
"

43 
usšg
 
Çme¥aû
 
	gshÜe
;

46 
ENTER_NAMESPACE
(
û
);

64 
DECLARE_TABLE_SCHEMA_PD
(
£ùÜ_t
);

66 
DECLARE_TABLE_SCHEMA_PD
(
ch¬ge_t
);

67 
DECLARE_TABLE_SCHEMA_PD
(
commissiÚ_¿‹_t
);

68 
DECLARE_TABLE_SCHEMA_PD
(
exchªge_t
);

69 
DECLARE_TABLE_SCHEMA_PD
(
šdu¡ry_t
);

70 
DECLARE_TABLE_SCHEMA_PD
(
¡©us_ty³_t
);

71 
DECLARE_TABLE_SCHEMA_PD
(
x¿‹_t
);

72 
DECLARE_TABLE_SCHEMA_PD
(
Œade_ty³_t
);

73 
DECLARE_TABLE_SCHEMA_PD
(
z_code_t
);

76 
DECLARE_TABLE_SCHEMA_PD
(
ÿsh_Œª§ùiÚ_t
);

77 
DECLARE_TABLE_SCHEMA_PD
(
£‰Ëm’t_t
);

78 
DECLARE_TABLE_SCHEMA_PD
(
Œade_t
);

79 
DECLARE_TABLE_SCHEMA_PD
(
Œade_hi¡Üy_t
);

80 
DECLARE_TABLE_SCHEMA_PD
(
Œade_»que¡_t
);

83 
DECLARE_TABLE_SCHEMA_PD
(
accouÁ_³rmissiÚ_t
);

84 
DECLARE_TABLE_SCHEMA_PD
(
brok”_t
);

85 
DECLARE_TABLE_SCHEMA_PD
(
com·ny_t
);

86 
DECLARE_TABLE_SCHEMA_PD
(
cu¡om”_t
);

87 
DECLARE_TABLE_SCHEMA_PD
(
com·ny_com³t™Ü_t
);

88 
DECLARE_TABLE_SCHEMA_PD
(
£cur™y_t
);

89 
DECLARE_TABLE_SCHEMA_PD
(
cu¡om”_accouÁ_t
);

90 
DECLARE_TABLE_SCHEMA_PD
(
day_m¬k‘_t
);

91 
DECLARE_TABLE_SCHEMA_PD
(
cu¡om”_x¿‹_t
);

92 
DECLARE_TABLE_SCHEMA_PD
(
hŞdšg_t
);

93 
DECLARE_TABLE_SCHEMA_PD
(
fšªcŸl_t
);

94 
DECLARE_TABLE_SCHEMA_PD
(
hŞdšg_hi¡Üy_t
);

95 
DECLARE_TABLE_SCHEMA_PD
(
add»ss_t
);

96 
DECLARE_TABLE_SCHEMA_PD
(
hŞdšg_summ¬y_t
);

97 
DECLARE_TABLE_SCHEMA_PD
(
Ï¡_Œade_t
);

98 
DECLARE_TABLE_SCHEMA_PD
(
w©ch_™em_t
);

99 
DECLARE_TABLE_SCHEMA_PD
(
Ãws_™em_t
);

100 
DECLARE_TABLE_SCHEMA_PD
(
w©ch_li¡_t
);

101 
DECLARE_TABLE_SCHEMA_PD
(
Ãws_x»f_t
);

104 
DECLARE_TABLE_SCHEMA_PD
(
dim’siÚ_t
);

106 
EXIT_NAMESPACE
(
û
);

	@include/workload/tpce/shore_tpce_schema_man.h

35 #iâdeà
__SHORE_TPCE_SCHEMA_MANAGER_H


36 
	#__SHORE_TPCE_SCHEMA_MANAGER_H


	)

38 
	~"wÜklßd/û/shÜe_û_schema.h
"

39 
	~"wÜklßd/û/eg’/TxnH¬ÃssSŒuùs.h
"

41 
usšg
 
Çme¥aû
 
	gTPCE
;

42 
usšg
 
Çme¥aû
 
	gshÜe
;

45 
ENTER_NAMESPACE
(
û
);

56 
şass
 
	gaccouÁ_³rmissiÚ_mª_im¶
 : 
public
 
bË_mª_im¶
<
accouÁ_³rmissiÚ_t
>

58 
bË_row_t
 
	taccouÁ_³rmissiÚ_tu¶e
;

59 
	gšdex_sÿn_™”_im¶
 <
	taccouÁ_³rmissiÚ_t
> 
	taccouÁ_³rmissiÚ_šdex_™”
;

61 
	gpublic
:

63 
accouÁ_³rmissiÚ_mª_im¶
(
accouÁ_³rmissiÚ_t
* 
aAccouÁ_P”missiÚDesc
)

64 : 
bË_mª_im¶
<
accouÁ_³rmissiÚ_t
>(
aAccouÁ_P”missiÚDesc
) { }

66 ~
accouÁ_³rmissiÚ_mª_im¶
() { }

68 
w_rc_t
 
­_šdex_´obe
(
ss_m
* 
db
, 
accouÁ_³rmissiÚ_tu¶e
* 
±u¶e
,

69 cÚ¡ 
TId’t
 
acù_id
,

70 cÚ¡ * 
exec_x_id
);

72 
w_rc_t
 
­_g‘_™”_by_šdex
(
ss_m
* 
db
,

73 
accouÁ_³rmissiÚ_šdex_™”
* &
™”
,

74 
accouÁ_³rmissiÚ_tu¶e
* 
±u¶e
,

75 
»p_row_t
 &
»¶ow
,

76 
»p_row_t
 &
»phigh
,

77 cÚ¡ 
TId’t
 
acù_id
,

78 
lock_mode_t
 
®m
 = 
SH
,

79 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

81 
w_rc_t
 
­_upd©e_aş
(
ss_m
* 
db
, 
accouÁ_³rmissiÚ_tu¶e
* 
±u¶e
, cÚ¡ * 
aş
, 
lock_mode_t
 
lm
 = 
EX
);

89 
şass
 
	gbrok”_mª_im¶
 : 
public
 
bË_mª_im¶
<
brok”_t
>

91 
bË_row_t
 
	tbrok”_tu¶e
;

92 
	gšdex_sÿn_™”_im¶
 <
	tbrok”_t
> 
	tbrok”_šdex_™”
;

94 
	gpublic
:

96 
brok”_mª_im¶
(
brok”_t
* 
aBrok”Desc
)

97 : 
bË_mª_im¶
<
brok”_t
>(
aBrok”Desc
)

100 ~
brok”_mª_im¶
() { }

102 
w_rc_t
 
brok”_upd©e_ÿ_Á_by_šdex
(
ss_m
* 
db
, 
brok”_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
brok”_id
,

103 cÚ¡ 
comm_amouÁ
, 
lock_mode_t
 
lm
 = 
EX
);

105 
w_rc_t
 
b_g‘_™”_by_šdex2
(
ss_m
* 
db
,

106 
brok”_šdex_™”
* &
™”
,

107 
brok”_tu¶e
* 
±u¶e
,

108 
»p_row_t
 &
»¶ow
,

109 
»p_row_t
 &
»phigh
,

110 cÚ¡ 
TId’t
 
b_id
,

111 
lock_mode_t
 
®m
 = 
SH
,

112 
boŞ
 
Ãed_tu¶e
 = 
çl£
);

114 
w_rc_t
 
b_g‘_™”_by_šdex3
(
ss_m
* 
db
,

115 
brok”_šdex_™”
* &
™”
,

116 
brok”_tu¶e
* 
±u¶e
,

117 
»p_row_t
 &
»¶ow
,

118 
»p_row_t
 &
»phigh
,

119 cÚ¡ * 
b_Çme
,

120 
lock_mode_t
 
®m
 = 
SH
,

121 
boŞ
 
Ãed_tu¶e
 = 
çl£
);

129 
şass
 
	gÿsh_Œª§ùiÚ_mª_im¶
 : 
public
 
bË_mª_im¶
<
ÿsh_Œª§ùiÚ_t
>

131 
bË_row_t
 
	tÿsh_Œª§ùiÚ_tu¶e
;

133 
	gpublic
:

135 
ÿsh_Œª§ùiÚ_mª_im¶
(
ÿsh_Œª§ùiÚ_t
* 
aCash_T¿n§ùiÚDesc
)

136 : 
bË_mª_im¶
<
ÿsh_Œª§ùiÚ_t
>(
aCash_T¿n§ùiÚDesc
) { }

138 ~
ÿsh_Œª§ùiÚ_mª_im¶
() { }

140 
w_rc_t
 
ù_šdex_´obe
(
ss_m
* 
db
, 
ÿsh_Œª§ùiÚ_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
Œ_id
);

142 
w_rc_t
 
ù_šdex_´obe_fÜupd©e
(
ss_m
* 
db
, 
ÿsh_Œª§ùiÚ_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
t_id
);

144 
w_rc_t
 
ù_upd©e_Çme
(
ss_m
* 
db
, 
ÿsh_Œª§ùiÚ_tu¶e
* 
±u¶e
, cÚ¡ * 
ù_Çme
, 
lock_mode_t
 
lm
 = 
EX
);

152 
şass
 
	gch¬ge_mª_im¶
 : 
public
 
bË_mª_im¶
<
ch¬ge_t
>

154 
bË_row_t
 
	tch¬ge_tu¶e
;

155 
	gšdex_sÿn_™”_im¶
 <
	tch¬ge_t
> 
	tch¬ge_šdex_™”
;

157 
	gpublic
:

159 
ch¬ge_mª_im¶
(
ch¬ge_t
* 
aCh¬geDesc
)

160 : 
bË_mª_im¶
<
ch¬ge_t
>(
aCh¬geDesc
) { }

162 ~
ch¬ge_mª_im¶
() { }

164 
w_rc_t
 
ch_šdex_´obe
(
ss_m
* 
db
, 
ch¬ge_tu¶e
* 
±u¶e
, cÚ¡ 
cu¡_t›r
, cÚ¡ * 
Œade_ty³_id
);

173 
şass
 
	gcommissiÚ_¿‹_mª_im¶
 : 
public
 
bË_mª_im¶
<
commissiÚ_¿‹_t
>

175 
bË_row_t
 
	tcommissiÚ_¿‹_tu¶e
;

176 
	gšdex_sÿn_™”_im¶
 <
	tcommissiÚ_¿‹_t
> 
	tcommissiÚ_¿‹_šdex_™”
;

178 
	gpublic
:

180 
commissiÚ_¿‹_mª_im¶
(
commissiÚ_¿‹_t
* 
aCommissiÚ_R©eDesc
)

181 : 
bË_mª_im¶
<
commissiÚ_¿‹_t
>(
aCommissiÚ_R©eDesc
) { }

183 ~
commissiÚ_¿‹_mª_im¶
() { }

185 
w_rc_t
 
ü_g‘_™”_by_šdex
(
ss_m
* 
db
,

186 
commissiÚ_¿‹_šdex_™”
* &
™”
,

187 
commissiÚ_¿‹_tu¶e
* 
±u¶e
,

188 
»p_row_t
 &
»¶ow
,

189 
»p_row_t
 &
»phigh
,

190 cÚ¡ 
c_t›r
,

191 cÚ¡ * 
ty³_id
,

192 cÚ¡ * 
s_ex_id
,

193 cÚ¡ 
Œade_qty
,

194 
lock_mode_t
 
®m
 = 
SH
,

195 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

204 
şass
 
	gcom·ny_mª_im¶
 : 
public
 
bË_mª_im¶
<
com·ny_t
>

206 
bË_row_t
 
	tcom·ny_tu¶e
;

207 
	gšdex_sÿn_™”_im¶
 <
	tcom·ny_t
> 
	tcom·ny_šdex_™”
;

209 
	gpublic
:

211 
com·ny_mª_im¶
(
com·ny_t
* 
aCom·nyDesc
)

212 : 
bË_mª_im¶
<
com·ny_t
>(
aCom·nyDesc
) { }

214 ~
com·ny_mª_im¶
() { }

216 
w_rc_t
 
co_g‘_™”_by_šdex2
(
ss_m
* 
db
, 
com·ny_šdex_™”
* &
™”
, 
com·ny_tu¶e
* 
±u¶e
, 
»p_row_t
 &
»¶ow
,„•_row_ˆ&
»phigh
,

217 cÚ¡ * 
co_Çme
, 
lock_mode_t
 
®m
 = 
SH
, 
boŞ
 
Ãed_tu¶e
 = 
çl£
);

219 
w_rc_t
 
co_šdex_´obe
(
ss_m
* 
db
, 
com·ny_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
co_id
);

221 
w_rc_t
 
co_šdex_´obe_fÜupd©e
(
ss_m
* 
db
, 
com·ny_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
co_id
);

223 
w_rc_t
 
co_upd©e_¥¿‹
(
ss_m
* 
db
, 
com·ny_tu¶e
* 
±u¶e
, cÚ¡ * 
¥¿‹
, 
lock_mode_t
 
lm
 = 
EX
);

225 
w_rc_t
 
co_g‘_™”_by_šdex3
(
ss_m
* 
db
, 
com·ny_šdex_™”
* &
™”
, 
com·ny_tu¶e
* 
±u¶e
, 
»p_row_t
 &
»¶ow
,„•_row_ˆ&
»phigh
,

226 cÚ¡ * 
š_id
, 
lock_mode_t
 
®m
 = 
SH
, 
boŞ
 
Ãed_tu¶e
 = 
çl£
);

235 
şass
 
	gcu¡om”_mª_im¶
 : 
public
 
bË_mª_im¶
<
cu¡om”_t
>

237 
bË_row_t
 
	tcu¡om”_tu¶e
;

238 
	gšdex_sÿn_™”_im¶
 <
	tcu¡om”_t
> 
	tcu¡om”_šdex_™”
;

239 
	gpublic
:

241 
cu¡om”_mª_im¶
(
cu¡om”_t
* 
aCu¡om”Desc
)

242 : 
bË_mª_im¶
<
cu¡om”_t
>(
aCu¡om”Desc
) { }

244 ~
cu¡om”_mª_im¶
() { }

246 
w_rc_t
 
c_šdex_´obe
(
ss_m
* 
db
, 
cu¡om”_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
cu¡_id
);

248 
w_rc_t
 
c_šdex_´obe_fÜupd©e
(
ss_m
* 
db
, 
cu¡om”_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
cu¡_id
);

250 
w_rc_t
 
c_upd©e_ema2
(
ss_m
* 
db
, 
cu¡om”_tu¶e
* 
±u¶e
, cÚ¡ * 
ema2
, 
lock_mode_t
 
®m
 = 
EX
);

252 
w_rc_t
 
c_g‘_™”_by_šdex2
(
ss_m
* 
db
,

253 
cu¡om”_šdex_™”
* &
™”
,

254 
cu¡om”_tu¶e
* 
±u¶e
,

255 
»p_row_t
 &
»¶ow
,

256 
»p_row_t
 &
»phigh
,

257 cÚ¡ * 
x_id
,

258 
lock_mode_t
 
®m
 = 
SH
,

259 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

261 
w_rc_t
 
c_g‘_™”_by_šdex3
(
ss_m
* 
db
,

262 
cu¡om”_šdex_™”
* &
™”
,

263 
cu¡om”_tu¶e
* 
±u¶e
,

264 
»p_row_t
 &
»¶ow
,

265 
»p_row_t
 &
»phigh
,

266 cÚ¡ 
TId’t
 
cu¡_id
,

267 
lock_mode_t
 
®m
 = 
SH
,

268 
boŞ
 
Ãed_tu¶e
 = 
çl£
);

277 
şass
 
	gcu¡om”_accouÁ_mª_im¶
 : 
public
 
bË_mª_im¶
<
cu¡om”_accouÁ_t
>

279 
bË_row_t
 
	tcu¡om”_accouÁ_tu¶e
;

280 
	gšdex_sÿn_™”_im¶
 <
	tcu¡om”_accouÁ_t
> 
	tcu¡om”_accouÁ_šdex_™”
;

282 
	gpublic
:

284 
cu¡om”_accouÁ_mª_im¶
(
cu¡om”_accouÁ_t
* 
aCu¡om”_AccouÁDesc
)

285 : 
bË_mª_im¶
<
cu¡om”_accouÁ_t
>(
aCu¡om”_AccouÁDesc
) { }

287 ~
cu¡om”_accouÁ_mª_im¶
() { }

289 
w_rc_t
 
ÿ_šdex_´obe
(
ss_m
* 
db
, 
cu¡om”_accouÁ_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
acù_id
);

291 
w_rc_t
 
ÿ_upd©e_b®
(
ss_m
* 
db
, 
cu¡om”_accouÁ_tu¶e
* 
±u¶e
,

292 cÚ¡ 
TId’t
 
acù_id
, cÚ¡ 
£_amouÁ
,

293 
lock_mode_t
 
®m
 = 
EX
);

295 
w_rc_t
 
ÿ_g‘_™”_by_šdex2
(
ss_m
* 
db
,

296 
cu¡om”_accouÁ_šdex_™”
* &
™”
,

297 
cu¡om”_accouÁ_tu¶e
* 
±u¶e
,

298 
»p_row_t
 &
»¶ow
,

299 
»p_row_t
 &
»phigh
,

300 cÚ¡ 
TId’t
 
cu¡_id
,

301 
lock_mode_t
 
®m
 = 
SH
,

302 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

311 
şass
 
	gcu¡om”_x¿‹_mª_im¶
 : 
public
 
bË_mª_im¶
<
cu¡om”_x¿‹_t
>

313 
bË_row_t
 
	tcu¡om”_x¿‹_tu¶e
;

314 
	gšdex_sÿn_™”_im¶
 <
	tcu¡om”_x¿‹_t
> 
	tcu¡om”_x¿‹_šdex_™”
;

316 
	gpublic
:

318 
cu¡om”_x¿‹_mª_im¶
(
cu¡om”_x¿‹_t
* 
aCu¡om”_Tax¿‹Desc
)

319 : 
bË_mª_im¶
<
cu¡om”_x¿‹_t
>(
aCu¡om”_Tax¿‹Desc
) { }

321 ~
cu¡om”_x¿‹_mª_im¶
() { }

323 
w_rc_t
 
cx_g‘_™”_by_šdex
(
ss_m
* 
db
,

324 
cu¡om”_x¿‹_šdex_™”
* &
™”
,

325 
cu¡om”_x¿‹_tu¶e
* 
±u¶e
,

326 
»p_row_t
 &
»¶ow
,

327 
»p_row_t
 &
»phigh
,

328 cÚ¡ 
TId’t
 
cu¡_id
,

329 
lock_mode_t
 
®m
 = 
SH
,

330 
boŞ
 
Ãed_tu¶e
 = 
çl£
);

332 
w_rc_t
 
cx_upd©e_txid
(
ss_m
* 
db
, 
cu¡om”_x¿‹_tu¶e
* 
±u¶e
, cÚ¡ * 
Ãw_x_¿‹
, 
lock_mode_t
 
lm
 = 
EX
);

341 
şass
 
	ghŞdšg_mª_im¶
 : 
public
 
bË_mª_im¶
<
hŞdšg_t
>

343 
bË_row_t
 
	thŞdšg_tu¶e
;

344 
	gšdex_sÿn_™”_im¶
 <
	thŞdšg_t
> 
	thŞdšg_šdex_™”
;

345 
	gpublic
:

347 
hŞdšg_mª_im¶
(
hŞdšg_t
* 
aHŞdšgDesc
)

348 : 
bË_mª_im¶
<
hŞdšg_t
>(
aHŞdšgDesc
)

351 ~
hŞdšg_mª_im¶
() { }

353 
w_rc_t
 
h_g‘_™”_by_šdex2
(
ss_m
* 
db
,

354 
hŞdšg_šdex_™”
* &
™”
,

355 
hŞdšg_tu¶e
* 
±u¶e
,

356 
»p_row_t
 &
»¶ow
,

357 
»p_row_t
 &
»phigh
,

358 cÚ¡ 
TId’t
 
acù_id
,

359 cÚ¡ * 
symbŞ
,

360 
boŞ
 
is_backw¬d
 = 
çl£
,

361 
lock_mode_t
 
®m
 = 
SH
,

362 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

364 
w_rc_t
 
h_upd©e_qty
(
ss_m
* 
db
, 
hŞdšg_tu¶e
* 
±u¶e
, cÚ¡ 
qty
, 
lock_mode_t
 
lm
 = 
EX
);

366 
w_rc_t
 
h_d–‘e_tu¶e
(
ss_m
* 
db
, 
hŞdšg_tu¶e
* 
±u¶e
, 
rid_t
 
rid
);

375 
şass
 
	ghŞdšg_hi¡Üy_mª_im¶
 : 
public
 
bË_mª_im¶
<
hŞdšg_hi¡Üy_t
>

377 
bË_row_t
 
	thŞdšg_hi¡Üy_tu¶e
;

378 
	gšdex_sÿn_™”_im¶
 <
	thŞdšg_hi¡Üy_t
> 
	thŞdšg_hi¡Üy_šdex_™”
;

380 
	gpublic
:

382 
hŞdšg_hi¡Üy_mª_im¶
(
hŞdšg_hi¡Üy_t
* 
aHŞdšg_Hi¡ÜyDesc
)

383 : 
bË_mª_im¶
<
hŞdšg_hi¡Üy_t
>(
aHŞdšg_Hi¡ÜyDesc
)

386 ~
hŞdšg_hi¡Üy_mª_im¶
() { }

388 
w_rc_t
 
hh_g‘_™”_by_šdex2
(
ss_m
* 
db
,

389 
hŞdšg_hi¡Üy_šdex_™”
* &
™”
,

390 
hŞdšg_hi¡Üy_tu¶e
* 
±u¶e
,

391 
»p_row_t
 &
»¶ow
,

392 
»p_row_t
 &
»phigh
,

393 
TId’t
 
Œade_id
,

394 
lock_mode_t
 
®m
 = 
SH
,

395 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

404 
şass
 
	ghŞdšg_summ¬y_mª_im¶
 : 
public
 
bË_mª_im¶
<
hŞdšg_summ¬y_t
>

406 
bË_row_t
 
	thŞdšg_summ¬y_tu¶e
;

407 
	gšdex_sÿn_™”_im¶
 <
	thŞdšg_summ¬y_t
> 
	thŞdšg_summ¬y_šdex_™”
;

409 
	gpublic
:

411 
hŞdšg_summ¬y_mª_im¶
(
hŞdšg_summ¬y_t
* 
aHŞdšg_Summ¬yDesc
)

412 : 
bË_mª_im¶
<
hŞdšg_summ¬y_t
>(
aHŞdšg_Summ¬yDesc
) { }

414 ~
hŞdšg_summ¬y_mª_im¶
() { }

416 
w_rc_t
 
hs_šdex_´obe
(
ss_m
* 
db
,

417 
hŞdšg_summ¬y_tu¶e
* 
±u¶e
,

418 cÚ¡ 
TId’t
 
acù_id
,

419 cÚ¡ * 
symbŞ
);

421 
w_rc_t
 
hs_upd©e_qty
(
ss_m
* 
db
,

422 
hŞdšg_summ¬y_tu¶e
* 
±u¶e
,

423 cÚ¡ 
TId’t
 
acù_id
,

424 cÚ¡ * 
symbŞ
,

425 cÚ¡ 
qty
,

426 
lock_mode_t
 
lm
 = 
EX
);

428 
w_rc_t
 
hs_g‘_™”_by_šdex
(
ss_m
* 
db
,

429 
hŞdšg_summ¬y_šdex_™”
* &
™”
,

430 
hŞdšg_summ¬y_tu¶e
* 
±u¶e
,

431 
»p_row_t
 &
»¶ow
,

432 
»p_row_t
 &
»phigh
,

433 cÚ¡ 
TId’t
 
acù_id
,

434 
boŞ
 
Ãed_tu¶e
 = 
Œue
,

435 
lock_mode_t
 
®m
 = 
SH
);

444 
şass
 
	gÏ¡_Œade_mª_im¶
 : 
public
 
bË_mª_im¶
<
Ï¡_Œade_t
>

446 
bË_row_t
 
	tÏ¡_Œade_tu¶e
;

448 
	gpublic
:

450 
Ï¡_Œade_mª_im¶
(
Ï¡_Œade_t
* 
aLa¡_T¿deDesc
)

451 : 
bË_mª_im¶
<
Ï¡_Œade_t
>(
aLa¡_T¿deDesc
) { }

453 ~
Ï¡_Œade_mª_im¶
() { }

455 
w_rc_t
 
É_šdex_´obe
(
ss_m
* 
db
, 
Ï¡_Œade_tu¶e
* 
±u¶e
, cÚ¡ * 
symbŞ
);

457 
w_rc_t
 
É_upd©e_by_šdex
(
ss_m
* 
db
, 
Ï¡_Œade_tu¶e
* 
±u¶e
,

458 cÚ¡ * 
symbŞ
,

459 cÚ¡ 
´iû_quÙe
,

460 cÚ¡ 
Œade_qty
,

461 cÚ¡ 
myTime
 
now_dts
,

462 
lock_mode_t
 
lm
 = 
EX
);

471 
şass
 
	g£cur™y_mª_im¶
 : 
public
 
bË_mª_im¶
<
£cur™y_t
>

473 
bË_row_t
 
	t£cur™y_tu¶e
;

474 
	gšdex_sÿn_™”_im¶
 <
	t£cur™y_t
> 
	t£cur™y_šdex_™”
;

476 
	gpublic
:

478 
£cur™y_mª_im¶
(
£cur™y_t
* 
aSecur™yDesc
)

479 : 
bË_mª_im¶
<
£cur™y_t
>(
aSecur™yDesc
) { }

481 ~
£cur™y_mª_im¶
() { }

483 
w_rc_t
 
s_šdex_´obe
(
ss_m
* 
db
, 
£cur™y_tu¶e
* 
±u¶e
, cÚ¡ * 
symbŞ
);

485 
w_rc_t
 
s_šdex_´obe_fÜupd©e
(
ss_m
* 
db
, 
£cur™y_tu¶e
* 
±u¶e
, cÚ¡ * 
symbŞ
);

487 
w_rc_t
 
s_upd©e_ed
(
ss_m
* 
db
, 
£cur™y_tu¶e
* 
±u¶e
, cÚ¡ 
myTime
 
exch_d©e
, 
lock_mode_t
 
lm
 = 
EX
);

489 
w_rc_t
 
s_g‘_™”_by_šdex
(
ss_m
* 
db
,

490 
£cur™y_šdex_™”
* &
™”
,

491 
£cur™y_tu¶e
* 
±u¶e
,

492 
»p_row_t
 &
»¶ow
,

493 
»p_row_t
 &
»phigh
,

494 cÚ¡ * 
symbŞ
,

495 
lock_mode_t
 
®m
 = 
SH
,

496 
boŞ
 
Ãed_tu¶e
 = 
çl£
);

498 
w_rc_t
 
s_g‘_™”_by_šdex4
(
ss_m
* 
db
,

499 
£cur™y_šdex_™”
* &
™”
,

500 
£cur™y_tu¶e
* 
±u¶e
,

501 
»p_row_t
 &
»¶ow
,

502 
»p_row_t
 &
»phigh
,

503 cÚ¡ 
TId’t
 
co_id
,

504 
lock_mode_t
 
®m
 = 
SH
,

505 
boŞ
 
Ãed_tu¶e
 = 
çl£
);

507 
w_rc_t
 
s_g‘_™”_by_šdex4
(
ss_m
* 
db
,

508 
£cur™y_šdex_™”
* &
™”
,

509 
£cur™y_tu¶e
* 
±u¶e
,

510 
»p_row_t
 &
»¶ow
,

511 
»p_row_t
 &
»phigh
,

512 cÚ¡ 
TId’t
 
co_id
,

513 cÚ¡ * 
issue
,

514 
lock_mode_t
 
®m
 = 
SH
,

515 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

524 
şass
 
	g£‰Ëm’t_mª_im¶
 : 
public
 
bË_mª_im¶
<
£‰Ëm’t_t
>

526 
bË_row_t
 
	t£‰Ëm’t_tu¶e
;

528 
	gpublic
:

530 
£‰Ëm’t_mª_im¶
(
£‰Ëm’t_t
* 
aS‘em’tDesc
)

531 : 
bË_mª_im¶
<
£‰Ëm’t_t
>(
aS‘em’tDesc
) { }

533 ~
£‰Ëm’t_mª_im¶
() { }

535 
w_rc_t
 
£_šdex_´obe
(
ss_m
* 
db
, 
£‰Ëm’t_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
Œ_id
);

537 
w_rc_t
 
£_šdex_´obe_fÜupd©e
(
ss_m
* 
db
, 
£‰Ëm’t_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
Œ_id
);

539 
w_rc_t
 
£_upd©e_Çme
(
ss_m
* 
db
, 
£‰Ëm’t_tu¶e
* 
±u¶e
, cÚ¡ * 
ÿsh_ty³
, 
lock_mode_t
 
lm
 = 
EX
);

548 
şass
 
	gx¿‹_mª_im¶
 : 
public
 
bË_mª_im¶
<
x¿‹_t
>

550 
bË_row_t
 
	tx¿‹_tu¶e
;

552 
	gpublic
:

554 
x¿‹_mª_im¶
(
x¿‹_t
* 
aTax¿‹Desc
)

555 : 
bË_mª_im¶
<
x¿‹_t
>(
aTax¿‹Desc
)

558 ~
x¿‹_mª_im¶
() { }

560 
w_rc_t
 
tx_šdex_´obe
(
ss_m
* 
db
, 
x¿‹_tu¶e
* 
±u¶e
, cÚ¡ * 
tx_id
);

562 
w_rc_t
 
tx_šdex_´obe_fÜupd©e
(
ss_m
* 
db
, 
x¿‹_tu¶e
* 
±u¶e
, cÚ¡ * 
tx_id
);

564 
w_rc_t
 
tx_upd©e_Çme
(
ss_m
* 
db
, 
x¿‹_tu¶e
* 
±u¶e
, cÚ¡ * 
tx_Çme
, 
lock_mode_t
 
lm
 = 
EX
);

573 
şass
 
	gŒade_mª_im¶
 : 
public
 
bË_mª_im¶
<
Œade_t
>

575 
bË_row_t
 
	tŒade_tu¶e
;

576 
	gšdex_sÿn_™”_im¶
 <
	tŒade_t
> 
	tŒade_šdex_™”
;

577 
	gpublic
:

579 
Œade_mª_im¶
(
Œade_t
* 
aT¿deDesc
)

580 : 
bË_mª_im¶
<
Œade_t
>(
aT¿deDesc
) { }

582 ~
Œade_mª_im¶
() { }

584 
w_rc_t
 
t_šdex_´obe
(
ss_m
* 
db
, 
Œade_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
Œade_id
);

586 
w_rc_t
 
t_upd©e_x_by_šdex
(
ss_m
* 
db
, 
Œade_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
t_id
,

587 cÚ¡ 
x_amouÁ
, 
lock_mode_t
 
lm
 = 
EX
);

589 
w_rc_t
 
t_upd©e_ÿ_td_sci__by_šdex
(
ss_m
* 
db
,

590 
Œade_tu¶e
* 
±u¶e
,

591 cÚ¡ 
TId’t
 
Œade_id
,

592 cÚ¡ 
comm_amouÁ
,

593 cÚ¡ 
myTime
 
Œade_dts
,

594 cÚ¡ * 
¡_com¶‘ed_id
,

595 cÚ¡ 
Œade_´iû
,

596 
lock_mode_t
 
lm
 = 
EX
);

598 
w_rc_t
 
t_g‘_™”_by_šdex
(
ss_m
* 
db
,

599 
Œade_šdex_™”
* &
™”
,

600 
Œade_tu¶e
* 
±u¶e
,

601 
»p_row_t
 &
»¶ow
,

602 
»p_row_t
 &
»phigh
,

603 cÚ¡ 
TId’t
 
t_id
,

604 
lock_mode_t
 
®m
 = 
SH
,

605 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

607 
w_rc_t
 
t_g‘_™”_by_šdex2
(
ss_m
* 
db
,

608 
Œade_šdex_™”
* &
™”
,

609 
Œade_tu¶e
* 
±u¶e
,

610 
»p_row_t
 &
»¶ow
,

611 
»p_row_t
 &
»phigh
,

612 cÚ¡ 
TId’t
 
acù_id
,

613 cÚ¡ 
myTime
 
¡¬t_dts
,

614 cÚ¡ 
myTime
 
’d_dts
,

615 
boŞ
 
is_backw¬d
 = 
çl£
,

616 
boŞ
 
Ãed_tu¶e
 = 
Œue
,

617 
lock_mode_t
 
®m
 = 
SH
);

619 
w_rc_t
 
t_g‘_™”_by_šdex3
(
ss_m
* 
db
,

620 
Œade_šdex_™”
* &
™”
,

621 
Œade_tu¶e
* 
±u¶e
,

622 
»p_row_t
 &
»¶ow
,

623 
»p_row_t
 &
»phigh
,

624 cÚ¡ * 
symbŞ
,

625 cÚ¡ 
myTime
 
¡¬t_dts
,

626 cÚ¡ 
myTime
 
’d_dts
,

627 
lock_mode_t
 
®m
 = 
SH
,

628 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

630 
w_rc_t
 
t_upd©e_dts_¡did_by_šdex
(
ss_m
* 
db
,

631 
Œade_tu¶e
* 
±u¶e
,

632 cÚ¡ 
TId’t
 
»q_Œade_id
,

633 cÚ¡ 
myTime
 
now_dts
,

634 cÚ¡ * 
¡©us_subm™‹d
,

635 
lock_mode_t
 
lm
 = 
EX
);

637 
w_rc_t
 
t_šdex_´obe_fÜupd©e
(
ss_m
* 
db
, 
Œade_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
t_id
);

639 
w_rc_t
 
t_upd©e_Çme
(
ss_m
* 
db
, 
Œade_tu¶e
* 
±u¶e
, cÚ¡ * 
exec_Çme
, 
lock_mode_t
 
lm
 = 
EX
);

648 
şass
 
	gŒade_hi¡Üy_mª_im¶
 : 
public
 
bË_mª_im¶
<
Œade_hi¡Üy_t
>

650 
bË_row_t
 
	tŒade_hi¡Üy_tu¶e
;

651 
	gšdex_sÿn_™”_im¶
 <
	tŒade_hi¡Üy_t
> 
	tŒade_hi¡Üy_šdex_™”
;

652 
	gpublic
:

654 
Œade_hi¡Üy_mª_im¶
(
Œade_hi¡Üy_t
* 
aT¿de_Hi¡ÜyDesc
)

655 : 
bË_mª_im¶
<
Œade_hi¡Üy_t
>(
aT¿de_Hi¡ÜyDesc
)

658 ~
Œade_hi¡Üy_mª_im¶
() { }

660 
w_rc_t
 
th_g‘_™”_by_šdex
(
ss_m
* 
db
,

661 
Œade_hi¡Üy_šdex_™”
* &
™”
,

662 
Œade_hi¡Üy_tu¶e
* 
±u¶e
,

663 
»p_row_t
 &
»¶ow
,

664 
»p_row_t
 &
»phigh
,

665 cÚ¡ 
TId’t
 
t_id
,

666 
lock_mode_t
 
®m
 = 
SH
,

667 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

676 
şass
 
	gŒade_ty³_mª_im¶
 : 
public
 
bË_mª_im¶
<
Œade_ty³_t
>

678 
bË_row_t
 
	tŒade_ty³_tu¶e
;

680 
	gpublic
:

682 
Œade_ty³_mª_im¶
(
Œade_ty³_t
* 
aT¿de_Ty³Desc
)

683 : 
bË_mª_im¶
<
Œade_ty³_t
>(
aT¿de_Ty³Desc
)

686 ~
Œade_ty³_mª_im¶
() { }

688 
w_rc_t
 
‰_šdex_´obe
(
ss_m
* 
db
, 
Œade_ty³_tu¶e
* 
±u¶e
, cÚ¡ * 
Œade_ty³_id
);

697 
şass
 
	g¡©us_ty³_mª_im¶
 : 
public
 
bË_mª_im¶
<
¡©us_ty³_t
>

699 
bË_row_t
 
	t¡©us_ty³_tu¶e
;

701 
	gpublic
:

703 
¡©us_ty³_mª_im¶
(
¡©us_ty³_t
* 
aStus_Ty³Desc
)

704 : 
bË_mª_im¶
<
¡©us_ty³_t
>(
aStus_Ty³Desc
)

707 ~
¡©us_ty³_mª_im¶
() { }

709 
w_rc_t
 
¡_šdex_´obe
(
ss_m
* 
db
, 
¡©us_ty³_tu¶e
* 
±u¶e
, cÚ¡ * 
¡_id
);

718 
şass
 
	g£ùÜ_mª_im¶
 : 
public
 
bË_mª_im¶
<
£ùÜ_t
>

720 
bË_row_t
 
	t£ùÜ_tu¶e
;

721 
	gšdex_sÿn_™”_im¶
 <
	t£ùÜ_t
> 
	t£ùÜ_šdex_™”
;

723 
	gpublic
:

725 
£ùÜ_mª_im¶
(
£ùÜ_t
* 
aSeùÜDesc
)

726 : 
bË_mª_im¶
<
£ùÜ_t
>(
aSeùÜDesc
)

729 ~
£ùÜ_mª_im¶
() { }

731 
w_rc_t
 
sc_g‘_™”_by_šdex2
(
ss_m
* 
db
,

732 
£ùÜ_šdex_™”
* &
™”
,

733 
£ùÜ_tu¶e
* 
±u¶e
,

734 
»p_row_t
 &
»¶ow
,

735 
»p_row_t
 &
»phigh
,

736 cÚ¡ * 
sc_Çme
,

737 
lock_mode_t
 
®m
 = 
SH
,

738 
boŞ
 
Ãed_tu¶e
 = 
çl£
);

747 
şass
 
	gexchªge_mª_im¶
 : 
public
 
bË_mª_im¶
<
exchªge_t
>

749 
bË_row_t
 
	texchªge_tu¶e
;

750 
	gšdex_sÿn_™”_im¶
 <
	texchªge_t
> 
	texchªge_šdex_™”
;

752 
	gpublic
:

754 
exchªge_mª_im¶
(
exchªge_t
* 
aExchªgeDesc
)

755 : 
bË_mª_im¶
<
exchªge_t
>(
aExchªgeDesc
)

758 ~
exchªge_mª_im¶
() { }

760 
w_rc_t
 
ex_upd©e_desc
(
ss_m
* 
db
, 
exchªge_tu¶e
* 
±u¶e
, cÚ¡ * 
Ãw_desc
, 
lock_mode_t
 
®m
 = 
EX
);

762 
w_rc_t
 
ex_šdex_´obe
(
ss_m
* 
db
, 
exchªge_tu¶e
* 
±u¶e
, cÚ¡ * 
id
);

771 
şass
 
	gšdu¡ry_mª_im¶
 : 
public
 
bË_mª_im¶
<
šdu¡ry_t
>

773 
bË_row_t
 
	tšdu¡ry_tu¶e
;

774 
	gšdex_sÿn_™”_im¶
 <
	tšdu¡ry_t
> 
	tšdu¡ry_šdex_™”
;

776 
	gpublic
:

778 
šdu¡ry_mª_im¶
(
šdu¡ry_t
* 
aIndu¡ryDesc
)

779 : 
bË_mª_im¶
<
šdu¡ry_t
>(
aIndu¡ryDesc
)

782 ~
šdu¡ry_mª_im¶
() { }

784 
w_rc_t
 
š_šdex_´obe
(
ss_m
* 
db
, 
šdu¡ry_tu¶e
* 
±u¶e
, cÚ¡ * 
id
);

786 
w_rc_t
 
š_g‘_™”_by_šdex2
(
ss_m
* 
db
,

787 
šdu¡ry_šdex_™”
* &
™”
,

788 
šdu¡ry_tu¶e
* 
±u¶e
,

789 
»p_row_t
 &
»¶ow
,

790 
»p_row_t
 &
»phigh
,

791 cÚ¡ * 
š_Çme
,

792 
lock_mode_t
 
®m
 = 
SH
,

793 
boŞ
 
Ãed_tu¶e
 = 
çl£
);

795 
w_rc_t
 
š_g‘_™”_by_šdex3
(
ss_m
* 
db
,

796 
šdu¡ry_šdex_™”
* &
™”
,

797 
šdu¡ry_tu¶e
* 
±u¶e
,

798 
»p_row_t
 &
»¶ow
,

799 
»p_row_t
 &
»phigh
,

800 cÚ¡ * 
sc_id
,

801 
lock_mode_t
 
®m
 = 
SH
,

802 
boŞ
 
Ãed_tu¶e
 = 
çl£
);

811 
şass
 
	gz_code_mª_im¶
 : 
public
 
bË_mª_im¶
<
z_code_t
>

813 
bË_row_t
 
	tz_code_tu¶e
;

814 
	gšdex_sÿn_™”_im¶
 <
	tz_code_t
> 
	tz_code_šdex_™”
;

815 
	gpublic
:

817 
z_code_mª_im¶
(
z_code_t
* 
aZ_CodeDesc
)

818 : 
bË_mª_im¶
<
z_code_t
>(
aZ_CodeDesc
) { }

820 ~
z_code_mª_im¶
() { }

822 
w_rc_t
 
zc_šdex_´obe
(
ss_m
* 
db
, 
z_code_tu¶e
* 
±u¶e
, cÚ¡ * 
zc_code
);

831 
şass
 
	gŒade_»que¡_mª_im¶
 : 
public
 
bË_mª_im¶
<
Œade_»que¡_t
>

833 
bË_row_t
 
	tŒade_»que¡_tu¶e
;

834 
	gšdex_sÿn_™”_im¶
 <
	tŒade_»que¡_t
> 
	tŒade_»que¡_šdex_™”
;

835 
	gpublic
:

837 
Œade_»que¡_mª_im¶
(
Œade_»que¡_t
* 
aT¿de_Reque¡Desc
)

838 : 
bË_mª_im¶
<
Œade_»que¡_t
>(
aT¿de_Reque¡Desc
)

841 ~
Œade_»que¡_mª_im¶
() { }

843 
w_rc_t
 
Œ_d–‘e_tu¶e
(
ss_m
* 
db
, 
Œade_»que¡_tu¶e
* 
±u¶e
, 
rid_t
 
rid
);

845 
w_rc_t
 
Œ_g‘_™”_by_šdex4
(
ss_m
* 
db
,

846 
Œade_»que¡_šdex_™”
* &
™”
,

847 
Œade_»que¡_tu¶e
* 
±u¶e
,

848 
»p_row_t
 &
»¶ow
,

849 
»p_row_t
 &
»phigh
,

850 cÚ¡ * 
Œ_s_symb
,

851 cÚ¡ 
TId’t
 
Œ_b_id
,

852 
lock_mode_t
 
®m
 = 
SH
,

853 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

855 
w_rc_t
 
Œ_g‘_™”_by_šdex4
(
ss_m
* 
db
,

856 
Œade_»que¡_šdex_™”
* &
™”
,

857 
Œade_»que¡_tu¶e
* 
±u¶e
,

858 
»p_row_t
 &
»¶ow
,

859 
»p_row_t
 &
»phigh
,

860 cÚ¡ * 
Œ_s_symb
,

861 
lock_mode_t
 
®m
 = 
SH
,

862 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

871 
şass
 
	gcom·ny_com³t™Ü_mª_im¶
 : 
public
 
bË_mª_im¶
<
com·ny_com³t™Ü_t
>

873 
bË_row_t
 
	tcom·ny_com³t™Ü_tu¶e
;

874 
	gšdex_sÿn_™”_im¶
 <
	tcom·ny_com³t™Ü_t
> 
	tcom·ny_com³t™Ü_šdex_™”
;

876 
	gpublic
:

878 
com·ny_com³t™Ü_mª_im¶
(
com·ny_com³t™Ü_t
* 
aCom·ny_Com³t™ÜDesc
)

879 : 
bË_mª_im¶
<
com·ny_com³t™Ü_t
>(
aCom·ny_Com³t™ÜDesc
)

882 ~
com·ny_com³t™Ü_mª_im¶
() { }

884 
w_rc_t
 
cc_g‘_™”_by_šdex
(
ss_m
* 
db
,

885 
com·ny_com³t™Ü_šdex_™”
* &
™”
,

886 
com·ny_com³t™Ü_tu¶e
* 
±u¶e
,

887 
»p_row_t
 &
»¶ow
,

888 
»p_row_t
 &
»phigh
,

889 cÚ¡ 
TId’t
 
co_id
,

890 
boŞ
 
Ãed_tu¶e
 = 
çl£
,

891 
lock_mode_t
 
®m
 = 
SH
);

900 
şass
 
	gday_m¬k‘_mª_im¶
 : 
public
 
bË_mª_im¶
<
day_m¬k‘_t
>

902 
bË_row_t
 
	tday_m¬k‘_tu¶e
;

903 
	gšdex_sÿn_™”_im¶
 <
	tday_m¬k‘_t
> 
	tday_m¬k‘_šdex_™”
;

904 
	gpublic
:

906 
day_m¬k‘_mª_im¶
(
day_m¬k‘_t
* 
aDay_M¬k‘Desc
)

907 : 
bË_mª_im¶
<
day_m¬k‘_t
>(
aDay_M¬k‘Desc
)

910 ~
day_m¬k‘_mª_im¶
() { }

912 
w_rc_t
 
dm_šdex_´obe
(
ss_m
* 
db
, 
day_m¬k‘_tu¶e
* 
±u¶e
, cÚ¡ * 
symbŞ
, cÚ¡ 
myTime
 
¡¬t_d©e
);

914 
w_rc_t
 
dm_upd©e_vŞ
(
ss_m
* 
db
, 
day_m¬k‘_tu¶e
* 
±u¶e
, cÚ¡ 
vŞ_šü
, 
lock_mode_t
 
lm
 = 
EX
);

916 
w_rc_t
 
dm_g‘_™”_by_šdex
(
ss_m
* 
db
,

917 
day_m¬k‘_šdex_™”
* &
™”
,

918 
day_m¬k‘_tu¶e
* 
±u¶e
,

919 
»p_row_t
 &
»¶ow
,

920 
»p_row_t
 &
»phigh
,

921 cÚ¡ * 
symbŞ
,

922 cÚ¡ 
myTime
 
¡¬t_day
 = 0,

923 
lock_mode_t
 
®m
 = 
SH
,

924 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

933 
şass
 
	gfšªcŸl_mª_im¶
 : 
public
 
bË_mª_im¶
<
fšªcŸl_t
>

935 
bË_row_t
 
	tfšªcŸl_tu¶e
;

936 
	gšdex_sÿn_™”_im¶
 <
	tfšªcŸl_t
> 
	tfšªcŸl_šdex_™”
;

937 
	gpublic
:

939 
fšªcŸl_mª_im¶
(
fšªcŸl_t
* 
aFšªcŸlDesc
)

940 : 
bË_mª_im¶
<
fšªcŸl_t
>(
aFšªcŸlDesc
)

943 ~
fšªcŸl_mª_im¶
() { }

945 
w_rc_t
 
fi_upd©e_desc
(
ss_m
* 
db
, 
fšªcŸl_tu¶e
* 
±u¶e
, cÚ¡ 
myTime
 
Ãw_qŒ_¡¬t_d©e
, 
lock_mode_t
 
®m
 = 
EX
);

947 
w_rc_t
 
fi_g‘_™”_by_šdex
(
ss_m
* 
db
,

948 
fšªcŸl_šdex_™”
* &
™”
,

949 
fšªcŸl_tu¶e
* 
±u¶e
,

950 
»p_row_t
 &
»¶ow
,

951 
»p_row_t
 &
»phigh
,

952 cÚ¡ 
TId’t
 
co_id
,

953 
lock_mode_t
 
®m
 = 
SH
,

954 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

963 
şass
 
	gadd»ss_mª_im¶
 : 
public
 
bË_mª_im¶
<
add»ss_t
>

965 
bË_row_t
 
	tadd»ss_tu¶e
;

967 
	gpublic
:

969 
add»ss_mª_im¶
(
add»ss_t
* 
aAdd»ssDesc
)

970 : 
bË_mª_im¶
<
add»ss_t
>(
aAdd»ssDesc
)

973 ~
add»ss_mª_im¶
() { }

975 
w_rc_t
 
ad_g‘_bË_™”
(
ss_m
* 
db
, 
bË_™”
* &
™”
);

977 
w_rc_t
 
ad_šdex_´obe
(
ss_m
* 
db
, 
add»ss_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
ad_id
);

979 
w_rc_t
 
ad_šdex_´obe_fÜupd©e
(
ss_m
* 
db
, 
add»ss_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
ad_id
);

981 
w_rc_t
 
ad_upd©e_lše2
(
ss_m
* 
db
, 
add»ss_tu¶e
* 
±u¶e
, cÚ¡ * 
lše2
, 
lock_mode_t
 = 
EX
);

990 
şass
 
	gw©ch_™em_mª_im¶
 : 
public
 
bË_mª_im¶
<
w©ch_™em_t
>

992 
bË_row_t
 
	tw©ch_™em_tu¶e
;

993 
	gšdex_sÿn_™”_im¶
 <
	tw©ch_™em_t
> 
	tw©ch_™em_šdex_™”
;

994 
	gpublic
:

996 
w©ch_™em_mª_im¶
(
w©ch_™em_t
* 
aW©ch_I‹mDesc
)

997 : 
bË_mª_im¶
<
w©ch_™em_t
>(
aW©ch_I‹mDesc
)

1000 ~
w©ch_™em_mª_im¶
() { }

1002 
w_rc_t
 
wi_upd©e_symb
(
ss_m
* 
db
, 
w©ch_™em_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
wl_id
,

1003 cÚ¡ * 
Şd_symbŞ
, cÚ¡ * 
Ãw_symbŞ
, 
lock_mode_t
 
lm
 = 
EX
);

1005 
w_rc_t
 
wi_g‘_™”_by_šdex
(
ss_m
* 
db
,

1006 
w©ch_™em_šdex_™”
* &
™”
,

1007 
w©ch_™em_tu¶e
* 
±u¶e
,

1008 
»p_row_t
 &
»¶ow
,

1009 
»p_row_t
 &
»phigh
,

1010 cÚ¡ 
TId’t
 
wl_id
,

1011 
lock_mode_t
 
®m
 = 
SH
,

1012 
boŞ
 
Ãed_tu¶e
 = 
çl£
);

1021 
şass
 
	gw©ch_li¡_mª_im¶
 : 
public
 
bË_mª_im¶
<
w©ch_li¡_t
>

1023 
bË_row_t
 
	tw©ch_li¡_tu¶e
;

1024 
	gšdex_sÿn_™”_im¶
 <
	tw©ch_li¡_t
> 
	tw©ch_li¡_šdex_™”
;

1026 
	gpublic
:

1028 
w©ch_li¡_mª_im¶
(
w©ch_li¡_t
* 
aW©ch_Li¡Desc
)

1029 : 
bË_mª_im¶
<
w©ch_li¡_t
>(
aW©ch_Li¡Desc
)

1032 ~
w©ch_li¡_mª_im¶
() { }

1034 
w_rc_t
 
wl_g‘_™”_by_šdex2
(
ss_m
* 
db
,

1035 
w©ch_li¡_šdex_™”
* &
™”
,

1036 
w©ch_li¡_tu¶e
* 
±u¶e
,

1037 
»p_row_t
 &
»¶ow
,

1038 
»p_row_t
 &
»phigh
,

1039 cÚ¡ 
TId’t
 
c_id
,

1040 
lock_mode_t
 
®m
 = 
SH
,

1041 
boŞ
 
Ãed_tu¶e
 = 
çl£
);

1050 
şass
 
	gÃws_™em_mª_im¶
 : 
public
 
bË_mª_im¶
<
Ãws_™em_t
>

1052 
bË_row_t
 
	tÃws_™em_tu¶e
;

1054 
	gpublic
:

1056 
Ãws_™em_mª_im¶
(
Ãws_™em_t
* 
aNews_I‹mDesc
)

1057 : 
bË_mª_im¶
<
Ãws_™em_t
>(
aNews_I‹mDesc
)

1060 ~
Ãws_™em_mª_im¶
() { }

1062 
w_rc_t
 
ni_šdex_´obe
(
ss_m
* 
db
, 
Ãws_™em_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
ni_id
);

1064 
w_rc_t
 
ni_šdex_´obe_fÜupd©e
(
ss_m
* 
db
, 
Ãws_™em_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
ni_id
);

1066 
w_rc_t
 
ni_upd©e_dts_by_šdex
(
ss_m
* 
db
, 
Ãws_™em_tu¶e
* 
±u¶e
, cÚ¡ 
myTime
 
ni_dts
, 
lock_mode_t
 
®m
 = 
EX
);

1075 
şass
 
	gÃws_x»f_mª_im¶
 : 
public
 
bË_mª_im¶
<
Ãws_x»f_t
>

1077 
bË_row_t
 
	tÃws_x»f_tu¶e
;

1078 
	gšdex_sÿn_™”_im¶
 <
	tÃws_x»f_t
> 
	tÃws_x»f_šdex_™”
;

1080 
	gpublic
:

1082 
Ãws_x»f_mª_im¶
(
Ãws_x»f_t
* 
aNews_X»fDesc
)

1083 : 
bË_mª_im¶
<
Ãws_x»f_t
>(
aNews_X»fDesc
) { }

1085 ~
Ãws_x»f_mª_im¶
() {}

1087 
w_rc_t
 
nx_g‘_bË_™”
(
ss_m
* 
db
, 
bË_™”
* &
™”
);

1089 
w_rc_t
 
nx_g‘_™”_by_šdex
(
ss_m
* 
db
,

1090 
Ãws_x»f_šdex_™”
* &
™”
,

1091 
Ãws_x»f_tu¶e
* 
±u¶e
,

1092 
»p_row_t
 &
»¶ow
,

1093 
»p_row_t
 &
»phigh
,

1094 cÚ¡ 
TId’t
 
co_id
,

1095 
lock_mode_t
 
®m
 = 
SH
,

1096 
boŞ
 
Ãed_tu¶e
 = 
çl£
);

1101 
EXIT_NAMESPACE
(
û
);

	@include/workload/tpce/tpce_const.h

9 #iâdeà
__TPCE_CONST_H


10 
	#__TPCE_CONST_H


	)

13 
	~"ut/Çme¥aû.h
"

14 
	~"wÜklßd/û/eg’/CE.h
"

15 
	~"wÜklßd/û/eg’/TxnH¬ÃssSŒuùs.h
"

17 
	tmyTime
;

19 
ENTER_NAMESPACE
(
û
);

23 cÚ¡ 
	gTPCE_CUSTS_PER_LU
 = 1000;

27 cÚ¡ 
TId’t
 
	gMAX_ID
 = 
UINT64
(-1)/2;

28 cÚ¡ 
myTime
 
	gMAX_DTS
 = 
UINT64
(-1)/2;

29 cÚ¡ 
	gMAX_VAL
 = 
UINT32
(-1)/2;

30 cÚ¡ 
	gMAX_SHORT
 = 
UINT16
(-1)/2;

32 cÚ¡ 
	gmš_brok”_li¡_Ën
 = 20;

33 cÚ¡ 
	gmax_brok”_li¡_Ën
 = 40;

35 cÚ¡ 
	gmax_acù_Ën
 = 10;

36 cÚ¡ 
	gmax_hi¡_Ën
 = 30;

38 cÚ¡ 
	gmax_ãed_Ën
 = 20;

40 cÚ¡ 
	gmš_day_Ën
 = 5;

41 cÚ¡ 
	gmax_day_Ën
 = 20;

42 cÚ¡ 
	gmax_fš_Ën
 = 20;

43 cÚ¡ 
	gmax_Ãws_Ën
 = 2;

44 cÚ¡ 
	gmax_comp_Ën
 = 3;

47 cÚ¡ 
	gmax_Ãws_™em_size
 = 10000;

49 cÚ¡ 
	gT¿deLookupMaxRows
 = 20;

50 cÚ¡ 
	gT¿deLookupF¿me1MaxRows
 = 20;

51 cÚ¡ 
	gT¿deLookupF¿me2MaxRows
 = 20;

52 cÚ¡ 
	gT¿deLookupF¿me3MaxRows
 = 20;

53 cÚ¡ 
	gT¿deLookupMaxT¿deHi¡ÜyRowsR‘uºed
 = 20;

55 cÚ¡ 
	gmax_Œade_¡©us_Ën
 = 50;

57 cÚ¡ 
	gT¿deUpd©eMaxRows
 = 20;

58 cÚ¡ 
	gT¿deUpd©eF¿me1MaxRows
 = 20;

59 cÚ¡ 
	gT¿deUpd©eF¿me2MaxRows
 = 20;

60 cÚ¡ 
	gT¿deUpd©eF¿me3MaxRows
 = 20;

61 cÚ¡ 
	gT¿deUpd©eMaxT¿deHi¡ÜyRowsR‘uºed
 = 3;

65 cÚ¡ 
	gTPCE_ACCOUNT_PERMISSION_FCOUNT
 = 5;

66 cÚ¡ 
	gTPCE_CUSTOMER_FCOUNT
 = 24;

67 cÚ¡ 
	gTPCE_CUSTOMER_ACCOUNT_FCOUNT
 = 6;

68 cÚ¡ 
	gTPCE_CUSTOMER_TAXRATE_FCOUNT
 = 2;

69 cÚ¡ 
	gTPCE_HOLDING_FCOUNT
 = 6;

70 cÚ¡ 
	gTPCE_HOLDING_HISTORY_FCOUNT
 = 4;

71 cÚ¡ 
	gTPCE_HOLDING_SUMMARY_FCOUNT
 = 3;

72 cÚ¡ 
	gTPCE_WATCH_ITEM_FCOUNT
 = 2;

73 cÚ¡ 
	gTPCE_WATCH_LIST_FCOUNT
 = 2;

75 cÚ¡ 
	gTPCE_BROKER_FCOUNT
 = 5;

76 cÚ¡ 
	gTPCE_CASH_TRANSACTION_FCOUNT
 = 4;

77 cÚ¡ 
	gTPCE_CHARGE_FCOUNT
 = 3;

78 cÚ¡ 
	gTPCE_COMMISSION_RATE_FCOUNT
 = 6;

79 cÚ¡ 
	gTPCE_SETTLEMENT_FCOUNT
 = 4;

80 cÚ¡ 
	gTPCE_TRADE_FCOUNT
 = 15;

81 cÚ¡ 
	gTPCE_TRADE_HISTORY_FCOUNT
 = 3;

82 cÚ¡ 
	gTPCE_TRADE_REQUEST_FCOUNT
 = 6;

83 cÚ¡ 
	gTPCE_TRADE_TYPE_FCOUNT
 = 4;

85 cÚ¡ 
	gTPCE_COMPANY_FCOUNT
 = 9;

86 cÚ¡ 
	gTPCE_COMPANY_COMPETITOR_FCOUNT
 = 3;

87 cÚ¡ 
	gTPCE_DAILY_MARKET_FCOUNT
 = 6;

88 cÚ¡ 
	gTPCE_EXCHANGE_FCOUNT
 = 7;

89 cÚ¡ 
	gTPCE_FINANCIAL_FCOUNT
 = 14;

90 cÚ¡ 
	gTPCE_INDUSTRY_FCOUNT
 = 3;

91 cÚ¡ 
	gTPCE_LAST_TRADE_FCOUNT
 = 5;

92 cÚ¡ 
	gTPCE_NEWS_ITEM_FCOUNT
 = 7;

93 cÚ¡ 
	gTPCE_NEWS_XREF_FCOUNT
 = 2;

94 cÚ¡ 
	gTPCE_SECTOR_FCOUNT
 = 2;

95 cÚ¡ 
	gTPCE_SECURITY_FCOUNT
 = 16;

97 cÚ¡ 
	gTPCE_ADDRESS_FCOUNT
 = 5;

98 cÚ¡ 
	gTPCE_STATUS_TYPE_FCOUNT
 = 2;

99 cÚ¡ 
	gTPCE_TAXRATE_FCOUNT
 = 3;

100 cÚ¡ 
	gTPCE_ZIP_CODE_FCOUNT
 = 3;

105 cÚ¡ 
	gSHORE_TPCE_TABLES
 = 33;

112 cÚ¡ 
	gXCT_TPCE_MIX
 = 70;

113 cÚ¡ 
	gXCT_TPCE_BROKER_VOLUME
 = 71;

114 cÚ¡ 
	gXCT_TPCE_CUSTOMER_POSITION
 = 72;

115 cÚ¡ 
	gXCT_TPCE_MARKET_FEED
 = 73;

116 cÚ¡ 
	gXCT_TPCE_MARKET_WATCH
 = 74;

117 cÚ¡ 
	gXCT_TPCE_SECURITY_DETAIL
 = 75;

118 cÚ¡ 
	gXCT_TPCE_TRADE_LOOKUP
 = 76;

119 cÚ¡ 
	gXCT_TPCE_TRADE_ORDER
 = 77;

120 cÚ¡ 
	gXCT_TPCE_TRADE_RESULT
 = 78;

121 cÚ¡ 
	gXCT_TPCE_TRADE_STATUS
 = 79;

122 cÚ¡ 
	gXCT_TPCE_TRADE_UPDATE
 = 80;

123 cÚ¡ 
	gXCT_TPCE_DATA_MAINTENANCE
 = 81;

124 cÚ¡ 
	gXCT_TPCE_TRADE_CLEANUP
 = 82;

129 cÚ¡ 
	gPROB_TPCE_DATA_MAINTENANCE
 = 0;

130 cÚ¡ 
	gPROB_TPCE_TRADE_CLEANUP
 = 0;

131 cÚ¡ 
	gPROB_TPCE_MARKET_FEED
 = 1.0;

132 cÚ¡ 
	gPROB_TPCE_TRADE_UPDATE
 = 2.0;

133 cÚ¡ 
	gPROB_TPCE_BROKER_VOLUME
 = 4.9;

134 cÚ¡ 
	gPROB_TPCE_TRADE_LOOKUP
 = 8.0;

135 cÚ¡ 
	gPROB_TPCE_TRADE_RESULT
 = 10.0;

136 cÚ¡ 
	gPROB_TPCE_TRADE_ORDER
 = 10.1;

137 cÚ¡ 
	gPROB_TPCE_CUSTOMER_POSITION
 = 13.0;

138 cÚ¡ 
	gPROB_TPCE_SECURITY_DETAIL
 = 14.0;

139 cÚ¡ 
	gPROB_TPCE_MARKET_WATCH
 = 18.0;

140 cÚ¡ 
	gPROB_TPCE_TRADE_STATUS
 = 19.0;

147 
¿ndom_xù_ty³
(cÚ¡ 
idx
);

149 
EXIT_NAMESPACE
(
û
);

	@include/workload/tpce/tpce_input.h

33 #iâdeà
__TPCE_INPUT_H


34 
	#__TPCE_INPUT_H


	)

36 
	~"wÜklßd/û/û_cÚ¡.h
"

37 
	~"wÜklßd/û/û_¡ruù.h
"

38 
	~"ut.h
"

39 
	~"wÜklßd/û/eg’/CE.h
"

40 
	~"wÜklßd/û/eg’/TxnH¬ÃssSŒuùs.h
"

41 
	~"wÜklßd/û/eg’/DM.h
"

42 
	~"wÜklßd/û/eg’/MEE.h
"

43 
	~"wÜklßd/û/MEESUT.h
"

45 
usšg
 
Çme¥aû
 
	gTPCE
;

47 
CCETxnIÅutG’”©Ü
* 
Œª§ùiÚs_šput_š™
(
cu¡om”s
, 
sf
, 
wdays
);

48 
CDM
* 
d©a_maš‹Çnû_š™
(
cu¡om”s
, 
sf
, 
wdays
);

49 
CMEE
* 
m¬k‘_š™
Ğ
INT32
 
T¿dšgTimeSoF¬
, 
CMEESUTIÁ”çû
 *
pSUT
, 
UINT32
 
UniqueId
);

51 
ENTER_NAMESPACE
(
û
);

53 
CCETxnIÅutG’”©Ü
* 
m_TxnIÅutG’”©Ü
;

54 
CDM
* 
m_CDM
;

55 
CMEESUT
* 
m“sut
;

56 
CMEE
* 
m“
;

59 
myTime
 
Eg’TimeToTimeT
(
CD©eTime
 &
cdt
);

63 
myTime
 
Eg’TimeSmpToTimeT
(
TIMESTAMP_STRUCT
 &
tss
);

66 
dayOfMÚth
(
myTime
& 
t
);

76 
	sbrok”_vŞume_šput_t


78 
	m_brok”_li¡
[40][
STRSIZE
(49)];

79 
	m_£ùÜ_Çme
[
STRSIZE
(30)];

82 
brok”_vŞume_šput_t
()

84 
mem£t
(
_£ùÜ_Çme
, '\0', 
STRSIZE
(30));

87 ~
brok”_vŞume_šput_t
() { };

88 
´št
 ();

90 
	mbrok”_vŞume_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
brok”_vŞume_šput_t
& 
rhs
);

103 
	scu¡om”_pos™iÚ_šput_t


105 
TId’t
 
	m_acù_id_idx
;

106 
TId’t
 
	m_cu¡_id
;

107 
boŞ
 
	m_g‘_hi¡Üy
;

108 
	m_x_id
[
STRSIZE
(20)];

111 
cu¡om”_pos™iÚ_šput_t
()

112 :
_acù_id_idx
(0), 
_cu¡_id
(0),

113 
_g‘_hi¡Üy
(
çl£
)

115 
mem£t
(
_x_id
, '\0', 21);

118 
´št
();

120 ~
cu¡om”_pos™iÚ_šput_t
() { };

123 
	mcu¡om”_pos™iÚ_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
cu¡om”_pos™iÚ_šput_t
& 
rhs
);

137 
	sŒade_Üd”_šput_t


139 
TId’t
 
	m_acù_id
;

140 
	m_co_Çme
[61];

141 
	m_exec_f_Çme
[21];

142 
	m_exec_l_Çme
[26];

143 
	m_exec_x_id
[21];

144 
boŞ
 
	m_is_lifo
;

145 
	m_issue
[7];

146 
	m_»que¡ed_´iû
;

147 
boŞ
 
	m_rŞl_™_back
;

148 
	m_¡_³ndšg_id
[5];

149 
	m_¡_subm™‹d_id
[5];

150 
	m_symbŞ
[16];

151 
	m_Œade_qty
;

152 
	m_Œade_ty³_id
[4];

153 
boŞ
 
	m_ty³_is_m¬gš
;

155 
´št
();

158 
Œade_Üd”_šput_t
()

159 :
_acù_id
(0), 
_is_lifo
(
çl£
), 
_»que¡ed_´iû
(0),

160 
_rŞl_™_back
(
çl£
), 
_Œade_qty
(0), 
_ty³_is_m¬gš
(false)

162 
mem£t
(
_co_Çme
, '\0', 61);

163 
mem£t
(
_exec_f_Çme
, '\0', 21);

164 
mem£t
(
_exec_l_Çme
, '\0', 26);

165 
mem£t
(
_exec_x_id
, '\0', 21);

166 
mem£t
(
_issue
, '\0', 7);

167 
mem£t
(
_¡_³ndšg_id
, '\0', 5);

168 
mem£t
(
_¡_subm™‹d_id
, '\0', 5);

169 
mem£t
(
_symbŞ
, '\0', 16);

170 
mem£t
(
_Œade_ty³_id
, '\0', 4);

173 ~
Œade_Üd”_šput_t
() { };

176 
	mŒade_Üd”_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
Œade_Üd”_šput_t
& 
rhs
);

189 
	sŒade_lookup_šput_t


191 
TId’t
 
	m_acù_id
;

192 
	m_äame_to_execu‹
;

193 
TId’t
 
	m_max_acù_id
;

194 
	m_max_Œades
;

195 
myTime
 
	m_¡¬t_Œade_dts
;

196 
myTime
 
	m_’d_Œade_dts
;

197 
	m_symbŞ
[16];

198 
TId’t
 
	m_Œade_id
[20];

200 
´št
();

202 
Œade_lookup_šput_t
()

203 :
_acù_id
(0), 
_’d_Œade_dts
(0), 
_äame_to_execu‹
(0),

204 
_max_acù_id
(0), 
_max_Œades
(0), 
_¡¬t_Œade_dts
(0)

206 
mem£t
(
_symbŞ
, '\0', 16);

209 ~
Œade_lookup_šput_t
() { };

212 
	mŒade_lookup_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
Œade_lookup_šput_t
& 
rhs
);

224 
	sŒade_»suÉ_šput_t


228 
rid_t
 
	m_hŞdšg_rid
[10];

230 
TId’t
 
	m_Œade_id
;

231 
	m_Œade_´iû
;

234 
Œade_»suÉ_šput_t
()

235 :
_Œade_id
(0), 
_Œade_´iû
(0)

237 
´št
();

238 ~
Œade_»suÉ_šput_t
() { };

241 
	mŒade_»suÉ_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
Œade_»suÉ_šput_t
& 
rhs
);

251 
	sm¬k‘_w©ch_šput_t


253 
TId’t
 
	m_acù_id
;

254 
TId’t
 
	m_cu¡_id
;

255 
TId’t
 
	m_¡¬tšg_co_id
;

256 
TId’t
 
	m_’dšg_co_id
;

257 
	m_šdu¡ry_Çme
[51];

258 
myTime
 
	m_¡¬t_d©e
;

260 
´št
();

263 
m¬k‘_w©ch_šput_t
():

264 
_acù_id
(0), 
_cu¡_id
(0), 
_’dšg_co_id
(0),

265 
_¡¬t_d©e
(0), 
_¡¬tšg_co_id
(0)

267 
mem£t
(
_šdu¡ry_Çme
, '\0', 51);

270 ~
m¬k‘_w©ch_šput_t
() { };

273 
	mm¬k‘_w©ch_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
m¬k‘_w©ch_šput_t
& 
rhs
);

284 
	s£cur™y_d‘a_šput_t


286 
boŞ
 
	m_acûss_lob_æag
;

287 
	m_symbŞ
[16];

288 
myTime
 
	m_¡¬t_day
;

289 
	m_max_rows_to_»tuº
;

293 
£cur™y_d‘a_šput_t
():

294 
_acûss_lob_æag
(
çl£
), 
_max_rows_to_»tuº
(0),

295 
_¡¬t_day
(0)

297 
mem£t
(
_symbŞ
, '\0', 16);

299 
´št
();

300 ~
£cur™y_d‘a_šput_t
() { };

303 
	m£cur™y_d‘a_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
£cur™y_d‘a_šput_t
& 
rhs
);

313 
	sŒade_¡©us_šput_t


315 
TId’t
 
	m_acù_id
;

317 
Œade_¡©us_šput_t
()

318 :
_acù_id
(0)

320 
´št
();

321 ~
Œade_¡©us_šput_t
() { };

324 
	mŒade_¡©us_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
Œade_¡©us_šput_t
& 
rhs
);

334 
	sŒade_upd©e_šput_t


336 
TId’t
 
	m_acù_id
;

337 
	m_äame_to_execu‹
;

338 
	m_max_Œades
;

339 
	m_max_upd©es
;

340 
	m_symbŞ
[
cSYMBOL_Ën
+1];

341 
myTime
 
	m_¡¬t_Œade_dts
;

342 
myTime
 
	m_’d_Œade_dts
;

343 
TId’t
 
	m_Œade_id
[
T¿deUpd©eF¿me1MaxRows
];

344 
TId’t
 
	m_max_acù_id
;

347 
´št
();

348 
Œade_upd©e_šput_t
():

349 
_acù_id
(0), 
_äame_to_execu‹
(0), 
_max_Œades
(0), 
_max_upd©es
(0), 
_max_acù_id
(0)

351 
mem£t
(
_symbŞ
, '\0', 16);

353 ~
Œade_upd©e_šput_t
(){}

363 
	sd©a_maš‹Çnû_šput_t


365 
TId’t
 
	m_acù_id
;

366 
TId’t
 
	m_c_id
;

367 
TId’t
 
	m_co_id
;

368 
	m_day_of_mÚth
;

369 
	m_symbŞ
[16];

370 
	m_bË_Çme
[31];

371 
	m_tx_id
[21];

372 
	m_vŞ_šü
;

374 
´št
();

376 
d©a_maš‹Çnû_šput_t
 ():

377 
_acù_id
(0), 
_c_id
(0), 
_co_id
(0),

378 
_vŞ_šü
(0), 
_day_of_mÚth
(0)

381 
mem£t
(
_symbŞ
, '\0', 16);

382 
mem£t
(
_bË_Çme
, '\0', 31);

383 
mem£t
(
_tx_id
, '\0', 21);

386 ~
d©a_maš‹Çnû_šput_t
() { };

389 
	md©a_maš‹Çnû_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
d©a_maš‹Çnû_šput_t
& 
rhs
);

400 
	sm¬k‘_ãed_šput_t


404 
rid_t
 
	m_Œade_rid
[10];

406 
	m_´iû_quÙe
[
max_ãed_Ën
];

407 
	m_¡©us_subm™‹d
[5];

408 
	m_symbŞ
[
max_ãed_Ën
][16];

409 
	m_Œade_qty
[
max_ãed_Ën
];

410 
	m_ty³_lim™_buy
[4];

411 
	m_ty³_lim™_£Î
[4];

412 
	m_ty³_¡İ_loss
[4];

414 
´št
();

416 
m¬k‘_ãed_šput_t
()

418 
mem£t
(
_¡©us_subm™‹d
, '\0', 5);

419 
mem£t
(
_ty³_lim™_buy
, '\0', 4);

420 
mem£t
(
_ty³_lim™_£Î
, '\0', 4);

421 
mem£t
(
_ty³_¡İ_loss
, '\0', 4);

424 ~
m¬k‘_ãed_šput_t
() { };

427 
	mm¬k‘_ãed_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
m¬k‘_ãed_šput_t
& 
rhs
);

437 
	sŒade_ş—nup_šput_t


439 
	m_¡_ÿnûËd_id
[5];

440 
	m_¡_³ndšg_id
[5];

441 
	m_¡_subm™‹d_id
[5];

442 
TId’t
 
	m_Œade_id
;

445 
Œade_ş—nup_šput_t
():
_Œade_id
(0)

447 
mem£t
(
_¡_ÿnûËd_id
, '\0', 5);

448 
mem£t
(
_¡_³ndšg_id
, '\0', 5);

449 
mem£t
(
_¡_subm™‹d_id
, '\0', 5);

452 
´št
();

453 ~
Œade_ş—nup_šput_t
() { };

456 
	mŒade_ş—nup_šput_t
& 
	mİ”©Ü
ğ(cÚ¡ 
Œade_ş—nup_šput_t
& 
rhs
);

460 
brok”_vŞume_šput_t
 
ü—‹_brok”_vŞume_šput
(
sf
, 
¥ecificIdx
);

461 
cu¡om”_pos™iÚ_šput_t
 
ü—‹_cu¡om”_pos™iÚ_šput
(
sf
, 
¥ecificIdx
);

462 
m¬k‘_ãed_šput_t
 
ü—‹_m¬k‘_ãed_šput
(
sf
, 
¥ecificIdx
);

463 
m¬k‘_w©ch_šput_t
 
ü—‹_m¬k‘_w©ch_šput
(
sf
, 
¥ecificIdx
);

464 
£cur™y_d‘a_šput_t
 
ü—‹_£cur™y_d‘a_šput
(
sf
, 
¥ecificIdx
);

465 
Œade_lookup_šput_t
 
ü—‹_Œade_lookup_šput
(
sf
, 
¥ecificIdx
);

466 
Œade_Üd”_šput_t
 
ü—‹_Œade_Üd”_šput
(
sf
, 
¥ecificIdx
);

467 
Œade_»suÉ_šput_t
 
ü—‹_Œade_»suÉ_šput
(
sf
, 
¥ecificIdx
);

468 
Œade_¡©us_šput_t
 
ü—‹_Œade_¡©us_šput
(
sf
, 
¥ecificIdx
);

469 
Œade_upd©e_šput_t
 
ü—‹_Œade_upd©e_šput
(
sf
, 
¥ecificIdx
);

470 
d©a_maš‹Çnû_šput_t
 
ü—‹_d©a_maš‹Çnû_šput
(
sf
, 
¥ecificIdx
);

471 
Œade_ş—nup_šput_t
 
ü—‹_Œade_ş—nup_šput
(
sf
, 
¥ecificIdx
);

474 
	spİuÏ‹_sm®l_šput_t
{};

475 
	spİuÏ‹_cu¡om”_šput_t
{};

476 
	spİuÏ‹_add»ss_šput_t
{};

477 
	spİuÏ‹_ÿ_ªd_­_šput_t
{};

478 
	spİuÏ‹_wl_ªd_wi_šput_t
{};

479 
	spİuÏ‹_com·ny_šput_t
{};

480 
	spİuÏ‹_com·ny_com³t™Ü_šput_t
{};

481 
	spİuÏ‹_day_m¬k‘_šput_t
{};

482 
	spİuÏ‹_fšªcŸl_šput_t
{};

483 
	spİuÏ‹_Ï¡_Œade_šput_t
{};

484 
	spİuÏ‹_ni_ªd_nx_šput_t
{};

485 
	spİuÏ‹_£cur™y_šput_t
{};

486 
	spİuÏ‹_cu¡om”_x¿‹_šput_t
{};

487 
	spİuÏ‹_brok”_šput_t
{};

488 
	spİuÏ‹_hŞdšg_šput_t
{};

489 
	spİuÏ‹_hŞdšg_summ¬y_šput_t
{};

490 
	spİuÏ‹_un™_Œade_šput_t
{};

492 
	sfšd_maxŒade_id_šput_t
{};

496 
EXIT_NAMESPACE
(
û
);

	@include/workload/tpce/tpce_struct.h

9 #iâdeà
__TPCE_STRUCT_H


10 
	#__TPCE_STRUCT_H


	)

12 
	~<c¡dlib
>

13 
	~<uni¡d.h
>

14 
	~<sys/time.h
>

15 
	~"ut.h
"

16 
	~"wÜklßd/û/eg’/TxnH¬ÃssSŒuùs.h
"

18 
usšg
 
Çme¥aû
 
	gTPCE
;

20 
ENTER_NAMESPACE
(
û
);

24 
	#STRSIZE
(
x
)(x+1)

	)

34 
	sû_accouÁ_³rmissiÚ_tu¶e
{

35 
TId’t
 
	mAP_CA_ID
;

36 
	mAP_ACL
 [
STRSIZE
(4)];

37 
	mAP_TAX_ID
 [
STRSIZE
(20)];

38 
	mAP_L_NAME
 [
STRSIZE
(25)];

39 
	mAP_F_NAME
 [
STRSIZE
(20)];

43 
	sû_accouÁ_³rmissiÚ_key
{

44 
TId’t
 
	mAP_CA_ID
;

45 
	mAP_ACL
 [
STRSIZE
(4)];

49 
	sû_cu¡om”_tu¶e
{

50 
TId’t
 
	mC_ID
;

51 
	mC_TAX_ID
 [
STRSIZE
(20)];

52 
	mC_ST_ID
 [
STRSIZE
(4)];

53 
	mC_L_NAME
 [
STRSIZE
(25)];

54 
	mC_F_NAME
 [
STRSIZE
(20)];

55 
	mC_M_NAME
;

56 
	mC_GNDR
;

57 
	mC_TIER
;

58 
time_t
 
	mC_DOB
;

59 
TId’t
 
	mC_AD_ID
;

60 
	mC_CTRY_1
 [
STRSIZE
(3)];

61 
	mC_AREA_1
 [
STRSIZE
(3)];

62 
	mC_LOCAL_1
 [
STRSIZE
(10)];

63 
	mC_EXT_1
 [
STRSIZE
(5)];

64 
	mC_CTRY_2
 [
STRSIZE
(3)];

65 
	mC_AREA_2
 [
STRSIZE
(3)];

66 
	mC_LOCAL_2
 [
STRSIZE
(10)];

67 
	mC_EXT_2
 [
STRSIZE
(5)];

68 
	mC_CTRY_3
 [
STRSIZE
(3)];

69 
	mC_AREA_3
 [
STRSIZE
(3)];

70 
	mC_LOCAL_3
 [
STRSIZE
(10)];

71 
	mC_EXT_3
 [
STRSIZE
(5)];

72 
	mC_EMAIL_1
 [
STRSIZE
(50)];

73 
	mC_EMAIL_2
 [
STRSIZE
(50)];

76 
	sû_cu¡om”_key
{

78 
	mTId’t
;

83 
	sû_cu¡om”_accouÁ_tu¶e
{

84 
TId’t
 
	mCA_ID
;

85 
TId’t
 
	mCA_B_ID
;

86 
TId’t
 
	mCA_C_ID
;

87 
	mCA_NAME
 [
STRSIZE
(50)];

88 
	mCA_TAX_ST
;

89 
	mCA_BAL
;

93 
	sû_cu¡om”_accouÁ_key
{

94 
TId’t
 
	mCA_ID
;

99 
	sû_cu¡om”_x¿‹_tu¶e


101 
	mCX_TX_ID
 [
STRSIZE
(4)];

102 
TId’t
 
	mCX_C_ID
;

105 
	sû_cu¡om”_x¿‹_key
{

106 
TId’t
 
	mCA_ID
;

107 
	mCX_TX_ID
 [
STRSIZE
(4)];

112 
	sû_hŞdšg_tu¶e
{

113 
TId’t
 
	mH_T_ID
;

114 
TId’t
 
	mH_CA_ID
;

115 
	mH_S_SYMB
 [
STRSIZE
(4)];

116 
time_t
 
	mH_DTS
;

117 
	mH_PRICE
;

118 
	mH_QTY
;

121 
	sû_hŞdšg_key
{

122 
TId’t
 
	mH_T_ID
;

126 
	sû_hŞdšg_hi¡Üy_tu¶e
{

127 
TId’t
 
	mHH_H_T_ID
;

128 
TId’t
 
	mHH_T_ID
;

129 
	mHH_BEFORE_QTY
;

130 
	mHH_AFTER_QTY
;

133 
	sû_hŞdšg_hi¡Üy_key
{

134 
TId’t
 
	mHH_H_T_ID
;

135 
TId’t
 
	mHH_T_ID
;

140 
	sû_hŞdšg_summ¬y_tu¶e
{

141 
TId’t
 
	mHS_CA_ID
;

142 
	mHS_S_SYMB
 [
STRSIZE
(15)];

143 
	mHS_QTY
;

146 
	sû_hŞdšg_summ¬y_key
{

147 
TId’t
 
	mHS_CA_ID
;

148 
	mHS_S_SYMB
 [
STRSIZE
(15)];

152 
	sû_w©ch_™em_tu¶e
{

153 
TId’t
 
	mWI_WL_ID
;

154 
	mWI_S_SYMB
 [
STRSIZE
(15)];

157 
	sû_w©ch_™em_key
{

158 
TId’t
 
	mWI_WL_ID
;

159 
	mWI_S_SYMB
 [
STRSIZE
(15)];

165 
	sû_w©ch_li¡_tu¶e
{

166 
TId’t
 
	mWL_ID
;

167 
TId’t
 
	mWL_C_ID
;

170 
	sû_w©ch_li¡_key
{

171 
TId’t
 
	mWL_ID
;

180 
	sû_brok”_tu¶e
{

181 
TId’t
 
	mB_ID
;

182 
	mB_ST_ID
 [
STRSIZE
(4)];

183 
	mB_NAME
 [
STRSIZE
(49)];

184 
	mB_NUM_TRADES
 [
STRSIZE
(9)];

185 
	mB_COMM_TOTAL
;

188 
	sû_brok”_key
{

189 
TId’t
 
	mB_ID
;

194 
	sû_ÿsh_Œª§ùiÚ_tu¶e
{

195 
TId’t
 
	mCT_T_ID
;

196 
time_t
 
	mCT_DTS
;

197 
	mCT_AMT
;

198 
	mCT_NAME
 [
STRSIZE
(100)];

201 
	sû_ÿsh_Œª§ùiÚ_key
{

202 
TId’t
 
	mCT_T_ID
;

207 
	sû_ch¬ge_tu¶e
{

208 
	mCH_TT_ID
 [
STRSIZE
(3)] ;

209 
	mCH_C_TIER
;

210 
	mCH_CHRG
;

213 
	sû_ch¬ge_key
{

214 
	mCH_TT_ID
 [
STRSIZE
(3)] ;

215 
	mCH_C_TIER
;

221 
	sû_commissiÚ_¿‹_tu¶e
{

222 
	mCR_C_TIER
;

223 
	mCR_TT_ID
 [
STRSIZE
(3)];

224 
	mCR_EX_ID
 [
STRSIZE
(6)];

225 
	mCR_FROM_QTY
;

226 
	mCR_TO_QTY
;

227 
	mCR_RATE
;

231 
	sû_commissiÚ_¿‹_key
{

232 
	mCR_C_TIER
;

233 
	mCR_TT_ID
 [
STRSIZE
(3)];

234 
	mCR_EX_ID
 [
STRSIZE
(6)];

235 
	mCR_FROM_QTY
;

240 
	sû_£‰Ëm’t_tu¶e
{

241 
TId’t
 
	mSE_T_ID
;

242 
	mSE_CASH_TYPE
 [
STRSIZE
(40)];

243 
time_t
 
	mSE_CASH_DUE_DATE
;

244 
	mSE_AMT
;

247 
	sû_£‰Ëm’t_key
{

248 
	mSE_T_ID
;

254 
	sû_Œade_tu¶e
{

255 
TId’t
 
	mT_ID
;

256 
time_t
 
	mT_DTS
;

257 
	mT_ST_ID
 [
STRSIZE
(4)];

258 
	mT_TT_ID
 [
STRSIZE
(3)];

259 
boŞ
 
	mT_IS_CASH
;

260 
	mT_S_SYMB
 [
STRSIZE
(15)];

261 
	mT_QTY
;

262 
	mT_BID_PRICE
;

263 
TId’t
 
	mT_CA_ID
;

264 
	mT_EXEC_NAME
 [
STRSIZE
(49)];

265 
	mT_TRADE_PRICE
;

266 
	mT_CHRG
;

267 
	mT_COMM
;

268 
	mT_TAX
;

269 
boŞ
 
	mT_LIFO
;

272 
	sû_Œade_key
{

273 
TId’t
 
	mT_ID
;

277 
	sû_Œade_hi¡Üy_tu¶e
{

278 
TId’t
 
	mTH_T_ID
;

279 
time_t
 
	mTH_DTS
;

280 
	mTH_ST_ID
 [
STRSIZE
(4)];

283 
	sû_Œade_hi¡Üy_key
{

284 
TId’t
 
	mTH_T_ID
;

285 
	mTH_ST_ID
 [
STRSIZE
(4)];

290 
	sû_Œade_»que¡_tu¶e
{

291 
TId’t
 
	mTR_T_ID
;

292 
	mTR_TT_ID
 [
STRSIZE
(3)];

293 
	mTR_S_SYMB
 [
STRSIZE
(15)];

294 
	mTR_QTY
;

295 
	mTR_BID_PRICE
;

296 
TId’t
 
	mTR_B_ID
;

300 
	sû_Œade_»que¡_key
{

301 
TId’t
 
	mTR_T_ID
;

306 
	sû_Œade_ty³_tu¶e
{

307 
	mTT_ID
 [
STRSIZE
(3)];

308 
	mTT_NAME
 [
STRSIZE
(12)];

309 
boŞ
 
	mTT_IS_SELL
;

310 
boŞ
 
	mTT_IS_MRKT
;

313 
	sû_Œade_ty³_key
{

314 
	mTT_ID
 [
STRSIZE
(3)];

323 
	sû_com·ny_tu¶e
{

324 
TId’t
 
	mCO_ID
;

325 
	mCO_ST_ID
 [
STRSIZE
(4)];

326 
	mCO_NAME
 [
STRSIZE
(60)];

327 
	mCO_IN_ID
 [
STRSIZE
(2)];

328 
	mCO_SP_RATE
 [
STRSIZE
(4)];

329 
	mCO_CEO
 [
STRSIZE
(46)];

330 
TId’t
 
	mCO_AD_ID
;

331 
	mCO_DESC
 [
STRSIZE
(150)];

332 
time_t
 
	mCO_OPENDATE
;

336 
	sû_com·ny_tu¶e_key
{

337 
TId’t
 
	mCO_ID
;

341 
	sû_com·ny_com³t™Ü_tu¶e
{

342 
TId’t
 
	mCP_CO_ID
;

343 
TId’t
 
	mCP_COMP_CO_ID
;

344 
	mCP_IN_ID
 [
STRSIZE
(2)];

348 
	sû_com·ny_com³t™Ü_tu¶e_key
{

349 
TId’t
 
	mCP_CO_ID
;

350 
TId’t
 
	mCP_COMP_CO_ID
;

351 
	mCP_IN_ID
 [
STRSIZE
(2)];

356 
	sû_day_m¬k‘_tu¶e
{

357 
time_t
 
	mDM_DATE
;

358 
	mDM_S_SYMB
 [
STRSIZE
(15)];

359 
	mDM_CLOSE
;

360 
	mDM_HIGH
;

361 
	mDM_LOW
;

362 
TId’t
 
	mDM_VOL
;

366 
	sû_day_m¬k‘_tu¶e_key
{

367 
time_t
 
	mDM_DATE
;

368 
	mDM_S_SYMB
 [
STRSIZE
(15)];

372 
	sû_exchªge_tu¶e
{

373 
	mEX_ID
 [
STRSIZE
(6)];

374 
	mEX_NAME
 [
STRSIZE
(100)];

375 
	mEX_NUM_SYMB
;

376 
	mEX_OPEN
;

377 
	mEX_CLOSE
;

378 
	mEX_DESC
 [
STRSIZE
(150)];

379 
TId’t
 
	mEX_AD_ID
;

384 
	sû_exchªge_tu¶e_key
{

385 
	mEX_ID
 [
STRSIZE
(6)];

389 
	sû_fšªcŸl_tu¶e
{

390 
TId’t
 
	mFI_CO_ID
;

391 
	mFI_YEAR
;

392 
	mFI_QTR
;

393 
time_t
 
	mFI_QTR_START_DATE
;

394 
	mFI_QTR_REVENUE
;

395 
	mFI_NET_EARN
;

396 
	mFI_BASIC_EPS
;

397 
	mFI_DILUT_EPS
 [
STRSIZE
(150)];

398 
	mFI_MARGIN
;

399 
	mFI_INVENTORY
;

400 
	mFI_ASSETS
;

401 
	mFI_LIABILITY
;

402 
TId’t
 
	mFI_OUT_BASIC
;

403 
TId’t
 
	mFI_OUT_DILUT
;

407 
	sû_fšªcŸl_tu¶e_key
{

408 
TId’t
 
	mFI_CO_ID
;

409 
	mFI_YEAR
;

410 
	mFI_QTR
;

415 
	sû_šdu¡ry_tu¶e
{

416 
	mIN_ID
 [
STRSIZE
(2)];

417 
	mIN_NAME
 [
STRSIZE
(50)];

418 
	mIN_SC_ID
 [
STRSIZE
(2)];

421 
	sû_šdu¡ry_tu¶e_key
{

422 
	mIN_ID
 [
STRSIZE
(2)];

426 
	sû_Ï¡_Œade_tu¶e
{

427 
	mLT_S_SYMB
 [
STRSIZE
(15)];

428 
time_t
 
	mLT_DTS
;

429 
	mLT_PRICE
;

430 
	mLT_OPEN_PRICE
;

431 
TId’t
 
	mLT_VOL
;

434 
	sû_Ï¡_Œade_tu¶e_key
{

435 
	mLT_S_SYMB
 [
STRSIZE
(15)];

439 
	sû_Ãws_™em_tu¶e
{

440 
TId’t
 
	mNI_ID
;

441 
	mNI_HEADLINE
 [
STRSIZE
(80)];

442 
	mNI_SUMMARY
 [
STRSIZE
(255)];

443 
	mNI_ITEM
 [
STRSIZE
(100000)];

444 
time_t
 
	mNI_DTS
;

445 
	mNI_SOURCE
 [
STRSIZE
(30)];

446 
	mNI_AUTHOR
 [
STRSIZE
(30)];

449 
	sû_Ãws_™em_tu¶e_key
{

450 
TId’t
 
	mNI_ID
;

454 
	sû_Ãws_x»f_tu¶e
{

455 
TId’t
 
	mNX_NI_ID
;

456 
TId’t
 
	mNX_CO_ID
;

459 
	sû_Ãws_x»f_tu¶e_key
{

460 
TId’t
 
	mNX_NI_ID
;

461 
TId’t
 
	mNX_CO_ID
;

465 
	sû_£ùÜ_tu¶e
{

466 
	mSC_ID
 [
STRSIZE
(2)];

467 
	mSC_NAME
 [
STRSIZE
(30)];

470 
	sû_£ùÜ_tu¶e_key
{

471 
	mSC_ID
 [
STRSIZE
(2)];

475 
	sû_£cur™y_tu¶e
{

476 
	mS_SYMB
 [
STRSIZE
(15)];

477 
	mS_ISSUE
 [
STRSIZE
(6)];

478 
	mS_ST_ID
 [
STRSIZE
(4)];

479 
	mS_NAME
 [
STRSIZE
(70)];

480 
	mS_EX_ID
 [
STRSIZE
(6)];

481 
TId’t
 
	mS_CO_ID
;

482 
TId’t
 
	mS_NUM_OUT
;

483 
time_t
 
	mS_START_DATE
;

484 
time_t
 
	mS_EXCH_DATE
;

485 
	mS_PE
;

486 
	mS_52WK_HIGH
;

487 
time_t
 
	mS_52WK_HIGH_DATE
;

488 
	mS_52WK_LOW
;

489 
time_t
 
	mS_52WK_LOW_DATE
;

490 
	mS_DIVIDEND
;

491 
	mS_YIELD
;

494 
	sû_£cur™y_tu¶e_key
{

495 
	mS_SYMB
 [
STRSIZE
(15)];

504 
	sû_add»ss_tu¶e
{

505 
TId’t
 
	mAD_ID
;

506 
	mAD_LINE1
 [
STRSIZE
(80)];

507 
	mAD_LINE2
 [
STRSIZE
(80)];

508 
	mAD_ZC_CODE
 [
STRSIZE
(12)];

509 
	mAD_CTRY
 [
STRSIZE
(80)];

512 
	sû_add»ss_tu¶e_key
{

513 
TId’t
 
	mAD_ID
;

517 
	sû_¡©us_ty³_tu¶e
{

518 
	mST_ID
 [
STRSIZE
(4)];

519 
	mST_NAME
 [
STRSIZE
(10)];

522 
	sû_¡©us_ty³_tu¶e_key
{

523 
	mST_ID
 [
STRSIZE
(4)];

527 
	sû_x_¿‹_tu¶e
{

528 
	mTX_ID
 [
STRSIZE
(4)];

529 
	mTX_NAME
 [
STRSIZE
(50)];

530 
	mTX_RATE
;

533 
	sû_x_¿‹_tu¶e_key
{

534 
	mTX_ID
 [
STRSIZE
(4)];

538 
	sû_z_code_tu¶e
{

539 
	mZC_CODE
 [
STRSIZE
(12)];

540 
	mZC_TOWN
 [
STRSIZE
(80)];

541 
	mZC_DIV
 [
STRSIZE
(80)];

544 
	sû_z_code_tu¶e_key
{

545 
	mZC_CODE
 [
STRSIZE
(12)];

548 
EXIT_NAMESPACE
(
û
);

	@include/workload/tpch/dbgen/bcd2.h

22 #iâdeà
DBGEN_TPCH_BCD2_H


23 
	#DBGEN_TPCH_BCD2_H


	)

25 
	~"ut/Çme¥aû.h
"

27 
ENTER_NAMESPACE
(
dbg’ch
);

29 
bš_bcd2
(
bš¬y
, *
low_»s
, *
high_»s
);

30 
bcd2_bš
(*
de¡
, 
bcd
);

31 
bcd2_add
(*
bcd_low
, *
bcd_high
, 
add’d
);

32 
bcd2_sub
(*
bcd_low
, *
bcd_high
, 
sub’d
);

33 
bcd2_mul
(*
bcd_low
, *
bcd_high
, 
muÉl›r
);

34 
bcd2_div
(*
bcd_low
, *
bcd_high
, 
divisÜ
);

35 
bcd2_mod
(*
bcd_low
, *
bcd_high
, 
modulo
);

36 
bcd2_cmp
(*
bcd_low
, *
bcd_high
, 
com·»
);

38 
EXIT_NAMESPACE
(
dbg’ch
);

	@include/workload/tpch/dbgen/config.h

101 #iâdeà
DBGEN_TPCH_CONFIG_H


102 
	#DBGEN_TPCH_CONFIG_H


	)

104 
	~"ut/Çme¥aû.h
"

106 
ENTER_NAMESPACE
(
dbg’ch
);

110 
	#TPCH


	)

112 #ifdeà
DOS


113 
	#DSS_PROC
 1

	)

114 
	#PATH_SEP
 '\\'

	)

118 #ifdeà
LINUX


119 
	#STDLIB_HAS_GETOPT


	)

120 
	#SUPPORT_64BITS


	)

121 
	#DSS_HUGE
 

	)

122 
	#HUGE_FORMAT
 "%Îd"

	)

123 
	#HUGE_DATE_FORMAT
 "%02Îd"

	)

124 
	#RNG_A
 6364136223846793005uÎ

	)

125 
	#RNG_C
 1uÎ

	)

128 #ià
defšed
(
SUN
è|| defšed(
SOLARIS2
)

129 
	#STDLIB_HAS_GETOPT


	)

130 
	#RNG_A
 6364136223846793005uÎ

	)

131 
	#RNG_C
 1uÎ

	)

132 
	#SUPPORT_64BITS


	)

133 
	#DSS_HUGE
 

	)

134 
	#HUGE_FORMAT
 "%Îd"

	)

135 
	#HUGE_DATE_FORMAT
 "%02Îd"

	)

138 #ifdeà
SGI


139 
	#STDLIB_HAS_GETOPT


	)

140 
	#SUPPORT_64BITS


	)

141 
	#DSS_HUGE
 
__št64_t


	)

144 #ià(
defšed
(
WIN32
)&&!defšed(
_POSIX_
))

145 
	#pid_t
 

	)

146 
	#SET_HANDLER
(
´oc
è
	`sigÇl
(
SIGINT
,…roc)

	)

147 
	#KILL
(
pid
) \

148 
	`T”mš©eProûss
(
	`O³nProûss
(
PROCESS_TERMINATE
,
FALSE
,
pid
),3)

	)

149 #ià(
defšed
 (
__WATCOMC__
))

150 
	#SPAWN
(è
	`¥awnv
(
P_NOWAIT
, 
¥awn_¬gs
[0], s·wn_¬gs)

	)

151 
	#WAIT
(
»s
, 
pid
è
	`cwa™
Ôes,…id, 
WAIT_CHILD
)

	)

153 
	#SPAWN
(è
	`_¥awnv
(
_P_NOWAIT
, 
¥awn_¬gs
[0], s·wn_¬gs)

	)

154 
	#WAIT
(
»s
, 
pid
è
	`_cwa™
Ôes,…id, 
_WAIT_CHILD
)

	)

155 
	#g‘pid
 
_g‘pid


	)

157 
	#SIGS_DEFINED


	)

158 
	#PATH_SEP
 '\\'

	)

159 
	#SUPPORT_64BITS


	)

160 
	#DSS_HUGE
 
__št64


	)

161 
	#RNG_A
 6364136223846793005u
I64


	)

162 
	#RNG_C
 1u
I64


	)

163 
	#HUGE_FORMAT
 "%I64d"

	)

164 
	#HUGE_DATE_FORMAT
 "%02I64d"

	)

168 
	#WIFEXITED
(
s
è(( & 0xFFè=ğ0)

	)

169 
	#WIFSIGNALED
(
s
è((()((
¡©us
)-1è& 0xFFFFè< 0xFF)

	)

170 
	#WIFSTOPPED
(
s
è(((sè& 0xffè=ğ0x7f)

	)

171 
	#WTERMSIG
(
s
è((sè& 0x7f)

	)

172 
	#WSTOPSIG
(
s
è(((sè& 0xff00è>> 8)

	)

174 
	#¡rdup
(
x
è
	`_¡rdup
(x)

	)

177 #iâdeà
SIGS_DEFINED


178 
	#KILL
(
pid
è
	`kl
(
SIGUSR1
,…id)

	)

179 
	#SET_HANDLER
(
´oc
è
	`sigÇl
(
SIGUSR1
,…roc)

	)

180 
	#SPAWN
 
fÜk


	)

181 
	#WAIT
(
»s
, 
pid
è
	`wa™
Ôes)

	)

184 
	#DSS_PROC
 
	`g‘pid
()

	)

187 #iâdeà
DBNAME


188 
	#DBNAME
 "dss"

	)

191 #iâdeà
PATH_SEP


192 
	#PATH_SEP
 '/'

	)

195 #iâdeà
DSS_HUGE


196 #”rÜ 
SuµÜt
 
a
 64-
b™
 
d©©y³
 
is
 
»quœed
 
š
 
this
 
»Ëa£


199 #iâdeà
DOUBLE_CAST


200 
	#DOUBLE_CAST
 ()

	)

204 
EXIT_NAMESPACE
(
dbg’ch
);

	@include/workload/tpch/dbgen/dss.h

69 #iâdeà
DBGEN_TPCH_DSS_H


70 
	#DBGEN_TPCH_DSS_H


	)

72 
	~"ut/Çme¥aû.h
"

73 
	~"ut/Œaû.h
"

76 
	~"wÜklßd/ch/dbg’/cÚfig.h
"

77 
	~"wÜklßd/ch/dbg’/sh¬ed.h
"

79 #ifdeà
TPCH


80 
	#NAME
 "TPC-H"

	)

82 #ifdeà
TPCR


83 
	#NAME
 "TPC-R"

	)

85 #iâdeà
NAME


86 #”rÜ 
B’chm¬k
 
v”siÚ
 
mu¡
 
be
 
defšed
 
š
 
cÚfig
.
h


88 
	#TPC
 "T¿n§ùiÚ Proûssšg P”fÜmªû Counc"

	)

89 
	#C_DATES
 "1994 - 2008"

	)

91 
	~<¡dio.h
>

92 
	~<¡dlib.h
>

93 
	~<as£¹.h
>

96 
ENTER_NAMESPACE
(
dbg’ch
);

98 
dbg’_š™
();

101 
	#NONE
 -1

	)

102 
	#PART
 0

	)

103 
	#PSUPP
 1

	)

104 
	#SUPP
 2

	)

105 
	#CUST
 3

	)

106 
	#ORDER
 4

	)

107 
	#LINE
 5

	)

108 
	#ORDER_LINE
 6

	)

109 
	#PART_PSUPP
 7

	)

110 
	#NATION
 8

	)

111 
	#REGION
 9

	)

112 
	#UPDATE
 10

	)

113 
	#MAX_TABLE
 11

	)

114 
	#ONE_STREAM
 1

	)

115 
	#ADD_AT_END
 2

	)

117 #ifdeà
MAX


118 #undeà
MAX


120 #ifdeà
MIN


121 #undeà
MIN


123 
	#MAX
(
a
,
b
è(× > b )?a:b)

	)

124 
	#MIN
(
A
,
B
èĞ(Aè< (Bè? (Aè: (B))

	)

126 
	#INTERNAL_ERROR
(
p
è{
	`årštf
(
¡d”r
,"%s",…); 
	`as£¹
(0);}

	)

127 
	#LN_CNT
 4

	)

129 
Êoi£
[4];

132 
	#LIFENOISE
(
n
, 
v¬
) \

133 ià(
v”bo£
 > 0è
	`årštf
(
¡d”r
, "%c\b", 
Êoi£
[(
v¬
%
LN_CNT
)])

	)

135 
	#MALLOC_CHECK
(
v¬
) \

136 ià((
v¬
è=ğ
NULL
) \

138 
	`årštf
(
¡d”r
, "Malloc failed‡t %s:%d\n", \

139 
__FILE__
, 
__LINE__
); \

140 
	`ex™
(1); \

141 }

	)

142 
	#OPEN_CHECK
(
v¬
, 
·th
) \

143 ià((
v¬
è=ğ
NULL
) \

145 
	`årštf
(
¡d”r
, "Open failed for %s\n", \

146 
·th
); \

147 
	`as£¹
(0); \

148 }

	)

149 #iâdeà
MAX_CHILDREN


150 
	#MAX_CHILDREN
 1000

	)

158 #iâdeà
BITS_PER_LONG


159 
	#BITS_PER_LONG
 32

	)

160 
	#MAX_LONG
 0x7FFFFFFF

	)

162 
	#SPARSE_BITS
 2

	)

163 
	#SPARSE_KEEP
 3

	)

164 
	#MK_SPARSE
(
key
, 
£q
) \

165 (((((
key
>>3)<<2)|(
£q
 & 0x0003))<<3)|(key & 0x0007))

	)

167 
	#RANDOM
(
tgt
, 
low”
, 
uµ”
, 
¡»am
è
	`dss_¿ndom
(&tgt,†ow”, uµ”, sŒ—m)

	)

168 
	#RANDOM64
(
tgt
, 
low”
, 
uµ”
, 
¡»am
è
	`dss_¿ndom64
(&tgt,†ow”, uµ”, sŒ—m)

	)

174 
	mweight
;

175 *
	m‹xt
;

176 } 
	t£t_memb”
;

180 
	mcouÁ
;

181 
	mmax
;

182 
£t_memb”
 *
	mli¡
;

183 *
	m³rmu‹
;

184 } 
	tdi¡ributiÚ
;

188 
	#DIST_SIZE
(
d
èd->
couÁ


	)

189 
	#DIST_MEMBER
(
d
, 
i
è((
£t_memb”
 *)((d)->
li¡
 + i))->
‹xt


	)

193 cÚ¡ *
	mÇme
;

194 cÚ¡ *
	mcomm’t
;

195 
DSS_HUGE
 
	mba£
;

196 (*
	mh—d”
è(
FILE
* 
	mf
);

197 (*
	mlßd”
[2]è(* 
	mo
, 
	mmode
);

198 (*
	mg’_£ed
)(
	mchd
, 
DSS_HUGE
 
	msk_couÁ
);

199 (*
	mv”ify
è(* 
	mvo
, 
	mmode
);

200 
	mchd
;

201 
DSS_HUGE
 
	mvtÙ®
;

202 } 
	ttdef
;

204 
	sSEED_T
 {

205 
	mbË
;

206 
DSS_HUGE
 
	mv®ue
;

207 
DSS_HUGE
 
	mu§ge
;

208 
DSS_HUGE
 
	mbound¬y
;

209 #ifdeà
RNG_TEST


210 
DSS_HUGE
 
	mnC®ls
;

212 } 
	t£ed_t
;

215 #ià
defšed
(
__STDC__
)

216 
	#PROTO
(
s
è
	)
s

218 
	#PROTO
(
s
è()

	)

222 cÚ¡ *
’v_cÚfig
 
PROTO
((cÚ¡ *
v¬
, cÚ¡ *
dæt
));

223 
yes_no
 
PROTO
((*
´om±
));

224 
a_ºd
 
PROTO
((
mš
, 
max
, 
cŞumn
, *
de¡
));

225 
tx_ºd
 
PROTO
((
mš
, 
max
, 
cŞumn
, *
tgt
));

226 
julŸn
 
PROTO
((
d©e
));

227 
unjulŸn
 
PROTO
((
d©e
));

228 
FILE
 *
tbl_İ’
 
PROTO
((
tbl
, cÚ¡ *
mode
));

229 
ds¢ÿ£cmp
 
PROTO
((cÚ¡ *
s1
, cÚ¡ *
s2
, 
n
));

230 
dssÿ£cmp
 
PROTO
((cÚ¡ *
s1
, cÚ¡ *
s2
));

231 
pick_¡r
 
PROTO
((
di¡ributiÚ
 * 
s
, 
c
, *
rg‘
));

232 
agg_¡r
 
PROTO
((
di¡ributiÚ
 *
£t
, 
couÁ
, 
cŞ
, *
de¡
));

233 
»ad_di¡
 
PROTO
((cÚ¡ *
·th
, cÚ¡ *
Çme
, 
di¡ributiÚ
 * 
rg‘
));

234 
embed_¡r
 
PROTO
((
di¡ributiÚ
 *
d
, 
mš
, 
max
, 
¡»am
, *
de¡
));

235 #iâdeà
STDLIB_HAS_GETOPT


236 
g‘İt
 
PROTO
((
¬g_út
, **
¬g_veù
, *
İriÚs
));

238 
DSS_HUGE
 
£t_¡©e
 
PROTO
((
t
, 
sÿË
, 
´ocs
, 
¡•
, DSS_HUGE *
e
));

241 
DSS_HUGE
 
NextRªd
 
PROTO
((DSS_HUGE 
nS“d
));

242 
DSS_HUGE
 
UnifIÁ
 
PROTO
((DSS_HUGE 
nLow
, DSS_HUGE 
nHigh
, 
nSŒ—m
));

243 
dss_¿ndom
(
DSS_HUGE
 *
tgt
, DSS_HUGE 
mš
, DSS_HUGE 
max
, 
£ed
);

244 
row_¡¬t
(
t
);

245 
row_¡İ
(
t
);

246 
dump_£eds
(
t
);

249 
	#MAX_GRAMMAR_LEN
 12

	)

250 
	#MAX_SENT_LEN
 256

	)

251 
	#RNG_PER_SENT
 27

	)

253 
dbg_‹xt
 
PROTO
((* 
t
, 
mš
, 
max
, 
s
));

255 #undeà
EXTERN


256 #ifdeà
DECLARER


257 
	#EXTERN


	)

259 
	#EXTERN
 

	)

263 
EXTERN
 
di¡ributiÚ
 
ÇtiÚs
;

264 
EXTERN
 
di¡ributiÚ
 
	gÇtiÚs2
;

265 
EXTERN
 
di¡ributiÚ
 
	g»giÚs
;

266 
EXTERN
 
di¡ributiÚ
 
	go_´iÜ™y_£t
;

267 
EXTERN
 
di¡ributiÚ
 
	gl_š¡ruù_£t
;

268 
EXTERN
 
di¡ributiÚ
 
	gl_smode_£t
;

269 
EXTERN
 
di¡ributiÚ
 
	gl_ÿ‹gÜy_£t
;

270 
EXTERN
 
di¡ributiÚ
 
	gl_ræag_£t
;

271 
EXTERN
 
di¡ributiÚ
 
	gc_m£g_£t
;

272 
EXTERN
 
di¡ributiÚ
 
	gcŞÜs
;

273 
EXTERN
 
di¡ributiÚ
 
	gp_ty³s_£t
;

274 
EXTERN
 
di¡ributiÚ
 
	gp_úŒ_£t
;

277 
EXTERN
 
di¡ributiÚ
 
	g¬tişes
;

278 
EXTERN
 
di¡ributiÚ
 
	gnouns
;

279 
EXTERN
 
di¡ributiÚ
 
	gadjeùives
;

280 
EXTERN
 
di¡ributiÚ
 
	gadv”bs
;

281 
EXTERN
 
di¡ributiÚ
 
	g´•os™iÚs
;

282 
EXTERN
 
di¡ributiÚ
 
	gv”bs
;

283 
EXTERN
 
di¡ributiÚ
 
	g‹rmš©Üs
;

284 
EXTERN
 
di¡ributiÚ
 
	gauxÏr›s
;

285 
EXTERN
 
di¡ributiÚ
 
	gÅ
;

286 
EXTERN
 
di¡ributiÚ
 
	gvp
;

287 
EXTERN
 
di¡ributiÚ
 
	gg¿mm¬
;

290 
EXTERN
 
	gsÿË
;

291 
EXTERN
 
	g¬eäesh
;

292 
EXTERN
 
	g»sume
;

293 
EXTERN
 
	gv”bo£
;

294 
EXTERN
 
	gfÜû
;

295 
EXTERN
 
	gh—d”
;

296 
EXTERN
 
	gcŞumÇr
;

297 
EXTERN
 
	gdœeù
;

298 
EXTERN
 
	gupd©es
;

299 
EXTERN
 
	gbË
;

300 
EXTERN
 
	gchd»n
;

301 
EXTERN
 
	gâames
;

302 
EXTERN
 
	gg’_sql
;

303 
EXTERN
 
	gg’_ºg
;

304 
EXTERN
 *
	gdb_Çme
;

305 
EXTERN
 
	g¡•
;

306 
EXTERN
 
	g£t_£eds
;

307 
EXTERN
 
	gv®id©e
;

308 
EXTERN
 *
	gd_·th
;

311 
EXTERN
 
	gš£¹_£gm’ts
;

312 
EXTERN
 
	gd–‘e_£gm’ts
;

313 
EXTERN
 
	gš£¹_Üd”s_£gm’t
;

314 
EXTERN
 
	gš£¹_lše™em_£gm’t
;

315 
EXTERN
 
	gd–‘e_£gm’t
;

318 #iâdeà
DECLARER


319 
tdef
 
tdefs
[];

335 
	#P_SIZE
 126

	)

336 
	#P_NAME_SCL
 5

	)

337 
	#P_MFG_TAG
 "Mªuçùu»r#"

	)

338 
	#P_MFG_FMT
 "%%s%%0%d%s"

	)

339 
	#P_MFG_MIN
 1

	)

340 
	#P_MFG_MAX
 5

	)

341 
	#P_BRND_TAG
 "B¿nd#"

	)

342 
	#P_BRND_FMT
 "%%s%%0%d%s"

	)

343 
	#P_BRND_MIN
 1

	)

344 
	#P_BRND_MAX
 5

	)

345 
	#P_SIZE_MIN
 1

	)

346 
	#P_SIZE_MAX
 50

	)

347 
	#P_MCST_MIN
 100

	)

348 
	#P_MCST_MAX
 99900

	)

349 
	#P_MCST_SCL
 100.0

	)

350 
	#P_RCST_MIN
 90000

	)

351 
	#P_RCST_MAX
 200000

	)

352 
	#P_RCST_SCL
 100.0

	)

356 
	#S_SIZE
 145

	)

357 
	#S_NAME_TAG
 "Suµl›r#"

	)

358 
	#S_NAME_FMT
 "%%s%%0%d%s"

	)

359 
	#S_ABAL_MIN
 -99999

	)

360 
	#S_ABAL_MAX
 999999

	)

361 
	#S_CMNT_MAX
 101

	)

362 
	#S_CMNT_BBB
 10

	)

363 
	#BBB_DEADBEATS
 50

	)

364 
	#BBB_BASE
 "Cu¡om” "

	)

365 
	#BBB_COMPLAIN
 "Com¶ašts"

	)

366 
	#BBB_COMMEND
 "Recomm’ds"

	)

367 
	#BBB_CMNT_LEN
 19

	)

368 
	#BBB_BASE_LEN
 9

	)

369 
	#BBB_TYPE_LEN
 10

	)

374 
	#PS_SIZE
 145

	)

375 
	#PS_SKEY_MIN
 0

	)

376 
	#PS_SKEY_MAX
 ((
tdefs
[
SUPP
].
ba£
 - 1è* 
sÿË
)

	)

377 
	#PS_SCST_MIN
 100

	)

378 
	#PS_SCST_MAX
 100000

	)

379 
	#PS_QTY_MIN
 1

	)

380 
	#PS_QTY_MAX
 9999

	)

384 
	#C_SIZE
 165

	)

385 
	#C_NAME_TAG
 "Cu¡om”#"

	)

386 
	#C_NAME_FMT
 "%%s%%0%d%s"

	)

387 
	#C_MSEG_MAX
 5

	)

388 
	#C_ABAL_MIN
 -99999

	)

389 
	#C_ABAL_MAX
 999999

	)

393 
	#O_SIZE
 109

	)

394 
	#O_CKEY_MIN
 1

	)

395 
	#O_CKEY_MAX
 (
tdefs
[
CUST
].
ba£
 * 
sÿË
)

	)

396 
	#O_ODATE_MIN
 
STARTDATE


	)

397 
	#O_ODATE_MAX
 (
STARTDATE
 + 
TOTDATE
 - \

398 (
L_SDTE_MAX
 + 
L_RDTE_MAX
è- 1)

	)

399 
	#O_CLRK_TAG
 "CËrk#"

	)

400 
	#O_CLRK_FMT
 "%%s%%0%d%s"

	)

401 
	#O_CLRK_SCL
 1000

	)

402 
	#O_LCNT_MIN
 1

	)

403 
	#O_LCNT_MAX
 7

	)

408 
	#L_SIZE
 144L

	)

409 
	#L_QTY_MIN
 1

	)

410 
	#L_QTY_MAX
 50

	)

411 
	#L_TAX_MIN
 0

	)

412 
	#L_TAX_MAX
 8

	)

413 
	#L_DCNT_MIN
 0

	)

414 
	#L_DCNT_MAX
 10

	)

415 
	#L_PKEY_MIN
 1

	)

416 
	#L_PKEY_MAX
 (
tdefs
[
PART
].
ba£
 * 
sÿË
)

	)

417 
	#L_SDTE_MIN
 1

	)

418 
	#L_SDTE_MAX
 121

	)

419 
	#L_CDTE_MIN
 30

	)

420 
	#L_CDTE_MAX
 90

	)

421 
	#L_RDTE_MIN
 1

	)

422 
	#L_RDTE_MAX
 30

	)

426 
	#T_SIZE
 30

	)

427 
	#T_START_DAY
 3

	)

428 
	#LEAP
(
y
è((!(y % 4è&& (y % 100))?1:0)

	)

437 
	#SUPP_PER_PART
 4

	)

438 
	#ORDERS_PER_CUST
 10

	)

439 
	#CUST_MORTALITY
 3

	)

440 
	#NATIONS_MAX
 90

	)

441 
	#PHONE_FMT
 "%02d-%03d-%03d-%04d"

	)

442 
	#STARTDATE
 92001

	)

443 
	#CURRENTDATE
 95168

	)

444 
	#ENDDATE
 98365

	)

445 
	#TOTDATE
 2557

	)

446 
	#UPD_PCT
 10

	)

447 
	#MAX_STREAM
 47

	)

448 
	#V_STR_LOW
 0.4

	)

449 
	#PENNIES
 100

	)

450 
	#Q11_FRACTION
 ()0.0001

	)

454 
	#MIN_SCALE
 1.0

	)

455 
	#MAX_SCALE
 100000.0

	)

459 
	#MAX_32B_SCALE
 1000.0

	)

460 
	#LONG2HUGE
(
¤c
, 
d¡
è*d¡ = (
DSS_HUGE
)
	)
src

461 
	#HUGE2LONG
(
¤c
, 
d¡
è*d¡ = ()
	)
src

462 
	#HUGE_SET
(
¤c
, 
d¡
è*d¡ = *
	)
src

463 
	#HUGE_MUL
(
İ1
, 
İ2
è*İ1 *ğ
	)
op2

464 
	#HUGE_DIV
(
İ1
, 
İ2
è*İ1 /ğ
	)
op2

465 
	#HUGE_ADD
(
İ1
, 
İ2
, 
d¡
è*d¡ = *İ1 + 
	)
op2

466 
	#HUGE_SUB
(
İ1
, 
İ2
, 
d¡
è*d¡ = *İ1 - 
	)
op2

467 
	#HUGE_MOD
(
İ1
, 
İ2
è*İ1 % 
	)
op2

468 
	#HUGE_CMP
(
İ1
, 
İ2
è(*İ1 =ğ*İ2)?0:(*İ1 < *İ2)-1:1

	)

472 
	#DIST_TAG
 "DSS_DIST"

	)

473 
	#DIST_DFLT
 "di¡s.dss"

	)

474 
	#PATH_TAG
 "DSS_PATH"

	)

475 
	#PATH_DFLT
 "."

	)

476 
	#CONFIG_TAG
 "DSS_CONFIG"

	)

477 
	#CONFIG_DFLT
 "šşude/wÜklßd/ch/dbg’"

	)

478 
	#ADHOC_TAG
 "DSS_ADHOC"

	)

479 
	#ADHOC_DFLT
 "adhoc.dss"

	)

482 #iâdeà
SEPARATOR


483 
	#SEPARATOR
 '|'

	)

486 
	#DT_STR
 0

	)

487 #iâdeà
MVS


488 
	#DT_VSTR
 
DT_STR


	)

490 
	#DT_VSTR
 1

	)

492 
	#DT_INT
 2

	)

493 
	#DT_HUGE
 3

	)

494 
	#DT_KEY
 4

	)

495 
	#DT_MONEY
 5

	)

497 #undeà
DT_CHR


498 
	#DT_CHR
 6

	)

500 
dbg_´št
(
dt
, 
FILE
 *
tgt
, *
d©a
, 
Ën
, 
eŞ
);

501 
	#PR_STR
(
f
, 
¡r
, 
Ën
è
	`dbg_´št
(
DT_STR
, f, (*)¡r,†’, 1)

	)

502 
	#PR_VSTR
(
f
, 
¡r
, 
Ën
è
	`dbg_´št
(
DT_VSTR
, f, (*)¡r,†’, 1)

	)

503 
	#PR_VSTR_LAST
(
f
, 
¡r
, 
Ën
è
	`dbg_´št
(
DT_VSTR
, f, (*)¡r,†’, 0)

	)

504 
	#PR_INT
(
f
, 
¡r
è
	`dbg_´št
(
DT_INT
, f, (*)¡r, 0, 1)

	)

505 
	#PR_HUGE
(
f
, 
¡r
è
	`dbg_´št
(
DT_HUGE
, f, (*)¡r, 0, 1)

	)

506 
	#PR_KEY
(
f
, 
¡r
è
	`dbg_´št
(
DT_KEY
, f, (*)¡r, 0, -1)

	)

507 
	#PR_MONEY
(
f
, 
¡r
è
	`dbg_´št
(
DT_MONEY
, f, (*)¡r, 0, 1)

	)

508 
	#PR_CHR
(
f
, 
¡r
è
	`dbg_´št
(
DT_CHR
, f, (*)¡r, 0, 1)

	)

509 
	#PR_STRT
(
å
è

	)

510 
	#PR_END
(
å
è
	`årštf
(å, "\n"è

	)

511 #ifdeà
MDY_DATE


512 
	#PR_DATE
(
tgt
, 
yr
, 
mn
, 
dy
) \

513 
	`¥rštf
(
tgt
, "%02ld-%02ld-19%02ld", 
mn
, 
dy
, 
yr
)

	)

515 
	#PR_DATE
(
tgt
, 
yr
, 
mn
, 
dy
) \

516 
	`¥rštf
(
tgt
, "19%02ld-%02ld-%02ld", 
yr
, 
mn
, 
dy
)

	)

522 
	#VRF_STR
(
t
, 
d
è{*
xx
 = d; *xxè
tdefs
[t].
vtÙ®
 +ğ*xx++;}

	)

523 
	#VRF_INT
(
t
,
d
è
tdefs
[t].
vtÙ®
 +ğ
	)
d

524 
	#VRF_HUGE
(
t
,
d
è
tdefs
[t].
vtÙ®
 = *((*)&dè+ *((*)(&d + 1))

	)

526 
	#VRF_MONEY
(
t
,
d
è
tdefs
[t].
vtÙ®
 = *((*)&dè+ *((*)(&d + 1))

	)

527 
	#VRF_CHR
(
t
,
d
è
tdefs
[t].
vtÙ®
 +ğ
	)
d

528 
	#VRF_STRT
(
t
)

	)

529 
	#VRF_END
(
t
)

	)

532 
	#UNIFORM
 0

	)

537 
	#P_MFG_SD
 0

	)

538 
	#P_BRND_SD
 1

	)

539 
	#P_TYPE_SD
 2

	)

540 
	#P_SIZE_SD
 3

	)

541 
	#P_CNTR_SD
 4

	)

542 
	#P_RCST_SD
 5

	)

543 
	#PS_QTY_SD
 7

	)

544 
	#PS_SCST_SD
 8

	)

545 
	#O_SUPP_SD
 10

	)

546 
	#O_CLRK_SD
 11

	)

547 
	#O_ODATE_SD
 13

	)

548 
	#L_QTY_SD
 14

	)

549 
	#L_DCNT_SD
 15

	)

550 
	#L_TAX_SD
 16

	)

551 
	#L_SHIP_SD
 17

	)

552 
	#L_SMODE_SD
 18

	)

553 
	#L_PKEY_SD
 19

	)

554 
	#L_SKEY_SD
 20

	)

555 
	#L_SDTE_SD
 21

	)

556 
	#L_CDTE_SD
 22

	)

557 
	#L_RDTE_SD
 23

	)

558 
	#L_RFLG_SD
 24

	)

559 
	#C_NTRG_SD
 27

	)

560 
	#C_PHNE_SD
 28

	)

561 
	#C_ABAL_SD
 29

	)

562 
	#C_MSEG_SD
 30

	)

563 
	#S_NTRG_SD
 33

	)

564 
	#S_PHNE_SD
 34

	)

565 
	#S_ABAL_SD
 35

	)

566 
	#P_NAME_SD
 37

	)

567 
	#O_PRIO_SD
 38

	)

568 
	#HVAR_SD
 39

	)

569 
	#O_CKEY_SD
 40

	)

570 
	#N_CMNT_SD
 41

	)

571 
	#R_CMNT_SD
 42

	)

572 
	#O_LCNT_SD
 43

	)

573 
	#BBB_JNK_SD
 44

	)

574 
	#BBB_TYPE_SD
 45

	)

575 
	#BBB_CMNT_SD
 46

	)

576 
	#BBB_OFFSET_SD
 47

	)

579 
EXIT_NAMESPACE
(
dbg’ch
);

	@include/workload/tpch/dbgen/dsstypes.h

39 #iâdeà
DBGEN_TPCH_DSSTYPES_H


40 
	#DBGEN_TPCH_DSSTYPES_H


	)

42 
	~"ut/Çme¥aû.h
"

44 
ENTER_NAMESPACE
(
dbg’ch
);

51 
DSS_HUGE
 
	mcu¡key
;

52 
	mÇme
[
C_NAME_LEN
 + 3];

53 
	madd»ss
[
C_ADDR_MAX
 + 1];

54 
	m®’
;

55 
DSS_HUGE
 
	mÇtiÚ_code
;

56 
	mphÚe
[
PHONE_LEN
 + 1];

57 
DSS_HUGE
 
	macùb®
;

58 
	mmkt£gm’t
[
MAXAGG_LEN
 + 1];

59 
	mcomm’t
[
C_CMNT_MAX
 + 1];

60 
	mş’
;

61 } 
	tcu¡om”_t
;

64 
mk_cu¡
 
PROTO
((
DSS_HUGE
 
n_cu¡
, 
cu¡om”_t
 * 
c
));

65 
´_cu¡
 
PROTO
((* 
c
, 
mode
));

66 
ld_cu¡
 
PROTO
((* 
c
, 
mode
));

70 
DSS_HUGE
 
	mokey
;

71 
DSS_HUGE
 
	m·¹key
;

72 
DSS_HUGE
 
	msuµkey
;

73 
DSS_HUGE
 
	mlút
;

74 
DSS_HUGE
 
	mquªt™y
;

75 
DSS_HUGE
 
	m•riû
;

76 
DSS_HUGE
 
	mdiscouÁ
;

77 
DSS_HUGE
 
	mx
;

78 
	mræag
;

79 
	ml¡©us
;

80 
	mcd©e
[
DATE_LEN
];

81 
	msd©e
[
DATE_LEN
];

82 
	mrd©e
[
DATE_LEN
];

83 
	mshš¡ruù
[
MAXAGG_LEN
 + 1];

84 
	mshmode
[
MAXAGG_LEN
 + 1];

85 
	mcomm’t
[
L_CMNT_MAX
 + 1];

86 
	mş’
;

87 } 
	tlše_t
;

91 
DSS_HUGE
 
	mokey
;

92 
DSS_HUGE
 
	mcu¡key
;

93 
	mÜd”¡©us
;

94 
DSS_HUGE
 
	mtÙ®´iû
;

95 
	mod©e
[
DATE_LEN
];

96 
	mİriÜ™y
[
MAXAGG_LEN
 + 1];

97 
	mş”k
[
O_CLRK_LEN
 + 1];

98 
	m¥riÜ™y
;

99 
DSS_HUGE
 
	mlšes
;

100 
	mcomm’t
[
O_CMNT_MAX
 + 1];

101 
	mş’
;

102 
lše_t
 
	ml
[
O_LCNT_MAX
];

103 } 
	tÜd”_t
;

106 
mk_Üd”
 
PROTO
((
DSS_HUGE
 
šdex
, 
Üd”_t
 * 
o
, 
upd_num
));

107 
´_Üd”
 
PROTO
((* 
o
, 
mode
));

108 
ld_Üd”
 
PROTO
((* 
o
, 
mode
));

109 
mk_¥¬£
 
PROTO
((
DSS_HUGE
 
šdex
, DSS_HUGE *
ok
, 
£q
));

113 
DSS_HUGE
 
	m·¹key
;

114 
DSS_HUGE
 
	msuµkey
;

115 
DSS_HUGE
 
	mqty
;

116 
DSS_HUGE
 
	msco¡
;

117 
	mcomm’t
[
PS_CMNT_MAX
 + 1];

118 
	mş’
;

119 } 
	t·¹suµ_t
;

123 
DSS_HUGE
 
	m·¹key
;

124 
	mÇme
[
P_NAME_LEN
 + 1];

125 
	mÆ’
;

126 
	mmfgr
[
P_MFG_LEN
 + 1];

127 
	mb¿nd
[
P_BRND_LEN
 + 1];

128 
	mty³
[
P_TYPE_LEN
 + 1];

129 
	m’
;

130 
DSS_HUGE
 
	msize
;

131 
	mcÚš”
[
P_CNTR_LEN
 + 1];

132 
DSS_HUGE
 
	m»´iû
;

133 
	mcomm’t
[
P_CMNT_MAX
 + 1];

134 
	mş’
;

135 
·¹suµ_t
 
	ms
[
SUPP_PER_PART
];

136 } 
	t·¹_t
;

139 
mk_·¹
 
PROTO
((
DSS_HUGE
 
šdex
, 
·¹_t
 * 
p
));

140 
´_·¹
 
PROTO
((* 
·¹
, 
mode
));

141 
ld_·¹
 
PROTO
((* 
·¹
, 
mode
));

145 
DSS_HUGE
 
	msuµkey
;

146 
	mÇme
[
S_NAME_LEN
 + 1];

147 
	madd»ss
[
S_ADDR_MAX
 + 1];

148 
	m®’
;

149 
DSS_HUGE
 
	mÇtiÚ_code
;

150 
	mphÚe
[
PHONE_LEN
 + 1];

151 
DSS_HUGE
 
	macùb®
;

152 
	mcomm’t
[
S_CMNT_MAX
 + 1];

153 
	mş’
;

154 } 
	tsuµl›r_t
;

157 
mk_suµ
 
PROTO
((
DSS_HUGE
 
šdex
, 
suµl›r_t
 * 
s
));

158 
´_suµ
 
PROTO
((* 
suµ
, 
mode
));

159 
ld_suµ
 
PROTO
((* 
suµ
, 
mode
));

163 
DSS_HUGE
 
	mtimekey
;

164 
	m®pha
[
DATE_LEN
];

165 
	my—r
;

166 
	mmÚth
;

167 
	mw“k
;

168 
	mday
;

169 } 
	tdss_time_t
;

172 
mk_time
 
PROTO
((
DSS_HUGE
 
h
, 
dss_time_t
 * 
t
));

179 
DSS_HUGE
 
	mcode
;

180 *
	m‹xt
;

181 
	mjoš
;

182 
	mcomm’t
[
N_CMNT_MAX
 + 1];

183 
	mş’
;

184 } 
	tcode_t
;

187 
mk_ÇtiÚ
 
PROTO
((
DSS_HUGE
 
i
, 
code_t
 * 
c
));

188 
´_ÇtiÚ
 
PROTO
((* 
c
, 
mode
));

189 
ld_ÇtiÚ
 
PROTO
((* 
c
, 
mode
));

190 
mk_»giÚ
 
PROTO
((
DSS_HUGE
 
i
, 
code_t
 * 
c
));

191 
´_»giÚ
 
PROTO
((* 
c
, 
mode
));

192 
ld_»giÚ
 
PROTO
((* 
c
, 
mode
));

195 
EXIT_NAMESPACE
(
dbg’ch
);

	@include/workload/tpch/dbgen/permute.h

22 #iâdeà
DBGEN_TPCH_PERMUTE_H


23 
	#DBGEN_TPCH_PERMUTE_H


	)

25 
	~"ut/Çme¥aû.h
"

27 
ENTER_NAMESPACE
(
dbg’ch
);

30 
	g³rmutiÚ
[41][22] =

76 
EXIT_NAMESPACE
(
dbg’ch
);

	@include/workload/tpch/dbgen/release.h

4 
	#DBGENVERSION
 2

	)

5 
	#RELEASE
 8

	)

6 
	#PATCH
 0

	)

7 
	#BUILD
 10

	)

	@include/workload/tpch/dbgen/rnd.h

40 #iâdeà
DBGEN_TPCH_RND_H


41 
	#DBGEN_TPCH_RND_H


	)

43 
	~"ut/Çme¥aû.h
"

45 
ENTER_NAMESPACE
(
dbg’ch
);

49 
DSS_HUGE
 
NextRªd
 
PROTO
((DSS_HUGE));

50 
DSS_HUGE
 
UnifIÁ
 
PROTO
((DSS_HUGE, DSS_HUGE, ));

52 
nA
;

53 
nM
;

54 
nQ
;

55 
nR
;

57 
	gdM
 = 2147483647.0;

67 
	#VSTR_MAX
(
Ën
è()Ö’ / 5 + (ËÀ% 5 =ğ0)?0:1 + 1)

	)

68 
£ed_t
 
	gS“d
[
MAX_STREAM
 + 1] =

70 {
PART
, 1, 0, 1},

71 {
PART
, 46831694, 0, 1},

72 {
PART
, 1841581359, 0, 1},

73 {
PART
, 1193163244, 0, 1},

74 {
PART
, 727633698, 0, 1},

75 {
NONE
, 933588178, 0, 1},

76 {
PART
, 804159733, 0, 2},

77 {
PSUPP
, 1671059989, 0, 
SUPP_PER_PART
},

78 {
PSUPP
, 1051288424, 0, 
SUPP_PER_PART
},

79 {
PSUPP
, 1961692154, 0, 
SUPP_PER_PART
 * 2},

80 {
ORDER
, 1227283347, 0, 1},

81 {
ORDER
, 1171034773, 0, 1},

82 {
ORDER
, 276090261, 0, 2},

83 {
ORDER
, 1066728069, 0, 1},

84 {
LINE
, 209208115, 0, 
O_LCNT_MAX
},

85 {
LINE
, 554590007, 0, 
O_LCNT_MAX
},

86 {
LINE
, 721958466, 0, 
O_LCNT_MAX
},

87 {
LINE
, 1371272478, 0, 
O_LCNT_MAX
},

88 {
LINE
, 675466456, 0, 
O_LCNT_MAX
},

89 {
LINE
, 1808217256, 0, 
O_LCNT_MAX
},

90 {
LINE
, 2095021727, 0, 
O_LCNT_MAX
},

91 {
LINE
, 1769349045, 0, 
O_LCNT_MAX
},

92 {
LINE
, 904914315, 0, 
O_LCNT_MAX
},

93 {
LINE
, 373135028, 0, 
O_LCNT_MAX
},

94 {
LINE
, 717419739, 0, 
O_LCNT_MAX
},

95 {
LINE
, 1095462486, 0, 
O_LCNT_MAX
 * 2},

96 {
CUST
, 881155353, 0, 9},

97 {
CUST
, 1489529863, 0, 1},

98 {
CUST
, 1521138112, 0, 3},

99 {
CUST
, 298370230, 0, 1},

100 {
CUST
, 1140279430, 0, 1},

101 {
CUST
, 1335826707, 0, 2},

102 {
SUPP
, 706178559, 0, 9},

103 {
SUPP
, 110356601, 0, 1},

104 {
SUPP
, 884434366, 0, 3},

105 {
SUPP
, 962338209, 0, 1},

106 {
SUPP
, 1341315363, 0, 2},

107 {
PART
, 709314158, 0, 92},

108 {
ORDER
, 591449447, 0, 1},

109 {
LINE
, 431918286, 0, 1},

110 {
ORDER
, 851767375, 0, 1},

111 {
NATION
, 606179079, 0, 2},

112 {
REGION
, 1500869201, 0, 2},

113 {
ORDER
, 1434868289, 0, 1},

114 {
SUPP
, 263032577, 0, 1},

115 {
SUPP
, 753643799, 0, 1},

116 {
SUPP
, 202794285, 0, 1},

117 {
SUPP
, 715851524, 0, 1}

121 
EXIT_NAMESPACE
(
dbg’ch
);

	@include/workload/tpch/dbgen/rng64.h

22 #iâdeà
DBGEN_TPCH_RNG64_H


23 
	#DBGEN_TPCH_RNG64_H


	)

25 
	~"ut/Çme¥aû.h
"

27 
ENTER_NAMESPACE
(
dbg’ch
);

30 
DSS_HUGE
 
AdvªûRªd64
ĞDSS_HUGE 
nS“d
, DSS_HUGE 
nCouÁ
);

31 
dss_¿ndom64
(
DSS_HUGE
 *
tgt
, DSS_HUGE 
nLow
, DSS_HUGE 
nHigh
, 
¡»am
);

32 
DSS_HUGE
 
NextRªd64
(DSS_HUGE 
nS“d
);

35 
EXIT_NAMESPACE
(
dbg’ch
);

	@include/workload/tpch/dbgen/shared.h

22 #iâdeà
DBGEN_TPCH_SHARED_H


23 
	#DBGEN_TPCH_SHARED_H


	)

25 
	~"ut/Çme¥aû.h
"

27 
ENTER_NAMESPACE
(
dbg’ch
);

30 
	#N_CMNT_LEN
 72

	)

31 
	#N_CMNT_MAX
 152

	)

32 
	#R_CMNT_LEN
 72

	)

33 
	#R_CMNT_MAX
 152

	)

34 
	#MONEY_SCL
 0.01

	)

35 
	#V_STR_HGH
 1.6

	)

36 
	#P_NAME_LEN
 55

	)

37 
	#P_MFG_LEN
 25

	)

38 
	#P_BRND_LEN
 10

	)

39 
	#P_TYPE_LEN
 25

	)

40 
	#P_CNTR_LEN
 10

	)

41 
	#P_CMNT_LEN
 14

	)

42 
	#P_CMNT_MAX
 23

	)

43 
	#S_NAME_LEN
 25

	)

44 
	#S_ADDR_LEN
 25

	)

45 
	#S_ADDR_MAX
 40

	)

46 
	#S_CMNT_LEN
 63

	)

47 
	#S_CMNT_MAX
 101

	)

48 
	#PS_CMNT_LEN
 124

	)

49 
	#PS_CMNT_MAX
 199

	)

50 
	#C_NAME_LEN
 18

	)

51 
	#C_ADDR_LEN
 25

	)

52 
	#C_ADDR_MAX
 40

	)

53 
	#C_MSEG_LEN
 10

	)

54 
	#C_CMNT_LEN
 73

	)

55 
	#C_CMNT_MAX
 117

	)

56 
	#O_OPRIO_LEN
 15

	)

57 
	#O_CLRK_LEN
 15

	)

58 
	#O_CMNT_LEN
 49

	)

59 
	#O_CMNT_MAX
 79

	)

60 
	#L_CMNT_LEN
 27

	)

61 
	#L_CMNT_MAX
 44

	)

62 
	#L_INST_LEN
 25

	)

63 
	#L_SMODE_LEN
 10

	)

64 
	#T_ALPHA_LEN
 10

	)

65 
	#DATE_LEN
 13

	)

66 
	#NATION_LEN
 25

	)

67 
	#REGION_LEN
 25

	)

68 
	#PHONE_LEN
 15

	)

69 
	#MAXAGG_LEN
 20

	)

70 
	#P_CMNT_SD
 6

	)

71 
	#PS_CMNT_SD
 9

	)

72 
	#O_CMNT_SD
 12

	)

73 
	#C_ADDR_SD
 26

	)

74 
	#C_CMNT_SD
 31

	)

75 
	#S_ADDR_SD
 32

	)

76 
	#S_CMNT_SD
 36

	)

77 
	#L_CMNT_SD
 25

	)

80 
EXIT_NAMESPACE
(
dbg’ch
);

	@include/workload/tpch/dbgen/tpcd.h

28 #iâdeà
DBGEN_TPCH_TPCD_H


29 
	#DBGEN_TPCH_TPCD_H


	)

31 
	~"ut/Çme¥aû.h
"

33 
ENTER_NAMESPACE
(
dbg’ch
);

36 
	#DFLT
 0x0001

	)

37 
	#OUTPUT
 0x0002

	)

38 
	#EXPLAIN
 0x0004

	)

39 
	#DBASE
 0x0008

	)

40 
	#VERBOSE
 0x0010

	)

41 
	#TIMING
 0x0020

	)

42 
	#LOG
 0x0040

	)

43 
	#QUERY
 0x0080

	)

44 
	#REFRESH
 0x0100

	)

45 
	#ANSI
 0x0200

	)

46 
	#SEED
 0x0400

	)

47 
	#COMMENT
 0x0800

	)

48 
	#INIT
 0x1000

	)

49 
	#TERMINATE
 0x2000

	)

50 
	#DFLT_NUM
 0x4000

	)

55 
	#VTAG
 ':'

	)

56 
	#oå
 
¡dout


	)

57 
	#QDIR_TAG
 "DSS_QUERY"

	)

58 
	#QDIR_DFLT
 "."

	)

63 #ifdeà
DB2


64 
	#GEN_QUERY_PLAN
 "SET CURRENT EXPLAIN SNAPSHOT ON;"

	)

65 
	#START_TRAN
 ""

	)

66 
	#END_TRAN
 "COMMIT WORK;"

	)

67 
	#SET_OUTPUT
 ""

	)

68 
	#SET_ROWCOUNT
 "--#SET ROWS_FETCH %d\n"

	)

69 
	#SET_DBASE
 "CONNECT TO % ;\n"

	)

72 #ifdeà
INFORMIX


73 
	#GEN_QUERY_PLAN
 "SET EXPLAIN ON;"

	)

74 
	#START_TRAN
 "BEGIN WORK;"

	)

75 
	#END_TRAN
 "COMMIT WORK;"

	)

76 
	#SET_OUTPUT
 "OUTPUT TO "

	)

77 
	#SET_ROWCOUNT
 "FIRST %d"

	)

78 
	#SET_DBASE
 "d©aba£ % ;\n"

	)

81 #ifdeà 
SQLSERVER


82 
	#GEN_QUERY_PLAN
 "£ˆshow¶ª on\n£ˆnÛxeøÚ\ngo\n"

	)

83 
	#START_TRAN
 "begš¿n§ùiÚ\ngo\n"

	)

84 
	#END_TRAN
 "comm™¿n§ùiÚ\ngo\n"

	)

85 
	#SET_OUTPUT
 ""

	)

86 
	#SET_ROWCOUNT
 "£ˆrowcouÁ %d\ngo\n\n"

	)

87 
	#SET_DBASE
 "u£ %s\ngo\n"

	)

90 #ifdeà 
SYBASE


91 
	#GEN_QUERY_PLAN
 "£ˆshow¶ª on\n£ˆnÛxeøÚ\ngo\n"

	)

92 
	#START_TRAN
 "begš¿n§ùiÚ\ngo\n"

	)

93 
	#END_TRAN
 "comm™¿n§ùiÚ\ngo\n"

	)

94 
	#SET_OUTPUT
 ""

	)

95 
	#SET_ROWCOUNT
 "£ˆrowcouÁ %d\ngo\n\n"

	)

96 
	#SET_DBASE
 "u£ %s\ngo\n"

	)

99 #ifdeà
TDAT


100 
	#GEN_QUERY_PLAN
 "EXPLAIN"

	)

101 
	#START_TRAN
 "BEGIN TRANSACTION"

	)

102 
	#END_TRAN
 "END TRANSACTION"

	)

103 
	#SET_OUTPUT
 ".SET FORMAT OFF\n.EXPORT REPORT fe="

	)

104 
	#SET_ROWCOUNT
 ".SET RETCANCEL ON\n.SET RETLIMIT %d\n"

	)

105 
	#SET_DBASE
 ".LOGON %s\n"

	)

108 
	#MAX_VARS
 8

	)

109 
	#QLEN_MAX
 2048

	)

110 
	#QUERIES_PER_SET
 22

	)

111 
	#MAX_PIDS
 50

	)

113 
EXTERN
 
	gæags
;

114 
EXTERN
 
	gs_út
;

115 
EXTERN
 *
	gosuff
;

116 
EXTERN
 
	g¡»am
;

117 
EXTERN
 *
	glfe
;

118 
EXTERN
 *
	gife
;

119 
EXTERN
 *
	gtfe
;

121 
	#MAX_PERMUTE
 41

	)

122 #ifdeà
DECLARER


123 
	growút_dæt
[
QUERIES_PER_SET
 + 1] =

125 
	growút
;

126 
	#SEQUENCE
(
¡»am
, 
qu”y
è
³rmutiÚ
[¡»am % 
MAX_PERMUTE
][qu”y - 1]

	)

128 
rowút_dæt
[];

129 
rowút
;

133 
EXIT_NAMESPACE
(
dbg’ch
);

	@include/workload/tpch/shore_tpch_client.h

31 #iâdeà
__SHORE_TPCH_CLIENT_H


32 
	#__SHORE_TPCH_CLIENT_H


	)

34 
	~"sm/shÜe/shÜe_ş›Á.h
"

36 
	~"wÜklßd/ch/ch_cÚ¡.h
"

37 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

40 
ENTER_NAMESPACE
(
ch
);

42 
usšg
 
Çme¥aû
 
	gshÜe
;

53 şas 
	cba£lše_ch_ş›Á_t
 : 
public
 
ba£_ş›Á_t


55 
´iv©e
:

56 
_£lid
;

57 
Œx_wÜk”_t
* 
	m_wÜk”
;

58 
	m_qf
;

60 
	mpublic
:

62 
	$ba£lše_ch_ş›Á_t
() { }

64 
	`ba£lše_ch_ş›Á_t
(
c_¡r
 
Šame
, cÚ¡ 
id
, 
ShÜeTPCHEnv
* 
’v
,

65 cÚ¡ 
M—su»m’tTy³
 
aTy³
, cÚ¡ 
Œxid
,

66 cÚ¡ 
numOfTrxs
,

67 
´oûssÜid_t
 
­rsid
, cÚ¡ 
£lID
, cÚ¡ 
qf
);

69 ~
	$ba£lše_ch_ş›Á_t
(è{ 
	}
}

72 
lßd_sup_xù
(
m­SupTrxs
& 
m­
);

76 
w_rc_t
 
subm™_Úe
(
xù_ty³
, 
xùid
);

81 
EXIT_NAMESPACE
(
ch
);

	@include/workload/tpch/shore_tpch_env.h

32 #iâdeà
__SHORE_TPCH_ENV_H


33 
	#__SHORE_TPCH_ENV_H


	)

35 
	~"sm_vas.h
"

36 
	~"ut.h
"

38 
	~"sm/shÜe/shÜe_’v.h
"

39 
	~"sm/shÜe/shÜe_asc_sÜt_buf.h
"

40 
	~"sm/shÜe/shÜe_Œx_wÜk”.h
"

42 
	~"wÜklßd/ch/ch_cÚ¡.h
"

44 
	~"wÜklßd/ch/shÜe_ch_schema_mª.h
"

45 
	~"wÜklßd/ch/ch_šput.h
"

47 #ifdeà
CFG_QPIPE


48 
	~"qpe.h
"

51 
	~<m­
>

53 
usšg
 
Çme¥aû
 
	gshÜe
;

56 
ENTER_NAMESPACE
(
ch
);

59 
usšg
 
	g¡d
::
m­
;

66 cÚ¡ 
	gTPCH_SCALING_FACTOR
 = 1;

70 cÚ¡ 
	gCUST_POP_UNIT
 = 10;

71 cÚ¡ 
	gPART_POP_UNIT
 = 10;

81 şas 
	crow_d©a_t


83 
	mpublic
:

84 
veùÜ
<
bË_row_t
 *> 
rows
;

95 
	sShÜeTPCHTrxCouÁ


97 
ušt
 
	mq1
;

98 
ušt
 
	mq2
;

99 
ušt
 
	mq3
;

100 
ušt
 
	mq4
;

101 
ušt
 
	mq5
;

102 
ušt
 
	mq6
;

103 
ušt
 
	mq7
;

104 
ušt
 
	mq8
;

105 
ušt
 
	mq9
;

106 
ušt
 
	mq10
;

107 
ušt
 
	mq11
;

108 
ušt
 
	mq12
;

109 
ušt
 
	mq13
;

110 
ušt
 
	mq14
;

111 
ušt
 
	mq15
;

112 
ušt
 
	mq16
;

113 
ušt
 
	mq17
;

114 
ušt
 
	mq18
;

115 
ušt
 
	mq19
;

116 
ušt
 
	mq20
;

117 
ušt
 
	mq21
;

118 
ušt
 
	mq22
;

119 
ušt
 
	mqlše™em
;

120 
ušt
 
	mqÇtiÚ
;

121 
ušt
 
	mq»giÚ
;

122 
ušt
 
	mqÜd”s
;

123 
ušt
 
	mq·¹
;

124 
ušt
 
	mq·¹suµ
;

125 
ušt
 
	mqsuµl›r
;

126 
ušt
 
	mqcu¡om”
;

128 
ušt
 
	mqNP
;

131 
	mShÜeTPCHTrxCouÁ
& 
	mİ”©Ü
+=(
ShÜeTPCHTrxCouÁ
 cÚ¡& 
rhs
) {

132 
q1
 +ğ
rhs
.q1;

133 
	mq2
 +ğ
rhs
.
q2
;

134 
	mq3
 +ğ
rhs
.
q3
;

135 
	mq4
 +ğ
rhs
.
q4
;

136 
	mq5
 +ğ
rhs
.
q5
;

137 
	mq6
 +ğ
rhs
.
q6
;

138 
	mq7
 +ğ
rhs
.
q7
;

139 
	mq8
 +ğ
rhs
.
q8
;

140 
	mq9
 +ğ
rhs
.
q9
;

141 
	mq10
 +ğ
rhs
.
q10
;

142 
	mq11
 +ğ
rhs
.
q11
;

143 
	mq12
 +ğ
rhs
.
q12
;

144 
	mq13
 +ğ
rhs
.
q13
;

145 
	mq14
 +ğ
rhs
.
q14
;

146 
	mq15
 +ğ
rhs
.
q15
;

147 
	mq16
 +ğ
rhs
.
q16
;

148 
	mq17
 +ğ
rhs
.
q17
;

149 
	mq18
 +ğ
rhs
.
q18
;

150 
	mq19
 +ğ
rhs
.
q19
;

151 
	mq20
 +ğ
rhs
.
q20
;

152 
	mq21
 +ğ
rhs
.
q21
;

153 
	mq22
 +ğ
rhs
.
q22
;

154 
	mqlše™em
 +ğ
rhs
.
qlše™em
;

155 
	mqÇtiÚ
 +ğ
rhs
.
qÇtiÚ
;

156 
	mq»giÚ
 +ğ
rhs
.
q»giÚ
;

157 
	mqÜd”s
 +ğ
rhs
.
qÜd”s
;

158 
	mq·¹
 +ğ
rhs
.
q·¹
;

159 
	mq·¹suµ
 +ğ
rhs
.
q·¹suµ
;

160 
	mqsuµl›r
 +ğ
rhs
.
qsuµl›r
;

161 
	mqcu¡om”
 +ğ
rhs
.
qcu¡om”
;

163 
	mqNP
 +ğ
rhs
.
qNP
;

165  (*
	mthis
);

168 
	mShÜeTPCHTrxCouÁ
& 
	mİ”©Ü
-=(
ShÜeTPCHTrxCouÁ
 cÚ¡& 
rhs
) {

169 
q1
 -ğ
rhs
.q1;

170 
	mq2
 -ğ
rhs
.
q2
;

171 
	mq3
 -ğ
rhs
.
q3
;

172 
	mq4
 -ğ
rhs
.
q4
;

173 
	mq5
 -ğ
rhs
.
q5
;

174 
	mq6
 -ğ
rhs
.
q6
;

175 
	mq7
 -ğ
rhs
.
q7
;

176 
	mq8
 -ğ
rhs
.
q8
;

177 
	mq9
 -ğ
rhs
.
q9
;

178 
	mq10
 -ğ
rhs
.
q10
;

179 
	mq11
 -ğ
rhs
.
q11
;

180 
	mq12
 -ğ
rhs
.
q12
;

181 
	mq13
 -ğ
rhs
.
q13
;

182 
	mq14
 -ğ
rhs
.
q14
;

183 
	mq15
 -ğ
rhs
.
q15
;

184 
	mq16
 -ğ
rhs
.
q16
;

185 
	mq17
 -ğ
rhs
.
q17
;

186 
	mq18
 -ğ
rhs
.
q18
;

187 
	mq19
 -ğ
rhs
.
q19
;

188 
	mq20
 -ğ
rhs
.
q20
;

189 
	mq21
 -ğ
rhs
.
q21
;

190 
	mq22
 -ğ
rhs
.
q22
;

191 
	mqlše™em
 -ğ
rhs
.
qlše™em
;

192 
	mqÇtiÚ
 -ğ
rhs
.
qÇtiÚ
;

193 
	mq»giÚ
 -ğ
rhs
.
q»giÚ
;

194 
	mqÜd”s
 -ğ
rhs
.
qÜd”s
;

195 
	mq·¹
 -ğ
rhs
.
q·¹
;

196 
	mq·¹suµ
 -ğ
rhs
.
q·¹suµ
;

197 
	mqsuµl›r
 -ğ
rhs
.
qsuµl›r
;

198 
	mqcu¡om”
 -ğ
rhs
.
qcu¡om”
;

200 
	mqNP
 -ğ
rhs
.
qNP
;

202  (*
	mthis
);

205 
ušt
 
tÙ®
() const {

206  (
	mq1
+
	mq2
+
	mq3
+
	mq4
+
	mq5
+
	mq6
+
	mq7
+
	mq8
+
	mq9
+
	mq10
+

207 
	mq11
+
	mq12
+
	mq13
+
	mq14
+
	mq15
+
	mq16
+
	mq17
+
	mq18
+
	mq19
+
	mq20
+

208 
	mq21
+
	mq22
+
	mqlše™em
+
	mqÇtiÚ
+
	mq»giÚ
+
	mqÜd”s
+
	mq·¹
+
	mq·¹suµ
+
	mqsuµl›r
+
	mqcu¡om”
+

209 
	mqNP
);

215 
	sShÜeTPCHTrxSts


217 
ShÜeTPCHTrxCouÁ
 
	m©‹m±ed
;

218 
ShÜeTPCHTrxCouÁ
 
	mçed
;

219 
ShÜeTPCHTrxCouÁ
 
	md—dlocked
;

221 
	mShÜeTPCHTrxSts
& 
	mİ”©Ü
+=(
ShÜeTPCHTrxSts
 cÚ¡& 
Ùh”
) {

222 
©‹m±ed
 +ğ
Ùh”
.attempted;

223 
	mçed
 +ğ
Ùh”
.
çed
;

224 
	md—dlocked
 +ğ
Ùh”
.
d—dlocked
;

225  (*
	mthis
);

228 
	mShÜeTPCHTrxSts
& 
	mİ”©Ü
-=(
ShÜeTPCHTrxSts
 cÚ¡& 
Ùh”
) {

229 
©‹m±ed
 -ğ
Ùh”
.attempted;

230 
	mçed
 -ğ
Ùh”
.
çed
;

231 
	md—dlocked
 -ğ
Ùh”
.
d—dlocked
;

232  (*
	mthis
);

246 şas 
	cShÜeTPCHEnv
 : 
public
 
ShÜeEnv


248 
public
:

249 
¡d
::
	tm­
<
	t±h»ad_t
, 
	tShÜeTPCHTrxSts
*> 
	t¡©m­_t
;

251 
şass
 
	mbË_bud”_t
;

252 
şass
 
	mbË_ü—tÜ_t
;

253 
	mcheckpoš‹r_t
;

255 
	m´iv©e
:

257 
w_rc_t
 
_po¡_š™_im¶
();

260 
w_rc_t
 
_g’_Úe_ÇtiÚ
(cÚ¡ 
id
, 
»p_row_t
& 
¬•row
);

261 
w_rc_t
 
_g’_Úe_»giÚ
(cÚ¡ 
id
, 
»p_row_t
& 
¬•row
);

262 
w_rc_t
 
_g’_Úe_suµl›r
(cÚ¡ 
id
, 
»p_row_t
& 
¬•row
);

263 
w_rc_t
 
_g’_Úe_·¹_ba£d
(cÚ¡ 
id
, 
»p_row_t
& 
¬•row
);

264 
w_rc_t
 
_g’_Úe_cu¡_ba£d
(cÚ¡ 
id
, 
»p_row_t
& 
¬•row
);

266 
	mpublic
:

267 
ShÜeTPCHEnv
();

268 
	mvœtu®
 ~
ShÜeTPCHEnv
();

272 
vœtu®
 
	$£t
(
’vV¬M­
* ) { (0); };

273 
vœtu®
 
	$İ’
(è{ (0); 
	}
};

274 
vœtu®
 
	$·u£
(è{ (0); 
	}
};

275 
vœtu®
 
	$»sume
(è{ (0); 
	}
};

276 
vœtu®
 
w_rc_t
 
	$Ãwrun
(è{ (
RCOK
); 
	}
};

278 
vœtu®
 
po¡_š™
();

279 
vœtu®
 
w_rc_t
 
lßd_schema
();

281 
vœtu®
 
w_rc_t
 
lßd_ªd_»gi¡”_fids
();

283 
vœtu®
 
cÚf
();

284 
vœtu®
 
¡¬t
();

285 
vœtu®
 
¡İ
();

286 
vœtu®
 
	$šfo
() const;

287 
vœtu®
 
	`¡©i¡ics
();

289 
w_rc_t
 
	`w¬mup
();

290 
w_rc_t
 
	`check_cÚsi¡’cy
();

292 
	`dump
();

294 
vœtu®
 
	`´št_throughput
(cÚ¡ 
iQu”›dSF
,

295 cÚ¡ 
iS´—d
,

296 cÚ¡ 
iNumOfTh»ads
,

297 cÚ¡ 
d–ay
,

298 cÚ¡ 
ulÚg_t
 
mioch
,

299 cÚ¡ 
avgıuu§ge
);

304 
w_rc_t
 
	`lßdd©a
();

307 
	`DECLARE_TABLE
(
ÇtiÚ_t
,
ÇtiÚ_mª_im¶
,
ÇtiÚ
);

308 
	`DECLARE_TABLE
(
»giÚ_t
,
»giÚ_mª_im¶
,
»giÚ
);

309 
	`DECLARE_TABLE
(
·¹_t
,
·¹_mª_im¶
,
·¹
);

310 
	`DECLARE_TABLE
(
suµl›r_t
,
suµl›r_mª_im¶
,
suµl›r
);

311 
	`DECLARE_TABLE
(
·¹suµ_t
,
·¹suµ_mª_im¶
,
·¹suµ
);

312 
	`DECLARE_TABLE
(
cu¡om”_t
,
cu¡om”_mª_im¶
,
cu¡om”
);

313 
	`DECLARE_TABLE
(
Üd”s_t
,
Üd”s_mª_im¶
,
Üd”s
);

314 
	`DECLARE_TABLE
(
lše™em_t
,
lše™em_mª_im¶
,
lše™em
);

319 
w_rc_t
 
	`run_Úe_xù
(
Reque¡
* 
´eque¡
);

322 
	`DECLARE_TRX
(
q1
);

323 
	`DECLARE_TRX
(
q2
);

324 
	`DECLARE_TRX
(
q3
);

325 
	`DECLARE_TRX
(
q4
);

326 
	`DECLARE_TRX
(
q5
);

327 
	`DECLARE_TRX
(
q6
);

328 
	`DECLARE_TRX
(
q7
);

329 
	`DECLARE_TRX
(
q8
);

330 
	`DECLARE_TRX
(
q9
);

331 
	`DECLARE_TRX
(
q10
);

332 
	`DECLARE_TRX
(
q11
);

333 
	`DECLARE_TRX
(
q12
);

334 
	`DECLARE_TRX
(
q13
);

335 
	`DECLARE_TRX
(
q14
);

336 
	`DECLARE_TRX
(
q15
);

337 
	`DECLARE_TRX
(
q16
);

338 
	`DECLARE_TRX
(
q17
);

339 
	`DECLARE_TRX
(
q18
);

340 
	`DECLARE_TRX
(
q19
);

341 
	`DECLARE_TRX
(
q20
);

342 
	`DECLARE_TRX
(
q21
);

343 
	`DECLARE_TRX
(
q22
);

344 
	`DECLARE_TRX
(
qlše™em
);

345 
	`DECLARE_TRX
(
qÜd”s
);

346 
	`DECLARE_TRX
(
qÇtiÚ
);

347 
	`DECLARE_TRX
(
q»giÚ
);

348 
	`DECLARE_TRX
(
q·¹
);

349 
	`DECLARE_TRX
(
qsuµl›r
);

350 
	`DECLARE_TRX
(
q·¹suµ
);

351 
	`DECLARE_TRX
(
qcu¡om”
);

354 
	`DECLARE_TRX
(
qNP
);

357 
	`DECLARE_TRX
(
pİuÏ‹_ba£lše
);

358 
	`DECLARE_TRX
(
pİuÏ‹_some_·¹s
);

359 
	`DECLARE_TRX
(
pİuÏ‹_some_cu¡s
);

363 
‹m¶©e
<
şass
 
T1_mª
, cÏs 
T2_mª
, cÏs 
T1_desc
, cÏs 
T2_desc
>

364 
w_rc_t


365 
	`još_1_bË
(
gu¬d
<
T1_mª
> , gu¬d<
T2_mª
> ,

366 
gu¬d
<
T1_desc
>, gu¬d<
T2_desc
>,

367 
veùÜ
<
row_d©a_t
*>& );

370 
‹m¶©e
<
şass
 
T_mª
, cÏs 
T_desc
>

371 
w_rc_t


372 
	`još_2_bË
(
gu¬d
<
T_mª
> , gu¬d<
T_desc
> ,

373 
veùÜ
<
row_d©a_t
 *> ,

374 
veùÜ
<
row_d©a_t
*> );

376 
‹m¶©e
<
şass
 
T
> 
	$f
(è{
	}
}

379 #ifdeà
CFG_QPIPE


380 
	g´iv©e
:

381 
gu¬d
<
pŞicy_t
> 
_sched_pŞicy
;

383 
	gpublic
:

384 
pŞicy_t
* 
g‘_sched_pŞicy
();

385 
pŞicy_t
* 
£t_sched_pŞicy
(cÚ¡ * 
¥Şicy
);

386 
w_rc_t
 
run_Úe_qpe_xù
(
Reque¡
* 
´eque¡
);

389 
DECLARE_QPIPE_TRX
(
q1
);

390 
DECLARE_QPIPE_TRX
(
q2
);

391 
DECLARE_QPIPE_TRX
(
q3
);

392 
DECLARE_QPIPE_TRX
(
q4
);

393 
DECLARE_QPIPE_TRX
(
q5
);

394 
DECLARE_QPIPE_TRX
(
q6
);

395 
DECLARE_QPIPE_TRX
(
q7
);

396 
DECLARE_QPIPE_TRX
(
q8
);

397 
DECLARE_QPIPE_TRX
(
q9
);

398 
DECLARE_QPIPE_TRX
(
q10
);

399 
DECLARE_QPIPE_TRX
(
q11
);

400 
DECLARE_QPIPE_TRX
(
q12
);

401 
DECLARE_QPIPE_TRX
(
q13
);

402 
DECLARE_QPIPE_TRX
(
q14
);

403 
DECLARE_QPIPE_TRX
(
q15
);

404 
DECLARE_QPIPE_TRX
(
q16
);

405 
DECLARE_QPIPE_TRX
(
q17
);

406 
DECLARE_QPIPE_TRX
(
q18
);

407 
DECLARE_QPIPE_TRX
(
q19
);

408 
DECLARE_QPIPE_TRX
(
q20
);

409 
DECLARE_QPIPE_TRX
(
q21
);

410 
DECLARE_QPIPE_TRX
(
q22
);

411 
DECLARE_QPIPE_TRX
(
qlše™em
);

412 
DECLARE_QPIPE_TRX
(
qÜd”s
);

413 
DECLARE_QPIPE_TRX
(
qÇtiÚ
);

414 
DECLARE_QPIPE_TRX
(
q»giÚ
);

415 
DECLARE_QPIPE_TRX
(
q·¹
);

416 
DECLARE_QPIPE_TRX
(
qsuµl›r
);

417 
DECLARE_QPIPE_TRX
(
q·¹suµ
);

418 
DECLARE_QPIPE_TRX
(
qcu¡om”
);

423 
vœtu®
 
’v_th»ad_š™
();

424 
vœtu®
 
’v_th»ad_fši
();

427 
¡©m­_t
 
	g_¡©m­
;

430 
ShÜeTPCHTrxSts
 
	g_Ï¡_¡©s
;

431 
vœtu®
 
»£t_¡©s
();

432 
ShÜeTPCHTrxSts
 
_g‘_¡©s
();

437 
	g‹m¶©e
<
şass
 
	gT_mª
, cÏs 
	gT_desc
>

438 
w_rc_t


439 
	gShÜeTPCHEnv
::
još_2_bË
(
gu¬d
<
T_mª
> 
_t_m
, gu¬d<
T_desc
> 
_t_d
, 
veùÜ
<
row_d©a_t
 *> 
£tOfRow
, veùÜ<row_d©a_ˆ*> 
»suÉ
)

442 
as£¹
 (
_pssm
);

443 
as£¹
 (
_š™Ÿlized
);

444 
as£¹
 (
_lßded
);

448 
bË_row_t
* 
	gt_r
 = 
_t_m
->
g‘_tu¶e
();

449 
as£¹
(
t_r
);

451 
w_rc_t
 
	ge
 =
RCOK
;

454 
»p_row_t
 
¬•row
(
_t_m
->
ts
());

455 
	g¬•row
.
£t
(
_t_d
->
maxsize
());

457 
	gt_r
->
	g_»p
 = &
¬•row
;

458 
	ggu¬d
< 
	gbË_sÿn_™”_im¶
<
	gT_desc
> > 
	gl_™”
;

460 
	gbË_sÿn_™”_im¶
<
	gT_desc
>* 
	gt
;

461 
	ge
 = 
_t_m
->
g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
t
);

462 
	gl_™”
 = 
t
;

463 ià(
	ge
.
is_”rÜ
()è{ 
	gdÚe
; }

465 
boŞ
 
	geof
;

467 
	ge
 = 
l_™”
->
Ãxt
(
_pssm
, 
eof
, *
t_r
);

469 !
	geof
){

470 
	gr
 = 0;„ < 
	g£tOfRow
.
size
();„++){

473 
row_d©a_t
 * 
	gjošed_row
 = 
Ãw
„ow_d©a_t(*
£tOfRow
[
r
]);

474 
	gjošed_row
->
	grows
.
push_back
(
t_r
);

475 
	g»suÉ
.
push_back
(
jošed_row
);

478 
	ge
 = 
l_™”
->
Ãxt
(
_pssm
, 
eof
, *
t_r
);

479 ià(
	ge
.
is_”rÜ
()è{
	gdÚe
;}

483  (
	gRCOK
);

486 
	g‹m¶©e
<
şass
 
	gT1_mª
, cÏs 
	gT2_mª
, cÏs 
	gT1_desc
, cÏs 
	gT2_desc
>

487 
w_rc_t


488 
	gShÜeTPCHEnv
::
još_1_bË
(
gu¬d
<
T1_mª
> 
_t1_m
, gu¬d<
T2_mª
> 
_t2_m
, gu¬d<
T1_desc
>
_t1_d
, gu¬d<
T2_desc
>
_t2_d
, 
veùÜ
<
row_d©a_t
*>& 
»suÉ
)

493 
as£¹
 (
_pssm
);

494 
as£¹
 (
_š™Ÿlized
);

495 
as£¹
 (
_lßded
);

498 
bË_row_t
* 
	gt1_r
 = 
_t1_m
->
g‘_tu¶e
();

499 
as£¹
(
t1_r
);

501 
w_rc_t
 
	ge1
 =
RCOK
;

504 
»p_row_t
 
¬•row1
(
_t1_m
->
ts
());

505 
	g¬•row1
.
£t
(
_t1_d
->
maxsize
());

507 
	gt1_r
->
	g_»p
 = &
¬•row1
;

510 
bË_row_t
* 
	gt2_r
 = 
_t2_m
->
g‘_tu¶e
();

511 
as£¹
(
t2_r
);

512 
w_rc_t
 
	ge2
 =
RCOK
;

515 
»p_row_t
 
¬•row2
(
_t2_m
->
ts
());

516 
	g¬•row2
.
£t
(
_t2_d
->
maxsize
());

518 
	gt2_r
->
	g_»p
 = &
¬•row2
;

519 
	gc
 =0;

520 
	ggu¬d
< 
	gbË_sÿn_™”_im¶
<
	gT1_desc
> > 
	gl_™”1
;

522 
	gbË_sÿn_™”_im¶
<
	gT1_desc
>* 
	gt1
;

523 
	ge1
 = 
_t1_m
->
g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
t1
);

524 
	gl_™”1
 = 
t1
;

525 ià(
	ge1
.
is_”rÜ
()è{ 
	gdÚe
; }

527 
boŞ
 
	geof1
;

529 
	ge1
 = 
l_™”1
->
Ãxt
(
_pssm
, 
eof1
, *
t1_r
);

531 !
	geof1
){

533 
	ggu¬d
< 
	gbË_sÿn_™”_im¶
<
	gT2_desc
> > 
	gl_™”2
;

535 
	gbË_sÿn_™”_im¶
<
	gT2_desc
>* 
	gt2
;

536 
	ge2
 = 
_t2_m
->
g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
t2
);

537 
	gl_™”2
 = 
t2
;

538 ià(
	ge2
.
is_”rÜ
()è{ 
	gdÚe
; }

540 
boŞ
 
	geof2
;

542 
	ge2
 = 
l_™”2
->
Ãxt
(
_pssm
, 
eof2
, *
t2_r
);

544 !
	geof2
){

547 
	gc
++;

548 
bË_row_t
* 
	gr1
 = 
Ãw
abË_row_t(*
t1_r
);

549 
bË_row_t
* 
	gr2
 = 
Ãw
abË_row_t(*
t2_r
);

551 
row_d©a_t
* 
	gj
 = 
Ãw
„ow_data_t;

552 
	gj
->
	grows
.
push_back
(
r1
);

553 
	gj
->
	grows
.
push_back
(
r2
);

555 
	g»suÉ
.
push_back
(
j
);

557 
	ge2
 = 
l_™”2
->
Ãxt
(
_pssm
, 
eof2
, *
t2_r
);

558 ià(
	ge2
.
is_”rÜ
()è{
	gdÚe
;}

561 
	ge1
 = 
l_™”1
->
Ãxt
(
_pssm
, 
eof1
, *
t1_r
);

562 ià(
	ge1
.
is_”rÜ
()è{
	gdÚe
;}

565 
	gdÚe
:

566 
cout
<<"*******num oàtu¶: "<<
c
<<
’dl
;

567 
	g_t1_m
->
give_tu¶e
(
t1_r
);

568 
	g_t2_m
->
give_tu¶e
(
t2_r
);

569  (
	gRCOK
);

574 
EXIT_NAMESPACE
(
ch
);

	@include/workload/tpch/shore_tpch_schema.h

32 #iâdeà
__SHORE_TPCH_SCHEMA_H


33 
	#__SHORE_TPCH_SCHEMA_H


	)

35 
	~<m©h.h
>

37 
	~"sm_vas.h
"

38 
	~"ut.h
"

40 
	~"wÜklßd/ch/ch_cÚ¡.h
"

41 
	~"sm/shÜe/shÜe_bË_mª.h
"

43 
usšg
 
Çme¥aû
 
	gshÜe
;

46 
ENTER_NAMESPACE
(
ch
);

57 
DECLARE_TABLE_SCHEMA_PD
(
ÇtiÚ_t
);

58 
DECLARE_TABLE_SCHEMA_PD
(
»giÚ_t
);

59 
DECLARE_TABLE_SCHEMA_PD
(
suµl›r_t
);

60 
DECLARE_TABLE_SCHEMA_PD
(
·¹_t
);

61 
DECLARE_TABLE_SCHEMA_PD
(
·¹suµ_t
);

62 
DECLARE_TABLE_SCHEMA_PD
(
cu¡om”_t
);

63 
DECLARE_TABLE_SCHEMA_PD
(
Üd”s_t
);

64 
DECLARE_TABLE_SCHEMA_PD
(
lše™em_t
);

67 
EXIT_NAMESPACE
(
ch
);

	@include/workload/tpch/shore_tpch_schema_man.h

33 #iâdeà
__SHORE_TPCH_SCHEMA_MANAGER_H


34 
	#__SHORE_TPCH_SCHEMA_MANAGER_H


	)

36 
	~"wÜklßd/ch/ch_¡ruù.h
"

37 
	~"wÜklßd/ch/shÜe_ch_schema.h
"

40 
usšg
 
Çme¥aû
 
	gshÜe
;

43 
ENTER_NAMESPACE
(
ch
);

52 
şass
 
	gÇtiÚ_mª_im¶
 : 
public
 
bË_mª_im¶
<
ÇtiÚ_t
>

54 
bË_row_t
 
	tÇtiÚ_tu¶e
;

56 
	gpublic
:

58 
ÇtiÚ_mª_im¶
(
ÇtiÚ_t
* 
aN©iÚDesc
)

59 : 
bË_mª_im¶
<
ÇtiÚ_t
>(
aN©iÚDesc
)

62 ~
ÇtiÚ_mª_im¶
() { }

65 
w_rc_t
 
n_šdex_´obe
(
ss_m
* 
db
,

66 
ÇtiÚ_tu¶e
* 
±u¶e
,

67 cÚ¡ 
n_ÇtiÚkey
);

72 
şass
 
	g»giÚ_mª_im¶
 : 
public
 
bË_mª_im¶
<
»giÚ_t
>

74 
bË_row_t
 
	t»giÚ_tu¶e
;

76 
	gpublic
:

78 
»giÚ_mª_im¶
(
»giÚ_t
* 
aRegiÚDesc
)

79 : 
bË_mª_im¶
<
»giÚ_t
>(
aRegiÚDesc
)

82 ~
»giÚ_mª_im¶
() { }

85 
w_rc_t
 
r_šdex_´obe
(
ss_m
* 
db
,

86 
»giÚ_tu¶e
* 
±u¶e
,

87 cÚ¡ 
r_»giÚkey
);

91 
şass
 
	g·¹_mª_im¶
 : 
public
 
bË_mª_im¶
<
·¹_t
>

93 
bË_row_t
 
	t·¹_tu¶e
;

95 
	gpublic
:

97 
·¹_mª_im¶
(
·¹_t
* 
aP¬tDesc
)

98 : 
bË_mª_im¶
<
·¹_t
>(
aP¬tDesc
)

101 ~
·¹_mª_im¶
() { }

103 
w_rc_t
 
p_šdex_´obe
(
ss_m
* 
db
,

104 
·¹_tu¶e
* 
±u¶e
,

105 cÚ¡ 
p_·¹key
);

110 
şass
 
	gsuµl›r_mª_im¶
 : 
public
 
bË_mª_im¶
<
suµl›r_t
>

112 
bË_row_t
 
	tsuµl›r_tu¶e
;

113 
	gbË_sÿn_™”_im¶
<
	tsuµl›r_t
> 
	tsuµl›r_bË_™”
;

114 
	gšdex_sÿn_™”_im¶
<
	tsuµl›r_t
> 
	tsuµl›r_šdex_™”
;

116 
	gpublic
:

118 
suµl›r_mª_im¶
(
suµl›r_t
* 
aSuµl›rDesc
)

119 : 
bË_mª_im¶
<
suµl›r_t
>(
aSuµl›rDesc
)

123 ~
suµl›r_mª_im¶
()

128 
w_rc_t
 
s_šdex_´obe
(
ss_m
* 
db
,

129 
suµl›r_tu¶e
* 
±u¶e
,

130 cÚ¡ 
s_suµkey
);

135 
şass
 
	g·¹suµ_mª_im¶
 : 
public
 
bË_mª_im¶
<
·¹suµ_t
>

137 
bË_row_t
 
	t·¹suµ_tu¶e
;

138 
	gbË_sÿn_™”_im¶
<
	t·¹suµ_t
> 
	t·¹suµ_bË_™”
;

139 
	gšdex_sÿn_™”_im¶
<
	t·¹suµ_t
> 
	t·¹suµ_šdex_™”
;

141 
	gpublic
:

143 
·¹suµ_mª_im¶
(
·¹suµ_t
* 
aP¬tsuµDesc
)

144 : 
bË_mª_im¶
<
·¹suµ_t
>(
aP¬tsuµDesc
)

148 ~
·¹suµ_mª_im¶
()

152 
w_rc_t
 
ps_šdex_´obe
(
ss_m
* 
db
,

153 
·¹suµ_tu¶e
* 
±u¶e
,

154 cÚ¡ 
ps_·¹key
,

155 cÚ¡ 
ps_suµkey
);

160 
şass
 
	gcu¡om”_mª_im¶
 : 
public
 
bË_mª_im¶
<
cu¡om”_t
>

162 
bË_row_t
 
	tcu¡om”_tu¶e
;

163 
	gbË_sÿn_™”_im¶
<
	tcu¡om”_t
> 
	tcu¡om”_bË_™”
;

164 
	gšdex_sÿn_™”_im¶
<
	tcu¡om”_t
> 
	tcu¡om”_šdex_™”
;

166 
	gpublic
:

168 
cu¡om”_mª_im¶
(
cu¡om”_t
* 
aCu¡om”Desc
)

169 : 
bË_mª_im¶
<
cu¡om”_t
>(
aCu¡om”Desc
)

172 ~
cu¡om”_mª_im¶
() { }

185 
w_rc_t
 
c_šdex_´obe
(
ss_m
* 
db
,

186 
cu¡om”_tu¶e
* 
±u¶e
,

187 cÚ¡ 
c_cu¡key
);

189 
w_rc_t
 
c_šdex_´obe_by_Çme
(
ss_m
* 
db
,

190 cÚ¡ * 
idx_Çme
,

191 
cu¡om”_tu¶e
* 
±u¶e
,

192 cÚ¡ 
c_cu¡key
);

197 
şass
 
	gÜd”s_mª_im¶
 : 
public
 
bË_mª_im¶
<
Üd”s_t
>

199 
bË_row_t
 
	tÜd”s_tu¶e
;

200 
	gbË_sÿn_™”_im¶
<
	tÜd”s_t
> 
	tÜd”s_bË_™”
;

201 
	gšdex_sÿn_™”_im¶
<
	tÜd”s_t
> 
	tÜd”s_šdex_™”
;

203 
	gpublic
:

205 
Üd”s_mª_im¶
(
Üd”s_t
* 
aOrd”sDesc
)

206 : 
bË_mª_im¶
<
Üd”s_t
>(
aOrd”sDesc
)

210 ~
Üd”s_mª_im¶
()

215 
w_rc_t
 
o_g‘_™”_by_šdex
(
ss_m
* 
db
,

216 
Üd”s_šdex_™”
* &
™”
,

217 
Üd”s_tu¶e
* 
±u¶e
,

218 
»p_row_t
 &
»¶ow
,

219 
»p_row_t
 &
»phigh
,

220 cÚ¡ 
c_Üd”key
,

221 
lock_mode_t
 
®m
 = 
SH
,

222 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

224 
w_rc_t
 
o_g‘_™”_by_fšdex
(
ss_m
* 
db
,

225 
Üd”s_šdex_™”
* &
™”
,

226 
Üd”s_tu¶e
* 
±u¶e
,

227 
»p_row_t
 &
»¶ow
,

228 
»p_row_t
 &
»phigh
,

229 cÚ¡ 
o_cu¡key
,

230 
lock_mode_t
 
®m
 = 
SH
,

231 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

233 
w_rc_t
 
o_g‘_¿nge_™”_by_šdex
(
ss_m
* 
db
,

234 
Üd”s_šdex_™”
* &
™”
,

235 
Üd”s_tu¶e
* 
±u¶e
,

236 
»p_row_t
 &
»¶ow
,

237 
»p_row_t
 &
»phigh
,

238 cÚ¡ 
time_t
 
low_o_Üd”d©e
,

239 cÚ¡ 
time_t
 
high_o_Üd”d©e
,

240 
lock_mode_t
 
®m
 = 
SH
,

241 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

247 
şass
 
	glše™em_mª_im¶
 : 
public
 
bË_mª_im¶
<
lše™em_t
>

249 
bË_row_t
 
	tlše™em_tu¶e
;

250 
	gbË_sÿn_™”_im¶
<
	tlše™em_t
> 
	tlše™em_bË_™”
;

251 
	gšdex_sÿn_™”_im¶
<
	tlše™em_t
> 
	tlše™em_šdex_™”
;

253 
	gpublic
:

255 
lše™em_mª_im¶
(
lše™em_t
* 
aLše™emDesc
)

256 : 
bË_mª_im¶
<
lše™em_t
>(
aLše™emDesc
)

260 ~
lše™em_mª_im¶
()

265 
w_rc_t
 
l_g‘_¿nge_™”_by_šdex
(
ss_m
* 
db
,

266 
lše™em_šdex_™”
* &
™”
,

267 
lše™em_tu¶e
* 
±u¶e
,

268 
»p_row_t
 &
»¶ow
,

269 
»p_row_t
 &
»phigh
,

270 cÚ¡ 
time_t
 
low_l_shd©e
,

271 cÚ¡ 
time_t
 
high_l_shd©e
,

272 
lock_mode_t
 
®m
 = 
SH
,

273 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

286 
w_rc_t
 
l_g‘_¿nge_™”_by_»ûtd©e_šdex
(
ss_m
* 
db
,

287 
lše™em_šdex_™”
* &
™”
,

288 
lše™em_tu¶e
* 
±u¶e
,

289 
»p_row_t
 &
»¶ow
,

290 
»p_row_t
 &
»phigh
,

291 cÚ¡ 
time_t
 
low_l_»ûtd©e
,

292 cÚ¡ 
time_t
 
high_l_»ûtd©e
,

293 
lock_mode_t
 
®m
 = 
SH
,

294 
boŞ
 
Ãed_tu¶e
 = 
Œue
);

297 
EXIT_NAMESPACE
(
ch
);

	@include/workload/tpch/tpch_const.h

31 #iâdeà
__TPCH_CONST_H


32 
	#__TPCH_CONST_H


	)

35 
	~"ut/Çme¥aû.h
"

38 
ENTER_NAMESPACE
(
ch
);

43 cÚ¡ 
	gNATIONS
 = 25;

44 cÚ¡ 
	gREGIONS
 = 5;

45 cÚ¡ 
	gPARTS
 = 200000;

46 cÚ¡ 
	gSUPPLIERS
 = 10000;

47 cÚ¡ 
	gPARTSUPPS
 = 800000;

48 cÚ¡ 
	gCUSTOMERS
 = 150000;

49 cÚ¡ 
	gORDERS
 = 1500000;

51 cÚ¡ 
	gLINEITEMS_1
 = 6001215;

52 cÚ¡ 
	gLINEITEMS_10
 = 59986052;

53 cÚ¡ 
	gLINEITEMS_30
 = 179998372;

54 cÚ¡ 
	gLINEITEMS_100
 = 600037902;

56 cÚ¡ 
	gMAX_TABLENAM_LENGTH
 = 8;

57 cÚ¡ 
	gMAX_RECORD_LENGTH
 = 234;

62 cÚ¡ 
	gTPCH_NATION_FCOUNT
 = 4;

63 cÚ¡ 
	gTPCH_REGION_FCOUNT
 = 3;

64 cÚ¡ 
	gTPCH_PART_FCOUNT
 = 9;

65 cÚ¡ 
	gTPCH_SUPPLIER_FCOUNT
 = 7;

66 cÚ¡ 
	gTPCH_PARTSUPP_FCOUNT
 = 5;

67 cÚ¡ 
	gTPCH_CUSTOMER_FCOUNT
 = 8;

68 cÚ¡ 
	gTPCH_ORDERS_FCOUNT
 = 9;

69 cÚ¡ 
	gTPCH_LINEITEM_FCOUNT
 = 16;

73 cÚ¡ 
	gSHORE_TPCH_TABLES
 = 8;

79 cÚ¡ 
	gXCT_TPCH_MIX
 = 40;

80 cÚ¡ 
	gXCT_TPCH_Q1
 = 41;

81 cÚ¡ 
	gXCT_TPCH_Q2
 = 42;

82 cÚ¡ 
	gXCT_TPCH_Q3
 = 43;

83 cÚ¡ 
	gXCT_TPCH_Q4
 = 44;

84 cÚ¡ 
	gXCT_TPCH_Q5
 = 45;

85 cÚ¡ 
	gXCT_TPCH_Q6
 = 46;

86 cÚ¡ 
	gXCT_TPCH_Q7
 = 47;

87 cÚ¡ 
	gXCT_TPCH_Q8
 = 48;

88 cÚ¡ 
	gXCT_TPCH_Q9
 = 49;

89 cÚ¡ 
	gXCT_TPCH_Q10
 = 50;

90 cÚ¡ 
	gXCT_TPCH_Q11
 = 51;

91 cÚ¡ 
	gXCT_TPCH_Q12
 = 52;

92 cÚ¡ 
	gXCT_TPCH_Q13
 = 53;

93 cÚ¡ 
	gXCT_TPCH_Q14
 = 54;

94 cÚ¡ 
	gXCT_TPCH_Q15
 = 55;

95 cÚ¡ 
	gXCT_TPCH_Q16
 = 56;

96 cÚ¡ 
	gXCT_TPCH_Q17
 = 57;

97 cÚ¡ 
	gXCT_TPCH_Q18
 = 58;

98 cÚ¡ 
	gXCT_TPCH_Q19
 = 59;

99 cÚ¡ 
	gXCT_TPCH_Q20
 = 60;

100 cÚ¡ 
	gXCT_TPCH_Q21
 = 61;

101 cÚ¡ 
	gXCT_TPCH_Q22
 = 62;

103 cÚ¡ 
	gXCT_TPCH_QLINEITEM
 = 70;

104 cÚ¡ 
	gXCT_TPCH_QORDERS
 = 71;

105 cÚ¡ 
	gXCT_TPCH_QREGION
 = 72;

106 cÚ¡ 
	gXCT_TPCH_QNATION
 = 73;

107 cÚ¡ 
	gXCT_TPCH_QSUPPLIER
 = 74;

108 cÚ¡ 
	gXCT_TPCH_QPART
 = 75;

109 cÚ¡ 
	gXCT_TPCH_QPARTSUPP
 = 76;

110 cÚ¡ 
	gXCT_TPCH_QCUSTOMER
 = 77;

112 cÚ¡ 
	gXCT_QPIPE_TPCH_MIX
 = 1040;

115 
EXIT_NAMESPACE
(
ch
);

	@include/workload/tpch/tpch_input.h

33 #iâdeà
__TPCH_INPUT_H


34 
	#__TPCH_INPUT_H


	)

36 
	~"wÜklßd/ch/ch_cÚ¡.h
"

37 
	~"wÜklßd/ch/ch_¡ruù.h
"

40 
ENTER_NAMESPACE
(
ch
);

45 
	sqlše™em_šput_t


47 
	mdummy
;

48 
	mqlše™em_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
qlše™em_šput_t
& 
rhs
);

51 
qlše™em_šput_t
 
ü—‹_qlše™em_šput
(cÚ¡ 
sf
,

52 cÚ¡ 
¥ecificWH
 = 0);

54 
	sqÜd”s_šput_t


56 
	mdummy
;

57 
	mqÜd”s_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
qÜd”s_šput_t
& 
rhs
);

60 
qÜd”s_šput_t
 
ü—‹_qÜd”s_šput
(cÚ¡ 
sf
,

61 cÚ¡ 
¥ecificWH
 = 0);

63 
	sqÇtiÚ_šput_t


65 
	mdummy
;

66 
	mqÇtiÚ_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
qÇtiÚ_šput_t
& 
rhs
);

69 
qÇtiÚ_šput_t
 
ü—‹_qÇtiÚ_šput
(cÚ¡ 
sf
,

70 cÚ¡ 
¥ecificWH
 = 0);

72 
	sq»giÚ_šput_t


74 
	mdummy
;

75 
	mq»giÚ_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q»giÚ_šput_t
& 
rhs
);

78 
q»giÚ_šput_t
 
ü—‹_q»giÚ_šput
(cÚ¡ 
sf
,

79 cÚ¡ 
¥ecificWH
 = 0);

81 
	sqsuµl›r_šput_t


83 
	mdummy
;

84 
	mqsuµl›r_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
qsuµl›r_šput_t
& 
rhs
);

87 
qsuµl›r_šput_t
 
ü—‹_qsuµl›r_šput
(cÚ¡ 
sf
,

88 cÚ¡ 
¥ecificWH
 = 0);

90 
	sq·¹_šput_t


92 
	mdummy
;

93 
	mq·¹_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q·¹_šput_t
& 
rhs
);

96 
q·¹_šput_t
 
ü—‹_q·¹_šput
(cÚ¡ 
sf
,

97 cÚ¡ 
¥ecificWH
 = 0);

99 
	sq·¹suµ_šput_t


101 
	mdummy
;

102 
	mq·¹suµ_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q·¹suµ_šput_t
& 
rhs
);

105 
q·¹suµ_šput_t
 
ü—‹_q·¹suµ_šput
(cÚ¡ 
sf
,

106 cÚ¡ 
¥ecificWH
 = 0);

108 
	sqcu¡om”_šput_t


110 
	mdummy
;

111 
	mqcu¡om”_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
qcu¡om”_šput_t
& 
rhs
);

114 
qcu¡om”_šput_t
 
ü—‹_qcu¡om”_šput
(cÚ¡ 
sf
,

115 cÚ¡ 
¥ecificWH
 = 0);

123 
	sq1_šput_t


125 
time_t
 
	ml_shd©e
;

126 
	mq1_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q1_šput_t
& 
rhs
);

129 
q1_šput_t
 
ü—‹_q1_šput
(cÚ¡ 
sf
,

130 cÚ¡ 
¥ecificWH
 = 0);

138 
	sq2_šput_t
 {

139 
	mp_size
;

140 
	mp_ty³s3
;

141 
	mr_Çme
;

143 
	mq2_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q2_šput_t
& 
rhs
);

145 
q2_šput_t
 
ü—‹_q2_šput
(cÚ¡ 
sf
, cÚ¡ 
¥ecificWH
);

153 
	sq3_šput_t
 {

155 
time_t
 
	mcu¼’t_d©e
;

156 
	mc_£gm’t
;

157 
	mq3_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q3_šput_t
& 
rhs
);

159 
q3_šput_t
 
ü—‹_q3_šput
(cÚ¡ 
sf
, cÚ¡ 
¥ecificWH
);

167 
	sq4_šput_t


169 
time_t
 
	mo_Üd”d©e
;

170 
	mq4_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q4_šput_t
& 
rhs
);

173 
q4_šput_t
 
ü—‹_q4_šput
(cÚ¡ 
sf
,

174 cÚ¡ 
¥ecificWH
 = 0);

181 
	sq5_šput_t
 {

182 
	mr_Çme
;

183 
time_t
 
	mo_Üd”d©e
;

184 
	mq5_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q5_šput_t
& 
rhs
);

186 
q5_šput_t
 
ü—‹_q5_šput
(cÚ¡ 
sf
, cÚ¡ 
¥ecificWH
);

194 
	sq6_šput_t


196 
time_t
 
	ml_shd©e
;

197 
	ml_quªt™y
;

198 
	ml_discouÁ
;

200 
	mq6_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q6_šput_t
& 
rhs
);

203 
q6_šput_t
 
ü—‹_q6_šput
(cÚ¡ 
sf
,

204 cÚ¡ 
¥ecificWH
 = 0);

213 
	sq7_šput_t
 {

214 
	mn_Çme1
;

215 
	mn_Çme2
;

216 
	mq7_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q7_šput_t
& 
rhs
);

218 
q7_šput_t
 
ü—‹_q7_šput
(cÚ¡ 
sf
, cÚ¡ 
¥ecificWH
);

225 
	sq8_šput_t
 {

226 
	mn_Çme
;

227 
	mr_Çme
;

229 
ch_p_ty³
 
	mp_ty³
;

231 
	mq8_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q8_šput_t
& 
rhs
);

233 
q8_šput_t
 
ü—‹_q8_šput
(cÚ¡ 
sf
, cÚ¡ 
¥ecificWH
);

241 
	sq9_šput_t
 {

242 
	mp_Çme
;

244 
	mq9_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q9_šput_t
& 
rhs
);

246 
q9_šput_t
 
ü—‹_q9_šput
(cÚ¡ 
sf
, cÚ¡ 
¥ecificWH
);

254 
	sq10_šput_t
 {

255 
time_t
 
	mo_Üd”d©e
;

256 
	mq10_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q10_šput_t
& 
rhs
);

258 
q10_šput_t
 
ü—‹_q10_šput
(cÚ¡ 
sf
, cÚ¡ 
¥ecificWH
);

266 
	sq11_šput_t
 {

267 
	mn_Çme
;

268 
	mäaùiÚ
;

270 
	mq11_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q11_šput_t
& 
rhs
);

272 
q11_šput_t
 
ü—‹_q11_šput
(cÚ¡ 
sf
, cÚ¡ 
¥ecificWH
);

282 
	sq12_šput_t


284 
	ml_shmode1
;

285 
	ml_shmode2
;

286 
time_t
 
	ml_»ûtd©e
;

288 
	mq12_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q12_šput_t
& 
rhs
);

291 
q12_šput_t
 
ü—‹_q12_šput
(cÚ¡ 
sf
,

292 cÚ¡ 
¥ecificWH
 = 0);

301 
	sq13_šput_t


303 
	mWORD1
[15];

304 
	mWORD2
[15];

306 
	mq13_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q13_šput_t
& 
rhs
);

309 
q13_šput_t
 
ü—‹_q13_šput
(cÚ¡ 
sf
,

310 cÚ¡ 
¥ecificWH
 = 0);

321 
	sq14_šput_t


323 
time_t
 
	ml_shd©e
;

325 
	mq14_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q14_šput_t
& 
rhs
);

328 
q14_šput_t
 
ü—‹_q14_šput
(cÚ¡ 
sf
,

329 cÚ¡ 
¥ecificWH
 = 0);

336 
	sq15_šput_t
 {

338 
time_t
 
	ml_shd©e
;

339 
	mq15_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q15_šput_t
& 
rhs
);

341 
q15_šput_t
 
ü—‹_q15_šput
(cÚ¡ 
sf
, cÚ¡ 
¥ecificWH
);

349 
	sq16_šput_t
 {

350 
	mp_b¿nd
;

351 
	mp_ty³
;

353 
	mp_size
[8];

354 
	mq16_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q16_šput_t
& 
rhs
);

356 
q16_šput_t
 
ü—‹_q16_šput
(cÚ¡ 
sf
, cÚ¡ 
¥ecificWH
);

363 
	sq17_šput_t
 {

364 
	mp_b¿nd
;

365 
	mp_cÚš”
;

366 
	mq17_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q17_šput_t
& 
rhs
);

368 
q17_šput_t
 
ü—‹_q17_šput
(cÚ¡ 
sf
, cÚ¡ 
¥ecificWH
);

375 
	sq18_šput_t
 {

376 
	ml_quªt™y
;

377 
	mq18_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q18_šput_t
& 
rhs
);

379 
q18_šput_t
 
ü—‹_q18_šput
(cÚ¡ 
sf
, cÚ¡ 
¥ecificWH
);

386 
	sq19_šput_t
 {

388 
	ml_quªt™y
[3];

389 
	mp_b¿nd
[3];

391 
	mq19_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q19_šput_t
& 
rhs
);

393 
q19_šput_t
 
ü—‹_q19_šput
(cÚ¡ 
sf
, cÚ¡ 
¥ecificWH
);

400 
	sq20_šput_t
 {

401 
	mn_Çme
;

402 
	mp_cŞÜ
;

403 
time_t
 
	ml_shd©e
;

405 
	mq20_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q20_šput_t
& 
rhs
);

407 
q20_šput_t
 
ü—‹_q20_šput
(cÚ¡ 
sf
, cÚ¡ 
¥ecificWH
);

414 
	sq21_šput_t
 {

415 
	mn_Çme
;

416 
	mq21_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q21_šput_t
& 
rhs
);

418 
q21_šput_t
 
ü—‹_q21_šput
(cÚ¡ 
sf
, cÚ¡ 
¥ecificWH
);

425 
	sq22_šput_t
 {

426 
	múŒycode
[7];

428 
	mq22_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
q22_šput_t
& 
rhs
);

430 
q22_šput_t
 
ü—‹_q22_šput
(cÚ¡ 
sf
, cÚ¡ 
¥ecificWH
);

438 
	sqNP_šput_t


440 
	m_cu¡id
;

442 
	mqNP_šput_t
& 
	mİ”©Ü
=(cÚ¡ 
qNP_šput_t
& 
rhs
);

445 
qNP_šput_t
 
ü—‹_qNP_šput
(cÚ¡ 
sf
,

446 cÚ¡ 
¥ecificWH
 = 0);

457 
	spİuÏ‹_ba£lše_šput_t


459 
	m_sf
;

460 
	m_lßd”_couÁ
;

461 
	m_divisÜ
;

462 
	m_·¹s_³r_th»ad
;

463 
	m_cu¡s_³r_th»ad
;

467 
	spİuÏ‹_some_·¹s_šput_t


469 
	m_·¹id
;

473 
	spİuÏ‹_some_cu¡s_šput_t


475 
	m_cu¡id
;

479 
EXIT_NAMESPACE
(
ch
);

	@include/workload/tpch/tpch_random.h

32 #iâdeà
__TPCH_COMMON_H


33 
	#__TPCH_COMMON_H


	)

35 
	~"ut.h
"

38 
ENTER_NAMESPACE
(
ch
);

52 
NURªd
(
A
, 
low
, 
high
);

54 
EXIT_NAMESPACE
(
ch
);

	@include/workload/tpch/tpch_struct.h

33 #iâdeà
__TPCH_STRUCT_H


34 
	#__TPCH_STRUCT_H


	)

36 
	~<c¡dlib
>

37 
	~<uni¡d.h
>

38 
	~<sys/time.h
>

39 
	~"ut.h
"

42 
ENTER_NAMESPACE
(
ch
);

46 
	#STRSIZE
(
x
è(x+1)

	)

51 
	ech_l_shmode
 {

52 
	mREG_AIR
,

53 
	mAIR
,

54 
	mRAIL
,

55 
	mTRUCK
,

56 
	mMAIL
,

57 
	mFOB
,

58 
	mSHIP
,

59 
	mEND_SHIPMODE


62 
	ech_r_Çme
{

63 
	mAFRICA
,

64 
	mAMERICA
,

65 
	mASIA
,

66 
	mEUROPE
,

67 
	mMIDDLE_EAST
,

68 
	mEND_R_NAME


71 
	ech_n_Çme
{

72 
	mALGERIA
,

73 
	mARGENTINA
,

74 
	mBRAZIL
,

75 
	mCANADA
,

76 
	mEGYPT
,

77 
	mETHIOPIA
,

78 
	mFRANCE
,

79 
	mGERMANY
,

80 
	mINDIA
,

81 
	mINDONESIA
,

82 
	mIRAN
,

83 
	mIRAQ
,

84 
	mJAPAN
,

85 
	mJORDAN
,

86 
	mKENYA
,

87 
	mMOROCCO
,

88 
	mMOZAMBIQUE
,

89 
	mPERU
,

90 
	mCHINA
,

91 
	mROMANIA
,

92 
	mSAUDI_ARABIA
,

93 
	mVIETNAM
,

94 
	mRUSSIA
,

95 
	mUNITED_KINGDOM
,

96 
	mUNITED_STATES
,

97 
	mEND_N_NAME


100 
	ech_p_ty³_s1
{

101 
	mSTANDARD
,

102 
	mSMALL
,

103 
	mMEDIUM
,

104 
	mLARGE
,

105 
	mECONOMY
,

106 
	mPROMO
,

107 
	mEND_TYPE_S1


110 
	ech_p_ty³_s2
{

111 
	mANODIZED
,

112 
	mBURNISHED
,

113 
	mPLATED
,

114 
	mPOLISHED
,

115 
	mBRUSHED
,

116 
	mEND_TYPE_S2


119 
	ech_p_ty³_s3
{

120 
	mTIN
,

121 
	mNICKEL
,

122 
	mBRASS
,

123 
	mSTEEL
,

124 
	mCOPPER
,

125 
	mEND_TYPE_S3


128 
	ech_p_cÚš”_s1
{

129 
	mSM
,

130 
	mLG
,

131 
	mMED
,

132 
	mJUMBO
,

133 
	mWRAP
,

134 
	mEND_P_CONTAINER_S1


137 
	ech_p_cÚš”_s2
{

139 
	mCASE
,

140 
	mBOX
,

141 
	mBAG
,

142 
	mJAR
,

143 
	mPKG
,

144 
	mPACK
,

145 
	mCAN
,

146 
	mDRUM
,

147 
	mEND_P_cÚtAINER_S2


150 
	ech_o_´iÜ™y
{

152 
	mO_URGENT
,

153 
	mO_HIGH
,

154 
	mO_MEDIUM
,

155 
	mO_NOT_SPECIFIED
,

156 
	mO_LOW
,

157 
	mEND_O_PRIORITY


160 
	ech_c_£gm’t
{

161 
	mAUTOMOBILE
,

162 
	mBUILDING
,

163 
	mFURNITURE
,

164 
	mMACHINERY
,

165 
	mHOUSEHOLD
,

166 
	mEND_SEGMENT


169 
	sch_p_ty³
{

170 
	ms1
;

171 
	ms2
;

172 
	ms3
;

175 
	ech_²ame
{

176 
	m®mÚd
, 
	mªtique
, 
	maquam¬še
, 
	mazu»
, 
	mbeige
, 
	mbisque
, 
	mbÏck
, 
	mbÏnched
, 
	mblue
, 
	mblush
, 
	mbrown
, 
	mbu¾ywood
, 
	mbuºished
, 
	mch¬Œeu£
, 
	mchiffÚ
, 
	mchocŞ©e
, 
	mcÜ®
, 
	mcÜnæow”
, 
	mcÜnsk
, 
	mü—m
, 
	mcyª
, 
	md¬k
, 
	md“p
, 
	mdim
, 
	mdodg”
, 
	md¿b
, 
	mfœebrick
, 
	mæÜ®
, 
	mfÜe¡
, 
	mäo¡ed
, 
	mgašsbÜo
, 
	mgho¡
, 
	mgŞd’rod
, 
	mg»’
, 
	mg»y
, 
	mhÚeydew
, 
	mhÙ
, 
	mšdŸn
, 
	mivÜy
, 
	mkhaki
, 
	mÏû
, 
	mÏv’d”
, 
	mÏwn
, 
	mËmÚ
, 
	mlight
, 
	mlime
, 
	mlš’
, 
	mmag’
, 
	mm¬oÚ
, 
	mmedium
, 
	mm‘®lic
, 
	mmidnight
, 
	mmšt
, 
	mmi¡y
, 
	mmocÿsš
, 
	mÇvajo
, 
	mÇvy
, 
	mŞive
, 
	mÜªge
, 
	mÜchid
, 
	m·Ë
, 
	m··ya
, 
	m³ach
, 
	m³ru
, 
	mpšk
, 
	m¶um
, 
	mpowd”
, 
	mpuff
, 
	mpu½Ë
, 
	m»d
, 
	mro£
, 
	mrosy
, 
	mroy®
, 
	m§ddË
, 
	m§lmÚ
, 
	m§ndy
, 
	m£ash–l
, 
	ms›Âa
, 
	msky
, 
	m¦©e
, 
	msmoke
, 
	m¢ow
, 
	m¥ršg
, 
	m¡“l
, 
	mn
, 
	mthi¡Ë
, 
	mtom©o
, 
	mturquoi£
, 
	mviŞ‘
, 
	mwh—t
, 
	mwh™e
, 
	my–low
, 
	mEND_P_NAME
};

181 cÚ¡ 
	gNO_NATIONS
 = 25;

182 cÚ¡ 
	gNO_REGIONS
 = 5;

183 cÚ¡ 
	gSUPPLIER_PER_SF
 = 10000;

184 cÚ¡ 
	gPART_PER_SF
 = 200000;

185 cÚ¡ 
	gCUSTOMER_PER_SF
 = 150000;

186 cÚ¡ 
	gORDERS_PER_CUSTOMER
 = 10;

187 cÚ¡ 
	gLINEITEM_PER_ORDER
 = 7;

195 
	sch_ÇtiÚ_tu¶e


197 
	mN_NATIONKEY
;

198 
	mN_NAME
 [
STRSIZE
(25)];

199 
	mN_REGIONKEY
;

200 
	mN_COMMENT
 [
STRSIZE
(152)];

202 
c_¡r
 
tu¶e_to_¡r
() {

203 (
c_¡r
("NATI = %d|%s|%d|%s",

204 
N_NATIONKEY
, 
N_NAME
, 
N_REGIONKEY
, 
N_COMMENT
));

210 
	sch_ÇtiÚ_tu¶e_key


212 
	mN_NATIONKEY
;

214 
boŞ
 
	mİ”©Ü
==(cÚ¡ 
ch_ÇtiÚ_tu¶e_key
& 
rhs
) const {

215  (
N_NATIONKEY
 =ğ
rhs
.N_NATIONKEY);

218 
boŞ
 
	mİ”©Ü
<(cÚ¡ 
	mch_ÇtiÚ_tu¶e_key
& 
	mrhs
) const {

219  (
	mN_NATIONKEY
 < 
	mrhs
.N_NATIONKEY);

223 
	sch_ÇtiÚ_tu¶e_body


225 
	mN_NAME
 [
STRSIZE
(25)];

226 
	mN_REGIONKEY
;

227 
	mN_COMMENT
 [
STRSIZE
(152)];

232 
	sch_»giÚ_tu¶e


234 
	mR_REGIONKEY
;

235 
	mR_NAME
 [
STRSIZE
(25)];

236 
	mR_COMMENT
 [
STRSIZE
(25)];

238 
c_¡r
 
tu¶e_to_¡r
() {

239 (
c_¡r
("REGN = %d|%s|%s",

240 
R_REGIONKEY
, 
R_NAME
, 
R_COMMENT
));

246 
	sch_»giÚ_tu¶e_key


248 
	mR_REGIONKEY
;

250 
boŞ
 
	mİ”©Ü
==(cÚ¡ 
ch_»giÚ_tu¶e_key
& 
rhs
) const {

251  ((
R_REGIONKEY
 =ğ
rhs
.R_REGIONKEY));

254 
boŞ
 
	mİ”©Ü
<(cÚ¡ 
	mch_»giÚ_tu¶e_key
& 
	mrhs
) const {

255 ià((
	mR_REGIONKEY
 < 
	mrhs
.R_REGIONKEY))

256  (
	mŒue
);

258  (
	mçl£
);

263 
	sch_»giÚ_tu¶e_body


265 
	mR_NAME
 [
STRSIZE
(25)];

266 
	mR_COMMENT
 [
STRSIZE
(25)];

272 
	sch_·¹_tu¶e


274 
	mP_PARTKEY
;

275 
	mP_NAME
 [
STRSIZE
(55)];

276 
	mP_MFGR
 [
STRSIZE
(25)];

277 
	mP_BRAND
 [
STRSIZE
(10)];

278 
	mP_TYPE
 [
STRSIZE
(25)];

279 
	mP_SIZE
;

280 
	mP_CONTAINER
 [
STRSIZE
(10)];

281 
decim®
 
	mP_RETAILPRICE
;

282 
	mP_COMMENT
 [
STRSIZE
(23)];

287 
	sch_·¹_tu¶e_key
 {

288 
	mP_PARTKEY
;

290 
boŞ
 
	mİ”©Ü
==(cÚ¡ 
ch_·¹_tu¶e_key
& 
rhs
) const {

291  
P_PARTKEY
 =ğ
rhs
.P_PARTKEY;

294 
boŞ
 
	mİ”©Ü
<(cÚ¡ 
	mch_·¹_tu¶e_key
& 
	mrhs
) const {

295  
	mP_PARTKEY
 < 
	mrhs
.P_PARTKEY;

299 
	sch_·¹_tu¶e_body


301 
	mP_NAME
 [
STRSIZE
(55)];

302 
	mP_MFGR
 [
STRSIZE
(25)];

303 
	mP_BRAND
 [
STRSIZE
(10)];

304 
	mP_TYPE
 [
STRSIZE
(25)];

305 
	mP_SIZE
;

306 
	mP_CONTAINER
 [
STRSIZE
(10)];

307 
decim®
 
	mP_RETAILPRICE
;

308 
	mP_COMMENT
 [
STRSIZE
(23)];

314 
	sch_suµl›r_tu¶e


316 
	mS_SUPPKEY
;

317 
	mS_NAME
 [
STRSIZE
(25)];

318 
	mS_ADDRESS
 [
STRSIZE
(40)];

319 
	mS_NATIONKEY
;

320 
	mS_PHONE
 [
STRSIZE
(15)];

321 
decim®
 
	mS_ACCTBAL
;

322 
	mS_COMMENT
 [
STRSIZE
(101)];

325 
	sch_suµl›r_tu¶e_key


327 
	mS_SUPPKEY
;

329 
boŞ
 
	mİ”©Ü
==(cÚ¡ 
ch_suµl›r_tu¶e_key
& 
rhs
) const {

330  
S_SUPPKEY
 =ğ
rhs
.S_SUPPKEY;

333 
boŞ
 
	mİ”©Ü
<(cÚ¡ 
	mch_suµl›r_tu¶e_key
& 
	mrhs
) const {

334  
	mS_SUPPKEY
 < 
	mrhs
.S_SUPPKEY;

339 
	sch_suµl›r_tu¶e_body


341 
	mS_NAME
 [
STRSIZE
(25)];

342 
	mS_ADDRESS
 [
STRSIZE
(40)];

343 
	mS_NATIONKEY
;

344 
	mS_PHONE
 [
STRSIZE
(15)];

345 
decim®
 
	mS_ACCTBAL
;

346 
	mS_COMMENT
 [
STRSIZE
(101)];

352 
	sch_·¹suµ_tu¶e


354 
	mPS_PARTKEY
;

355 
	mPS_SUPPKEY
;

356 
	mPS_AVAILQTY
;

357 
decim®
 
	mPS_SUPPLYCOST
;

358 
	mPS_COMMENT
 [
STRSIZE
(199)];

362 
	sch_·¹suµ_tu¶e_key


364 
	mPS_PARTKEY
;

365 
	mPS_SUPPKEY
;

367 
boŞ
 
	mİ”©Ü
==(cÚ¡ 
ch_·¹suµ_tu¶e_key
& 
rhs
) const {

368  (
PS_PARTKEY
 =ğ
rhs
.PS_PARTKEY) &&

369 (
PS_SUPPKEY
 =ğ
rhs
.PS_SUPPKEY);

372 
boŞ
 
	mİ”©Ü
<(cÚ¡ 
	mch_·¹suµ_tu¶e_key
& 
	mrhs
) const {

373  (
	mPS_PARTKEY
 < 
	mrhs
.PS_PARTKEY) ||

374 ((
	mPS_PARTKEY
 =ğ
rhs
.
PS_PARTKEY
) &&

375 (
PS_SUPPKEY
 < 
rhs
.PS_SUPPKEY)) ||

376 ((
PS_PARTKEY
 < 
rhs
.PS_PARTKEY) &&

377 (
PS_SUPPKEY
 =ğ
rhs
.PS_SUPPKEY));

382 
	sch_·¹suµ_tu¶e_body


384 
	mPS_AVAILQTY
;

385 
decim®
 
	mPS_SUPPLYCOST
;

386 
	mPS_COMMENT
 [
STRSIZE
(199)];

391 
	sch_cu¡om”_tu¶e


393 
	mC_CUSTKEY
;

394 
	mC_NAME
 [
STRSIZE
(25)];

395 
	mC_ADDRESS
 [
STRSIZE
(40)];

396 
	mC_NATIONKEY
;

397 
	mC_PHONE
 [
STRSIZE
(15)];

398 
decim®
 
	mC_ACCTBAL
;

399 
	mC_MKTSEGMENT
 [
STRSIZE
(10)];

400 
	mC_COMMENT
 [
STRSIZE
(117)];

402 
c_¡r
 
tu¶e_to_¡r
() {

403 (
c_¡r
("CUST = %d|%s|%s|%d|%s|%.2f|%s|%s -",

404 
C_CUSTKEY
, 
C_NAME
, 
C_ADDRESS
, 
C_NATIONKEY
,

405 
C_PHONE
, 
C_ACCTBAL
.
to_doubË
(), 
C_MKTSEGMENT
, 
C_COMMENT
));

412 
	sch_cu¡om”_tu¶e_key
 {

413 
	mC_CUSTKEY
;

415 
boŞ
 
	mİ”©Ü
==(cÚ¡ 
ch_cu¡om”_tu¶e_key
& 
rhs
) const {

416  ((
C_CUSTKEY
 =ğ
rhs
.C_CUSTKEY));

419 
boŞ
 
	mİ”©Ü
<(cÚ¡ 
	mch_cu¡om”_tu¶e_key
& 
	mrhs
) const {

420 ià((
	mC_CUSTKEY
 < 
	mrhs
.C_CUSTKEY))

421  (
	mŒue
);

423  (
	mçl£
);

428 
	sch_cu¡om”_tu¶e_body


430 
	mC_NAME
 [
STRSIZE
(25)];

431 
	mC_ADDRESS
 [
STRSIZE
(40)];

432 
	mC_NATIONKEY
;

433 
	mC_PHONE
 [
STRSIZE
(15)];

434 
decim®
 
	mC_ACCTBAL
;

435 
	mC_MKTSEGMENT
 [
STRSIZE
(10)];

436 
	mC_COMMENT
 [
STRSIZE
(117)];

442 
	sch_Üd”s_tu¶e


444 
	mO_ORDERKEY
;

445 
	mO_CUSTKEY
;

446 
	mO_ORDERSTATUS
;

447 
decim®
 
	mO_TOTALPRICE
;

450 
	mO_ORDERDATE
 [
STRSIZE
(15)];

452 
	mO_ORDERPRIORITY
 [
STRSIZE
(15)];

453 
	mO_CLERK
 [
STRSIZE
(15)];

454 
	mO_SHIPPRIORITY
;

455 
	mO_COMMENT
 [
STRSIZE
(79)];

459 
	sch_Üd”s_tu¶e_key


461 
	mO_ORDERKEY
;

465 
	sch_Üd”s_tu¶e_body


467 
	mO_CUSTKEY
;

468 
	mO_ORDERSTATUS
;

469 
decim®
 
	mO_TOTALPRICE
;

472 
	mO_ORDERDATE
 [
STRSIZE
(15)];

474 
	mO_ORDERPRIORITY
 [
STRSIZE
(15)];

475 
	mO_CLERK
 [
STRSIZE
(15)];

476 
	mO_SHIPPRIORITY
;

477 
	mO_COMMENT
 [
STRSIZE
(79)];

484 
	sch_lše™em_tu¶e


486 
	mL_ORDERKEY
;

487 
	mL_PARTKEY
;

488 
	mL_SUPPKEY
;

489 
	mL_LINENUMBER
;

490 
	mL_QUANTITY
;

491 
	mL_EXTENDEDPRICE
;

492 
	mL_DISCOUNT
;

493 
	mL_TAX
;

494 
	mL_RETURNFLAG
;

495 
	mL_LINESTATUS
;

500 
	mL_SHIPDATE
 [
STRSIZE
(15)];

501 
	mL_COMMITDATE
 [
STRSIZE
(15)];

502 
	mL_RECEIPTDATE
 [
STRSIZE
(15)];

504 
	mL_SHIPINSTRUCT
 [
STRSIZE
(25)];

505 
	mL_SHIPMODE
 [
STRSIZE
(10)];

506 
	mL_COMMENT
 [
STRSIZE
(44)];

510 
	sch_lše™em_tu¶e_key


512 
	mL_ORDERKEY
;

513 
	mL_LINENUMBER
;

515 
boŞ
 
	mİ”©Ü
==(cÚ¡ 
ch_lše™em_tu¶e_key
& 
rhs
) const {

516  (
L_ORDERKEY
 =ğ
rhs
.L_ORDERKEY) &&

517 (
L_LINENUMBER
 =ğ
rhs
.L_LINENUMBER);

520 
boŞ
 
	mİ”©Ü
<(cÚ¡ 
	mch_lše™em_tu¶e_key
& 
	mrhs
) const {

521  (
	mL_ORDERKEY
 < 
	mrhs
.L_ORDERKEY) ||

522 ((
	mL_ORDERKEY
 =ğ
rhs
.
L_ORDERKEY
) &&

523 (
L_LINENUMBER
 =ğ
rhs
.L_LINENUMBER));

528 
	sch_lše™em_tu¶e_body


530 
	mL_PARTKEY
;

531 
	mL_SUPPKEY
;

532 
	mL_QUANTITY
;

533 
	mL_EXTENDEDPRICE
;

534 
	mL_DISCOUNT
;

535 
	mL_TAX
;

536 
	mL_RETURNFLAG
;

537 
	mL_LINESTATUS
;

542 
	mL_SHIPDATE
 [
STRSIZE
(15)];

543 
	mL_COMMITDATE
 [
STRSIZE
(15)];

544 
	mL_RECEIPTDATE
 [
STRSIZE
(15)];

546 
	mL_SHIPINSTRUCT
 [
STRSIZE
(25)];

547 
	mL_SHIPMODE
 [
STRSIZE
(10)];

548 
	mL_COMMENT
 [
STRSIZE
(44)];

551 
EXIT_NAMESPACE
(
ch
);

	@include/workload/tpch/tpch_util.h

33 #iâdeà
__TPCH_UTIL_H


34 
	#__TPCH_UTIL_H


	)

36 
	~"wÜklßd/ch/ch_¡ruù.h
"

38 
ENTER_NAMESPACE
(
ch
);

40 
ch_l_shmode
 
¡r_to_shmode
(* 
shmode
);

41 
shmode_to_¡r
(* 
¡r
, 
ch_l_shmode
 
shmode
);

43 
B¿nd_to_¤t
(* 
¡r
, 
b¿nd
);

44 
¡r_to_B¿nd
(* 
B¿nd
 );

46 
ty³s1_to_¡r
(*
¡r
 , 
s1
);

47 
ch_p_ty³_s1
 
¡r_to_ty³s1
(*
s1
);

50 
ty³s2_to_¡r
(* 
¡r
 , 
s2
);

51 
ch_p_ty³_s2
 
¡r_to_ty³s2
(* 
s2
);

53 
ty³s3_to_¡r
(* 
¡r
 , 
s3
);

54 
ch_p_ty³_s3
 
¡r_to_ty³s3
(* 
s3
);

56 
ty³_to_¡r
(
ch_p_ty³
 
t
, * 
¡r
);

58 
ch_p_cÚš”_s1
 
¡r_to_cÚš”s1
(* 
s1
);

59 
cÚš”s1_to_¡r
Ğ
ch_p_cÚš”_s1
 
s1
, * 
¡r
);

61 
ch_p_cÚš”_s2
 
¡r_to_cÚš”s2
(* 
s2
);

62 
cÚš”s2_to_¡r
Ğ
ch_p_cÚš”_s2
 
s2
, * 
¡r
);

64 
cÚš”_to_¡r
(
p_cÚš”
, * 
¡r
);

66 
²ame_to_¡r
(
p
, * 
¤t
);

68 
ch_o_´iÜ™y
 
¡r_to_´iÜ™y
(* 
¡r
 );

70 
£gm’t_to_¡r
(* 
¡r
, 
£g
);

71 
ch_c_£gm’t
 
¡r_to_£gm’t
(*
¡r
);

73 
ch_n_Çme
 
¡r_to_ÇtiÚ
(* 
¡r
 );

74 
ÇtiÚ_to_¡r
Ğ
n_ÇtiÚ
 , * 
¡r
 );

76 
ch_r_Çme
 
¡r_to_»giÚ
(* 
¡r
);

77 
»giÚ_to_¡r
(
r_Çme
, * 
¡r
);

79 
EXIT_NAMESPACE
(
ch
);

	@src/dora/base_action.cpp

32 
	~"dÜa/ba£_aùiÚ.h
"

35 
ENTER_NAMESPACE
(
dÜa
);

39 
	gba£_aùiÚ_t
& ba£_aùiÚ_t::
İ”©Ü
=(cÚ¡ 
ba£_aùiÚ_t
& 
rhs
)

41 ià(
this
 !ğ&
rhs
) {

42 
_´vp
 = 
rhs
._prvp;

43 
	g_xù
 = 
rhs
.
_xù
;

44 
	g_tid
 = 
rhs
.
_tid
;

45 
	g_keys_Ãeded
 = 
rhs
.
_keys_Ãeded
;

46 
	g_keys_£t
 = 
rhs
.
_keys_£t
;

48  (*
	gthis
);

53 
EXIT_NAMESPACE
(
dÜa
);

	@src/dora/base_partition.cpp

32 
	~"dÜa/ba£_·¹™iÚ.h
"

35 
ENTER_NAMESPACE
(
dÜa
);

38 
	gba£_·¹™iÚ_t
::
	$ba£_·¹™iÚ_t
(
ShÜeEnv
* 
’v
, 
bË_desc_t
* 
±abË
,

39 cÚ¡ 
ušt
 
­¬tid
,

40 cÚ¡ 
´oûssÜid_t
 
­rsid
)

41 : 
	`_’v
(
’v
), 
	`_bË
(
±abË
),

42 
	`_·¹_id
(
­¬tid
), 
	`_·¹_pŞicy
(
PP_UNDEF
),

43 
	$_´s_id
(
­rsid
)

45 
	`as£¹
 (
_’v
);

46 
	`as£¹
 (
_bË
);

47 
	}
}

50 
	gba£_·¹™iÚ_t
::~
	$ba£_·¹™iÚ_t
()

52 
	}
}

55 
ba£_·¹™iÚ_t
::
	$£t_·¹_id
(cÚ¡ 
ušt
 
pid
)

57 
_·¹_id
 = 
pid
;

58 
	}
}

61 
eP¬t™iÚPŞicy
 
	gba£_·¹™iÚ_t
::
	$g‘_·¹_pŞicy
()

63  (
_·¹_pŞicy
);

64 
	}
}

66 
	gba£_·¹™iÚ_t
::
	$£t_·¹_pŞicy
(cÚ¡ 
eP¬t™iÚPŞicy
 
aP¬tPŞicy
)

68 
	`as£¹
 (
aP¬tPŞicy
!=
PP_UNDEF
);

69 
_·¹_pŞicy
 = 
aP¬tPŞicy
;

70 
	}
}

74 
	gba£_·¹™iÚ_t
::
	$dump
()

76 
	`TRACE
Ğ
TRACE_DEBUG
, "PŞicy (%d)\n", 
_·¹_pŞicy
);

77 
	}
}

80 
EXIT_NAMESPACE
(
dÜa
);

	@src/dora/dflusher.cpp

31 
	~"dÜa/dæush”.h
"

32 
	~"xù.h
"

34 
ENTER_NAMESPACE
(
dÜa
);

43 
	gdÜa_æush”_t
::
	$dÜa_æush”_t
(
ShÜeEnv
* 
³nv
,

44 
c_¡r
 
Šame
,

45 
´oûssÜid_t
 
­rsid
,

46 cÚ¡ 
u£_¦i
)

47 : 
	$æush”_t
(
³nv
, 
Šame
, 
­rsid
, 
u£_¦i
)

49 
_dÜa_toæush
 = 
Ãw
 
	`DÜaQueue
(
_pxù_toæush_poŞ
.
	`g‘
());

50 
	`as£¹
 (
_dÜa_toæush
.
	`g‘
());

51 
_dÜa_toæush
->
	`£tqueue
(
WS_COMMIT_Q
,
this
,2000,0);

53 
_dÜa_æushšg
 = 
Ãw
 
	`DÜaQueue
(
_pxù_æushšg_poŞ
.
	`g‘
());

54 
	`as£¹
 (
_dÜa_æushšg
.
	`g‘
());

55 
_dÜa_æushšg
->
	`£tqueue
(
WS_COMMIT_Q
,
this
,0,0);

58 
	`årštf
(
¡dout
, "Starting dora-notifier...\n");

59 
_nÙif›r
 = 
Ãw
 
	`dÜa_nÙif›r_t
(
_’v
, 
	`c_¡r
("DNotifier"));

60 
	`as£¹
(
_nÙif›r
.
	`g‘
());

61 
_nÙif›r
->
	`fÜk
();

62 
_nÙif›r
->
	`¡¬t
();

63 
	}
}

65 
	gdÜa_æush”_t
::~
	$dÜa_æush”_t
()

69 
	`as£¹
 (
_dÜa_toæush
->
	`is_em±y
());

70 
_dÜa_toæush
.
	`dÚe
();

72 
	`as£¹
 (
_dÜa_æushšg
->
	`is_em±y
());

73 
_dÜa_æushšg
.
	`dÚe
();

74 
	}
}

88 
	gdÜa_æush”_t
::
	$_check_wa™šg
(
boŞ
& 
bSË•Next
,

89 cÚ¡ 
l¢_t
& 
du¿bËl¢
,

90 
l¢_t
& 
maxl¢
,

91 
ušt
& 
wa™šg
)

93 
‹rmš®_rvp_t
* 
´vp
 = 
NULL
;

94 
l¢_t
 
xùl¢
;

97 (!
_dÜa_toæush
->
	`is_em±y
()è|| (
bSË•Next
)) {

100 
´vp
 = 
_dÜa_toæush
->
	`pİ
();

103 ià(
´vp
) {

104 
xùl¢
 = 
´vp
->
	`my_Ï¡_l¢
();

106 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

108 
´vp
->
	`tid
().
	`g‘_lo
(), 
xùl¢
.
	`lo
(), 
maxl¢
.lo());

112 ià(
du¿bËl¢
 > 
xùl¢
) {

114 
_nÙif›r
->
	`’queue_tÚÙify
(
´vp
);

115 
_¡©s
.
®»adyFlushed
++;

120 
maxl¢
 = 
¡d
::
	`max
(maxl¢,
xùl¢
);

121 
_dÜa_æushšg
->
	`push
(
´vp
,
çl£
);

122 
wa™šg
++;

126 
bSË•Next
 = 
çl£
;

127 
_¡©s
.
£rved
++;

131 
	}
}

145 
	gdÜa_æush”_t
::
	$_move_äom_æushšg
(cÚ¡ 
l¢_t
& 
du¿bËl¢
)

147 
‹rmš®_rvp_t
* 
´vp
 = 
NULL
;

148 
l¢_t
 
xùl¢
;

150 !
_dÜa_æushšg
->
	`is_em±y
()) {

151 
´vp
 = 
_dÜa_æushšg
->
	`pİ
();

152 
xùl¢
 = 
´vp
->
	`my_Ï¡_l¢
();

153 
	`as£¹
 (
xùl¢
 < 
du¿bËl¢
);

155 
_nÙif›r
->
	`’queue_tÚÙify
(
´vp
);

159 
	}
}

173 
	gdÜa_æush”_t
::
	$_´e_STOP_im¶
()

175 
ušt
 
aá”Stİ
 = 0;

176 
‹rmš®_rvp_t
* 
´vp
 = 
NULL
;

179 
_nÙif›r
->
	`¡İ
();

180 
_nÙif›r
->
	`još
();

187 !
_dÜa_æushšg
->
	`is_em±y
()) {

188 ++
aá”Stİ
;

189 
´vp
 = 
_dÜa_æushšg
->
	`pİ
();

190 
´vp
->
	`nÙify_ş›Á
();

191 
´vp
->
	`giveback
();

194 !
_dÜa_toæush
->
	`is_em±y
()) {

195 ++
aá”Stİ
;

196 
´vp
 = 
_dÜa_toæush
->
	`pİ
();

197 
´vp
->
	`nÙify_ş›Á
();

198 
´vp
->
	`giveback
();

201 ià(
aá”Stİ
>0) {

202 
	`TRACE
Ğ
TRACE_ALWAYS
,

204 
aá”Stİ
);

208 
	}
}

218 
	gdÜa_nÙif›r_t
::
	$dÜa_nÙif›r_t
(
ShÜeEnv
* 
’v
,

219 
c_¡r
 
Šame
,

220 
´oûssÜid_t
 
­rsid
,

221 cÚ¡ 
u£_¦i
)

222 : 
	$ba£_wÜk”_t
(
’v
, 
Šame
, 
­rsid
, 
u£_¦i
)

224 
_pxù_tÚÙify_poŞ
 = 
Ãw
 
	`PoŞ
((
xù_t
*),
FLUSHER_BUFFER_EXPECTED_SZ
);

225 
_tÚÙify
 = 
Ãw
 
	`DÜaQueue
(
_pxù_tÚÙify_poŞ
.
	`g‘
());

226 
	`as£¹
 (
_tÚÙify
.
	`g‘
());

227 
_tÚÙify
->
	`£tqueue
(
WS_COMMIT_Q
,
this
,0,0);

228 
	}
}

230 
	gdÜa_nÙif›r_t
::~
	$dÜa_nÙif›r_t
()

234 
	`as£¹
 (
_tÚÙify
->
	`is_em±y
());

235 
_tÚÙify
.
	`dÚe
();

236 
_pxù_tÚÙify_poŞ
.
	`dÚe
();

237 
	}
}

249 
	gdÜa_nÙif›r_t
::
	$_wÜk_ACTIVE_im¶
()

251 
’vV¬
* 
ev
 =ƒnvV¬::
	`š¡ªû
();

252 
bšdšg
 = 
ev
->
	`g‘V¬IÁ
("dora-cpu-binding",0);

253 ià(
bšdšg
==0è
_´s_id
 = 
PBIND_NONE
;

254 
	`TRY_TO_BIND
(
_´s_id
,
_is_bound
);

256 
‹rmš®_rvp_t
* 
´vp
 = 
NULL
;

259 
	`g‘_cÚŒŞ
(è=ğ
WC_ACTIVE
) {

262 
	`£t_ws
(
WS_LOOP
);

265 
´vp
 = 
_tÚÙify
->
	`pİ
();

267 ià(
´vp
) {

268 
´vp
->
	`upd_comm™‹d_¡©s
();

269 
´vp
->
	`nÙify_·¹™iÚs
();

270 
´vp
->
	`nÙify_ş›Á
();

271 
´vp
->
	`giveback
();

272 
´vp
 = 
NULL
;

276 
	}
}

290 
	gdÜa_nÙif›r_t
::
	$_´e_STOP_im¶
()

292 
ušt
 
aá”Stİ
 = 0;

293 
‹rmš®_rvp_t
* 
´vp
 = 
NULL
;

294 !
_tÚÙify
->
	`is_em±y
()) {

295 ++
aá”Stİ
;

297 
´vp
 = 
_tÚÙify
->
	`pİ
();

298 
´vp
->
	`upd_comm™‹d_¡©s
();

300 
´vp
->
	`nÙify_ş›Á
();

301 
´vp
->
	`giveback
();

302 
´vp
 = 
NULL
;

305 ià(
aá”Stİ
>0)

306 
	`TRACE
Ğ
TRACE_ALWAYS
,

308 
aá”Stİ
);

310 
	}
}

313 
EXIT_NAMESPACE
(
dÜa
);

	@src/dora/dkey_ranges_map.cpp

39 
	~"dÜa/dkey_¿nges_m­.h
"

41 
	~"sm/shÜe/shÜe_’v.h
"

44 
ENTER_NAMESPACE
(
dÜa
);

54 
	gdkey_¿nges_m­
::
	$dkey_¿nges_m­
(cÚ¡ 
¡id_t
& 
¡id
,

55 cÚ¡ 
cvec_t
& 
mšKey
,

56 cÚ¡ 
cvec_t
& 
maxKey
,

57 cÚ¡ 
ušt
 
numP¬ts
)

58 : 
	$_i¥Í
(
çl£
)

60 
w_rc_t
 
e
 = 
ss_m
::
	`g‘_¡Üe_šfo
(
¡id
,
_sšfo
);

61 ià(
e
.
	`is_”rÜ
()è{ 
	`as£¹
(0); }

62 
_rm­
 = 
Ãw
 
	`key_¿nges_m­
(
_sšfo
,
mšKey
,
maxKey
,
numP¬ts
,
çl£
);

63 
	}
}

67 
	gdkey_¿nges_m­
::
	$dkey_¿nges_m­
(cÚ¡ 
¡id_t
& 
¡id
,

68 
key_¿nges_m­
* 
krm
)

69 : 
	$_i¥Í
(
Œue
)

71 
_rm­
 = 
Ãw
 
	`key_¿nges_m­
();

72 *(
_rm­
èğ*(
krm
);

74 
w_rc_t
 
e
 = 
ss_m
::
	`g‘_¡Üe_šfo
(
¡id
,
_sšfo
);

75 ià(
e
.
	`is_”rÜ
()è{ 
	`as£¹
(0); }

76 
	}
}

78 
	gdkey_¿nges_m­
::~
	$dkey_¿nges_m­
()

80 ià((!
_i¥Í
è&& (
_rm­
)) {

81 
	`d–‘e
 (
_rm­
);

82 
_rm­
 = 
NULL
;

84 
	}
}

95 
w_rc_t
 
	gdkey_¿nges_m­
::
g‘_®l_·¹™iÚs
(
veùÜ
<
Íid_t
>& 
pidVec
)

97 (
_rm­
->
g‘AÎP¬t™iÚs
(
pidVec
));

110 
w_rc_t
 
	gdkey_¿nges_m­
::
	$add_·¹™iÚ
(cÚ¡ 
cvec_t
& 
key
, 
Íid_t
& 
Íid
)

112 (
_rm­
->
	`addP¬t™iÚ
(
key
,
Íid
));

113 
	}
}

128 
w_rc_t
 
	gdkey_¿nges_m­
::
	$d–‘e_·¹™iÚ
(cÚ¡ 
Íid_t
& )

130 
	`as£¹
 (0);

132  (
RCOK
);

133 
	}
}

142 
boŞ
 
	gdkey_¿nges_m­
::
	$is_§me
(cÚ¡ 
dkey_¿nges_m­
& 
drm
)

144 #w¬nšg 
IP
: 
FÜ
 
now
, 
	`is_§me
(è
checks
 
Úly
 
the
 
numb”
 
of
 
·¹™iÚs


145  (
_rm­
->
	`g‘NumP¬t™iÚs
(è=ğ
drm
._rmap->getNumPartitions());

146 
	}
}

162 
	g¿ngem­_smt_t
::
	$¿ngem­_smt_t
(
ShÜeEnv
* 
’v
, 
bË_desc_t
* 
bËdesc
, 
ušt
 
dty³
)

163 : 
	`th»ad_t
(
	`c_¡r
("RMS")),

164 
	`_’v
(
’v
), 
	`_bË
(
bËdesc
), 
	`_dty³
(
dty³
),

165 
	`_drm
(
NULL
), 
	$_rc
(
RCOK
)

167 
	}
}

169 
	g¿ngem­_smt_t
::~
	$¿ngem­_smt_t
()

171 
	}
}

173 
¿ngem­_smt_t
::
	$wÜk
()

175 
	`as£¹
 (
_’v
);

177 
tid_t
 
©id
;

178 
_rc
 = 
_’v
->
	`db
()->
	`begš_xù
(
©id
);

180 ià(!
_rc
.
	`is_”rÜ
()) {

182 ià(
_dty³
 & 
DT_PLAIN
) {

186 
¡id_t
 
¡id
 = 
_bË
->
	`g‘_´im¬y_¡id
();

187 
cvec_t
 
	`mšcv
(
_bË
->
	`g‘MšKey
(),_bË->
	`g‘MšKeyL’
());

188 
cvec_t
 
	`maxcv
(
_bË
->
	`g‘MaxKey
(),_bË->
	`g‘MaxKeyL’
());

189 
ušt
 
pút
 = 
_bË
->
	`pút
();

191 
_drm
 = 
Ãw
 
	`dkey_¿nges_m­
(
¡id
,
mšcv
,
maxcv
,
pút
);

194 ià(
_dty³
 & 
DT_PLP
) {

198 
key_¿nges_m­
* 
¬m
;

199 
_rc
 = 
_bË
->
	`g‘_maš_¿ngem­
(
¬m
);

200 
¡id_t
 
¡id
 = 
_bË
->
	`g‘_´im¬y_¡id
();

202 
_drm
 = 
Ãw
 
	`dkey_¿nges_m­
(
¡id
,
¬m
);

207 ià(
_rc
.
	`is_”rÜ
()) {

208 
_rc
 = 
_’v
->
	`db
()->
	`abÜt_xù
();

211 
_rc
 = 
_’v
->
	`db
()->
	`comm™_xù
();

213 
	}
}

218 
EXIT_NAMESPACE
(
dÜa
);

	@src/dora/dora_env.cpp

32 
	~"dÜa/commÚ.h
"

33 
	~"dÜa/dÜa_’v.h
"

35 
	~"ıu_šfo.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

39 
ENTER_NAMESPACE
(
dÜa
);

41 
	g·¹™iÚ_t
<> 
	tœpIm¶
;

53 
	gDÜaEnv
::
	$DÜaEnv
()

55 
	`_check_ty³
();

56 
	}
}

59 
	gDÜaEnv
::~
	$DÜaEnv
()

61 
	}
}

72 
ušt
 
DÜaEnv
::
	$dty³
() const

74  (
_dty³
);

75 
	}
}

77 
boŞ
 
	gDÜaEnv
::
	$is_dÜa
() const

79  (
_dty³
 & 
DT_PLAIN
);

80 
	}
}

82 
boŞ
 
	gDÜaEnv
::
	$is_¶p
() const

84  (
_dty³
 & 
DT_PLP
);

85 
	}
}

87 
ušt
 
	gDÜaEnv
::
	$upd©e_pd
(
ShÜeEnv
* 
³nv
)

89 
	`as£¹
 (
³nv
);

92 
	`_check_ty³
();

95 
³nv
->
	`add_pd
(
PD_NOLOCK
);

97 ià(
_dty³
 & 
DT_PLP
) {

98 
³nv
->
	`add_pd
(
PD_NOLATCH
);

101  (
_dty³
);

102 
	}
}

114 
	gDÜaEnv
::
	$_¡©i¡ics
(
ShÜeEnv
* )

117 
	`TRACE
Ğ
TRACE_STATISTICS
, "----- DORA -----\n");

118 
ušt
 
sz
=
_œ±p_vec
.
	`size
();

119 
	`TRACE
Ğ
TRACE_STATISTICS
, "TabË  = (%d)\n", 
sz
);

120 
ušt
 
i
=0;i<
sz
;++i) {

121 
_œ±p_vec
[
i
]->
	`¡©i¡ics
();

124 #ifdeà
CFG_FLUSHER


125 
	`TRACE
Ğ
TRACE_STATISTICS
, "Flush”s: (%d)\n", 
_num_æush”s
);

127 
ušt_t
 
i
=0; i<
_num_æush”s
; i++)

129 
_vec_æush”
[
i
]->
	`¡©i¡ics
();

133 
	}
}

146 
ušt
 
	gDÜaEnv
::
	$_check_ty³
()

149 
¡ršg
 
sy¢ame
 = 
’vV¬
::
	`š¡ªû
()->
	`g‘SysName
();

151 ià(
sy¢ame
.
	`com·»
("baseline")==0) {

152 
	`as£¹
(0);

155 ià(
sy¢ame
.
	`com·»
("dora")==0) {

156 
_dty³
 = 
DT_PLAIN
;

159 ià(
sy¢ame
.
	`com·»
("plp")==0) {

160 
_dty³
 = 
DT_PLP
;

163  (
_dty³
);

164 
	}
}

177 
	gDÜaEnv
::
	$_po¡_¡¬t
(
ShÜeEnv
* 
³nv
)

179 #ifdeà
CFG_FLUSHER


181 
	`TRACE
Ğ
TRACE_ALWAYS
, "Creating dora-flusher...\n");

184 
_num_æush”s
 = 
	`d‘”mšeNumFlush”s
();

185 
_vec_æush”
.
	`»£rve
(
_num_æush”s
);

189 
ušt_t
 
i
=0; i<
_num_æush”s
; i++)

191 
dÜa_æush”_t
* 
aFlush”
 = 
Ãw
 
	`dÜa_æush”_t
(
³nv
, 
	`c_¡r
("DFlush”-%d",
i
));

192 
	`w_as£¹0
(
aFlush”
);

194 
_vec_æush”
[
i
] = 
aFlush”
;

196 
aFlush”
->
	`fÜk
();

197 
aFlush”
->
	`¡¬t
();

203 
ušt_t
 
i
=0; i<
_œ±p_vec
.
	`size
(); i++) {

204 
_œ±p_vec
[
i
]->
	`»£t
();

207 
³nv
->
	`£t_dbc
(
DBC_ACTIVE
);

209 
	}
}

223 
	gDÜaEnv
::
	$_po¡_¡İ
(
ShÜeEnv
* 
³nv
)

226 
	`TRACE
Ğ
TRACE_ALWAYS
, "Stopping...\n");

228 
ušt
 
i
=0; i<
_œ±p_vec
.
	`size
(); i++)

230 ià(
_œ±p_vec
[
i
] !ğ
NULL
)

232 
	`TRACE
Ğ
TRACE_ALWAYS
, "Stoppingable (%s)...\n",

233 
_œ±p_vec
[
i
]->
	`bË
()->
	`Çme
());

235 
_œ±p_vec
[
i
]->
	`¡İ
();

236 
_œ±p_vec
[
i
] = 
NULL
;

239 
_œ±p_vec
.
	`ş—r
();

241 #ifdeà
CFG_FLUSHER


243 
ušt_t
 
i
=0; i<
_num_æush”s
; i++)

245 ià(
_vec_æush”
[
i
] !ğ
NULL
)

247 
	`TRACE
Ğ
TRACE_ALWAYS
, "Stİpšg dÜa-æush”-(%d)...\n",
i
);

249 
_vec_æush”
[
i
]->
	`¡İ
();

250 
_vec_æush”
[
i
]->
	`još
();

252 
	`d–‘e
 (
_vec_æush”
[
i
]);

253 
_vec_æush”
[
i
] = 
NULL
;

258 
³nv
->
	`£t_dbc
(
DBC_STOPPED
);

260 
	}
}

272 
w_rc_t
 
	gDÜaEnv
::
	$_Ãwrun
(
ShÜeEnv
* )

274 
	`TRACE
Ğ
TRACE_DEBUG
, "Preparing for‚ew„un...\n");

275 
ušt
 
i
=0; i<
_œ±p_vec
.
	`size
(); i++) {

276 
	`W_DO
(
_œ±p_vec
[
i
]->
	`´•¬eNewRun
());

278  (
RCOK
);

279 
	}
}

291 
	gDÜaEnv
::
	$_dump
(
ShÜeEnv
* )

293 
ušt
 
sz
=
_œ±p_vec
.
	`size
();

294 
	`TRACE
Ğ
TRACE_ALWAYS
, "TabË  = (%d)\n", 
sz
);

295 
ušt
 
i
=0; i<
sz
; i++) {

296 
_œ±p_vec
[
i
]->
	`dump
();

299 
	}
}

310 
	gDÜaEnv
::
	$_šfo
(cÚ¡ 
ShÜeEnv
* 
³nv
) const

312 
	`TRACE
Ğ
TRACE_ALWAYS
, "SF = (%.1f)\n", 
³nv
->
	`g‘_sf
());

313 
ušt
 
sz
=
_œ±p_vec
.
	`size
();

314 
	`TRACE
Ğ
TRACE_ALWAYS
, "TabË  = (%d)\n", 
sz
);

315 
ušt
 
i
=0;i<
sz
;++i) {

316 
_œ±p_vec
[
i
]->
	`šfo
();

319 
	}
}

344 
´oûssÜid_t
 
	gDÜaEnv
::
	$_Ãxt_ıu
(cÚ¡ 
´oûssÜid_t
& 
­rd
,

345 cÚ¡ 
œpTabËIm¶
* ,

346 cÚ¡ 
¡•
)

348 
bšdšg
 = 
’vV¬
::
	`š¡ªû
()->
	`g‘V¬IÁ
("dora-cpu-binding",0);

349 ià(
bšdšg
==0)

350  (
PBIND_NONE
);

352 
aùiveıu
 = 
’vV¬
::
	`š¡ªû
()->
	`g‘V¬IÁ
("active-cpu-count",64);

353 
´oûssÜid_t
 
Ãxrs
 = ((
­rd
+
¡•
è% 
aùiveıu
);

354 
	`TRACE
Ğ
TRACE_DEBUG
, "(%dè-> (%d)\n", 
­rd
, 
Ãxrs
);

355  (
Ãxrs
);

356 
	}
}

371 
ušt_t
 
	gDÜaEnv
::
	$d‘”mšeNumFlush”s
()

373 
numb”OfFlush”s
 = 1;

376 
sock‘CouÁ
 = 
ıu_šfo
::
	`sock‘_couÁ
();

377 ià(
sock‘CouÁ
 > 0)

379 
numb”OfFlush”s
 = 
sock‘CouÁ
;

380 
	`TRACE
Ğ
TRACE_STATISTICS
,

382 
numb”OfFlush”s
);

387 
numb”OfFlush”s
 = 
’vV¬
::
	`š¡ªû
()->
	`g‘V¬IÁ
("num-flushers",1);

388 ià(
numb”OfFlush”s
<=0)

390 
	`TRACE
Ğ
TRACE_ALWAYS
,

392 
numb”OfFlush”s
);

393 
numb”OfFlush”s
 = 1;

395 
	`TRACE
Ğ
TRACE_STATISTICS
,

397 
numb”OfFlush”s
);

399  ((
ušt_t
)
numb”OfFlush”s
);

400 
	}
}

406 
EXIT_NAMESPACE
(
dÜa
);

	@src/dora/logical_lock.cpp

32 
	~"dÜa/logiÿl_lock.h
"

35 
ENTER_NAMESPACE
(
dÜa
);

47 
	gDÜaLockModeM©rix
[
DL_CC_MODES
][DL_CC_MODES] = { {1, 1, 1},

52 #undeà
LOCKDEBUG


53 
	#LOCKDEBUG


	)

55 
	gPoŞedLi¡
<
	tAùiÚLockReq
>::
	tTy³
 
	tAùiÚLockReqLi¡
;

56 
	gAùiÚLockReqLi¡
::
	t™”©Ü
 
	tAùiÚLockReqLi¡It
;

57 
	gAùiÚLockReqLi¡
::
	tcÚ¡_™”©Ü
 
	tAùiÚLockReqLi¡C™
;

69 
	g¡d
::
o¡»am
&

70 
İ”©Ü
<<(
¡d
::
o¡»am
& 
os
, cÚ¡ 
	gAùiÚLockReq
& 
	grhs
)

72 
	gos
 << "(" << 
	grhs
.
	g_tid
 << "è(" <<„hs.
	g_dlm
 << "è(" <<„hs.
	g_aùiÚ
 << ")";

73  (
	gos
);

79 
	s´‘ty_´š‹r


81 
o¡ršg¡»am
 
	m_out
;

82 
¡ršg
 
	m_tmp
;

83 
İ”©Ü
 
	mo¡»am
&(è{  
	m_out
; }

84 
İ”©Ü
 cÚ¡*(è{ 
	m_tmp
 = 
_out
.
¡r
(); 
	m_out
.¡r("");  _tmp.
c_¡r
(); }

89 
	$_´št_logiÿl_lock_m­s
(
¡d
::
o¡»am
 &
out
, 
LogiÿlLock
& 
Î
)

91 
o
 = 
Î
.
	`owÃrs
().
	`size
();

93 
out
 << "OwÃr " << 
o
 << 
’dl
;

94 
i
=0;

95 
i
=0; i<
o
; ++i) {

96 
out
 << 
i
 << ". " << 
Î
.
	`owÃrs
()[i] << 
’dl
;

98 
out
 << "Wa™” " << 
o
 << 
’dl
;

99 
i
=0;

100 
AùiÚLockReqLi¡C™
 
™
=
Î
.
	`wa™”s
().
	`begš
(); it!öl.wa™”s().
	`’d
(); ++it) {

102 
out
 << ++
i
 << ". " << (*
™
è<< 
’dl
;

104 
	}
}

107 cÚ¡* 
	$db_´‘ty_´št
(
LogiÿlLock
* 
Î
, , const* )

109 
´‘ty_´š‹r
 
µ
;

110 
	`_´št_logiÿl_lock_m­s
(
µ
, *
Î
);

111  
µ
;

112 
	}
}

115 
_´št_key
(
¡d
::
o¡»am
 &
out
, 
key_w¿µ”_t
<> cÚ¡ &
key
)

117 
ušt
 
	gi
=0; i<
	gkey
.
	g_key_v
.
size
(); ++i) {

118 
	gout
 << 
	gkey
.
	g_key_v
.
©
(
i
è<< 
	g’dl
;

123 cÚ¡* 
db_´‘ty_´št
(
key_w¿µ”_t
<> cÚ¡* 
key
, , const* )

125 
´‘ty_´š‹r
 
	gµ
;

126 
_´št_key
(
µ
, *
key
);

127  
	gµ
;

139 
	gLogiÿlLock
::
	$LogiÿlLock
(
AùiÚLockReq
& 
ªowÃr
)

140 : 
	`_dlm
(
ªowÃr
.
	$dlm
())

143 
_owÃrs
.
	`»£rve
(1);

144 
_owÃrs
.
	`push_back
(
ªowÃr
);

145 
	}
}

164 
	gLogiÿlLock
::
	$»Ëa£
(
Ba£AùiÚPŒ
 
ªowÃr
,

165 
Ba£AùiÚPŒLi¡
& 
´omÙedLi¡
)

167 
	`as£¹
 (
ªowÃr
);

168 
boŞ
 
found
 = 
çl£
;

169 
tid_t
 
©id
 = 
ªowÃr
->
	`tid
();

170 
romÙed
 = 0;

174 
AùiÚLockReqVecIt
 
™
=
_owÃrs
.
	`begš
(); it!=_owÃrs.
	`’d
(); ++it) {

175 
tid_t
* 
owÃ¹id
 = (*
™
).
	`tid
();

176 
	`w_as£¹1
 (
owÃ¹id
);

177 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Checking (%d) - Owner (%d)\n",

178 
©id
.
	`g‘_lo
(), 
owÃ¹id
->get_lo());

181 ià(
©id
==*
owÃ¹id
) {

182 
found
 = 
Œue
;

185 
_owÃrs
.
	`”a£
(
™
);

188 ià(
	`_upd_dlm
()) {

192 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

194 
©id
.
	`g‘_lo
(), 
_owÃrs
.
	`size
(), 
_dlm
);

195 
Ba£AùiÚPŒ
 
aùiÚ
 = 
NULL
;

199 
	`_h—d_ÿn_acquœe
()) {

201 
AùiÚLockReq
 
h—d
 = 
_wa™”s
.
	`äÚt
();

202 
aùiÚ
 = 
h—d
.
	`aùiÚ
();

206 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "(%d)…romoting (%d)\n",

207 
©id
.
	`g‘_lo
(), 
aùiÚ
->
	`tid
().get_lo());

208 
´omÙedLi¡
.
	`push_back
(
aùiÚ
);

211 
_owÃrs
.
	`push_back
(
h—d
);

212 ++
romÙed
;

215 
_wa™”s
.
	`pİ_äÚt
();

218 
	`_upd_dlm
();

219 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

221 
©id
.
	`g‘_lo
(), 
_owÃrs
.
	`size
(), 
romÙed
, 
_dlm
);

225 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

227 
©id
.
	`g‘_lo
(), 
_owÃrs
.
	`size
(), 
romÙed
, 
_dlm
);

233 iàĞ!
found
 )

235 ià(
_dlm
 =ğ
DL_CC_NOLOCK
)

237 
	`TRACE
Ğ
TRACE_ALWAYS
,

239 
©id
.
	`g‘_lo
(), 
_wa™”s
.
	`size
() );

241 
Ba£AùiÚPŒ
 
aùiÚ
 = 
NULL
;

245 
	`_h—d_ÿn_acquœe
())

248 
AùiÚLockReq
 
h—d
 = 
_wa™”s
.
	`äÚt
();

249 
aùiÚ
 = 
h—d
.
	`aùiÚ
();

253 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "(%d)…romoting (%d)\n",

254 
©id
.
	`g‘_lo
(), 
aùiÚ
->
	`tid
().get_lo());

255 
´omÙedLi¡
.
	`push_back
(
aùiÚ
);

258 
_owÃrs
.
	`push_back
(
h—d
);

259 ++
romÙed
;

262 
_wa™”s
.
	`pİ_äÚt
();

265 
	`_upd_dlm
();

266 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

268 
©id
.
	`g‘_lo
(), 
_owÃrs
.
	`size
(), 
romÙed
, 
_dlm
);

275 
	`w_as£¹0
 (
found
 && (
_dlm
 !ğ
DL_CC_NOLOCK
) );

279  (
romÙed
);

280 
	}
}

295 
boŞ
 
	gLogiÿlLock
::
	$acquœe
(
AùiÚLockReq
& 
®r
)

297 
	`as£¹
 (
®r
.
	`aùiÚ
());

300 
AùiÚLockReqVecIt
 
™
=
_owÃrs
.
	`begš
(); it!=_owÃrs.
	`’d
(); ++it) {

301 ià(
®r
.
	`isSame
((*
™
))) {

304 ià(
_dlm
 =ğ
®r
.
	`dlm
()) {

306  (
Œue
);

310 ià(
_owÃrs
.
	`size
()==1) {

312 ià(
_dlm
 < 
®r
.
	`dlm
()) _dlm =‡lr.dlm();

314  (
Œue
);

318 
	`TRACE
 (
TRACE_ALWAYS
,

320 
_dlm
, 
®r
.
	`dlm
());

321 
	`as£¹
 (0);

322  (
çl£
);

334 ià(!
DÜaLockModeM©rix
[
_dlm
][
®r
.
	`dlm
()]) {

335 
	`as£¹
 (
_owÃrs
.
	`size
());

336 
_wa™”s
.
	`push_back
(
®r
);

337  (
çl£
);

348 
AùiÚLockReqLi¡It
 
™
=
_wa™”s
.
	`begš
(); it!=_wa™”s.
	`’d
(); ++it) {

353 
eDÜaLockMode
 
wdlm
 = (*
™
).
	`dlm
();

354 ià(!
DÜaLockModeM©rix
[
wdlm
][
®r
.
	`dlm
()]) {

355 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

357 
®r
.
	`tid
()->
	`g‘_lo
(), 
wdlm
,‡Ì.
	`dlm
());

360 
_wa™”s
.
	`push_back
(
®r
);

361  (
çl£
);

369 
_owÃrs
.
	`push_back
(
®r
);

372 ià(
®r
.
	`dlm
(è!ğ
DL_CC_NOLOCK
è
_dlm
 =‡lr.dlm();

374 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

376 
®r
.
	`tid
()->
	`g‘_lo
(), 
_owÃrs
.
	`size
(), 
_dlm
);

378  (
Œue
);

379 
	}
}

392 
boŞ
 
	gLogiÿlLock
::
	$_h—d_ÿn_acquœe
()

394 ià(
_wa™”s
.
	`em±y
()è (
çl£
);

395  (
DÜaLockModeM©rix
[
_dlm
][
_wa™”s
.
	`äÚt
().
	`dlm
()]);

396 
	}
}

410 
boŞ
 
	gLogiÿlLock
::
	$_upd_dlm
()

413 ià(
_owÃrs
.
	`em±y
()) {

415 ià(
_dlm
!=
DL_CC_NOLOCK
) {

417 
_dlm
=
DL_CC_NOLOCK
;

418  (
Œue
);

421  (
çl£
);

425 
eDÜaLockMode
 
Ãw_dlm
 = 
DL_CC_NOLOCK
;

426 
eDÜaLockMode
 
odlm
 = 
DL_CC_NOLOCK
;

427 
boŞ
 
chªged
 = 
çl£
;

430 
AùiÚLockReqVecIt
 
™
=
_owÃrs
.
	`begš
(); it!=_owÃrs.
	`’d
(); ++it) {

431 
odlm
 = (*
™
).
	`dlm
();

434 ià(!
DÜaLockModeM©rix
[
Ãw_dlm
][
odlm
]) {

435 
	`as£¹
 (0);

439 ià(
odlm
!=
DL_CC_NOLOCK
) {

440 
Ãw_dlm
 = 
odlm
;

446 
chªged
 = (
_dlm
 !ğ
Ãw_dlm
);

447 
_dlm
 = 
Ãw_dlm
;

450  (
chªged
);

451 
	}
}

463 
boŞ
 
	gLogiÿlLock
::
	$is_ş—n
() const

465 
boŞ
 
isCËª
 = (
_owÃrs
.
	`em±y
()è&& (
_wa™”s
.em±y()è&& (
_dlm
 =ğ
DL_CC_NOLOCK
);

466  (
isCËª
);

467 
	}
}

480 
	gLogiÿlLock
::
abÜt_ªd_»£t
(
veùÜ
<
xù_t
*>& 
tßbÜt
)

485 
AùiÚLockReqVecIt
 
™
=
_owÃrs
.
begš
(); 
	g™
!=_owÃrs.
’d
(); ++it) {

486 
xù_t
* 
	gviùim
 = (*
™
).
aùiÚ
()->
xù
();

487 
	gcout
 << (*
	g™
è<< 
	g’dl
;

488 
	gtßbÜt
.
push_back
(
viùim
);

492 
	g_owÃrs
.
ş—r
();

493 
	g_wa™”s
.
ş—r
();

494 
	g_dlm
 = 
DL_CC_NOLOCK
;

502 
	g¡d
::
o¡»am
&

503 
İ”©Ü
<<(
¡d
::
o¡»am
& 
os
, 
	gLogiÿlLock
& 
	grhs
)

505 
	gos
 << "lock: " << 
	grhs
.
dlm
(è<< 
	g’dl
;

506 
	gos
 << "owÃrs: " << 
	grhs
.
owÃrs
().
size
(è<< 
	g’dl
;

507 
ušt
 
	gi
=0; i<
	grhs
.
owÃrs
().
size
(); ++i) {

508 
	gos
 << 
	grhs
.
owÃrs
()[
i
] << 
	g’dl
;

511 
	gos
 << "wa™”s: " << 
	grhs
.
wa™”s
().
size
(è<< 
	g’dl
;

512 
AùiÚLockReqLi¡C™
 
	g™
=
rhs
.
wa™”s
().
begš
(); it!ôhs.wa™”s().
’d
(); ++it) {

513 
	gos
 << (*
	g™
è<< 
	g’dl
;

515  (
	gos
);

519 
EXIT_NAMESPACE
(
dÜa
);

	@src/dora/part_table.cpp

33 
	~<c¡dio
>

35 
	~"dÜa/·¹_bË.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

40 
ENTER_NAMESPACE
(
dÜa
);

49 
	g·¹_bË_t
::
	$·¹_bË_t
(
ShÜeEnv
* 
’v
, 
bË_desc_t
* 
±abË
,

50 cÚ¡ 
´oûssÜid_t
 
­rs
,

51 cÚ¡ 
ušt
 
aıu¿nge
,

52 cÚ¡ 
ušt
 
keyE¡im©iÚ
)

53 : 
	`_’v
(
’v
), 
	`_bË
(
±abË
),

54 
	`_¡¬t_´s_id
(
­rs
), 
	`_Ãxt_´s_id
×´s), 
	`_´s_¿nge
(
aıu¿nge
),

55 
	$_key_e¡im©iÚ
(
keyE¡im©iÚ
)

57 
	`as£¹
 (
_’v
);

58 
	`as£¹
 (
_bË
);

59 
_bµm­
.
	`ş—r
();

60 
	}
}

63 
	g·¹_bË_t
::~
	$·¹_bË_t
()

65 
	}
}

68 
bË_desc_t
* 
·¹_bË_t
::
	$bË
() const

70  (
_bË
);

71 
	}
}

81 
w_rc_t
 
	g·¹_bË_t
::
	$¡İ
()

83 
	`CRITICAL_SECTION
(
±cs
, 
_lock
);

85 
BPPM­It
 
™
=
_bµm­
.
	`begš
(); iˆ!ğ_bµm­.
	`’d
(); it++) {

86 (*
™
).
£cÚd
->
	`¡İ
();

87 
	`d–‘e
 (*
™
).
£cÚd
;

89 
_bµm­
.
	`ş—r
();

90  (
RCOK
);

91 
	}
}

106 
w_rc_t
 
	g·¹_bË_t
::
	$´•¬eNewRun
()

108 
	`CRITICAL_SECTION
(
±cs
, 
_lock
);

111 
BPPM­It
 
™
=
_bµm­
.
	`begš
(); iˆ!ğ_bµm­.
	`’d
(); it++) {

112 
	`W_DO
((*
™
).
£cÚd
->
	`´•¬eNewRun
());

116 
	`W_DO
(
	`»·¹™iÚ
());

117  (
RCOK
);

118 
	}
}

131 
w_rc_t
 
	g·¹_bË_t
::
	$»£t
()

133 
	`CRITICAL_SECTION
(
±cs
, 
_lock
);

135 
	`TRACE
Ğ
TRACE_DEBUG
, "Re£tšg (%s)...\n", 
_bË
->
	`Çme
());

136 
_Ãxt_´s_id
 = 
_¡¬t_´s_id
;

138 
BPPM­It
 
™
=
_bµm­
.
	`begš
(); iˆ!ğ_bµm­.
	`’d
(); it++) {

139 (*
™
).
£cÚd
->
	`»£t
(
_Ãxt_´s_id
);

140 
_Ãxt_´s_id
 = 
	`Ãxt_ıu
(_next_prs_id);

142  (
RCOK
);

143 
	}
}

157 
w_rc_t
 
	g·¹_bË_t
::
	$move
(cÚ¡ 
´oûssÜid_t
 
­rs
, cÚ¡ 
ušt
 
¬ªge
)

161 
	`CRITICAL_SECTION
(
±cs
, 
_lock
);

162 
_¡¬t_´s_id
 = 
­rs
;

163 
_´s_¿nge
 = 
¬ªge
;

166  (
	`»£t
());

167 
	}
}

188 
´oûssÜid_t
 
	g·¹_bË_t
::
	$Ãxt_ıu
(cÚ¡ 
´oûssÜid_t
& 
­rd
)

190 
bšdšg
 = 
’vV¬
::
	`š¡ªû
()->
	`g‘V¬IÁ
("dora-cpu-binding",0);

191 ià(
bšdšg
==0) {

192  (
PBIND_NONE
);

195 
·¹™iÚ_¡•
 = 
’vV¬
::
	`š¡ªû
()->
	`g‘V¬IÁ
("dora-cpu-partition-step",

196 
DF_CPU_STEP_PARTITIONS
);

197 
´oûssÜid_t
 
Ãxrs
 = ((
­rd
+
·¹™iÚ_¡•
è% 
_’v
->
	`g‘_aùive_ıu_couÁ
());

198  (
Ãxrs
);

199 
	}
}

210 
	g·¹_bË_t
::
	$¡©i¡ics
() const

212 
	`TRACE
Ğ
TRACE_STATISTICS
, "TabË (%s)\n", 
_bË
->
	`Çme
());

214 
wÜk”_¡©s_t
 
ws_g©h”ed
;

215 
ušt
 
¡l_sz
 = 0;

217 
BPPM­CIt
 
™
=
_bµm­
.
	`begš
(); iˆ!ğ_bµm­.
	`’d
(); it++) {

219 (*
™
).
£cÚd
->
	`¡©i¡ics
(
ws_g©h”ed
);

222 (*
™
).
£cÚd
->
	`¡lsize
(
¡l_sz
);

225 ià(
ws_g©h”ed
.
_´oûs£d
 > 
MINIMUM_PROCESSED
) {

226 
	`TRACE
Ğ
TRACE_STATISTICS
, "P¬t (%d)\n", 
_bË
->
	`pút
());

229 
ws_g©h”ed
.
	`´št_ªd_»£t
();

231 
	`TRACE
Ğ
TRACE_STATISTICS
, "¡l.’Œ› (%d)\n", 
¡l_sz
);

233 
	}
}

236 
	g·¹_bË_t
::
	$šfo
() const

238 
	`TRACE
Ğ
TRACE_STATISTICS
, "TabË (%s)\n", 
_bË
->
	`Çme
());

239 
	`TRACE
Ğ
TRACE_STATISTICS
, "P¬t (%d)\n", 
_bË
->
	`pút
());

240 
	}
}

243 
	g·¹_bË_t
::
	$dump
() const

245 
	`TRACE
Ğ
TRACE_DEBUG
, "TabË (%s)\n", 
_bË
->
	`Çme
());

246 
	`TRACE
Ğ
TRACE_DEBUG
, "P¬t (%d)\n", 
_bË
->
	`pút
());

248 
BPPM­CIt
 
™
=
_bµm­
.
	`begš
(); iˆ!ğ_bµm­.
	`’d
(); it++) {

249 (*
™
).
£cÚd
->
	`dump
();

251 
	}
}

254 
EXIT_NAMESPACE
(
dÜa
);

	@src/dora/partition.cpp

33 
	~"dÜa/·¹™iÚ.h
"

34 
	~"dÜa/aùiÚ.h
"

37 
ENTER_NAMESPACE
(
dÜa
);

40 
	s´‘ty_´š‹r


42 
o¡ršg¡»am
 
	m_out
;

43 
¡ršg
 
	m_tmp
;

44 
İ”©Ü
 
	mo¡»am
&(è{  
	m_out
; }

45 
İ”©Ü
 const*()

47 
	m_tmp
 = 
_out
.
¡r
();

48 
	m_out
.
¡r
("");

49  
	m_tmp
.
c_¡r
();

54 
_´št_·¹™iÚ
(
¡d
::
o¡»am
 &
out
, cÚ¡ 
·¹™iÚ_t
<> &
·¹
)

56 
	gout
 << "P¬t™iÚ: " << 
	g·¹
.
bË
()->
Çme
(è<< "-" <<…¬t.
·¹_id
(è<< 
	g’dl
;

57 
	gout
 << "IÅut: " << !
	g·¹
.
has_šput
(è<< 
	g’dl
;

58 
	gout
 << "Comm™: " << !
	g·¹
.
has_comm™‹d
(è<< 
	g’dl
;

61 cÚ¡* 
db_´‘ty_´št
(cÚ¡ 
·¹™iÚ_t
<>* 
·¹
,

65 
´‘ty_´š‹r
 
	gµ
;

66 
_´št_·¹™iÚ
(
µ
, *
·¹
);

67  
	gµ
;

71 
EXIT_NAMESPACE
(
dÜa
);

	@src/dora/range_part_table.cpp

33 
	~"dÜa/¿nge_·¹_bË.h
"

34 
	~"dÜa/dÜa_”rÜ.h
"

36 
usšg
 
Çme¥aû
 
	gshÜe
;

39 
ENTER_NAMESPACE
(
dÜa
);

50 
	g¿nge_bË_t
::
	$¿nge_bË_t
(
ShÜeEnv
* 
’v
, 
bË_desc_t
* 
±abË
, cÚ¡ 
ušt
 
dty³
,

51 cÚ¡ 
´oûssÜid_t
 
­rs
,

52 cÚ¡ 
ušt
 
aıu¿nge
,

53 cÚ¡ 
ušt
 
keyE¡im©iÚ
)

54 : 
	`·¹_bË_t
(
’v
,
±abË
,
­rs
,
aıu¿nge
,
keyE¡im©iÚ
), 
	$_dty³
(
dty³
)

56 
_´M­
 = 
NULL
;

57 
	}
}

60 
	g¿nge_bË_t
::~
	$¿nge_bË_t
()

62 
	}
}

81 
w_rc_t
 
¿nge_bË_t
::
	$»·¹™iÚ
()

85 
dkey_¿nges_m­
* 
drm
 = 
NULL
;

86 
	`W_DO
(
	`_g‘_upd©ed_m­
(
drm
));

87 
	`as£¹
(
drm
);

88 ià((
_´M­
 !ğ
NULL
è&& (_´M­->
	`is_§me
(*
drm
))) {

89 
	`TRACE
Ğ
TRACE_STATISTICS
, "Not…artitioning changes in (%s)\n",

90 
_bË
->
	`Çme
());

91 
	`d–‘e
 (
drm
);

92  (
RCOK
);

97 
_´M­
 = 
drm
;

98 
	`as£¹
 (
_´M­
);

101 
Ba£P¬t™iÚPŒM­
 
tmpm­
 = 
_bµm­
;

104 
_bµm­
.
	`ş—r
();

107 
veùÜ
<
Íid_t
> 
pidVec
;

108 
	`W_DO
(
_´M­
->
	`g‘_®l_·¹™iÚs
(
pidVec
));

112 
veùÜ
<
Íid_t
>::
™”©Ü
 
pidIt
 = 
pidVec
.
	`begš
();

113 
BPPM­It
 
ŞdP¬tIt
 = 
tmpm­
.
	`begš
();

114 
ušt
 
út
=0;

116 (
pidIt
 !ğ
pidVec
.
	`’d
()è&& (
ŞdP¬tIt
 !ğ
tmpm­
.end())) {

120 
_bµm­
[(*
pidIt
).
·ge
] = (*
ŞdP¬tIt
).
£cÚd
;

121 
pidIt
++;

122 
ŞdP¬tIt
++;

123 
út
++;

126 ià(
út
>0) {

127 
	`TRACE
Ğ
TRACE_STATISTICS
, "Repositioned (%d) (%s)…artitions\n",

128 
út
, 
_bË
->
	`Çme
());

129 
út
=0;

133 
ŞdP¬tIt
 !ğ
tmpm­
.
	`’d
()) {

135 (*
ŞdP¬tIt
).
£cÚd
->
	`¡İ
();

136 
	`d–‘e
 ((*
ŞdP¬tIt
).
£cÚd
);

137 
ŞdP¬tIt
++;

138 
út
++;

141 ià(
út
>0) {

142 
	`TRACE
Ğ
TRACE_STATISTICS
, "Deleted (%d) (%s)…artitions\n",

143 
út
, 
_bË
->
	`Çme
());

144 
út
=0;

148 
pidIt
 !ğ
pidVec
.
	`’d
()) {

153 
ba£_·¹™iÚ_t
* 
abp
 = 
NULL
;

154 
	`W_DO
(
	`ü—‹_Úe_·¹
((*
pidIt
).
·ge
,
abp
));

155 
	`as£¹
 (
abp
);

156 
_bµm­
[(*
pidIt
).
·ge
] = 
abp
;

157 
pidIt
++;

158 
út
++;

161 ià(
út
>0) {

162 
	`TRACE
Ğ
TRACE_STATISTICS
, "Created (%d) (%s)…artitions\n",

163 
út
, 
_bË
->
	`Çme
());

164 
út
=0;

166  (
RCOK
);

167 
	}
}

182 
w_rc_t
 
	g¿nge_bË_t
::
	$_g‘_upd©ed_m­
(
dkey_¿nges_m­
*& 
drm
)

184 
w_rc_t
 
r
 = 
RCOK
;

186 
¿ngem­_smt_t
* 
rsm
 = 
Ãw
 
	`¿ngem­_smt_t
(
_’v
,
_bË
,
_dty³
);

187 
	`as£¹
 (
rsm
);

188 
rsm
->
	`fÜk
();

189 
rsm
->
	`još
();

191 
r
 = 
rsm
->
_rc
;

192 ià(!
r
.
	`is_”rÜ
()è{ 
drm
 = 
rsm
->
_drm
; }

194 
	`d–‘e
(
rsm
);

195 
rsm
 = 
NULL
;

197  (
r
);

198 
	}
}

212 
w_rc_t
 
	g¿nge_bË_t
::
	$ü—‹_Úe_·¹
(cÚ¡ 
shpid_t
& 
pid
, 
ba£_·¹™iÚ_t
*& 
abp
)

215 
w_rc_t
 
r
 = 
	`_ü—‹_Úe_·¹
(
pid
,
abp
);

217 ià(
r
.
	`is_”rÜ
()) {

218 
	`TRACE
Ğ
TRACE_ALWAYS
, "Problem in creating…artition for (%s)\n",

219 
_bË
->
	`Çme
());

220  (
	`RC
(
de_GEN_PARTITION
));

224 
P¬tTabË
::
_Ãxt_´s_id
 = P¬tTabË::
	`Ãxt_ıu
(PartTable::_next_prs_id);

225  (
r
);

226 
	}
}

229 
EXIT_NAMESPACE
(
dÜa
);

	@src/dora/rvp.cpp

31 
	~"dÜa/rvp.h
"

32 
	~"dÜa/dÜa_’v.h
"

34 
ENTER_NAMESPACE
(
dÜa
);

43 
	grvp_t
::
	$rvp_t
()

44 : 
	$ba£_»que¡_t
()

45 { 
	}
}

47 
rvp_t
::
	$rvp_t
(
xù_t
* 
axù
, cÚ¡ 
tid_t
& 
©id
, cÚ¡ 
axùid
,

48 cÚ¡ 
Œx_»suÉ_tu¶e_t
& 
´esuÉ
,

49 cÚ¡ 
ušt
 
šŒa_Œx_út
, cÚ¡ ušˆ
tÙ®_aùiÚs
)

51 
	`_£t
(
axù
, 
©id
, 
axùid
,

52 
´esuÉ
, 
šŒa_Œx_út
, 
tÙ®_aùiÚs
);

53 
	}
}

62 
	grvp_t
::
	$rvp_t
(cÚ¡ 
rvp_t
& 
rhs
)

63 : 
	$ba£_»que¡_t
()

65 
	`_£t
(
rhs
.
_xù
,„hs.
_tid
,„hs.
_xù_id
,„hs.
_»suÉ
,

66 
rhs
.
_couÁdown
.
	`»maššg
(),„hs.
_aùiÚs
.
	`size
());

67 
	`cİy_aùiÚs
(
rhs
.
_aùiÚs
);

68 
	}
}

70 
	grvp_t
&„vp_t::
İ”©Ü
=(cÚ¡ 
rvp_t
& 
rhs
)

72 ià(
this
 !ğ&
rhs
) {

73 
_£t
(
rhs
.
_xù
,rhs.
_tid
,rhs.
_xù_id
,rhs.
_»suÉ
,

74 
rhs
.
_couÁdown
.
»maššg
(),rhs.
_aùiÚs
.
size
());

75 
cİy_aùiÚs
(
rhs
.
_aùiÚs
);

77  (*
	gthis
);

88 
	grvp_t
::
	$cİy_aùiÚs
(cÚ¡ 
ba£AùiÚsLi¡
& 
aùiÚLi¡
)

90 
_aùiÚs
.
	`»£rve
(
aùiÚLi¡
.
	`size
());

91 
_aùiÚs
.
	`assign
(
aùiÚLi¡
.
	`begš
(),aùiÚLi¡.
	`’d
());

93 
	}
}

106 
	grvp_t
::
	$­³nd_aùiÚs
(cÚ¡ 
ba£AùiÚsLi¡
& 
aùiÚLi¡
)

108 
	`CRITICAL_SECTION
(
aùiÚ_cs
, 
_aùiÚs_lock
);

110 
_aùiÚs
.
	`š£¹
(_aùiÚs.
	`’d
(), 
aùiÚLi¡
.
	`begš
(),actionList.end());

112 
	}
}

123 
	grvp_t
::
	$add_aùiÚ
(
ba£_aùiÚ_t
* 
·ùiÚ
)

125 
	`as£¹
 (
·ùiÚ
);

126 
	`as£¹
 (
this
==
·ùiÚ
->
	`rvp
());

127 
_aùiÚs
.
	`push_back
(
·ùiÚ
);

129 
	}
}

141 
w_rc_t
 
	grvp_t
::
	$run
()

143 
w_rc_t
 
e
 = 
	`_run
();

144 
	`giveback
();

145  (
e
);

146 
	}
}

155 
	g‹rmš®_rvp_t
::
	$‹rmš®_rvp_t
()

156 : 
	`rvp_t
(), 
	`_db
(
NULL
), 
	$_d’v
(
NULL
)

158 
	}
}

174 
	g‹rmš®_rvp_t
::
	$‹rmš®_rvp_t
(cÚ¡ 
‹rmš®_rvp_t
& 
rhs
)

175 : 
	$rvp_t
(
rhs
)

177 
_db
 = 
rhs
._db;

178 
_d’v
 = 
rhs
._denv;

179 
	}
}

181 
	g‹rmš®_rvp_t
&”mš®_rvp_t::
İ”©Ü
=(cÚ¡ 
‹rmš®_rvp_t
& 
rhs
)

183 
rvp_t
::
İ”©Ü
=(
rhs
);

184 
	g_db
 = 
rhs
.
_db
;

185 
	g_d’v
 = 
rhs
.
_d’v
;

186  (*
	gthis
);

189 
	g‹rmš®_rvp_t
::~
	$‹rmš®_rvp_t
()

191 
	}
}

202 
‹rmš®_rvp_t
::
	$nÙify_·¹™iÚs
()

204 #w¬nšg (
IP
è
P”f
. 
İtimiz©iÚ
 --> 
Do
 
nÙ
 
’queue_comm™‹d
 
your
 
own
 
aùiÚ
!

206 
ba£AùiÚsIt
 
™
=
_aùiÚs
.
	`begš
(); it!=_aùiÚs.
	`’d
(); ++it) {

207 (*
™
)->
	`nÙify_own_·¹™iÚ
();

209  (
_aùiÚs
.
	`size
());

210 
	}
}

220 
w_rc_t
 
	g‹rmš®_rvp_t
::
	$run
()

222 (
	`_run
());

223 
	}
}

237 
w_rc_t
 
	g‹rmš®_rvp_t
::
	$_run
()

239 
	`w_as£¹4
 (
_db
);

240 
	`w_as£¹4
 (
_d’v
);

243 
	`w_as£¹1
 (
_xù
);

244 
smth»ad_t
::
	`me
()->
	`©ch_xù
(
_xù
);

247 
w_rc_t
 
rcdec
;

248 ià(
_decisiÚ
 =ğ
AD_ABORT
)

252 
rcdec
 = 
_db
->
	`abÜt_xù
();

254 ià(
rcdec
.
	`is_”rÜ
())

256 
	`TRACE
Ğ
TRACE_ALWAYS
, "Xct (%d)‡bort failed [0x%x]\n",

257 
_tid
.
	`g‘_lo
(), 
rcdec
.
	`”r_num
());

261 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Xù (%dèabÜ‹d\n", 
_tid
.
	`g‘_lo
());

262 
	`upd_abÜ‹d_¡©s
();

265 #ifdeà
CFG_FLUSHER


266 
	`nÙify_Ú_abÜt
();

271 #ifdeà
CFG_FLUSHER


273 
l¢_t
 
xùLa¡L¢
;

274 
rcdec
 = 
_db
->
	`comm™_xù
(
Œue
,&
xùLa¡L¢
);

275 
	`£t_Ï¡_l¢
(
xùLa¡L¢
);

277 
rcdec
 = 
_db
->
	`comm™_xù
();

280 ià(
rcdec
.
	`is_”rÜ
()) {

281 
	`TRACE
Ğ
TRACE_ALWAYS
, "Xct (%d) commit failed [0x%x]\n",

282 
_tid
.
	`g‘_lo
(), 
rcdec
.
	`”r_num
());

283 
	`upd_abÜ‹d_¡©s
();

284 
w_rc_t
 
—bÜt
 = 
_db
->
	`abÜt_xù
();

286 ià(
—bÜt
.
	`is_”rÜ
()) {

287 
	`TRACE
Ğ
TRACE_ALWAYS
, "Xct (%d)‡bort failed [0x%x]\n",

288 
_tid
.
	`g‘_lo
(), 
—bÜt
.
	`”r_num
());

291 #ifdeà
CFG_FLUSHER


292 
	`nÙify_Ú_abÜt
();

296 #ifdeà
CFG_FLUSHER


298 
_d’v
->
	`’queue_toæush
(
this
);

300 ()
_d’v
;

301 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Xù (%dècomm™‹d\n", 
_tid
.
	`g‘_lo
());

302 
	`upd_comm™‹d_¡©s
();

307 #iâdeà
CFG_FLUSHER


311 
	`nÙify_ş›Á
();

315 
	`nÙify_·¹™iÚs
();

316 
	`giveback
();

319  (
rcdec
);

320 
	}
}

337 
	g‹rmš®_rvp_t
::
	$nÙify_Ú_abÜt
()

346 
	`nÙify_·¹™iÚs
();

347 
	`nÙify_ş›Á
();

349 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Givšg back‡bÜ‹d (%d)\n", 
_tid
.
	`g‘_lo
());

351 
	`giveback
();

352 
	}
}

354 
EXIT_NAMESPACE
(
dÜa
);

	@src/dora/tm1/dora_tm1.cpp

31 
	~"s.h
"

33 
	~"dÜa/tm1/dÜa_tm1.h
"

34 
	~"dÜa/tm1/dÜa_tm1_im¶.h
"

36 
usšg
 
Çme¥aû
 
	gshÜe
;

37 
usšg
 
Çme¥aû
 
	gtm1
;

40 
ENTER_NAMESPACE
(
dÜa
);

45 cÚ¡ 
ušt
 
	gsub_IRP_KEY
 = 1;

46 cÚ¡ 
ušt
 
	gai_IRP_KEY
 = 2;

47 cÚ¡ 
ušt
 
	gsf_IRP_KEY
 = 2;

48 cÚ¡ 
ušt
 
	gcf_IRP_KEY
 = 3;

51 cÚ¡ 
ušt
 
	gsub_KEY_EST
 = 1000;

52 cÚ¡ 
ušt
 
	gai_KEY_EST
 = 2500;

53 cÚ¡ 
ušt
 
	gsf_KEY_EST
 = 2500;

54 cÚ¡ 
ušt
 
	gcf_KEY_EST
 = 3750;

64 
	gDÜaTM1Env
::
	$DÜaTM1Env
()

65 : 
	`ShÜeTM1Env
(), 
	$DÜaEnv
()

67 
	`upd©e_pd
(
this
);

68 
	}
}

70 
	gDÜaTM1Env
::~
	$DÜaTM1Env
()

72 
	`¡İ
();

73 
	}
}

91 
	gDÜaTM1Env
::
	$¡¬t
()

99 
	`cÚf
();

100 
´oûssÜid_t
 
	`iıu
(
_¡¬tšg_ıu
);

103 
	`GENERATE_DORA_PARTS
(
sub
,sub);

106 
	`GENERATE_DORA_PARTS
(
ai
,ai);

109 
	`GENERATE_DORA_PARTS
(
sf
,sf);

112 
	`GENERATE_DORA_PARTS
(
cf
,cf);

115 
DÜaEnv
::
	`_po¡_¡¬t
(
this
);

117 
	}
}

129 
w_rc_t
 
	gDÜaTM1Env
::
	$upd©e_·¹™iÚšg
()

134 
	`cÚf
();

138 
mšKeyV®
 = 1;

139 
maxKeyV®
 = (
	`g‘_sf
()*
TM1_SUBS_PER_SF
)+1;

144 * 
mšKey
 = (*)
	`m®loc
(());

145 
	`mem£t
(
mšKey
,0,());

146 
	`memıy
(
mšKey
,&
mšKeyV®
,());

148 * 
maxKey
 = (*)
	`m®loc
(());

149 
	`mem£t
(
maxKey
,0,());

150 
	`memıy
(
maxKey
,&
maxKeyV®
,());

153 
_psub_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
_·¹s_sub
);

154 
_·i_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
_·¹s_ai
);

155 
_psf_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
_·¹s_sf
);

156 
_pcf_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
_·¹s_cf
);

158 
	`ä“
 (
mšKey
);

159 
	`ä“
 (
maxKey
);

161  (
RCOK
);

162 
	}
}

174 
	gDÜaTM1Env
::
	$¡İ
()

177  (
DÜaEnv
::
	`_po¡_¡İ
(
this
));

178 
	}
}

189 
	gDÜaTM1Env
::
	$»sume
()

191 
	`as£¹
 (0);

192 
	`£t_dbc
(
DBC_ACTIVE
);

194 
	}
}

205 
	gDÜaTM1Env
::
	$·u£
()

207 
	`as£¹
 (0);

208 
	`£t_dbc
(
DBC_PAUSED
);

210 
	}
}

221 
	gDÜaTM1Env
::
	$cÚf
()

223 
ShÜeTM1Env
::
	`cÚf
();

225 
	`_check_ty³
();

227 
’vV¬
* 
ev
 =ƒnvV¬::
	`š¡ªû
();

230 
_ıu_¿nge
 = 
	`g‘_aùive_ıu_couÁ
();

231 
_¡¬tšg_ıu
 = 
ev
->
	`g‘V¬IÁ
("dÜa-ıu-¡¬tšg",
DF_CPU_STEP_PARTITIONS
);

232 
_ıu_bË_¡•
 = 
ev
->
	`g‘V¬IÁ
("dÜa-ıu-bË-¡•",
DF_CPU_STEP_TABLES
);

244 
ušt
 
»cÜdE¡im©iÚ
 = 
	`g‘_sf
()*
TM1_SUBS_PER_SF
;

246 
sub_P”CPU
 = 
ev
->
	`g‘V¬DoubË
("dora-ratio-tm1-sub",0);

247 
_·¹s_sub
 = ( 
sub_P”CPU
>0 ? 
	`û
(
_ıu_¿nge
 * sub_PerCPU) : 1);

248 
_·¹s_sub
 = 
¡d
::
	`mš
(
»cÜdE¡im©iÚ
,_parts_sub);

251 
ai_P”CPU
 = 
ev
->
	`g‘V¬DoubË
("dora-ratio-tm1-ai",0);

252 
_·¹s_ai
 = ( 
ai_P”CPU
>0 ? (
_ıu_¿nge
 *‡i_PerCPU) : 1);

253 
_·¹s_ai
 = 
¡d
::
	`mš
(
»cÜdE¡im©iÚ
,_parts_ai);

256 
sf_P”CPU
 = 
ev
->
	`g‘V¬DoubË
("dora-ratio-tm1-sf",0);

257 
_·¹s_sf
 = ( 
sf_P”CPU
>0 ? (
_ıu_¿nge
 * sf_PerCPU) : 1);

258 
_·¹s_sf
 = 
¡d
::
	`mš
(
»cÜdE¡im©iÚ
,_parts_sf);

261 
cf_P”CPU
 = 
ev
->
	`g‘V¬DoubË
("dora-ratio-tm1-cf",0);

262 
_·¹s_cf
 = ( 
cf_P”CPU
>0 ? (
_ıu_¿nge
 * cf_PerCPU) : 1);

263 
_·¹s_cf
 = 
¡d
::
	`mš
(
»cÜdE¡im©iÚ
,_parts_cf);

265 
	`TRACE
Ğ
TRACE_STATISTICS
,"Total‚umber of…artitions (%d)\n",

266 (
_·¹s_sub
+
_·¹s_ai
+
_·¹s_sf
+
_·¹s_cf
));

269 
	}
}

280 
w_rc_t
 
	gDÜaTM1Env
::
	$Ãwrun
()

282  (
DÜaEnv
::
	`_Ãwrun
(
this
));

283 
	}
}

294 
	gDÜaTM1Env
::
	$dump
()

296  (
DÜaEnv
::
	`_dump
(
this
));

297 
	}
}

308 
	gDÜaTM1Env
::
	$šfo
() const

310  (
DÜaEnv
::
	`_šfo
(
this
));

311 
	}
}

322 
	gDÜaTM1Env
::
	$¡©i¡ics
()

324 
DÜaEnv
::
	`_¡©i¡ics
(
this
);

329 
	`TRACE
Ğ
TRACE_STATISTICS
, "----- TM1 -----\n");

330 
ShÜeTM1Env
::
	`¡©i¡ics
();

332 
	}
}

348 
DEFINE_DORA_FINAL_RVP_GEN_FUNC
(
fš®_gsd_rvp
,
DÜaTM1Env
);

350 
DEFINE_DORA_ACTION_GEN_FUNC
(
r_sub_gsd_aùiÚ
,
rvp_t
,
g‘_sub_d©a_šput_t
,,
DÜaTM1Env
);

357 #ifdeà
TM1GND2


358 
DEFINE_DORA_MIDWAY_RVP_GEN_FUNC
(
mid_gnd_rvp
,
g‘_Ãw_de¡_šput_t
,
DÜaTM1Env
);

359 
DEFINE_DORA_FINAL_RVP_WITH_PREV_GEN_FUNC
(
fš®_gnd_rvp
,
DÜaTM1Env
);

361 
DEFINE_DORA_ACTION_GEN_FUNC
(
r_sf_gnd_aùiÚ
,
mid_gnd_rvp
,
g‘_Ãw_de¡_šput_t
,,
DÜaTM1Env
);

363 
DEFINE_DORA_ACTION_GEN_FUNC
(
r_cf_gnd_aùiÚ
,
rvp_t
,
g‘_Ãw_de¡_šput_t
,,
DÜaTM1Env
);

366 #w¬nšg 
OLD
-
G‘NewDe¡
 !!

367 
DEFINE_DORA_FINAL_RVP_GEN_FUNC
(
fš®_gnd_rvp
,
DÜaTM1Env
);

369 
DEFINE_DORA_ACTION_GEN_FUNC
(
r_sf_gnd_aùiÚ
,
rvp_t
,
g‘_Ãw_de¡_šput_t
,,
DÜaTM1Env
);

370 
DEFINE_DORA_ACTION_GEN_FUNC
(
r_cf_gnd_aùiÚ
,
rvp_t
,
g‘_Ãw_de¡_šput_t
,,
DÜaTM1Env
);

378 
DEFINE_DORA_FINAL_RVP_GEN_FUNC
(
fš®_gad_rvp
,
DÜaTM1Env
);

380 
DEFINE_DORA_ACTION_GEN_FUNC
(
r_ai_gad_aùiÚ
,
rvp_t
,
g‘_acc_d©a_šput_t
,,
DÜaTM1Env
);

387 #ifdeà
TM1USD2


388 
DEFINE_DORA_MIDWAY_RVP_GEN_FUNC
(
mid_usd_rvp
,
upd_sub_d©a_šput_t
,
DÜaTM1Env
);

389 
DEFINE_DORA_FINAL_RVP_WITH_PREV_GEN_FUNC
(
fš®_usd_rvp
,
DÜaTM1Env
);

391 
DEFINE_DORA_ACTION_GEN_FUNC
(
upd_sf_usd_aùiÚ
,
mid_usd_rvp
,
upd_sub_d©a_šput_t
,,
DÜaTM1Env
);

393 
DEFINE_DORA_ACTION_GEN_FUNC
(
upd_sub_usd_aùiÚ
,
rvp_t
,
upd_sub_d©a_šput_t
,,
DÜaTM1Env
);

396 #w¬nšg 
OLD
-
UpdSubD©a
 !!

397 
DEFINE_DORA_FINAL_RVP_GEN_FUNC
(
fš®_usd_rvp
,
DÜaTM1Env
);

399 
DEFINE_DORA_ACTION_GEN_FUNC
(
upd_sub_usd_aùiÚ
,
rvp_t
,
upd_sub_d©a_šput_t
,,
DÜaTM1Env
);

400 
DEFINE_DORA_ACTION_GEN_FUNC
(
upd_sf_usd_aùiÚ
,
rvp_t
,
upd_sub_d©a_šput_t
,,
DÜaTM1Env
);

407 
DEFINE_DORA_MIDWAY_RVP_GEN_FUNC
(
mid_usdmix_rvp
,
upd_sub_d©a_šput_t
,
DÜaTM1Env
);

408 
DEFINE_DORA_FINAL_RVP_WITH_PREV_GEN_FUNC
(
fš®_usdmix_rvp
,
DÜaTM1Env
);

410 
DEFINE_DORA_ACTION_GEN_FUNC
(
upd_sub_usdmix_aùiÚ
,
mid_usdmix_rvp
,
upd_sub_d©a_šput_t
,,
DÜaTM1Env
);

411 
DEFINE_DORA_ACTION_GEN_FUNC
(
upd_sf_usdmix_aùiÚ
,
rvp_t
,
upd_sub_d©a_šput_t
,,
DÜaTM1Env
);

418 
DEFINE_DORA_FINAL_RVP_GEN_FUNC
(
fš®_ul_rvp
,
DÜaTM1Env
);

420 
DEFINE_DORA_ACTION_GEN_FUNC
(
upd_sub_ul_aùiÚ
,
rvp_t
,
upd_loc_šput_t
,,
DÜaTM1Env
);

427 #ifdeà
TM1ICF2


428 
DEFINE_DORA_MIDWAY_RVP_GEN_FUNC
(
mid1_icf_rvp
,
šs_ÿÎ_fwd_šput_t
,
DÜaTM1Env
);

429 
DEFINE_DORA_MIDWAY_RVP_WITH_PREV_GEN_FUNC
(
mid2_icf_rvp
,
šs_ÿÎ_fwd_šput_t
,
DÜaTM1Env
);

430 
DEFINE_DORA_FINAL_RVP_WITH_PREV_GEN_FUNC
(
fš®_icf_rvp
,
DÜaTM1Env
);

432 
DEFINE_DORA_ACTION_GEN_FUNC
(
r_sub_icf_aùiÚ
,
mid1_icf_rvp
,
šs_ÿÎ_fwd_šput_t
,,
DÜaTM1Env
);

433 
DEFINE_DORA_ACTION_GEN_FUNC
(
r_sf_icf_aùiÚ
,
mid2_icf_rvp
,
šs_ÿÎ_fwd_šput_t
,,
DÜaTM1Env
);

435 
DEFINE_DORA_ACTION_GEN_FUNC
(
šs_cf_icf_aùiÚ
,
rvp_t
,
šs_ÿÎ_fwd_šput_t
,,
DÜaTM1Env
);

439 #w¬nšg 
OLD
-
InsC®lFwd
 !!

440 
DEFINE_DORA_MIDWAY_RVP_GEN_FUNC
(
mid_icf_rvp
,
šs_ÿÎ_fwd_šput_t
,
DÜaTM1Env
);

441 
DEFINE_DORA_FINAL_RVP_WITH_PREV_GEN_FUNC
(
fš®_icf_rvp
,
DÜaTM1Env
);

443 
DEFINE_DORA_ACTION_GEN_FUNC
(
r_sub_icf_aùiÚ
,
mid_icf_rvp
,
šs_ÿÎ_fwd_šput_t
,,
DÜaTM1Env
);

445 
DEFINE_DORA_ACTION_GEN_FUNC
(
r_sf_icf_aùiÚ
,
rvp_t
,
šs_ÿÎ_fwd_šput_t
,,
DÜaTM1Env
);

446 
DEFINE_DORA_ACTION_GEN_FUNC
(
šs_cf_icf_aùiÚ
,
rvp_t
,
šs_ÿÎ_fwd_šput_t
,,
DÜaTM1Env
);

455 
DEFINE_DORA_FINAL_RVP_GEN_FUNC
(
fš®_icfb_rvp
,
DÜaTM1Env
);

457 
DEFINE_DORA_ACTION_GEN_FUNC
(
r_sub_icfb_aùiÚ
,
rvp_t
,
šs_ÿÎ_fwd_b’ch_šput_t
,,
DÜaTM1Env
);

458 
DEFINE_DORA_ACTION_GEN_FUNC
(
i_cf_icfb_aùiÚ
,
rvp_t
,
šs_ÿÎ_fwd_b’ch_šput_t
,,
DÜaTM1Env
);

466 
DEFINE_DORA_MIDWAY_RVP_GEN_FUNC
(
mid_dcf_rvp
,
d–_ÿÎ_fwd_šput_t
,
DÜaTM1Env
);

467 
DEFINE_DORA_FINAL_RVP_WITH_PREV_GEN_FUNC
(
fš®_dcf_rvp
,
DÜaTM1Env
);

469 
DEFINE_DORA_ACTION_GEN_FUNC
(
r_sub_dcf_aùiÚ
,
mid_dcf_rvp
,
d–_ÿÎ_fwd_šput_t
,,
DÜaTM1Env
);

471 
DEFINE_DORA_ACTION_GEN_FUNC
(
d–_cf_dcf_aùiÚ
,
rvp_t
,
d–_ÿÎ_fwd_šput_t
,,
DÜaTM1Env
);

479 
DEFINE_DORA_FINAL_DYNAMIC_RVP_GEN_FUNC
(
fš®_g¢_rvp
,
DÜaTM1Env
);

480 #iâdeà
USE_DORA_EXT_IDX


481 
DEFINE_DORA_ACTION_GEN_FUNC
(
r_sub_g¢_aùiÚ
,
rvp_t
,
g‘_sub_nbr_šput_t
,,
DÜaTM1Env
);

483 
DEFINE_DORA_ACTION_GEN_FUNC
(
r_sub_g¢_acc_aùiÚ
,
rvp_t
,
g‘_sub_nbr_šput_t
,,
DÜaTM1Env
);

488 
EXIT_NAMESPACE
(
dÜa
);

	@src/dora/tm1/dora_tm1_client.cpp

31 
	~"dÜa/tm1/dÜa_tm1_ş›Á.h
"

34 
ENTER_NAMESPACE
(
dÜa
);

39 cÚ¡ 
	gXCT_TM1_DORA_MIX
 = 200;

40 cÚ¡ 
	gXCT_TM1_DORA_GET_SUB_DATA
 = 221;

41 cÚ¡ 
	gXCT_TM1_DORA_GET_NEW_DEST
 = 222;

42 cÚ¡ 
	gXCT_TM1_DORA_GET_ACC_DATA
 = 223;

43 cÚ¡ 
	gXCT_TM1_DORA_UPD_SUB_DATA
 = 224;

44 cÚ¡ 
	gXCT_TM1_DORA_UPD_LOCATION
 = 225;

45 cÚ¡ 
	gXCT_TM1_DORA_CALL_FWD_MIX
 = 226;

47 cÚ¡ 
	gXCT_TM1_DORA_INS_CALL_FWD
 = 227;

48 cÚ¡ 
	gXCT_TM1_DORA_DEL_CALL_FWD
 = 228;

50 cÚ¡ 
	gXCT_TM1_DORA_GET_SUB_NBR
 = 229;

52 cÚ¡ 
	gXCT_TM1_DORA_CALL_FWD_MIX_BENCH
 = 230;

53 cÚ¡ 
	gXCT_TM1_DORA_INS_CALL_FWD_BENCH
 = 231;

54 cÚ¡ 
	gXCT_TM1_DORA_DEL_CALL_FWD_BENCH
 = 232;

56 cÚ¡ 
	gXCT_TM1_DORA_UPD_SUB_DATA_MIX
 = 234;

64 
	gdÜa_tm1_ş›Á_t
::
	$lßd_sup_xù
(
m­SupTrxs
& 
¡m­
)

67 
¡m­
.
	`ş—r
();

70 
¡m­
[
XCT_TM1_DORA_MIX
] = "DORA-TM1-Mix";

71 
¡m­
[
XCT_TM1_DORA_GET_SUB_DATA
] = "DORA-TM1-GetSubData";

72 
¡m­
[
XCT_TM1_DORA_GET_NEW_DEST
] = "DORA-TM1-GetNewDest";

73 
¡m­
[
XCT_TM1_DORA_GET_ACC_DATA
] = "DORA-TM1-GetAccData";

74 
¡m­
[
XCT_TM1_DORA_UPD_SUB_DATA
] = "DORA-TM1-UpdSubData";

75 
¡m­
[
XCT_TM1_DORA_UPD_LOCATION
] = "DORA-TM1-UpdLocation";

76 
¡m­
[
XCT_TM1_DORA_CALL_FWD_MIX
] = "DORA-TM1-CallFwd-Mix";

77 
¡m­
[
XCT_TM1_DORA_INS_CALL_FWD
] = "DORA-TM1-InsCallFwd";

78 
¡m­
[
XCT_TM1_DORA_DEL_CALL_FWD
] = "DORA-TM1-DelCallFwd";

80 #iâdeà
USE_DORA_EXT_IDX


81 
¡m­
[
XCT_TM1_DORA_GET_SUB_NBR
] = "DORA-TM1-GetSubNbr";

83 
¡m­
[
XCT_TM1_DORA_GET_SUB_NBR
] = "DORA-TM1-GetSubNbr-Ext";

86 
¡m­
[
XCT_TM1_DORA_CALL_FWD_MIX_BENCH
] = "DORA-TM1-CallFwdMixBench";

87 
¡m­
[
XCT_TM1_DORA_INS_CALL_FWD_BENCH
] = "DORA-TM1-InsCallFwdBench";

88 
¡m­
[
XCT_TM1_DORA_DEL_CALL_FWD_BENCH
] = "DORA-TM1-DelCallFwdBench";

90  (
¡m­
.
	`size
());

91 
	}
}

104 
w_rc_t
 
	gdÜa_tm1_ş›Á_t
::
	$subm™_Úe
(
xù_ty³
, 
xùid
)

107 
boŞ
 
bWake
 = 
çl£
;

108 ià(
xù_ty³
 =ğ
XCT_TM1_DORA_MIX
) {

109 
xù_ty³
 = 
XCT_TM1_DORA_MIX
 + 
	`¿ndom_tm1_xù_ty³
(
	`¿nd
(100));

110 if(
xù_ty³
 =ğ
XCT_TM1_DORA_UPD_SUB_DATA
) {

111 
xù_ty³
 = 
XCT_TM1_DORA_UPD_SUB_DATA_MIX
;

113 
bWake
 = 
Œue
;

117 
£lsf
 = 
_£lid
;

120 ià(
_£lid
==0) {

121 
£lsf
 = 
	`URªd
(1,
_qf
);

122 
bWake
 = 
Œue
;

126 
£lid
 = (
£lsf
-1)*
TM1_SUBS_PER_SF
 + 
	`URªd
(1,TM1_SUBS_PER_SF);

128 
Œx_»suÉ_tu¶e_t
 
©¹
;

129 ià(
cÚdex
* 
c
 = 
_ı
->
	`ke_Úe
()) {

130 
©¹
.
	`£t_nÙify
(
c
);

131 
bWake
 = 
Œue
;

134 
xù_ty³
) {

137 
XCT_TM1_DORA_GET_SUB_DATA
:

138  (
_tm1db
->
	`dÜa_g‘_sub_d©a
(
xùid
,
©¹
,
£lid
,
bWake
));

139 
XCT_TM1_DORA_GET_NEW_DEST
:

140  (
_tm1db
->
	`dÜa_g‘_Ãw_de¡
(
xùid
,
©¹
,
£lid
,
bWake
));

141 
XCT_TM1_DORA_GET_ACC_DATA
:

142  (
_tm1db
->
	`dÜa_g‘_acc_d©a
(
xùid
,
©¹
,
£lid
,
bWake
));

143 
XCT_TM1_DORA_UPD_SUB_DATA
:

144  (
_tm1db
->
	`dÜa_upd_sub_d©a
(
xùid
,
©¹
,
£lid
,
bWake
));

145 
XCT_TM1_DORA_UPD_LOCATION
:

146  (
_tm1db
->
	`dÜa_upd_loc
(
xùid
,
©¹
,
£lid
,
bWake
));

147 
XCT_TM1_DORA_INS_CALL_FWD
:

148  (
_tm1db
->
	`dÜa_šs_ÿÎ_fwd
(
xùid
,
©¹
,
£lid
,
bWake
));

149 
XCT_TM1_DORA_DEL_CALL_FWD
:

150  (
_tm1db
->
	`dÜa_d–_ÿÎ_fwd
(
xùid
,
©¹
,
£lid
,
bWake
));

153 
XCT_TM1_DORA_CALL_FWD_MIX
:

155 ià(
	`URªd
(1,100)>50)

156  (
_tm1db
->
	`dÜa_šs_ÿÎ_fwd
(
xùid
,
©¹
,
£lid
,
Œue
));

158  (
_tm1db
->
	`dÜa_d–_ÿÎ_fwd
(
xùid
,
©¹
,
£lid
,
Œue
));

160 
XCT_TM1_DORA_GET_SUB_NBR
:

161  (
_tm1db
->
	`dÜa_g‘_sub_nbr
(
xùid
,
©¹
,
£lid
,
bWake
));

163 
XCT_TM1_DORA_INS_CALL_FWD_BENCH
:

164  (
_tm1db
->
	`dÜa_šs_ÿÎ_fwd_b’ch
(
xùid
,
©¹
,
£lid
,
Œue
));

166 
XCT_TM1_DORA_UPD_SUB_DATA_MIX
:

167  (
_tm1db
->
	`dÜa_upd_sub_d©a_mix
(
xùid
,
©¹
,
£lid
,
bWake
));

170 
	`as£¹
 (0);

172  (
RCOK
);

173 
	}
}

176 
EXIT_NAMESPACE
(
dÜa
);

	@src/dora/tm1/dora_tm1_impl.cpp

34 
	~"dÜa/tm1/dÜa_tm1_im¶.h
"

35 
	~"dÜa/tm1/dÜa_tm1.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
usšg
 
Çme¥aû
 
	gtm1
;

41 
ENTER_NAMESPACE
(
dÜa
);

43 
	g·¹™iÚ_t
<> 
	tœpIm¶
;

52 
DEFINE_DORA_FINAL_RVP_CLASS
(
fš®_gsd_rvp
,
g‘_sub_d©a
);

64 
	gr_sub_gsd_aùiÚ
::
	$ÿlc_keys
()

66 
	`£t_»ad_Úly
();

67 
_down
.
	`push_back
(
_š
.
_s_id
);

68 
	}
}

72 
w_rc_t
 
	gr_sub_gsd_aùiÚ
::
	$Œx_exec
()

74 
	`as£¹
 (
_³nv
);

78 
tu¶e_gu¬d
<
sub_mª_im¶
> 
	`´sub
(
_³nv
->
	`sub_mª
());

79 
»p_row_t
 
	`¬•row
(
_³nv
->
	`sub_mª
()->
	`ts
());

80 
¬•row
.
	`£t
(
_³nv
->
	`sub_desc
()->
	`maxsize
());

81 
´sub
->
_»p
 = &
¬•row
;

93 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d GSD:sub-idx-nl (%d)\n",

94 
_tid
.
	`g‘_lo
(), 
_š
.
_s_id
);

95 
	`W_DO
(
_³nv
->
	`sub_mª
()->
	`sub_idx_Æ
(_³nv->
	`db
(), 
´sub
, 
_š
.
_s_id
));

97 
tm1_sub_t
 
asub
;

101 
´sub
->
	`g‘_v®ue
(0, 
asub
.
S_ID
);

102 
´sub
->
	`g‘_v®ue
(1, 
asub
.
SUB_NBR
, 17);

105 
´sub
->
	`g‘_v®ue
(2, 
asub
.
BIT_XX
[0]);

106 
´sub
->
	`g‘_v®ue
(3, 
asub
.
BIT_XX
[1]);

107 
´sub
->
	`g‘_v®ue
(4, 
asub
.
BIT_XX
[2]);

108 
´sub
->
	`g‘_v®ue
(5, 
asub
.
BIT_XX
[3]);

109 
´sub
->
	`g‘_v®ue
(6, 
asub
.
BIT_XX
[4]);

110 
´sub
->
	`g‘_v®ue
(7, 
asub
.
BIT_XX
[5]);

111 
´sub
->
	`g‘_v®ue
(8, 
asub
.
BIT_XX
[6]);

112 
´sub
->
	`g‘_v®ue
(9, 
asub
.
BIT_XX
[7]);

113 
´sub
->
	`g‘_v®ue
(10, 
asub
.
BIT_XX
[8]);

114 
´sub
->
	`g‘_v®ue
(11, 
asub
.
BIT_XX
[9]);

117 
´sub
->
	`g‘_v®ue
(12, 
asub
.
HEX_XX
[0]);

118 
´sub
->
	`g‘_v®ue
(13, 
asub
.
HEX_XX
[1]);

119 
´sub
->
	`g‘_v®ue
(14, 
asub
.
HEX_XX
[2]);

120 
´sub
->
	`g‘_v®ue
(15, 
asub
.
HEX_XX
[3]);

121 
´sub
->
	`g‘_v®ue
(16, 
asub
.
HEX_XX
[4]);

122 
´sub
->
	`g‘_v®ue
(17, 
asub
.
HEX_XX
[5]);

123 
´sub
->
	`g‘_v®ue
(18, 
asub
.
HEX_XX
[6]);

124 
´sub
->
	`g‘_v®ue
(19, 
asub
.
HEX_XX
[7]);

125 
´sub
->
	`g‘_v®ue
(20, 
asub
.
HEX_XX
[8]);

126 
´sub
->
	`g‘_v®ue
(21, 
asub
.
HEX_XX
[9]);

129 
´sub
->
	`g‘_v®ue
(22, 
asub
.
BYTE2_XX
[0]);

130 
´sub
->
	`g‘_v®ue
(23, 
asub
.
BYTE2_XX
[1]);

131 
´sub
->
	`g‘_v®ue
(24, 
asub
.
BYTE2_XX
[2]);

132 
´sub
->
	`g‘_v®ue
(25, 
asub
.
BYTE2_XX
[3]);

133 
´sub
->
	`g‘_v®ue
(26, 
asub
.
BYTE2_XX
[4]);

134 
´sub
->
	`g‘_v®ue
(27, 
asub
.
BYTE2_XX
[5]);

135 
´sub
->
	`g‘_v®ue
(28, 
asub
.
BYTE2_XX
[6]);

136 
´sub
->
	`g‘_v®ue
(29, 
asub
.
BYTE2_XX
[7]);

137 
´sub
->
	`g‘_v®ue
(30, 
asub
.
BYTE2_XX
[8]);

138 
´sub
->
	`g‘_v®ue
(31, 
asub
.
BYTE2_XX
[9]);

140 
´sub
->
	`g‘_v®ue
(32, 
asub
.
MSC_LOCATION
);

141 
´sub
->
	`g‘_v®ue
(33, 
asub
.
VLR_LOCATION
);

143 #ifdeà
PRINT_TRX_RESULTS


145 
´sub
->
	`´št_tu¶e
();

148  
RCOK
;

149 
	}
}

159 #ifdeà
TM1GND2


161 
w_rc_t
 
	gmid_gnd_rvp
::
	$_run
()

164 
fš®_gnd_rvp
* 
ävp
 = 
_³nv
->
	`Ãw_fš®_gnd_rvp
(
_xù
,
_tid
,
_xù_id
,
_»suÉ
,
_aùiÚs
);

167 
	`CHECK_MIDWAY_RVP_ABORTED
(
ävp
);

170 
r_cf_gnd_aùiÚ
* 
r_cf
 = 
_³nv
->
	`Ãw_r_cf_gnd_aùiÚ
(
_xù
,
_tid
,
ävp
,
_š
);

172 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Nexˆpha£ (%d)\n", 
_tid
.
	`g‘_lo
());

178 
œpIm¶
* 
my_cf_·¹
 = 
_³nv
->
	`decide_·¹
(_³nv->
	`cf
(),
_š
.
_s_id
);

181 
	`CRITICAL_SECTION
(
cf_·¹_cs
, 
my_cf_·¹
->
_’queue_lock
);

182 ià(
my_cf_·¹
->
	`’queue
(
r_cf
,
_bWake
)) {

183 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing R_CF_GND\n");

184 
	`as£¹
 (0);

185  (
	`RC
(
de_PROBLEM_ENQUEUE
));

188  (
RCOK
);

189 
	}
}

193 
DEFINE_DORA_FINAL_RVP_CLASS
(
fš®_gnd_rvp
,
g‘_Ãw_de¡
);

207 
	gr_sf_gnd_aùiÚ
::
	$ÿlc_keys
()

209 
	`£t_»ad_Úly
();

210 
sáy³
 = 
_š
.
_sf_ty³
;

211 
_down
.
	`push_back
(
_š
.
_s_id
);

212 
_down
.
	`push_back
(
sáy³
);

213 
	}
}

217 
w_rc_t
 
	gr_sf_gnd_aùiÚ
::
	$Œx_exec
()

219 
	`as£¹
 (
_³nv
);

223 
tu¶e_gu¬d
<
sf_mª_im¶
> 
	`´sf
(
_³nv
->
	`sf_mª
());

224 
»p_row_t
 
	`¬•row
(
_³nv
->
	`sf_mª
()->
	`ts
());

225 
¬•row
.
	`£t
(
_³nv
->
	`sf_desc
()->
	`maxsize
());

226 
´sf
->
_»p
 = &
¬•row
;

228 
tm1_sf_t
 
asf
;

231 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d GND:sf-idx-nl (%d) (%d)\n",

232 
_tid
.
	`g‘_lo
(), 
_š
.
_s_id
, _š.
_sf_ty³
);

233 #iâdeà
TM1GND2


234 ià(
_´vp
->
	`isAbÜ‹d
()è{ 
	`W_DO
(
	`RC
(
de_MIDWAY_ABORT
)); }

236 
	`W_DO
(
_³nv
->
	`sf_mª
()->
	`sf_idx_Æ
(_³nv->
	`db
(), 
´sf
, 
_š
.
_s_id
, _š.
_sf_ty³
));

237 
´sf
->
	`g‘_v®ue
(2, 
asf
.
IS_ACTIVE
);

238 ià(!
asf
.
IS_ACTIVE
) {

240 
	`W_DO
(
	`RC
(
£_NO_CURRENT_TUPLE
));

243 #ifdeà
PRINT_TRX_RESULTS


245 
´sf
->
	`´št_tu¶e
();

248  
RCOK
;

249 
	}
}

254 
	gr_cf_gnd_aùiÚ
::
	$ÿlc_keys
()

256 
	`£t_»ad_Úly
();

257 
sáy³
 = 
_š
.
_sf_ty³
;

258 
¡ime
 = 
_š
.
_s_time
;

259 
_down
.
	`push_back
(
_š
.
_s_id
);

260 
_down
.
	`push_back
(
sáy³
);

261 
_down
.
	`push_back
(
¡ime
);

262 
	}
}

266 
w_rc_t
 
	gr_cf_gnd_aùiÚ
::
	$Œx_exec
()

268 
	`as£¹
 (
_³nv
);

272 
tu¶e_gu¬d
<
cf_mª_im¶
> 
	`´cf
(
_³nv
->
	`cf_mª
());

273 
»p_row_t
 
	`¬•row
(
_³nv
->
	`cf_mª
()->
	`ts
());

274 
¬•row
.
	`£t
(
_³nv
->
	`cf_desc
()->
	`maxsize
());

275 
´cf
->
_»p
 = &
¬•row
;

277 
»p_row_t
 
	`low»p
(
_³nv
->
	`cf_mª
()->
	`ts
());

278 
»p_row_t
 
	`high»p
(
_³nv
->
	`cf_mª
()->
	`ts
());

279 
low»p
.
	`£t
(
_³nv
->
	`cf_desc
()->
	`maxsize
());

280 
high»p
.
	`£t
(
_³nv
->
	`cf_desc
()->
	`maxsize
());

282 
tm1_cf_t
 
acf
;

283 
boŞ
 
eof
;

284 
boŞ
 
bFound
 = 
çl£
;

286 #iâdeà
TM1GND2


287 ià(
_´vp
->
	`isAbÜ‹d
()è{ 
	`W_DO
(
	`RC
(
de_MIDWAY_ABORT
)); }

291 
gu¬d
<
šdex_sÿn_™”_im¶
<
ÿÎ_fÜw¬dšg_t
> > 
cf_™”
;

293 
šdex_sÿn_™”_im¶
<
ÿÎ_fÜw¬dšg_t
>* 
tmp_cf_™”
;

294 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d GND:cf-idx-™”-Æ\n", 
_tid
.
	`g‘_lo
());

295 
	`W_DO
(
_³nv
->
	`cf_mª
()->
	`cf_g‘_idx_™”_Æ
(_³nv->
	`db
(), 
tmp_cf_™”
, 
´cf
,

296 
low»p
, 
high»p
, 
_š
.
_s_id
,

297 
_š
.
_sf_ty³
, _š.
_s_time
));

298 
cf_™”
 = 
tmp_cf_™”
;

300 
	`W_DO
(
cf_™”
->
	`Ãxt
(
_³nv
->
	`db
(), 
eof
, *
´cf
));

302 !
eof
) {

303 #iâdeà
TM1GND2


304 ià(
_´vp
->
	`isAbÜ‹d
()è{ 
	`W_DO
(
	`RC
(
de_MIDWAY_ABORT
)); }

307 
´cf
->
	`g‘_v®ue
(3, 
acf
.
END_TIME
);

308 ià(
acf
.
END_TIME
 > 
_š
.
_e_time
) {

309 
´cf
->
	`g‘_v®ue
(4, 
acf
.
NUMBERX
, 17);

310 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d GND: found (%d) (%d) (%s)\n",

311 
_tid
.
	`g‘_lo
(), 
_š
.
_e_time
, 
acf
.
END_TIME
,‡cf.
NUMBERX
);

312 
bFound
 = 
Œue
;

314 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d GND:cf-idx-™”-Ãxt\n", 
_tid
.
	`g‘_lo
());

315 
	`W_DO
(
cf_™”
->
	`Ãxt
(
_³nv
->
	`db
(), 
eof
, *
´cf
));

318 ià(!
bFound
) {

319 
	`W_DO
(
	`RC
(
£_NO_CURRENT_TUPLE
));

322 #ifdeà
PRINT_TRX_RESULTS


324 
´cf
->
	`´št_tu¶e
();

327  
RCOK
;

328 
	}
}

339 
DEFINE_DORA_FINAL_RVP_CLASS
(
fš®_gad_rvp
,
g‘_acc_d©a
);

351 
	gr_ai_gad_aùiÚ
::
	$ÿlc_keys
()

353 
	`£t_»ad_Úly
();

354 
a™y³
 = 
_š
.
_ai_ty³
;

355 
_down
.
	`push_back
(
_š
.
_s_id
);

356 
_down
.
	`push_back
(
a™y³
);

357 
	}
}

361 
w_rc_t
 
	gr_ai_gad_aùiÚ
::
	$Œx_exec
()

363 
	`as£¹
 (
_³nv
);

367 
tu¶e_gu¬d
<
ai_mª_im¶
> 
	`´ai
(
_³nv
->
	`ai_mª
());

368 
»p_row_t
 
	`¬•row
(
_³nv
->
	`ai_mª
()->
	`ts
());

369 
¬•row
.
	`£t
(
_³nv
->
	`ai_desc
()->
	`maxsize
());

370 
´ai
->
_»p
 = &
¬•row
;

381 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d GAD:ai-idx-nl (%d) (%d)\n",

382 
_tid
.
	`g‘_lo
(), 
_š
.
_s_id
, _š.
_ai_ty³
);

383 
	`W_DO
(
_³nv
->
	`ai_mª
()->
	`ai_idx_Æ
(_³nv->
	`db
(), 
´ai
, 
_š
.
_s_id
, _š.
_ai_ty³
));

386 
tm1_ai_t
 
¯i
;

387 
´ai
->
	`g‘_v®ue
(2, 
¯i
.
DATA1
);

388 
´ai
->
	`g‘_v®ue
(3, 
¯i
.
DATA2
);

389 
´ai
->
	`g‘_v®ue
(4, 
¯i
.
DATA3
, 5);

390 
´ai
->
	`g‘_v®ue
(5, 
¯i
.
DATA4
, 9);

392 #ifdeà
PRINT_TRX_RESULTS


394 
´ai
->
	`´št_tu¶e
();

397  
RCOK
;

398 
	}
}

409 #ifdeà
TM1USD2


411 
w_rc_t
 
	gmid_usd_rvp
::
	$_run
()

414 
fš®_usd_rvp
* 
ävp
 = 
_³nv
->
	`Ãw_fš®_usd_rvp
(
_xù
,
_tid
,
_xù_id
,
_»suÉ
,
_aùiÚs
);

417 
	`CHECK_MIDWAY_RVP_ABORTED
(
ävp
);

420 
upd_sub_usd_aùiÚ
* 
upd_sub
 = 
_³nv
->
	`Ãw_upd_sub_usd_aùiÚ
(
_xù
,
_tid
,
ävp
,
_š
);

422 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Nexˆpha£ (%d)\n", 
_tid
.
	`g‘_lo
());

427 
œpIm¶
* 
my_sub_·¹
 = 
_³nv
->
	`decide_·¹
(_³nv->
	`sub
(),
_š
.
_s_id
);

430 
	`CRITICAL_SECTION
(
sub_·¹_cs
, 
my_sub_·¹
->
_’queue_lock
);

431 ià(
my_sub_·¹
->
	`’queue
(
upd_sub
,
_bWake
)) {

432 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing UPD_SUB_USD\n");

433 
	`as£¹
 (0);

434  (
	`RC
(
de_PROBLEM_ENQUEUE
));

437  (
RCOK
);

438 
	}
}

442 
DEFINE_DORA_FINAL_RVP_CLASS
(
fš®_usd_rvp
,
upd_sub_d©a
);

455 
	gupd_sub_usd_aùiÚ
::
	$ÿlc_keys
()

457 
_down
.
	`push_back
(
_š
.
_s_id
);

458 
	}
}

461 
w_rc_t
 
	gupd_sub_usd_aùiÚ
::
	$Œx_exec
()

463 
	`as£¹
 (
_³nv
);

467 
tu¶e_gu¬d
<
sub_mª_im¶
> 
	`´sub
(
_³nv
->
	`sub_mª
());

468 
»p_row_t
 
	`¬•row
(
_³nv
->
	`sub_mª
()->
	`ts
());

469 
¬•row
.
	`£t
(
_³nv
->
	`sub_desc
()->
	`maxsize
());

470 
´sub
->
_»p
 = &
¬•row
;

480 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

481 "Aµ: %d USD:sub-idx-Æ (%d)\n", 
_tid
.
	`g‘_lo
(), 
_š
.
_s_id
);

482 #iâdeà
TM1USD2


483 ià(
_´vp
->
	`isAbÜ‹d
()è{ 
	`W_DO
(
	`RC
(
de_MIDWAY_ABORT
)); }

485 
	`W_DO
(
_³nv
->
	`sub_mª
()->
	`sub_idx_Æ
(_³nv->
	`db
(), 
´sub
, 
_š
.
_s_id
));

486 
´sub
->
	`£t_v®ue
(2, 
_š
.
_a_b™
);

487 #iâdeà
TM1USD2


488 ià(
_´vp
->
	`isAbÜ‹d
()è{ 
	`W_DO
(
	`RC
(
de_MIDWAY_ABORT
)); }

490 
	`W_DO
(
_³nv
->
	`sub_mª
()->
	`upd©e_tu¶e
(_³nv->
	`db
(), 
´sub
, 
NL
));

492 #ifdeà
PRINT_TRX_RESULTS


494 
´sub
->
	`´št_tu¶e
();

497  
RCOK
;

498 
	}
}

502 
	gupd_sf_usd_aùiÚ
::
	$ÿlc_keys
()

504 
sáy³
 = 
_š
.
_sf_ty³
;

505 
_down
.
	`push_back
(
_š
.
_s_id
);

506 
_down
.
	`push_back
(
sáy³
);

507 
	}
}

510 
w_rc_t
 
	gupd_sf_usd_aùiÚ
::
	$Œx_exec
()

512 
	`as£¹
 (
_³nv
);

516 
tu¶e_gu¬d
<
sf_mª_im¶
> 
	`´sf
(
_³nv
->
	`sf_mª
());

517 
»p_row_t
 
	`¬•row
(
_³nv
->
	`sf_mª
()->
	`ts
());

518 
¬•row
.
	`£t
(
_³nv
->
	`sf_desc
()->
	`maxsize
());

519 
´sf
->
_»p
 = &
¬•row
;

530 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d USD:sf-idx-nl (%d) (%d)\n",

531 
_tid
.
	`g‘_lo
(), 
_š
.
_s_id
, _š.
_sf_ty³
);

532 
	`W_DO
(
_³nv
->
	`sf_mª
()->
	`sf_idx_Æ
(_³nv->
	`db
(), 
´sf
, 
_š
.
_s_id
, _š.
_sf_ty³
));

533 
´sf
->
	`£t_v®ue
(4, 
_š
.
_a_d©a
);

534 
	`W_DO
(
_³nv
->
	`sf_mª
()->
	`upd©e_tu¶e
(_³nv->
	`db
(), 
´sf
, 
NL
));

536 #ifdeà
PRINT_TRX_RESULTS


538 
´sf
->
	`´št_tu¶e
();

541  
RCOK
;

542 
	}
}

551 
w_rc_t
 
	gmid_usdmix_rvp
::
	$_run
()

554 
fš®_usdmix_rvp
* 
ävp
 = 
_³nv
->
	`Ãw_fš®_usdmix_rvp
(
_xù
,
_tid
,
_xù_id
,
_»suÉ
,
_aùiÚs
);

557 
	`CHECK_MIDWAY_RVP_ABORTED
(
ävp
);

560 
upd_sf_usdmix_aùiÚ
* 
upd_sf
 = 
_³nv
->
	`Ãw_upd_sf_usdmix_aùiÚ
(
_xù
,
_tid
,
ävp
,
_š
);

562 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Nexˆpha£ (%d)\n", 
_tid
.
	`g‘_lo
());

567 
œpIm¶
* 
my_sf_·¹
 = 
_³nv
->
	`decide_·¹
(_³nv->
	`sf
(),
_š
.
_s_id
);

570 
	`CRITICAL_SECTION
(
sf_·¹_cs
, 
my_sf_·¹
->
_’queue_lock
);

571 ià(
my_sf_·¹
->
	`’queue
(
upd_sf
,
_bWake
)) {

572 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing UPD_SF_USD\n");

573 
	`as£¹
 (0);

574  (
	`RC
(
de_PROBLEM_ENQUEUE
));

577  (
RCOK
);

578 
	}
}

580 
DEFINE_DORA_FINAL_RVP_CLASS
(
fš®_usdmix_rvp
,
upd_sub_d©a
);

593 
	gupd_sub_usdmix_aùiÚ
::
	$ÿlc_keys
()

595 
_down
.
	`push_back
(
_š
.
_s_id
);

596 
	}
}

599 
w_rc_t
 
	gupd_sub_usdmix_aùiÚ
::
	$Œx_exec
()

601 
	`as£¹
 (
_³nv
);

605 
tu¶e_gu¬d
<
sub_mª_im¶
> 
	`´sub
(
_³nv
->
	`sub_mª
());

606 
»p_row_t
 
	`¬•row
(
_³nv
->
	`sub_mª
()->
	`ts
());

607 
¬•row
.
	`£t
(
_³nv
->
	`sub_desc
()->
	`maxsize
());

608 
´sub
->
_»p
 = &
¬•row
;

618 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

619 "Aµ: %d USD:sub-idx-Æ (%d)\n", 
_tid
.
	`g‘_lo
(), 
_š
.
_s_id
);

620 
	`W_DO
(
_³nv
->
	`sub_mª
()->
	`sub_idx_Æ
(_³nv->
	`db
(), 
´sub
, 
_š
.
_s_id
));

621 
´sub
->
	`£t_v®ue
(2, 
_š
.
_a_b™
);

622 
	`W_DO
(
_³nv
->
	`sub_mª
()->
	`upd©e_tu¶e
(_³nv->
	`db
(), 
´sub
, 
NL
));

624 #ifdeà
PRINT_TRX_RESULTS


626 
´sub
->
	`´št_tu¶e
();

629  
RCOK
;

630 
	}
}

634 
	gupd_sf_usdmix_aùiÚ
::
	$ÿlc_keys
()

636 
sáy³
 = 
_š
.
_sf_ty³
;

637 
_down
.
	`push_back
(
_š
.
_s_id
);

638 
_down
.
	`push_back
(
sáy³
);

639 
	}
}

642 
w_rc_t
 
	gupd_sf_usdmix_aùiÚ
::
	$Œx_exec
()

644 
	`as£¹
 (
_³nv
);

648 
tu¶e_gu¬d
<
sf_mª_im¶
> 
	`´sf
(
_³nv
->
	`sf_mª
());

649 
»p_row_t
 
	`¬•row
(
_³nv
->
	`sf_mª
()->
	`ts
());

650 
¬•row
.
	`£t
(
_³nv
->
	`sf_desc
()->
	`maxsize
());

651 
´sf
->
_»p
 = &
¬•row
;

662 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d USD:sf-idx-nl (%d) (%d)\n",

663 
_tid
.
	`g‘_lo
(), 
_š
.
_s_id
, _š.
_sf_ty³
);

664 
	`W_DO
(
_³nv
->
	`sf_mª
()->
	`sf_idx_Æ
(_³nv->
	`db
(), 
´sf
, 
_š
.
_s_id
, _š.
_sf_ty³
));

665 
´sf
->
	`£t_v®ue
(4, 
_š
.
_a_d©a
);

666 
	`W_DO
(
_³nv
->
	`sf_mª
()->
	`upd©e_tu¶e
(_³nv->
	`db
(), 
´sf
, 
NL
));

668 #ifdeà
PRINT_TRX_RESULTS


670 
´sf
->
	`´št_tu¶e
();

673  
RCOK
;

674 
	}
}

683 
DEFINE_DORA_FINAL_RVP_CLASS
(
fš®_ul_rvp
,
upd_loc
);

695 
	gupd_sub_ul_aùiÚ
::
	$ÿlc_keys
()

697 
_down
.
	`push_back
(
_š
.
_s_id
);

698 
	}
}

701 
w_rc_t
 
	gupd_sub_ul_aùiÚ
::
	$Œx_exec
()

703 
	`as£¹
 (
_³nv
);

707 
tu¶e_gu¬d
<
sub_mª_im¶
> 
	`´sub
(
_³nv
->
	`sub_mª
());

708 
»p_row_t
 
	`¬•row
(
_³nv
->
	`sub_mª
()->
	`ts
());

709 
¬•row
.
	`£t
(
_³nv
->
	`sub_desc
()->
	`maxsize
());

710 
´sub
->
_»p
 = &
¬•row
;

720 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

721 "Aµ: %d UL:sub-nbr-idx-Æ (%d)\n", 
_tid
.
	`g‘_lo
(), 
_š
.
_s_id
);

722 
	`W_DO
(
_³nv
->
	`sub_mª
()->
	`sub_nbr_idx_Æ
(_³nv->
	`db
(), 
´sub
, 
_š
.
_sub_nbr
));

723 
´obed_sid
;

724 
´sub
->
	`g‘_v®ue
(0, 
´obed_sid
);

725 ià(
´obed_sid
 !ğ
_š
.
_s_id
) {

726 
	`TRACE
Ğ
TRACE_ALWAYS
, "Probed sid‚ot matching sid (%d) (%d) ***\n",

727 
´obed_sid
, 
_š
.
_s_id
);

728 
	`W_DO
(
	`RC
(
de_WRONG_IDX_DATA
));

730 
´sub
->
	`£t_v®ue
(33, 
_š
.
_vÌ_loc
);

733 
	`W_DO
(
_³nv
->
	`sub_mª
()->
	`upd©e_tu¶e
(_³nv->
	`db
(), 
´sub
, 
NL
));

735 #ifdeà
PRINT_TRX_RESULTS


737 
´sub
->
	`´št_tu¶e
();

740  
RCOK
;

741 
	}
}

756 #ifdeà
TM1ICF2


758 
w_rc_t
 
	gmid1_icf_rvp
::
	$_run
()

762 
mid2_icf_rvp
* 
rvp
 = 
_³nv
->
	`Ãw_mid2_icf_rvp
(
_xù
,
_tid
,
_xù_id
,
_»suÉ
,
_š
,
_aùiÚs
,
_bWake
);

765 
	`CHECK_MIDWAY_RVP_ABORTED
(
rvp
);

768 
r_sf_icf_aùiÚ
* 
r_sf
 = 
_³nv
->
	`Ãw_r_sf_icf_aùiÚ
(
_xù
,
_tid
,
rvp
,
_š
);

770 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Nexˆpha£ (%d)\n", 
_tid
.
	`g‘_lo
());

775 
œpIm¶
* 
my_sf_·¹
 = 
_³nv
->
	`decide_·¹
(_³nv->
	`sf
(),
_š
.
_s_id
);

778 
	`CRITICAL_SECTION
(
sf_·¹_cs
, 
my_sf_·¹
->
_’queue_lock
);

779 ià(
my_sf_·¹
->
	`’queue
(
r_sf
,
_bWake
)) {

780 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing R_SF_ICF\n");

781 
	`as£¹
 (0);

782  (
	`RC
(
de_PROBLEM_ENQUEUE
));

785  (
RCOK
);

786 
	}
}

789 
w_rc_t
 
	gmid2_icf_rvp
::
	$_run
()

793 
fš®_icf_rvp
* 
ävp
 = 
_³nv
->
	`Ãw_fš®_icf_rvp
(
_xù
,
_tid
,
_xù_id
,
_»suÉ
,
_aùiÚs
);

796 
	`CHECK_MIDWAY_RVP_ABORTED
(
ävp
);

799 
šs_cf_icf_aùiÚ
* 
šs_cf
 = 
_³nv
->
	`Ãw_šs_cf_icf_aùiÚ
(
_xù
,
_tid
,
ävp
,
_š
);

801 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Nexˆpha£ (%d)\n", 
_tid
.
	`g‘_lo
());

806 
œpIm¶
* 
my_cf_·¹
 = 
_³nv
->
	`decide_·¹
(_³nv->
	`cf
(),
_š
.
_s_id
);

809 
	`CRITICAL_SECTION
(
cf_·¹_cs
, 
my_cf_·¹
->
_’queue_lock
);

810 ià(
my_cf_·¹
->
	`’queue
(
šs_cf
,
_bWake
)) {

811 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing INS_CF_ICF\n");

812 
	`as£¹
 (0);

813  (
	`RC
(
de_PROBLEM_ENQUEUE
));

816  (
RCOK
);

817 
	}
}

821 
w_rc_t
 
	gmid_icf_rvp
::
	$_run
()

824 
fš®_icf_rvp
* 
ävp
 = 
_³nv
->
	`Ãw_fš®_icf_rvp
(
_xù
,
_tid
,
_xù_id
,
_»suÉ
,
_aùiÚs
);

827 
	`CHECK_MIDWAY_RVP_ABORTED
(
ävp
);

830 
r_sf_icf_aùiÚ
* 
r_sf
 = 
_³nv
->
	`Ãw_r_sf_icf_aùiÚ
(
_xù
,
_tid
,
ävp
,
_š
);

831 
šs_cf_icf_aùiÚ
* 
šs_cf
 = 
_³nv
->
	`Ãw_šs_cf_icf_aùiÚ
(
_xù
,
_tid
,
ävp
,
_š
);

833 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Nexˆpha£ (%d)\n", 
_tid
.
	`g‘_lo
());

838 
œpIm¶
* 
my_sf_·¹
 = 
_³nv
->
	`decide_·¹
(_³nv->
	`sf
(),
_š
.
_s_id
);

839 
œpIm¶
* 
my_cf_·¹
 = 
_³nv
->
	`decide_·¹
(_³nv->
	`cf
(),
_š
.
_s_id
);

842 
	`CRITICAL_SECTION
(
sf_·¹_cs
, 
my_sf_·¹
->
_’queue_lock
);

843 ià(
my_sf_·¹
->
	`’queue
(
r_sf
,
_bWake
)) {

844 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing R_SF_ICF\n");

845 
	`as£¹
 (0);

846  (
	`RC
(
de_PROBLEM_ENQUEUE
));

850 
	`CRITICAL_SECTION
(
cf_·¹_cs
, 
my_cf_·¹
->
_’queue_lock
);

851 
sf_·¹_cs
.
	`ex™
();

852 ià(
my_cf_·¹
->
	`’queue
(
šs_cf
,
_bWake
)) {

853 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing INS_CF_ICF\n");

854 
	`as£¹
 (0);

855  (
	`RC
(
de_PROBLEM_ENQUEUE
));

859  (
RCOK
);

860 
	}
}

864 
DEFINE_DORA_FINAL_RVP_CLASS
(
fš®_icf_rvp
,
šs_ÿÎ_fwd
);

878 
	gr_sub_icf_aùiÚ
::
	$ÿlc_keys
()

880 
	`£t_»ad_Úly
();

881 
_down
.
	`push_back
(
_š
.
_s_id
);

882 
	}
}

885 
w_rc_t
 
	gr_sub_icf_aùiÚ
::
	$Œx_exec
()

887 
	`as£¹
 (
_³nv
);

891 
tu¶e_gu¬d
<
sub_mª_im¶
> 
	`´sub
(
_³nv
->
	`sub_mª
());

892 
»p_row_t
 
	`¬•row
(
_³nv
->
	`sub_mª
()->
	`ts
());

893 
¬•row
.
	`£t
(
_³nv
->
	`sub_desc
()->
	`maxsize
());

894 
´sub
->
_»p
 = &
¬•row
;

897 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

898 "Aµ: %d ICF:sub-nbr-idx-Æ (%d)\n", 
_tid
.
	`g‘_lo
(), 
_š
.
_s_id
);

899 
	`W_DO
(
_³nv
->
	`sub_mª
()->
	`sub_nbr_idx_Æ
(_³nv->
	`db
(), 
´sub
, 
_š
.
_sub_nbr
));

900 
´obed_sid
;

901 
´sub
->
	`g‘_v®ue
(0, 
´obed_sid
);

902 ià(
´obed_sid
 !ğ
_š
.
_s_id
) {

903 
	`TRACE
Ğ
TRACE_ALWAYS
, "Probed sid‚ot matching sid (%d) (%d) ***\n",

904 
´obed_sid
, 
_š
.
_s_id
);

905 
	`W_DO
(
	`RC
(
de_WRONG_IDX_DATA
));

908 #ifdeà
PRINT_TRX_RESULTS


910 
´sub
->
	`´št_tu¶e
();

913  
RCOK
;

914 
	}
}

918 
	gr_sf_icf_aùiÚ
::
	$ÿlc_keys
()

920 
	`£t_»ad_Úly
();

921 
sáy³
 = 
_š
.
_sf_ty³
;

922 
_down
.
	`push_back
(
_š
.
_s_id
);

923 
_down
.
	`push_back
(
sáy³
);

924 
	}
}

927 
w_rc_t
 
	gr_sf_icf_aùiÚ
::
	$Œx_exec
()

929 
	`as£¹
 (
_³nv
);

933 
tu¶e_gu¬d
<
sf_mª_im¶
> 
	`´sf
(
_³nv
->
	`sf_mª
());

934 
»p_row_t
 
	`¬•row
(
_³nv
->
	`sf_mª
()->
	`ts
());

935 
¬•row
.
	`£t
(
_³nv
->
	`sf_desc
()->
	`maxsize
());

936 
´sf
->
_»p
 = &
¬•row
;

938 
»p_row_t
 
	`low»p
(
_³nv
->
	`sf_mª
()->
	`ts
());

939 
»p_row_t
 
	`high»p
(
_³nv
->
	`sf_mª
()->
	`ts
());

940 
low»p
.
	`£t
(
_³nv
->
	`sf_desc
()->
	`maxsize
());

941 
high»p
.
	`£t
(
_³nv
->
	`sf_desc
()->
	`maxsize
());

943 
tm1_sf_t
 
asf
;

944 
boŞ
 
bFound
 = 
çl£
;

945 
boŞ
 
eof
;

953 #iâdeà
TM1ICF2


954 ià(
_´vp
->
	`isAbÜ‹d
()è{ 
	`W_DO
(
	`RC
(
de_MIDWAY_ABORT
)); }

958 
gu¬d
<
šdex_sÿn_™”_im¶
<
¥ecŸl_çc™y_t
> > 
sf_™”
;

960 
šdex_sÿn_™”_im¶
<
¥ecŸl_çc™y_t
>* 
tmp_sf_™”
;

961 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d ICF:sf-idx-™”-Æ\n", 
_tid
.
	`g‘_lo
());

962 
	`W_DO
(
_³nv
->
	`sf_mª
()->
	`sf_g‘_idx_™”_Æ
(_³nv->
	`db
(), 
tmp_sf_™”
, 
´sf
,

963 
low»p
, 
high»p
, 
_š
.
_s_id
));

964 
sf_™”
 = 
tmp_sf_™”
;

966 
	`W_DO
(
sf_™”
->
	`Ãxt
(
_³nv
->
	`db
(), 
eof
, *
´sf
));

968 !
eof
) {

969 #iâdeà
TM1ICF2


970 ià(
_´vp
->
	`isAbÜ‹d
()è{ 
	`W_DO
(
	`RC
(
de_MIDWAY_ABORT
)); }

973 
´sf
->
	`g‘_v®ue
(1, 
asf
.
SF_TYPE
);

975 ià(
asf
.
SF_TYPE
 =ğ
_š
.
_sf_ty³
) {

976 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d ICF: found (%d) (%d)\n",

977 
_tid
.
	`g‘_lo
(), 
_š
.
_s_id
, 
asf
.
SF_TYPE
);

978 
bFound
 = 
Œue
;

982 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d ICF:sf-idx-™”-Ãxt\n", 
_tid
.
	`g‘_lo
());

983 
	`W_DO
(
sf_™”
->
	`Ãxt
(
_³nv
->
	`db
(), 
eof
, *
´sf
));

986 ià(!
bFound
) {

987 
	`W_DO
(
	`RC
(
£_NO_CURRENT_TUPLE
));

990 #ifdeà
PRINT_TRX_RESULTS


992 
´sf
->
	`´št_tu¶e
();

995  
RCOK
;

996 
	}
}

1000 
	gšs_cf_icf_aùiÚ
::
	$ÿlc_keys
()

1002 
sáy³
 = 
_š
.
_sf_ty³
;

1003 
¡ime
 = 
_š
.
_s_time
;

1004 
_down
.
	`push_back
(
_š
.
_s_id
);

1005 
_down
.
	`push_back
(
sáy³
);

1006 
_down
.
	`push_back
(
¡ime
);

1007 
	}
}

1010 
w_rc_t
 
	gšs_cf_icf_aùiÚ
::
	$Œx_exec
()

1012 
	`as£¹
 (
_³nv
);

1016 
tu¶e_gu¬d
<
cf_mª_im¶
> 
	`´cf
(
_³nv
->
	`cf_mª
());

1017 
»p_row_t
 
	`¬•row
(
_³nv
->
	`cf_mª
()->
	`ts
());

1018 
¬•row
.
	`£t
(
_³nv
->
	`cf_desc
()->
	`maxsize
());

1019 
´cf
->
_»p
 = &
¬•row
;

1020 
»p_row_t
 
	`¬•row_key
(
_³nv
->
	`cf_mª
()->
	`ts
());

1021 
¬•row_key
.
	`£t
(
_³nv
->
	`cf_desc
()->
	`maxsize
());

1022 
´cf
->
_»p_key
 = &
¬•row_key
;

1025 
w_rc_t
 
e
;

1026 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d ICF:cf-idx-nl (%d) (%d) (%d)\n",

1027 
_tid
.
	`g‘_lo
(), 
_š
.
_s_id
, _š.
_sf_ty³
, _š.
_s_time
);

1028 #iâdeà
TM1ICF2


1029 ià(
_´vp
->
	`isAbÜ‹d
()è{ 
	`W_DO
(
	`RC
(
de_MIDWAY_ABORT
)); }

1031 
e
 = 
_³nv
->
	`cf_mª
()->
	`cf_idx_Æ
(_³nv->
	`db
(), 
´cf
, 
_š
.
_s_id
,

1032 
_š
.
_sf_ty³
, _š.
_s_time
);

1035 ià(
e
.
	`is_”rÜ
(è&&ƒ.
	`”r_num
(è=ğ
£_TUPLE_NOT_FOUND
) {

1037 
´cf
->
	`£t_v®ue
(0, 
_š
.
_s_id
);

1038 
´cf
->
	`£t_v®ue
(1, 
_š
.
_sf_ty³
);

1039 
´cf
->
	`£t_v®ue
(2, 
_š
.
_s_time
);

1040 
´cf
->
	`£t_v®ue
(3, 
_š
.
_e_time
);

1041 
´cf
->
	`£t_v®ue
(4, 
_š
.
_numb”x
);

1042 #ifdeà
CFG_HACK


1043 
´cf
->
	`£t_v®ue
(5, "padding");

1045 
	`TRACE
 (
TRACE_TRX_FLOW
, "Aµ: %d ICF:šs-cf\n", 
_tid
.
	`g‘_lo
());

1046 #iâdeà
TM1ICF2


1047 ià(
_´vp
->
	`isAbÜ‹d
()è{ 
	`W_DO
(
	`RC
(
de_MIDWAY_ABORT
)); }

1049 
	`W_DO
(
_³nv
->
	`cf_mª
()->
	`add_tu¶e
(_³nv->
	`db
(), 
´cf
, 
NL
));

1052 
	`W_DO
(
	`RC
(
£_CANNOT_INSERT_TUPLE
));

1055 #ifdeà
PRINT_TRX_RESULTS


1057 
´cf
->
	`´št_tu¶e
();

1060  
RCOK
;

1061 
	}
}

1075 
w_rc_t
 
	gmid_dcf_rvp
::
	$_run
()

1078 
fš®_dcf_rvp
* 
ävp
 = 
_³nv
->
	`Ãw_fš®_dcf_rvp
(
_xù
,
_tid
,
_xù_id
,
_»suÉ
,
_aùiÚs
);

1081 
	`CHECK_MIDWAY_RVP_ABORTED
(
ävp
);

1084 
d–_cf_dcf_aùiÚ
* 
d–_cf
 = 
_³nv
->
	`Ãw_d–_cf_dcf_aùiÚ
(
_xù
,
_tid
,
ävp
,
_š
);

1086 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Nexˆpha£ (%d)\n", 
_tid
.
	`g‘_lo
());

1091 
œpIm¶
* 
my_cf_·¹
 = 
_³nv
->
	`decide_·¹
(_³nv->
	`cf
(),
_š
.
_s_id
);

1094 
	`CRITICAL_SECTION
(
cf_·¹_cs
, 
my_cf_·¹
->
_’queue_lock
);

1095 ià(
my_cf_·¹
->
	`’queue
(
d–_cf
,
_bWake
)) {

1096 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing DEL_CF_ICF\n");

1097 
	`as£¹
 (0);

1098  (
	`RC
(
de_PROBLEM_ENQUEUE
));

1102  (
RCOK
);

1103 
	}
}

1106 
DEFINE_DORA_FINAL_RVP_CLASS
(
fš®_dcf_rvp
,
d–_ÿÎ_fwd
);

1119 
	gr_sub_dcf_aùiÚ
::
	$ÿlc_keys
()

1121 
	`£t_»ad_Úly
();

1122 
_down
.
	`push_back
(
_š
.
_s_id
);

1123 
	}
}

1126 
w_rc_t
 
	gr_sub_dcf_aùiÚ
::
	$Œx_exec
()

1128 
	`as£¹
 (
_³nv
);

1132 
tu¶e_gu¬d
<
sub_mª_im¶
> 
	`´sub
(
_³nv
->
	`sub_mª
());

1133 
»p_row_t
 
	`¬•row
(
_³nv
->
	`sub_mª
()->
	`ts
());

1134 
¬•row
.
	`£t
(
_³nv
->
	`sub_desc
()->
	`maxsize
());

1135 
´sub
->
_»p
 = &
¬•row
;

1138 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

1139 "Aµ: %d DCF:sub-nbr-idx-Æ (%d)\n", 
_tid
.
	`g‘_lo
(), 
_š
.
_s_id
);

1140 
	`W_DO
(
_³nv
->
	`sub_mª
()->
	`sub_nbr_idx_Æ
(_³nv->
	`db
(), 
´sub
, 
_š
.
_sub_nbr
));

1141 
´obed_sid
;

1142 
´sub
->
	`g‘_v®ue
(0, 
´obed_sid
);

1143 ià(
´obed_sid
 !ğ
_š
.
_s_id
) {

1144 
	`TRACE
Ğ
TRACE_ALWAYS
, "Probed sid‚ot matching sid (%d) (%d) ***\n",

1145 
´obed_sid
, 
_š
.
_s_id
);

1146 
	`W_DO
(
	`RC
(
de_WRONG_IDX_DATA
));

1149 #ifdeà
PRINT_TRX_RESULTS


1151 
´sub
->
	`´št_tu¶e
();

1154  
RCOK
;

1155 
	}
}

1159 
	gd–_cf_dcf_aùiÚ
::
	$ÿlc_keys
()

1161 
sáy³
 = 
_š
.
_sf_ty³
;

1162 
¡ime
 = 
_š
.
_s_time
;

1163 
_down
.
	`push_back
(
_š
.
_s_id
);

1164 
_down
.
	`push_back
(
sáy³
);

1165 
_down
.
	`push_back
(
¡ime
);

1166 
	}
}

1170 
w_rc_t
 
	gd–_cf_dcf_aùiÚ
::
	$Œx_exec
()

1172 
	`as£¹
 (
_³nv
);

1176 
tu¶e_gu¬d
<
cf_mª_im¶
> 
	`´cf
(
_³nv
->
	`cf_mª
());

1177 
»p_row_t
 
	`¬•row
(
_³nv
->
	`cf_mª
()->
	`ts
());

1178 
¬•row
.
	`£t
(
_³nv
->
	`cf_desc
()->
	`maxsize
());

1179 
´cf
->
_»p
 = &
¬•row
;

1190 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DCF:cf-idx-upd (%d) (%d) (%d)\n",

1191 
_tid
.
	`g‘_lo
(), 
_š
.
_s_id
, _š.
_sf_ty³
, _š.
_s_time
);

1192 
	`W_DO
(
_³nv
->
	`cf_mª
()->
	`cf_idx_Æ
(_³nv->
	`db
(), 
´cf
,

1193 
_š
.
_s_id
, _š.
_sf_ty³
, _š.
_s_time
));

1194 
	`TRACE
 (
TRACE_TRX_FLOW
, "Aµ: %d DCF:d–-cf\n", 
_tid
.
	`g‘_lo
());

1195 
	`W_DO
(
_³nv
->
	`cf_mª
()->
	`d–‘e_tu¶e
(_³nv->
	`db
(), 
´cf
, 
NL
));

1197 #ifdeà
PRINT_TRX_RESULTS


1199 
´cf
->
	`´št_tu¶e
();

1202  
RCOK
;

1203 
	}
}

1216 
DEFINE_DORA_FINAL_RVP_CLASS
(
fš®_icfb_rvp
,
šs_ÿÎ_fwd_b’ch
);

1229 
	gr_sub_icfb_aùiÚ
::
	$ÿlc_keys
()

1231 
	`£t_»ad_Úly
();

1232 
_down
.
	`push_back
(
_š
.
_s_id
);

1233 
	}
}

1236 
w_rc_t
 
	gr_sub_icfb_aùiÚ
::
	$Œx_exec
()

1238 
	`as£¹
 (
_³nv
);

1242 
tu¶e_gu¬d
<
sub_mª_im¶
> 
	`´sub
(
_³nv
->
	`sub_mª
());

1243 
»p_row_t
 
	`¬•row
(
_³nv
->
	`sub_mª
()->
	`ts
());

1244 
¬•row
.
	`£t
(
_³nv
->
	`sub_desc
()->
	`maxsize
());

1245 
´sub
->
_»p
 = &
¬•row
;

1248 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

1249 "Aµ: %d ICF:sub-nbr-idx-Æ (%d)\n", 
_tid
.
	`g‘_lo
(), 
_š
.
_s_id
);

1250 
	`W_DO
(
_³nv
->
	`sub_mª
()->
	`sub_nbr_idx_Æ
(_³nv->
	`db
(), 
´sub
, 
_š
.
_sub_nbr
));

1251 
´sub
->
	`g‘_v®ue
(0, 
_š
.
_s_id
);

1253 #ifdeà
PRINT_TRX_RESULTS


1255 
´sub
->
	`´št_tu¶e
();

1258  
RCOK
;

1259 
	}
}

1263 
	gi_cf_icfb_aùiÚ
::
	$ÿlc_keys
()

1265 
sáy³
 = 
_š
.
_sf_ty³
;

1266 
¡ime
 = 
_š
.
_s_time
;

1267 
_down
.
	`push_back
(
_š
.
_s_id
);

1268 
_down
.
	`push_back
(
sáy³
);

1269 
_down
.
	`push_back
(
¡ime
);

1270 
	}
}

1273 
w_rc_t
 
	gi_cf_icfb_aùiÚ
::
	$Œx_exec
()

1275 
	`as£¹
 (
_³nv
);

1279 
tu¶e_gu¬d
<
cf_mª_im¶
> 
	`´cf
(
_³nv
->
	`cf_mª
());

1280 
»p_row_t
 
	`¬•row
(
_³nv
->
	`cf_mª
()->
	`ts
());

1281 
¬•row
.
	`£t
(
_³nv
->
	`cf_desc
()->
	`maxsize
());

1282 
´cf
->
_»p
 = &
¬•row
;

1283 
»p_row_t
 
	`¬•row_key
(
_³nv
->
	`cf_mª
()->
	`ts
());

1284 
¬•row_key
.
	`£t
(
_³nv
->
	`cf_desc
()->
	`maxsize
());

1285 
´cf
->
_»p_key
 = &
¬•row_key
;

1288 
w_rc_t
 
e
;

1289 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d ICFB:cf-idx-nl (%d) (%d) (%d)\n",

1290 
_tid
.
	`g‘_lo
(), 
_š
.
_s_id
, _š.
_sf_ty³
, _š.
_s_time
);

1291 
e
 = 
_³nv
->
	`cf_mª
()->
	`cf_idx_Æ
(_³nv->
	`db
(), 
´cf
,

1292 
_š
.
_s_id
, _š.
_sf_ty³
, _š.
_s_time
);

1294 ià(
e
.
	`is_”rÜ
(è&&ƒ.
	`”r_num
(è=ğ
£_TUPLE_NOT_FOUND
) {

1296 
´cf
->
	`£t_v®ue
(0, 
_š
.
_s_id
);

1297 
´cf
->
	`£t_v®ue
(1, 
_š
.
_sf_ty³
);

1298 
´cf
->
	`£t_v®ue
(2, 
_š
.
_s_time
);

1299 
´cf
->
	`£t_v®ue
(3, 
_š
.
_e_time
);

1300 
´cf
->
	`£t_v®ue
(4, 
_š
.
_numb”x
);

1301 #ifdeà
CFG_HACK


1302 
´cf
->
	`£t_v®ue
(5, "padding");

1304 
	`TRACE
 (
TRACE_TRX_FLOW
, "Aµ: %d ICFB:šs-cf\n", 
_tid
.
	`g‘_lo
());

1305 
	`W_DO
(
_³nv
->
	`cf_mª
()->
	`add_tu¶e
(_³nv->
	`db
(), 
´cf
, 
NL
));

1307 if(
e
.
	`is_”rÜ
()è{ 
	`W_DO
(e); }

1308 
	`TRACE
 (
TRACE_TRX_FLOW
, "Aµ: %d ICFB:d–-cf\n", 
_tid
.
	`g‘_lo
());

1309 
	`W_DO
(
_³nv
->
	`cf_mª
()->
	`d–‘e_tu¶e
(_³nv->
	`db
(), 
´cf
, 
NL
));

1312 #ifdeà
PRINT_TRX_RESULTS


1314 
´cf
->
	`´št_tu¶e
();

1317  
RCOK
;

1318 
	}
}

1332 
DEFINE_DORA_FINAL_RVP_CLASS
(
fš®_g¢_rvp
,
g‘_sub_nbr
);

1348 #iâdeà
USE_DORA_EXT_IDX


1349 
	gr_sub_g¢_aùiÚ
::
	$ÿlc_keys
()

1352 
	`£t_»ad_Úly
();

1355 
	`£t_is_¿nge
();

1358 
_key_li¡
.
	`»£rve
(
_š
.
_¿nge
);

1359 
sid
;

1360 
ušt
 
i
=0; i<
_š
.
_¿nge
; i++) {

1361 
¿nge_aùiÚ_im¶
<>::
Key
 
aKey
;

1362 
sid
 = 
_š
.
_s_id
 + 
i
;

1363 
aKey
.
	`push_back
(
sid
);

1364 
¿nge_aùiÚ_im¶
<>::
_key_li¡
.
	`push_back
(
aKey
);

1371 #w¬nšg 
Look
 
©
 
lock_mª_t
::
	`acquœe_®l
() !!!

1372 
	}
}

1374 
w_rc_t
 
	gr_sub_g¢_aùiÚ
::
	$Œx_exec
()

1376 
	`as£¹
 (
_³nv
);

1380 
tu¶e_gu¬d
<
sub_mª_im¶
> 
	`´sub
(
_³nv
->
	`sub_mª
());

1381 
»p_row_t
 
	`¬•row
(
_³nv
->
	`sub_mª
()->
	`ts
());

1382 
¬•row
.
	`£t
(
_³nv
->
	`sub_desc
()->
	`maxsize
());

1383 
´sub
->
_»p
 = &
¬•row
;

1384 
»p_row_t
 
	`low»p
(
_³nv
->
	`sub_mª
()->
	`ts
());

1385 
»p_row_t
 
	`high»p
(
_³nv
->
	`sub_mª
()->
	`ts
());

1386 
low»p
.
	`£t
(
_³nv
->
	`sub_desc
()->
	`maxsize
());

1387 
high»p
.
	`£t
(
_³nv
->
	`sub_desc
()->
	`maxsize
());

1389 
boŞ
 
eof
;

1390 
sid
, 
vÌloc
;

1401 
gu¬d
<
šdex_sÿn_™”_im¶
<
subsüib”_t
> > 
sub_™”
;

1403 
šdex_sÿn_™”_im¶
<
subsüib”_t
>* 
tmp_sub_™”
;

1404 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d GSN:sub-nbr-idx-iter (%d) (%d)\n",

1405 
_tid
.
	`g‘_lo
(), 
_š
.
_s_id
, _š.
_¿nge
);

1406 
	`W_DO
(
_³nv
->
	`sub_mª
()->
	`sub_g‘_idx_™”
(_³nv->
	`db
(), 
tmp_sub_™”
, 
´sub
,

1407 
low»p
,
high»p
, 
_š
.
_s_id
,

1408 
_š
.
_¿nge
, 
NL
, 
Œue
));

1409 
sub_™”
 = 
tmp_sub_™”
;

1413 
	`W_DO
(
sub_™”
->
	`Ãxt
(
_³nv
->
	`db
(), 
eof
, *
´sub
));

1414 !
eof
) {

1415 
´sub
->
	`g‘_v®ue
(0, 
sid
);

1416 
´sub
->
	`g‘_v®ue
(33, 
vÌloc
);

1417 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d GSN:„ead (%d) (%d)\n",

1418 
_tid
.
	`g‘_lo
(), 
sid
, 
vÌloc
);

1419 
	`W_DO
(
sub_™”
->
	`Ãxt
(
_³nv
->
	`db
(), 
eof
, *
´sub
));

1422  
RCOK
;

1423 
	}
}

1427 
	gr_sub_g¢_acc_aùiÚ
::
	$ÿlc_keys
()

1429 
	`£t_»ad_Úly
();

1430 
	`£t_£cÚd¬y
();

1434 
	`£t_is_¿nge
();

1435 
_key_li¡
.
	`»£rve
(
_š
.
_·œs
.
	`size
());

1436 
veùÜ
< 
	t·œ
<,
	trid_t
> >::
	t™”©Ü
 
	t·œ_™”©Ü
;

1437 
·œ_™”©Ü
 
™
=
_š
.
_·œs
.
	`begš
(); it!=_š._·œs.
	`’d
(); it++) {

1438 
¿nge_aùiÚ_im¶
<>::
Key
 
aKey
;

1439 
aKey
.
	`push_back
((*
™
).
fœ¡
);

1440 
¿nge_aùiÚ_im¶
<>::
_key_li¡
.
	`push_back
(
aKey
);

1442 
	}
}

1445 
w_rc_t
 
	gr_sub_g¢_acc_aùiÚ
::
	$Œx_exec
()

1447 
	`as£¹
 (
_³nv
);

1451 
tu¶e_gu¬d
<
sub_mª_im¶
> 
	`´sub
(
_³nv
->
	`sub_mª
());

1452 
»p_row_t
 
	`¬•row
(
_³nv
->
	`sub_mª
()->
	`ts
());

1453 
¬•row
.
	`£t
(
_³nv
->
	`sub_desc
()->
	`maxsize
());

1454 
´sub
->
_»p
 = &
¬•row
;

1455 
vÌloc
;

1457 
veùÜ
< 
	t·œ
<,
	trid_t
> >::
	t™”©Ü
 
	t·œ_™”©Ü
;

1458 
rid_t
 
¬id
;

1459 
·œ_™”©Ü
 
™
=
_š
.
_·œs
.
	`begš
(); it!=_š._·œs.
	`’d
(); it++) {

1460 
¬id
 = (*
™
).
£cÚd
;

1463 
´sub
->
	`£t_rid
(
¬id
);

1464 
	`W_DO
(
_³nv
->
	`sub_mª
()->
	`»ad_tu¶e
(
´sub
,
NL
));

1465 
´sub
->
	`g‘_v®ue
(33, 
vÌloc
);

1467 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d GSN:„ead (%d) (%d)\n",

1468 
_tid
.
	`g‘_lo
(), (*
™
).
fœ¡
, 
vÌloc
);

1471  
RCOK
;

1472 
	}
}

1477 
EXIT_NAMESPACE
(
dÜa
);

	@src/dora/tm1/dora_tm1_xct.cpp

32 
	~"dÜa/tm1/dÜa_tm1_im¶.h
"

33 
	~"dÜa/tm1/dÜa_tm1.h
"

35 
	~<®gÜ™hm
>

36 
	~<li¡
>

37 
	~<ut™y
>

39 
usšg
 
Çme¥aû
 
	gshÜe
;

40 
usšg
 
Çme¥aû
 
	gtm1
;

42 
usšg
 
Çme¥aû
 
	g¡d
;

44 
ENTER_NAMESPACE
(
dÜa
);

46 
	g·¹™iÚ_t
<> 
	tœpIm¶
;

82 
DEFINE_DORA_WITHOUT_INPUT_TRX_WRAPPER
(
DÜaTM1Env
,
g‘_sub_d©a
);

83 
DEFINE_DORA_WITHOUT_INPUT_TRX_WRAPPER
(
DÜaTM1Env
,
g‘_Ãw_de¡
);

84 
DEFINE_DORA_WITHOUT_INPUT_TRX_WRAPPER
(
DÜaTM1Env
,
g‘_acc_d©a
);

85 
DEFINE_DORA_WITHOUT_INPUT_TRX_WRAPPER
(
DÜaTM1Env
,
upd_sub_d©a
);

86 
DEFINE_ALTER_DORA_WITHOUT_INPUT_TRX_WRAPPER
(
DÜaTM1Env
,
upd_sub_d©a
,
upd_sub_d©a_mix
);

87 
DEFINE_DORA_WITHOUT_INPUT_TRX_WRAPPER
(
DÜaTM1Env
,
upd_loc
);

88 
DEFINE_DORA_WITHOUT_INPUT_TRX_WRAPPER
(
DÜaTM1Env
,
šs_ÿÎ_fwd
);

89 
DEFINE_DORA_WITHOUT_INPUT_TRX_WRAPPER
(
DÜaTM1Env
,
d–_ÿÎ_fwd
);

91 
DEFINE_DORA_WITHOUT_INPUT_TRX_WRAPPER
(
DÜaTM1Env
,
g‘_sub_nbr
);

93 
DEFINE_DORA_WITHOUT_INPUT_TRX_WRAPPER
(
DÜaTM1Env
,
šs_ÿÎ_fwd_b’ch
);

104 
w_rc_t
 
	gDÜaTM1Env
::
	$dÜa_g‘_sub_d©a
(cÚ¡ 
xù_id
,

105 
Œx_»suÉ_tu¶e_t
& 
©¹
,

106 
g‘_sub_d©a_šput_t
& 
š
,

107 cÚ¡ 
boŞ
 
bWake
)

109 if(
_¡¬t_imb®ªû
 > 0 && !
_bAÏrmS‘
) {

110 
	`CRITICAL_SECTION
(
®¬m_cs
, 
_®¬m_lock
);

111 if(!
_bAÏrmS‘
) {

112 
	`®¬m
(
_¡¬t_imb®ªû
);

113 
_bAÏrmS‘
 = 
Œue
;

118 
tid_t
 
©id
;

120 
	`W_DO
(
_pssm
->
	`begš_xù
(
©id
));

121 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Begš (%d)\n", 
©id
.
	`g‘_lo
());

123 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

126 
	`as£¹
 (
pxù
);

127 
smth»ad_t
::
	`me
()->
	`d‘ach_xù
(
pxù
);

128 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "D‘ached from (%d)\n", 
©id
.
	`g‘_lo
());

131 
fš®_gsd_rvp
* 
ävp
 = 
	`Ãw_fš®_gsd_rvp
(
pxù
,
©id
,
xù_id
,
©¹
);

134 
r_sub_gsd_aùiÚ
* 
r_sub
 = 
	`Ãw_r_sub_gsd_aùiÚ
(
pxù
,
©id
,
ävp
,
š
);

140 
œpIm¶
* 
my_sub_·¹
 = 
	`decide_·¹
(
	`sub
(),
š
.
_s_id
);

141 
	`as£¹
 (
my_sub_·¹
);

144 
	`CRITICAL_SECTION
(
sub_·¹_cs
, 
my_sub_·¹
->
_’queue_lock
);

145 ià(
my_sub_·¹
->
	`’queue
(
r_sub
,
bWake
)) {

146 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing R_SUB_GSD\n");

147 
	`as£¹
 (0);

148  (
	`RC
(
de_PROBLEM_ENQUEUE
));

152  (
RCOK
);

153 
	}
}

162 #ifdeà
TM1GND2


164 
w_rc_t
 
	gDÜaTM1Env
::
	$dÜa_g‘_Ãw_de¡
(cÚ¡ 
xù_id
,

165 
Œx_»suÉ_tu¶e_t
& 
©¹
,

166 
g‘_Ãw_de¡_šput_t
& 
š
,

167 cÚ¡ 
boŞ
 
bWake
)

169 if(
_¡¬t_imb®ªû
 > 0 && !
_bAÏrmS‘
) {

170 
	`CRITICAL_SECTION
(
®¬m_cs
, 
_®¬m_lock
);

171 if(!
_bAÏrmS‘
) {

172 
	`®¬m
(
_¡¬t_imb®ªû
);

173 
_bAÏrmS‘
 = 
Œue
;

178 
tid_t
 
©id
;

180 
	`W_DO
(
_pssm
->
	`begš_xù
(
©id
));

181 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Begš (%d)\n", 
©id
.
	`g‘_lo
());

183 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

186 
	`as£¹
 (
pxù
);

187 
smth»ad_t
::
	`me
()->
	`d‘ach_xù
(
pxù
);

188 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "D‘ached from (%d)\n", 
©id
.
	`g‘_lo
());

192 
mid_gnd_rvp
* 
rvp
 = 
	`Ãw_mid_gnd_rvp
(
pxù
,
©id
,
xù_id
,
©¹
,
š
,
bWake
);

195 
r_sf_gnd_aùiÚ
* 
r_sf
 = 
	`Ãw_r_sf_gnd_aùiÚ
(
pxù
,
©id
,
rvp
,
š
);

200 
œpIm¶
* 
my_sf_·¹
 = 
	`decide_·¹
(
	`sf
(),
š
.
_s_id
);

203 
	`CRITICAL_SECTION
(
sf_·¹_cs
, 
my_sf_·¹
->
_’queue_lock
);

204 ià(
my_sf_·¹
->
	`’queue
(
r_sf
,
bWake
)) {

205 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing R_SF\n");

206 
	`as£¹
 (0);

207  (
	`RC
(
de_PROBLEM_ENQUEUE
));

210  (
RCOK
);

211 
	}
}

215 
w_rc_t
 
	gDÜaTM1Env
::
	$dÜa_g‘_Ãw_de¡
(cÚ¡ 
xù_id
,

216 
Œx_»suÉ_tu¶e_t
& 
©¹
,

217 
g‘_Ãw_de¡_šput_t
& 
š
,

218 cÚ¡ 
boŞ
 
bWake
)

220 if(
_¡¬t_imb®ªû
 > 0 && !
_bAÏrmS‘
) {

221 
	`CRITICAL_SECTION
(
®¬m_cs
, 
_®¬m_lock
);

222 if(!
_bAÏrmS‘
) {

223 
	`®¬m
(
_¡¬t_imb®ªû
);

224 
_bAÏrmS‘
 = 
Œue
;

229 
tid_t
 
©id
;

231 
	`W_DO
(
_pssm
->
	`begš_xù
(
©id
));

232 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Begš (%d)\n", 
©id
);

234 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

237 
	`as£¹
 (
pxù
);

238 
smth»ad_t
::
	`me
()->
	`d‘ach_xù
(
pxù
);

239 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "D‘ached from (%d)\n", 
©id
);

242 
fš®_gnd_rvp
* 
ävp
 = 
	`Ãw_fš®_gnd_rvp
(
pxù
,
©id
,
xù_id
,
©¹
);

245 
r_sf_gnd_aùiÚ
* 
r_sf
 = 
	`Ãw_r_sf_gnd_aùiÚ
(
pxù
,
©id
,
ävp
,
š
);

246 
r_cf_gnd_aùiÚ
* 
r_cf
 = 
	`Ãw_r_cf_gnd_aùiÚ
(
pxù
,
©id
,
ävp
,
š
);

252 
œpIm¶
* 
my_sf_·¹
 = 
	`decide_·¹
(
	`sf
(),
š
.
_s_id
);

253 
œpIm¶
* 
my_cf_·¹
 = 
	`decide_·¹
(
	`cf
(),
š
.
_s_id
);

256 
	`CRITICAL_SECTION
(
sf_·¹_cs
, 
my_sf_·¹
->
_’queue_lock
);

257 ià(
my_sf_·¹
->
	`’queue
(
r_sf
,
bWake
)) {

258 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing R_SF\n");

259 
	`as£¹
 (0);

260  (
	`RC
(
de_PROBLEM_ENQUEUE
));

264 
	`CRITICAL_SECTION
(
cf_·¹_cs
, 
my_cf_·¹
->
_’queue_lock
);

265 
sf_·¹_cs
.
	`ex™
();

266 ià(
my_cf_·¹
->
	`’queue
(
r_cf
,
bWake
)) {

267 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing R_CF\n");

268 
	`as£¹
 (0);

269  (
	`RC
(
de_PROBLEM_ENQUEUE
));

273  (
RCOK
);

274 
	}
}

285 
w_rc_t
 
	gDÜaTM1Env
::
	$dÜa_g‘_acc_d©a
(cÚ¡ 
xù_id
,

286 
Œx_»suÉ_tu¶e_t
& 
©¹
,

287 
g‘_acc_d©a_šput_t
& 
š
,

288 cÚ¡ 
boŞ
 
bWake
)

290 if(
_¡¬t_imb®ªû
 > 0 && !
_bAÏrmS‘
) {

291 
	`CRITICAL_SECTION
(
®¬m_cs
, 
_®¬m_lock
);

292 if(!
_bAÏrmS‘
) {

293 
	`®¬m
(
_¡¬t_imb®ªû
);

294 
_bAÏrmS‘
 = 
Œue
;

299 
tid_t
 
©id
;

301 
	`W_DO
(
_pssm
->
	`begš_xù
(
©id
));

302 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Begš (%d)\n", 
©id
.
	`g‘_lo
());

304 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

307 
	`as£¹
 (
pxù
);

308 
smth»ad_t
::
	`me
()->
	`d‘ach_xù
(
pxù
);

309 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "D‘ached from (%d)\n", 
©id
.
	`g‘_lo
());

312 
fš®_gad_rvp
* 
ävp
 = 
	`Ãw_fš®_gad_rvp
(
pxù
,
©id
,
xù_id
,
©¹
);

315 
r_ai_gad_aùiÚ
* 
r_ai
 = 
	`Ãw_r_ai_gad_aùiÚ
(
pxù
,
©id
,
ävp
,
š
);

321 
œpIm¶
* 
my_ai_·¹
 = 
	`decide_·¹
(
	`ai
(),
š
.
_s_id
);

324 
	`CRITICAL_SECTION
(
ai_·¹_cs
, 
my_ai_·¹
->
_’queue_lock
);

325 ià(
my_ai_·¹
->
	`’queue
(
r_ai
,
bWake
)) {

326 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing R_AI_GAD\n");

327 
	`as£¹
 (0);

328  (
	`RC
(
de_PROBLEM_ENQUEUE
));

332  (
RCOK
);

333 
	}
}

342 #ifdeà
TM1USD2


344 
w_rc_t
 
	gDÜaTM1Env
::
	$dÜa_upd_sub_d©a
(cÚ¡ 
xù_id
,

345 
Œx_»suÉ_tu¶e_t
& 
©¹
,

346 
upd_sub_d©a_šput_t
& 
š
,

347 cÚ¡ 
boŞ
 
bWake
)

349 if(
_¡¬t_imb®ªû
 > 0 && !
_bAÏrmS‘
) {

350 
	`CRITICAL_SECTION
(
®¬m_cs
, 
_®¬m_lock
);

351 if(!
_bAÏrmS‘
) {

352 
	`®¬m
(
_¡¬t_imb®ªû
);

353 
_bAÏrmS‘
 = 
Œue
;

358 
tid_t
 
©id
;

360 
	`W_DO
(
_pssm
->
	`begš_xù
(
©id
));

361 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Begš (%d)\n", 
©id
.
	`g‘_lo
());

363 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

366 
	`as£¹
 (
pxù
);

367 
smth»ad_t
::
	`me
()->
	`d‘ach_xù
(
pxù
);

368 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "D‘ached from (%d)\n", 
©id
.
	`g‘_lo
());

372 
mid_usd_rvp
* 
rvp
 = 
	`Ãw_mid_usd_rvp
(
pxù
,
©id
,
xù_id
,
©¹
,
š
,
bWake
);

375 
upd_sf_usd_aùiÚ
* 
upd_sf
 = 
	`Ãw_upd_sf_usd_aùiÚ
(
pxù
,
©id
,
rvp
,
š
);

380 
œpIm¶
* 
my_sf_·¹
 = 
	`decide_·¹
(
	`sf
(),
š
.
_s_id
);

383 
	`CRITICAL_SECTION
(
sf_·¹_cs
, 
my_sf_·¹
->
_’queue_lock
);

384 ià(
my_sf_·¹
->
	`’queue
(
upd_sf
,
bWake
)) {

385 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing UPD_SF\n");

386 
	`as£¹
 (0);

387  (
	`RC
(
de_PROBLEM_ENQUEUE
));

390  (
RCOK
);

391 
	}
}

396 
w_rc_t
 
	gDÜaTM1Env
::
	$dÜa_upd_sub_d©a
(cÚ¡ 
xù_id
,

397 
Œx_»suÉ_tu¶e_t
& 
©¹
,

398 
upd_sub_d©a_šput_t
& 
š
,

399 cÚ¡ 
boŞ
 
bWake
)

401 if(
_¡¬t_imb®ªû
 > 0 && !
_bAÏrmS‘
) {

402 
	`CRITICAL_SECTION
(
®¬m_cs
, 
_®¬m_lock
);

403 if(!
_bAÏrmS‘
) {

404 
	`®¬m
(
_¡¬t_imb®ªû
);

405 
_bAÏrmS‘
 = 
Œue
;

410 
tid_t
 
©id
;

412 
	`W_DO
(
_pssm
->
	`begš_xù
(
©id
));

413 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Begš (%d)\n", 
©id
);

415 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

418 
	`as£¹
 (
pxù
);

419 
smth»ad_t
::
	`me
()->
	`d‘ach_xù
(
pxù
);

420 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "D‘ached from (%d)\n", 
©id
);

423 
fš®_usd_rvp
* 
ävp
 = 
	`Ãw_fš®_usd_rvp
(
pxù
,
©id
,
xù_id
,
©¹
);

426 
upd_sub_usd_aùiÚ
* 
upd_sub
 = 
	`Ãw_upd_sub_usd_aùiÚ
(
pxù
,
©id
,
ävp
,
š
);

427 
upd_sf_usd_aùiÚ
* 
upd_sf
 = 
	`Ãw_upd_sf_usd_aùiÚ
(
pxù
,
©id
,
ävp
,
š
);

433 
œpIm¶
* 
my_sub_·¹
 = 
	`decide_·¹
(
	`sub
(),
š
.
_s_id
);

434 
œpIm¶
* 
my_sf_·¹
 = 
	`decide_·¹
(
	`sf
(),
š
.
_s_id
);

437 
	`CRITICAL_SECTION
(
sub_·¹_cs
, 
my_sub_·¹
->
_’queue_lock
);

438 ià(
my_sub_·¹
->
	`’queue
(
upd_sub
,
bWake
)) {

439 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing UPD_SUB\n");

440 
	`as£¹
 (0);

441  (
	`RC
(
de_PROBLEM_ENQUEUE
));

445 
	`CRITICAL_SECTION
(
sf_·¹_cs
, 
my_sf_·¹
->
_’queue_lock
);

446 
sub_·¹_cs
.
	`ex™
();

447 ià(
my_sf_·¹
->
	`’queue
(
upd_sf
,
bWake
)) {

448 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing UPD_SF\n");

449 
	`as£¹
 (0);

450  (
	`RC
(
de_PROBLEM_ENQUEUE
));

454  (
RCOK
);

455 
	}
}

466 
w_rc_t
 
	gDÜaTM1Env
::
	$dÜa_upd_sub_d©a_mix
(cÚ¡ 
xù_id
,

467 
Œx_»suÉ_tu¶e_t
& 
©¹
,

468 
upd_sub_d©a_šput_t
& 
š
,

469 cÚ¡ 
boŞ
 
bWake
)

471 if(
_¡¬t_imb®ªû
 > 0 && !
_bAÏrmS‘
) {

472 
	`CRITICAL_SECTION
(
®¬m_cs
, 
_®¬m_lock
);

473 if(!
_bAÏrmS‘
) {

474 
	`®¬m
(
_¡¬t_imb®ªû
);

475 
_bAÏrmS‘
 = 
Œue
;

480 
tid_t
 
©id
;

482 
	`W_DO
(
_pssm
->
	`begš_xù
(
©id
));

483 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Begš (%d)\n", 
©id
.
	`g‘_lo
());

485 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

488 
	`as£¹
 (
pxù
);

489 
smth»ad_t
::
	`me
()->
	`d‘ach_xù
(
pxù
);

490 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "D‘ached from (%d)\n", 
©id
.
	`g‘_lo
());

494 
mid_usdmix_rvp
* 
rvp
 = 
	`Ãw_mid_usdmix_rvp
(
pxù
,
©id
,
xù_id
,
©¹
,
š
,
bWake
);

497 
upd_sub_usdmix_aùiÚ
* 
upd_sub
 = 
	`Ãw_upd_sub_usdmix_aùiÚ
(
pxù
,
©id
,
rvp
,
š
);

502 
œpIm¶
* 
my_sub_·¹
 = 
	`decide_·¹
(
	`sub
(),
š
.
_s_id
);

505 
	`CRITICAL_SECTION
(
sub_·¹_cs
, 
my_sub_·¹
->
_’queue_lock
);

506 ià(
my_sub_·¹
->
	`’queue
(
upd_sub
,
bWake
)) {

507 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing UPD_SUB\n");

508 
	`as£¹
 (0);

509  (
	`RC
(
de_PROBLEM_ENQUEUE
));

512  (
RCOK
);

513 
	}
}

522 
w_rc_t
 
	gDÜaTM1Env
::
	$dÜa_upd_loc
(cÚ¡ 
xù_id
,

523 
Œx_»suÉ_tu¶e_t
& 
©¹
,

524 
upd_loc_šput_t
& 
š
,

525 cÚ¡ 
boŞ
 
bWake
)

527 if(
_¡¬t_imb®ªû
 > 0 && !
_bAÏrmS‘
) {

528 
	`CRITICAL_SECTION
(
®¬m_cs
, 
_®¬m_lock
);

529 if(!
_bAÏrmS‘
) {

530 
	`®¬m
(
_¡¬t_imb®ªû
);

531 
_bAÏrmS‘
 = 
Œue
;

536 
tid_t
 
©id
;

538 
	`W_DO
(
_pssm
->
	`begš_xù
(
©id
));

539 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Begš (%d)\n", 
©id
.
	`g‘_lo
());

541 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

544 
	`as£¹
 (
pxù
);

545 
smth»ad_t
::
	`me
()->
	`d‘ach_xù
(
pxù
);

546 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "D‘ached from (%d)\n", 
©id
.
	`g‘_lo
());

549 
fš®_ul_rvp
* 
ävp
 = 
	`Ãw_fš®_ul_rvp
(
pxù
,
©id
,
xù_id
,
©¹
);

552 
upd_sub_ul_aùiÚ
* 
upd_sub
 = 
	`Ãw_upd_sub_ul_aùiÚ
(
pxù
,
©id
,
ävp
,
š
);

558 
œpIm¶
* 
my_sub_·¹
 = 
	`decide_·¹
(
	`sub
(),
š
.
_s_id
);

561 
	`CRITICAL_SECTION
(
sub_·¹_cs
, 
my_sub_·¹
->
_’queue_lock
);

562 ià(
my_sub_·¹
->
	`’queue
(
upd_sub
,
bWake
)) {

563 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing UPD_SUB_UL\n");

564 
	`as£¹
 (0);

565  (
	`RC
(
de_PROBLEM_ENQUEUE
));

569  (
RCOK
);

570 
	}
}

580 
w_rc_t
 
	gDÜaTM1Env
::
	$dÜa_šs_ÿÎ_fwd
(cÚ¡ 
xù_id
,

581 
Œx_»suÉ_tu¶e_t
& 
©¹
,

582 
šs_ÿÎ_fwd_šput_t
& 
š
,

583 cÚ¡ 
boŞ
 
bWake
)

585 if(
_¡¬t_imb®ªû
 > 0 && !
_bAÏrmS‘
) {

586 
	`CRITICAL_SECTION
(
®¬m_cs
, 
_®¬m_lock
);

587 if(!
_bAÏrmS‘
) {

588 
	`®¬m
(
_¡¬t_imb®ªû
);

589 
_bAÏrmS‘
 = 
Œue
;

594 
tid_t
 
©id
;

596 
	`W_DO
(
_pssm
->
	`begš_xù
(
©id
));

597 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Begš (%d)\n", 
©id
.
	`g‘_lo
());

599 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

602 
	`as£¹
 (
pxù
);

603 
smth»ad_t
::
	`me
()->
	`d‘ach_xù
(
pxù
);

604 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "D‘ached from (%d)\n", 
©id
.
	`g‘_lo
());

608 #ifdeà
TM1ICF2


609 
mid1_icf_rvp
* 
rvp
 = 
	`Ãw_mid1_icf_rvp
(
pxù
,
©id
,
xù_id
,
©¹
,
š
,
bWake
);

611 
mid_icf_rvp
* 
rvp
 = 
	`Ãw_mid_icf_rvp
(
pxù
,
©id
,
xù_id
,
©¹
,
š
,
bWake
);

615 
r_sub_icf_aùiÚ
* 
r_sub
 = 
	`Ãw_r_sub_icf_aùiÚ
(
pxù
,
©id
,
rvp
,
š
);

620 
œpIm¶
* 
my_sub_·¹
 = 
	`decide_·¹
(
	`sub
(),
š
.
_s_id
);

623 
	`CRITICAL_SECTION
(
sub_·¹_cs
, 
my_sub_·¹
->
_’queue_lock
);

624 ià(
my_sub_·¹
->
	`’queue
(
r_sub
,
bWake
)) {

625 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing R_SUB_ICF\n");

626 
	`as£¹
 (0);

627  (
	`RC
(
de_PROBLEM_ENQUEUE
));

630  (
RCOK
);

631 
	}
}

640 
w_rc_t
 
	gDÜaTM1Env
::
	$dÜa_d–_ÿÎ_fwd
(cÚ¡ 
xù_id
,

641 
Œx_»suÉ_tu¶e_t
& 
©¹
,

642 
d–_ÿÎ_fwd_šput_t
& 
š
,

643 cÚ¡ 
boŞ
 
bWake
)

645 if(
_¡¬t_imb®ªû
 > 0 && !
_bAÏrmS‘
) {

646 
	`CRITICAL_SECTION
(
®¬m_cs
, 
_®¬m_lock
);

647 if(!
_bAÏrmS‘
) {

648 
	`®¬m
(
_¡¬t_imb®ªû
);

649 
_bAÏrmS‘
 = 
Œue
;

654 
tid_t
 
©id
;

656 
	`W_DO
(
_pssm
->
	`begš_xù
(
©id
));

657 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Begš (%d)\n", 
©id
.
	`g‘_lo
());

659 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

662 
	`as£¹
 (
pxù
);

663 
smth»ad_t
::
	`me
()->
	`d‘ach_xù
(
pxù
);

664 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "D‘ached from (%d)\n", 
©id
.
	`g‘_lo
());

668 
mid_dcf_rvp
* 
rvp
 = 
	`Ãw_mid_dcf_rvp
(
pxù
,
©id
,
xù_id
,
©¹
,
š
,
bWake
);

671 
r_sub_dcf_aùiÚ
* 
r_sub
 = 
	`Ãw_r_sub_dcf_aùiÚ
(
pxù
,
©id
,
rvp
,
š
);

676 
œpIm¶
* 
my_sub_·¹
 = 
	`decide_·¹
(
	`sub
(),
š
.
_s_id
);

679 
	`CRITICAL_SECTION
(
sub_·¹_cs
, 
my_sub_·¹
->
_’queue_lock
);

680 ià(
my_sub_·¹
->
	`’queue
(
r_sub
,
bWake
)) {

681 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing R_SUB_DCF\n");

682 
	`as£¹
 (0);

683  (
	`RC
(
de_PROBLEM_ENQUEUE
));

687  (
RCOK
);

688 
	}
}

698 
w_rc_t
 
	gDÜaTM1Env
::
	$dÜa_šs_ÿÎ_fwd_b’ch
(cÚ¡ 
xù_id
,

699 
Œx_»suÉ_tu¶e_t
& 
©¹
,

700 
šs_ÿÎ_fwd_b’ch_šput_t
& 
š
,

701 cÚ¡ 
boŞ
 
bWake
)

704 
tid_t
 
©id
;

706 
	`W_DO
(
_pssm
->
	`begš_xù
(
©id
));

707 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Begš (%d)\n", 
©id
.
	`g‘_lo
());

709 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

712 
	`as£¹
 (
pxù
);

713 
smth»ad_t
::
	`me
()->
	`d‘ach_xù
(
pxù
);

714 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "D‘ached from (%d)\n", 
©id
.
	`g‘_lo
());

718 
fš®_icfb_rvp
* 
rvp
 = 
	`Ãw_fš®_icfb_rvp
(
pxù
,
©id
,
xù_id
,
©¹
);

721 
r_sub_icfb_aùiÚ
* 
r_sub
 = 
	`Ãw_r_sub_icfb_aùiÚ
(
pxù
,
©id
,
rvp
,
š
);

722 
i_cf_icfb_aùiÚ
* 
i_cf
 = 
	`Ãw_i_cf_icfb_aùiÚ
(
pxù
,
©id
,
rvp
,
š
);

727 
œpIm¶
* 
my_sub_·¹
 = 
	`decide_·¹
(
	`sub
(),
š
.
_s_id
);

728 
œpIm¶
* 
my_cf_·¹
 = 
	`decide_·¹
(
	`cf
(),
š
.
_s_id
);

731 
	`CRITICAL_SECTION
(
sub_·¹_cs
, 
my_sub_·¹
->
_’queue_lock
);

732 ià(
my_sub_·¹
->
	`’queue
(
r_sub
,
bWake
)) {

733 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing R_SUB_ICFB\n");

734 
	`as£¹
 (0);

735  (
	`RC
(
de_PROBLEM_ENQUEUE
));

739 
	`CRITICAL_SECTION
(
cf_·¹_cs
, 
my_cf_·¹
->
_’queue_lock
);

740 
sub_·¹_cs
.
	`ex™
();

741 ià(
my_cf_·¹
->
	`’queue
(
i_cf
,
bWake
)) {

742 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing I_CF_ICFB\n");

743 
	`as£¹
 (0);

744  (
	`RC
(
de_PROBLEM_ENQUEUE
));

748  (
RCOK
);

749 
	}
}

772 #iâdeà
USE_DORA_EXT_IDX


776 
w_rc_t
 
	gDÜaTM1Env
::
	$dÜa_g‘_sub_nbr
(cÚ¡ 
xù_id
,

777 
Œx_»suÉ_tu¶e_t
& 
©¹
,

778 
g‘_sub_nbr_šput_t
& 
š
,

779 cÚ¡ 
boŞ
 
bWake
)

781 if(
_¡¬t_imb®ªû
 > 0 && !
_bAÏrmS‘
) {

782 
	`CRITICAL_SECTION
(
®¬m_cs
, 
_®¬m_lock
);

783 if(!
_bAÏrmS‘
) {

784 
	`®¬m
(
_¡¬t_imb®ªû
);

785 
_bAÏrmS‘
 = 
Œue
;

790 
tid_t
 
©id
;

792 
	`W_DO
(
_pssm
->
	`begš_xù
(
©id
));

793 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Begš (%d)\n", 
©id
.
	`g‘_lo
());

795 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

798 
	`as£¹
 (
pxù
);

799 
smth»ad_t
::
	`me
()->
	`d‘ach_xù
(
pxù
);

800 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "D‘ached from (%d)\n", 
©id
.
	`g‘_lo
());

804 
ušt
 
šŒ©rx
 = 1;

805 
šRªge
 = 
	`g‘_»c_to_acûss
();

806 
Ëá
 = 
TM1_SUBS_PER_SF
 - (
š
.
_s_id
 % TM1_SUBS_PER_SF);

807 
veùÜ
<
ušt
> 
¿ngeVec
;

809 
¿ngeVec
.
	`push_back
(
¡d
::
	`mš
(
Ëá
,
šRªge
));

810 
šRªge
 -ğ
Ëá
;

812 
ušt
 
¡¬t
 = 
š
.
_s_id
 + 
Ëá
;

813 
ušt
 
¡•
 = 0;

815 (
šRªge
 > 0è&& (
¡¬t
<
TM1_SUBS_PER_SF
*
_sÿlšg_çùÜ
)) {

816 
¡•
 = 
¡d
::
	`mš
(
šRªge
,
TM1_SUBS_PER_SF
);

817 
¿ngeVec
.
	`push_back
(
¡•
);

818 
šŒ©rx
++;

819 
šRªge
 -ğ
TM1_SUBS_PER_SF
;

820 
¡¬t
 +ğ
¡•
;

824 
fš®_g¢_rvp
* 
ävp
 = 
	`Ãw_fš®_g¢_rvp
(
pxù
,
©id
,
xù_id
,
©¹
,
šŒ©rx
);

827 
veùÜ
<
ušt
>::
™”©Ü
 
v™
 = 
¿ngeVec
.
	`begš
(); v™ <„ªgeVec.
	`’d
(); vit++) {

828 
š
.
_¿nge
 = *
v™
;

829 
r_sub_g¢_aùiÚ
* 
r_sub
 = 
	`Ãw_r_sub_g¢_aùiÚ
(
pxù
,
©id
,
ävp
,
š
);

833 
œpIm¶
* 
my_sub_·¹
 = 
	`decide_·¹
(
	`sub
(),
š
.
_s_id
);

836 
	`CRITICAL_SECTION
(
sub_·¹_cs
, 
my_sub_·¹
->
_’queue_lock
);

837 ià(
my_sub_·¹
->
	`’queue
(
r_sub
,
bWake
)) {

838 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing R_SUB_GSN\n");

839 
	`as£¹
 (0);

840  (
	`RC
(
de_PROBLEM_ENQUEUE
));

846 
š
.
_s_id
 +ğ*
v™
;

853  (
RCOK
);

854 
	}
}

858 
boŞ
 
com·»_·œs
Ğ
·œ
<,
rid_t
> 
fœ¡
,…aœ<,rid_t> 
£cÚd
 )

860  (
	gfœ¡
.fœ¡ < 
	g£cÚd
.first);

863 
´št_·œ
(cÚ¡ 
·œ
<,
rid_t
>& 
aPaœ
)

865 
	gcout
 << 
	gaPaœ
.
	gfœ¡
 << " - " <<‡Paœ.
	g£cÚd
 << 
	g’dl
;

871 
w_rc_t
 
	gDÜaTM1Env
::
	$dÜa_g‘_sub_nbr
(cÚ¡ 
xù_id
,

872 
Œx_»suÉ_tu¶e_t
& 
©¹
,

873 
g‘_sub_nbr_šput_t
& 
š
,

874 cÚ¡ 
boŞ
 
bWake
)

876 if(
_¡¬t_imb®ªû
 > 0 && !
_bAÏrmS‘
) {

877 
	`CRITICAL_SECTION
(
®¬m_cs
, 
_®¬m_lock
);

878 if(!
_bAÏrmS‘
) {

879 
	`®¬m
(
_¡¬t_imb®ªû
);

880 
_bAÏrmS‘
 = 
Œue
;

885 
w_rc_t
 
e
 = 
RCOK
;

886 
tid_t
 
©id
;

887 
	`W_DO
(
_pssm
->
	`begš_xù
(
©id
));

888 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Begš (%d)\n", 
©id
.
	`g‘_lo
());

889 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

893 
š
.
_¿nge
 = 
	`g‘_»c_to_acûss
();

894 
li¡
< 
·œ
<,
rid_t
> > 
subsFound
;

895 
sid
;

896 
rid_t
 
rid
;

900 
bË_row_t
* 
´sub
 = 
_psub_mª
->
	`g‘_tu¶e
();

901 
	`as£¹
 (
´sub
);

903 
»p_row_t
 
	`¬•row
(
_psub_mª
->
	`ts
());

904 
¬•row
.
	`£t
(
_psub_desc
->
	`maxsize
());

905 
´sub
->
_»p
 = &
¬•row
;

907 
»p_row_t
 
	`low»p
(
_psub_mª
->
	`ts
());

908 
»p_row_t
 
	`high»p
(
_psub_mª
->
	`ts
());

909 
low»p
.
	`£t
(
_psub_desc
->
	`maxsize
());

910 
high»p
.
	`£t
(
_psub_desc
->
	`maxsize
());

912 
boŞ
 
eof
;

926 
gu¬d
<
šdex_sÿn_™”_im¶
<
subsüib”_t
> > 
sub_™”
;

928 
šdex_sÿn_™”_im¶
<
subsüib”_t
>* 
tmp_sub_™”
;

929 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

931 
©id
.
	`g‘_lo
(), 
š
.
_s_id
, in.
_¿nge
);

934 
e
 = 
_psub_mª
->
	`sub_g‘_idx_™”
(
_pssm
, 
tmp_sub_™”
, 
´sub
,

935 
low»p
,
high»p
,

936 
š
.
_s_id
, in.
_¿nge
,

937 
SH
, 
çl£
);

938 ià(
e
.
	`is_”rÜ
()è{ 
dÚe
; }

939 
sub_™”
 = 
tmp_sub_™”
;

943 
e
 = 
sub_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´sub
);

944 ià(
e
.
	`is_”rÜ
()è{ 
dÚe
; }

946 !
eof
) {

950 
´sub
->
	`g‘_v®ue
(0, 
sid
);

951 
rid
 = 
´sub
->
	`rid
();

952 
subsFound
.
	`push_back
Ğ
	`make_·œ
Ğ
sid
, 
rid
 ) );

954 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d GSN:„ead (%d)\n",

955 
©id
.
	`g‘_lo
(), 
sid
);

957 
e
 = 
sub_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´sub
);

958 ià(
e
.
	`is_”rÜ
()è{ 
dÚe
; }

962 
dÚe
:

964 
_psub_mª
->
	`give_tu¶e
(
´sub
);

965 ià(
e
.
	`is_”rÜ
()) {  (e); }

970 
	`as£¹
 (
pxù
);

971 
smth»ad_t
::
	`me
()->
	`d‘ach_xù
(
pxù
);

972 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "D‘ached from (%d)\n", 
©id
.
	`g‘_lo
());

977 ià(
subsFound
.
	`em±y
()) {

978 
	`TRACE
Ğ
TRACE_DEBUG
, "Index…robe didn't„eturn‡ny„ecord\n");

979  (
	`RC
(
£_NO_CURRENT_TUPLE
));

984 
subsFound
.
	`sÜt
(
com·»_·œs
);

989 
¡¬t
 = 
subsFound
.
	`äÚt
().
fœ¡
;

990 
ušt
 
šŒ©rx
 = 1;

991 
ÃxtBound
 = 
¡¬t
 + (
TM1_SUBS_PER_SF
 - (start % TM1_SUBS_PER_SF));

992 
š
.
_·œs
.
	`ş—r
();

994 
fš®_g¢_rvp
* 
ävp
 = 
	`Ãw_fš®_g¢_rvp
(
pxù
,
©id
,
xù_id
,
©¹
,
šŒ©rx
);

995 
veùÜ
<
r_sub_g¢_acc_aùiÚ
*> 
vecAùiÚs
;

997 
li¡
< 
	t·œ
<,
	trid_t
> >::
	t™”©Ü
 
	t·œ_™”©Ü
;

998 
·œ_™”©Ü
 
™
=
subsFound
.
	`begš
(); it!=subsFound.
	`’d
(); it++) {

999 
sid
 = (*
™
).
fœ¡
;

1000 
rid
 = (*
™
).
£cÚd
;

1004 iàĞ
sid
 >ğ
ÃxtBound
 ) {

1005 
ÃxtBound
 +ğ
TM1_SUBS_PER_SF
;

1006 
vecAùiÚs
.
	`push_back
Ğ
	`Ãw_r_sub_g¢_acc_aùiÚ
(
pxù
,
©id
,
ävp
,
š
) );

1007 
š
.
_·œs
.
	`ş—r
();

1008 ++
šŒ©rx
;

1011 
š
.
_·œs
.
	`push_back
Ğ
	`make_·œ
(
sid
, 
rid
) );

1015 ià(!
š
.
_·œs
.
	`em±y
()) {

1016 
vecAùiÚs
.
	`push_back
Ğ
	`Ãw_r_sub_g¢_acc_aùiÚ
(
pxù
,
©id
,
ävp
,
š
) );

1020 
ävp
->
	`»size
(
šŒ©rx
,intratrx);

1023 
veùÜ
<
	tr_sub_g¢_acc_aùiÚ
*>::
	t™”©Ü
 
	taùiÚ_™”©Ü
;

1024 
r_sub_g¢_acc_aùiÚ
* 
·
 = 
NULL
;

1025 
aùiÚ_™”©Ü
 
a™
=
vecAùiÚs
.
	`begš
();‡™!=vecAùiÚs.
	`’d
();‡it++) {

1026 
·
 = *
a™
;

1027 
sid
 = 
·
->
_š
.
_·œs
.
	`back
().
fœ¡
;

1031 
œpIm¶
* 
my_sub_·¹
 = 
	`decide_·¹
(
	`sub
(),
sid
);

1034 
	`CRITICAL_SECTION
(
sub_·¹_cs
, 
my_sub_·¹
->
_’queue_lock
);

1035 ià(
my_sub_·¹
->
	`’queue
(
·
,
bWake
)) {

1036 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing R_SUB_GSN\n");

1037 
	`as£¹
 (0);

1038  (
	`RC
(
de_PROBLEM_ENQUEUE
));

1043  (
e
);

1044 
	}
}

1047 
EXIT_NAMESPACE
(
dÜa
);

	@src/dora/tpcb/dora_tpcb.cpp

32 
	~"s.h
"

34 
	~"dÜa/cb/dÜa_cb.h
"

35 
	~"dÜa/cb/dÜa_cb_im¶.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
usšg
 
Çme¥aû
 
	gcb
;

41 
ENTER_NAMESPACE
(
dÜa
);

46 cÚ¡ 
ušt
 
	gbr_IRP_KEY
 = 1;

47 cÚ¡ 
ušt
 
	g‹_IRP_KEY
 = 1;

48 cÚ¡ 
ušt
 
	gac_IRP_KEY
 = 1;

49 cÚ¡ 
ušt
 
	ghi_IRP_KEY
 = 1;

52 cÚ¡ 
ušt
 
	gbr_KEY_EST
 = 100;

53 cÚ¡ 
ušt
 
	g‹_KEY_EST
 = 100;

54 cÚ¡ 
ušt
 
	gac_KEY_EST
 = 100;

55 cÚ¡ 
ušt
 
	ghi_KEY_EST
 = 100;

68 
	gDÜaTPCBEnv
::
	$DÜaTPCBEnv
()

69 : 
	$ShÜeTPCBEnv
()

71 
	`upd©e_pd
(
this
);

72 
	}
}

74 
	gDÜaTPCBEnv
::~
	$DÜaTPCBEnv
()

76 
	`¡İ
();

77 
	}
}

94 
	gDÜaTPCBEnv
::
	$¡¬t
()

100 
	`cÚf
();

101 
´oûssÜid_t
 
	`iıu
(
_¡¬tšg_ıu
);

104 
	`GENERATE_DORA_PARTS
(
br
,
b¿nch
);

107 
	`GENERATE_DORA_PARTS
(
‹
,
‹Î”
);

110 
	`GENERATE_DORA_PARTS
(
ac
,
accouÁ
);

113 
	`GENERATE_DORA_PARTS
(
hi
,
hi¡Üy
);

116 
DÜaEnv
::
	`_po¡_¡¬t
(
this
);

118 
	}
}

130 
w_rc_t
 
	gDÜaTPCBEnv
::
	$upd©e_·¹™iÚšg
()

135 
	`cÚf
();

138 
mšKeyV®
 = 0;

139 
maxKeyV®
 = 
	`g‘_sf
();

141 * 
mšKey
 = (*)
	`m®loc
(());

142 
	`mem£t
(
mšKey
,0,());

143 
	`memıy
(
mšKey
,&
mšKeyV®
,());

145 * 
maxKey
 = (*)
	`m®loc
(());

146 
	`mem£t
(
maxKey
,0,());

147 
	`memıy
(
maxKey
,&
maxKeyV®
,());

150 
_pb¿nch_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
_·¹s_br
);

154 
maxKeyV®
 = (
	`g‘_sf
()*
TPCB_TELLERS_PER_BRANCH
);

155 
	`mem£t
(
maxKey
,0,());

156 
	`memıy
(
maxKey
,&
maxKeyV®
,());

157 
_±–Ër_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
_·¹s_‹
);

160 
_phi¡Üy_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
_·¹s_hi
);

163 
maxKeyV®
 = (
	`g‘_sf
()*
TPCB_ACCOUNTS_PER_BRANCH
);

164 
	`mem£t
(
maxKey
,0,());

165 
	`memıy
(
maxKey
,&
maxKeyV®
,());

166 
_·ccouÁ_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
_·¹s_ac
);

168 
	`ä“
 (
mšKey
);

169 
	`ä“
 (
maxKey
);

171  (
RCOK
);

172 
	}
}

186 
	gDÜaTPCBEnv
::
	$¡İ
()

189  (
DÜaEnv
::
	`_po¡_¡İ
(
this
));

190 
	}
}

201 
	gDÜaTPCBEnv
::
	$»sume
()

203 
	`as£¹
 (0);

204 
	`£t_dbc
(
DBC_ACTIVE
);

206 
	}
}

218 
	gDÜaTPCBEnv
::
	$·u£
()

220 
	`as£¹
 (0);

221 
	`£t_dbc
(
DBC_PAUSED
);

223 
	}
}

235 
	gDÜaTPCBEnv
::
	$cÚf
()

237 
ShÜeTPCBEnv
::
	`cÚf
();

238 
	`_check_ty³
();

239 
’vV¬
* 
ev
 =ƒnvV¬::
	`š¡ªû
();

242 
_ıu_¿nge
 = 
	`g‘_aùive_ıu_couÁ
();

243 
_¡¬tšg_ıu
 = 
ev
->
	`g‘V¬IÁ
("dÜa-ıu-¡¬tšg",
DF_CPU_STEP_PARTITIONS
);

244 
_ıu_bË_¡•
 = 
ev
->
	`g‘V¬IÁ
("dÜa-ıu-bË-¡•",
DF_CPU_STEP_TABLES
);

255 
ušt
 
»cÜdE¡im©iÚ
 = 
	`g‘_sf
();

256 
br_P”CPU
 = 
ev
->
	`g‘V¬DoubË
("dora-ratio-tpcb-br",1);

257 
_·¹s_br
 = ( 
br_P”CPU
>0 ? 
	`û
(
_ıu_¿nge
 * br_PerCPU) : 1);

258 
_·¹s_br
 = 
¡d
::
	`mš
(
»cÜdE¡im©iÚ
,_parts_br);

261 
»cÜdE¡im©iÚ
 = 
	`g‘_sf
()*
TPCB_TELLERS_PER_BRANCH
;

262 
‹_P”CPU
 = 
ev
->
	`g‘V¬DoubË
("dora-ratio-tpcb-te",1);

263 
_·¹s_‹
 = ( 
‹_P”CPU
>0 ? 
	`û
(
_ıu_¿nge
 *e_PerCPU) : 1);

264 
_·¹s_‹
 = 
¡d
::
	`mš
(
»cÜdE¡im©iÚ
,_parts_te);

267 
»cÜdE¡im©iÚ
 = 
	`g‘_sf
()*
TPCB_ACCOUNTS_PER_BRANCH
;

268 
ac_P”CPU
 = 
ev
->
	`g‘V¬DoubË
("dora-ratio-tpcb-ac",1);

269 
_·¹s_ac
 = ( 
ac_P”CPU
>0 ? 
	`û
(
_ıu_¿nge
 *‡c_PerCPU) : 1);

270 
_·¹s_ac
 = 
¡d
::
	`mš
(
»cÜdE¡im©iÚ
,_parts_ac);

274 
»cÜdE¡im©iÚ
 = 
	`g‘_sf
()*
TPCB_TELLERS_PER_BRANCH
;

275 
hi_P”CPU
 = 
ev
->
	`g‘V¬DoubË
("dora-ratio-tpcb-hi",1);

276 
_·¹s_hi
 = ( 
hi_P”CPU
>0 ? 
	`û
(
_ıu_¿nge
 * hi_PerCPU) : 1);

278 
	`TRACE
Ğ
TRACE_STATISTICS
,"Total‚umber of…artitions (%d)\n",

279 (
_·¹s_br
+
_·¹s_‹
+
_·¹s_ac
+
_·¹s_hi
));

282 
	}
}

296 
w_rc_t
 
	gDÜaTPCBEnv
::
	$Ãwrun
()

298  (
DÜaEnv
::
	`_Ãwrun
(
this
));

299 
	}
}

310 
	gDÜaTPCBEnv
::
	$dump
()

312  (
DÜaEnv
::
	`_dump
(
this
));

313 
	}
}

324 
	gDÜaTPCBEnv
::
	$šfo
() const

326  (
DÜaEnv
::
	`_šfo
(
this
));

327 
	}
}

338 
	gDÜaTPCBEnv
::
	$¡©i¡ics
()

340 
DÜaEnv
::
	`_¡©i¡ics
(
this
);

344 
	`TRACE
Ğ
TRACE_STATISTICS
, "----- TPCB -----\n");

345 
ShÜeTPCBEnv
::
	`¡©i¡ics
();

347 
	}
}

363 
DEFINE_DORA_FINAL_RVP_GEN_FUNC
(
fš®_au_rvp
,
DÜaTPCBEnv
);

365 
DEFINE_DORA_ACTION_GEN_FUNC
(
upd_br_aùiÚ
,
rvp_t
,
acù_upd©e_šput_t
,,
DÜaTPCBEnv
);

366 
DEFINE_DORA_ACTION_GEN_FUNC
(
upd_‹_aùiÚ
,
rvp_t
,
acù_upd©e_šput_t
,,
DÜaTPCBEnv
);

367 
DEFINE_DORA_ACTION_GEN_FUNC
(
upd_ac_aùiÚ
,
rvp_t
,
acù_upd©e_šput_t
,,
DÜaTPCBEnv
);

368 
DEFINE_DORA_ACTION_GEN_FUNC
(
šs_hi_aùiÚ
,
rvp_t
,
acù_upd©e_šput_t
,,
DÜaTPCBEnv
);

372 
EXIT_NAMESPACE
(
dÜa
);

	@src/dora/tpcb/dora_tpcb_client.cpp

31 
	~"dÜa/cb/dÜa_cb_ş›Á.h
"

34 
ENTER_NAMESPACE
(
dÜa
);

38 cÚ¡ 
	gXCT_TPCB_DORA_ACCT_UPDATE
 = 331;

48 
	gdÜa_cb_ş›Á_t
::
	$lßd_sup_xù
(
m­SupTrxs
& 
¡m­
)

51 
¡m­
.
	`ş—r
();

54 
¡m­
[
XCT_TPCB_DORA_ACCT_UPDATE
] = "DORA-TPCB-AcctUpd";

55  (
¡m­
.
	`size
());

56 
	}
}

70 
w_rc_t
 
	gdÜa_cb_ş›Á_t
::
	$subm™_Úe
(
xù_ty³
, 
xùid
)

73 
boŞ
 
bWake
 = 
çl£
;

76 
£lid
 = 
_£lid
;

81 
Œx_»suÉ_tu¶e_t
 
©¹
;

82 ià(
cÚdex
* 
c
 = 
_ı
->
	`ke_Úe
()) {

83 
©¹
.
	`£t_nÙify
(
c
);

84 
bWake
 = 
Œue
;

87 
xù_ty³
) {

90 
XCT_TPCB_DORA_ACCT_UPDATE
:

91  (
_cbdb
->
	`dÜa_acù_upd©e
(
xùid
,
©¹
,
£lid
,
bWake
));

94 
	`as£¹
 (0);

96  (
RCOK
);

97 
	}
}

101 
EXIT_NAMESPACE
(
dÜa
);

	@src/dora/tpcb/dora_tpcb_impl.cpp

35 
	~"dÜa/cb/dÜa_cb_im¶.h
"

36 
	~"dÜa/cb/dÜa_cb.h
"

38 
usšg
 
Çme¥aû
 
	gshÜe
;

39 
usšg
 
Çme¥aû
 
	gcb
;

42 
ENTER_NAMESPACE
(
dÜa
);

51 
DEFINE_DORA_FINAL_RVP_CLASS
(
fš®_au_rvp
,
acù_upd©e
);

66 
	gupd_br_aùiÚ
::
	$ÿlc_keys
()

68 
_down
.
	`push_back
(
_š
.
b_id
);

69 
	}
}

72 
w_rc_t
 
	gupd_br_aùiÚ
::
	$Œx_exec
()

74 
	`as£¹
 (
_³nv
);

78 
tu¶e_gu¬d
<
b¿nch_mª_im¶
> 
	`´b
(
_³nv
->
	`b¿nch_mª
());

79 
»p_row_t
 
	`¬•row
(
_³nv
->
	`b¿nch_mª
()->
	`ts
());

80 
¬•row
.
	`£t
(
_³nv
->
	`b¿nch_desc
()->
	`maxsize
());

81 
´b
->
_»p
 = &
¬•row
;

92 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d UA:b-idx-Æ (%d)\n", 
_tid
.
	`g‘_lo
(), 
_š
.
b_id
);

93 
	`W_DO
(
_³nv
->
	`b¿nch_mª
()->
	`b_idx_Æ
(_³nv->
	`db
(), 
´b
, 
_š
.
b_id
));

95 
tÙ®
;

96 
´b
->
	`g‘_v®ue
(1, 
tÙ®
);

97 
´b
->
	`£t_v®ue
(1, 
tÙ®
 + 
_š
.
d–
);

100 
	`W_DO
(
_³nv
->
	`b¿nch_mª
()->
	`upd©e_tu¶e
(_³nv->
	`db
(), 
´b
, 
NL
));

102 #ifdeà
PRINT_TRX_RESULTS


104 
´b
->
	`´št_tu¶e
();

107  
RCOK
;

108 
	}
}

112 
	gupd_‹_aùiÚ
::
	$ÿlc_keys
()

114 
_down
.
	`push_back
(
_š
.
t_id
);

115 
	}
}

119 
w_rc_t
 
	gupd_‹_aùiÚ
::
	$Œx_exec
()

121 
	`as£¹
 (
_³nv
);

125 
tu¶e_gu¬d
<
‹Î”_mª_im¶
> 
	`´t
(
_³nv
->
	`‹Î”_mª
());

126 
»p_row_t
 
	`¬•row
(
_³nv
->
	`‹Î”_mª
()->
	`ts
());

127 
¬•row
.
	`£t
(
_³nv
->
	`‹Î”_desc
()->
	`maxsize
());

128 
´t
->
_»p
 = &
¬•row
;

138 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d UA:t-idx-Æ (%d)\n", 
_tid
.
	`g‘_lo
(), 
_š
.
t_id
);

139 
	`W_DO
(
_³nv
->
	`‹Î”_mª
()->
	`t_idx_Æ
(_³nv->
	`db
(), 
´t
, 
_š
.
t_id
));

141 
tÙ®
;

142 
´t
->
	`g‘_v®ue
(2, 
tÙ®
);

143 
´t
->
	`£t_v®ue
(2, 
tÙ®
 + 
_š
.
d–
);

146 
	`W_DO
(
_³nv
->
	`‹Î”_mª
()->
	`upd©e_tu¶e
(_³nv->
	`db
(), 
´t
, 
NL
));

148 #ifdeà
PRINT_TRX_RESULTS


150 
´t
->
	`´št_tu¶e
();

153  
RCOK
;

154 
	}
}

158 
	gupd_ac_aùiÚ
::
	$ÿlc_keys
()

160 
_down
.
	`push_back
(
_š
.
a_id
);

161 
	}
}

165 
w_rc_t
 
	gupd_ac_aùiÚ
::
	$Œx_exec
()

167 
	`as£¹
 (
_³nv
);

171 
tu¶e_gu¬d
<
accouÁ_mª_im¶
> 
	`´a
(
_³nv
->
	`accouÁ_mª
());

172 
»p_row_t
 
	`¬•row
(
_³nv
->
	`accouÁ_mª
()->
	`ts
());

173 
¬•row
.
	`£t
(
_³nv
->
	`accouÁ_desc
()->
	`maxsize
());

174 
´a
->
_»p
 = &
¬•row
;

184 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d UA:a-idx-Æ (%d)\n", 
_tid
.
	`g‘_lo
(), 
_š
.
a_id
);

185 
	`W_DO
(
_³nv
->
	`accouÁ_mª
()->
	`a_idx_Æ
(_³nv->
	`db
(), 
´a
, 
_š
.
a_id
));

187 
tÙ®
;

188 
´a
->
	`g‘_v®ue
(2, 
tÙ®
);

189 
´a
->
	`£t_v®ue
(2, 
tÙ®
 + 
_š
.
d–
);

192 
	`W_DO
(
_³nv
->
	`accouÁ_mª
()->
	`upd©e_tu¶e
(_³nv->
	`db
(), 
´a
, 
NL
));

194 #ifdeà
PRINT_TRX_RESULTS


196 
´a
->
	`´št_tu¶e
();

199  
RCOK
;

200 
	}
}

204 
	gšs_hi_aùiÚ
::
	$ÿlc_keys
()

206 
_down
.
	`push_back
(
_š
.
a_id
);

207 
	}
}

211 
w_rc_t
 
	gšs_hi_aùiÚ
::
	$Œx_exec
()

213 
	`as£¹
 (
_³nv
);

217 
tu¶e_gu¬d
<
hi¡Üy_mª_im¶
> 
	`´h
(
_³nv
->
	`hi¡Üy_mª
());

218 
»p_row_t
 
	`¬•row
(
_³nv
->
	`accouÁ_mª
()->
	`ts
());

219 
¬•row
.
	`£t
(
_³nv
->
	`accouÁ_desc
()->
	`maxsize
());

220 
´h
->
_»p
 = &
¬•row
;

227 
´h
->
	`£t_v®ue
(0, 
_š
.
b_id
);

228 
´h
->
	`£t_v®ue
(1, 
_š
.
t_id
);

229 
´h
->
	`£t_v®ue
(2, 
_š
.
a_id
);

230 
´h
->
	`£t_v®ue
(3, 
_š
.
d–
);

231 
´h
->
	`£t_v®ue
(4, 
	`time
(
NULL
));

232 #ifdeà
CFG_HACK


233 
´h
->
	`£t_v®ue
(5, "padding");

236 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d UA:šs-hi\n", 
_tid
.
	`g‘_lo
());

237 
	`W_DO
(
_³nv
->
	`hi¡Üy_mª
()->
	`add_tu¶e
(_³nv->
	`db
(), 
´h
, 
NL
));

239 #ifdeà
PRINT_TRX_RESULTS


241 
´h
->
	`´št_tu¶e
();

244  
RCOK
;

245 
	}
}

250 
EXIT_NAMESPACE
(
dÜa
);

	@src/dora/tpcb/dora_tpcb_xct.cpp

32 
	~"dÜa/cb/dÜa_cb_im¶.h
"

33 
	~"dÜa/cb/dÜa_cb.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
usšg
 
Çme¥aû
 
	gcb
;

39 
ENTER_NAMESPACE
(
dÜa
);

42 
	g·¹™iÚ_t
<> 
	tœpIm¶
;

81 
DEFINE_DORA_WITHOUT_INPUT_TRX_WRAPPER
(
DÜaTPCBEnv
,
acù_upd©e
);

93 
w_rc_t
 
	gDÜaTPCBEnv
::
	$dÜa_acù_upd©e
(cÚ¡ 
xù_id
,

94 
Œx_»suÉ_tu¶e_t
& 
©¹
,

95 
acù_upd©e_šput_t
& 
š
,

96 cÚ¡ 
boŞ
 
bWake
)

98 if(
_¡¬t_imb®ªû
 > 0 && !
_bAÏrmS‘
) {

99 
	`CRITICAL_SECTION
(
®¬m_cs
, 
_®¬m_lock
);

100 if(!
_bAÏrmS‘
) {

101 
	`®¬m
(
_¡¬t_imb®ªû
);

102 
_bAÏrmS‘
 = 
Œue
;

107 
tid_t
 
©id
;

109 
	`W_DO
(
_pssm
->
	`begš_xù
(
©id
));

110 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Begš (%d)\n", 
©id
.
	`g‘_lo
());

112 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

115 
	`as£¹
 (
pxù
);

116 
smth»ad_t
::
	`me
()->
	`d‘ach_xù
(
pxù
);

117 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "D‘ached from (%d)\n", 
©id
.
	`g‘_lo
());

120 
fš®_au_rvp
* 
ävp
 = 
	`Ãw_fš®_au_rvp
(
pxù
,
©id
,
xù_id
,
©¹
);

123 
upd_br_aùiÚ
* 
upd_br
 = 
	`Ãw_upd_br_aùiÚ
(
pxù
,
©id
,
ävp
,
š
);

124 
upd_‹_aùiÚ
* 
upd_‹
 = 
	`Ãw_upd_‹_aùiÚ
(
pxù
,
©id
,
ävp
,
š
);

125 
upd_ac_aùiÚ
* 
upd_ac
 = 
	`Ãw_upd_ac_aùiÚ
(
pxù
,
©id
,
ävp
,
š
);

126 
šs_hi_aùiÚ
* 
šs_hi
 = 
	`Ãw_šs_hi_aùiÚ
(
pxù
,
©id
,
ävp
,
š
);

132 
œpIm¶
* 
my_br_·¹
 = 
	`decide_·¹
(
	`br
(),
š
.
b_id
);

133 
	`as£¹
 (
my_br_·¹
);

136 
œpIm¶
* 
my_‹_·¹
 = 
	`decide_·¹
(
	`‹
(),
š
.
t_id
);

137 
	`as£¹
 (
my_‹_·¹
);

140 
œpIm¶
* 
my_ac_·¹
 = 
	`decide_·¹
(
	`ac
(),
š
.
a_id
);

141 
	`as£¹
 (
my_ac_·¹
);

144 
œpIm¶
* 
my_hi_·¹
 = 
	`decide_·¹
(
	`hi
(),
š
.
t_id
);

145 
	`as£¹
 (
my_hi_·¹
);

150 
	`CRITICAL_SECTION
(
br_·¹_cs
, 
my_br_·¹
->
_’queue_lock
);

151 ià(
my_br_·¹
->
	`’queue
(
upd_br
,
bWake
)) {

152 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing UPD_BR\n");

153 
	`as£¹
 (0);

154  (
	`RC
(
de_PROBLEM_ENQUEUE
));

158 
	`CRITICAL_SECTION
(
‹_·¹_cs
, 
my_‹_·¹
->
_’queue_lock
);

159 
br_·¹_cs
.
	`ex™
();

160 ià(
my_‹_·¹
->
	`’queue
(
upd_‹
,
bWake
)) {

161 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing UPD_TE\n");

162 
	`as£¹
 (0);

163  (
	`RC
(
de_PROBLEM_ENQUEUE
));

167 
	`CRITICAL_SECTION
(
ac_·¹_cs
, 
my_ac_·¹
->
_’queue_lock
);

168 
‹_·¹_cs
.
	`ex™
();

169 ià(
my_ac_·¹
->
	`’queue
(
upd_ac
,
bWake
)) {

170 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing UPD_AC\n");

171 
	`as£¹
 (0);

172  (
	`RC
(
de_PROBLEM_ENQUEUE
));

176 
	`CRITICAL_SECTION
(
hi_·¹_cs
, 
my_hi_·¹
->
_’queue_lock
);

177 
ac_·¹_cs
.
	`ex™
();

178 ià(
my_hi_·¹
->
	`’queue
(
šs_hi
,
bWake
)) {

179 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing INS_HI\n");

180 
	`as£¹
 (0);

181  (
	`RC
(
de_PROBLEM_ENQUEUE
));

185  (
RCOK
);

186 
	}
}

189 
EXIT_NAMESPACE
(
dÜa
);

	@src/dora/tpcc/dora_delivery.cpp

34 
	~"dÜa/cc/dÜa_d–iv”y.h
"

35 
	~"dÜa/cc/dÜa_cc.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
usšg
 
Çme¥aû
 
	gcc
;

41 
ENTER_NAMESPACE
(
dÜa
);

59 
w_rc_t
 
	gmid1_d–_rvp
::
	$_run
()

64 
mid2_d–_rvp
* 
rvp2
 = 
NULL
;

65 
	`as£¹
 (0);

67 
rvp2
->
	`po¡£t
(
_d_id
,
_fš®_rvp
);

70 
	`CHECK_MIDWAY_RVP_ABORTED
(
rvp2
);

73 
upd_Üd_d–_aùiÚ
* 
d–_upd_Üd
 = 
_±pcûnv
->
	`Ãw_upd_Üd_d–_aùiÚ
(
_xù
,
_tid
,
rvp2
,
_dš
);

74 
d–_upd_Üd
->
	`po¡£t
(
_d_id
,
_o_id
);

76 
upd_Şše_d–_aùiÚ
* 
d–_upd_Şše
 = 
_±pcûnv
->
	`Ãw_upd_Şše_d–_aùiÚ
(
_xù
,
_tid
,
rvp2
,
_dš
);

77 
d–_upd_Şše
->
	`po¡£t
(
_d_id
,
_o_id
);

79 
·¹™iÚ_t
<> 
	tœpIm¶
;

82 
wh
 = 
_dš
.
_wh_id
;

83 
œpIm¶
* 
my_Üd_·¹
 = 
_±pcûnv
->
	`decide_·¹
(_±pcûnv->
	`Üd
(),
wh
);

84 
œpIm¶
* 
my_Şše_·¹
 = 
_±pcûnv
->
	`decide_·¹
(_±pcûnv->
	`Şi
(),
wh
);

86 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Nexˆpha£ (%d-%d)\n", 
_tid
.
	`g‘_lo
(), 
_d_id
);

89 
	`CRITICAL_SECTION
(
Üd_·¹_cs
, 
my_Üd_·¹
->
_’queue_lock
);

90 ià(
my_Üd_·¹
->
	`’queue
(
d–_upd_Üd
,
_bWake
)) {

91 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing DEL_UPD_ORD\n");

92 
	`as£¹
 (0);

93  (
	`RC
(
de_PROBLEM_ENQUEUE
));

97 
	`CRITICAL_SECTION
(
Ş_·¹_cs
, 
my_Şše_·¹
->
_’queue_lock
);

98 
Üd_·¹_cs
.
	`ex™
();

99 ià(
my_Şše_·¹
->
	`’queue
(
d–_upd_Şše
,
_bWake
)) {

100 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing DEL_UPD_OL\n");

101 
	`as£¹
 (0);

102  (
	`RC
(
de_PROBLEM_ENQUEUE
));

106  (
RCOK
);

107 
	}
}

127 
w_rc_t
 
	gmid2_d–_rvp
::
	$_run
()

131 
	`as£¹
 (
_fš®_rvp
);

132 
_fš®_rvp
->
	`­³nd_aùiÚs
(
_aùiÚs
);

135 
	`CHECK_MIDWAY_RVP_ABORTED
(
_fš®_rvp
);

138 
upd_cu¡_d–_aùiÚ
* 
d–_upd_cu¡
 = 
_±pcûnv
->
	`Ãw_upd_cu¡_d–_aùiÚ
(
_xù
,
_tid
,
_fš®_rvp
,
_dš
);

139 
d–_upd_cu¡
->
	`po¡£t
(
_d_id
,
_c_id
,
_amouÁ
);

141 
·¹™iÚ_t
<> 
	tœpIm¶
;

144 
wh
 = 
_dš
.
_wh_id
;

145 
œpIm¶
* 
my_cu¡_·¹
 = 
_±pcûnv
->
	`decide_·¹
(_±pcûnv->
	`cus
(),
wh
);

147 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Nexˆpha£ (%d-%d)\n", 
_tid
.
	`g‘_lo
(), 
_d_id
);

149 #w¬nšg 
IP
: 
N“d
 
to
 
move
 
CUST
 
befÜe
 
NÜd
, 
Ord
, 
ªd
 
Ol
 
š
 
D–iv”y
Ø
avoid
 
d—dlock
 
w™h
 
NewOrd”


152 
	`CRITICAL_SECTION
(
cu¡_·¹_cs
, 
my_cu¡_·¹
->
_’queue_lock
);

153 ià(
my_cu¡_·¹
->
	`’queue
(
d–_upd_cu¡
,
_bWake
)) {

154 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing DEL_UPD_CUST\n");

155 
	`as£¹
 (0);

156  (
	`RC
(
de_PROBLEM_ENQUEUE
));

160  (
RCOK
);

161 
	}
}

172 
w_rc_t
 
	gfš®_d–_rvp
::
	$run
()

174  (
	`_run
());

175 
	}
}

177 
	gfš®_d–_rvp
::
	$upd_comm™‹d_¡©s
()

179 
_±pcûnv
->
	`_šc_d–iv”y_©t
();

180 
	}
}

182 
	gfš®_d–_rvp
::
	$upd_abÜ‹d_¡©s
()

184 
_±pcûnv
->
	`_šc_d–iv”y_çed
();

185 
	}
}

200 
w_rc_t
 
	gd–_nÜd_d–_aùiÚ
::
	$Œx_exec
()

202 
	`as£¹
 (
_±pcûnv
);

205 
tu¶e_gu¬d
<
Ãw_Üd”_mª_im¶
> 
	`´no
(
_±pcûnv
->
	`Ãw_Üd”_mª
());

207 
»p_row_t
 
	`¬•row
(
_±pcûnv
->
	`Ãw_Üd”_mª
()->
	`ts
());

208 
¬•row
.
	`£t
(
_±pcûnv
->
	`Ãw_Üd”_desc
()->
	`maxsize
());

209 
´no
->
_»p
 = &
¬•row
;

211 
»p_row_t
 
	`low»p
(
_±pcûnv
->
	`Ãw_Üd”_mª
()->
	`ts
());

212 
»p_row_t
 
	`high»p
(
_±pcûnv
->
	`Ãw_Üd”_mª
()->
	`ts
());

216 
low»p
.
	`£t
(
_±pcûnv
->
	`Ãw_Üd”_desc
()->
	`maxsize
());

217 
high»p
.
	`£t
(
_±pcûnv
->
	`Ãw_Üd”_desc
()->
	`maxsize
());

227 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DEL:nord-iter-by-idx-nl (%d) (%d)\n",

228 
_tid
.
	`g‘_lo
(), 
_dš
.
_wh_id
, 
_d_id
);

230 
gu¬d
<
šdex_sÿn_™”_im¶
<
Ãw_Üd”_t
> > 
no_™”
;

232 
šdex_sÿn_™”_im¶
<
Ãw_Üd”_t
>* 
tmp_no_™”
;

233 
	`W_DO
(
_±pcûnv
->
	`Ãw_Üd”_mª
()->
	`no_g‘_™”_by_šdex_Æ
(_±pcûnv->
	`db
(),

234 
tmp_no_™”
,

235 
´no
,

236 
low»p
, 
high»p
,

237 
_dš
.
_wh_id
,

238 
_d_id
));

239 
no_™”
 = 
tmp_no_™”
;

242 
boŞ
 
eof
;

245 
	`W_DO
(
no_™”
->
	`Ãxt
(
_±pcûnv
->
	`db
(), 
eof
, *
´no
));

247 ià(
eof
è{  
RCOK
; }

249 
no_o_id
;

250 
´no
->
	`g‘_v®ue
(0, 
no_o_id
);

251 
	`as£¹
 (
no_o_id
);

252 
_pmid1_rvp
->
	`£t_o_id
(
no_o_id
);

261 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DEL:nord-delete-by-index-nl (%d) (%d) (%d)\n",

262 
_tid
.
	`g‘_lo
(), 
_dš
.
_wh_id
, 
_d_id
, 
no_o_id
);

263 
	`W_DO
(
_±pcûnv
->
	`Ãw_Üd”_mª
()->
	`no_d–‘e_by_šdex_Æ
(_±pcûnv->
	`db
(), 
´no
,

264 
_dš
.
_wh_id
, 
_d_id
,

265 
no_o_id
));

267 #ifdeà
PRINT_TRX_RESULTS


270 
´no
->
	`´št_tu¶e
();

273  
RCOK
;

274 
	}
}

278 
w_rc_t
 
	gupd_Üd_d–_aùiÚ
::
	$Œx_exec
()

280 
	`as£¹
 (
_±pcûnv
);

283 
tu¶e_gu¬d
<
Üd”_mª_im¶
> 
	`´Üd
(
_±pcûnv
->
	`Üd”_mª
());

285 
»p_row_t
 
	`¬•row
(
_±pcûnv
->
	`Üd”_mª
()->
	`ts
());

286 
¬•row
.
	`£t
(
_±pcûnv
->
	`Üd”_desc
()->
	`maxsize
());

287 
´Üd
->
_»p
 = &
¬•row
;

289 ià(
_o_id
<0è{  
RCOK
; }

301 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DEL:ord-idx-probe-upd (%d) (%d) (%d)\n",

302 
_tid
.
	`g‘_lo
(), 
_dš
.
_wh_id
, 
_d_id
, 
_o_id
);

303 
´Üd
->
	`£t_v®ue
(0, 
_o_id
);

304 
´Üd
->
	`£t_v®ue
(2, 
_d_id
);

305 
´Üd
->
	`£t_v®ue
(3, 
_dš
.
_wh_id
);

306 
	`W_DO
(
_±pcûnv
->
	`Üd”_mª
()->
	`Üd_upd©e_ÿ¼›r_by_šdex_Æ
(_±pcûnv->
	`db
(),

307 
´Üd
,

308 
_dš
.
_ÿ¼›r_id
));

310 
c_id
;

311 
´Üd
->
	`g‘_v®ue
(1, 
c_id
);

312 
_pmid2_rvp
->
	`£t_c_id
(
c_id
);

314 #ifdeà
PRINT_TRX_RESULTS


317 
´Üd
->
	`´št_tu¶e
();

320  
RCOK
;

321 
	}
}

325 
w_rc_t
 
	gupd_Şše_d–_aùiÚ
::
	$Œx_exec
()

327 
	`as£¹
 (
_±pcûnv
);

330 
tu¶e_gu¬d
<
Üd”_lše_mª_im¶
> 
	`´Ş
(
_±pcûnv
->
	`Üd”_lše_mª
());

332 
»p_row_t
 
	`¬•row
(
_±pcûnv
->
	`Üd”_lše_mª
()->
	`ts
());

333 
¬•row
.
	`£t
(
_±pcûnv
->
	`Üd”_lše_desc
()->
	`maxsize
());

334 
´Ş
->
_»p
 = &
¬•row
;

336 
»p_row_t
 
	`low»p
(
_±pcûnv
->
	`Üd”_lše_mª
()->
	`ts
());

337 
»p_row_t
 
	`high»p
(
_±pcûnv
->
	`Üd”_lše_mª
()->
	`ts
());

341 
low»p
.
	`£t
(
_±pcûnv
->
	`Üd”_lše_desc
()->
	`maxsize
());

342 
high»p
.
	`£t
(
_±pcûnv
->
	`Üd”_lše_desc
()->
	`maxsize
());

344 
time_t
 
ts_¡¬t
 = 
	`time
(
NULL
);

346 ià(
_o_id
<0è{  
RCOK
; }

358 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DEL:ol-iter-probe-by-idx-nl (%d) (%d) (%d)\n",

359 
_tid
.
	`g‘_lo
(), 
_dš
.
_wh_id
, 
_d_id
, 
_o_id
);

361 
tÙ®_amouÁ
 = 0;

363 
gu¬d
<
šdex_sÿn_™”_im¶
<
Üd”_lše_t
> > 
Ş_™”
;

365 
šdex_sÿn_™”_im¶
<
Üd”_lše_t
>* 
tmp_Ş_™”
;

366 
	`W_DO
(
_±pcûnv
->
	`Üd”_lše_mª
()->

367 
	`Ş_g‘_´obe_™”_by_šdex_Æ
(
_±pcûnv
->
	`db
(), 
tmp_Ş_™”
, 
´Ş
,

368 
low»p
, 
high»p
, 
_dš
.
_wh_id
, 
_d_id
,

369 
_o_id
));

370 
Ş_™”
 = 
tmp_Ş_™”
;

374 
boŞ
 
eof
;

375 
	`W_DO
(
Ş_™”
->
	`Ãxt
(
_±pcûnv
->
	`db
(), 
eof
, *
´Ş
));

376 !
eof
) {

378 
cu¼’t_amouÁ
;

379 
´Ş
->
	`g‘_v®ue
(8, 
cu¼’t_amouÁ
);

380 
tÙ®_amouÁ
 +ğ
cu¼’t_amouÁ
;

383 
´Ş
->
	`£t_v®ue
(6, 
ts_¡¬t
);

384 
	`W_DO
(
_±pcûnv
->
	`Üd”_lše_mª
()->
	`upd©e_tu¶e
(_±pcûnv->
	`db
(),

385 
´Ş
, 
NL
));

388 
	`W_DO
(
Ş_™”
->
	`Ãxt
(
_±pcûnv
->
	`db
(), 
eof
, *
´Ş
));

391 
_pmid2_rvp
->
	`add_amouÁ
(
tÙ®_amouÁ
);

393 #ifdeà
PRINT_TRX_RESULTS


396 
´Ş
->
	`´št_tu¶e
();

399  
RCOK
;

400 
	}
}

405 
w_rc_t
 
	gupd_cu¡_d–_aùiÚ
::
	$Œx_exec
()

407 
	`as£¹
 (
_±pcûnv
);

410 
tu¶e_gu¬d
<
cu¡om”_mª_im¶
> 
	`´cu¡
(
_±pcûnv
->
	`cu¡om”_mª
());

412 
»p_row_t
 
	`¬•row
(
_±pcûnv
->
	`cu¡om”_mª
()->
	`ts
());

413 
¬•row
.
	`£t
(
_±pcûnv
->
	`cu¡om”_desc
()->
	`maxsize
());

414 
´cu¡
->
_»p
 = &
¬•row
;

416 ià(
_c_id
<0è{  
RCOK
; }

426 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DEL:cust-idx-probe-upd-nl (%d) (%d) (%d)\n",

427 
_tid
.
	`g‘_lo
(), 
_dš
.
_wh_id
, 
_d_id
, 
_c_id
);

428 
	`W_DO
(
_±pcûnv
->
	`cu¡om”_mª
()->
	`cu¡_šdex_´obe_Æ
(_±pcûnv->
	`db
(), 
´cu¡
,

429 
_dš
.
_wh_id
, 
_d_id
,

430 
_c_id
));

431 
b®ªû
;

432 
´cu¡
->
	`g‘_v®ue
(16, 
b®ªû
);

433 
´cu¡
->
	`£t_v®ue
(16, 
b®ªû
+
_amouÁ
);

434 
	`W_DO
(
_±pcûnv
->
	`cu¡om”_mª
()->
	`upd©e_tu¶e
(_±pcûnv->
	`db
(), 
´cu¡
, 
NL
));

436 #ifdeà
PRINT_TRX_RESULTS


439 
´cu¡
->
	`´št_tu¶e
();

442  
RCOK
;

443 
	}
}

447 
EXIT_NAMESPACE
(
dÜa
);

	@src/dora/tpcc/dora_mbench.cpp

34 
	~"dÜa/cc/dÜa_mb’ch.h
"

35 
	~"dÜa/cc/dÜa_cc.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
usšg
 
Çme¥aû
 
	gcc
;

41 
ENTER_NAMESPACE
(
dÜa
);

50 
DEFINE_DORA_FINAL_RVP_CLASS
(
fš®_mb_rvp
,
mb’ch_wh
);

62 
	gupd_wh_mb_aùiÚ
::
	$ÿlc_keys
()

64 
_down
.
	`push_back
(
_š
.
_wh_id
);

65 
	}
}

68 
w_rc_t
 
	gupd_wh_mb_aùiÚ
::
	$Œx_exec
()

70 
	`as£¹
 (
_³nv
);

76 
tu¶e_gu¬d
<
w¬ehou£_mª_im¶
> 
	`´wh
(
_³nv
->
	`w¬ehou£_mª
());

77 
»p_row_t
 
	`¬•row
(
_³nv
->
	`w¬ehou£_mª
()->
	`ts
());

78 
¬•row
.
	`£t
(
_³nv
->
	`w¬ehou£_desc
()->
	`maxsize
());

79 
´wh
->
_»p
 = &
¬•row
;

82 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

83 "Aµ: %d PAY:wh-idx-Æ (%d)\n", 
_tid
.
	`g‘_lo
(), 
_š
.
_wh_id
);

84 
	`W_DO
(
_³nv
->
	`w¬ehou£_mª
()->
	`wh_šdex_´obe_Æ
(_³nv->
	`db
(), 
´wh
,

85 
_š
.
_wh_id
));

96 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d PAY:wh-update-ytd-nl (%d)\n",

97 
_tid
.
	`g‘_lo
(), 
_š
.
_wh_id
);

98 
	`W_DO
(
_³nv
->
	`w¬ehou£_mª
()->
	`wh_upd©e_ytd_Æ
(_³nv->
	`db
(), 
´wh
,

99 
_š
.
_amouÁ
));

100 
cc_w¬ehou£_tu¶e
 
awh
;

101 
´wh
->
	`g‘_v®ue
(1, 
awh
.
W_NAME
, 11);

102 
´wh
->
	`g‘_v®ue
(2, 
awh
.
W_STREET_1
, 21);

103 
´wh
->
	`g‘_v®ue
(3, 
awh
.
W_STREET_2
, 21);

104 
´wh
->
	`g‘_v®ue
(4, 
awh
.
W_CITY
, 21);

105 
´wh
->
	`g‘_v®ue
(5, 
awh
.
W_STATE
, 3);

106 
´wh
->
	`g‘_v®ue
(6, 
awh
.
W_ZIP
, 10);

108 #ifdeà
PRINT_TRX_RESULTS


111 
´wh
->
	`´št_tu¶e
();

114  
RCOK
;

115 
	}
}

126 
	gupd_cu¡_mb_aùiÚ
::
	$ÿlc_keys
()

128 
_down
.
	`push_back
(
_š
.
_wh_id
);

129 
_down
.
	`push_back
(
_š
.
_d_id
);

130 
_down
.
	`push_back
(
_š
.
_c_id
);

131 
	}
}

134 
w_rc_t
 
	gupd_cu¡_mb_aùiÚ
::
	$Œx_exec
()

136 
	`as£¹
 (
_³nv
);

141 
tu¶e_gu¬d
<
cu¡om”_mª_im¶
> 
	`´cu¡
(
_³nv
->
	`cu¡om”_mª
());

142 
»p_row_t
 
	`¬•row
(
_³nv
->
	`cu¡om”_mª
()->
	`ts
());

143 
¬•row
.
	`£t
(
_³nv
->
	`cu¡om”_desc
()->
	`maxsize
());

144 
´cu¡
->
_»p
 = &
¬•row
;

157 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

159 
_tid
.
	`g‘_lo
(), 
_š
.
_wh_id
, _š.
_d_id
, _š.
_c_id
);

160 
	`W_DO
(
_³nv
->
	`cu¡om”_mª
()->
	`cu¡_šdex_´obe_Æ
(_³nv->
	`db
(), 
´cu¡
,

161 
_š
.
_wh_id
, _š.
_d_id
,

162 
_š
.
_c_id
));

165 
cc_cu¡om”_tu¶e
 
acu¡
;

166 
´cu¡
->
	`g‘_v®ue
(3, 
acu¡
.
C_FIRST
, 17);

167 
´cu¡
->
	`g‘_v®ue
(4, 
acu¡
.
C_MIDDLE
, 3);

168 
´cu¡
->
	`g‘_v®ue
(5, 
acu¡
.
C_LAST
, 17);

169 
´cu¡
->
	`g‘_v®ue
(6, 
acu¡
.
C_STREET_1
, 21);

170 
´cu¡
->
	`g‘_v®ue
(7, 
acu¡
.
C_STREET_2
, 21);

171 
´cu¡
->
	`g‘_v®ue
(8, 
acu¡
.
C_CITY
, 21);

172 
´cu¡
->
	`g‘_v®ue
(9, 
acu¡
.
C_STATE
, 3);

173 
´cu¡
->
	`g‘_v®ue
(10, 
acu¡
.
C_ZIP
, 10);

174 
´cu¡
->
	`g‘_v®ue
(11, 
acu¡
.
C_PHONE
, 17);

175 
´cu¡
->
	`g‘_v®ue
(12, 
acu¡
.
C_SINCE
);

176 
´cu¡
->
	`g‘_v®ue
(13, 
acu¡
.
C_CREDIT
, 3);

177 
´cu¡
->
	`g‘_v®ue
(14, 
acu¡
.
C_CREDIT_LIM
);

178 
´cu¡
->
	`g‘_v®ue
(15, 
acu¡
.
C_DISCOUNT
);

179 
´cu¡
->
	`g‘_v®ue
(16, 
acu¡
.
C_BALANCE
);

180 
´cu¡
->
	`g‘_v®ue
(17, 
acu¡
.
C_YTD_PAYMENT
);

181 
´cu¡
->
	`g‘_v®ue
(18, 
acu¡
.
C_LAST_PAYMENT
);

182 
´cu¡
->
	`g‘_v®ue
(19, 
acu¡
.
C_PAYMENT_CNT
);

183 
´cu¡
->
	`g‘_v®ue
(20, 
acu¡
.
C_DATA_1
, 251);

184 
´cu¡
->
	`g‘_v®ue
(21, 
acu¡
.
C_DATA_2
, 251);

187 
acu¡
.
C_BALANCE
 -ğ
_š
.
_amouÁ
;

188 
acu¡
.
C_YTD_PAYMENT
 +ğ
_š
.
_amouÁ
;

189 
acu¡
.
C_PAYMENT_CNT
++;

192 ià((
acu¡
.
C_CREDIT
[0] == 'B') && (acust.C_CREDIT[1] == 'C')) {

204 
c_Ãw_d©a_1
[251];

205 
c_Ãw_d©a_2
[251];

206 
	`¥rštf
(
c_Ãw_d©a_1
, "%d,%d,%d,%d,%d,%1.2f", 
_š
.
_c_id
, _š.
_d_id
,

207 
_š
.
_wh_id
, _š.
_d_id
, _š._wh_id, _š.
_amouÁ
);

208 
Ën
 = 
	`¡¾’
(
c_Ãw_d©a_1
);

209 
	`¡ºÿt
(
c_Ãw_d©a_1
, 
acu¡
.
C_DATA_1
, 250-
Ën
);

210 
	`¡ºıy
(
c_Ãw_d©a_2
, &
acu¡
.
C_DATA_1
[250-
Ën
],†en);

211 
	`¡ºıy
(
c_Ãw_d©a_2
, 
acu¡
.
C_DATA_2
, 250-
Ën
);

213 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d PAY:bad-cust-update-tuple-nl\n",

214 
_tid
.
	`g‘_lo
());

215 
	`W_DO
(
_³nv
->
	`cu¡om”_mª
()->
	`cu¡_upd©e_tu¶e_Æ
(_³nv->
	`db
(), 
´cu¡
,

216 
acu¡
, 
c_Ãw_d©a_1
,

217 
c_Ãw_d©a_2
));

219 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d PAY:good-cust-update-tuple-nl\n",

220 
_tid
.
	`g‘_lo
());

221 
	`W_DO
(
_³nv
->
	`cu¡om”_mª
()->
	`cu¡_upd©e_tu¶e_Æ
(_³nv->
	`db
(), 
´cu¡
,

222 
acu¡
, 
NULL
, NULL));

225 #ifdeà
PRINT_TRX_RESULTS


228 
´cu¡
->
	`´št_tu¶e
();

231  
RCOK
;

232 
	}
}

235 
EXIT_NAMESPACE
(
dÜa
);

	@src/dora/tpcc/dora_new_order.cpp

34 
	~"dÜa/cc/dÜa_Ãw_Üd”.h
"

36 
usšg
 
Çme¥aû
 
	gdÜa
;

37 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
usšg
 
Çme¥aû
 
	gcc
;

41 
ENTER_NAMESPACE
(
dÜa
);

53 
DEFINE_DORA_FINAL_RVP_CLASS
(
fš®_nÜd_rvp
,
Ãw_Üd”
);

63 
w_rc_t
 
	gmid1_nÜd_rvp
::
	$_run
()

69 
whid
 = 
_š
.
_wh_id
;

72 
mid2_nÜd_rvp
* 
mid2_rvp
 = 
_³nv
->
	`Ãw_mid2_nÜd_rvp
(
_xù
,
_tid
,
_xù_id
,
_»suÉ
,
_š
,
_aùiÚs
,
_bWake
);

75 
	`CHECK_MIDWAY_RVP_ABORTED
(
mid2_rvp
);

78 
	`as£¹
 (
_š
.
_d_Ãxt_o_id
!=-1);

81 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Nexˆpha£ (%d)\n", 
_tid
.
	`g‘_lo
());

82 
·¹™iÚ_t
<> 
	tœpIm¶
;

91 
no_™em_nÜd_šput_t
 
ªo™š
;

92 
_š
.
	`g‘_no_™em_šput
(
ªo™š
);

95 
šs_nÜd_nÜd_aùiÚ
* 
šs_nÜd_nÜd
 = 
_³nv
->
	`Ãw_šs_nÜd_nÜd_aùiÚ
(
_xù
,
_tid
,
mid2_rvp
,
ªo™š
);

96 
œpIm¶
* 
my_nÜd_·¹
 = 
_³nv
->
	`decide_·¹
(_³nv->
	`nÜ
(),
whid
);

100 
šs_Üd_nÜd_aùiÚ
* 
šs_Üd_nÜd
 = 
_³nv
->
	`Ãw_šs_Üd_nÜd_aùiÚ
(
_xù
,
_tid
,
mid2_rvp
,
ªo™š
);

101 
œpIm¶
* 
my_Üd_·¹
 = 
_³nv
->
	`decide_·¹
(_³nv->
	`Üd
(),
whid
);

107 
	`CRITICAL_SECTION
(
nÜd_·¹_cs
, 
my_nÜd_·¹
->
_’queue_lock
);

108 ià(
my_nÜd_·¹
->
	`’queue
(
šs_nÜd_nÜd
,
_bWake
))

110 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing INS_NORD_NORD\n");

111 
	`as£¹
 (0);

112  (
	`RC
(
de_PROBLEM_ENQUEUE
));

116 
	`CRITICAL_SECTION
(
Üd_·¹_cs
, 
my_Üd_·¹
->
_’queue_lock
);

117 
nÜd_·¹_cs
.
	`ex™
();

118 ià(
my_Üd_·¹
->
	`’queue
(
šs_Üd_nÜd
,
_bWake
))

120 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing INS_ORD_NORD\n");

121 
	`as£¹
 (0);

122  (
	`RC
(
de_PROBLEM_ENQUEUE
));

127  (
RCOK
);

128 
	}
}

138 
w_rc_t
 
	gmid2_nÜd_rvp
::
	$_run
()

140 
whid
 = 
_š
.
_wh_id
;

143 
mid3_nÜd_rvp
* 
mid3_rvp
 = 
_³nv
->
	`Ãw_mid3_nÜd_rvp
(
_xù
,
_tid
,
_xù_id
,
_»suÉ
,
_š
,
_aùiÚs
,
_bWake
);

146 
	`CHECK_MIDWAY_RVP_ABORTED
(
mid3_rvp
);

149 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Nexˆpha£ (%d)\n", 
_tid
.
	`g‘_lo
());

150 
·¹™iÚ_t
<> 
	tœpIm¶
;

158 
šs_Ş_nÜd_aùiÚ
* 
šs_Ş_nÜd
 = 
_³nv
->
	`Ãw_šs_Ş_nÜd_aùiÚ
(
_xù
,
_tid
,
mid3_rvp
,
_š
);

159 
œpIm¶
* 
my_Ş_·¹
 = 
_³nv
->
	`decide_·¹
(_³nv->
	`Şi
(),
whid
);

163 
	`CRITICAL_SECTION
(
Şi_·¹_cs
, 
my_Ş_·¹
->
_’queue_lock
);

164 ià(
my_Ş_·¹
->
	`’queue
(
šs_Ş_nÜd
,
_bWake
)) {

165 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing INS_OL_NORD\n");

166 
	`as£¹
 (0);

167  (
	`RC
(
de_PROBLEM_ENQUEUE
));

171  (
RCOK
);

172 
	}
}

183 
w_rc_t
 
	gmid3_nÜd_rvp
::
	$_run
()

185 
whid
 = 
_š
.
_wh_id
;

188 
fš®_nÜd_rvp
* 
ävp
 = 
_³nv
->
	`Ãw_fš®_nÜd_rvp
(
_xù
,
_tid
,
_xù_id
,
_»suÉ
,
_aùiÚs
);

191 
	`CHECK_MIDWAY_RVP_ABORTED
(
ävp
);

194 
	`as£¹
 (
_š
.
_d_Ãxt_o_id
!=-1);

197 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Nexˆpha£ (%d)\n", 
_tid
.
	`g‘_lo
());

198 
·¹™iÚ_t
<> 
	tœpIm¶
;

206 
upd_¡o_nÜd_aùiÚ
* 
upd_¡o_nÜd
 = 
_³nv
->
	`Ãw_upd_¡o_nÜd_aùiÚ
(
_xù
,
_tid
,
ävp
,
_š
);

207 
œpIm¶
* 
my_¡o_·¹
 = 
_³nv
->
	`decide_·¹
(_³nv->
	`¡o
(),
whid
);

211 
	`CRITICAL_SECTION
(
¡o_·¹_cs
, 
my_¡o_·¹
->
_’queue_lock
);

213 ià(
my_¡o_·¹
->
	`’queue
(
upd_¡o_nÜd
,
_bWake
)) {

214 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing UPD_STO_NORD\n");

215 
	`as£¹
 (0);

216  (
	`RC
(
de_PROBLEM_ENQUEUE
));

220  (
RCOK
);

221 
	}
}

252 
	gr_wh_nÜd_aùiÚ
::
	$ÿlc_keys
()

254 
	`£t_»ad_Úly
();

255 
_down
.
	`push_back
(
_š
.
_wh_id
);

256 
	}
}

259 
w_rc_t
 
	gr_wh_nÜd_aùiÚ
::
	$Œx_exec
()

261 
	`as£¹
 (
_³nv
);

264 
tu¶e_gu¬d
<
w¬ehou£_mª_im¶
> 
	`´wh
(
_³nv
->
	`w¬ehou£_mª
());

266 
»p_row_t
 
	`¬•row
(
_³nv
->
	`w¬ehou£_mª
()->
	`ts
());

267 
¬•row
.
	`£t
(
_³nv
->
	`w¬ehou£_desc
()->
	`maxsize
());

268 
´wh
->
_»p
 = &
¬•row
;

278 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d NO:wh-idx-nl (%d)\n",

279 
_tid
.
	`g‘_lo
(), 
_š
.
_wh_id
);

280 
	`W_DO
(
_³nv
->
	`w¬ehou£_mª
()->
	`wh_šdex_´obe_Æ
(_³nv->
	`db
(), 
´wh
,

281 
_š
.
_wh_id
));

282 
´wh
->
	`g‘_v®ue
(7, 
_´vp
->
_š
.
_awh
.
W_TAX
);

284 #ifdeà
PRINT_TRX_RESULTS


287 
´wh
->
	`´št_tu¶e
();

290  
RCOK
;

291 
	}
}

297 
	gr_cu¡_nÜd_aùiÚ
::
	$ÿlc_keys
()

299 
	`£t_»ad_Úly
();

300 
_down
.
	`push_back
(
_š
.
_wh_id
);

301 
_down
.
	`push_back
(
_š
.
_d_id
);

302 
	}
}

305 
w_rc_t
 
	gr_cu¡_nÜd_aùiÚ
::
	$Œx_exec
()

307 
	`as£¹
 (
_³nv
);

310 
tu¶e_gu¬d
<
cu¡om”_mª_im¶
> 
	`´cu¡
(
_³nv
->
	`cu¡om”_mª
());

312 
»p_row_t
 
	`¬•row
(
_³nv
->
	`cu¡om”_mª
()->
	`ts
());

313 
¬•row
.
	`£t
(
_³nv
->
	`cu¡om”_desc
()->
	`maxsize
());

314 
´cu¡
->
_»p
 = &
¬•row
;

324 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d NO:cust-idx-nl (%d) (%d) (%d)\n",

325 
_tid
.
	`g‘_lo
(), 
_š
.
_wh_id
, _š.
_d_id
, _š.
_c_id
);

326 
	`W_DO
(
_³nv
->
	`cu¡om”_mª
()->
	`cu¡_šdex_´obe_Æ
(_³nv->
	`db
(), 
´cu¡
,

327 
_š
.
_wh_id
, _š.
_d_id
,

328 
_š
.
_c_id
));

329 
´cu¡
->
	`g‘_v®ue
(15, 
_´vp
->
_š
.
_acu¡
.
C_DISCOUNT
);

330 
´cu¡
->
	`g‘_v®ue
(13, 
_´vp
->
_š
.
_acu¡
.
C_CREDIT
, 3);

331 
´cu¡
->
	`g‘_v®ue
(5, 
_´vp
->
_š
.
_acu¡
.
C_LAST
, 17);

333 #ifdeà
PRINT_TRX_RESULTS


336 
´cu¡
->
	`´št_tu¶e
();

339  
RCOK
;

340 
	}
}

347 
	gupd_di¡_nÜd_aùiÚ
::
	$ÿlc_keys
()

349 
_down
.
	`push_back
(
_š
.
_wh_id
);

350 
_down
.
	`push_back
(
_š
.
_d_id
);

351 
	}
}

353 
w_rc_t
 
	gupd_di¡_nÜd_aùiÚ
::
	$Œx_exec
()

355 
	`as£¹
 (
_³nv
);

358 
tu¶e_gu¬d
<
di¡riù_mª_im¶
> 
	`´di¡
(
_³nv
->
	`di¡riù_mª
());

360 
»p_row_t
 
	`¬•row
(
_³nv
->
	`di¡riù_mª
()->
	`ts
());

361 
¬•row
.
	`£t
(
_³nv
->
	`di¡riù_desc
()->
	`maxsize
());

362 
´di¡
->
_»p
 = &
¬•row
;

372 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d NO:dist-idx-nl (%d) (%d)\n",

373 
_tid
.
	`g‘_lo
(), 
_š
.
_wh_id
, _š.
_d_id
);

374 
	`W_DO
(
_³nv
->
	`di¡riù_mª
()->
	`di¡_šdex_´obe_Æ
(_³nv->
	`db
(), 
´di¡
,

375 
_š
.
_wh_id
, _š.
_d_id
));

376 
´di¡
->
	`g‘_v®ue
(8, 
_´vp
->
_š
.
_adi¡
.
D_TAX
);

377 
´di¡
->
	`g‘_v®ue
(10, 
_´vp
->
_š
.
_adi¡
.
D_NEXT_O_ID
);

378 
_´vp
->
_š
.
_adi¡
.
D_NEXT_O_ID
++;

386 cÚ¡ 
Ãxt_o_id
 = 
_´vp
->
_š
.
_adi¡
.
D_NEXT_O_ID
;

387 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d NO:dist-upd-next-o-id-nl (%d)\n",

388 
_tid
.
	`g‘_lo
(), 
Ãxt_o_id
);

389 
	`W_DO
(
_³nv
->
	`di¡riù_mª
()->
	`di¡_upd©e_Ãxt_o_id_Æ
(_³nv->
	`db
(), 
´di¡
,

390 
Ãxt_o_id
));

393 
_´vp
->
_š
.
_d_Ãxt_o_id
 = 
Ãxt_o_id
;

395 #ifdeà
PRINT_TRX_RESULTS


398 
´di¡
->
	`´št_tu¶e
();

401  
RCOK
;

402 
	}
}

408 
	gr_™em_nÜd_aùiÚ
::
	$ÿlc_keys
()

411 
	`£t_»ad_Úly
();

412 
_down
.
	`push_back
(
_š
.
_wh_id
);

413 
	}
}

415 
w_rc_t
 
	gr_™em_nÜd_aùiÚ
::
	$Œx_exec
()

417 
	`as£¹
 (
_³nv
);

420 
tu¶e_gu¬d
<
™em_mª_im¶
> 
	`´™em
(
_³nv
->
	`™em_mª
());

422 
»p_row_t
 
	`¬•row
(
_³nv
->
	`™em_mª
()->
	`ts
());

423 
¬•row
.
	`£t
(
_³nv
->
	`™em_desc
()->
	`maxsize
());

424 
´™em
->
_»p
 = &
¬•row
;

427 
idx
=0;

429 
	`TRACE
(
TRACE_TRX_FLOW
, "Aµ: %d NO:r-™em (%d)\n", 
_tid
.
	`g‘_lo
(), 
_š
.
_Ş_út
);

432 
idx
=0; idx<
_š
.
_Ş_út
; idx++) {

434 
Ş_i_id
 = 
_š
.
™ems
[
idx
].
_Ş_i_id
;

435 
Ş_suµly_w_id
 = 
_š
.
™ems
[
idx
].
_Ş_suµly_wh_id
;

436 
	`as£¹
 (
_š
.
_wh_id
==
Ş_suµly_w_id
);

444 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d NO:item-idx-nl-%d (%d)\n",

445 
_tid
.
	`g‘_lo
(), 
idx
, 
Ş_i_id
);

446 
	`W_DO
(
_³nv
->
	`™em_mª
()->
	`™_šdex_´obe_Æ
(_³nv->
	`db
(), 
´™em
, 
Ş_i_id
));

449 
´™em
->
	`g‘_v®ue
(4, 
_š
.
™ems
[
idx
].
_a™em
.
I_DATA
, 51);

450 
´™em
->
	`g‘_v®ue
(3, 
_š
.
™ems
[
idx
].
_a™em
.
I_PRICE
);

451 
´™em
->
	`g‘_v®ue
(2, 
_š
.
™ems
[
idx
].
_a™em
.
I_NAME
, 25);

452 
_š
.
™ems
[
idx
].
_™em_amouÁ
 = _š.™ems[idx].
_a™em
.
I_PRICE
 *

453 
_š
.
™ems
[
idx
].
_Ş_quªt™y
;

456 
_´vp
->
_š
.
™ems
[
idx
].
_™em_amouÁ
 = _in.items[idx]._item_amount;

459 #ifdeà
PRINT_TRX_RESULTS


462 
´™em
->
	`´št_tu¶e
();

465  
RCOK
;

466 
	}
}

485 
	gšs_Üd_nÜd_aùiÚ
::
	$ÿlc_keys
()

487 
_down
.
	`push_back
(
_š
.
_wh_id
);

488 
_down
.
	`push_back
(
_š
.
_d_id
);

489 
	}
}

491 
w_rc_t
 
	gšs_Üd_nÜd_aùiÚ
::
	$Œx_exec
()

493 
	`as£¹
 (
_³nv
);

496 
tu¶e_gu¬d
<
Üd”_mª_im¶
> 
	`´Üd
(
_³nv
->
	`Üd”_mª
());

498 
»p_row_t
 
	`¬•row
(
_³nv
->
	`Üd”_mª
()->
	`ts
());

499 
¬•row
.
	`£t
(
_³nv
->
	`Üd”_desc
()->
	`maxsize
());

500 
´Üd
->
_»p
 = &
¬•row
;

502 
»p_row_t
 
	`¬•row_key
(
_³nv
->
	`Üd”_mª
()->
	`ts
());

503 
¬•row_key
.
	`£t
(
_³nv
->
	`Üd”_desc
()->
	`maxsize
());

504 
´Üd
->
_»p_key
 = &
¬•row_key
;

511 
´Üd
->
	`£t_v®ue
(0, 
_š
.
_d_Ãxt_o_id
);

512 
´Üd
->
	`£t_v®ue
(1, 
_š
.
_c_id
);

513 
´Üd
->
	`£t_v®ue
(2, 
_š
.
_d_id
);

514 
´Üd
->
	`£t_v®ue
(3, 
_š
.
_wh_id
);

515 
´Üd
->
	`£t_v®ue
(4, 
_š
.
_t¡amp
);

516 
´Üd
->
	`£t_v®ue
(5, 0);

517 
´Üd
->
	`£t_v®ue
(6, 
_š
.
_Ş_út
);

518 
´Üd
->
	`£t_v®ue
(7, 
_š
.
_®l_loÿl
);

520 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d NO:ord-add-tuple-nl (%d)\n",

521 
_tid
.
	`g‘_lo
(), 
_š
.
_d_Ãxt_o_id
);

522 
	`W_DO
(
_³nv
->
	`Üd”_mª
()->
	`add_tu¶e
(_³nv->
	`db
(), 
´Üd
, 
NL
));

524 #ifdeà
PRINT_TRX_RESULTS


527 
´Üd
->
	`´št_tu¶e
();

530  
RCOK
;

531 
	}
}

538 
	gšs_nÜd_nÜd_aùiÚ
::
	$ÿlc_keys
()

540 
_down
.
	`push_back
(
_š
.
_wh_id
);

541 
_down
.
	`push_back
(
_š
.
_d_id
);

542 
	}
}

544 
w_rc_t
 
	gšs_nÜd_nÜd_aùiÚ
::
	$Œx_exec
()

546 
	`as£¹
 (
_³nv
);

549 
tu¶e_gu¬d
<
Ãw_Üd”_mª_im¶
> 
	`´no
(
_³nv
->
	`Ãw_Üd”_mª
());

551 
»p_row_t
 
	`¬•row
(
_³nv
->
	`Ãw_Üd”_mª
()->
	`ts
());

552 
¬•row
.
	`£t
(
_³nv
->
	`Ãw_Üd”_desc
()->
	`maxsize
());

553 
´no
->
_»p
 = &
¬•row
;

555 
»p_row_t
 
	`¬•row_key
(
_³nv
->
	`Ãw_Üd”_mª
()->
	`ts
());

556 
¬•row_key
.
	`£t
(
_³nv
->
	`Ãw_Üd”_desc
()->
	`maxsize
());

557 
´no
->
_»p_key
 = &
¬•row_key
;

563 
´no
->
	`£t_v®ue
(0, 
_š
.
_d_Ãxt_o_id
);

564 
´no
->
	`£t_v®ue
(1, 
_š
.
_d_id
);

565 
´no
->
	`£t_v®ue
(2, 
_š
.
_wh_id
);

567 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d NO:nord-add-tuple (%d) (%d) (%d)\n",

568 
_tid
.
	`g‘_lo
(), 
_š
.
_wh_id
, _š.
_d_id
, _š.
_d_Ãxt_o_id
);

569 
	`W_DO
(
_³nv
->
	`Ãw_Üd”_mª
()->
	`add_tu¶e
(_³nv->
	`db
(), 
´no
, 
NL
));

571 #ifdeà
PRINT_TRX_RESULTS


574 
´no
->
	`´št_tu¶e
();

577  
RCOK
;

578 
	}
}

595 
	gšs_Ş_nÜd_aùiÚ
::
	$ÿlc_keys
()

597 
_down
.
	`push_back
(
_š
.
_wh_id
);

598 
_down
.
	`push_back
(
_š
.
_d_id
);

599 
	}
}

602 
w_rc_t
 
	gšs_Ş_nÜd_aùiÚ
::
	$Œx_exec
()

604 
	`as£¹
 (
_³nv
);

607 
tu¶e_gu¬d
<
Üd”_lše_mª_im¶
> 
	`´Ş
(
_³nv
->
	`Üd”_lše_mª
());

609 
»p_row_t
 
	`¬•row
(
_³nv
->
	`Üd”_lše_mª
()->
	`ts
());

610 
¬•row
.
	`£t
(
_³nv
->
	`Üd”_lše_desc
()->
	`maxsize
());

611 
´Ş
->
_»p
 = &
¬•row
;

613 
»p_row_t
 
	`¬•row_key
(
_³nv
->
	`Üd”_lše_mª
()->
	`ts
());

614 
¬•row_key
.
	`£t
(
_³nv
->
	`Üd”_lše_desc
()->
	`maxsize
());

615 
´Ş
->
_»p_key
 = &
¬•row_key
;

618 
idx
 = 0;

620 
	`TRACE
(
TRACE_TRX_FLOW
, "Aµ: %d NO:šs-Ş (%d)\n", 
_tid
.
	`g‘_lo
(), 
_š
.
_Ş_út
);

622 
idx
=0; idx<
_š
.
_Ş_út
; idx++) {

628 
´Ş
->
	`£t_v®ue
(0, 
_š
.
_d_Ãxt_o_id
);

629 
´Ş
->
	`£t_v®ue
(1, 
_š
.
_d_id
);

630 
´Ş
->
	`£t_v®ue
(2, 
_š
.
_wh_id
);

631 
´Ş
->
	`£t_v®ue
(3, 
idx
+1);

632 
´Ş
->
	`£t_v®ue
(4, 
_š
.
™ems
[
idx
].
_Ş_i_id
);

633 
´Ş
->
	`£t_v®ue
(5, 
_š
.
™ems
[
idx
].
_Ş_suµly_wh_id
);

634 
´Ş
->
	`£t_v®ue
(6, 
_š
.
_t¡amp
);

635 
´Ş
->
	`£t_v®ue
(7, 
_š
.
™ems
[
idx
].
_Ş_quªt™y
);

636 
´Ş
->
	`£t_v®ue
(8, 
_š
.
™ems
[
idx
].
_™em_amouÁ
);

637 
´Ş
->
	`£t_v®ue
(9, 
_š
.
™ems
[
idx
].
_a¡ock
.
S_DIST
[_š.
_d_id
]);

639 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d NO:ol-add-tuple-%d (%d) (%d) (%d) (%d)\n",

640 
_tid
.
	`g‘_lo
(), 
idx
, 
_š
.
_wh_id
, _š.
_d_id
, _š.
_d_Ãxt_o_id
,

641 
_š
.
™ems
[
idx
].
_Ş_i_id
);

642 
	`W_DO
(
_³nv
->
	`Üd”_lše_mª
()->
	`add_tu¶e
(_³nv->
	`db
(), 
´Ş
, 
NL
));

645 #ifdeà
PRINT_TRX_RESULTS


648 
´Ş
->
	`´št_tu¶e
();

651  
RCOK
;

652 
	}
}

668 
	gupd_¡o_nÜd_aùiÚ
::
	$ÿlc_keys
()

671 
_down
.
	`push_back
(
_š
.
_wh_id
);

672 
	}
}

674 
w_rc_t
 
	gupd_¡o_nÜd_aùiÚ
::
	$Œx_exec
()

676 
	`as£¹
 (
_³nv
);

679 
tu¶e_gu¬d
<
¡ock_mª_im¶
> 
	`´¡
(
_³nv
->
	`¡ock_mª
());

681 
»p_row_t
 
	`¬•row
(
_³nv
->
	`¡ock_mª
()->
	`ts
());

682 
¬•row
.
	`£t
(
_³nv
->
	`¡ock_desc
()->
	`maxsize
());

683 
´¡
->
_»p
 = &
¬•row
;

685 
idx
=0;

686 
Ş_i_id
=0;

687 
Ş_suµly_w_id
=0;

689 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d NO:upd-stock (%d)\n",

690 
_tid
.
	`g‘_lo
(), 
_š
.
_Ş_út
);

693 
idx
=0; idx<
_š
.
_Ş_út
; idx++) {

696 
Ş_i_id
 = 
_š
.
™ems
[
idx
].
_Ş_i_id
;

697 
Ş_suµly_w_id
 = 
_š
.
™ems
[
idx
].
_Ş_suµly_wh_id
;

706 
cc_¡ock_tu¶e
* 
p¡ock
 = &
_š
.
™ems
[
idx
].
_a¡ock
;

707 
cc_™em_tu¶e
* 
p™em
 = &
_š
.
™ems
[
idx
].
_a™em
;

708 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d NO:stock-idx-nl-%d (%d) (%d)\n",

709 
_tid
.
	`g‘_lo
(), 
idx
, 
Ş_suµly_w_id
, 
Ş_i_id
);

710 
	`W_DO
(
_³nv
->
	`¡ock_mª
()->
	`¡_šdex_´obe_Æ
(_³nv->
	`db
(), 
´¡
,

711 
Ş_suµly_w_id
, 
Ş_i_id
));

713 
´¡
->
	`g‘_v®ue
(0, 
p¡ock
->
S_I_ID
);

714 
´¡
->
	`g‘_v®ue
(1, 
p¡ock
->
S_W_ID
);

715 
´¡
->
	`g‘_v®ue
(5, 
p¡ock
->
S_YTD
);

716 
p¡ock
->
S_YTD
 +ğ
_š
.
™ems
[
idx
].
_Ş_quªt™y
;

717 
´¡
->
	`g‘_v®ue
(2, 
p¡ock
->
S_REMOTE_CNT
);

718 
´¡
->
	`g‘_v®ue
(3, 
p¡ock
->
S_QUANTITY
);

719 
p¡ock
->
S_QUANTITY
 -ğ
_š
.
™ems
[
idx
].
_Ş_quªt™y
;

720 ià(
p¡ock
->
S_QUANTITY
 < 10) {

721 
p¡ock
->
S_QUANTITY
 += 91;

723 
´¡
->
	`g‘_v®ue
(6+
_š
.
_d_id
, 
p¡ock
->
S_DIST
[_in._d_id], 25);

724 
´¡
->
	`g‘_v®ue
(16, 
p¡ock
->
S_DATA
, 51);

725 
c_s_b¿nd_g’”ic
;

726 ià(
	`¡r¡r
(
p™em
->
I_DATA
, "ORIGINAL"è!ğ
NULL
 &&

727 
	`¡r¡r
(
p¡ock
->
S_DATA
, "ORIGINAL"è!ğ
NULL
) {

728 
c_s_b¿nd_g’”ic
 = 'B';

730 
c_s_b¿nd_g’”ic
 = 'G';

732 
´¡
->
	`g‘_v®ue
(4, 
p¡ock
->
S_ORDER_CNT
);

733 
p¡ock
->
S_ORDER_CNT
++;

735 ià(
_š
.
_wh_id
 !ğ_š.
™ems
[
idx
].
_Ş_suµly_wh_id
) {

736 
p¡ock
->
S_REMOTE_CNT
++;

738 
	`as£¹
 (0);

746 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d NO:stock-upd-tuple-nl-%d (%d) (%d)\n",

747 
_tid
.
	`g‘_lo
(), 
idx
, 
p¡ock
->
S_W_ID
,…¡ock->
S_I_ID
);

748 
	`W_DO
(
_³nv
->
	`¡ock_mª
()->
	`¡_upd©e_tu¶e_Æ
(_³nv->
	`db
(), 
´¡
, 
p¡ock
));

754 #ifdeà
PRINT_TRX_RESULTS


757 
´¡
->
	`´št_tu¶e
();

760  
RCOK
;

761 
	}
}

767 
EXIT_NAMESPACE
(
dÜa
);

	@src/dora/tpcc/dora_order_status.cpp

34 
	~"dÜa/cc/dÜa_Üd”_¡©us.h
"

35 
	~"dÜa/cc/dÜa_cc.h
"

37 
usšg
 
Çme¥aû
 
	gdÜa
;

38 
usšg
 
Çme¥aû
 
	gshÜe
;

39 
usšg
 
Çme¥aû
 
	gcc
;

42 
ENTER_NAMESPACE
(
dÜa
);

56 
DEFINE_DORA_FINAL_RVP_CLASS
(
fš®_Üd¡_rvp
,
Üd”_¡©us
);

67 
w_rc_t
 
	gmid1_Üd¡_rvp
::
	$_run
()

70 
mid2_Üd¡_rvp
* 
mid2_rvp
 = 
_³nv
->
	`Ãw_mid2_Üd¡_rvp
(
_xù
,
_tid
,
_xù_id
,
_»suÉ
,
_š
,
_aùiÚs
,
_bWake
);

73 
	`CHECK_MIDWAY_RVP_ABORTED
(
mid2_rvp
);

76 
r_Üd_Üd¡_aùiÚ
* 
r_Üd
 = 
_³nv
->
	`Ãw_r_Üd_Üd¡_aùiÚ
(
_xù
,
_tid
,
mid2_rvp
,
_š
);

78 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Nexˆpha£ (%d)\n", 
_tid
.
	`g‘_lo
());

79 
·¹™iÚ_t
<> 
	tœpIm¶
;

85 
wh
 = 
_š
.
_wh_id
;

86 
œpIm¶
* 
my_Üd_·¹
 = 
_³nv
->
	`decide_·¹
(_³nv->
	`Üd
(),
wh
);

89 
	`CRITICAL_SECTION
(
Üd_·¹_cs
, 
my_Üd_·¹
->
_’queue_lock
);

90 ià(
my_Üd_·¹
->
	`’queue
(
r_Üd
,
_bWake
)) {

91 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing ORDST_R_ORD\n");

92 
	`as£¹
 (0);

93  (
	`RC
(
de_PROBLEM_ENQUEUE
));

96  (
RCOK
);

97 
	}
}

109 
w_rc_t
 
	gmid2_Üd¡_rvp
::
	$_run
()

112 
fš®_Üd¡_rvp
* 
ävp
 = 
_³nv
->
	`Ãw_fš®_Üd¡_rvp
(
_xù
,
_tid
,
_xù_id
,
_»suÉ
,
_aùiÚs
);

115 
	`CHECK_MIDWAY_RVP_ABORTED
(
ävp
);

118 
r_Ş_Üd¡_aùiÚ
* 
r_Ş
 = 
_³nv
->
	`Ãw_r_Ş_Üd¡_aùiÚ
(
_xù
,
_tid
,
ävp
,
_š
);

120 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Nexˆpha£ (%d)\n", 
_tid
.
	`g‘_lo
());

121 
·¹™iÚ_t
<> 
	tœpIm¶
;

127 
wh
 = 
_š
.
_wh_id
 ;

128 
œpIm¶
* 
my_Şi_·¹
 = 
_³nv
->
	`decide_·¹
(_³nv->
	`Şi
(),
wh
);

131 
	`CRITICAL_SECTION
(
Şi_·¹_cs
, 
my_Şi_·¹
->
_’queue_lock
);

132 ià(
my_Şi_·¹
->
	`’queue
(
r_Ş
,
_bWake
)) {

133 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing ORDST_R_OL\n");

134 
	`as£¹
 (0);

135  (
	`RC
(
de_PROBLEM_ENQUEUE
));

138  (
RCOK
);

139 
	}
}

154 
	gr_cu¡_Üd¡_aùiÚ
::
	$ÿlc_keys
()

156 
	`£t_»ad_Úly
();

157 
_down
.
	`push_back
(
_š
.
_wh_id
);

158 
_down
.
	`push_back
(
_š
.
_d_id
);

159 
	}
}

161 
w_rc_t
 
	gr_cu¡_Üd¡_aùiÚ
::
	$Œx_exec
()

163 
	`as£¹
 (
_³nv
);

166 
tu¶e_gu¬d
<
cu¡om”_mª_im¶
> 
	`´cu¡
(
_³nv
->
	`cu¡om”_mª
());

168 
»p_row_t
 
	`¬•row
(
_³nv
->
	`cu¡om”_mª
()->
	`ts
());

169 
¬•row
.
	`£t
(
_³nv
->
	`cu¡om”_desc
()->
	`maxsize
());

170 
´cu¡
->
_»p
 = &
¬•row
;

172 
»p_row_t
 
	`low»p
(
_³nv
->
	`cu¡om”_mª
()->
	`ts
());

173 
»p_row_t
 
	`high»p
(
_³nv
->
	`cu¡om”_mª
()->
	`ts
());

174 
low»p
.
	`£t
(
_³nv
->
	`cu¡om”_desc
()->
	`maxsize
());

175 
high»p
.
	`£t
(
_³nv
->
	`cu¡om”_desc
()->
	`maxsize
());

177 
w_id
 = 
_š
.
_wh_id
;

178 
d_id
 = 
_š
.
_d_id
;

179 
c_id
 = 
_š
.
_c_id
;

185 ià(
_š
.
_c_id
 == 0) {

195 
	`as£¹
 (
_š
.
_c_£Ëù
 <= 60);

196 
	`as£¹
 (
_š
.
_c_Ï¡
);

198 
gu¬d
<
šdex_sÿn_™”_im¶
<
cu¡om”_t
> > 
c_™”
;

200 
šdex_sÿn_™”_im¶
<
cu¡om”_t
>* 
tmp_c_™”
;

201 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d ORDST:cust-iter-by-name-idx-nl\n",

202 
_tid
.
	`g‘_lo
());

203 
	`W_DO
(
_³nv
->
	`cu¡om”_mª
()->
	`cu¡_g‘_™”_by_šdex_Æ
(_³nv->
	`db
(),

204 
tmp_c_™”
,

205 
´cu¡
, 
low»p
,

206 
high»p
, 
w_id
,

207 
d_id
,

208 
_š
.
_c_Ï¡
));

209 
c_™”
 = 
tmp_c_™”
;

212 
veùÜ
<> 
v_c_id
;

213 
a_c_id
 = 0;

214 
couÁ
 = 0;

215 
boŞ
 
eof
;

217 
	`W_DO
(
c_™”
->
	`Ãxt
(
_³nv
->
	`db
(), 
eof
, *
´cu¡
));

218 !
eof
) {

220 ++
couÁ
;

221 
´cu¡
->
	`g‘_v®ue
(0, 
a_c_id
);

222 
v_c_id
.
	`push_back
(
a_c_id
);

224 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d ORDST:cust-iter-next\n",

225 
_tid
.
	`g‘_lo
());

226 
	`W_DO
(
c_™”
->
	`Ãxt
(
_³nv
->
	`db
(), 
eof
, *
´cu¡
));

228 
	`as£¹
 (
couÁ
);

231 
_š
.
_c_id
 = 
v_c_id
[(
couÁ
+1)/2-1];

232 
c_id
 = 
_š
.
_c_id
;

234 
	`as£¹
 (
_š
.
_c_id
>0);

245 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d ORDST:cust-idx-nl (%d) (%d) (%d)\n",

246 
_tid
.
	`g‘_lo
(), 
w_id
, 
d_id
, 
c_id
);

247 
	`W_DO
(
_³nv
->
	`cu¡om”_mª
()->
	`cu¡_šdex_´obe_Æ
(_³nv->
	`db
(), 
´cu¡
,

248 
w_id
, 
d_id
, 
c_id
));

250 
cc_cu¡om”_tu¶e
 
acu¡
;

251 
´cu¡
->
	`g‘_v®ue
(3, 
acu¡
.
C_FIRST
, 17);

252 
´cu¡
->
	`g‘_v®ue
(4, 
acu¡
.
C_MIDDLE
, 3);

253 
´cu¡
->
	`g‘_v®ue
(5, 
acu¡
.
C_LAST
, 17);

254 
´cu¡
->
	`g‘_v®ue
(16, 
acu¡
.
C_BALANCE
);

257 
_´vp
->
_š
.
_c_id
 = _in._c_id;

259 #ifdeà
PRINT_TRX_RESULTS


262 
´cu¡
->
	`´št_tu¶e
();

265  
RCOK
;

266 
	}
}

269 
	gr_Üd_Üd¡_aùiÚ
::
	$ÿlc_keys
()

271 
	`£t_»ad_Úly
();

272 
_down
.
	`push_back
(
_š
.
_wh_id
);

273 
_down
.
	`push_back
(
_š
.
_d_id
);

274 
	}
}

277 
w_rc_t
 
	gr_Üd_Üd¡_aùiÚ
::
	$Œx_exec
()

279 
	`as£¹
 (
_³nv
);

282 
tu¶e_gu¬d
<
Üd”_mª_im¶
> 
	`´Üd
(
_³nv
->
	`Üd”_mª
());

284 
»p_row_t
 
	`¬•row
(
_³nv
->
	`Üd”_mª
()->
	`ts
());

285 
¬•row
.
	`£t
(
_³nv
->
	`Üd”_desc
()->
	`maxsize
());

286 
´Üd
->
_»p
 = &
¬•row
;

288 
»p_row_t
 
	`low»p
(
_³nv
->
	`Üd”_mª
()->
	`ts
());

289 
»p_row_t
 
	`high»p
(
_³nv
->
	`Üd”_mª
()->
	`ts
());

290 
low»p
.
	`£t
(
_³nv
->
	`Üd”_desc
()->
	`maxsize
());

291 
high»p
.
	`£t
(
_³nv
->
	`Üd”_desc
()->
	`maxsize
());

293 
w_id
 = 
_š
.
_wh_id
;

294 
d_id
 = 
_š
.
_d_id
;

295 
c_id
 = 
_š
.
_c_id
;

307 
gu¬d
<
šdex_sÿn_™”_im¶
<
Üd”_t
> > 
o_™”
;

309 
šdex_sÿn_™”_im¶
<
Üd”_t
>* 
tmp_o_™”
;

310 
	`TRACE
(
TRACE_TRX_FLOW
,"Aµ: %d ORDST:Üd-™”-by-idx-Æ\n",
_tid
.
	`g‘_lo
());

311 
	`W_DO
(
_³nv
->
	`Üd”_mª
()->
	`Üd_g‘_™”_by_šdex_Æ
(_³nv->
	`db
(), 
tmp_o_™”
,

312 
´Üd
, 
low»p
, 
high»p
,

313 
w_id
, 
d_id
, 
c_id
));

314 
o_™”
 = 
tmp_o_™”
;

317 
cc_Üd”_tu¶e
 
aÜd”
;

318 
boŞ
 
eof
;

319 
ušt
 
út
 = 0;

321 
	`W_DO
(
o_™”
->
	`Ãxt
(
_³nv
->
	`db
(), 
eof
, *
´Üd
));

322 !
eof
) {

323 ++
út
;

324 
´Üd
->
	`g‘_v®ue
(0, 
aÜd”
.
O_ID
);

325 
´Üd
->
	`g‘_v®ue
(4, 
aÜd”
.
O_ENTRY_D
);

326 
´Üd
->
	`g‘_v®ue
(5, 
aÜd”
.
O_CARRIER_ID
);

327 
´Üd
->
	`g‘_v®ue
(6, 
aÜd”
.
O_OL_CNT
);

328 
	`W_DO
(
o_™”
->
	`Ãxt
(
_³nv
->
	`db
(), 
eof
, *
´Üd
));

330 
	`as£¹
 (
út
);

333 
	`as£¹
 (
aÜd”
.
O_ID
);

334 
	`as£¹
 (
aÜd”
.
O_OL_CNT
);

336 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d ORDST: (%d) (%d)\n",

337 
_tid
.
	`g‘_lo
(), 
aÜd”
.
O_ID
,‡Üd”.
O_OL_CNT
);

340 
_´vp
->
_š
.
_o_id
 = 
aÜd”
.
O_ID
;

341 
_´vp
->
_š
.
_o_Ş_út
 = 
aÜd”
.
O_OL_CNT
;

343 #ifdeà
PRINT_TRX_RESULTS


346 
´Üd
->
	`´št_tu¶e
();

349  
RCOK
;

350 
	}
}

353 
	gr_Ş_Üd¡_aùiÚ
::
	$ÿlc_keys
()

355 
	`£t_»ad_Úly
();

356 
_down
.
	`push_back
(
_š
.
_wh_id
);

357 
_down
.
	`push_back
(
_š
.
_d_id
);

358 
	}
}

360 
w_rc_t
 
	gr_Ş_Üd¡_aùiÚ
::
	$Œx_exec
()

362 
	`as£¹
 (
_³nv
);

365 
tu¶e_gu¬d
<
Üd”_lše_mª_im¶
> 
	`´Ş
(
_³nv
->
	`Üd”_lše_mª
());

367 
»p_row_t
 
	`¬•row
(
_³nv
->
	`Üd”_lše_mª
()->
	`ts
());

368 
¬•row
.
	`£t
(
_³nv
->
	`Üd”_lše_desc
()->
	`maxsize
());

369 
´Ş
->
_»p
 = &
¬•row
;

371 
»p_row_t
 
	`low»p
(
_³nv
->
	`Üd”_lše_mª
()->
	`ts
());

372 
»p_row_t
 
	`high»p
(
_³nv
->
	`Üd”_lše_mª
()->
	`ts
());

374 
cc_Üd”lše_tu¶e
* 
pÜd”lšes
 = 
NULL
;

376 
w_id
 = 
_š
.
_wh_id
;

377 
d_id
 = 
_š
.
_d_id
;

378 
o_id
 = 
_š
.
_o_id
;

389 
gu¬d
<
šdex_sÿn_™”_im¶
<
Üd”_lše_t
> > 
Ş_™”
;

391 
šdex_sÿn_™”_im¶
<
Üd”_lše_t
>* 
tmp_Ş_™”
;

392 
	`TRACE
(
TRACE_TRX_FLOW
, "Aµ: %d ORDST:Ş-™”-by-idx-Æ\n", 
_tid
.
	`g‘_lo
());

393 
	`W_DO
(
_³nv
->
	`Üd”_lše_mª
()->
	`Ş_g‘_´obe_™”_by_šdex_Æ
(_³nv->
	`db
(),

394 
tmp_Ş_™”
,

395 
´Ş
, 
low»p
,

396 
high»p
, 
w_id
,

397 
d_id
, 
o_id
));

398 
Ş_™”
 = 
tmp_Ş_™”
;

401 
pÜd”lšes
 = 
Ãw
 
cc_Üd”lše_tu¶e
[
_š
.
_o_Ş_út
];

402 
i
=0;

403 
boŞ
 
eof
;

405 
	`W_DO
(
Ş_™”
->
	`Ãxt
(
_³nv
->
	`db
(), 
eof
, *
´Ş
));

406 !
eof
) {

407 
´Ş
->
	`g‘_v®ue
(4, 
pÜd”lšes
[
i
].
OL_I_ID
);

408 
´Ş
->
	`g‘_v®ue
(5, 
pÜd”lšes
[
i
].
OL_SUPPLY_W_ID
);

409 
´Ş
->
	`g‘_v®ue
(6, 
pÜd”lšes
[
i
].
OL_DELIVERY_D
);

410 
´Ş
->
	`g‘_v®ue
(7, 
pÜd”lšes
[
i
].
OL_QUANTITY
);

411 
´Ş
->
	`g‘_v®ue
(8, 
pÜd”lšes
[
i
].
OL_AMOUNT
);

413 #ifdeà
PRINT_TRX_RESULTS


414 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d ORDST: (%d) %d - %d - %d - %d\n",

415 
_tid
.
	`g‘_lo
(),

416 
i
, 
pÜd”lšes
[i].
OL_I_ID
,…Üd”lšes[i].
OL_SUPPLY_W_ID
,

417 
pÜd”lšes
[
i
].
OL_QUANTITY
,…Üd”lšes[i].
OL_AMOUNT
);

420 
i
++;

421 
	`W_DO
(
Ş_™”
->
	`Ãxt
(
_³nv
->
	`db
(), 
eof
, *
´Ş
));

423 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d ORDST: found (%d)\n", 
_tid
.
	`g‘_lo
(), 
i
);

425 #ifdeà
PRINT_TRX_RESULTS


428 
´Ş
->
	`´št_tu¶e
();

431 ià(
pÜd”lšes
è
d–‘e
 []…orderlines;

432  
RCOK
;

433 
	}
}

436 
EXIT_NAMESPACE
(
dÜa
);

	@src/dora/tpcc/dora_payment.cpp

34 
	~"dÜa/cc/dÜa_·ym’t.h
"

35 
	~"dÜa/cc/dÜa_cc.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
usšg
 
Çme¥aû
 
	gcc
;

41 
ENTER_NAMESPACE
(
dÜa
);

58 
w_rc_t
 
	gmidway_·y_rvp
::
	$_run
()

61 
fš®_·y_rvp
* 
ävp
 = 
_±pcûnv
->
	`Ãw_fš®_·y_rvp
(
_xù
,
_tid
,
_xù_id
,
_»suÉ
,
_aùiÚs
);

64 
	`CHECK_MIDWAY_RVP_ABORTED
(
ävp
);

67 
šs_hi¡_·y_aùiÚ
* 
šs_hi¡_·y
 = 
_±pcûnv
->
	`Ãw_šs_hi¡_·y_aùiÚ
(
_xù
,
_tid
,
ävp
,
_pš
);

68 
šs_hi¡_·y
->
	`po¡£t
(
_awh
,
_adi¡
);

69 
·¹™iÚ_t
<> 
	tœpIm¶
;

70 
œpIm¶
* 
hi¡_·¹
 = 
_±pcûnv
->
	`decide_·¹
(_±pcûnv->
	`his
(),
_pš
.
_home_wh_id
);

72 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Nexˆpha£ (%d)\n", 
_tid
.
	`g‘_lo
());

75 
	`CRITICAL_SECTION
(
his_·¹_cs
, 
hi¡_·¹
->
_’queue_lock
);

76 ià(
hi¡_·¹
->
	`’queue
(
šs_hi¡_·y
,
_bWake
)) {

77 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing INS_HIST_PAY\n");

78 
	`as£¹
 (0);

79  (
	`RC
(
de_PROBLEM_ENQUEUE
));

82  (
RCOK
);

83 
	}
}

94 
w_rc_t
 
	gfš®_·y_rvp
::
	$run
()

96  (
	`_run
());

97 
	}
}

99 
	gfš®_·y_rvp
::
	$upd_comm™‹d_¡©s
()

101 
_±pcûnv
->
	`_šc_·ym’t_©t
();

102 
	}
}

104 
	gfš®_·y_rvp
::
	$upd_abÜ‹d_¡©s
()

106 
_±pcûnv
->
	`_šc_·ym’t_çed
();

107 
	}
}

122 
	gupd_wh_·y_aùiÚ
::
	$ÿlc_keys
()

124 
_down
.
	`push_back
(
_pš
.
_home_wh_id
);

125 
	}
}

127 
w_rc_t
 
	gupd_wh_·y_aùiÚ
::
	$Œx_exec
()

129 
	`as£¹
 (
_±pcûnv
);

132 
tu¶e_gu¬d
<
w¬ehou£_mª_im¶
> 
	`´wh
(
_±pcûnv
->
	`w¬ehou£_mª
());

133 
»p_row_t
 
	`¬•row
(
_±pcûnv
->
	`w¬ehou£_mª
()->
	`ts
());

134 
¬•row
.
	`£t
(
_±pcûnv
->
	`w¬ehou£_desc
()->
	`maxsize
());

135 
´wh
->
_»p
 = &
¬•row
;

138 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d PAY:wh-idx-nl (%d)\n",

139 
_tid
.
	`g‘_lo
(), 
_pš
.
_home_wh_id
);

140 
	`W_DO
(
_±pcûnv
->
	`w¬ehou£_mª
()->
	`wh_šdex_´obe_Æ
(_±pcûnv->
	`db
(), 
´wh
,

141 
_pš
.
_home_wh_id
));

153 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d PAY:wh-update-ytd-nl (%d)\n",

154 
_tid
.
	`g‘_lo
(), 
_pš
.
_home_wh_id
);

155 
	`W_DO
(
_±pcûnv
->
	`w¬ehou£_mª
()->
	`wh_upd©e_ytd_Æ
(_±pcûnv->
	`db
(),

156 
´wh
, 
_pš
.
_h_amouÁ
));

158 
cc_w¬ehou£_tu¶e
* 
awh
 = 
_m_rvp
->
	`wh
();

159 
´wh
->
	`g‘_v®ue
(1, 
awh
->
W_NAME
, 11);

160 
´wh
->
	`g‘_v®ue
(2, 
awh
->
W_STREET_1
, 21);

161 
´wh
->
	`g‘_v®ue
(3, 
awh
->
W_STREET_2
, 21);

162 
´wh
->
	`g‘_v®ue
(4, 
awh
->
W_CITY
, 21);

163 
´wh
->
	`g‘_v®ue
(5, 
awh
->
W_STATE
, 3);

164 
´wh
->
	`g‘_v®ue
(6, 
awh
->
W_ZIP
, 10);

166 #ifdeà
PRINT_TRX_RESULTS


169 
´wh
->
	`´št_tu¶e
();

172  
RCOK
;

173 
	}
}

176 
	gupd_di¡_·y_aùiÚ
::
	$ÿlc_keys
()

178 
_down
.
	`push_back
(
_pš
.
_home_wh_id
);

179 
_down
.
	`push_back
(
_pš
.
_home_d_id
);

180 
	}
}

182 
w_rc_t
 
	gupd_di¡_·y_aùiÚ
::
	$Œx_exec
()

184 
	`as£¹
 (
_±pcûnv
);

187 
tu¶e_gu¬d
<
di¡riù_mª_im¶
> 
	`´di¡
(
_±pcûnv
->
	`di¡riù_mª
());

188 
»p_row_t
 
	`¬•row
(
_±pcûnv
->
	`di¡riù_mª
()->
	`ts
());

189 
¬•row
.
	`£t
(
_±pcûnv
->
	`di¡riù_desc
()->
	`maxsize
());

190 
´di¡
->
_»p
 = &
¬•row
;

193 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d PAY:dist-idx-nl (%d) (%d)\n",

194 
_tid
.
	`g‘_lo
(), 
_pš
.
_home_wh_id
, _pš.
_home_d_id
);

195 
	`W_DO
(
_±pcûnv
->
	`di¡riù_mª
()->
	`di¡_šdex_´obe_Æ
(_±pcûnv->
	`db
(), 
´di¡
,

196 
_pš
.
_home_wh_id
,

197 
_pš
.
_home_d_id
));

199 #ifdeà
ACCESS_RECORD_TRACE


200 
¡ršg¡»am
 
¡
;

201 
di
 = 10*(
_pš
.
_home_wh_id
 - 1è+ _pš.
_home_d_id
;

202 
¡
 << 
di
;

203 
_±pcûnv
->
	`add_¿t
(
¡
.
	`¡r
());

216 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d PAY:distr-upd-ytd-nl (%d) (%d)\n",

217 
_tid
.
	`g‘_lo
(), 
_pš
.
_home_wh_id
, _pš.
_home_d_id
);

218 
	`W_DO
(
_±pcûnv
->
	`di¡riù_mª
()->
	`di¡_upd©e_ytd_Æ
(_±pcûnv->
	`db
(),

219 
´di¡
, 
_pš
.
_h_amouÁ
));

221 
cc_di¡riù_tu¶e
* 
adi¡r
 = 
_m_rvp
->
	`di¡
();

222 
´di¡
->
	`g‘_v®ue
(2, 
adi¡r
->
D_NAME
, 11);

223 
´di¡
->
	`g‘_v®ue
(3, 
adi¡r
->
D_STREET_1
, 21);

224 
´di¡
->
	`g‘_v®ue
(4, 
adi¡r
->
D_STREET_2
, 21);

225 
´di¡
->
	`g‘_v®ue
(5, 
adi¡r
->
D_CITY
, 21);

226 
´di¡
->
	`g‘_v®ue
(6, 
adi¡r
->
D_STATE
, 3);

227 
´di¡
->
	`g‘_v®ue
(7, 
adi¡r
->
D_ZIP
, 10);

229 #ifdeà
PRINT_TRX_RESULTS


232 
´di¡
->
	`´št_tu¶e
();

235  
RCOK
;

236 
	}
}

240 
	gupd_cu¡_·y_aùiÚ
::
	$ÿlc_keys
()

242 
_down
.
	`push_back
(
_pš
.
_home_wh_id
);

243 
_down
.
	`push_back
(
_pš
.
_home_d_id
);

244 
	}
}

246 
w_rc_t
 
	gupd_cu¡_·y_aùiÚ
::
	$Œx_exec
()

248 
	`as£¹
 (
_±pcûnv
);

251 
tu¶e_gu¬d
<
cu¡om”_mª_im¶
> 
	`´cu¡
(
_±pcûnv
->
	`cu¡om”_mª
());

252 
»p_row_t
 
	`¬•row
(
_±pcûnv
->
	`cu¡om”_mª
()->
	`ts
());

253 
¬•row
.
	`£t
(
_±pcûnv
->
	`cu¡om”_desc
()->
	`maxsize
());

254 
´cu¡
->
_»p
 = &
¬•row
;

257 
c_w
 = 
_pš
.
_v_cu¡_wh_£ËùiÚ
>85 ? _pš.
_home_wh_id
 : _pš.
_»mÙe_wh_id
;

258 
c_d
 = 
_pš
.
_v_cu¡_wh_£ËùiÚ
>85 ? _pš.
_home_d_id
 : _pš.
_»mÙe_d_id
;

260 ià(
_pš
.
_v_cu¡_id’t_£ËùiÚ
 <= 60) {

271 
	`as£¹
 (
_pš
.
_v_cu¡_id’t_£ËùiÚ
 <= 60);

272 
	`as£¹
 (
_pš
.
_c_id
 == 0);

274 
»p_row_t
 
	`low»p
(
_±pcûnv
->
	`cu¡om”_mª
()->
	`ts
());

275 
»p_row_t
 
	`high»p
(
_±pcûnv
->
	`cu¡om”_mª
()->
	`ts
());

277 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d PAY:cust-get-iter-by-name-index (%s)\n",

278 
_tid
.
	`g‘_lo
(), 
_pš
.
_c_Ï¡
);

280 
gu¬d
<
šdex_sÿn_™”_im¶
<
cu¡om”_t
> > 
c_™”
;

282 
šdex_sÿn_™”_im¶
<
cu¡om”_t
>* 
tmp_c_™”
;

283 
	`W_DO
(
_±pcûnv
->
	`cu¡om”_mª
()->

284 
	`cu¡_g‘_™”_by_šdex_Æ
(
_±pcûnv
->
	`db
(), 
tmp_c_™”
, 
´cu¡
,

285 
low»p
, 
high»p
, 
c_w
, 
c_d
,

286 
_pš
.
_c_Ï¡
));

287 
c_™”
 = 
tmp_c_™”
;

290 
veùÜ
<> 
v_c_id
;

291 
a_c_id
 = 0;

292 
couÁ
 = 0;

293 
boŞ
 
eof
;

295 
	`W_DO
(
c_™”
->
	`Ãxt
(
_±pcûnv
->
	`db
(), 
eof
, *
´cu¡
));

296 !
eof
) {

297 
couÁ
++;

298 
´cu¡
->
	`g‘_v®ue
(0, 
a_c_id
);

299 
v_c_id
.
	`push_back
(
a_c_id
);

301 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d PAY:cust-iter-next (%d)\n",

302 
_tid
.
	`g‘_lo
(), 
a_c_id
);

303 
	`W_DO
(
c_™”
->
	`Ãxt
(
_±pcûnv
->
	`db
(), 
eof
, *
´cu¡
));

305 
	`as£¹
 (
couÁ
);

308 
_pš
.
_c_id
 = 
v_c_id
[(
couÁ
+1)/2-1];

310 
	`as£¹
 (
_pš
.
_c_id
>0);

324 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d PAY:cust-idx-probe-upd-nl (%d) (%d) (%d)\n",

325 
_tid
.
	`g‘_lo
(), 
c_w
, 
c_d
, 
_pš
.
_c_id
);

326 
	`W_DO
(
_±pcûnv
->
	`cu¡om”_mª
()->
	`cu¡_šdex_´obe_Æ
(_±pcûnv->
	`db
(), 
´cu¡
,

327 
c_w
, 
c_d
, 
_pš
.
_c_id
));

330 
cc_cu¡om”_tu¶e
 
acu¡
;

331 
´cu¡
->
	`g‘_v®ue
(3, 
acu¡
.
C_FIRST
, 17);

332 
´cu¡
->
	`g‘_v®ue
(4, 
acu¡
.
C_MIDDLE
, 3);

333 
´cu¡
->
	`g‘_v®ue
(5, 
acu¡
.
C_LAST
, 17);

334 
´cu¡
->
	`g‘_v®ue
(6, 
acu¡
.
C_STREET_1
, 21);

335 
´cu¡
->
	`g‘_v®ue
(7, 
acu¡
.
C_STREET_2
, 21);

336 
´cu¡
->
	`g‘_v®ue
(8, 
acu¡
.
C_CITY
, 21);

337 
´cu¡
->
	`g‘_v®ue
(9, 
acu¡
.
C_STATE
, 3);

338 
´cu¡
->
	`g‘_v®ue
(10, 
acu¡
.
C_ZIP
, 10);

339 
´cu¡
->
	`g‘_v®ue
(11, 
acu¡
.
C_PHONE
, 17);

340 
´cu¡
->
	`g‘_v®ue
(12, 
acu¡
.
C_SINCE
);

341 
´cu¡
->
	`g‘_v®ue
(13, 
acu¡
.
C_CREDIT
, 3);

342 
´cu¡
->
	`g‘_v®ue
(14, 
acu¡
.
C_CREDIT_LIM
);

343 
´cu¡
->
	`g‘_v®ue
(15, 
acu¡
.
C_DISCOUNT
);

344 
´cu¡
->
	`g‘_v®ue
(16, 
acu¡
.
C_BALANCE
);

345 
´cu¡
->
	`g‘_v®ue
(17, 
acu¡
.
C_YTD_PAYMENT
);

346 
´cu¡
->
	`g‘_v®ue
(18, 
acu¡
.
C_LAST_PAYMENT
);

347 
´cu¡
->
	`g‘_v®ue
(19, 
acu¡
.
C_PAYMENT_CNT
);

348 
´cu¡
->
	`g‘_v®ue
(20, 
acu¡
.
C_DATA_1
, 251);

349 
´cu¡
->
	`g‘_v®ue
(21, 
acu¡
.
C_DATA_2
, 251);

352 
acu¡
.
C_BALANCE
 -ğ
_pš
.
_h_amouÁ
;

353 
acu¡
.
C_YTD_PAYMENT
 +ğ
_pš
.
_h_amouÁ
;

354 
acu¡
.
C_PAYMENT_CNT
++;

357 ià(
acu¡
.
C_CREDIT
[0] == 'B' &&‡cust.C_CREDIT[1] == 'C') {

369 
c_Ãw_d©a_1
[251];

370 
c_Ãw_d©a_2
[251];

371 
	`¥rštf
(
c_Ãw_d©a_1
, "%d,%d,%d,%d,%d,%1.2f",

372 
_pš
.
_c_id
, 
c_d
, 
c_w
, _pš.
_home_d_id
,

373 
_pš
.
_home_wh_id
, _pš.
_h_amouÁ
);

375 
Ën
 = 
	`¡¾’
(
c_Ãw_d©a_1
);

376 
	`¡ºÿt
(
c_Ãw_d©a_1
, 
acu¡
.
C_DATA_1
, 250-
Ën
);

377 
	`¡ºıy
(
c_Ãw_d©a_2
, &
acu¡
.
C_DATA_1
[250-
Ën
],†en);

378 
	`¡ºıy
(
c_Ãw_d©a_2
, 
acu¡
.
C_DATA_2
, 250-
Ën
);

380 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d PAY:cu¡-upd©e-tu¶e-Æ\n",
_tid
.
	`g‘_lo
());

381 
	`W_DO
(
_±pcûnv
->
	`cu¡om”_mª
()->
	`cu¡_upd©e_tu¶e_Æ
(_±pcûnv->
	`db
(),

382 
´cu¡
, 
acu¡
,

383 
c_Ãw_d©a_1
,

384 
c_Ãw_d©a_2
));

386 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d PAY:cu¡-upd©e-tu¶e-Æ\n",
_tid
.
	`g‘_lo
());

387 
	`W_DO
(
_±pcûnv
->
	`cu¡om”_mª
()->
	`cu¡_upd©e_tu¶e_Æ
(_±pcûnv->
	`db
(),

388 
´cu¡
, 
acu¡
, 
NULL
,

389 
NULL
));

392 
_m_rvp
->
_pš
.
_c_id
 = _pin._c_id;

395 #ifdeà
PRINT_TRX_RESULTS


398 
´cu¡
->
	`´št_tu¶e
();

401  
RCOK
;

402 
	}
}

406 
	gšs_hi¡_·y_aùiÚ
::
	$ÿlc_keys
()

408 
_down
.
	`push_back
(
_pš
.
_home_wh_id
);

409 
	}
}

411 
w_rc_t
 
	gšs_hi¡_·y_aùiÚ
::
	$Œx_exec
()

413 
	`as£¹
 (
_±pcûnv
);

416 
tu¶e_gu¬d
<
hi¡Üy_mª_im¶
> 
	`´hi¡
(
_±pcûnv
->
	`hi¡Üy_mª
());

417 
»p_row_t
 
	`¬•row
(
_±pcûnv
->
	`hi¡Üy_mª
()->
	`ts
());

418 
¬•row
.
	`£t
(
_±pcûnv
->
	`hi¡Üy_desc
()->
	`maxsize
());

419 
´hi¡
->
_»p
 = &
¬•row
;

422 
c_w
 = 
_pš
.
_v_cu¡_wh_£ËùiÚ
>85 ? _pš.
_home_wh_id
 : _pš.
_»mÙe_wh_id
;

423 
c_d
 = 
_pš
.
_v_cu¡_wh_£ËùiÚ
>85 ? _pš.
_home_d_id
 : _pš.
_»mÙe_d_id
;

430 
cc_hi¡Üy_tu¶e
 
ahi¡
;

431 
	`¥rštf
(
ahi¡
.
H_DATA
, "%  %s", 
_awh
.
W_NAME
, 
_adi¡
.
D_NAME
);

432 
ahi¡
.
H_DATE
 = 
	`time
(
NULL
);

434 
´hi¡
->
	`£t_v®ue
(0, 
_pš
.
_c_id
);

435 
´hi¡
->
	`£t_v®ue
(1, 
c_d
);

436 
´hi¡
->
	`£t_v®ue
(2, 
c_w
);

437 
´hi¡
->
	`£t_v®ue
(3, 
_pš
.
_home_d_id
);

438 
´hi¡
->
	`£t_v®ue
(4, 
_pš
.
_home_wh_id
);

439 
´hi¡
->
	`£t_v®ue
(5, 
ahi¡
.
H_DATE
);

440 
´hi¡
->
	`£t_v®ue
(6, 
_pš
.
_h_amouÁ
 * 100.0);

441 
´hi¡
->
	`£t_v®ue
(7, 
ahi¡
.
H_DATA
);

443 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d PAY:hi¡-add-tu¶e\n", 
_tid
.
	`g‘_lo
());

444 
	`W_DO
(
_±pcûnv
->
	`hi¡Üy_mª
()->
	`add_tu¶e
(_±pcûnv->
	`db
(), 
´hi¡
, 
NL
));

446 #ifdeà
PRINT_TRX_RESULTS


449 
´hi¡
->
	`´št_tu¶e
();

452  
RCOK
;

453 
	}
}

456 
EXIT_NAMESPACE
(
dÜa
);

	@src/dora/tpcc/dora_stock_level.cpp

34 
	~"dÜa/cc/dÜa_¡ock_Ëv–.h
"

35 
	~"dÜa/cc/dÜa_cc.h
"

37 
usšg
 
Çme¥aû
 
	gdÜa
;

38 
usšg
 
Çme¥aû
 
	gshÜe
;

39 
usšg
 
Çme¥aû
 
	gcc
;

42 
ENTER_NAMESPACE
(
dÜa
);

56 
DEFINE_DORA_FINAL_RVP_CLASS
(
fš®_¡ock_rvp
,
¡ock_Ëv–
);

66 
w_rc_t
 
	gmid1_¡ock_rvp
::
	$_run
()

69 
mid2_¡ock_rvp
* 
rvp2
 = 
_³nv
->
	`Ãw_mid2_¡ock_rvp
(
_xù
,
_tid
,
_xù_id
,
_»suÉ
,
_š
,
_aùiÚs
,
_bWake
);

72 
	`CHECK_MIDWAY_RVP_ABORTED
(
rvp2
);

75 
r_Ş_¡ock_aùiÚ
* 
r_Ş_¡ock
 = 
_³nv
->
	`Ãw_r_Ş_¡ock_aùiÚ
(
_xù
,
_tid
,
rvp2
,
_š
);

77 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Nexˆpha£ (%d)\n", 
_tid
.
	`g‘_lo
());

78 
·¹™iÚ_t
<> 
	tœpIm¶
;

81 
œpIm¶
* 
Ş_·¹
 = 
_³nv
->
	`decide_·¹
(_³nv->
	`Şi
(),
_š
.
_wh_id
);

84 
	`CRITICAL_SECTION
(
Şi_·¹_cs
, 
Ş_·¹
->
_’queue_lock
);

85 ià(
Ş_·¹
->
	`’queue
(
r_Ş_¡ock
,
_bWake
)) {

86 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing R_OL_STOCK\n");

87 
	`as£¹
 (0);

88  (
	`RC
(
de_PROBLEM_ENQUEUE
));

90  (
RCOK
);

92 
	}
}

102 
w_rc_t
 
	gmid2_¡ock_rvp
::
	$_run
()

105 
fš®_¡ock_rvp
* 
ävp
 = 
_³nv
->
	`Ãw_fš®_¡ock_rvp
(
_xù
,
_tid
,
_xù_id
,
_»suÉ
,
_aùiÚs
);

108 
	`CHECK_MIDWAY_RVP_ABORTED
(
ävp
);

111 
r_¡_¡ock_aùiÚ
* 
r_¡
 = 
_³nv
->
	`Ãw_r_¡_¡ock_aùiÚ
(
_xù
,
_tid
,
ävp
,
_š
);

113 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Nexˆpha£ (%d)\n", 
_tid
.
	`g‘_lo
());

114 
·¹™iÚ_t
<> 
	tœpIm¶
;

117 
œpIm¶
* 
my_¡_·¹
 = 
_³nv
->
	`decide_·¹
(_³nv->
	`¡o
(),
_š
.
_wh_id
);

120 
	`CRITICAL_SECTION
(
¡o_·¹_cs
, 
my_¡_·¹
->
_’queue_lock
);

121 ià(
my_¡_·¹
->
	`’queue
(
r_¡
,
_bWake
)) {

122 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing R_ST_STOCK\n");

123 
	`as£¹
 (0);

124  (
	`RC
(
de_PROBLEM_ENQUEUE
));

127  (
RCOK
);

128 
	}
}

141 
	gr_di¡_¡ock_aùiÚ
::
	$ÿlc_keys
()

143 
	`£t_»ad_Úly
();

144 
_down
.
	`push_back
(
_š
.
_wh_id
);

145 
_down
.
	`push_back
(
_š
.
_d_id
);

146 
	}
}

148 
w_rc_t
 
	gr_di¡_¡ock_aùiÚ
::
	$Œx_exec
()

150 
	`as£¹
 (
_³nv
);

153 
tu¶e_gu¬d
<
di¡riù_mª_im¶
> 
	`´di¡
(
_³nv
->
	`di¡riù_mª
());

155 
»p_row_t
 
	`¬•row
(
_³nv
->
	`di¡riù_mª
()->
	`ts
());

156 
¬•row
.
	`£t
(
_³nv
->
	`di¡riù_desc
()->
	`maxsize
());

157 
´di¡
->
_»p
 = &
¬•row
;

159 
w_id
 = 
_š
.
_wh_id
;

160 
d_id
 = 
_š
.
_d_id
;

171 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d STO:dist-idx-probe (%d) (%d)\n",

172 
_tid
.
	`g‘_lo
(), 
w_id
, 
d_id
);

173 
	`W_DO
(
_³nv
->
	`di¡riù_mª
()->
	`di¡_šdex_´obe_Æ
(_³nv->
	`db
(), 
´di¡
,

174 
w_id
, 
d_id
));

177 
Ãxt_o_id
 = 0;

178 
´di¡
->
	`g‘_v®ue
(10, 
Ãxt_o_id
);

180 
_´vp
->
_š
.
_Ãxt_o_id
 = 
Ãxt_o_id
;

182 #ifdeà
PRINT_TRX_RESULTS


185 
´di¡
->
	`´št_tu¶e
();

188  
RCOK
;

189 
	}
}

193 
	gr_Ş_¡ock_aùiÚ
::
	$ÿlc_keys
()

195 
	`£t_»ad_Úly
();

196 
_down
.
	`push_back
(
_š
.
_wh_id
);

197 
_down
.
	`push_back
(
_š
.
_d_id
);

198 
	}
}

200 
w_rc_t
 
	gr_Ş_¡ock_aùiÚ
::
	$Œx_exec
()

202 
	`as£¹
 (
_³nv
);

205 
tu¶e_gu¬d
<
Üd”_lše_mª_im¶
> 
	`´Ş
(
_³nv
->
	`Üd”_lše_mª
());

207 
»p_row_t
 
	`¬•row
(
_³nv
->
	`Üd”_lše_mª
()->
	`ts
());

208 
¬•row
.
	`£t
(
_³nv
->
	`Üd”_lše_desc
()->
	`maxsize
());

209 
´Ş
->
_»p
 = &
¬•row
;

211 
»p_row_t
 
	`low»p
(
_³nv
->
	`Üd”_lše_mª
()->
	`ts
());

212 
low»p
.
	`£t
(
_³nv
->
	`Üd”_lše_desc
()->
	`maxsize
());

214 
»p_row_t
 
	`high»p
(
_³nv
->
	`Üd”_lše_mª
()->
	`ts
());

215 
high»p
.
	`£t
(
_³nv
->
	`Üd”_lše_desc
()->
	`maxsize
());

217 
»p_row_t
 
	`sÜŒ•
(
_³nv
->
	`Üd”_lše_mª
()->
	`ts
());

218 
sÜŒ•
.
	`£t
(
_³nv
->
	`Üd”_lše_desc
()->
	`maxsize
());

220 
asc_sÜt_bufãr_t
 
	`Ş_li¡
(4);

221 
Ş_li¡
.
	`£tup
(0, 
SQL_INT
);

222 
Ş_li¡
.
	`£tup
(1, 
SQL_INT
);

223 
Ş_li¡
.
	`£tup
(2, 
SQL_INT
);

224 
Ş_li¡
.
	`£tup
(3, 
SQL_INT
);

225 
asc_sÜt_mª_im¶
 
	`Ş_sÜ‹r
(&
Ş_li¡
, &
sÜŒ•
);

226 
bË_row_t
 
	`rsb
(&
Ş_li¡
);

228 
boŞ
 
eof
;

230 
w_id
 = 
_š
.
_wh_id
;

231 
d_id
 = 
_š
.
_d_id
;

232 
i_id
 = -1;

253 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d STO:ol-iter-by-idx (%d) (%d) (%d) (%d)\n",

254 
_tid
.
	`g‘_lo
(), 
w_id
, 
d_id
, 
_š
.
_Ãxt_o_id
-20, _in._next_o_id);

256 
gu¬d
<
šdex_sÿn_™”_im¶
<
Üd”_lše_t
> > 
Ş_™”
;

258 
šdex_sÿn_™”_im¶
<
Üd”_lše_t
>* 
tmp_Ş_™”
;

259 
	`W_DO
(
_³nv
->
	`Üd”_lše_mª
()->

260 
	`Ş_g‘_¿nge_™”_by_šdex_Æ
(
_³nv
->
	`db
(), 
tmp_Ş_™”
, 
´Ş
, 
low»p
,

261 
high»p
, 
w_id
, 
d_id
, 
_š
.
_Ãxt_o_id
-20,

262 
_š
.
_Ãxt_o_id
));

263 
Ş_™”
 = 
tmp_Ş_™”
;

267 
	`W_DO
(
Ş_™”
->
	`Ãxt
(
_³nv
->
	`db
(), 
eof
, *
´Ş
));

268 !
eof
) {

270 
‹mp_oid
, 
‹mp_iid
;

271 
‹mp_wid
, 
‹mp_did
;

273 
´Ş
->
	`g‘_v®ue
(4, 
‹mp_iid
);

274 
´Ş
->
	`g‘_v®ue
(0, 
‹mp_oid
);

275 
´Ş
->
	`g‘_v®ue
(2, 
‹mp_wid
);

276 
´Ş
->
	`g‘_v®ue
(1, 
‹mp_did
);

278 
rsb
.
	`£t_v®ue
(0, 
‹mp_iid
);

279 
rsb
.
	`£t_v®ue
(1, 
‹mp_wid
);

280 
rsb
.
	`£t_v®ue
(2, 
‹mp_did
);

281 
rsb
.
	`£t_v®ue
(3, 
‹mp_oid
);

283 
Ş_sÜ‹r
.
	`add_tu¶e
(
rsb
);

285 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d STO:ol-iter-next (%d) (%d) (%d) (%d)\n",

286 
_tid
.
	`g‘_lo
(), 
‹mp_wid
, 
‹mp_did
, 
‹mp_oid
, 
‹mp_iid
);

287 
	`W_DO
(
Ş_™”
->
	`Ãxt
(
_³nv
->
	`db
(), 
eof
, *
´Ş
));

289 
	`as£¹
 (
Ş_sÜ‹r
.
	`couÁ
());

292 
asc_sÜt_™”_im¶
 
	`Ş_li¡_sÜt_™”
(
_³nv
->
	`db
(), &
Ş_li¡
, &
Ş_sÜ‹r
);

295 
	`as£¹
 (
_´vp
->
_š
.
_pvwi
 =ğ
NULL
);

296 
_´vp
->
_š
.
_pvwi
 = 
Ãw
 
	`TwoIÁVec
();

297 
	`as£¹
 (
_´vp
->
_š
.
_pvwi
);

298 
_´vp
->
_š
.
_pvwi
->
	`»£rve
(
Ş_sÜ‹r
.
	`couÁ
());

300 
	`W_DO
(
Ş_li¡_sÜt_™”
.
	`Ãxt
(
_³nv
->
	`db
(), 
eof
, 
rsb
));

302 !
eof
) {

304 
rsb
.
	`g‘_v®ue
(0, 
i_id
);

305 
rsb
.
	`g‘_v®ue
(1, 
w_id
);

307 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d STO:st-idx-probe (%d) (%d)\n",

308 
_tid
.
	`g‘_lo
(), 
w_id
, 
i_id
);

311 
_´vp
->
_š
.
_pvwi
->
	`push_back
(
·œ
<,>(
w_id
,
i_id
));

313 
	`W_DO
(
Ş_li¡_sÜt_™”
.
	`Ãxt
(
_³nv
->
	`db
(), 
eof
, 
rsb
));

316 #ifdeà
PRINT_TRX_RESULTS


319 
´Ş
->
	`´št_tu¶e
();

322  
RCOK
;

323 
	}
}

327 
	gr_¡_¡ock_aùiÚ
::
	$ÿlc_keys
()

329 
	`£t_»ad_Úly
();

330 
_down
.
	`push_back
(
_š
.
_wh_id
);

331 
	}
}

333 
w_rc_t
 
	gr_¡_¡ock_aùiÚ
::
	$Œx_exec
()

335 
	`as£¹
 (
_³nv
);

338 
tu¶e_gu¬d
<
¡ock_mª_im¶
> 
	`´¡
(
_³nv
->
	`¡ock_mª
());

340 
»p_row_t
 
	`¬•row
(
_³nv
->
	`¡ock_mª
()->
	`ts
());

341 
¬•row
.
	`£t
(
_³nv
->
	`¡ock_desc
()->
	`maxsize
());

342 
´¡
->
_»p
 = &
¬•row
;

344 
šput_w_id
 = 
_š
.
_wh_id
;

345 
w_id
 = 0;

346 
i_id
 = 0;

347 
quªt™y
 = 0;

348 
Ï¡_i_id
 = -1;

349 
couÁ
 = 0;

352 
	`as£¹
 (
_š
.
_pvwi
);

353 
TwoIÁVecIt
 
™
 = 
_š
.
_pvwi
->
	`begš
(); iˆ!ğ_š._pvwi->
	`’d
(); ++it) {

355 
w_id
 = (*
™
).
fœ¡
;

356 
i_id
 = (*
™
).
£cÚd
;

359 
	`as£¹
 (
šput_w_id
 =ğ
w_id
);

361 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d STO:st-idx-probe-nl (%d) (%d)\n",

362 
_tid
.
	`g‘_lo
(), 
w_id
, 
i_id
);

365 
	`W_DO
(
_³nv
->
	`¡ock_mª
()->
	`¡_šdex_´obe_Æ
(_³nv->
	`db
(), 
´¡
,

366 
w_id
, 
i_id
));

369 
´¡
->
	`g‘_v®ue
(3, 
quªt™y
);

371 ià(
quªt™y
 < 
_š
.
_th»shŞd
) {

379 ià(
Ï¡_i_id
 !ğ
i_id
) {

380 
Ï¡_i_id
 = 
i_id
;

381 
couÁ
++;

384 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d STO:found-one (%d) (%d) (%d) (%d)\n",

385 
_tid
.
	`g‘_lo
(), 
w_id
, 
i_id
, 
quªt™y
, 
couÁ
);

389 #ifdeà
PRINT_TRX_RESULTS


392 
´¡
->
	`´št_tu¶e
();

396 ià(
_š
.
_pvwi
è{ 
	`d–‘e
 (_š._pvwi); _š._pvw˜ğ
NULL
; }

398  
RCOK
;

399 
	}
}

402 
EXIT_NAMESPACE
(
dÜa
);

	@src/dora/tpcc/dora_tpcc.cpp

31 
	~"s.h
"

33 
	~"dÜa/cc/dÜa_cc.h
"

35 
	~"dÜa/cc/dÜa_mb’ch.h
"

36 
	~"dÜa/cc/dÜa_·ym’t.h
"

37 
	~"dÜa/cc/dÜa_Üd”_¡©us.h
"

38 
	~"dÜa/cc/dÜa_¡ock_Ëv–.h
"

39 
	~"dÜa/cc/dÜa_d–iv”y.h
"

40 
	~"dÜa/cc/dÜa_Ãw_Üd”.h
"

42 
usšg
 
Çme¥aû
 
	gshÜe
;

43 
usšg
 
Çme¥aû
 
	gcc
;

46 
ENTER_NAMESPACE
(
dÜa
);

51 cÚ¡ 
ušt
 
	gwhs_IRP_KEY
 = 1;

52 cÚ¡ 
ušt
 
	gdis_IRP_KEY
 = 2;

53 cÚ¡ 
ušt
 
	gcus_IRP_KEY
 = 3;

54 cÚ¡ 
ušt
 
	ghis_IRP_KEY
 = 6;

55 cÚ¡ 
ušt
 
	gnÜ_IRP_KEY
 = 3;

56 cÚ¡ 
ušt
 
	gÜd_IRP_KEY
 = 4;

57 cÚ¡ 
ušt
 
	g™e_IRP_KEY
 = 1;

58 cÚ¡ 
ušt
 
	gŞi_IRP_KEY
 = 4;

59 cÚ¡ 
ušt
 
	g¡o_IRP_KEY
 = 2;

62 cÚ¡ 
ušt
 
	gwhs_KEY_EST
 = 100;

63 cÚ¡ 
ušt
 
	gdis_KEY_EST
 = 1000;

64 cÚ¡ 
ušt
 
	gcus_KEY_EST
 = 1000;

65 cÚ¡ 
ušt
 
	ghis_KEY_EST
 = 1000;

66 cÚ¡ 
ušt
 
	gnÜ_KEY_EST
 = 1000;

67 cÚ¡ 
ušt
 
	gÜd_KEY_EST
 = 1000;

68 cÚ¡ 
ušt
 
	g™e_KEY_EST
 = 1000;

69 cÚ¡ 
ušt
 
	gŞi_KEY_EST
 = 1000;

70 cÚ¡ 
ušt
 
	g¡o_KEY_EST
 = 1000;

82 
	gDÜaTPCCEnv
::
	$DÜaTPCCEnv
()

83 : 
	$ShÜeTPCCEnv
()

85 
	`upd©e_pd
(
this
);

86 
	}
}

88 
	gDÜaTPCCEnv
::~
	$DÜaTPCCEnv
()

90 
	`¡İ
();

91 
	}
}

108 
	gDÜaTPCCEnv
::
	$¡¬t
()

114 
	`cÚf
();

115 
´oûssÜid_t
 
	`iıu
(
_¡¬tšg_ıu
);

118 
	`GENERATE_DORA_PARTS
(
whs
,
w¬ehou£
);

121 
	`GENERATE_DORA_PARTS
(
dis
,
di¡riù
);

124 
	`GENERATE_DORA_PARTS
(
his
,
hi¡Üy
);

127 
	`GENERATE_DORA_PARTS
(
cus
,
cu¡om”
);

130 
	`GENERATE_DORA_PARTS
(
nÜ
,
Ãw_Üd”
);

133 
	`GENERATE_DORA_PARTS
(
Üd
,
Üd”
);

136 
	`GENERATE_DORA_PARTS
(
™e
,
™em
);

139 
	`GENERATE_DORA_PARTS
(
Şi
,
Üd”_lše
);

142 
	`GENERATE_DORA_PARTS
(
¡o
,
¡ock
);

145 
DÜaEnv
::
	`_po¡_¡¬t
(
this
);

147 
	}
}

159 
w_rc_t
 
	gDÜaTPCCEnv
::
	$upd©e_·¹™iÚšg
()

164 
	`cÚf
();

167 
mšKeyV®
 = 1;

168 
maxKeyV®
 = 
	`g‘_sf
()+1;

170 * 
mšKey
 = (*)
	`m®loc
(());

171 
	`mem£t
(
mšKey
,0,());

172 
	`memıy
(
mšKey
,&
mšKeyV®
,());

174 * 
maxKey
 = (*)
	`m®loc
(());

175 
	`mem£t
(
maxKey
,0,());

176 
	`memıy
(
maxKey
,&
maxKeyV®
,());

179 #w¬nšg !!! 
IP
: 
To
 
have
 
»®
 
PLP
, 
the
 
·¹™iÚšg
 
šfo
 
should
 
be
 
decou¶ed
 
by
h
Üd”
 
š
h
´efix
 
Œ“
 !!!

200 
_pw¬ehou£_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
_·¹s_whs
);

201 
_pdi¡riù_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
_·¹s_dis
);

202 
_pcu¡om”_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
_·¹s_cus
);

203 
_²ew_Üd”_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
_·¹s_nÜ
);

204 
_pÜd”_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
_·¹s_Üd
);

205 
_pÜd”_lše_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
_·¹s_Şi
);

206 
_phi¡Üy_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
_·¹s_his
);

207 
_p¡ock_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
_·¹s_¡o
);

210 
maxKeyV®
 = 
ITEMS
 + 1;

211 
	`mem£t
(
maxKey
,0,());

212 
	`memıy
(
maxKey
,&
maxKeyV®
,());

213 
_p™em_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
_·¹s_™e
);

215 
	`ä“
 (
mšKey
);

216 
	`ä“
 (
maxKey
);

218  (
RCOK
);

219 
	}
}

231 
	gDÜaTPCCEnv
::
	$¡İ
()

233  (
DÜaEnv
::
	`_po¡_¡İ
(
this
));

234 
	}
}

245 
	gDÜaTPCCEnv
::
	$»sume
()

247 
	`as£¹
 (0);

248 
	`£t_dbc
(
DBC_ACTIVE
);

250 
	}
}

261 
	gDÜaTPCCEnv
::
	$·u£
()

263 
	`as£¹
 (0);

264 
	`£t_dbc
(
DBC_PAUSED
);

266 
	}
}

277 
	gDÜaTPCCEnv
::
	$cÚf
()

279 
ShÜeTPCCEnv
::
	`cÚf
();

280 
	`_check_ty³
();

281 
’vV¬
* 
ev
 =ƒnvV¬::
	`š¡ªû
();

284 
_ıu_¿nge
 = 
	`g‘_aùive_ıu_couÁ
();

285 
_¡¬tšg_ıu
 = 
ev
->
	`g‘V¬IÁ
("dÜa-ıu-¡¬tšg",
DF_CPU_STEP_PARTITIONS
);

286 
_ıu_bË_¡•
 = 
ev
->
	`g‘V¬IÁ
("dÜa-ıu-bË-¡•",
DF_CPU_STEP_TABLES
);

304 
ušt
 
»cÜdE¡im©iÚ
 = 
	`g‘_sf
();

305 
whs_P”CPU
 = 
ev
->
	`g‘V¬DoubË
("dora-ratio-tpcc-whs",0);

306 
_·¹s_whs
 = ( 
whs_P”CPU
>0 ? (
_ıu_¿nge
 * whs_PerCPU) : 1);

307 
_·¹s_whs
 = 
¡d
::
	`mš
(
»cÜdE¡im©iÚ
,_parts_whs);

311 
dis_P”CPU
 = 
ev
->
	`g‘V¬DoubË
("dora-ratio-tpcc-dis",0);

312 
_·¹s_dis
 = ( 
dis_P”CPU
>0 ? (
_ıu_¿nge
 * dis_PerCPU) : 1);

313 
_·¹s_dis
 = 
¡d
::
	`mš
(
»cÜdE¡im©iÚ
,_parts_dis);

317 
cus_P”CPU
 = 
ev
->
	`g‘V¬DoubË
("dora-ratio-tpcc-cus",0);

318 
_·¹s_cus
 = ( 
cus_P”CPU
>0 ? (
_ıu_¿nge
 * cus_PerCPU) : 1);

319 
_·¹s_cus
 = 
¡d
::
	`mš
(
»cÜdE¡im©iÚ
,_parts_cus);

324 
nÜ_P”CPU
 = 
ev
->
	`g‘V¬DoubË
("dora-ratio-tpcc-nor",0);

325 
_·¹s_nÜ
 = ( 
nÜ_P”CPU
>0 ? (
_ıu_¿nge
 *‚or_PerCPU) : 1);

326 
_·¹s_nÜ
 = 
¡d
::
	`mš
(
»cÜdE¡im©iÚ
,_parts_nor);

330 
Üd_P”CPU
 = 
ev
->
	`g‘V¬DoubË
("dora-ratio-tpcc-ord",0);

331 
_·¹s_Üd
 = ( 
Üd_P”CPU
>0 ? (
_ıu_¿nge
 * ord_PerCPU) : 1);

332 
_·¹s_Üd
 = 
¡d
::
	`mš
(
»cÜdE¡im©iÚ
,_parts_ord);

336 
Şi_P”CPU
 = 
ev
->
	`g‘V¬DoubË
("dora-ratio-tpcc-oli",0);

337 
_·¹s_Şi
 = ( 
Şi_P”CPU
>0 ? (
_ıu_¿nge
 * oli_PerCPU) : 1);

338 
_·¹s_Şi
 = 
¡d
::
	`mš
(
»cÜdE¡im©iÚ
,_parts_oli);

343 
his_P”CPU
 = 
ev
->
	`g‘V¬DoubË
("dora-ratio-tpcc-his",0);

344 
_·¹s_his
 = ( 
his_P”CPU
>0 ? (
_ıu_¿nge
 * his_PerCPU) : 1);

345 
_·¹s_his
 = 
¡d
::
	`mš
(
»cÜdE¡im©iÚ
,_parts_his);

349 
¡o_P”CPU
 = 
ev
->
	`g‘V¬DoubË
("dora-ratio-tpcc-sto",0);

350 
_·¹s_¡o
 = ( 
whs_P”CPU
>0 ? (
_ıu_¿nge
 * 
¡o_P”CPU
) : 1);

351 
_·¹s_¡o
 = 
¡d
::
	`mš
(
»cÜdE¡im©iÚ
,_parts_sto);

354 
»cÜdE¡im©iÚ
 = 
ITEMS
;

355 
™e_P”CPU
 = 
ev
->
	`g‘V¬DoubË
("dora-ratio-tpcc-ite",0);

356 
_·¹s_™e
 = ( 
™e_P”CPU
>0 ? (
_ıu_¿nge
 * ite_PerCPU) : 1);

357 
_·¹s_™e
 = 
¡d
::
	`mš
(
»cÜdE¡im©iÚ
,_parts_ite);

360 
	`TRACE
Ğ
TRACE_STATISTICS
,"Total‚umber of…artitions (%d)\n",

361 (
_·¹s_whs
+
_·¹s_dis
+
_·¹s_cus
+
_·¹s_nÜ
+

362 
_·¹s_Üd
+
_·¹s_Şi
+
_·¹s_his
+
_·¹s_™e
+

363 
_·¹s_¡o
));

366 
	}
}

377 
w_rc_t
 
	gDÜaTPCCEnv
::
	$Ãwrun
()

379  (
DÜaEnv
::
	`_Ãwrun
(
this
));

380 
	}
}

391 
	gDÜaTPCCEnv
::
	$dump
()

393  (
DÜaEnv
::
	`_dump
(
this
));

394 
	}
}

405 
	gDÜaTPCCEnv
::
	$šfo
() const

407  (
DÜaEnv
::
	`_šfo
(
this
));

408 
	}
}

419 
	gDÜaTPCCEnv
::
	$¡©i¡ics
()

421 
DÜaEnv
::
	`_¡©i¡ics
(
this
);

424 
	`TRACE
Ğ
TRACE_STATISTICS
, "----- TPCC -----\n");

425 
ShÜeTPCCEnv
::
	`¡©i¡ics
();

427 
	}
}

440 
DEFINE_DORA_FINAL_RVP_GEN_FUNC
(
fš®_mb_rvp
,
DÜaTPCCEnv
);

442 
DEFINE_DORA_ACTION_GEN_FUNC
(
upd_wh_mb_aùiÚ
,
rvp_t
,
mb’ch_wh_šput_t
,,
DÜaTPCCEnv
);

443 
DEFINE_DORA_ACTION_GEN_FUNC
(
upd_cu¡_mb_aùiÚ
,
rvp_t
,
mb’ch_cu¡_šput_t
,,
DÜaTPCCEnv
);

451 
DEFINE_DORA_MIDWAY_RVP_GEN_FUNC
(
midway_·y_rvp
,
·ym’t_šput_t
,
DÜaTPCCEnv
);

452 
DEFINE_DORA_FINAL_RVP_WITH_PREV_GEN_FUNC
(
fš®_·y_rvp
,
DÜaTPCCEnv
);

455 
DEFINE_DORA_ACTION_GEN_FUNC
(
upd_wh_·y_aùiÚ
,
midway_·y_rvp
,
·ym’t_šput_t
,,
DÜaTPCCEnv
);

456 
DEFINE_DORA_ACTION_GEN_FUNC
(
upd_di¡_·y_aùiÚ
,
midway_·y_rvp
,
·ym’t_šput_t
,,
DÜaTPCCEnv
);

457 
DEFINE_DORA_ACTION_GEN_FUNC
(
upd_cu¡_·y_aùiÚ
,
midway_·y_rvp
,
·ym’t_šput_t
,,
DÜaTPCCEnv
);

459 
DEFINE_DORA_ACTION_GEN_FUNC
(
šs_hi¡_·y_aùiÚ
,
rvp_t
,
·ym’t_šput_t
,,
DÜaTPCCEnv
);

472 
DEFINE_DORA_MIDWAY_RVP_GEN_FUNC
(
mid1_Üd¡_rvp
,
Üd”_¡©us_šput_t
,
DÜaTPCCEnv
);

474 
DEFINE_DORA_MIDWAY_RVP_WITH_PREV_GEN_FUNC
(
mid2_Üd¡_rvp
,
Üd”_¡©us_šput_t
,
DÜaTPCCEnv
);

476 
DEFINE_DORA_FINAL_RVP_WITH_PREV_GEN_FUNC
(
fš®_Üd¡_rvp
,
DÜaTPCCEnv
);

478 
DEFINE_DORA_ACTION_GEN_FUNC
(
r_cu¡_Üd¡_aùiÚ
,
mid1_Üd¡_rvp
,
Üd”_¡©us_šput_t
,,
DÜaTPCCEnv
);

479 
DEFINE_DORA_ACTION_GEN_FUNC
(
r_Üd_Üd¡_aùiÚ
,
mid2_Üd¡_rvp
,
Üd”_¡©us_šput_t
,,
DÜaTPCCEnv
);

481 
DEFINE_DORA_ACTION_GEN_FUNC
(
r_Ş_Üd¡_aùiÚ
,
rvp_t
,
Üd”_¡©us_šput_t
,,
DÜaTPCCEnv
);

493 
DEFINE_DORA_MIDWAY_RVP_GEN_FUNC
(
mid1_¡ock_rvp
,
¡ock_Ëv–_šput_t
,
DÜaTPCCEnv
);

494 
DEFINE_DORA_MIDWAY_RVP_WITH_PREV_GEN_FUNC
(
mid2_¡ock_rvp
,
¡ock_Ëv–_šput_t
,
DÜaTPCCEnv
);

496 
DEFINE_DORA_FINAL_RVP_WITH_PREV_GEN_FUNC
(
fš®_¡ock_rvp
,
DÜaTPCCEnv
);

499 
DEFINE_DORA_ACTION_GEN_FUNC
(
r_di¡_¡ock_aùiÚ
,
mid1_¡ock_rvp
,
¡ock_Ëv–_šput_t
,,
DÜaTPCCEnv
);

500 
DEFINE_DORA_ACTION_GEN_FUNC
(
r_Ş_¡ock_aùiÚ
,
mid2_¡ock_rvp
,
¡ock_Ëv–_šput_t
,,
DÜaTPCCEnv
);

502 
DEFINE_DORA_ACTION_GEN_FUNC
(
r_¡_¡ock_aùiÚ
,
rvp_t
,
¡ock_Ëv–_šput_t
,,
DÜaTPCCEnv
);

514 
DEFINE_DORA_MIDWAY_RVP_GEN_FUNC
(
mid1_d–_rvp
,
d–iv”y_šput_t
,
DÜaTPCCEnv
);

518 
DEFINE_DORA_MIDWAY_RVP_WITH_PREV_GEN_FUNC
(
mid2_d–_rvp
,
d–iv”y_šput_t
,
DÜaTPCCEnv
);

522 
DEFINE_DORA_FINAL_RVP_GEN_FUNC
(
fš®_d–_rvp
,
DÜaTPCCEnv
);

525 
DEFINE_DORA_ACTION_GEN_FUNC
(
d–_nÜd_d–_aùiÚ
,
mid1_d–_rvp
,
d–iv”y_šput_t
,,
DÜaTPCCEnv
);

528 
DEFINE_DORA_ACTION_GEN_FUNC
(
upd_Üd_d–_aùiÚ
,
mid2_d–_rvp
,
d–iv”y_šput_t
,,
DÜaTPCCEnv
);

532 
DEFINE_DORA_ACTION_GEN_FUNC
(
upd_Şše_d–_aùiÚ
,
mid2_d–_rvp
,
d–iv”y_šput_t
,,
DÜaTPCCEnv
);

536 
DEFINE_DORA_ACTION_GEN_FUNC
(
upd_cu¡_d–_aùiÚ
,
rvp_t
,
d–iv”y_šput_t
,,
DÜaTPCCEnv
);

552 
DEFINE_DORA_MIDWAY_RVP_GEN_FUNC
(
mid1_nÜd_rvp
,
Ãw_Üd”_šput_t
,
DÜaTPCCEnv
);

554 
DEFINE_DORA_MIDWAY_RVP_WITH_PREV_GEN_FUNC
(
mid2_nÜd_rvp
,
Ãw_Üd”_šput_t
,
DÜaTPCCEnv
);

556 
DEFINE_DORA_MIDWAY_RVP_WITH_PREV_GEN_FUNC
(
mid3_nÜd_rvp
,
Ãw_Üd”_šput_t
,
DÜaTPCCEnv
);

558 
DEFINE_DORA_FINAL_RVP_WITH_PREV_GEN_FUNC
(
fš®_nÜd_rvp
,
DÜaTPCCEnv
);

562 
DEFINE_DORA_ACTION_GEN_FUNC
(
r_wh_nÜd_aùiÚ
,
mid1_nÜd_rvp
,
no_™em_nÜd_šput_t
,,
DÜaTPCCEnv
);

564 
DEFINE_DORA_ACTION_GEN_FUNC
(
upd_di¡_nÜd_aùiÚ
,
mid1_nÜd_rvp
,
no_™em_nÜd_šput_t
,,
DÜaTPCCEnv
);

566 
DEFINE_DORA_ACTION_GEN_FUNC
(
r_cu¡_nÜd_aùiÚ
,
mid1_nÜd_rvp
,
no_™em_nÜd_šput_t
,,
DÜaTPCCEnv
);

568 
DEFINE_DORA_ACTION_GEN_FUNC
(
r_™em_nÜd_aùiÚ
,
mid1_nÜd_rvp
,
Ãw_Üd”_šput_t
,,
DÜaTPCCEnv
);

572 
DEFINE_DORA_ACTION_GEN_FUNC
(
šs_Üd_nÜd_aùiÚ
,
mid2_nÜd_rvp
,
no_™em_nÜd_šput_t
,,
DÜaTPCCEnv
);

574 
DEFINE_DORA_ACTION_GEN_FUNC
(
šs_nÜd_nÜd_aùiÚ
,
mid2_nÜd_rvp
,
no_™em_nÜd_šput_t
,,
DÜaTPCCEnv
);

578 
DEFINE_DORA_ACTION_GEN_FUNC
(
šs_Ş_nÜd_aùiÚ
,
mid3_nÜd_rvp
,
Ãw_Üd”_šput_t
,,
DÜaTPCCEnv
);

582 
DEFINE_DORA_ACTION_GEN_FUNC
(
upd_¡o_nÜd_aùiÚ
,
rvp_t
,
Ãw_Üd”_šput_t
,,
DÜaTPCCEnv
);

590 
EXIT_NAMESPACE
(
dÜa
);

	@src/dora/tpcc/dora_tpcc_client.cpp

31 
	~"dÜa/cc/dÜa_cc_ş›Á.h
"

34 
ENTER_NAMESPACE
(
dÜa
);

37 cÚ¡ 
	gXCT_DORA_MIX
 = 100;

38 cÚ¡ 
	gXCT_DORA_NEW_ORDER
 = 101;

39 cÚ¡ 
	gXCT_DORA_PAYMENT
 = 102;

40 cÚ¡ 
	gXCT_DORA_ORDER_STATUS
 = 103;

41 cÚ¡ 
	gXCT_DORA_DELIVERY
 = 104;

42 cÚ¡ 
	gXCT_DORA_STOCK_LEVEL
 = 105;

44 cÚ¡ 
	gXCT_DORA_LITTLE_MIX
 = 109;

46 cÚ¡ 
	gXCT_DORA_MBENCH_WH
 = 111;

47 cÚ¡ 
	gXCT_DORA_MBENCH_CUST
 = 112;

56 
	gdÜa_cc_ş›Á_t
::
	$lßd_sup_xù
(
m­SupTrxs
& 
¡m­
)

59 
¡m­
.
	`ş—r
();

62 
¡m­
[
XCT_DORA_MIX
] = "DORA-TPCC-Mix";

63 
¡m­
[
XCT_DORA_NEW_ORDER
] = "DORA-TPCC-NewOrder";

64 
¡m­
[
XCT_DORA_PAYMENT
] = "DORA-TPCC-Payment";

65 
¡m­
[
XCT_DORA_ORDER_STATUS
] = "DORA-TPCC-OrderStatus";

66 
¡m­
[
XCT_DORA_DELIVERY
] = "DORA-TPCC-Delivery";

67 
¡m­
[
XCT_DORA_STOCK_LEVEL
] = "DORA-TPCC-StockLevel";

70 
¡m­
[
XCT_DORA_LITTLE_MIX
] = "DORA-TPCC-LittleMix";

73 
¡m­
[
XCT_DORA_MBENCH_WH
] = "DORA-TPCC-MBench-WHs";

74 
¡m­
[
XCT_DORA_MBENCH_CUST
] = "DORA-TPCC-MBench-CUSTs";

76  (
¡m­
.
	`size
());

77 
	}
}

90 
w_rc_t
 
	gdÜa_cc_ş›Á_t
::
	$subm™_Úe
(
xù_ty³
, 
xùid
)

93 
boŞ
 
bWake
 = 
çl£
;

94 ià(
xù_ty³
 =ğ
XCT_DORA_MIX
) {

95 
xù_ty³
 = 
XCT_DORA_MIX
 + 
	`¿ndom_xù_ty³
(
	`¿nd
(100));

96 
bWake
 = 
Œue
;

100 
whid
 = 
_wh
;

101 ià(
_wh
==0) {

102 
whid
 = 
	`URªd
(1,
_qf
);

103 
bWake
 = 
Œue
;

106 
Œx_»suÉ_tu¶e_t
 
©¹
;

107 ià(
cÚdex
* 
c
 = 
_ı
->
	`ke_Úe
()) {

108 
©¹
.
	`£t_nÙify
(
c
);

109 
bWake
 = 
Œue
;

112 
xù_ty³
) {

115 
XCT_DORA_NEW_ORDER
:

116  (
_ccdb
->
	`dÜa_Ãw_Üd”
(
xùid
,
©¹
,
whid
,
bWake
));

117 
XCT_DORA_PAYMENT
:

118  (
_ccdb
->
	`dÜa_·ym’t
(
xùid
,
©¹
,
whid
,
bWake
));

119 
XCT_DORA_ORDER_STATUS
:

120  (
_ccdb
->
	`dÜa_Üd”_¡©us
(
xùid
,
©¹
,
whid
,
bWake
));

121 
XCT_DORA_DELIVERY
:

122  (
_ccdb
->
	`dÜa_d–iv”y
(
xùid
,
©¹
,
whid
,
bWake
));

123 
XCT_DORA_STOCK_LEVEL
:

124  (
_ccdb
->
	`dÜa_¡ock_Ëv–
(
xùid
,
©¹
,
whid
,
bWake
));

127 
XCT_DORA_LITTLE_MIX
:

128 ià(
	`URªd
(1,100)>50)

129  (
_ccdb
->
	`dÜa_Ãw_Üd”
(
xùid
,
©¹
,
whid
,
Œue
));

131  (
_ccdb
->
	`dÜa_·ym’t
(
xùid
,
©¹
,
whid
,
Œue
));

134 
XCT_DORA_MBENCH_WH
:

135  (
_ccdb
->
	`dÜa_mb’ch_wh
(
xùid
,
©¹
,
whid
,
bWake
));

136 
XCT_DORA_MBENCH_CUST
:

137  (
_ccdb
->
	`dÜa_mb’ch_cu¡
(
xùid
,
©¹
,
whid
,
bWake
));

140 
	`as£¹
 (0);

142  (
RCOK
);

143 
	}
}

145 
EXIT_NAMESPACE
(
dÜa
);

	@src/dora/tpcc/dora_tpcc_xct.cpp

31 
	~"dÜa/cc/dÜa_mb’ch.h
"

32 
	~"dÜa/cc/dÜa_·ym’t.h
"

33 
	~"dÜa/cc/dÜa_Üd”_¡©us.h
"

34 
	~"dÜa/cc/dÜa_¡ock_Ëv–.h
"

35 
	~"dÜa/cc/dÜa_d–iv”y.h
"

36 
	~"dÜa/cc/dÜa_Ãw_Üd”.h
"

38 
	~"dÜa/cc/dÜa_cc.h
"

40 
usšg
 
Çme¥aû
 
	gshÜe
;

41 
usšg
 
Çme¥aû
 
	gcc
;

44 
ENTER_NAMESPACE
(
dÜa
);

47 
	g·¹™iÚ_t
<> 
	tœpIm¶
;

87 
DEFINE_DORA_WITHOUT_INPUT_TRX_WRAPPER
(
DÜaTPCCEnv
,
Ãw_Üd”
);

88 
DEFINE_DORA_WITHOUT_INPUT_TRX_WRAPPER
(
DÜaTPCCEnv
,
·ym’t
);

89 
DEFINE_DORA_WITHOUT_INPUT_TRX_WRAPPER
(
DÜaTPCCEnv
,
Üd”_¡©us
);

90 
DEFINE_DORA_WITHOUT_INPUT_TRX_WRAPPER
(
DÜaTPCCEnv
,
d–iv”y
);

91 
DEFINE_DORA_WITHOUT_INPUT_TRX_WRAPPER
(
DÜaTPCCEnv
,
¡ock_Ëv–
);

92 
DEFINE_DORA_WITHOUT_INPUT_TRX_WRAPPER
(
DÜaTPCCEnv
,
mb’ch_wh
);

93 
DEFINE_DORA_WITHOUT_INPUT_TRX_WRAPPER
(
DÜaTPCCEnv
,
mb’ch_cu¡
);

107 
w_rc_t
 
	gDÜaTPCCEnv
::
	$dÜa_Ãw_Üd”
(cÚ¡ 
xù_id
,

108 
Œx_»suÉ_tu¶e_t
& 
©¹
,

109 
Ãw_Üd”_šput_t
& 
ªoš
,

110 cÚ¡ 
boŞ
 
bWake
)

113 if(
_¡¬t_imb®ªû
 > 0 && !
_bAÏrmS‘
) {

114 
	`CRITICAL_SECTION
(
®¬m_cs
, 
_®¬m_lock
);

115 if(!
_bAÏrmS‘
) {

116 
	`®¬m
(
_¡¬t_imb®ªû
);

117 
_bAÏrmS‘
 = 
Œue
;

122 
tid_t
 
©id
;

124 
	`W_DO
(
_pssm
->
	`begš_xù
(
©id
));

125 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Begš (%d)\n", 
©id
.
	`g‘_lo
());

127 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

130 
	`as£¹
 (
pxù
);

131 
	`me
()->
	`d‘ach_xù
(
pxù
);

132 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "D‘ached from (%d)\n", 
©id
.
	`g‘_lo
());

139 
whid
 = 
ªoš
.
_wh_id
;

142 
mid1_nÜd_rvp
* 
midrvp
 = 
	`Ãw_mid1_nÜd_rvp
(
pxù
,
©id
,
xù_id
,
©¹
,
ªoš
,
bWake
);

148 
no_™em_nÜd_šput_t
 
ªo™š
;

149 
ªoš
.
	`g‘_no_™em_šput
(
ªo™š
);

152 
r_wh_nÜd_aùiÚ
* 
r_wh_nÜd
 = 
	`Ãw_r_wh_nÜd_aùiÚ
(
pxù
,
©id
,
midrvp
,
ªo™š
);

153 
œpIm¶
* 
my_wh_·¹
 = 
	`decide_·¹
(
	`whs
(),
whid
);

155 
r_cu¡_nÜd_aùiÚ
* 
r_cu¡_nÜd
 = 
	`Ãw_r_cu¡_nÜd_aùiÚ
(
pxù
,
©id
,
midrvp
,
ªo™š
);

156 
œpIm¶
* 
my_cu¡_·¹
 = 
	`decide_·¹
(
	`cus
(),
whid
);

158 
upd_di¡_nÜd_aùiÚ
* 
upd_di¡_nÜd
 = 
	`Ãw_upd_di¡_nÜd_aùiÚ
(
pxù
,
©id
,
midrvp
,
ªo™š
);

159 
œpIm¶
* 
my_di¡_·¹
 = 
	`decide_·¹
(
	`dis
(),
whid
);

161 
r_™em_nÜd_aùiÚ
* 
r_™em_nÜd
 = 
	`Ãw_r_™em_nÜd_aùiÚ
(
pxù
,
©id
,
midrvp
,
ªoš
);

162 
œpIm¶
* 
my_™em_·¹
 = 
	`decide_·¹
(
	`™e
(),
whid
);

165 
	`CRITICAL_SECTION
(
wh_·¹_cs
, 
my_wh_·¹
->
_’queue_lock
);

167 ià(
my_wh_·¹
->
	`’queue
(
r_wh_nÜd
,
bWake
)) {

168 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing R_WH_NORD\n");

169 
	`as£¹
 (0);

170  (
	`RC
(
de_PROBLEM_ENQUEUE
));

174 
	`CRITICAL_SECTION
(
di¡_·¹_cs
, 
my_di¡_·¹
->
_’queue_lock
);

175 
wh_·¹_cs
.
	`ex™
();

177 ià(
my_di¡_·¹
->
	`’queue
(
upd_di¡_nÜd
,
bWake
)) {

178 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing UPD_DIST_NORD\n");

179 
	`as£¹
 (0);

180  (
	`RC
(
de_PROBLEM_ENQUEUE
));

184 
	`CRITICAL_SECTION
(
cu¡_·¹_cs
, 
my_cu¡_·¹
->
_’queue_lock
);

185 
di¡_·¹_cs
.
	`ex™
();

187 ià(
my_cu¡_·¹
->
	`’queue
(
r_cu¡_nÜd
,
bWake
)) {

188 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing R_CUST_NORD\n");

189 
	`as£¹
 (0);

190  (
	`RC
(
de_PROBLEM_ENQUEUE
));

194 
	`CRITICAL_SECTION
(
™em_·¹_cs
, 
my_™em_·¹
->
_’queue_lock
);

195 
cu¡_·¹_cs
.
	`ex™
();

197 ià(
my_™em_·¹
->
	`’queue
(
r_™em_nÜd
,
bWake
)) {

198 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing R_ITEM_NORD\n");

199 
	`as£¹
 (0);

200  (
	`RC
(
de_PROBLEM_ENQUEUE
));

203  (
RCOK
);

204 
	}
}

214 
w_rc_t
 
	gDÜaTPCCEnv
::
	$dÜa_·ym’t
(cÚ¡ 
xù_id
,

215 
Œx_»suÉ_tu¶e_t
& 
©¹
,

216 
·ym’t_šput_t
& 
­š
,

217 cÚ¡ 
boŞ
 
bWake
)

219 if(
_¡¬t_imb®ªû
 > 0 && !
_bAÏrmS‘
) {

220 
	`CRITICAL_SECTION
(
®¬m_cs
, 
_®¬m_lock
);

221 if(!
_bAÏrmS‘
) {

222 
	`®¬m
(
_¡¬t_imb®ªû
);

223 
_bAÏrmS‘
 = 
Œue
;

228 
tid_t
 
©id
;

230 
	`W_DO
(
_pssm
->
	`begš_xù
(
©id
));

231 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Begš (%d)\n", 
©id
.
	`g‘_lo
());

233 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

236 
	`as£¹
 (
pxù
);

237 
	`me
()->
	`d‘ach_xù
(
pxù
);

238 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "D‘ached from (%d)\n", 
©id
.
	`g‘_lo
());

242 
midway_·y_rvp
* 
rvp
 = 
	`Ãw_midway_·y_rvp
(
pxù
,
©id
,
xù_id
,
©¹
,
­š
,
bWake
);

245 
upd_wh_·y_aùiÚ
* 
·y_upd_wh
 = 
	`Ãw_upd_wh_·y_aùiÚ
(
pxù
,
©id
,
rvp
,
­š
);

246 
upd_di¡_·y_aùiÚ
* 
·y_upd_di¡
 = 
	`Ãw_upd_di¡_·y_aùiÚ
(
pxù
,
©id
,
rvp
,
­š
);

247 
upd_cu¡_·y_aùiÚ
* 
·y_upd_cu¡
 = 
	`Ãw_upd_cu¡_·y_aùiÚ
(
pxù
,
©id
,
rvp
,
­š
);

259 
wh
 = 
­š
.
_home_wh_id
;

262 
œpIm¶
* 
my_wh_·¹
 = 
	`decide_·¹
(
	`whs
(),
wh
);

263 
œpIm¶
* 
my_di¡_·¹
 = 
	`decide_·¹
(
	`dis
(),
wh
);

264 
œpIm¶
* 
my_cu¡_·¹
 = 
	`decide_·¹
(
	`cus
(),
wh
);

269 
	`CRITICAL_SECTION
(
wh_·¹_cs
, 
my_wh_·¹
->
_’queue_lock
);

271 ià(
my_wh_·¹
->
	`’queue
(
·y_upd_wh
,
bWake
)) {

272 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing PAY_UPD_WH\n");

273 
	`as£¹
 (0);

274  (
	`RC
(
de_PROBLEM_ENQUEUE
));

278 
	`CRITICAL_SECTION
(
dis_·¹_cs
, 
my_di¡_·¹
->
_’queue_lock
);

279 
wh_·¹_cs
.
	`ex™
();

281 ià(
my_di¡_·¹
->
	`’queue
(
·y_upd_di¡
,
bWake
)) {

282 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing PAY_UPD_DIST\n");

283 
	`as£¹
 (0);

284  (
	`RC
(
de_PROBLEM_ENQUEUE
));

288 
	`CRITICAL_SECTION
(
cus_·¹_cs
, 
my_cu¡_·¹
->
_’queue_lock
);

289 
dis_·¹_cs
.
	`ex™
();

291 ià(
my_cu¡_·¹
->
	`’queue
(
·y_upd_cu¡
,
bWake
)) {

292 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing PAY_UPD_CUST\n");

293 
	`as£¹
 (0);

294  (
	`RC
(
de_PROBLEM_ENQUEUE
));

298  (
RCOK
);

299 
	}
}

309 
w_rc_t
 
	gDÜaTPCCEnv
::
	$dÜa_Üd”_¡©us
(cÚ¡ 
xù_id
,

310 
Œx_»suÉ_tu¶e_t
& 
©¹
,

311 
Üd”_¡©us_šput_t
& 
aÜd¡š
,

312 cÚ¡ 
boŞ
 
bWake
)

314 if(
_¡¬t_imb®ªû
 > 0 && !
_bAÏrmS‘
) {

315 
	`CRITICAL_SECTION
(
®¬m_cs
, 
_®¬m_lock
);

316 if(!
_bAÏrmS‘
) {

317 
	`®¬m
(
_¡¬t_imb®ªû
);

318 
_bAÏrmS‘
 = 
Œue
;

323 
tid_t
 
©id
;

325 
	`W_DO
(
_pssm
->
	`begš_xù
(
©id
));

326 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Begš (%d)\n", 
©id
.
	`g‘_lo
());

328 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

331 
	`as£¹
 (
pxù
);

332 
	`me
()->
	`d‘ach_xù
(
pxù
);

333 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "D‘ached from (%d)\n", 
©id
.
	`g‘_lo
());

337 
mid1_Üd¡_rvp
* 
mid1_rvp
 = 
	`Ãw_mid1_Üd¡_rvp
(
pxù
,
©id
,
xù_id
,
©¹
,
aÜd¡š
,
bWake
);

340 
r_cu¡_Üd¡_aùiÚ
* 
r_cu¡
 = 
	`Ãw_r_cu¡_Üd¡_aùiÚ
(
pxù
,
©id
,
mid1_rvp
,
aÜd¡š
);

347 
wh
 = 
aÜd¡š
.
_wh_id
;

350 
œpIm¶
* 
my_cu¡_·¹
 = 
	`decide_·¹
(
	`cus
(),
wh
);

353 
	`CRITICAL_SECTION
(
cu¡_·¹_cs
, 
my_cu¡_·¹
->
_’queue_lock
);

355 ià(
my_cu¡_·¹
->
	`’queue
(
r_cu¡
,
bWake
)) {

356 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing ORDST_R_CUST\n");

357 
	`as£¹
 (0);

358  (
	`RC
(
de_PROBLEM_ENQUEUE
));

361  (
RCOK
);

362 
	}
}

372 
w_rc_t
 
	gDÜaTPCCEnv
::
	$dÜa_d–iv”y
(cÚ¡ 
xù_id
,

373 
Œx_»suÉ_tu¶e_t
& 
©¹
,

374 
d–iv”y_šput_t
& 
ad–š
,

375 cÚ¡ 
boŞ
 
bWake
)

377 if(
_¡¬t_imb®ªû
 > 0 && !
_bAÏrmS‘
) {

378 
	`CRITICAL_SECTION
(
®¬m_cs
, 
_®¬m_lock
);

379 if(!
_bAÏrmS‘
) {

380 
	`®¬m
(
_¡¬t_imb®ªû
);

381 
_bAÏrmS‘
 = 
Œue
;

386 
tid_t
 
©id
;

388 
	`W_DO
(
_pssm
->
	`begš_xù
(
©id
));

389 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Begš (%d)\n", 
©id
.
	`g‘_lo
());

391 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

394 
	`as£¹
 (0);

395 #w¬nšg 
TODO
: 
DEL
-
CUST
 
key
 
should
 
be
 2 (
WH
|
DI
è
ªd
 DEL-
ORD
 key should be 2 (WH|DI)

399 
	`as£¹
 (
pxù
);

400 
	`me
()->
	`d‘ach_xù
(
pxù
);

401 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "D‘ached from (%d)\n", 
©id
.
	`g‘_lo
());

404 
fš®_d–_rvp
* 
ävp
 = 
	`Ãw_fš®_d–_rvp
(
pxù
,
©id
,
xù_id
,
©¹
);

408 
i
=0;i<
DISTRICTS_PER_WAREHOUSE
;i++) {

411 
mid1_d–_rvp
* 
rvp
 = 
NULL
;

412 
	`as£¹
 (0);

413 
rvp
->
	`po¡£t
(
ävp
,
i
);

416 
d–_nÜd_d–_aùiÚ
* 
d–_d–_nÜd
 = 
	`Ãw_d–_nÜd_d–_aùiÚ
(
pxù
,
©id
,
rvp
,
ad–š
);

417 
d–_d–_nÜd
->
	`po¡£t
(
i
);

429 
wh
 = 
ad–š
.
_wh_id
;

432 
œpIm¶
* 
my_nÜd_·¹
 = 
	`decide_·¹
(
	`nÜ
(),
wh
);

437 
	`CRITICAL_SECTION
(
nÜd_·¹_cs
, 
my_nÜd_·¹
->
_’queue_lock
);

439 ià(
my_nÜd_·¹
->
	`’queue
(
d–_d–_nÜd
,
bWake
)) {

440 
	`TRACE
Ğ
TRACE_DEBUG
, "ProbËm iÀ’queuešg DEL_DEL_NORD-%d\n", 
i
);

441 
	`as£¹
 (0);

442  (
	`RC
(
de_PROBLEM_ENQUEUE
));

447  (
RCOK
);

448 
	}
}

458 
w_rc_t
 
	gDÜaTPCCEnv
::
	$dÜa_¡ock_Ëv–
(cÚ¡ 
xù_id
,

459 
Œx_»suÉ_tu¶e_t
& 
©¹
,

460 
¡ock_Ëv–_šput_t
& 
a¡oš
,

461 cÚ¡ 
boŞ
 
bWake
)

463 if(
_¡¬t_imb®ªû
 > 0 && !
_bAÏrmS‘
) {

464 
	`CRITICAL_SECTION
(
®¬m_cs
, 
_®¬m_lock
);

465 if(!
_bAÏrmS‘
) {

466 
	`®¬m
(
_¡¬t_imb®ªû
);

467 
_bAÏrmS‘
 = 
Œue
;

472 
tid_t
 
©id
;

474 
	`W_DO
(
_pssm
->
	`begš_xù
(
©id
));

475 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Begš (%d)\n", 
©id
.
	`g‘_lo
());

477 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

480 
	`as£¹
 (
pxù
);

481 
	`me
()->
	`d‘ach_xù
(
pxù
);

482 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "D‘ached from (%d)\n", 
©id
.
	`g‘_lo
());

486 
mid1_¡ock_rvp
* 
rvp
 = 
	`Ãw_mid1_¡ock_rvp
(
pxù
,
©id
,
xù_id
,
©¹
,
a¡oš
,
bWake
);

489 
r_di¡_¡ock_aùiÚ
* 
¡ock_r_di¡
 = 
	`Ãw_r_di¡_¡ock_aùiÚ
(
pxù
,
©id
,
rvp
,
a¡oš
);

500 
wh
 = 
a¡oš
.
_wh_id
;

503 
œpIm¶
* 
my_di¡_·¹
 = 
	`decide_·¹
(
	`dis
(),
wh
);

508 
	`CRITICAL_SECTION
(
dis_·¹_cs
, 
my_di¡_·¹
->
_’queue_lock
);

510 ià(
my_di¡_·¹
->
	`’queue
(
¡ock_r_di¡
,
bWake
)) {

511 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing STOCK_R_DIST\n");

512 
	`as£¹
 (0);

513  (
	`RC
(
de_PROBLEM_ENQUEUE
));

517  (
RCOK
);

518 
	}
}

529 
w_rc_t
 
	gDÜaTPCCEnv
::
	$dÜa_mb’ch_wh
(cÚ¡ 
xù_id
,

530 
Œx_»suÉ_tu¶e_t
& 
©¹
,

531 
mb’ch_wh_šput_t
& 
š
,

532 cÚ¡ 
boŞ
 
bWake
)

535 
tid_t
 
©id
;

537 
	`W_DO
(
_pssm
->
	`begš_xù
(
©id
));

538 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Begš (%d)\n", 
©id
.
	`g‘_lo
());

540 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

543 
	`as£¹
 (
pxù
);

544 
smth»ad_t
::
	`me
()->
	`d‘ach_xù
(
pxù
);

545 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "D‘ached from (%d)\n", 
©id
.
	`g‘_lo
());

549 
fš®_mb_rvp
* 
ävp
 = 
	`Ãw_fš®_mb_rvp
(
pxù
,
©id
,
xù_id
,
©¹
);

552 
upd_wh_mb_aùiÚ
* 
upd_wh
 = 
	`Ãw_upd_wh_mb_aùiÚ
(
pxù
,
©id
,
ävp
,
š
);

563 
œpIm¶
* 
my·¹™iÚ
 = 
	`decide_·¹
(
	`whs
(),
š
.
_wh_id
);

566 
	`CRITICAL_SECTION
(
wh_·¹_cs
, 
my·¹™iÚ
->
_’queue_lock
);

567 ià(
my·¹™iÚ
->
	`’queue
(
upd_wh
,
bWake
)) {

568 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing UPD_WH_MB\n");

569 
	`as£¹
 (0);

570  (
	`RC
(
de_PROBLEM_ENQUEUE
));

574  (
RCOK
);

575 
	}
}

577 
w_rc_t
 
	gDÜaTPCCEnv
::
	$dÜa_mb’ch_cu¡
(cÚ¡ 
xù_id
,

578 
Œx_»suÉ_tu¶e_t
& 
©¹
,

579 
mb’ch_cu¡_šput_t
& 
š
,

580 cÚ¡ 
boŞ
 
bWake
)

583 
tid_t
 
©id
;

585 
	`W_DO
(
_pssm
->
	`begš_xù
(
©id
));

586 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Begš (%d)\n", 
©id
.
	`g‘_lo
());

588 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

591 
	`as£¹
 (
pxù
);

592 
	`me
()->
	`d‘ach_xù
(
pxù
);

593 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "D‘ached from (%d)\n", 
©id
.
	`g‘_lo
());

596 
fš®_mb_rvp
* 
ävp
 = 
	`Ãw_fš®_mb_rvp
(
pxù
,
©id
,
xù_id
,
©¹
);

599 
upd_cu¡_mb_aùiÚ
* 
upd_cu¡
 = 
	`Ãw_upd_cu¡_mb_aùiÚ
(
pxù
,
©id
,
ävp
,
š
);

610 
œpIm¶
* 
my·¹™iÚ
 = 
	`decide_·¹
(
	`cus
(),
š
.
_wh_id
);

613 
	`CRITICAL_SECTION
(
cus_·¹_cs
, 
my·¹™iÚ
->
_’queue_lock
);

614 ià(
my·¹™iÚ
->
	`’queue
(
upd_cu¡
,
bWake
)) {

615 
	`TRACE
Ğ
TRACE_DEBUG
, "Problem inƒnqueueing UPD_CUST\n");

616 
	`as£¹
 (0);

617  (
	`RC
(
de_PROBLEM_ENQUEUE
));

621  (
RCOK
);

622 
	}
}

625 
EXIT_NAMESPACE
(
dÜa
);

	@src/dora/worker.cpp

32 
	~"dÜa/wÜk”.h
"

33 
	~"dÜa/aùiÚ.h
"

34 
	~"dÜa/·¹™iÚ.h
"

35 
	~"dÜa/rvp.h
"

38 
ENTER_NAMESPACE
(
dÜa
);

50 
	gdÜa_wÜk”_t
::
	$dÜa_wÜk”_t
(
ShÜeEnv
* 
’v
, 
ba£_·¹™iÚ_t
* 
­¬t
, 
c_¡r
 
Šame
,

51 
´oûssÜid_t
 
­rsid
, cÚ¡ 
u£_¦i
)

52 : 
	`ba£_wÜk”_t
(
’v
, 
Šame
, 
­rsid
, 
u£_¦i
),

53 
	$_·¹™iÚ
(
­¬t
)

55 
	}
}

57 
	gdÜa_wÜk”_t
::~
	$dÜa_wÜk”_t
()

59 
	}
}

63 
dÜa_wÜk”_t
::
	$£t_·¹™iÚ
(
ba£_·¹™iÚ_t
* 
­¬t
)

65 
	`as£¹
 (
­¬t
);

66 
_·¹™iÚ
 = 
­¬t
;

67 
	}
}

70 
ba£_·¹™iÚ_t
* 
	gdÜa_wÜk”_t
::
	$g‘_·¹™iÚ
()

72  (
_·¹™iÚ
);

73 
	}
}

75 
	gdÜa_wÜk”_t
::
	$doRecov”y
()

77  (
	`_wÜk_ACTIVE_im¶
());

78 
	}
}

81 
	gdÜa_wÜk”_t
::
	$_´e_STOP_im¶
()

83 
	`as£¹
(
_·¹™iÚ
);

84  (
_·¹™iÚ
->
	`abÜt_®l_’queued
());

85 
	}
}

99 
	gdÜa_wÜk”_t
::
	$_wÜk_ACTIVE_im¶
()

101 
bšdšg
 = 
’vV¬
::
	`š¡ªû
()->
	`g‘V¬IÁ
("dora-cpu-binding",0);

102 ià(
bšdšg
==0è
_´s_id
 = 
PBIND_NONE
;

103 
	`TRY_TO_BIND
(
_´s_id
,
_is_bound
);

108 
ba£_aùiÚ_t
* 
­a
 = 
NULL
;

109 
Ba£AùiÚPŒLi¡
 
aùiÚR—dyLi¡
;

110 
Ba£AùiÚPŒLi¡
 
aùiÚPromÙedLi¡
;

111 
aùiÚR—dyLi¡
.
	`ş—r
();

112 
aùiÚPromÙedLi¡
.
	`ş—r
();

114 
boŞ
 
šRecov”y
 = 
çl£
;

117 
	`me
()->
	`®loc_sdesc_ÿche
();

120 (
	`g‘_cÚŒŞ
(è& 
WC_ACTIVE
è|| (
šRecov”y
=(g‘_cÚŒŞ(è=ğ
WC_RECOVERY
))) {

123 
­a
 = 
NULL
;

124 
	`£t_ws
(
WS_LOOP
);

130 
_·¹™iÚ
->
	`has_comm™‹d
()) {

133 
­a
 = 
_·¹™iÚ
->
	`dequeue_comm™
();

134 
	`w_as£¹0
 (
­a
);

135 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Reûived comm™‹d (%d)\n", 
­a
->
	`tid
().
	`g‘_lo
());

139 
­a
->
	`Œx_»l_locks
(
aùiÚR—dyLi¡
,
aùiÚPromÙedLi¡
);

140 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Reûived (%dè»ady\n", 
aùiÚR—dyLi¡
.
	`size
());

143 
­a
->
	`giveback
();

144 
­a
 = 
NULL
;

148 
Ba£AùiÚPŒIt
 
™
=
aùiÚR—dyLi¡
.
	`begš
(); it!÷ùiÚR—dyLi¡.
	`’d
(); ++it) {

149 
	`_£rve_aùiÚ
(*
™
);

150 ++
_¡©s
.
_£rved_wa™šg
;

154 
aùiÚR—dyLi¡
.
	`ş—r
();

155 
aùiÚPromÙedLi¡
.
	`ş—r
();

158 ià(
šRecov”y
) {

159 ià(!
_·¹™iÚ
->
	`has_šput
()è{ 
loİex™
; }

168 
­a
 = 
_·¹™iÚ
->
	`dequeue
();

171 ià(
­a
) {

172 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "IÅuˆŒx (%d)\n", 
­a
->
	`tid
().
	`g‘_lo
());

173 ià(
­a
->
	`Œx_acq_locks
()) {

176 
	`_£rve_aùiÚ
(
­a
);

177 ++
_¡©s
.
_£rved_šput
;

182 
loİex™
:

184 
	`me
()->
	`ä“_sdesc_ÿche
();

186 
	}
}

200 
	gdÜa_wÜk”_t
::
	$_£rve_aùiÚ
(
ba£_aùiÚ_t
* 
·ùiÚ
)

203 
	`as£¹
 (
·ùiÚ
);

204 
	`as£¹
 (
·ùiÚ
->
	`is_»ady
());

206 
boŞ
 
is_”rÜ
 = 
çl£
;

207 
w_rc_t
 
e
 = 
RCOK
;

208 
r_code
 = 0;

211 
rvp_t
* 
­rvp
 = 
·ùiÚ
->
	`rvp
();

212 
	`as£¹
 (
­rvp
);

215 #ifdeà
WORKER_VERBOSE_STATS


217 
_¡©s
.
	`upd©e_wa™ed
(
·ùiÚ
->
	`wa™ed
());

221 ià(!
­rvp
->
	`isAbÜ‹d
()) {

224 
	`©ch_xù
(
·ùiÚ
->
	`xù
());

225 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "A‰achedØ(%d)\n", 
·ùiÚ
->
	`tid
().
	`g‘_lo
());

227 #ifdeà
WORKER_VERBOSE_STATS


228 
¡İw©ch_t
 
£rvšg_time
;

232 
e
 = 
·ùiÚ
->
	`Œx_exec
();

234 #ifdeà
WORKER_VERBOSE_STATS


235 
_¡©s
.
	`upd©e_£rved
(
£rvšg_time
.
	`time_ms
());

238 ià(
e
.
	`is_”rÜ
()) {

240 ià(
e
.
	`”r_num
(è=ğ
de_MIDWAY_ABORT
) {

241 
r_code
 = 
de_MIDWAY_ABORT
;

242 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Midway‡bÜˆ(%d)\n", 
·ùiÚ
->
	`tid
().
	`g‘_lo
());

243 ++
_¡©s
.
_mid_abÜts
;

247 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Problem„unning xct (%d) [0x%x]\n",

248 
·ùiÚ
->
	`tid
().
	`g‘_lo
(), 
e
.
	`”r_num
());

250 
is_”rÜ
 = 
Œue
;

251 
r_code
 = 
de_WORKER_RUN_XCT
;

253 ++
_¡©s
.
_´obËms
;

258 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "D‘achšg from (%d)\n", 
·ùiÚ
->
	`tid
().
	`g‘_lo
());

259 
	`d‘ach_xù
(
·ùiÚ
->
	`xù
());

263 
r_code
 = 
de_EARLY_ABORT
;

264 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "E¬ly‡bÜˆ(%d)\n", 
·ùiÚ
->
	`tid
().
	`g‘_lo
());

265 ++
_¡©s
.
_—¾y_abÜts
;

269 #ifdeà
WORKER_VERBOSE_STATS


270 
¡İw©ch_t
 
rvp_time
;

274 ià(
­rvp
->
	`po¡
(
is_”rÜ
)) {

277 
e
 = 
­rvp
->
	`run
();

279 #ifdeà
WORKER_VERBOSE_STATS


280 
_¡©s
.
	`upd©e_rvp_exec_time
(
rvp_time
.
	`time_ms
());

283 ià(
e
.
	`is_”rÜ
()) {

284 
	`TRACE
Ğ
TRACE_ALWAYS
, "Problem„unning„vp for xct (%d) [0x%x]\n",

285 
·ùiÚ
->
	`tid
().
	`g‘_lo
(), 
e
.
	`”r_num
());

286 
r_code
 = 
de_WORKER_RUN_RVP
;

294 
­rvp
 = 
NULL
;

297 #ifdeà
WORKER_VERBOSE_STATS


298 
_¡©s
.
	`upd©e_rvp_nÙify_time
(
rvp_time
.
	`time_ms
());

302 ++
_¡©s
.
_´oûs£d
;

304  (
r_code
);

305 
	}
}

309 
EXIT_NAMESPACE
(
dÜa
);

	@src/qpipe/common/predicates.cpp

24 
	~"qpe/commÚ/´ediÿ‹s.h
"

27 
ENTER_NAMESPACE
(
qpe
);

31 
boŞ
 
	$u£_d‘”mši¡ic_´ediÿ‹s
() {

32  
Œue
;

33 
	}
}

37 
´ediÿ‹_¿ndg’_t
 
	g´ediÿ‹_¿ndg’_t
::
	$acquœe
(cÚ¡ * 
ÿÎ”_g
) {

38 ià(
	`u£_d‘”mši¡ic_´ediÿ‹s
())

40  
	`´ediÿ‹_¿ndg’_t
(
ÿÎ”_g
);

43  
	`´ediÿ‹_¿ndg’_t
(
	`th»ad_g‘_£lf
()->
	`¿ndg’
());

44 
	}
}

48 
EXIT_NAMESPACE
(
qpe
);

	@src/qpipe/common/process_query.cpp

24 
	~"qpe/cÜe/tu¶e_fifo.h
"

25 
	~"qpe/cÜe/di¥©ch”.h
"

26 
	~"qpe/commÚ/´oûss_qu”y.h
"

27 
	~"ut.h
"

29 
ENTER_NAMESPACE
(
qpe
);

32 
	$´oûss_qu”y
(
·ck‘_t
* 
roÙ
, 
´oûss_tu¶e_t
& 
±
)

34 
gu¬d
<
tu¶e_fifo
> 
out
 = 
roÙ
->
	`ouut_bufãr
();

36 
di¥©ch”_t
::
wÜk”_»£rv”_t
* 
wr
 = di¥©ch”_t::
	`»£rv”_acquœe
();

39 
roÙ
->
	`deş¬e_wÜk”_Ãeds
(
wr
);

40 
wr
->
	`acquœe_»sourûs
();

41 
di¥©ch”_t
::
	`di¥©ch_·ck‘
(
roÙ
);

44 
tu¶e_t
 
ouut
;

45 
±
.
	`begš
();

46 
out
->
	`g‘_tu¶e
(
ouut
))

47 
±
.
	`´oûss
(
ouut
);

48 
±
.
	`’d
();

50 
di¥©ch”_t
::
	`»£rv”_»Ëa£
(
wr
);

51 
	}
}

54 
EXIT_NAMESPACE
(
qpe
);

	@src/qpipe/core/dispatcher.cpp

24 
	~"ut.h
"

25 
	~"qpe/cÜe/di¥©ch”.h
"

27 
	~<c¡dio
>

28 
	~<c¡ršg
>

29 
	~<m­
>

31 
usšg
 
	g¡d
::
m­
;

35 
ENTER_NAMESPACE
(
qpe
);

38 
di¥©ch”_t
* 
	gdi¥©ch”_t
::
_š¡ªû
 = 
NULL
;

39 
±h»ad_mu‹x_t
 
	gdi¥©ch”_t
::
_š¡ªû_lock
 = 
th»ad_mu‹x_ü—‹
();

42 
	gdi¥©ch”_t
::
	$di¥©ch”_t
()

44 
	}
}

48 
di¥©ch”_t
::~
	$di¥©ch”_t
()

50 
	`TRACE
(
TRACE_DEBUG
, "Needo destroy‚odes‡nd keys\n");

51 
	}
}

61 
	gdi¥©ch”_t
::
	$_»gi¡”_¡age_cÚš”
(cÚ¡ 
c_¡r
 &
·ck‘_ty³
,

62 
¡age_cÚš”_t
* 
sc
,

63 
boŞ
 
o¥_’abËd
)

68 iàĞ
_scdœ
[
·ck‘_ty³
] !ğ
NULL
 )

69 
	`THROW2
(
Di¥©ch”Exû±iÚ
,

71 
·ck‘_ty³
.
	`d©a
());

73 
_scdœ
[
·ck‘_ty³
] = 
sc
;

74 
_o¥dœ
[
·ck‘_ty³
] = 
o¥_’abËd
;

75 
	}
}

83 
	gdi¥©ch”_t
::
	$_di¥©ch_·ck‘
(
·ck‘_t
* 
·ck‘
) {

85 
¡age_cÚš”_t
* 
sc
 = 
_scdœ
[
·ck‘
->
_·ck‘_ty³
];

86 ià(
sc
 =ğ
NULL
)

87 
	`THROW2
(
Di¥©ch”Exû±iÚ
,

88 "Pack‘y³ % uÄegi¡”ed\n", 
·ck‘
->
_·ck‘_ty³
.
	`d©a
());

89 
sc
->
	`’queue
(
·ck‘
);

90 
	}
}

98 
boŞ
 
	gdi¥©ch”_t
::
	$_is_o¥_’abËd_fÜ_ty³
(cÚ¡ 
c_¡r
& 
ty³
)

101 
¡age_cÚš”_t
* 
sc
 = 
_scdœ
[
ty³
];

102 ià(
sc
 =ğ
NULL
) {

103 
	`THROW2
(
Di¥©ch”Exû±iÚ
,

104 "Pack‘y³ % uÄegi¡”ed\n", 
ty³
.
	`d©a
());

107  
_o¥dœ
[
ty³
];

108 
	}
}

117 
	gdi¥©ch”_t
::
	$_»£rve_wÜk”s
(cÚ¡ 
c_¡r
& 
ty³
, 
n
)

120 
¡age_cÚš”_t
* 
sc
 = 
_scdœ
[
ty³
];

121 ià(
sc
 =ğ
NULL
) {

122 
	`THROW2
(
Di¥©ch”Exû±iÚ
,

123 "Ty³ % uÄegi¡”ed\n", 
ty³
.
	`d©a
());

125 
sc
->
	`»£rve
(
n
);

126 
	}
}

135 
	gdi¥©ch”_t
::
	$_uÄe£rve_wÜk”s
(cÚ¡ 
c_¡r
& 
ty³
, 
n
)

137 
¡age_cÚš”_t
* 
sc
 = 
_scdœ
[
ty³
];

138 ià(
sc
 =ğ
NULL
)

139 
	`THROW2
(
Di¥©ch”Exû±iÚ
,

140 "Ty³ % uÄegi¡”ed\n", 
ty³
.
	`d©a
());

141 
sc
->
	`uÄe£rve
(
n
);

142 
	}
}

146 
	gdi¥©ch”_t
::
wÜk”_»£rv”_t
* 
di¥©ch”_t
::
	$»£rv”_acquœe
()

148  
Ãw
 
	`wÜk”_»£rv”_t
(
	`š¡ªû
());

149 
	}
}

153 
	gdi¥©ch”_t
::
	$»£rv”_»Ëa£
(
wÜk”_»£rv”_t
* 
wr
)

155 
d–‘e
 
wr
;

156 
	}
}

160 
	gdi¥©ch”_t
::
wÜk”_»Ëa£r_t
* 
di¥©ch”_t
::
	$»Ëa£r_acquœe
() {

161  
Ãw
 
	`wÜk”_»Ëa£r_t
(
	`š¡ªû
());

162 
	}
}

166 
	gdi¥©ch”_t
::
	$»Ëa£r_»Ëa£
(
wÜk”_»Ëa£r_t
* 
wr
)

168 
d–‘e
 
wr
;

169 
	}
}

173 
	gdi¥©ch”_t
::
wÜk”_»£rv”_t
::
	$acquœe_»sourûs
()

175 
m­
<
c_¡r
, >::
™”©Ü
 
™
;

176 
™
 = 
_wÜk”_Ãeds
.
	`begš
(); iˆ!ğ_wÜk”_Ãeds.
	`’d
(); ++it) {

177 
n
 = 
™
->
£cÚd
;

178 ià(
n
 > 0) {

179 
	`TRACE
(
TRACE_DEBUG
, "Re£rvšg %d % wÜk”s\n", 
n
, 
™
->
fœ¡
.
	`d©a
());

180 
_di¥©ch”
->
	`_»£rve_wÜk”s
(
™
->
fœ¡
, 
n
);

183 
	}
}

188 
boŞ
 
	$is_o¥_’abËd_fÜ_ty³
(cÚ¡ 
c_¡r
& 
·ck‘_ty³
)

190  
di¥©ch”_t
::
	`is_o¥_’abËd_fÜ_ty³
(
·ck‘_ty³
);

191 
	}
}

195 
	gdi¥©ch”_t
::
	$_£t_o¥_fÜ_ty³
(cÚ¡ 
c_¡r
& 
·ck‘_ty³
, 
boŞ
 
o¥_sw™ch
)

197 
_o¥dœ
[
·ck‘_ty³
] = 
o¥_sw™ch
;

198 
	}
}

199 
	$£t_o¥_fÜ_ty³
(cÚ¡ 
c_¡r
& 
·ck‘_ty³
, 
boŞ
 
o¥_sw™ch
)

201 
di¥©ch”_t
::
	`£t_o¥_fÜ_ty³
(
·ck‘_ty³
, 
o¥_sw™ch
);

202 
	}
}

205 
EXIT_NAMESPACE
(
qpe
);

	@src/qpipe/core/packet.cpp

24 
	~"qpe/cÜe/·ck‘.h
"

25 
	~"qpe/cÜe/¡age_cÚš”.h
"

26 
	~"ut.h
"

27 
	~"ut/th»ad.h
"

30 
ENTER_NAMESPACE
(
qpe
);

34 
o¥_pŞicy_t
 
	go¥_glob®_pŞicy
 = 
OSP_FULL
;

62 
	g·ck‘_t
::
	$·ck‘_t
(cÚ¡ 
c_¡r
 &
·ck‘_id
,

63 cÚ¡ 
c_¡r
 &
·ck‘_ty³
,

64 
tu¶e_fifo
* 
ouut_bufãr
,

65 
tu¶e_f‹r_t
* 
ouut_f‹r
,

66 
qu”y_¶ª
* 
¶ª
,

67 
boŞ
 
m”ge_’abËd
,

68 
boŞ
 
uÄe£rve_Ú_com¶‘iÚ
)

69 : 
	`_¶ª
(
¶ª
),

72 
	`_q¡©e
(
NULL
),

74 
	`_m”ge_’abËd
(
m”ge_’abËd
),

75 
	`_uÄe£rve_Ú_com¶‘iÚ
(
uÄe£rve_Ú_com¶‘iÚ
),

76 
	`_·ck‘_id
("%s_%s", 
	`th»ad_g‘_£lf
()->
	`th»ad_Çme
().
	`d©a
(), 
·ck‘_id
.data()),

77 
	`_·ck‘_ty³
(
·ck‘_ty³
),

78 
	`_ouut_bufãr
(
ouut_bufãr
),

79 
	`_ouut_f‹r
(
ouut_f‹r
),

80 
	`_Ãxt_tu¶e_Ú_m”ge
(
¡age_cÚš”_t
::
NEXT_TUPLE_UNINITIALIZED
),

81 
	$_Ãxt_tu¶e_Ãeded
 (
¡age_cÚš”_t
::
NEXT_TUPLE_INITIAL_VALUE
)

84 
	`as£¹
(
ouut_bufãr
 !ğ
NULL
);

85 
	`as£¹
(
ouut_f‹r
 !ğ
NULL
);

86 
	`as£¹
(!
m”ge_’abËd
 || 
¶ª
 !ğ
NULL
);

88 
	`TRACE
(
TRACE_PACKET_FLOW
, "Created %s…acket with ID %s\n",

89 
_·ck‘_ty³
.
	`d©a
(),

90 
_·ck‘_id
.
	`d©a
());

91 
	}
}

99 
	g·ck‘_t
::~
	$·ck‘_t
() {

101 
	`TRACE
(
TRACE_PACKET_FLOW
, "Destroying %s…acket with ID %s\n",

102 
_·ck‘_ty³
.
	`d©a
(),

103 
_·ck‘_id
.
	`d©a
());

104 
	}
}

108 
EXIT_NAMESPACE
(
qpe
);

	@src/qpipe/core/stage_container.cpp

24 
	~"qpe/cÜe/¡age_cÚš”.h
"

25 
	~"qpe/cÜe/di¥©ch”.h
"

26 
	~"ut.h
"

28 
	~<c¡dio
>

29 
	~<c¡ršg
>

33 
	#TRACE_MERGING
 
TRACE_RESOURCE_RELEASE
|0

	)

34 
	#TRACE_DEQUEUE
 
TRACE_RESOURCE_RELEASE
|0

	)

37 
ENTER_NAMESPACE
(
qpe
);

40 cÚ¡ 
boŞ
 
	gALWAYS_TRY_OSP_INSTEAD_OF_WORKER_CREATE
 = 
Œue
;

41 cÚ¡ 
	g¡age_cÚš”_t
::
NEXT_TUPLE_UNINITIALIZED
 = 0;

42 cÚ¡ 
	g¡age_cÚš”_t
::
NEXT_TUPLE_INITIAL_VALUE
 = 1;

49 
	s¡İ_exû±iÚ
 { };

51 
EXIT_NAMESPACE
(
qpe
);

52 
	g‹m¶©e
<>

53 
šlše
 

54 
	ggu¬d
<
	gqpe
::
di¥©ch”_t
::
wÜk”_»Ëa£r_t
>::

55 
	$aùiÚ
(
qpe
::
di¥©ch”_t
::
wÜk”_»Ëa£r_t
* 
±r
)

57 
qpe
::
di¥©ch”_t
::
	`»Ëa£r_»Ëa£
(
±r
);

58 
	}
}

59 
ENTER_NAMESPACE
(
qpe
);

63 * 
	g¡age_cÚš”_t
::
	$¡©ic_run_¡age_w¿µ”
(
¡age_t
* 
¡age
,

64 
¡age_ad­tÜ_t
* 
ad­tÜ
)

66 
ad­tÜ
->
	`run_¡age
(
¡age
);

67 
d–‘e
 
¡age
;

68 
d–‘e
 
ad­tÜ
;

69  
NULL
;

70 
	}
}

83 
	g¡age_cÚš”_t
::
	$¡age_cÚš”_t
(cÚ¡ 
c_¡r
 &
cÚš”_Çme
,

84 
¡age_çùÜy_t
* 
¡age_mak”
, 
aùive_couÁ
, 
max_couÁ
)

85 : 
	`_cÚš”_lock
(
	`th»ad_mu‹x_ü—‹
()),

86 
	`_cÚš”_queue_nÚem±y
(
	`th»ad_cÚd_ü—‹
()),

87 
	`_cÚš”_Çme
(
cÚš”_Çme
), 
	`_¡age_mak”
(
¡age_mak”
),

88 
	`_poŞ
(
aùive_couÁ
),

89 
	`_max_th»ads
((
max_couÁ
 > 
aùive_couÁ
)? max_couÁ : 
¡d
::
	`max
(10,‡ctive_count * 4)),

90 
	`_Ãxt_th»ad
(0),

91 
	$_½
(&
_cÚš”_lock
.
_lock
, 0, 
cÚš”_Çme
)

93 
	}
}

103 
	g¡age_cÚš”_t
::~
	$¡age_cÚš”_t
()

110 
	`th»ad_mu‹x_de¡roy
(
_cÚš”_lock
);

111 
	`th»ad_cÚd_de¡roy
(
_cÚš”_queue_nÚem±y
);

112 
	}
}

121 
	g¡age_th»ad
 : 
public
 
th»ad_t


123 
¡age_cÚš”_t
* 
_sc
;

124 
¡age_th»ad
(cÚ¡ 
c_¡r
 &
Çme
, 
¡age_cÚš”_t
* 
sc
)

125 : 
th»ad_t
(
Çme
), 
_sc
(
sc
)

129 
vœtu®
 
wÜk
() {

130 
	g_sc
->
run
();

139 
	g¡age_cÚš”_t
::
	$cÚš”_queue_’queue_no_m”ge
(
·ck‘_li¡_t
* 
·ck‘s
) {

140 
_cÚš”_queue
.
	`push_back
(
·ck‘s
);

141 
	`th»ad_cÚd_sigÇl
(
_cÚš”_queue_nÚem±y
);

142 
	}
}

153 
	g¡age_cÚš”_t
::
	$cÚš”_queue_’queue_no_m”ge
(
·ck‘_t
* 
·ck‘
)

155 
·ck‘_li¡_t
* 
·ck‘s
 = 
Ãw
 
	`·ck‘_li¡_t
();

156 
·ck‘s
->
	`push_back
(
·ck‘
);

157 
	`cÚš”_queue_’queue_no_m”ge
(
·ck‘s
);

158 
	}
}

169 
·ck‘_li¡_t
* 
	g¡age_cÚš”_t
::
	$cÚš”_queue_dequeue
() {

172  
_cÚš”_queue
.
	`em±y
() ) {

173 
	`th»ad_cÚd_wa™
Ğ
_cÚš”_queue_nÚem±y
, 
_cÚš”_lock
 );

177 
·ck‘_li¡_t
* 
¶i¡
 = 
_cÚš”_queue
.
	`äÚt
();

178 
_cÚš”_queue
.
	`pİ_äÚt
();

180  
¶i¡
;

181 
	}
}

191 
	g¡age_cÚš”_t
::
	$ü—‹_wÜk”
()

194 
_Ãxt_th»ad
++;

195 
c_¡r
 
	`th»ad_Çme
("%s_THREAD_%d", 
_cÚš”_Çme
.
	`d©a
(), 
_Ãxt_th»ad
);

196 
th»ad_t
* 
th»ad
 = 
Ãw
 
	`¡age_th»ad
(
th»ad_Çme
, 
this
);

198 
	`TRACE
(
TRACE_DEBUG
, "C»©šgh»ad %s\n", 
th»ad_Çme
.
	`d©a
());

200 #ifdeà
USE_SMTHREAD_AS_BASE


201 
th»ad
->
	`fÜk
();

203 
	`th»ad_ü—‹
(
th»ad
, &
_poŞ
);

207 
_½
.
	`nÙify_ÿ·c™y_šü—£
(1);

208 
	}
}

212 
	g¡age_cÚš”_t
::
	$»£rve
(
n
)

214 
ü™iÿl_£ùiÚ_t
 
	`cs
(
_cÚš”_lock
);

215 
	`_»£rve
(
n
);

216 
	}
}

226 
	g¡age_cÚš”_t
::
	$_»£rve
(
n
) {

229 
	`as£¹
(
n
 > 0);

234 
	`as£¹
(
n
 <ğ
_max_th»ads
);

239 
cu¼_ÿ·c™y
 = 
_½
.
	`g‘_ÿ·c™y
();

240 
cu¼_»£rved
 = 
_½
.
	`g‘_»£rved
();

241 ià((
cu¼_ÿ·c™y
 - 
cu¼_»£rved
è>ğ
n
) {

243 
_½
.
	`»£rve
(
n
);

251 
cu¼_ÿ·c™y
 < 
n
) {

252 
	`ü—‹_wÜk”
();

253 
cu¼_ÿ·c™y
++;

269 
cu¼_ÿ·c™y
 < 
_max_th»ads
) {

271 
uÄe£rved
 = 
cu¼_ÿ·c™y
 - 
cu¼_»£rved
;

272 ià(
uÄe£rved
 >ğ
n
) {

277 
	`ü—‹_wÜk”
();

278 
cu¼_ÿ·c™y
++;

283 
_½
.
	`»£rve
(
n
);

287 
	}
};

298 
	g¡age_cÚš”_t
::
	$uÄe£rve
(
n
) {

300 
	`as£¹
(
n
 > 0);

303 
ü™iÿl_£ùiÚ_t
 
	`cs
(
_cÚš”_lock
);

305 
_½
.
	`uÄe£rve
(
n
);

307 
	}
}

328 
	g¡age_cÚš”_t
::
	$’queue
(
·ck‘_t
* 
·ck‘
) {

331 
	`as£¹
(
·ck‘
 !ğ
NULL
);

332 
boŞ
 
uÄe£rve
 = 
·ck‘
->
	`uÄe£rve_wÜk”_Ú_com¶‘iÚ
();

333 
gu¬d
<
di¥©ch”_t
::
wÜk”_»Ëa£r_t
> 
wr
 = di¥©ch”_t::
	`»Ëa£r_acquœe
();

334 
·ck‘
->
	`deş¬e_wÜk”_Ãeds
(
wr
);

343 
ü™iÿl_£ùiÚ_t
 
	`cs
(
_cÚš”_lock
);

347 ià(!
·ck‘
->
	`is_m”ge_’abËd
()) {

349 
	`cÚš”_queue_’queue_no_m”ge
(
·ck‘
);

350 ià(
TRACE_MERGING
)

351 
	`TRACE
(
TRACE_ALWAYS
, "%s merging disabled\n",

352 
·ck‘
->
_·ck‘_id
.
	`d©a
());

366 if(
ALWAYS_TRY_OSP_INSTEAD_OF_WORKER_CREATE


367 || (
_½
.
	`g‘_nÚ_idË
(è>ğ
_poŞ
.
_max_aùive
)) {

371 
li¡
<
¡age_ad­tÜ_t
*>::
™”©Ü
 
s™
 = 
_cÚš”_cu¼’t_¡ages
.
	`begš
();

372  ; 
s™
 !ğ
_cÚš”_cu¼’t_¡ages
.
	`’d
(); ++sit) {

375 
¡age_cÚš”_t
::
¡age_ad­tÜ_t
* 
ad
 = *
s™
;

377 
¡age_cÚš”_t
::
m”ge_t
 
»t
 = 
ad
->
	`Œy_m”ge
(
·ck‘
);

378 ià(
»t
 =ğ
¡age_cÚš”_t
::
MERGE_SUCCESS_RELEASE_RESOURCES
) {

380 
cs
.
	`ex™
();

381 ià(
uÄe£rve
)

382 
wr
->
	`»Ëa£_»sourûs
();

385 ià(
»t
 =ğ
¡age_cÚš”_t
::
MERGE_SUCCESS_HOLD_RESOURCES
)

394 
CÚš”Queue
::
™”©Ü
 
c™
 = 
_cÚš”_queue
.
	`begš
();

395  ; 
c™
 !ğ
_cÚš”_queue
.
	`’d
(); ++cit) {

397 
·ck‘_li¡_t
* 
cq_¶i¡
 = *
c™
;

398 
·ck‘_t
* 
cq_·ck‘
 = 
cq_¶i¡
->
	`äÚt
();

408 iàĞ
cq_·ck‘
->
	`is_m”g—bË
(
·ck‘
) ) {

411 
cq_¶i¡
->
	`push_back
(
·ck‘
);

414 
cs
.
	`ex™
();

417 ià(
uÄe£rve
)

418 
wr
->
	`»Ëa£_»sourûs
();

425 ià(
TRACE_MERGING
)

426 
	`TRACE
(
TRACE_ALWAYS
, "%s could‚ot be merged\n",

427 
·ck‘
->
_·ck‘_id
.
	`d©a
());

432 
	`cÚš”_queue_’queue_no_m”ge
(
·ck‘
);

434 
	}
};

444 
	g¡age_cÚš”_t
::
	$run
() {

453 
ü™iÿl_£ùiÚ_t
 
	`cs
(
_cÚš”_lock
);

456 
·ck‘_li¡_t
* 
·ck‘s
 = 
	`cÚš”_queue_dequeue
();

459 
	`as£¹
Ğ
·ck‘s
 !ğ
NULL
 );

460 
	`as£¹
Ğ!
·ck‘s
->
	`em±y
() );

461 ià(
TRACE_DEQUEUE
) {

462 
·ck‘_t
* 
h—d_·ck‘
 = *(
·ck‘s
->
	`begš
());

463 
	`TRACE
(
TRACE_ALWAYS
, "Processing %s\n",

464 
h—d_·ck‘
->
_·ck‘_id
.
	`d©a
());

472 
¡age_ad­tÜ_t


473 
	`ad­tÜ
(
this
,

474 
·ck‘s
,

475 
·ck‘s
->
	`äÚt
()->
_ouut_f‹r
->
	`šput_tu¶e_size
());

481 
_cÚš”_cu¼’t_¡ages
.
	`push_back
(&
ad­tÜ
);

486 
_½
.
	`nÙify_nÚ_idË
();

489 
cs
.
	`ex™
();

493 
gu¬d
<
¡age_t
> 
¡age
 = 
_¡age_mak”
->
	`ü—‹_¡age
();

494 
ad­tÜ
.
	`run_¡age
(
¡age
);

498 
ü™iÿl_£ùiÚ_t
 
	`cs_»move_aùive_¡age
(
_cÚš”_lock
);

500 
_cÚš”_cu¼’t_¡ages
.
	`»move
(&
ad­tÜ
);

503 
cs_»move_aùive_¡age
.
	`ex™
();

508 
	}
}

524 
	g¡age_cÚš”_t
::
¡age_ad­tÜ_t
::
	$¡age_ad­tÜ_t
(
¡age_cÚš”_t
* 
cÚš”
,

525 
·ck‘_li¡_t
* 
·ck‘_li¡
,

526 
size_t
 
tu¶e_size
)

527 : 
	`ad­tÜ_t
(
·ge
::
	`®loc
(
tu¶e_size
)),

528 
	`_¡age_ad­tÜ_lock
(
	`th»ad_mu‹x_ü—‹
()),

529 
	`_cÚš”
(
cÚš”
),

530 
	`_·ck‘_li¡
(
·ck‘_li¡
),

531 
	`_Ãxt_tu¶e
(
NEXT_TUPLE_INITIAL_VALUE
),

532 
	`_¡l_acû±šg_·ck‘s
(
Œue
),

533 
	`_cÚšs_Ï‹_m”g”
(
çl£
),

534 
	$_ÿnûÎed
(
çl£
)

537 
	`as£¹
Ğ!
·ck‘_li¡
->
	`em±y
() );

539 
·ck‘_li¡_t
::
™”©Ü
 
™
;

545 
™
 = 
·ck‘_li¡
->
	`begš
();

546 
_·ck‘
 = *
™
;

550 
™
 = 
·ck‘_li¡
->
	`begš
(); iˆ!ğ·ck‘_li¡->
	`’d
(); ++it) {

551 
·ck‘_t
* 
·ck‘
 = *
™
;

552 
·ck‘
->
_Ãxt_tu¶e_Ú_m”ge
 = 
NEXT_TUPLE_INITIAL_VALUE
;

553 
·ck‘
->
	`ouut_bufãr
()->
	`wr™”_š™
();

555 
	}
}

576 
	g¡age_cÚš”_t
::
m”ge_t
 
¡age_cÚš”_t
::
¡age_ad­tÜ_t
::
	$Œy_m”ge
(
·ck‘_t
* 
·ck‘
) {

579 
ü™iÿl_£ùiÚ_t
 
	`cs
(
_¡age_ad­tÜ_lock
);

582 iàĞ!
_¡l_acû±šg_·ck‘s
 ) {

584  
¡age_cÚš”_t
::
MERGE_FAILED
;

596 iàĞ!
_·ck‘
->
	`is_m”g—bË
(
·ck‘
) ) {

598  
¡age_cÚš”_t
::
MERGE_FAILED
;

604 
¡age_cÚš”_t
::
m”ge_t
 
»t
;

607 
_·ck‘_li¡
->
	`push_äÚt
(
·ck‘
);

608 
·ck‘
->
_Ãxt_tu¶e_Ú_m”ge
 = 
_Ãxt_tu¶e
;

609 ià((
_Ãxt_tu¶e
 =ğ
NEXT_TUPLE_INITIAL_VALUE
è|| 
_cÚšs_Ï‹_m”g”
)

614 
»t
 = 
¡age_cÚš”_t
::
MERGE_SUCCESS_RELEASE_RESOURCES
;

618 
_cÚšs_Ï‹_m”g”
 = 
Œue
;

619 
»t
 = 
¡age_cÚš”_t
::
MERGE_SUCCESS_HOLD_RESOURCES
;

624 
·ck‘
->
	`ouut_bufãr
()->
	`wr™”_š™
();

627 
cs
.
	`ex™
();

629 
	`TRACE
(
TRACE_WORK_SHARING
, "%s merged into %s.‚ext_tuple_on_merge = %d\n",

630 
·ck‘
->
_·ck‘_id
.
	`d©a
(),

631 
·ck‘
->
_·ck‘_id
.
	`d©a
(),

632 
·ck‘
->
_Ãxt_tu¶e_Ú_m”ge
);

635  
»t
;

636 
	}
}

655 
	g¡age_cÚš”_t
::
¡age_ad­tÜ_t
::
	$ouut_·ge
(
·ge
* 
p
) {

657 
·ck‘_li¡_t
::
™”©Ü
 
™
, 
’d
;

658 
Ãxt_tu¶e
;

661 
ü™iÿl_£ùiÚ_t
 
	`cs
(
_¡age_ad­tÜ_lock
);

663 
™
 = 
_·ck‘_li¡
->
	`begš
();

664 
’d
 = 
_·ck‘_li¡
->
	`’d
();

665 
_Ãxt_tu¶e
 +ğ
p
->
	`tu¶e_couÁ
();

666 
Ãxt_tu¶e
 = 
_Ãxt_tu¶e
;

668 
cs
.
	`ex™
();

675 
·ge
::
™”©Ü
 
³nd
 = 
p
->
	`’d
();

676 
boŞ
 
·ck‘s_»maššg
 = 
çl£
;

677 
™
 !ğ
’d
) {

680 
·ck‘_t
* 
cu¼_·ck‘
 = *
™
;

681 
tu¶e_fifo
* 
ouut_bufãr
 = 
cu¼_·ck‘
->
	`ouut_bufãr
();

682 
tu¶e_f‹r_t
* 
ouut_f‹r
 = 
cu¼_·ck‘
->
_ouut_f‹r
;

683 
boŞ
 
‹rmš©e_cu¼_·ck‘
 = 
çl£
;

684 
Œy
 {

688 
·ge
::
™”©Ü
 
·ge_™
 = 
p
->
	`begš
();

689 
·ge_™
 !ğ
³nd
) {

692 
tu¶e_t
 
š_tup
 = 
·ge_™
.
	`advªû
();

693 if(
ouut_f‹r
->
	`£Ëù
(
š_tup
)) {

698 
tu¶e_t
 
out_tup
 = 
ouut_bufãr
->
	`®loÿ‹
();

699 
ouut_f‹r
->
	`´ojeù
(
out_tup
, 
š_tup
);

706 iàĞ
Ãxt_tu¶e
 =ğ
cu¼_·ck‘
->
_Ãxt_tu¶e_Ãeded
 ) {

710 
‹rmš©e_cu¼_·ck‘
 = 
Œue
;

714 } 
	`ÿtch
(
T”mš©edBufãrExû±iÚ
 &
e
) {

718 
	`TRACE
(
TRACE_ALWAYS
,

720 
‹rmš©e_cu¼_·ck‘
 = 
Œue
;

725 ià(
‹rmš©e_cu¼_·ck‘
) {

730 
	`fšish_·ck‘
(
cu¼_·ck‘
);

731 
™
 = 
_·ck‘_li¡
->
	`”a£
(it);

736 ++
™
;

737 
·ck‘s_»maššg
 = 
Œue
;

742 iàĞ!
·ck‘s_»maššg
 )

743 
throw
 
	`¡İ_exû±iÚ
();

744 
	}
}

759 
	g¡age_cÚš”_t
::
¡age_ad­tÜ_t
::
	$fšish_·ck‘
(
·ck‘_t
* 
·ck‘
) {

762 
gu¬d
<
tu¶e_fifo
> 
ouut_bufãr
 = 
·ck‘
->
	`»Ëa£_ouut_bufãr
();

763 iàĞ
ouut_bufãr
->
	`£nd_eof
() )

766 
ouut_bufãr
.
	`»Ëa£
();

769 iàĞ
·ck‘
 !ğ
_·ck‘
 ) {

772 
d–‘e
 
·ck‘
;

774 
	}
}

792 
	g¡age_cÚš”_t
::
¡age_ad­tÜ_t
::
	$run_¡age
(
¡age_t
* 
¡age
) {

796 
	`as£¹
Ğ
¡age
 !ğ
NULL
 );

800 
boŞ
 
”rÜ
 = 
çl£
;

801 
Œy
 {

802 
¡age
->
	`š™
(
this
);

803 
¡age
->
	`´oûss
();

804 
	`æush
();

805 } 
	`ÿtch
(
¡İ_exû±iÚ
 &) {

807 
	`TRACE
(
TRACE_DEBUG
, "process()ƒndedƒarly\n");

808 } 
	`ÿtch
(
QPeExû±iÚ
 &
qe
) {

810 
	`TRACE
(
TRACE_ALWAYS
, "´oûss(è’couÁ”ed‡À”rÜ: %s\n", 
qe
.
	`wh©
());

811 
”rÜ
 = 
Œue
;

812 } 
	`ÿtch
 (...) {

813 
	`TRACE
(
TRACE_ALWAYS
, "Caught unrecognizedƒxception\n");

814 
	`as£¹
(
çl£
);

818 
	`¡İ_acû±šg_·ck‘s
();

819 if(
”rÜ
)

820 
	`abÜt_qu”›s
();

822 
	`ş—nup
();

824 
	}
}

850 
	g¡age_cÚš”_t
::
¡age_ad­tÜ_t
::
	$ş—nup
() {

853 
·ck‘_li¡_t
::
™”©Ü
 
™
;

854 
™
 = 
_·ck‘_li¡
->
	`begš
(); iˆ!ğ_·ck‘_li¡->
	`’d
(); ) {

856 
·ck‘_t
* 
cu¼_·ck‘
 = *
™
;

861 iàĞ
cu¼_·ck‘
->
_Ãxt_tu¶e_Ú_m”ge
 =ğ
NEXT_TUPLE_INITIAL_VALUE
 ) {

865 
	`fšish_·ck‘
(
cu¼_·ck‘
);

867 
™
 = 
_·ck‘_li¡
->
	`”a£
(it);

875 
cu¼_·ck‘
->
_Ãxt_tu¶e_Ãeded
 =

876 
cu¼_·ck‘
->
_Ãxt_tu¶e_Ú_m”ge
;

877 
cu¼_·ck‘
->
_Ãxt_tu¶e_Ú_m”ge
 = 
NEXT_TUPLE_UNINITIALIZED
;

878 ++
™
;

882 
ü™iÿl_£ùiÚ_t
 
	`cs
(
_cÚš”
->
_cÚš”_lock
);

889 
_cÚš”
->
_½
.
	`nÙify_idË
();

890 ià(
_·ck‘
->
	`uÄe£rve_wÜk”_Ú_com¶‘iÚ
())

891 
_cÚš”
->
_½
.
	`uÄe£rve
(1);

895 iàĞ
_·ck‘_li¡
->
	`em±y
() )

896 
d–‘e
 
_·ck‘_li¡
;

898 
_cÚš”
->
	`cÚš”_queue_’queue_no_m”ge
(
_·ck‘_li¡
);

902 
cs
.
	`ex™
();

907 
_·ck‘_li¡
 = 
NULL
;

908 
	`as£¹
(
_·ck‘
 !ğ
NULL
);

909 
d–‘e
 
_·ck‘
;

910 
_·ck‘
 = 
NULL
;

911 
	}
}

935 
	g¡age_cÚš”_t
::
¡age_ad­tÜ_t
::
	$abÜt_qu”›s
() {

937 
	`TRACE
(
TRACE_ALWAYS
, "AbÜtšg qu”y: %s", 
_·ck‘
->
_·ck‘_id
.
	`d©a
());

940 
·ck‘_li¡_t
::
™”©Ü
 
™
;

941 
™
 = 
_·ck‘_li¡
->
	`begš
(); iˆ!ğ_·ck‘_li¡->
	`’d
(); ++it) {

943 
·ck‘_t
* 
cu¼_·ck‘
 = *
™
;

944 iàĞ
cu¼_·ck‘
 !ğ
_·ck‘
 ) {

946 
d–‘e
 
cu¼_·ck‘
;

950 
d–‘e
 
_·ck‘_li¡
;

951 
_·ck‘_li¡
 = 
NULL
;

954 
d–‘e
 
_·ck‘
;

955 
_·ck‘
 = 
NULL
;

956 
	}
}

960 
EXIT_NAMESPACE
(
qpe
);

	@src/qpipe/core/tuple.cpp

24 
	~<c¡dio
>

26 
	~"qpe/cÜe/tu¶e.h
"

27 
	~"ut.h
"

31 
ENTER_NAMESPACE
(
qpe
);

33 *
	$®igÃd_®loc
(
size_t
 
sz
, size_ˆ
®ignm’t
) {

34 *
rv®
;

35 #ifdeà
HAVE_POSIX_MEMALIGN


36 ià(
	`posix_mem®ign
(&
rv®
, 
®ignm’t
, 
sz
))

37 
rv®
 = 0;

38 #–ià
	`defšed
(
HAVE_MEMALIGN
)

39 
rv®
 = 
	`mem®ign
(
®ignm’t
, 
sz
);

41 #”rÜ 
No
 
mem®ign
?

43  (*è
rv®
;

44 
	}
}

48 
m®loc_·ge_poŞ
 
	gm®loc_·ge_poŞ
::
_š¡ªû
;

52 
size_t
 
	gdeçuÉ_·ge_size
 = 8192;

53 
boŞ
 
	gš™Ÿlized
 = 
çl£
;

55 
	$£t_deçuÉ_·ge_size
(
size_t
 
·ge_size
) {

56 
	`as£¹
(!
š™Ÿlized
);

57 
š™Ÿlized
 = 
Œue
;

58 
deçuÉ_·ge_size
 = 
·ge_size
;

59 
	}
}

61 
size_t
 
	$g‘_deçuÉ_·ge_size
(è{  
deçuÉ_·ge_size
; 
	}
}

65 
boŞ
 
	g·ge
::
	$»ad_fuÎ_·ge
(
fd
) {

68 
gu¬d
<> 
®igÃd_ba£
 = 
	`®igÃd_®loc
(
	`·ge_size
(), 512);

69 
	`as£¹
(
®igÃd_ba£
 !ğ
NULL
);

74 
ssize_t
 
size_»ad
 = 
	`rio_»adn
(
fd
, 
®igÃd_ba£
, 
	`·ge_size
());

78 ià(
size_»ad
 == -1)

79 
	`THROW2
(
FeExû±iÚ
, "::»ad faed %s", 
	`¡»¼Ü
(
”ºo
));

83 ià(
size_»ad
 == 0)

84  
çl£
;

89 
·ge_poŞ
* 
poŞ
 = 
_poŞ
;

90 
	`memıy
(
this
, 
®igÃd_ba£
, 
size_»ad
);

91 
_poŞ
 = 
poŞ
;

95 iàĞ(
	`·ge_size
(è!ğ(
size_t
)
size_»ad
) ) {

100 
	`TRACE
(
TRACE_ALWAYS
,

103 
size_»ad
,

104 
	`·ge_size
());

105 
	`THROW1
(
FeExû±iÚ
, "::read„ead wrong size…age");

108  
Œue
;

109 
	}
}

113 
	g·ge
::
	$wr™e_fuÎ_·ge
(
fd
) {

116 
gu¬d
<> 
®igÃd_ba£
 = 
	`®igÃd_®loc
(
	`·ge_size
(), 512);

117 
	`as£¹
(
®igÃd_ba£
 !ğ
NULL
);

118 
	`memıy
(
®igÃd_ba£
, 
this
, 
	`·ge_size
());

121 
ssize_t
 
wr™e_couÁ
 = 
	`rio_wr™’
(
fd
, 
®igÃd_ba£
, 
	`·ge_size
());

122 ià((
size_t
)
wr™e_couÁ
 !ğ
	`·ge_size
()) {

123 
	`TRACE
(
TRACE_ALWAYS
, "::write(%d, %p, %zd)„eturned %zd: %s\n",

124 
fd
,

125 
®igÃd_ba£
,

126 
	`·ge_size
(),

127 
wr™e_couÁ
,

128 
	`¡»¼Ü
(
”ºo
));

129 
	`THROW2
(
FeExû±iÚ
, "::wr™e(èçed %s", 
	`¡»¼Ü
(
”ºo
));

131 
	}
}

135 
boŞ
 
	g·ge
::
	$ä—d_fuÎ_·ge
(
FILE
* 
fe
) {

138 
size_t
 
size
 = 
	`·ge_size
();

139 
	`TRACE
(0&
TRACE_ALWAYS
, "Compu‹d…agsiza %d\n", ()
size
);

140 
·ge_poŞ
* 
poŞ
 = 
_poŞ
;

143 
size_t
 
size_»ad
 = ::
	`ä—d
(
this
, 1, 
size
, 
fe
);

144 
_poŞ
 = 
poŞ
;

147 iàĞ(
size_»ad
 =ğ0è&& !
	`ãof
(
fe
) )

148 
	`THROW2
(
FeExû±iÚ
, "::ä—d faed %s", 
	`¡»¼Ü
(
”ºo
));

152 iàĞ(
size_»ad
 =ğ0è&& 
	`ãof
(
fe
) )

154  
çl£
;

157 iàĞ(
size
 !ğ
size_»ad
è|| (siz!ğ
	`·ge_size
()) ) {

162 
	`TRACE
(
TRACE_ALWAYS
,

165 
size_»ad
,

166 
	`·ge_size
(),

167 
size
);

168 
	`THROW1
(
FeExû±iÚ
, "::fread„ead wrong size…age");

171  
Œue
;

172 
	}
}

176 
	g·ge
::
	$fwr™e_fuÎ_·ge
(
FILE
 *
fe
) {

177 
size_t
 
wr™e_couÁ
 = ::
	`fwr™e
(
this
, 1, 
	`·ge_size
(), 
fe
);

178 iàĞ
wr™e_couÁ
 !ğ
	`·ge_size
() ) {

179 
	`TRACE
(
TRACE_ALWAYS
, "::fwrite() wrote %zd/%zd…age bytes %s\n",

180 
wr™e_couÁ
,

181 
	`·ge_size
(),

182 
	`¡»¼Ü
(
”ºo
));

183 
	`THROW2
(
FeExû±iÚ
, "::fwr™e(èçed %s", 
	`¡»¼Ü
(
”ºo
));

185 
	}
}

189 
EXIT_NAMESPACE
(
qpe
);

	@src/qpipe/core/tuple_fifo.cpp

24 
	~"qpe/cÜe/tu¶e_fifo.h
"

25 
	~"qpe/cÜe/tu¶e_fifo_dœeùÜy.h
"

26 
	~"ut/Œaû.h
"

27 
	~"ut/acouÁ”.h
"

28 
	~<®gÜ™hm
>

31 
ENTER_NAMESPACE
(
qpe
);

36 
	gTRACE_MASK_WAITS
 = 
TRACE_COMPONENT_MASK_NONE
;

37 
	gTRACE_MASK_DISK
 = 
TRACE_COMPONENT_MASK_NONE
;

38 cÚ¡ 
boŞ
 
	gFLUSH_TO_DISK_ON_FULL
 = 
çl£
;

45 
±h»ad_mu‹x_t
 
	gtu¶e_fifo_¡©s_mu‹x
 = 
th»ad_mu‹x_ü—‹
();

46 
	gİ’_fifo_couÁ
 = 0;

47 
	gtÙ®_fifos_ü—‹d
 = 0;

48 
	gtÙ®_fifos_ex³r›nûd_»ad_wa™
 = 0;

49 
	gtÙ®_fifos_ex³r›nûd_wr™e_wa™
 = 0;

50 
	gtÙ®_fifos_ex³r›nûd_wa™
 = 0;

60 
	gtu¶e_fifo
::
	$İ’_fifos
() {

61  
İ’_fifo_couÁ
;

62 
	}
}

70 
	gtu¶e_fifo
::
	$ş—r_¡©s
() {

71 
ü™iÿl_£ùiÚ_t
 
	`cs
(
tu¶e_fifo_¡©s_mu‹x
);

72 
İ’_fifo_couÁ
 = 0;

73 
tÙ®_fifos_ü—‹d
 = 0;

74 
tÙ®_fifos_ex³r›nûd_»ad_wa™
 = 0;

75 
tÙ®_fifos_ex³r›nûd_wr™e_wa™
 = 0;

76 
	}
}

83 
	gtu¶e_fifo
::
	$Œaû_¡©s
() {

84 
	`TRACE
(
TRACE_ALWAYS
,

86 
	`TRACE
(
TRACE_ALWAYS
,

87 "%du¶e_fifo ü—‹d\n", 
tÙ®_fifos_ü—‹d
);

88 
	`TRACE
(
TRACE_ALWAYS
,

89 "%d cu¼’y o³n\n", 
İ’_fifo_couÁ
);

90 
	`TRACE
(
TRACE_ALWAYS
,

92 ()
tÙ®_fifos_ex³r›nûd_»ad_wa™
/
tÙ®_fifos_ü—‹d
);

93 
	`TRACE
(
TRACE_ALWAYS
,

95 ()
tÙ®_fifos_ex³r›nûd_wr™e_wa™
/
tÙ®_fifos_ü—‹d
);

96 
	}
}

111 
	g£Áš–_·ge_poŞ
 : 
·ge_poŞ
 {

114 
_d©a
[(
qpe
::
·ge
)];

116 
£Áš–_·ge_poŞ
()

117 : 
·ge_poŞ
((
qpe
::
·ge
))

121 
vœtu®
 * 
®loc
() {

122  
_d©a
;

125 
vœtu®
 
ä“
(*) {

134 
£Áš–_·ge_poŞ
 
	gSENTINEL_POOL
;

135 
	gqpe
::
·ge
* 
SENTINEL_PAGE
 = 
qpe
::·ge::
®loc
(1, &
SENTINEL_POOL
);

146 
	gtu¶e_fifo
::
	$š™
() {

149 
tu¶e_fifo_dœeùÜy_t
::
	`İ’_Úû
();

151 
_»ad”_tid
 = 
	`±h»ad_£lf
();

154 
	`_£t_»ad_·ge
(
SENTINEL_PAGE
);

157 
_wr™e_·ge
 = 
SENTINEL_PAGE
;

160 
_¡©e
.
	`Œªs™iÚ
(
tu¶e_fifo_¡©e_t
::
IN_MEMORY
);

163 
ü™iÿl_£ùiÚ_t
 
	`cs
(
tu¶e_fifo_¡©s_mu‹x
);

164 
İ’_fifo_couÁ
++;

165 
tÙ®_fifos_ü—‹d
++;

166 
cs
.
	`ex™
();

167 
	}
}

174 
	gtu¶e_fifo
::
	$wr™”_š™
() {

176 
_wr™”_tid
 = 
	`±h»ad_£lf
();

177 
	}
}

185 
	sä“_·ge
 {

186 
İ”©Ü
()(
	mqpe
::
·ge
* 
p
) {

187 
p
->
ä“
();

197 
	gtu¶e_fifo
::
	$de¡roy
() {

199 
¡d
::
	`fÜ_—ch
(
_·ges
.
	`begš
(), _·ges.
	`’d
(), 
	`ä“_·ge
());

200 
¡d
::
	`fÜ_—ch
(
_ä“_·ges
.
	`begš
(), _ä“_·ges.
	`’d
(), 
	`ä“_·ge
());

203 
ü™iÿl_£ùiÚ_t
 
	`cs
(
tu¶e_fifo_¡©s_mu‹x
);

204 
İ’_fifo_couÁ
--;

205 
boŞ
 
wr™e_wa™
 = 
_num_wa™s_Ú_š£¹
 > 0;

206 
boŞ
 
»ad_wa™
 = 
_num_wa™s_Ú_»move
 > 0;

207 ià(
»ad_wa™
)

208 
tÙ®_fifos_ex³r›nûd_»ad_wa™
++;

209 ià(
wr™e_wa™
)

210 
tÙ®_fifos_ex³r›nûd_wr™e_wa™
++;

211 ià(
»ad_wa™
 || 
wr™e_wa™
)

212 
tÙ®_fifos_ex³r›nûd_wa™
++;

214 
	`TRACE
(
TRACE_MASK_WAITS
 & 
TRACE_ALWAYS
,

216 ()
_num_wa™s_Ú_š£¹
/
_num_š£¹ed
);

217 
	`TRACE
(
TRACE_MASK_WAITS
 & 
TRACE_ALWAYS
,

219 ()
_num_wa™s_Ú_»move
/
_num_»moved
);

220 
	}
}

237 
boŞ
 
	gtu¶e_fifo
::
	$cİy_·ge
(
·ge
* 
d¡
, 
timeout_ms
) {

239 ià(!
	`’su»_»ad_»ady
(
timeout_ms
))

241  
çl£
;

244 
	`as£¹
(
_»ad_™”©Ü
 =ğ
_»ad_·ge
->
	`begš
());

247 
d¡
->
	`ş—r
();

248 
size_t
 
ÿ·c™y
 = 
d¡
->
	`ÿ·c™y
();

249 
size_t
 
i
 = 0; i < 
ÿ·c™y
; i++) {

250 
tu¶e_t
 
tu¶e
;

251 ià(!
	`g‘_tu¶e
(
tu¶e
))

253 
d¡
->
	`­³nd_tu¶e
(
tu¶e
);

257 
_num_»moved
 +ğ
d¡
->
	`tu¶e_couÁ
();

258  
Œue
;

259 
	}
}

273 
boŞ
 
	gtu¶e_fifo
::
	$£nd_eof
() {

274 
Œy
 {

276 
	`_æush_wr™e_·ge
(
Œue
);

277  
Œue
;

279 
	`ÿtch
(
T”mš©edBufãrExû±iÚ
 &
e
) {

281  
çl£
;

283 
	}
}

301 
boŞ
 
	gtu¶e_fifo
::
	$‹rmš©e
() {

304 
ü™iÿl_£ùiÚ_t
 
	`cs
(
_lock
);

311 if(
	`is_‹rmš©ed
(è|| 
	`is_dÚe_wr™šg
())

312  
çl£
;

316 
_¡©e
.
	`Œªs™iÚ
(
tu¶e_fifo_¡©e_t
::
TERMINATED
);

317 
	`th»ad_cÚd_sigÇl
(
_»ad”_nÙify
);

318 
	`th»ad_cÚd_sigÇl
(
_wr™”_nÙify
);

321  
Œue
;

322 
	}
}

328 
šlše
 
	gtu¶e_fifo
::
	$wa™_fÜ_»ad”
() {

329 
_num_wa™s_Ú_š£¹
++;

330 
	`th»ad_cÚd_wa™
(
_wr™”_nÙify
, 
_lock
);

331 
	}
}

333 
šlše
 
	gtu¶e_fifo
::
	$’su»_»ad”_ruÂšg
() {

334 
	`th»ad_cÚd_sigÇl
(
_»ad”_nÙify
);

335 
	}
}

337 
šlše
 
boŞ
 
	gtu¶e_fifo
::
	$wa™_fÜ_wr™”
(
timeout_ms
) {

338 
_num_wa™s_Ú_»move
++;

339  
	`th»ad_cÚd_wa™
(
_»ad”_nÙify
, 
_lock
, 
timeout_ms
);

340 
	}
}

342 
šlše
 
	gtu¶e_fifo
::
	$’su»_wr™”_ruÂšg
() {

343 
	`th»ad_cÚd_sigÇl
(
_wr™”_nÙify
);

344 
	}
}

353 
	gtu¶e_fifo
::
	$_æush_wr™e_·ge
(
boŞ
 
dÚe_wr™šg
) {

356 
	`as£¹
(!
	`is_dÚe_wr™šg
());

359 
ü™iÿl_£ùiÚ_t
 
	`cs
(
_lock
);

360 
	`_‹rmš©iÚ_check
();

363 
_¡©e
.
	`cu¼’t
()) {

364 
tu¶e_fifo_¡©e_t
::
IN_MEMORY
: {

369 ià(!
FLUSH_TO_DISK_ON_FULL
) {

374 
size_t
 
th»shŞd
=1;

375 
	`_avaabË_š_memÜy_wr™es
(è< 
th»shŞd
;h»shŞd = 
_th»shŞd
) {

377 
	`wa™_fÜ_»ad”
();

378 
	`_‹rmš©iÚ_check
();

387 ià(
	`_avaabË_š_memÜy_wr™es
() >= 1) {

391 if(!
_wr™e_·ge
->
	`em±y
()) {

392 
_·ges
.
	`push_back
(
_wr™e_·ge
.
	`»Ëa£
());

393 
_·ges_š_memÜy
++;

394 
_·ges_š_fifo
++;

398 if(
dÚe_wr™šg
) {

402 
_¡©e
.
	`Œªs™iÚ
(
tu¶e_fifo_¡©e_t
::
IN_MEMORY_DONE_WRITING
);

403 
_wr™e_·ge
.
	`dÚe
();

406 
_wr™e_·ge
 = 
	`_®loc_·ge
();

409 if(
	`_avaabË_š_memÜy_»ads
(è>ğ
_th»shŞd
 || 
	`is_dÚe_wr™šg
())

410 
	`’su»_»ad”_ruÂšg
();

418 
c_¡r
 
f•©h
 = 
tu¶e_fifo_dœeùÜy_t
::
	`g’”©e_f•©h
(
_fifo_id
);

419 
_·ge_fe
 = 
	`fİ’
(
f•©h
.
	`d©a
(), "w+");

420 
	`as£¹
(
_·ge_fe
 !ğ
NULL
);

421 ià(
_·ge_fe
 =ğ
NULL
)

422 
	`THROW2
(
FeExû±iÚ
,

423 "fİ’(%sèçed", 
f•©h
.
	`d©a
());

424 
	`TRACE
(
TRACE_ALWAYS
, "Createduple_fifo file %s\n",

425 
f•©h
.
	`d©a
());

429 if(!
_wr™e_·ge
->
	`em±y
()) {

430 
_·ges
.
	`push_back
(
_wr™e_·ge
.
	`»Ëa£
());

431 
_·ges_š_memÜy
++;

432 
_·ges_š_fifo
++;

434 
·ge_li¡
::
™”©Ü
 
™
 = 
_·ges
.
	`begš
(); iˆ!ğ_·ges.
	`’d
(); ) {

435 
qpe
::
·ge
* 
p
 = *
™
;

436 
p
->
	`fwr™e_fuÎ_·ge
(
_·ge_fe
);

439 
p
->
	`ş—r
();

440 
_ä“_·ges
.
	`push_back
(
p
);

441 
™
 = 
_·ges
.
	`”a£
(it);

443 
	`as£¹
(
_·ges_š_memÜy
 > 0);

444 
_·ges_š_memÜy
--;

446 
	`fæush
(
_·ge_fe
);

449 
	`as£¹
(
_fe_h—d_·ge
 == 0);

450 
_fe_h—d_·ge
 = 
_Ãxt_·ge
;

452 
_¡©e
.
	`Œªs™iÚ
(
tu¶e_fifo_¡©e_t
::
ON_DISK
);

453 ià(
dÚe_wr™šg
) {

455 
_¡©e
.
	`Œªs™iÚ
(
tu¶e_fifo_¡©e_t
::
ON_DISK_DONE_WRITING
);

456 
_wr™e_·ge
.
	`dÚe
();

460 
	`as£¹
(!
_ä“_·ges
.
	`em±y
());

461 
_wr™e_·ge
 = 
	`_®loc_·ge
();

470 ià(
_»ad_·ge
 =ğ
SENTINEL_PAGE
) {

471 
	`_£t_»ad_·ge
(
	`_®loc_·ge
());

478 if(
	`_avaabË_fifo_»ads
(è>ğ
_th»shŞd
 || 
	`is_dÚe_wr™šg
())

479 
	`’su»_»ad”_ruÂšg
();

485 
tu¶e_fifo_¡©e_t
::
ON_DISK
: {

487 
f£ek_»t
 = 
	`f£ek
(
_·ge_fe
, 0, 
SEEK_END
);

488 
	`as£¹
(!
f£ek_»t
);

489 ià(
f£ek_»t
)

490 
	`THROW1
(
FeExû±iÚ
, "fseeko EOF");

491 
_wr™e_·ge
->
	`fwr™e_fuÎ_·ge
(
_·ge_fe
);

492 
	`fæush
(
_·ge_fe
);

493 
_·ges_š_fifo
++;

495 ià(
dÚe_wr™šg
) {

496 
_¡©e
.
	`Œªs™iÚ
(
tu¶e_fifo_¡©e_t
::
ON_DISK_DONE_WRITING
);

497 
_wr™e_·ge
.
	`dÚe
();

501 
_wr™e_·ge
->
	`ş—r
();

505 if(
	`_avaabË_fifo_»ads
(è>ğ
_th»shŞd
 || 
	`is_dÚe_wr™šg
())

506 
	`’su»_»ad”_ruÂšg
();

512 
	`uÄ—chabË
();

518 
	}
}

534 
	gtu¶e_fifo
::
	$_g‘_»ad_·ge
(
timeout_ms
) {

537 
ü™iÿl_£ùiÚ_t
 
	`cs
(
_lock
);

538 
	`_‹rmš©iÚ_check
();

542 ià(
	`is_š_memÜy
(è&& (
_»ad_·ge
 !ğ
SENTINEL_PAGE
)) {

546 
_»ad_·ge
->
	`ş—r
();

547 
_ä“_·ges
.
	`push_back
(
_»ad_·ge
.
	`»Ëa£
());

548 
	`_£t_»ad_·ge
(
SENTINEL_PAGE
);

556 
size_t
 
t
=1;

557 (
timeout_ms
 >ğ0è&& !
	`is_dÚe_wr™šg
(è&& (
	`_avaabË_fifo_»ads
(è< 
t
);

558 
t
 = 
_th»shŞd
) {

560 if(!
	`wa™_fÜ_wr™”
(
timeout_ms
))

563 
	`_‹rmš©iÚ_check
();

567 
	`TRACE
(
TRACE_ALWAYS
&
TRACE_MASK_DISK
,

568 "avaabË„—d ğ%d\n", ()
	`_avaabË_fifo_»ads
());

569 if(
	`_avaabË_fifo_»ads
() == 0) {

573 if(
	`is_dÚe_wr™šg
()) {

575 
	`TRACE
(
TRACE_ALWAYS
&
TRACE_MASK_DISK
, "Returning -1\n");

578 if(
timeout_ms
 != 0)

581 
	`uÄ—chabË
();

585 
_¡©e
.
	`cu¼’t
()) {

586 
tu¶e_fifo_¡©e_t
::
IN_MEMORY
:

587 
tu¶e_fifo_¡©e_t
::
IN_MEMORY_DONE_WRITING
: {

589 
	`as£¹
(!
_·ges
.
	`em±y
());

590 
	`_£t_»ad_·ge
(
_·ges
.
	`äÚt
());

591 
_·ges
.
	`pİ_äÚt
();

592 
	`as£¹
(
_·ges_š_memÜy
 > 0);

593 
_·ges_š_memÜy
--;

596 
tu¶e_fifo_¡©e_t
::
ON_DISK
:

597 
tu¶e_fifo_¡©e_t
::
ON_DISK_DONE_WRITING
: {

604 ià(
_»ad_·ge
 =ğ
SENTINEL_PAGE
)

605 
	`_£t_»ad_·ge
(
	`_®loc_·ge
());

608 
_»ad_·ge
->
	`ş—r
();

609 
	`_£t_»ad_·ge
(
_»ad_·ge
.
	`»Ëa£
());

615 
	`as£¹
(
_»ad_·ge
 !ğ
SENTINEL_PAGE
);

616 
	`as£¹
(
_»ad_·ge
->
	`·ge_size
(è=ğ
m®loc_·ge_poŞ
::
	`š¡ªû
()->page_size());

620 
_»ad_·ge
->
	`ş—r
();

621 
	`TRACE
(
TRACE_ALWAYS
&
TRACE_MASK_DISK
, "_Ãxt_·gğ%d\n", ()
_Ãxt_·ge
);

622 
	`TRACE
(
TRACE_ALWAYS
&
TRACE_MASK_DISK
, "_fe_h—d_·gğ%d\n", ()
_fe_h—d_·ge
);

623 
£ek_pos
 =

624 (
_Ãxt_·ge
 - 
_fe_h—d_·ge
è* 
	`g‘_deçuÉ_·ge_size
();

625 
	`TRACE
(
TRACE_ALWAYS
&
TRACE_MASK_DISK
, "f£ekØ%lu\n", 
£ek_pos
);

626 
f£ek_»t
 = 
	`f£ek
(
_·ge_fe
, 
£ek_pos
, 
SEEK_SET
);

627 
	`as£¹
(!
f£ek_»t
);

628 ià(
f£ek_»t
)

629 
	`THROW2
(
FeExû±iÚ
, "f£ekØ%lu", 
£ek_pos
);

630 
ä—d_»t
 = 
_»ad_·ge
->
	`ä—d_fuÎ_·ge
(
_·ge_fe
);

631 
	`as£¹
(
ä—d_»t
);

632 
	`_£t_»ad_·ge
(
_»ad_·ge
.
	`»Ëa£
());

635 
size_t
 
·ge_size
 = 
_»ad_·ge
->
	`·ge_size
();

636 ià(
TRACE_ALWAYS
&
TRACE_MASK_DISK
) {

637 
·ge
* 
pg
 = 
_»ad_·ge
.
	`»Ëa£
();

638 * 
pg_by‹s
 = (*)
pg
;

639 
size_t
 
i
 = 0; i < 
·ge_size
; i++) {

640 
	`´štf
("%02x", 
pg_by‹s
[
i
]);

641 ià(
i
 % 2 == 0)

642 
	`´štf
("\t");

643 ià(
i
 % 16 == 0)

644 
	`´štf
("\n");

646 
	`_£t_»ad_·ge
(
pg
);

649 
	`TRACE
(
TRACE_ALWAYS
&
TRACE_MASK_DISK
, "Read %d %d-byteuples\n",

650 ()
_»ad_·ge
->
	`tu¶e_couÁ
(),

651 ()
_»ad_·ge
->
	`tu¶e_size
());

656 
	`uÄ—chabË
();

660 
	`as£¹
(
_·ges_š_fifo
 > 0);

661 
_·ges_š_fifo
--;

662 
_Ãxt_·ge
++;

666 if(!
FLUSH_TO_DISK_ON_FULL


667 && (
	`_avaabË_š_memÜy_wr™es
(è>ğ
_th»shŞd
)

668 && !
	`is_dÚe_wr™šg
())

669 
	`’su»_wr™”_ruÂšg
();

674 
	}
}

678 
	$tu¶e_fifo_g’”©e_id
() {

679 
acouÁ”_t
 
Ãxt_fifo_id
;

680  
Ãxt_fifo_id
.
	`ãtch_ªd_šc
();

681 
	}
}

685 
	gtu¶e_fifo
::
tu¶e_fifo_¡©e_t
::
	$Œªs™iÚ
(cÚ¡ 
_tu¶e_fifo_¡©e_t
 
Ãxt
) {

686 ià(
	`_Œªs™iÚ_ok
(
Ãxt
))

687 
_v®ue
 = 
Ãxt
;

689 
	`TRACE
(
TRACE_ALWAYS
, "Invalidransition from %so %s\n",

690 
	`to_¡ršg
().
	`d©a
(),

691 
	`¡©e_to_¡ršg
(
Ãxt
).
	`d©a
());

692 
	`as£¹
(0);

694 
	}
}

698 
boŞ
 
	gtu¶e_fifo
::
tu¶e_fifo_¡©e_t
::
	$_Œªs™iÚ_ok
(cÚ¡ 
_tu¶e_fifo_¡©e_t
 
Ãxt
) {

699 
_v®ue
) {

700 
INVALID
:

703  
Ãxt
 =ğ
IN_MEMORY
;

704 
IN_MEMORY
:

706 (
Ãxt
 =ğ
IN_MEMORY_DONE_WRITING
)

707 || (
Ãxt
 =ğ
ON_DISK
)

708 || (
Ãxt
 =ğ
TERMINATED
);

709 
ON_DISK
:

711 (
Ãxt
 =ğ
ON_DISK_DONE_WRITING
)

712 || (
Ãxt
 =ğ
TERMINATED
);

714  
çl£
;

716 
	}
}

720 
EXIT_NAMESPACE
(
qpe
);

	@src/qpipe/core/tuple_fifo_directory.cpp

24 
	~"ut/th»ad.h
"

25 
	~"ut/sync.h
"

26 
	~"ut/feİs.h
"

27 
	~"qpe/cÜe/tu¶e_fifo_dœeùÜy.h
"

29 
	~<sys/ty³s.h
>

30 
	~<dœ’t.h
>

31 
	~<uni¡d.h
>

35 
ENTER_NAMESPACE
(
qpe
);

38 
±h»ad_mu‹x_t


39 
	gtu¶e_fifo_dœeùÜy_t
::
_dœ_mu‹x
 = 
PTHREAD_MUTEX_INITIALIZER
;

41 
	gtu¶e_fifo_dœeùÜy_t
::
dœ_¡©e_t


42 
tu¶e_fifo_dœeùÜy_t
::
_dœ_¡©e
 = 
TUPLE_FIFO_DIRECTORY_FIRST
;

44 
c_¡r


45 
	gtu¶e_fifo_dœeùÜy_t
::
_dœ_·th
 = 
c_¡r
("temp");

49 cÚ¡ 
	gc_¡r
& 
	gtu¶e_fifo_dœeùÜy_t
::
	$dœ_·th
() {

51  
_dœ_·th
;

52 
	}
}

56 
	gtu¶e_fifo_dœeùÜy_t
::
	$İ’_Úû
()

58 
ü™iÿl_£ùiÚ_t
 
	`cs
(
_dœ_mu‹x
);

59 ià(
_dœ_¡©e
 !ğ
TUPLE_FIFO_DIRECTORY_FIRST
)

62 cÚ¡ 
c_¡r
& 
·th
 = 
	`dœ_·th
();

63 ià(
	`feİs_check_fe_dœeùÜy
(
·th
.
	`d©a
()))

64 
	`THROW2
(
Tu¶eFifoDœeùÜyExû±iÚ
,

66 
·th
.
	`d©a
());

68 ià(
	`feİs_check_dœeùÜy_acûssibË
(
·th
.
	`d©a
()))

69 
	`THROW2
(
Tu¶eFifoDœeùÜyExû±iÚ
,

71 
·th
.
	`d©a
());

73 
	`ş—n_dœ
();

75 
_dœ_¡©e
 = 
TUPLE_FIFO_DIRECTORY_OPEN
;

76 
	}
}

80 
	gtu¶e_fifo_dœeùÜy_t
::
	$şo£
() {

82 
ü™iÿl_£ùiÚ_t
 
	`cs
(
_dœ_mu‹x
);

83 ià(
_dœ_¡©e
 !ğ
TUPLE_FIFO_DIRECTORY_OPEN
)

86 
	`ş—n_dœ
();

88 
_dœ_¡©e
 = 
TUPLE_FIFO_DIRECTORY_CLOSED
;

89 
	}
}

93 
c_¡r
 
	gtu¶e_fifo_dœeùÜy_t
::
	$g’”©e_f•©h
(
id
) {

94  
	`c_¡r
("%s/tu¶e_fifo_%d", 
	`dœ_·th
().
	`d©a
(), 
id
);

95 
	}
}

99 
boŞ
 
	gtu¶e_fifo_dœeùÜy_t
::
	$f’ame_f‹r
(cÚ¡ * 
·th
) {

100 
id
;

101  
	`ssÿnf
(
·th
, "tu¶e_fifo_%d", &
id
) == 1;

102 
	}
}

106 
	gtu¶e_fifo_dœeùÜy_t
::
	$ş—n_dœ
() {

108 
DIR
* 
dœ
 = 
	`İ’dœ
(
	`dœ_·th
().
	`d©a
());

109 ià(
dœ
 =ğ
NULL
)

110 
	`THROW2
(
Tu¶eFifoDœeùÜyExû±iÚ
,

111 "İ’dœ(%sèçed", 
	`dœ_·th
().
	`d©a
());

115 
dœ’t
* 
dšfo
 = 
	`»addœ
(
dœ
);

116 ià(
dšfo
 =ğ
NULL
)

120 cÚ¡ * 
f’ame
 = 
dšfo
->
d_Çme
;

121 ià(!
	`f’ame_f‹r
(
f’ame
))

127 
c_¡r
 
	`f•©h
("%s/%s", 
	`dœ_·th
().
	`d©a
(), 
f’ame
);

128 ià(
	`uÆšk
(
f•©h
.
	`d©a
()))

129 
	`THROW2
(
Tu¶eFifoDœeùÜyExû±iÚ
,

130 "uÆšk(%sèçed", 
f•©h
.
	`d©a
());

133 
	`TRACE
(
TRACE_ALWAYS
, "Deleting olduple_fifo file %s\n",

134 
f•©h
.
	`d©a
());

137 ià(
	`şo£dœ
(
dœ
))

138 
	`THROW2
(
Tu¶eFifoDœeùÜyExû±iÚ
,

139 "şo£dœ(%sèçed", 
	`dœ_·th
().
	`d©a
());

140 
	}
}

144 
EXIT_NAMESPACE
(
qpe
);

	@src/qpipe/scheduler/cpu.cpp

31 
	~"ut.h
"

32 
	~"qpe/scheduËr/ıu.h
"

33 
	~"qpe/scheduËr/ıu_¡ruù.h
"

34 
	~"qpe/scheduËr/os_suµÜt.h
"

37 
ENTER_NAMESPACE
(
qpe
);

52 
	$ıu_bšd_£lf
(
ıu_t
 
ıu
)

57 #ifdeà
FOUND_LINUX


65 iàĞ
	`sched_£ffš™y
(0, (
os_ıu_£t_t
), &
ıu
->
ıu_£t
) )

66 
throw
 
	`EXCEPTION2
(
QPeExû±iÚ
,

68 
	`”ºo_to_¡r
().
	`d©a
());

87 iàĞ
	`´oûssÜ_bšd
(
P_LWPID
, 
P_MYID
, 
ıu
->
ıu_id
, 
NULL
) )

88 
	`THROW2
(
QPeExû±iÚ
,

90 
	`”ºo_to_¡r
().
	`d©a
());

95 
	`THROW1
(
QPeExû±iÚ
,

98 
	}
}

101 
	$ıu_g‘_unique_id
(
ıu_t
 
ıu
) {

102  
ıu
->
ıu_unique_id
;

103 
	}
}

105 
EXIT_NAMESPACE
(
qpe
);

	@src/qpipe/scheduler/cpu_set.cpp

29 
	~<c¡dlib
>

30 
	~<c¡ršg
>

31 
	~<uni¡d.h
>

32 
	~<û¼no
>

34 
	~"ut.h
"

35 
	~"qpe/scheduËr/ıu_£t.h
"

36 
	~"qpe/scheduËr/ıu_£t_¡ruù.h
"

37 
	~"qpe/scheduËr/os_suµÜt.h
"

39 
ENTER_NAMESPACE
(
qpe
);

44 #ifdeà
FOUND_LINUX


46 
ıu_£t_cİy
Ğ
os_ıu_£t_t
* 
d¡
, os_ıu_£t_t* 
¤c
 );

47 
ıu_£t_š™_Lšux
(
ıu_£t_p
 
ıu_£t
);

53 
ıu_£t_š™_SŞ¬is
(
ıu_£t_p
 
ıu_£t
);

74 
	$ıu_£t_š™
(
ıu_£t_p
 
ıu_£t
)

77 #ifdeà
FOUND_LINUX


79 
	`ıu_£t_š™_Lšux
Ğ
ıu_£t
 );

85 
	`ıu_£t_š™_SŞ¬is
Ğ
ıu_£t
 );

88 
	}
}

101 
	$ıu_£t_g‘_num_ıus
(
ıu_£t_p
 
ıu_£t
)

104 iàĞ
ıu_£t
 =ğ
NULL
 )

105 
	`THROW1
(
QPeExû±iÚ
, "Called with NULL cpu_set_t");

107  
ıu_£t
->
ıu£t_num_ıus
;

108 
	}
}

124 
ıu_t
 
	$ıu_£t_g‘_ıu
(
ıu_£t_p
 
ıu_£t
, 
šdex
)

128 iàĞ
ıu_£t
 =ğ
NULL
 )

129 
	`THROW1
(
QPeExû±iÚ
, "Called with NULL cpu_set_t");

131 iàĞ
šdex
 < 0 )

132 
	`THROW2
(
OutOfRªge
, "C®Ëd w™h‚eg©ivšdex %d\n", 
šdex
);

133 iàĞ
šdex
 >ğ
ıu_£t
->
ıu£t_num_ıus
 )

134 
	`THROW3
(
OutOfRªge
,

136 
šdex
,

137 
ıu_£t
->
ıu£t_num_ıus
);

139  &
ıu_£t
->
ıu£t_ıus
[
šdex
];

140 
	}
}

153 
	$ıu_£t_fšish
(
ıu_£t_p
 
ıu_£t
)

155 
ıu_£t
->
ıu£t_num_ıus
 = 0;

156 
	`ä“
Ğ
ıu_£t
->
ıu£t_ıus
 );

157 
ıu_£t
->
ıu£t_ıus
 = 
NULL
;

158 
	}
}

164 #ifdeà
FOUND_LINUX


177 
	$ıu_£t_cİy
Ğ
os_ıu_£t_t
* 
d¡
, os_ıu_£t_t* 
¤c
 )

179 
i
;

181 
	`CPU_ZERO
Ğ
d¡
 );

182 
i
 = 0; i < 
CPU_SETSIZE
; i++)

183 iàĞ
	`CPU_ISSET
(
i
, 
¤c
) )

184 
	`CPU_SET
(
i
, 
d¡
);

185 
	}
}

195 
	$ıu_£t_š™_Lšux
(
ıu_£t_p
 
ıu_£t
)

198 
i
;

199 
os_ıu_£t_t
 
Üigš®_affš™y_£t
;

200 
num_ıus
 = 
	`syscÚf
(
_SC_NPROCESSORS_CONF
);

205 iàĞ
	`sched_g‘affš™y
Ğ0, (
os_ıu_£t_t
), &
Üigš®_affš™y_£t
 ) )

206 
throw
 
	`EXCEPTION2
(
Th»adExû±iÚ
,

208 
	`”ºo_to_¡r
().
	`d©a
());

211 iàĞ
	`sched_£ffš™y
Ğ0, (
os_ıu_£t_t
), &
Üigš®_affš™y_£t
 ) )

212 
throw
 
	`EXCEPTION2
(
Th»adExû±iÚ
,

214 
	`”ºo_to_¡r
().
	`d©a
());

218 
ıu_t
 
ıus
 =

219 (
ıu_t
)
	`m®loc
Ğ
num_ıus
 * (
ıu_s
) );

220 iàĞ
ıus
 =ğ
NULL
 )

221 
throw
 
	`EXCEPTION1
(
BadAÎoc
, "cpu‡rray");

223 
i
 = 0; i < 
num_ıus
; i++)

225 
	`CPU_ZERO
Ğ&
ıus
[
i
].
ıu_£t
 );

230 
num_found
 = 0;

231 
ıu_num
;

232 
ıu_num
 = 0; ; cpu_num++)

234 
os_ıu_£t_t
 
‹¡_£t
;

235 
	`CPU_ZERO
Ğ&
‹¡_£t
 );

236 
	`CPU_SET
 ( 
ıu_num
, &
‹¡_£t
 );

238 iàĞ!
	`sched_£ffš™y
Ğ0, (
os_ıu_£t_t
), &
‹¡_£t
 ) )

241 
ıus
[
num_found
].
ıu_unique_id
 = 
ıu_num
;

242 
	`ıu_£t_cİy
Ğ&
ıus
[
num_found
].
ıu_£t
, &
‹¡_£t
 );

243 
num_found
++;

244 iàĞ
num_found
 =ğ
num_ıus
 )

252 iàĞ
	`sched_£ffš™y
Ğ0, (
os_ıu_£t_t
), &
Üigš®_affš™y_£t
 ) )

253 
throw
 
	`EXCEPTION2
(
Th»adExû±iÚ
,

255 
	`”ºo_to_¡r
().
	`d©a
());

259 
ıu_£t
->
ıu£t_num_ıus
 = 
num_ıus
;

260 
ıu_£t
->
ıu£t_ıus
 = 
ıus
;

261 
	}
}

276 
	$ıu_£t_š™_SŞ¬is
(
ıu_£t_p
 
ıu_£t
)

279 
i
;

280 
num_ıus
 = 
	`syscÚf
(
_SC_NPROCESSORS_ONLN
);

284 
ıu_t
 
ıus
 =

285 (
ıu_t
)
	`m®loc
Ğ
num_ıus
 * (
ıu_s
) );

286 iàĞ
ıus
 =ğ
NULL
 )

287 
	`THROW
(
BadAÎoc
);

289 
i
 = 0; i < 
num_ıus
; i++)

292 
	`mem£t
Ğ&
ıus
[
i
], 0, (
ıu_s
) );

297 
num_found
 = 0;

298 
ıu_num
;

299 
ıu_num
 = 0; ; cpu_num++)

301 
¡©us
 = 
	`p_Úlše
(
ıu_num
, 
P_STATUS
);

302 iàĞ(
¡©us
 =ğ-1è&& (
”ºo
 =ğ
EINVAL
) )

306 
ıus
[
num_found
].
ıu_unique_id
 = 
ıu_num
;

307 
ıus
[
num_found
].
ıu_id
 = 
ıu_num
;

308 iàĞ
	`´oûssÜ_šfo
Ğ
ıu_num
, &
ıus
[
num_found
].
ıu_´oc_šfo
 ) ) {

309 
	`ä“
(
ıus
);

310 
	`THROW4
(
Th»adExû±iÚ
,

312 
	`”ºo_to_¡r
().
	`d©a
(),

313 
ıu_num
+1,

314 
num_ıus
);

317 
num_found
++;

318 iàĞ
num_found
 =ğ
num_ıus
 )

324 
ıu_£t
->
ıu£t_num_ıus
 = 
num_ıus
;

325 
ıu_£t
->
ıu£t_ıus
 = 
ıus
;

326 
	}
}

333 
EXIT_NAMESPACE
(
qpe
);

	@src/qpipe/stages/aggregate.cpp

24 
	~"qpe/¡ages/agg»g©e.h
"

26 
ENTER_NAMESPACE
(
qpe
);

29 cÚ¡ 
c_¡r
 
	gagg»g©e_·ck‘_t
::
PACKET_TYPE
 = "AGGREGATE";

31 cÚ¡ 
c_¡r
 
	gagg»g©e_¡age_t
::
DEFAULT_STAGE_NAME
 = "AGGREGATE_STAGE";

34 
	gagg»g©e_¡age_t
::
	$´oûss_·ck‘
()

36 
ad­tÜ_t
* 
ad­tÜ
 = 
_ad­tÜ
;

37 
agg»g©e_·ck‘_t
* 
·ck‘
 = (agg»g©e_·ck‘_t*)
ad­tÜ
->
	`g‘_·ck‘
();

40 
tu¶e_agg»g©e_t
* 
agg»g©e
 = 
·ck‘
->
_agg»g©Ü
;

41 
key_exŒaùÜ_t
* 
exŒaù
 = 
·ck‘
->
_exŒaù
;

42 
tu¶e_fifo
* 
šput_bufãr
 = 
·ck‘
->
_šput_bufãr
;

43 
di¥©ch”_t
::
	`di¥©ch_·ck‘
(
·ck‘
->
_šput
);

47 
size_t
 
de¡_size
 = 
·ck‘
->
	`ouut_bufãr
()->
	`tu¶e_size
();

48 
¬¿y_gu¬d_t
<> 
de¡_d©a
 = 
Ãw
 [
de¡_size
];

49 
tu¶e_t
 
	`de¡
(
de¡_d©a
, 
de¡_size
);

52 
size_t
 
agg_size
 = 
agg»g©e
->
	`tu¶e_size
();

53 
¬¿y_gu¬d_t
<> 
agg_d©a
 = 
Ãw
 [
agg_size
];

54 
tu¶e_t
 
	`agg
(
agg_d©a
, 
agg_size
);

56 
size_t
 
key_size
 = 
exŒaù
->
	`key_size
();

57 * 
Ï¡_key
 = 
agg»g©e
->
	`key_exŒaùÜ
()->
	`exŒaù_key
(
agg_d©a
);

59 
i
 = 0;

60 
boŞ
 
fœ¡
 = 
Œue
;

64 
tu¶e_t
 
¤c
;

65 if(!
šput_bufãr
->
	`g‘_tu¶e
(
¤c
))

71 cÚ¡ * 
key
 = 
exŒaù
->
	`exŒaù_key
(
¤c
);

74 if(
fœ¡
 ||

75 (
key_size
 && 
	`memcmp
(
Ï¡_key
, 
key
, key_size))) {

77 if(!
fœ¡
) {

78 
agg»g©e
->
	`fšish
(
de¡
, 
agg
.
d©a
);

79 
	`TRACE
(0&
TRACE_ALWAYS
, "key_sizğ%d\n", 
key_size
);

80 
ad­tÜ
->
	`ouut
(
de¡
);

83 
agg»g©e
->
	`š™
(
agg
.
d©a
);

84 
	`memıy
(
Ï¡_key
, 
key
, 
key_size
);

85 
fœ¡
 = 
çl£
;

88 
agg»g©e
->
	`agg»g©e
(
agg
.
d©a
, 
¤c
);

89 
i
++;

93 if(!
fœ¡
) {

94 
agg»g©e
->
	`fšish
(
de¡
, 
agg
.
d©a
);

95 
ad­tÜ
->
	`ouut
(
de¡
);

97 
	}
}

100 
EXIT_NAMESPACE
(
qpe
);

	@src/qpipe/stages/bnl_in.cpp

24 
	~"qpe/¡ages/bÆ_š.h
"

26 
	~<c¡ršg
>

27 
	~<b™£t
>

29 
usšg
 
	g¡d
::
b™£t
;

33 cÚ¡ 
c_¡r
 
	gbÆ_š_·ck‘_t
::
PACKET_TYPE
 = "BNL_IN";

37 cÚ¡ 
c_¡r
 
	gbÆ_š_¡age_t
::
DEFAULT_STAGE_NAME
 = "BNL_IN_STAGE";

47 
	gbÆ_š_¡age_t
::
	$´oûss_·ck‘
() {

49 
ad­tÜ_t
* 
ad­tÜ
 = 
_ad­tÜ
;

50 
bÆ_š_·ck‘_t
* 
·ck‘
 = (bÆ_š_·ck‘_t*)
ad­tÜ
->
	`g‘_·ck‘
();

53 
tu¶e_fifo
* 
Ëá_bufãr
 = 
·ck‘
->
_Ëá_bufãr
;

54 
tu¶e_sourû_t
* 
right_sourû
 = 
·ck‘
->
_right_sourû
;

55 
key_com·»_t
* 
_com·»
 = 
·ck‘
->_compare;

56 
key_exŒaùÜ_t
* 
_exŒaù
 = 
·ck‘
->_extract;

57 
tu¶e_com·¿tÜ_t
 
	`com·»
(
_exŒaù
, 
_com·»
);

58 
boŞ
 
ouut_Ú_m©ch
 = 
·ck‘
->
_ouut_Ú_m©ch
;

62 
	`TRACE
(
TRACE_ALWAYS
,

64 
di¥©ch”_t
::
	`di¥©ch_·ck‘
(
·ck‘
->
_Ëá
);

67 
gu¬d
<
qpe
::
·ge
> 
ou‹r_tu¶e_·ge
 = qpe::·ge::
	`®loc
(
Ëá_bufãr
->
	`tu¶e_size
());

68 
gu¬d
<
qpe
::
·ge
> 
šÃr_tu¶e_·ge
 = qpe::·ge::
	`®loc
(
right_sourû
->
	`tu¶e_size
());

74 ià(!
Ëá_bufãr
->
	`cİy_·ge
(
ou‹r_tu¶e_·ge
))

81 
b™£t
<2048> 
m©ches
;

82 
	`as£¹
(
ou‹r_tu¶e_·ge
->
	`tu¶e_couÁ
(è<ğ
m©ches
.
	`size
());

86 
·ck‘_t
* 
right_·ck‘
 = 
right_sourû
->
	`»£t
();

87 
tu¶e_fifo
* 
right_bufãr
 = 
right_·ck‘
->
	`ouut_bufãr
();

88 
	`TRACE
(
TRACE_ALWAYS
,

90 
di¥©ch”_t
::
	`di¥©ch_·ck‘
(
right_·ck‘
);

97 ià(!
right_bufãr
->
	`cİy_·ge
(
šÃr_tu¶e_·ge
))

105 
qpe
::
·ge
::
™”©Ü
 
o_™
 = 
ou‹r_tu¶e_·ge
->
	`begš
();

106 
o_šdex
 = 0; 
o_™
 !ğ
ou‹r_tu¶e_·ge
->
	`’d
(); ++o_index) {

110 
tu¶e_t
 
ou‹r_tu¶e
 = 
o_™
.
	`advªû
();

111 
hšt_tu¶e_·œ_t


112 
	`ou‹r_kaœ
(
_exŒaù
->
	`exŒaù_hšt
(
ou‹r_tu¶e
), ou‹r_tu¶e.
d©a
);

115 
qpe
::
·ge
::
™”©Ü
 
i_™
 = 
šÃr_tu¶e_·ge
->
	`begš
();

116 
i_™
 !ğ
šÃr_tu¶e_·ge
->
	`’d
()) {

120 
tu¶e_t
 
šÃr_tu¶e
 = 
i_™
.
	`advªû
();

121 
hšt_tu¶e_·œ_t


122 
	`šÃr_kaœ
(
_exŒaù
->
	`exŒaù_hšt
(
šÃr_tu¶e
), iÂ”_tu¶e.
d©a
);

125 iàĞ
	`com·»
(
ou‹r_kaœ
, 
šÃr_kaœ
) == 0 )

127 
m©ches
.
	`£t
(
o_šdex
);

139 
qpe
::
·ge
::
™”©Ü
 
o_™
 = 
ou‹r_tu¶e_·ge
->
	`begš
();

140 
o_šdex
 = 0; 
o_™
 !ğ
ou‹r_tu¶e_·ge
->
	`’d
(); ++o_index) {

141 iàĞ
m©ches
[
o_šdex
] !ğ
ouut_Ú_m©ch
 )

142 
_ad­tÜ
->
	`ouut
(
o_™
.
	`advªû
());

147 
	}
}

	@src/qpipe/stages/bnl_join.cpp

24 
	~"qpe/¡ages/bÆ_još.h
"

26 
	~<c¡ršg
>

30 cÚ¡ 
c_¡r
 
	gbÆ_još_·ck‘_t
::
PACKET_TYPE
 = "BNL_JOIN";

34 cÚ¡ 
c_¡r
 
	gbÆ_još_¡age_t
::
DEFAULT_STAGE_NAME
 = "BNL_JOIN_STAGE";

44 
	gbÆ_još_¡age_t
::
	$´oûss_·ck‘
() {

46 
ad­tÜ_t
* 
ad­tÜ
 = 
_ad­tÜ
;

47 
bÆ_još_·ck‘_t
* 
·ck‘
 = (bÆ_još_·ck‘_t*)
ad­tÜ
->
	`g‘_·ck‘
();

49 
tu¶e_fifo
* 
Ëá_bufãr
 = 
·ck‘
->
_Ëá_bufãr
;

50 
tu¶e_sourû_t
* 
right_sourû
 = 
·ck‘
->
_right_sourû
;

51 
tu¶e_još_t
* 
još
 = 
·ck‘
->
_još
;

55 
	`TRACE
(
TRACE_ALWAYS
,

57 
di¥©ch”_t
::
	`di¥©ch_·ck‘
(
·ck‘
->
_Ëá
);

61 
size_t
 
key_size
 = 
još
->
	`key_size
();

62 
¬¿y_gu¬d_t
<> 
ouut_d©a
 = 
Ãw
 [
još
->
	`ouut_tu¶e_size
()];

63 
tu¶e_t
 
	`ouut_tu¶e
(
ouut_d©a
, (output_data));

66 
gu¬d
<
qpe
::
·ge
> 
ou‹r_tu¶e_·ge
 = qpe::·ge::
	`®loc
(
Ëá_bufãr
->
	`tu¶e_size
());

67 
gu¬d
<
qpe
::
·ge
> 
šÃr_tu¶e_·ge
 = qpe::·ge::
	`®loc
(
right_sourû
->
	`tu¶e_size
());

73 ià(!
Ëá_bufãr
->
	`cİy_·ge
(
ou‹r_tu¶e_·ge
))

79 
·ck‘_t
* 
right_·ck‘
 = 
right_sourû
->
	`»£t
();

80 
tu¶e_fifo
* 
right_bufãr
 = 
right_·ck‘
->
	`ouut_bufãr
();

81 
	`TRACE
(
TRACE_ALWAYS
,

83 
di¥©ch”_t
::
	`di¥©ch_·ck‘
(
right_·ck‘
);

90 ià(!
right_bufãr
->
	`cİy_·ge
(
šÃr_tu¶e_·ge
))

98 
qpe
::
·ge
::
™”©Ü
 
o_™
 = 
ou‹r_tu¶e_·ge
->
	`begš
();

99 
o_™
 !ğ
ou‹r_tu¶e_·ge
->
	`’d
()) {

101 
tu¶e_t
 
ou‹r_tu¶e
 = 
o_™
.
	`advªû
();

102 cÚ¡ * 
ou‹r_key
 = 
još
->
	`Ëá_key
(
ou‹r_tu¶e
);

105 
qpe
::
·ge
::
™”©Ü
 
i_™
 = 
šÃr_tu¶e_·ge
->
	`begš
();

106 
i_™
 !ğ
šÃr_tu¶e_·ge
->
	`’d
()) {

111 
tu¶e_t
 
šÃr_tu¶e
 = 
i_™
.
	`advªû
();

112 cÚ¡ * 
šÃr_key
 = 
još
->
	`right_key
(
šÃr_tu¶e
);

113 iàĞ
	`memcmp
Ğ
ou‹r_key
, 
šÃr_key
, 
key_size
 ) == 0 ) {

115 
još
->
	`još
(
ouut_tu¶e
, 
ou‹r_tu¶e
, 
šÃr_tu¶e
);

116 
_ad­tÜ
->
	`ouut
(
ouut_tu¶e
);

127 
	}
}

	@src/qpipe/stages/delay_writer.cpp

24 
	~"qpe/¡ages/d–ay_wr™”.h
"

25 
	~"ut.h
"

26 
	~<uni¡d.h
>

29 
ENTER_NAMESPACE
(
qpe
);

31 cÚ¡ 
c_¡r
 
	gd–ay_wr™”_·ck‘_t
::
PACKET_TYPE
 = "DELAY_WRITER";

33 cÚ¡ 
c_¡r
 
	gd–ay_wr™”_¡age_t
::
DEFAULT_STAGE_NAME
 = "DELAY_WRITER_STAGE";

38 
	gd–ay_wr™”_¡age_t
::
	$´oûss_·ck‘
() {

40 
ad­tÜ_t
* 
ad­tÜ
 = 
_ad­tÜ
;

41 
d–ay_wr™”_·ck‘_t
* 
·ck‘
 = (d–ay_wr™”_·ck‘_t*)
ad­tÜ
->
	`g‘_·ck‘
();

44 
size_t
 
tu¶e_size
 = 
·ck‘
->
_ouut_tu¶e_size
;

45 
¬¿y_gu¬d_t
<> 
tu¶e_d©a
 = 
Ãw
 [
tu¶e_size
];

46 
	`mem£t
(
tu¶e_d©a
, 0, (tuple_data));

47 
tu¶e_t
 
	`tu¶e
(
tu¶e_d©a
, 
tu¶e_size
);

50 
d–ay_us
 = 
·ck‘
->
_d–ay_us
;

51 
num_tu¶es
 = 
·ck‘
->
_num_tu¶es
;

52 
i
 = 0; i < 
num_tu¶es
; i++) {

53 
	`busy_d–ay_us
(
d–ay_us
);

54 
ad­tÜ
->
	`ouut
(
tu¶e
);

56 
	}
}

59 
EXIT_NAMESPACE
(
qpe
);

	@src/qpipe/stages/echo.cpp

24 
	~"qpe/¡ages/echo.h
"

28 cÚ¡ 
c_¡r
 
	gecho_·ck‘_t
::
PACKET_TYPE
 = "ECHO";

32 cÚ¡ 
c_¡r
 
	gecho_¡age_t
::
DEFAULT_STAGE_NAME
 = "ECHO_STAGE";

36 
	gecho_¡age_t
::
	$´oûss_·ck‘
() {

39 
ad­tÜ_t
* 
ad­tÜ
 = 
_ad­tÜ
;

40 
echo_·ck‘_t
* 
·ck‘
 = (echo_·ck‘_t*)
ad­tÜ
->
	`g‘_·ck‘
();

43 
tu¶e_fifo
* 
šput_bufãr
 = 
·ck‘
->
_šput_bufãr
;

44 
di¥©ch”_t
::
	`di¥©ch_·ck‘
(
·ck‘
->
_šput
);

47 
gu¬d
<
qpe
::
·ge
> 
Ãxt_·ge
 = qpe::·ge::
	`®loc
(
šput_bufãr
->
	`tu¶e_size
());

49 ià(!
šput_bufãr
->
	`cİy_·ge
(
Ãxt_·ge
))

51 
ad­tÜ
->
	`ouut
(
Ãxt_·ge
);

53 
	}
}

	@src/qpipe/stages/fdump.cpp

24 
	~"qpe/¡ages/fdump.h
"

27 cÚ¡ 
c_¡r
 
	gfdump_·ck‘_t
::
PACKET_TYPE
 = "FDUMP";

29 cÚ¡ 
c_¡r
 
	gfdump_¡age_t
::
DEFAULT_STAGE_NAME
 = "FDUMP_STAGE";

38 
	gfdump_¡age_t
::
	$´oûss_·ck‘
() {

40 
ad­tÜ_t
* 
ad­tÜ
 = 
_ad­tÜ
;

41 
fdump_·ck‘_t
* 
·ck‘
 = (fdump_·ck‘_t*è
ad­tÜ
->
	`g‘_·ck‘
();

43 ià(
·ck‘
->
_chd
) {

44 
di¥©ch”_t
::
	`di¥©ch_·ck‘
(
·ck‘
->
_chd
);

47 cÚ¡ 
c_¡r
 &
f’ame
 = 
·ck‘
->
_f’ame
;

49 
gu¬d
<
FILE
> 
fe
 = 
	`fİ’
(
f’ame
.
	`d©a
(), "w+");

50 ià(
fe
 =ğ
NULL
)

51 
	`THROW3
(
FeExû±iÚ
,

53 
	`”ºo_to_¡r
().
	`d©a
(), 
f’ame
.data());

56 
tu¶e_fifo
* 
šput_bufãr
 = 
·ck‘
->
_šput_bufãr
;

58 ià(!(
·ck‘
->
_tu¶e_to_c_¡r
)) {

61 
gu¬d
<
qpe
::
·ge
> 
Ãxt_·ge
 = qpe::·ge::
	`®loc
(
šput_bufãr
->
	`tu¶e_size
());

64 ià(!
šput_bufãr
->
	`cİy_·ge
(
Ãxt_·ge
)) {

65 
	`TRACE
(
TRACE_DEBUG
, "Fšished dum°tØf%s\n", 
f’ame
.
	`d©a
());

69 
	`TRACE
(
TRACE_ALWAYS
, "Wrote…age\n");

70 
ad­tÜ
->
	`ouut
(
Ãxt_·ge
);

71 
Ãxt_·ge
->
	`fwr™e_fuÎ_·ge
(
fe
);

76 ià(!
šput_bufãr
->
	`’su»_»ad_»ady
()) {

81 
tu¶e_t
 
	`tup
(
NULL
, 
šput_bufãr
->
	`tu¶e_size
());

86 ià(!
šput_bufãr
->
	`g‘_tu¶e
(
tup
))

89 cÚ¡ 
c_¡r
* 
¡r
 = 
·ck‘
->
	`_tu¶e_to_c_¡r
(&
tup
);

90 
	`fwr™e
(
¡r
->
	`d©a
(), (), 
	`¡¾’
(¡r->d©a()), 
fe
);

91 
d–‘e
 
¡r
;

93 
ad­tÜ
->
	`ouut
(
tup
);

97 
	}
}

	@src/qpipe/stages/fscan.cpp

24 
	~"qpe/¡ages/fsÿn.h
"

28 cÚ¡ 
c_¡r
 
	gfsÿn_·ck‘_t
::
PACKET_TYPE
 = "FSCAN";

32 cÚ¡ 
c_¡r
 
	gfsÿn_¡age_t
::
DEFAULT_STAGE_NAME
 = "FSCAN_STAGE";

42 
	gfsÿn_¡age_t
::
	$´oûss_·ck‘
() {

44 
ad­tÜ_t
* 
ad­tÜ
 = 
_ad­tÜ
;

45 
fsÿn_·ck‘_t
* 
·ck‘
 = (fsÿn_·ck‘_t*)
ad­tÜ
->
	`g‘_·ck‘
();

48 cÚ¡ 
c_¡r
 &
f’ame
 = 
·ck‘
->
_f’ame
;

49 
gu¬d
<
FILE
> 
fe
 = 
	`fİ’
(
f’ame
.
	`d©a
(), "r");

50 ià(
fe
 =ğ
NULL
)

51 
	`THROW3
(
FeExû±iÚ
,

53 
	`”ºo_to_¡r
().
	`d©a
(), 
f’ame
.data());

56 
gu¬d
<
qpe
::
·ge
> 
tu¶e_·ge
 =

57 
qpe
::
·ge
::
	`®loc
(
·ck‘
->
	`ouut_bufãr
()->
	`tu¶e_size
());

63 
boŞ
 
acû±šg_·ck‘s
 = 
Œue
;

68 if(!
tu¶e_·ge
->
	`ä—d_fuÎ_·ge
(
fe
))

74 ià(
acû±šg_·ck‘s
) {

75 
ad­tÜ
->
	`¡İ_acû±šg_·ck‘s
();

76 
acû±šg_·ck‘s
 = 
çl£
;

80 
qpe
::
·ge
::
™”©Ü
 
™
 = 
tu¶e_·ge
->
	`begš
();

81 
™
 !ğ
tu¶e_·ge
->
	`’d
())

82 
ad­tÜ
->
	`ouut
(*
™
++);

86 
	}
}

	@src/qpipe/stages/func_call.cpp

24 
	~"qpe/¡ages/func_ÿÎ.h
"

28 cÚ¡ 
c_¡r
 
	gfunc_ÿÎ_·ck‘_t
::
PACKET_TYPE
 = "FUNC_CALL";

32 cÚ¡ 
c_¡r
 
	gfunc_ÿÎ_¡age_t
::
DEFAULT_STAGE_NAME
 = "FUNC_CALL_STAGE";

40 
	gfunc_ÿÎ_¡age_t
::
	$´oûss_·ck‘
() {

41 
ad­tÜ_t
* 
ad­tÜ
 = 
_ad­tÜ
;

42 
func_ÿÎ_·ck‘_t
* 
·ck‘
 = (func_ÿÎ_·ck‘_t*)
ad­tÜ
->
	`g‘_·ck‘
();

43 
·ck‘
->
	`_func
(
ad­tÜ
,…ack‘->
_func_¬g
);

44 
	}
}

	@src/qpipe/stages/hash_aggregate.cpp

24 
	~"qpe/¡ages/hash_agg»g©e.h
"

26 #ià
defšed
(
lšux
è|| defšed(
__lšux
)

28 
	~<ext/hash_£t
>

29 
usšg
 
	g__gnu_cxx
::
hashbË
;

30 
usšg
 
	g__gnu_cxx
::
hash_£t
;

33 
	~<hash_£t
>

34 
usšg
 
	g¡d
::
hash_£t
;

35 
usšg
 
	g¡d
::
hashbË
;

39 cÚ¡ 
c_¡r
 
	ghash_agg»g©e_·ck‘_t
::
PACKET_TYPE
 = "HASH_AGGREGATE";

43 cÚ¡ 
c_¡r
 
	ghash_agg»g©e_¡age_t
::
DEFAULT_STAGE_NAME
 = "HASH_AGGREGATE_STAGE";

48 cÚ¡ 
size_t
 
	gMAX_RUN_PAGES
 = 10000;

56 
	sexŒaùkey_t
 {

57 
key_exŒaùÜ_t
 *
	m_exŒaù
;

59 
exŒaùkey_t
(
key_exŒaùÜ_t
* 
exŒaù
)

60 : 
_exŒaù
(
exŒaù
)

64 cÚ¡ * cÚ¡ 
İ”©Ü
()(cÚ¡ * 
v®ue
) const {

65  
_exŒaù
->
exŒaù_key
(
v®ue
);

72 
	sequ®by‹s_t
 {

74 
size_t
 
	m_Ën
;

75 
equ®by‹s_t
(
size_t
 
Ën
)

76 : 
_Ën
(
Ën
)

80 
boŞ
 
İ”©Ü
()(cÚ¡ *
k1
, cÚ¡ *
	mk2
) const {

81  !
memcmp
(
k1
, 
k2
, 
_Ën
);

86 
	shashfú_t
 {

88 
size_t
 
	m_Ën
;

89 
hashfú_t
(
size_t
 
Ën
)

90 : 
_Ën
(
Ën
)

94 
size_t
 
İ”©Ü
()(cÚ¡ *
key
) const {

95  
âv_hash
(
key
, 
_Ën
);

99 
	ghash_£t
<*, 
	thashfú_t
, 
	tequ®by‹s_t
>::
	t®loÿtÜ_ty³
 
	t®loc_t
;

100 
	ghashbË
<*, const *,

101 
	thashfú_t
, 
	texŒaùkey_t
,

102 
	tequ®by‹s_t
, 
	t®loc_t
> 
	ttu¶e_hash_t
;

105 
	ghash_agg»g©e_¡age_t
::
	$®loc_agg
(
tu¶e_t
 &
agg
, cÚ¡ * 
key
) {

107 if(!
_agg_·ge
 || _agg_·ge->
	`fuÎ
()) {

108 if(
_·ge_couÁ
 >ğ
MAX_RUN_PAGES
)

111 
_agg_·ge
 = 
qpe
::
·ge
::
	`®loc
(
_agg»g©e
->
	`tu¶e_size
());

112 
_·ge_li¡
.
	`add
(
_agg_·ge
);

113 
_·ge_couÁ
++;

117 
agg
.
d©a
 = 
_agg_·ge
->
	`®loÿ‹
();

120 
_agg»g©e
->
	`š™
(
agg
.
d©a
);

123 
key_exŒaùÜ_t
* 
exŒaù
 = 
_agg»g©e
->
	`key_exŒaùÜ
();

124 * 
agg_key
 = 
exŒaù
->
	`exŒaù_key
(
agg
.
d©a
);

125 
	`memıy
(
agg_key
, 
key
, 
exŒaù
->
	`key_size
());

127 
	}
}

129 
	ghash_agg»g©e_¡age_t
::
	$´oûss_·ck‘
() {

130 
hash_agg»g©e_·ck‘_t
* 
·ck‘
;

131 
·ck‘
 = (
hash_agg»g©e_·ck‘_t
*è
_ad­tÜ
->
	`g‘_·ck‘
();

132 
tu¶e_fifo
* 
šput_bufãr
 = 
·ck‘
->
_šput_bufãr
;

133 
di¥©ch”_t
::
	`di¥©ch_·ck‘
(
·ck‘
->
_šput
);

134 
_agg»g©e
 = 
·ck‘
->_aggregate;

135 
key_exŒaùÜ_t
* 
agg_key
 = 
_agg»g©e
->
	`key_exŒaùÜ
();

136 
key_exŒaùÜ_t
* 
tup_key
 = 
·ck‘
->
_exŒaùÜ
;

142 
size_t
 
key_size
 = 
agg_key
->
	`key_size
();

143 
hashfú_t
 
	`hf
(
key_size
);

144 
equ®by‹s_t
 
	`eql
(
key_size
);

145 
exŒaùkey_t
 
	`ext
(
agg_key
);

148 
tu¶e_hash_t
 
	`run
(10001, 
hf
, 
eql
, 
ext
);

151 !
šput_bufãr
->
	`eof
()) {

152 
_·ge_li¡
.
	`ş—r
();

153 
_·ge_couÁ
 = 0;

154 
_agg_·ge
 = 
NULL
;

155 
_·ge_couÁ
 < 
MAX_RUN_PAGES
 && !
šput_bufãr
->
	`eof
()) {

156 
gu¬d
<
qpe
::
·ge
>…agğ
NULL
;

157 
tu¶e_t
 
š
;

160 if(!
šput_bufãr
->
	`g‘_tu¶e
(
š
))

164 cÚ¡* 
key
 = 
tup_key
->
	`exŒaù_key
(
š
);

165 
tu¶e_hash_t
::
™”©Ü
 
ÿndid©e
 = 
run
.
	`fšd
(
key
);

166 if(
ÿndid©e
 =ğ
run
.
	`’d
()) {

168 
tu¶e_t
 
agg
;

169 if(
	`®loc_agg
(
agg
, 
key
))

173 
ÿndid©e
 = 
run
.
	`š£¹_unique
(
agg
.
d©a
).
fœ¡
;

176 
	`TRACE
(
TRACE_DEBUG
, "Merging‡uple\n");

181 
_agg»g©e
->
	`agg»g©e
(*
ÿndid©e
, 
š
);

186 
	`as£¹
(
šput_bufãr
->
	`eof
());

189 
size_t
 
out_size
 = 
·ck‘
->
_ouut_f‹r
->
	`šput_tu¶e_size
();

190 
¬¿y_gu¬d_t
<> 
out_d©a
 = 
Ãw
 [
out_size
];

191 
tu¶e_t
 
	`out
(
out_d©a
, 
out_size
);

192 
tu¶e_hash_t
::
™”©Ü
 
™
=
run
.
	`begš
(); iˆ!ğrun.
	`’d
(); ++it) {

194 
_agg»g©e
->
	`fšish
(
out
, *
™
);

195 
_ad­tÜ
->
	`ouut
(
out
);

198 
	}
}

	@src/qpipe/stages/hash_join.cpp

31 
	~"qpe/¡ages/hash_još.h
"

33 
	~<c¡ršg
>

34 
	~<®gÜ™hm
>

37 
ENTER_NAMESPACE
(
qpe
);

40 cÚ¡ 
c_¡r
 
	ghash_još_·ck‘_t
::
PACKET_TYPE
 = "HASH_JOIN";

42 cÚ¡ 
c_¡r
 
	ghash_još_¡age_t
::
DEFAULT_STAGE_NAME
 = "HASH_JOIN";

46 
	ghash_još_¡age_t
::
	$´oûss_·ck‘
() {

48 
hash_još_·ck‘_t
* 
·ck‘
 = (hash_još_·ck‘_ˆ*)
_ad­tÜ
->
	`g‘_·ck‘
();

51 
boŞ
 
ou‹r_još
 = 
·ck‘
->
_ou‹r
;

52 
_još
 = 
·ck‘
->_join;

53 
boŞ
 
di¡šù
 = 
·ck‘
->
_di¡šù
;

62 
tu¶e_fifo
 *
right_bufãr
 = 
·ck‘
->
_right_bufãr
;

63 
di¥©ch”_t
::
	`di¥©ch_·ck‘
(
·ck‘
->
_right
);

64 
tu¶e_fifo
 *
Ëá_bufãr
 = 
·ck‘
->
_Ëá_bufãr
;

65 
di¥©ch”_t
::
	`di¥©ch_·ck‘
(
·ck‘
->
_Ëá
);

69 if(!
right_bufãr
->
	`’su»_»ad_»ady
()) {

78 
hash_još_¡age_t
::
exŒaùkey_t
 
	`exŒaù_Ëá
 (
_još
, 
çl£
);

79 
hash_još_¡age_t
::
exŒaùkey_t
 
	`exŒaù_right
(
_još
, 
Œue
);

80 
hash_još_¡age_t
::
hashfú_t
 
	`hashfú
(
_još
->
	`key_size
());

88 
tu¶e_t
 
right
;

92 if(!
right_bufãr
->
	`g‘_tu¶e
(
right
))

96 
size_t
 
hash_code
 = 
	`hashfú
(
	`exŒaù_right
(
right
.
d©a
));

97 
hash_št
 = ()
hash_code
;

98 
·¹™iÚ
 = 
hash_št
 % 
·¹™iÚs
.
	`size
();

104 
	`‹¡_ov”æow
(
·¹™iÚ
);

109 
qpe
::
·ge
* &
p
 = 
·¹™iÚs
[
·¹™iÚ
].
_·ge
;

110 
p
->
	`­³nd_tu¶e
(
right
);

120 
size_t
 
·ge_ÿ·c™y
 =

121 
qpe
::
·ge
::
	`ÿ·c™y
(
	`g‘_deçuÉ_·ge_size
(),

122 
_još
->
	`right_tu¶e_size
());

124 
exŒaùkey_t
 
	`right_key_exŒaùÜ
(
_još
, 
Œue
);

125 
equ®by‹s_t
 
	`equ®_key
 (
_još
->
	`key_size
());

126 
equ®by‹s_t
 
	`equ®_¹up
(
_još
->
	`right_tu¶e_size
());

127 
hashfú_t
 
	`hash”
(
_još
->
	`key_size
());

129 
tu¶e_hash_t
 
	`bË
(
·ge_couÁ
 * 
·ge_ÿ·c™y
,

130 
right_key_exŒaùÜ
,

131 
equ®_key
,

132 
equ®_¹up
,

133 
hash”
);

136 
right_aùiÚ_t
 
	`right_aùiÚ
(
_još
->
	`Ëá_tu¶e_size
());

137 
·¹™iÚ_li¡_t
::
™”©Ü
 
™
=
·¹™iÚs
.
	`begš
(); iˆ!ğ·¹™iÚs.
	`’d
(); ++it) {

139 
qpe
::
·ge
* 
p
 = 
™
->
_·ge
;

140 if(
p
 =ğ
NULL
)

145 if(
™
->
fe
)

146 
	`şo£_fe
(
™
, 
right_aùiÚ
);

150 
p
) {

151 
qpe
::
·ge
::
™”©Ü
 
™
=
p
->
	`begš
(); iˆ!ğp->
	`’d
(); ++it) {

154 if(
di¡šù
)

155 
bË
.
	`š£¹_unique_nÜesize
(
™
->
d©a
);

157 
bË
.
	`š£¹_nÜesize
(
™
->
d©a
);

160 
p
 =…->
Ãxt
;

167 if(!
Ëá_bufãr
->
	`’su»_»ad_»ady
())

173 
exŒaùkey_t
 
	`Ëá_key_exŒaùÜ
(
_još
, 
çl£
);

174 
tu¶e_t
 
	`Ëá
(
NULL
, 
_još
->
	`Ëá_tu¶e_size
());

175 
¬¿y_gu¬d_t
<> 
d©a
 = 
Ãw
 [
_još
->
	`ouut_tu¶e_size
()];

179 if(!
Ëá_bufãr
->
	`g‘_tu¶e
(
Ëá
))

183 cÚ¡ * 
Ëá_key
 = 
	`Ëá_key_exŒaùÜ
(
Ëá
.
d©a
);

184 
hash_code
 = 
	`hash”
(
Ëá_key
);

185 
·¹™iÚ
 = 
hash_code
 % 
·¹™iÚs
.
	`size
();

186 
·¹™iÚ_t
 &
p
 = 
·¹™iÚs
[
·¹™iÚ
];

189 if(
p
.
size
 == 0)

193 if(
p
.
fe
) {

194 
qpe
::
·ge
* 
pg
 = 
p
.
_·ge
;

197 if(
pg
->
	`fuÎ
()) {

198 
pg
->
	`fwr™e_fuÎ_·ge
(
p
.
fe
);

199 
pg
->
	`ş—r
();

203 
pg
->
	`­³nd_tu¶e
(
Ëá
);

208 
¡d
::
·œ
<
tu¶e_hash_t
::
™”©Ü
,u¶e_hash_t::™”©Ü> 
¿nge
;

209 
¿nge
 = 
bË
.
	`equ®_¿nge
(
Ëá_key
);

211 
tu¶e_t
 
	`out
(
d©a
, 
_još
->
	`ouut_tu¶e_size
());

212 if(
ou‹r_još
 && 
¿nge
.
fœ¡
 =ğ¿nge.
£cÚd
) {

213 
_još
->
	`Ëá_ou‹r_još
(
out
, 
Ëá
);

214 
_ad­tÜ
->
	`ouut
(
out
);

217 
tu¶e_hash_t
::
™”©Ü
 
™
 = 
¿nge
.
fœ¡
; iˆ!ğ¿nge.
£cÚd
; ++it) {

218 
right
.
d©a
 = *
™
;

219 
_još
->
	`još
(
out
, 
Ëá
, 
right
);

220 
_ad­tÜ
->
	`ouut
(
out
);

227 
bË
.
	`ş—r
();

228 
·¹™iÚ_li¡_t
::
™”©Ü
 
™
=
·¹™iÚs
.
	`begš
(); iˆ!ğ·¹™iÚs.
	`’d
(); ++it) {

230 
gu¬d
<
qpe
::
·ge
> 
pg
 = 
™
->
_·ge
;…g;…g =…g->
Ãxt
);

231 if(
™
->
fe
)

232 
	`şo£_fe
(
™
, 
	`Ëá_aùiÚ_t
());

237 
	}
}

241 
	ghash_još_¡age_t
::
	$‹¡_ov”æow
(
·¹™iÚ
) {

243 
·¹™iÚ_t
 &
p
 = 
·¹™iÚs
[
·¹™iÚ
];

246 if(
p
.
_·ge
 && !p._·ge->
	`fuÎ
())

259 if(
·ge_couÁ
 =ğ
·ge_quÙa
) {

265 
max
 = -1;

266 
i
=0; i < 
·¹™iÚs
.
	`size
(); i++) {

267 
·¹™iÚ_t
 &
p
 = 
·¹™iÚs
[
i
];

268 if(!
p
.
fe
 && (
max
 < 0 ||….
size
 > 
·¹™iÚs
[max].size))

269 
max
 = 
i
;

273 
·¹™iÚ_t
 &
p
 = 
·¹™iÚs
[
max
];

274 
p
.
fe
 = 
	`ü—‹_tmp_fe
Õ.
fe_Çme1
, "hash-join-right");

277 
gu¬d
<
qpe
::
·ge
> 
h—d
;

278 
h—d
 = 
p
.
_·ge
; h—d->
Ãxt
; head=head->next) {

279 
h—d
->
	`fwr™e_fuÎ_·ge
(
p
.
fe
);

280 
·ge_couÁ
--;

284 
h—d
->
	`fwr™e_fuÎ_·ge
(
p
.
fe
);

285 
h—d
->
	`ş—r
();

286 
p
.
_·ge
 = 
h—d
.
	`»Ëa£
();

292 
qpe
::
·ge
* 
pg
 =

293 
qpe
::
·ge
::
	`®loc
(
_još
->
	`right_tu¶e_size
());

294 
pg
->
Ãxt
 = 
p
.
_·ge
;

295 
p
.
_·ge
 = 
pg
;

296 
·ge_couÁ
++;

300 
p
.
size
++;

301 
	}
}

305 
	g‹m¶©e
 <
şass
 
	gAùiÚ
>

306 
	ghash_još_¡age_t
::
	$şo£_fe
(
·¹™iÚ_li¡_t
::
™”©Ü
 
™
, 
AùiÚ
 
aùiÚ
) {

311 
qpe
::
·ge
 *
p
 = 
™
->
_·ge
;

315 
fe_gu¬d_t
 
fe
 = 
™
->file;

316 if(!
p
 ||…->
	`em±y
())

319 
p
->
	`fwr™e_fuÎ_·ge
(
fe
);

320 
	`aùiÚ
(
™
);

321 
	}
}

323 
EXIT_NAMESPACE
(
qpe
);

	@src/qpipe/stages/merge.cpp

24 
	~"qpe/¡ages/m”ge.h
"

25 
	~<li¡
>

27 
usšg
 
	g¡d
::
li¡
;

31 cÚ¡ 
c_¡r
 
	gm”ge_·ck‘_t
::
PACKET_TYPE
 = "MERGE";

35 cÚ¡ 
c_¡r
 
	gm”ge_¡age_t
::
DEFAULT_STAGE_NAME
 = "MERGE_STAGE";

66 
boŞ
 
	gm”ge_¡age_t
::
bufãr_h—d_t
::
	$š™
(
tu¶e_fifo
 *
buf
,

67 
key_exŒaùÜ_t
* 
exŒaù
)

69 
bufãr
 = 
buf
;

70 
_exŒaù
 = 
exŒaù
;

71 
size
 = 
bufãr
->
	`tu¶e_size
();

72 
d©a
 = 
Ãw
 [
size
];

73 
tu¶e
 = 
	`tu¶e_t
(
d©a
, 
size
);

74 
™em
.
d©a
 = data;

75  
	`has_tu¶e
();

76 
	}
}

86 
boŞ
 
	gm”ge_¡age_t
::
bufãr_h—d_t
::
	$has_tu¶e
() {

88 
tu¶e_t
 
šput
;

90 if(!
bufãr
->
	`g‘_tu¶e
(
šput
))

91  
çl£
;

96 
tu¶e
.
	`assign
(
šput
);

99 
™em
.
hšt
 = 
_exŒaù
->
	`exŒaù_hšt
(
tu¶e
);

100  
Œue
;

101 
	}
}

104 
	gm”ge_¡age_t
::
	$com·»
(cÚ¡ 
hšt_tu¶e_·œ_t
 &
a
, cÚ¡ hšt_tu¶e_·œ_ˆ&
b
) {

105  
	`tu¶e_com·¿tÜ_t
(
_exŒaù
, 
_com·»
)(
a
, 
b
);

106 
	}
}

111 
	gm”ge_¡age_t
::
	$š£¹_sÜ‹d
(
bufãr_h—d_t
 *
h—d
)

114 if(!
_h—d_li¡
 || 
	`com·»
(
h—d
->
™em
, _head_list->item) <= 0) {

115 
h—d
->
Ãxt
 = 
_h—d_li¡
;

116 
_h—d_li¡
 = 
h—d
;

121 
bufãr_h—d_t
 *
´ev
 = 
_h—d_li¡
;

122 
´ev
->
Ãxt
 && 
	`com·»
Õ»v->Ãxt->
™em
, 
h—d
->item) < 0)

123 
´ev
 =…»v->
Ãxt
;

126 
h—d
->
Ãxt
 = 
´ev
->next;

127 
´ev
->
Ãxt
 = 
h—d
;

128 
	}
}

132 
	gm”ge_¡age_t
::
	$´oûss_·ck‘
() {

134 
m”ge_·ck‘_t
::
	tbufãr_li¡_t
 buffer_list_t;

137 
m”ge_·ck‘_t
 *
·ck‘
 = (m”ge_·ck‘_ˆ*)
_ad­tÜ
->
	`g‘_·ck‘
();

139 
_com·»
 = 
·ck‘
->_compare;

140 
_exŒaù
 = 
·ck‘
->_extract;

141 
bufãr_li¡_t
 &
šputs
 = 
·ck‘
->
_šput_bufãrs
;

145 
m”ge_çùÜ
 = 
šputs
.
	`size
();

146 
¬¿y_gu¬d_t
<
bufãr_h—d_t
> 
h—d_¬¿y
 = 
Ãw
 bufãr_h—d_t[
m”ge_çùÜ
];

147 
	`TRACE
(
TRACE_DEBUG
, "Proûssšg %d-way m”ge\n", 
m”ge_çùÜ
);

151 
i
=0; i < 
m”ge_çùÜ
; i++) {

152 
bufãr_h—d_t
 &
h—d
 = 
h—d_¬¿y
[
i
];

153 if(
h—d
.
	`š™
(
šputs
[
i
], 
_exŒaù
))

154 
	`š£¹_sÜ‹d
(&
h—d
);

159 
i
=0; 
_h—d_li¡
; i++) {

162 
bufãr_h—d_t
 *
h—d
 = 
_h—d_li¡
;

163 
_h—d_li¡
 = 
h—d
->
Ãxt
;

167 
_ad­tÜ
->
	`ouut
(
h—d
->
tu¶e
);

171 if(
h—d
->
	`has_tu¶e
())

172 
	`š£¹_sÜ‹d
(
h—d
);

176 
	}
}

	@src/qpipe/stages/partial_aggregate.cpp

24 
	~"qpe/¡ages/·¹Ÿl_agg»g©e.h
"

28 cÚ¡ 
c_¡r
 
	g·¹Ÿl_agg»g©e_·ck‘_t
::
PACKET_TYPE
 = "PARTIAL_AGGREGATE";

32 cÚ¡ 
c_¡r
 
	g·¹Ÿl_agg»g©e_¡age_t
::
DEFAULT_STAGE_NAME
 = "PARTIAL_AGGREGATE_STAGE";

37 cÚ¡ 
size_t
 
	gMAX_RUN_PAGES
 = 10000;

41 
	g·¹Ÿl_agg»g©e_¡age_t
::
	$®loc_agg
(
hšt_tu¶e_·œ_t
 &
agg
, cÚ¡ * 
key
) {

43 if(!
_agg_·ge
 || _agg_·ge->
	`fuÎ
()) {

44 if(
_·ge_couÁ
 >ğ
MAX_RUN_PAGES
)

47 
_agg_·ge
 = 
qpe
::
·ge
::
	`®loc
(
_agg»g©e
->
	`tu¶e_size
());

48 
_·ge_li¡
.
	`add
(
_agg_·ge
);

49 
_·ge_couÁ
++;

53 
agg
.
d©a
 = 
_agg_·ge
->
	`®loÿ‹
();

56 
_agg»g©e
->
	`š™
(
agg
.
d©a
);

59 
key_exŒaùÜ_t
* 
exŒaù
 = 
_agg»g©e
->
	`key_exŒaùÜ
();

60 * 
agg_key
 = 
exŒaù
->
	`exŒaù_key
(
agg
.
d©a
);

61 
	`memıy
(
agg_key
, 
key
, 
exŒaù
->
	`key_size
());

63 
	}
}

65 
	g·¹Ÿl_agg»g©e_¡age_t
::
	$´oûss_·ck‘
() {

66 
·¹Ÿl_agg»g©e_·ck‘_t
* 
·ck‘
;

67 
·ck‘
 = (
·¹Ÿl_agg»g©e_·ck‘_t
*è
_ad­tÜ
->
	`g‘_·ck‘
();

68 
tu¶e_fifo
* 
šput_bufãr
 = 
·ck‘
->
_šput_bufãr
;

69 
di¥©ch”_t
::
	`di¥©ch_·ck‘
(
·ck‘
->
_šput
);

70 
_agg»g©e
 = 
·ck‘
->_aggregate;

71 
key_exŒaùÜ_t
* 
agg_key
 = 
_agg»g©e
->
	`key_exŒaùÜ
();

72 
key_exŒaùÜ_t
* 
tup_key
 = 
·ck‘
->
_exŒaùÜ
;

73 
key_com·»_t
* 
com·»
 = 
·ck‘
->
_com·»
;

77 
tu¶e_Ëss_t
 
	`Ëss
(
agg_key
, 
com·»
);

78 
tu¶e_£t_t
 
	`run
(
Ëss
);

81 !
šput_bufãr
->
	`eof
()) {

82 
_·ge_li¡
.
	`ş—r
();

83 
_·ge_couÁ
 = 0;

84 
_agg_·ge
 = 
NULL
;

85 
_·ge_couÁ
 < 
MAX_RUN_PAGES
 && !
šput_bufãr
->
	`eof
()) {

86 
gu¬d
<
qpe
::
·ge
>…agğ
NULL
;

87 
tu¶e_t
 
š
;

90 if(!
šput_bufãr
->
	`g‘_tu¶e
(
š
))

93 
hšt
 = 
tup_key
->
	`exŒaù_hšt
(
š
);

101 
size_t
 
off£t
 = 
agg_key
->
	`key_off£t
();

102 * 
key_d©a
 = 
tup_key
->
	`exŒaù_key
(
š
);

103 
hšt_tu¶e_·œ_t
 
	`key
(
hšt
, 
key_d©a
 - 
off£t
);

117 
tu¶e_£t_t
::
™”©Ü
 
ÿndid©e
 = 
run
.
	`fšd
(
key
);

118 if(
ÿndid©e
 =ğ
run
.
	`’d
()) {

120 
hšt_tu¶e_·œ_t
 
	`agg
(
hšt
, 
NULL
);

121 if(
	`®loc_agg
(
agg
, 
key_d©a
))

125 
ÿndid©e
 = 
run
.
	`š£¹
(
agg
).
fœ¡
;

128 
	`TRACE
(
TRACE_DEBUG
, "Merging‡uple\n");

133 
_agg»g©e
->
	`agg»g©e
(
ÿndid©e
->
d©a
, 
š
);

138 
	`as£¹
(
šput_bufãr
->
	`eof
());

141 
size_t
 
out_size
 = 
·ck‘
->
_ouut_f‹r
->
	`šput_tu¶e_size
();

142 
¬¿y_gu¬d_t
<> 
out_d©a
 = 
Ãw
 [
out_size
];

143 
tu¶e_t
 
	`out
(
out_d©a
, 
out_size
);

144 
tu¶e_£t_t
::
™”©Ü
 
™
=
run
.
	`begš
(); iˆ!ğrun.
	`’d
(); ++it) {

146 
_agg»g©e
->
	`fšish
(
out
, 
™
->
d©a
);

147 
_ad­tÜ
->
	`ouut
(
out
);

150 
	}
}

	@src/qpipe/stages/pipe_hash_join.cpp

31 
	~"qpe/¡ages/pe_hash_još.h
"

32 
	~<c¡ršg
>

33 
	~<®gÜ™hm
>

35 #ià
defšed
(
lšux
è|| defšed(
__lšux
)

37 
	~<ext/hash_£t
>

38 
usšg
 
	g__gnu_cxx
::
hashbË
;

39 
usšg
 
	g__gnu_cxx
::
hash_£t
;

42 
	~<hash_£t
>

43 
usšg
 
	g¡d
::
hash_£t
;

44 
usšg
 
	g¡d
::
hashbË
;

49 
ENTER_NAMESPACE
(
qpe
);

52 cÚ¡ 
c_¡r
 
	gpe_hash_još_·ck‘_t
::
PACKET_TYPE
 = "PIPE_HASH_JOIN";

54 cÚ¡ 
c_¡r
 
	gpe_hash_još_¡age_t
::
DEFAULT_STAGE_NAME
 = "PIPE_HASH_JOIN";

61 
	sexŒaùkey_t
 {

62 
size_t
 
	m_off£t
;

64 
exŒaùkey_t
(
tu¶e_još_t
* 
još
, 
boŞ
 
Ëá
)

65 : 
_off£t
(
Ëá
? 
još
->
Ëá_key_off£t
(è: još->
right_key_off£t
())

69 cÚ¡ * cÚ¡ 
İ”©Ü
()(cÚ¡ * 
v®ue
) const {

70  
v®ue
 + 
_off£t
;

77 
	sequ®by‹s_t
 {

79 
size_t
 
	m_Ën
;

80 
equ®by‹s_t
(
size_t
 
Ën
)

81 : 
_Ën
(
Ën
)

85 
boŞ
 
İ”©Ü
()(cÚ¡ *
k1
, cÚ¡ *
	mk2
) const {

86  !
memcmp
(
k1
, 
k2
, 
_Ën
);

91 
	shashfú_t
 {

93 
size_t
 
	m_Ën
;

94 
hashfú_t
(
size_t
 
Ën
)

95 : 
_Ën
(
Ën
)

99 
size_t
 
İ”©Ü
()(cÚ¡ *
key
) const {

100  
âv_hash
(
key
, 
_Ën
);

105 
	ghash_£t
<*, 
	thashfú_t
, 
	tequ®by‹s_t
>::
	t®loÿtÜ_ty³
 
	t®loc_t
;

107 
	ghashbË
<*, const *,

108 
	thashfú_t
, 
	texŒaùkey_t
,

109 
	tequ®by‹s_t
, 
	t®loc_t
> 
	ttu¶e_hash_t
;

117 
	gpe_hash_još_¡age_t
::
	$´oûss_·ck‘
() {

124 
pe_hash_još_·ck‘_t
* 
·ck‘
 = (pe_hash_još_·ck‘_ˆ*)
_ad­tÜ
->
	`g‘_·ck‘
();

130 
tu¶e_fifo
 *
right_bufãr
 = 
·ck‘
->
_right_bufãr
;

131 
di¥©ch”_t
::
	`di¥©ch_·ck‘
(
·ck‘
->
_right
);

132 
tu¶e_fifo
 *
Ëá_bufãr
 = 
·ck‘
->
_Ëá_bufãr
;

133 
di¥©ch”_t
::
	`di¥©ch_·ck‘
(
·ck‘
->
_Ëá
);

135 
_još
 = 
·ck‘
->_join;

136 
tu¶e_t
 
	`Ëá
(
NULL
, 
Ëá_bufãr
->
	`tu¶e_size
());

137 
tu¶e_t
 
	`right
(
NULL
, 
right_bufãr
->
	`tu¶e_size
());

138 
exŒaùkey_t
 
	`Ëá_ke
(
_još
, 
Œue
);

139 
exŒaùkey_t
 
	`right_ke
(
_još
, 
çl£
);

140 
equ®by‹s_t
 
	`eq
(
_još
->
	`key_size
());

141 
hashfú_t
 
	`hf
(
_još
->
	`key_size
());

147 
tu¶e_hash_t
 
	`Ëá_hash
(10001, 
hf
, 
eq
, 
Ëá_ke
);

148 
tu¶e_hash_t
 
	`right_hash
(10001, 
hf
, 
eq
, 
right_ke
);

152 
·ge_Œash_¡ack
 
Ëá_·ges
;

153 
·ge_Œash_¡ack
 
right_·ges
;

155 
out_size
 = 
·ck‘
->
_ouut_f‹r
->
	`šput_tu¶e_size
();

156 
¬¿y_gu¬d_t
<> 
out_d©a
 = 
Ãw
 [
out_size
];

157 
tu¶e_t
 
	`out
(
out_d©a
, 
out_size
);

164 
Ëá_»ady
 = 
Ëá_bufãr
->
	`check_»ad_»ady
();

165 
right_»ady
 = 
right_bufãr
->
	`check_»ad_»ady
();

167 
qpe
::
	t·ge
::
	t™”©Ü
 
	tp™
;

168 
tu¶e_hash_t
::
	t™”©Ü
 
	th™
;

169 
do_Ëá
:

170 if(
Ëá_»ady
 == 1) {

172 
qpe
::
·ge
* 
p
 = qpe::·ge::
	`®loc
(
Ëá_bufãr
->
	`tu¶e_size
());

173 
Ëá_bufãr
->
	`cİy_·ge
(
p
);

174 
Ëá_·ges
.
	`add
(
p
);

175 
p™
 
™
 = 
p
->
	`begš
();

176 
p™
 
’d
 = 
p
->
	`’d
();

177 
™
 !ğ
’d
) {

179 
tu¶e_t
 
Ëá
 = 
™
.
	`advªû
();

180 
Ëá_hash
.
	`š£¹_equ®
(
Ëá
.
d©a
);

181 
h™
 
´obe
 = 
right_hash
.
	`fšd
(
	`Ëá_ke
(
Ëá
.
d©a
));

182 ; 
´obe
 !ğ
right_hash
.
	`’d
(); ++probe) {

183 
right
.
d©a
 = *
´obe
;

184 
_još
->
	`još
(
out
, 
Ëá
, 
right
);

185 
_ad­tÜ
->
	`ouut
(
out
);

189 
Ëá_»ady
 = 
Ëá_bufãr
->
	`check_»ad_»ady
();

190 
right_»ady
 = 
right_bufãr
->
	`check_»ad_»ady
();

193 
do_right
:

194 if(
right_»ady
 == 1) {

196 
qpe
::
·ge
* 
p
 = qpe::·ge::
	`®loc
(
right_bufãr
->
	`tu¶e_size
());

197 
right_bufãr
->
	`cİy_·ge
(
p
);

198 
right_·ges
.
	`add
(
p
);

199 
p™
 
™
 = 
p
->
	`begš
();

200 
p™
 
’d
 = 
p
->
	`’d
();

201 
™
 !ğ
’d
) {

203 
tu¶e_t
 
right
 = 
™
.
	`advªû
();

204 
right_hash
.
	`š£¹_equ®
(
right
.
d©a
);

205 
h™
 
´obe
 = 
Ëá_hash
.
	`fšd
(
	`right_ke
(
right
.
d©a
));

206 ; 
´obe
 !ğ
Ëá_hash
.
	`’d
(); ++probe) {

207 
Ëá
.
d©a
 = *
´obe
;

208 
_još
->
	`još
(
out
, 
Ëá
, 
right
);

209 
_ad­tÜ
->
	`ouut
(
out
);

213 
Ëá_»ady
 = 
Ëá_bufãr
->
	`check_»ad_»ady
();

214 
right_»ady
 = 
right_bufãr
->
	`check_»ad_»ady
();

217 
do_decide
:

219 if(
Ëá_»ady
 == 1)

220 
do_Ëá
;

221 if(
right_»ady
 == 1)

222 
do_right
;

223 if(
Ëá_»ady
 == -1) {

224 if(
right_»ady
 == -1)

228 if(
right_bufãr
->
	`’su»_»ad_»ady
())

229 
right_»ady
 = 1;

231 
right_»ady
 = -1;

235 if(
right_»ady
 == 0) {

236 if(
Ëá_bufãr
->
	`’su»_»ad_»ady
(1))

237 
Ëá_»ady
 = 1;

239 
Ëá_»ady
 = 
Ëá_bufãr
->
	`check_»ad_»ady
();

240 
right_»ady
 = 
right_bufãr
->
	`check_»ad_»ady
();

243 if(
Ëá_bufãr
->
	`’su»_»ad_»ady
())

244 
Ëá_»ady
 = 1;

246 
Ëá_»ady
 = -1;

249 
do_decide
;

250 
	}
}

252 
EXIT_NAMESPACE
(
qpe
);

	@src/qpipe/stages/register_stage_containers.cpp

30 
	~"qpe/¡ages/»gi¡”_¡age_cÚš”s.h
"

31 
	~"qpe/¡ages.h
"

33 
ENTER_NAMESPACE
(
qpe
);

36 
	#MAX_NUM_CLIENTS
 128

	)

38 
	#MAX_NUM_TSCAN_THREADS
 
MAX_NUM_CLIENTS
 * 2

39 
	#MAX_NUM_AGGREGATE_THREADS
 
MAX_NUM_CLIENTS


	)

40 
	#MAX_NUM_PARTIAL_AGGREGATE_THREADS
 
MAX_NUM_CLIENTS
 * 2

41 
	#MAX_NUM_HASH_JOIN_THREADS
 
MAX_NUM_CLIENTS


	)

42 
	#MAX_NUM_SORT_MERGE_JOIN_THREADS
 
MAX_NUM_CLIENTS


	)

43 
	#MAX_NUM_FUNC_CALL_THREADS
 
MAX_NUM_CLIENTS


	)

44 
	#MAX_NUM_SORT_THREADS
 
MAX_NUM_CLIENTS
 * 2

45 
	#MAX_NUM_SORTED_IN_STAGE_THREADS
 
MAX_NUM_CLIENTS


	)

48 
	$»gi¡”_¡age_cÚš”s
()

50 
	`TRACE
Ğ
TRACE_ALWAYS
, "Registering stage containers\n");

52 
»gi¡”_¡age
<
tsÿn_¡age_t
>(
MAX_NUM_TSCAN_THREADS
, 
Œue
);

53 
»gi¡”_¡age
<
agg»g©e_¡age_t
>(
MAX_NUM_AGGREGATE_THREADS
, 
Œue
);

54 
»gi¡”_¡age
<
·¹Ÿl_agg»g©e_¡age_t
>(
MAX_NUM_PARTIAL_AGGREGATE_THREADS
, 
Œue
);

55 
»gi¡”_¡age
<
hash_agg»g©e_¡age_t
>(
MAX_NUM_AGGREGATE_THREADS
, 
Œue
);

56 
»gi¡”_¡age
<
hash_još_¡age_t
>(
MAX_NUM_HASH_JOIN_THREADS
, 
Œue
);

57 
»gi¡”_¡age
<
sÜt_m”ge_još_¡age_t
>(
MAX_NUM_SORT_MERGE_JOIN_THREADS
, 
Œue
);

58 
»gi¡”_¡age
<
pe_hash_još_¡age_t
>(
MAX_NUM_CLIENTS
, 
Œue
);

59 
»gi¡”_¡age
<
func_ÿÎ_¡age_t
>(
MAX_NUM_FUNC_CALL_THREADS
, 
Œue
);

60 
»gi¡”_¡age
<
sÜt_¡age_t
>(
MAX_NUM_SORT_THREADS
, 
Œue
);

61 
»gi¡”_¡age
<
fdump_¡age_t
> (
MAX_NUM_CLIENTS
, 
Œue
);

62 
»gi¡”_¡age
<
sÜ‹d_š_¡age_t
>(
MAX_NUM_SORTED_IN_STAGE_THREADS
, 
Œue
);

63 
»gi¡”_¡age
<
echo_¡age_t
>(
MAX_NUM_CLIENTS
, 
Œue
);

64 
»gi¡”_¡age
<
s›ve_¡age_t
>(
MAX_NUM_CLIENTS
, 
Œue
);

65 
	}
}

67 
EXIT_NAMESPACE
(
qpe
);

	@src/qpipe/stages/sieve.cpp

24 
	~"qpe/¡ages/s›ve.h
"

28 cÚ¡ 
c_¡r
 
	gs›ve_·ck‘_t
::
PACKET_TYPE
 = "SIEVE";

32 cÚ¡ 
c_¡r
 
	gs›ve_¡age_t
::
DEFAULT_STAGE_NAME
 = "SIEVE_STAGE";

36 
	gs›ve_¡age_t
::
	$´oûss_·ck‘
() {

39 
ad­tÜ_t
* 
ad­tÜ
 = 
_ad­tÜ
;

40 
s›ve_·ck‘_t
* 
·ck‘
 = (s›ve_·ck‘_t*)
ad­tÜ
->
	`g‘_·ck‘
();

43 
tu¶e_s›ve_t
* 
s›ve
 = 
·ck‘
->
_s›ve
;

44 
tu¶e_fifo
* 
šput_bufãr
 = 
·ck‘
->
_šput_bufãr
;

45 
di¥©ch”_t
::
	`di¥©ch_·ck‘
(
·ck‘
->
_šput
);

49 
size_t
 
de¡_size
 = 
·ck‘
->
	`ouut_bufãr
()->
	`tu¶e_size
();

50 
¬¿y_gu¬d_t
<> 
de¡_d©a
 = 
Ãw
 [
de¡_size
];

51 
tu¶e_t
 
	`de¡
(
de¡_d©a
, 
de¡_size
);

56 
tu¶e_t
 
¤c
;

57 ià(!
šput_bufãr
->
	`g‘_tu¶e
(
¤c
))

60 ià(
s›ve
->
	`·ss
(
de¡
, 
¤c
))

61 
ad­tÜ
->
	`ouut
(
de¡
);

64 ià(
s›ve
->
	`æush
(
de¡
))

65 
ad­tÜ
->
	`ouut
(
de¡
);

66 
	}
}

	@src/qpipe/stages/sort.cpp

24 
	~"qpe/¡ages/sÜt.h
"

25 
	~"qpe/¡ages/m”ge.h
"

26 
	~"qpe/¡ages/fdump.h
"

27 
	~"qpe/¡ages/fsÿn.h
"

29 
	~<®gÜ™hm
>

30 
	~<¡ršg
>

31 
	~<c¡dlib
>

32 
	~<deque
>

33 
	~<m­
>

34 
	~<li¡
>

36 
usšg
 
	g¡d
::
¡ršg
;

37 
usšg
 
	g¡d
::
deque
;

38 
usšg
 
	g¡d
::
m­
;

39 
usšg
 
	g¡d
::
li¡
;

44 cÚ¡ 
c_¡r
 
	gsÜt_·ck‘_t
::
PACKET_TYPE
 = "SORT";

48 cÚ¡ 
c_¡r
 
	gsÜt_¡age_t
::
DEFAULT_STAGE_NAME
 = "SORT_STAGE";

50 cÚ¡ 
	gsÜt_¡age_t
::
MERGE_FACTOR
 = 8;

52 cÚ¡ 
	gsÜt_¡age_t
::
PAGES_PER_INITIAL_SORTED_RUN
 = 8 * 1024;

56 
æush_·ge
(
qpe
::
·ge
* 
pg
, 
FILE
* 
fe
);

67 
	gsÜt_¡age_t
::
	$check_fšished_m”ges
() {

76 
m”ge_m­_t
::
™”©Ü
 
Ëv–_™
 = 
_m”ge_m­
.
	`begš
();

77 
Ëv–_™
 !ğ
_m”ge_m­
.
	`’d
()) {

78 
Ëv–
 = 
Ëv–_™
->
fœ¡
;

79 
m”ge_li¡_t
 &
m”ges
 = 
Ëv–_™
->
£cÚd
;

80 
m”ge_li¡_t
::
™”©Ü
 
™
 = 
m”ges
.
	`begš
();

81 
™
 !ğ
m”ges
.
	`’d
()) {

83 if(
™
->
_sigÇl_bufãr
->
	`eof
()) {

86 
_run_m­
[
Ëv–
].
	`push_back
(
™
->
_ouut
);

87 
	`TRACE
(
TRACE_DEBUG
, "Added finished merge file %so _run_map[%d]\n",

88 
™
->
_ouut
.
	`d©a
(),

89 
Ëv–
);

92 
	`»move_šput_fes
(
™
->
_šputs
);

93 
™
 = 
m”ges
.
	`”a£
(it);

97 ++
™
;

102 
m”ge_m­_t
::
™”©Ü
 
Şd_Ëv–_™
 = 
Ëv–_™
++;

103 if(
m”ges
.
	`em±y
())

104 
_m”ge_m­
.
	`”a£
(
Şd_Ëv–_™
);

106 
	}
}

110 
	gsÜt_¡age_t
::
	$¡¬t_m”ge
(
Ãw_Ëv–
, 
run_li¡_t
& 
runs
, 
m”ge_çùÜ
)

113 
	`as£¹
(
m”ge_çùÜ
 > 0);

114 
	`as£¹
(
runs
.
	`size
(è>ğ()
m”ge_çùÜ
);

118 
m”ge_li¡_t
 &
m”ges
 = 
_m”ge_m­
[
Ãw_Ëv–
];

119 
m”ges
.
	`»size
(m”ges.
	`size
()+1);

120 
m”ge_t
 &
m”ge
 = 
m”ges
.
	`back
();

123 
run_li¡_t
 
m”ge_šputs
;

124 
bufãr_li¡_t
 
fsÿn_bufãrs
;

127 
run_li¡_t
::
™”©Ü
 
™
 = 
runs
.
	`begš
();

128 
i
 = 0; i < 
m”ge_çùÜ
; i++) {

131 
c_¡r
 
run_f’ame
 = *
™
;

132 
™
 = 
runs
.
	`”a£
(it);

134 
fsÿn_·ck‘_t
* 
p
;

135 
tu¶e_fifo
* 
buf
 = 
Ãw
 
	`tu¶e_fifo
(
_tu¶e_size
);

138 
c_¡r
 
	`fsÿn_·ck‘_id
("SORT_FSCAN_PACKET_%d", 
i
);

140 
p
 = 
Ãw
 
	`fsÿn_·ck‘_t
(
fsÿn_·ck‘_id
,

141 
buf
,

142 
Ãw
 
	`ŒivŸl_f‹r_t
(
_tu¶e_size
),

143 
run_f’ame
.
	`d©a
());

144 
di¥©ch”_t
::
	`di¥©ch_·ck‘
(
p
);

146 
m”ge
.
_šputs
.
	`push_back
(
run_f’ame
.
	`d©a
());

147 
fsÿn_bufãrs
.
	`push_back
(
buf
);

152 
m”ge_·ck‘_t
* 
mp
;

153 
tu¶e_fifo
* 
m”ge_out
 = 
Ãw
 
	`tu¶e_fifo
(
_tu¶e_size
);

155 
	`TRACE
(
TRACE_ALWAYS
,

157 
	`as£¹
(0);

158 
mp
 = 
Ãw
 
	`m”ge_·ck‘_t
("SORT_MERGE_PACKET",

159 
m”ge_out
,

160 
Ãw
 
	`ŒivŸl_f‹r_t
(
_tu¶e_size
),

161 
fsÿn_bufãrs
,

162 
_exŒaù
->
	`şÚe
(), 
_com·»
->clone());

163 
di¥©ch”_t
::
	`di¥©ch_·ck‘
(
mp
);

168 if(
Ãw_Ëv–
 < 0) {

169 
m”ge
.
_sigÇl_bufãr
 = 
m”ge_out
;

176 
fdump_·ck‘_t
* 
å
;

177 
tu¶e_fifo
* 
fdump_out
;

178 
c_¡r
 
fe_Çme
;

182 
	`fşo£
(
	`ü—‹_tmp_fe
(
fe_Çme
, "merged-run"));

183 
fdump_out
 = 
Ãw
 
	`tu¶e_fifo
(
_tu¶e_size
);

185 
å
 = 
Ãw
 
	`fdump_·ck‘_t
("SORT_FDUMP_PACKET",

186 
fdump_out
,

187 
Ãw
 
	`ŒivŸl_f‹r_t
(
m”ge_out
->
	`tu¶e_size
()),

188 
m”ge_out
,

189 
fe_Çme
.
	`d©a
(),

190 &
_mÚ™Ü
);

191 
di¥©ch”_t
::
	`di¥©ch_·ck‘
(
å
);

194 
m”ge
.
_ouut
 = 
fe_Çme
;

195 
m”ge
.
_sigÇl_bufãr
 = 
fdump_out
;

196 
	}
}

204 
	gsÜt_¡age_t
::
	$¡¬t_Ãw_m”ges
() {

207 
	`TRACE
(
TRACE_DEBUG
, "_run_map has size %zd\n",

208 
_run_m­
.
	`size
());

212 
run_m­_t
::
™”©Ü
 
Ëv–_™
 = 
_run_m­
.
	`begš
();

213 
Ëv–_™
 !ğ
_run_m­
.
	`’d
()) {

215 
Ëv–
 = 
Ëv–_™
->
fœ¡
;

216 
	`TRACE
(
TRACE_DEBUG
, "RuÂšg oÀËv– %d\n", 
Ëv–
);

219 
run_li¡_t
 &
runs
 = 
Ëv–_™
->
£cÚd
;

220 
boŞ
 
¡¬‹d_m”ges
 = 
çl£
;

221 
runs
.
	`size
(è>ğ
MERGE_FACTOR
) {

223 
	`¡¬t_m”ge
(
Ëv–
+1, 
runs
, 
MERGE_FACTOR
);

224 
¡¬‹d_m”ges
 = 
Œue
;

228 
run_m­_t
::
™”©Ü
 
cu¼_Ëv–_™
 = 
Ëv–_™
++;

229 
run_m­_t
::
™”©Ü
 
Ãxt_Ëv–_™
 = 
Ëv–_™
;

231 
	`TRACE
(
TRACE_DEBUG
, "curr_level = %d ;‚ext_level = %d\n",

232 
cu¼_Ëv–_™
->
fœ¡
,

233 
Ãxt_Ëv–_™
->
fœ¡
);

239 if(
runs
.
	`em±y
()) {

240 
_run_m­
.
	`”a£
(
cu¼_Ëv–_™
);

247 if(!
_sÜtšg_fšished
 || 
¡¬‹d_m”ges
)

255 
Ãxt_run_Ëv–
 =

256 (
Ãxt_Ëv–_™
 =ğ
_run_m­
.
	`’d
()è? -1 :‚ext_Ëv–_™->
fœ¡
;

263 
m”ge_m­_t
::
™”©Ü
 
m”ges
 = 
_m”ge_m­
.
	`begš
();

264 
lowe¡_m”ge_Ëv–
 = (
m”ges
 =ğ
_m”ge_m­
.
	`’d
())? -1 : m”ges->
fœ¡
;

267 
	`TRACE
(
TRACE_DEBUG
, "lowest_merge_level = %d ;‚ext_run_level = %d\n",

268 
lowe¡_m”ge_Ëv–
,

269 
Ãxt_run_Ëv–
);

276 
Ãxt_size
, 
Ãxt_Ëv–
;

277 ià((
lowe¡_m”ge_Ëv–
 >ğ0è&& (lowe¡_m”ge_Ëv– <ğ
Ëv–
)) {

284 ià((
lowe¡_m”ge_Ëv–
 < 0è&& (
Ãxt_run_Ëv–
 < 0)) {

289 
	`¡¬t_m”ge
(-1, 
runs
,„uns.
	`size
());

290 
_run_m­
.
	`”a£
(
cu¼_Ëv–_™
);

293 ià(
Ãxt_run_Ëv–
 < 0) {

296 
Ãxt_Ëv–
 = 
lowe¡_m”ge_Ëv–
;

297 
Ãxt_size
 = 
m”ges
->
£cÚd
.
	`size
();

299 ià(
lowe¡_m”ge_Ëv–
 < 0) {

301 
Ãxt_Ëv–
 = 
Ãxt_run_Ëv–
;

302 
Ãxt_size
 = 
Ãxt_Ëv–_™
->
£cÚd
.
	`size
();

304 if(
lowe¡_m”ge_Ëv–
 > 
Ãxt_run_Ëv–
) {

306 
Ãxt_Ëv–
 = 
Ãxt_run_Ëv–
;

307 
Ãxt_size
 = 
Ãxt_Ëv–_™
->
£cÚd
.
	`size
();

309 if(
lowe¡_m”ge_Ëv–
 < 
Ãxt_run_Ëv–
) {

311 
Ãxt_Ëv–
 = 
lowe¡_m”ge_Ëv–
;

312 
Ãxt_size
 = 
m”ges
->
£cÚd
.
	`size
();

316 
Ãxt_Ëv–
 = 
lowe¡_m”ge_Ëv–
;

317 
Ãxt_size
 = 
m”ges
->
£cÚd
.
	`size
(è+ 
Ãxt_Ëv–_™
->second.size();

321 
	`TRACE
(
TRACE_DEBUG
, "next_size = %d ;‚ext_level = %d\n",

322 
Ãxt_size
,

323 
Ãxt_Ëv–
);

327 
»quœed_m”ges
 = (
Ãxt_size
 + 
MERGE_FACTOR
-1)/MERGE_FACTOR;

328 
pÙ’tŸl_m”ges
 = (
Ãxt_size
 + 
runs
.
	`size
(è+ 
MERGE_FACTOR
-1)/MERGE_FACTOR;

329 if(
pÙ’tŸl_m”ges
 > 
»quœed_m”ges
) {

331 
	`¡¬t_m”ge
(
Ãxt_Ëv–
, 
runs
,„uns.
	`size
());

335 
run_li¡_t
 &
Ãxt_runs
 = 
_run_m­
[
Ãxt_Ëv–
];

336 
Ãxt_runs
.
	`š£¹
Òext_runs.
	`’d
(), 
runs
.
	`begš
(),„uns.end());

341 
_run_m­
.
	`”a£
(
cu¼_Ëv–_™
);

343 
	}
}

353 
tu¶e_fifo
 *
	gsÜt_¡age_t
::
	$mÚ™Ü_m”ge_·ck‘s
() {

355 
ü™iÿl_£ùiÚ_t
 
	`cs
(
_mÚ™Ü
.
_lock
);

358 if(
_mÚ™Ü
.
	`wa™_hŞdšg_lock
())

360 
	`±h»ad_ex™
(
NULL
);

365 
	`check_fšished_m”ges
();

368 
	`¡¬t_Ãw_m”ges
();

371 
m”ge_m­_t
::
™”©Ü
 
m”ge
 = 
_m”ge_m­
.
	`begš
();

373 if(
m”ge
 !ğ
_m”ge_m­
.
	`’d
(è&& m”ge->
fœ¡
 < 0)

375 
	`±h»ad_ex™
(&
m”ge
->
£cÚd
.
	`äÚt
().
_sigÇl_bufãr
);

379  
NULL
;

380 
	}
}

384 
	gsÜt_¡age_t
::
	$´oûss_·ck‘
() {

386 
sÜt_·ck‘_t
 *
·ck‘
 = (sÜt_·ck‘_ˆ*)
_ad­tÜ
->
	`g‘_·ck‘
();

388 
_šput_bufãr
 = 
·ck‘
->_input_buffer;

389 
_tu¶e_size
 = 
_šput_bufãr
->
	`tu¶e_size
();

390 
_com·»
 = 
·ck‘
->_compare;

391 
_exŒaù
 = 
·ck‘
->_extract;

392 
_sÜtšg_fšished
 = 
çl£
;

395 
di¥©ch”_t
::
	`di¥©ch_·ck‘
(
·ck‘
->
_šput
);

399 if(!
_šput_bufãr
->
	`’su»_»ad_»ady
())

403 
gu¬d
<
qpe
::
·ge
> 
out_·ge
 = qpe::·ge::
	`®loc
(
_tu¶e_size
);

406 
ÿ·c™y
 =

407 
qpe
::
·ge
::
	`ÿ·c™y
(
_šput_bufãr
->
	`·ge_size
(), 
_tu¶e_size
);

408 
tu¶e_couÁ
 = 
PAGES_PER_INITIAL_SORTED_RUN
 * 
ÿ·c™y
;

409 
hšt_veùÜ_t
 
¬¿y
;

410 
¬¿y
.
	`»£rve
(
tu¶e_couÁ
);

415 
th»ad_t
 *
mÚ™Ü
;

416 
mÚ™Ü
 = 
	`memb”_func_th»ad
(
this
,

417 &
sÜt_¡age_t
::
mÚ™Ü_m”ge_·ck‘s
,

419 
_mÚ™Ü_th»ad
 = 
	`th»ad_ü—‹
(
mÚ™Ü
);

423 
boŞ
 
fœ¡_run
 = 
Œue
;

427 
·ge_Œash_¡ack
 
·ges
;

428 
¬¿y
.
	`ş—r
();

429 
i
=0; i < 
PAGES_PER_INITIAL_SORTED_RUN
; i++) {

432 
qpe
::
·ge
* 
p
 = qpe::·ge::
	`®loc
(
_šput_bufãr
->
	`tu¶e_size
());

433 ià(!
_šput_bufãr
->
	`cİy_·ge
(
p
)) {

434 
p
->
	`ä“
();

439 
·ges
.
	`add
(
p
);

442 
qpe
::
·ge
::
™”©Ü
 
™
=
p
->
	`begš
(); iˆ!ğp->
	`’d
(); ++it) {

443 
hšt
 = 
_exŒaù
->
	`exŒaù_hšt
(*
™
);

444 
¬¿y
.
	`push_back
(
	`hšt_tu¶e_·œ_t
(
hšt
, 
™
->
d©a
));

449 
¡d
::
	`sÜt
(
¬¿y
.
	`begš
(),‡¼ay.
	`’d
(), 
	`tu¶e_Ëss_t
(
_exŒaù
, 
_com·»
));

452 
boŞ
 
eof
 = !
_šput_bufãr
->
	`’su»_»ad_»ady
();

455 if(
fœ¡_run
 && 
eof
) {

456 
_mÚ™Ü
.
	`ÿnûl
();

457 
tu¶e_t
 
	`out
(
NULL
, 
·ck‘
->
_ouut_f‹r
->
	`šput_tu¶e_size
());

458 
hšt_veùÜ_t
::
™”©Ü
 
™
=
¬¿y
.
	`begš
(); iˆ!ğ¬¿y.
	`’d
(); ++it) {

459 
out
.
d©a
 = 
™
->data;

460 
_ad­tÜ
->
	`ouut
(
out
);

466 
fœ¡_run
 = 
çl£
;

469 
c_¡r
 
fe_Çme
;

470 
gu¬d
<
FILE
> 
fe
 = 
	`ü—‹_tmp_fe
(
fe_Çme
, "sorted-run");

474 
hšt_veùÜ_t
::
™”©Ü
 
™
=
¬¿y
.
	`begš
(); iˆ!ğ¬¿y.
	`’d
(); ++it) {

476 
tu¶e_t
 
	`out
(
™
->
d©a
, 
_tu¶e_size
);

477 
out_·ge
->
	`­³nd_tu¶e
(
out
);

480 if(
out_·ge
->
	`fuÎ
())

481 
	`æush_·ge
(
out_·ge
, 
fe
);

485 if(!
out_·ge
->
	`em±y
())

486 
	`æush_·ge
(
out_·ge
, 
fe
);

489 
ü™iÿl_£ùiÚ_t
 
	`cs
(
_mÚ™Ü
.
_lock
);

490 
run_li¡_t
 &
runs
 = 
_run_m­
[0];

491 
runs
.
	`push_back
(
fe_Çme
);

492 
_sÜtšg_fšished
 = 
eof
;

493 
_mÚ™Ü
.
	`nÙify_hŞdšg_lock
();

495 
	`TRACE
(
TRACE_DEBUG
, "Added f% tØ_run_m­[0]\n", 
fe_Çme
.
	`d©a
());

497 } !
_sÜtšg_fšished
);

500 
tu¶e_fifo
* 
m”ge_ouut
 = 
th»ad_još
<tu¶e_fifo>(
_mÚ™Ü_th»ad
);

503 
ü™iÿl_£ùiÚ_t
 
	`cs
(
_mÚ™Ü
.
_lock
);

504 
_mÚ™Ü_th»ad
 = 0;

506 if(
m”ge_ouut
 =ğ
NULL
)

507 
	`THROW1
(
QPeExû±iÚ
, "Merge failed. Terminating Sort");

511 
tu¶e_t
 
out
;

512 
m”ge_ouut
->
	`g‘_tu¶e
(
out
))

513 
_ad­tÜ
->
	`ouut
(
out
);

515 
	}
}

522 
	$æush_·ge
(
qpe
::
·ge
* 
pg
, 
FILE
* 
fe
) {

523 
pg
->
	`fwr™e_fuÎ_·ge
(
fe
);

524 
pg
->
	`ş—r
();

525 
	}
}

529 
	gsÜt_¡age_t
::
	$´št_runs
() {

530 
run_m­_t
::
™”©Ü
 
Ëv–_™
 = 
_run_m­
.
	`begš
();

531  ; 
Ëv–_™
 !ğ
_run_m­
.
	`’d
(); ++level_it) {

532 
Ëv–
 = 
Ëv–_™
->
fœ¡
;

533 
run_li¡_t
 &
runs
 = 
Ëv–_™
->
£cÚd
;

534 
	`TRACE
(
TRACE_ALWAYS
, "Lev– %d (%zd):\n", 
Ëv–
, 
runs
.
	`size
());

535 
run_li¡_t
::
™”©Ü
 
™
 = 
runs
.
	`begš
();

536  ; 
™
 !ğ
runs
.
	`’d
(); ++it)

537 
	`TRACE
(
TRACE_ALWAYS
, "\t%s\n", 
™
->
	`d©a
());

540 
	}
}

544 
	gsÜt_¡age_t
::
	$´št_m”ges
() {

545 
m”ge_m­_t
::
™”©Ü
 
Ëv–_™
 = 
_m”ge_m­
.
	`begš
();

546  ; 
Ëv–_™
 !ğ
_m”ge_m­
.
	`’d
(); ++level_it) {

547 
Ëv–
 = 
Ëv–_™
->
fœ¡
;

548 
m”ge_li¡_t
 &
m”ges
 = 
Ëv–_™
->
£cÚd
;

549 
	`TRACE
(
TRACE_ALWAYS
, "Lev– %d (%zd)\n", 
Ëv–
, 
m”ges
.
	`size
());

550 
m”ge_li¡_t
::
™”©Ü
 
™
 = 
m”ges
.
	`begš
();

551  ; 
™
 !ğ
m”ges
.
	`’d
(); ++it) {

552 
	`TRACE
(
TRACE_ALWAYS
, "\t% <=\n", 
™
->
_ouut
.
	`d©a
());

553 
run_li¡_t
::
™”©Ü
 
run_™
 = 
™
->
_šputs
.
	`begš
();

554  ; 
run_™
 !ğ
™
->
_šputs
.
	`’d
(); ++run_it)

555 
	`TRACE
(
TRACE_ALWAYS
, "\t\t%s\n", 
run_™
->
	`d©a
());

559 
	}
}

563 
	gsÜt_¡age_t
::
	$»move_šput_fes
(
run_li¡_t
& 
fes
) {

566 
run_li¡_t
::
™”©Ü
 
™
=
fes
.
	`begš
(); iˆ!ğfes.
	`’d
(); ++it) {

567 if(
	`»move
(
™
->
	`d©a
()))

568 
	`TRACE
(
TRACE_ALWAYS
, "UÇbËØ»mov‹m°f%s", 
™
->
	`d©a
());

569 
	`TRACE
(
TRACE_TEMP_FILE
, "Removed fšishedem°f%s\n", 
™
->
	`d©a
());

571 
	}
}

	@src/qpipe/stages/sort_merge_join.cpp

28 
	~"qpe/¡ages/sÜt_m”ge_još.h
"

30 
	~<c¡ršg
>

31 
	~<®gÜ™hm
>

34 
ENTER_NAMESPACE
(
qpe
);

37 cÚ¡ 
c_¡r
 
	gsÜt_m”ge_još_·ck‘_t
::
PACKET_TYPE
 = "SORT_MERGE_JOIN";

39 cÚ¡ 
c_¡r
 
	gsÜt_m”ge_još_¡age_t
::
DEFAULT_STAGE_NAME
 = "SORT_MERGE_JOIN";

43 
	gsÜt_m”ge_još_¡age_t
::
	$´oûss_·ck‘
() {

45 
sÜt_m”ge_još_·ck‘_t
* 
·ck‘
 = (sÜt_m”ge_još_·ck‘_ˆ*)
_ad­tÜ
->
	`g‘_·ck‘
();

47 
_još
 = 
·ck‘
->_join;

48 
_com·»
 = 
·ck‘
->_compare;

50 
tu¶e_fifo
 *
right_bufãr
 = 
·ck‘
->
_right_bufãr
;

51 
di¥©ch”_t
::
	`di¥©ch_·ck‘
(
·ck‘
->
_right
);

52 
tu¶e_fifo
 *
Ëá_bufãr
 = 
·ck‘
->
_Ëá_bufãr
;

53 
di¥©ch”_t
::
	`di¥©ch_·ck‘
(
·ck‘
->
_Ëá
);

56 if(!
right_bufãr
->
	`’su»_»ad_»ady
()) {

62 if(!
Ëá_bufãr
->
	`’su»_»ad_»ady
())

67 
tu¶e_t
 
	`Ëá
(
NULL
, 
_još
->
	`Ëá_tu¶e_size
());

68 
tu¶e_t
 
	`right
(
NULL
, 
_još
->
	`right_tu¶e_size
());

69 
¬¿y_gu¬d_t
<> 
d©a
 = 
Ãw
 [
_još
->
	`ouut_tu¶e_size
()];

72 ià(!
Ëá_bufãr
->
	`g‘_tu¶e
(
Ëá
))

75 ià(!
right_bufãr
->
	`g‘_tu¶e
(
right
))

79 cÚ¡ * 
Ëá_key
;

80 cÚ¡ * 
right_key
;

86 
Ëá_key
 = 
_još
->
	`Ëá_key
(
Ëá
);

87 
right_key
 = 
_još
->
	`right_key
(
right
);

92 (
_com·»
->
	`İ”©Ü
 ()(
Ëá_key
, 
right_key
)) < 0) {

93 ià(!
Ëá_bufãr
->
	`g‘_tu¶e
(
Ëá
))

95 
Ëá_key
 = 
_još
->
	`Ëá_key
(
Ëá
);

102 (
_com·»
->
	`İ”©Ü
 ()(
Ëá_key
, 
right_key
)) > 0) {

103 ià(!
right_bufãr
->
	`g‘_tu¶e
(
right
))

105 
right_key
 = 
_još
->
	`right_key
(
right
);

122 
·ge_poŞ
* 
poŞ
 = 
m®loc_·ge_poŞ
::
	`š¡ªû
();

123 
qpe
::
·ge
* 
right_h—d_·ge
 = qpe::·ge::
	`®loc
(
_još
->
	`right_tu¶e_size
(), 
poŞ
);

124 
qpe
::
·ge
* 
right_·ge
 = 
right_h—d_·ge
;

128 cÚ¡ * 
right_key_Ãw
 = 
_još
->
	`right_key
(
right
);

129 
	`memcmp
(
right_key_Ãw
, 
right_key
, 
_još
->
	`key_size
()) == 0) {

131 ià(
right_·ge
->
	`fuÎ
()) {

132 
qpe
::
·ge
* 
Ãw_·ge
 = qpe::·ge::
	`®loc
(
_još
->
	`right_tu¶e_size
(), 
poŞ
);

133 
right_·ge
->
Ãxt
 = 
Ãw_·ge
;

134 
Ãw_·ge
->
Ãxt
 = 
NULL
;

135 
right_·ge
 = 
Ãw_·ge
;

139 
right_·ge
->
	`­³nd_tu¶e
(
right
);

142 ià(!
right_bufãr
->
	`g‘_tu¶e
(
right
))

144 
right_key_Ãw
 = 
_još
->
	`right_key
(
right
);

151 cÚ¡ * 
Ëá_key_Ãw
 = 
_još
->
	`Ëá_key
(
Ëá
);

152 
	`memcmp
(
Ëá_key_Ãw
, 
Ëá_key
, 
_još
->
	`key_size
()) == 0) {

155 
right_·ge
 = 
right_h—d_·ge
;

156 
right_·ge
 !ğ
NULL
) {

157 
qpe
::
·ge
::
™”©Ü
 
™
 = 
right_·ge
->
	`begš
();

158 
qpe
::
·ge
::
™”©Ü
 
’d
 = 
right_·ge
->
	`’d
();

159 
™
 !ğ
’d
) {

160 
tu¶e_t
 
right_tu¶e_to_add
 = 
™
.
	`advªû
();

161 
tu¶e_t
 
	`out
(
d©a
, 
_još
->
	`ouut_tu¶e_size
());

162 
_još
->
	`još
(
out
, 
Ëá
, 
right_tu¶e_to_add
);

163 
_ad­tÜ
->
	`ouut
(
out
);

166 
right_·ge
 =„ight_·ge->
Ãxt
;

170 ià(!
Ëá_bufãr
->
	`g‘_tu¶e
(
Ëá
))

172 
Ëá_key_Ãw
 = 
_još
->
	`Ëá_key
(
Ëá
);

176 
right_·ge
 = 
right_h—d_·ge
;

177 
right_·ge
 !ğ
NULL
) {

178 
qpe
::
·ge
* 
Ãxt_right_·ge
 = 
right_·ge
->
Ãxt
;

179 
right_·ge
->
	`ä“
();

180 
right_·ge
 = 
Ãxt_right_·ge
;

184 
	}
}

186 
EXIT_NAMESPACE
(
qpe
);

	@src/qpipe/stages/sorted_in.cpp

24 
	~"qpe/¡ages/sÜ‹d_š.h
"

28 cÚ¡ 
c_¡r
 
	gsÜ‹d_š_¡age_t
::
DEFAULT_STAGE_NAME
 = "SORTED_IN_STAGE";

32 cÚ¡ 
c_¡r
 
	gsÜ‹d_š_·ck‘_t
::
PACKET_TYPE
 = "SORTED_IN";

49 
	gsÜ‹d_š_¡age_t
::
	$´oûss_·ck‘
() {

52 
sÜ‹d_š_·ck‘_t
* 
·ck‘
;

53 
·ck‘
 = (
sÜ‹d_š_·ck‘_t
*è
_ad­tÜ
->
	`g‘_·ck‘
();

54 
tu¶e_fifo
* 
Ëá_šput
 = 
·ck‘
->
_Ëá_šput
;

55 
tu¶e_fifo
* 
right_šput
 = 
·ck‘
->
_right_šput
;

56 
key_exŒaùÜ_t
* 
Ëá_exŒaùÜ
 = 
·ck‘
->
_Ëá_exŒaùÜ
;

57 
key_exŒaùÜ_t
* 
right_exŒaùÜ
 = 
·ck‘
->
_right_exŒaùÜ
;

58 
key_com·»_t
* 
com·»
 = 
·ck‘
->
_com·»
;

59 
boŞ
 
»jeù_m©ches
 = 
·ck‘
->
_»jeù_m©ches
;

62 
di¥©ch”_t
::
	`di¥©ch_·ck‘
(
·ck‘
->
_Ëá
);

64 
tu¶e_t
 
Ëá
;

65 cÚ¡ * 
Ëá_key
;

66 
Ëá_hšt
;

68 
tu¶e_t
 
right
;

69 cÚ¡ * 
right_key
;

70 
right_hšt
;

73 if(!
Ëá_šput
->
	`g‘_tu¶e
(
Ëá
))

75 
di¥©ch”_t
::
	`di¥©ch_·ck‘
(
·ck‘
->
_right
);

76 
Ëá_key
 = 
Ëá_exŒaùÜ
->
	`exŒaù_key
(
Ëá
);

77 
Ëá_hšt
 = 
Ëá_exŒaùÜ
->
	`exŒaù_hšt
(
Ëá_key
);

92 
diff
;

96 if(!
right_šput
->
	`g‘_tu¶e
(
right
)) {

102 if(
»jeù_m©ches
) {

103 
Ëá_šput
->
	`g‘_tu¶e
(
Ëá
))

104 
_ad­tÜ
->
	`ouut
(
Ëá
);

112 
right_key
 = 
right_exŒaùÜ
->
	`exŒaù_key
(
right
);

113 
right_hšt
 = 
right_exŒaùÜ
->
	`exŒaù_hšt
(
right_key
);

117 
diff
 = 
Ëá_hšt
 - 
right_hšt
;

118 if(!
diff
 && 
Ëá_exŒaùÜ
->
	`key_size
() > ())

119 
diff
 = (*
com·»
)(
Ëá_key
, 
right_key
);

121 } 
diff
 > 0);

126 
diff
 <= 0) {

129 if((
diff
 =ğ0è!ğ
»jeù_m©ches
)

130 
_ad­tÜ
->
	`ouut
(
Ëá
);

135 if(!
Ëá_šput
->
	`g‘_tu¶e
(
Ëá
))

141 
Ëá_key
 = 
Ëá_exŒaùÜ
->
	`exŒaù_key
(
Ëá
);

142 
Ëá_hšt
 = 
Ëá_exŒaùÜ
->
	`exŒaù_hšt
(
Ëá_key
);

146 
diff
 = 
Ëá_hšt
 - 
right_hšt
;

147 if(!
diff
 && 
Ëá_exŒaùÜ
->
	`key_size
() > ())

148 
diff
 = (*
com·»
)(
Ëá_key
, 
right_key
);

152 
	`uÄ—chabË
();

153 
	}
}

	@src/qpipe/stages/tscan.cpp

32 
	~"qpe/¡ages/tsÿn.h
"

33 
	~<uni¡d.h
>

35 
	~"sm_vas.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

39 
ENTER_NAMESPACE
(
qpe
);

48 cÚ¡ 
c_¡r
 
	gtsÿn_·ck‘_t
::
PACKET_TYPE
 = "TSCAN";

50 cÚ¡ 
c_¡r
 
	gtsÿn_¡age_t
::
DEFAULT_STAGE_NAME
 = "TSCAN_STAGE";

52 
	#KB
 1024

	)

53 
	#MB
 (1024*
KB
)

	)

55 
	gtsÿn_·ck‘_t
::
	$tsÿn_·ck‘_t
(cÚ¡ 
c_¡r
& 
·ck‘_id
,

56 
tu¶e_fifo
* 
ouut_bufãr
,

57 
tu¶e_f‹r_t
* 
ouut_f‹r
,

58 
ss_m
* 
db
,

59 
bË_desc_t
* 
bË
,

60 
xù_t
* 
pxù
,

61 
lock_mode_t
 
lm
)

62 : 
	`·ck‘_t
(
·ck‘_id
, 
PACKET_TYPE
, 
ouut_bufãr
, 
ouut_f‹r
,

63 
	`ü—‹_¶ª
(
ouut_f‹r
, 
bË
),

64 
Œue
,

65 
Œue


67 
	`_db
(
db
), 
	`_bË
(
bË
), 
	`_xù
(
pxù
), 
	$_lm
(
lm
)

69 
	`as£¹
(
_db
);

70 
	`as£¹
(
_bË
);

71 
	`as£¹
(
_xù
);

72 
	}
}

75 
qu”y_¶ª
* 
	gtsÿn_·ck‘_t
::
	$ü—‹_¶ª
(
tu¶e_f‹r_t
* 
f‹r
,

76 
bË_desc_t
* 
bË
)

78 
c_¡r
 
	`aùiÚ
("%s:%s", 
PACKET_TYPE
.
	`d©a
(), 
bË
->
	`Çme
());

79  
Ãw
 
	`qu”y_¶ª
(
aùiÚ
, 
f‹r
->
	`to_¡ršg
(), 
NULL
, 0);

80 
	}
}

82 
	gtsÿn_·ck‘_t
::
	$deş¬e_wÜk”_Ãeds
(
»sourû_deş¬e_t
* 
deş¬e
)

84 
deş¬e
->
	`deş¬e
(
_·ck‘_ty³
, 1);

86 
	}
}

92 cÚ¡ 
size_t
 
	gtsÿn_¡age_t
::
TSCAN_BULK_READ_BUFFER_SIZE
=256*
KB
;

115 
	gtsÿn_¡age_t
::
	$´oûss_·ck‘
()

117 
ad­tÜ_t
* 
ad­tÜ
 = 
_ad­tÜ
;

118 
tsÿn_·ck‘_t
* 
·ck‘
 = (tsÿn_·ck‘_t*)
ad­tÜ
->
	`g‘_·ck‘
();

119 
smth»ad_t
::
	`me
()->
	`©ch_xù
(
·ck‘
->
_xù
);

122 
sim¶e_bË_™”_t
 
	`tsÿÂ”
(
·ck‘
->
_db
,…ack‘->
_bË
,…ack‘->
_lm
);

123 
boŞ
 
	`eof
(
çl£
);

124 
pš_i
* 
	`hªdË
(
NULL
);

125 
ušt
 
pút
=0;

126 
ušt
 
	`tsz
(
·ck‘
->
_bË
->
	`maxsize
());

129 
w_rc_t
 
e
 = 
tsÿÂ”
.
	`Ãxt
(
eof
,
hªdË
);

130 !
e
.
	`is_”rÜ
(è&& !
eof
) {

137 
tu¶e_t
 
	`©
((*)
hªdË
->
	`body
(),
tsz
);

138 #w¬nšg 
MA
:
Check
 
th©
 
this
 
dÛs
 
nÙ
  
ªythšg
.

139 
ad­tÜ
->
	`ouut
(
©
);

141 
e
 = 
tsÿÂ”
.
	`Ãxt
(
eof
,
hªdË
);

149 
smth»ad_t
::
	`me
()->
	`d‘ach_xù
(
·ck‘
->
_xù
);

150 
	}
}

153 
EXIT_NAMESPACE
(
qpe
);

	@src/sm/shore/shore_asc_sort_buf.cpp

33 
	~"sm/shÜe/shÜe_asc_sÜt_buf.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

39 cÚ¡ 
	gMIN_TUPLES_FOR_SORT
 = 250;

53 
	$com·»_sm®lšt_asc
(cÚ¡ * 
d1
, cÚ¡ * 
d2
)

55 
d©a1
 = *((*)
d1
);

56 
d©a2
 = *((*)
d2
);

57 ià(
d©a1
 > 
d©a2
)  (1);

58 ià(
d©a1
 =ğ
d©a2
)  (0);

60 
	}
}

63 
	$com·»_št_asc
(cÚ¡ * 
d1
, cÚ¡ * 
d2
)

65 
d©a1
 = *((*)
d1
);

66 
d©a2
 = *((*)
d2
);

67 ià(
d©a1
 > 
d©a2
)  (1);

68 ià(
d©a1
 =ğ
d©a2
)  (0);

70 
	}
}

73 
	$com·»_b™_asc
(cÚ¡ * 
d1
, cÚ¡ * 
d2
)

75 
d©a1
 = *((
boŞ
*)
d1
);

76 
d©a2
 = *((
boŞ
*)
d2
);

77 ià(
d©a1
 > 
d©a2
)  (1);

78 ià(
d©a1
 =ğ
d©a2
)  (0);

80 
	}
}

82 
	$com·»_lÚg_asc
(cÚ¡ * 
d1
, cÚ¡ * 
d2
)

84 
d©a1
 = *((*)
d1
);

85 
d©a2
 = *((*)
d2
);

86 ià(
d©a1
 > 
d©a2
)  (1);

87 ià(
d©a1
 =ğ
d©a2
)  (0);

89 
	}
}

91 
	$com·»_doubË_asc
(cÚ¡ * 
d1
, cÚ¡ * 
d2
)

93 
d©a1
 = *((*)
d1
);

94 
d©a2
 = *((*)
d2
);

95 ià(
d©a1
 > 
d©a2
)  (1);

96 ià(
d©a1
 =ğ
d©a2
)  (0);

98 
	}
}

100 
	$com·»_fixch¬_asc
(cÚ¡ * 
d1
, cÚ¡ * 
d2
){

101  (
	`¡rcmp
((*)
d1
, (*)
d2
));

102 
	}
}

104 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

105 
	$com·»_asc
(cÚ¡ * 
d1
, cÚ¡ * 
d2
)

107 
T
 
d©a1
 = *((T*)
d1
);

108 
T
 
d©a2
 = *((T*)
d2
);

109 ià(
d©a1
 > 
d©a2
)  (1);

110 ià(
d©a1
 =ğ
d©a2
)  (0);

112 
	}
}

130 
	gasc_sÜt_mª_im¶
::
	$š™
()

132 
	`as£¹
 (
_±abË
);

135 
_tu¶e_size
 = 0;

138 
ušt_t
 
i
=0; i<
_±abË
->
	`f›ld_couÁ
(); i++)

139 
_tu¶e_size
 +ğ
_±abË
->
	`desc
(
i
)->
	`f›ldmaxsize
();

142 if((
_tu¶e_size
 % 
_±abË
->
	`desc
(0)->
	`f›ldmaxsize
()) != 0) {

143 
_tu¶e_size
 = ((_tu¶e_siz/ 
_±abË
->
	`desc
(0)->
	`f›ldmaxsize
()) + 1) * _ptable->desc(0)->fieldmaxsize();

147 
	`as£¹
 (!
_sÜt_buf
);

148 
	`as£¹
 (
_tu¶e_couÁ
==0);

149 
	`as£¹
 (
_buf_size
==0);

150 
_sÜt_buf
 = 
Ãw
 [
MIN_TUPLES_FOR_SORT
*
_tu¶e_size
];

151 
_buf_size
 = 
MIN_TUPLES_FOR_SORT
;

153 
_is_sÜ‹d
 = 
çl£
;

154 
	}
}

166 
	gasc_sÜt_mª_im¶
::
	$»£t
()

168 
	`as£¹
 (
_±abË
);

170 
	`as£¹
 (
_sÜt_buf
);

172 
	`as£¹
 (
_buf_size
);

174 
	`as£¹
 (
_tu¶e_size
);

177 
	`mem£t
(
_sÜt_buf
, 0, 
_buf_size
);

178 
_is_sÜ‹d
 = 
çl£
;

179 
	}
}

191 
	gasc_sÜt_mª_im¶
::
	$add_tu¶e
(
sÜ‹r_tu¶e
& 
©u¶e
)

193 
	`CRITICAL_SECTION
(
cs
, 
_sÜ‹d_lock
);

196 ià(!
_tu¶e_size
è
	`š™
();

199 ià(
_buf_size
 =ğ
_tu¶e_couÁ
) {

201 * 
tmp
 = 
Ãw
 [(2*
_buf_size
)*
_tu¶e_size
];

202 
	`memıy
(
tmp
, 
_sÜt_buf
, 
_buf_size
*
_tu¶e_size
);

203 
d–‘e
 [] 
_sÜt_buf
;

205 
_sÜt_buf
 = 
tmp
;

206 
_buf_size
 *= 2;

212 
	`fÜm©
(&
©u¶e
, *
_´•row
);

213 
	`as£¹
 (
_´•row
->
_de¡
);

214 
	`memıy
(
_sÜt_buf
+(
_tu¶e_couÁ
*
_tu¶e_size
), 
_´•row
->
_de¡
, _tuple_size);

215 
_tu¶e_couÁ
++;

216 
_is_sÜ‹d
 = 
çl£
;

217 
	}
}

228 
	gasc_sÜt_mª_im¶
::
	$sÜt
()

230 
	`CRITICAL_SECTION
(
cs
, 
_sÜ‹d_lock
);

235 
cout
 << "BefÜsÜtšg: " << 
’dl
;

236 
_±abË
->
	`desc
(0)->
	`ty³
()) {

237 
SQL_BIT
:

238 
i
=0; i<
_tu¶e_couÁ
; i++) {

239 
cout
 << ((
boŞ
*)(
_sÜt_buf
+
i
*
_tu¶e_size
))[0] << " ";

242 
SQL_SMALLINT
:

243 
i
=0; i<
_tu¶e_couÁ
; i++) {

244 
cout
 << ((*)(
_sÜt_buf
+
i
*
_tu¶e_size
))[0] << " ";

247 
SQL_INT
:

248 
i
=0; i<
_tu¶e_couÁ
; i++) {

249 
cout
 << ((*)(
_sÜt_buf
+
i
*
_tu¶e_size
))[0] << " ";

252 
SQL_LONG
:

253 
i
=0; i<
_tu¶e_couÁ
; i++) {

254 
cout
 << ((*)(
_sÜt_buf
+
i
*
_tu¶e_size
))[0] << " ";

257 
SQL_FLOAT
:

258 
i
=0; i<
_tu¶e_couÁ
; i++) {

259 
cout
 << ((*)(
_sÜt_buf
+
i
*
_tu¶e_size
))[0] << " ";

263 
cout
 << 
’dl
;

268 
_±abË
->
	`desc
(0)->
	`ty³
()) {

269 
SQL_BIT
:

270 
	`qsÜt
(
_sÜt_buf
, 
_tu¶e_couÁ
, 
_tu¶e_size
, 
com·»_b™_asc
); ;

271 
SQL_SMALLINT
:

272 
	`qsÜt
(
_sÜt_buf
, 
_tu¶e_couÁ
, 
_tu¶e_size
, 
com·»_sm®lšt_asc
); ;

273 
SQL_INT
:

274 
	`qsÜt
(
_sÜt_buf
, 
_tu¶e_couÁ
, 
_tu¶e_size
, 
com·»_št_asc
); ;

275 
SQL_LONG
:

276 
	`qsÜt
(
_sÜt_buf
, 
_tu¶e_couÁ
, 
_tu¶e_size
, 
com·»_lÚg_asc
); ;

277 
SQL_FLOAT
:

278 
	`qsÜt
(
_sÜt_buf
, 
_tu¶e_couÁ
, 
_tu¶e_size
, 
com·»_doubË_asc
); ;

279 
SQL_FIXCHAR
:

280 
	`qsÜt
(
_sÜt_buf
, 
_tu¶e_couÁ
, 
_tu¶e_size
, 
com·»_fixch¬_asc
); ;

283 
	`as£¹
(0);

285 
_is_sÜ‹d
 = 
Œue
;

288 
cout
 << "Aá” sÜtšg: " << 
’dl
;

289 
_±abË
->
	`desc
(0)->
	`ty³
()) {

290 
SQL_BIT
:

291 
i
=0; i<
_tu¶e_couÁ
; i++) {

292 
cout
 << ((
boŞ
*)(
_sÜt_buf
+
i
*
_tu¶e_size
))[0] << " ";

295 
SQL_SMALLINT
:

296 
i
=0; i<
_tu¶e_couÁ
; i++) {

297 
cout
 << ((*)(
_sÜt_buf
+
i
*
_tu¶e_size
))[0] << " ";

300 
SQL_INT
:

301 
i
=0; i<
_tu¶e_couÁ
; i++) {

302 
cout
 << ((*)(
_sÜt_buf
+
i
*
_tu¶e_size
))[0] << " ";

305 
SQL_LONG
:

306 
i
=0; i<
_tu¶e_couÁ
; i++) {

307 
cout
 << ((*)(
_sÜt_buf
+
i
*
_tu¶e_size
))[0] << " ";

310 
SQL_FLOAT
:

311 
i
=0; i<
_tu¶e_couÁ
; i++) {

312 
cout
 << ((*)(
_sÜt_buf
+
i
*
_tu¶e_size
))[0] << " ";

316 
cout
 << 
’dl
;

318 
	}
}

331 
w_rc_t
 
	gasc_sÜt_mª_im¶
::
	$g‘_sÜt_™”
(
ss_m
* 
db
,

332 
asc_sÜt_™”_im¶
* &
sÜt_™”
)

334 
sÜt_™”
 = 
Ãw
 
	`asc_sÜt_™”_im¶
(
db
, 
_p¥ecifiùabË
, 
this
);

335  (
RCOK
);

336 
	}
}

350 
boŞ
 
	gasc_sÜt_mª_im¶
::
	$g‘_sÜ‹d
(cÚ¡ 
šdex
, 
sÜ‹r_tu¶e
* 
±u¶e
)

352 
	`CRITICAL_SECTION
(
cs
, 
_sÜ‹d_lock
);

354 ià(
_is_sÜ‹d
) {

355 ià(
šdex
 >=0 && index < 
_tu¶e_couÁ
) {

356  (
	`lßd
(
±u¶e
, 
_sÜt_buf
 + (
šdex
*
_tu¶e_size
)));

359  (
çl£
);

361 
	`TRACE
Ğ
TRACE_DEBUG
, "buffer‚ot sorted yet...\n");

362  (
çl£
);

363 
	}
}

	@src/sm/shore/shore_client.cpp

31 
	~"sm/shÜe/shÜe_ş›Á.h
"

33 
ENTER_NAMESPACE
(
shÜe
);

44 
boŞ
 
	g_abÜt_‹¡
 = 
çl£
;

45 
	gba£_ş›Á_t
::
	$abÜt_‹¡
()

47 
_abÜt_‹¡
 = 
Œue
;

48 
	}
}

49 
	gba£_ş›Á_t
::
	$»sume_‹¡
()

51 
_abÜt_‹¡
 = 
çl£
;

52 
	}
}

53 
boŞ
 
	gba£_ş›Á_t
::
	$is_‹¡_abÜ‹d
()

55  (
_abÜt_‹¡
);

56 
	}
}

68 
w_rc_t
 
	gba£_ş›Á_t
::
	$subm™_b©ch
(
xù_ty³
, & 
Œx_út
, cÚ¡ 
b©ch_sz
)

70 
	`as£¹
 (
b©ch_sz
);

71 
	`as£¹
 (
_ı
);

72 
j
=1; j <ğ
b©ch_sz
; j++) {

77 ià(
j
 =ğ
b©ch_sz
)

78 
_ı
->
	`¶—£_ke_Úe
();

79 
	`W_COERCE
(
	`subm™_Úe
(
xù_ty³
, 
Œx_út
++));

81  (
RCOK
);

82 
	}
}

84 
±h»ad_mu‹x_t
 
	gş›Á_mu‹x
 = 
PTHREAD_MUTEX_INITIALIZER
;

85 
±h»ad_cÚd_t
 
	gş›Á_cÚd
 = 
PTHREAD_COND_INITIALIZER
;

86 
	gş›Á_Ãeded_couÁ
;

87 
	$sh–l_ex³ù_ş›Ás
(
couÁ
) {

88 
ş›Á_Ãeded_couÁ
 = 
couÁ
;

89 
	}
}

90 
	$sh–l_awa™_ş›Ás
() {

91 
	`CRITICAL_SECTION
(
cs
, 
ş›Á_mu‹x
);

92 
ş›Á_Ãeded_couÁ
)

93 
	`±h»ad_cÚd_wa™
(&
ş›Á_cÚd
, &
ş›Á_mu‹x
);

94 
	}
}

95 
	$ş›Á_»ady
() {

96 
	`CRITICAL_SECTION
(
cs
, 
ş›Á_mu‹x
);

97 if(! --
ş›Á_Ãeded_couÁ
)

98 
	`±h»ad_cÚd_sigÇl
(&
ş›Á_cÚd
);

99 
	}
}

109 
w_rc_t
 
ba£_ş›Á_t
::
	$run_xùs
(
xù_ty³
, 
num_xù
)

111 
i
=0;

112 
b©chsz
=1;

114 
	`ş›Á_»ady
();

117 
’vV¬
* 
ev
 =ƒnvV¬::
	`š¡ªû
();

118 
b©chsz
 = 
ev
->
	`g‘V¬IÁ
("db-ş-b©chsz",
BATCH_SIZE
);

119 
_thšk_time
 = 
ev
->
	`g‘V¬IÁ
("db-ş-thšktime",
THINK_TIME
);

121 ià((
_thšk_time
>0è&& (
b©chsz
>1)) {

122 
	`TRACE
Ğ
TRACE_ALWAYS
, "error: Batchsz=%d && ThinkTime=%d\n",

123 
b©chsz
, 
_thšk_time
);

124 
	`as£¹
(0);

130 
¡ršg
 
sy¢ame
 = 
ev
->
	`g‘SysName
();

131 ià(
sy¢ame
.
	`com·»
("baseline")!=0) {

132 
	`me
()->
	`®loc_sdesc_ÿche
();

136 
_m—su»_ty³
) {

139 (
MT_NUM_OF_TRXS
):

142 
	`W_COERCE
(
	`subm™_b©ch
(
xù_ty³
, 
i
, 
num_xù
));

144 
_ı
->
	`wa™
();

148 (
MT_TIME_DUR
):

151 
	`W_COERCE
(
	`subm™_b©ch
(
xù_ty³
, 
i
, 
b©chsz
));

152 
	`W_COERCE
(
	`subm™_b©ch
(
xù_ty³
, 
i
, 
b©chsz
));

155 
Œue
) {

157 
_ı
->
	`wa™
();

160 if(
_abÜt_‹¡
 || 
_’v
->
	`g‘_m—su»
(è=ğ
MST_DONE
)

164 
	`W_COERCE
(
	`subm™_b©ch
(
xù_ty³
, 
i
, 
b©chsz
));

168 
_ı
->
	`wa™
();

172 
	`as£¹
 (0);

175 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Exiting...\n");

176 ià(
sy¢ame
.
	`com·»
("baseline")!=0) {

177 
	`me
()->
	`ä“_sdesc_ÿche
();

180  (
RCOK
);

181 
	}
}

184 
EXIT_NAMESPACE
(
shÜe
);

	@src/sm/shore/shore_desc_sort_buf.cpp

33 
	~"sm/shÜe/shÜe_desc_sÜt_buf.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

39 cÚ¡ 
	gMIN_TUPLES_FOR_SORT
 = 250;

54 
	$com·»_sm®lšt_desc
(cÚ¡ * 
d1
, cÚ¡ * 
d2
)

56 
d©a1
 = *((*)
d1
);

57 
d©a2
 = *((*)
d2
);

58 ià(
d©a1
 > 
d©a2
)  (-1);

59 ià(
d©a1
 =ğ
d©a2
)  (0);

61 
	}
}

64 
	$com·»_št_desc
(cÚ¡ * 
d1
, cÚ¡ * 
d2
)

66 
d©a1
 = *((*)
d1
);

67 
d©a2
 = *((*)
d2
);

68 ià(
d©a1
 > 
d©a2
)  (-1);

69 ià(
d©a1
 =ğ
d©a2
)  (0);

71 
	}
}

74 
	$com·»_b™_desc
(cÚ¡ * 
d1
, cÚ¡ * 
d2
)

76 
d©a1
 = *((
boŞ
*)
d1
);

77 
d©a2
 = *((
boŞ
*)
d2
);

78 ià(
d©a1
 > 
d©a2
)  (-1);

79 ià(
d©a1
 =ğ
d©a2
)  (0);

81 
	}
}

83 
	$com·»_lÚg_desc
(cÚ¡ * 
d1
, cÚ¡ * 
d2
)

85 
d©a1
 = *((*)
d1
);

86 
d©a2
 = *((*)
d2
);

87 ià(
d©a1
 > 
d©a2
)  (-1);

88 ià(
d©a1
 =ğ
d©a2
)  (0);

90 
	}
}

92 
	$com·»_doubË_desc
(cÚ¡ * 
d1
, cÚ¡ * 
d2
)

94 
d©a1
 = *((*)
d1
);

95 
d©a2
 = *((*)
d2
);

96 ià(
d©a1
 > 
d©a2
)  (-1);

97 ià(
d©a1
 =ğ
d©a2
)  (0);

99 
	}
}

101 
	$com·»_fixch¬_desc
(cÚ¡ * 
d1
, cÚ¡ * 
d2
){

102  -(
	`¡rcmp
((*)
d1
, (*)
d2
));

103 
	}
}

105 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

106 
	$com·»_desc
(cÚ¡ * 
d1
, cÚ¡ * 
d2
)

108 
T
 
d©a1
 = *((T*)
d1
);

109 
T
 
d©a2
 = *((T*)
d2
);

110 ià(
d©a1
 > 
d©a2
)  (-1);

111 ià(
d©a1
 =ğ
d©a2
)  (0);

113 
	}
}

131 
	gdesc_sÜt_mª_im¶
::
	$š™
()

133 
	`as£¹
 (
_±abË
);

136 
_tu¶e_size
 = 0;

139 
ušt_t
 
i
=0; i<
_±abË
->
	`f›ld_couÁ
(); i++)

140 
_tu¶e_size
 +ğ
_±abË
->
	`desc
(
i
)->
	`f›ldmaxsize
();

143 if((
_tu¶e_size
 % 
_±abË
->
	`desc
(0)->
	`f›ldmaxsize
()) != 0) {

144 
_tu¶e_size
 = ((_tu¶e_siz/ 
_±abË
->
	`desc
(0)->
	`f›ldmaxsize
()) + 1) * _ptable->desc(0)->fieldmaxsize();

148 
	`as£¹
 (!
_sÜt_buf
);

149 
	`as£¹
 (
_tu¶e_couÁ
==0);

150 
	`as£¹
 (
_buf_size
==0);

151 
_sÜt_buf
 = 
Ãw
 [
MIN_TUPLES_FOR_SORT
*
_tu¶e_size
];

152 
_buf_size
 = 
MIN_TUPLES_FOR_SORT
;

154 
_is_sÜ‹d
 = 
çl£
;

155 
	}
}

167 
	gdesc_sÜt_mª_im¶
::
	$»£t
()

169 
	`as£¹
 (
_±abË
);

171 
	`as£¹
 (
_sÜt_buf
);

173 
	`as£¹
 (
_buf_size
);

175 
	`as£¹
 (
_tu¶e_size
);

178 
	`mem£t
(
_sÜt_buf
, 0, 
_buf_size
);

179 
_is_sÜ‹d
 = 
çl£
;

180 
	}
}

192 
	gdesc_sÜt_mª_im¶
::
	$add_tu¶e
(
sÜ‹r_tu¶e
& 
©u¶e
)

194 
	`CRITICAL_SECTION
(
cs
, 
_sÜ‹d_lock
);

197 ià(!
_tu¶e_size
è
	`š™
();

200 ià(
_buf_size
 =ğ
_tu¶e_couÁ
) {

202 * 
tmp
 = 
Ãw
 [(2*
_buf_size
)*
_tu¶e_size
];

203 
	`memıy
(
tmp
, 
_sÜt_buf
, 
_buf_size
*
_tu¶e_size
);

204 
d–‘e
 [] 
_sÜt_buf
;

206 
_sÜt_buf
 = 
tmp
;

207 
_buf_size
 *= 2;

213 
	`fÜm©
(&
©u¶e
, *
_´•row
);

214 
	`as£¹
 (
_´•row
->
_de¡
);

215 
	`memıy
(
_sÜt_buf
+(
_tu¶e_couÁ
*
_tu¶e_size
), 
_´•row
->
_de¡
, _tuple_size);

216 
_tu¶e_couÁ
++;

217 
_is_sÜ‹d
 = 
çl£
;

218 
	}
}

229 
	gdesc_sÜt_mª_im¶
::
	$sÜt
()

231 
	`CRITICAL_SECTION
(
cs
, 
_sÜ‹d_lock
);

236 
cout
 << "BefÜsÜtšg: " << 
’dl
;

237 
_±abË
->
	`desc
(0)->
	`ty³
()) {

238 
SQL_BIT
:

239 
i
=0; i<
_tu¶e_couÁ
; i++) {

240 
cout
 << ((
boŞ
*)(
_sÜt_buf
+
i
*
_tu¶e_size
))[0] << " ";

243 
SQL_SMALLINT
:

244 
i
=0; i<
_tu¶e_couÁ
; i++) {

245 
cout
 << ((*)(
_sÜt_buf
+
i
*
_tu¶e_size
))[0] << " ";

248 
SQL_INT
:

249 
i
=0; i<
_tu¶e_couÁ
; i++) {

250 
cout
 << ((*)(
_sÜt_buf
+
i
*
_tu¶e_size
))[0] << " ";

253 
SQL_LONG
:

254 
i
=0; i<
_tu¶e_couÁ
; i++) {

255 
cout
 << ((*)(
_sÜt_buf
+
i
*
_tu¶e_size
))[0] << " ";

258 
SQL_FLOAT
:

259 
i
=0; i<
_tu¶e_couÁ
; i++) {

260 
cout
 << ((*)(
_sÜt_buf
+
i
*
_tu¶e_size
))[0] << " ";

264 
cout
 << 
’dl
;

269 
_±abË
->
	`desc
(0)->
	`ty³
()) {

270 
SQL_BIT
:

271 
	`qsÜt
(
_sÜt_buf
, 
_tu¶e_couÁ
, 
_tu¶e_size
, 
com·»_b™_desc
); ;

272 
SQL_SMALLINT
:

273 
	`qsÜt
(
_sÜt_buf
, 
_tu¶e_couÁ
, 
_tu¶e_size
, 
com·»_sm®lšt_desc
); ;

274 
SQL_INT
:

275 
	`qsÜt
(
_sÜt_buf
, 
_tu¶e_couÁ
, 
_tu¶e_size
, 
com·»_št_desc
); ;

276 
SQL_LONG
:

277 
	`qsÜt
(
_sÜt_buf
, 
_tu¶e_couÁ
, 
_tu¶e_size
, 
com·»_lÚg_desc
); ;

278 
SQL_FLOAT
:

279 
	`qsÜt
(
_sÜt_buf
, 
_tu¶e_couÁ
, 
_tu¶e_size
, 
com·»_doubË_desc
); ;

280 
SQL_FIXCHAR
:

281 
	`qsÜt
(
_sÜt_buf
, 
_tu¶e_couÁ
, 
_tu¶e_size
, 
com·»_fixch¬_desc
); ;

284 
	`as£¹
(0);

286 
_is_sÜ‹d
 = 
Œue
;

289 
cout
 << "Aá” sÜtšg: " << 
’dl
;

290 
_±abË
->
	`desc
(0)->
	`ty³
()) {

291 
SQL_BIT
:

292 
i
=0; i<
_tu¶e_couÁ
; i++) {

293 
cout
 << ((
boŞ
*)(
_sÜt_buf
+
i
*
_tu¶e_size
))[0] << " ";

296 
SQL_SMALLINT
:

297 
i
=0; i<
_tu¶e_couÁ
; i++) {

298 
cout
 << ((*)(
_sÜt_buf
+
i
*
_tu¶e_size
))[0] << " ";

301 
SQL_INT
:

302 
i
=0; i<
_tu¶e_couÁ
; i++) {

303 
cout
 << ((*)(
_sÜt_buf
+
i
*
_tu¶e_size
))[0] << " ";

306 
SQL_LONG
:

307 
i
=0; i<
_tu¶e_couÁ
; i++) {

308 
cout
 << ((*)(
_sÜt_buf
+
i
*
_tu¶e_size
))[0] << " ";

311 
SQL_FLOAT
:

312 
i
=0; i<
_tu¶e_couÁ
; i++) {

313 
cout
 << ((*)(
_sÜt_buf
+
i
*
_tu¶e_size
))[0] << " ";

317 
cout
 << 
’dl
;

319 
	}
}

332 
w_rc_t
 
	gdesc_sÜt_mª_im¶
::
	$g‘_sÜt_™”
(
ss_m
* 
db
,

333 
desc_sÜt_™”_im¶
* &
sÜt_™”
)

335 
sÜt_™”
 = 
Ãw
 
	`desc_sÜt_™”_im¶
(
db
, 
_p¥ecifiùabË
, 
this
);

336  (
RCOK
);

337 
	}
}

351 
boŞ
 
	gdesc_sÜt_mª_im¶
::
	$g‘_sÜ‹d
(cÚ¡ 
šdex
, 
sÜ‹r_tu¶e
* 
±u¶e
)

353 
	`CRITICAL_SECTION
(
cs
, 
_sÜ‹d_lock
);

355 ià(
_is_sÜ‹d
) {

356 ià(
šdex
 >=0 && index < 
_tu¶e_couÁ
) {

357  (
	`lßd
(
±u¶e
, 
_sÜt_buf
 + (
šdex
*
_tu¶e_size
)));

360  (
çl£
);

362 
	`TRACE
Ğ
TRACE_DEBUG
, "buffer‚ot sorted yet...\n");

363  (
çl£
);

364 
	}
}

	@src/sm/shore/shore_env.cpp

32 
	~"ut/cÚå¬£r.h
"

33 
	~"sm/shÜe/shÜe_’v.h
"

34 
	~"sm/shÜe/shÜe_Œx_wÜk”.h
"

35 
	~"sm/shÜe/shÜe_æush”.h
"

36 
	~"sm/shÜe/shÜe_h–³r_lßd”.h
"

39 
ENTER_NAMESPACE
(
shÜe
);

42 #w¬nšg 
IP
: 
TODO
 
·ss
 
¬b™¿ry
 -
sm_
* 
İtiÚs
 
äom
 
shÜe
.
cÚf
 
to
 shore

46 
ShÜeEnv
* 
	g_g_shÜe_’v
 = 
NULL
;

48 
´ocmÚ™Ü_t
* 
	g_g_mÚ
 = 
NULL
;

64 
	g’v_¡©s_t
::
	$´št_’v_¡©s
() const

66 
	`TRACE
Ğ
TRACE_STATISTICS
, "===============================\n");

67 
	`TRACE
Ğ
TRACE_STATISTICS
, "Databaseransaction statistics\n");

68 
	`TRACE
Ğ
TRACE_STATISTICS
, "A‰em±ed: %d\n", 
_Árx_©t
);

69 
	`TRACE
Ğ
TRACE_STATISTICS
, "Comm™‹d: %d\n", 
_Árx_com
);

70 
	`TRACE
Ğ
TRACE_STATISTICS
, "AbÜ‹d : %d\n", (
_Árx_©t
-
_Árx_com
));

71 
	`TRACE
Ğ
TRACE_STATISTICS
, "===============================\n");

72 
	}
}

86 
	gShÜeEnv
::
	$ShÜeEnv
()

87 : 
	`db_içû
(),

88 
	`_pssm
(
NULL
),

89 
	`_š™Ÿlized
(
çl£
), 
	`_š™_mu‹x
(
	`th»ad_mu‹x_ü—‹
()),

90 
	`_lßded
(
çl£
), 
	`_lßd_mu‹x
(
	`th»ad_mu‹x_ü—‹
()),

91 
	`_¡©m­_mu‹x
(
	`th»ad_mu‹x_ü—‹
()),

92 
	`_Ï¡_¡©s_mu‹x
(
	`th»ad_mu‹x_ü—‹
()),

93 
	`_vŞ_mu‹x
(
	`th»ad_mu‹x_ü—‹
()),

94 
	`_max_ıu_couÁ
(0),

95 
	`_aùive_ıu_couÁ
(0),

96 
	`_wÜk”_út
(0),

97 
	`_m—su»
(
MST_UNDEF
),

98 
	`_pd
(
PD_NORMAL
),

99 
	`_š£¹_äeq
(0),
	`_d–‘e_äeq
(0),
	`_´obe_äeq
(100),

100 
	`_»que¡_poŞ
((
Œx_»que¡_t
)),

101 
	`_bU£SLI
(
çl£
),
	`_bU£ELR
(çl£),
	`_bU£Flush”
(false),

102 
	`_bAÏrmS‘
(
çl£
), 
	`_¡¬t_imb®ªû
(0), 
	$_skew_ty³
(
SKEW_NONE
)

104 
_pİts
 = 
Ãw
 
	`İtiÚ_group_t
(1);

105 
_pvid
 = 
Ãw
 
	`vid_t
(1);

107 
	`±h»ad_mu‹x_š™
(&
_sÿlšg_mu‹x
, 
NULL
);

108 
	`±h»ad_mu‹x_š™
(&
_qu”›d_mu‹x
, 
NULL
);

111 
’vV¬
* 
ev
 =ƒnvV¬::
	`š¡ªû
();

113 
¡ršg
 
physiÿl
 = 
ev
->
	`g‘SysDesign
();

115 ià(
physiÿl
.
	`com·»
("normal")==0) {

116 
_pd
 = 
PD_NORMAL
;

118 ià(
physiÿl
.
	`com·»
("mrbtnorm")==0) {

119 
_pd
 = 
PD_MRBT_NORMAL
;

121 ià(
physiÿl
.
	`com·»
("mrbtpart")==0) {

122 
_pd
 = 
PD_MRBT_PART
;

124 ià(
physiÿl
.
	`com·»
("mrbtleaf")==0) {

125 
_pd
 = 
PD_MRBT_LEAF
;

129 
	`check_hacks_’abËd
();

130 ià(
	`is_hacks_’abËd
()) {

131 
_pd
 |ğ
PD_PADDED
;

135 
_bU£SLI
 = 
ev
->
	`g‘V¬IÁ
("db-worker-sli",0);

136 
	`årštf
(
¡dout
, "SLIğ%s\n", (
_bU£SLI
 ? "enabled" : "disabled"));

139 
_»c_to_acc
 = 
ev
->
	`g‘V¬IÁ
("records-to-access",1);

140 
	}
}

143 
	gShÜeEnv
::~
	$ShÜeEnv
()

145 ià(
	`dbc
()!=
DBC_STOPPED
è
	`¡İ
();

147 
	`±h»ad_mu‹x_de¡roy
(&
_š™_mu‹x
);

148 
	`±h»ad_mu‹x_de¡roy
(&
_¡©m­_mu‹x
);

149 
	`±h»ad_mu‹x_de¡roy
(&
_Ï¡_¡©s_mu‹x
);

150 
	`±h»ad_mu‹x_de¡roy
(&
_lßd_mu‹x
);

151 
	`±h»ad_mu‹x_de¡roy
(&
_vŞ_mu‹x
);

153 
	`±h»ad_mu‹x_de¡roy
(&
_sÿlšg_mu‹x
);

154 
	`±h»ad_mu‹x_de¡roy
(&
_qu”›d_mu‹x
);

155 
	}
}

158 
boŞ
 
	gShÜeEnv
::
	$is_š™Ÿlized
()

160 
	`CRITICAL_SECTION
(
cs
, 
_š™_mu‹x
);

161  (
_š™Ÿlized
);

162 
	}
}

164 
boŞ
 
	gShÜeEnv
::
	$is_lßded
()

166 
	`CRITICAL_SECTION
(
cs
, 
_lßd_mu‹x
);

167  (
_lßded
);

168 
	}
}

171 
	gShÜeEnv
::
	$£t_max_ıu_couÁ
(cÚ¡ 
ušt
 
ıuút
)

173 
_max_ıu_couÁ
 = ( 
ıuút
>0 ? cpucnt : _max_cpu_count);

174 ià(
_aùive_ıu_couÁ
>
_max_ıu_couÁ
) {

175 
_aùive_ıu_couÁ
 = 
_max_ıu_couÁ
;

177 
	}
}

179 
ušt
 
	gShÜeEnv
::
	$g‘_max_ıu_couÁ
() const

181  (
_max_ıu_couÁ
);

182 
	}
}

184 
ušt
 
	gShÜeEnv
::
	$g‘_aùive_ıu_couÁ
() const

186  (
_aùive_ıu_couÁ
);

187 
	}
}

199 
	gShÜeEnv
::
	$£t_qf
(cÚ¡ 
aQF
)

201 ià((
aQF
>0è&& (aQF<=
_sÿlšg_çùÜ
)) {

202 
	`TRACE
Ğ
TRACE_ALWAYS
, "New Qu”›d FaùÜ: %.1f\n", 
aQF
);

203 
_qu”›d_çùÜ
 = 
aQF
;

206 
	`TRACE
Ğ
TRACE_ALWAYS
, "Inv®id qu”›d faùÜ iÅut: %.1f\n", 
aQF
);

208 
	}
}

210 
	gShÜeEnv
::
	$g‘_qf
() const

212  (
_qu”›d_çùÜ
);

213 
	}
}

216 
	gShÜeEnv
::
	$£t_sf
(cÚ¡ 
aSF
)

218 ià(
aSF
 > 0.0) {

219 
	`TRACE
Ğ
TRACE_ALWAYS
, "New Sÿlšg faùÜ: %.1f\n", 
aSF
);

220 
_sÿlšg_çùÜ
 = 
aSF
;

223 
	`TRACE
Ğ
TRACE_ALWAYS
, "Inv®id sÿlšg faùÜ iÅut: %.1f\n", 
aSF
);

225 
	}
}

227 
	gShÜeEnv
::
	$g‘_sf
() const

229  (
_sÿlšg_çùÜ
);

230 
	}
}

232 
	gShÜeEnv
::
	$upd_sf
()

234 
’vV¬
* 
ev
 =ƒnvV¬::
	`š¡ªû
();

235 
tmp_sf
 = 
ev
->
	`g‘SysV¬DoubË
("sf");

236 
	`as£¹
 (
tmp_sf
>0);

237 
	`£t_sf
(
tmp_sf
);

238  (
_sÿlšg_çùÜ
);

239 
	}
}

241 
	gShÜeEnv
::
	$´št_sf
() const

243 
	`TRACE
Ğ
TRACE_ALWAYS
, "Sÿlšg FaùÜ = (%.1f)\n", 
	`g‘_sf
());

244 
	`TRACE
Ğ
TRACE_ALWAYS
, "Qu”›d FaùÜ = (%.1f)\n", 
	`g‘_qf
());

245 
	}
}

255 
ušt4_t
 
	gShÜeEnv
::
	$g‘_pd
() const

257  (
_pd
);

258 
	}
}

260 
ušt4_t
 
	gShÜeEnv
::
	$£t_pd
(cÚ¡ 
physiÿl_design_t
& 
­d
)

262 
_pd
 = 
­d
;

263 
	`TRACE
Ğ
TRACE_ALWAYS
, "DB s‘Ø(%x)\n", 
_pd
);

264  (
_pd
);

265 
	}
}

267 
ušt4_t
 
	gShÜeEnv
::
	$add_pd
(cÚ¡ 
physiÿl_design_t
& 
­d
)

269 
_pd
 |ğ
­d
;

270 
	`TRACE
Ğ
TRACE_ALWAYS
, "DB s‘Ø(%x)\n", 
_pd
);

271  (
_pd
);

272 
	}
}

274 
boŞ
 
	gShÜeEnv
::
	$check_hacks_’abËd
()

277 
he
 = 
’vV¬
::
	`š¡ªû
()->
	`g‘V¬IÁ
("physical-hacks-enable",0);

278 
_’abË_hacks
 = (
he
 =ğ1 ? 
Œue
 : 
çl£
);

279  (
_’abË_hacks
);

280 
	}
}

282 
boŞ
 
	gShÜeEnv
::
	$is_hacks_’abËd
() const

284  (
_’abË_hacks
);

285 
	}
}

294 
	gShÜeEnv
::
	$£t_äeqs
(
š£¹_äeq
, 
d–‘e_äeq
, 
´obe_äeq
)

296 
	`as£¹
 ((
š£¹_äeq
>=0) && (insert_freq<=100));

297 
	`as£¹
 ((
d–‘e_äeq
>=0) && (delete_freq<=100));

298 
	`as£¹
 ((
´obe_äeq
>=0) && (probe_freq<=100));

299 
_š£¹_äeq
 = 
š£¹_äeq
;

300 
_d–‘e_äeq
 = 
d–‘e_äeq
;

301 
_´obe_äeq
 = 
´obe_äeq
;

302 
	}
}

311 
	gShÜeEnv
::
	$£t_skew
(
¬—
, 
lßd
, 
¡¬t_imb®ªû
)

313 
	`as£¹
 ((
lßd
>=0) && (load<=100));

314 
	`as£¹
 (
¡¬t_imb®ªû
>0);

315 
	`as£¹
((
¬—
>0) && (area<100));

317 
_¡¬t_imb®ªû
 = 
¡¬t_imb®ªû
;

319 
skew_ty³
 = 
	`URªd
(1,10);

320 if(
skew_ty³
 < 6) {

322 
_skew_ty³
 = 
SKEW_NORMAL
;

323 
	`TRACE
Ğ
TRACE_ALWAYS
, "SKEW_NORMAL\n");

324 } if(
skew_ty³
 < 9) {

326 
_skew_ty³
 = 
SKEW_DYNAMIC
;

327 
	`TRACE
Ğ
TRACE_ALWAYS
, "SKEW_DYNAMIC\n");

328 } if(
skew_ty³
 < 11) {

333 
_skew_ty³
 = 
SKEW_CHAOTIC
;

334 
	`TRACE
Ğ
TRACE_ALWAYS
, "SKEW_CHAOTIC\n");

336 
	`as£¹
(0);

338 
	}
}

347 
	gShÜeEnv
::
	$¡¬t_lßd_imb®ªû
()

350 if(
_skew_ty³
 =ğ
SKEW_DYNAMIC
 || _skew_ty³ =ğ
SKEW_CHAOTIC
) {

351 
_¡¬t_imb®ªû
 = 
	`URªd
(10,30);

352 
_bAÏrmS‘
 = 
çl£
;

354 
	}
}

363 
	gShÜeEnv
::
	$»£t_skew
()

365 
_¡¬t_imb®ªû
 = 0;

366 
_bAÏrmS‘
 = 
çl£
;

367 
	}
}

378 
ušt
 
	gShÜeEnv
::
	$upd_wÜk”_út
()

381 
ušt
 
wÜk”s
 = 
’vV¬
::
	`š¡ªû
()->
	`g‘V¬IÁ
("db-workers",0);

382 
	`as£¹
 (
wÜk”s
);

383 
_wÜk”_út
 = 
wÜk”s
;

384  (
_wÜk”_út
);

385 
	}
}

388 
Œx_wÜk”_t
* 
	gShÜeEnv
::
	$wÜk”
(cÚ¡ 
ušt
 
idx
)

390  (
_wÜk”s
[
idx
%
_wÜk”_út
]);

391 
	}
}

413 
	gShÜeEnv
::
	$š™
()

415 
	`CRITICAL_SECTION
(
cs
,
_š™_mu‹x
);

416 ià(
_š™Ÿlized
) {

417 
	`TRACE
Ğ
TRACE_ALWAYS
, "Already initialized\n");

424 
	`»adcÚfig
();

427 ià(
	`_£t_sys_·¿ms
()) {

428 
	`TRACE
Ğ
TRACE_ALWAYS
, "Problem in setting system…arameters\n");

434 ià(
	`cÚfigu»_sm
()) {

435 
	`TRACE
Ğ
TRACE_ALWAYS
, "Error configuring Shore\n");

440 ià(
	`lßd_schema
().
	`is_”rÜ
()) {

441 
	`TRACE
Ğ
TRACE_ALWAYS
, "Error†oadinghe database schema\n");

446 ià(
	`upd©e_·¹™iÚšg
().
	`is_”rÜ
()) {

447 
	`TRACE
Ğ
TRACE_ALWAYS
, "Error updatinghe…artitioning info\n");

453 ià(
	`¡¬t_sm
()) {

454 
	`TRACE
Ğ
TRACE_ALWAYS
, "Error starting Shore database\n");

458 
şobb”
 = 
	`©oi
(
_sys_İts
[
SHORE_SYS_OPTIONS
[0][0]].
	`c_¡r
());

459 ià(!
şobb”
) {

461 
	`W_COERCE
(
	`db
()->
	`begš_xù
());

462 
	`W_COERCE
(
	`lßd_ªd_»gi¡”_fids
());

463 
	`W_COERCE
(
	`db
()->
	`comm™_xù
());

465 ià(
rv®
 = 
	`po¡_š™
()) {

466 
	`TRACE
Ğ
TRACE_ALWAYS
, "Error in Shore…ost-init\n");

467  (
rv®
);

472 
_š™Ÿlized
 = 
Œue
;

473 
	`TRACE
Ğ
TRACE_DEBUG
, "ShoreEnv initialized\n");

476 
	}
}

490 
	gShÜeEnv
::
	$¡¬t
()

492 
	`upd_sf
();

493 
	`upd_wÜk”_út
();

495 
	`as£¹
 (
_wÜk”s
.
	`em±y
());

497 
	`TRACE
Ğ
TRACE_ALWAYS
, "S¹šg (%s)\n", 
_sy¢ame
.
	`c_¡r
());

498 
	`šfo
();

501 
lc
 = 
’vV¬
::
	`š¡ªû
()->
	`g‘V¬IÁ
("db-worker-queueloops",0);

503 #ifdeà
CFG_FLUSHER


504 
	`_¡¬t_æush”
();

507 
WÜk”PŒ
 
awÜk”
;

508 
ušt
 
i
=0; i<
_wÜk”_út
; i++) {

509 
awÜk”
 = 
Ãw
 
	`WÜk”
(
this
,
	`c_¡r
("wÜk-%d", 
i
),
PBIND_NONE
,
_bU£SLI
);

510 
_wÜk”s
.
	`push_back
(
awÜk”
);

511 
awÜk”
->
	`š™
(
lc
);

512 
awÜk”
->
	`¡¬t
();

513 
awÜk”
->
	`fÜk
();

516 
	}
}

530 
	gShÜeEnv
::
	$¡İ
()

533 
	`CRITICAL_SECTION
(
cs
, 
_š™_mu‹x
);

535 ià(
	`dbc
(è=ğ
DBC_STOPPED
)

538 
	`TRACE
Ğ
TRACE_ALWAYS
, "(%s)‡lready stopped\n",

539 
_sy¢ame
.
	`c_¡r
());

543 
	`TRACE
Ğ
TRACE_ALWAYS
, "Stİpšg (%s)\n", 
_sy¢ame
.
	`c_¡r
());

544 
	`šfo
();

546 ià(!
_š™Ÿlized
) {

547 
û¼
 << "EnvœÚm’ˆnÙ in™Ÿlized..." << 
’dl
;

552 
i
=0;

553 
WÜk”It
 
™
 = 
_wÜk”s
.
	`begš
(); iˆ!ğ_wÜk”s.
	`’d
(); ++it) {

554 
i
++;

555 
	`TRACE
Ğ
TRACE_DEBUG
, "Stİpšg wÜk” (%d)\n", 
i
);

556 ià(*
™
) {

557 (*
™
)->
	`¡İ
();

558 (*
™
)->
	`još
();

559 
	`d–‘e
 (*
™
);

562 
_wÜk”s
.
	`ş—r
();

564 #ifdeà
CFG_FLUSHER


565 
	`_¡İ_æush”
();

569 
	`£t_dbc
(
DBC_STOPPED
);

573 
	}
}

587 
	gShÜeEnv
::
	$şo£
()

589 
	`TRACE
Ğ
TRACE_ALWAYS
, "Closšg (%s)\n", 
_sy¢ame
.
	`c_¡r
());

592 
r
 = 
	`¡İ
();

593 ià(
r
 != 0)

596  (
r
);

600 
	`CRITICAL_SECTION
(
cs
, 
_š™_mu‹x
);

601 
	`şo£_sm
();

602 
_š™Ÿlized
 = 
çl£
;

606 
	}
}

617 
	gShÜeEnv
::
	$¡©i¡ics
()

619 
	`CRITICAL_SECTION
(
cs
, 
_š™_mu‹x
);

620 ià(!
_š™Ÿlized
) {

621 
û¼
 << "EnvœÚm’ˆnÙ in™Ÿlized..." << 
’dl
;

625 #ifdeà
CFG_FLUSHER


626 ià(
_ba£_æush”
è_ba£_æush”->
	`¡©i¡ics
();

632 
	}
}

649 
	gShÜeEnv
::
	$şo£_sm
()

651 
	`TRACE
Ğ
TRACE_ALWAYS
, "Closing Shore storage manager...\n");

653 ià(!
_pssm
) {

654 
	`TRACE
Ğ
TRACE_ALWAYS
, "sm‡lready closed...\n");

660 
_pssm
->
	`di§bË_çke_disk_Ï‹ncy
(*
_pvid
);

663 
	`TRACE
Ğ
TRACE_ALWAYS
, "Dismounting‡ll devices...\n");

666 
aùivexùs
 = 
ss_m
::
	`num_aùive_xùs
();

667 ià(
aùivexùs
) {

668 
	`TRACE
 (
TRACE_ALWAYS
, "\n*** Warning (%d)‡ctive xcts. Cannot dismount!!\n",

669 
aùivexùs
);

670 
	`w_as£¹3
 (
çl£
);

672 
	`W_IGNORE
(
ss_m
::
	`dump_xùs
(
cout
));

673 
cout
 << 
æush
;

676 
w_rc_t
 
e
 = 
_pssm
->
	`dismouÁ_®l
();

677 ià(
e
.
	`is_”rÜ
()) {

679 ià(
e
.
	`”r_num
(è=ğ
smËv–_0
::
eCANTWHILEACTIVEXCTS
) {

681 
	`TRACE
Ğ
TRACE_ALWAYS
,

683 
e
.
	`”r_num
());

686 
	`TRACE
Ğ
TRACE_ALWAYS
,

688 
e
.
	`”r_num
());

700 
	`d–‘e
 (
_pssm
);

704 
	}
}

715 
sm_¡©s_šfo_t
 
	gŞd¡©s
;

717 
	gShÜeEnv
::
	$g©h”¡©s_sm
()

722 
sm_¡©s_šfo_t
 
¡©s
;

723 
ss_m
::
	`g©h”_¡©s
(
¡©s
);

725 
sm_¡©s_šfo_t
 
diff
 = 
¡©s
;

726 
diff
 -ğ
_Ï¡_sm_¡©s
;

729 
cout
 << 
diff
 << 
’dl
;

730 
_Ï¡_sm_¡©s
 = 
¡©s
;

731 
	}
}

745 
	gShÜeEnv
::
	$cÚfigu»_sm
()

747 
	`TRACE
Ğ
TRACE_DEBUG
, "Configuring Shore...\n");

750 
	`W_COERCE
(
ss_m
::
	`£tup_İtiÚs
(
_pİts
));

752 
szO±
 = 
_sm_İts
.
	`size
();

753 
	`as£¹
 (
szO±
 > 1);

754 cÚ¡ * 
myO±s
[(2*(
SHORE_NUM_SYS_SM_OPTIONS
+
SHORE_NUM_DB_SM_OPTIONS
)) + 1];

755 
i
=0;

757 
myO±s
[
i
++] = (*)"fake";

758 
m­
<
¡ršg
,¡ršg>::
™”©Ü
 
sm_™”
 = 
_sm_İts
.
	`begš
();

759 
sm_™”
 !ğ
_sm_İts
.
	`’d
(); sm_iter++)

761 
myO±s
[
i
++] = 
sm_™”
->
fœ¡
.
	`c_¡r
();

762 
myO±s
[
i
++] = 
sm_™”
->
£cÚd
.
	`c_¡r
();

765 
w_o¡r¡»am
 
”r
;

766 
numO±s
 = (2*
szO±
)+1;

767 
w_rc_t
 
rc
 = 
_pİts
->
	`·r£_commªd_lše
(
myO±s
, 
numO±s
, 2, &
”r
);

769 
”r
 << 
’ds
;

772 ià(
rc
.
	`is_”rÜ
()) {

773 
û¼
 << "E¼Ü cÚfiguršg ShÜe: " << 
’dl
;

774 
û¼
 << "\t" << 
w_”rÜ_t
::
	`”rÜ_¡ršg
(
rc
.
	`”r_num
()è<< 
’dl
;

775 
û¼
 << "\t" << 
”r
.
	`c_¡r
(è<< 
’dl
;

776 
	`u§ge
(*
_pİts
);

781 
	`w_»£t_¡r¡»am
(
”r
);

782 
rc
 = 
_pİts
->
	`check_»quœed
(&
”r
);

783 ià(
rc
.
	`is_”rÜ
()) {

784 
û¼
 << "The£„equœed o±iÚ ¬nÙ s‘:" << 
’dl
;

785 
û¼
 << 
”r
.
	`c_¡r
(è<< 
’dl
;

786 
	`u§ge
(*
_pİts
);

790 
	`upd_sf
();

791 
	`upd_wÜk”_út
();

795 
	}
}

812 
	gssm_max_sm®l_»c
;

813 
sm_cÚfig_šfo_t
 
	gsm_cÚfig_šfo
;

815 
	gShÜeEnv
::
	$¡¬t_sm
()

817 
	`TRACE
Ğ
TRACE_DEBUG
, "Starting Shore...\n");

819 ià(
_š™Ÿlized
 =ğ
çl£
) {

820 
_pssm
 = 
Ãw
 
	`ss_m
();

823 
	`TRACE
Ğ
TRACE_DEBUG
, "Shore‡lready started...\n");

830 cÚ¡* 
deviû
 = 
_dev_İts
[
SHORE_DB_OPTIONS
[0][0]].
	`c_¡r
();

831 
quÙa
 = 
	`©oi
(
_dev_İts
[
SHORE_DB_OPTIONS
[1][0]].
	`c_¡r
());

832 
şobb”
 = 
	`©oi
(
_sys_İts
[
SHORE_SYS_OPTIONS
[0][0]].
	`c_¡r
());

834 
	`as£¹
 (
_pssm
);

835 
	`as£¹
 (
	`¡¾’
(
deviû
)>0);

836 
	`as£¹
 (
quÙa
>0);

838 ià(
şobb”
) {

840 
	`CRITICAL_SECTION
(
cs
, 
_lßd_mu‹x
);

842 
	`TRACE
Ğ
TRACE_DEBUG
, "Formatting‡‚ew device (%s) with‡ (%d) kB quota\n",

843 
deviû
, 
quÙa
);

847 
ss_m
::
smksize_t
 
smquÙa
 = 
quÙa
;

848 
	`W_COERCE
(
_pssm
->
	`fÜm©_dev
(
deviû
, 
smquÙa
, 
Œue
));

849 
	`TRACE
Ğ
TRACE_DEBUG
, "Formatting device completed...\n");

852 
	`W_COERCE
(
_pssm
->
	`mouÁ_dev
(
deviû
, 
_vŞ_út
, 
_devid
));

853 
	`TRACE
Ğ
TRACE_DEBUG
, "Mounting (new) device completed...\n");

858 
	`W_COERCE
(
_pssm
->
	`g’”©e_Ãw_lvid
(
_lvid
));

859 
	`W_COERCE
(
_pssm
->
	`ü—‹_vŞ
(
deviû
, 
_lvid
, 
quÙa
, 
çl£
, *
_pvid
));

862 
_lßded
 = 
çl£
;

866 
	`CRITICAL_SECTION
(
cs
, 
_lßd_mu‹x
);

868 
	`TRACE
Ğ
TRACE_DEBUG
, "Usšg deviû (%s)\n", 
deviû
);

871 
	`W_COERCE
(
_pssm
->
	`mouÁ_dev
(
deviû
, 
_vŞ_út
, 
_devid
));

872 
	`TRACE
Ğ
TRACE_DEBUG
,

874 
_vŞ_út
);

877 
lvid_t
* 
vŞume_li¡
;

878 
vŞume_út
;

879 
	`W_COERCE
(
_pssm
->
	`li¡_vŞumes
(
deviû
, 
vŞume_li¡
, 
vŞume_út
));

881 
	`as£¹
 (
vŞume_út
);

883 
_lvid
 = 
vŞume_li¡
[0];

884 
d–‘e
 [] 
vŞume_li¡
;

887 
_lßded
 = 
Œue
;

892 
’vV¬
* 
ev
 =ƒnvV¬::
	`š¡ªû
();

893 
’abËFakeIO
 = 
ev
->
	`g‘V¬IÁ
("shore-fakeiodelay-enable",0);

894 
	`TRACE
Ğ
TRACE_DEBUG
, "I çkI/O d–ayƒÇbËd: (%d)\n", 
’abËFakeIO
);

895 ià(
’abËFakeIO
) {

896 
_pssm
->
	`’abË_çke_disk_Ï‹ncy
(*
_pvid
);

899 
_pssm
->
	`di§bË_çke_disk_Ï‹ncy
(*
_pvid
);

901 
ioL©’cy
 = 
ev
->
	`g‘V¬IÁ
("shore-fakeiodelay",0);

902 
	`TRACE
Ğ
TRACE_DEBUG
, "I/O d–ay†©’cy s‘: (%d)\n", 
ioL©’cy
);

903 
	`W_COERCE
(
_pssm
->
	`£t_çke_disk_Ï‹ncy
(*
_pvid
,
ioL©’cy
));

909 ià(
ss_m
::
	`cÚfig_šfo
(
sm_cÚfig_šfo
).
	`is_”rÜ
())  (1);

910 
shÜe
::
ssm_max_sm®l_»c
 = 
sm_cÚfig_šfo
.
max_sm®l_»c
;

915 
	}
}

929 
	gShÜeEnv
::
	$checkpošt
()

931 
db_log_smt_t
* 
checkpoš‹r
 = 
Ãw
 
	`db_log_smt_t
(
	`c_¡r
("checkpoš‹r"), 
this
);

932 
	`as£¹
 (
checkpoš‹r
);

936 
checkpoš‹r
->
	`fÜk
();

937 
checkpoš‹r
->
	`još
();

938 
rv
 = 
checkpoš‹r
->
	`rv
();

939 
	`d–‘e
 (
checkpoš‹r
);

940 
checkpoš‹r
 = 
NULL
;

941  (
rv
);

942 
	}
}

952 
ušt_t
 
	gShÜeEnv
::
	$g‘_Œx_©t
() const

954  (*&
_’v_¡©s
.
_Árx_©t
);

955 
	}
}

957 
ušt_t
 
	gShÜeEnv
::
	$g‘_Œx_com
() const

959  (*&
_’v_¡©s
.
_Árx_com
);

960 
	}
}

975 
	gShÜeEnv
::
	$£t_aùive_ıu_couÁ
(cÚ¡ 
ušt_t
 
aùıuút
)

977 
_aùive_ıu_couÁ
 = ( 
aùıuút
>0 ?‡ctcpucnt : _active_cpu_count );

978 
	}
}

995 
	gShÜeEnv
::
	$_£t_sys_·¿ms
()

998 ià(
_max_ıu_couÁ
==0) {

999 
_max_ıu_couÁ
 = 
	`©oi
(
_sys_İts
[
SHORE_SYS_OPTIONS
[1][0]].
	`c_¡r
());

1003 
ušt
 
tmp_aùive_ıu_couÁ
 = 
	`©oi
(
_sys_İts
[
SHORE_SYS_OPTIONS
[2][0]].
	`c_¡r
());

1004 ià(
tmp_aùive_ıu_couÁ
>
_max_ıu_couÁ
) {

1005 
_aùive_ıu_couÁ
 = 
_max_ıu_couÁ
;

1008 
_aùive_ıu_couÁ
 = 
tmp_aùive_ıu_couÁ
;

1010 
	`´št_ıus
();

1012 
	}
}

1015 
	gShÜeEnv
::
	$´št_ıus
() const

1017 
	`TRACE
Ğ
TRACE_ALWAYS
, "MaxCPU=(%d) - ActiveCPU=(%d)\n",

1018 
_max_ıu_couÁ
, 
_aùive_ıu_couÁ
);

1019 
	}
}

1030 
	gShÜeEnv
::
	$u§ge
(
İtiÚ_group_t
& 
İtiÚs
)

1032 
û¼
 << "V®id ShÜİtiÚ ¬e: " << 
’dl
;

1033 
İtiÚs
.
	`´št_u§ge
(
Œue
, 
û¼
);

1034 
	}
}

1046 
	gShÜeEnv
::
	$»adcÚfig
()

1048 
¡ršg
 
cÚf_fe
;

1049 
’vV¬
* 
ev
 =ƒnvV¬::
	`š¡ªû
();

1050 
cÚf_fe
 = 
ev
->
	`g‘CÚfFe
();

1052 
	`TRACE
Ğ
TRACE_ALWAYS
, "R—dšg cÚfig f(%s)\n", 
cÚf_fe
.
	`c_¡r
());

1054 
¡ršg
 
tmp
;

1055 
i
=0;

1058 
¡ršg
 
cÚfigsuf
 = 
ev
->
	`g‘V¬
(
CONFIG_PARAM
,
CONFIG_PARAM_VALUE
);

1061 
	`as£¹
 (
cÚfigsuf
.
	`com·»
(
CONFIG_PARAM_VALUE
)!=0);

1062 
	`TRACE
Ğ
TRACE_ALWAYS
, "R—dšg cÚfigu¿tiÚ (%s)\n", 
cÚfigsuf
.
	`c_¡r
());

1065 
	`TRACE
Ğ
TRACE_DEBUG
, "Reading SYS options\n");

1066 
i
=0; i<
SHORE_NUM_SYS_OPTIONS
; i++) {

1067 
tmp
 = 
ev
->
	`g‘V¬
(
SHORE_SYS_OPTIONS
[
i
][0],SHORE_SYS_OPTIONS[i][1]);

1068 
_sys_İts
[
SHORE_SYS_OPTIONS
[
i
][0]] = 
tmp
;

1072 
	`TRACE
Ğ
TRACE_DEBUG
, "Reading SYS-SM options\n");

1073 
i
=0; i<
SHORE_NUM_SYS_SM_OPTIONS
; i++) {

1074 
tmp
 = 
ev
->
	`g‘V¬
(
SHORE_SYS_SM_OPTIONS
[
i
][1],SHORE_SYS_SM_OPTIONS[i][2]);

1075 
_sm_İts
[
SHORE_SYS_SM_OPTIONS
[
i
][0]] = 
tmp
;

1079 
	`TRACE
Ğ
TRACE_DEBUG
, "Reading DB-SM options\n");

1080 
i
=0; i<
SHORE_NUM_DB_SM_OPTIONS
; i++) {

1081 
tmp
 = 
ev
->
	`g‘V¬
(
cÚfigsuf
 + "-" + 
SHORE_DB_SM_OPTIONS
[
i
][1],SHORE_DB_SM_OPTIONS[i][2]);

1082 
_sm_İts
[
SHORE_DB_SM_OPTIONS
[
i
][0]] = 
tmp
;

1086 
	`TRACE
Ğ
TRACE_DEBUG
, "Reading DB options\n");

1087 
i
=0; i<
SHORE_NUM_DB_OPTIONS
; i++) {

1088 
tmp
 = 
ev
->
	`g‘V¬
(
cÚfigsuf
 + "-" + 
SHORE_DB_OPTIONS
[
i
][0],SHORE_DB_OPTIONS[i][1]);

1089 
_dev_İts
[
SHORE_DB_OPTIONS
[
i
][0]] = 
tmp
;

1093 
	}
}

1109 
	gShÜeEnv
::
	$»¡¬t
()

1111 
	`TRACE
Ğ
TRACE_DEBUG
, "Re¡¬tšg (%s)...\n", 
_sy¢ame
.
	`c_¡r
());

1112 
	`¡İ
();

1113 
	`cÚf
();

1114 
	`_£t_sys_·¿ms
();

1115 
	`¡¬t
();

1117 
	}
}

1128 
	gShÜeEnv
::
	$cÚf
()

1130 
	`TRACE
Ğ
TRACE_DEBUG
, "ShoreEnv configuration\n");

1133 
m­
<
¡ršg
,¡ršg>::
™”©Ü
 
™”
;

1134 
	`TRACE
Ğ
TRACE_DEBUG
, "** SYS options\n");

1135  
™”
 = 
_sys_İts
.
	`begš
(); i‹¸!ğ_sys_İts.
	`’d
(); iter++)

1136 
cout
 << "(" << 
™”
->
fœ¡
 << "è(" << i‹r->
£cÚd
 << ")" << 
’dl
;

1138 
	`TRACE
Ğ
TRACE_DEBUG
, "** SM options\n");

1139  
™”
 = 
_sm_İts
.
	`begš
(); i‹¸!ğ_sm_İts.
	`’d
(); iter++)

1140 
cout
 << "(" << 
™”
->
fœ¡
 << "è(" << i‹r->
£cÚd
 << ")" << 
’dl
;

1142 
	`TRACE
Ğ
TRACE_DEBUG
, "** DB options\n");

1143  
™”
 = 
_dev_İts
.
	`begš
(); i‹¸!ğ_dev_İts.
	`’d
(); iter++)

1144 
cout
 << "(" << 
™”
->
fœ¡
 << "è(" << i‹r->
£cÚd
 << ")" << 
’dl
;

1147 
	}
}

1159 
	gShÜeEnv
::
	$di§bË_çke_disk_Ï‹ncy
()

1162 
w_rc_t
 
e
 = 
_pssm
->
	`di§bË_çke_disk_Ï‹ncy
(*
_pvid
);

1163 ià(
e
.
	`is_”rÜ
()) {

1164 
	`TRACE
Ğ
TRACE_ALWAYS
, "Problem in disabling fake IO delay [0x%x]\n",

1165 
e
.
	`”r_num
());

1168 
’vV¬
* 
ev
 =ƒnvV¬::
	`š¡ªû
();

1169 
ev
->
	`£tV¬IÁ
("shore-fakeiodelay-enable",0);

1170 
ev
->
	`£tV¬IÁ
("shore-fakeiodelay",0);

1172 
	}
}

1174 
	gShÜeEnv
::
	$’abË_çke_disk_Ï‹ncy
(cÚ¡ 
ad–ay
)

1176 ià(!
ad–ay
>0)  (1);

1179 
w_rc_t
 
e
 = 
_pssm
->
	`£t_çke_disk_Ï‹ncy
(*
_pvid
,
ad–ay
);

1180 ià(
e
.
	`is_”rÜ
()) {

1181 
	`TRACE
Ğ
TRACE_ALWAYS
, "Problem in setting fake IO delay [0x%x]\n",

1182 
e
.
	`”r_num
());

1186 
e
 = 
_pssm
->
	`’abË_çke_disk_Ï‹ncy
(*
_pvid
);

1187 ià(
e
.
	`is_”rÜ
()) {

1188 
	`TRACE
Ğ
TRACE_ALWAYS
, "Problem inƒnabling fake IO delay [0x%x]\n",

1189 
e
.
	`”r_num
());

1192 
’vV¬
* 
ev
 =ƒnvV¬::
	`š¡ªû
();

1193 
ev
->
	`£tV¬IÁ
("shore-fakeiodelay-enable",1);

1194 
ev
->
	`£tV¬IÁ
("shÜe-çkeiod–ay",
ad–ay
);

1196 
	}
}

1208 
	gShÜeEnv
::
	$dump
()

1210 
	`TRACE
Ğ
TRACE_DEBUG
, "~~~~~~~~~~~~~~~~~~~~~\n");

1211 
	`TRACE
Ğ
TRACE_DEBUG
, "Dumping Shore Data\n");

1213 
	`TRACE
Ğ
TRACE_ALWAYS
, "Not implemented...\n");

1215 
	`TRACE
Ğ
TRACE_DEBUG
, "~~~~~~~~~~~~~~~~~~~~~\n");

1217 
	}
}

1229 
	gShÜeEnv
::
	$£tAsynchComm™
(cÚ¡ 
boŞ
 
bAsynch
)

1231 
_asynch_comm™
 = 
bAsynch
;

1232 
	}
}

1245 
	gShÜeEnv
::
	$_¡¬t_æush”
()

1247 
_ba£_æush”
 = 
Ãw
 
	`æush”_t
(
this
,
	`c_¡r
("base-flusher"));

1248 
	`as£¹
 (
_ba£_æush”
);

1249 
_ba£_æush”
->
	`fÜk
();

1250 
_ba£_æush”
->
	`¡¬t
();

1252 
	}
}

1263 
	gShÜeEnv
::
	$_¡İ_æush”
()

1265 
_ba£_æush”
->
	`¡İ
();

1266 
_ba£_æush”
->
	`još
();

1268 
	}
}

1279 
	gShÜeEnv
::
	$to_ba£_æush”
(
Reque¡
* 
¬
)

1282 
_ba£_æush”
->
	`’queue_toæush
(
¬
);

1283 
	}
}

1294 
	gShÜeEnv
::
	$db_´št_š™
(
num_lšes
)

1296 
bË_´š‹r_t
* 
db_´š‹r
 = 
Ãw
 
	`bË_´š‹r_t
(
this
, 
num_lšes
);

1297 
db_´š‹r
->
	`fÜk
();

1298 
db_´š‹r
->
	`još
();

1299 
	`d–‘e
 (
db_´š‹r
);

1300 
	}
}

1311 
	gShÜeEnv
::
	$db_ãtch_š™
()

1313 
bË_ãtch”_t
* 
db_ãtch”
 = 
Ãw
 
	`bË_ãtch”_t
(
this
);

1314 
db_ãtch”
->
	`fÜk
();

1315 
db_ãtch”
->
	`još
();

1316 
	`d–‘e
 (
db_ãtch”
);

1317 
	}
}

1319 
EXIT_NAMESPACE
(
shÜe
);

	@src/sm/shore/shore_field.cpp

32 
	~"sm/shÜe/shÜe_f›ld.h
"

34 
usšg
 
Çme¥aû
 
	gshÜe
;

44 
	gf›ld_desc_t
::
	$´št_desc
(
o¡»am
 & 
os
)

46 
os
 << "F›ld " << 
_Çme
 << "\t";

47 
_ty³
) {

48 
SQL_BIT
:

49 
os
 << "Ty³: BIT \ˆsize: " << (
boŞ
è<< 
’dl
;

51 
SQL_SMALLINT
:

52 
os
 << "Ty³: SMALLINT \ˆsize: " << (è<< 
’dl
;

54 
SQL_CHAR
:

55 
os
 << "Ty³: CHAR \ˆsize: " << (è<< 
’dl
;

57 
SQL_INT
:

58 
os
 << "Ty³: INT \ˆsize: " << (è<< 
’dl
;

60 
SQL_FLOAT
:

61 
os
 << "Ty³: FLOAT \ˆsize: " << (è<< 
’dl
;

63 
SQL_LONG
:

64 
os
 << "Ty³: LONG \ˆsize: " << (è<< 
’dl
;

66 
SQL_TIME
:

67 
os
 << "Ty³: TIMESTAMP \ˆsize: " << 
time¡amp_t
::
	`size
(è<< 
’dl
;

69 
SQL_VARCHAR
:

70 
os
 << "Ty³: VARCHAR \ˆsize: " << 
_size
 << 
’dl
;

72 
SQL_FIXCHAR
:

73 
os
 << "Ty³: CHAR \ˆsize: " << 
_size
 << 
’dl
;

75 
SQL_NUMERIC
:

76 
os
 << "Ty³: NUMERIC \ˆsize: " << 
_size
 << 
’dl
;

78 
SQL_SNUMERIC
:

79 
os
 << "Ty³: SNUMERIC \ˆsize: " << 
_size
 << 
’dl
;

82 
	}
}

105 
boŞ
 
	gf›ld_v®ue_t
::
	$lßd_v®ue_äom_fe
(
if¡»am
 & 
is
,

106 cÚ¡ 
d–im
)

108 
	`as£¹
 (
_pf›ld_desc
);

110 * 
¡ršg
 = 
Ãw
 [10*
_pf›ld_desc
->
	`f›ldmaxsize
()];

111 
is
.
	`g‘
(
¡ršg
, 10*
_pf›ld_desc
->
	`f›ldmaxsize
(), 
d–im
);

112 ià(
	`¡¾’
(
¡ršg
) == 0) {

113 
d–‘e
 [] 
¡ršg
;

114  
çl£
;

117 ià(
	`¡rcmp
(
¡ršg
, "(null)") == 0) {

118 
	`as£¹
(
_pf›ld_desc
->
	`®low_nuÎ
());

119 
_nuÎ_æag
 = 
Œue
;

120 
d–‘e
 [] 
¡ršg
;

121  
Œue
;

124 
_nuÎ_æag
 = 
çl£
;

126 
_pf›ld_desc
->
	`ty³
()) {

127 
SQL_BIT
: 
_v®ue
.
_b™
 = 
	`©oi
(
¡ršg
); ;

128 
SQL_SMALLINT
: 
_v®ue
.
_sm®lšt
 = 
	`©oi
(
¡ršg
); ;

129 
SQL_CHAR
: 
_v®ue
.
_ch¬
 = 
	`©oi
(
¡ršg
); ;

130 
SQL_INT
: 
_v®ue
.
_št
 = 
	`©oi
(
¡ršg
); ;

131 
SQL_FLOAT
: 
_v®ue
.
_æßt
 = 
	`©of
(
¡ršg
); ;

132 
SQL_LONG
: 
_v®ue
.
_æßt
 = 
	`©Ş
(
¡ršg
); ;

133 
SQL_TIME
: ;

134 
SQL_VARCHAR
: {

135 ià(
¡ršg
[0] =ğ'\"'è¡ršg[
	`¡¾’
(string)-1] = '\0';

136 
	`£t_v¬_¡ršg_v®ue
(
¡ršg
+1, 
	`¡¾’
(string)-1);

139 
SQL_FIXCHAR
: {

140 ià(
¡ršg
[0] =ğ'\"'è¡ršg[
	`¡¾’
(string)-1] = '\0';

141 
	`£t_fixed_¡ršg_v®ue
(
¡ršg
+1, 
	`¡¾’
(string)-1);

144 
SQL_NUMERIC
:

145 
SQL_SNUMERIC
:

146 
	`£t_fixed_¡ršg_v®ue
(
¡ršg
, 
	`¡¾’
(string));

149 
d–‘e
 [] 
¡ršg
;

150  
Œue
;

151 
	}
}

162 
	gf›ld_v®ue_t
::
	$´št_v®ue
(
o¡»am
 & 
os
)

164 
	`as£¹
 (
_pf›ld_desc
);

166 ià(
_nuÎ_æag
) {

167 
os
 << "(null)";

171 
_pf›ld_desc
->
	`ty³
()) {

172 
SQL_BIT
:

173 
os
 <<
_v®ue
.
_b™
;

175 
SQL_SMALLINT
:

176 
os
 <<
_v®ue
.
_sm®lšt
;

178 
SQL_CHAR
:

179 
os
 <<
_v®ue
.
_ch¬
;

181 
SQL_INT
:

182 
os
 << 
_v®ue
.
_št
;

184 
SQL_FLOAT
:

185 
os
 << 
fixed
;

186 
os
.
	`´ecisiÚ
(2);

187 
os
 << 
_v®ue
.
_æßt
;

189 
SQL_LONG
:

190 
os
 << 
_v®ue
.
_lÚg
;

192 
SQL_TIME
:

193 
m¡r
[32];

194 
_v®ue
.
_time
->
	`¡ršg
(
m¡r
,32);

195 
os
 << 
m¡r
;

197 
SQL_VARCHAR
:

198 
SQL_FIXCHAR
:

200 
ušt
 
i
=0; i<
_»®_size
; i++) {

201 ià(
_v®ue
.
_¡ršg
[
i
]è
os
 << _value._string[i];

205 
SQL_NUMERIC
:

206 
SQL_SNUMERIC
: {

207 
ušt
 
i
=0; i<
_»®_size
; i++) {

208 ià(
_v®ue
.
_¡ršg
[
i
]è
os
 << _value._string[i];

213 
	}
}

226 
	gf›ld_v®ue_t
::
	$g‘_debug_¡r
(* &
buf
)

228 
	`as£¹
 (
_pf›ld_desc
);

230 
ušt_t
 
sz
 = 
_max_size
;

231 
buf
 = 
Ãw
 [
MAX_LINE_LENGTH
];

232 
	`mem£t
(
buf
, '\0', 
MAX_LINE_LENGTH
);

234 ià(
_nuÎ_æag
) {

235 
	`¥rštf
(
buf
, "(null)");

239 
_pf›ld_desc
->
	`ty³
()) {

240 
SQL_BIT
:

241 
	`¥rštf
(
buf
, "SQL_BIT: \t%d", 
_v®ue
.
_b™
);

243 
SQL_SMALLINT
:

244 
	`¥rštf
(
buf
, "SQL_SMALLINT: \t%d", 
_v®ue
.
_sm®lšt
);

246 
SQL_CHAR
:

247 
	`¥rštf
(
buf
, "SQL_CHAR: \t%d", 
_v®ue
.
_ch¬
);

249 
SQL_INT
:

250 
	`¥rštf
(
buf
, "SQL_INT: \t%d", 
_v®ue
.
_št
);

252 
SQL_FLOAT
:

253 
	`¥rštf
(
buf
, "SQL_FLOAT: \t%.2f", 
_v®ue
.
_æßt
);

255 
SQL_LONG
:

256 
	`¥rštf
(
buf
, "SQL_LONG: \t%Îd", 
_v®ue
.
_lÚg
);

258 
SQL_TIME
:

259 
m¡r
[32];

260 
_v®ue
.
_time
->
	`¡ršg
(
m¡r
,32);

261 
	`¥rštf
(
buf
, "SQL_TIME: \t%s", 
m¡r
);

263 
SQL_VARCHAR
:

264 
	`¡rÿt
(
buf
, "SQL_VARCHAR: \t");

265 
	`¡ºÿt
(
buf
, 
_v®ue
.
_¡ršg
, 
_»®_size
);

267 
SQL_FIXCHAR
:

268 
	`¡rÿt
(
buf
, "SQL_CHAR: \t");

269 
	`¡ºÿt
(
buf
, 
_v®ue
.
_¡ršg
, 
_»®_size
);

271 
SQL_NUMERIC
:

272 
	`¡rÿt
(
buf
, "SQL_NUMERIC: \t");

273 
	`¡ºÿt
(
buf
, 
_v®ue
.
_¡ršg
, 
_»®_size
);

275 
SQL_SNUMERIC
: {

276 
	`¡rÿt
(
buf
, "SQL_sNUMERIC: \t");

277 
	`¡ºÿt
(
buf
, 
_v®ue
.
_¡ršg
, 
_»®_size
);

282  (
sz
);

283 
	}
}

	@src/sm/shore/shore_file_desc.cpp

34 
	~"sm/shÜe/shÜe_fe_desc.h
"

35 
	~"sm/shÜe/shÜe_šdex.h
"

37 
ENTER_NAMESPACE
(
shÜe
);

49 
	gfe_desc_t
::
	$fe_desc_t
(cÚ¡ * 
Çme
,

50 cÚ¡ 
ušt_t
 
fút
,

51 cÚ¡ 
ušt4_t
& 
­d
)

52 : 
	`_f›ld_couÁ
(
fút
), 
	`_vid
(
vid_t
::
nuÎ
),

53 
	`_roÙ_iid
(
¡id_t
::
nuÎ
), 
	`_pd
(
­d
), 
	$_fid
(
¡id_t
::
nuÎ
)

55 
	`as£¹
 (
fút
>0);

57 
	`±h»ad_mu‹x_š™
(&
_fschema_mu‹x
, 
NULL
);

60 
	`mem£t
(
_Çme
,0,
MAX_FNAME_LEN
);

61 #iâdeà
__GNUC__


62 if(
	`¡¾ıy
(
_Çme
, 
Çme
, 
MAX_FNAME_LEN
) >= MAX_FNAME_LEN)

64 if(
	`w_¡¾ıy
(
_Çme
, 
Çme
, 
MAX_FNAME_LEN
) >= MAX_FNAME_LEN)

67 
throw
 "file_desc_t::_nameoo†ong!\n";

69 
	}
}

71 
	gfe_desc_t
::~
	$fe_desc_t
()

73 
	`±h»ad_mu‹x_de¡roy
(&
_fschema_mu‹x
);

74 
	}
}

89 
w_rc_t
 
	gfe_desc_t
::
	$fšd_roÙ_iid
(
ss_m
* )

93 
vid_t
 
vid
;

94 
vid_t
* 
vid_li¡
 = 
NULL
;;

95 
u_št
 
vid_út
 = 0;

97 
	`as£¹
 (
çl£
);

98 
	`W_DO
(
db
->
	`li¡_vŞumes
("deviû_Çme", 
vid_li¡
, 
vid_út
));

100 ià(
vid_út
 == 0)

101  
	`RC
(
£_VOLUME_NOT_FOUND
);

103 
vid
 = 
vid_li¡
[0];

104 
d–‘e
 [] 
vid_li¡
;

105 
_vid
 = 
vid
;

108 #w¬nšg 
IP
: 
Stl
 
nÙ
 
muÉi
-
vŞume
 
»ady


109 
_vid
 = 1;

113 
	`W_DO
(
ss_m
::
	`vŞ_roÙ_šdex
(
_vid
, 
_roÙ_iid
));

114  
RCOK
;

115 
	}
}

126 
w_rc_t
 
	gfe_desc_t
::
	$fšd_fid
(
ss_m
* 
db
)

129 ià(
	`is_fid_v®id
())

130  
RCOK
;

132 
fe_šfo_t
 
šfo
;

133 
boŞ
 
found
 = 
çl£
;

134 
smsize_t
 
šfosize
 = (
fe_šfo_t
);

136 ià(!
	`is_roÙ_v®id
()è
	`W_DO
(
	`fšd_roÙ_iid
(
db
));

138 
	`W_DO
(
ss_m
::
	`fšd_assoc
(
	`roÙ_iid
(),

139 
	`vec_t
(
_Çme
, 
	`¡¾’
(_name)),

140 &
šfo
, 
šfosize
,

141 
found
));

142 
_fid
 = 
šfo
.
	`fid
();

144 ià(!
found
) {

145 
û¼
 << "ProbËm fšdšgabË " << 
_Çme
 << 
’dl
;

146  
	`RC
(
£_TABLE_NOT_FOUND
);

149  
RCOK
;

150 
	}
}

153 
w_rc_t
 
	gšdex_desc_t
::
	$fšd_fid
(
ss_m
* 
db
, 
²um
)

155 
	`as£¹
(
²um
 >ğ0 &&…num < 
_·¹™iÚ_couÁ
);

156 if(
	`is_·¹™iÚed
()) {

158 ià(
	`is_fid_v®id
(
²um
))

159  
RCOK
;

161 
fe_šfo_t
 
šfo
;

162 
boŞ
 
found
 = 
çl£
;

163 
smsize_t
 
šfosize
 = (
fe_šfo_t
);

165 ià(!
_ba£
.
	`is_roÙ_v®id
()è
	`W_DO
(_ba£.
	`fšd_roÙ_iid
(
db
));

167 
tmp
[100];

168 
	`¥rštf
(
tmp
, "%s_%d", 
_ba£
.
_Çme
, 
²um
);

169 
	`W_DO
(
ss_m
::
	`fšd_assoc
(
_ba£
.
	`roÙ_iid
(),

170 
	`vec_t
(
tmp
, 
	`¡¾’
(tmp)),

171 &
šfo
, 
šfosize
,

172 
found
));

173 
_·¹™iÚ_¡ids
[
²um
] = 
šfo
.
	`fid
();

175 ià(!
found
) {

176 
û¼
 << "ProbËm fšdšg index " << 
tmp
 << 
’dl
;

177  
	`RC
(
£_TABLE_NOT_FOUND
);

180  
RCOK
;

183  
_ba£
.
	`fšd_fid
(
db
);

185 
	}
}

199 
	gfe_šfo_t
::
	$fe_šfo_t
(cÚ¡ 
¡id_t
& 
fid
,

200 cÚ¡ * 
âame
,

201 cÚ¡ 
fe_ty³_t
 
áy³
)

202 : 
	`_áy³
(
áy³
),

203 
	`_»cÜd_size
(
¡d
::
·œ
<,>(0,0)),

204 
	`_fœ¡_rid
(0, 
	`shrid_t
(0,0,0)),

205 
	$_fid
(
fid
)

208 #iâdeà
__GNUC__


209 if(
	`¡¾ıy
(
_âame
, 
âame
, 
MAX_FNAME_LEN
) >= MAX_FNAME_LEN)

211 if(
	`w_¡¾ıy
(
_âame
, 
âame
, 
MAX_FNAME_LEN
) >= MAX_FNAME_LEN)

214 
throw
 "file_info_t::_fnameoo†ong!\n";

216 
	}
}

218 
	gfe_šfo_t
::
	$fe_šfo_t
()

219 : 
	`_áy³
(
FT_HEAP
),

220 
	`_»cÜd_size
(
¡d
::
·œ
<,>(0,0)),

221 
	`_fœ¡_rid
(0, 
	`shrid_t
(0,0,0)),

222 
	`_cur_rid
(0, 
	$shrid_t
(0,0,0))

223 { 
	}
}

227 
EXIT_NAMESPACE
(
shÜe
);

	@src/sm/shore/shore_flusher.cpp

31 
	~"sm/shÜe/shÜe_æush”.h
"

32 
	~"sm/shÜe/shÜe_’v.h
"

33 
	~"xù.h
"

35 
ENTER_NAMESPACE
(
shÜe
);

45 cÚ¡ 
ušt
 
	gsmBLOCK_SIZE
=8192;

46 cÚ¡ 
ušt
 
	gsmSEGMENT_SIZE
=128*
smBLOCK_SIZE
;

48 
	gæush”_¡©s_t
::
	$æush”_¡©s_t
()

49 : 
	`£rved
(0), 
	`æushes
(0), 
	`logsize
(0), 
	`®»adyFlushed
(0), 
	`wa™šg
(0),

50 
	`ŒigByXùs
(0), 
	`ŒigBySize
(0), 
	$ŒigByTimeout
(0)

54 
_log·¹_sz
 = (
’vV¬
::
	`š¡ªû
()->
	`g‘SysV¬IÁ
("logbufsize"))/8;

56 
_log·¹_sz
 = 
	`æoÜ
(_log·¹_sz + 
smSEGMENT_SIZE
 - 1, smSEGMENT_SIZE);

58 
	}
}

61 
	gæush”_¡©s_t
::~
	$æush”_¡©s_t
()

63 
	}
}

66 
æush”_¡©s_t
::
	$´št
() const

68 cÚ¡ 
MEGABYTE
 = 1024*1024;

70 
	`TRACE
Ğ
TRACE_STATISTICS
, "Flushes: (%d)\n", 
æushes
);

71 
	`TRACE
Ğ
TRACE_STATISTICS
, "Xcts: (%d)\t(%.2f)\n",

72 
£rved
, ()£rved/()
æushes
);

73 
	`TRACE
Ğ
TRACE_STATISTICS
, "Logsize MBs: (%ld)\t(%.2f)\n",

74 
logsize
/
MEGABYTE
, (îogsize/()(
æushes
*MEGABYTE));

75 
	`TRACE
Ğ
TRACE_STATISTICS
, "Already: (%d)\t(%.2f%%)\n",

76 
®»adyFlushed
, ()(100*®»adyFlushed)/()
£rved
);

77 
	`TRACE
Ğ
TRACE_STATISTICS
, "Waiting: (%d)\t(%.2f)\n",

78 
wa™šg
, ()wa™šg/()
æushes
);

80 
	`TRACE
Ğ
TRACE_STATISTICS
, "By Xcts: (%d)\t(%.2f%%)\n",

81 
ŒigByXùs
,()(100*ŒigByXùs)/()
æushes
);

82 
	`TRACE
Ğ
TRACE_STATISTICS
, "By Size: (%d)\t(%.2f%%)\n",

83 
ŒigBySize
,()(100*ŒigBySize)/()
æushes
);

84 
	`TRACE
Ğ
TRACE_STATISTICS
, "By Timeout: (%d)\t(%.2f%%)\n",

85 
ŒigByTimeout
,()(100*ŒigByTimeout)/()
æushes
);

86 
	}
}

88 
	gæush”_¡©s_t
::
	$»£t
()

90 
£rved
 = 0;

91 
æushes
 = 0;

93 
logsize
 = 0;

94 
®»adyFlushed
 = 0;

95 
wa™šg
 = 0;

97 
ŒigByXùs
 = 0;

98 
ŒigBySize
 = 0;

99 
ŒigByTimeout
 = 0;

100 
	}
}

113 
	gæush”_¡©s_t
::
	$_log_diff
(cÚ¡ 
l¢_t
& 
h—d
, cÚ¡†¢_t& 

)

115 ià(
h—d
.
	`hi
()==

.hi()è (h—d.
	`lo
()-tail.lo());

116 
	`as£¹
(
h—d
.
	`hi
()>

.hi());

117 
diff
 = (
h—d
.
	`hi
(è- 

.hi()è* 
_log·¹_sz
;

118 ià(
h—d
.
	`lo
()>

.lo()è (
diff
 + (head.lo()-tail.lo()));

119  (
diff
 - (

.
	`lo
()-
h—d
.lo()));

120 
	}
}

131 
	gæush”_t
::
	$æush”_t
(
ShÜeEnv
* 
’v
,

132 
c_¡r
 
Šame
,

133 
´oûssÜid_t
 
­rsid
,

134 cÚ¡ 
u£_¦i
)

135 : 
	$ba£_wÜk”_t
(
’v
, 
Šame
, 
­rsid
, 
u£_¦i
)

137 
_pxù_toæush_poŞ
 = 
Ãw
 
	`PoŞ
((
xù_t
*),
FLUSHER_BUFFER_EXPECTED_SZ
);

138 
_ba£_toæush
 = 
Ãw
 
	`Ba£Queue
(
_pxù_toæush_poŞ
.
	`g‘
());

139 
	`as£¹
 (
_ba£_toæush
.
	`g‘
());

140 
_ba£_toæush
->
	`£tqueue
(
WS_COMMIT_Q
,
this
,2000,0);

142 
_pxù_æushšg_poŞ
 = 
Ãw
 
	`PoŞ
((
xù_t
*),
FLUSHER_BUFFER_EXPECTED_SZ
);

143 
_ba£_æushšg
 = 
Ãw
 
	`Ba£Queue
(
_pxù_æushšg_poŞ
.
	`g‘
());

144 
	`as£¹
 (
_ba£_æushšg
.
	`g‘
());

145 
_ba£_æushšg
->
	`£tqueue
(
WS_COMMIT_Q
,
this
,0,0);

146 
	}
}

148 
	gæush”_t
::~
	$æush”_t
()

152 
	`as£¹
 (
_ba£_toæush
->
	`is_em±y
());

153 
_ba£_toæush
.
	`dÚe
();

154 
_pxù_toæush_poŞ
.
	`dÚe
();

156 
	`as£¹
 (
_ba£_æushšg
->
	`is_em±y
());

157 
_ba£_æushšg
.
	`dÚe
();

158 
_pxù_æushšg_poŞ
.
	`dÚe
();

159 
	}
}

161 
	gæush”_t
::
	$¡©i¡ics
()

163 
_¡©s
.
	`´št
();

164 
_¡©s
.
	`»£t
();

166 
	}
}

183 
	gæush”_t
::
	$_wÜk_ACTIVE_im¶
()

185 
’vV¬
* 
ev
 =ƒnvV¬::
	`š¡ªû
();

186 
bšdšg
 = 
ev
->
	`g‘V¬IÁ
("flusher-binding",0);

187 ià(
bšdšg
==0è
_´s_id
 = 
PBIND_NONE
;

188 
	`TRY_TO_BIND
(
_´s_id
,
_is_bound
);

191 
ušt
 
maxGroupSize
 = 
ev
->
	`g‘V¬IÁ
("æush”-group-size",
FLUSHER_GROUP_SIZE_THRESHOLD
);

192 
ušt
 
maxLogSize
 = 
ev
->
	`g‘V¬IÁ
("æush”-log-size",
FLUSHER_LOG_SIZE_THRESHOLD
);

193 
ušt
 
maxTimeIÁ”v®u£c
 = 
ev
->
	`g‘V¬IÁ
("æush”-timeout",
FLUSHER_TIME_THRESHOLD
);

195 
ušt
 
wa™šg
 = 0;

196 
l¢_t
 
du¿bËl¢
, 
maxl¢
;

197 
boŞ
 
bShouldFlush
 = 
çl£
;

198 
logWa™šg
 = 0;

199 
time¥ec
 
¡¬t
, 
ts
;

200 cÚ¡ 
BILLION
 = 1000*1000*1000;

201 
boŞ
 
bSË•Next
 = 
çl£
;

203 
	`şock_g‘time
(
CLOCK_REALTIME
, &
¡¬t
);

206 
ts
 = 
¡¬t
;

207 
ts
.
tv_n£c
 +ğ
maxTimeIÁ”v®u£c
 * 1000;

208 ià(
ts
.
tv_n£c
 > 
BILLION
) {

209 
ts
.
tv_n£c
 -ğ
BILLION
;

210 
ts
.
tv_£c
++;

214 
	`g‘_cÚŒŞ
(è=ğ
WC_ACTIVE
) {

217 
	`£t_ws
(
WS_LOOP
);

218 
bShouldFlush
 = 
çl£
;

221 
_’v
->
	`db
()->
	`g‘_du¿bË_l¢
(
du¿bËl¢
);

222 
maxl¢
 = 
du¿bËl¢
;

225 
	`_check_wa™šg
(
bSË•Next
,
du¿bËl¢
,
maxl¢
,
wa™šg
);

228 ià(
wa™šg
 >ğ
maxGroupSize
) {

230 
bShouldFlush
 = 
Œue
;

231 
_¡©s
.
ŒigByXùs
++;

234 
logWa™šg
 = 
_¡©s
.
	`_log_diff
(
maxl¢
,
du¿bËl¢
);

235 ià(
logWa™šg
 >ğ
maxLogSize
) {

237 
bShouldFlush
 = 
Œue
;

238 
_¡©s
.
ŒigBySize
++;

244 
	`şock_g‘time
(
CLOCK_REALTIME
, &
¡¬t
);

245 ià((
¡¬t
.
tv_£c
 > 
ts
.tv_sec) ||

246 (
¡¬t
.
tv_£c
 =ğ
ts
.tv_£ø&& s¹.
tv_n£c
 >s.tv_nsec)) {

247 
bShouldFlush
 = 
Œue
;

248 
_¡©s
.
ŒigByTimeout
++;

251 
ts
 = 
¡¬t
;

252 
ts
.
tv_n£c
 +ğ
maxTimeIÁ”v®u£c
 * 1000;

253 ià(
ts
.
tv_n£c
 > 
BILLION
) {

254 
ts
.
tv_n£c
 -ğ
BILLION
;

255 
ts
.
tv_£c
++;

262 ià(
wa™šg
è
_’v
->
	`db
()->
	`sync_log
();

263 
bSË•Next
 = 
Œue
;

268 ià(
	`g‘_cÚŒŞ
(è!ğ
WC_ACTIVE
) (0);

275 ià(
bShouldFlush
) {

276 
_¡©s
.
æushes
++;

277 
_¡©s
.
wa™šg
 += waiting;

278 
_¡©s
.
logsize
 +ğ
logWa™šg
;

279 
_’v
->
	`db
()->
	`sync_log
();

281 
wa™šg
 = 0;

282 
logWa™šg
 = 0;

289 
_’v
->
	`db
()->
	`g‘_du¿bË_l¢
(
du¿bËl¢
);

290 
	`_move_äom_æushšg
(
du¿bËl¢
);

293 
	}
}

306 
	gæush”_t
::
	$_check_wa™šg
(
boŞ
& 
bSË•Next
,

307 cÚ¡ 
l¢_t
& 
du¿bËl¢
,

308 
l¢_t
& 
maxl¢
,

309 
ušt
& 
wa™šg
)

311 
Œx_»que¡_t
* 
´eq
 = 
NULL
;

312 
l¢_t
 
xùl¢
;

315 (!
_ba£_toæush
->
	`is_em±y
()è|| (
bSË•Next
)) {

318 
´eq
 = 
_ba£_toæush
->
	`pİ
();

321 ià(
´eq
) {

322 
xùl¢
 = 
´eq
->
	`my_Ï¡_l¢
();

324 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

326 
´eq
->
	`tid
().
	`g‘_lo
(), 
xùl¢
.
	`lo
(), 
maxl¢
.lo());

330 ià(
du¿bËl¢
 > 
xùl¢
) {

331 
_¡©s
.
®»adyFlushed
++;

332 
´eq
->
	`nÙify_ş›Á
();

333 
_’v
->
	`šc_Œx_com
();

334 
_’v
->
_»que¡_poŞ
.
	`de¡roy
(
´eq
);

339 
maxl¢
 = 
¡d
::
	`max
(maxl¢,
xùl¢
);

340 
_ba£_æushšg
->
	`push
(
´eq
,
çl£
);

341 
wa™šg
++;

345 
bSË•Next
 = 
çl£
;

346 
_¡©s
.
£rved
++;

350 
	}
}

364 
	gæush”_t
::
	$_move_äom_æushšg
(cÚ¡ 
l¢_t
& 
du¿bËl¢
)

366 
Œx_»que¡_t
* 
´eq
 = 
NULL
;

367 
l¢_t
 
xùl¢
;

369 !
_ba£_æushšg
->
	`is_em±y
()) {

370 
´eq
 = 
_ba£_æushšg
->
	`pİ
();

371 
xùl¢
 = 
´eq
->
	`my_Ï¡_l¢
();

372 
	`as£¹
 (
xùl¢
 < 
du¿bËl¢
);

373 
´eq
->
	`nÙify_ş›Á
();

374 
_’v
->
	`šc_Œx_com
();

375 
_’v
->
_»que¡_poŞ
.
	`de¡roy
(
´eq
);

379 
	}
}

393 
	gæush”_t
::
	$_´e_STOP_im¶
()

395 
ušt
 
aá”Stİ
 = 0;

396 
Œx_»que¡_t
* 
´eq
 = 
NULL
;

399 !
_ba£_æushšg
->
	`is_em±y
()) {

400 ++
aá”Stİ
;

401 
´eq
 = 
_ba£_æushšg
->
	`pİ
();

402 
´eq
->
	`nÙify_ş›Á
();

403 
_’v
->
_»que¡_poŞ
.
	`de¡roy
(
´eq
);

406 !
_ba£_toæush
->
	`is_em±y
()) {

407 ++
aá”Stİ
;

408 
´eq
 = 
_ba£_toæush
->
	`pİ
();

409 
´eq
->
	`nÙify_ş›Á
();

410 
_’v
->
_»que¡_poŞ
.
	`de¡roy
(
´eq
);

413 ià(
aá”Stİ
>0)

414 
	`TRACE
Ğ
TRACE_ALWAYS
,

416 
aá”Stİ
);

419 
	}
}

422 
EXIT_NAMESPACE
(
shÜe
);

	@src/sm/shore/shore_helper_loader.cpp

31 
	~"sm/shÜe/shÜe_h–³r_lßd”.h
"

32 
	~"sm/shÜe/shÜe_’v.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

47 
	gdb_š™_smt_t
::
	$db_š™_smt_t
(
c_¡r
 
Šame
, 
ShÜeEnv
* 
db
)

48 : 
	`th»ad_t
(
Šame
), 
	$_’v
(
db
)

50 
	`as£¹
 (
_’v
);

51 
	}
}

54 
	gdb_š™_smt_t
::~
	$db_š™_smt_t
()

56 
	}
}

58 
db_š™_smt_t
::
	$wÜk
()

60 ià(!
_’v
->
	`is_š™Ÿlized
()) {

61 
_rv
 = 
_’v
->
	`š™
();

62 ià(
_rv
) {

65 
	`TRACE
Ğ
TRACE_ALWAYS
, "Couldn't initialize Shore...\n");

71 
	`TRACE
Ğ
TRACE_DEBUG
, "Shore initialized...\n");

72 
_rv
 = 0;

73 
	}
}

86 
	gdb_š™_smt_t
::
	$rv
()

88  (
_rv
);

89 
	}
}

92 
	gdb_log_smt_t
::
	$wÜk
()

94 
	`as£¹
 (
_’v
);

95 
_rv
 = 0;

96 
	}
}

99 
	gdb_lßd_smt_t
::
	$wÜk
()

101 
_rc
 = 
_’v
->
	`lßdd©a
();

102 
_rv
 = 0;

103 
	}
}

107 
	gşo£_smt_t
::
	$wÜk
()

109 
	`TRACE
Ğ
TRACE_ALWAYS
, "Closing Shore...\n");

110 ià(
_’v
 !ğ
NULL
)

112 
_’v
->
	`şo£
();

113 
	`d–‘e
 (
_’v
);

114 
_’v
 = 
NULL
;

116 
	}
}

121 
	gdump_smt_t
::
	$wÜk
()

123 
	`as£¹
 (
_’v
);

124 
	`TRACE
Ğ
TRACE_DEBUG
, "Dumping...\n");

125 
_’v
->
	`dump
();

126 
_rv
 = 0;

127 
	}
}

140 
	gabÜt_smt_t
::
abÜt_smt_t
(
c_¡r
 
Šame
,

141 
ShÜeEnv
* 
’v
,

142 
veùÜ
<
xù_t
*>& 
tßbÜt
)

143 : 
th»ad_t
(
Šame
), 
	$_’v
(
’v
)

145 
	`as£¹
(
’v
);

146 
_tßbÜt
 = &
tßbÜt
;

147 
	}
}

149 
	gabÜt_smt_t
::~
	$abÜt_smt_t
()

151 
	}
}

153 
abÜt_smt_t
::
	$wÜk
()

155 
w_rc_t
 
r
 = 
RCOK
;

156 
xù_t
* 
viùim
 = 
NULL
;

157 
	`me
()->
	`®loc_sdesc_ÿche
();

158 
veùÜ
<
xù_t
*>::
™”©Ü
 
™
 = 
_tßbÜt
->
	`begš
();

159 
™
 !ğ
_tßbÜt
->
	`’d
(); ++it) {

161 
viùim
 = *
™
;

162 
	`as£¹
 (
viùim
);

163 
_’v
->
	`db
()->
	`©ch_xù
(
viùim
);

164 
r
 = 
_’v
->
	`db
()->
	`abÜt_xù
();

165 ià(
r
.
	`is_”rÜ
()) {

166 
	`TRACE
Ğ
TRACE_ALWAYS
, "ProbËm‡bÜtšg (%x)\n", *
™
);

169 
_abÜ‹d
++;

172 
	`me
()->
	`ä“_sdesc_ÿche
();

173 
	}
}

	@src/sm/shore/shore_index.cpp

32 
	~"sm/shÜe/shÜe_šdex.h
"

34 
usšg
 
Çme¥aû
 
	gshÜe
;

44 
	gšdex_desc_t
::
	$šdex_desc_t
(cÚ¡ * 
Çme
, cÚ¡ 
f›ldút
,

45 
·¹™iÚs
, cÚ¡ 
ušt
* 
f›lds
,

46 
boŞ
 
unique
, boŞ 
´im¬y
,

47 cÚ¡ 
ušt4_t
& 
pd
,

48 
boŞ
 
rm­hŞd”
)

49 : 
	`_ba£
(
Çme
, 
f›ldút
, 
pd
),

50 
	`_unique
(
unique
), 
	`_´im¬y
(
´im¬y
),

51 
	`_rm­hŞd”
(
rm­hŞd”
),

52 
	`_Ãxt
(
NULL
), 
	`_maxkeysize
(0),

53 
	`_·¹™iÚ_couÁ
((
·¹™iÚs
 > 0)?…¬t™iÚ : 1), 
	$_·¹™iÚ_¡ids
(0)

56 
_key
 = 
Ãw
 
ušt
[
_ba£
.
_f›ld_couÁ
];

57 
ušt_t
 
i
=0; i<
_ba£
.
_f›ld_couÁ
; i++è
_key
[i] = 
f›lds
[i];

59 
	`mem£t
(
_keydesc
, 0, 
MAX_KEYDESC_LEN
);

62 if(
	`is_·¹™iÚed
()) {

63 
_·¹™iÚ_¡ids
 = 
Ãw
 
¡id_t
[
_·¹™iÚ_couÁ
];

64 
i
=0; i < 
_·¹™iÚ_couÁ
; i++)

65 
_·¹™iÚ_¡ids
[
i
] = 
¡id_t
::
nuÎ
;

72 
_mr
 = (
pd
 & (
PD_MRBT_NORMAL
 | 
PD_MRBT_PART
 | 
PD_MRBT_LEAF
));

81 
_nŞock
 = (
pd
 & 
PD_NOLOCK
);

90 
_ÏtchËss
 = (
pd
 & 
PD_NOLATCH
);

100 
	`w_as£¹0
Ğ(!
_rm­hŞd”
è|| (
_mr
 && !
	`is_·¹™iÚed
()));

112 
	}
}

115 
	gšdex_desc_t
::~
	$šdex_desc_t
()

117 ià(
_key
) {

118 
d–‘e
 [] 
_key
;

119 
_key
 = 
NULL
;

123 ià(
_Ãxt
) {

124 
d–‘e
 
_Ãxt
;

125 
_Ãxt
 = 
NULL
;

128 if(
_·¹™iÚ_¡ids
) {

129 
d–‘e
 [] 
_·¹™iÚ_¡ids
;

130 
_·¹™iÚ_¡ids
 = 
NULL
;

132 
	}
}

144 
	gšdex_desc_t
::
	$£t_fid
(cÚ¡ 
²um
, 
¡id_t
 cÚ¡ &
fid
)

146 
	`as£¹
(
²um
 >ğ0 &&…num < 
_·¹™iÚ_couÁ
);

147 ià(
	`is_·¹™iÚed
()) {

148 
_·¹™iÚ_¡ids
[
²um
] = 
fid
;

151 
_ba£
.
	`£t_fid
(
fid
);

153 
	}
}

163 
šdex_desc_t
* 
	gšdex_desc_t
::
	$Ãxt
() const

165  
_Ãxt
;

166 
	}
}

170 
	gšdex_desc_t
::
	$šdex_couÁ
() const

172  (
_Ãxt
 ? _Ãxt->
	`šdex_couÁ
()+1 : 1);

173 
	}
}

177 
	gšdex_desc_t
::
	$š£¹
(
šdex_desc_t
* 
Ãw_node
)

179 
Ãw_node
->
_Ãxt
 = _next;

180 
_Ãxt
 = 
Ãw_node
;

181 
	}
}

185 
šdex_desc_t
* 
	gšdex_desc_t
::
	$fšd_by_Çme
(cÚ¡ * 
Çme
)

187 ià(
	`¡rcmp
(
Çme
, 
_ba£
.
_Çme
è=ğ0è (
this
);

188 ià(
_Ãxt
è _Ãxt->
	`fšd_by_Çme
(
Çme
);

189  (
NULL
);

190 
	}
}

192 
	gšdex_desc_t
::
	$key_šdex
(cÚ¡ 
ušt_t
 
šdex
) const

194 
	`as£¹
 (
šdex
 < 
_ba£
.
_f›ld_couÁ
);

195  (
_key
[
šdex
]);

196 
	}
}

207 
	gšdex_desc_t
::
	$´št_desc
(
o¡»am
& 
os
)

209 
os
 << "Schem¨fÜ index " << 
	`Çme
(è<< 
’dl
;

210 
ušt
 
fc
 = 
	`f›ld_couÁ
();

211 
os
 << "Num” oàf›lds: " << 
fc
 << 
’dl
;

212 
ušt_t
 
i
=0; i< 
fc
; i++) {

213 
os
 << 
_keydesc
[
i
] << "|";

215 
os
 << 
’dl
;

216 
	}
}

219 
	~<s¡»am
>

220 cÚ¡* 
	$db_´‘ty_´št
(
šdex_desc_t
 cÚ¡* 
±desc
, , const* )

222 
d©a
[1024];

223 
¡d
::
¡ršg¡»am
 
	`šout
(
d©a
, sŒšg¡»am::
š
 | sŒšg¡»am::
out
);

225 ((
šdex_desc_t
*)
±desc
)->
	`´št_desc
(
šout
);

226 
šout
 << 
¡d
::
’ds
;

227  
d©a
;

228 
	}
}

	@src/sm/shore/shore_iter.cpp

32 
	~"sm/shÜe/shÜe_™”.h
"

34 
ENTER_NAMESPACE
(
shÜe
);

43 
	gsim¶e_bË_™”_t
::
	$sim¶e_bË_™”_t
(
ss_m
* 
db
, 
fe_desc_t
* 
fe
,

44 
lock_mode_t
 
®m
)

45 : 
	`_db
(
db
), 
	`_İ’ed
(
çl£
), 
	`_fe
(
fe
), 
	$_lm
(
®m
)

47 
	`as£¹
 (
_db
);

48 
	}
}

50 
	gsim¶e_bË_™”_t
::~
	$sim¶e_bË_™”_t
()

52 
	`şo£_sÿn
();

53 
	}
}

56 
w_rc_t
 
	gsim¶e_bË_™”_t
::
	$İ’_sÿn
()

58 ià(!
_İ’ed
) {

59 
	`as£¹
 (
_db
);

60 
_sÿÂ”
 = 
Ãw
 
	`sÿn_fe_i
(
_fe
->
	`fid
(),

61 
ss_m
::
t_cc_»cÜd
,

62 
çl£
, 
_lm
);

63 
_İ’ed
 = 
Œue
;

65  (
RCOK
);

66 
	}
}

69 
w_rc_t
 
	gsim¶e_bË_™”_t
::
	$Ãxt
(
boŞ
& 
eof
, 
pš_i
*& 
hªdË
)

71 ià(!
_İ’ed
è
	`İ’_sÿn
();

72 
	`W_DO
(
_sÿÂ”
->
	`Ãxt
(
hªdË
, 0, 
eof
));

73  (
RCOK
);

74 
	}
}

77 
w_rc_t
 
	gsim¶e_bË_™”_t
::
	$şo£_sÿn
()

79 
_İ’ed
 = 
çl£
;

80  (
RCOK
);

81 
	}
}

84 
pš_i
* 
	gsim¶e_bË_™”_t
::
	$cursÜ
()

86 
pš_i
 *
rv®
;

87 
boŞ
 
eof
;

88 
_sÿÂ”
->
	`cursÜ
(
rv®
, 
eof
);

89  (
eof
? 
NULL
 : 
rv®
);

90 
	}
}

100 
	gsim¶e_šdex_™”_t
::
	$sim¶e_šdex_™”_t
(
ss_m
* 
db
, 
šdex_desc_t
* 
šdex
,

101 
lock_mode_t
 
®m
)

102 : 
	`_db
(
db
), 
	`_İ’ed
(
çl£
), 
	`_idx
(
šdex
), 
	$_lm
(
®m
)

104 
	`as£¹
 (
_db
);

105 
	}
}

107 
	gsim¶e_šdex_™”_t
::~
	$sim¶e_šdex_™”_t
()

109 
	`şo£_sÿn
();

110 
	}
}

120 
w_rc_t
 
	gsim¶e_šdex_™”_t
::
	$İ’_sÿn
(
ušt
 
²um
,

121 
sÿn_šdex_i
::
cmp_t
 
c1
, cÚ¡ 
cvec_t
& 
bound1
,

122 
sÿn_šdex_i
::
cmp_t
 
c2
, cÚ¡ 
cvec_t
& 
bound2
)

124 
_²um
 = 
²um
;

126 ià(!
_İ’ed
) {

132 
ss_m
::
cÚcu¼’cy_t
 
cc
 = ss_m::
t_cc_im
;

133 ià(
_lm
==
NL
è
cc
 = 
ss_m
::
t_cc_nÚe
;

136 
_sÿÂ”
 = 
Ãw
 
	`sÿn_šdex_i
(
_idx
->
	`fid
(
_²um
),

137 
c1
, 
bound1
, 
c2
, 
bound2
,

138 
çl£
, 
cc
,

139 
_lm
);

140 
_İ’ed
 = 
Œue
;

142  (
RCOK
);

143 
	}
}

146 
w_rc_t
 
	gsim¶e_šdex_™”_t
::
	$Ãxt
(
boŞ
& 
eof
, 
rid_t
& 
rid
)

148 
	`as£¹
 (
_İ’ed
);

150 
	`W_DO
(
_sÿÂ”
->
	`Ãxt
(
eof
));

152 ià(!
eof
) {

153 
rid_t
 
tm´id
;

154 
vec_t
 
	`»cÜd
(&
tm´id
, (
rid_t
));

155 
smsize_t
 
–’
 = (
rid_t
);

157 
vec_t
 
tmpvec
;

158 
smsize_t
 
tmpsz
=0;

160 
	`W_DO
(
_sÿÂ”
->
	`cu¼
(&
tmpvec
, 
tmpsz
, &
»cÜd
, 
–’
));

161 
rid
 = 
tm´id
;

163  (
RCOK
);

164 
	}
}

167 
w_rc_t
 
	gsim¶e_šdex_™”_t
::
	$şo£_sÿn
()

169 
_İ’ed
 = 
çl£
;

170  (
RCOK
);

171 
	}
}

174 
EXIT_NAMESPACE
(
shÜe
);

	@src/sm/shore/shore_reqs.cpp

32 
	~"sm/shÜe/shÜe_Œx_wÜk”.h
"

35 
ENTER_NAMESPACE
(
shÜe
);

46 
	gba£_»que¡_t
::
	$nÙify_ş›Á
()

49 
cÚdex
* 
pcÚdex
 = 
_»suÉ
.
	`g‘_nÙify
();

50 ià(
pcÚdex
) {

51 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Xct (%d)‚otifying client (%x)\n",

52 
_tid
.
	`g‘_lo
(), 
pcÚdex
);

53 
_»suÉ
.
	`£t_nÙify
(
NULL
);

54 
pcÚdex
->
	`sigÇl
();

57 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Xct (%d)‚ot‚otifying client\n",

58 
_tid
.
	`g‘_lo
());

60 
	}
}

63 
EXIT_NAMESPACE
(
shÜe
);

	@src/sm/shore/shore_row.cpp

32 
	~"sm/shÜe/shÜe_row.h
"

33 
	~"sm/shÜe/shÜe_bË.h
"

36 
ENTER_NAMESPACE
(
shÜe
);

47 
	g»p_row_t
::
	$»p_row_t
()

48 : 
	`_de¡
(
NULL
), 
	`_bufsz
(0), 
	$_±s
(
NULL
)

49 { 
	}
}

51 
	g»p_row_t
::
	$»p_row_t
(
©s_ch¬_t
* 
­ts
)

52 : 
	`_de¡
(
NULL
), 
	`_bufsz
(0), 
	$_±s
(
­ts
)

54 
	`as£¹
 (
_±s
);

55 
	}
}

57 
	g»p_row_t
::~
	$»p_row_t
()

59 ià(
_de¡
) {

60 
_±s
->
	`de¡roy
(
_de¡
);

61 
_de¡
 = 
NULL
;

63 
	}
}

74 
	g»p_row_t
::
	$£t
(cÚ¡ 
ušt
 
nsz
)

76 ià((!
_de¡
è|| (
_bufsz
 < 
nsz
)) {

78 * 
tmp
 = 
_de¡
;

81 
	`as£¹
 (
_±s
);

84 
	`w_as£¹1
(
nsz
 <ğ
_±s
->
	`nby‹s
());

85 
_de¡
 = (*)
_±s
->
	`acquœe
();

86 
	`as£¹
 (
_de¡
);

88 ià(
tmp
) {

90 
_±s
->
	`de¡roy
(
tmp
);

91 
tmp
 = 
NULL
;

93 
_bufsz
 = 
_±s
->
	`nby‹s
();

97 
	`mem£t
 (
_de¡
, 0, 
nsz
);

98 
	}
}

109 
	g»p_row_t
::
	$£t_ts
(
©s_ch¬_t
* 
­ts
, cÚ¡ 
ušt
 
nsz
)

111 
	`as£¹
(
­ts
);

112 
_±s
 = 
­ts
;

113 
	`£t
(
nsz
);

114 
	}
}

128 
	gbË_row_t
::
	$bË_row_t
()

129 : 
	`_±abË
(
NULL
),

130 
	`_f›ld_út
(0), 
	`_is_£tup
(
çl£
),

131 
	`_rid
(
rid_t
::
nuÎ
), 
	`_pv®ues
(
NULL
),

132 
	`_fixed_off£t
(0),
	`_v¬_¦Ù_off£t
(0),
	`_v¬_off£t
(0),
	`_nuÎ_couÁ
(0),

133 
	`_»p
(
NULL
), 
	$_»p_key
(
NULL
)

135 
	}
}

137 
	gbË_row_t
::~
	$bË_row_t
()

139 
	`ä“v®ues
();

140 
	}
}

154 
	gbË_row_t
::
	$£tup
(
bË_desc_t
* 
±d
)

156 
	`as£¹
 (
±d
);

159 ià((
_±abË
 =ğ
±d
è&& (
_pv®ues
 !ğ
NULL
è&& (
_is_£tup
)) {

160 
	`»£t
();

165 
_±abË
 = 
±d
;

166 
_f›ld_út
 = 
±d
->
	`f›ld_couÁ
();

167 
	`as£¹
 (
_f›ld_út
>0);

168 
_pv®ues
 = 
Ãw
 
f›ld_v®ue_t
[
_f›ld_út
];

170 
ušt
 
v¬_couÁ
 = 0;

171 
ušt
 
fixed_size
 = 0;

174 
ušt
 
i
=0; i<
_f›ld_út
; i++) {

175 
_pv®ues
[
i
].
	`£tup
(
±d
->
	`desc
(i));

178 ià(
_pv®ues
[
i
].
	`is_v¬ŸbË_Ëngth
())

179 
v¬_couÁ
++;

181 
fixed_size
 +ğ
_pv®ues
[
i
].
	`maxsize
();

184 ià(
_pv®ues
[
i
].
	`f›ld_desc
()->
	`®low_nuÎ
())

185 
_nuÎ_couÁ
++;

189 
_fixed_off£t
 = 0;

190 ià(
_nuÎ_couÁ
è
_fixed_off£t
 = ((_null_count-1) >> 3) + 1;

192 
_v¬_¦Ù_off£t
 = 
_fixed_off£t
 + 
fixed_size
;

194 
_v¬_off£t
 = 
_v¬_¦Ù_off£t
 + (
off£t_t
)*
v¬_couÁ
;

196 
_is_£tup
 = 
Œue
;

198 
	}
}

209 
ušt
 
	gbË_row_t
::
	$size
() const

211 
	`as£¹
 (
_is_£tup
);

213 
ušt
 
size
 = 0;

222 
ušt
 
i
=0; i<
_f›ld_út
; i++) {

223 ià(
_pv®ues
[
i
].
_pf›ld_desc
->
	`®low_nuÎ
()) {

224 ià(
_pv®ues
[
i
].
	`is_nuÎ
()) ;

226 ià(
_pv®ues
[
i
].
	`is_v¬ŸbË_Ëngth
()) {

227 
size
 +ğ
_pv®ues
[
i
].
	`»®size
();

228 
size
 +ğ(
off£t_t
);

230 
size
 +ğ
_pv®ues
[
i
].
	`maxsize
();

232 ià(
_nuÎ_couÁ
è
size
 += (_null_count >> 3) + 1;

233  (
size
);

234 
	}
}

246 
	gbË_row_t
::
	$´št_v®ues
(
o¡»am
& 
os
)

248 
	`as£¹
 (
_is_£tup
);

250 
ušt
 
i
=0; i<
_f›ld_út
; i++) {

251 
_pv®ues
[
i
].
	`´št_v®ue
(
os
);

252 ià(
i
 !ğ
_f›ld_út
-1è
os
 << 
DELIM_CHAR
;

254 
os
 << 
ROWEND_CHAR
 << 
’dl
;

255 
	}
}

260 
	gbË_row_t
::
	$´št_tu¶e
()

262 
	`as£¹
 (
_is_£tup
);

264 * 
sbuf
 = 
NULL
;

265 
sz
 = 0;

266 
ušt
 
i
=0; i<
_f›ld_út
; i++) {

267 
sz
 = 
_pv®ues
[
i
].
	`g‘_debug_¡r
(
sbuf
);

268 ià(
sbuf
) {

269 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "%d. % (%d)\n", 
i
, 
sbuf
, 
sz
);

270 
d–‘e
 [] 
sbuf
;

271 
sbuf
 = 
NULL
;

274 
	}
}

278 
	gbË_row_t
::
	$´št_tu¶e_no_Œacšg
()

280 
	`as£¹
 (
_is_£tup
);

282 * 
sbuf
 = 
NULL
;

283 
sz
 = 0;

284 
ušt
 
i
=0; i<
_f›ld_út
; i++) {

285 
sz
 = 
_pv®ues
[
i
].
	`g‘_debug_¡r
(
sbuf
);

286 ià(
sbuf
) {

287 
	`årštf
Ğ
¡d”r
, "%d. % (%d)\n", 
i
, 
sbuf
, 
sz
);

288 
d–‘e
 [] 
sbuf
;

289 
sbuf
 = 
NULL
;

292 
	}
}

295 
EXIT_NAMESPACE
(
shÜe
);

299 
	~<s¡»am
>

300 cÚ¡* 
	$db_´‘ty_´št
(
shÜe
::
bË_row_t
 cÚ¡* 
»c
, , const* )

302 
d©a
[1024];

303 
¡d
::
¡ršg¡»am
 
	`šout
(
d©a
,¡ršg¡»am::
š
 | sŒšg¡»am::
out
);

305 ((
shÜe
::
bË_row_t
*)
»c
)->
	`´št_v®ues
(
šout
);

306 
šout
 << 
¡d
::
’ds
;

307  
d©a
;

308 
	}
}

	@src/sm/shore/shore_shell.cpp

31 
	~"sm/shÜe/shÜe_sh–l.h
"

32 
	~"k_defšes.h
"

35 
ENTER_NAMESPACE
(
shÜe
);

39 "C" 
	$®¬m_hªdËr
(
sig
)

41 if(
sig
 =ğ
SIGALRM
) {

42 if(
_g_shÜe_’v
->
	`g‘_m—su»
(è!ğ
MST_DONE
) {

43 
	`TRACE
Ğ
TRACE_ALWAYS
, "Start Load Imbalance\n");

44 
_g_shÜe_’v
->
	`¡¬t_lßd_imb®ªû
();

47 
_g_shÜe_’v
->
	`£t_m—su»
(
MST_DONE
);

49 
	}
}

51 
boŞ
 vŞ©
_g_ÿnûËd
 = 
çl£
;

53 
	g_theSF
 = 
DF_SF
;

59 
	gshÜe_sh–l_t
::
	$shÜe_sh–l_t
(cÚ¡ * 
´om±
,

60 cÚ¡ 
boŞ
 
Ãtmode
,

61 cÚ¡ 
ÃÜt
,

62 cÚ¡ 
boŞ
 
šputfemode
,

63 cÚ¡ 
¡ršg
 
šputfe
,

64 
´oûssÜid_t
 
aıu¡¬t
)

65 : 
	`sh–l_t
(
´om±
,
Œue
,
Ãtmode
,
ÃÜt
,
šputfemode
,
šputfe
),

66 
	`_’v
(
NULL
),

67 
	`_¡¬t_´s_id
(
aıu¡¬t
), 
	$_cu¼’t_´s_id
(
aıu¡¬t
)

70 
sigaùiÚ
 
§
;

71 
sigaùiÚ
 
§_Şd
;

72 
§
.
§_æags
 = 0;

73 
	`sigem±y£t
(&
§
.
§_mask
);

74 
§
.
§_hªdËr
 = &
®¬m_hªdËr
;

75 if(
	`sigaùiÚ
(
SIGALRM
, &
§
, &
§_Şd
) < 0) {

76 
	`ex™
(1);

78 
	}
}

80 
	gshÜe_sh–l_t
::~
	$shÜe_sh–l_t
()

82 ià(
_’v
) {

83 
_’v
->
	`¡İ
();

84 
şo£_smt_t
* 
şt
 = 
Ãw
 
	`şo£_smt_t
(
_’v
, 
	`c_¡r
("clt"));

85 
	`w_as£¹0
 (
şt
);

86 
şt
->
	`fÜk
();

87 
şt
->
	`još
();

88 
rv
 = 
şt
->
_rv
;

89 ià(
rv
) {

90 
	`årštf
Ğ
¡d”r
, "Error in closinghread...\n");

92 
	`d–‘e
 (
şt
);

93 
şt
 = 
NULL
;

95 
	}
}

110 
	gshÜe_sh–l_t
::
	$´št_sup_Œxs
() const

112 
	`TRACE
Ğ
TRACE_ALWAYS
, "Supported TRXs\n");

113 
m­SupTrxsCÚ¡It
 
c™
ğ
_sup_Œxs
.
	`begš
();

114 
c™
 !ğ
_sup_Œxs
.
	`’d
(); cit++)

115 
	`TRACE
Ğ
TRACE_ALWAYS
, "%d -> %s\n", 
c™
->
fœ¡
, c™->
£cÚd
.
	`c_¡r
());

116 
	}
}

118 cÚ¡ * 
	gshÜe_sh–l_t
::
	$Œª¦©e_Œx
(cÚ¡ 
iS–eùedTrx
) const

120 
m­SupTrxsCÚ¡It
 
c™
 = 
_sup_Œxs
.
	`fšd
(
iS–eùedTrx
);

121 ià(
c™
 !ğ
_sup_Œxs
.
	`’d
())

122  (
c™
->
£cÚd
.
	`c_¡r
());

124 
	}
}

129 
	gshÜe_sh–l_t
::
	$´št_sup_bp
()

131 
	`TRACE
Ğ
TRACE_ALWAYS
, "Supported Binding Policies\n");

132 
m­BšdPŞsIt
 
c™
ğ
_sup_bps
.
	`begš
();

133 
c™
 !ğ
_sup_bps
.
	`’d
(); cit++)

134 
	`TRACE
Ğ
TRACE_ALWAYS
, "%d -> %s\n", 
c™
->
fœ¡
, c™->
£cÚd
.
	`c_¡r
());

135 
	}
}

137 cÚ¡ * 
	gshÜe_sh–l_t
::
	$Œª¦©e_bp
(cÚ¡ 
eBšdšgTy³
 
abt
)

139 
m­BšdPŞsIt
 
™
 = 
_sup_bps
.
	`fšd
(
abt
);

140 ià(
™
 !ğ
_sup_bps
.
	`’d
())

141  (
™
->
£cÚd
.
	`c_¡r
());

143 
	}
}

161 
´oûssÜid_t
 
	gshÜe_sh–l_t
::
	$Ãxt_ıu
(cÚ¡ 
eBšdšgTy³
 
abt
,

162 cÚ¡ 
´oûssÜid_t
 
­rd
)

164 
´oûssÜid_t
 
Ãxrs
;

165 
abt
) {

166 (
BT_NONE
):

167  (
PBIND_NONE
);

168 (
BT_NEXT
):

169 
Ãxrs
 = ((
­rd
+1è% 
_’v
->
	`g‘_aùive_ıu_couÁ
());

170  (
Ãxrs
);

171 (
BT_SPREAD
):

172 cÚ¡ 
ušt
 
NIAGARA_II_STEP
 = 8;

173 
Ãxrs
 = ((
­rd
+
NIAGARA_II_STEP
è% 
_’v
->
	`g‘_aùive_ıu_couÁ
());

174  (
Ãxrs
);

176 
	`as£¹
 (0);

177  (
Ãxrs
);

178 
	}
}

189 
	gshÜe_sh–l_t
::
	$´št_MEASURE_šfo
(cÚ¡ 
iQu”›dSF
, cÚ¡ 
iS´—d
,

190 cÚ¡ 
iNumOfTh»ads
, cÚ¡ 
iDu¿tiÚ
,

191 cÚ¡ 
iS–eùedTrx
, cÚ¡ 
iI‹¿tiÚs
,

192 cÚ¡ 
eBšdšgTy³
 
abt
)

195 
	`TRACE
Ğ
TRACE_ALWAYS
, "\n" \

203 
iQu”›dSF
, (
iS´—d
 ? "Yes" : "No"),

204 
	`Œª¦©e_bp
(
abt
),

205 
iNumOfTh»ads
, 
iDu¿tiÚ
, 
	`Œª¦©e_Œx
(
iS–eùedTrx
),

206 
iI‹¿tiÚs
);

207 
	}
}

210 
	gshÜe_sh–l_t
::
	$´št_TEST_šfo
(cÚ¡ 
iQu”›dSF
, cÚ¡ 
iS´—d
,

211 cÚ¡ 
iNumOfTh»ads
, cÚ¡ 
iNumOfTrxs
,

212 cÚ¡ 
iS–eùedTrx
, cÚ¡ 
iI‹¿tiÚs
,

213 cÚ¡ 
eBšdšgTy³
 
abt
)

216 
	`TRACE
Ğ
TRACE_ALWAYS
, "\n"

224 
iQu”›dSF
, (
iS´—d
 ? "Yes" : "No"),

225 
	`Œª¦©e_bp
(
abt
),

226 
iNumOfTh»ads
, 
iNumOfTrxs
, 
	`Œª¦©e_Œx
(
iS–eùedTrx
),

227 
iI‹¿tiÚs
);

228 
	}
}

239 
	gshÜe_sh–l_t
::
	$´št_u§ge
(cÚ¡ * 
commªd
)

241 
	`as£¹
 (
commªd
);

243 
	`TRACE
Ğ
TRACE_ALWAYS
, "\n\nSupported commands: TRXS/LOAD/WARMUP/TEST/MEASURE\n\n" );

245 
	`TRACE
Ğ
TRACE_ALWAYS
, "WARMUP Usage:\n\n" \

253 
	`TRACE
Ğ
TRACE_ALWAYS
, "TEST Usage:\n\n" \

264 
	`TRACE
Ğ
TRACE_ALWAYS
, "MEASURE Usage:\n\n" \

275 
	`TRACE
Ğ
TRACE_ALWAYS
, "\n\nCu¼’y Sÿlšg faùÜ = (%d)\n", 
_theSF
);

277 
	`´št_sup_Œxs
();

278 
	`´št_sup_bp
();

280  (
SHELL_NEXT_CONTINUE
);

281 
	}
}

294 
	gshÜe_sh–l_t
::
	$´e_´oûss_cmd
()

296 
_g_ÿnûËd
 = 
çl£
;

298 
_cu¼’t_´s_id
 = 
_¡¬t_´s_id
;

301 
ba£_ş›Á_t
::
	`»sume_‹¡
();

303 #ifdeà
HAVE_CPUMON


304 
_g_mÚ
->
	`¡©_»£t
();

306 
	}
}

318 
	gshÜe_sh–l_t
::
	$´oûss_cmd_LOAD
(const * )

320 
	`as£¹
 (
_’v
);

321 
	`as£¹
 (
_’v
->
	`is_š™Ÿlized
());

323 ià(
_’v
->
	`is_lßded
()) {

324 
	`TRACE
Ğ
TRACE_ALWAYS
, "Environment‡lready†oaded\n");

325  (
SHELL_NEXT_CONTINUE
);

329  (
	`_cmd_LOAD_im¶
());

330 
	}
}

341 
	gshÜe_sh–l_t
::
	$´oûss_cmd_WARMUP
(cÚ¡ * 
commªd
)

343 
	`as£¹
 (
_’v
);

344 
	`as£¹
 (
_’v
->
	`is_š™Ÿlized
());

348 
w_rc_t
 
rş
 = 
_’v
->
	`lßdd©a
();

349 ià(
rş
.
	`is_”rÜ
()) {

350  (
SHELL_NEXT_QUIT
);

354 
’vV¬
* 
ev
 =ƒnvV¬::
	`š¡ªû
();

355 
numOfQu”›dSF
 = 
ev
->
	`g‘V¬DoubË
("‹¡-num-qu”›d",
DF_NUM_OF_QUERIED_SF
);

356 
tmp_numOfQu”›dSF
 = 
numOfQu”›dSF
;

357 
numOfTrxs
 = 
ev
->
	`g‘V¬IÁ
("‹¡-num-Œxs",
DF_WARMUP_TRX_PER_THR
);

358 
tmp_numOfTrxs
 = 
numOfTrxs
;

359 
du¿tiÚ
 = 
ev
->
	`g‘V¬IÁ
("m—su»-du¿tiÚ",
DF_WARMUP_DURATION
);

360 
tmp_du¿tiÚ
 = 
du¿tiÚ
;

361 
™”©iÚs
 = 
ev
->
	`g‘V¬IÁ
("‹¡-™”©iÚs",
DF_WARMUP_ITERS
);

362 
tmp_™”©iÚs
 = 
™”©iÚs
;

366 
commªd_g
[
SERVER_COMMAND_BUFFER_SIZE
];

367 iàĞ
	`ssÿnf
(
commªd
, "%s %lf %d %d %d",

368 
commªd_g
,

369 &
tmp_numOfQu”›dSF
,

370 &
tmp_numOfTrxs
,

371 &
tmp_du¿tiÚ
,

372 &
tmp_™”©iÚs
) < 1 )

374 
	`TRACE
Ğ
TRACE_ALWAYS
, "Wrong input. Type (help warmup)\n");

375  (
SHELL_NEXT_CONTINUE
);

382 ià((
tmp_numOfQu”›dSF
>0è&& (tmp_numOfQu”›dSF<=
_theSF
)) {

383 
numOfQu”›dSF
 = 
tmp_numOfQu”›dSF
;

386 
numOfQu”›dSF
 = 
_theSF
;

388 
	`as£¹
 (
numOfQu”›dSF
 <ğ
_theSF
);

391 ià(
tmp_numOfTrxs
>0)

392 
numOfTrxs
 = 
tmp_numOfTrxs
;

395 ià(
tmp_du¿tiÚ
>0)

396 
du¿tiÚ
 = 
tmp_du¿tiÚ
;

399 ià(
tmp_™”©iÚs
>0)

400 
™”©iÚs
 = 
tmp_™”©iÚs
;

404 
	`TRACE
Ğ
TRACE_ALWAYS
, "\n" \

409 
numOfQu”›dSF
, 
numOfTrxs
, 
du¿tiÚ
, 
™”©iÚs
);

412  (
	`_cmd_WARMUP_im¶
(
numOfQu”›dSF
, 
numOfTrxs
, 
du¿tiÚ
, 
™”©iÚs
));

413 
	}
}

426 
	gshÜe_sh–l_t
::
	$´oûss_cmd_TEST
(cÚ¡ * 
commªd
)

428 
	`as£¹
 (
_’v
);

429 
	`as£¹
 (
_’v
->
	`is_š™Ÿlized
());

433 
w_rc_t
 
rş
 = 
_’v
->
	`lßdd©a
();

434 ià(
rş
.
	`is_”rÜ
()) {

435  (
SHELL_NEXT_QUIT
);

439 
’vV¬
* 
ev
 =ƒnvV¬::
	`š¡ªû
();

440 
numOfQu”›dSF
 = 
ev
->
	`g‘V¬DoubË
("‹¡-num-qu”›d",
DF_NUM_OF_QUERIED_SF
);

441 
tmp_numOfQu”›dSF
 = 
numOfQu”›dSF
;

442 
¥»adTh»ads
 = 
ev
->
	`g‘V¬IÁ
("‹¡-¥»ad",
DF_SPREAD_THREADS
);

443 
tmp_¥»adTh»ads
 = 
¥»adTh»ads
;

444 
numOfTh»ads
 = 
ev
->
	`g‘V¬IÁ
("‹¡-num-th»ads",
DF_NUM_OF_THR
);

445 
tmp_numOfTh»ads
 = 
numOfTh»ads
;

446 
numOfTrxs
 = 
ev
->
	`g‘V¬IÁ
("‹¡-num-Œxs",
DF_TRX_PER_THR
);

447 
tmp_numOfTrxs
 = 
numOfTrxs
;

448 
£ËùedTrxID
 = 
ev
->
	`g‘V¬IÁ
("‹¡-Œx-id",
DF_TRX_ID
);

449 
tmp_£ËùedTrxID
 = 
£ËùedTrxID
;

450 
™”©iÚs
 = 
ev
->
	`g‘V¬IÁ
("‹¡-™”©iÚs",
DF_NUM_OF_ITERS
);

451 
tmp_™”©iÚs
 = 
™”©iÚs
;

452 
bšdšg
 = 
DF_BINDING_TYPE
;

453 
tmp_bšdšg
 = 
bšdšg
;

457 
tmp_sf
 = 
ev
->
	`g‘SysV¬DoubË
("sf");

458 ià(
tmp_sf
>0) {

459 
	`TRACE
Ğ
TRACE_STATISTICS
, "Upd©ed SF (%.1f)\n", 
tmp_sf
);

460 
_theSF
 = 
tmp_sf
;

465 
commªd_g
[
SERVER_COMMAND_BUFFER_SIZE
];

466 iàĞ
	`ssÿnf
(
commªd
, "%s %lf %d %d %d %d %d %d",

467 
commªd_g
,

468 &
tmp_numOfQu”›dSF
,

469 &
tmp_¥»adTh»ads
,

470 &
tmp_numOfTh»ads
,

471 &
tmp_numOfTrxs
,

472 &
tmp_£ËùedTrxID
,

473 &
tmp_™”©iÚs
,

474 &
tmp_bšdšg
) < 2 )

476 
	`TRACE
Ğ
TRACE_ALWAYS
, "Wrong input. Type (helpest)\n");

477  (
SHELL_NEXT_CONTINUE
);

484 ià((
tmp_numOfQu”›dSF
>0è&& (tmp_numOfQu”›dSF<=
_theSF
)) {

485 
numOfQu”›dSF
 = 
tmp_numOfQu”›dSF
;

488 
numOfQu”›dSF
 = 
_theSF
;

490 
	`as£¹
 (
numOfQu”›dSF
 <ğ
_theSF
);

496 
¥»adTh»ads
 = 
tmp_¥»adTh»ads
;

499 ià((
tmp_numOfTh»ads
>0è&& (tmp_numOfTh»ads<=
MAX_NUM_OF_THR
)) {

500 
numOfTh»ads
 = 
tmp_numOfTh»ads
;

503 ià(
¥»adTh»ads
 && ((
numOfTh»ads
 % ()
numOfQu”›dSF
)!=0)) {

504 
	`TRACE
Ğ
TRACE_ALWAYS
,

506 
numOfQu”›dSF
, 
numOfTh»ads
);

510 
numOfTh»ads
 = 
numOfQu”›dSF
;

514 ià(
tmp_numOfTrxs
>0)

515 
numOfTrxs
 = 
tmp_numOfTrxs
;

518 
m­SupTrxsCÚ¡It
 
¡
 = 
_sup_Œxs
.
	`fšd
(
tmp_£ËùedTrxID
);

519 ià(
¡
!=
_sup_Œxs
.
	`’d
()) {

520 
£ËùedTrxID
 = 
tmp_£ËùedTrxID
;

523 
	`TRACE
Ğ
TRACE_ALWAYS
, "Unsupported TRX\n");

524  (
SHELL_NEXT_CONTINUE
);

528 ià(
tmp_™”©iÚs
>0)

529 
™”©iÚs
 = 
tmp_™”©iÚs
;

532 
m­BšdPŞsIt
 
c™
 = 
_sup_bps
.
	`fšd
(
	`eBšdšgTy³
(
tmp_bšdšg
));

533 ià(
c™
!ğ
_sup_bps
.
	`’d
()) {

534 
bšdšg
 = 
tmp_bšdšg
;

537 
	`TRACE
Ğ
TRACE_ALWAYS
, "Unsupported Binding\n");

538  (
SHELL_NEXT_CONTINUE
);

543  (
	`_cmd_TEST_im¶
(
numOfQu”›dSF
, 
¥»adTh»ads
, 
numOfTh»ads
,

544 
numOfTrxs
, 
£ËùedTrxID
, 
™”©iÚs
,

545 
	`eBšdšgTy³
(
bšdšg
)));

546 
	}
}

558 
	gshÜe_sh–l_t
::
	$´oûss_cmd_MEASURE
(cÚ¡ * 
commªd
)

560 
	`as£¹
 (
_’v
);

561 
	`as£¹
 (
_’v
->
	`is_š™Ÿlized
());

565 
w_rc_t
 
rş
 = 
_’v
->
	`lßdd©a
();

566 ià(
rş
.
	`is_”rÜ
()) {

567  (
SHELL_NEXT_QUIT
);

571 
’vV¬
* 
ev
 =ƒnvV¬::
	`š¡ªû
();

572 
numOfQu”›dSF
 = 
ev
->
	`g‘V¬DoubË
("m—su»-num-qu”›d",
DF_NUM_OF_QUERIED_SF
);

573 
tmp_numOfQu”›dSF
 = 
numOfQu”›dSF
;

574 
¥»adTh»ads
 = 
ev
->
	`g‘V¬IÁ
("m—su»-¥»ad",
DF_SPREAD_THREADS
);

575 
tmp_¥»adTh»ads
 = 
¥»adTh»ads
;

576 
numOfTh»ads
 = 
ev
->
	`g‘V¬IÁ
("m—su»-num-th»ads",
DF_NUM_OF_THR
);

577 
tmp_numOfTh»ads
 = 
numOfTh»ads
;

578 
du¿tiÚ
 = 
ev
->
	`g‘V¬IÁ
("m—su»-du¿tiÚ",
DF_DURATION
);

579 
tmp_du¿tiÚ
 = 
du¿tiÚ
;

580 
£ËùedTrxID
 = 
ev
->
	`g‘V¬IÁ
("m—su»-Œx-id",
DF_TRX_ID
);

581 
tmp_£ËùedTrxID
 = 
£ËùedTrxID
;

582 
™”©iÚs
 = 
ev
->
	`g‘V¬IÁ
("m—su»-™”©iÚs",
DF_NUM_OF_ITERS
);

583 
tmp_™”©iÚs
 = 
™”©iÚs
;

584 
bšdšg
 = 
DF_BINDING_TYPE
;

585 
tmp_bšdšg
 = 
bšdšg
;

588 
commªd_g
[
SERVER_COMMAND_BUFFER_SIZE
];

589 iàĞ
	`ssÿnf
(
commªd
, "%s %lf %d %d %d %d %d %d",

590 
commªd_g
,

591 &
tmp_numOfQu”›dSF
,

592 &
tmp_¥»adTh»ads
,

593 &
tmp_numOfTh»ads
,

594 &
tmp_du¿tiÚ
,

595 &
tmp_£ËùedTrxID
,

596 &
tmp_™”©iÚs
,

597 &
tmp_bšdšg
) < 2 )

599 
	`TRACE
Ğ
TRACE_ALWAYS
, "Wrong input. Type (help measure)\n");

600  (
SHELL_NEXT_CONTINUE
);

604 
tmp_sf
 = 
ev
->
	`g‘SysV¬DoubË
("sf");

605 ià(
tmp_sf
>0) {

606 
	`TRACE
Ğ
TRACE_DEBUG
, "Upd©ed SF (%.1f)\n", 
tmp_sf
);

607 
_theSF
 = 
tmp_sf
;

614 ià((
tmp_numOfQu”›dSF
>0è&& (tmp_numOfQu”›dSF<=
_theSF
)) {

615 
numOfQu”›dSF
 = 
tmp_numOfQu”›dSF
;

618 
numOfQu”›dSF
 = 
_theSF
;

620 
	`as£¹
 (
numOfQu”›dSF
 <ğ
_theSF
);

626 
¥»adTh»ads
 = 
tmp_¥»adTh»ads
;

629 ià((
tmp_numOfTh»ads
>0è&& (tmp_numOfTh»ads<=
MAX_NUM_OF_THR
)) {

630 
numOfTh»ads
 = 
tmp_numOfTh»ads
;

633 ià(
¥»adTh»ads
 && ((
numOfTh»ads
 % ()
numOfQu”›dSF
)!=0)) {

634 
	`TRACE
Ğ
TRACE_ALWAYS
,

636 
numOfQu”›dSF
, 
numOfTh»ads
);

640 
numOfTh»ads
 = 
numOfQu”›dSF
;

644 ià(
tmp_du¿tiÚ
>0)

645 
du¿tiÚ
 = 
tmp_du¿tiÚ
;

648 
m­SupTrxsCÚ¡It
 
¡
 = 
_sup_Œxs
.
	`fšd
(
tmp_£ËùedTrxID
);

649 ià(
¡
!=
_sup_Œxs
.
	`’d
()) {

650 
£ËùedTrxID
 = 
tmp_£ËùedTrxID
;

653 
	`TRACE
Ğ
TRACE_ALWAYS
, "Unsupported TRX\n");

654  (
SHELL_NEXT_CONTINUE
);

658 ià(
tmp_™”©iÚs
>0)

659 
™”©iÚs
 = 
tmp_™”©iÚs
;

662 
m­BšdPŞsIt
 
c™
 = 
_sup_bps
.
	`fšd
(
	`eBšdšgTy³
(
tmp_bšdšg
));

663 ià(
c™
!ğ
_sup_bps
.
	`’d
()) {

664 
bšdšg
 = 
tmp_bšdšg
;

667 
	`TRACE
Ğ
TRACE_ALWAYS
, "Unsupported Binding\n");

668  (
SHELL_NEXT_CONTINUE
);

672  (
	`_cmd_MEASURE_im¶
(
numOfQu”›dSF
, 
¥»adTh»ads
, 
numOfTh»ads
,

673 
du¿tiÚ
, 
£ËùedTrxID
, 
™”©iÚs
,

674 
	`eBšdšgTy³
(
bšdšg
)));

675 
	}
}

686 
	gshÜe_sh–l_t
::
	$SIGINT_hªdËr
()

688 if(
_´oûssšg_commªd
 && !
_g_ÿnûËd
) {

689 
_g_ÿnûËd
 = 
Œue
;

690 
ba£_ş›Á_t
::
	`abÜt_‹¡
();

695  (
sh–l_t
::
	`SIGINT_hªdËr
());

696 
	}
}

707 
	gshÜe_sh–l_t
::
	$_cmd_WARMUP_im¶
(const ,

712 
	`TRACE
Ğ
TRACE_ALWAYS
, "warming up...\n");

714 
	`as£¹
 (
_’v
);

715 
	`as£¹
 (
_’v
->
	`is_š™Ÿlized
());

716 
	`as£¹
 (
_’v
->
	`is_lßded
());

719 
w_rc_t
 
rcw
 = 
_’v
->
	`w¬mup
();

720 ià(
rcw
.
	`is_”rÜ
()) {

721 
	`as£¹
 (0);

722  (
SHELL_NEXT_QUIT
);

724  (
SHELL_NEXT_CONTINUE
);

725 
	}
}

736 
	gshÜe_sh–l_t
::
	$_cmd_LOAD_im¶
()

738 
	`TRACE
Ğ
TRACE_ALWAYS
, "loading...\n");

740 
	`as£¹
 (
_’v
);

741 
	`as£¹
 (
_’v
->
	`is_š™Ÿlized
());

743 
w_rc_t
 
rş
 = 
_’v
->
	`lßdd©a
();

744 ià(
rş
.
	`is_”rÜ
()) {

745 
	`TRACE
Ğ
TRACE_ALWAYS
, "Problem†oading data\n");

746  (
SHELL_NEXT_QUIT
);

748 
	`as£¹
 (
_’v
->
	`is_lßded
());

749  (
SHELL_NEXT_CONTINUE
);

750 
	}
}

757 
	gshÜe_sh–l_t
::
	$»gi¡”_commªds
()

759 
	`REGISTER_CMD_PARAM
(
»¡¬t_cmd_t
,
_»¡¬‹r
,
_’v
);

760 
	`REGISTER_CMD_PARAM
(
šfo_cmd_t
,
_šfÜm”
,
_’v
);

761 
	`REGISTER_CMD_PARAM
(
¡©s_cmd_t
,
_¡©”
,
_’v
);

762 
	`REGISTER_CMD_PARAM
(
sm¡©s_cmd_t
,
_sm¡©”
,
_’v
);

763 
	`REGISTER_CMD_PARAM
(
dump_cmd_t
,
_dum³r
,
_’v
);

764 
	`REGISTER_CMD_PARAM
(
çke_iod–ay_cmd_t
,
_çkeiÛr
,
_’v
);

765 
	`REGISTER_CMD_PARAM
(
äeq_cmd_t
,
_äeq”
,
_’v
);

766 
	`REGISTER_CMD_PARAM
(
skew_cmd_t
,
_skew”
,
_’v
);

767 
	`REGISTER_CMD_PARAM
(
¡©s_v”bo£_cmd_t
,
_¡©s_v”bo£r
,
_’v
);

768 
	`REGISTER_CMD_PARAM
(
db_´št_cmd_t
,
_db_´š‹r
,
_’v
);

769 
	`REGISTER_CMD_PARAM
(
db_ãtch_cmd_t
,
_db_ãtch
,
_’v
);

771 
	`REGISTER_CMD_PARAM
(
log_cmd_t
,
_logg”
,
_’v
);

772 
	`REGISTER_CMD_PARAM
(
asynch_cmd_t
,
_asynch”
,
_’v
);

774 
	`REGISTER_CMD_PARAM
(
¦i_cmd_t
,
_¦›r
,
_’v
);

775 
	`REGISTER_CMD_PARAM
(
–r_cmd_t
,
_–»r
,
_’v
);

777 #ifdeà
CFG_BT


778 
	`REGISTER_CMD_PARAM
(
bt_cmd_t
,
_b‹r
,
_’v
);

781 
	`REGISTER_CMD_PARAM
(
m—su»_cmd_t
,
_m—su»r
,
this
);

782 
	`REGISTER_CMD_PARAM
(
‹¡_cmd_t
,
_‹¡”
,
this
);

783 
	`REGISTER_CMD_PARAM
(
w¬mup_cmd_t
,
_w¬mu³r
,
this
);

784 
	`REGISTER_CMD_PARAM
(
lßd_cmd_t
,
_lßd”
,
this
);

785 
	`REGISTER_CMD_PARAM
(
Œxs_cmd_t
,
_Œx£r
,
this
);

788 
	}
}

801 
	g»¡¬t_cmd_t
::
	$£lŸ£s
()

803 
_Çme
 = 
	`¡ršg
("restart");

804 
_®Ÿ£s
.
	`push_back
("restart");

805 
	}
}

807 
	g»¡¬t_cmd_t
::
	$hªdË
(const * )

809 
	`as£¹
 (
_’v
);

810 
_’v
->
	`¡İ
();

811 
_’v
->
	`¡¬t
();

812  (
SHELL_NEXT_CONTINUE
);

813 
	}
}

815 
	g»¡¬t_cmd_t
::
	$u§ge
()

817 
	`TRACE
Ğ
TRACE_ALWAYS
, "usage: info\n");

818 
	}
}

820 
¡ršg
 
	g»¡¬t_cmd_t
::
	$desc
() const

822  (
	`¡ršg
("Restart"));

823 
	}
}

834 
	gšfo_cmd_t
::
	$£lŸ£s
()

836 
_Çme
 = 
	`¡ršg
("info");

837 
_®Ÿ£s
.
	`push_back
("info");

838 
_®Ÿ£s
.
	`push_back
("i");

839 
	}
}

841 
	gšfo_cmd_t
::
	$hªdË
(const * )

843 
	`as£¹
 (
_’v
);

844 
_’v
->
	`šfo
();

845  (
SHELL_NEXT_CONTINUE
);

846 
	}
}

848 
	gšfo_cmd_t
::
	$u§ge
()

850 
	`TRACE
Ğ
TRACE_ALWAYS
, "usage: info\n");

851 
	}
}

853 
¡ršg
 
	gšfo_cmd_t
::
	$desc
() const

855  (
	`¡ršg
("Prints info‡bouthe state of db instance"));

856 
	}
}

867 
	g¡©s_cmd_t
::
	$£lŸ£s
()

869 
_Çme
 = 
	`¡ršg
("stats");

870 
_®Ÿ£s
.
	`push_back
("stats");

871 
_®Ÿ£s
.
	`push_back
("st");

872 
	}
}

874 
	g¡©s_cmd_t
::
	$hªdË
(const * )

876 
	`as£¹
 (
_’v
);

877 
_’v
->
	`¡©i¡ics
();

878  (
SHELL_NEXT_CONTINUE
);

879 
	}
}

881 
	g¡©s_cmd_t
::
	$u§ge
()

883 
	`TRACE
Ğ
TRACE_ALWAYS
, "usage: stats\n");

884 
	}
}

886 
¡ršg
 
	g¡©s_cmd_t
::
	$desc
() const

888  (
	`¡ršg
("Prints gathered statistics"));

889 
	}
}

899 
	gsm¡©s_cmd_t
::
	$£lŸ£s
()

901 
_Çme
 = 
	`¡ršg
("smstats");

902 
_®Ÿ£s
.
	`push_back
("smst");

903 
	}
}

905 
	gsm¡©s_cmd_t
::
	$hªdË
(const * )

907 
	`as£¹
 (
_’v
);

908 
_’v
->
	`g©h”¡©s_sm
();

909  (
SHELL_NEXT_CONTINUE
);

910 
	}
}

912 
	gsm¡©s_cmd_t
::
	$u§ge
()

914 
	`TRACE
Ğ
TRACE_ALWAYS
, "usage: smstats\n");

915 
	}
}

917 
¡ršg
 
	gsm¡©s_cmd_t
::
	$desc
() const

919  (
	`¡ršg
("Prints gathered statistics fromhe SM"));

920 
	}
}

931 
	gdump_cmd_t
::
	$£lŸ£s
()

933 
_Çme
 = 
	`¡ršg
("dump");

934 
_®Ÿ£s
.
	`push_back
("dump");

935 
_®Ÿ£s
.
	`push_back
("d");

936 
	}
}

938 
	gdump_cmd_t
::
	$hªdË
(const * )

940 
	`as£¹
 (
_’v
);

941 
_’v
->
	`dump
();

942  (
SHELL_NEXT_CONTINUE
);

943 
	}
}

945 
	gdump_cmd_t
::
	$u§ge
()

947 
	`TRACE
Ğ
TRACE_ALWAYS
, "usage: dump\n");

948 
	}
}

950 
¡ršg
 
	gdump_cmd_t
::
	$desc
() const

952  (
	`¡ršg
("Dumps db instance data"));

953 
	}
}

964 
	gçke_iod–ay_cmd_t
::
	$£lŸ£s
()

966 
_Çme
 = 
	`¡ršg
("iodelay");

967 
_®Ÿ£s
.
	`push_back
("iodelay");

968 
_®Ÿ£s
.
	`push_back
("io");

969 
	}
}

971 
	gçke_iod–ay_cmd_t
::
	$hªdË
(cÚ¡ * 
cmd
)

973 
cmd_g
[
SERVER_COMMAND_BUFFER_SIZE
];

974 
iod–ay_g
[
SERVER_COMMAND_BUFFER_SIZE
];

975 iàĞ
	`ssÿnf
(
cmd
, "% %s", 
cmd_g
, 
iod–ay_g
) < 2) {

977 
	`u§ge
();

978  (
SHELL_NEXT_CONTINUE
);

980 
	`as£¹
 (
_’v
);

981 
d–ay
 = 
	`©oi
(
iod–ay_g
);

982 ià(!
d–ay
>0) {

983 
_’v
->
	`di§bË_çke_disk_Ï‹ncy
();

986 
_’v
->
	`’abË_çke_disk_Ï‹ncy
(
d–ay
);

988  (
SHELL_NEXT_CONTINUE
);

989 
	}
}

992 
	gçke_iod–ay_cmd_t
::
	$u§ge
()

994 
	`TRACE
Ğ
TRACE_ALWAYS
, "IODELAY Usage:\n\n" \

998 
	}
}

1000 
¡ršg
 
	gçke_iod–ay_cmd_t
::
	$desc
() const

1002  (
	`¡ršg
("Setshe fake I/O disk delay"));

1003 
	}
}

1015 
	gäeq_cmd_t
::
	$£lŸ£s
()

1017 
_Çme
 = 
	`¡ršg
("freq");

1018 
_®Ÿ£s
.
	`push_back
("freq");

1019 
	}
}

1021 
	gäeq_cmd_t
::
	$hªdË
(cÚ¡ * 
cmd
)

1023 
cmd_g
[
SERVER_COMMAND_BUFFER_SIZE
];

1024 
sIn£¹F»q
[
SERVER_COMMAND_BUFFER_SIZE
];

1025 
sD–‘eF»q
[
SERVER_COMMAND_BUFFER_SIZE
];

1027 iàĞ
	`ssÿnf
(
cmd
, "% % %s", 
cmd_g
, 
sIn£¹F»q
, 
sD–‘eF»q
) < 3) {

1029 
	`u§ge
();

1030  (
SHELL_NEXT_CONTINUE
);

1032 
	`as£¹
 (
_’v
);

1034 
š£¹_äeq
 = 
	`©oi
(
sIn£¹F»q
);

1035 
d–‘e_äeq
 = 
	`©oi
(
sD–‘eF»q
);

1038 
š£¹_äeq
= (insert_freq<0) ? 0 : insert_freq;

1039 
š£¹_äeq
= (insert_freq>100) ? 100 : insert_freq;

1042 
d–‘e_äeq
= (delete_freq<0) ? 0 : delete_freq;

1043 
d–‘e_äeq
ğ(
š£¹_äeq
+delete_freq>100) ? (100-insert_freq) : delete_freq;

1046 
´obe_äeq
 = 100-
š£¹_äeq
-
d–‘e_äeq
;

1048 
	`TRACE
Ğ
TRACE_ALWAYS
, "Setting frequencies I=%d%% D=%d%% P=%d%%\n",

1049 
š£¹_äeq
, 
d–‘e_äeq
, 
´obe_äeq
);

1050 
_’v
->
	`£t_äeqs
Ğ
š£¹_äeq
, 
d–‘e_äeq
, 
´obe_äeq
);

1051  (
SHELL_NEXT_CONTINUE
);

1052 
	}
}

1055 
	gäeq_cmd_t
::
	$u§ge
()

1057 
	`TRACE
Ğ
TRACE_ALWAYS
, "FREQ Usage:\n\n" \

1063 
	}
}

1065 
¡ršg
 
	gäeq_cmd_t
::
	$desc
() const

1067  (
	`¡ršg
("Setshe frequency of INS/DEL/PROBES, used by some workloads"));

1068 
	}
}

1079 
	gskew_cmd_t
::
	$£lŸ£s
()

1081 
_Çme
 = 
	`¡ršg
("skew");

1082 
_®Ÿ£s
.
	`push_back
("skew");

1083 
	}
}

1085 
	gskew_cmd_t
::
	$hªdË
(cÚ¡ * 
cmd
)

1087 
cmd_g
[
SERVER_COMMAND_BUFFER_SIZE
];

1088 
sA»a
[
SERVER_COMMAND_BUFFER_SIZE
];

1089 
sLßd
[
SERVER_COMMAND_BUFFER_SIZE
];

1090 
sTime
[
SERVER_COMMAND_BUFFER_SIZE
];

1092 iàĞ
	`ssÿnf
(
cmd
, "% % % %s", 
cmd_g
, 
sA»a
, 
sLßd
, 
sTime
) < 4) {

1094 
	`u§ge
();

1095 
_’v
->
	`»£t_skew
();

1096  (
SHELL_NEXT_CONTINUE
);

1098 
	`as£¹
 (
_’v
);

1100 
¬—
 = 
	`©oi
(
sA»a
);

1101 
lßd
 = 
	`©oi
(
sLßd
);

1102 
time
 = 
	`©oi
(
sTime
);

1105 
¬—
 = (area<0) ? 0 :‡rea;

1106 
¬—
 = (area>100) ? 100 :‡rea;

1109 
lßd
 = (load<0) ? 0 :†oad;

1110 
lßd
 = (load>100) ? 100 :†oad;

1112 
	`TRACE
Ğ
TRACE_ALWAYS
, "S‘tšg†ßd imb®ªû A»a=%d%% Lßd=%d%% S¹=%d£c\n", 
¬—
, 
lßd
, 
time
);

1113 
_’v
->
	`£t_skew
(
¬—
, 
lßd
, 
time
);

1114  (
SHELL_NEXT_CONTINUE
);

1115 
	}
}

1118 
	gskew_cmd_t
::
	$u§ge
()

1120 
	`TRACE
Ğ
TRACE_ALWAYS
, "SKEW Usage:\n\n" \

1127 
	}
}

1129 
¡ršg
 
	gskew_cmd_t
::
	$desc
() const

1131  (
	`¡ršg
("Setshe†oad of‡…articular…ercentage of„ecords inhe database, used by some workloads"));

1132 
	}
}

1143 
	g¡©s_v”bo£_cmd_t
::
	$£lŸ£s
()

1145 
_Çme
 = 
	`¡ršg
("stats_verbose");

1146 
_®Ÿ£s
.
	`push_back
("stats_verbose");

1147 
	}
}

1149 
	g¡©s_v”bo£_cmd_t
::
	$hªdË
(cÚ¡ * 
cmd
)

1151 
cmd_g
[
SERVER_COMMAND_BUFFER_SIZE
];

1152 
s
[
SERVER_COMMAND_BUFFER_SIZE
];

1154 iàĞ
	`ssÿnf
(
cmd
, "% %s", 
cmd_g
, 
s
) < 2) {

1156 
	`u§ge
();

1157  (
SHELL_NEXT_CONTINUE
);

1159 
	`as£¹
 (
_’v
);

1161 #ifdeà
HAVE_CPUMON


1162 if(0 =ğ
	`¡rÿ£cmp
("Ú", 
s
)) {

1163 
_g_mÚ
->
	`£t_´št_v”bo£
(
Œue
);

1164 
	`TRACE
Ğ
TRACE_ALWAYS
, "Verbose statistics will be…rintedƒvery second during‡ measurement!\n" );

1165 } if(0 =ğ
	`¡rÿ£cmp
("off", 
s
)) {

1166 
_g_mÚ
->
	`£t_´št_v”bo£
(
çl£
);

1167 
	`TRACE
Ğ
TRACE_ALWAYS
, "Verbose statistics off!\n" );

1169 
	`u§ge
();

1172 
	`TRACE
 (
TRACE_ALWAYS
, "CPU Monitoring‚ot configured, verbose stats‚ot‡vailable\n");

1175  (
SHELL_NEXT_CONTINUE
);

1176 
	}
}

1179 
	g¡©s_v”bo£_cmd_t
::
	$u§ge
()

1181 
	`TRACE
Ğ
TRACE_ALWAYS
, "STATS_VERBOSE Usage:\n\n" \

1186 
	}
}

1188 
¡ršg
 
	g¡©s_v”bo£_cmd_t
::
	$desc
() const

1190  (
	`¡ršg
("To start-stop…rinting more statistics during‡ measurement."));

1191 
	}
}

1202 
	gdb_´št_cmd_t
::
	$£lŸ£s
()

1204 
_Çme
 = 
	`¡ršg
("db_print");

1205 
_®Ÿ£s
.
	`push_back
("db_print");

1206 
	}
}

1208 
	gdb_´št_cmd_t
::
	$hªdË
(cÚ¡ * 
cmd
)

1210 
cmd_g
[
SERVER_COMMAND_BUFFER_SIZE
];

1211 
lšes_c
[
SERVER_COMMAND_BUFFER_SIZE
];

1213 iàĞ
	`ssÿnf
(
cmd
, "% %s", 
cmd_g
, 
lšes_c
) < 1) {

1215 
	`u§ge
();

1216  (
SHELL_NEXT_CONTINUE
);

1218 
	`as£¹
 (
_’v
);

1220 
lšes_i
 = 
	`©oi
(
lšes_c
);

1221 
_’v
->
	`db_´št_š™
(
lšes_i
);

1223  (
SHELL_NEXT_CONTINUE
);

1224 
	}
}

1227 
	gdb_´št_cmd_t
::
	$u§ge
()

1229 
	`TRACE
Ğ
TRACE_ALWAYS
, "DB_PRINT Usage:\n\n" \

1233 
	}
}

1235 
¡ršg
 
	gdb_´št_cmd_t
::
	$desc
() const

1237  (
	`¡ršg
("To…rinthe contents ofhe current dbables into files."));

1238 
	}
}

1249 
	gdb_ãtch_cmd_t
::
	$£lŸ£s
()

1251 
_Çme
 = 
	`¡ršg
("db_fetch");

1252 
_®Ÿ£s
.
	`push_back
("db_fetch");

1253 
	}
}

1255 
	gdb_ãtch_cmd_t
::
	$hªdË
(cÚ¡ * 
cmd
)

1257 
	`as£¹
 (
_’v
);

1258 
_’v
->
	`db_ãtch_š™
();

1259  (
SHELL_NEXT_CONTINUE
);

1260 
	}
}

1263 
	gdb_ãtch_cmd_t
::
	$u§ge
()

1265 
	`TRACE
Ğ
TRACE_ALWAYS
, "DB_FETCH Usage:\n\n*** db_fetch\n\n");

1266 
	}
}

1268 
¡ršg
 
	gdb_ãtch_cmd_t
::
	$desc
() const

1270  (
	`¡ršg
("To fetchhe…ages ofhe current dbables‡ndheir indexes intohe buffer…ool."));

1271 
	}
}

1280 
	glog_cmd_t
::
	$£lŸ£s
()

1282 
_Çme
 = 
	`¡ršg
("log");

1283 
_®Ÿ£s
.
	`push_back
("log");

1284 
_®Ÿ£s
.
	`push_back
("l");

1285 
	}
}

1287 
	glog_cmd_t
::
	$hªdË
(cÚ¡ * 
cmd
)

1289 
cmd_g
[
SERVER_COMMAND_BUFFER_SIZE
];

1290 
Ëv–_g
[
SERVER_COMMAND_BUFFER_SIZE
];

1292 iàĞ
	`ssÿnf
(
cmd
, "% %s", 
cmd_g
, 
Ëv–_g
) < 2) {

1293 
	`u§ge
();

1296 if(
	`¡rÿ£cmp
("g‘", 
Ëv–_g
)) {

1297 
rc_t
 
”r
 = 
_’v
->
	`db
()->
	`£t_log_ã©u»s
(
Ëv–_g
);

1298 if(
”r
.
	`is_”rÜ
()) {

1299 
	`TRACE
Ğ
TRACE_ALWAYS
, "*** Inv®id f—tu» s‘: % ***", 
Ëv–_g
);

1302 cÚ¡* 
Ëv–
 = 
_’v
->
	`db
()->
	`g‘_log_ã©u»s
();

1303 
	`TRACE
Ğ
TRACE_ALWAYS
, "EÇbËd†og f—tu»s: %s\n", 
Ëv–
);

1304 
d–‘e
[] 
Ëv–
;

1307  (
SHELL_NEXT_CONTINUE
);

1308 
	}
}

1310 
	glog_cmd_t
::
	$u§ge
()

1312 
	`TRACE
Ğ
TRACE_ALWAYS
, "LOG Usage:\n\n"

1326 
	}
}

1328 
¡ršg
 
	glog_cmd_t
::
	$desc
() const

1330  (
	`¡ršg
("Setshe†ogging mechanism"));

1331 
	}
}

1340 
	gasynch_cmd_t
::
	$asynch_cmd_t
(
ShÜeEnv
* 
’v
)

1341 : 
	`_’v
(
’v
), 
	$_’abËd
(
çl£
)

1342 { 
	}
}

1344 
	gasynch_cmd_t
::
	$£lŸ£s
()

1346 
_Çme
 = 
	`¡ršg
("asynch");

1347 
_®Ÿ£s
.
	`push_back
("asynch");

1348 
	}
}

1350 
	gasynch_cmd_t
::
	$hªdË
(const * )

1352 
_’abËd
 = !_enabled;

1353 
_’v
->
	`£tAsynchComm™
(
_’abËd
);

1354 
	`TRACE
Ğ
TRACE_ALWAYS
, "AsynchComm™=%d\n", 
_’abËd
);

1355  (
SHELL_NEXT_CONTINUE
);

1356 
	}
}

1358 
	gasynch_cmd_t
::
	$u§ge
()

1360 
	`TRACE
Ğ
TRACE_ALWAYS
, "Asynch Usage:\n\n" \

1362 
	}
}

1365 
¡ršg
 
	gasynch_cmd_t
::
	$desc
() const

1367  (
	`¡ršg
("Setshe fake†og disk delay"));

1368 
	}
}

1378 
	g¦i_cmd_t
::
	$¦i_cmd_t
(
ShÜeEnv
* 
’v
)

1379 : 
	`_’v
(
’v
), 
	$_’abËd
(
çl£
)

1380 { 
	}
}

1382 
	g¦i_cmd_t
::
	$£lŸ£s
()

1384 
_Çme
 = 
	`¡ršg
("sli");

1385 
_®Ÿ£s
.
	`push_back
("sli");

1386 
	}
}

1388 
	g¦i_cmd_t
::
	$hªdË
(const * )

1390 
_’abËd
 = !_enabled;

1391 
_’v
->
	`db
()->
	`£t_¦i_’abËd
(
_’abËd
);

1392 
_’v
->
	`£tSLIEÇbËd
(
_’abËd
);

1393 
	`TRACE
Ğ
TRACE_ALWAYS
, "SLI=%d\n", 
_’abËd
);

1394  (
SHELL_NEXT_CONTINUE
);

1395 
	}
}

1397 
	g¦i_cmd_t
::
	$u§ge
()

1399 
	`TRACE
Ğ
TRACE_ALWAYS
, "SLI Usage:\n\n" \

1401 
	}
}

1403 
¡ršg
 
	g¦i_cmd_t
::
	$desc
() const

1405  (
	`¡ršg
("Enables/disables SLI"));

1406 
	}
}

1417 
	g–r_cmd_t
::
	$–r_cmd_t
(
ShÜeEnv
* 
’v
)

1418 : 
	`_’v
(
’v
), 
	$_’abËd
(
çl£
)

1419 { 
	}
}

1421 
	g–r_cmd_t
::
	$£lŸ£s
()

1423 
_Çme
 = 
	`¡ršg
("elr");

1424 
_®Ÿ£s
.
	`push_back
("elr");

1425 
	}
}

1427 
	g–r_cmd_t
::
	$hªdË
(const * )

1429 
_’abËd
 = !_enabled;

1430 
_’v
->
	`db
()->
	`£t_–r_’abËd
(
_’abËd
);

1431 
_’v
->
	`£tELREÇbËd
(
_’abËd
);

1432 
	`TRACE
Ğ
TRACE_ALWAYS
, "ELR=%d\n", 
_’abËd
);

1433  (
SHELL_NEXT_CONTINUE
);

1434 
	}
}

1436 
	g–r_cmd_t
::
	$u§ge
()

1438 
	`TRACE
Ğ
TRACE_ALWAYS
, "ELR Usage:\n\n" \

1440 
	}
}

1442 
¡ršg
 
	g–r_cmd_t
::
	$desc
() const

1444  (
	`¡ršg
("Enables/disables ELR"));

1445 
	}
}

1450 #ifdeà
CFG_BT


1457 
	gbt_cmd_t
::
	$bt_cmd_t
(
ShÜeEnv
* 
’v
)

1458 : 
	`_’v
(
’v
), 
	$_’abËd
(
çl£
)

1459 { 
	}
}

1461 
	gbt_cmd_t
::
	$£lŸ£s
()

1463 
_Çme
 = 
	`¡ršg
("bt");

1464 
_®Ÿ£s
.
	`push_back
("bt");

1465 
	}
}

1467 
	gbt_cmd_t
::
	$hªdË
(cÚ¡ * 
cmd
)

1469 
	#CMDLEN
 10

	)

1470 
ušt
 
¶ev–
=0;

1471 
couÁ
 = 
	`ssÿnf
(
cmd
, "%* %ud", &
¶ev–
);

1472 
couÁ
) {

1474 
	`u§ge
();

1477 
ss_m
::
	`£t_¶p_Œacšg
(
¶ev–
);

1478 
	`TRACE
Ğ
TRACE_ALWAYS
, "PLEVEL=%d\n", 
¶ev–
);

1481 
	`TRACE
(
TRACE_ALWAYS
, "Inv®id‡rgum’t: %s\n", 
cmd
);

1484  (
SHELL_NEXT_CONTINUE
);

1485 
	}
}

1487 
	gbt_cmd_t
::
	$u§ge
()

1489 
	`TRACE
Ğ
TRACE_ALWAYS
, "BT Usage:\n\n" \

1491 
	}
}

1493 
¡ršg
 
	gbt_cmd_t
::
	$desc
() const

1495  (
	`¡ršg
("Enables/disables PLPracing‡t shore-sm-6"));

1496 
	}
}

1509 
	gm—su»_cmd_t
::
	$£lŸ£s
()

1511 
_Çme
 = 
	`¡ršg
("measure");

1512 
_®Ÿ£s
.
	`push_back
("measure");

1513 
_®Ÿ£s
.
	`push_back
("m");

1514 
	}
}

1516 
	gm—su»_cmd_t
::
	$hªdË
(cÚ¡ * 
cmd
)

1518 
_k™
->
	`´e_´oûss_cmd
();

1519  (
_k™
->
	`´oûss_cmd_MEASURE
(
cmd
));

1520 
	}
}

1522 
	gm—su»_cmd_t
::
	$u§ge
()

1524 
	`TRACE
Ğ
TRACE_ALWAYS
, "MEASURE Usage:\n\n" \

1534 
	}
}

1536 
¡ršg
 
	gm—su»_cmd_t
::
	$desc
() const

1538  
	`¡ršg
("Duration-based Measurement (powerrun)");

1539 
	}
}

1550 
	g‹¡_cmd_t
::
	$£lŸ£s
()

1552 
_Çme
 = 
	`¡ršg
("test");

1553 
_®Ÿ£s
.
	`push_back
("test");

1554 
	}
}

1556 
	g‹¡_cmd_t
::
	$hªdË
(cÚ¡ * 
cmd
)

1558 
_k™
->
	`´e_´oûss_cmd
();

1559  (
_k™
->
	`´oûss_cmd_TEST
(
cmd
));

1560 
	}
}

1562 
	g‹¡_cmd_t
::
	$u§ge
()

1564 
	`TRACE
Ğ
TRACE_ALWAYS
, "TEST Usage:\n\n" \

1574 
	}
}

1576 
¡ršg
 
	g‹¡_cmd_t
::
	$desc
() const

1578  
	`¡ršg
("NumOfXcts-based Measument (powerrun)");

1579 
	}
}

1590 
	gw¬mup_cmd_t
::
	$£lŸ£s
()

1592 
_Çme
 = 
	`¡ršg
("warmup");

1593 
_®Ÿ£s
.
	`push_back
("warmup");

1594 
	}
}

1596 
	gw¬mup_cmd_t
::
	$hªdË
(cÚ¡ * 
cmd
)

1598 
_k™
->
	`´e_´oûss_cmd
();

1599  (
_k™
->
	`´oûss_cmd_WARMUP
(
cmd
));

1600 
	}
}

1602 
	gw¬mup_cmd_t
::
	$u§ge
()

1604 
	`TRACE
Ğ
TRACE_ALWAYS
, "WARMUP Usage:\n\n" \

1611 
	}
}

1613 
¡ršg
 
	gw¬mup_cmd_t
::
	$desc
() const

1615  
	`¡ršg
("Does‡…reselected warmup„un");

1616 
	}
}

1627 
	glßd_cmd_t
::
	$£lŸ£s
()

1629 
_Çme
 = 
	`¡ršg
("load");

1630 
_®Ÿ£s
.
	`push_back
("load");

1631 
	}
}

1633 
	glßd_cmd_t
::
	$hªdË
(cÚ¡ * 
cmd
)

1635 
_k™
->
	`´e_´oûss_cmd
();

1636  (
_k™
->
	`´oûss_cmd_LOAD
(
cmd
));

1637 
	}
}

1639 
	glßd_cmd_t
::
	$u§ge
()

1641 
	`TRACE
Ğ
TRACE_ALWAYS
, "LOAD Usage:\n\n" \

1643 
	}
}

1645 
¡ršg
 
	glßd_cmd_t
::
	$desc
() const

1647  
	`¡ršg
("Loads‡ database forhe benchmark");

1648 
	}
}

1659 
	gŒxs_cmd_t
::
	$£lŸ£s
()

1661 
_Çme
 = 
	`¡ršg
("trxs");

1662 
_®Ÿ£s
.
	`push_back
("trxs");

1663 
	}
}

1665 
	gŒxs_cmd_t
::
	$hªdË
(const * )

1667 
_k™
->
	`´št_sup_Œxs
();

1668  (
SHELL_NEXT_CONTINUE
);

1669 
	}
}

1671 
	gŒxs_cmd_t
::
	$u§ge
()

1673 
	`TRACE
Ğ
TRACE_ALWAYS
, "usage:rxs\n");

1674 
	}
}

1676 
¡ršg
 
	gŒxs_cmd_t
::
	$desc
() const

1678  
	`¡ršg
("Listshe‡vailableransactions inhe benchmark");

1679 
	}
}

1683 
EXIT_NAMESPACE
(
shÜe
);

	@src/sm/shore/shore_table.cpp

32 
	~"sm/shÜe/shÜe_bË.h
"

34 
usšg
 
Çme¥aû
 
	gshÜe
;

44 
	#VAR_SLOT
(
¡¬t
, 
off£t
è((¡¬t)+(off£t))

	)

45 
	#SET_NULL_FLAG
(
¡¬t
, 
off£t
) \

46 (*(*)((
¡¬t
)+((
off£t
)>>3))è&ğ(1<<((off£t)>>3))

	)

47 
	#IS_NULL_FLAG
(
¡¬t
, 
off£t
) \

48 (*(*)((
¡¬t
)+((
off£t
)>>3)))&(1<<((off£t)>>3))

	)

60 
	gbË_desc_t
::
	$bË_desc_t
(cÚ¡ * 
Çme
, 
f›ldút
, 
ušt4_t
 
pd
)

61 : 
	`fe_desc_t
(
Çme
, 
f›ldút
, 
pd
), 
	`_db
(
NULL
),

62 
	`_šdexes
(
NULL
), 
	`_´im¬y_idx
(NULL),

63 
	`_maxsize
(0),

64 
	`_sMšKey
(
NULL
),
	`_sMšKeyL’
(0),

65 
	`_sMaxKey
(
NULL
),
	$_sMaxKeyL’
(0)

68 
_desc
 = 
Ãw
 
f›ld_desc_t
[
f›ldút
];

69 
	}
}

72 
	gbË_desc_t
::~
	$bË_desc_t
()

74 ià(
_desc
) {

75 
d–‘e
 [] 
_desc
;

76 
_desc
 = 
NULL
;

79 ià(
_šdexes
) {

80 
d–‘e
 
_šdexes
;

81 
_šdexes
 = 
NULL
;

84 ià(
_sMšKey
!=
NULL
) {

85 
	`ä“
(
_sMšKey
);

86 
_sMšKey
=
NULL
;

89 ià(
_sMaxKey
!=
NULL
) {

90 
	`ä“
(
_sMaxKey
);

91 
_sMaxKey
=
NULL
;

93 
	}
}

110 
w_rc_t
 
	gbË_desc_t
::
	$ü—‹_physiÿl_bË
(
ss_m
* 
db
)

112 
	`as£¹
 (
db
);

113 
_db
 = 
db
;

115 ià(!
	`is_vid_v®id
(è|| !
	`is_roÙ_v®id
()) {

116 
	`W_DO
(
	`fšd_roÙ_iid
(
db
));

121 
šdex_desc_t
* 
šdex
 = 
_šdexes
;

123 ià(
šdex
 && (šdex->
	`g‘_pd
(è& (
PD_MRBT_PART
 | 
PD_MRBT_LEAF
))) {

125 
	`W_DO
(
db
->
	`ü—‹_mrbt_fe
(
	`vid
(), 
_fid
, 
smËv–_3
::
t_»guÏr
));

127 
	`W_DO
(
db
->
	`ü—‹_fe
(
	`vid
(), 
_fid
, 
smËv–_3
::
t_»guÏr
));

129 
	`TRACE
Ğ
TRACE_STATISTICS
, "% %d\n", 
	`Çme
(), 
	`fid
().
¡Üe
);

132 
fe_šfo_t
 
fe
;

133 
fe
.
	`£t_áy³
(
FT_HEAP
);

134 
fe
.
	`£t_fid
(
_fid
);

135 
	`W_DO
(
ss_m
::
	`ü—‹_assoc
(
	`roÙ_iid
(),

136 
	`vec_t
(
	`Çme
(), 
	`¡¾’
(name())),

137 
	`vec_t
(&
fe
, (
fe_šfo_t
))));

141 
šdex
) {

144 
	`W_DO
(
	`ü—‹_physiÿl_šdex
(
db
,
šdex
));

147 
šdex
 = index->
	`Ãxt
();

150  (
RCOK
);

151 
	}
}

163 
w_rc_t
 
	gbË_desc_t
::
	$ü—‹_physiÿl_šdex
(
ss_m
* 
db
, 
šdex_desc_t
* 
šdex
)

166 
fe_šfo_t
 
fe
;

169 
¡id_t
 
iid
 = stid_t::
nuÎ
;

170 
ss_m
::
ndx_t
 
smidx_ty³
 = ss_m::
t_uni_bŒ“
;

171 
ss_m
::
cÚcu¼’cy_t
 
smidx_cc
 = ss_m::
t_cc_im
;

176 ià(
šdex
->
	`is_mr
()) {

177 
ušt4_t
 
pd
 = 
šdex
->
	`g‘_pd
();

178 ià(
šdex
->
	`is_´im¬y
()) {

183 ià(
pd
 & 
PD_MRBT_NORMAL
) {

185 
smidx_ty³
 = 
šdex
->
	`is_unique
(è? 
ss_m
::
t_uni_mrbŒ“
 : ss_m::
t_mrbŒ“
;

188 ià(
pd
 & 
PD_MRBT_PART
) {

190 
smidx_ty³
 = 
šdex
->
	`is_unique
(è? 
ss_m
::
t_uni_mrbŒ“_p
 : ss_m::
t_mrbŒ“_p
;

193 
	`as£¹
 (
pd
 & 
PD_MRBT_LEAF
);

195 
smidx_ty³
 = 
šdex
->
	`is_unique
(è? 
ss_m
::
t_uni_mrbŒ“_l
 : ss_m::
t_mrbŒ“_l
;

201 
smidx_ty³
 = 
šdex
->
	`is_unique
(è? 
ss_m
::
t_uni_mrbŒ“
 : ss_m::
t_mrbŒ“
;

206 
smidx_ty³
 = 
šdex
->
	`is_unique
(è? 
ss_m
::
t_uni_bŒ“
 : ss_m::
t_bŒ“
;

211 
smidx_cc
 = 
šdex
->
	`is_»Ïxed
(è? 
ss_m
::
t_cc_nÚe
 : ss_m::
t_cc_im
;

215 ià(
šdex
->
	`is_´im¬y
()) {

216 
fe
.
	`£t_áy³
(
FT_PRIMARY_IDX
);

219 
fe
.
	`£t_áy³
(
FT_IDX
);

222 ià(
šdex
->
	`is_rm­hŞd”
()) {

223 
fe
.
	`£t_áy³
(
FT_NONE
);

228 if(
šdex
->
	`is_·¹™iÚed
()) {

229 
i
=0; i < 
šdex
->
	`g‘_·¹™iÚ_couÁ
(); i++) {

230 ià(!
šdex
->
	`is_mr
()) {

231 
	`W_DO
(
db
->
	`ü—‹_šdex
(
_vid
, 
smidx_ty³
, 
ss_m
::
t_»guÏr
,

232 
	`šdex_keydesc
(
šdex
), 
smidx_cc
, 
iid
));

235 
	`W_DO
(
db
->
	`ü—‹_mr_šdex
(
_vid
, 
smidx_ty³
, 
ss_m
::
t_»guÏr
,

236 
	`šdex_keydesc
(
šdex
), 
smidx_cc
, 
iid
,

237 
šdex
->
	`is_ÏtchËss
()));

240 
vec_t
 
	`mšv
(
_sMšKey
,
_sMšKeyL’
);

241 
vec_t
 
	`maxv
(
_sMaxKey
,
_sMaxKeyL’
);

242 
	`W_DO
(
db
->
	`make_equ®_·¹™iÚs
(
iid
,
mšv
,
maxv
,
_numP¬ts
));

244 
šdex
->
	`£t_fid
(
i
, 
iid
);

247 
fe
.
	`£t_fid
(
iid
);

248 
tmp
[100];

249 
	`¥rštf
(
tmp
, "%s_%d", 
šdex
->
	`Çme
(), 
i
);

250 
	`W_DO
(
db
->
	`ü—‹_assoc
(
	`roÙ_iid
(),

251 
	`vec_t
(
tmp
, 
	`¡¾’
(tmp)),

252 
	`vec_t
(&
fe
, (
fe_šfo_t
))));

257 ià(!
šdex
->
	`is_mr
()) {

258 
	`W_DO
(
db
->
	`ü—‹_šdex
(
_vid
, 
smidx_ty³
, 
ss_m
::
t_»guÏr
,

259 
	`šdex_keydesc
(
šdex
), 
smidx_cc
, 
iid
));

262 
	`W_DO
(
db
->
	`ü—‹_mr_šdex
(
_vid
, 
smidx_ty³
, 
ss_m
::
t_»guÏr
,

263 
	`šdex_keydesc
(
šdex
), 
smidx_cc
, 
iid
,

264 
šdex
->
	`is_ÏtchËss
()));

267 
vec_t
 
	`mšv
(
_sMšKey
,
_sMšKeyL’
);

268 
vec_t
 
	`maxv
(
_sMaxKey
,
_sMaxKeyL’
);

269 
	`W_DO
(
db
->
	`make_equ®_·¹™iÚs
(
iid
,
mšv
,
maxv
,
_numP¬ts
));

271 
šdex
->
	`£t_fid
(0, 
iid
);

274 
fe
.
	`£t_fid
(
iid
);

275 
	`W_DO
(
db
->
	`ü—‹_assoc
(
	`roÙ_iid
(),

276 
	`vec_t
(
šdex
->
	`Çme
(), 
	`¡¾’
(index->name())),

277 
	`vec_t
(&
fe
, (
fe_šfo_t
))));

281 
	`TRACE
Ğ
TRACE_STATISTICS
, "%s %d (%s) (%s) (%s) (%s) (%s)\n",

282 
šdex
->
	`Çme
(), 
iid
.
¡Üe
,

283 (
šdex
->
	`is_mr
() ? "mrbt" : "normal"),

284 (
šdex
->
	`is_ÏtchËss
() ? "no†atch" : "latch"),

285 (
šdex
->
	`is_»Ïxed
() ? "relaxed" : "no„elaxed"),

286 (
šdex
->
	`is_·¹™iÚed
() ? "part" : "no…art"),

287 (
šdex
->
	`is_unique
() ? "unique" : "no unique"));

289  (
RCOK
);

290 
	}
}

307 
w_rc_t
 
	gbË_desc_t
::
	$ü—‹_physiÿl_em±y_´im¬y_idx
()

310 
	`as£¹
 (
_db
);

312 
¡ršg
 
idxÇme
 = 
	`¡ršg
(
this
->
	`Çme
()) + string("MRHolder");

313 
ušt
 
key
[1]={0};

314 
šdex_desc_t
* 
p_šdex
 = 
Ãw
 
	`šdex_desc_t
(
idxÇme
.
	`c_¡r
(),1,0,
key
,

315 
çl£
,çl£,
PD_MRBT_NORMAL
,

316 
Œue
);

317 
	`as£¹
(
p_šdex
);

320 
_´im¬y_idx
 = 
p_šdex
;

322 
	`W_DO
(
	`ü—‹_physiÿl_šdex
(
_db
,
p_šdex
));

324  (
RCOK
);

325 
	}
}

340 #w¬nšg 
CªnÙ
 
upd©e
 
f›lds
 
šşuded
 
©
 
šdexes
 - 
d–‘e
 
ªd
 
š£¹
 
agaš


342 #w¬nšg 
OÆy
 
the
 
Ï¡
 
f›ld
 
of
 
ª
 
šdex
 
ÿn
 
be
 oà
v¬ŸbË
 
Ëngth


344 
boŞ
 
	gbË_desc_t
::
	$ü—‹_šdex_desc
(cÚ¡ * 
Çme
,

345 
·¹™iÚs
,

346 cÚ¡ 
ušt
* 
f›lds
,

347 cÚ¡ 
ušt
 
num
,

348 cÚ¡ 
boŞ
 
unique
,

349 cÚ¡ 
boŞ
 
´im¬y
,

350 cÚ¡ 
ušt4_t
& 
pd
)

352 
šdex_desc_t
* 
p_šdex
 = 
Ãw
 
	`šdex_desc_t
(
Çme
, 
num
, 
·¹™iÚs
, 
f›lds
,

353 
unique
, 
´im¬y
, 
pd
);

356 
ušt_t
 
i
=0; i<
num
; i++) {

357 
	`as£¹
(
f›lds
[
i
] < 
_f›ld_couÁ
);

360 #w¬nšg 
IP
: 
I
 
am
 
nÙ
 
su»
 
¡l
 
Úly
 
the
 
Ï¡
 
f›ld
 
š
h
šdex
 
ÿn
 
be
 
v¬ŸbË
 
Ëngthed


362 ià(
_desc
[
f›lds
[
i
]].
	`is_v¬ŸbË_Ëngth
(è&& i !ğ
num
-1) {

363 
	`as£¹
(
çl£
);

368 ià(
_šdexes
 =ğ
NULL
è_šdexe ğ
p_šdex
;

369 
_šdexes
->
	`š£¹
(
p_šdex
);

372 ià(
p_šdex
->
	`is_unique
(è&&…_šdex->
	`is_´im¬y
())

373 
_´im¬y_idx
 = 
p_šdex
;

375  
Œue
;

376 
	}
}

379 
boŞ
 
	gbË_desc_t
::
	$ü—‹_´im¬y_idx_desc
(cÚ¡ * 
Çme
,

380 
·¹™iÚs
,

381 cÚ¡ 
ušt
* 
f›lds
,

382 cÚ¡ 
ušt
 
num
,

383 cÚ¡ 
ušt4_t
& 
pd
)

385 
šdex_desc_t
* 
p_šdex
 = 
Ãw
 
	`šdex_desc_t
(
Çme
, 
num
, 
·¹™iÚs
, 
f›lds
,

386 
Œue
,rue, 
pd
);

389 
ušt_t
 
i
=0; i<
num
; i++) {

390 
	`as£¹
(
f›lds
[
i
] < 
_f›ld_couÁ
);

393 ià(
_desc
[
f›lds
[
i
]].
	`is_v¬ŸbË_Ëngth
(è&& i !ğ
num
-1) {

394 
	`as£¹
(
çl£
);

399 ià(
_šdexes
 =ğ
NULL
è_šdexe ğ
p_šdex
;

400 
_šdexes
->
	`š£¹
(
p_šdex
);

403 
_´im¬y_idx
 = 
p_šdex
;

405  (
Œue
);

406 
	}
}

411 
¡id_t
 
	gbË_desc_t
::
	$g‘_´im¬y_¡id
()

413 
¡id_t
 
¡id
 = ( 
_´im¬y_idx
 ? _´im¬y_idx->
	`fid
(0) : fid() );

414  (
¡id
);

415 
	}
}

424 
w_rc_t
 
	gbË_desc_t
::
	$£t_·¹™iÚšg
(cÚ¡ * 
sMšKey
,

425 
ušt
 
Ën1
,

426 cÚ¡ * 
sMaxKey
,

427 
ušt
 
Ën2
,

428 
ušt
 
numP¬ts
)

431 ià(
_sMšKeyL’
 < 
Ën1
) {

432 ià(
_sMšKey
è{ 
	`ä“
 (_sMinKey); }

433 
_sMšKey
 = (*)
	`m®loc
(
Ën1
+1);

435 
	`mem£t
(
_sMšKey
,0,
Ën1
+1);

436 
	`memıy
(
_sMšKey
,
sMšKey
,
Ën1
);

437 
_sMšKeyL’
 = 
Ën1
;

439 ià(
_sMaxKeyL’
 < 
Ën2
) {

440 ià(
_sMaxKey
è{ 
	`ä“
 (_sMaxKey); }

441 
_sMaxKey
 = (*)
	`m®loc
(
Ën2
+1);

443 
	`mem£t
(
_sMaxKey
,0,
Ën2
+1);

444 
	`memıy
(
_sMaxKey
,
sMaxKey
,
Ën2
);

445 
_sMaxKeyL’
 = 
Ën2
;

447 
_numP¬ts
 = 
numP¬ts
;

448  (
RCOK
);

449 
	}
}

453 
ušt
 
	gbË_desc_t
::
	$pút
() const

455  (
_numP¬ts
);

456 
	}
}

458 * 
	gbË_desc_t
::
	$g‘MšKey
() const

460  (
_sMšKey
);

461 
	}
}

463 
ušt
 
	gbË_desc_t
::
	$g‘MšKeyL’
() const

465  (
_sMšKeyL’
);

466 
	}
}

468 * 
	gbË_desc_t
::
	$g‘MaxKey
() const

470  (
_sMaxKey
);

471 
	}
}

473 
ušt
 
	gbË_desc_t
::
	$g‘MaxKeyL’
() const

475  (
_sMaxKeyL’
);

476 
	}
}

490 
w_rc_t
 
	gbË_desc_t
::
	$g‘_maš_¿ngem­
(
key_¿nges_m­
*& 
¿ngem­
)

492 ià(!
_´im¬y_idx
 || _´im¬y_idx->
	`is_·¹™iÚed
()) {

494 
	`ü—‹_physiÿl_em±y_´im¬y_idx
();

496 
	`as£¹
 (
_´im¬y_idx
);

500 
	`as£¹
 (!
_´im¬y_idx
->
	`is_·¹™iÚed
());

502 
	`W_DO
(
ss_m
::
	`g‘_¿nge_m­
(
_´im¬y_idx
->
	`fid
(0),
¿ngem­
));

503  (
RCOK
);

504 
	}
}

514 
	gbË_desc_t
::
	$´št_desc
(
o¡»am
& 
os
)

516 
os
 << "Schem¨fÜabË " << 
_Çme
 << 
’dl
;

517 
os
 << "Num” oàf›lds: " << 
_f›ld_couÁ
 << 
’dl
;

518 
ušt_t
 
i
=0; i<
_f›ld_couÁ
; i++) {

519 
_desc
[
i
].
	`´št_desc
(
os
);

521 
	}
}

556 
	gbË_mª_t
::
	$fÜm©
(
bË_tu¶e
* 
±u¶e
,

557 
»p_row_t
 &
¬•
)

565 
off£t_t
 
fixed_off£t
 = 
±u¶e
->
	`g‘_fixed_off£t
();

568 
off£t_t
 
v¬_¦Ù_off£t
 = 
±u¶e
->
	`g‘_v¬_¦Ù_off£t
();

571 
off£t_t
 
v¬_off£t
 = 
±u¶e
->
	`g‘_v¬_off£t
();

578 
tupsize
 = 0;

580 
nuÎ_couÁ
 = 
±u¶e
->
	`g‘_nuÎ_couÁ
();

581 
fixed_size
 = 
±u¶e
->
	`g‘_v¬_¦Ù_off£t
(è-…tu¶e->
	`g‘_fixed_off£t
();

584 
ušt_t
 
i
=0; i<
_±abË
->
	`f›ld_couÁ
(); i++) {

586 ià(
±u¶e
->
_pv®ues
[
i
].
	`is_v¬ŸbË_Ëngth
()) {

591 ià(
±u¶e
->
_pv®ues
[
i
].
	`is_nuÎ
()) ;

592 
tupsize
 +ğ
±u¶e
->
_pv®ues
[
i
].
	`»®size
();

593 
tupsize
 +ğ(
off£t_t
);

604 
tupsize
 +ğ
fixed_size
;

608 ià(
nuÎ_couÁ
è
tupsize
 += (null_count >> 3) + 1;

609 
	`as£¹
 (
tupsize
);

614 
¬•
.
	`£t
(
tupsize
);

620 
nuÎ_šdex
 = -1;

622 
ušt_t
 
i
=0; i<
_±abË
->
	`f›ld_couÁ
(); i++) {

627 ià(
±u¶e
->
_pv®ues
[
i
].
	`f›ld_desc
()->
	`®low_nuÎ
()) {

628 
nuÎ_šdex
++;

629 ià(
±u¶e
->
_pv®ues
[
i
].
	`is_nuÎ
()) {

630 
	`SET_NULL_FLAG
(
¬•
.
_de¡
, 
nuÎ_šdex
);

638 ià(
±u¶e
->
_pv®ues
[
i
].
	`is_v¬ŸbË_Ëngth
()) {

639 
±u¶e
->
_pv®ues
[
i
].
	`cİy_v®ue
(
¬•
.
_de¡
 + 
v¬_off£t
);

640 
off£t
 = 
±u¶e
->
_pv®ues
[
i
].
	`»®size
();

641 
v¬_off£t
 +ğ
off£t
;

644 
off£t_t
 
Ën
 = 
off£t
;

645 
	`memıy
(
	`VAR_SLOT
(
¬•
.
_de¡
, 
v¬_¦Ù_off£t
), &
Ën
, (
off£t_t
));

646 
v¬_¦Ù_off£t
 +ğ(
off£t_t
);

653 
±u¶e
->
_pv®ues
[
i
].
	`cİy_v®ue
(
¬•
.
_de¡
 + 
fixed_off£t
);

654 
fixed_off£t
 +ğ
±u¶e
->
_pv®ues
[
i
].
	`maxsize
();

657  (
tupsize
);

658 
	}
}

676 
boŞ
 
	gbË_mª_t
::
	$lßd
(
bË_tu¶e
* 
±u¶e
,

677 cÚ¡ * 
d©a
)

680 
	`as£¹
 (
±u¶e
);

681 
	`as£¹
 (
d©a
);

686 
off£t_t
 
fixed_off£t
 = 
±u¶e
->
	`g‘_fixed_off£t
();

689 
off£t_t
 
v¬_¦Ù_off£t
 = 
±u¶e
->
	`g‘_v¬_¦Ù_off£t
();

692 
off£t_t
 
v¬_off£t
 = 
±u¶e
->
	`g‘_v¬_off£t
();

697 
nuÎ_šdex
 = -1;

698 
ušt_t
 
i
=0; i<
_±abË
->
	`f›ld_couÁ
(); i++) {

705 ià(
±u¶e
->
_pv®ues
[
i
].
	`f›ld_desc
()->
	`®low_nuÎ
()) {

706 
nuÎ_šdex
++;

707 ià(
	`IS_NULL_FLAG
(
d©a
, 
nuÎ_šdex
)) {

708 
±u¶e
->
_pv®ues
[
i
].
	`£t_nuÎ
();

719 ià(
±u¶e
->
_pv®ues
[
i
].
	`is_v¬ŸbË_Ëngth
()) {

720 
off£t_t
 
v¬_Ën
;

721 
	`memıy
(&
v¬_Ën
, 
	`VAR_SLOT
(
d©a
, 
v¬_¦Ù_off£t
), (
off£t_t
));

722 
±u¶e
->
_pv®ues
[
i
].
	`£t_v®ue
(
d©a
+
v¬_off£t
, 
v¬_Ën
);

723 
v¬_off£t
 +ğ
v¬_Ën
;

724 
v¬_¦Ù_off£t
 +ğ(
off£t_t
);

730 
±u¶e
->
_pv®ues
[
i
].
	`£t_v®ue
(
d©a
+
fixed_off£t
,

731 
±u¶e
->
_pv®ues
[
i
].
	`maxsize
());

732 
fixed_off£t
 +ğ
±u¶e
->
_pv®ues
[
i
].
	`maxsize
();

735  (
Œue
);

736 
	}
}

758 
	gbË_mª_t
::
	$fÜm©_key
(
šdex_desc_t
* 
pšdex
,

759 
bË_tu¶e
* 
±u¶e
,

760 
»p_row_t
 &
¬•
)

762 
	`as£¹
 (
_±abË
);

763 
	`as£¹
 (
pšdex
);

764 
	`as£¹
 (
±u¶e
);

767 
isz
 = 
	`key_size
(
pšdex
, 
±u¶e
);

768 
	`as£¹
 (
isz
);

771 
¬•
.
	`£t
(
isz
);

774 
off£t_t
 
off£t
 = 0;

775 
ušt_t
 
i
=0; i<
pšdex
->
	`f›ld_couÁ
(); i++) {

776 
ix
 = 
pšdex
->
	`key_šdex
(
i
);

777 
f›ld_v®ue_t
* 
pfv
 = &
±u¶e
->
_pv®ues
[
ix
];

780 ià(!
pfv
->
	`cİy_v®ue
(
¬•
.
_de¡
+
off£t
)) {

781 
	`as£¹
 (
çl£
);

787 
off£t
 +ğ
pfv
->
	`maxsize
();

789  (
isz
);

790 
	}
}

811 
boŞ
 
	gbË_mª_t
::
	$lßd_key
(cÚ¡ * 
¡ršg
,

812 
šdex_desc_t
* 
pšdex
,

813 
bË_tu¶e
* 
±u¶e
)

815 
	`as£¹
 (
_±abË
);

816 
	`as£¹
 (
pšdex
);

817 
	`as£¹
 (
¡ršg
);

819 
off£t
 = 0;

820 
ušt_t
 
i
=0; i<
pšdex
->
	`f›ld_couÁ
(); i++) {

821 
ušt_t
 
f›ld_šdex
 = 
pšdex
->
	`key_šdex
(
i
);

822 
ušt_t
 
size
 = 
±u¶e
->
_pv®ues
[
f›ld_šdex
].
	`maxsize
();

823 
±u¶e
->
_pv®ues
[
f›ld_šdex
].
	`£t_v®ue
(
¡ršg
 + 
off£t
, 
size
);

824 
off£t
 +ğ
size
;

827  (
Œue
);

828 
	}
}

842 
	gbË_mª_t
::
	$mš_key
(
šdex_desc_t
* 
pšdex
,

843 
bË_tu¶e
* 
±u¶e
,

844 
»p_row_t
 &
¬•
)

846 
	`as£¹
 (
_±abË
);

847 
ušt_t
 
i
=0; i<
pšdex
->
	`f›ld_couÁ
(); i++) {

848 
ušt_t
 
f›ld_šdex
 = 
pšdex
->
	`key_šdex
(
i
);

849 
±u¶e
->
_pv®ues
[
f›ld_šdex
].
	`£t_mš_v®ue
();

851  (
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
¬•
));

852 
	}
}

855 
	gbË_mª_t
::
	$max_key
(
šdex_desc_t
* 
pšdex
,

856 
bË_tu¶e
* 
±u¶e
,

857 
»p_row_t
 &
¬•
)

859 
	`as£¹
 (
_±abË
);

860 
ušt_t
 
i
=0; i<
pšdex
->
	`f›ld_couÁ
(); i++) {

861 
ušt_t
 
f›ld_šdex
 = 
pšdex
->
	`key_šdex
(
i
);

862 
±u¶e
->
_pv®ues
[
f›ld_šdex
].
	`£t_max_v®ue
();

864  (
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
¬•
));

865 
	}
}

884 
	gbË_mª_t
::
	$key_size
(
šdex_desc_t
* 
pšdex
,

885 cÚ¡ 
bË_tu¶e
*) const

887 
	`as£¹
 (
_±abË
);

888  (
_±abË
->
	`šdex_maxkeysize
(
pšdex
));

889 
	}
}

897 
	gbË_mª_t
::
	$g‘_²um
(
šdex_desc_t
* 
pšdex
,

898 
bË_tu¶e
 cÚ¡* 
±u¶e
) const

900 
	`as£¹
(
±u¶e
);

901 
	`as£¹
(
pšdex
);

902 if(!
pšdex
->
	`is_·¹™iÚed
())

905 
fœ¡_key
;

906 
±u¶e
->
	`g‘_v®ue
(
pšdex
->
	`key_šdex
(0), 
fœ¡_key
);

907  (
fœ¡_key
 % 
pšdex
->
	`g‘_·¹™iÚ_couÁ
());

908 
	}
}

912 
mcs_lock
 
	gbË_mª_t
::
»gi¡”_bË_lock
;

913 
	g¡d
::
m­
<
¡id_t
, 
	gbË_mª_t
*>abË_mª_t::
¡id_to_bËmª
;

915 
	gbË_mª_t
::
	$»gi¡”_bË_mª
()

917 
	`CRITICAL_SECTION
(
»gbËcs
,
»gi¡”_bË_lock
);

918 
¡id_to_bËmª
[
this
->
	`bË
()->
	`fid
()] =his;

919 
	}
}

932 
w_rc_t
 
	gbË_mª_t
::
	$lßd_ªd_»gi¡”_fid
(
ss_m
* 
db
)

934 
	`as£¹
 (
_±abË
);

935 
	`as£¹
 (
db
);

937 
_±abË
->
	`£t_db
(
db
);

938 
	`W_DO
(
_±abË
->
	`check_fid
(
db
));

939 
	`»gi¡”_bË_mª
();

941 
šdex_desc_t
* 
šdex
 = 
_±abË
->
	`šdexes
();

942 
šdex
) {

943 
	`W_DO
(
šdex
->
	`check_fid
(
db
));

944 
šdex
 = index->
	`Ãxt
();

946  (
RCOK
);

947 
	}
}

961 
w_rc_t
 
	gbË_mª_t
::
	$šdex_´obe
(
ss_m
* 
db
,

962 
šdex_desc_t
* 
pšdex
,

963 
bË_tu¶e
* 
±u¶e
,

964 
lock_mode_t
 
lock_mode
,

965 cÚ¡ 
Íid_t
& 
roÙ
)

967 
	`as£¹
 (
_±abË
);

968 
	`as£¹
 (
pšdex
);

969 
	`as£¹
 (
±u¶e
);

970 
	`as£¹
 (
±u¶e
->
_»p
);

972 
ušt4_t
 
sy¡em_mode
 = 
pšdex
->
	`g‘_pd
();

974 
boŞ
 
found
 = 
çl£
;

975 
smsize_t
 
Ën
 = (
rid_t
);

980 
boŞ
 
bIgnÜeLocks
 = 
çl£
;

981 ià(
pšdex
->
	`is_»Ïxed
()) {

982 
lock_mode
 = 
NL
;

983 
bIgnÜeLocks
 = 
Œue
;

987 
key_sz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, *±u¶e->
_»p
);

988 
	`as£¹
 (
±u¶e
->
_»p
->
_de¡
);

990 
²um
 = 
	`g‘_²um
(
pšdex
, 
±u¶e
);

992 ià(
pšdex
->
	`is_mr
()) {

995 
	`W_DO
(
ss_m
::
	`fšd_mr_assoc
(
pšdex
->
	`fid
(
²um
),

996 
	`vec_t
(
±u¶e
->
_»p
->
_de¡
, 
key_sz
),

997 &(
±u¶e
->
_rid
),

998 
Ën
,

999 
found
,

1000 
bIgnÜeLocks
,

1001 
pšdex
->
	`is_ÏtchËss
(),

1002 
roÙ


1006 
	`W_DO
(
ss_m
::
	`fšd_assoc
(
pšdex
->
	`fid
(
²um
),

1007 
	`vec_t
(
±u¶e
->
_»p
->
_de¡
, 
key_sz
),

1008 &(
±u¶e
->
_rid
),

1009 
Ën
,

1010 
found
,

1011 
bIgnÜeLocks


1015 ià(!
found
è 
	`RC
(
£_TUPLE_NOT_FOUND
);

1018 
pš_i
 
pš
;

1019 
Ïtch_mode_t
 
h—p_Ïtch_mode
 = 
LATCH_SH
;

1020 ià(
sy¡em_mode
 & (
PD_MRBT_PART
 | 
PD_MRBT_LEAF
)è
h—p_Ïtch_mode
 = 
LATCH_NLS
;

1021 
	`W_DO
(
pš
.
	`pš
(
±u¶e
->
	`rid
(), 0, 
lock_mode
, 
h—p_Ïtch_mode
));

1023 ià(!
	`lßd
(
±u¶e
, 
pš
.
	`body
())) {

1024 
pš
.
	`uÅš
();

1025  
	`RC
(
£_WRONG_DISK_DATA
);

1027 
pš
.
	`uÅš
();

1028  (
RCOK
);

1029 
	}
}

1052 
w_rc_t
 
	gbË_mª_t
::
	$add_tu¶e
(
ss_m
* 
db
,

1053 
bË_tu¶e
* 
±u¶e
,

1054 cÚ¡ 
lock_mode_t
 
lock_mode
,

1055 cÚ¡ 
Íid_t
& 
´im¬y_roÙ
)

1057 
	`as£¹
 (
_±abË
);

1058 
	`as£¹
 (
±u¶e
);

1059 
	`as£¹
 (
±u¶e
->
_»p
);

1060 
ušt4_t
 
sy¡em_mode
 = 
_±abË
->
	`g‘_pd
();

1062 ià((
sy¡em_mode
 & (
PD_MRBT_PART
 | 
PD_MRBT_LEAF
)) &&

1063 (
_±abË
->
	`´im¬y_idx
(è&& _±abË->´im¬y_idx()->
	`is_ÏtchËss
())) {

1064  (
	`add_¶p_tu¶e
(
db
,
±u¶e
,
lock_mode
,
sy¡em_mode
,
´im¬y_roÙ
));

1068 
boŞ
 
bIgnÜeLocks
 = 
çl£
;

1069 ià(
lock_mode
==
NL
è
bIgnÜeLocks
 = 
Œue
;

1073 
tsz
 = 
	`fÜm©
(
±u¶e
, *±u¶e->
_»p
);

1074 
	`as£¹
 (
±u¶e
->
_»p
->
_de¡
);

1076 
	`W_DO
(
db
->
	`ü—‹_»c
(
_±abË
->
	`fid
(),

1077 
	`vec_t
(),

1078 
tsz
,

1079 
	`vec_t
(
±u¶e
->
_»p
->
_de¡
, 
tsz
),

1080 
±u¶e
->
_rid
,

1081 
bIgnÜeLocks


1085 
šdex_desc_t
* 
šdex
 = 
_±abË
->
	`šdexes
();

1086 
ksz
 = 0;

1088 
šdex
) {

1089 
ksz
 = 
	`fÜm©_key
(
šdex
, 
±u¶e
, *±u¶e->
_»p
);

1090 
	`as£¹
 (
±u¶e
->
_»p
->
_de¡
);

1092 
²um
 = 
	`g‘_²um
(
šdex
, 
±u¶e
);

1094 ià(
šdex
->
	`is_mr
()) {

1095 
ss_m
::
RELOCATE_RECORD_CALLBACK_FUNC
 
»loc_func
 = &
»loÿ‹_»cÜds
;

1096 
–_fËr
 
ef
;

1097 
ef
.
_–
.
	`put
(
	`vec_t
(&(
±u¶e
->
_rid
), (
rid_t
)));

1098 
	`W_DO
(
db
->
	`ü—‹_mr_assoc
(
šdex
->
	`fid
(
²um
),

1099 
	`vec_t
(
±u¶e
->
_»p
->
_de¡
, 
ksz
),

1100 
ef
,

1101 
bIgnÜeLocks
,

1102 
bIgnÜeLocks
 && 
šdex
->
	`is_ÏtchËss
(),

1103 
»loc_func
,

1104 (
šdex
->
	`is_´im¬y
(è? 
´im¬y_roÙ
 : 
Íid_t
::
nuÎ
)

1108 
	`W_DO
(
db
->
	`ü—‹_assoc
(
šdex
->
	`fid
(
²um
),

1109 
	`vec_t
(
±u¶e
->
_»p
->
_de¡
, 
ksz
),

1110 
	`vec_t
(&(
±u¶e
->
_rid
), (
rid_t
)),

1111 
bIgnÜeLocks


1115 
šdex
 = index->
	`Ãxt
();

1117  (
RCOK
);

1118 
	}
}

1133 
w_rc_t
 
	gbË_mª_t
::
	$add_šdex_’Œy
(
ss_m
* 
db
,

1134 cÚ¡ * 
idx_Çme
,

1135 
bË_tu¶e
* 
±u¶e
,

1136 cÚ¡ 
lock_mode_t
 
lock_mode
,

1137 cÚ¡ 
Íid_t
& 
´im¬y_roÙ
)

1139 
	`as£¹
 (
_±abË
);

1140 
	`as£¹
 (
±u¶e
);

1141 
	`as£¹
 (
±u¶e
->
_»p
);

1144 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
(
idx_Çme
);

1145 
	`as£¹
 (
pšdex
);

1147 ià(!
±u¶e
->
	`is_rid_v®id
()è 
	`RC
(
£_NO_CURRENT_TUPLE
);

1149 
ušt4_t
 
sy¡em_mode
 = 
_±abË
->
	`g‘_pd
();

1152 
boŞ
 
bIgnÜeLocks
 = 
çl£
;

1153 ià(
lock_mode
==
NL
è
bIgnÜeLocks
 = 
Œue
;

1156 
ksz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, *±u¶e->
_»p
);

1157 
	`as£¹
 (
±u¶e
->
_»p
->
_de¡
);

1159 
²um
 = 
	`g‘_²um
(
pšdex
, 
±u¶e
);

1161 ià(
pšdex
->
	`is_mr
()) {

1162 
ss_m
::
RELOCATE_RECORD_CALLBACK_FUNC
 
»loc_func
 = &
»loÿ‹_»cÜds
;

1163 
–_fËr
 
ef
;

1164 
ef
.
_–
.
	`put
(
	`vec_t
(&(
±u¶e
->
_rid
), (
rid_t
)));

1165 
	`W_DO
(
db
->
	`ü—‹_mr_assoc
(
pšdex
->
	`fid
(
²um
),

1166 
	`vec_t
(
±u¶e
->
_»p
->
_de¡
, 
ksz
),

1167 
ef
,

1168 
bIgnÜeLocks
,

1169 
pšdex
->
	`is_ÏtchËss
(),

1170 
»loc_func
,

1171 (
pšdex
->
	`is_´im¬y
(è? 
´im¬y_roÙ
 : 
Íid_t
::
nuÎ
)

1175 
	`W_DO
(
db
->
	`ü—‹_assoc
(
pšdex
->
	`fid
(
²um
),

1176 
	`vec_t
(
±u¶e
->
_»p
->
_de¡
, 
ksz
),

1177 
	`vec_t
(&(
±u¶e
->
_rid
), (
rid_t
)),

1178 
bIgnÜeLocks


1182  (
RCOK
);

1183 
	}
}

1210 
	g–_fËr_·¹
::
	$–_fËr_·¹
(
size_t
 
šdex’Œysz
,

1211 
ss_m
* 
db
,

1212 
bË_mª_t
* 
±abËmª
,

1213 
bË_tu¶e
* 
±u¶e
,

1214 
šdex_desc_t
* 
pšdex
,

1215 
boŞ
 
bIgnÜeLocks
)

1216 : 
	`_db
(
db
),
	`_±abËmª
(
±abËmª
), 
	`_±u¶e
(
±u¶e
), 
	`_pšdex
(
pšdex
),

1217 
	$_bIgnÜeLocks
(
bIgnÜeLocks
)

1219 
_–_size
 = 
šdex’Œysz
;

1220 
	`as£¹
 (
db
);

1221 
	`as£¹
 (
±abËmª
);

1222 
	`as£¹
 (
±u¶e
);

1223 
	`as£¹
 (
pšdex
);

1224 
	}
}

1227 
rc_t
 
	g–_fËr_·¹
::
	$fl_–
(
vec_t
& 
–
, cÚ¡ 
Íid_t
& 
Ëaf
)

1231 
tsz
 = 
_±abËmª
->
	`fÜm©
(
_±u¶e
, *_±u¶e->
_»p
);

1232 
	`as£¹
 (
_±u¶e
->
_»p
->
_de¡
);

1236 
rc_t
 
rc
 = 
_db
->
	`fšd_·ge_ªd_ü—‹_mrbt_»c
(
_±abËmª
->
	`bË
()->
	`fid
(),

1237 
Ëaf
,

1238 
	`vec_t
(),

1239 
tsz
,

1240 
	`vec_t
(
_±u¶e
->
_»p
->
_de¡
, 
tsz
),

1241 
_±u¶e
->
_rid
,

1242 
_bIgnÜeLocks
,

1243 
_bIgnÜeLocks
);

1244 
–
.
	`put
(
	`vec_t
(&(
_±u¶e
->
_rid
), (
rid_t
)));

1246  
rc
;

1247 
	}
}

1260 
w_rc_t
 
	gbË_mª_t
::
»loÿ‹_»cÜds
(
veùÜ
<
rid_t
>& 
Şd_rids
,

1261 
veùÜ
<
rid_t
>& 
Ãw_rids
)

1266 
as£¹
(
Şd_rids
.
size
(è=ğ
Ãw_rids
.size() && old_rids.size() > 0);

1268 
	gveùÜ
<
	trid_t
>::
	t™”©Ü
 
	tRIDIt
;

1271 
RIDIt
 
	gŞd_rid™
 = 
Şd_rids
.
begš
();

1272 
RIDIt
 
	gÃw_rid™
 = 
Ãw_rids
.
begš
();

1273 
bË_mª_t
* 
	gmy_bË_mª
 =abË_mª_t::
¡id_to_bËmª
[(*
Şd_rid™
).
pid
.
_¡id
];

1276 if(
	gmy_bË_mª
->
bË
()->
šdex_couÁ
() > 1) {

1277 
šdex_desc_t
* 
	gpšdex
;

1278 
bË_row_t
* 
	g©u¶e
 = 
Ãw
able_row_t();

1279 
	g©u¶e
->
£tup
(
my_bË_mª
->
bË
());

1280 
	gksz
;

1281 
boŞ
 
	gfound
 = 
çl£
;

1282 
»p_row_t
 
¬•row
(
my_bË_mª
->
ts
());

1283 
	g¬•row
.
£t
(
my_bË_mª
->
bË
()->
maxsize
());

1284 
	g©u¶e
->
	g_»p
 = &
¬•row
;

1285 
	g²um
;

1289 
	gŞd_rid™
 !ğ
Şd_rids
.
’d
(è&& 
Ãw_rid™
 !ğ
Ãw_rids
.end();

1290 
	gŞd_rid™
++,
	gÃw_rid™
++) {

1293 
	g©u¶e
->
£t_rid
(*
Ãw_rid™
);

1294 
	gmy_bË_mª
->
»ad_tu¶e
(
©u¶e
);

1297 
	gpšdex
 = 
my_bË_mª
->
bË
()->
šdexes
();

1298 
	gpšdex
) {

1299 if(!
	gpšdex
->
is_´im¬y
()) {

1300 
	gfound
 = 
çl£
;

1301 
	g²um
 = 
my_bË_mª
->
g‘_²um
(
pšdex
, 
©u¶e
);

1303 
	gksz
 = 
my_bË_mª
->
fÜm©_key
(
pšdex
, 
©u¶e
, *©u¶e->
_»p
);

1304 
as£¹
 (
©u¶e
->
_»p
->
_de¡
);

1305 
W_DO
Ğ
ss_m
::
upd©e_mr_assoc
(
pšdex
->
fid
(
²um
),

1306 
vec_t
(
©u¶e
->
_»p
->
_de¡
, 
ksz
),

1307 
vec_t
(&(*
Şd_rid™
),(
rid_t
)),

1308 
vec_t
(&(*
Ãw_rid™
),(
rid_t
)),

1309 
found
) );

1310 
as£¹
(
found
);

1312 
	gpšdex
 = 
pšdex
->
Ãxt
();

1317 
d–‘e
 
	g©u¶e
;

1318 
	g©u¶e
 = 
NULL
;

1320  (
	gRCOK
);

1324 
w_rc_t
 
	gbË_mª_t
::
	$add_¶p_tu¶e
(
ss_m
* 
db
,

1325 
bË_tu¶e
* 
±u¶e
,

1326 cÚ¡ 
lock_mode_t
 
lock_mode
,

1327 cÚ¡ 
ušt
 
sy¡em_mode
,

1328 cÚ¡ 
Íid_t
& 
´im¬y_roÙ
)

1330 
	`as£¹
 (
sy¡em_mode
 & (
PD_MRBT_PART
 | 
PD_MRBT_LEAF
));

1333 
boŞ
 
bIgnÜeLocks
 = 
çl£
;

1334 ià(
lock_mode
==
NL
è
bIgnÜeLocks
 = 
Œue
;

1338 
šdex_desc_t
* 
´im¬y_šdex
 = 
_±abË
->
	`´im¬y_idx
();

1339 
	`as£¹
 (
´im¬y_šdex
);

1340 
	`as£¹
 (
´im¬y_šdex
->
	`is_mr
());

1342 
ksz
 = 
	`fÜm©_key
(
´im¬y_šdex
, 
±u¶e
, *±u¶e->
_»p_key
);

1343 
	`as£¹
 (
±u¶e
->
_»p_key
->
_de¡
);

1345 
²um
 = 
	`g‘_²um
(
´im¬y_šdex
, 
±u¶e
);

1347 
ss_m
::
RELOCATE_RECORD_CALLBACK_FUNC
 
»loc_func
 = &
»loÿ‹_»cÜds
;

1348 
–_fËr_·¹
 
	`·¹_fËr
((
rid_t
),
db
,
this
,
±u¶e
,
´im¬y_šdex
,
bIgnÜeLocks
);

1349 
	`W_DO
(
db
->
	`ü—‹_mr_assoc
(
´im¬y_šdex
->
	`fid
(
²um
),

1350 
	`vec_t
(
±u¶e
->
_»p_key
->
_de¡
, 
ksz
),

1351 
·¹_fËr
,

1352 
bIgnÜeLocks
,

1353 
bIgnÜeLocks
 && 
´im¬y_šdex
->
	`is_ÏtchËss
(),

1354 
»loc_func
,

1355 
´im¬y_roÙ
));

1358 
šdex_desc_t
* 
šdex
 = 
_±abË
->
	`šdexes
();

1359 
šdex
) {

1363 ià(
šdex
->
	`is_´im¬y
()) {

1364 
šdex
 = index->
	`Ãxt
();

1368 
ksz
 = 
	`fÜm©_key
(
šdex
, 
±u¶e
, *±u¶e->
_»p_key
);

1369 
	`as£¹
 (
±u¶e
->
_»p_key
->
_de¡
);

1371 
²um
 = 
	`g‘_²um
(
šdex
, 
±u¶e
);

1373 ià(
šdex
->
	`is_mr
()) {

1374 
–_fËr
 
ef
;

1375 
ef
.
_–
.
	`put
(
	`vec_t
(&(
±u¶e
->
_rid
), (
rid_t
)));

1376 
	`W_DO
(
db
->
	`ü—‹_mr_assoc
(
šdex
->
	`fid
(
²um
),

1377 
	`vec_t
(
±u¶e
->
_»p_key
->
_de¡
, 
ksz
),

1378 
ef
,

1379 
bIgnÜeLocks
,

1380 
bIgnÜeLocks
 && 
šdex
->
	`is_ÏtchËss
(),

1381 
NULL
,

1382 
Íid_t
::
nuÎ
));

1385 
	`W_DO
(
db
->
	`ü—‹_assoc
(
šdex
->
	`fid
(
²um
),

1386 
	`vec_t
(
±u¶e
->
_»p_key
->
_de¡
, 
ksz
),

1387 
	`vec_t
(&(
±u¶e
->
_rid
), (
rid_t
)),

1388 
bIgnÜeLocks


1392 
šdex
 = index->
	`Ãxt
();

1394  (
RCOK
);

1395 
	}
}

1412 
w_rc_t
 
	gbË_mª_t
::
	$d–‘e_tu¶e
(
ss_m
* 
db
,

1413 
bË_tu¶e
* 
±u¶e
,

1414 cÚ¡ 
lock_mode_t
 
lock_mode
,

1415 cÚ¡ 
Íid_t
& 
´im¬y_roÙ
)

1417 
	`as£¹
 (
_±abË
);

1418 
	`as£¹
 (
±u¶e
);

1419 
	`as£¹
 (
±u¶e
->
_»p
);

1421 ià(!
±u¶e
->
	`is_rid_v®id
()è 
	`RC
(
£_NO_CURRENT_TUPLE
);

1423 
ušt4_t
 
sy¡em_mode
 = 
_±abË
->
	`g‘_pd
();

1424 
rid_t
 
tod–‘e
 = 
±u¶e
->
	`rid
();

1427 
boŞ
 
bIgnÜeLocks
 = 
çl£
;

1428 ià(
lock_mode
==
NL
è
bIgnÜeLocks
 = 
Œue
;

1432 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`šdexes
();

1433 
key_sz
 = 0;

1435 
pšdex
) {

1436 
key_sz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, *±u¶e->
_»p
);

1437 
	`as£¹
 (
±u¶e
->
_»p
->
_de¡
);

1439 
²um
 = 
	`g‘_²um
(
pšdex
, 
±u¶e
);

1441 ià(
pšdex
->
	`is_mr
()) {

1442 
	`W_DO
(
db
->
	`de¡roy_mr_assoc
(
pšdex
->
	`fid
(
²um
),

1443 
	`vec_t
(
±u¶e
->
_»p
->
_de¡
, 
key_sz
),

1444 
	`vec_t
(&(
tod–‘e
), (
rid_t
)),

1445 
bIgnÜeLocks
,

1446 
pšdex
->
	`is_ÏtchËss
(),

1447 (
pšdex
->
	`is_´im¬y
(è? 
´im¬y_roÙ
 : 
Íid_t
::
nuÎ
)));

1450 
	`W_DO
(
db
->
	`de¡roy_assoc
(
pšdex
->
	`fid
(
²um
),

1451 
	`vec_t
(
±u¶e
->
_»p
->
_de¡
, 
key_sz
),

1452 
	`vec_t
(&(
tod–‘e
), (
rid_t
)),

1453 
bIgnÜeLocks


1458 
pšdex
 =…šdex->
	`Ãxt
();

1463 ià(
sy¡em_mode
 & ( 
PD_MRBT_LEAF
 | 
PD_MRBT_PART
) ) {

1464 
	`W_DO
(
db
->
	`de¡roy_mrbt_»c
Ğ
tod–‘e
,

1465 
bIgnÜeLocks
,

1466 
Œue
));

1470 
	`W_DO
(
db
->
	`de¡roy_»c
(
tod–‘e
, 
bIgnÜeLocks
));

1474 
±u¶e
->
	`£t_rid
(
rid_t
::
nuÎ
);

1475  (
RCOK
);

1476 
	}
}

1492 
w_rc_t
 
	gbË_mª_t
::
	$d–‘e_šdex_’Œy
(
ss_m
* 
db
,

1493 cÚ¡ * 
idx_Çme
,

1494 
bË_tu¶e
* 
±u¶e
,

1495 cÚ¡ 
lock_mode_t
 
lock_mode
,

1496 cÚ¡ 
Íid_t
& 
´im¬y_roÙ
)

1498 
	`as£¹
 (
_±abË
);

1499 
	`as£¹
 (
±u¶e
);

1500 
	`as£¹
 (
±u¶e
->
_»p
);

1502 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
(
idx_Çme
);

1503 
	`as£¹
 (
pšdex
);

1505 ià(!
±u¶e
->
	`is_rid_v®id
()è 
	`RC
(
£_NO_CURRENT_TUPLE
);

1507 
ušt4_t
 
sy¡em_mode
 = 
_±abË
->
	`g‘_pd
();

1508 
rid_t
 
tod–‘e
 = 
±u¶e
->
	`rid
();

1511 
boŞ
 
bIgnÜeLocks
 = 
çl£
;

1512 ià(
lock_mode
==
NL
è
bIgnÜeLocks
 = 
Œue
;

1515 
key_sz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, *±u¶e->
_»p
);

1516 
	`as£¹
 (
±u¶e
->
_»p
->
_de¡
);

1518 
²um
 = 
	`g‘_²um
(
pšdex
, 
±u¶e
);

1520 ià(
pšdex
->
	`is_mr
()) {

1521 
	`W_DO
(
db
->
	`de¡roy_mr_assoc
(
pšdex
->
	`fid
(
²um
),

1522 
	`vec_t
(
±u¶e
->
_»p
->
_de¡
, 
key_sz
),

1523 
	`vec_t
(&(
tod–‘e
), (
rid_t
)),

1524 
bIgnÜeLocks
,

1525 
pšdex
->
	`is_ÏtchËss
(),

1526 (
pšdex
->
	`is_´im¬y
(è? 
´im¬y_roÙ
 : 
Íid_t
::
nuÎ
)));

1529 
	`W_DO
(
db
->
	`de¡roy_assoc
(
pšdex
->
	`fid
(
²um
),

1530 
	`vec_t
(
±u¶e
->
_»p
->
_de¡
, 
key_sz
),

1531 
	`vec_t
(&(
tod–‘e
), (
rid_t
)),

1532 
bIgnÜeLocks


1536  (
RCOK
);

1537 
	}
}

1559 
w_rc_t
 
	gbË_mª_t
::
	$upd©e_tu¶e
(
ss_m
* ,

1560 
bË_tu¶e
* 
±u¶e
,

1561 cÚ¡ 
lock_mode_t
 
lock_mode
)

1563 
	`as£¹
 (
_±abË
);

1564 
	`as£¹
 (
±u¶e
);

1565 
	`as£¹
 (
±u¶e
->
_»p
);

1567 ià(!
±u¶e
->
	`is_rid_v®id
()è 
	`RC
(
£_NO_CURRENT_TUPLE
);

1569 
ušt4_t
 
sy¡em_mode
 = 
_±abË
->
	`g‘_pd
();

1570 
boŞ
 
bIgnÜeLocks
 = 
çl£
;

1571 ià(
lock_mode
==
NL
è
bIgnÜeLocks
 = 
Œue
;

1573 
boŞ
 
no_h—p_Ïtch
 = 
çl£
;

1574 
Ïtch_mode_t
 
h—p_Ïtch_mode
 = 
LATCH_EX
;

1575 ià(
sy¡em_mode
 & ( 
PD_MRBT_LEAF
 | 
PD_MRBT_PART
) ) {

1576 
no_h—p_Ïtch
 = 
Œue
;

1577 
h—p_Ïtch_mode
 = 
LATCH_NLX
;

1581 
pš_i
 
pš
;

1582 
	`W_DO
(
pš
.
	`pš
(
±u¶e
->
	`rid
(), 0, 
lock_mode
, 
h—p_Ïtch_mode
));

1583 
cu¼’t_size
 = 
pš
.
	`body_size
();

1587 
tsz
 = 
	`fÜm©
(
±u¶e
, *±u¶e->
_»p
);

1588 
	`as£¹
 (
±u¶e
->
_»p
->
_de¡
);

1591 
w_rc_t
 
rc
;

1592 ià(
cu¼’t_size
 < 
tsz
) {

1593 
zvec_t
 
	`azv
(
tsz
 - 
cu¼’t_size
);

1595 ià(
no_h—p_Ïtch
) {

1596 
rc
 = 
pš
.
	`­³nd_mrbt_»c
(
azv
,
h—p_Ïtch_mode
);

1599 
rc
 = 
pš
.
	`­³nd_»c
(
azv
);

1603 ià(
rc
.
	`is_”rÜ
()) {

1604 
	`TRACE
Ğ
TRACE_DEBUG
, "Error updating (by‡ppend)„ecord\n");

1605 
pš
.
	`uÅš
();

1607 
	`W_DO
(
rc
);

1612 ià(
no_h—p_Ïtch
) {

1613 
rc
 = 
pš
.
	`upd©e_mrbt_»c
(0, 
	`vec_t
(
±u¶e
->
_»p
->
_de¡
, 
tsz
),

1614 
bIgnÜeLocks
, 
Œue
);

1616 
rc
 = 
pš
.
	`upd©e_»c
(0, 
	`vec_t
(
±u¶e
->
_»p
->
_de¡
, 
tsz
), 
bIgnÜeLocks
);

1619 ià(
rc
.
	`is_”rÜ
()è
	`TRACE
Ğ
TRACE_DEBUG
, "Error updating„ecord\n");

1622 
pš
.
	`uÅš
();

1623  (
rc
);

1624 
	}
}

1641 
w_rc_t
 
	gbË_mª_t
::
	$»ad_tu¶e
(
bË_tu¶e
* 
±u¶e
,

1642 
lock_mode_t
 
lock_mode
,

1643 
Ïtch_mode_t
 
h—p_Ïtch_mode
)

1645 
	`as£¹
 (
_±abË
);

1646 
	`as£¹
 (
±u¶e
);

1648 ià(!
±u¶e
->
	`is_rid_v®id
()è 
	`RC
(
£_NO_CURRENT_TUPLE
);

1650 
ušt4_t
 
sy¡em_mode
 = 
_±abË
->
	`g‘_pd
();

1651 ià(
sy¡em_mode
 & ( 
PD_MRBT_LEAF
 | 
PD_MRBT_PART
) ) {

1652 
h—p_Ïtch_mode
 = 
LATCH_NLS
;

1653 
lock_mode
 = 
NL
;

1656 
pš_i
 
pš
;

1657 
	`W_DO
(
pš
.
	`pš
(
±u¶e
->
	`rid
(), 0, 
lock_mode
, 
h—p_Ïtch_mode
));

1658 ià(!
	`lßd
(
±u¶e
, 
pš
.
	`body
())) {

1659 
pš
.
	`uÅš
();

1660  
	`RC
(
£_WRONG_DISK_DATA
);

1662 
pš
.
	`uÅš
();

1664  (
RCOK
);

1665 
	}
}

1685 
w_rc_t
 
	gbË_mª_t
::
	$ãtch_bË
(
ss_m
* 
db
, 
lock_mode_t
 
®m
)

1687 
	`as£¹
 (
db
);

1688 
	`as£¹
 (
_±abË
);

1690 
boŞ
 
eof
 = 
çl£
;

1691 
couÁ”
 = -1;

1692 
pš_i
* 
hªdË
;

1694 
	`W_DO
(
db
->
	`begš_xù
());

1697 
sÿn_fe_i
 
	`t_sÿn
(
_±abË
->
	`fid
(), 
ss_m
::
t_cc_»cÜd
, 
çl£
, 
®m
);

1698 !
eof
) {

1699 
	`W_DO
(
t_sÿn
.
	`Ãxt_·ge
(
hªdË
, 0, 
eof
));

1700 
couÁ”
++;

1702 
	`TRACE
Ğ
TRACE_ALWAYS
, "%s:%d…ages\n", 
_±abË
->
	`Çme
(), 
couÁ”
);

1705 
šdex_desc_t
* 
šdex
 = 
_±abË
->
	`šdexes
();

1706 
²um
 = 0;

1707 
šdex
) {

1708 
²um
 = 0;…num < 
šdex
->
	`g‘_·¹™iÚ_couÁ
();…num++) {

1709 
sÿn_fe_i
 
	`if_sÿn
(
šdex
->
	`fid
(
²um
), 
ss_m
::
t_cc_»cÜd
, 
çl£
, 
®m
);

1710 
eof
 = 
çl£
;

1711 
couÁ”
 = -1;

1712 !
eof
) {

1713 
	`W_DO
(
if_sÿn
.
	`Ãxt_·ge
(
hªdË
, 0, 
eof
));

1714 
couÁ”
++;

1716 
	`TRACE
Ğ
TRACE_ALWAYS
, "\t%s:%d…age Õnum: %d)\n", 
šdex
->
	`Çme
(), 
couÁ”
, 
²um
);

1718 
šdex
 = index->
	`Ãxt
();

1721 
	`W_DO
(
db
->
	`comm™_xù
());

1723  (
RCOK
);

1724 
	}
}

1734 
	gbË_ãtch”_t
::
	$bË_ãtch”_t
(
ShÜeEnv
* 
’v
)

1735 : 
	`th»ad_t
("DB_FETCHER"), 
	$_’v
(
’v
)

1737 
	}
}

1739 
	gbË_ãtch”_t
::~
	$bË_ãtch”_t
()

1741 
	}
}

1743 
bË_ãtch”_t
::
	$wÜk
()

1745 
	`as£¹
(
_’v
);

1746 
w_rc_t
 
e
 = 
_’v
->
	`db_ãtch
();

1747 if(
e
.
	`is_”rÜ
()) {

1748 
û¼
 << "E¼Ü whãtchšg db!" << 
’dl
 << 
e
 <<ƒndl;

1750 
	}
}

1760 
	gbË_´š‹r_t
::
	$bË_´š‹r_t
(
ShÜeEnv
* 
’v
, 
lšes
)

1761 : 
	`th»ad_t
("DB_PRINTER"),

1762 
	`_’v
(
’v
), 
	$_lšes
(
lšes
)

1764 
	}
}

1766 
	gbË_´š‹r_t
::~
	$bË_´š‹r_t
()

1768 
	}
}

1770 
bË_´š‹r_t
::
	$wÜk
()

1772 
	`as£¹
(
_’v
);

1773 
w_rc_t
 
e
 = 
_’v
->
	`db_´št
(
_lšes
);

1774 if(
e
.
	`is_”rÜ
()) {

1775 
û¼
 << "E¼Ü wh´štšg db!" << 
’dl
 << 
e
 <<ƒndl;

1777 
	}
}

1785 
	~<s¡»am
>

1786 cÚ¡* 
	$db_´‘ty_´št
(
bË_desc_t
 cÚ¡* 
±desc
, , const* )

1788 
d©a
[1024];

1789 
¡d
::
¡ršg¡»am
 
	`šout
(
d©a
, sŒšg¡»am::
š
 | sŒšg¡»am::
out
);

1791 ((
bË_desc_t
*)
±desc
)->
	`´št_desc
(
šout
);

1792 
šout
 << 
¡d
::
’ds
;

1793  
d©a
;

1794 
	}
}

	@src/sm/shore/shore_trx_worker.cpp

33 
	~"sm/shÜe/shÜe_Œx_wÜk”.h
"

34 
	~"sm/shÜe/shÜe_’v.h
"

36 
ENTER_NAMESPACE
(
shÜe
);

47 
	gŒx_wÜk”_t
::
	$Œx_wÜk”_t
(
ShÜeEnv
* 
’v
, 
c_¡r
 
Šame
,

48 
´oûssÜid_t
 
­rsid
,

49 cÚ¡ 
u£_¦i
)

50 : 
	$ba£_wÜk”_t
(
’v
, 
Šame
, 
­rsid
, 
u£_¦i
)

52 
	`as£¹
 (
’v
);

53 
_aùiÚpoŞ
 = 
Ãw
 
	`PoŞ
((
Reque¡
*),
REQUESTS_PER_WORKER_POOL_SZ
);

54 
_pqueue
 = 
Ãw
 
	`Queue
Ğ
_aùiÚpoŞ
.
	`g‘
() );

55 
	}
}

57 
	gŒx_wÜk”_t
::~
	$Œx_wÜk”_t
()

59 
_pqueue
 = 
NULL
;

60 
_aùiÚpoŞ
 = 
NULL
;

61 
	}
}

64 
	gŒx_wÜk”_t
::
	$š™
(cÚ¡ 
lc
)

66 
_pqueue
->
	`£tqueue
(
WS_INPUT_Q
,
this
,
lc
,0);

67 
	}
}

80 
	gŒx_wÜk”_t
::
	$_wÜk_ACTIVE_im¶
()

83 
_´s_id
 = 
PBIND_NONE
;

84 
	`TRY_TO_BIND
(
_´s_id
,
_is_bound
);

86 
w_rc_t
 
e
;

87 
Reque¡
* 
¬
 = 
NULL
;

90 
	`g‘_cÚŒŞ
(è=ğ
WC_ACTIVE
) {

93 
¬
 = 
NULL
;

94 
	`£t_ws
(
WS_LOOP
);

98 
¬
 = 
_pqueue
->
	`pİ
();

101 ià(
¬
) {

102 
	`_£rve_aùiÚ
(
¬
);

103 ++
_¡©s
.
_£rved_šput
;

105 #iâdeà
CFG_FLUSHER


106 
_’v
->
_»que¡_poŞ
.
	`de¡roy
(
¬
);

111 
	}
}

125 
	gŒx_wÜk”_t
::
	$_£rve_aùiÚ
(
Reque¡
* 
´eque¡
)

130 
	`as£¹
 (
´eque¡
);

132 
tid_t
 
©id
;

134 
w_rc_t
 
e
 = 
_’v
->
	`db
()->
	`begš_xù
(
©id
);

135 ià(
e
.
	`is_”rÜ
()) {

136 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Problem beginning xct [0x%x]\n",

137 
e
.
	`”r_num
());

138 ++
_¡©s
.
_´obËms
;

143 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

144 
	`as£¹
 (
pxù
);

145 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Begš (%d)\n", 
©id
.
	`g‘_lo
());

146 
´eque¡
->
_xù
 = 
pxù
;

147 
´eque¡
->
_tid
 = 
©id
;

151 
w_rc_t
 
e
 = 
_’v
->
	`run_Úe_xù
(
´eque¡
);

152 ià(
e
.
	`is_”rÜ
()) {

153 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Problem„unning xct (%d) (%d) [0x%x]\n",

154 
´eque¡
->
_tid
.
	`g‘_lo
(),…»que¡->
_xù_id
, 
e
.
	`”r_num
());

155 ++
_¡©s
.
_´obËms
;

161 ++
_¡©s
.
_´oûs£d
;

163 
	}
}

176 
	gŒx_wÜk”_t
::
	$_´e_STOP_im¶
()

178 
Reque¡
* 
´
;

179 
»qs_»ad
 = 0;

180 
»qs_wr™e
 = 0;

181 
»qs_abt
 = 0;

183 
	`as£¹
 (
_pqueue
);

186 ; 
_pqueue
->
_»ad_pos
 !ğ_pqueue->
_fÜ_»ad”s
->
	`’d
(); _pqueue->_read_pos++) {

187 
´
 = *(
_pqueue
->
_»ad_pos
);

188 ++
»qs_»ad
;

189 ià(
	`abÜt_Úe_Œx
(
´
->
_xù
)è++
»qs_abt
;

194 
	`CRITICAL_SECTION
(
q_cs
, 
_pqueue
->
_lock
);

195 
_pqueue
->
_»ad_pos
 = _pqueue->
_fÜ_wr™”s
->
	`begš
();

196 
_pqueue
->
_»ad_pos
 !ğ_pqueue->
_fÜ_wr™”s
->
	`’d
();

197 
_pqueue
->
_»ad_pos
++)

199 
´
 = *(
_pqueue
->
_»ad_pos
);

200 ++
»qs_wr™e
;

201 ià(
	`abÜt_Úe_Œx
(
´
->
_xù
)è++
»qs_abt
;

205 ià((
»qs_»ad
 + 
»qs_wr™e
) > 0) {

206 
	`TRACE
Ğ
TRACE_ALWAYS
, "(%d)‡borted before stopping. (%d) (%d)\n",

207 
»qs_abt
, 
»qs_»ad
, 
»qs_wr™e
);

209  (
»qs_abt
);

210 
	}
}

213 
EXIT_NAMESPACE
(
shÜe
);

	@src/sm/shore/shore_worker.cpp

32 
	~"sm/shÜe/shÜe_wÜk”.h
"

33 
	~"sm/shÜe/shÜe_’v.h
"

35 
ENTER_NAMESPACE
(
shÜe
);

38 #ifdeà
WORKER_VERBOSE_STATS


39 #w¬nšg 
V”bo£
 
wÜk”
 
¡©i¡ics
 
’abËd


42 #ifdeà
WORKER_VERY_VERBOSE_STATS


43 #w¬nšg 
V”y
 
v”bo£
 
wÜk”
 
¡©i¡ics
 
’abËd
 (
avg
 
time
 
wa™šg
 
wšdow
)

56 
	gwÜk”_¡©s_t
::
	$´št_¡©s
() const

58 
ušt
 
execu‹d
 = 
_´oûs£d
 - 
_—¾y_abÜts
;

61 
	`TRACE
Ğ
TRACE_STATISTICS
, "Proûs£d (%d)\n", 
_´oûs£d
);

64 
	`TRACE
Ğ
TRACE_STATISTICS
, "Executed (%d) \t%.1f%%\n",

65 
execu‹d
, ()(100*execu‹d)/()
_´oûs£d
);

68 
	`TRACE
Ğ
TRACE_STATISTICS
, "Failure„ate (%d) \t%.1f%% \t%.1f%%\n",

69 
_´obËms
, ()(100*_´obËms)/()
_´oûs£d
,

70 ()(100*
_´obËms
)/()
execu‹d
);

74 
	`TRACE
Ğ
TRACE_STATISTICS
, "Input served (%d) \t%.1f%%\n",

75 
_£rved_šput
, ()(100*_£rved_šput)/()
_´oûs£d
);

80 
	`TRACE
Ğ
TRACE_STATISTICS
, "Wait served (%d) \t%.1f%%\n",

81 
_£rved_wa™šg
, ()(100*_£rved_wa™šg)/()
_´oûs£d
);

84 
	`TRACE
Ğ
TRACE_STATISTICS
, "Early‡borts (%d) \t%.1f%%\n",

85 
_—¾y_abÜts
, ()(100*_—¾y_abÜts)/()
_´oûs£d
);

89 
	`TRACE
Ğ
TRACE_STATISTICS
, "Midway‡borts (%d) \t%.1f%% \t%.1f%%\n",

90 
_mid_abÜts
, ()(100*_mid_abÜts)/()
_´oûs£d
,

91 ()(100*
_mid_abÜts
)/()
execu‹d
);

97 
	`TRACE
Ğ
TRACE_STATISTICS
, "Sleeped (%d) \t%.1f%%\n",

98 
_cÚdex_¦“p
, ()(100*_cÚdex_¦“p)/()
_´oûs£d
);

104 
	`TRACE
Ğ
TRACE_STATISTICS
, "Failed sleep (%d) \t%.1f%%\n",

105 
_çed_¦“p
, ()(100*_çed_¦“p)/()
_´oûs£d
);

108 #ifdeà
WORKER_VERBOSE_STATS


111 
	`TRACE
Ğ
TRACE_STATISTICS
, "Avg Action (%.3fms) \t(%.3fms)\n",

112 
_£rvšg_tÙ®
/()
_´oûs£d
, _£rvšg_tÙ®/()
execu‹d
);

116 
	`TRACE
Ğ
TRACE_STATISTICS
, "Avg RVPƒxec (%.3fms)\n",

117 
_rvp_exec_time
/()
_rvp_exec
);

121 
	`TRACE
Ğ
TRACE_STATISTICS
, "Avg RVP‚otify (%.3fms)\n",

122 
_rvp_nÙify_time
/()
_rvp_exec
);

125 
	`TRACE
Ğ
TRACE_STATISTICS
, "Avg iÀqueu (%.3f)\n", 
_wa™šg_tÙ®
/()
_´oûs£d
);

127 #ifdeà
WORKER_VERY_VERBOSE_STATS


129 
i
=1; i<
WAITING_WINDOW
; i++) {

130 
	`TRACE
Ğ
TRACE_STATISTICS
, "(%d -> %d). Wait (%.2f)\n",

131 
i
, i+1, 
_ww
[(
_ww_idx
+i)%
WAITING_WINDOW
]);

132 
	}
}

137 
	gwÜk”_¡©s_t
&

138 
	gwÜk”_¡©s_t
::
İ”©Ü
+ğ(
wÜk”_¡©s_t
 cÚ¡& 
rhs
)

140 
_´oûs£d
 +ğ
rhs
._processed;

141 
	g_´obËms
 +ğ
rhs
.
_´obËms
;

143 
	g_£rved_šput
 +ğ
rhs
.
_£rved_šput
;

144 
	g_£rved_wa™šg
 +ğ
rhs
.
_£rved_wa™šg
;

146 
	g_cÚdex_¦“p
 +ğ
rhs
.
_cÚdex_¦“p
;

147 
	g_çed_¦“p
 +ğ
rhs
.
_çed_¦“p
;

149 
	g_—¾y_abÜts
 +ğ
rhs
.
_—¾y_abÜts
;

150 
	g_mid_abÜts
 +ğ
rhs
.
_mid_abÜts
;

152 #ifdeà
WORKER_VERBOSE_STATS


153 
	g_wa™šg_tÙ®
 +ğ
rhs
.
_wa™šg_tÙ®
;

154 
	g_£rvšg_tÙ®
 +ğ
rhs
.
_£rvšg_tÙ®
;

156 
	g_rvp_exec
 +ğ
rhs
.
_rvp_exec
;

157 
	g_rvp_exec_time
 +ğ
rhs
.
_rvp_exec_time
;

158 
	g_rvp_nÙify_time
 +ğ
rhs
.
_rvp_nÙify_time
;

160 #ifdeà
WORKER_VERY_VERBOSE_STATS


161 
	gi
=0; i<
	gWAITING_WINDOW
; i++è
	g_ww
[
i
] +ğ
rhs
.
_ww
[i];

162 
	g_ww_idx
 +ğ
rhs
.
_ww_idx
;

163 
	g_Ï¡_chªge
 +ğ
rhs
.
_Ï¡_chªge
;

167  (*
	gthis
);

171 
	gwÜk”_¡©s_t
::
	$»£t
()

173 
_´oûs£d
 = 0;

174 
_´obËms
 = 0;

176 
_£rved_šput
 = 0;

177 
_£rved_wa™šg
 = 0;

179 
_cÚdex_¦“p
 = 0;

180 
_çed_¦“p
 = 0;

182 
_—¾y_abÜts
 = 0;

183 
_mid_abÜts
 = 0;

185 #ifdeà
WORKER_VERBOSE_STATS


186 
_wa™šg_tÙ®
 = 0;

187 
_£rvšg_tÙ®
 = 0;

189 
_rvp_exec
 = 0;

190 
_rvp_exec_time
 = 0;

191 
_rvp_nÙify_time
 = 0;

193 #ifdeà
WORKER_VERY_VERBOSE_STATS


194 
i
=0; i<
WAITING_WINDOW
; i++è
_ww
[i] = 0;

195 
_ww_idx
 = 0;

196 
_Ï¡_chªge
 = 0;

199 
	}
}

202 #ifdeà
WORKER_VERBOSE_STATS


204 
	gwÜk”_¡©s_t
::
	$upd©e_wa™ed
(cÚ¡ 
queue_time
)

206 
_wa™šg_tÙ®
 +ğ
queue_time
;

207 #ifdeà
WORKER_VERY_VERBOSE_STATS


208 
_Ï¡_chªge
 +ğ
_fÜ_Ï¡_chªge
.
	`time
();

209 ià(
_Ï¡_chªge
>1) {

211 
_ww_idx
 = (_ww_idx + 1è% 
WAITING_WINDOW
;

212 
_ww
[
_ww_idx
] = 0;

213 
_Ï¡_chªge
 = 0;

216 
_ww
[
_ww_idx
] +ğ
queue_time
;

218 
	}
}

220 
	gwÜk”_¡©s_t
::
	$upd©e_£rved
(cÚ¡ 
£rve_time_ms
)

222 
_£rvšg_tÙ®
 +ğ
£rve_time_ms
;

223 
	}
}

225 
	gwÜk”_¡©s_t
::
	$upd©e_rvp_exec_time
(cÚ¡ 
rvp_exec_time_ms
)

227 
_rvp_exec_time
 +ğ
rvp_exec_time_ms
;

228 ++
_rvp_exec
;

229 
	}
}

231 
	gwÜk”_¡©s_t
::
	$upd©e_rvp_nÙify_time
(cÚ¡ 
rvp_nÙify_time_ms
)

233 
_rvp_nÙify_time
 +ğ
rvp_nÙify_time_ms
;

234 
	}
}

254 
	gba£_wÜk”_t
::
	$wÜk
()

256 
ss_m
::
	`£t_¦i_’abËd
(
_u£_¦i
);

257 
rv®
 = 0;

260 
Œue
) {

261 
	`g‘_cÚŒŞ
()) {

266 (
WC_PAUSED
):

267 ià(
	`wÜk_PAUSED
())

271 (
WC_ACTIVE
):

273 
_’v
->
	`’v_th»ad_š™
();

276 
rv®
 = 
	`wÜk_ACTIVE
();

278 
_’v
->
	`’v_th»ad_fši
();

280 ià(
rv®
)

284 (
WC_STOPPED
):

285 
	`wÜk_STOPPED
();

290 
	`as£¹
(0);

293 
	}
}

310 
	gba£_wÜk”_t
::
	$_wÜk_PAUSED_im¶
()

317 
	`g‘_cÚŒŞ
(è=ğ
WC_PAUSED
) {

318 
	`¦“p
(1);

321 
	}
}

336 
	gba£_wÜk”_t
::
	$_wÜk_STOPPED_im¶
()

343 
xù_t
* 
ax
 = 
smth»ad_t
::
	`xù
();

344 ià(
ax
) {

345 
	`abÜt_Úe_Œx
(
ax
);

346 
	`TRACE
Ğ
TRACE_ALWAYS
, "Aborted one\n");

352 
	`_´e_STOP_im¶
();

356 
	`CRITICAL_SECTION
(
Ãxt_cs
, 
_Ãxt_lock
);

357 ià(
_Ãxt
) {

359 
_Ãxt
->
	`¡İ
();

360 
_Ãxt
->
	`još
();

361 
	`TRACE
Ğ
TRACE_DEBUG
, "Next joined...\n");

362 
	`d–‘e
 (
_Ãxt
);

364 
_Ãxt
 = 
NULL
;

372 
	}
}

386 
boŞ
 
	gba£_wÜk”_t
::
	$abÜt_Úe_Œx
(
xù_t
* 
axù
)

388 
	`as£¹
 (
_’v
);

389 
	`as£¹
 (
axù
);

390 
smth»ad_t
::
	`me
()->
	`©ch_xù
(
axù
);

391 
w_rc_t
 
e
 = 
ss_m
::
	`abÜt_xù
();

392 ià(
e
.
	`is_”rÜ
()) {

393 
	`TRACE
Ğ
TRACE_ALWAYS
, "Xù‡bÜˆçed [0x%x]\n", 
e
.
	`”r_num
());

394  (
çl£
);

396  (
Œue
);

397 
	}
}

409 
	gba£_wÜk”_t
::
	$¡©s
()

411 ià(
_¡©s
.
_´oûs£d
 < 
MINIMUM_PROCESSED
) {

413 
	`TRACE
Ğ
TRACE_DEBUG
, "(%sèãw d©a\n", 
	`th»ad_Çme
().
	`d©a
());

416 
	`TRACE
Ğ
TRACE_STATISTICS
, "(%s)\n", 
	`th»ad_Çme
().
	`d©a
());

417 
_¡©s
.
	`´št_¡©s
();

421 
_¡©s
.
	`»£t
();

422 
	}
}

426 
wÜk”_¡©s_t
 
	gba£_wÜk”_t
::
	$g‘_¡©s
()

429 ià(
_¡©s
.
_´oûs£d
 < 
MINIMUM_PROCESSED
) {

431 
	`TRACE
Ğ
TRACE_STATISTICS
, "(%sèãw d©a\n", 
	`th»ad_Çme
().
	`d©a
());

432 
	}
}

434 
TRACE
Ğ
TRACE_STATISTICS
, "(%s)\n", 
th»ad_Çme
().
d©a
());

435 
	g_¡©s
.
´št_¡©s
();

438  (*&
	g_¡©s
);

453 #ifdeà
ACCESS_RECORD_TRACE


454 #w¬nšg 
T¿cšg
 
»cÜd
 
acûs£s
 
’abËd


455 
	~<sys/¡©.h
>

456 
	~<sys/ty³s.h
>

457 
	~<fú.h
>

458 
	~<”ºo.h
>

459 
	gba£_wÜk”_t
::
	$ü—‹_Œaû_dœ
(
¡ršg
 
dœ
)

461 
	`mkdœ
(
dœ
.
	`c_¡r
(),0777);

462 
	}
}

463 
	gba£_wÜk”_t
::
	$İ’_Œaû_fe
()

465 
¡ršg
 
dœ
 = 
’vV¬
::
	`š¡ªû
()->
	`g‘V¬
("dir-trace","RAT");

466 
	`ü—‹_Œaû_dœ
(
dœ
);

467 
time_t
 
£cÚd
 = 
	`time
(
NULL
);

468 
¡ršg¡»am
 
¡
;

469 
¡
 << 
£cÚd
;

470 
¡ršg
 
âame
 = 
dœ
 + 
	`¡ršg
("/¿t-"è+ 
¡
.
	`¡r
(è+ sŒšg("-"è+ 
this
->
	`th»ad_Çme
() + string(".csv");

471 
	`TRACE
Ğ
TRACE_ALWAYS
, "O³nšg f(%s)\n", 
âame
.
	`c_¡r
());

472 
_Œaû_fe
.
	`İ’
(
âame
.
	`c_¡r
());

473 
	}
}

474 
	gba£_wÜk”_t
::
	$şo£_Œaû_fe
()

476 
veùÜ
<
¡ršg
>::
™”©Ü
 
™
 = 
_ev’ts
.
	`begš
(); iˆ!ğ_ev’ts.
	`’d
(); it++) {

477 
_Œaû_fe
 << 
this
->
	`th»ad_Çme
(è<< "," << *
™
 << 
’dl
;

479 
_Œaû_fe
.
	`şo£
();

480 
	`TRACE
Ğ
TRACE_ALWAYS
, "Closšg fe. (%dèev’t dum³d\n", 
_ev’ts
.
	`size
());

481 
	}
}

485 
EXIT_NAMESPACE
(
shÜe
);

	@src/tests/shore_kits.cpp

32 
	~"sm/shÜe/shÜe_sh–l.h
"

34 
	~"wÜklßd/cc/shÜe_cc_’v.h
"

35 
	~"wÜklßd/cc/shÜe_cc_ş›Á.h
"

37 
	~"wÜklßd/tm1/shÜe_tm1_’v.h
"

38 
	~"wÜklßd/tm1/shÜe_tm1_ş›Á.h
"

40 
	~"wÜklßd/cb/shÜe_cb_’v.h
"

41 
	~"wÜklßd/cb/shÜe_cb_ş›Á.h
"

43 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

44 
	~"wÜklßd/ch/shÜe_ch_ş›Á.h
"

46 
	~"wÜklßd/ssb/shÜe_ssb_’v.h
"

47 
	~"wÜklßd/ssb/shÜe_ssb_ş›Á.h
"

49 
	~"wÜklßd/û/shÜe_û_’v.h
"

50 
	~"wÜklßd/û/shÜe_û_ş›Á.h
"

52 
	~"k_defšes.h
"

54 #ifdeà
CFG_SIMICS


55 
	~"ut/simics-magic-š¡ruùiÚ.h
"

58 
	~"dÜa.h
"

59 
	~"dÜa/cc/dÜa_cc.h
"

60 
	~"dÜa/cc/dÜa_cc_ş›Á.h
"

61 
	~"dÜa/tm1/dÜa_tm1.h
"

62 
	~"dÜa/tm1/dÜa_tm1_ş›Á.h
"

63 
	~"dÜa/cb/dÜa_cb.h
"

64 
	~"dÜa/cb/dÜa_cb_ş›Á.h
"

66 #ifdeà
CFG_VTUNE


67 
	~<™ŠÙify.h
>

70 
	~<dlfú.h
>

72 
usšg
 
Çme¥aû
 
	gshÜe
;

74 
usšg
 
Çme¥aû
 
	gcc
;

75 
usšg
 
Çme¥aû
 
	gtm1
;

76 
usšg
 
Çme¥aû
 
	gcb
;

77 
usšg
 
Çme¥aû
 
	gch
;

78 
usšg
 
Çme¥aû
 
	gssb
;

79 
usšg
 
Çme¥aû
 
	gû
;

84 #w¬nšg 
CÚfigu¿tiÚ
: 
DORA
 
’abËd


85 
usšg
 
Çme¥aû
 
	gdÜa
;

87 #ifdeà
CFG_FLUSHER


88 #w¬nšg 
CÚfigu¿tiÚ
: 
FLUSHER
/
GROUPCOMMIT
 
’abËd


91 #w¬nšg 
CÚfigu¿tiÚ
: 
SLI
 
’abËd


92 #w¬nšg 
CÚfigu¿tiÚ
: 
ELR
 
’abËd


94 #ifdeà
CFG_SIMICS


95 #w¬nšg 
CÚfigu¿tiÚ
: 
W™h
 
SIMICS
 
MAGIC
 
INSTRUCTIONS


98 #ifdeà
CFG_CACHES


99 #w¬nšg 
CÚfigu¿tiÚ
: 
W™h
 
Objeù
 
CACHES


102 #ifdeà
CFG_BT


103 #w¬nšg 
CÚfigu¿tiÚ
: 
BackŒacšg
 
’abËd


106 #ifdeà
CFG_QPIPE


107 #w¬nšg 
CÚfigu¿tiÚ
: 
QPe
 
’abËd


110 #ifdeà
CFG_VTUNE


111 #w¬nšg 
CÚfigu¿tiÚ
: 
VTuÃ
 
cÚŒŞs
 
’abËd


117 
	eSy¢ameV®ue
 { 
	m¢Ba£lše
 = 0x1,

118 
	m¢DORA
 = 0x2,

119 
	m¢PLP
 = 0x4

124 
	gm­
<
	g¡ršg
,
	gSy¢ameV®ue
> 
	gmSy¢ameV®ue
;

126 
	$š™sy¢amem­
()

128 
mSy¢ameV®ue
["ba£lše"] = 
¢Ba£lše
;

129 
mSy¢ameV®ue
["dÜa"] = 
¢DORA
;

130 
mSy¢ameV®ue
["¶p"] = 
¢PLP
;

131 
	}
}

137 
	eB’chm¬kV®ue
 { 
	mbmTPCC
, 
	mbmTM1
, 
	mbmTPCB
, 
	mbmTPCH
 , 
	mbmSSB
, 
	mbmTPCE
 };

141 
	gm­
<
	g¡ršg
,
	gB’chm¬kV®ue
> 
	gmB’chm¬kV®ue
;

143 
	$š™b’chm¬km­
()

145 
mB’chm¬kV®ue
["cc"] = 
bmTPCC
;

146 
mB’chm¬kV®ue
["tm1"] = 
bmTM1
;

147 
mB’chm¬kV®ue
["cb"] = 
bmTPCB
;

148 
mB’chm¬kV®ue
["ch"] = 
bmTPCH
;

149 
mB’chm¬kV®ue
["ssb"] = 
bmSSB
;

150 
mB’chm¬kV®ue
["û"] = 
bmTPCE
;

151 
	}
}

157 
	g‹m¶©e
<
şass
 
	gCl›Á
,şas 
	gDB
>

158 şas 
	ck™_t
 : 
public
 
shÜe_sh–l_t


160 
´iv©e
:

161 
DB
* 
_dbš¡
;

163 
	mpublic
:

165 
	$k™_t
(cÚ¡ * 
´om±
,

166 cÚ¡ 
boŞ
 
Ãtmode
, cÚ¡ 
pÜt
,

167 cÚ¡ 
boŞ
 
šputfemode
, cÚ¡ 
¡ršg
 
šputfe
)

168 : 
	$shÜe_sh–l_t
(
´om±
,
Ãtmode
,
pÜt
,
šputfemode
,
šputfe
)

171 
	`lßd_Œxs_m­
();

172 
	`lßd_bp_m­
();

174 ~
	$k™_t
(è{ 
	}
}

177 
vœtu®
 
š¡_‹¡_’v
(
¬gc
, * 
¬gv
[]);

178 
vœtu®
 
lßd_Œxs_m­
();

179 
vœtu®
 
lßd_bp_m­
();

183 
vœtu®
 
_cmd_TEST_im¶
(cÚ¡ 
iQu”›dSF
, cÚ¡ 
iS´—d
,

184 cÚ¡ 
iNumOfTh»ads
, cÚ¡ 
iNumOfTrxs
,

185 cÚ¡ 
iS–eùedTrx
, cÚ¡ 
iI‹¿tiÚs
,

186 cÚ¡ 
eBšdšgTy³
 
abt
);

187 
vœtu®
 
_cmd_MEASURE_im¶
(cÚ¡ 
iQu”›dSF
, cÚ¡ 
iS´—d
,

188 cÚ¡ 
iNumOfTh»ads
, cÚ¡ 
iDu¿tiÚ
,

189 cÚ¡ 
iS–eùedTrx
, cÚ¡ 
iI‹¿tiÚs
,

190 cÚ¡ 
eBšdšgTy³
 
abt
);

192 
vœtu®
 
w_rc_t
 
	$´•¬eNewRun
(è{ 
	`as£¹
(
_dbš¡
); (_dbš¡->
	`Ãwrun
()); 
	}
}

209 
	g‹m¶©e
<
şass
 
	gCl›Á
,şas 
	gDB
>

210 
	gk™_t
<
	gCl›Á
,
	gDB
>::
	$lßd_Œxs_m­
()

212 
	`CRITICAL_SECTION
(
sh–l_cs
,
_lock
);

214  (
Cl›Á
::
	`lßd_sup_xù
(
_sup_Œxs
));

215 
	}
}

217 
	g‹m¶©e
<
şass
 
	gCl›Á
,şas 
	gDB
>

218 
	gk™_t
<
	gCl›Á
,
	gDB
>::
	$lßd_bp_m­
()

220 
	`CRITICAL_SECTION
(
sh–l_cs
,
_lock
);

222 
_sup_bps
[
BT_NONE
] = "NoBinding";

223 
_sup_bps
[
BT_NEXT
] = "Adjacent";

224 
_sup_bps
[
BT_SPREAD
] = "SpreadToCores";

225  (
_sup_bps
.
	`size
());

226 
	}
}

240 
	g‹m¶©e
<
şass
 
	gCl›Á
,şas 
	gDB
>

241 
	gk™_t
<
	gCl›Á
,
	gDB
>::
	$š¡_‹¡_’v
(
¬gc
, * 
¬gv
[])

244 
_’v
 = 
_dbš¡
 = 
Ãw
 
	`DB
();

245 #ifdeà
HAVE_CPUMON


246 
	`as£¹
 (
_g_mÚ
);

247 
_’v
->
	`£t_max_ıu_couÁ
(
_g_mÚ
->
	`g‘_num_of_ıus
());

252 
db_š™_smt_t
* 
š™Ÿliz”
 = 
Ãw
 
	`db_š™_smt_t
(
	`c_¡r
("š™"), 
_’v
);

253 
	`as£¹
 (
š™Ÿliz”
);

254 
š™Ÿliz”
->
	`fÜk
();

255 
š™Ÿliz”
->
	`još
();

256 
rv
 = 
š™Ÿliz”
->
	`rv
();

257 
	`d–‘e
 (
š™Ÿliz”
);

258 
š™Ÿliz”
 = 
NULL
;

260 ià(
rv
) {

261 
	`TRACE
Ğ
TRACE_ALWAYS
, "Exiting...\n");

262  (
rv
);

266 
	`as£¹
 (
_dbš¡
);

267 ià(
¬gc
>2) {

268 
qu”›dSF
 = 
	`©oi
(
¬gv
[2]);

269 
_dbš¡
->
	`£t_qf
(
qu”›dSF
);

271 
_theSF
 = 
_dbš¡
->
	`g‘_sf
();

275 ià(!
	`lßd_Œxs_m­
()) {

276 
	`TRACE
Ğ
TRACE_ALWAYS
, "No supportedrxs...\nExiting...");

279 ià(!
	`lßd_bp_m­
()) {

280 
	`TRACE
Ğ
TRACE_ALWAYS
, "No supported binding…olicies...\nExiting...");

285 
shÜe_sh–l_t
::
	`»gi¡”_commªds
();

288  (
_dbš¡
->
	`¡¬t
());

289 
	}
}

293 
Çme¥aû
 
	gshÜe
 {

294 
sh–l_ex³ù_ş›Ás
(
couÁ
);

295 
sh–l_awa™_ş›Ás
();

300 cÚ¡ 
	gMILLION
 = 1000000;

310 
	g‹m¶©e
<
şass
 
	gCl›Á
,şas 
	gDB
>

311 
	gk™_t
<
	gCl›Á
,
	gDB
>::
	$_cmd_TEST_im¶
(cÚ¡ 
iQu”›dSF
,

312 cÚ¡ 
iS´—d
,

313 cÚ¡ 
iNumOfTh»ads
,

314 cÚ¡ 
iNumOfTrxs
,

315 cÚ¡ 
iS–eùedTrx
,

316 cÚ¡ 
iI‹¿tiÚs
,

317 cÚ¡ 
eBšdšgTy³
 
abt
)

320 
	`´št_TEST_šfo
(
iQu”›dSF
, 
iS´—d
, 
iNumOfTh»ads
,

321 
iNumOfTrxs
, 
iS–eùedTrx
, 
iI‹¿tiÚs
, 
abt
);

323 
_dbš¡
->
	`upd_sf
();

324 
_dbš¡
->
	`£t_qf
(
iQu”›dSF
);

326 
Cl›Á
* 
‹¡”s
[
MAX_NUM_OF_THR
];

327 
j
=0; j<
iI‹¿tiÚs
 && !
ba£_ş›Á_t
::
	`is_‹¡_abÜ‹d
(); j++) {

329 
	`TRACE
Ğ
TRACE_ALWAYS
, "Iteration [%d of %d]\n",

330 (
j
+1), 
iI‹¿tiÚs
);

333 
_cu¼’t_´s_id
 = 
_¡¬t_´s_id
;

334 
wh_id
 = 0;

336 
_’v
->
	`»£t_¡©s
();

339 #ifdeà
HAVE_CPUMON


340 
_g_mÚ
->
	`úŒ_»£t
();

344 
	`TRACE
(
TRACE_ALWAYS
, "begin measurement\n");

345 
_’v
->
	`£t_m—su»
(
MST_MEASURE
);

346 
¡İw©ch_t
 
tim”
;

349 
i
=0; i<
iNumOfTh»ads
; i++) {

351 ià(
iS´—d
) {

352 
wh_id
 = (
i
%()
iQu”›dSF
)+1;

355 
‹¡”s
[
i
] = 
Ãw
 
	`Cl›Á
(
	`c_¡r
("CL-%d",i), i, 
_dbš¡
,

356 
MT_NUM_OF_TRXS
, 
iS–eùedTrx
, 
iNumOfTrxs
,

357 
_cu¼’t_´s_id
, 
wh_id
, 
iQu”›dSF
);

358 
	`as£¹
 (
‹¡”s
[
i
]);

359 
‹¡”s
[
i
]->
	`fÜk
();

360 
_cu¼’t_´s_id
 = 
	`Ãxt_ıu
(
abt
, _current_prs_id);

364 
i
=0; i<
iNumOfTh»ads
; i++) {

365 
‹¡”s
[
i
]->
	`još
();

366 ià(
‹¡”s
[
i
]->
	`rv
()) {

367 
	`TRACE
Ğ
TRACE_ALWAYS
, "Error inesting...\n");

368 
	`TRACE
Ğ
TRACE_ALWAYS
, "Exiting...\n");

369 
	`as£¹
 (
çl£
);

371 
	`d–‘e
 (
‹¡”s
[
i
]);

374 
d–ay
 = 
tim”
.
	`time
();

376 #ifdeà
HAVE_CPUMON


377 
_g_mÚ
->
	`úŒ_·u£
();

378 
ulÚg_t
 
miochs
 = 
_g_mÚ
->
	`ioch¬s
()/
MILLION
;

379 
u§ge
 = 
_g_mÚ
->
	`g‘_avg_u§ge
(
Œue
);

381 
ulÚg_t
 
miochs
 = 0;

382 
u§ge
 = 0;

384 
	`TRACE
(
TRACE_ALWAYS
, "end measurement\n");

385 
_’v
->
	`´št_throughput
(
iQu”›dSF
,
iS´—d
,
iNumOfTh»ads
,
d–ay
,

386 
miochs
, 
u§ge
);

388 #ifdeà
HAVE_CPUMON


389 
_g_mÚ
->
	`´št_lßd
(
d–ay
);

390 
_g_mÚ
->
	`´št_ext_¡©s
();

394 
_’v
->
	`£t_m—su»
(
MST_PAUSE
);

395 
	`TRACE
Ğ
TRACE_DEBUG
, "db checkpoint - start\n");

396 
_’v
->
	`checkpošt
();

397 
	`TRACE
Ğ
TRACE_ALWAYS
, "Checkpoint\n");

401 
_’v
->
	`£t_m—su»
(
MST_DONE
);

404 
w_rc_t
 
e
 = 
	`´•¬eNewRun
();

405 ià(
e
.
	`is_”rÜ
()) {

406 
	`TRACE
Ğ
TRACE_ALWAYS
, "!!! Problem…reparing forhe‚ext„un\n");

409  (
SHELL_NEXT_CONTINUE
);

410 
	}
}

416 
	g‹m¶©e
<
şass
 
	gCl›Á
,şas 
	gDB
>

417 
	gk™_t
<
	gCl›Á
,
	gDB
>::
	$_cmd_MEASURE_im¶
(cÚ¡ 
iQu”›dSF
,

418 cÚ¡ 
iS´—d
,

419 cÚ¡ 
iNumOfTh»ads
,

420 cÚ¡ 
iDu¿tiÚ
,

421 cÚ¡ 
iS–eùedTrx
,

422 cÚ¡ 
iI‹¿tiÚs
,

423 cÚ¡ 
eBšdšgTy³
 
abt
)

425 #ifdeà
CFG_VTUNE


427 
	`__™t_»sume
();

431 
	`´št_MEASURE_šfo
(
iQu”›dSF
, 
iS´—d
, 
iNumOfTh»ads
, 
iDu¿tiÚ
,

432 
iS–eùedTrx
, 
iI‹¿tiÚs
, 
abt
);

434 
_dbš¡
->
	`upd_sf
();

435 
_dbš¡
->
	`£t_qf
(
iQu”›dSF
);

437 
Cl›Á
* 
‹¡”s
[
MAX_NUM_OF_THR
];

438 
_cu¼’t_´s_id
 = 
_¡¬t_´s_id
;

439 
wh_id
 = 0;

442 
_’v
->
	`£t_m—su»
(
MST_WARMUP
);

443 
	`sh–l_ex³ù_ş›Ás
(
iNumOfTh»ads
);

446 
i
=0; i<
iNumOfTh»ads
; i++) {

448 ià(
iS´—d
) {

449 
wh_id
 = (
i
%()
iQu”›dSF
)+1;

452 
‹¡”s
[
i
] = 
Ãw
 
	`Cl›Á
(
	`c_¡r
("CL-%d",i), i, 
_dbš¡
,

453 
MT_TIME_DUR
, 
iS–eùedTrx
, 0,

454 
_cu¼’t_´s_id
, 
wh_id
, 
iQu”›dSF
);

455 
	`as£¹
 (
‹¡”s
[
i
]);

456 
‹¡”s
[
i
]->
	`fÜk
();

457 
_cu¼’t_´s_id
 = 
	`Ãxt_ıu
(
abt
, _current_prs_id);

461 
	`sh–l_awa™_ş›Ás
();

464 
»maššg
 = 0;

465 
d–ay
 = 0;

466 
j
=0; j<
iI‹¿tiÚs
 && !
ba£_ş›Á_t
::
	`is_‹¡_abÜ‹d
(); j++) {

467 if(
»maššg
 == 0) {

468 
	`¦“p
(1);

469 
	`TRACE
Ğ
TRACE_ALWAYS
, "Iteration [%d of %d]\n",

470 (
j
+1), 
iI‹¿tiÚs
);

473 #ifdeà
HAVE_CPUMON


474 
_g_mÚ
->
	`úŒ_»£t
();

478 
	`TRACE
(
TRACE_ALWAYS
, "begin measurement\n");

479 
_’v
->
	`£t_m—su»
(
MST_MEASURE
);

481 
_’v
->
	`»£t_¡©s
();

482 
d–ay
 = 0;

483 
»maššg
 = 
iDu¿tiÚ
;

485 
¡İw©ch_t
 
tim”
;

486 
»maššg
 = 
	`¦“p
(remaining);

487 if(
»maššg
 != 0) {

488 
d–ay
 +ğ
tim”
.
	`time
();

489 
j
--;

492 
d–ay
 +ğ
tim”
.
	`time
();

493 #ifdeà
HAVE_CPUMON


494 
_g_mÚ
->
	`úŒ_·u£
();

495 
ulÚg_t
 
miochs
 = 
_g_mÚ
->
	`ioch¬s
()/
MILLION
;

496 
u§ge
 = 
_g_mÚ
->
	`g‘_avg_u§ge
(
Œue
);

498 
ulÚg_t
 
miochs
 = 0;

499 
u§ge
 = 0;

501 
	`TRACE
(
TRACE_ALWAYS
, "end measurement\n");

502 
_’v
->
	`´št_throughput
(
iQu”›dSF
,
iS´—d
,
iNumOfTh»ads
,
d–ay
,

503 
miochs
, 
u§ge
);

505 #ifdeà
HAVE_CPUMON


506 
_g_mÚ
->
	`´št_lßd
(
d–ay
);

507 
_g_mÚ
->
	`´št_ext_¡©s
();

511 
_’v
->
	`£t_m—su»
(
MST_PAUSE
);

512 
	`TRACE
Ğ
TRACE_DEBUG
, "db checkpoint - start\n");

513 
_’v
->
	`checkpošt
();

514 
	`TRACE
Ğ
TRACE_ALWAYS
, "Checkpoint\n");

518 
_’v
->
	`£t_m—su»
(
MST_DONE
);

519 
i
=0; i<
iNumOfTh»ads
; i++) {

520 
‹¡”s
[
i
]->
	`još
();

522 ià(
‹¡”s
[
i
]->
	`rv
()) {

523 
	`TRACE
Ğ
TRACE_ALWAYS
, "Error inesting...\n");

524 
	`as£¹
 (
çl£
);

526 
	`as£¹
 (
‹¡”s
[
i
]);

527 
	`d–‘e
 (
‹¡”s
[
i
]);

531 
_’v
->
	`£t_m—su»
(
MST_DONE
);

533 
	`TRACE
Ğ
TRACE_ALWAYS
, "Preparing forhe‚ext„un\n");

536 
w_rc_t
 
e
 = 
	`´•¬eNewRun
();

537 ià(
e
.
	`is_”rÜ
()) {

538 
	`TRACE
Ğ
TRACE_ALWAYS
, "!!! Problem…reparing forhe‚ext„un\n");

541 #ifdeà
CFG_VTUNE


543 
	`__™t_·u£
();

546  (
SHELL_NEXT_CONTINUE
);

547 
	}
}

554 
	gk™_t
<
	tba£lše_cc_ş›Á_t
,
	tShÜeTPCCEnv
> 
	tba£lšeTPCCK™
;

555 
	gk™_t
<
	tba£lše_tm1_ş›Á_t
,
	tShÜeTM1Env
> 
	tba£lšeTM1K™
;

556 
	gk™_t
<
	tba£lše_cb_ş›Á_t
,
	tShÜeTPCBEnv
> 
	tba£lšeTPCBK™
;

557 
	gk™_t
<
	tba£lše_ch_ş›Á_t
,
	tShÜeTPCHEnv
> 
	tba£lšeTPCHK™
;

559 #ifdeà
CFG_QPIPE


560 
	gk™_t
<
	tba£lše_ssb_ş›Á_t
,
	tShÜeSSBEnv
> 
	tba£lšeSSBK™
;

563 
	gk™_t
<
	tba£lše_û_ş›Á_t
,
	tShÜeTPCEEnv
> 
	tba£lšeTPCEK™
;

566 
	gk™_t
<
	tdÜa_cc_ş›Á_t
,
	tDÜaTPCCEnv
> 
	tdÜaTPCCK™
;

567 
	gk™_t
<
	tdÜa_tm1_ş›Á_t
,
	tDÜaTM1Env
> 
	tdÜaTM1K™
;

568 
	gk™_t
<
	tdÜa_cb_ş›Á_t
,
	tDÜaTPCBEnv
> 
	tdÜaTPCBK™
;

572 
boŞ
 
	$v®id©ePhysiÿl
(
¡ršg
 
physiÿl
)

574 ià(
physiÿl
.
	`com·»
("normal")==0) {

575  (
Œue
);

577 ià(
physiÿl
.
	`com·»
("mrbtnorm")==0) {

578  (
Œue
);

580 ià(
physiÿl
.
	`com·»
("mrbtpart")==0) {

581  (
Œue
);

583 ià(
physiÿl
.
	`com·»
("mrbtleaf")==0) {

584  (
Œue
);

586  (
çl£
);

587 
	}
}

589 
	$u§ge
()

591 
	`TRACE
Ğ
TRACE_ALWAYS
, "\nAccepted…arameters:\n" \

603 
	}
}

607 
	$maš
(
¬gc
, * 
¬gv
[])

609 
	`dlİ’
("foo", 0);

611 #ifdeà
CFG_VTUNE


613 
	`__™t_·u£
();

616 
	`th»ad_š™
();

618 #ifdeà
CFG_SIMICS


619 
MAGIC_BREAKPOINT
;

622 
	`TRACE_SET
Ğ
TRACE_ALWAYS
 | 
TRACE_STATISTICS


632 
_g_shÜe_’v
 = 
NULL
;

633 
_g_mÚ
 = 
NULL
;

636 
boŞ
 
Ãtmode
 = 
çl£
;

637 
boŞ
 
šputfemode
 = 
çl£
;

638 
¡ršg
 
šputfe
;

639 
ÃÜt
 = 0;

640 
¡ršg
 
sy¡em
,
physiÿl
;

641 
iRªge
 = 0;

642 
c
 = 0;

643 
¡ršg
 
cÚfig
 = 
DEFAULTCONFIG
;

644 
¡ršg
 
cÚfFe
 = 
ENVCONFFILE
;

646 
’vV¬
* 
ev
 =ƒnvV¬::
	`š¡ªû
();

651 (
c
 = 
	`g‘İt
(
¬gc
,
¬gv
,"f:rnp:c:s:d:xg:i:h")) != -1) {

652 
c
) {

654 
	`TRACE
Ğ
TRACE_ALWAYS
, "CONFIGFILE (%s)\n", 
İrg
);

655 
cÚfFe
 = (
¡ršg
)
İrg
;

656 
ev
->
	`£tCÚfFe
(
cÚfFe
);

657 
	`TRACE
Ğ
TRACE_ALWAYS
, "CONFIG (%s)\n", 
cÚfig
.
	`c_¡r
());

658 
ev
->
	`£tCÚfigu¿tiÚ
(
cÚfig
);

661 
	`TRACE
Ğ
TRACE_ALWAYS
, "CLOBBERING DB\n");

662 
ev
->
	`£tV¬IÁ
("db-clobberdev",1);

665 
	`TRACE
Ğ
TRACE_ALWAYS
, "NETMODE\n");

666 
Ãtmode
 = 
Œue
;

669 
ÃÜt
 = 
	`©oi
(
İrg
);

670 
	`TRACE
Ğ
TRACE_ALWAYS
, "PORT (%d)\n", 
ÃÜt
);

673 
	`TRACE
Ğ
TRACE_ALWAYS
, "CONFIG (%s)\n", 
İrg
);

674 
cÚfig
 = (
¡ršg
)
İrg
;

675 
ev
->
	`£tCÚfigu¿tiÚ
(
cÚfig
);

678 
	`TRACE
Ğ
TRACE_ALWAYS
, "SYSTEM (%s)\n", 
İrg
);

679 
sy¡em
 = (
¡ršg
)
İrg
;

680 
ev
->
	`£tSysName
(
sy¡em
);

683 
	`TRACE
Ğ
TRACE_ALWAYS
, "PHYSICAL DESIGN (%s)\n", 
İrg
);

684 
physiÿl
 = (
¡ršg
)
İrg
;

685 ià(!
	`v®id©ePhysiÿl
(
physiÿl
)) {

686 
	`TRACE
Ğ
TRACE_ALWAYS
, "Unknown…hysical design (%s)\n",

687 
physiÿl
.
	`c_¡r
());

690 
ev
->
	`£tSysDesign
(
physiÿl
);

693 
	`TRACE
Ğ
TRACE_ALWAYS
, "Enabling hacks\n");

694 
ev
->
	`£tV¬IÁ
("physical-hacks-enable",1);

697 
iRªge
 = 
	`©oi
(
İrg
);

698 
	`TRACE
Ğ
TRACE_ALWAYS
, "RANGE (%d)\n", 
iRªge
);

699 
ev
->
	`£tV¬IÁ
("»cÜds-to-acûss",
iRªge
);

702 
šputfemode
 = 
Œue
;

703 
	`TRACE
Ğ
TRACE_ALWAYS
, "INPUTFILE (%s)\n", 
İrg
);

704 
šputfe
 = (
¡ršg
)
İrg
;

707 
	`u§ge
();

711 
	`TRACE
Ğ
TRACE_ALWAYS
, "Wrong…arameter. Accepted:„np:c:xg:s:d:h\n");

717 
	`as£¹
Ğ((
šputfemode
 =ğ
Œue
è&& (
Ãtmode
 =ğŒue)è=ğ
çl£
);

720 
	`š™sy¢amem­
();

721 
	`š™b’chm¬km­
();

723 
¡ršg
 
sy¢ame
 = 
ev
->
	`g‘SysName
();

724 
¡ršg
 
b’chm¬kÇme
 = 
ev
->
	`g‘SysV¬
("benchmark");

727 
physiÿl
 = 
ev
->
	`g‘SysDesign
();

729 
boŞ
 
Çme£t
=
çl£
;

730 
¡ršg
 
dbÇme
;

733 
gu¬d
<
shÜe_sh–l_t
> 
k™
 = 
NULL
;

735 
	`TRACE
Ğ
TRACE_ALWAYS
, "Starting (%s-%s-%s) kit\n",

736 
b’chm¬kÇme
.
	`c_¡r
(),

737 
physiÿl
.
	`c_¡r
(),

738 
sy¢ame
.
	`c_¡r
());

742 ià(
b’chm¬kÇme
.
	`com·»
("tpcc")==0) {

743 
dbÇme
 = "Ñpcc-" + 
physiÿl
 + "-";

744 
mSy¢ameV®ue
[
sy¢ame
]) {

745 
¢Ba£lše
:

746 
dbÇme
 += "base) ";

747 
k™
 = 
Ãw
 
	`ba£lšeTPCCK™
(
dbÇme
.
	`c_¡r
(),
Ãtmode
,
ÃÜt
,
šputfemode
,
šputfe
);

749 
¢DORA
:

750 
dbÇme
 +ğ"dÜaè"; 
Çme£t
=
Œue
;

751 
¢PLP
:

752 ià(!
Çme£t
è
dbÇme
 += "plp) ";

753 
k™
 = 
Ãw
 
	`dÜaTPCCK™
(
dbÇme
.
	`c_¡r
(),
Ãtmode
,
ÃÜt
,
šputfemode
,
šputfe
);

756 
	`TRACE
Ğ
TRACE_ALWAYS
, "Not supported configuration. Exiting...\n");

762 ià(
b’chm¬kÇme
.
	`com·»
("tm1")==0) {

763 
dbÇme
 = "Ñ©p-" + 
physiÿl
 + "-";

764 
mSy¢ameV®ue
[
sy¢ame
]) {

765 
¢Ba£lše
:

766 
dbÇme
 += "base) ";

767 
k™
 = 
Ãw
 
	`ba£lšeTM1K™
(
dbÇme
.
	`c_¡r
(),
Ãtmode
,
ÃÜt
,
šputfemode
,
šputfe
);

769 
¢DORA
:

770 
dbÇme
 +ğ"dÜaè"; 
Çme£t
=
Œue
;

771 
¢PLP
:

772 ià(!
Çme£t
è
dbÇme
 += "plp) ";

773 
k™
 = 
Ãw
 
	`dÜaTM1K™
(
dbÇme
.
	`c_¡r
(),
Ãtmode
,
ÃÜt
,
šputfemode
,
šputfe
);

776 
	`TRACE
Ğ
TRACE_ALWAYS
, "Not supported configuration. Exiting...\n");

782 ià(
b’chm¬kÇme
.
	`com·»
("tpcb")==0) {

783 
dbÇme
 = "Ñpcb-" + 
physiÿl
 + "-";

784 
mSy¢ameV®ue
[
sy¢ame
]) {

785 
¢Ba£lše
:

786 
dbÇme
 += "base) ";

787 
k™
 = 
Ãw
 
	`ba£lšeTPCBK™
(
dbÇme
.
	`c_¡r
(),
Ãtmode
,
ÃÜt
,
šputfemode
,
šputfe
);

789 
¢DORA
:

790 
dbÇme
 +ğ"dÜaè"; 
Çme£t
=
Œue
;

791 
¢PLP
:

792 ià(!
Çme£t
è
dbÇme
 += "plp) ";

793 
k™
 = 
Ãw
 
	`dÜaTPCBK™
(
dbÇme
.
	`c_¡r
(),
Ãtmode
,
ÃÜt
,
šputfemode
,
šputfe
);

796 
	`TRACE
Ğ
TRACE_ALWAYS
, "Not supported configuration. Exiting...\n");

802 ià(
b’chm¬kÇme
.
	`com·»
("tpch")==0) {

803 
mSy¢ameV®ue
[
sy¢ame
]) {

804 
¢Ba£lše
:

805 
k™
 = 
Ãw
 
	`ba£lšeTPCHK™
("Ñpch-ba£è",
Ãtmode
,
ÃÜt
,
šputfemode
,
šputfe
);

807 
¢DORA
:

808 
dbÇme
 +ğ"dÜaè"; 
Çme£t
=
Œue
;

809 
	`as£¹
 (0);

813 
	`TRACE
Ğ
TRACE_ALWAYS
, "Not supported configuration. Exiting...\n");

818 #ifdeà
CFG_QPIPE


820 ià(
b’chm¬kÇme
.
	`com·»
("ssb")==0) {

821 
mSy¢ameV®ue
[
sy¢ame
]) {

822 
¢Ba£lše
:

823 
k™
 = 
Ãw
 
	`ba£lšeSSBK™
("(ssb-ba£è",
Ãtmode
,
ÃÜt
,
šputfemode
,
šputfe
);

825 
¢DORA
:

826 
dbÇme
 +ğ"dÜaè"; 
Çme£t
=
Œue
;

827 
	`as£¹
 (0);

831 
	`TRACE
Ğ
TRACE_ALWAYS
, "Not supported configuration. Exiting...\n");

839 ià(
b’chm¬kÇme
.
	`com·»
("tpce")==0) {

840 
mSy¢ameV®ue
[
sy¢ame
]) {

841 
¢Ba£lše
:

842 
k™
 = 
Ãw
 
	`ba£lšeTPCEK™
("Ñpû-ba£è",
Ãtmode
,
ÃÜt
,
šputfemode
,
šputfe
);

844 
¢DORA
:

845 
dbÇme
 +ğ"dÜaè"; 
Çme£t
=
Œue
;

846 
	`as£¹
 (0);

850 
	`TRACE
Ğ
TRACE_ALWAYS
, "Not supported configurations. Exiting...\n");

856 
	`w_as£¹0
 (
k™
.
	`g‘
());

859 #ifdeà
HAVE_CPUMON


860 #ifdeà
HAVE_GLIBTOP


861 
_g_mÚ
 = 
Ãw
 
	`lšux_´ocmÚ™Ü_t
(
NULL
);

862 #–ià
	`defšed
(
HAVE_PROCFS
)

863 
_g_mÚ
 = 
Ãw
 
	`sunos_´ocmÚ™Ü_t
(
NULL
);

865 
	`w_as£¹0
 (
_g_mÚ
);

869 
	`TRACE
 ( 
TRACE_ALWAYS
, "Starting Shore Environment\n" );

870 ià(
k™
->
	`š¡_‹¡_’v
(
¬gc
, 
¬gv
)) {

875 
w_rc_t
 
rş
 = 
k™
->
	`db
()->
	`lßdd©a
();

876 ià(
rş
.
	`is_”rÜ
()) {

881 
_g_shÜe_’v
 = 
k™
->
	`db
();

884 
	`TRACE
Ğ
TRACE_ALWAYS
, "Preparing forhe‚ext„un\n");

885 
w_rc_t
 
e
 = 
k™
->
	`´•¬eNewRun
();

886 ià(
e
.
	`is_”rÜ
()) {

887 
	`TRACE
Ğ
TRACE_ALWAYS
, "!!! Problem…reparing forhe‚ext„un\n");

891 #ifdeà
HAVE_CPUMON


893 
_g_mÚ
->
	`£tEnv
(
k™
->
	`db
());

894 
_g_mÚ
->
	`fÜk
();

898 
	`TRACE
 ( 
TRACE_ALWAYS
, "Starting…rocessing commands\n" );

900 
¡¬t
 = 
k™
->
	`¡¬t
();

901 ià(
¡¬t
 < 0)

903 
	`TRACE
Ğ
TRACE_ALWAYS
, "Error in starting shell\n");

908 
k™
->
	`db
()->
	`¡©i¡ics
();

910 #ifdeà
HAVE_CPUMON


912 
_g_mÚ
->
	`úŒ_¡İ
();

913 
_g_mÚ
->
	`još
();

914 
	`d–‘e
 (
_g_mÚ
);

919 
	}
}

	@src/trace/trace_force.cpp

35 
	~"Œaû/Œaû_fÜû.h
"

37 
	~"k_defšes.h
"

41 
	#FORCE_BUFFER_SIZE
 256

	)

48 
	$Œaû_fÜû_
(cÚ¡ * 
f’ame
, 
lše_num
, cÚ¡ * 
funùiÚ_Çme
,

49 * 
fÜm©
, ...)

52 
funùiÚ_Çme_Ën
 = 
	`¡¾’
(
funùiÚ_Çme
);

53 
size
 = 
FORCE_BUFFER_SIZE
 + 
funùiÚ_Çme_Ën
;

54 
buf
[
size
];

57 
	`¢´štf
(
buf
, 
size
, "\nFORCE: %s:%d %s: ", 
f’ame
, 
lše_num
, 
funùiÚ_Çme
);

58 
msg_off£t
 = 
	`¡¾’
(
buf
);

59 
msg_size
 = 
size
 - 
msg_off£t
;

60 * 
msg
 = &
buf
[ 
msg_off£t
 ];

63 
va_li¡
 
­
;

64 
	`va_¡¬t
(
­
, 
fÜm©
);

65 
	`v¢´štf
(
msg
, 
msg_size
, 
fÜm©
, 
­
);

66 
	`årštf
(
¡d”r
, 
buf
);

67 
	`va_’d
(
­
);

68 
	}
}

	@src/trace/trace_print_pthread.cpp

32 
	~"Œaû/Œaû_´št_±h»ad.h
"

51 
	$Œaû_´št_±h»ad
(
FILE
* 
out_¡»am
, 
±h»ad_t
 
th»ad
)

57 #ià
	`defšed
(
lšux
è|| defšed(
__lšux
)

58 #iâdeà
__USE_GNU


59 
	#__USE_GNU


	)

64 
	`årštf
(
out_¡»am
, "%lu", 
th»ad
);

71 #ià
	`defšed
(
sun
è|| defšed(
__sun
)

72 #ià
	`defšed
(
__SVR4
è|| defšed(
__svr4__
)

76 
	`årštf
(
out_¡»am
, "%u", 
th»ad
);

82 
	}
}

	@src/trace/trace_stream.cpp

30 
	~"’gše/th»ad.h
"

31 
	~"Œaû/Œaû_¡»am.h
"

32 
	~"Œaû/Œaû_fÜû.h
"

33 
	~"Œaû/Œaû_´št_±h»ad.h
"

39 
±h»ad_mu‹x_t
 
	g¡»am_mu‹x
 = 
PTHREAD_MUTEX_INITIALIZER
;

70 
	$Œaû_¡»am
(
FILE
* 
out_¡»am
,

71 cÚ¡ * 
f’ame
, 
lše_num
, cÚ¡ * 
funùiÚ_Çme
,

72 * 
fÜm©
, 
va_li¡
 
­
)

83 
th»ad_t
* 
this_th»ad
 = 
	`th»ad_g‘_£lf
();

86 iàĞ
	`±h»ad_mu‹x_lock
Ğ&
¡»am_mu‹x
 ) )

88 
	`TRACE_FORCE
("pthread_mutex_lock() failed\n");

95 iàĞ
this_th»ad
 !ğ
NULL
 )

96 
	`årštf
(
out_¡»am
, "%s", 
this_th»ad
->
	`th»ad_Çme
().
	`d©a
());

98 
	`Œaû_´št_±h»ad
(
out_¡»am
, 
	`±h»ad_£lf
());

101 
	`årštf
(
out_¡»am
, ": %s:%d:%s: ", 
f’ame
, 
lše_num
, 
funùiÚ_Çme
);

102 
	`vårštf
(
out_¡»am
, 
fÜm©
, 
­
);

104 iàĞ
	`±h»ad_mu‹x_uÆock
Ğ&
¡»am_mu‹x
 ) )

106 
	`TRACE_FORCE
("pthread_mutex_unlock() failed\n");

115 
	`fæush
(
out_¡»am
);

116 
	}
}

	@src/util/busy_delay.cpp

9 
	~"ut/busy_d–ay.h
"

10 
	~<c¡dlib
>

12 #ifdeà
__GCC


13 
	~<c¡ršg
>

15 
	~<¡ršg.h
>

19 
	~<c¡ršg
>

20 
	~<m©h.h
>

21 
	~<ÿs£¹
>

22 
	~<sys/time.h
>

23 
	~"ut/Œaû.h
"

29 
	g_NAN
;

30 
	gMS_PER_SEC
 = 1000.0;

31 
	gMS_PER_USEC
 = 0.001;

32 
	gNUM_ITERATIONS_PER_MS
 = -1;

33 
	gNUM_RUNS_PER_ITERATION_COUNT
 = 10;

39 
™”©iÚ
();

40 
compu‹_™”©iÚs_³r_ms
(
mš_pow
, 
num_pow
);

51 
	$busy_d–ay_š™
()

54 
	`as£¹
(
NUM_ITERATIONS_PER_MS
 == -1);

57 
_NAN
 = 
	`log
(()-1);

60 
mš_pow
 = 10;

61 
num_pow
 = 10;

62 
num
 = 
	`compu‹_™”©iÚs_³r_ms
(
mš_pow
, 
num_pow
);

63 ià(
num
 < 0)

66 
	`TRACE
(0&
TRACE_ALWAYS
, "Compu‹d %d i‹¿tiÚ ³¸ms\n", 
num
);

67 
NUM_ITERATIONS_PER_MS
 = 
num
;

69 
	}
}

75 
	$busy_d–ay_ms
(
ms
)

78 
	`as£¹
(
NUM_ITERATIONS_PER_MS
 > 0);

80 
m
;

81 
m
 = 0; m < 
ms
; m++)

83 
i
;

84 
i
 = 0; i < 
NUM_ITERATIONS_PER_MS
; i++)

85 
	`™”©iÚ
();

87 
	}
}

93 
	$busy_d–ay_us
(
us
)

96 
	`as£¹
(
NUM_ITERATIONS_PER_MS
 > 0);

98 
num_™”©iÚs_³r_us
 = 
NUM_ITERATIONS_PER_MS
 / 1000;

99 
m
;

100 
m
 = 0; m < 
us
; m++)

102 
i
;

103 
i
 = 0; i < 
num_™”©iÚs_³r_us
; i++)

104 
	`™”©iÚ
();

106 
	}
}

115 
	$™”©iÚ
()

119 
_‹mp
 = 0;

120 vŞ©* 
_‹mp_±r
 = &
_‹mp
;

121 *
_‹mp_±r
 = *_temp_ptr + 1;

122 
	}
}

125 
	$compu‹_time_ms
(
num_™”
)

127 
	`as£¹
(
num_™”
 > 0);

129 
timev®
 
¡¬t
, 
’d
;

130 
	`mem£t
(&
¡¬t
, 0, (
timev®
));

131 
	`mem£t
(&
’d
, 0, (
timev®
));

134 ià(
	`g‘timeofday
(&
¡¬t
, 
NULL
))

135  
_NAN
;

137 
i
;

138 
i
 = 0; i < 
num_™”
; i++)

139 
	`™”©iÚ
();

142 ià(
	`g‘timeofday
(&
’d
, 
NULL
))

143  
_NAN
;

146 
¡¬t_time
 =

147 
¡¬t
.
tv_£c
 * 
MS_PER_SEC
 + s¹.
tv_u£c
 * 
MS_PER_USEC
;

148 
’d_time
 =

149 
’d
.
tv_£c
 * 
MS_PER_SEC
 +ƒnd.
tv_u£c
 * 
MS_PER_USEC
;

151  
’d_time
 - 
¡¬t_time
;

152 
	}
}

155 
	$compu‹_™”©iÚs_³r_ms
(
mš_pow
, 
num_pow
)

157 
sum_™”
 = 0;

158 
sum_time
 = 0.0;

160 
i
;

161 
p
 = 
mš_pow
;

162 
i
 = 0; i < 
num_pow
; i++)

164 
num_™”
 = 1 << 
p
;

165 
	`as£¹
(
num_™”
 > 0);

170 
sum
 = 0.0;

171 
r
;

172 
r
 = 0;„ < 
NUM_RUNS_PER_ITERATION_COUNT
;„++)

175 
t
 = 
	`compu‹_time_ms
(
num_™”
);

176 ià(
	`i¢ª
(
t
))

179 
	`TRACE
(0&
TRACE_DEBUG
, "compu‹_time_ms(%dè»tuº NAN\n", 
num_™”
);

183 
sum
 +ğ
t
;

186 
vg
 = 
sum
 / 
NUM_RUNS_PER_ITERATION_COUNT
;

187 
	`TRACE
(0&
TRACE_DEBUG
,

189 
vg
,

190 
num_™”
);

192 
sum_™”
 +ğ
num_™”
;

193 
sum_time
 +ğ
vg
;

195 
p
++;

198  ()Ğ
sum_™”
 / 
sum_time
 );

199 
	}
}

	@src/util/c_str.cpp

24 
	~<¡d¬g.h
>

26 
	~"ut/c_¡r.h
"

27 
	~"ut/exû±iÚ.h
"

28 
	~"ut/sync.h
"

29 
	~"ut/gu¬d.h
"

30 
	~<¡dio.h
>

32 
	~"k_defšes.h
"

34 
	~"ut/poŞ_®loc.h
"

36 #undeà
TRACK_LEAKS


38 #ifdeà
TRACK_LEAKS


39 
	~<m­
>

40 
	~<£t
>

41 
	~<veùÜ
>

42 
	g¡d
::
	tveùÜ
<*> 
	tadd»ss_li¡
;

43 
	g¡d
::
	tm­
<
	tc_¡r
::
	tc_¡r_d©a
*, 
	tadd»ss_li¡
> 
	towÃr_m­
;

44 
±h»ad_mu‹x_t
 
	gowÃr_mu‹x
 = 
PTHREAD_MUTEX_INITIALIZER
;

45 
owÃr_m­
* 
	gowÃrs
;

47 #ifdeà
__SUNPRO_CC


62 "C" * 
g‘_ÿÎ”
();

65 * 
	$g‘_ÿÎ”
(è{  
NULL
; 
	}
}

77 
	gsw©chz_couÁ
 = 0;

78 
	gš™Ÿlize_®loÿtÜ
::
	$š™Ÿlize_®loÿtÜ
() {

79 if(!
sw©chz_couÁ
++) {

80 #ifdeà
TRACK_LEAKS


81 
owÃrs
 = 
Ãw
 
owÃr_m­
;

84 
	}
}

89 cÚ¡ 
c_¡r
 
	gc_¡r
::
EMPTY_STRING
("%s", "");

91 
	gc_¡r
::
c_¡r_d©a
 {

92 
mubË
 
_couÁ
;

93 
	g_d©a
[0];

94 * 
_¡r
(è{  
	g_d©a
; }

95 
DECLARE_POOL_ALLOC_POOL
(
c_¡r_d©a
);

99 #ifdeà
TRACK_LEAKS


100 
	$´št_live_¡ršgs
() {

101 
owÃr_m­
::
™”©Ü
 
™
 = 
owÃrs
->
	`begš
();

102 
¡d
::
£t
<*> 
uniques
;

103 ; 
™
 !ğ
owÃrs
->
	`’d
(); ++it) {

104 
add»ss_li¡
::
™”©Ü
 
™2
 = 
™
->
£cÚd
.
	`begš
();

105 
	`´štf
("\"%s\"", 
™
->
fœ¡
->
	`_¡r
());

106 
uniques
.
	`ş—r
();

107 ; 
™2
 !ğ
™
->
£cÚd
.
	`’d
(); ++it2) {

108 if(
uniques
.
	`fšd
(*
™2
è!ğuniques.
	`’d
())

110 
	`´štf
(" @0x%p", *
™2
);

111 
uniques
.
	`š£¹
(*
™2
);

113 
	`´štf
("\n");

116 
	}
}

119 
	gc_¡r
::
	$c_¡r
(cÚ¡ * 
¡r
, ...)

120 : 
	$_d©a
(
NULL
)

123 cÚ¡ 
i
 = 1024;

124 
tmp
[
i
];

125 cÚ¡* 
¤c
;

126 
couÁ
;

129 if(
	`¡rchr
(
¡r
, '%')) {

130 
¤c
 = 
tmp
;

131 
va_li¡
 
¬gs
;

132 
	`va_¡¬t
(
¬gs
, 
¡r
);

133 
couÁ
 = 
	`v¢´štf
(
tmp
, 
i
, 
¡r
, 
¬gs
);

134 
	`va_’d
(
¬gs
);

136 if((
couÁ
 < 0è || (couÁ >ğ
i
) )

137 
	`THROW
(
BadAÎoc
);

140 
¤c
 = 
¡r
;

141 
couÁ
 = 
	`¡¾’
(
¡r
);

144 
_d©a
 = (
c_¡r_d©a
*èc_¡r_d©a::
	`poŞ
()->
	`®loc
((c_¡r_d©aè+ 
couÁ
 + 1);

146 
_d©a
->
_couÁ
 = 1;

147 
	`memıy
(
_d©a
->
	`_¡r
(), 
¤c
, 
couÁ
+1);

149 #ià
	`defšed
(
TRACK_LEAKS
)

150 
	`±h»ad_mu‹x_lock
(&
owÃr_mu‹x
);

151 (*
owÃrs
)[
_d©a
].
	`push_back
(
	`g‘_ÿÎ”
());

152 
	`±h»ad_mu‹x_uÆock
(&
owÃr_mu‹x
);

155 
	}
}

159 cÚ¡ * 
	gc_¡r
::
	$d©a
() const {

162  
_d©a
->
	`_¡r
();

163 
	}
}

167 
	gc_¡r
::
	$assign
(cÚ¡ 
c_¡r
 &
Ùh”
) {

169 #ià
	`defšed
(
TRACK_LEAKS
)

170 
	`±h»ad_mu‹x_lock
(&
owÃr_mu‹x
);

171 (*
owÃrs
)[
Ùh”
.
_d©a
].
	`push_back
(
	`g‘_ÿÎ”
());

172 
	`±h»ad_mu‹x_uÆock
(&
owÃr_mu‹x
);

176 
_d©a
 = 
Ùh”
._data;

178 #ifdeà
__¥¬cv9


179 
	`memb¬_’‹r
();

180 
	`©omic_šc_64
(&
_d©a
->
_couÁ
);

181 
	`memb¬_ex™
();

183 
	`__sync_ãtch_ªd_add
(&
_d©a
->
_couÁ
, 1);

185 
	}
}

189 
	gc_¡r
::
	$»Ëa£
() {

190 
couÁ
;

191 #ifdeà
__¥¬cv9


192 
	`memb¬_´oduûr
();

193 
couÁ
 = 
	`©omic_dec_64_nv
(&
_d©a
->
_couÁ
);

194 
	`memb¬_cÚsum”
();

196 
couÁ
 = 
	`__sync_add_ªd_ãtch
(&
_d©a
->
_couÁ
, -1);

198 if(
couÁ
 == 0) {

202 if(
DEBUG_C_STR
)

203 
	`´štf
("F»ešg %s\n", 
_d©a
->
	`_¡r
());

205 #ifdeà
TRACK_LEAKS


206 
	`±h»ad_mu‹x_lock
(&
owÃr_mu‹x
);

207 
owÃrs
->
	`”a£
(
_d©a
);

208 
	`±h»ad_mu‹x_uÆock
(&
owÃr_mu‹x
);

210 
c_¡r_d©a
::
	`poŞ
()->
	`ä“
(
_d©a
);

212 
	}
}

	@src/util/chomp.cpp

31 
	~"ut/chomp.h
"

33 
	~"k_defšes.h
"

35 #iâdeà
__GCC


36 
usšg
 
	g¡d
::
¡¾’
;

39 
	$chomp_Ãwlše
(* 
¡r
) {

40 
Ën
 = 
	`¡¾’
(
¡r
);

41 iàĞ
¡r
[
Ën
-1] == '\n' )

42 
¡r
[
Ën
-1] = '\0';

43 
	}
}

46 
	$chomp_ÿ¼Ÿge_»tuº
(* 
¡r
) {

47 
Ën
 = 
	`¡¾’
(
¡r
);

48 iàĞ
¡r
[
Ën
-1] == '\r' )

49 
¡r
[
Ën
-1] = '\0';

50 
	}
}

	@src/util/command/printer.cpp

24 
	~"ut.h
"

25 
	~"ut/commªd/´š‹r.h
"

27 
	~"k_defšes.h
"

30 
	g´š‹r_t
::
	$hªdË_commªd
(cÚ¡ * 
commªd
)

32 
num
;

33 iàĞ
	`ssÿnf
(
commªd
, "%* %d", &
num
) < 1 ) {

34 
	`TRACE
(
TRACE_ALWAYS
, "num‚ot specified...‡borting\n");

38 
i
 = 0; i < 
num
; i++) {

39 
	`TRACE
(
TRACE_ALWAYS
, "%s\n", 
commªd
);

41 
	}
}

	@src/util/command/tracer.cpp

24 
	~"ut.h
"

25 
	~"ut/cÚfig.h
"

26 
	~"ut/commªd/Œaûr.h
"

28 
	~"k_defšes.h
"

33 
	gŒaû_cmd_t
::
	$£lŸ£s
()

35 
_Çme
 = 
	`¡ršg
("trace");

36 
_®Ÿ£s
.
	`push_back
("trace");

37 
_®Ÿ£s
.
	`push_back
("t");

38 
_®Ÿ£s
.
	`push_back
("tracer");

39 
	}
}

42 
	gŒaû_cmd_t
::
	$š™
()

45 
	#ADD_TYPE
(
x
è
_known_ty³s
[
	`c_¡r
("%s", #x)] = x;

	)

47 
	`ADD_TYPE
(
TRACE_ALWAYS
);

48 
	`ADD_TYPE
(
TRACE_TUPLE_FLOW
);

49 
	`ADD_TYPE
(
TRACE_PACKET_FLOW
);

50 
	`ADD_TYPE
(
TRACE_SYNC_COND
);

51 
	`ADD_TYPE
(
TRACE_SYNC_LOCK
);

52 
	`ADD_TYPE
(
TRACE_THREAD_LIFE_CYCLE
);

53 
	`ADD_TYPE
(
TRACE_TEMP_FILE
);

54 
	`ADD_TYPE
(
TRACE_CPU_BINDING
);

55 
	`ADD_TYPE
(
TRACE_QUERY_RESULTS
);

56 
	`ADD_TYPE
(
TRACE_QUERY_PROGRESS
);

57 
	`ADD_TYPE
(
TRACE_STATISTICS
);

58 
	`ADD_TYPE
(
TRACE_NETWORK
);

59 
	`ADD_TYPE
(
TRACE_RESPONSE_TIME
);

60 
	`ADD_TYPE
(
TRACE_WORK_SHARING
);

61 
	`ADD_TYPE
(
TRACE_TRX_FLOW
);

62 
	`ADD_TYPE
(
TRACE_KEY_COMP
);

63 
	`ADD_TYPE
(
TRACE_RECORD_FLOW
);

65 
	`ADD_TYPE
(
TRACE_DEBUG
);

66 
	}
};

70 
	gŒaû_cmd_t
::
	$hªdË
(cÚ¡ * 
cmd
)

72 
cmd_g
[
SERVER_COMMAND_BUFFER_SIZE
];

73 
g
[
SERVER_COMMAND_BUFFER_SIZE
];

76 iàĞ
	`ssÿnf
(
cmd
, "%s", 
cmd_g
) < 1 ) {

77 
	`TRACE
(
TRACE_ALWAYS
, "Unableo…arse cmdag!\n");

78 
	`u§ge
();

79  (
SHELL_NEXT_CONTINUE
);

86 iàĞ
	`ssÿnf
(
cmd
, "%* %s", 
g
) < 1 ) {

87 
	`u§ge
();

88  (
SHELL_NEXT_CONTINUE
);

91 ià(!
	`¡rÿ£cmp
(
g
, "known")) {

92 
	`´št_known_ty³s
();

93  (
SHELL_NEXT_CONTINUE
);

96 ià(!
	`¡rÿ£cmp
(
g
, "list")) {

97 
	`´št_’abËd_ty³s
();

98  (
SHELL_NEXT_CONTINUE
);

101 ià(!
	`¡rÿ£cmp
(
g
, "enable")) {

102 
Œaû_ty³
[
SERVER_COMMAND_BUFFER_SIZE
];

103 iàĞ
	`ssÿnf
(
cmd
, "%* %* %s", 
Œaû_ty³
) < 1 ) {

104 
	`u§ge
();

105  (
SHELL_NEXT_CONTINUE
);

107 
	`’abË
(
Œaû_ty³
);

108  (
SHELL_NEXT_CONTINUE
);

111 ià(!
	`¡rÿ£cmp
(
g
, "disable")) {

112 
Œaû_ty³
[
SERVER_COMMAND_BUFFER_SIZE
];

113 iàĞ
	`ssÿnf
(
cmd
, "%* %* %s", 
Œaû_ty³
) < 1 ) {

114 
	`u§ge
();

115  (
SHELL_NEXT_CONTINUE
);

117 
	`di§bË
(
Œaû_ty³
);

118  (
SHELL_NEXT_CONTINUE
);

121 
	`TRACE
(
TRACE_ALWAYS
, "UÄecognizedag %s\n", 
g
);

122 
	`u§ge
();

123  (
SHELL_NEXT_CONTINUE
);

124 
	}
}

128 
	gŒaû_cmd_t
::
	$’abË
(cÚ¡ * 
ty³
)

130 
m­
<
c_¡r
, >::
™”©Ü
 
™
;

131 
™
 = 
_known_ty³s
.
	`begš
(); iˆ!ğ_known_ty³s.
	`’d
(); ++it) {

132 ià(!
	`¡rÿ£cmp
(
™
->
fœ¡
.
	`d©a
(), 
ty³
)) {

134 
mask
 = 
™
->
£cÚd
;

135 
	`TRACE_SET
(
	`TRACE_GET
(è| 
mask
);

136 
	`TRACE
(
TRACE_ALWAYS
, "EÇbËd %s\n", 
™
->
fœ¡
.
	`d©a
());

141 
	`TRACE
(
TRACE_ALWAYS
, "UnknowÀty³ %s\n", 
ty³
);

142 
	}
}

146 
	gŒaû_cmd_t
::
	$di§bË
(cÚ¡ * 
ty³
)

148 
m­
<
c_¡r
, >::
™”©Ü
 
™
;

149 
™
 = 
_known_ty³s
.
	`begš
(); iˆ!ğ_known_ty³s.
	`’d
(); ++it) {

150 ià(!
	`¡rÿ£cmp
(
™
->
fœ¡
.
	`d©a
(), 
ty³
)) {

152 
mask
 = 
™
->
£cÚd
;

153 
	`TRACE_SET
(
	`TRACE_GET
(è& (~
mask
));

154 
	`TRACE
(
TRACE_ALWAYS
, "Di§bËd %s\n", 
™
->
fœ¡
.
	`d©a
());

159 
	`TRACE
(
TRACE_ALWAYS
, "UnknowÀty³ %s\n", 
ty³
);

160 
	}
}

164 
	gŒaû_cmd_t
::
	$´št_known_ty³s
() {

166 
m­
<
c_¡r
, >::
™”©Ü
 
™
;

167 
™
 = 
_known_ty³s
.
	`begš
(); iˆ!ğ_known_ty³s.
	`’d
(); ++it) {

168 
	`TRACE
(
TRACE_ALWAYS
,

169 "Regi¡”ed¿ûy³ %s\n", 
™
->
fœ¡
.
	`d©a
());

171 
	}
}

175 
	gŒaû_cmd_t
::
	$´št_’abËd_ty³s
() {

177 
m­
<
c_¡r
, >::
™”©Ü
 
™
;

178 
™
 = 
_known_ty³s
.
	`begš
(); iˆ!ğ_known_ty³s.
	`’d
(); ++it) {

179 
mask
 = 
™
->
£cÚd
;

180 iàĞ
	`TRACE_GET
(è& 
mask
 )

181 
	`TRACE
(
TRACE_ALWAYS
, "EÇbËdy³ %s\n", 
™
->
fœ¡
.
	`d©a
());

183 
	}
}

187 
	gŒaû_cmd_t
::
	$u§ge
() {

188 
	`TRACE
(
TRACE_ALWAYS
, "trace known|list|enable <type>|disable <type>\n");

189 
	}
}

	@src/util/confparser.cpp

31 
	~"ut/cÚå¬£r.h
"

34 
	gCÚfigFe
::
	$CÚfigFe
Ğ
¡ršg
 
f’ame
, sŒšg 
d–im™”
,

35 
¡ršg
 
comm’t
, sŒšg 
£Áry
 )

36 : 
	`myD–im™”
(
d–im™”
), 
	`myComm’t
(
comm’t
), 
	`myS’Œy
(
£Áry
),

37 
	$_âame
(
f’ame
)

40 
¡d
::
if¡»am
 
	`š
Ğ
f’ame
.
	`c_¡r
() );

42 ifĞ!
š
 ) 
throw
 
	`fe_nÙ_found
Ğ
f’ame
 );

43 
š
 >> (*
this
);

44 
	}
}

47 
	gCÚfigFe
::
	$CÚfigFe
()

48 : 
	`myD–im™”
Ğ
	`¡ršg
(1,'='è), 
	`myComm’t
( string(1,'#') )

51 
	}
}

55 
	gCÚfigFe
::
	$§veCu¼’tCÚfig
()

57 
¡d
::
of¡»am
 
	`of
(
_âame
.
	`c_¡r
());

58 ià(!
of
è
throw
 
	`fe_nÙ_found
(
_âame
);

59 
of
 << (*
this
);

60 
	}
}

63 
	gCÚfigFe
::
	$»move
ĞcÚ¡ 
¡ršg
& 
key
 )

66 
myCÚ‹Ás
.
	`”a£
ĞmyCÚ‹Ás.
	`fšd
Ğ
key
 ) );

68 
	}
}

71 
boŞ
 
	gCÚfigFe
::
	$keyExi¡s
ĞcÚ¡ 
¡ršg
& 
key
 ) const

74 
m­ci
 
p
 = 
myCÚ‹Ás
.
	`fšd
Ğ
key
 );

75  ( 
p
 !ğ
myCÚ‹Ás
.
	`’d
() );

76 
	}
}

80 
	gCÚfigFe
::
	$Œim
Ğ
¡ršg
& 
s
 )

83 cÚ¡ 
wh™e¥aû
[] = " \n\t\v\r\f";

84 
s
.
	`”a£
Ğ0, s.
	`fšd_fœ¡_nÙ_of
(
wh™e¥aû
) );

85 
s
.
	`”a£
Ğs.
	`fšd_Ï¡_nÙ_of
(
wh™e¥aû
) + 1U );

86 
	}
}

89 
	g¡d
::
o¡»am
& 
İ”©Ü
<<Ğ
¡d
::o¡»am& 
os
, cÚ¡ 
	gCÚfigFe
& 
	gcf
 )

92  
	gCÚfigFe
::
m­ci
 
p
 = 
cf
.
myCÚ‹Ás
.
begš
();

93 
	gp
 !ğ
cf
.
myCÚ‹Ás
.
’d
();

94 ++
	gp
 )

96 
	gos
 << 
	gp
->
	gfœ¡
 << " " << 
	gcf
.
	gmyD–im™”
 << " ";

97 
	gos
 << 
	gp
->
	g£cÚd
 << 
	g¡d
::
’dl
;

99  
	gos
;

103 
	g¡d
::
i¡»am
& 
İ”©Ü
>>Ğ
¡d
::i¡»am& 
is
, 
	gCÚfigFe
& 
	gcf
 )

107 
	g¡ršg
::
	tsize_ty³
 
	tpos
;

108 cÚ¡ 
	g¡ršg
& 
	gd–im
 = 
cf
.
myD–im™”
;

109 cÚ¡ 
	g¡ršg
& 
	gcomm
 = 
cf
.
myComm’t
;

110 cÚ¡ 
	g¡ršg
& 
	g£Áry
 = 
cf
.
myS’Œy
;

111 cÚ¡ 
pos
 
	gsk
 = 
d–im
.
Ëngth
();

113 
¡ršg
 
	gÃxše
 = "";

115  
	gis
 || 
	gÃxše
.
Ëngth
() > 0 ) {

117 
¡ršg
 
	glše
;

118 ifĞ
	gÃxše
.
Ëngth
() > 0 )

120 
	glše
 = 
Ãxše
;

121 
	gÃxše
 = "";

125 
	g¡d
::
g‘lše
Ğ
is
, 
lše
 );

129 
	glše
 = 
lše
.
sub¡r
Ğ0,†še.
fšd
(
comm
) );

132 ifĞ
	g£Áry
 !ğ"" && 
lše
.
fšd
(
£Áry
è!ğ
¡ršg
::
Åos
 )  
is
;

135 
pos
 
	gd–imPos
 = 
lše
.
fšd
Ğ
d–im
 );

136 ifĞ
	gd–imPos
 < 
	g¡ršg
::
Åos
 ) {

138 
¡ršg
 
key
 = 
lše
.
sub¡r
Ğ0, 
d–imPos
 );

139 
	glše
.
»¶aû
Ğ0, 
d–imPos
+
sk
, "" );

144 
boŞ
 
	g‹rmš©e
 = 
çl£
;

145  !
	g‹rmš©e
 && 
	gis
 ) {

146 
	g¡d
::
g‘lše
Ğ
is
, 
Ãxše
 );

147 
	g‹rmš©e
 = 
Œue
;

149 
¡ršg
 
	gÆcİy
 = 
Ãxše
;

150 
	gCÚfigFe
::
Œim
(
Æcİy
);

151 ifĞ
	gÆcİy
 == "" ) ;

153 
	gÃxše
 = 
Ãxše
.
sub¡r
Ğ0,‚exše.
fšd
(
comm
) );

154 ifĞ
	gÃxše
.
fšd
(
d–im
è!ğ
¡ršg
::
Åos
 )

156 ifĞ
	g£Áry
 !ğ"" && 
Ãxše
.
fšd
(
£Áry
è!ğ
¡ršg
::
Åos
 )

159 
	gÆcİy
 = 
Ãxše
;

160 
	gCÚfigFe
::
Œim
(
Æcİy
);

161 ifĞ
	gÆcİy
 !ğ"" ) 
lše
 += "\n";

162 
	glše
 +ğ
Ãxše
;

163 
	g‹rmš©e
 = 
çl£
;

167 
	gCÚfigFe
::
Œim
(
key
);

168 
	gCÚfigFe
::
Œim
(
lše
);

169 
	gcf
.
	gmyCÚ‹Ás
[
key
] = 
lše
;

173  
	gis
;

	@src/util/countdown.cpp

31 
	~"ut/couÁdown.h
"

36 
	gcouÁdown_t
::
	$»£t
(cÚ¡ 
ÃwcouÁ
)

41 
_¡©e
 = 
ÃwcouÁ
*
CD_NUMBER
;

42 
	}
}

45 
boŞ


46 
	gcouÁdown_t
::
	$po¡
(
boŞ
 
is_”rÜ
)

48 
Şd_v®ue
 = *&
_¡©e
;

49 
Şd_v®ue
 >ğ2*
CD_NUMBER
) {

50 
Ãw_v®ue
 = (
is_”rÜ
? 
CD_ERROR
 : 
Şd_v®ue
-
CD_NUMBER
);

51 
cur_v®ue
 = 
	`©omic_ÿs_32
(&
_¡©e
, 
Şd_v®ue
, 
Ãw_v®ue
);

52 ià(
cur_v®ue
 =ğ
Şd_v®ue
) {

53 
	`as£¹
(
is_”rÜ
 || 
Ãw_v®ue
 >ğ
CD_NUMBER
);

54  (
is_”rÜ
);

58 
Şd_v®ue
 = 
cur_v®ue
;

62 ià(
Şd_v®ue
 =ğ
CD_ERROR
) {

63  (
çl£
);

67 
	`as£¹
(
Şd_v®ue
 =ğ
CD_NUMBER
);

68 
_¡©e
 = (
is_”rÜ
? 
CD_ERROR
 : 0);

69  (
Œue
);

70 
	}
}

72 
	gcouÁdown_t
::
	$»maššg
() const

74 
Şd_v®ue
 = *&
_¡©e
;

75  ((
Şd_v®ue
 =ğ
CD_ERROR
è? -1 : old_v®ue/
CD_NUMBER
);

76 
	}
}

	@src/util/envvar.cpp

32 
	~"ut/’vv¬.h
"

46 
¡ršg
 
	g’vV¬
::
	$_»adCÚfV¬
(cÚ¡ 
¡ršg
& 
sP¬am
, cÚ¡ sŒšg& 
sDefV®ue
)

48 ià(
sP¬am
.
	`em±y
()||
sDefV®ue
.empty()) {

49 
	`TRACE
Ğ
TRACE_ALWAYS
, "Invalid Param or Value input\n");

53 
	`w_as£¹2
 (
_på¬£r
);

54 
¡ršg
 
tmp
;

56 
_på¬£r
->
	`»adIÁo
(
tmp
,
sP¬am
,
sDefV®ue
);

58 
_evm
[
sP¬am
] = 
tmp
;

59 
	`TRACE
Ğ
TRACE_DEBUG
, "(%sè(%s)\n", 
sP¬am
.
	`c_¡r
(), 
tmp
.c_str());

60  (
tmp
);

61 
	}
}

66 
	g’vV¬
::
	$£tV¬
(cÚ¡ 
¡ršg
& 
sP¬am
, cÚ¡ sŒšg& 
sV®ue
)

68 ià((!
sP¬am
.
	`em±y
())&&(!
sV®ue
.empty())) {

69 
	`TRACE
Ğ
TRACE_DEBUG
, "(%sè(%s)\n", 
sP¬am
.
	`c_¡r
(), 
sV®ue
.c_str());

70 
	`CRITICAL_SECTION
(
evm_cs
,
_lock
);

71 
_evm
[
sP¬am
] = 
sV®ue
;

72  (
_evm
.
	`size
());

75 
	}
}

78 
	g’vV¬
::
	$£tV¬IÁ
(cÚ¡ 
¡ršg
& 
sP¬am
, cÚ¡ & 
iV®ue
)

80  (
	`£tV¬
(
sP¬am
,
	`_toSŒšg
(
iV®ue
)));

81 
	}
}

86 
	g’vV¬
::
	$»äeshV¬s
()

88 
	`TRACE
Ğ
TRACE_DEBUG
, "Refreshingƒnvironment variables\n");

89 
	`CRITICAL_SECTION
(
evm_cs
,
_lock
);

90 
’vV¬It
 
™
ğ
_evm
.
	`begš
(); iˆ!ğ_evm.
	`’d
(); ++it)

91 
	`_»adCÚfV¬
(
™
->
fœ¡
,™->
£cÚd
);

93 
	}
}

99 
¡ršg
 
	g’vV¬
::
	$g‘V¬
(cÚ¡ 
¡ršg
& 
sP¬am
, cÚ¡ sŒšg& 
sDefV®ue
)

101 ià(
sP¬am
.
	`em±y
()) {

102 
	`TRACE
Ğ
TRACE_ALWAYS
, "Invalid Param input\n");

106 
	`CRITICAL_SECTION
(
evm_cs
,
_lock
);

107 
’vV¬It
 
™
 = 
_evm
.
	`fšd
(
sP¬am
);

108 ià(
™
==
_evm
.
	`’d
()) {

110  (
	`_»adCÚfV¬
(
sP¬am
,
sDefV®ue
));

112  (
™
->
£cÚd
);

113 
	}
}

115 
	g’vV¬
::
	$g‘V¬IÁ
(cÚ¡ 
¡ršg
& 
sP¬am
, cÚ¡ & 
iDefV®ue
)

117  (
	`©oi
(
	`g‘V¬
(
sP¬am
,
	`_toSŒšg
(
iDefV®ue
)).
	`c_¡r
()));

118 
	}
}

120 
	g’vV¬
::
	$g‘V¬DoubË
(cÚ¡ 
¡ršg
& 
sP¬am
, cÚ¡ & 
iDefV®ue
)

122 * 
’dp
;

123 
d
;

124 
¡ršg
 
r
 = 
	`g‘V¬
(
sP¬am
,
	`_toSŒšg
(
iDefV®ue
));

125 
d
 = 
	`¡¹od
(
r
.
	`c_¡r
(), &
’dp
);

126  (
d
);

127 
	}
}

131 
	g’vV¬
::
	$checkV¬
(cÚ¡ 
¡ršg
& 
sP¬am
)

133 
¡ršg
 
r
;

134 
	`CRITICAL_SECTION
(
evm_cs
,
_lock
);

136 
’vV¬It
 
™
 = 
_evm
.
	`fšd
(
sP¬am
);

137 ià(
™
!=
_evm
.
	`’d
()) {

138 
r
 = 
™
->
£cÚd
 + " (map)";

142 
	`w_as£¹2
 (
_på¬£r
);

143 ià(
_på¬£r
->
	`keyExi¡s
(
sP¬am
)) {

144 
_på¬£r
->
	`»adIÁo
(
r
,
sP¬am
,
	`¡ršg
("Not found"));

145 
r
 =„ + " (conf)";

148 
r
 = 
	`¡ršg
("Not found");

151 
	`TRACE
Ğ
TRACE_ALWAYS
, "% -> %s\n", 
sP¬am
.
	`c_¡r
(), 
r
.c_str());

152 
	}
}

161 
¡ršg
 
	g’vV¬
::
	$g‘SysName
()

163 
¡ršg
 
sysName
 = "system";

164  (
	`g‘SysV¬
(
sysName
));

165 
	}
}

167 
	g’vV¬
::
	$£tSysName
(cÚ¡ 
¡ršg
& 
sysName
)

169 
¡ršg
 
cÚfigsys
 = 
	`g‘V¬
("db-config","invalid");

170 
cÚfigsys
 = configsys + "-system";

171  (
	`£tV¬
(
cÚfigsys
,
sysName
));

172 
	}
}

174 
¡ršg
 
	g’vV¬
::
	$g‘SysDesign
()

176 
¡ršg
 
sysDesign
 = "design";

177  (
	`g‘SysV¬
(
sysDesign
));

178 
	}
}

180 
	g’vV¬
::
	$£tSysDesign
(cÚ¡ 
¡ršg
& 
sysDesign
)

182 
¡ršg
 
cÚfigsys
 = 
	`g‘V¬
("db-config","invalid");

183 
cÚfigsys
 = configsys + "-design";

184  (
	`£tV¬
(
cÚfigsys
,
sysDesign
));

185 
	}
}

187 
¡ršg
 
	g’vV¬
::
	$g‘SysV¬
(
¡ršg
 
sP¬am
)

189 
¡ršg
 
cÚfig
 = 
	`g‘V¬
("db-config","invalid");

190 
cÚfig
 = cÚfig + "-" + 
sP¬am
;

191  (
	`g‘V¬
(
cÚfig
,"invalid"));

192 
	}
}

195 
	g’vV¬
::
	$g‘SysV¬IÁ
(
¡ršg
 
sP¬am
)

197 
¡ršg
 
cÚfig
 = 
	`g‘V¬
("db-config","invalid");

198 
cÚfig
 = cÚfig + "-" + 
sP¬am
;

199  (
	`g‘V¬IÁ
(
cÚfig
,0));

200 
	}
}

202 
	g’vV¬
::
	$g‘SysV¬DoubË
(
¡ršg
 
sP¬am
)

204 
¡ršg
 
cÚfig
 = 
	`g‘V¬
("db-config","invalid");

205 
cÚfig
 = cÚfig + "-" + 
sP¬am
;

206  (
	`g‘V¬DoubË
(
cÚfig
,0.0));

207 
	}
}

210 
	g’vV¬
::
	$£tCÚfigu¿tiÚ
(
¡ršg
 
sCÚfigu¿tiÚ
)

212  (
	`£tV¬
("db-cÚfig",
sCÚfigu¿tiÚ
));

213 
	}
}

217 
	g’vV¬
::
	$´štV¬s
()

219 
	`TRACE
Ğ
TRACE_DEBUG
, "Environment variables\n");

220 
	`CRITICAL_SECTION
(
evm_cs
,
_lock
);

221 
’vV¬CÚ¡It
 
c™
ğ
_evm
.
	`begš
(); c™ !ğ_evm.
	`’d
(); ++cit)

222 
	`TRACE
Ğ
TRACE_STATISTICS
, "% -> %s\n", 
c™
->
fœ¡
.
	`c_¡r
(), c™->
£cÚd
.c_str());

223 
	}
}

228 
	g’vV¬
::
	$£tCÚfFe
(cÚ¡ 
¡ršg
& 
sCÚfFe
)

230 
	`w_as£¹0
 (!
sCÚfFe
.
	`em±y
());

231 
	`CRITICAL_SECTION
(
evm_cs
,
_lock
);

232 
_câame
 = 
sCÚfFe
;

233 
_på¬£r
 = 
Ãw
 
	`CÚfigFe
(
_câame
);

234 
	`w_as£¹0
 (
_på¬£r
);

235 
	}
}

237 
¡ršg
 
	g’vV¬
::
	$g‘CÚfFe
() const

239  (
_câame
);

240 
	}
}

244 
	g’vV¬
::
	$·r£OÃS‘Req
(cÚ¡ 
¡ršg
& 
š
)

246 
¡ršg
 
·¿m
;

247 
¡ršg
 
v®ue
;

248 
v®ue£p
 = '=';

250 
size_t
 
£pos
 = 
š
.
	`fšd
(
v®ue£p
);

251 if(
£pos
 =ğ
¡ršg
::
Åos
) {

252 
	`TRACE
Ğ
TRACE_DEBUG
, "(%sèi m®fÜmed\n", 
š
.
	`c_¡r
());

255 
·¿m
 = 
š
.
	`sub¡r
(0, 
£pos
);

256 
v®ue
 = 
š
.
	`sub¡r
(
£pos
+1);

257 ià(
v®ue
.
	`em±y
()) {

258 
	`TRACE
Ğ
TRACE_DEBUG
, "(%sèi m®fÜmed\n", 
š
.
	`c_¡r
());

261 
	`TRACE
Ğ
TRACE_DEBUG
, "% -> %s\n", 
·¿m
.
	`c_¡r
(), 
v®ue
.c_str());

262 
	`CRITICAL_SECTION
(
evm_cs
,
_lock
);

263 
_evm
[
·¿m
] = 
v®ue
;

265 
	}
}

270 
	g’vV¬
::
	$·r£S‘Req
(cÚ¡ 
¡ršg
& 
š
)

272 
út
=0;

275 
şau££p
 = ' ';

276 
size_t
 
¡¬t
 = 
š
.
	`fšd
(
şau££p
);

277 
size_t
 
’d
;

278 ; 
¡¬t
 !ğ
¡ršg
::
Åos
; s¹=
’d
) {

279 
¡¬t
++;

280 
’d
 = 
š
.
	`fšd
(
şau££p
, 
¡¬t
);

281 
	`·r£OÃS‘Req
(
š
.
	`sub¡r
(
¡¬t
, 
’d
-start));

282 ++
út
;

284  (
út
);

285 
	}
}

	@src/util/fileops.cpp

36 
	~"ut/feİs.h
"

38 
	~<¡dio.h
>

39 
	~<¡dlib.h
>

40 
	~<¡ršg.h
>

41 
	~<as£¹.h
>

42 
	~<sys/ty³s.h
>

43 
	~<sys/¡©.h
>

44 
	~<uni¡d.h
>

46 
	~"ut/Œaû.h
"

47 
	~"ut/gu¬d.h
"

53 
	#MAX_PATH_SIZE
 1024

	)

59 
	#GET_USER_ID
(è
	`g‘uid
()

	)

60 
	#GET_GROUP_ID
(è
	`g‘gid
()

	)

66 
_is_dœeùÜy
(cÚ¡ 
¡©
* 
buf
);

67 
_is_»adabË
(cÚ¡ 
¡©
* 
buf
, 
uid_t
 
uid
, uid_ˆ
gid
);

68 
_is_wr™—bË
(cÚ¡ 
¡©
* 
buf
, 
uid_t
 
uid
, uid_ˆ
gid
);

69 
_is_execubË
(cÚ¡ 
¡©
* 
buf
, 
uid_t
 
uid
, uid_ˆ
gid
);

70 
_’ds_w™h
(cÚ¡ * 
¡r
, cÚ¡ * 
’dšg
);

71 
_¡Üe
(* 
d¡
, 
d¡_size
, cÚ¡ * 
¤c
);

77 cÚ¡ 
	gdebug_Œaû_ty³
 = 
TRACE_DEBUG
;

78 
	#DEBUG_TRACE
(
fÜm©
, 
¬g
è
	`TRACE
(
debug_Œaû_ty³
, fÜm©,‡rg)

	)

92 
	$feİs_check_fe_exi¡s
(cÚ¡ * 
·th
)

94 
¡©
 
buf
;

95 
¡©_»t
 = 
	`¡©
(
·th
, &
buf
);

96 ià(
¡©_»t
 != 0) {

97 
	`DEBUG_TRACE
("¡©(%s, ...èçed\n", 
·th
);

98  
FILEOPS_ERROR_NOT_FOUND
;

102 
	}
}

113 
	$feİs_check_fe_dœeùÜy
(cÚ¡ * 
·th
)

115 
¡©
 
buf
;

116 
¡©_»t
 = 
	`¡©
(
·th
, &
buf
);

117 ià(
¡©_»t
 != 0) {

118 
	`DEBUG_TRACE
("¡©(%s, ...èçed\n", 
·th
);

119  
FILEOPS_ERROR_NOT_FOUND
;

122 ià(
	`_is_dœeùÜy
(&
buf
))

125  
FILEOPS_ERROR_NOT_DIRECTORY
;

126 
	}
}

137 
	$feİs_check_fe_»adabË
(cÚ¡ * 
·th
)

139 
¡©
 
buf
;

140 
¡©_»t
 = 
	`¡©
(
·th
, &
buf
);

141 ià(
¡©_»t
 != 0) {

142 
	`DEBUG_TRACE
("¡©(%s, ...èçed\n", 
·th
);

143  
FILEOPS_ERROR_NOT_FOUND
;

146 
uid_t
 
uid
 = 
	`GET_USER_ID
();

147 
uid_t
 
gid
 = 
	`GET_GROUP_ID
();

148 ià(
	`_is_»adabË
(&
buf
, 
uid
, 
gid
))

151  
FILEOPS_ERROR_PERMISSION_DENIED
;

152 
	}
}

163 
	$feİs_check_fe_wr™—bË
(cÚ¡ * 
·th
)

165 
¡©
 
buf
;

166 
¡©_»t
 = 
	`¡©
(
·th
, &
buf
);

167 ià(
¡©_»t
 != 0) {

168 
	`DEBUG_TRACE
("¡©(%s, ...èçed\n", 
·th
);

169  
FILEOPS_ERROR_NOT_FOUND
;

172 
uid_t
 
uid
 = 
	`GET_USER_ID
();

173 
uid_t
 
gid
 = 
	`GET_GROUP_ID
();

174 ià(
	`_is_wr™—bË
(&
buf
, 
uid
, 
gid
))

177  
FILEOPS_ERROR_PERMISSION_DENIED
;

178 
	}
}

189 
	$feİs_check_fe_execubË
(cÚ¡ * 
·th
)

191 
¡©
 
buf
;

192 
¡©_»t
 = 
	`¡©
(
·th
, &
buf
);

193 ià(
¡©_»t
 != 0) {

194 
	`DEBUG_TRACE
("¡©(%s, ...èçed\n", 
·th
);

195  
FILEOPS_ERROR_NOT_FOUND
;

198 
uid_t
 
uid
 = 
	`GET_USER_ID
();

199 
uid_t
 
gid
 = 
	`GET_GROUP_ID
();

200 ià(
	`_is_execubË
(&
buf
, 
uid
, 
gid
))

203  
FILEOPS_ERROR_PERMISSION_DENIED
;

204 
	}
}

215 
	$feİs_check_dœeùÜy_acûssibË
(cÚ¡ * 
·th
)

217 
¡©
 
buf
;

218 
¡©_»t
 = 
	`¡©
(
·th
, &
buf
);

219 ià(
¡©_»t
 != 0) {

220 
	`DEBUG_TRACE
("¡©(%s, ...èçed\n", 
·th
);

221  
FILEOPS_ERROR_NOT_FOUND
;

224 ià(!
	`_is_dœeùÜy
(&
buf
))

225  
FILEOPS_ERROR_NOT_DIRECTORY
;

227 
uid_t
 
uid
 = 
	`GET_USER_ID
();

228 
uid_t
 
gid
 = 
	`GET_GROUP_ID
();

229 ià(
	`_is_»adabË
(&
buf
, 
uid
, 
gid
è&& 
	`_is_execubË
(&buf, uid, gid))

232  
FILEOPS_ERROR_PERMISSION_DENIED
;

233 
	}
}

247 
	$feİs_check_fe_ü—bË
(cÚ¡ * 
·th
)

249 
¡©
 
fbuf
;

250 
¡©_»t_f
 = 
	`¡©
(
·th
, &
fbuf
);

251 ià(
¡©_»t_f
 == 0)

254 
uid_t
 
uid
 = 
	`GET_USER_ID
();

255 
uid_t
 
gid
 = 
	`GET_GROUP_ID
();

256 ià(
	`_is_wr™—bË
(&
fbuf
, 
uid
, 
gid
))

259  
FILEOPS_ERROR_PERMISSION_DENIED
;

264 
size
 = 
	`¡¾’
(
·th
)+1;

265 ià(
size
 > 
MAX_PATH_SIZE
)

266  
FILEOPS_ERROR_PATH_TOO_LONG
;

269 
¬¿y_gu¬d_t
<> 
·»Á_dœ
 = 
Ãw
 [
size
];

270 
»t
 = 
	`feİs_·r£_·»Á_dœeùÜy
(
·»Á_dœ
, 
size
, 
·th
);

271 
	`as£¹
((
»t
 =ğ0è|| (»ˆ=ğ
FILEOPS_ERROR_PATH_TOO_LONG
));

272 ià(
»t
 =ğ
FILEOPS_ERROR_PATH_TOO_LONG
)

273  
FILEOPS_ERROR_PATH_TOO_LONG
;

276 
¡©
 
pbuf
;

277 
¡©_»t_p
 = 
	`¡©
(
·»Á_dœ
, &
pbuf
);

278 ià(
¡©_»t_p
 != 0)

280  
FILEOPS_ERROR_PERMISSION_DENIED
;

283 
uid_t
 
uid
 = 
	`GET_USER_ID
();

284 
uid_t
 
gid
 = 
	`GET_GROUP_ID
();

285 ià(
	`_is_wr™—bË
(&
pbuf
, 
uid
, 
gid
))

288  
FILEOPS_ERROR_PERMISSION_DENIED
;

290 
	}
}

306 
	$feİs_·r£_·»Á_dœeùÜy
(* 
d¡
, 
d¡_size
, cÚ¡ * 
¤c
)

313 
¤c_Ën
 = 
	`¡¾’
(
¤c
);

314 
size
 = 
¤c_Ën
+1;

315 ià(
size
 > 
d¡_size
)

316  
FILEOPS_ERROR_PATH_TOO_LONG
;

322 
	`_’ds_w™h
(
¤c
, src);

326 
¦ash_pos
;

327 
¦ash_pos
 = 
¤c_Ën
-1; slash_pos >= 0; slash_pos--)

328 ià(
¤c
[
¦ash_pos
] == '/')

331 ià(
¦ash_pos
 >= 0)

340 
	`¡ºıy
(
d¡
, 
¤c
, 
¦ash_pos
+1);

341 
d¡
[
¦ash_pos
+1] = '\0';

348 ià(!
	`¡rcmp
(
¤c
, "."))

349  
	`_¡Üe
(
d¡
, 
d¡_size
, "../");

351 ià(!
	`¡rcmp
(
¤c
, ".."))

352  
	`_¡Üe
(
d¡
, 
d¡_size
, "../../");

354  
	`_¡Üe
(
d¡
, 
d¡_size
, "./");

355 
	}
}

363 
	$_is_dœeùÜy
(cÚ¡ 
¡©
* 
buf
)

365  
	`S_ISDIR
(
buf
->
¡_mode
);

366 
	}
}

369 
	$_is_»adabË
(cÚ¡ 
¡©
* 
buf
, 
uid_t
 
uid
, uid_ˆ
gid
)

372 (
buf
->
¡_mode
 & 
S_IROTH
)

373 || ((
buf
->
¡_mode
 & 
S_IRGRP
è&& (buf->
¡_gid
 =ğ
gid
))

374 || ((
buf
->
¡_mode
 & 
S_IRUSR
è&& (buf->
¡_uid
 =ğ
uid
));

375 
	}
}

378 
	$_is_wr™—bË
(cÚ¡ 
¡©
* 
buf
, 
uid_t
 
uid
, uid_ˆ
gid
)

381 (
buf
->
¡_mode
 & 
S_IWOTH
)

382 || ((
buf
->
¡_mode
 & 
S_IWGRP
è&& (buf->
¡_gid
 =ğ
gid
))

383 || ((
buf
->
¡_mode
 & 
S_IWUSR
è&& (buf->
¡_uid
 =ğ
uid
));

384 
	}
}

387 
	$_is_execubË
(cÚ¡ 
¡©
* 
buf
, 
uid_t
 
uid
, uid_ˆ
gid
)

390 (
buf
->
¡_mode
 & 
S_IXOTH
)

391 || ((
buf
->
¡_mode
 & 
S_IXGRP
è&& (buf->
¡_gid
 =ğ
gid
))

392 || ((
buf
->
¡_mode
 & 
S_IXUSR
è&& (buf->
¡_uid
 =ğ
uid
));

393 
	}
}

396 
	$_’ds_w™h
(cÚ¡ * 
¡r
, cÚ¡ * 
’dšg
)

398 
¡r_Ën
 = 
	`¡¾’
(
¡r
);

399 
’dšg_Ën
 = 
	`¡¾’
(
’dšg
);

402 ià(
’dšg_Ën
 > 
¡r_Ën
)

405 
¡r_pos
 = 
¡r_Ën
-1;

406 
’dšg_pos
 = 
’dšg_Ën
-1;

408 
’dšg_pos
 >= 0)

410 ià(
’dšg
[
’dšg_pos
] !ğ
¡r
[
¡r_pos
])

412 
¡r_pos
--;

413 
’dšg_pos
--;

418 
	}
}

421 
	$_¡Üe
(* 
d¡
, 
d¡_size
, cÚ¡ * 
¤c
)

423 
¤c_Ën
 = 
	`¡¾’
(
¤c
);

424 ià((
¤c_Ën
+1è> 
d¡_size
)

425  
FILEOPS_ERROR_PATH_TOO_LONG
;

426 
	`¡ºıy
(
d¡
, 
¤c
, 
¤c_Ën
);

427 
d¡
[
¤c_Ën
] = '\0';

429 
	}
}

	@src/util/fnv.cpp

57 
	~"ut/âv.h
"

63 
	#FNV_32_PRIME
 ((
ušt32_t
)0x01000193)

	)

81 
ušt32_t


82 
	$âv_hash
(cÚ¡ *
bp
, 
size_t
 
Ën
, 
ušt32_t
 
hv®
)

84 cÚ¡ *
be
 = 
bp
 + 
Ën
;

89 
bp
 < 
be
) {

92 
hv®
 ^ğ(
ušt32_t
)*
bp
++;

95 #ià
	`defšed
(
NO_FNV_GCC_OPTIMIZATION
)

96 
hv®
 *ğ
FNV_32_PRIME
;

98 
hv®
 += (hval<<1) + (hval<<4) + (hval<<7) + (hval<<8) + (hval<<24);

103  
hv®
;

104 
	}
}

115 
šlše


116 
ušt32_t
 
	$mix
(
v®
, 
ušt32_t
 
hv®
) {

117 
hv®
 ^ğ(
ušt32_t
è
v®
;

118 
hv®
 += (hval<<1) + (hval<<4) + (hval<<7) + (hval<<8) + (hval<<24);

119  
hv®
;

120 
	}
}

122 
ušt32_t


123 
	$âv_hash
(cÚ¡ *
bp
, 
size_t
 
Ën
, 
ušt32_t
 
hv®
)

126 cÚ¡ *
be
 = 
bp
 + 
Ën
 - 8;

131 
bp
 -ğ8 - (
Ën
 % 8);

135 
Ën
 % 8) {

141 
bp
 += 8;

142 
hv®
 = 
	`mix
(
bp
[0], hval);

144 
hv®
 = 
	`mix
(
bp
[1], hval);

146 
hv®
 = 
	`mix
(
bp
[2], hval);

148 
hv®
 = 
	`mix
(
bp
[3], hval);

150 
hv®
 = 
	`mix
(
bp
[4], hval);

152 
hv®
 = 
	`mix
(
bp
[5], hval);

154 
hv®
 = 
	`mix
(
bp
[6], hval);

156 
hv®
 = 
	`mix
(
bp
[7], hval);

157 } 
bp
 < 
be
);

161  
hv®
;

162 
	}
}

167 
	$maš
() {

168 
ušt32_t
 
hash
 = 
FNV_INIT
;

169 
i
[2];

170 *
i
=0; *i < (1 << 28); ++*i)

171 
hash
 ^ğ
	`âv_hash
((*è&
i
, (i), hash);

174 
	}
}

	@src/util/hash_functions.cpp

2 
	~"ut/hash_funùiÚs.h
"

6 
	$RSHash
(cÚ¡ * 
¡r
, 
Ën
)

8 
b
 = 378551;

9 
a
 = 63689;

10 
hash
 = 0;

11 
i
 = 0;

13 
i
 = 0; i < 
Ën
; 
¡r
++, i++)

15 
hash
 = hash * 
a
 + (*
¡r
);

16 
a
 =‡ * 
b
;

19  (
hash
 & 0x7FFFFFFF);

20 
	}
}

25 
	$JSHash
(cÚ¡ * 
¡r
, 
Ën
)

27 
hash
 = 1315423911;

28 
i
 = 0;

30 
i
 = 0; i < 
Ën
; 
¡r
++, i++)

32 
hash
 ^ğ((hash << 5è+ (*
¡r
) + (hash >> 2));

35  (
hash
 & 0x7FFFFFFF);

36 
	}
}

41 
	$PJWHash
(cÚ¡ * 
¡r
, 
Ën
)

43 
B™sInUnsigÃdIÁ
 = ()(() * 8);

44 
Th»eQu¬‹rs
 = ()((
B™sInUnsigÃdIÁ
 * 3) / 4);

45 
OÃEighth
 = ()(
B™sInUnsigÃdIÁ
 / 8);

46 
HighB™s
 = ()(0xFFFFFFFFè<< (
B™sInUnsigÃdIÁ
 - 
OÃEighth
);

47 
hash
 = 0;

48 
‹¡
 = 0;

49 
i
 = 0;

51 
i
 = 0; i < 
Ën
; 
¡r
++, i++)

53 
hash
 = (hash << 
OÃEighth
è+ (*
¡r
);

55 if((
‹¡
 = 
hash
 & 
HighB™s
) != 0)

57 
hash
 = (Ğhash ^ (
‹¡
 >> 
Th»eQu¬‹rs
)è& (~
HighB™s
));

61  (
hash
 & 0x7FFFFFFF);

62 
	}
}

67 
	$ELFHash
(cÚ¡ * 
¡r
, 
Ën
)

69 
hash
 = 0;

70 
x
 = 0;

71 
i
 = 0;

73 
i
 = 0; i < 
Ën
; 
¡r
++, i++)

75 
hash
 = (hash << 4è+ (*
¡r
);

76 if((
x
 = 
hash
 & 0xF0000000L) != 0)

78 
hash
 ^ğ(
x
 >> 24);

79 
hash
 &ğ~
x
;

83  (
hash
 & 0x7FFFFFFF);

84 
	}
}

89 
	$BKDRHash
(cÚ¡ * 
¡r
, 
Ën
)

91 
£ed
 = 131;

92 
hash
 = 0;

93 
i
 = 0;

95 
i
 = 0; i < 
Ën
; 
¡r
++, i++)

97 
hash
 = (hash * 
£ed
è+ (*
¡r
);

100  (
hash
 & 0x7FFFFFFF);

101 
	}
}

106 
	$SDBMHash
(cÚ¡ * 
¡r
, 
Ën
)

108 
hash
 = 0;

109 
i
 = 0;

111 
i
 = 0; i < 
Ën
; 
¡r
++, i++)

113 
hash
 = (*
¡r
) + (hash << 6) + (hash << 16) - hash;

116  (
hash
 & 0x7FFFFFFF);

117 
	}
}

122 
	$DJBHash
(cÚ¡ * 
¡r
, 
Ën
)

124 
hash
 = 5381;

125 
i
 = 0;

127 
i
 = 0; i < 
Ën
; 
¡r
++, i++)

129 
hash
 = ((hash << 5è+ hashè+ (*
¡r
);

132  (
hash
 & 0x7FFFFFFF);

133 
	}
}

138 
	$DEKHash
(cÚ¡ * 
¡r
, 
Ën
)

140 
hash
 = 
Ën
;

141 
i
 = 0;

143 
i
 = 0; i < 
Ën
; 
¡r
++, i++)

145 
hash
 = ((hash << 5è^ (hash >> 27)è^ (*
¡r
);

147  (
hash
 & 0x7FFFFFFF);

148 
	}
}

153 
	$APHash
(cÚ¡ * 
¡r
, 
Ën
)

155 
hash
 = 0;

156 
i
 = 0;

158 
i
 = 0; i < 
Ën
; 
¡r
++, i++)

160 
hash
 ^ğ((
i
 & 1è=ğ0è? ( (hash << 7è^ (*
¡r
) ^ (hash >> 3)) :

161 (~((
hash
 << 11è^ (*
¡r
) ^ (hash >> 5)));

164  (
hash
 & 0x7FFFFFFF);

165 
	}
}

	@src/util/history.cpp

24 
	~"ut/c_¡r.h
"

25 
	~"ut/Œaû.h
"

27 
	~"k_defšes.h
"

28 
	~"ut/cÚfig.h
"

33 #ifdeà
HAVE_READLINE


36 
	~<sys/¡©.h
>

37 
	~<sys/ty³s.h
>

38 
	~<fú.h
>

39 
	~<”ºo.h
>

40 
	~<uni¡d.h
>

41 
	~<»adlše/hi¡Üy.h
>

45 
boŞ
 
’su»_sş›Á_dœeùÜy_exi¡s
();

46 
boŞ
 
Œy_hi¡Üy_lßd
();

47 
boŞ
 
hi¡Üy_§ve
();

59 
boŞ
 
	$hi¡Üy_İ’
() {

61 ià(!
	`’su»_sş›Á_dœeùÜy_exi¡s
())

62  
çl£
;

64 ià(!
	`Œy_hi¡Üy_lßd
())

65  
çl£
;

67  
Œue
;

68 
	}
}

72 
boŞ
 
	$hi¡Üy_şo£
() {

74 ià(!
	`hi¡Üy_§ve
())

75  
çl£
;

77  
Œue
;

78 
	}
}

82 
boŞ
 
	$’su»_sş›Á_dœeùÜy_exi¡s
() {

84 * 
home_dœeùÜy
 = 
	`g‘’v
("HOME");

85 ià(
home_dœeùÜy
 =ğ
NULL
) {

86 
	`TRACE
(
TRACE_ALWAYS
,

88  
çl£
;

91 
c_¡r
 
	`sş›Á_dœeùÜy
("%s/%s", 
home_dœeùÜy
, 
SCLIENT_DIRECTORY_NAME
);

93 
mkdœ_»t
 = 
	`mkdœ
(
sş›Á_dœeùÜy
.
	`d©a
(), 
S_IRWXU
);

94 ià((
mkdœ_»t
 !ğ0è&& (
”ºo
 !ğ
EEXIST
)) {

95 
	`TRACE
(
TRACE_ALWAYS
, "Could‚ot create SCLIENT config directory %s\n",

96 
sş›Á_dœeùÜy
.
	`d©a
());

97  
çl£
;

100  
Œue
;

101 
	}
}

105 
boŞ
 
	$Œy_hi¡Üy_lßd
() {

107 * 
home_dœeùÜy
 = 
	`g‘’v
("HOME");

108 ià(
home_dœeùÜy
 =ğ
NULL
) {

109 
	`TRACE
(
TRACE_ALWAYS
,

111  
çl£
;

114 
c_¡r
 
	`sş›Á_hi¡Üy_fe
("%s/%s/%s",

115 
home_dœeùÜy
,

116 
SCLIENT_DIRECTORY_NAME
,

117 
SCLIENT_HISTORY_FILE
);

119 
İ’_»t
 = 
	`İ’
(
sş›Á_hi¡Üy_fe
.
	`d©a
(), 
O_CREAT
|
O_RDWR
, 
S_IRUSR
|
S_IWUSR
);

120 ià(
İ’_»t
 == -1) {

121 
	`TRACE
(
TRACE_ALWAYS
, "Could‚ot open SCLIENT history file %s\n",

122 
sş›Á_hi¡Üy_fe
.
	`d©a
());

123  
çl£
;

125 
	`şo£
(
İ’_»t
);

127 iàĞ
	`»ad_hi¡Üy
(
sş›Á_hi¡Üy_fe
.
	`d©a
()) ) {

128 
	`TRACE
(
TRACE_ALWAYS
, "Could‚ot„ead SCLIENT history file %s\n",

129 
sş›Á_hi¡Üy_fe
.
	`d©a
());

130  
çl£
;

133  
Œue
;

134 
	}
}

138 
boŞ
 
	$hi¡Üy_§ve
() {

140 * 
home_dœeùÜy
 = 
	`g‘’v
("HOME");

141 ià(
home_dœeùÜy
 =ğ
NULL
) {

142 
	`TRACE
(
TRACE_ALWAYS
,

144  
çl£
;

147 
c_¡r
 
	`sş›Á_hi¡Üy_fe
("%s/%s/%s",

148 
home_dœeùÜy
,

149 
SCLIENT_DIRECTORY_NAME
,

150 
SCLIENT_HISTORY_FILE
);

152 iàĞ
	`wr™e_hi¡Üy
(
sş›Á_hi¡Üy_fe
.
	`d©a
()) ) {

153 
	`TRACE
(
TRACE_ALWAYS
, "Could‚ot write SCLIENT history file %s\n",

154 
sş›Á_hi¡Üy_fe
.
	`d©a
());

155  
çl£
;

159  
Œue
;

160 
	}
}

	@src/util/linux_procstat.cpp

32 
	~"ut/lšux_´oc¡©.h
"

37 
	glšux_´ocmÚ™Ü_t
::
	$lšux_´ocmÚ™Ü_t
(
shÜe
::
ShÜeEnv
* 
’v
,

38 cÚ¡ 
š‹rv®_£c
)

39 : 
	`´ocmÚ™Ü_t
("lšux-mÚ",
’v
,
š‹rv®_£c
)

41 
	`_£tup
(
š‹rv®_£c
);

42 
	}
}

45 
	glšux_´ocmÚ™Ü_t
::~
	$lšux_´ocmÚ™Ü_t
()

47 
	}
}

50 
lšux_´ocmÚ™Ü_t
::
	$_£tup
(cÚ¡ 
š‹rv®_£c
)

52 
´ocmÚ™Ü_t
::
	`_£tup
(
š‹rv®_£c
);

53 
	}
}

58 
	glšux_´ocmÚ™Ü_t
::
	$g‘_avg_u§ge
(
boŞ
 
bUpd©eR—dšg
)

61  (
_tİšfo
.
	`g‘_avg_u§ge
(
bUpd©eR—dšg
));

62 
	}
}

64 
	glšux_´ocmÚ™Ü_t
::
	$´št_avg_u§ge
()

66 
_tİšfo
.
	`´št_avg_u§ge
();

67 
	}
}

69 
	glšux_´ocmÚ™Ü_t
::
	$´št_ext_¡©s
()

71 
_tİšfo
.
	`´št_¡©s
();

72 
	}
}

74 
ulÚg_t
 
	glšux_´ocmÚ™Ü_t
::
	$ioch¬s
()

76  (
_tİšfo
.
	`ioch¬s
());

77 
	}
}

79 
	glšux_´ocmÚ™Ü_t
::
	$¡©_»£t
()

81 
_tİšfo
.
	`»£t
();

82 
	}
}

84 
ušt
 
	glšux_´ocmÚ™Ü_t
::
	$g‘_num_of_ıus
()

86  (
_tİšfo
.
	`g‘_num_of_ıus
());

87 
	}
}

89 
ıu_lßd_v®ues_t
 
	glšux_´ocmÚ™Ü_t
::
	$g‘_lßd
()

91  (
_tİšfo
.
	`g‘_lßd
());

92 
	}
}

	@src/util/pool_alloc.cpp

24 
	~"ut/poŞ_®loc.h
"

25 
	~"ut/sync.h
"

27 
	~"k_defšes.h
"

29 
	~<Ãw
>

30 
	~<veùÜ
>

33 #ifdeà
DEBUG_ALLOC


34 
	~<c¡dio
>

35 
usšg
 
Çme¥aû
 
	g¡d
;

38 #undeà
TRACK_LEAKS


41 #undeà
TRACE_LEAKS


42 #undeà
TRACK_BLOCKS


45 
	gÇme¥aû
 {

49 
	g¡d
::
	tveùÜ
<
	tpoŞ_®loc
*> 
	tpoŞ_li¡
;

51 "C" 
d–‘e_poŞ_li¡
(* 
¬g
) {

52 
poŞ_li¡
* 
¶
 = (poŞ_li¡*è
¬g
;

53 if(!
¶
)

55 
ušt
 
i
=0; i < 
¶
->
size
(); i++)

56 
d–‘e
 
¶
->
©
(
i
);

58 
d–‘e
 
¶
;

61 
	ss_th»ad_loÿl_poŞs
 {

62 
±h»ad_key_t
 
±key
;

63 
š™
() {

65 
boŞ
 
š™Ÿlized
 = 
çl£
;

66 if(
š™Ÿlized
)

69 
”r
 = 
±h»ad_key_ü—‹
(&
±key
, 
d–‘e_poŞ_li¡
);

70 
as£¹
(!
”r
);

71 
š™Ÿlized
 = 
Œue
;

73 
İ”©Ü
 
poŞ_li¡
*(è{  
g‘
(); }

74 
poŞ_li¡
* 
İ”©Ü
->(è{  
g‘
(); }

75 
poŞ_li¡
* 
g‘
() {

76 
poŞ_li¡
* 
±r
 = (poŞ_li¡*è
±h»ad_g‘¥ecific
(
±key
);

77 if(!
±r
)

78 
±h»ad_£t¥ecific
(
±key
, 
±r
 = 
Ãw
 
poŞ_li¡
);

80  
±r
;

82 } 
th»ad_loÿl_poŞs
;

86 
	g¡©ic_š™Ÿlize_poŞ_®loc
::
	$¡©ic_š™Ÿlize_poŞ_®loc
() {

87 
th»ad_loÿl_poŞs
.
	`š™
();

88 
	}
}

91 
	tb™m­
;

121 #ifdeà
TRACK_BLOCKS


122 
	~<m­
>

123 
	~<veùÜ
>

124 
	~<ut™y
>

125 
	~<®gÜ™hm
>

127 
±h»ad_mu‹x_t
 
	gblock_mu‹x
 = 
PTHREAD_MUTEX_INITIALIZER
;

128 
	sblock_’Œy
 {

129 
	mpoŞ_®loc
::
block
* 
_block
;

130 cÚ¡* 
	m_Çme
;

131 
±h»ad_t
 
	m_tid
;

132 
	m_d–
;

133 
block_’Œy
(
poŞ_®loc
::
block
* 
b
, cÚ¡* 
Çme
, 
±h»ad_t
 
tid
, 
d–
)

134 : 
_block
(
b
), 
_Çme
(
Çme
), 
_tid
(
tid
), 
_d–
(
d–
) { }

135 
boŞ
 
	mİ”©Ü
<(
block_’Œy
 cÚ¡ &
	mÙh”
) const {

136 if(
	m_Çme
 < 
	mÙh”
._name)

137  
	mŒue
;

138 if(
	m_Çme
 > 
	mÙh”
._name)

139  
	mçl£
;

140 if(
	m_tid
 < 
	mÙh”
._tid)

141  
	mŒue
;

142 if(
	m_tid
 > 
	mÙh”
._tid)

143  
	mçl£
;

144  
	m_block
 < 
	mÙh”
._block;

147 
	g¡d
::
	tm­
<
	tpoŞ_®loc
::
	tblock
*, > 
	tblock_m­
;

148 
	g¡d
::
	t·œ
<
	tblock_m­
, 
	t±h»ad_mu‹x_t
> 
	tblock_m­_sync
;

149 
	g¡d
::
	t·œ
<cÚ¡*, 
	t±h»ad_t
> 
	tth»ad_®loc_key
;

150 
	g¡d
::
	t·œ
<
	tblock_m­_sync
*, 
	tboŞ
> 
	tth»ad_®loc_v®ue
;

151 
	g¡d
::
	tm­
<
	tth»ad_®loc_key
, 
	tth»ad_®loc_v®ue
> 
	tth»ad_m­s
;

152 
	g¡d
::
	tveùÜ
<
	tblock_’Œy
> 
	tblock_li¡
;

153 
th»ad_m­s
* 
	glive_blocks
;

155 
	$´št_live_blocks
() {

157 
poŞ_®loc
::
block_li¡
 
bli¡
;

160 
th»ad_m­s
::
™”©Ü
 
m­
 = 
live_blocks
->
	`begš
();

161 
m­
 !ğ
live_blocks
->
	`’d
()) {

162 
th»ad_®loc_key
 cÚ¡ &
key
 = 
m­
->
fœ¡
;

163 
th»ad_®loc_v®ue
 &
v®ue
 = 
m­
->
£cÚd
;

164 
block_m­
* 
bm­
 = &
v®ue
.
fœ¡
->first;

167 
block_m­
::
™”©Ü
 
™
 = 
bm­
->
	`begš
();

168  ; 
™
 !ğ
bm­
->
	`’d
(); ++it)

169 
bli¡
.
	`push_back
(
	`block_’Œy
(
™
->
fœ¡
, 
key
.fœ¡, key.
£cÚd
, it->second));

172 if(!
v®ue
.
£cÚd
 && 
bm­
->
	`em±y
())

173 
live_blocks
->
	`”a£
(
m­
++);

175 ++
m­
;

178 
¡d
::
	`sÜt
(
bli¡
.
	`begš
(), bli¡.
	`’d
());

179 
block_li¡
::
™”©Ü
 
™
=
bli¡
.
	`begš
();

180 
	`´štf
("Allocator (tid): " "address " " unit bitmap\n");

181 ; 
™
 !ğ
bli¡
.
	`’d
(); ++it) {

182 
	`´štf
("%10 (%3d): 0x%016°%4d ", 
™
->
_Çme
, it->
_tid
, it->
_block
, it->
_d–
);

183 
b™m­
 
un™s
 = 
™
->
_block
->
_b™m­
;

184 
i
=0; i < 
poŞ_®loc
::
BLOCK_UNITS
; i++) {

185 
	`putch¬
('0' + (
un™s
&0x1));

186 
un™s
 >>= 1;

188 
	`putch¬
('\n');

190 
	}
}

192 
	$´št_live_blocks
() {

193 
	`´štf
("Sorry, blockracking is‚otƒnabled. Recompile with -DTRACK_BLOCKS‡ndry‡gain)\n");

194 
	}
}

197 
	gpoŞ_®loc
::
	$poŞ_®loc
(cÚ¡* 
Çme
, 
d–
)

198 : 
	`_Çme
(
Çme
), 
	`_block
(
NULL
), 
	`_Ãxt_un™
(0), 
	`_d–
(
d–
), 
	`_off£t
(0),

199 
	`_®loc_couÁ
(0), 
	$_huge_couÁ
(0)

202 
	`mem£t
(
_®loc_sizes
, 0, (_alloc_sizes));

203 
	`mem£t
(
_huge_sizes
, 0, (_huge_sizes));

204 #ifdeà
TRACK_BLOCKS


206 
_live_blocks
 = 
Ãw
 
block_m­_sync
;

207 
_live_blocks
->
£cÚd
 = 
	`th»ad_mu‹x_ü—‹
();

208 
ü™iÿl_£ùiÚ_t
 
	`cs
(
block_mu‹x
);

209 (*
live_blocks
)[
¡d
::
	`make_·œ
(
_Çme
, 
	`±h»ad_£lf
())] = std::make_·œ(
_live_blocks
, 
Œue
);

213 
th»ad_loÿl_poŞs
->
	`push_back
(
this
);

214 
	}
}

216 
	gpoŞ_®loc
::~
	$poŞ_®loc
() {

218 
	`disÿrd_block
();

219 #ifdeà
TRACK_BLOCKS


221 
ü™iÿl_£ùiÚ_t
 
	`cs
(
block_mu‹x
);

222 (*
live_blocks
)[
¡d
::
	`make_·œ
(
_Çme
, 
	`±h»ad_£lf
())].
£cÚd
 = 
çl£
;

224 
	}
}

227 
	gpoŞ_®loc
::
h—d”
* 
poŞ_®loc
::
block
::
	$g‘_h—d”
(
off£t
, 
poŞ_®loc
::
b™m­
 
¿nge
) {

228 
h—d”
* 
h
 = (h—d”*è&
_d©a
[
off£t
];

229 
h
->
_block
 = 
this
;

230 
h
->
_¿nge
 = 
¿nge
;

231  
h
;

232 
	}
}

234 
	gpoŞ_®loc
::
h—d”
::
	$»Ëa£
() {

236 #ifdeà
TRACE_LEAKS


237 
	`årštf
(
¡d”r
, "% un™ -1 %°%016Îx\n", 
_block
->
_Çme
, _block, 
_¿nge
);

240 
b™m­
 
»suÉ
;

241 
b™m­
 
ş—r_¿nge
 = ~
_¿nge
;

242 #ifdeà
__¥¬cv9


243 
	`memb¬_’‹r
();

244 
»suÉ
 = 
	`©omic_ªd_64_nv
(&
_block
->
_b™m­
, 
ş—r_¿nge
);

245 
	`memb¬_ex™
();

247 
»suÉ
 = 
	`__sync_ªd_ªd_ãtch
(&
_block
->
_b™m­
, 
ş—r_¿nge
);

251 if(!
»suÉ
) {

252 #ifdeà
TRACE_LEAKS


253 if(!
ş—r_¿nge
)

254 
	`årštf
(
¡d”r
, "% block -1 %°%016Îx (ov”sized)\n", 
_block
->
_Çme
, _block, 
_¿nge
);

256 
	`årštf
(
¡d”r
, "% block -1 %p\n", 
_block
->
_Çme
, _block);

258 #ifdeà
TRACK_BLOCKS


260 
ü™iÿl_£ùiÚ_t
 
	`cs
(
_block
->
_live_blocks
->
£cÚd
);

261 
_block
->
_live_blocks
->
fœ¡
.
	`”a£
(_block);

265 ::
	`ä“
(
_block
);

267 
	}
}

270 cÚ¡ 
	gADJUST_GOAL
 = 5;

271 cÚ¡ 
	gK_MAX
 = (
poŞ_®loc
::
BLOCK_UNITS
+
ADJUST_GOAL
-1)/ADJUST_GOAL;

273 
	$kth_bigge¡
(* 
¬¿y
, 
¬¿y_size
) {

274 
tİ_k
[
K_MAX
];

275 
k
 = (
¬¿y_size
+
ADJUST_GOAL
-1)/ADJUST_GOAL;

276 
Ï¡
=0;

277 
tİ_k
[0] = 
¬¿y
[0];

278 
i
=1; i < 
¬¿y_size
; i++) {

279 
size
 = 
¬¿y
[
i
];

282 
šdex
=0;

283 
šdex
 <ğ
Ï¡
 && 
size
 < 
tİ_k
[index]) ++index;

284 if(
šdex
 =ğ
k
)

288 
j
=
k
; --j > 
šdex
; )

289 
tİ_k
[
j
] =op_k[j-1];

292 
tİ_k
[
šdex
] = 
size
;

293 if(
šdex
 > 
Ï¡
)

294 
Ï¡
 = 
šdex
;

297  
tİ_k
[
Ï¡
];

298 
	}
}

300 
	gpoŞ_®loc
::
	$disÿrd_block
() {

302 if(
_Ãxt_un™
) {

303 
_block
->
	`g‘_h—d”
(
_off£t
, ~(
_Ãxt_un™
-1))->
	`»Ëa£
();

304 
_Ãxt_un™
 = 0;

306 
	}
}

308 
	gpoŞ_®loc
::
	$Ãw_block
() {

312 
_huge_couÁ
 = 0;

313 
_®loc_couÁ
 = 0;

314 
_Ãxt_un™
 = 1;

315 
by‹s
 = (
block
è+ 
BLOCK_UNITS
*
_d–
;

316 * 
d©a
 = ::
	`m®loc
(
by‹s
);

317 if(!
d©a
)

318 
throw
 
¡d
::
	`bad_®loc
();

320 
_block
 = 
	`Ãw
(
d©a
è
	`block
(
_Çme
);

321 
_off£t
 = 0;

322 #ifdeà
TRACK_BLOCKS


324 
_block
->
_live_blocks
 = _live_blocks;

325 
ü™iÿl_£ùiÚ_t
 
	`cs
(
_live_blocks
->
£cÚd
);

326 
_live_blocks
->
fœ¡
[
_block
] = 
_d–
;

329 
	}
}

331 
	gpoŞ_®loc
::
h—d”
* 
poŞ_®loc
::
	$®loÿ‹_huge
(
size
) {

332 
_huge_sizes
[
_huge_couÁ
++] = 
size
;

334 if(
_huge_couÁ
 > 
K_MAX
) {

335 
	`disÿrd_block
();

336 
_d–
 = 
	`kth_bigge¡
(
_huge_sizes
, 
_huge_couÁ
);

337  
	`®loÿ‹_nÜm®
(
size
);

343 * 
d©a
 = ::
	`m®loc
((
block
è+ 
size
);

344 if(!
d©a
)

345 
throw
 
¡d
::
	`bad_®loc
();

347 
block
* 
b
 = 
	`Ãw
(
d©a
è
	`block
(
_Çme
);

348 #ifdeà
TRACK_BLOCKS


350 
b
->
_live_blocks
 = _live_blocks;

351 
ü™iÿl_£ùiÚ_t
 
	`cs
(
_live_blocks
->
£cÚd
);

352 
_live_blocks
->
fœ¡
[
b
] = 
size
;

355 #ifdeà
TRACE_LEAKS


356 
	`årštf
(
¡d”r
, "% block 1 %p+%d (ov”sized)\n", 
_Çme
, 
b
, 
size
);

358  
b
->
	`g‘_h—d”
(0, ~0ull);

359 
	}
}

361 
	gpoŞ_®loc
::
h—d”
* 
poŞ_®loc
::
	$®loÿ‹_nÜm®
(
size
) {

364 if(
_Ãxt_un™
 == 0) {

365 if(
_®loc_couÁ
)

366 
_d–
 = 
	`kth_bigge¡
(
_®loc_sizes
, 
_®loc_couÁ
);

367 
	`Ãw_block
();

368 #ifdeà
TRACE_LEAKS


369 
	`årštf
(
¡d”r
, "% block 1 %p+%d\n", 
_Çme
, 
_block
, 
_d–
);

374 
_®loc_sizes
[
_®loc_couÁ
++] = 
size
;

377 
h—d”
* 
h
 = 
_block
->
	`g‘_h—d”
(
_off£t
, 0);

380 
»maššg
 = 
size
;

382 
h
->
_¿nge
 |ğ
_Ãxt_un™
;

383 
_Ãxt_un™
 <<= 1;

384 
»maššg
 -ğ
_d–
;

385 
_off£t
 +ğ
_d–
;

386 } 
»maššg
 > 0 && 
_Ãxt_un™
);

389 if(
»maššg
 > 0) {

391 
h
->
	`»Ëa£
();

392  
	`®loÿ‹_nÜm®
(
size
);

396  
h
;

397 
	}
}

399 
	gpoŞ_®loc
::
h—d”
* 
poŞ_®loc
::
	$®loÿ‹
(
size
) {

401 cÚ¡ 
HUGE_THRESHOLD
 = 
BLOCK_UNITS
/8;

404  (
size
 > 
HUGE_THRESHOLD
*
_d–
)? 
	`®loÿ‹_huge
(sizeè: 
	`®loÿ‹_nÜm®
(size);

405 
	}
}

407 #undeà
USE_MALLOC


409 * 
	gpoŞ_®loc
::
	$®loc
(
size
) {

410 #ifdeà
USE_MALLOC


411  ::
	`m®loc
(
size
);

414 
size
 = (siz+ (
h—d”
) + 7) & -8;

416 
h—d”
* 
h
 = 
	`®loÿ‹
(
size
);

417 #ifdeà
TRACE_LEAKS


418 
	`årštf
(
¡d”r
, "% un™ 1 %°%016Îx\n", 
_Çme
, 
h
->
_block
, h->
_¿nge
);

420  
h
->
_d©a
;

421 
	}
}

423 
	gpoŞ_®loc
::
	$ä“
(* 
±r
) {

424 #ifdeà
USE_MALLOC


425 ::
	`ä“
(
±r
);

449 * 
v±r
;

450 * 
ıŒ
;

451 
h—d”
* 
h±r
;

452 } 
u
 = {
±r
};

455 
u
.
ıŒ
 -ğ(
h—d”
);

456 
u
.
h±r
->
	`»Ëa£
();

457 
	}
}

	@src/util/prcinfo.cpp

43 
	~"ut/´cšfo.h
"

44 
	~"ut/Œaû.h
"

46 
	~<uni¡d.h
>

47 
	~<¡dio.h
>

50 
	g´oûssšfo_t
::
	$´oûssšfo_t
(cÚ¡ 
boŞ
 
´š‹x™
)

51 : 
	`_´št_©_ex™
(
´š‹x™
), 
	$_is_ok
(0)

54 
¡ršg
 
·thÇme
 = "/proc/self/usage";

55 ià((
_fd
 = 
	`İ’
(
·thÇme
.
	`c_¡r
(), 
O_RDONLY
)) < 0) {

57 
	`TRACE
Ğ
TRACE_ALWAYS
, "Couldn't open /proc/self/usage\n");

62 
	`l£ek
(
_fd
, 0, 
SEEK_SET
);

65 ià(
	`»ad
(
_fd
, &
_Şd_´u§ge
, (_old_prusage)) != (_old_prusage)) {

66 
	`TRACE
Ğ
TRACE_ALWAYS
, "Reading…rusageƒrror\n");

70 
_tim”
.
	`»£t
();

71 
_is_ok
 = 1;

76 
_nıus
 = 
	`syscÚf
Ğ
_SC_NPROCESSORS_ONLN
 );

77 
	}
}

79 
	g´oûssšfo_t
::~
	$´oûssšfo_t
() {

80 ià(
_´št_©_ex™
 && 
_is_ok
)

81 
	`´št
();

82 
	}
}

85 
	g´oûssšfo_t
::
	$»£t
()

87 ià(!
_is_ok
)  (1);

90 
	`l£ek
(
_fd
, 0, 
SEEK_SET
);

93 ià(
	`»ad
(
_fd
, &
_´u§ge
, (_prusage)) != (_prusage)) {

94 
	`TRACE
Ğ
TRACE_ALWAYS
, "Reading…rusageƒrror\n");

99 
_Şd_´u§ge
 = 
_´u§ge
;

100 
_tim”
.
	`»£t
();

103 
	}
}

105 
	g´oûssšfo_t
::
	$´št
()

107 ià(!
_is_ok
)  (1);

110 
	`l£ek
(
_fd
, 0, 
SEEK_SET
);

113 ià(
	`»ad
(
_fd
, &
_´u§ge
, (_prusage)) != (_prusage)) {

114 
	`TRACE
Ğ
TRACE_ALWAYS
, "Reading…rusageƒrror\n");

122 
ulÚg_t
 
´_mšf
 = 
_´u§ge
.´_mšà- 
_Şd_´u§ge
.pr_minf;

123 
ulÚg_t
 
´_majf
 = 
_´u§ge
.´_majà- 
_Şd_´u§ge
.pr_majf;

124 
ulÚg_t
 
´_nsw­
 = 
_´u§ge
.´_nsw­ - 
_Şd_´u§ge
.pr_nswap;

125 
ulÚg_t
 
´_šblk
 = 
_´u§ge
.´_šblk - 
_Şd_´u§ge
.pr_inblk;

126 
ulÚg_t
 
´_oublk
 = 
_´u§ge
.´_oublk - 
_Şd_´u§ge
.pr_oublk;

127 
ulÚg_t
 
´_m¢d
 = 
_´u§ge
.´_m¢d - 
_Şd_´u§ge
.pr_msnd;

128 
ulÚg_t
 
´_mrcv
 = 
_´u§ge
.´_mrcv - 
_Şd_´u§ge
.pr_mrcv;

129 
ulÚg_t
 
´_sigs
 = 
_´u§ge
.´_sig - 
_Şd_´u§ge
.pr_sigs;

130 
ulÚg_t
 
´_vùx
 = 
_´u§ge
.´_vùx - 
_Şd_´u§ge
.pr_vctx;

131 
ulÚg_t
 
´_iùx
 = 
_´u§ge
.´_iùx - 
_Şd_´u§ge
.pr_ictx;

132 
ulÚg_t
 
´_sysc
 = 
_´u§ge
.´_sysø- 
_Şd_´u§ge
.pr_sysc;

133 
ulÚg_t
 
´_ioch
 = 
_´u§ge
.´_ioch - 
_Şd_´u§ge
.pr_ioch;

136 
time¡ruc_t
 
´_¹ime
;

137 
time¡ruc_t
 
´_utime
;

138 
time¡ruc_t
 
´_¡ime
;

139 
time¡ruc_t
 
´_‰ime
;

140 
time¡ruc_t
 
´_táime
;

141 
time¡ruc_t
 
´_dáime
;

142 
time¡ruc_t
 
´_káime
;

143 
time¡ruc_t
 
´_Éime
;

144 
time¡ruc_t
 
´_¦±ime
;

145 
time¡ruc_t
 
´_wtime
;

146 
time¡ruc_t
 
´_¡İtime
;

148 
	`tssub
(&
´_¹ime
, &
_´u§ge
.´_¹ime, &
_Şd_´u§ge
.pr_rtime);

149 
	`tssub
(&
´_utime
, &
_´u§ge
.´_utime, &
_Şd_´u§ge
.pr_utime);

150 
	`tssub
(&
´_¡ime
, &
_´u§ge
.´_¡ime, &
_Şd_´u§ge
.pr_stime);

151 
	`tssub
(&
´_‰ime
, &
_´u§ge
.´_‰ime, &
_Şd_´u§ge
.pr_ttime);

152 
	`tssub
(&
´_táime
, &
_´u§ge
.´_táime, &
_Şd_´u§ge
.pr_tftime);

153 
	`tssub
(&
´_dáime
, &
_´u§ge
.´_dáime, &
_Şd_´u§ge
.pr_dftime);

154 
	`tssub
(&
´_káime
, &
_´u§ge
.´_káime, &
_Şd_´u§ge
.pr_kftime);

155 
	`tssub
(&
´_Éime
, &
_´u§ge
.´_Éime, &
_Şd_´u§ge
.pr_ltime);

156 
	`tssub
(&
´_¦±ime
, &
_´u§ge
.´_¦±ime, &
_Şd_´u§ge
.pr_slptime);

157 
	`tssub
(&
´_wtime
, &
_´u§ge
.´_wtime, &
_Şd_´u§ge
.pr_wtime);

158 
	`tssub
(&
´_¡İtime
, &
_´u§ge
.´_¡İtime, &
_Şd_´u§ge
.pr_stoptime);

160 
	`´štf
("*** Usage Counters *** \n");

161 
	`´štf
("MšÜ FauÉs:................. %lu\n", 
´_mšf
);

162 
	`´štf
("MajÜ FauÉs:................. %lu\n", 
´_majf
);

163 
	`´štf
("Sw­s:........................ %lu\n", 
´_nsw­
);

164 
	`´štf
("IÅuˆBlocks:................. %lu\n", 
´_šblk
);

165 
	`´štf
("OuuˆBlocks:................ %lu\n", 
´_oublk
);

166 
	`´štf
("STREAMS Mes§ge S’t:........ %lu\n", 
´_m¢d
);

167 
	`´štf
("STREAMS Mes§ge Reûived:.... %lu\n", 
´_mrcv
);

168 
	`´štf
("SigÇls:...................... %lu\n", 
´_sigs
);

169 
	`´štf
("VŞuÁ¬y CÚ‹xˆSw™ches:... %lu\n", 
´_vùx
);

170 
	`´štf
("InvŞuÁ¬y CÚ‹xˆSw™ches:. %lu\n", 
´_iùx
);

171 
	`´štf
("Sy¡em C®ls:................. %lu\n", 
´_sysc
);

172 
	`´štf
("R—d/Wr™Ch¬aù”s:........ %lu\n", 
´_ioch
);

173 
	`´štf
("*** Process Times *** \n");

175 
d–ay
 = 
_tim”
.
	`time_us
();

176 
	`´time
("TÙ® EÏp£d Time:........... ", 
d–ay
);

177 
	`´time
("TÙ® U£¸Time:.............. ", &
´_utime
);

178 
	`´time
("TÙ® Sy¡em Time:............ ", &
´_¡ime
);

179 
	`´time
("Oth” Sy¡em T¿°Time:....... ", &
´_‰ime
);

180 
	`´time
("TexˆPagFauÉ SË• Time.... ", &
´_táime
);

181 
	`´time
("D©¨PagFauÉ SË• Time.... ", &
´_dáime
);

182 
	`´time
("K”ÃÈPagFauÉ SË• Time.. ", &
´_káime
);

183 
	`´time
("U£¸Lock Wa™ SË• Time..... ", &
´_Éime
);

184 
	`´time
("AÎ Oth” SË• Time.......... ", &
´_¦±ime
);

185 
	`´time
("TimWa™šg fÜ‡ CPU........ ", &
´_wtime
);

186 
	`´time
("Stİ³d Time.................. ", &
´_¡İtime
);

189 
_Şd_´u§ge
 = 
_´u§ge
;

190 
_tim”
.
	`»£t
();

192 
	}
}

195 
ušt
 
	g´oûssšfo_t
::
	$g‘_num_of_ıus
()

197  (
_nıus
);

198 
	}
}

201 
ıu_lßd_v®ues_t
 
	g´oûssšfo_t
::
	$g‘_lßd
()

203 
ıu_lßd_v®ues_t
 
lßd
;

204 ià(!
_is_ok
è (
lßd
);

207 
	`l£ek
(
_fd
, 0, 
SEEK_SET
);

210 ià(
	`»ad
(
_fd
, &
_´u§ge
, (_prusage)) != (_prusage)) {

211 
	`TRACE
Ğ
TRACE_ALWAYS
, "Reading…rusageƒrror\n");

212  (
lßd
);

219 
time¡ruc_t
 
´_utime
;

220 
time¡ruc_t
 
´_¡ime
;

221 
time¡ruc_t
 
´_‰ime
;

222 
time¡ruc_t
 
´_wtime
;

224 
	`tssub
(&
´_utime
, &
_´u§ge
.´_utime, &
_Şd_´u§ge
.pr_utime);

225 
	`tssub
(&
´_¡ime
, &
_´u§ge
.´_¡ime, &
_Şd_´u§ge
.pr_stime);

226 
	`tssub
(&
´_‰ime
, &
_´u§ge
.´_‰ime, &
_Şd_´u§ge
.pr_ttime);

227 
	`tssub
(&
´_wtime
, &
_´u§ge
.´_wtime, &
_Şd_´u§ge
.pr_wtime);

229 
lßd
.
run_tm
 = 
	`Œªs
(
´_utime
);

230 
lßd
.
run_tm
 +ğ
	`Œªs
(
´_¡ime
);

231 
lßd
.
run_tm
 +ğ
	`Œªs
(
´_‰ime
);

232 
lßd
.
wa™_tm
 = 
	`Œªs
(
´_wtime
);

233  (
lßd
);

234 
	}
}

237 
ulÚg_t
 
	g´oûssšfo_t
::
	$ioch¬s
()

239 ià(!
_is_ok
)  (1);

242 
	`l£ek
(
_fd
, 0, 
SEEK_SET
);

245 ià(
	`»ad
(
_fd
, &
_´u§ge
, (_prusage)) != (_prusage)) {

246 
	`TRACE
Ğ
TRACE_ALWAYS
, "Reading…rusageƒrror\n");

250 
ulÚg_t
 
´_ioch
 = 
_´u§ge
.´_ioch - 
_Şd_´u§ge
.pr_ioch;

251  (
´_ioch
);

252 
	}
}

255 
	g´oûssšfo_t
::
	$Œªs
(
time¡ruc_t
 
©s
)

257 cÚ¡ 
BILLION
 = 1000000000;

258 
ad
 = 
©s
.
tv_£c
 + (©s.
tv_n£c
/
BILLION
);

259  (
ad
);

260 
	}
}

263 
	g´oûssšfo_t
::
	$t§dd
(
time¡ruc_t
* 
»suÉ
,ime¡ruc_ˆ*
a
,ime¡ruc_ˆ*
b
)

265 
»suÉ
->
tv_£c
 = 
a
->tv_£ø+ 
b
->tv_sec;

266 ià((
»suÉ
->
tv_n£c
 = 
a
->tv_n£ø+ 
b
->tv_nsec) >= 1000000000) {

267 
»suÉ
->
tv_n£c
 -= 1000000000;

268 
»suÉ
->
tv_£c
 += 1;

270 
	}
}

273 
	g´oûssšfo_t
::
	$tssub
(
time¡ruc_t
* 
»suÉ
,ime¡ruc_ˆ*
a
,ime¡ruc_ˆ*
b
)

275 
»suÉ
->
tv_£c
 = 
a
->tv_£ø- 
b
->tv_sec;

276 ià((
»suÉ
->
tv_n£c
 = 
a
->tv_n£ø- 
b
->tv_nsec) < 0) {

277 
»suÉ
->
tv_n£c
 += 1000000000;

278 
»suÉ
->
tv_£c
 -= 1;

280 
	}
}

283 
	g´oûssšfo_t
::
	$hr_mš_£c
(* 
buf
, 
£c
)

285 
	`¥rštf
(
buf
, "%ld", 
£c
);

288 ià(
£c
 >= 3600)

289 
	`¥rštf
(
buf
, "%ld:%.2ld:%.2ld",

290 
£c
 / 3600, (sec % 3600) / 60, sec % 60);

291 ià(
£c
 >= 60)

292 
	`¥rštf
(
buf
, "%ld:%.2ld",

293 
£c
 / 60, sec % 60);

295 
	`¥rštf
(
buf
, "%ld", 
£c
);

297 
	}
}

300 
	g´oûssšfo_t
::
	$´time
(
¡ršg
 
Ïb–
, 
time¡ruc_t
* 
ts
)

302 
buf
[32];

303 
	`hr_mš_£c
(
buf
, 
ts
->
tv_£c
);

304 
cout
 << 
Ïb–
 << 
buf
 << "." << (
u_št
)
ts
->
tv_n£c
/1000000 << 
’dl
;

305 
	}
}

308 
	g´oûssšfo_t
::
	$´time
(
¡ršg
 
Ïb–
, & 
d–ay
)

310 
buf
[32];

311 
	`hr_mš_£c
(
buf
, 
d–ay
*1e-6);

312 
û¼
 << 
Ïb–
 << 
buf
 << "." << 
d–ay
/100000 << 
’dl
;

313 
	}
}

	@src/util/procstat.cpp

32 
	~"ut/´oc¡©.h
"

34 
	~"ut.h
"

36 
	~"sm/shÜe/shÜe_’v.h
"

45 
	gıu_m—su»m’t
& cpu_m—su»m’t::
İ”©Ü
+=(
ıu_m—su»m’t
 cÚ¡ &
Ùh”
)

47 
time¡amp
 +ğ
Ùh”
.timestamp;

48 
	gıu_n£c_idË
 +ğ
Ùh”
.
ıu_n£c_idË
;

49  (*
	gthis
);

52 
	gıu_m—su»m’t
& cpu_m—su»m’t::
İ”©Ü
-=(
ıu_m—su»m’t
 cÚ¡ &
Ùh”
)

54 
time¡amp
 -ğ
Ùh”
.timestamp;

55 
	gıu_n£c_idË
 -ğ
Ùh”
.
ıu_n£c_idË
;

56  (*
	gthis
);

59 
	gıu_m—su»m’t
::
	$ş—r
() {

60 
time¡amp
 = 0;

61 
ıu_n£c_idË
 = 0;

62 
	}
}

64 
	gıu_m—su»m’t
::
	$£t
(
ušt64_t
 
¢­time
, ušt64_ˆ
n£c_idË
)

66 
time¡amp
 = 
¢­time
;

67 
ıu_n£c_idË
 = 
n£c_idË
;

68 
	}
}

78 
	g´ocmÚ™Ü_t
::
	$´ocmÚ™Ü_t
(cÚ¡ * 
Çme
,

79 
shÜe
::
ShÜeEnv
* 
’v
,

80 cÚ¡ 
š‹rv®_£c
)

81 : 
	`th»ad_t
(
Çme
), 
	`_š‹rv®_u£c
(0), 
	`_š‹rv®_£c
(
š‹rv®_£c
),

82 
	`_tÙ®_u§ge
(0), 
	`_num_u§ge_»adšgs
(0), 
	`_avg_u§ge
(0),

83 
	`_¡©e
(
CPS_NOTSET
), 
	`_’v
(
’v
), 
	`_Ï¡_»adšg
(0),

84 
	$_´št_v”bo£
(
çl£
)

86 
	}
}

89 
	g´ocmÚ™Ü_t
::~
	$´ocmÚ™Ü_t
()

91 ià(*&
_¡©e
 !ğ
CPS_NOTSET
) {

92 
	`±h»ad_mu‹x_de¡roy
(&
_mu‹x
);

93 
	`±h»ad_cÚd_de¡roy
(&
_cÚd
);

95 
	}
}

107 
	g´ocmÚ™Ü_t
::
	$_£tup
(cÚ¡ 
š‹rv®_£c
)

110 
	`as£¹
 (
š‹rv®_£c
>0);

111 
_š‹rv®_u£c
 = (
š‹rv®_£c
*1e6);

113 ià(
š‹rv®_£c
<1) {

114 
	`TRACE
Ğ
TRACE_DEBUG
, "CPU usage updatedƒvery (%0.3f) msec\n",

115 
_š‹rv®_u£c
/1000.);

118 
	`TRACE
Ğ
TRACE_DEBUG
, "CPU usage(updatedƒvery (%0.6f) sec\n",

119 
_š‹rv®_u£c
/1000./1000);

123 
	`±h»ad_mu‹x_š™
(&
_mu‹x
, 
NULL
);

124 
	`±h»ad_cÚd_š™
(&
_cÚd
, 
NULL
);

126 
_¡©e
 = 
CPS_PAUSE
;

127 
	}
}

139 
	g´ocmÚ™Ü_t
::
	$wÜk
()

142 ià(*&
_¡©e
==
CPS_NOTSET
è
	`_£tup
(
_š‹rv®_£c
);

143 
	`as£¹
 (*&
_¡©e
!=
CPS_NOTSET
);

146 
	`ÿ£_£tup
();

148 
eCPS
 
a¡©e
 = *&
_¡©e
;

149 
”rÜ
 = 0;

150 
time¥ec
 
¡¬t
;

152 
	`±h»ad_mu‹x_lock
(&
_mu‹x
);

153 
	`şock_g‘time
(
CLOCK_REALTIME
, &
¡¬t
);

155 
time¥ec
 
ts
 = 
¡¬t
;

156 cÚ¡ 
BILLION
 = 1000*1000*1000;

158 
Œue
) {

160 
a¡©e
 = *&
_¡©e
;

162 
a¡©e
) {

163 (
CPS_RUNNING
):

164 (
CPS_PAUSE
):

167 
	`ÿ£_tick
();

168 if(
_´št_v”bo£
)

169 
	`´št_v”bo£
();

170 
	`´št_š‹rv®
();

173 
ts
 = 
¡¬t
;

174 
ts
.
tv_n£c
 +ğ
_š‹rv®_u£c
*1000;

175 if(
ts
.
tv_n£c
 > 
BILLION
) {

176 
ts
.
tv_n£c
 -ğ
BILLION
;

177 
ts
.
tv_£c
++;

181 
Œue
) {

183 
”rÜ
 = 
	`±h»ad_cÚd_timedwa™
(&
_cÚd
, &
_mu‹x
, &
ts
);

184 
	`şock_g‘time
(
CLOCK_REALTIME
, &
¡¬t
);

185 if(
¡¬t
.
tv_£c
 > 
ts
.tv_sec ||

186 (
¡¬t
.
tv_£c
 =ğ
ts
.tv_£ø&& s¹.
tv_n£c
 >s.tv_nsec))

189 
¡¬t
 = 
ts
;

193 (
CPS_RESET
):

196 
	`ÿ£_»£t
();

199 
_tÙ®_u§ge
 = 0;

200 
_num_u§ge_»adšgs
 = 0;

201 
_avg_u§ge
 = 0;

202 
_¡©e
 = 
CPS_RUNNING
;

205 (
CPS_STOP
):

208 
	`ÿ£_¡İ
();

211 (
CPS_NOTSET
):

213 
	`as£¹
(0);

217 
	}
}

229 
	g´ocmÚ™Ü_t
::
	$´št_lßd
(cÚ¡ 
d–ay
)

231 cÚ¡ 
ıu_lßd_v®ues_t
 
lßd
 = 
	`g‘_lßd
();

234 ià((
lßd
.
run_tm
>0.è&& (lßd.
wa™_tm
>0.)) {

235 
	`TRACE
Ğ
TRACE_ALWAYS
, "\nCpuLoad = (%.2f)\nAbsLoad = (%.2f)\n",

236 (
lßd
.
run_tm
+lßd.
wa™_tm
)/lßd.run_tm,†ßd.run_tm/
d–ay
);

238 
	}
}

249 
	g´ocmÚ™Ü_t
::
	$´št_š‹rv®
()

251 
	`as£¹
(
_’v
);

252 
ušt_t
 
©t
 = 
_’v
->
	`g‘_Œx_©t
();

253 ià(
_’v
->
	`g‘_m—su»
(è=ğ
shÜe
::
MST_MEASURE
) {

254 
	`TRACE
Ğ
TRACE_STATISTICS
, "(%.1f) (%.1f)\n",

255 
	`g‘_avg_u§ge
(
çl£
),

256 ()(
©t
-
_Ï¡_»adšg
)/
_š‹rv®_£c
);

258 
_Ï¡_»adšg
=
©t
;

259 
	}
}

272 
	g´ocmÚ™Ü_t
::
	$úŒ_»£t
()

274 
	`¡©_»£t
();

275 
_¡©e
 = 
CPS_RESET
;

276 
	}
}

278 
	g´ocmÚ™Ü_t
::
	$úŒ_·u£
()

280 
_¡©e
 = 
CPS_PAUSE
;

281 
	}
}

283 
	g´ocmÚ™Ü_t
::
	$úŒ_»sume
()

285 
_¡©e
 = 
CPS_RUNNING
;

286 
	}
}

288 
	g´ocmÚ™Ü_t
::
	$úŒ_¡İ
()

290 
_¡©e
 = 
CPS_STOP
;

291 
	}
}

294 
w_rc_t
 
	g´ocmÚ™Ü_t
::
	$ÿ£_£tup
()

296  (
RCOK
);

297 
	}
}

299 
w_rc_t
 
	g´ocmÚ™Ü_t
::
	$ÿ£_»£t
()

301  (
RCOK
);

302 
	}
}

304 
w_rc_t
 
	g´ocmÚ™Ü_t
::
	$ÿ£_¡İ
()

306  (
RCOK
);

307 
	}
}

309 
w_rc_t
 
	g´ocmÚ™Ü_t
::
	$ÿ£_tick
()

311  (
RCOK
);

312 
	}
}

315 
	g´ocmÚ™Ü_t
::
	$£tEnv
(
shÜe
::
ShÜeEnv
* 
’v
)

317 
	`as£¹
 (
’v
);

318 
_’v
 = 
’v
;

319 
	}
}

322 
	g´ocmÚ™Ü_t
::
	$£t_´št_v”bo£
(
boŞ
 
´št_v”bo£
)

324 
_´št_v”bo£
 = 
´št_v”bo£
;

325 
	}
}

327 
	g´ocmÚ™Ü_t
::
	$´št_v”bo£
()

329 
	`as£¹
(
_’v
);

330 
ušt_t
 
©t
 = 
_’v
->
	`g‘_Œx_©t
();

331 ià(
_’v
->
	`g‘_m—su»
(è=ğ
shÜe
::
MST_MEASURE
) {

332 
	`TRACE
Ğ
TRACE_STATISTICS
, "(%.1f) (%.1f)\n",

333 
	`g‘_avg_u§ge
(
çl£
),

334 ()(
©t
-
_Ï¡_»adšg
)/
_š‹rv®_£c
);

335 
	`´št_lßd
(
_š‹rv®_£c
);

336 
	`´št_ext_¡©s
();

338 
_Ï¡_»adšg
=
©t
;

339 
	}
}

	@src/util/progress.cpp

31 
	~"ut/´og»ss.h
"

33 
	~"k_defšes.h
"

42 
	$´og»ss_»£t
(* 
šdiÿtÜ
) {

43 *
šdiÿtÜ
 = 0;

44 
	}
}

52 
	$´og»ss_upd©e
(* 
šdiÿtÜ
) {

54 iàĞ(++*
šdiÿtÜ
 % 
PROGRESS_INTERVAL
) == 0 ) {

55 
	`´štf
(".");

56 
	`fæush
(
¡dout
);

57 *
šdiÿtÜ
 = 0;

59 
	}
}

67 
	$´og»ss_dÚe
(cÚ¡ * 
bËÇme
) {

69 
	`´štf
("\nDÚlßdšg (%s)...\n", 
bËÇme
);

70 
	`fæush
(
¡dout
);

71 
	}
}

	@src/util/random_input.cpp

33 
	~"ut/¿ndom_šput.h
"

37 
	$URªd
(cÚ¡ 
low
, cÚ¡ 
high
)

39 
th»ad_t
* 
£lf
 = 
	`th»ad_g‘_£lf
();

40 
	`as£¹
 (
£lf
);

41 
¿ndg’_t
* 
¿ndg’p
 = 
£lf
->
	`¿ndg’
();

42 
	`as£¹
 (
¿ndg’p
);

44 
d
 = 
high
 - 
low
 + 1;

45  (
low
 + 
¿ndg’p
->
	`¿nd
(
d
));

46 
	}
}

50 
boŞ


51 
	$URªdBoŞ
()

53  (
	`URªd
(0,1è? 
Œue
 : 
çl£
);

54 
	}
}

58 
	$URªdShÜt
(cÚ¡ 
low
, cÚ¡ 
high
)

60 
th»ad_t
* 
£lf
 = 
	`th»ad_g‘_£lf
();

61 
	`as£¹
 (
£lf
);

62 
¿ndg’_t
* 
¿ndg’p
 = 
£lf
->
	`¿ndg’
();

63 
	`as£¹
 (
¿ndg’p
);

65 
d
 = 
high
 - 
low
 + 1;

66  (
low
 + ()
¿ndg’p
->
	`¿nd
(
d
));

67 
	}
}

71 
	$URªdFlSŒC­s
(* 
de¡
, cÚ¡ 
sz
)

73 
	`as£¹
 (
de¡
);

74 
i
=0; i<
sz
; i++) {

75 
de¡
[
i
] = 
CAPS_CHAR_ARRAY
[
	`URªd
(0,(CAPS_CHAR_ARRAY)-1)];

77 
	}
}

81 
	$URªdFlSŒNumbx
(* 
de¡
, cÚ¡ 
sz
)

83 
	`as£¹
 (
de¡
);

84 
i
=0; i<
sz
; i++) {

85 
de¡
[
i
] = 
NUMBERS_CHAR_ARRAY
[
	`URªd
(0,(NUMBERS_CHAR_ARRAY)-1)];

87 
	}
}

90 
	#USE_ZIPF
 1

	)

92 
boŞ
 
	g_g_’abËZf
 = 
çl£
;

93 
	g_g_ZfS
 = 0.0;

96 
	$UZRªd
(cÚ¡ 
low
, cÚ¡ 
high
)

98 #ifdeà
USE_ZIPF


99  ( 
_g_’abËZf
? ( 
	`ZRªd
(
low
,
high
è):Ğ
	`URªd
(low,high) ));

101  
	`URªd
(
low
,
high
);

103 
	}
}

106 
	$ZRªd
(cÚ¡ 
low
, cÚ¡ 
high
)

108 
zfŸn
 
	`myZf
(
high
-
low
+2,
_g_ZfS
);

110 
th»ad_t
* 
£lf
 = 
	`th»ad_g‘_£lf
();

111 
	`as£¹
 (
£lf
);

112 
¿ndg’_t
* 
¿ndg’p
 = 
£lf
->
	`¿ndg’
();

113 
	`as£¹
 (
¿ndg’p
);

114 
u
 = ()
¿ndg’p
->
	`¿nd
(10000)/(10000);

116  (
myZf
.
	`Ãxt
(
u
)+
low
-1);

117 
	}
}

119 
	$£tZf
(cÚ¡ 
boŞ
 
isEÇbËd
, cÚ¡ 
s
)

121 
_g_’abËZf
 = 
isEÇbËd
;

122 
_g_ZfS
 = 
s
;

123 
	}
}

	@src/util/resource_pool.cpp

42 
	~<±h»ad.h
>

43 
	~"ut/»sourû_poŞ.h
"

44 
	~"ut/¡©ic_li¡.h
"

46 
	~<¡dlib.h
>

47 
	~<as£¹.h
>

48 
	~"ut/Œaû.h
"

49 
	~"ut/s£¹.h
"

55 
	#TRACE_RESOURCE_POOL
 0

	)

65 
	swa™”_node_s


67 
	m»q_»£rve_couÁ
;

68 
±h»ad_cÚd_t
 
	m»que¡_g¿Áed
;

69 
¡©ic_li¡_node_s
 
	mli¡_node
;

91 
	g»sourû_poŞ_t
::
	$»£rve
(
n
)

96 
	`TASSERT
(
n
 <ğ
_ÿ·c™y
);

98 
	`TRACE
(
TRACE_RESOURCE_POOL
 & 
TRACE_ALWAYS
, "%s was %d:%d:%d\n",

99 
_Çme
.
	`d©a
(),

100 
_ÿ·c™y
,

101 
_»£rved
,

102 
_nÚ_idË
);

111 
num_uÄe£rved
 = 
_ÿ·c™y
 - 
_»£rved
;

112 ià(!
	`¡©ic_li¡_is_em±y
(&
_wa™”s
è|| (
num_uÄe£rved
 < 
n
)) {

114 
	`wa™_fÜ_tuº
(
n
);

118 
	`TRACE
(
TRACE_RESOURCE_POOL
 & 
TRACE_ALWAYS
, "%s‡fter_woken %d:%d:%d\n",

119 
_Çme
.
	`d©a
(),

120 
_ÿ·c™y
,

121 
_»£rved
,

122 
_nÚ_idË
);

130 
_»£rved
 +ğ
n
;

132 
	`TRACE
(
TRACE_RESOURCE_POOL
 & 
TRACE_ALWAYS
, "%s didnt_sleep %d:%d:%d\n",

133 
_Çme
.
	`d©a
(),

134 
_ÿ·c™y
,

135 
_»£rved
,

136 
_nÚ_idË
);

137 
	}
}

153 
	g»sourû_poŞ_t
::
	$uÄe£rve
(
n
)

156 
	`TASSERT
(
_»£rved
 >ğ
n
);

157 
	`TRACE
(
TRACE_RESOURCE_POOL
 & 
TRACE_ALWAYS
, "%s was %d:%d:%d\n",

158 
_Çme
.
	`d©a
(),

159 
_ÿ·c™y
,

160 
_»£rved
,

161 
_nÚ_idË
);

164 
_»£rved
 -ğ
n
;

166 
	`TRACE
(
TRACE_RESOURCE_POOL
 & 
TRACE_ALWAYS
, "%s‚ow %d:%d:%d\n",

167 
_Çme
.
	`d©a
(),

168 
_ÿ·c™y
,

169 
_»£rved
,

170 
_nÚ_idË
);

172 
	`wa™”_wake
();

174 
	`TRACE
(
TRACE_RESOURCE_POOL
 & 
TRACE_ALWAYS
, "%s‡fter_waking %d:%d:%d\n",

175 
_Çme
.
	`d©a
(),

176 
_ÿ·c™y
,

177 
_»£rved
,

178 
_nÚ_idË
);

179 
	}
}

198 
	g»sourû_poŞ_t
::
	$nÙify_ÿ·c™y_šü—£
(
diff
)

200 
	`TASSERT
(
diff
 > 0);

201 
	`TRACE
(
TRACE_RESOURCE_POOL
 & 
TRACE_ALWAYS
, "%s was %d:%d:%d\n",

202 
_Çme
.
	`d©a
(),

203 
_ÿ·c™y
,

204 
_»£rved
,

205 
_nÚ_idË
);

207 
_ÿ·c™y
 +ğ
diff
;

208 
	`wa™”_wake
();

210 
	`TRACE
(
TRACE_RESOURCE_POOL
 & 
TRACE_ALWAYS
, "%s‚ow %d:%d:%d\n",

211 
_Çme
.
	`d©a
(),

212 
_ÿ·c™y
,

213 
_»£rved
,

214 
_nÚ_idË
);

215 
	}
}

234 
	g»sourû_poŞ_t
::
	$nÙify_idË
()

236 
	`TASSERT
(
_nÚ_idË
 > 0);

237 
_nÚ_idË
--;

238 
	`TRACE
(
TRACE_RESOURCE_POOL
 & 
TRACE_ALWAYS
, "%s IDLE %d:%d:%d\n",

239 
_Çme
.
	`d©a
(),

240 
_ÿ·c™y
,

241 
_»£rved
,

242 
_nÚ_idË
);

243 
	}
}

246 
	g»sourû_poŞ_t
::
	$nÙify_nÚ_idË
()

248 
	`TASSERT
(
_nÚ_idË
 < 
_»£rved
);

249 
_nÚ_idË
++;

250 
	`TRACE
(
TRACE_RESOURCE_POOL
 & 
TRACE_ALWAYS
, "%s NON_IDLE %d:%d:%d\n",

251 
_Çme
.
	`d©a
(),

252 
_ÿ·c™y
,

253 
_»£rved
,

254 
_nÚ_idË
);

255 
	}
}

258 
	g»sourû_poŞ_t
::
	$g‘_ÿ·c™y
()

260  
_ÿ·c™y
;

261 
	}
}

264 
	g»sourû_poŞ_t
::
	$g‘_»£rved
()

266  
_»£rved
;

267 
	}
}

276 
	g»sourû_poŞ_t
::
	$g‘_nÚ_idË
()

278  
_nÚ_idË
;

279 
	}
}

297 
	g»sourû_poŞ_t
::
	$wa™_fÜ_tuº
(
»q_»£rve_couÁ
)

300 
wa™”_node_s
 
node
;

301 
node
.
»q_»£rve_couÁ
 =„eq_reserve_count;

302 
	`±h»ad_cÚd_š™
(&
node
.
»que¡_g¿Áed
, 
NULL
);

303 
	`¡©ic_li¡_­³nd
(&
_wa™”s
, &
node
, &node.
li¡_node
);

305 
	`±h»ad_cÚd_wa™
(&
node
.
»que¡_g¿Áed
, 
_mu‹xp
);

309 
	}
}

320 
	g»sourû_poŞ_t
::
	$wa™”_wake
()

322  !
	`¡©ic_li¡_is_em±y
(&
_wa™”s
) ) {

323 
num_uÄe£rved
 = 
_ÿ·c™y
 - 
_»£rved
;

325 * 
wa™”_node
;

326 
g‘_»t
 =

327 
	`¡©ic_li¡_g‘_h—d
(&
_wa™”s
, &
wa™”_node
);

328 
	`TASSERT
(
g‘_»t
 == 0);

329 
wa™”_node_s
* 
wn
 = (wa™”_node_s*)
wa™”_node
;

331 ià(
num_uÄe£rved
 < 
wn
->
»q_»£rve_couÁ
)

337 
»move_»t
 =

338 
	`¡©ic_li¡_»move_h—d
(&
_wa™”s
, &
wa™”_node
, 
NULL
);

339 
	`TASSERT
(
»move_»t
 == 0);

340 
wn
 = (
wa™”_node_s
*)
wa™”_node
;

342 
_»£rved
 +ğ
wn
->
»q_»£rve_couÁ
;

343 
	`±h»ad_cÚd_sigÇl
(&
wn
->
»que¡_g¿Áed
);

345 
	}
}

	@src/util/rio.cpp

13 
	~"ut/rio.h
"

17 
	~<¡ršg.h
>

18 
	~<sys/ty³s.h
>

19 
	~<uni¡d.h
>

20 
	~<”ºo.h
>

28 
ssize_t
 
rio_»ad
(
rio_t
* 
½
, * 
u¤buf
, ssize_ˆ
n
);

50 
ssize_t
 
	$rio_»adn
(
fd
, * 
u¤buf
, 
size_t
 
n
)

52 
size_t
 
Æeá
 = 
n
;

53 
ssize_t
 
Ä—d
;

54 * 
buå
 = (*)
u¤buf
;

56 
Æeá
 > 0)

58 ià((
Ä—d
 = 
	`»ad
(
fd
, 
buå
, 
Æeá
)) < 0)

60 ià(
”ºo
 =ğ
EINTR
)

61 
Ä—d
 = 0;

65 ià(
Ä—d
 == 0)

67 
Æeá
 -ğ
Ä—d
;

68 
buå
 +ğ
Ä—d
;

71  (
n
 - 
Æeá
);

72 
	}
}

91 
ssize_t
 
	$rio_wr™’
(
fd
, cÚ¡ * 
u¤buf
, 
size_t
 
n
)

93 
size_t
 
Æeá
 = 
n
;

94 
ssize_t
 
nwr™‹n
;

95 * 
buå
 = (*)
u¤buf
;

97 
Æeá
 > 0)

99 ià((
nwr™‹n
 = 
	`wr™e
(
fd
, 
buå
, 
Æeá
)) <= 0)

101 ià(
”ºo
 =ğ
EINTR
)

102 
nwr™‹n
 = 0;

106 
Æeá
 -ğ
nwr™‹n
;

107 
buå
 +ğ
nwr™‹n
;

110  
n
;

111 
	}
}

126 
	$rio_»adš™b
(
rio_t
 *
½
, 
fd
)

128 
½
->
rio_fd
 = 
fd
;

129 
½
->
rio_út
 = 0;

130 
½
->
rio_buåŒ
 =„p->
rio_buf
;

131 
	}
}

150 
ssize_t
 
	$rio_»adnb
(
rio_t
 *
½
, *
u¤buf
, 
size_t
 
n
)

152 
size_t
 
Æeá
 = 
n
;

153 
ssize_t
 
Ä—d
;

154 * 
buå
 = (*)
u¤buf
;

156 
Æeá
 > 0)

158 ià((
Ä—d
 = 
	`rio_»ad
(
½
, 
buå
, 
Æeá
)) < 0)

160 ià(
”ºo
 =ğ
EINTR
)

161 
Ä—d
 = 0;

165 ià(
Ä—d
 == 0)

167 
Æeá
 -ğ
Ä—d
;

168 
buå
 +ğ
Ä—d
;

171  (
n
 - 
Æeá
);

172 
	}
}

192 
ssize_t
 
	$rio_»adlšeb
(
rio_t
 *
½
, *
u¤buf
, 
size_t
 
maxËn
)

194 
rc
;

195 
size_t
 
n
;

196 
c
, *
buå
 = (*)
u¤buf
;

199 
n
 = 1;‚ < 
maxËn
;‚++)

201 ià((
rc
 = 
	`rio_»ad
(
½
, &
c
, 1)) == 1)

203 *
buå
++ = 
c
;

204 ià(
c
 == '\n')

207 ià(
rc
 == 0)

209 ià(
n
 == 1)

219 *
buå
 = 0;

220  
n
;

221 
	}
}

249 
ssize_t
 
	$rio_»ad
(
rio_t
* 
½
, * 
u¤buf
, 
ssize_t
 
n
)

252 
út
;

256 
½
->
rio_út
 <= 0)

258 
½
->
rio_út
 = 
	`»ad
Ôp->
rio_fd
,„p->
rio_buf
, (rp->rio_buf));

259 ià(
½
->
rio_út
 < 0)

261 ià(
”ºo
 !ğ
EINTR
)

264 ià(
½
->
rio_út
 == 0)

267 
½
->
rio_buåŒ
 =„p->
rio_buf
;

272 
út
 = 
n
;

273 ià(
½
->
rio_út
 < 
n
)

274 
út
 = 
½
->
rio_út
;

275 
	`memıy
(
u¤buf
, 
½
->
rio_buåŒ
, 
út
);

276 
½
->
rio_buåŒ
 +ğ
út
;

277 
½
->
rio_út
 -ğ
út
;

280  
út
;

281 
	}
}

	@src/util/shell.cpp

32 
	~"k_defšes.h
"

33 
	~"ut/sh–l.h
"

34 
	~"ut/chomp.h
"

35 
	~"ut/tı.h
"

36 
	~"ut/’vv¬.h
"

37 
	~"ut/hi¡Üy.h
"

40 
	$sig_hªdËr_fwd
(
sig
)

42 
sh–l_t
::
	`sig_hªdËr
(
sig
);

43 
	}
}

55 
	gsh–l_t
::
	$sh–l_t
(cÚ¡ * 
´om±
,

56 cÚ¡ 
boŞ
 
§ve_hi¡Üy
,

57 cÚ¡ 
boŞ
 
Ãt_mode
,

58 cÚ¡ 
ušt_t
 
Ãt_pÜt
,

59 cÚ¡ 
boŞ
 
šputfe_mode
,

60 cÚ¡ 
¡ršg
 
šputfe


62 : 
	`_cmd_couÁ”
(0),

63 
	`_§ve_hi¡Üy
(
§ve_hi¡Üy
),

64 
	`_¡©e
(
SHELL_NEXT_CONTINUE
),

65 
	`_´oûssšg_commªd
(
çl£
),

66 
	`_Ãt_mode
(
Ãt_mode
),

67 
	`_Ãt_pÜt
(
Ãt_pÜt
),

68 
	`_šputfe_mode
(
šputfe_mode
),

69 
	`_šputfe
(
šputfe
),

70 
	`_li¡’_fd
(-1), 
	`_cÚn_fd
(-1), 
	$_Ãt_cÚn_út
(0)

73 
_cmd_´om±
 = 
Ãw
 [
SHELL_COMMAND_BUFFER_SIZE
];

74 
	`mem£t
(
_cmd_´om±
,0,
SHELL_COMMAND_BUFFER_SIZE
);

75 ià(
´om±
è
	`¡ºıy
(
_cmd_´om±
,…rom±, 
	`¡¾’
(prompt));

76 
	`_»gi¡”_commªds
();

77 
	}
}

89 
	gsh–l_t
::~
	$sh–l_t
()

92 ià(
_šputfe_mode
)

94 
_šputfe¡»am
.
	`şo£
();

96 
	}
}

112 
	gsh–l_t
::
	$¡¬t
()

115 
	`š¡ªû
(èğ
this
;

116 
sigaùiÚ
 
§
;

117 
sigaùiÚ
 
§_Şd
;

118 
§
.
§_æags
 = 0;

119 
	`sigem±y£t
(&
§
.
§_mask
);

121 
§
.
§_hªdËr
 = &
sig_hªdËr_fwd
;

123 ià(
	`sigaùiÚ
(
SIGINT
, &
§
, &
§_Şd
) < 0) {

124 
	`TRACE
Ğ
TRACE_ALWAYS
, "Cannot install SIGINT handler\n");

129 ià(
_Ãt_mode
) {

131 
_li¡’_fd
 = 
	`İ’_li¡’fd
(
_Ãt_pÜt
);

132 ià(
_li¡’_fd
 == -1) {

133 
	`TRACE
Ğ
TRACE_ALWAYS
, "Could‚ot open†ist…ort (%d):\n%s\n",

134 
_Ãt_pÜt
, 
	`¡»¼Ü
(
”ºo
));

140 ià(
_šputfe_mode
)

143 
_šputfe¡»am
.
	`İ’
(
_šputfe
.
	`c_¡r
());

144 ià((!
_šputfe¡»am
.
	`is_İ’
()è|| (!_šputfe¡»am.
	`good
()))

146 
	`TRACE
Ğ
TRACE_ALWAYS
, "File (%s)ƒmpty or‚ot found.\n",

147 
_šputfe
.
	`c_¡r
());

153 
	`š™_cmds
();

156 #ifdeà
HAVE_READLINE


157 ià(
_§ve_hi¡Üy
) {

158 
_§ve_hi¡Üy
 = 
	`hi¡Üy_İ’
();

163 
_¡©e
 = 
SHELL_NEXT_CONTINUE
;

164 
_¡©e
 =ğ
SHELL_NEXT_CONTINUE
)

166 ià(
_Ãt_mode
)

168 
_¡©e
 = 
	`´oûss_ÃtwÜk
();

169 ià(
_¡©e
 =ğ
SHELL_NEXT_DISCONNECT
)

171 
_cÚn_fd
 = -1;

172 
_¡©e
 = 
SHELL_NEXT_CONTINUE
;

176 ià(
_šputfe_mode
)

178 
_¡©e
 = 
	`´oûss_f–še
();

182 
_¡©e
 = 
	`´oûss_»adlše
();

188 #ifdeà
HAVE_READLINE


189 ià(
_§ve_hi¡Üy
) {

190 
	`TRACE
Ğ
TRACE_ALWAYS
, "Saving history. (%d) commands...\n",

191 
_cmd_couÁ”
);

192 
	`hi¡Üy_şo£
();

197 
	`şo£_cmds
();

200 
	`sigaùiÚ
(
SIGINT
, &
§_Şd
, 0);

203 
	}
}

215 
	gsh–l_t
::
	$´oûss_»adlše
()

217 
	`as£¹
 (!
_Ãt_mode
);

218 
	`as£¹
 (!
_šputfe_mode
);

220 *
cmd
 = (*)
NULL
;

223 #ifdeà
HAVE_READLINE


224 
cmd
 = 
	`»adlše
(
_cmd_´om±
);

226 
	#SZ
 127

	)

227 
	#STR
(
x
è
	`_STR
(x)

	)

228 
	#_STR
(
x
è#x

	)

229 
¡¬t
 = 0;

230 
sz
 = 
SZ
;

231 
cmd
 = (*è
	`m®loc
(
sz
+1);

232 
’d
;

233 
agaš
:

234 
»ad
 = 
	`fsÿnf
(
¡dš
, "%" 
	`STR
(
SZ
è"[^\n]%c", 
cmd
+
¡¬t
, &
’d
);

235 ià(
»ad
 == 2) {

236 ià(
’d
 != '\n') {

237 
cmd
[
sz
] = 
’d
;

238 
¡¬t
 = 
sz
+1;

239 
sz
 +ğ
SZ
;

240 
cmd
 = (*è
	`»®loc
(cmd, 
sz
);

241 
agaš
;

244 
cmd
[
sz
] = 0;

247 #undeà
SZ


248 #undeà
STR


249 #undeà
_STR


251 ià(
cmd
 =ğ
NULL
) {

253  (
SHELL_NEXT_QUIT
);

256  (
	`´oûss_Úe
(
cmd
));

257 
	}
}

269 
	gsh–l_t
::
	$´oûss_ÃtwÜk
()

271 
	`as£¹
 (
_Ãt_mode
);

272 
	`as£¹
 (!
_šputfe_mode
);

273 
	`as£¹
 (
_li¡’_fd
>=0);

276 ià(
_cÚn_fd
<0) {

280 
	`TRACE
Ğ
TRACE_ALWAYS
,

282 
_Ãt_cÚn_út
, 
_Ãt_pÜt
);

283 
_ş›Á_Ën
 = (
_ş›Á_addr
);

285 
_cÚn_fd
 = 
	`acû±
(
_li¡’_fd
,

286 (
sockaddr
*)&
_ş›Á_addr
,

287 (
sockËn_t
*)&
_ş›Á_Ën
);

289 ià(
_cÚn_fd
 < 0) {

290 
	`TRACE
Ğ
TRACE_ALWAYS
, "Error‡ccepting‚ew connection\n");

291  (
SHELL_NEXT_QUIT
);

295 
_š_¡»am
 = 
	`fdİ’
(
_cÚn_fd
, "r");

296 ià(
_š_¡»am
.
	`g‘
(è=ğ
NULL
) {

297 
	`TRACE
Ğ
TRACE_ALWAYS
,

299 
_cÚn_fd
);

300 
	`şo£
(
_cÚn_fd
);

301  (
SHELL_NEXT_QUIT
);

304 
	`TRACE
Ğ
TRACE_ALWAYS
, "Client connection opened...\n");

305 ++
_Ãt_cÚn_út
;

308 
	`as£¹
 (
_š_¡»am
.
	`g‘
());

310 
cmd
[
SERVER_COMMAND_BUFFER_SIZE
];

313 * 
fg‘s_»t
 = 
	`fg‘s
(
cmd
, (cmd), 
_š_¡»am
);

314 ià(
fg‘s_»t
 =ğ
NULL
) {

316  (
SHELL_NEXT_QUIT
);

320 
	`chomp_Ãwlše
(
cmd
);

321 
	`chomp_ÿ¼Ÿge_»tuº
(
cmd
);

323  (
	`´oûss_Úe
(
cmd
));

324 
	}
}

336 
	gsh–l_t
::
	$´oûss_f–še
()

338 
	`as£¹
 (!
_Ãt_mode
);

339 
	`as£¹
 (
_šputfe_mode
);

341 
¡ršg
 
cmd_»ad
;

344 ià(
_šputfe¡»am
.
	`eof
())

346  (
SHELL_NEXT_QUIT
);

348 
	`g‘lše
(
_šputfe¡»am
,
cmd_»ad
);

349 
cout
 << "FILECMD: " << 
cmd_»ad
 << 
’dl
;

357  (
	`´oûss_Úe
(
cmd_»ad
.
	`c_¡r
()));

358 
	}
}

370 
	gsh–l_t
::
	$´oûss_Úe
(cÚ¡ * 
acmd
)

372 
	`as£¹
 (
acmd
 !ğ
NULL
);

375 
cmd_g
[
SERVER_COMMAND_BUFFER_SIZE
];

376 
	`CRITICAL_SECTION
(
sh_cs
,
_lock
);

379 iàĞ
	`ssÿnf
(
acmd
, "%s", 
cmd_g
) < 1) {

380 
_h–³r
->
	`li¡_cmds
();

381  (
SHELL_NEXT_CONTINUE
);

385 #ifdeà
HAVE_READLINE


386 ià(*
acmd
) {

388 
	`add_hi¡Üy
(
acmd
);

393 ++
_cmd_couÁ”
;

396 
_´oûssšg_commªd
 = 
Œue
;

397 
rv®
=0;

398 
cmdM­It
 
cmd™
 = 
_®Ÿ£s
.
	`fšd
(
cmd_g
);

399 ià(
cmd™
 =ğ
_®Ÿ£s
.
	`’d
()) {

400 
	`TRACE
Ğ
TRACE_ALWAYS
, "UnknowÀcommªd (%s)\n", 
cmd_g
);

401 
rv®
 = 
SHELL_NEXT_CONTINUE
;

404 
rv®
 = 
cmd™
->
£cÚd
->
	`hªdË
(
acmd
);

406 
_´oûssšg_commªd
 = 
çl£
;

409  (
rv®
);

410 
	}
}

421 
	gsh–l_t
::
	$add_cmd
(
commªd_hªdËr_t
* 
acmd
)

423 
	`as£¹
 (
acmd
);

424 
	`as£¹
 (!
acmd
->
	`Çme
().
	`em±y
());

425 
cmdM­It
 
cmd™
;

428 
cmd™
 = 
_cmds
.
	`fšd
(
acmd
->
	`Çme
());

429 ià(
cmd™
!=
_cmds
.
	`’d
()) {

430 
	`TRACE
Ğ
TRACE_ALWAYS
,

432 
acmd
->
	`Çme
().
	`c_¡r
());

436 
	`TRACE
Ğ
TRACE_DEBUG
,

438 
acmd
->
	`Çme
().
	`c_¡r
());

439 
_cmds
[
acmd
->
	`Çme
()] =‡cmd;

443 
»gs
=0;

444 
veùÜ
<
¡ršg
>* 
­l
 = 
acmd
->
	`®Ÿ£s
();

445 
	`as£¹
 (
­l
);

446 
veùÜ
<
¡ršg
>::
™”©Ü
 
®™
 = 
­l
->
	`begš
();‡l™ !ğ­l->
	`’d
(); ++alit) {

447 
cmd™
 = 
_®Ÿ£s
.
	`fšd
(*
®™
);

448 ià(
cmd™
!=
_®Ÿ£s
.
	`’d
()) {

449 
	`TRACE
Ğ
TRACE_ALWAYS
,

451 (*
®™
).
	`c_¡r
());

454 
	`TRACE
Ğ
TRACE_DEBUG
,

456 (*
®™
).
	`c_¡r
());

457 
_®Ÿ£s
[*
®™
]=
acmd
;

458 ++
»gs
;

461 
	`as£¹
 (
»gs
);

463 
	}
}

476 
	gsh–l_t
::
	$š™_cmds
()

478 
	`CRITICAL_SECTION
(
sh_cs
,
_lock
);

479 
cmdM­It
 
™
 = 
_cmds
.
	`begš
(); iˆ!ğ_cmds.
	`’d
(); ++it) {

480 
™
->
£cÚd
->
	`š™
();

483 
	}
}

496 
	gsh–l_t
::
	$şo£_cmds
()

498 
	`CRITICAL_SECTION
(
sh_cs
,
_lock
);

499 
cmdM­It
 
™
 = 
_cmds
.
	`begš
(); iˆ!ğ_cmds.
	`’d
(); ++it) {

500 
™
->
£cÚd
->
	`şo£
();

503 
	}
}

516 
	gsh–l_t
::
	$_»gi¡”_commªds
()

518 
	`REGISTER_CMD
(
Œaû_cmd_t
,
_Œaûr
);

519 
	`REGISTER_CMD
(
cÚf_cmd_t
,
_cÚãr
);

520 
	`REGISTER_CMD
(
’v_cmd_t
,
_’v”
);

521 
	`REGISTER_CMD
(
£t_cmd_t
,
_£‹r
);

522 
	`REGISTER_CMD
(
qu™_cmd_t
,
_qu™”
);

523 
	`REGISTER_CMD
(
echo_cmd_t
,
_echÛr
);

524 
	`REGISTER_CMD
(
b»ak_cmd_t
,
_b»ak”
);

525 
	`REGISTER_CMD
(
zf_cmd_t
,
_zãr
);

527 
	`REGISTER_CMD_PARAM
(
h–p_cmd_t
,
_h–³r
,&
_cmds
);

530 
	}
}

548 
	gqu™_cmd_t
::
	$£lŸ£s
()

550 
_Çme
 = 
	`¡ršg
("quit");

551 
_®Ÿ£s
.
	`push_back
("quit");

552 
_®Ÿ£s
.
	`push_back
("q");

553 
_®Ÿ£s
.
	`push_back
("exit");

554 
	}
}

564 
	gdiscÚÃù_cmd_t
::
	$£lŸ£s
()

566 
_Çme
 = 
	`¡ršg
("disconnect");

567 
_®Ÿ£s
.
	`push_back
("disconnect");

568 
_®Ÿ£s
.
	`push_back
("d");

569 
	}
}

578 
	gh–p_cmd_t
::
	$£lŸ£s
()

580 
_Çme
 = 
	`¡ršg
("help");

581 
_®Ÿ£s
.
	`push_back
("help");

582 
_®Ÿ£s
.
	`push_back
("h");

583 
	}
}

586 
	gh–p_cmd_t
::
	$li¡_cmds
()

588 
	`TRACE
Ğ
TRACE_ALWAYS
,

590 
cmdM­It
 
™
 = 
_pcmds
->
	`begš
(); iˆ!ğ_pcmds->
	`’d
(); ++it) {

591 
	`TRACE
Ğ
TRACE_ALWAYS
, " %s - %s\n",

592 
™
->
fœ¡
.
	`c_¡r
(), it->
£cÚd
->
	`desc
().c_str());

594 
	}
}

597 
	gh–p_cmd_t
::
	$hªdË
(cÚ¡ * 
cmd
)

599 
h–p_g
[
SERVER_COMMAND_BUFFER_SIZE
];

600 
cmd_g
[
SERVER_COMMAND_BUFFER_SIZE
];

601 iàĞ
	`ssÿnf
(
cmd
, "% %s", 
h–p_g
, 
cmd_g
) < 2) {

603 
	`li¡_cmds
();

604  (
SHELL_NEXT_CONTINUE
);

607 
cmdM­It
 
™
 = 
_pcmds
->
	`fšd
(
cmd_g
);

608 ià(
™
==
_pcmds
->
	`’d
()) {

609 
	`TRACE
Ğ
TRACE_ALWAYS
,"Cmd (%sènÙ found\n", 
cmd_g
);

610  (
SHELL_NEXT_CONTINUE
);

612 
™
->
£cÚd
->
	`u§ge
();

613  (
SHELL_NEXT_CONTINUE
);

614 
	}
}

623 
	g£t_cmd_t
::
	$š™
()

625 
ev
 = 
’vV¬
::
	`š¡ªû
();

626 
	}
}

628 
	g£t_cmd_t
::
	$£lŸ£s
()

630 
_Çme
 = 
	`¡ršg
("set");

631 
_®Ÿ£s
.
	`push_back
("set");

632 
_®Ÿ£s
.
	`push_back
("s");

633 
	}
}

636 
	g£t_cmd_t
::
	$hªdË
(cÚ¡ * 
cmd
)

638 
	`as£¹
 (
ev
);

639 
ev
->
	`·r£S‘Req
(
cmd
);

640  (
SHELL_NEXT_CONTINUE
);

641 
	}
}

644 
	g£t_cmd_t
::
	$u§ge
()

646 
	`TRACE
Ğ
TRACE_ALWAYS
, "SET Usage:\n\n" \

651 
	}
}

660 
	g’v_cmd_t
::
	$š™
()

662 
ev
 = 
’vV¬
::
	`š¡ªû
();

663 
	}
}

665 
	g’v_cmd_t
::
	$£lŸ£s
()

667 
_Çme
 = 
	`¡ršg
("env");

668 
_®Ÿ£s
.
	`push_back
("env");

669 
_®Ÿ£s
.
	`push_back
("e");

670 
	}
}

673 
	g’v_cmd_t
::
	$hªdË
(cÚ¡ * 
cmd
)

675 
	`as£¹
 (
ev
);

676 
cmd_g
[
SERVER_COMMAND_BUFFER_SIZE
];

677 
’v_g
[
SERVER_COMMAND_BUFFER_SIZE
];

678 iàĞ
	`ssÿnf
(
cmd
, "% %s", 
cmd_g
, 
’v_g
) < 2) {

680 
ev
->
	`´štV¬s
();

681  (
SHELL_NEXT_CONTINUE
);

683 
ev
->
	`checkV¬
(
’v_g
);

684  (
SHELL_NEXT_CONTINUE
);

685 
	}
}

688 
	g’v_cmd_t
::
	$u§ge
()

690 
	`TRACE
Ğ
TRACE_ALWAYS
, "ENV Usage:\n\n" \

695 
	}
}

704 
	gcÚf_cmd_t
::
	$š™
()

706 
ev
 = 
’vV¬
::
	`š¡ªû
();

707 
	}
}

709 
	gcÚf_cmd_t
::
	$£lŸ£s
()

711 
_Çme
 = 
	`¡ršg
("conf");

712 
_®Ÿ£s
.
	`push_back
("conf");

713 
_®Ÿ£s
.
	`push_back
("c");

714 
	}
}

717 
	gcÚf_cmd_t
::
	$hªdË
(const * )

719 
ev
->
	`»äeshV¬s
();

720  (
SHELL_NEXT_CONTINUE
);

721 
	}
}

724 
	gcÚf_cmd_t
::
	$u§ge
()

726 
	`TRACE
Ğ
TRACE_ALWAYS
,

728 
	}
}

738 
	gzf_cmd_t
::
	$£lŸ£s
()

740 
_Çme
 = 
	`¡ršg
("zipf");

741 
_®Ÿ£s
.
	`push_back
("zipf");

742 
_®Ÿ£s
.
	`push_back
("z");

743 
	}
}

745 
	gzf_cmd_t
::
	$hªdË
(cÚ¡ * 
cmd
)

747 
cmd_g
[
SERVER_COMMAND_BUFFER_SIZE
];

748 
s_g
[
SERVER_COMMAND_BUFFER_SIZE
];

749 iàĞ
	`ssÿnf
(
cmd
, "% %s", 
cmd_g
, 
s_g
) < 2) {

750 
_is_’abËd
 = 
çl£
;

753 
_s
 = 
	`©of
(
s_g
);

754 
_is_’abËd
 = 
Œue
;

757 
	`TRACE
Ğ
TRACE_ALWAYS
, "S‘tšg Zf. EÇbËd=%d. S=%.2f\n", 
_is_’abËd
, 
_s
);

758 
	`£tZf
(
_is_’abËd
,
_s
);

759  (
SHELL_NEXT_CONTINUE
);

760 
	}
}

763 
	gzf_cmd_t
::
	$u§ge
()

765 
	`TRACE
Ğ
TRACE_ALWAYS
,

768 
	}
}

770 
¡ršg
 
	gzf_cmd_t
::
	$desc
() const

772  
	`¡ršg
("Enables/Disables zipfian input generation");

773 
	}
}

	@src/util/skewer.cpp

31 
	~"ut/skew”.h
"

32 
	~"ut/¿ndom_šput.h
"

52 
	gskew”_t
::
	$£t
(
¬—
, 
low”
, 
uµ”
, 
lßd
)

54 
_¬—
 = 
¬—
;

55 
_low”
 = 
low”
;

56 
_uµ”
 = 
uµ”
;

57 
_lßd
 = 
lßd
;

58 
	`ş—r
();

59 
	`_£t_š‹rv®s
();

60 
	}
}

71 
	gskew”_t
::
	$ş—r
() {

72 
_š‹rv®_l
.
	`ş—r
();

73 
_š‹rv®_u
.
	`ş—r
();

74 
_nÚ_š‹rv®_l
.
	`ş—r
();

75 
_nÚ_š‹rv®_u
.
	`ş—r
();

76 
_is_u£d
 = 
çl£
;

77 
	}
}

89 
	gskew”_t
::
	$»£t
(
skew_ty³_t
 
ty³
) {

90 
	`ş—r
();

91 if(
ty³
 =ğ
SKEW_CHAOTIC
) {

92 
_lßd
 = 
	`URªd
(0,100);

93 
_¬—
 = 
	`URªd
(1,100);

97 
	`_£t_š‹rv®s
();

98 
_is_u£d
 = 
Œue
;

99 
	}
}

110 
boŞ
 
	gskew”_t
::
	$is_u£d
() {

111 if(!
_is_u£d
) {

112 
_is_u£d
 = 
Œue
;

113  
çl£
;

114 }  
Œue
;

115 
	}
}

131 
	gskew”_t
::
	$_£t_š‹rv®s
() {

133 if(
	`URªd
(1,100) < 70) {

134 
š‹rv®_low”
 = 
	`URªd
(
_low”
,
_uµ”
);

135 
š‹rv®_uµ”
 = 
š‹rv®_low”
 + 
	`û
(((è((
_uµ”
 - 
_low”
 + 1è* 
_¬—
))/100);

136 
	`_add_š‹rv®
(
š‹rv®_low”
, 
š‹rv®_uµ”
);

138 
š‹rv®
 = 
	`û
(((è((
_uµ”
 - 
_low”
 + 1è* 
_¬—
))/200);

139 
š‹rv®_low”
 = 
	`URªd
(
_low”
,
_uµ”
);

140 
š‹rv®_uµ”
 = 
š‹rv®_low”
 + 
š‹rv®
;

141 
š‹rv®_low”_2
 = 
	`URªd
(
š‹rv®_low”
,
_uµ”
);

142 
š‹rv®_uµ”_2
 = 
š‹rv®_low”_2
 + 
š‹rv®
;

143 
	`_add_š‹rv®
(
š‹rv®_low”
, 
š‹rv®_uµ”
);

144 
	`_add_š‹rv®
(
š‹rv®_low”_2
, 
š‹rv®_uµ”_2
);

147 
i
=0; i<
_š‹rv®_u
.
	`size
(); i++) {

148 if(
i
==0 && 
_š‹rv®_l
[i] > 
_low”
) {

149 
_nÚ_š‹rv®_l
.
	`push_back
(
_low”
);

150 
_nÚ_š‹rv®_u
.
	`push_back
(
_š‹rv®_l
[
i
]-1);

152 if(
i
+1<
_š‹rv®_u
.
	`size
()) {

153 if(
_š‹rv®_u
[
i
]+1 < 
_š‹rv®_l
[i+1]) {

154 
_nÚ_š‹rv®_l
.
	`push_back
(
_š‹rv®_u
[
i
]+1);

155 
_nÚ_š‹rv®_u
.
	`push_back
(
_š‹rv®_l
[
i
+1]-1);

157 } if(
_š‹rv®_u
[
i
] < 
_uµ”
) {

158 
_nÚ_š‹rv®_l
.
	`push_back
(
_š‹rv®_u
[
i
]+1);

159 
_nÚ_š‹rv®_u
.
	`push_back
(
_uµ”
);

164 
	}
}

179 
	gskew”_t
::
	$_add_š‹rv®
(
š‹rv®_low”
, 
š‹rv®_uµ”
) {

181 if(
š‹rv®_low”
 =ğ
_uµ”
 && 
š‹rv®_uµ”
-1>_upper) {

182 
š‹rv®_low”
--;

183 
š‹rv®_uµ”
--;

185 if(
š‹rv®_uµ”
-1 > 
_uµ”
) {

186 if(
_š‹rv®_l
.
	`size
() == 1) {

187 
_š‹rv®_l
.
	`š£¹
(_š‹rv®_l.
	`begš
(), 
_low”
);

188 
_š‹rv®_u
.
	`š£¹
(_š‹rv®_u.
	`begš
(), 
š‹rv®_uµ”
 - 
_uµ”
 - 2 + 
_low”
);

189 
_š‹rv®_l
.
	`push_back
(
š‹rv®_low”
 + 1);

190 
_š‹rv®_u
.
	`push_back
(
_uµ”
);

191 } if(
_š‹rv®_l
.
	`size
() == 2) {

192 if(
_š‹rv®_u
[0] > 
š‹rv®_uµ”
 - 
_uµ”
 - 2 + 
_low”
) {

193 
_š‹rv®_l
.
	`š£¹
(_š‹rv®_l.
	`begš
(), 
_low”
);

194 
_š‹rv®_u
.
	`š£¹
(_š‹rv®_u.
	`begš
(), 
š‹rv®_uµ”
 - 
_uµ”
 - 2 + 
_low”
);

196 
veùÜ
<>::
™”©Ü
 
™”
 = 
_š‹rv®_l
.
	`begš
();

197 
_š‹rv®_l
.
	`š£¹
(++
™”
, 
_low”
);

198 
™”
 = 
_š‹rv®_u
.
	`begš
();

199 
_š‹rv®_u
.
	`š£¹
(++
™”
, 
š‹rv®_uµ”
 - 
_uµ”
 - 2 + 
_low”
);

201 if(
_š‹rv®_l
[2] < 
š‹rv®_low”
+1) {

202 
_š‹rv®_l
.
	`push_back
(
š‹rv®_low”
+1);

203 
_š‹rv®_u
.
	`push_back
(
_uµ”
);

205 
_š‹rv®_l
.
	`push_back
(_interval_l[2]);

206 
_š‹rv®_u
.
	`push_back
(_interval_u[2]);

207 
_š‹rv®_l
[2] = 
š‹rv®_low”
+1;

208 
_š‹rv®_u
[2] = 
_uµ”
;

211 
_š‹rv®_l
.
	`push_back
(
_low”
);

212 
_š‹rv®_u
.
	`push_back
(
š‹rv®_uµ”
 - 
_uµ”
 - 2 + 
_low”
);

213 
_š‹rv®_l
.
	`push_back
(
š‹rv®_low”
+1);

214 
_š‹rv®_u
.
	`push_back
(
_uµ”
);

217 
_š‹rv®_l
.
	`push_back
(
š‹rv®_low”
);

218 
_š‹rv®_u
.
	`push_back
(
š‹rv®_uµ”
 - 1);

220 
	}
}

231 
	gskew”_t
::
	$g‘_šput
() {

232 
šput
 = 0;

233 
boŞ
 
is_£t
 = 
çl£
;

234 
¿nd
 = 
	`URªd
(1,100);

235 
lßd
 = 
_lßd
 / 
_š‹rv®_u
.
	`size
();

236 
i
=0; !
is_£t
 && i<
_š‹rv®_u
.
	`size
(); i++) {

237 if(
¿nd
 < 
lßd
 * (
i
+1)) {

238 
šput
 = 
	`UZRªd
(
_š‹rv®_l
[
i
],
_š‹rv®_u
[i]);

239 
is_£t
 = 
Œue
;

242 
¿nd
 =„ªd - 
_lßd
;

243 
lßd
 = (100 - 
_lßd
è/ 
_nÚ_š‹rv®_u
.
	`size
();

244 
i
=0; !
is_£t
 && i<
_nÚ_š‹rv®_u
.
	`size
(); i++) {

245 if(
¿nd
 < 
lßd
 * (
i
+1)) {

246 
šput
 = 
	`UZRªd
(
_nÚ_š‹rv®_l
[
i
],
_nÚ_š‹rv®_u
[i]);

247 
is_£t
 = 
Œue
;

250 if(!
is_£t
 || (
šput
 < 
_low”
è|| (špuˆ> 
_uµ”
)) {

251 
šput
 = 
	`UZRªd
(
_low”
, 
_uµ”
);

253  
šput
;

254 
	}
}

266 
	gskew”_t
::
	$´št_š‹rv®s
() {

267 
cout
 << "´šˆš‹rv® fÜ (lßd)" << 
’dl
;

268 
i
=0; i<
_š‹rv®_u
.
	`size
(); i++) {

269 
cout
 << 
_š‹rv®_l
[
i
] << " - " << 
_š‹rv®_u
[i] << 
’dl
;

271 
cout
 << "´šˆš‹rv® fÜ (100-lßd)" << 
’dl
;

272 
i
=0; i<
_nÚ_š‹rv®_u
.
	`size
(); i++) {

273 
cout
 << 
_nÚ_š‹rv®_l
[
i
] << " - " << 
_nÚ_š‹rv®_u
[i] << 
’dl
;

275 
	}
}

	@src/util/static_hash_map.cpp

43 
	~<c¡dlib
>

44 
	~"ut/¡©ic_hash_m­.h
"

45 
	~"ut/¡©ic_hash_m­_¡ruù.h
"

50 * 
¡©ic_hash_node_g‘_key
(
¡©ic_hash_node_t
 
node
);

51 * 
¡©ic_hash_node_g‘_v®ue
(
¡©ic_hash_node_t
 
node
);

52 
¡©ic_hash_node_t
 
¡©ic_hash_node_g‘_Ãxt
(¡©ic_hash_node_ˆ
node
);

53 
¡©ic_hash_node_š£¹_aá”
(
¡©ic_hash_node_t
 
š£¹_aá”_this
,

54 
¡©ic_hash_node_t
 
node_to_š£¹
);

55 
¡©ic_hash_node_cut
(
¡©ic_hash_node_t
 
node
);

81 
¡©ic_hash_m­_š™
(
¡©ic_hash_m­_t
 
ht
,

82 
¡©ic_hash_node_s
* 
bË_’Œ›s
,

83 
size_t
 
bË_size
,

84 
	$size_t
 (*
hf
è(cÚ¡ * 
key
),

85 (*
com·¿tÜ
è(cÚ¡ * 
key1
, cÚ¡ * 
key2
) )

87 
ht
->
bË_’Œ›s
 =able_entries;

88 
ht
->
bË_size
 =able_size;

89 
ht
->
hf
 = hf;

90 
ht
->
com·¿tÜ
 = comparator;

92 
size_t
 
i
;

93 
i
 = 0; i < 
bË_size
; i++)

98 
	`¡©ic_hash_node_š™
Ğ&
bË_’Œ›s
[
i
], 
NULL
, NULL );

100 
	}
}

117 
	$¡©ic_hash_m­_š£¹
(
¡©ic_hash_m­_t
 
ht
,

118 cÚ¡ * 
key
,

119 cÚ¡ * 
v®ue
,

120 
¡©ic_hash_node_t
 
node
)

122 
hash_code
 = 
ht
->
	`hf
(
key
);

123 
hash_šdex
 = 
hash_code
 % 
ht
->
bË_size
;

125 
	`¡©ic_hash_node_š™
Ğ
node
, 
key
, 
v®ue
 );

129 
	`¡©ic_hash_node_š£¹_aá”
Ğ&
ht
->
bË_’Œ›s
[
hash_šdex
], 
node
 );

130 
	}
}

149 
	$¡©ic_hash_m­_fšd
(
¡©ic_hash_m­_t
 
ht
,

150 cÚ¡ * 
key
,

151 ** 
v®ue
,

152 
¡©ic_hash_node_t
* 
node
)

154 
hash_code
 = 
ht
->
	`hf
(
key
);

155 
hash_šdex
 = 
hash_code
 % 
ht
->
bË_size
;

159 
¡©ic_hash_node_t
 
h—d
 =

160 &
ht
->
bË_’Œ›s
[ 
hash_šdex
 ];

162 
¡©ic_hash_node_t
 
cu¼
 =

163 
	`¡©ic_hash_node_g‘_Ãxt
Ğ
h—d
 );

165  
cu¼
 !ğ
h—d
 )

167 * 
node_key
 =

168 
	`¡©ic_hash_node_g‘_key
Ğ
cu¼
 );

170 iàĞ!
ht
->
	`com·¿tÜ
Ğ
node_key
, 
key
 ) )

173 iàĞ
v®ue
 !ğ
NULL
 )

174 *
v®ue
 = 
	`¡©ic_hash_node_g‘_v®ue
Ğ
cu¼
 );

175 iàĞ
node
 !ğ
NULL
 )

176 *
node
 = 
cu¼
;

181 
cu¼
 = 
	`¡©ic_hash_node_g‘_Ãxt
( curr );

187 
	}
}

207 
	$¡©ic_hash_m­_»move
(
¡©ic_hash_m­_t
 
ht
,

208 cÚ¡ * 
key
,

209 ** 
v®ue
,

210 
¡©ic_hash_node_t
* 
node
)

213 * 
’Œy_v®ue
;

214 
¡©ic_hash_node_t
 
’Œy_node
;

215 iàĞ!
	`¡©ic_hash_m­_fšd
Ğ
ht
, 
key
, &
’Œy_v®ue
, &
’Œy_node
 ) )

218 
	`¡©ic_hash_m­_cut
Ğ
ht
, 
’Œy_node
 );

220 iàĞ
v®ue
 !ğ
NULL
 )

221 *
v®ue
 = 
’Œy_v®ue
;

223 iàĞ
node
 !ğ
NULL
 )

224 *
node
 = 
’Œy_node
;

231 
	}
}

245 
	$¡©ic_hash_m­_cut
(
¡©ic_hash_m­_t
 
ht
, 
¡©ic_hash_node_t
 
node
)

247 
ht
 = ht;

248 
	`¡©ic_hash_node_cut
Ğ
node
 );

249 
	}
}

268 
	$¡©ic_hash_node_š™
(
¡©ic_hash_node_t
 
node
, cÚ¡ * 
key
, cÚ¡ * 
v®ue
)

270 
node
->
Ãxt
 =‚ode->
´ev
 =‚ode;

271 
node
->
key
 = key;

272 
node
->
v®ue
 = value;

273 
	}
}

283 * 
	$¡©ic_hash_node_g‘_key
(
¡©ic_hash_node_t
 
node
)

285  (*)
node
->
key
;

286 
	}
}

296 * 
	$¡©ic_hash_node_g‘_v®ue
(
¡©ic_hash_node_t
 
node
)

298  (*)
node
->
v®ue
;

299 
	}
}

310 
¡©ic_hash_node_t
 
	$¡©ic_hash_node_g‘_Ãxt
(
¡©ic_hash_node_t
 
node
)

312  
node
->
Ãxt
;

313 
	}
}

329 
	$¡©ic_hash_node_š£¹_aá”
(
¡©ic_hash_node_t
 
š£¹_aá”_this
,

330 
¡©ic_hash_node_t
 
node_to_š£¹
)

333 
node_to_š£¹
->
Ãxt
 = 
š£¹_aá”_this
->next;

334 
node_to_š£¹
->
´ev
 = 
š£¹_aá”_this
;

337 
š£¹_aá”_this
->
Ãxt
 = 
node_to_š£¹
;

338 
node_to_š£¹
->
Ãxt
->
´ev
 =‚ode_to_insert;

339 
	}
}

351 
	$¡©ic_hash_node_cut
(
¡©ic_hash_node_t
 
node
)

354 
node
->
Ãxt
->
´ev
 =‚ode->prev;

355 
node
->
´ev
->
Ãxt
 =‚ode->next;

358 
node
->
Ãxt
 =‚ode->
´ev
 =‚ode;

359 
	}
}

	@src/util/static_list.cpp

45 
	~<¡dlib.h
>

46 
	~"ut/¡©ic_li¡.h
"

47 
	~"ut/¡©ic_li¡_¡ruù.h
"

48 
	~"ut/¡©ic_li¡_node.h
"

60 
	$¡©ic_li¡_š™
(
¡©ic_li¡_t
 
li¡
)

63 
	`¡©ic_li¡_node_š™_em±y
Ğ&
li¡
->
dummy
 );

64 
	}
}

80 
	$¡©ic_li¡_´•’d
(
¡©ic_li¡_t
 
li¡
, * 
v®ue
, 
¡©ic_li¡_node_t
 
node
)

82 
	`¡©ic_li¡_node_š™
Ğ
node
, 
v®ue
 );

83 
	`¡©ic_li¡_node_š£¹_aá”
Ğ&
li¡
->
dummy
, 
node
 );

84 
	}
}

100 
	$¡©ic_li¡_­³nd
(
¡©ic_li¡_t
 
li¡
, * 
v®ue
, 
¡©ic_li¡_node_t
 
node
)

102 
	`¡©ic_li¡_node_š™
Ğ
node
, 
v®ue
 );

103 
	`¡©ic_li¡_node_š£¹_befÜe
Ğ&
li¡
->
dummy
, 
node
 );

104 
	}
}

119 
	$¡©ic_li¡_»move_node
(
¡©ic_li¡_t
 
li¡
, 
¡©ic_li¡_node_t
 
node
)

122 
li¡
 =†ist;

123 
	`¡©ic_li¡_node_cut
(
node
);

124 
	}
}

142 
	$¡©ic_li¡_»move_h—d
(
¡©ic_li¡_t
 
li¡
, ** 
»suÉ
, 
¡©ic_li¡_node_t
* 
node
)

145 iàĞ
	`¡©ic_li¡_is_em±y
(
li¡
) )

150 
¡©ic_li¡_node_t
 
»moved_node
 = 
	`¡©ic_li¡_node_g‘_Ãxt
Ğ&
li¡
->
dummy
 );

151 
	`¡©ic_li¡_node_cut
Ğ
»moved_node
 );

155 *
»suÉ
 = 
	`¡©ic_li¡_node_g‘_·ylßd
(
»moved_node
);

156 iàĞ
node
 !ğ
NULL
 )

157 *
node
 = 
»moved_node
;

160 
	}
}

178 
	$¡©ic_li¡_»move_
(
¡©ic_li¡_t
 
li¡
, ** 
»suÉ
, 
¡©ic_li¡_node_t
* 
node
)

181 iàĞ
	`¡©ic_li¡_is_em±y
(
li¡
) )

186 
¡©ic_li¡_node_t
 
»moved_node
 = 
	`¡©ic_li¡_node_g‘_´ev
Ğ&
li¡
->
dummy
 );

187 
	`¡©ic_li¡_node_cut
Ğ
»moved_node
 );

191 *
»suÉ
 = 
	`¡©ic_li¡_node_g‘_·ylßd
Ğ
»moved_node
 );

192 iàĞ
node
 !ğ
NULL
 )

193 *
node
 = 
»moved_node
;

196 
	}
}

211 
	$¡©ic_li¡_g‘_h—d
(
¡©ic_li¡_t
 
li¡
, ** 
»suÉ
)

214 iàĞ
	`¡©ic_li¡_is_em±y
(
li¡
) )

217 
¡©ic_li¡_node_t
 
node
 = 
	`¡©ic_li¡_node_g‘_Ãxt
Ğ&
li¡
->
dummy
 );

218 *
»suÉ
 = 
	`¡©ic_li¡_node_g‘_·ylßd
(
node
);

221 
	}
}

236 
	$¡©ic_li¡_g‘_
(
¡©ic_li¡_t
 
li¡
, ** 
»suÉ
)

239 iàĞ
	`¡©ic_li¡_is_em±y
(
li¡
) )

242 
¡©ic_li¡_node_t
 
node
 = 
	`¡©ic_li¡_node_g‘_´ev
Ğ&
li¡
->
dummy
 );

243 *
»suÉ
 = 
	`¡©ic_li¡_node_g‘_·ylßd
(
node
);

246 
	}
}

260 
	$¡©ic_li¡_is_em±y
(
¡©ic_li¡_t
 
li¡
)

263  
	`¡©ic_li¡_node_is_sšgËtÚ
Ğ&
li¡
->
dummy
 );

264 
	}
}

284 
¡©ic_li¡_m­
(
¡©ic_li¡_t
 
li¡
,

285 * (*
m­
) (*,*),

286 * 
m­_¡©e
)

290 
¡©ic_li¡_node_t
 
	gcu¼
 = 
¡©ic_li¡_node_g‘_Ãxt
Ğ&
li¡
->
dummy
 );

293  
	gcu¼
 !ğ&
li¡
->
dummy
 )

296 * 
·ylßd
 = 
¡©ic_li¡_node_g‘_·ylßd
(
cu¼
);

299 * 
	gupd©ed_·ylßd
 = 
m­
(
·ylßd
, 
m­_¡©e
);

300 
¡©ic_li¡_node_£t_·ylßd
(
cu¼
, 
upd©ed_·ylßd
);

303 
	gcu¼
 = 
¡©ic_li¡_node_g‘_Ãxt
(
cu¼
);

324 
¡©ic_li¡_m­_»v”£
(
¡©ic_li¡_t
 
li¡
,

325 * (*
m­
) (*,*),

326 * 
m­_¡©e
)

330 
¡©ic_li¡_node_t
 
	gcu¼
 = 
¡©ic_li¡_node_g‘_´ev
Ğ&
li¡
->
dummy
 );

333  
	gcu¼
 !ğ&
li¡
->
dummy
 )

336 * 
·ylßd
 = 
¡©ic_li¡_node_g‘_·ylßd
(
cu¼
);

339 * 
	gupd©ed_·ylßd
 = 
m­
(
·ylßd
, 
m­_¡©e
);

340 
¡©ic_li¡_node_£t_·ylßd
(
cu¼
, 
upd©ed_·ylßd
);

343 
	gcu¼
 = 
¡©ic_li¡_node_g‘_´ev
(
cu¼
);

368 
¡©ic_li¡_´oûss
(
¡©ic_li¡_t
 
li¡
,

369 (*
´oûss
) (*,*),

370 * 
´oûssšg_¡©e
)

374 
¡©ic_li¡_node_t
 
cu¼
 = 
	`¡©ic_li¡_node_g‘_Ãxt
Ğ&
li¡
->
dummy
 );

377  
cu¼
 !ğ&
li¡
->
dummy
 )

380 * 
·ylßd
 = 
	`¡©ic_li¡_node_g‘_·ylßd
(
cu¼
);

383 
k“p_gošg
 = 
	`´oûss
(
·ylßd
, 
´oûssšg_¡©e
);

384 iàĞ!
k“p_gošg
 ) ;

387 
cu¼
 = 
	`¡©ic_li¡_node_g‘_Ãxt
(curr);

389 
	}
}

409 
¡©ic_li¡_´oûss_»v”£
(
¡©ic_li¡_t
 
li¡
,

410 (*
´oûss
) (*,*),

411 * 
´oûssšg_¡©e
)

415 
¡©ic_li¡_node_t
 
cu¼
 = 
	`¡©ic_li¡_node_g‘_´ev
Ğ&
li¡
->
dummy
 );

418  
cu¼
 !ğ&
li¡
->
dummy
 )

421 * 
·ylßd
 = 
	`¡©ic_li¡_node_g‘_·ylßd
(
cu¼
);

424 
k“p_gošg
 = 
	`´oûss
(
·ylßd
, 
´oûssšg_¡©e
);

425 iàĞ!
k“p_gošg
 ) ;

428 
cu¼
 = 
	`¡©ic_li¡_node_g‘_´ev
(curr);

430 
	}
}

	@src/util/static_list_node.cpp

41 
	~<¡dlib.h
>

42 
	~"ut/¡©ic_li¡_node.h
"

43 
	~"ut/¡©ic_li¡_node_¡ruù.h
"

57 
	$¡©ic_li¡_node_š™_em±y
(
¡©ic_li¡_node_t
 
node
)

59 
node
->
Ãxt
 =‚ode->
´ev
 =‚ode;

60 
node
->
·ylßd
 = 
NULL
;

61 
	}
}

76 
	$¡©ic_li¡_node_š™
(
¡©ic_li¡_node_t
 
node
, * 
·ylßd
)

78 
	`¡©ic_li¡_node_š™_em±y
(
node
);

79 
node
->
·ylßd
 =…ayload;

80 
	}
}

92 * 
	$¡©ic_li¡_node_g‘_·ylßd
(
¡©ic_li¡_node_t
 
node
)

94  
node
->
·ylßd
;

95 
	}
}

108 
¡©ic_li¡_node_t
 
	$¡©ic_li¡_node_g‘_´ev
(
¡©ic_li¡_node_t
 
node
)

110  
node
->
´ev
;

111 
	}
}

124 
¡©ic_li¡_node_t
 
	$¡©ic_li¡_node_g‘_Ãxt
(
¡©ic_li¡_node_t
 
node
)

126  
node
->
Ãxt
;

127 
	}
}

141 
	$¡©ic_li¡_node_£t_·ylßd
(
¡©ic_li¡_node_t
 
node
, * 
·ylßd
)

143 
node
->
·ylßd
 =…ayload;

144 
	}
}

162 
	$¡©ic_li¡_node_š£¹_aá”
(
¡©ic_li¡_node_t
 
š£¹_aá”_this
,

163 
¡©ic_li¡_node_t
 
node_to_š£¹
)

166 
node_to_š£¹
->
Ãxt
 = 
š£¹_aá”_this
->next;

167 
node_to_š£¹
->
´ev
 = 
š£¹_aá”_this
;

170 
š£¹_aá”_this
->
Ãxt
 = 
node_to_š£¹
;

171 
node_to_š£¹
->
Ãxt
->
´ev
 =‚ode_to_insert;

172 
	}
}

190 
	$¡©ic_li¡_node_š£¹_befÜe
(
¡©ic_li¡_node_t
 
š£¹_befÜe_this
,

191 
¡©ic_li¡_node_t
 
node_to_š£¹
)

194 
node_to_š£¹
->
´ev
 = 
š£¹_befÜe_this
->prev;

195 
node_to_š£¹
->
Ãxt
 = 
š£¹_befÜe_this
;

198 
š£¹_befÜe_this
->
´ev
 = 
node_to_š£¹
;

199 
node_to_š£¹
->
´ev
->
Ãxt
 =‚ode_to_insert;

200 
	}
}

215 
	$¡©ic_li¡_node_is_sšgËtÚ
(
¡©ic_li¡_node_t
 
node
)

217  
node
->
Ãxt
 ==‚ode;

218 
	}
}

232 
	$¡©ic_li¡_node_cut
(
¡©ic_li¡_node_t
 
node
)

235 
node
->
Ãxt
->
´ev
 =‚ode->prev;

236 
node
->
´ev
->
Ãxt
 =‚ode->next;

239 
node
->
Ãxt
 =‚ode->
´ev
 =‚ode;

240 
	}
}

	@src/util/stl_pool.cpp

33 
	~"ut/¡l_poŞ.h
"

34 
	~"ut/Œaû.h
"

37 
	gPoŞ
::
	$PoŞ
Ğ
size_t
 
g¿nuÏr™y
, size_ˆ
size
 )

38 : 
	`m_g¿nuÏr™y
Ğ
g¿nuÏr™y
 ), 
	`m_size
Ğ
size
 ), 
	`m_u£d
Ğ0 ), 
	$m_ov”æow
( 0 )

40 ifĞ
m_size
 > 0 )

42 
m_¡Üage
 = 
Ãw
 [
m_size
*
g¿nuÏr™y
];

43 
m_¦Ùs
 = 
Ãw
 *[
m_size
];

45  
size_t
 
i
 = 0; i < 
m_size
; ++i )

46 
m_¦Ùs
[
i
] = 
»š‹½»t_ÿ¡
<*>Ğ
m_¡Üage
.
	`g‘
(è+ i*
g¿nuÏr™y
 );

48 
	}
}

50 
	gPoŞ
::~
	$PoŞ
()

53 
i
=0; i<3; ++i) {

54 ià((
m_u£d
 =ğ0è&& (
m_ov”æow
 == 0)) {

57 
¡d
::
cout
 << "~" << std::
’dl
;

58 
	`¦“p
(1);

60 
	`as£¹
Ğ
m_u£d
 =ğ0 && 
m_ov”æow
 == 0 && "can't destroy‡…ool with outstanding‡llocations" );

62 
	}
}

64 * 
	gPoŞ
::
	$AÎoÿ‹
()

66 ifĞ
m_u£d
 < 
m_size
 )

68  
m_¦Ùs
[
m_u£d
++];

72 ++
m_ov”æow
;

73 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Ov”æow (%d)\n", 
m_ov”æow
);

74  
»š‹½»t_ÿ¡
<*>Ğ
Ãw
 [
m_g¿nuÏr™y
] );

76 
	}
}

78 
	gPoŞ
::
	$D—Îoÿ‹
Ğ* 
block
 )

80 
	`as£¹
Ğ
block
 && "null…ointer‡rgument" );

81 ifĞ
	`IsFromPoŞ
Ğ
block
 ) )

83 
	`as£¹
Ğ
m_u£d
 > 0 && "internalƒrror" );

84 
m_¦Ùs
[--
m_u£d
] = 
block
;

88 
	`as£¹
Ğ
m_ov”æow
 > 0 && "internalƒrror" );

89 
d–‘e
[] 
»š‹½»t_ÿ¡
<*>Ğ
block
 );

90 --
m_ov”æow
;

92 
	}
}

	@src/util/store_string.cpp

31 
	~"ut/¡Üe_¡ršg.h
"

33 
	~"k_defšes.h
"

42 
	$¡Üe_¡ršg
(* 
de¡
, * 
¤c
) {

43 
Ën
 = 
	`¡¾’
(
¤c
);

44 
	`¡ºıy
(
de¡
, 
¤c
, 
Ën
);

45 
de¡
[
Ën
] = '\0';

46 
	}
}

55 
	$¡Üe_¡ršg
(* 
de¡
, cÚ¡ * 
¤c
) {

56 
Ën
 = 
	`¡¾’
(
¤c
);

57 
	`¡ºıy
(
de¡
, 
¤c
, 
Ën
);

58 
de¡
[
Ën
] = '\0';

59 
	}
}

	@src/util/sunos_procstat.cpp

33 
	~"ut/sunos_´oc¡©.h
"

34 
	~"ut.h
"

36 
	gsunos_´ocmÚ™Ü_t
::
	$sunos_´ocmÚ™Ü_t
(
shÜe
::
ShÜeEnv
* 
’v
,

37 cÚ¡ 
š‹rv®_£c
)

38 : 
	`´ocmÚ™Ü_t
("sunos-mÚ",
’v
,
š‹rv®_£c
),

39 
	`_pkc
(
NULL
), 
	`_’Œ›s_sz
(0),

40 
	`_fœ¡_time
(
Œue
), 
	`_Ï¡_m—su»m’t
(1), 
	`_Ãw_m—su»m’t
(0),

41 
	`_šu£
(0), 
	`_k£
(
NULL
), 
	`_kid
(0), 
	$_kn
(
NULL
)

43 
	`_£tup
(
š‹rv®_£c
);

44 
	}
}

47 
	gsunos_´ocmÚ™Ü_t
::~
	$sunos_´ocmÚ™Ü_t
()

49 ià(*&
_¡©e
 !ğ
CPS_NOTSET
) {

50 
	`k¡©_şo£
(
_pkc
);

52 
	}
}

57 
	gsunos_´ocmÚ™Ü_t
::
	$¡©_»£t
()

59 
_´cšfo
.
	`»£t
();

60 
	}
}

62 
	gsunos_´ocmÚ™Ü_t
::
	$g‘_avg_u§ge
(
boŞ
 
bUpd©eR—dšg
)

64  (*&
_avg_u§ge
);

65 
	}
}

67 
	gsunos_´ocmÚ™Ü_t
::
	$´št_avg_u§ge
()

69 
au
 = *&
_avg_u§ge
;

70 
’Œ›ssz
 = 
_’Œ›s
.
	`size
();

71 
	`TRACE
Ğ
TRACE_STATISTICS
,

73 
au
, 100*×u/
’Œ›ssz
));

74 
	}
}

76 
	gsunos_´ocmÚ™Ü_t
::
	$´št_ext_¡©s
()

78 
_´cšfo
.
	`´št
();

79 
	}
}

81 
ulÚg_t
 
	gsunos_´ocmÚ™Ü_t
::
	$ioch¬s
()

83  (
_´cšfo
.
	`ioch¬s
());

84 
	}
}

86 
ušt
 
	gsunos_´ocmÚ™Ü_t
::
	$g‘_num_of_ıus
()

88  (
_´cšfo
.
	`g‘_num_of_ıus
());

89 
	}
}

91 
ıu_lßd_v®ues_t
 
	gsunos_´ocmÚ™Ü_t
::
	$g‘_lßd
()

93  (
_´cšfo
.
	`g‘_lßd
());

94 
	}
}

99 
	gsunos_´ocmÚ™Ü_t
::
	$_£tup
(cÚ¡ 
š‹rv®_£c
)

101 
´ocmÚ™Ü_t
::
	`_£tup
(
š‹rv®_£c
);

103 
_’Œ›s
.
	`ş—r
();

104 
_’Œ›s
.
	`»£rve
(64);

112 
_pkc
 = 
	`k¡©_İ’
();

113 
k¡©_t
* 
k¥
=
_pkc
->
kc_chaš
; k¥; k¥=k¥->
ks_Ãxt
) {

114 if(
	`¡rcmp
(
k¥
->
ks_moduË
, "ıu"è=ğ0 && sŒcmp(k¥->
ks_Çme
, "sys") == 0) {

115 
kid
 = 
	`k¡©_»ad
(
_pkc
, 
k¥
, 0);

116 
k¡©_Çmed_t
* 
kn
 = (k¡©_Çmed_t*è
k¥
->
ks_d©a
;

117 
i
=0; i < 
k¥
->
ks_nd©a
; i++) {

118 if(
	`¡rcmp
(
kn
[
i
].
Çme
, "cpu_nsec_idle") == 0) {

119 
k¡©_’Œy
 
’Œy
 = {
k¥
, 
i
, {{k¥->
ks_¢­time
, 
kn
->
v®ue
.
ui64
}, {0, 0}}};

120 
_’Œ›s
.
	`push_back
(
’Œy
);

126 
	}
}

130 
w_rc_t
 
	gsunos_´ocmÚ™Ü_t
::
	$ÿ£_£tup
()

132 
_fœ¡_time
 = 
Œue
;

133 
_Ï¡_m—su»m’t
 = 1;

134 
_Ãw_m—su»m’t
 = 0;

135 
_tÙ®s
.
	`£t
(0,0);

136 
_m
.
	`£t
(0,0);

137 
_šu£
 = 0;

138 
_k£
 = 
NULL
;

139 
_kid
 = 0;

140 
_kn
 = 
NULL
;

142 
_’Œ›s_sz
 = 
_’Œ›s
.
	`size
();

143 
	`as£¹
 (
_pkc
);

145  (
RCOK
);

146 
	}
}

148 
w_rc_t
 
	gsunos_´ocmÚ™Ü_t
::
	$ÿ£_tick
()

150 
_Ãw_m—su»m’t
 = 1 - 
_Ï¡_m—su»m’t
;

153 
_tÙ®s
.
	`ş—r
();

155 
i
=0; i<
_’Œ›s_sz
; i++) {

156 
_k£
 = &
_’Œ›s
[
i
];

157 
_kid
 = 
	`k¡©_»ad
(
_pkc
, 
_k£
->
k¥
, 0);

158 
_kn
 = ((
k¡©_Çmed_t
*è
_k£
->
k¥
->
ks_d©a
è+ _k£->
off£t
;

159 
_m
.
	`£t
(
_k£
->
k¥
->
ks_¢­time
, 
_kn
->
v®ue
.
ui64
);

160 
_k£
->
m—su»d
[
_Ãw_m—su»m’t
] = 
_m
;

161 
_m
 -ğ
_k£
->
m—su»d
[
_Ï¡_m—su»m’t
];

162 
_tÙ®s
 +ğ
_m
;

166 ià((!
_fœ¡_time
è&& (*&
_¡©e
==
CPS_RUNNING
)) {

167 
_šu£
 = 
_’Œ›s_sz
 - _’Œ›s_sz*
_tÙ®s
.
ıu_n£c_idË
/_tÙ®s.
time¡amp
;

170 ++
_num_u§ge_»adšgs
;

171 
_tÙ®_u§ge
 +ğ
_šu£
;

172 
_avg_u§ge
 = 
_tÙ®_u§ge
/
_num_u§ge_»adšgs
;

175 
_fœ¡_time
 = 
çl£
;

176 
_Ï¡_m—su»m’t
 = 
_Ãw_m—su»m’t
;

178  (
RCOK
);

179 
	}
}

182 
w_rc_t
 
	gsunos_´ocmÚ™Ü_t
::
	$ÿ£_»£t
()

184 
_fœ¡_time
=
Œue
;

185 
_Ï¡_m—su»m’t
 = 1;

186  (
RCOK
);

187 
	}
}

	@src/util/tcp.cpp

34 
	~"ut/tı.h
"

36 
	~<¡dlib.h
>

37 
	~<¡ršg.h
>

38 
	~<sys/ty³s.h
>

39 
	~<sys/sock‘.h
>

40 
	~<Ãtš‘/š.h
>

41 
	~<Ãtdb.h
>

46 cÚ¡ 
	gLISTENQ
 = 1024;

47 cÚ¡ 
	gGETHOSTBYNAME_R_INITIAL_BUFFER_SIZE
 = 16;

48 cÚ¡ 
	gGETHOSTBYNAME_R_MAX_BUFFER_SIZE
 = 128;

62 
	$İ’_li¡’fd
(
pÜt
)

64 
li¡’fd
, 
İtv®
=1;

65 
sockaddr_š
 
£rv”addr
;

68 ià((
li¡’fd
 = 
	`sock‘
(
PF_INET
, 
SOCK_STREAM
, 0)) < 0) {

73 ià(
	`£tsockİt
(
li¡’fd
, 
SOL_SOCKET
, 
SO_REUSEADDR
,

74 (cÚ¡ *)&
İtv®
 , ()) < 0) {

81 
	`mem£t
((*è&
£rv”addr
, 0, (serveraddr));

82 
£rv”addr
.
sš_çmy
 = 
PF_INET
;

83 
£rv”addr
.
sš_addr
.
s_addr
 = 
	`htÚl
(
INADDR_ANY
);

84 
£rv”addr
.
sš_pÜt
 = 
	`htÚs
(()
pÜt
);

86 ià(
	`bšd
(
li¡’fd
, (
sockaddr
 *)&
£rv”addr
, (serveraddr)) < 0) {

91 ià(
	`li¡’
(
li¡’fd
, 
LISTENQ
) < 0) {

95  (
li¡’fd
);

96 
	}
}

113 
	$İ’_ş›Áfd
(cÚ¡ * 
ho¡Çme
, 
pÜt
)

115 
ş›Áfd
;

116 
ho¡’t
* 
hp
;

117 
sockaddr_š
 
£rv”addr
;

120 ià((
ş›Áfd
 = 
	`sock‘
(
PF_INET
, 
SOCK_STREAM
, 0)) < 0) {

126 ià((
hp
 = 
	`g‘ho¡byÇme
(
ho¡Çme
)è=ğ
NULL
) {

130 
	`mem£t
((*è&
£rv”addr
, 0, (serveraddr));

131 
£rv”addr
.
sš_çmy
 = 
PF_INET
;

132 
	`memıy
((*)&
£rv”addr
.
sš_addr
.
s_addr
,

133 (*)
hp
->
h_addr
, hp->
h_Ëngth
);

134 
£rv”addr
.
sš_pÜt
 = 
	`htÚs
(
pÜt
);

137 ià(
	`cÚÃù
(
ş›Áfd
, (
sockaddr
 *è&
£rv”addr
, (serveraddr)) < 0) {

141  (
ş›Áfd
);

142 
	}
}

	@src/util/thread.cpp

24 
	~"ut/th»ad.h
"

25 
	~<sys/ty³s.h
>

26 
	~<sys/¡©.h
>

27 
	~<sys/time.h
>

28 
	~<fú.h
>

30 #iâdeà
_GNU_SOURCE


31 
	#_GNU_SOURCE


	)

34 
	~"k_defšes.h
"

36 
	~<uni¡d.h
>

39 #undeà
DISABLE_THREAD_POOL


44 
	sth»ad_¬gs
 {

45 
th»ad_t
* 
	mt
;

46 
th»ad_poŞ
* 
	mp
;

47 
th»ad_¬gs
(
th»ad_t
* 
th»ad
, 
th»ad_poŞ
* 
poŞ
)

48 : 
t
(
th»ad
), 
p
(
poŞ
)

54 şas 
	croÙ_th»ad_t
 : 
public
 
th»ad_t


56 
public
:

61 
	$roÙ_th»ad_t
(cÚ¡ 
c_¡r
 &
Çme
)

62 : 
	$th»ad_t
(
Çme
)

66 
vœtu®
 
	$wÜk
() {

68 
	`as£¹
(
çl£
);

69 
	}
}

76 "C" 
th»ad_de¡roy
(* 
th»ad_objeù
);

77 "C" * 
¡¬t_th»ad
(*);

78 
£tup_th»ad
(
th»ad_¬gs
* 
¬gs
);

84 
__th»ad
 
th»ad_t
* 
	gTHREAD_KEY_SELF
;

85 
__th»ad
 
th»ad_poŞ
* 
	gTHREAD_POOL
;

87 
th»ad_poŞ
 
deçuÉ_th»ad_poŞ
(1<<30);

104 
	gth»ad_t
::
	$th»ad_t
(cÚ¡ 
c_¡r
 &
Çme
)

105 #ifdeà
USE_SMTHREAD_AS_BASE


106 : 
	`smth»ad_t
(
t_»guÏr
, 
Çme
.
	`d©a
()),

107 
	`_th»ad_Çme
(
Çme
), 
	`_µoŞ
(
NULL
), 
	$_d–‘e_me
(
Œue
)

109 : 
	`_th»ad_Çme
(
Çme
), 
	$_d–‘e_me
(
Œue
)

113 
	}
}

116 #ifdeà
USE_SMTHREAD_AS_BASE


130 
	gth»ad_t
::
	$run
()

132 
	`£tu±hr
();

134 
th»ad_t
* 
th»ad
 = 
THREAD_KEY_SELF
;

135 
th»ad_poŞ
* 
poŞ
 = 
THREAD_POOL
;

136 
	`as£¹
 (
poŞ
);

137 
poŞ
->
	`¡¬t
();

138 
th»ad
->
	`wÜk
();

139 
poŞ
->
	`¡İ
();

140 
	}
}

143 
	gth»ad_t
::
	$£tu±hr
()

145 if(!
_µoŞ
)

146 
_µoŞ
 = &
deçuÉ_th»ad_poŞ
;

149 
	`as£¹
 (
_µoŞ
);

153 
THREAD_KEY_SELF
 = 
this
;

154 
THREAD_POOL
 = 
_µoŞ
;

155 
	}
}

165 
	$th»ad_š™
()

167 
th»ad_¬gs
 
	`¬gs
(
Ãw
 
	`roÙ_th»ad_t
(
	`c_¡r
("roÙ-th»ad")), 
NULL
);

168 
	`£tup_th»ad
(&
¬gs
);

169 
	}
}

173 
th»ad_t
* 
	$th»ad_g‘_£lf
()

178  
THREAD_KEY_SELF
;

179 
	}
}

196 
±h»ad_t
 
	$th»ad_ü—‹
(
th»ad_t
* 
t
, 
th»ad_poŞ
* 
poŞ
)

198 
±h»ad_t
 
tid
;

199 
”r
;

200 
±h»ad_©Œ_t
 
·‰r
;

203 
”r
 = 
	`±h»ad_©Œ_š™
Ğ&
·‰r
 );

204 
	`THROW_IF
(
Th»adExû±iÚ
, 
”r
);

206 
”r
 = 
	`±h»ad_©Œ_£tscİe
Ğ&
·‰r
, 
PTHREAD_SCOPE_SYSTEM
 );

207 
	`THROW_IF
(
Th»adExû±iÚ
, 
”r
);

209 
”r
 = 
	`±h»ad_ü—‹
(&
tid
, &
·‰r
, 
¡¬t_th»ad
, 
Ãw
 
	`th»ad_¬gs
(
t
, 
poŞ
));

210 
	`THROW_IF
(
Th»adExû±iÚ
, 
”r
);

212  (
tid
);

213 
	}
}

217 
±h»ad_mu‹x_t
 
	$th»ad_mu‹x_ü—‹
(cÚ¡ 
±h»ad_mu‹x©Œ_t
* 
©Œ
)

219 
±h»ad_mu‹x©Œ_t
 
mu‹x_©Œ
;

220 cÚ¡ 
±h»ad_mu‹x©Œ_t
* 
±r_mu‹x_©Œ
;

221 
”r
;

223 ià(
©Œ
 =ğ
NULL
)

226 
”r
 = 
	`±h»ad_mu‹x©Œ_š™
(&
mu‹x_©Œ
);

227 
	`THROW_IF
(
Th»adExû±iÚ
, 
”r
);

229 
”r
 = 
	`±h»ad_mu‹x©Œ_£‰y³
(&
mu‹x_©Œ
, 
PTHREAD_MUTEX_ERRORCHECK
);

230 
	`THROW_IF
(
Th»adExû±iÚ
, 
”r
);

232 
”r
 = 
	`±h»ad_mu‹x©Œ_£sh¬ed
(&
mu‹x_©Œ
, 
PTHREAD_PROCESS_PRIVATE
);

233 
	`THROW_IF
(
Th»adExû±iÚ
, 
”r
);

235 
±r_mu‹x_©Œ
 = &
mu‹x_©Œ
;

237 (è
mu‹x_©Œ
;

238 
±r_mu‹x_©Œ
 = 
©Œ
;

242 
±r_mu‹x_©Œ
 = 
©Œ
;

245 
±h»ad_mu‹x_t
 
mu‹x
;

246 
”r
 = 
	`±h»ad_mu‹x_š™
(&
mu‹x
, 
±r_mu‹x_©Œ
);

247 
	`THROW_IF
(
Th»adExû±iÚ
, 
”r
);

248  
mu‹x
;

249 
	}
}

253 
	$th»ad_mu‹x_lock
(
±h»ad_mu‹x_t
 &
mu‹x
)

255 
i
=0; i < 3; i++) {

256 
”r
 = 
	`±h»ad_mu‹x_Œylock
(&
mu‹x
);

257 if(!
”r
)

259 if(
”r
 !ğ
EBUSY
)

260 
	`THROW_IF
(
Th»adExû±iÚ
, 
”r
);

263 
th»ad_poŞ
* 
poŞ
 = 
THREAD_POOL
;

264 
	`as£¹
 (
poŞ
);

265 
poŞ
->
	`¡İ
();

266 
”r
 = 
	`±h»ad_mu‹x_lock
(&
mu‹x
);

267 
poŞ
->
	`¡¬t
();

268 
	`THROW_IF
(
Th»adExû±iÚ
, 
”r
);

269 
	}
}

273 
	$th»ad_mu‹x_uÆock
(
±h»ad_mu‹x_t
 &
mu‹x
)

275 
”r
 = 
	`±h»ad_mu‹x_uÆock
(&
mu‹x
);

276 
	`THROW_IF
(
Th»adExû±iÚ
, 
”r
);

277 
	}
}

281 
	$th»ad_mu‹x_de¡roy
(
±h»ad_mu‹x_t
 &
mu‹x
)

283 
”r
 = 
	`±h»ad_mu‹x_de¡roy
(&
mu‹x
);

284 
	`THROW_IF
(
Th»adExû±iÚ
, 
”r
);

285 
	}
}

289 
±h»ad_cÚd_t
 
	$th»ad_cÚd_ü—‹
(cÚ¡ 
±h»ad_cÚd©Œ_t
* 
©Œ
)

291 
±h»ad_cÚd_t
 
cÚd
;

292 
”r
 = 
	`±h»ad_cÚd_š™
(&
cÚd
, 
©Œ
);

293 
	`THROW_IF
(
Th»adExû±iÚ
, 
”r
);

294  
cÚd
;

295 
	}
}

299 
	$th»ad_cÚd_de¡roy
(
±h»ad_cÚd_t
 &
cÚd
)

301 
”r
 = 
	`±h»ad_cÚd_de¡roy
(&
cÚd
);

302 
	`THROW_IF
(
Th»adExû±iÚ
, 
”r
);

303 
	}
}

307 
	$th»ad_cÚd_sigÇl
(
±h»ad_cÚd_t
 &
cÚd
)

309 
”r
 = 
	`±h»ad_cÚd_sigÇl
(&
cÚd
);

310 
	`THROW_IF
(
Th»adExû±iÚ
, 
”r
);

311 
	}
}

315 
	$th»ad_cÚd_brßdÿ¡
(
±h»ad_cÚd_t
 &
cÚd
)

317 
”r
 = 
	`±h»ad_cÚd_brßdÿ¡
(&
cÚd
);

318 
	`THROW_IF
(
Th»adExû±iÚ
, 
”r
);

319 
	}
}

323 
	$th»ad_cÚd_wa™
(
±h»ad_cÚd_t
 &
cÚd
, 
±h»ad_mu‹x_t
 &
mu‹x
)

325 
th»ad_poŞ
* 
poŞ
 = 
THREAD_POOL
;

326 
	`as£¹
 (
poŞ
);

327 
poŞ
->
	`¡İ
();

328 
”r
 = 
	`±h»ad_cÚd_wa™
(&
cÚd
, &
mu‹x
);

329 
poŞ
->
	`¡¬t
();

330 
	`THROW_IF
(
Th»adExû±iÚ
, 
”r
);

331 
	}
}

333 
boŞ
 
	$th»ad_cÚd_wa™
(
±h»ad_cÚd_t
 &
cÚd
, 
±h»ad_mu‹x_t
 &
mu‹x
,

334 
time¥ec
 &
timeout
)

336 
th»ad_poŞ
* 
poŞ
 = 
THREAD_POOL
;

337 
	`as£¹
 (
poŞ
);

338 
poŞ
->
	`¡İ
();

339 
”r
 = 
	`±h»ad_cÚd_timedwa™
(&
cÚd
, &
mu‹x
, &
timeout
);

340 
poŞ
->
	`¡¬t
();

342 
”r
) {

343 0:  
Œue
;

344 
ETIMEDOUT
:  
çl£
;

345 : 
	`THROW_IF
(
Th»adExû±iÚ
, 
”r
);

348 
	`uÄ—chabË
();

349 
	}
}

351 
boŞ
 
	$th»ad_cÚd_wa™
(
±h»ad_cÚd_t
 &
cÚd
, 
±h»ad_mu‹x_t
 &
mu‹x
,

352 
timeout_ms
)

354 if(
timeout_ms
 > 0) {

355 
time¥ec
 
timeout
;

356 
timev®
 
now
;

357 
	`g‘timeofday
(&
now
, 
NULL
);

358 if(
timeout_ms
 > 1000) {

359 
timeout
.
tv_£c
 = 
timeout_ms
 / 1000;

360 
timeout
.
tv_n£c
 = (
timeout_ms
 -imeout.
tv_£c
*1000)*1000;

363 
timeout
.
tv_£c
 = 0;

364 
timeout
.
tv_n£c
 = 
timeout_ms
*1000;

367  
	`th»ad_cÚd_wa™
(
cÚd
, 
mu‹x
, 
timeout
);

369 
	`th»ad_cÚd_wa™
(
cÚd
, 
mu‹x
);

370  
Œue
;

371 
	}
}

388 * 
	$¡¬t_th»ad
(* 
th»ad_objeù
)

390 
th»ad_¬gs
* 
¬gs
 = (th»ad_¬gs*)
th»ad_objeù
;

391 
	`£tup_th»ad
(
¬gs
);

392 
d–‘e
 
¬gs
;

394 
th»ad_t
* 
th»ad
 = 
THREAD_KEY_SELF
;

395 
th»ad_poŞ
* 
poŞ
 = 
THREAD_POOL
;

396 
	`as£¹
 (
poŞ
);

398 
poŞ
->
	`¡¬t
();

399 
th»ad
->
	`wÜk
();

400 
poŞ
->
	`¡İ
();

402 if(
th»ad
->
	`d–‘e_me
())

403 
d–‘e
 
th»ad
;

404  (
NULL
);

405 
	}
}

411 
	gth»ad_poŞ
::
	$¡¬t
()

413 #iâdeà
DISABLE_THREAD_POOL


414 
”r
 = 
	`±h»ad_mu‹x_lock
(&
_lock
);

415 
	`THROW_IF
(
Th»adExû±iÚ
, 
”r
);

416 
_aùive
 =ğ
_max_aùive
) {

417 
”r
 = 
	`±h»ad_cÚd_wa™
(&
_cÚd
, &
_lock
);

418 
	`THROW_IF
(
Th»adExû±iÚ
, 
”r
);

420 
	`as£¹
(
_aùive
 < 
_max_aùive
);

421 
_aùive
++;

422 
”r
 = 
	`±h»ad_mu‹x_uÆock
(&
_lock
);

423 
	`THROW_IF
(
Th»adExû±iÚ
, 
”r
);

425 
	}
}

427 
	gth»ad_poŞ
::
	$¡İ
()

429 #iâdeà
DISABLE_THREAD_POOL


430 
”r
 = 
	`±h»ad_mu‹x_lock
(&
_lock
);

431 
	`THROW_IF
(
Th»adExû±iÚ
, 
”r
);

432 
_aùive
--;

433 
	`th»ad_cÚd_sigÇl
(
_cÚd
);

434 
”r
 = 
	`±h»ad_mu‹x_uÆock
(&
_lock
);

435 
	`THROW_IF
(
Th»adExû±iÚ
, 
”r
);

437 
	}
}

441 
	$£tup_th»ad
(
th»ad_¬gs
* 
¬gs
)

443 
th»ad_t
* 
th»ad
 = 
¬gs
->
t
;

444 
th»ad_poŞ
* 
poŞ
 = 
¬gs
->
p
;

446 ià(!
poŞ
) {

447 
poŞ
 = &
deçuÉ_th»ad_poŞ
;

451 
	`as£¹
 (
poŞ
);

455 
THREAD_KEY_SELF
 = 
th»ad
;

456 
THREAD_POOL
 = 
poŞ
;

457 
	}
}

461 #ifdeà
USE_SMTHREAD_AS_BASE


477 
	$wa™_fÜ_¡h»ad_ş›Ás
(
¡h»ad_t
** 
th»ads
, 
num_th»ad_ids
)

480 
i
 = 0; i < 
num_th»ad_ids
; i++) {

483 
th»ads
[
i
]->
	`još
();

488 
	}
}

	@src/util/time_util.cpp

31 
	~"ut/time_ut.h
"

33 
	~<ÿs£¹
>

35 
	~"k_defšes.h
"

48 
	$d©•¬t
(cÚ¡* 
¡r
, cÚ¡ 
time_t
 *
±
)

50 
tm
 
tm_¡ruù
;

52 
	`loÿÉime_r
(
±
, &
tm_¡ruù
);

54 if(
	`¡rcmp
(
¡r
, "yy") == 0) {

55  (
tm_¡ruù
.
tm_y—r
 + 1900);

59 
	}
}

74 
time_t
 
	$¡r_to_tim‘
(cÚ¡* 
¡r
)

77 
tm
 
time_¡r
;

78 
couÁ
 = 
	`ssÿnf
(
¡r
, "%d-%d-%d",

79 &
time_¡r
.
tm_y—r
, &time_¡r.
tm_mÚ
, &time_¡r.
tm_mday
);

80 
	`as£¹
(
couÁ
 == 3);

81 
time_¡r
.
tm_y—r
 -= 1900;

82 
time_¡r
.
tm_mÚ
--;

83 
time_¡r
.
tm_hour
 = 0;

84 
time_¡r
.
tm_mš
 = 0;

85 
time_¡r
.
tm_£c
 = 0;

86 
time_¡r
.
tm_isd¡
 = -1;

88  
	`mktime
(&
time_¡r
);

89 
	}
}

100 
	$tim‘_to_¡r
(* 
d¡
, 
time_t
 
time
)

102 
tm
 
©m
;

103 
	`loÿÉime_r
(&
time
, &
©m
);

104 
	`¥rštf
(
d¡
, "%04d-%02d-%02d\n",

105 
©m
.
tm_y—r
+1900,‡tm.
tm_mÚ
+1,‡tm.
tm_mday
);

106 
	}
}

123 
	#REFORMATION_DAY
 639787

	)

126 
	#MISSING_DAYS
 11

	)

129 
	#THURSDAY
 4

	)

132 
	#SATURDAY
 6

	)

146 cÚ¡ 
	gdays_š_mÚth
[12] = {

169 
time_t


170 
	$time_add_day
 (
time_t
 
time
, 
days
)

172 
tm
m;

174 
	`loÿÉime_r
(&
time
, &
tm
);

175 
tm
.
tm_mday
 +ğ
days
;

176 
tm
.
tm_isd¡
 = -1;

177 
time_t
 
ÿËnd¬_time
 = 
	`mktime
 (&
tm
);

179  
ÿËnd¬_time
;

180 
	}
}

193 
time_t


194 
	$time_add_w“k
 (
time_t
 
time
, 
w“ks
)

196  
	`time_add_day
 (
time
, 
w“ks
 * 7);

197 
	}
}

210 
time_t


211 
	$time_add_mÚth
 (
time_t
 
time
, 
mÚths
)

213 
tm
m;

215 
	`loÿÉime_r
(&
time
, &
tm
);

216 
tm
.
tm_mÚ
 +ğ
mÚths
;

217 
tm
.
tm_isd¡
 = -1;

219  
	`mktime
(&
tm
);

220 
	}
}

233 
time_t


234 
	$time_add_y—r
 (
time_t
 
time
, 
y—rs
)

236 
tm
m;

238 
	`loÿÉime_r
(&
time
, &
tm
);

239 
tm
.
tm_y—r
 +ğ
y—rs
;

240 
tm
.
tm_isd¡
 = -1;

242  
	`mktime
(&
tm
);

243 
	}
}

256 
time_t


257 
	$time_day_begš
 (
time_t
 
t
)

259 
tm
m;

261 
	`loÿÉime_r
(&
t
, &
tm
);

262 
tm
.
tm_hour
 =m.
tm_mš
 =m.
tm_£c
 = 0;

263 
tm
.
tm_isd¡
 = -1;

265  
	`mktime
 (&
tm
);

266 
	}
}

279 
time_t


280 
	$time_day_’d
 (
time_t
 
t
)

282 
tm
m;

284 
	`loÿÉime_r
(&
t
, &
tm
);

285 
tm
.
tm_hour
 =m.
tm_mš
 =m.
tm_£c
 = 0;

286 
tm
.
tm_mday
++;

287 
tm
.
tm_isd¡
 = -1;

289  
	`mktime
 (&
tm
);

290 
	}
}

	@src/util/tmpfile.cpp

32 
	~<¡dlib.h
>

33 
	~"ut/tmpfe.h
"

34 
	~"ut/exû±iÚ.h
"

35 
	~"ut/Œaû.h
"

36 
	~"ut/gu¬d.h
"

37 
	~<¡dio.h
>

52 
FILE
* 
	$ü—‹_tmp_fe
(
c_¡r
& 
Çme
, cÚ¡ c_¡r& 
´efix
)

55 
m‘a_‹m¶©e
[] = "tmp/%s.XXXXXX";

56 
Ën
 = (
m‘a_‹m¶©e
è- 2 + 
	`¡¾’
(
´efix
);

57 
¬¿y_gu¬d_t
<> 
Çme_‹m¶©e
 = 
Ãw
 [
Ën
 + 1];

58 
	`¥rštf
(
Çme_‹m¶©e
, 
m‘a_‹m¶©e
, 
´efix
.
	`d©a
());

59 
fd
 = 
	`mk¡emp
(
Çme_‹m¶©e
);

60 if(
fd
 < 0) {

61 
	`THROW3
(
FeExû±iÚ
,

63 
	`”ºo_to_¡r
().
	`d©a
(), (*è
Çme_‹m¶©e
);

66 
	`TRACE
(
TRACE_TEMP_FILE
, "C»©edem°f%s\n", (*è
Çme_‹m¶©e
);

69 
FILE
 *
fe
 = 
	`fdİ’
(
fd
, "w");

70 if(!
fe
) {

71 
	`THROW3
(
FeExû±iÚ
,

73 
	`”ºo_to_¡r
().
	`d©a
(), (*è
Çme_‹m¶©e
);

76 
Çme
 = (*è
Çme_‹m¶©e
;

77  
fe
;

78 
	}
}

	@src/util/topinfo.cpp

34 
	~"ut/tİšfo.h
"

35 
	~"ut/Œaû.h
"

36 
	~<ÿs£¹
>

38 
	gtİšfo_t
::
	$tİšfo_t
()

39 : 
	$_»g_fs
(0)

41 
_cÚf
 = 
	`glibtİ_š™
();

42 
	`as£¹
 (
_cÚf
);

43 
	`TRACE
Ğ
TRACE_DEBUG
, "NCPU=(%d), REALCPU=(%d)\n",

44 
_cÚf
->
nıu
, _cÚf->
»®_nıu
);

47 
_mouÁ_’Œ›s
 = 
	`glibtİ_g‘_mouÁli¡
(&
_mouÁ_li¡
,1);

48 
ušt
 
i
=0; i< 
_mouÁ_li¡
.
numb”
; ++i) {

49 
	`TRACE
Ğ
TRACE_DEBUG
, "%d: %d %s %s %s\n",

50 
i
, 
_mouÁ_’Œ›s
[i].
dev
, _mouÁ_’Œ›s[i].
devÇme
,

51 
_mouÁ_’Œ›s
[
i
].
mouÁdœ
, _mouÁ_’Œ›s[i].
ty³
);

53 
	}
}

55 
	gtİšfo_t
::~
	$tİšfo_t
()

57 
	}
}

61 
tİšfo_t
::
	$»£t
()

63 
	`upd©e_ıu
();

64 
_Şd_ıu
 = 
_ıu
;

66 
	`upd©e_mem
();

67 
_Şd_mem
 = 
_mem
;

69 
	`upd©e_´oşi¡
();

70 
_Şd_´oşi¡
 = 
_´oşi¡
;

71 
	}
}

75 
	gtİšfo_t
::
	$´št_¡©s
()

80 
	}
}

90 
tİšfo_t
::
	$upd©e_ıu
()

92 
	`glibtİ_g‘_ıu
(&
_ıu
);

94 
	}
}

97 
	gtİšfo_t
::
	$´št_avg_u§ge
()

99 
	`upd©e_ıu
();

101 
ıus
 = 
_cÚf
->
nıu
+1;

102 
tÙ®
 = (è(
_ıu
.tÙ®-
_Şd_ıu
.total);

103 
u£r
 = (è(
_ıu
.u£r-
_Şd_ıu
.user);

104 
sys
 = (è(
_ıu
.sys-
_Şd_ıu
.sys);

105 
idË
 = (è(
_ıu
.idË-
_Şd_ıu
.idle);

108 
	`TRACE
Ğ
TRACE_STATISTICS
,

112 (
tÙ®
-
idË
)*
ıus
/total, 100*(total-idle)/total,

113 
u£r
*
ıus
/
tÙ®
, 100*user/total,

114 
sys
*
ıus
/
tÙ®
, 100*sys/total);

117 
_Şd_ıu
 = 
_ıu
;

118 
	}
}

121 
	gtİšfo_t
::
	$g‘_avg_u§ge
(
boŞ
 
bUpd©eR—dšg
)

123 
	`upd©e_ıu
();

125 
ıus
 = 
_cÚf
->
nıu
+1;

126 
tÙ®
 = (è(
_ıu
.tÙ®-
_Şd_ıu
.total);

127 
idË
 = (è(
_ıu
.idË-
_Şd_ıu
.idle);

130 ià(
bUpd©eR—dšg
) {

131 
_Şd_ıu
 = 
_ıu
;

134 Ğ(
tÙ®
-
idË
)*
ıus
/total );

135 
	}
}

137 
ušt
 
	gtİšfo_t
::
	$g‘_num_of_ıus
()

139 (
_cÚf
->
nıu
+1);

140 
	}
}

142 
ıu_lßd_v®ues_t
 
	gtİšfo_t
::
	$g‘_lßd
()

144 
ıu_lßd_v®ues_t
 
lßd
;

145 
lßd
.
run_tm
 = (è(
_ıu
.
tÙ®
-
_Şd_ıu
.total);

146 
lßd
.
wa™_tm
 = 0.;

147  (
lßd
);

148 
	}
}

157 
	gtİšfo_t
::
	$upd©e_mem
()

159 
	`glibtİ_g‘_mem
(&
_mem
);

161 
	}
}

164 cÚ¡ 
	gMBYTE
 = 1024*1024;

166 
	gtİšfo_t
::
	$´št_mem
()

168 
	`TRACE
Ğ
TRACE_STATISTICS
, "MEMORY INFO:\n:" );

169 
	`TRACE
Ğ
TRACE_STATISTICS
, "Memory Total : %ld MB\n" ,

170 (
ulÚg
)
_mem
.
tÙ®
/
MBYTE
);

171 
	`TRACE
Ğ
TRACE_STATISTICS
, "Memory Used : %ld MB\n" ,

172 (
ulÚg
)
_mem
.
u£d
/
MBYTE
);

173 
	`TRACE
Ğ
TRACE_STATISTICS
, "Memory Free : %ld MB\n" ,

174 (
ulÚg
)
_mem
.
ä“
/
MBYTE
);

175 
	`TRACE
Ğ
TRACE_STATISTICS
, "Memory Buffered: %ld MB\n" ,

176 (
ulÚg
)
_mem
.
bufãr
/
MBYTE
);

177 
	`TRACE
Ğ
TRACE_STATISTICS
, "Memory Cached : %ld MB\n" ,

178 (
ulÚg
)
_mem
.
ÿched
/
MBYTE
);

179 
	`TRACE
Ğ
TRACE_STATISTICS
, "Memory User : %ld MB\n" ,

180 (
ulÚg
)
_mem
.
u£r
/
MBYTE
);

181 
	`TRACE
Ğ
TRACE_STATISTICS
, "Memory Locked : %ld MB\n" ,

182 (
ulÚg
)
_mem
.
locked
/
MBYTE
);

183 
	}
}

194 
	gtİšfo_t
::
	$upd©e_´oşi¡
()

196 
which
 = 0;

197 
¬g
 = 0;

198 
	`glibtİ_g‘_´oşi¡
(&
_´oşi¡
,
which
,
¬g
);

200 
	}
}

203 
	gtİšfo_t
::
	$´št_´oşi¡
()

205 
	`TRACE
Ğ
TRACE_STATISTICS
, "PROCLIST INFO:\n:" );

206 
	`TRACE
Ğ
TRACE_STATISTICS
, "Numb”: %ld\n" , (
ulÚg
)
_´oşi¡
.
numb”
);

207 
	`TRACE
Ğ
TRACE_STATISTICS
, "TÙ® : %ld\n" , (
ulÚg
)
_´oşi¡
.
tÙ®
);

208 
	`TRACE
Ğ
TRACE_STATISTICS
, "Siz : %ld\n" , (
ulÚg
)
_´oşi¡
.
size
);

209 
	}
}

218 
	gtİšfo_t
::
	$»gi¡”_fs
(cÚ¡ 
¡ršg
& 
mouÁ·th
)

221 
mouÁ_™
 
m™
 = 
_v_»g_mouÁ
.
	`begš
();

222 
m™
 !ğ
_v_»g_mouÁ
.
	`’d
(); ++mit)

224 ià(*
m™
 =ğ
mouÁ·th
) {

225 
	`TRACE
Ğ
TRACE_ALWAYS
,

227 (*
m™
).
	`c_¡r
(), 
mouÁ·th
.c_str());

233 
	`TRACE
Ğ
TRACE_ALWAYS
, "Registering (%s) for monitoring\n",

234 
mouÁ·th
.
	`c_¡r
());

235 
_v_»g_mouÁ
.
	`push_back
(
mouÁ·th
);

236 
glibtİ_fsu§ge
 
afsu§ge
;

237 
	`glibtİ_g‘_fsu§ge
(&
afsu§ge
,
mouÁ·th
.
	`c_¡r
());

238 
_v_fs
.
	`push_back
(
afsu§ge
);

239 
_v_Şd_fs
.
	`push_back
(
afsu§ge
);

241 ++
_»g_fs
;

244 
	}
}

246 
	gtİšfo_t
::
	$upd©e_fs
()

248 
glibtİ_fsu§ge
 
afsu§ge
;

249 
¡ršg
 
mouÁ
;

250 
i
 = 0;

253 
mouÁ_™
 
m™
 = 
_v_»g_mouÁ
.
	`begš
();

254 
m™
 !ğ
_v_»g_mouÁ
.
	`’d
(); ++mit)

256 
mouÁ
 = *
m™
;

257 
	`glibtİ_g‘_fsu§ge
(&
afsu§ge
,
mouÁ
.
	`c_¡r
());

258 
_v_fs
[
i
++] = 
afsu§ge
;

262 
	}
}

265 
	gtİšfo_t
::
	$´št_fs
(cÚ¡ 
d–ay
)

268 
	`as£¹
 ( 
_v_fs
.
	`size
(è=ğ
_v_Şd_fs
.size());

269 
	`as£¹
 ( 
_»g_fs
 =ğ
_v_fs
.
	`size
());

271 
	`upd©e_fs
();

273 
glibtİ_fsu§ge
 
afsu§ge
, 
Şdfsu§ge
;

274 
gušt32
 
bsz
;

275 
gušt64
 
b»ad
, 
bwr™e
;

278 
ušt
 
i
=0; i<
_»g_fs
; ++i) {

280 
afsu§ge
 = 
_v_fs
[
i
];

281 
Şdfsu§ge
 = 
_v_Şd_fs
[
i
];

282 
bsz
 = 
afsu§ge
.
block_size
;

283 
b»ad
 = 
afsu§ge
.
»ad
 - 
Şdfsu§ge
.read;

284 
bwr™e
 = 
afsu§ge
.
wr™e
 - 
Şdfsu§ge
.write;

286 
	`TRACE
Ğ
TRACE_STATISTICS
, "Mount : %s\tBlockSZ: %d\n",

287 
_v_»g_mouÁ
[
i
].
	`c_¡r
(), 
bsz
);

288 
	`TRACE
Ğ
TRACE_STATISTICS
, "Read : %d (%.2fMB/sec)\n" ,

289 
b»ad
, ()(
bsz
*b»ad)/()(
d–ay
*1048576));

290 
	`TRACE
Ğ
TRACE_STATISTICS
, "Write : %d (%.2fMB/sec)\n" ,

291 
bwr™e
, ()(
bsz
*bwr™e)/()(
d–ay
*1048576));

297 
	`as£¹
 (
_v_fs
.
	`size
(è=ğ
_v_Şd_fs
.size());

298 
i
 = 0;

299 
sz
 = 
_v_fs
.
	`size
();

301 
i
=0;i<
sz
;++i) {

302 
_v_Şd_fs
[
i
] = 
_v_fs
[i];

304 
	}
}

307 
ulÚg_t
 
	gtİšfo_t
::
	$ioch¬s
()

311 
	}
}

	@src/util/trace.cpp

34 
	~"ut/Œaû.h
"

35 
	~"ut/sync.h
"

37 
	~"k_defšes.h
"

41 
	$Œaû_fÜû_
(cÚ¡ * 
f’ame
, 
lše_num
, cÚ¡ * 
funùiÚ_Çme
,

42 * 
fÜm©
, ...è
	`__©Œibu‹__
((
	`fÜm©
(
´štf
, 4, 5)));

58 
	#TRACE_FORCE
(
fÜm©
, 
»¡
...è
	`Œaû_fÜû_
(
__FILE__
, 
__LINE__
, 
__FUNCTION__
, fÜm©, ##»¡)

	)

62 
	`Œaû_´št_±h»ad
(
FILE
* 
out_¡»am
, 
±h»ad_t
 
th»ad
);

65 
	`Œaû_¡»am
(
FILE
* 
out_¡»am
,

66 cÚ¡ * 
f’ame
, 
lše_num
, cÚ¡ * 
funùiÚ_Çme
,

67 cÚ¡* 
fÜm©
, 
va_li¡
 
­
);

76 
Œaû_cu¼’t_£‰šg
 = ~0u;

105 
Œaûr
::
	$İ”©Ü
()(
Œaû_ty³
, cÚ¡* 
fÜm©
, ...)

110 
do_Œaû
 = 
Œaû_cu¼’t_£‰šg
 & 
Œaû_ty³
;

111 iàĞ
do_Œaû
 == 0 )

115 
va_li¡
 
­
;

116 
	`va_¡¬t
(
­
, 
fÜm©
);

119 
	`Œaû_¡»am
(
¡dout
, 
_fe
, 
_lše
, 
_funùiÚ
, 
fÜm©
, 
­
);

121 
	`va_’d
(
­
);

123 
	}
}

133 
	$Œaû_£t
(
Œaû_ty³_mask
) {

138 
Œaû_cu¼’t_£‰šg
 = 
Œaû_ty³_mask
;

139 
	}
}

146 
	$Œaû_g‘
() {

147  
Œaû_cu¼’t_£‰šg
;

148 
	}
}

154 cÚ¡ 
	gFORCE_BUFFER_SIZE
 = 256;

161 
	$Œaû_fÜû_
(cÚ¡ * 
f’ame
, 
lše_num
, cÚ¡ * 
funùiÚ_Çme
,

162 * 
fÜm©
, ...)

165 
funùiÚ_Çme_Ën
 = 
	`¡¾’
(
funùiÚ_Çme
);

166 
size
 = 
FORCE_BUFFER_SIZE
 + 
funùiÚ_Çme_Ën
;

167 
buf
[
size
];

170 
	`¢´štf
(
buf
, 
size
, "\nFORCE: %s:%d %s: ", 
f’ame
, 
lše_num
, 
funùiÚ_Çme
);

171 
msg_off£t
 = 
	`¡¾’
(
buf
);

172 
msg_size
 = 
size
 - 
msg_off£t
;

173 * 
msg
 = &
buf
[ 
msg_off£t
 ];

176 
va_li¡
 
­
;

177 
	`va_¡¬t
(
­
, 
fÜm©
);

178 
	`v¢´štf
(
msg
, 
msg_size
, 
fÜm©
, 
­
);

179 
	`årštf
(
¡d”r
, 
buf
);

180 
	`va_’d
(
­
);

181 
	}
}

196 
	$Œaû_´št_±h»ad
(
FILE
* 
out_¡»am
, 
±h»ad_t
 
th»ad
)

202 #ià
	`defšed
(
lšux
è|| defšed(
__lšux
)

203 #iâdeà
__USE_GNU


204 
	#__USE_GNU


	)

209 
	`årštf
(
out_¡»am
, "%lu", 
th»ad
);

216 #ià
	`defšed
(
sun
è|| defšed(
__sun
)

217 #ià
	`defšed
(
__SVR4
è|| defšed(
__svr4__
)

221 
	`årštf
(
out_¡»am
, "%u", 
th»ad
);

227 
	}
}

234 
±h»ad_mu‹x_t
 
	g¡»am_mu‹x
 = 
th»ad_mu‹x_ü—‹
();

265 
	$Œaû_¡»am
(
FILE
* 
out_¡»am
,

266 cÚ¡ * 
f’ame
, 
lše_num
, cÚ¡ * 
funùiÚ_Çme
,

267 cÚ¡* 
fÜm©
, 
va_li¡
 
­
)

278 
th»ad_t
* 
this_th»ad
 = 
	`th»ad_g‘_£lf
();

279 
ü™iÿl_£ùiÚ_t
 
	`cs
(
¡»am_mu‹x
);

284 iàĞ
this_th»ad
 !ğ
NULL
 )

285 
	`årštf
(
out_¡»am
, "%s", 
this_th»ad
->
	`th»ad_Çme
().
	`d©a
());

287 
	`Œaû_´št_±h»ad
(
out_¡»am
, 
	`±h»ad_£lf
());

290 
	`årštf
(
out_¡»am
, ": %s:%d:%s: ", 
f’ame
, 
lše_num
, 
funùiÚ_Çme
);

291 
	`vårštf
(
out_¡»am
, 
fÜm©
, 
­
);

297 
	`fæush
(
out_¡»am
);

298 
	}
}

	@src/util/w_strlcpy.cpp

47 
	~"ut/w_¡¾ıy.h
"

54 
size_t


55 
	$w_¡¾ıy
(*
d¡
, cÚ¡ *
¤c
, 
size_t
 
siz
)

57 *
d
 = 
d¡
;

58 cÚ¡ *
s
 = 
¤c
;

59 
size_t
 
n
 = 
siz
;

62 ià(
n
 != 0) {

63 --
n
 != 0) {

64 ià((*
d
++ = *
s
++) == '\0')

70 ià(
n
 == 0) {

71 ià(
siz
 != 0)

72 *
d
 = '\0';

73 *
s
++)

77  (
s
 - 
¤c
 - 1);

78 
	}
}

	@src/workload/ssb/dbgen/driver.cpp

4 
	#DECLARER


	)

5 
	#NO_FUNC
 ((*è()è
NULL


	)

6 
	#NO_LFUNC
 ((*è()è
NULL


	)

8 
	~"wÜklßd/ssb/dbg’/cÚfig.h
"

9 
	~<c¡dlib
>

10 #ià(
defšed
(
_POSIX_
)||!defšed(
WIN32
))

11 #iâdeà
DOS


12 
	~<uni¡d.h
>

13 
	~<g‘İt.h
>

14 
	~<sys/wa™.h
>

18 
	~<¡dio.h
>

19 
	~<lim™s.h
>

20 
	~<m©h.h
>

21 
	~<ùy³.h
>

22 
	~<sigÇl.h
>

23 
	~<¡ršg.h
>

24 
	~<”ºo.h
>

25 #ifdeà
HP


26 
	~<¡ršgs.h
>

28 #ià(
defšed
(
WIN32
)&&!defšed(
_POSIX_
))

29 
	~<´oûss.h
>

30 #´agm¨
w¬nšg
(
di§bË
:4201)

31 #´agm¨
w¬nšg
(
di§bË
:4214)

32 #´agm¨
w¬nšg
(
di§bË
:4514)

33 
	#WIN32_LEAN_AND_MEAN


	)

34 
	#NOATOM


	)

35 
	#NOGDICAPMASKS


	)

36 
	#NOMETAFILE


	)

37 
	#NOMINMAX


	)

38 
	#NOMSG


	)

39 
	#NOOPENFILE


	)

40 
	#NORASTEROPS


	)

41 
	#NOSCROLL


	)

42 
	#NOSOUND


	)

43 
	#NOSYSMETRICS


	)

44 
	#NOTEXTMETRIC


	)

45 
	#NOWH


	)

46 
	#NOCOMM


	)

47 
	#NOKANJI


	)

48 
	#NOMCX


	)

50 
	~"wšdows.h
"

52 #´agm¨
w¬nšg
(:4201)

53 #´agm¨
w¬nšg
(:4214)

56 
	~"dss.h
"

57 
	~"ds¡y³s.h
"

58 
	~"bcd2.h
"

60 
İtšd
, 
İ‹¼
;

61 *
İrg
;

64 
	$ENTER_NAMESPACE
(
dbg’ssb
)

69 
	`u§ge
 ();

70 
	`´•_dœeù
 (*);

71 
	`şo£_dœeù
 ();

72 
	`kl_lßd
 ();

73 
	`¶ßd
 (
tbl
);

74 
	`g’_tbl
 (
Šum
, 
¡¬t
, 
couÁ
, 
upd_num
);

75 
	`´_d¿nge
 (
tbl
, 
mš
, 
út
, 
num
);

76 
	`£t_fes
 (
t
, 
¶ßd
);

77 
	`·¹Ÿl
 (, );

81 
rowút
 = 0, 
mšrow
 = 0, 
upd_num
 = 0;

82 
æt_sÿË
;

83 #ià(
	`defšed
(
WIN32
)&&!defšed(
_POSIX_
))

84 *
¥awn_¬gs
[25];

114 #ifdeà
SSBM


115 
	`´_cu¡
 (* 
c
, 
mode
);

116 
	`´_·¹
 (* 
p
, 
mode
);

117 
	`´_suµ
 (* 
s
, 
mode
);

118 
	`´_lše
 (* 
o
, 
mode
);

120 
	`´_cu¡
 (* 
c
, 
mode
);

121 
	`´_lše
 (* 
o
, 
mode
);

122 
	`´_Üd”
 (* 
o
, 
mode
);

123 
	`´_·¹
 (* 
p
, 
mode
);

124 
	`´_psuµ
 (* 
p
, 
mode
);

125 
	`´_suµ
 (* 
s
, 
mode
);

126 
	`´_Üd”_lše
 (* 
o
, 
mode
);

127 
	`´_·¹_psuµ
 (* 
p
, 
mode
);

128 
	`´_ÇtiÚ
 (* 
c
, 
mode
);

129 
	`´_»giÚ
 (* 
c
, 
mode
);

135 #ifdeà
SSBM


136 
	`ld_cu¡
 (* 
c
, 
mode
);

137 
	`ld_·¹
 (* 
p
, 
mode
);

138 
	`ld_suµ
 (* 
s
, 
mode
);

141 
	`ld_lše
 (* 
o
, 
mode
);

142 
	`ld_Üd”
 (* 
o
, 
mode
);

145 
	`ld_cu¡
 (* 
c
, 
mode
);

146 
	`ld_lše
 (* 
o
, 
mode
);

147 
	`ld_Üd”
 (* 
o
, 
mode
);

148 
	`ld_·¹
 (* 
p
, 
mode
);

149 
	`ld_psuµ
 (* 
p
, 
mode
);

150 
	`ld_suµ
 (* 
s
, 
mode
);

151 
	`ld_Üd”_lše
 (* 
o
, 
mode
);

152 
	`ld_·¹_psuµ
 (* 
p
, 
mode
);

153 
	`ld_ÇtiÚ
 (* 
c
, 
mode
);

154 
	`ld_»giÚ
 (* 
c
, 
mode
);

160 #ifdeà
SSBM


161 
	`sd_cu¡
 (
chd
, 
sk_couÁ
);

162 
	`sd_·¹
 (
chd
, 
sk_couÁ
);

163 
	`sd_suµ
 (
chd
, 
sk_couÁ
);

165 
	`sd_lše
 (
chd
, 
sk_couÁ
);

166 
	`sd_Üd”
 (
chd
, 
sk_couÁ
);

169 
	`sd_cu¡
 (
chd
, 
sk_couÁ
);

170 
	`sd_lše
 (
chd
, 
sk_couÁ
);

171 
	`sd_Üd”
 (
chd
, 
sk_couÁ
);

172 
	`sd_·¹
 (
chd
, 
sk_couÁ
);

173 
	`sd_psuµ
 (
chd
, 
sk_couÁ
);

174 
	`sd_suµ
 (
chd
, 
sk_couÁ
);

175 
	`sd_Üd”_lše
 (
chd
, 
sk_couÁ
);

176 
	`sd_·¹_psuµ
 (
chd
, 
sk_couÁ
);

182 #ifdeà
SSBM


183 
	`hd_cu¡
 (
FILE
 * 
f
);

184 
	`hd_·¹
 (
FILE
 * 
f
);

185 
	`hd_suµ
 (
FILE
 * 
f
);

186 
	`hd_lše
 (
FILE
 * 
f
);

189 
	`hd_cu¡
 (
FILE
 * 
f
);

190 
	`hd_lše
 (
FILE
 * 
f
);

191 
	`hd_Üd”
 (
FILE
 * 
f
);

192 
	`hd_·¹
 (
FILE
 * 
f
);

193 
	`hd_psuµ
 (
FILE
 * 
f
);

194 
	`hd_suµ
 (
FILE
 * 
f
);

195 
	`hd_Üd”_lše
 (
FILE
 * 
f
);

196 
	`hd_·¹_psuµ
 (
FILE
 * 
f
);

197 
	`hd_ÇtiÚ
 (
FILE
 * 
f
);

198 
	`hd_»giÚ
 (
FILE
 * 
f
);

204 #ifdeà
SSBM


205 
	`vrf_cu¡
 (* 
c
, 
mode
);

206 
	`vrf_·¹
 (* 
p
, 
mode
);

207 
	`vrf_suµ
 (* 
s
, 
mode
);

208 
	`vrf_lše
 (* 
o
, 
mode
);

209 
	`vrf_Üd”
 (* 
o
, 
mode
);

210 
	`vrf_d©e
 (*
d
 ,
mode
);

212 
	`vrf_cu¡
 (* 
c
, 
mode
);

213 
	`vrf_lše
 (* 
o
, 
mode
);

214 
	`vrf_Üd”
 (* 
o
, 
mode
);

215 
	`vrf_·¹
 (* 
p
, 
mode
);

216 
	`vrf_psuµ
 (* 
p
, 
mode
);

217 
	`vrf_suµ
 (* 
s
, 
mode
);

218 
	`vrf_Üd”_lše
 (* 
o
, 
mode
);

219 
	`vrf_·¹_psuµ
 (* 
p
, 
mode
);

220 
	`vrf_ÇtiÚ
 (* 
c
, 
mode
);

221 
	`vrf_»giÚ
 (* 
c
, 
mode
);

225 #ifdeà
SSBM


226 
tdef
 
tdefs
[] =

229 {"·¹.tbl", "·¹abË", 200000, 
hd_·¹
,

230 {
´_·¹
, 
ld_·¹
}, 
sd_·¹
, 
vrf_·¹
, 
PSUPP
, 0},

232 {"suµl›r.tbl", "suµl›r bË", 10000, 
hd_suµ
,

233 {
´_suµ
, 
ld_suµ
}, 
sd_suµ
, 
vrf_suµ
, 
NONE
, 0},

235 {"cu¡om”.tbl", "cu¡om” bË", 30000, 
hd_cu¡
,

236 {
´_cu¡
, 
ld_cu¡
}, 
sd_cu¡
, 
vrf_cu¡
, 
NONE
, 0},

237 {"d©e.tbl","d©bË",2556,0,{
´_d©e
,
ld_d©e
}, 0,
vrf_d©e
, 
NONE
,0},

240 {"lšeÜd”.tbl", "lšeÜd”abË", 150000, 
hd_lše
,

241 {
´_lše
, 
ld_lše
}, 
sd_lše
, 
vrf_lše
, 
NONE
, 0},

246 
	}
};

250 
tdef
 
	gtdefs
[] =

252 {"·¹.tbl", "·¹abË", 200000, 
hd_·¹
,

253 {
´_·¹
, 
ld_·¹
}, 
sd_·¹
, 
vrf_·¹
, 
PSUPP
, 0},

254 {"·¹suµ.tbl", "·¹suµl›¸bË", 200000, 
hd_psuµ
,

255 {
´_psuµ
, 
ld_psuµ
}, 
sd_psuµ
, 
vrf_psuµ
, 
NONE
, 0},

256 {"suµl›r.tbl", "suµl›r bË", 10000, 
hd_suµ
,

257 {
´_suµ
, 
ld_suµ
}, 
sd_suµ
, 
vrf_suµ
, 
NONE
, 0},

258 {"cu¡om”.tbl", "cu¡om” bË", 150000, 
hd_cu¡
,

259 {
´_cu¡
, 
ld_cu¡
}, 
sd_cu¡
, 
vrf_cu¡
, 
NONE
, 0},

260 {"Üd”s.tbl", "Üd”abË", 150000, 
hd_Üd”
,

261 {
´_Üd”
, 
ld_Üd”
}, 
sd_Üd”
, 
vrf_Üd”
, 
LINE
, 0},

262 {"lše™em.tbl", "lše™emabË", 150000, 
hd_lše
,

263 {
´_lše
, 
ld_lše
}, 
sd_lše
, 
vrf_lše
, 
NONE
, 0},

264 {"Üd”s.tbl", "Üd”s/lše™emabËs", 150000, 
hd_Üd”_lše
,

265 {
´_Üd”_lše
, 
ld_Üd”_lše
}, 
sd_Üd”
, 
vrf_Üd”_lše
, 
LINE
, 0},

266 {"·¹.tbl", "·¹/·¹suµl›¸bËs", 200000, 
hd_·¹_psuµ
,

267 {
´_·¹_psuµ
, 
ld_·¹_psuµ
}, 
sd_·¹
, 
vrf_·¹_psuµ
, 
PSUPP
, 0},

268 {"ÇtiÚ.tbl", "ÇtiÚabË", 
NATIONS_MAX
, 
hd_ÇtiÚ
,

269 {
´_ÇtiÚ
, 
ld_ÇtiÚ
}, 
NO_LFUNC
, 
vrf_ÇtiÚ
, 
NONE
, 0},

270 {"»giÚ.tbl", "»giÚabË", 
NATIONS_MAX
, 
hd_»giÚ
,

271 {
´_»giÚ
, 
ld_»giÚ
}, 
NO_LFUNC
, 
vrf_»giÚ
, 
NONE
, 0},

274 *
	gpids
;

282 
	$¡İ_´oc
 (
signum
)

284 
	`ex™
 (0);

285 
	}
}

288 
	$kl_lßd
 ()

290 
i
;

292 #ià!
	`defšed
(
U2200
è&& !defšed(
DOS
)

293 
i
 = 0; i < 
chd»n
; i++)

294 ià(
pids
[
i
])

295 
	`KILL
 (
pids
[
i
]);

298 
	}
}

304 
	$£t_fes
 (
i
, 
¶ßd
)

306 
lše
[80], *
Ãw_Çme
;

308 ià(
bË
 & (1 << 
i
))

309 
chd_bË
:

311 ià(
¶ßd
 != -1)

312 
	`¥rštf
 (
lše
, "%s.%d", 
tdefs
[
i
].
Çme
, 
¶ßd
);

315 
	`´štf
 ("Enter‚ew destination for %s data: ",

316 
tdefs
[
i
].
Çme
);

317 ià(
	`fg‘s
 (
lše
,  (lše), 
¡dš
è=ğ
NULL
)

319 ià((
Ãw_Çme
 = 
	`¡rchr
 (
lše
, '\n')è!ğ
NULL
)

320 *
Ãw_Çme
 = '\0';

321 ià(
	`¡¾’
 (
lše
) == 0)

324 
Ãw_Çme
 = (*è
	`m®loc
 (
	`¡¾’
 (
lše
) + 1);

325 
	`MALLOC_CHECK
 (
Ãw_Çme
);

326 
	`¡rıy
 (
Ãw_Çme
, 
lše
);

327 
tdefs
[
i
].
Çme
 = 
Ãw_Çme
;

328 ià(
tdefs
[
i
].
chd
 !ğ
NONE
)

330 
i
 = 
tdefs
[i].
chd
;

331 
tdefs
[
i
].
chd
 = 
NONE
;

332 
chd_bË
;

337 
	}
}

345 
	$lßd_di¡s
 ()

347 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "p_úŒ", &
p_úŒ_£t
);

348 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "cŞÜs", &
cŞÜs
);

349 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "p_ty³s", &
p_ty³s_£t
);

350 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "ÇtiÚs", &
ÇtiÚs
);

351 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "»giÚs", &
»giÚs
);

352 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "o_oprio",

353 &
o_´iÜ™y_£t
);

354 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "instruct",

355 &
l_š¡ruù_£t
);

356 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "smode", &
l_smode_£t
);

357 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "category",

358 &
l_ÿ‹gÜy_£t
);

359 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "ræag", &
l_ræag_£t
);

360 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "m£gmÁ", &
c_m£g_£t
);

363 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "nouns", &
nouns
);

364 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "v”bs", &
v”bs
);

365 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "adjeùives", &
adjeùives
);

366 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "adv”bs", &
adv”bs
);

367 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "auxÏr›s", &
auxÏr›s
);

368 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "‹rmš©Üs", &
‹rmš©Üs
);

369 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "¬tişes", &
¬tişes
);

370 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "´•os™iÚs", &
´•os™iÚs
);

371 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "g¿mm¬", &
g¿mm¬
);

372 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "Å", &
Å
);

373 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "vp", &
vp
);

375 
	}
}

381 
	$g’_tbl
 (
Šum
, 
¡¬t
, 
couÁ
, 
upd_num
)

383 
Üd”_t
 
o
;

384 
suµl›r_t
 
suµ
;

385 
cu¡om”_t
 
cu¡
;

386 
·¹_t
 
·¹
;

387 #ifdeà
SSBM


388 
d©e_t
 
dt
;

390 
code_t
 
code
;

392 
com¶‘ed
 = 0;

393 
š™
 = 0;

394 
i
;

396 
rows_³r_£gm’t
=0;

397 
rows_this_£gm’t
=-1;

398 
»sidu®_rows
=0;

400 ià(
š£¹_£gm’ts
)

402 
rows_³r_£gm’t
 = 
couÁ
 / 
š£¹_£gm’ts
;

403 
»sidu®_rows
 = 
couÁ
 - (
rows_³r_£gm’t
 * 
š£¹_£gm’ts
);

406 ià(
š™
 == 0)

408 
	`INIT_HUGE
(
o
.
okey
);

409 
i
=0; i < 
O_LCNT_MAX
; i++)

410 #ifdeà
SSBM


411 
	`INIT_HUGE
(
o
.
lšeÜd”s
[
i
].
okey
);

413 
	`INIT_HUGE
(
o
.
l
[
i
].
okey
);

415 
š™
 = 1;

418 
i
 = 
¡¬t
; 
couÁ
; count--, i++)

420 
	`LIFENOISE
 (1000, 
i
);

421 
	`row_¡¬t
(
Šum
);

423 
Šum
)

425 
LINE
:

426 #ifdeà
SSBM


428 
ORDER
:

429 
ORDER_LINE
:

431 
	`mk_Üd”
 (
i
, &
o
, 
upd_num
 % 10000);

433 ià(
š£¹_£gm’ts
 && (
upd_num
 > 0))

434 if((
upd_num
 / 10000è< 
»sidu®_rows
)

436 if((++
rows_this_£gm’t
è> 
rows_³r_£gm’t
)

438 
rows_this_£gm’t
=0;

439 
upd_num
 += 10000;

444 if((++
rows_this_£gm’t
è>ğ
rows_³r_£gm’t
)

446 
rows_this_£gm’t
=0;

447 
upd_num
 += 10000;

451 ià(
£t_£eds
 == 0)

452 ià(
v®id©e
)

453 
tdefs
[
Šum
].
	`v”ify
((*)&
o
, 0);

455 
tdefs
[
Šum
].
lßd”
[
dœeù
] ((*)&
o
, 
upd_num
);

457 
SUPP
:

458 
	`mk_suµ
 (
i
, &
suµ
);

459 ià(
£t_£eds
 == 0)

460 ià(
v®id©e
)

461 
tdefs
[
Šum
].
	`v”ify
((*)&
suµ
, 0);

463 
tdefs
[
Šum
].
lßd”
[
dœeù
] ((*)&
suµ
, 
upd_num
);

465 
CUST
:

466 
	`mk_cu¡
 (
i
, &
cu¡
);

467 ià(
£t_£eds
 == 0)

468 ià(
v®id©e
)

469 
tdefs
[
Šum
].
	`v”ify
((*)&
cu¡
, 0);

471 
tdefs
[
Šum
].
lßd”
[
dœeù
] ((*)&
cu¡
, 
upd_num
);

473 #ifdeà
SSBM


474 
PART
:

476 
PSUPP
:

477 
PART
:

478 
PART_PSUPP
:

480 
	`mk_·¹
 (
i
, &
·¹
);

481 ià(
£t_£eds
 == 0)

482 ià(
v®id©e
)

483 
tdefs
[
Šum
].
	`v”ify
((*)&
·¹
, 0);

485 
tdefs
[
Šum
].
lßd”
[
dœeù
] ((*)&
·¹
, 
upd_num
);

487 #ifdeà
SSBM


488 
DATE
:

489 
	`mk_d©e
 (
i
, &
dt
);

490 ià(
£t_£eds
 == 0)

491 ià(
v®id©e
)

492 
tdefs
[
Šum
].
	`v”ify
((*)&
dt
, 0);

494 
tdefs
[
Šum
].
lßd”
[
dœeù
] ((*)&
dt
, 0);

497 
NATION
:

498 
	`mk_ÇtiÚ
 (
i
, &
code
);

499 ià(
£t_£eds
 == 0)

500 ià(
v®id©e
)

501 
tdefs
[
Šum
].
	`v”ify
((*)&
code
, 0);

503 
tdefs
[
Šum
].
lßd”
[
dœeù
] ((*)&
code
, 0);

505 
REGION
:

506 
	`mk_»giÚ
 (
i
, &
code
);

507 ià(
£t_£eds
 == 0)

508 ià(
v®id©e
)

509 
tdefs
[
Šum
].
	`v”ify
((*)&
code
, 0);

511 
tdefs
[
Šum
].
lßd”
[
dœeù
] ((*)&
code
, 0);

515 
	`row_¡İ
(
Šum
);

516 ià(
£t_£eds
 && (
i
 % 
tdefs
[
Šum
].
ba£
) < 2)

518 
	`´štf
("\nS“d fÜ % ©„owcouÁ %ld\n", 
tdefs
[
Šum
].
comm’t
, 
i
);

519 
	`dump_£eds
(
Šum
);

522 
com¶‘ed
 |ğ1 << 
Šum
;

523 
	}
}

528 
	$u§ge
 ()

530 #ifdeà
SSBM


531 
	`årštf
 (
¡d”r
, "%s\n%s\n\t%s\n%s %s\n\n",

539 
	`årštf
 (
¡d”r
, "%s\n%s\n\t%s\n%s %s\n\n",

546 
	`årštf
 (
¡d”r
, "-b <s> --†oad distributions for <s>\n");

547 
	`årštf
 (
¡d”r
, "-C <n> -- use <n>…rocesseso generate data\n");

548 
	`årštf
 (
¡d”r
, " [Under DOS, must be used with -S]\n");

549 
	`årštf
 (
¡d”r
, "-D -- do database†oad in†ine\n");

550 
	`årštf
 (
¡d”r
, "-d <n> -- split deletes between <n> files\n");

551 
	`årštf
 (
¡d”r
, "-f -- force. Overwriteƒxisting files\n");

552 
	`årštf
 (
¡d”r
, "-F -- generate flat files output\n");

553 
	`årštf
 (
¡d”r
, "-h -- displayhis message\n");

554 
	`årštf
 (
¡d”r
, "-i <n> -- split inserts between <n> files\n");

555 
	`årštf
 (
¡d”r
, "-n <s> -- inline†oad into database <s>\n");

556 
	`årštf
 (
¡d”r
, "-O d -- generate SQL syntax for deletes\n");

557 
	`årštf
 (
¡d”r
, "-O f -- over-ride default output file‚ames\n");

558 
	`årštf
 (
¡d”r
, "-O h -- output files with headers\n");

559 
	`årštf
 (
¡d”r
, "-O m --…roduce columnar output\n");

560 
	`årštf
 (
¡d”r
, "-O„ -- generate key„anges for deletes.\n");

561 
	`årštf
 (
¡d”r
, "-O v -- Verify data set without generating it.\n");

562 
	`årštf
 (
¡d”r
, "-q --ƒnable QUIET mode\n");

563 
	`årštf
 (
¡d”r
, "-r <n> -- updates„efresh (n/100)%% ofhe\n");

564 
	`årštf
 (
¡d”r
, " data set\n");

565 
	`årštf
 (
¡d”r
, "-s <n> -- set Scale Factor (SF)o <n> \n");

566 
	`årštf
 (
¡d”r
, "-S <n> -- buildhe <n>th step ofhe data/update set\n");

568 #ifdeà
SSBM


569 
	`årštf
 (
¡d”r
, "-T c -- generate cutomers dimensionable ONLY\n");

570 
	`årštf
 (
¡d”r
, "-T… -- generate…arts dimensionable ONLY\n");

571 
	`årštf
 (
¡d”r
, "-T s -- generate suppliers dimensionable ONLY\n");

572 
	`årštf
 (
¡d”r
, "-T d -- generate date dimensionable ONLY\n");

573 
	`årštf
 (
¡d”r
, "-T† -- generate†ineorder factable ONLY\n");

575 
	`årštf
 (
¡d”r
, "-T c -- generate cutomers ONLY\n");

576 
	`årštf
 (
¡d”r
, "-T† -- generate‚ation/region ONLY\n");

577 
	`årštf
 (
¡d”r
, "-T L -- generate†ineitem ONLY\n");

578 
	`årštf
 (
¡d”r
, "-T‚ -- generate‚ation ONLY\n");

579 
	`årštf
 (
¡d”r
, "-T o -- generate orders/lineitem ONLY\n");

580 
	`årštf
 (
¡d”r
, "-T O -- generate orders ONLY\n");

581 
	`årštf
 (
¡d”r
, "-T… -- generate…arts/partsupp ONLY\n");

582 
	`årštf
 (
¡d”r
, "-T P -- generate…arts ONLY\n");

583 
	`årštf
 (
¡d”r
, "-T„ -- generate„egion ONLY\n");

584 
	`årštf
 (
¡d”r
, "-T s -- generate suppliers ONLY\n");

585 
	`årštf
 (
¡d”r
, "-T S -- generate…artsupp ONLY\n");

588 
	`årštf
 (
¡d”r
, "-U <s> -- generate <s> update sets\n");

589 
	`årštf
 (
¡d”r
, "-v --ƒnable VERBOSE mode\n");

590 
	`årštf
 (
¡d”r
,

592 
	`årštf
 (
¡d”r
, "\tdbgen -vfF -s 1\n");

593 
	`årštf
 (
¡d”r
, "\nTo generate updates for‡ SF=1 (1GB), use:\n");

594 
	`årštf
 (
¡d”r
, "\tdbgen -v -U 1 -s 1\n");

595 
	}
}

604 
	$·¹Ÿl
 (
tbl
, 
s
)

606 
rowút
;

607 
exŒa
;

609 ià(
v”bo£
 > 0)

611 
	`årštf
 (
¡d”r
, "\tStartingo†oad stage %d of %ld for %s...",

612 
s
, 
chd»n
, 
tdefs
[
tbl
].
comm’t
);

615 ià(
dœeù
 == 0)

616 
	`£t_fes
 (
tbl
, 
s
);

618 
rowút
 = 
	`£t_¡©e
(
tbl
, 
sÿË
, 
chd»n
, 
s
, &
exŒa
);

620 ià(
s
 =ğ
chd»n
)

621 
	`g’_tbl
 (
tbl
, 
rowút
 * (
s
 - 1è+ 1,„owúˆ+ 
exŒa
, 
upd_num
);

623 
	`g’_tbl
 (
tbl
, 
rowút
 * (
s
 - 1è+ 1,„owút, 
upd_num
);

625 ià(
v”bo£
 > 0)

626 
	`årštf
 (
¡d”r
, "done.\n");

629 
	}
}

631 #iâdeà
DOS


634 
	$¶ßd
 (
tbl
)

636 
c
 = 0, 
i
, 
¡©us
;

638 ià(
v”bo£
 > 0)

640 
	`årštf
 (
¡d”r
, "Starting %ld childreno†oad %s",

641 
chd»n
, 
tdefs
[
tbl
].
comm’t
);

643 
c
 = 0; c < 
chd»n
; c++)

645 
pids
[
c
] = 
	`SPAWN
 ();

646 ià(
pids
[
c
] == -1)

648 
	`³¼Ü
 ("Child†oader‚ot created");

649 
	`kl_lßd
 ();

650 
	`ex™
 (-1);

652 ià(
pids
[
c
] == 0)

654 
	`SET_HANDLER
 (
¡İ_´oc
);

655 
v”bo£
 = 0;

656 
	`·¹Ÿl
 (
tbl
, 
c
+1);

657 
	`ex™
 (0);

659 ià(
v”bo£
 > 0)

660 
	`årštf
 (
¡d”r
, ".");

663 ià(
v”bo£
 > 0)

664 
	`årštf
 (
¡d”r
, "waiting...");

666 
c
 = 
chd»n
;

667 
c
)

669 
i
 = 
	`WAIT
 (&
¡©us
, 
pids
[
c
 - 1]);

670 ià(
i
 =ğ-1 && 
chd»n
)

672 ià(
”ºo
 =ğ
ECHILD
)

673 
	`årštf
 (
¡d”r
, "\nCould‚Ù wa™ oÀpid %d\n", 
pids
[
c
 - 1]);

674 ià(
”ºo
 =ğ
EINTR
)

675 
	`årštf
 (
¡d”r
, "\nProûs %d stİ³d‡bnÜm®ly\n", 
pids
[
c
 - 1]);

676 ià(
”ºo
 =ğ
EINVAL
)

677 
	`årštf
 (
¡d”r
, "\nProgram bug\n");

679 ià(! 
	`WIFEXITED
(
¡©us
)) {

680 (è
	`årštf
(
¡d”r
, "\nProûs %d: ", 
i
);

681 ià(
	`WIFSIGNALED
(
¡©us
)) {

682 (è
	`årštf
(
¡d”r
, "rcvd signal %d\n",

683 
	`WTERMSIG
(
¡©us
));

684 } ià(
	`WIFSTOPPED
(
¡©us
)) {

685 (è
	`årštf
(
¡d”r
, "stopped, signal %d\n",

686 
	`WSTOPSIG
(
¡©us
));

690 
c
--;

693 ià(
v”bo£
 > 0)

694 
	`årštf
 (
¡d”r
, "done\n");

696 
	}
}

701 
	$´oûss_İtiÚs
 (
couÁ
, **
veùÜ
)

703 
İtiÚ
;

705 (
İtiÚ
 = 
	`g‘İt
 (
couÁ
, 
veùÜ
,

711 
İtiÚ
)

714 
d_·th
 = (*)
	`m®loc
(
	`¡¾’
(
İrg
) + 1);

715 
	`MALLOC_CHECK
(
d_·th
);

716 
	`¡rıy
(
d_·th
, 
İrg
);

719 
v”bo£
 = -1;

722 
š£¹_£gm’ts
 = 
	`©oi
 (
İrg
);

725 
d–‘e_£gm’ts
 = 
	`©oi
 (
İrg
);

728 
¡•
 = 
	`©oi
 (
İrg
);

731 
v”bo£
 = 1;

734 
fÜû
 = 1;

737 *
İrg
)

739 #ifdeà
SSBM


741 
bË
 = 1 << 
CUST
;

744 
bË
 = 1 << 
PART
;

747 
bË
 = 1 << 
SUPP
;

750 
bË
 = 1 << 
DATE
;

753 
bË
 = 1 << 
LINE
;

756 
bË
 = 1 << 
CUST
;

757 
bË
 |ğ1 << 
PART
;

758 
bË
 |ğ1 << 
SUPP
;

759 
bË
 |ğ1 << 
DATE
;

760 
bË
 |ğ1 << 
LINE
;

764 
bË
 = 1 << 
CUST
;

767 
bË
 = 1 << 
LINE
;

770 
bË
 = 1 << 
NATION
;

771 
bË
 |ğ1 << 
REGION
;

774 
bË
 = 1 << 
NATION
;

777 
bË
 = 1 << 
ORDER
;

780 
bË
 = 1 << 
ORDER_LINE
;

783 
bË
 = 1 << 
PART
;

786 
bË
 = 1 << 
PART_PSUPP
;

789 
bË
 = 1 << 
REGION
;

792 
bË
 = 1 << 
PSUPP
;

795 
bË
 = 1 << 
SUPP
;

799 
	`årštf
 (
¡d”r
, "Unknownable‚ame %s\n",

800 
İrg
);

801 
	`u§ge
 ();

802 
	`ex™
 (1);

807 
æt_sÿË
 = 
	`©of
 (
İrg
);

808 ià(
æt_sÿË
 < 
MIN_SCALE
)

810 
i
;

812 
sÿË
 = 1;

813 
i
 = 
PART
; i < 
REGION
; i++)

815 
tdefs
[
i
].
ba£
 *ğ
æt_sÿË
;

816 ià(
tdefs
[
i
].
ba£
 < 1)

817 
tdefs
[
i
].
ba£
 = 1;

821 
sÿË
 = (è
æt_sÿË
;

822 ià(
sÿË
 > 
MAX_SCALE
)

824 
	`årštf
 (
¡d”r
, "%s %5.0f %s\n\t%s\n\n",

826 
MAX_SCALE
,

829 
	`årštf
 (
¡d”r
,

834 
	`tŞow”
 (*
İrg
))

837 
g’_sql
 = 1;

840 
âames
 = 1;

843 
h—d”
 = 1;

846 
cŞumÇr
 = 1;

849 
g’_ºg
 = 1;

852 
£t_£eds
 = 1;

855 
v®id©e
 = 1;

858 
	`årštf
 (
¡d”r
, "Unknown option‚ame %s\n",

859 
İrg
);

860 
	`u§ge
 ();

861 
	`ex™
 (1);

865 
dœeù
 = 1;

868 
dœeù
 = 0;

871 
upd©es
 = 
	`©oi
 (
İrg
);

874 
»äesh
 = 
	`©oi
 (
İrg
);

876 #iâdeà
DOS


878 
chd»n
 = 
	`©oi
 (
İrg
);

882 
db_Çme
 = (*è
	`m®loc
 (
	`¡¾’
 (
İrg
) + 1);

883 
	`MALLOC_CHECK
 (
db_Çme
);

884 
	`¡rıy
 (
db_Çme
, 
İrg
);

887 
	`´štf
 ("ERROR: option '%c' unknown.\n",

888 *(
veùÜ
[
İtšd
] + 1));

890 
	`årštf
 (
¡d”r
,

892 
NAME
, 
VERSION
, 
RELEASE
,

893 
MODIFICATION
, 
PATCH
);

896 
	`årštf
 (
¡d”r
, "Cİyrighˆ% %s\n", 
TPC
, 
C_DATES
);

897 
	`u§ge
 ();

898 
	`ex™
 (1);

905 #iâdeà
DOS


906 ià(
chd»n
 !ğ1 && 
¡•
 == -1)

908 
pids
 = (*)
	`m®loc
(
chd»n
 * (
pid_t
));

909 
	`MALLOC_CHECK
(
pids
)

912 ià(
chd»n
 !ğ1 && 
¡•
 < 0)

914 
	`årštf
(
¡d”r
, "ERROR: -C must be‡ccompanied by -S onhis…latform\n");

915 
	`ex™
(1);

920 
	}
}

922 
	$EXIT_NAMESPACE
(
dbg’ssb
)

924 
usšg
 
Çme¥aû
 
dbg’ssb
;

931 
	$ssb_dbg’_š™
()

934 
bË
 = (1 << 
PART
) |

935 (1 << 
SUPP
) |

936 (1 << 
CUST
) |

937 (1 << 
DATE
) |

938 (1 << 
LINE
);

939 
fÜû
 = 0;

940 
š£¹_£gm’ts
=0;

941 
d–‘e_£gm’ts
=0;

942 
š£¹_Üd”s_£gm’t
=0;

943 
š£¹_lše™em_£gm’t
=0;

944 
d–‘e_£gm’t
=0;

945 
v”bo£
 = 0;

946 
cŞumÇr
 = 0;

947 
£t_£eds
 = 0;

948 
h—d”
 = 0;

949 
dœeù
 = 0;

950 
sÿË
 = 1;

951 
æt_sÿË
 = 1.0;

952 
upd©es
 = 0;

953 
»äesh
 = 
UPD_PCT
;

954 
¡•
 = -1;

956 
tdefs
[
LINE
].
ba£
 *=

957 
ORDERS_PER_CUST
;

959 
âames
 = 0;

960 
db_Çme
 = 
NULL
;

961 
g’_sql
 = 0;

962 
g’_ºg
 = 0;

963 
chd»n
 = 1;

964 
d_·th
 = 
NULL
;

966 
	`lßd_di¡s
 ();

968 
tdefs
[
NATION
].
ba£
 = 
ÇtiÚs
.
couÁ
;

969 
tdefs
[
REGION
].
ba£
 = 
»giÚs
.
couÁ
;

972 
	}
}

976 
	$maš22
 (
ac
, **
av
)

978 
i
;

986 
bË
 = (1 << 
PART
) |

987 (1 << 
SUPP
) |

988 (1 << 
CUST
) |

989 (1 << 
DATE
) |

990 (1 << 
LINE
);

991 
fÜû
 = 0;

992 
š£¹_£gm’ts
=0;

993 
d–‘e_£gm’ts
=0;

994 
š£¹_Üd”s_£gm’t
=0;

995 
š£¹_lše™em_£gm’t
=0;

996 
d–‘e_£gm’t
=0;

997 
v”bo£
 = 0;

998 
cŞumÇr
 = 0;

999 
£t_£eds
 = 0;

1000 
h—d”
 = 0;

1001 
dœeù
 = 0;

1002 
sÿË
 = 1;

1003 
æt_sÿË
 = 1.0;

1004 
upd©es
 = 0;

1005 
»äesh
 = 
UPD_PCT
;

1006 
¡•
 = -1;

1008 
tdefs
[
LINE
].
ba£
 *=

1009 
ORDERS_PER_CUST
;

1011 
âames
 = 0;

1012 
db_Çme
 = 
NULL
;

1013 
g’_sql
 = 0;

1014 
g’_ºg
 = 0;

1015 
chd»n
 = 1;

1016 
d_·th
 = 
NULL
;

1019 
	`´oûss_İtiÚs
 (
ac
, 
av
);

1022 
	`lßd_di¡s
 ();

1024 
tdefs
[
NATION
].
ba£
 = 
ÇtiÚs
.
couÁ
;

1025 
tdefs
[
REGION
].
ba£
 = 
»giÚs
.
couÁ
;

1035 
i
 = 
PART
; i <ğ
REGION
; i++)

1036 ià(
bË
 & (1 << 
i
))

1038 ià(
chd»n
 > 1 && 
i
 < 
NATION
)

1040 ià(
¡•
 >= 0)

1042 ià(
v®id©e
)

1044 
	`INTERNAL_ERROR
("Cannot validate…arallel data generation");

1048 
	`·¹Ÿl
 (
i
, 
¡•
);

1053 ià(
v®id©e
)

1055 
	`INTERNAL_ERROR
("Cannot validate…arallel data generation");

1059 
	`¶ßd
 (
i
);

1065 
mšrow
 = 1;

1066 ià(
i
 < 
NATION
) {

1067 
rowút
 = 
tdefs
[
i
].
ba£
 * 
sÿË
;

1070 
rowút
 = 
tdefs
[
i
].
ba£
;

1072 if(
i
==
PART
){

1073 
rowút
 = 
tdefs
[
i
].
ba£
 * (
	`æoÜ
(1+
	`log
(()(
sÿË
))/(log(2))));

1075 if(
i
==
DATE
){

1076 
rowút
 = 
tdefs
[
i
].
ba£
;

1078 ià(
v”bo£
 > 0){

1079 
	`årštf
 (
¡d”r
, "%s data for %s [pid: %ld]",

1080 (
v®id©e
)?"V®id©šg":"G’”©šg", 
tdefs
[
i
].
comm’t
, ()
DSS_PROC
);

1082 
	`g’_tbl
 (
i
, 
mšrow
, 
rowút
, 
upd_num
);

1083 ià(
v”bo£
 > 0){

1084 
	`årštf
 (
¡d”r
, "done.\n");

1087 ià(
v®id©e
)

1089 
	`´štf
("Validation checksum for %s‡t %ld GB: %0x\n",

1090 
tdefs
[
i
].
Çme
, 
sÿË
, (édefs[i].
vtÙ®
);

1097 
	}
}

	@src/workload/ssb/dbgen/ssb_bcd2.cpp

15 
	~<¡dio.h
>

16 
	~"wÜklßd/ssb/dbg’/bcd2.h
"

18 
	#DIGITS_PER_LONG
 7

	)

19 
	#WORD_DIVISOR
 10000000

	)

20 
	#GET_DIGIT
(
num
, 
low
, 
high
) \

21 ((
num
è>ğ
DIGITS_PER_LONG
)? \

22 (
high
 & (0xF << (4 * ((
num
è- 
DIGITS_PER_LONG
)))) \

23 >> (((
num
è- 
DIGITS_PER_LONG
) * 4): \

24 (
low
 & (0xF << (4 * (
num
)))è>> (Òumè* 4)

	)

25 
	#SET_DIGIT
(
v®ue
, 
num
, 
low
, 
high
) \

26 ià((
num
è>ğ
DIGITS_PER_LONG
) \

28 *
high
 &= \

29 (0xFFFFFFF ^ (0xF << (4 * ((
num
è- 
DIGITS_PER_LONG
)))); \

30 *
high
 |ğ(
v®ue
 << (4 * ((
num
è- 
DIGITS_PER_LONG
))); \

34 *
low
 = (*low & (0xFFFFFFF ^ (0xF << (4 * (
num
))))); \

35 *
low
 |ğ(
v®ue
 << (4 * (
num
))); \

36 }

	)

38 
	$ENTER_NAMESPACE
(
dbg’ssb
)

41 
	$bš_bcd2
(
bš¬y
, *
low_»s
, *
high_»s
)

43 
numb”
[15],

44 *
cu¼’t
;

45 
couÁ
;

46 *
de¡
;

48 *
low_»s
 = *
high_»s
 = 0;

49 
	`¥rštf
(
numb”
, "%014ld", 
bš¬y
);

50 
cu¼’t
 = 
numb”
, 
couÁ
=13; *current; current++, count--)

52 
de¡
 = (
couÁ
 < 
DIGITS_PER_LONG
)?
low_»s
:
high_»s
;

53 *
de¡
 = *dest << 4;

54 *
de¡
 |ğ*
cu¼’t
 - '0';

57 
	}
}

60 
	$bcd2_bš
(*
de¡
, 
bcd
)

62 
couÁ
;

63 
mask
;

65 
couÁ
 = 
DIGITS_PER_LONG
 - 1;

66 
mask
 = 0xF000000;

67 *
de¡
 = 0;

68 
mask
)

70 *
de¡
 *= 10;

71 *
de¡
 +ğ(
bcd
 & 
mask
è>> (4 * 
couÁ
);

72 
mask
 = mask >> 4;

73 
couÁ
 -= 1;

76 
	}
}

79 
	$bcd2_add
(*
bcd_low
, *
bcd_high
, 
add’d
)

81 
tmp_lo
, 
tmp_hi
, 
ÿ¼y
, 
»s
;

82 
dig™
;

84 
	`bš_bcd2
(
add’d
, &
tmp_lo
, &
tmp_hi
);

85 
ÿ¼y
 = 0;

86 
dig™
=0; digit < 14; digit++)

88 
»s
 = 
	`GET_DIGIT
(
dig™
, *
bcd_low
, *
bcd_high
);

89 
»s
 +ğ
	`GET_DIGIT
(
dig™
, 
tmp_lo
, 
tmp_hi
);

90 
»s
 +ğ
ÿ¼y
;

91 
ÿ¼y
 = 
»s
 / 10;

92 
»s
 %= 10;

93 
	`SET_DIGIT
(
»s
, 
dig™
, 
bcd_low
, 
bcd_high
);

95 (
ÿ¼y
);

96 
	}
}

99 
	$bcd2_sub
(*
bcd_low
, *
bcd_high
, 
sub’d
)

101 
tmp_lo
, 
tmp_hi
, 
ÿ¼y
, 
»s
;

102 
dig™
;

104 
	`bš_bcd2
(
sub’d
, &
tmp_lo
, &
tmp_hi
);

105 
ÿ¼y
 = 0;

106 
dig™
=0; digit < 14; digit++)

108 
»s
 = 
	`GET_DIGIT
(
dig™
, *
bcd_low
, *
bcd_high
);

109 
»s
 -ğ
	`GET_DIGIT
(
dig™
, 
tmp_lo
, 
tmp_hi
);

110 
»s
 -ğ
ÿ¼y
;

111 ià(
»s
 < 0)

113 
»s
 += 10;

114 
ÿ¼y
 = 1;

116 
	`SET_DIGIT
(
»s
, 
dig™
, 
bcd_low
, 
bcd_high
);

118 (
ÿ¼y
);

119 
	}
}

122 
	$bcd2_mul
(*
bcd_low
, *
bcd_high
, 
muÉl›r
)

124 
tmp_lo
, 
tmp_hi
, 
ÿ¼y
, 
m_lo
, 
m_hi
, 
m1
, 
m2
;

125 
udig™
, 
ldig™
, 
»s
;

127 
tmp_lo
 = *
bcd_low
;

128 
tmp_hi
 = *
bcd_high
;

129 
	`bš_bcd2
(
muÉl›r
, &
m_lo
, &
m_hi
);

130 *
bcd_low
 = 0;

131 *
bcd_high
 = 0;

132 
ÿ¼y
 = 0;

133 
ldig™
=0;†digit < 14;†digit++)

135 
m1
 = 
	`GET_DIGIT
(
ldig™
, 
m_lo
, 
m_hi
);

136 
ÿ¼y
 = 0;

137 
udig™
=0; udigit < 14; udigit++)

139 
m2
 = 
	`GET_DIGIT
(
udig™
, 
tmp_lo
, 
tmp_hi
);

140 
»s
 = 
m1
 * 
m2
;

141 
»s
 +ğ
ÿ¼y
;

142 ià(
udig™
 + 
ldig™
 < 14)

144 
ÿ¼y
 = 
	`GET_DIGIT
(
udig™
 + 
ldig™
, *
bcd_low
, *
bcd_high
);

145 
»s
 +ğ
ÿ¼y
;

147 
ÿ¼y
 = 
»s
 / 10;

148 
»s
 %= 10;

149 ià(
udig™
 + 
ldig™
 < 14)

151 
	`SET_DIGIT
(
»s
, 
udig™
 + 
ldig™
, 
bcd_low
, 
bcd_high
);

155 (
ÿ¼y
);

156 
	}
}

159 
	$bcd2_div
(*
bcd_low
, *
bcd_high
, 
divisÜ
)

161 
tmp_lo
, 
tmp_hi
, 
ÿ¼y
, 
d1
, 
»s
, 
dig™
;

164 
ÿ¼y
 = 0;

165 
tmp_lo
 = *
bcd_low
;

166 
tmp_hi
 = *
bcd_high
;

167 *
bcd_low
 = *
bcd_high
 = 0;

168 
dig™
=13; digit >= 0; digit--)

170 
d1
 = 
	`GET_DIGIT
(
dig™
, 
tmp_lo
, 
tmp_hi
);

171 
d1
 +ğ10 * 
ÿ¼y
;

172 
»s
 = 
d1
 / 
divisÜ
;

173 
ÿ¼y
 = 
d1
 % 
divisÜ
;

174 
	`SET_DIGIT
(
»s
, 
dig™
, 
bcd_low
, 
bcd_high
);

176 (
ÿ¼y
);

177 
	}
}

180 
	$bcd2_mod
(*
bcd_low
, *
bcd_high
, 
modulo
)

182 
tmp_low
, 
tmp_high
;

184 
tmp_low
 = *
bcd_low
;

185 
tmp_high
 = *
bcd_high
;

186 
tmp_high
 || 
tmp_low
 > 
modulo
)

187 
	`bcd2_sub
(&
tmp_low
, &
tmp_high
, 
modulo
);

188 (
tmp_low
);

189 
	}
}

192 
	$bcd2_cmp
(*
low1
, *
high1
, 
comp
)

194 
‹mp
 = 0;

196 
	`bcd2_bš
(&
‹mp
, *
high1
);

197 ià(
‹mp
 > 214)

199 
	`bcd2_bš
(&
‹mp
, *
low1
);

200 (
‹mp
 - 
comp
);

201 
	}
}

203 #ifdeà
TEST_BCD


204 
	~<v®ues.h
>

206 
	$maš_‹¡
(, **)

208 
bš
, 
low_bcd
, 
high_bcd
;

209 
i
;

211 
bš
 = 
MAXINT
;

212 
	`´štf
("%ld\n", 
bš
);

213 
	`bš_bcd2
(
bš
, &
low_bcd
, &
high_bcd
);

214 
	`´štf
("%ld %ld\n", 
high_bcd
, 
low_bcd
);

215 
bš
 = 0;

216 
	`bcd2_bš
(&
bš
, 
high_bcd
);

217 
	`bcd2_bš
(&
bš
, 
low_bcd
);

218 
	`´štf
Ğ"%ld\n", 
bš
);

219 
i
=9; i >= 0; i--)

220 
	`´štf
("%dth digit in %d is %d\n",

221 
i
, 
bš
, 
	`GET_DIGIT
(i, 
low_bcd
, 
high_bcd
));

222 
	`bcd2_add
(&
low_bcd
, &
high_bcd
, 
MAXINT
);

223 
bš
 = 0;

224 
	`bcd2_bš
(&
bš
, 
high_bcd
);

225 
high_bcd
 = 
bš
;

226 
bš
 = 0;

227 
	`bcd2_bš
(&
bš
, 
low_bcd
);

228 
low_bcd
 = 
bš
;

229 
	`´štf
Ğ"%ld%07ld\n", 
high_bcd
, 
low_bcd
);

230 
	`bš_bcd2
(14, &
low_bcd
, &
high_bcd
);

231 
	`bcd2_mul
(&
low_bcd
, &
high_bcd
, 23L);

232 
bš
 = 0;

233 
	`bcd2_bš
(&
bš
, 
high_bcd
);

234 
	`bcd2_bš
(&
bš
, 
low_bcd
);

235 
	`´štf
Ğ"%ld\n", 
bš
);

236 
	`bcd2_div
(&
low_bcd
, &
high_bcd
, 10L);

237 
bš
 = 0;

238 
	`bcd2_bš
(&
bš
, 
high_bcd
);

239 
	`bcd2_bš
(&
bš
, 
low_bcd
);

240 
	`´štf
Ğ"%ld\n", 
bš
);

241 
	}
}

244 
EXIT_NAMESPACE
(
dbg’ssb
)

	@src/workload/ssb/dbgen/ssb_bm_utils.cpp

23 #ifdeà
LINUX


26 
	#_GNU_SOURCE


	)

29 
	~"wÜklßd/ssb/dbg’/dss.h
"

30 
	~<¡dio.h
>

31 
	~<c¡dlib
>

32 
	~<time.h
>

33 
	~<”ºo.h
>

34 
	~<¡ršg.h
>

36 
	~<uni¡d.h
>

37 
	~<g‘İt.h
>

39 #ifdeà
HP


40 
	~<¡ršgs.h
>

42 
	~<ùy³.h
>

43 
	~<m©h.h
>

44 #iâdeà
_POSIX_SOURCE


45 
	~<m®loc.h
>

48 
	~<fú.h
>

50 #ifdeà
IBM


51 
	~<sys/mode.h
>

53 
	~<sys/ty³s.h
>

54 
	~<sys/¡©.h
>

56 #if (
defšed
(
WIN32
)||defšed(
DOS
))

57 #iâdeà
_POSIX_


58 
	~<io.h
>

59 #iâdeà
S_ISREG


61 
	#S_ISREG
(
m
èĞ((mè& 
_S_IFMT
è=ğ
_S_IFREG
 )

	)

62 
	#S_ISFIFO
(
m
èĞ((mè& 
_S_IFMT
è=ğ
_S_IFIFO
 )

	)

66 #iâdeà
¡©


67 
	#¡©
 
_¡©


	)

69 #iâdeà
fdİ’


70 
	#fdİ’
 
_fdİ’


	)

72 #iâdeà
İ’


73 
	#İ’
 
_İ’


	)

75 #iâdeà
O_RDONLY


76 
	#O_RDONLY
 
_O_RDONLY


	)

78 #iâdeà
O_WRONLY


79 
	#O_WRONLY
 
_O_WRONLY


	)

81 #iâdeà
O_CREAT


82 
	#O_CREAT
 
_O_CREAT


	)

86 
	~"wÜklßd/ssb/dbg’/ds¡y³s.h
"

90 
	g®pha_num
[65] =

93 #ià
defšed
(
__STDC__
è|| defšed(
__ılu¥lus
)

94 
	#PROTO
(
s
è
	)
s

96 
	#PROTO
(
s
è()

	)

103 
	$ENTER_NAMESPACE
(
dbg’ssb
)

105 
	`u§ge
();

106 *
	`³rmu‹_di¡
(
di¡ributiÚ
 *
d
, 
¡»am
);

107 
S“d
[];

117 
	$’v_cÚfig
(*
v¬
, *
dæt
)

119 *
ev¬
;

121 ià((
ev¬
 = 
	`g‘’v
(
v¬
)è!ğ
NULL
)

122  (
ev¬
);

124  (
dæt
);

125 
	}
}

131 
	$yes_no
(*
´om±
)

133 
»¶y
[128];

135 #ifdeà
WIN32


137 #´agm¨
	`w¬nšg
(
di§bË
:4127)

142 #ifdeà
WIN32


143 #´agm¨
	`w¬nšg
(:4127)

145 
	`´štf
("% [Y/N]: ", 
´om±
);

146 
	`fg‘s
(
»¶y
,128,
¡dš
);

147 *
»¶y
)

156 
	`´štf
("Please‡nswer 'yes' or 'no'.\n");

159 
	}
}

167 
	$a_ºd
(
mš
, 
max
, 
cŞumn
, *
de¡
)

169 
i
,

170 
Ën
,

171 
ch¬_št
;

173 
	`RANDOM
(
Ën
, 
mš
, 
max
, 
cŞumn
);

174 
i
 = 0; i < 
Ën
; i++)

176 ià(
i
 % 5 == 0)

177 
	`RANDOM
(
ch¬_št
, 0, 
MAX_LONG
, 
cŞumn
);

178 *(
de¡
 + 
i
èğ
®pha_num
[
ch¬_št
 & 077];

179 
ch¬_št
 >>= 6;

181 *(
de¡
 + 
Ën
) = '\0';

182  (
Ën
);

183 
	}
}

191 
	$e_¡r
(
di¡ributiÚ
 *
d
, 
mš
, 
max
, 
¡»am
, *
de¡
)

193 
¡¹mp
[
MAXAGG_LEN
 + 1];

194 
loc
;

195 
Ën
;

197 
	`a_ºd
(
mš
, 
max
, 
¡»am
, 
de¡
);

198 
	`pick_¡r
(
d
, 
¡»am
, 
¡¹mp
);

199 
Ën
 = 
	`¡¾’
(
¡¹mp
);

200 
	`RANDOM
(
loc
, 0, (
	`¡¾’
(
de¡
è- 1 - 
Ën
), 
¡»am
);

201 
	`¡ºıy
(
de¡
 + 
loc
, 
¡¹mp
, 
Ën
);

204 
	}
}

213 
	$pick_¡r
(
di¡ributiÚ
 *
s
, 
c
, *
rg‘
)

215 
i
 = 0;

216 
j
;

218 
	`RANDOM
(
j
, 1, 
s
->
li¡
[s->
couÁ
 - 1].
weight
, 
c
);

219 
s
->
li¡
[
i
].
weight
 < 
j
)

220 
i
++;

221 
	`¡rıy
(
rg‘
, 
s
->
li¡
[
i
].
‹xt
);

222 (
i
);

223 
	}
}

229 
	$unjulŸn
(
d©e
)

231 
i
;

232 
»s
 = 0;

234 
i
 = 
STARTDATE
 / 1000; i < 
d©e
 / 1000; i++)

235 
»s
 +ğ365 + 
	`LEAP
(
i
);

236 
»s
 +ğ
d©e
 % 1000 - 1;

238 (
»s
);

239 
	}
}

242 
	$julŸn
(
d©e
)

244 
off£t
;

245 
»suÉ
;

246 
yr
;

247 
y’d
;

249 
off£t
 = 
d©e
 - 
STARTDATE
;

250 
»suÉ
 = 
STARTDATE
;

252 #ifdeà
WIN32


254 #´agm¨
	`w¬nšg
(
di§bË
:4127)

259 #ifdeà
WIN32


260 #´agm¨
	`w¬nšg
(:4127)

262 
yr
 = 
»suÉ
 / 1000;

263 
y’d
 = 
yr
 * 1000 + 365 + 
	`LEAP
(yr);

264 ià(
»suÉ
 + 
off£t
 > 
y’d
)

266 
off£t
 -ğ
y’d
 - 
»suÉ
 + 1;

267 
»suÉ
 += 1000;

273  (
»suÉ
 + 
off£t
);

274 
	}
}

281 
	$»ad_di¡
(*
·th
, *
Çme
, 
di¡ributiÚ
 *
rg‘
)

283 
FILE
 *
å
;

284 
lše
[256],

285 
tok’
[256],

286 *
c
;

287 
weight
,

288 
couÁ
 = 0,

289 
Çme_£t
 = 0;

291 ià(
d_·th
 =ğ
NULL
)

293 
	`¥rštf
(
lše
, "%s%c%s",

294 
	`’v_cÚfig
((*)
CONFIG_TAG
, (*)
CONFIG_DFLT
), 
PATH_SEP
, 
·th
);

295 
å
 = 
	`fİ’
(
lše
, "r");

296 
	`OPEN_CHECK
(
å
, 
lše
);

300 
å
 = 
	`fİ’
(
d_·th
, "r");

301 
	`OPEN_CHECK
(
å
, 
d_·th
);

303 
	`fg‘s
(
lše
, Öše), 
å
è!ğ
NULL
)

305 ià((
c
 = 
	`¡rchr
(
lše
, '\n')è!ğ
NULL
)

306 *
c
 = '\0';

307 ià((
c
 = 
	`¡rchr
(
lše
, '#')è!ğ
NULL
)

308 *
c
 = '\0';

309 ià(*
lše
 == '\0')

312 ià(!
Çme_£t
)

314 ià(
	`dssÿ£cmp
(
	`¡¹ok
(
lše
, "\n\t "), (*)"BEGIN"))

316 ià(
	`dssÿ£cmp
(
	`¡¹ok
(
NULL
, "\n\ˆ"), 
Çme
))

318 
Çme_£t
 = 1;

323 ià(!
	`ds¢ÿ£cmp
(
lše
, (*)"END", 3))

325 
	`fşo£
(
å
);

330 ià(
	`ssÿnf
(
lše
, "%[^|]|%ld", 
tok’
, &
weight
) != 2)

333 ià(!
	`dssÿ£cmp
(
tok’
, (*)"count"))

335 
rg‘
->
couÁ
 = 
weight
;

336 
rg‘
->
li¡
 =

337 (
£t_memb”
 *)

338 
	`m®loc
((
size_t
)(
weight
 * (
£t_memb”
)));

339 
	`MALLOC_CHECK
(
rg‘
->
li¡
);

340 
rg‘
->
max
 = 0;

343 
rg‘
->
li¡
[
couÁ
].
‹xt
 =

344 (*è
	`m®loc
((
size_t
)(
	`¡¾’
(
tok’
) + 1));

345 
	`MALLOC_CHECK
(
rg‘
->
li¡
[
couÁ
].
‹xt
);

346 
	`¡rıy
(
rg‘
->
li¡
[
couÁ
].
‹xt
, 
tok’
);

347 
rg‘
->
max
 +ğ
weight
;

348 
rg‘
->
li¡
[
couÁ
].
weight
 =¬g‘->
max
;

350 
couÁ
 += 1;

353 ià(
couÁ
 !ğ
rg‘
->count)

355 
	`årštf
(
¡d”r
, "R—dƒ¼Ü oÀdi¡ '%s'\n", 
Çme
);

356 
	`fşo£
(
å
);

357 
	`ex™
(1);

359 
rg‘
->
³rmu‹
 = (*)
NULL
;

360 
	`fşo£
(
å
);

362 
	}
}

368 
FILE
 *

369 
	$tbl_İ’
(
tbl
, *
mode
)

371 
´om±
[256];

372 
fuÎ·th
[256];

373 
FILE
 *
f
;

374 
¡©
 
f¡©s
;

375 
»tcode
;

378 ià(*
tdefs
[
tbl
].
Çme
 =ğ
PATH_SEP
)

379 
	`¡rıy
(
fuÎ·th
, 
tdefs
[
tbl
].
Çme
);

381 
	`¥rštf
(
fuÎ·th
, "%s%c%s",

382 
	`’v_cÚfig
((*)
PATH_TAG
, (*)
PATH_DFLT
), 
PATH_SEP
, 
tdefs
[
tbl
].
Çme
);

384 
»tcode
 = 
	`¡©
(
fuÎ·th
, &
f¡©s
);

385 ià(
»tcode
 && (
”ºo
 !ğ
ENOENT
))

387 
	`årštf
(
¡d”r
, "¡©(%sèçed.\n", 
fuÎ·th
);

388 
	`ex™
(-1);

390 ià(
	`S_ISREG
(
f¡©s
.
¡_mode
è&& !
fÜû
 && *
mode
 != 'r' )

392 
	`¥rštf
(
´om±
, "DØyou wªˆtØov”wr™% ?", 
fuÎ·th
);

393 ià(!
	`yes_no
(
´om±
))

394 
	`ex™
(0);

397 ià(
	`S_ISFIFO
(
f¡©s
.
¡_mode
))

399 
»tcode
 =

400 
	`İ’
(
fuÎ·th
, ((*
mode
 =ğ'r')?
O_RDONLY
:
O_WRONLY
)|
O_CREAT
);

401 
f
 = 
	`fdİ’
(
»tcode
, 
mode
);

405 #ifdeà
LINUX


410 
»tcode
 =

411 
	`İ’
(
fuÎ·th
, ((*
mode
 =ğ'r')?
O_RDONLY
:
O_WRONLY
)|
O_CREAT
|
O_LARGEFILE
,0644);

412 
f
 = 
	`fdİ’
(
»tcode
, 
mode
);

414 
f
 = 
	`fİ’
(
fuÎ·th
, 
mode
);

418 
	`OPEN_CHECK
(
f
, 
fuÎ·th
);

419 ià(
h—d”
 && 
cŞumÇr
 && 
tdefs
[
tbl
].h—d” !ğ
NULL
)

420 
tdefs
[
tbl
].
	`h—d”
(
f
);

422  (
f
);

423 
	}
}

431 
	$agg_¡r
(
di¡ributiÚ
 *
£t
, 
couÁ
, 
cŞ
, *
de¡
)

433 
di¡ributiÚ
 *
d
;

434 
i
;

437 
d
 = 
£t
;

438 *
de¡
 = '\0';

439 
i
=0; i < 
couÁ
; i++)

441 
	`¡rÿt
(
de¡
, 
	`DIST_MEMBER
(
£t
,*
	`³rmu‹_di¡
(
d
, 
cŞ
)));

443 
	`¡rÿt
(
de¡
, " ");

444 
d
 = (
di¡ributiÚ
 *)
NULL
;

446 *(
de¡
 + 
	`¡¾’
(dest) - 1) = '\0';

448 
	}
}

452 
	$ds¢ÿ£cmp
(*
s1
, *
s2
, 
n
)

454 ; 
n
 > 0; ++
s1
, ++
s2
, --n)

455 ià(
	`tŞow”
(*
s1
è!ğtŞow”(*
s2
))

456  ((
	`tŞow”
(*
s1
è<Şow”(*
s2
)) ? -1 : 1);

457 ià(*
s1
 == '\0')

460 
	}
}

463 
	$dssÿ£cmp
(*
s1
, *
s2
)

465 ; 
	`tŞow”
(*
s1
è=ğtŞow”(*
s2
); ++s1, ++s2)

466 ià(*
s1
 == '\0')

468  ((
	`tŞow”
(*
s1
è<Şow”(*
s2
)) ? -1 : 1);

469 
	}
}

471 #iâdeà
STDLIB_HAS_GETOPT


473 
	gİtšd
 = 0;

474 
	gİ‹¼
 = 0;

475 *
	gİrg
 = 
NULL
;

478 
	$g‘İt
(
ac
, **
av
, *
İt
)

480 *
Ãxtch¬
 = 
NULL
;

481 *
ı
;

482 
hŞd
;

484 ià(
İrg
 =ğ
NULL
)

486 
İrg
 = (*)
	`m®loc
(
BUFSIZ
);

487 
	`MALLOC_CHECK
(
İrg
);

490 ià(!
Ãxtch¬
 || *nextchar == '\0')

492 
İtšd
++;

493 ià(
İtšd
 =ğ
ac
)

495 
Ãxtch¬
 = 
av
[
İtšd
];

496 ià(*
Ãxtch¬
 != '-')

498 
Ãxtch¬
 +=1;

501 ià(
Ãxtch¬
 && *nextchar == '-')

503 
İtšd
++;

508 
ı
 = 
	`¡rchr
(
İt
, *
Ãxtch¬
);

509 
Ãxtch¬
 += 1;

510 ià(
ı
 =ğ
NULL
)

512 ià(*(
ı
 + 1) == ':')

514 ià(*
Ãxtch¬
)

516 
hŞd
 = *
ı
;

517 
ı
 = 
İrg
;

518 *
Ãxtch¬
)

519 *
ı
++ = *
Ãxtch¬
++;

520 *
ı
 = '\0';

521 *
ı
 = 
hŞd
;

525 ià(++
İtšd
 =ğ
ac
)

527 
	`¡rıy
(
İrg
, 
av
[
İtšd
]);

529 
Ãxtch¬
 = 
NULL
;

531 (*
ı
);

533 
	}
}

537 
	$mk_ascd©e
()

539 **
m
;

540 
dss_time_t
 
t
;

541 
i
;

543 
m
 = (**è
	`m®loc
((
size_t
)(
TOTDATE
 *  (*)));

544 
	`MALLOC_CHECK
(
m
);

545 
i
 = 0; i < 
TOTDATE
; i++)

547 
m
[
i
] = (*)
	`m®loc
(
DATE_LEN
 * ());

548 
	`MALLOC_CHECK
(
m
[
i
]);

549 
	`mk_time
(()(
i
 + 1), &
t
);

550 
	`¡rıy
(
m
[
i
], 
t
.
®pha
);

553 (
m
);

554 
	}
}

564 
	$£t_¡©e
(
bË
, 
sf
, 
´ocs
, 
¡•
, *
exŒa_rows
)

566 
i
;

567 
rowcouÁ
, 
»mašd”
, 
»suÉ
;

569 ià(
sf
 =ğ0 || 
¡•
 == 0)

572 
rowcouÁ
 = 
tdefs
[
bË
].
ba£
 / 
´ocs
;

573 ià((
sf
 / 
´ocs
è> ()
MAX_32B_SCALE
)

574 
	`INTERNAL_ERROR
("SCALE OVERFLOW. RE-RUN WITH MORE CHILDREN.");

575 
rowcouÁ
 *ğ
sf
;

576 
»mašd”
 = (
tdefs
[
bË
].
ba£
 % 
´ocs
è* 
sf
;

577 
rowcouÁ
 +ğ
»mašd”
 / 
´ocs
;

578 
»suÉ
 = 
rowcouÁ
;

579 
i
=0; i < 
¡•
 - 1; i++)

581 ià(
bË
 =ğ
LINE
)

582 
tdefs
[
bË
].
	`g’_£ed
(1, 
rowcouÁ
);

584 
tdefs
[
bË
].
	`g’_£ed
(0, 
rowcouÁ
);

587 ià(
tdefs
[
bË
].
chd
 !ğ
NONE
)

588 
tdefs
[tdefs[
bË
].
chd
].
	`g’_£ed
(0,
rowcouÁ
);

590 *
exŒa_rows
 = 
»mašd”
 % 
´ocs
;

591 ià(
¡•
 > 
´ocs
)

592 
tdefs
[
bË
].
	`g’_£ed
(0,*
exŒa_rows
);

594 (
»suÉ
);

595 
	}
}

597 
EXIT_NAMESPACE
(
dbg’ssb
)

	@src/workload/ssb/dbgen/ssb_build.cpp

4 
	~<¡dio.h
>

5 
	~<¡ršg.h
>

7 
	~"wÜklßd/ssb/dbg’/dss.h
"

8 
	~"wÜklßd/ssb/dbg’/ds¡y³s.h
"

9 
	~"wÜklßd/ssb/dbg’/bcd2.h
"

11 #ifdeà
SSBM


13 
	~<ùime
>

16 #iâdeà
VMS


17 
	~<sys/ty³s.h
>

20 #ià
defšed
(
SUN
)

21 
	~<uni¡d.h
>

24 #ià
defšed
(
LINUX
)

25 
	~<uni¡d.h
>

28 
	~<m©h.h
>

31 #ifdeà
ADHOC


32 
	~"wÜklßd/ssb/dbg’/adhoc.h
"

33 
adhoc_t
 
adhocs
[];

37 
	#LEAP_ADJ
(
yr
, 
mÁh
) \

38 ((
	`LEAP
(
yr
è&& (
mÁh
è>ğ2è? 1 : 0)

	)

39 
	#JDAY_BASE
 8035

	)

40 
	#JMNTH_BASE
 (-70 * 12è

	)

41 
	#JDAY
(
d©e
è((d©eè- 
STARTDATE
 + 
JDAY_BASE
 + 1)

	)

42 
	#PART_SUPP_BRIDGE
(
tgt
, 
p
, 
s
) \

44 
tÙ_sút
 = 
tdefs
[
SUPP
].
ba£
 * 
sÿË
; \

45 
tgt
 = (
p
 + 
s
 * (
tÙ_sút
 / 
SUPP_PER_PART
 + \

46 (è((
p
 - 1è/ 
tÙ_sút
))) %ot_scnt + 1; \

47 }

	)

48 
	#RPRICE_BRIDGE
(
tgt
, 
p
ètgˆğ
	`½b_routše
Õ)

	)

49 
	#V_STR
(
avg
, 
sd
, 
tgt
è
	`a_ºd
(()×vg * 
V_STR_LOW
), \

50 ()(
avg
 * 
V_STR_HGH
), 
sd
, 
tgt
)

	)

51 
	#TEXT
(
avg
, 
sd
, 
tgt
) \

52 
	`dbg_‹xt
(
tgt
, ()(
avg
 * 
V_STR_LOW
),()×vg * 
V_STR_HGH
), 
sd
)

	)

56 
	$ENTER_NAMESPACE
(
dbg’ssb
)

58 **
asc_d©e
 = 
NULL
;

60 
g’_phÚe
 
	`PROTO
((
šd
, *
rg‘
, 
£ed
));

62 #ifdeà
SSBM


63 
g’_ÿ‹gÜy
 
	`PROTO
((*
rg‘
, 
£ed
));

64 
g’_c™y
 
	`PROTO
((*
c™yName
, *
ÇtiÚName
));

65 
g’_£asÚ
 
	`PROTO
((* 
de¡
,
mÚth
,
day
));

66 
is_Ï¡_day_š_mÚth
 
	`PROTO
((
y—r
,
mÚth
,
day
));

67 
g’_hŞiday_æ
 
	`PROTO
((* 
de¡
, 
mÚth
, 
day
));

68 
g’_c™y
 
	`PROTO
((*
c™yName
, *
ÇtiÚName
));

69 
g’_cŞÜ
 
	`PROTO
((* 
sourû
, * 
de¡
));

74 
	$½b_routše
(
p
)

76 
´iû
;

77 
´iû
 = 90000;

78 
´iû
 +ğ(
p
/10) % 20001;

79 
´iû
 +ğ(
p
 % 1000) * 100;

81 (
´iû
);

82 
	}
}

85 
	$g’_phÚe
(
šd
, *
rg‘
, 
£ed
)

87 
acode
,

88 
exchg
,

89 
numb”
;

91 
	`RANDOM
(
acode
, 100, 999, 
£ed
);

92 
	`RANDOM
(
exchg
, 100, 999, 
£ed
);

93 
	`RANDOM
(
numb”
, 1000, 9999, 
£ed
);

94 
	`¥rštf
(
rg‘
, "%02ld", 10 + (
šd
 % 
NATIONS_MAX
));

95 
	`¥rštf
(
rg‘
 + 3, "%03ld", 
acode
);

96 
	`¥rštf
(
rg‘
 + 7, "%03ld", 
exchg
);

97 
	`¥rštf
(
rg‘
 + 11, "%04ld", 
numb”
);

98 
rg‘
[2] =arget[6] =arget[10] = '-';

100 
	}
}

103 
	$g’_ÿ‹gÜy
(*
rg‘
, 
£ed
){

104 
num1
,
num2
;

105 
	`RANDOM
(
num1
,1,5,
£ed
);

106 
	`RANDOM
(
num2
,1,5,
£ed
);

107 
	`¡rıy
(
rg‘
,"MFGR");

108 
	`¥rštf
(
rg‘
 + 4, "%01ld", 
num1
);

109 
	`¥rštf
(
rg‘
 + 5, "%01ld", 
num2
);

111 
	}
}

113 #ifdeà
SSBM


114 
	$mk_cu¡
(
n_cu¡
, 
cu¡om”_t
 *
c
)

116 
i
;

117 
bIn™
 = 0;

119 !
bIn™
) {

120 
	`TRACE
Ğ
TRACE_ALWAYS
, "Init mk_cust ..\n");

121 
bIn™
 = 1;

124 
c
->
cu¡key
 = 
n_cu¡
;

125 
	`¥rštf
(
c
->
Çme
, 
C_NAME_FMT
, 
C_NAME_TAG
, 
n_cu¡
);

126 
c
->
®’
 = 
	`V_STR
(
C_ADDR_LEN
, 
C_ADDR_SD
, c->
add»ss
);

127 
	`RANDOM
(
i
, 0, 
ÇtiÚs
.
couÁ
-1, 
C_NTRG_SD
);

128 
	`¡rıy
(
c
->
ÇtiÚ_Çme
,
ÇtiÚs
.
li¡
[
i
].
‹xt
);

129 
	`¡rıy
(
c
->
»giÚ_Çme
,
»giÚs
.
li¡
[
ÇtiÚs
.li¡[
i
].
weight
].
‹xt
);

130 
	`g’_c™y
(
c
->
c™y
,c->
ÇtiÚ_Çme
);

131 
	`g’_phÚe
(
i
, 
c
->
phÚe
, ()
C_PHNE_SD
);

132 
	`pick_¡r
(&
c_m£g_£t
, 
C_MSEG_SD
, 
c
->
mkt£gm’t
);

134 
	}
}

138 
	$mk_cu¡
(
n_cu¡
, 
cu¡om”_t
 *
c
)

140 
i
;

142 
c
->
cu¡key
 = 
n_cu¡
;

143 
	`¥rštf
(
c
->
Çme
, 
C_NAME_FMT
, 
C_NAME_TAG
, 
n_cu¡
);

144 
c
->
®’
 = 
	`V_STR
(
C_ADDR_LEN
, 
C_ADDR_SD
, c->
add»ss
);

145 
	`RANDOM
(
i
, 0, (
ÇtiÚs
.
couÁ
 - 1), 
C_NTRG_SD
);

146 
c
->
ÇtiÚ_code
 = 
i
;

147 
	`g’_phÚe
(
i
, 
c
->
phÚe
, ()
C_PHNE_SD
);

148 
	`RANDOM
(
c
->
acùb®
, 
C_ABAL_MIN
, 
C_ABAL_MAX
, 
C_ABAL_SD
);

149 
	`pick_¡r
(&
c_m£g_£t
, 
C_MSEG_SD
, 
c
->
mkt£gm’t
);

150 
c
->
ş’
 = 
	`TEXT
(
C_CMNT_LEN
, 
C_CMNT_SD
, c->
comm’t
);

153 
	}
}

160 
	$mk_¥¬£
 (
DSS_HUGE
 
i
, DSS_HUGE *
ok
, 
£q
)

162 #iâdeà
SUPPORT_64BITS


163 ià(
sÿË
 < 
MAX_32B_SCALE
)

165 
	`ez_¥¬£
(
i
, 
ok
, 
£q
);

166 #iâdeà
SUPPORT_64BITS


168 
	`hd_¥¬£
(
i
, 
ok
, 
£q
);

171 
	}
}

178 
	$ez_¥¬£
(
DSS_HUGE
 
i
, DSS_HUGE *
ok
, 
£q
)

180 
low_b™s
;

183 *
ok
 = 
i
;

184 
low_b™s
 = ()(
i
 & ((1 << 
SPARSE_KEEP
) - 1));

185 *
ok
 = *ok >> 
SPARSE_KEEP
;

186 *
ok
 = *ok << 
SPARSE_BITS
;

187 *
ok
 +ğ
£q
;

188 *
ok
 = *ok << 
SPARSE_KEEP
;

189 *
ok
 +ğ
low_b™s
;

192 
	}
}

194 #iâdeà
SUPPORT_64BITS


196 
	$hd_¥¬£
(
DSS_HUGE
 
i
, DSS_HUGE *
ok
, 
£q
)

198 
low_mask
, 
£q_mask
;

199 
š™
 = 0;

200 
DSS_HUGE
 *
ba£
, *
»s
;

202 ià(
š™
 == 0)

204 
	`INIT_HUGE
(
ba£
);

205 
	`INIT_HUGE
(
»s
);

206 
š™
 = 1;

209 
low_mask
 = (1 << 
SPARSE_KEEP
) - 1;

210 
£q_mask
 = (1 << 
SPARSE_BITS
) - 1;

211 
	`bš_bcd2
(
i
, 
ba£
, base + 1);

212 
	`HUGE_SET
 (
ba£
, 
»s
);

213 
	`HUGE_DIV
 (
»s
, 1 << 
SPARSE_KEEP
);

214 
	`HUGE_MUL
 (
»s
, 1 << 
SPARSE_BITS
);

215 
	`HUGE_ADD
 (
»s
, 
£q
,„es);

216 
	`HUGE_MUL
 (
»s
, 1 << 
SPARSE_KEEP
);

217 
	`HUGE_ADD
 (
»s
, *
ba£
 & 
low_mask
,„es);

218 
	`bcd2_bš
 (&
low_mask
, *
»s
);

219 
	`bcd2_bš
 (&
£q_mask
, *(
»s
 + 1));

220 *
ok
 = 
low_mask
;

221 *(
ok
 + 1èğ
£q_mask
;

223 
	}
}

226 
	$ä“_asc_d©e
()

228 
ušt
 
i
=0; i<
TOTDATE
; i++) {

229 
	`ä“
 (
asc_d©e
[
i
]);

231 
	`ä“
(
asc_d©e
);

232 
asc_d©e
=
NULL
;

233 
	}
}

235 #ifdeà
SSBM


237 
	$mk_Üd”
(
šdex
, 
Üd”_t
 *
o
, 
upd_num
)

239 
lút
;

240 
½riû
;

241 
oút
;

242 
tmp_d©e
;

243 
c_d©e
;

244 
şk_num
;

248 **
mk_ascd©e
 
	`PROTO
(());

249 
d–
 = 1;

251 
bIn™
 = 0;

254 !
bIn™
) {

255 
	`TRACE
Ğ
TRACE_ALWAYS
, "Init mk_order ..\n");

257 
bIn™
 = 1;

260 ià(
asc_d©e
 =ğ
NULL
) {

261 
asc_d©e
 = 
	`mk_ascd©e
();

264 
	`RANDOM
(
tmp_d©e
, 
O_ODATE_MIN
, 
O_ODATE_MAX
, 
O_ODATE_SD
);

265 
	`¡rıy
(
o
->
od©e
, 
asc_d©e
[
tmp_d©e
 - 
STARTDATE
]);

269 
	`mk_¥¬£
 (
šdex
, 
o
->
okey
, 0);

271 
	`RANDOM
(
o
->
cu¡key
, 
O_CKEY_MIN
, 
O_CKEY_MAX
, 
O_CKEY_SD
);

272 
o
->
cu¡key
 % 
CUST_MORTALITY
 == 0)

274 
o
->
cu¡key
 +ğ
d–
;

275 
o
->
cu¡key
 = 
	`MIN
(o->cu¡key, 
O_CKEY_MAX
);

276 
d–
 *= -1;

279 
	`pick_¡r
(&
o_´iÜ™y_£t
, 
O_PRIO_SD
, 
o
->
İriÜ™y
);

280 
	`RANDOM
(
şk_num
, 1, 
	`MAX
((
sÿË
 * 
O_CLRK_SCL
), O_CLRK_SCL), 
O_CLRK_SD
);

281 
o
->
¥riÜ™y
 = 0;

283 
o
->
tÙ®´iû
 = 0;

284 
oút
 = 0;

286 
	`RANDOM
(
o
->
lšes
, 
O_LCNT_MIN
, 
O_LCNT_MAX
, 
O_LCNT_SD
);

287 
lút
 = 0;†úˆ< 
o
->
lšes
;†cnt++)

290 
	`HUGE_SET
(
o
->
okey
, o->
lšeÜd”s
[
lút
].okey);

291 
o
->
lšeÜd”s
[
lút
].
lš’umb”
 =†cnt + 1;

292 
o
->
lšeÜd”s
[
lút
].
cu¡key
 = o->custkey;

293 
	`RANDOM
(
o
->
lšeÜd”s
[
lút
].
·¹key
, 
L_PKEY_MIN
, 
L_PKEY_MAX
, 
L_PKEY_SD
);

294 
	`RANDOM
(
o
->
lšeÜd”s
[
lút
].
suµkey
, 
L_SKEY_MIN
, 
L_SKEY_MAX
, 
L_SKEY_SD
);

296 
	`RANDOM
(
o
->
lšeÜd”s
[
lút
].
quªt™y
, 
L_QTY_MIN
, 
L_QTY_MAX
, 
L_QTY_SD
);

297 
	`RANDOM
(
o
->
lšeÜd”s
[
lút
].
discouÁ
, 
L_DCNT_MIN
, 
L_DCNT_MAX
, 
L_DCNT_SD
);

298 
	`RANDOM
(
o
->
lšeÜd”s
[
lút
].
x
, 
L_TAX_MIN
, 
L_TAX_MAX
, 
L_TAX_SD
);

300 
	`¡rıy
(
o
->
lšeÜd”s
[
lút
].
Üd”d©e
,o->
od©e
);

302 
	`¡rıy
(
o
->
lšeÜd”s
[
lút
].
İriÜ™y
,o->opriority);

303 
o
->
lšeÜd”s
[
lút
].
sh_´iÜ™y
 = o->
¥riÜ™y
;

305 
	`RANDOM
(
c_d©e
, 
L_CDTE_MIN
, 
L_CDTE_MAX
, 
L_CDTE_SD
);

306 
c_d©e
 +ğ
tmp_d©e
;

307 
	`¡rıy
(
o
->
lšeÜd”s
[
lút
].
comm™_d©e
, 
asc_d©e
[
c_d©e
 - 
STARTDATE
]);

309 
	`pick_¡r
(&
l_smode_£t
, 
L_SMODE_SD
, 
o
->
lšeÜd”s
[
lút
].
shmode
);

311 
	`RPRICE_BRIDGE
Ğ
½riû
, 
o
->
lšeÜd”s
[
lút
].
·¹key
);

312 
o
->
lšeÜd”s
[
lút
].
ex‹nded_´iû
 = 
½riû
 * o->lšeÜd”s[lút].
quªt™y
;

313 
o
->
lšeÜd”s
[
lút
].
»v’ue
 = o->lšeÜd”s[lút].
ex‹nded_´iû
 * (()100-o->lšeÜd”s[lút].
discouÁ
)/()
PENNIES
;

316 
o
->
lšeÜd”s
[
lút
].
suµ_co¡
 = 6 * 
½riû
 /10;

318 
o
->
tÙ®´iû
 +=

319 ((
o
->
lšeÜd”s
[
lút
].
ex‹nded_´iû
 *

320 (()100 - 
o
->
lšeÜd”s
[
lút
].
discouÁ
)è/ ()
PENNIES
 ) *

321 (()100 + 
o
->
lšeÜd”s
[
lút
].
x
)

322 / ()
PENNIES
;

325 
lút
 = 0;†úˆ< 
o
->
lšes
;†cnt++)

327 
o
->
lšeÜd”s
[
lút
].
Üd”_tÙ®´iû
 = o->
tÙ®´iû
;

340 
	}
}

343 
	$mk_Üd”
(
šdex
, 
Üd”_t
 *
o
, 
upd_num
)

345 
lút
;

346 
½riû
;

347 
oút
;

348 
tmp_d©e
;

349 
s_d©e
;

350 
r_d©e
;

351 
c_d©e
;

352 
şk_num
;

353 
suµ_num
;

354 **
asc_d©e
 = 
NULL
;

355 
tmp_¡r
[2];

356 **
mk_ascd©e
 
	`PROTO
(());

357 
d–
 = 1;

359 ià(
asc_d©e
 =ğ
NULL
)

360 
asc_d©e
 = 
	`mk_ascd©e
();

361 
	`mk_¥¬£
 (
šdex
, 
o
->
okey
,

362 (
upd_num
 =ğ0è? 0 : 1 + upd_num / (10000 / 
»äesh
));

363 
	`RANDOM
(
o
->
cu¡key
, 
O_CKEY_MIN
, 
O_CKEY_MAX
, 
O_CKEY_SD
);

364 
o
->
cu¡key
 % 
CUST_MORTALITY
 == 0)

366 
o
->
cu¡key
 +ğ
d–
;

367 
o
->
cu¡key
 = 
	`MIN
(o->cu¡key, 
O_CKEY_MAX
);

368 
d–
 *= -1;

372 
	`RANDOM
(
tmp_d©e
, 
O_ODATE_MIN
, 
O_ODATE_MAX
, 
O_ODATE_SD
);

373 
	`¡rıy
(
o
->
od©e
, 
asc_d©e
[
tmp_d©e
 - 
STARTDATE
]);

375 
	`pick_¡r
(&
o_´iÜ™y_£t
, 
O_PRIO_SD
, 
o
->
İriÜ™y
);

376 
	`RANDOM
(
şk_num
, 1, 
	`MAX
((
sÿË
 * 
O_CLRK_SCL
), O_CLRK_SCL), 
O_CLRK_SD
);

377 
	`¥rštf
(
o
->
ş”k
, 
O_CLRK_FMT
,

378 
O_CLRK_TAG
,

379 
şk_num
);

380 
o
->
ş’
 = 
	`TEXT
(
O_CMNT_LEN
, 
O_CMNT_SD
, o->
comm’t
);

381 #ifdeà
DEBUG


382 ià(
o
->
ş’
 > 
O_CMNT_MAX
è
	`årštf
(
¡d”r
, "comm’ˆ”rÜ: O%d\n", 
šdex
);

384 
o
->
¥riÜ™y
 = 0;

386 
o
->
tÙ®´iû
 = 0;

387 
o
->
Üd”¡©us
 = 'O';

388 
oút
 = 0;

390 
	`RANDOM
(
o
->
lšes
, 
O_LCNT_MIN
, 
O_LCNT_MAX
, 
O_LCNT_SD
);

391 
lút
 = 0;†úˆ< 
o
->
lšes
;†cnt++)

393 
	`HUGE_SET
(
o
->
okey
, o->
l
[
lút
].okey);

394 
o
->
l
[
lút
].lcnt =†cnt + 1;

395 
	`RANDOM
(
o
->
l
[
lút
].
quªt™y
, 
L_QTY_MIN
, 
L_QTY_MAX
, 
L_QTY_SD
);

396 
	`RANDOM
(
o
->
l
[
lút
].
discouÁ
, 
L_DCNT_MIN
, 
L_DCNT_MAX
, 
L_DCNT_SD
);

397 
	`RANDOM
(
o
->
l
[
lút
].
x
, 
L_TAX_MIN
, 
L_TAX_MAX
, 
L_TAX_SD
);

398 
	`pick_¡r
(&
l_š¡ruù_£t
, 
L_SHIP_SD
, 
o
->
l
[
lút
].
shš¡ruù
);

399 
	`pick_¡r
(&
l_smode_£t
, 
L_SMODE_SD
, 
o
->
l
[
lút
].
shmode
);

400 
o
->
l
[
lút
].
ş’
 = 
	`TEXT
(
L_CMNT_LEN
, 
L_CMNT_SD
, o->l[lút].
comm’t
);

401 
	`RANDOM
(
o
->
l
[
lút
].
·¹key
, 
L_PKEY_MIN
, 
L_PKEY_MAX
, 
L_PKEY_SD
);

402 
	`RPRICE_BRIDGE
Ğ
½riû
, 
o
->
l
[
lút
].
·¹key
);

403 
	`RANDOM
(
suµ_num
, 0, 3, 
L_SKEY_SD
);

404 
	`PART_SUPP_BRIDGE
Ğ
o
->
l
[
lút
].
suµkey
, o->l[lút].
·¹key
, 
suµ_num
);

405 
o
->
l
[
lút
].
•riû
 = 
½riû
 * o->l[lút].
quªt™y
;

407 
o
->
tÙ®´iû
 +=

408 ((
o
->
l
[
lút
].
•riû
 *

409 (()100 - 
o
->
l
[
lút
].
discouÁ
)è/ ()
PENNIES
 ) *

410 (()100 + 
o
->
l
[
lút
].
x
)

411 / ()
PENNIES
;

413 
	`RANDOM
(
s_d©e
, 
L_SDTE_MIN
, 
L_SDTE_MAX
, 
L_SDTE_SD
);

414 
s_d©e
 +ğ
tmp_d©e
;

415 
	`RANDOM
(
c_d©e
, 
L_CDTE_MIN
, 
L_CDTE_MAX
, 
L_CDTE_SD
);

416 
c_d©e
 +ğ
tmp_d©e
;

417 
	`RANDOM
(
r_d©e
, 
L_RDTE_MIN
, 
L_RDTE_MAX
, 
L_RDTE_SD
);

418 
r_d©e
 +ğ
s_d©e
;

421 
	`¡rıy
(
o
->
l
[
lút
].
sd©e
, 
asc_d©e
[
s_d©e
 - 
STARTDATE
]);

422 
	`¡rıy
(
o
->
l
[
lút
].
cd©e
, 
asc_d©e
[
c_d©e
 - 
STARTDATE
]);

423 
	`¡rıy
(
o
->
l
[
lút
].
rd©e
, 
asc_d©e
[
r_d©e
 - 
STARTDATE
]);

426 ià(
	`julŸn
(
r_d©e
è<ğ
CURRENTDATE
)

428 
	`pick_¡r
(&
l_ræag_£t
, 
L_RFLG_SD
, 
tmp_¡r
);

429 
o
->
l
[
lút
].
ræag
[0] = *
tmp_¡r
;

432 
o
->
l
[
lút
].
ræag
[0] = 'N';

434 ià(
	`julŸn
(
s_d©e
è<ğ
CURRENTDATE
)

436 
oút
++;

437 
o
->
l
[
lút
].
l¡©us
[0] = 'F';

440 
o
->
l
[
lút
].
l¡©us
[0] = 'O';

443 ià(
oút
 > 0)

444 
o
->
Üd”¡©us
 = 'P';

445 ià(
oút
 =ğ
o
->
lšes
)

446 
o
->
Üd”¡©us
 = 'F';

449 
	}
}

452 #ifdeà
SSBM


453 
	$mk_·¹
(
šdex
, 
·¹_t
 *
p
)

455 
mfgr
,
ÿt
,
bºd
;

456 
bIn™
 = 0;

457 
szFÜm©
[100];

458 
szB¿ndFÜm©
[100];

460 ià(!
bIn™
) {

461 
	`TRACE
Ğ
TRACE_ALWAYS
, "Init mk_part ..\n");

462 
bIn™
 = 1;

465 
p
->
·¹key
 = 
šdex
;

466 
	`agg_¡r
(&
cŞÜs
, ()
P_NAME_SCL
, ()
P_NAME_SD
, 
p
->
Çme
);

469 
p
->
ş’
 =
	`g’_cŞÜ
Õ->
Çme
,p->
cŞÜ
);

472 
	`RANDOM
(
mfgr
, 
P_MFG_MIN
, 
P_MFG_MAX
, 
P_MFG_SD
);

473 
	`¥rštf
(
p
->
mfgr
, "%s%ld", "MFGR#", mfgr);

475 
	`RANDOM
(
ÿt
, 
P_CAT_MIN
, 
P_CAT_MAX
, 
P_CAT_SD
);

476 
	`¥rštf
(
p
->
ÿ‹gÜy
, "%s%ld",…->
mfgr
,
ÿt
);

478 
	`RANDOM
(
bºd
, 
P_BRND_MIN
, 
P_BRND_MAX
, 
P_BRND_SD
);

479 
	`¥rštf
(
p
->
b¿nd
,"%s%ld",p->
ÿ‹gÜy
,
bºd
);

481 
p
->
’
 = 
	`pick_¡r
(&
p_ty³s_£t
, 
P_TYPE_SD
,…->
ty³
);

482 
p
->
’
 = 
	`¡¾’
(
p_ty³s_£t
.
li¡
[p->’].
‹xt
);

483 
	`RANDOM
(
p
->
size
, 
P_SIZE_MIN
, 
P_SIZE_MAX
, 
P_SIZE_SD
);

485 
	`pick_¡r
(&
p_úŒ_£t
, 
P_CNTR_SD
, 
p
->
cÚš”
);

489 
	}
}

492 
	$mk_·¹
(
šdex
, 
·¹_t
 *
p
)

494 
‹mp
;

495 
¢um
;

496 
bºd
;

498 
p
->
·¹key
 = 
šdex
;

499 
	`agg_¡r
(&
cŞÜs
, ()
P_NAME_SCL
, ()
P_NAME_SD
, 
p
->
Çme
);

500 
	`RANDOM
(
‹mp
, 
P_MFG_MIN
, 
P_MFG_MAX
, 
P_MFG_SD
);

501 
	`¥rštf
(
p
->
mfgr
, 
P_MFG_FMT
, 
P_MFG_TAG
, 
‹mp
);

502 
	`RANDOM
(
bºd
, 
P_BRND_MIN
, 
P_BRND_MAX
, 
P_BRND_SD
);

503 
	`¥rštf
(
p
->
b¿nd
, 
P_BRND_FMT
,

504 
P_BRND_TAG
,

505 (
‹mp
 * 10 + 
bºd
));

506 
p
->
’
 = 
	`pick_¡r
(&
p_ty³s_£t
, 
P_TYPE_SD
,…->
ty³
);

507 
p
->
’
 = 
	`¡¾’
(
p_ty³s_£t
.
li¡
[p->’].
‹xt
);

508 
	`RANDOM
(
p
->
size
, 
P_SIZE_MIN
, 
P_SIZE_MAX
, 
P_SIZE_SD
);

509 
	`pick_¡r
(&
p_úŒ_£t
, 
P_CNTR_SD
, 
p
->
cÚš”
);

510 
	`RPRICE_BRIDGE
Ğ
p
->
»´iû
, 
šdex
);

511 
p
->
ş’
 = 
	`TEXT
(
P_CMNT_LEN
, 
P_CMNT_SD
,…->
comm’t
);

513 
¢um
 = 0; snum < 
SUPP_PER_PART
; snum++)

515 
p
->
s
[
¢um
].
·¹key
 =…->partkey;

516 
	`PART_SUPP_BRIDGE
Ğ
p
->
s
[
¢um
].
suµkey
, 
šdex
, snum);

517 
	`RANDOM
(
p
->
s
[
¢um
].
qty
, 
PS_QTY_MIN
, 
PS_QTY_MAX
, 
PS_QTY_SD
);

518 
	`RANDOM
(
p
->
s
[
¢um
].
sco¡
, 
PS_SCST_MIN
, 
PS_SCST_MAX
, 
PS_SCST_SD
);

519 
p
->
s
[
¢um
].
ş’
 = 
	`TEXT
(
PS_CMNT_LEN
, 
PS_CMNT_SD
,…->s[¢um].
comm’t
);

522 
	}
}

526 #ifdeà
SSBM


528 
	$mk_suµ
(
šdex
, 
suµl›r_t
 *
s
)

530 
i
;

535 
s
->
suµkey
 = 
šdex
;

536 
	`¥rštf
(
s
->
Çme
, 
S_NAME_FMT
, 
S_NAME_TAG
, 
šdex
);

537 
s
->
®’
 = 
	`V_STR
(
S_ADDR_LEN
, 
S_ADDR_SD
, s->
add»ss
);

538 
	`RANDOM
(
i
, 0, 
ÇtiÚs
.
couÁ
-1, 
S_NTRG_SD
);

539 
	`¡rıy
(
s
->
ÇtiÚ_Çme
,
ÇtiÚs
.
li¡
[
i
].
‹xt
);

540 
	`¡rıy
(
s
->
»giÚ_Çme
,
»giÚs
.
li¡
[
ÇtiÚs
.li¡[
i
].
weight
].
‹xt
);

541 
	`g’_c™y
(
s
->
c™y
,s->
ÇtiÚ_Çme
);

542 
	`g’_phÚe
(
i
, 
s
->
phÚe
, ()
C_PHNE_SD
);

544 
	}
}

547 
	$mk_suµ
(
šdex
, 
suµl›r_t
 *
s
)

549 
i
,

550 
bad_´ess
,

551 
noi£
,

552 
off£t
,

553 
ty³
;

555 
s
->
suµkey
 = 
šdex
;

556 
	`¥rštf
(
s
->
Çme
, 
S_NAME_FMT
, 
S_NAME_TAG
, 
šdex
);

557 
s
->
®’
 = 
	`V_STR
(
S_ADDR_LEN
, 
S_ADDR_SD
, s->
add»ss
);

558 
	`RANDOM
(
i
, 0, 
ÇtiÚs
.
couÁ
 - 1, 
S_NTRG_SD
);

559 
s
->
ÇtiÚ_code
ğ
i
;

560 
	`g’_phÚe
(
i
, 
s
->
phÚe
, 
S_PHNE_SD
);

561 
	`RANDOM
(
s
->
acùb®
, 
S_ABAL_MIN
, 
S_ABAL_MAX
, 
S_ABAL_SD
);

563 
s
->
ş’
 = 
	`TEXT
(
S_CMNT_LEN
, 
S_CMNT_SD
, s->
comm’t
);

567 
	`RANDOM
(
bad_´ess
, 1, 10000, 
BBB_CMNT_SD
);

568 
	`RANDOM
(
ty³
, 0, 100, 
BBB_TYPE_SD
);

569 
	`RANDOM
(
noi£
, 0, (
s
->
ş’
 - 
BBB_CMNT_LEN
), 
BBB_JNK_SD
);

570 
	`RANDOM
(
off£t
, 0, (
s
->
ş’
 - (
BBB_CMNT_LEN
 + 
noi£
)),

571 
BBB_OFFSET_SD
);

572 ià(
bad_´ess
 <ğ
S_CMNT_BBB
)

574 
ty³
 = (ty³ < 
BBB_DEADBEATS
) ?0:1;

575 
	`memıy
(
s
->
comm’t
 + 
off£t
, 
BBB_BASE
, 
BBB_BASE_LEN
);

576 ià(
ty³
 == 0)

577 
	`memıy
(
s
->
comm’t
 + 
BBB_BASE_LEN
 + 
off£t
 + 
noi£
,

578 
BBB_COMPLAIN
, 
BBB_TYPE_LEN
);

580 
	`memıy
(
s
->
comm’t
 + 
BBB_BASE_LEN
 + 
off£t
 + 
noi£
,

581 
BBB_COMMEND
, 
BBB_TYPE_LEN
);

585 
	}
}

590 cÚ¡ *
	mmdes
;

591 
	mdays
;

592 
	mdút
;

594 
	gmÚths
[] =

597 {
NULL
, 0, 0},

613 
	$mk_time
(
šdex
, 
dss_time_t
 *
t
)

615 
m
 = 0;

616 
y
;

617 
d
;

619 
t
->
timekey
 = 
šdex
 + 
JDAY_BASE
;

620 
y
 = 
	`julŸn
(
šdex
 + 
STARTDATE
 - 1) / 1000;

621 
d
 = 
	`julŸn
(
šdex
 + 
STARTDATE
 - 1) % 1000;

622 
d
 > 
mÚths
[
m
].
dút
 + 
	`LEAP_ADJ
(
y
, m))

623 
m
++;

624 
	`PR_DATE
(
t
->
®pha
, 
y
, 
m
,

625 
d
 - 
mÚths
[
m
 - 1].
dút
 - ((
	`LEAP
(
y
) && m > 2) ? 1 : 0));

626 
t
->
y—r
 = 1900 + 
y
;

627 
t
->
mÚth
 = 
m
 + 12 * 
y
 + 
JMNTH_BASE
;

628 
t
->
w“k
 = (
d
 + 
T_START_DAY
 - 1) / 7 + 1;

629 
t
->
day
 = 
d
 - 
mÚths
[
m
 - 1].
dút
 - 
	`LEAP_ADJ
(
y
, m-1);

632 
	}
}

635 
	$mk_ÇtiÚ
(
šdex
, 
code_t
 *
c
)

637 
c
->
code
 = 
šdex
 - 1;

638 
c
->
‹xt
 = 
ÇtiÚs
.
li¡
[
šdex
 - 1].text;

639 
c
->
još
 = 
ÇtiÚs
.
li¡
[
šdex
 - 1].
weight
;

640 
c
->
ş’
 = 
	`TEXT
(
N_CMNT_LEN
, 
N_CMNT_SD
, c->
comm’t
);

642 
	}
}

645 
	$mk_»giÚ
(
šdex
, 
code_t
 *
c
)

648 
c
->
code
 = 
šdex
 - 1;

649 
c
->
‹xt
 = 
»giÚs
.
li¡
[
šdex
 - 1].text;

650 
c
->
još
 = 0;

651 
c
->
ş’
 = 
	`TEXT
(
R_CMNT_LEN
, 
R_CMNT_SD
, c->
comm’t
);

653 
	}
}

656 #ifdeà
SSBM


658 
	$g’_c™y
(*
c™yName
, *
ÇtiÚName
){

659 
i
=0;

660 
¿ndomPick
;

662 
Æ’
 = 
	`¡¾’
(
ÇtiÚName
);

664 
	`¡ºıy
(
c™yName
,
ÇtiÚName
,
CITY_FIX
-1);

666 if(
Æ’
 < 
CITY_FIX
-1){

667 
i
 = 
Æ’
 ; i< 
CITY_FIX
-1;i++)

668 
c™yName
[
i
] = ' ';

670 
	`RANDOM
(
¿ndomPick
, 0, 9, 98);

672 
	`¥rštf
(
c™yName
+
CITY_FIX
-1,"%ld",
¿ndomPick
);

673 
c™yName
[
CITY_FIX
] = '\0';

675 
	}
}

684 
	$g’_cŞÜ
(* 
sourû
, * 
de¡
){

685 
i
 = 0,
j
=0;

686 
ş’
=0;

688 
sourû
[
i
]!= ' ' ){

689 
de¡
[
i
]=
sourû
[i];

690 
i
++;

692 
de¡
[
i
]='\0';

694 
i
++;

695 
sourû
[
i
] != '\0'){

696 
sourû
[
j
] = sourû[
i
];

697 
j
++;

698 
i
++;

701 
sourû
[
j
] = '\0';

703 
ş’
 = 
	`¡¾’
(
de¡
);

704  
ş’
;

705 
	}
}

710 
	gdays_š_a_mÚth
[12]={31,28,31,30,31,30,31,31,30,31,30,31};

711 
	gdays_š_a_mÚth_l
[12]={31,29,31,30,31,30,31,31,30,31,30,31};

712 
£asÚ
 
	g£asÚs
[]={

719 
hŞiday
 
	ghŞidays
[]={

732 cÚ¡ * 
	gmÚth_Çmes
[]={"January","February","March","April",

736 cÚ¡ * 
	gw“kday_Çmes
[]={"Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"};

746 
	$mk_d©e
(
šdex
,
d©e_t
 *
d
)

748 
e¥ª
 = (
šdex
-1)*60*60*24;

750 
numD©eTime
 = 
D_STARTDATE
 + 
e¥ª
;

752 
tm
 *
loÿlTime
 = 
¡d
::
	`loÿÉime
(&
numD©eTime
);

755 
d
->
daynumšw“k
=(()
loÿlTime
->
tm_wday
+1)%7+1;

756 
d
->
mÚthnumšy—r
=()
loÿlTime
->
tm_mÚ
+1;

757 
	`¡ºıy
(
d
->
dayofw“k
, 
w“kday_Çmes
[d->
daynumšw“k
-1],
D_DAYWEEK_LEN
+1);

758 
	`¡ºıy
(
d
->
mÚth
,
mÚth_Çmes
[d->
mÚthnumšy—r
-1],
D_MONTH_LEN
+1);

759 
d
->
y—r
=()
loÿlTime
->
tm_y—r
 + 1900;

760 
d
->
daynumšmÚth
=()
loÿlTime
->
tm_mday
;

761 
d
->
y—rmÚthnum
=d->
y—r
 * 100 + d->
mÚthnumšy—r
;

763 
	`¥rštf
(
d
->
y—rmÚth
,"%.3s%d",d->
mÚth
,d->
y—r
);

764 
	`¥rštf
(
d
->
d©e
,"% %d, %d",d->
mÚth
,d->
daynumšmÚth
,d->
y—r
);

766 
d
->
d©ekey
 = d->
y—r
*10000+d->
mÚthnumšy—r
*100+ d->
daynumšmÚth
;

768 
d
->
daynumšy—r
=()
loÿlTime
->
tm_yday
+1;

769 
d
->
w“knumšy—r
 = d->
daynumšy—r
/7 + 1;

771 if(
d
->
daynumšw“k
 ==7){

772 
d
->
Ï¡dayšw“kæ
[0]='1';

775 
d
->
Ï¡dayšw“kæ
[0]='0';

777 
d
->
Ï¡dayšw“kæ
[1]='\0';

779 if(
	`is_Ï¡_day_š_mÚth
(
d
->
y—r
,d->
mÚthnumšy—r
,d->
daynumšmÚth
)==1){

780 
d
->
Ï¡dayšmÚthæ
[0]= '0';

782 
d
->
Ï¡dayšmÚthæ
[0]= '1';

784 
d
->
Ï¡dayšmÚthæ
[1]='\0';

786 if(
d
->
daynumšw“k
!=1 && d->daynuminweek!=7){

787 
d
->
w“kdayæ
[0]='1';

790 
d
->
w“kdayæ
[0]='0';

793 
d
->
w“kdayæ
[1]='\0';

795 
	`g’_£asÚ
(
d
->
£Îšg£asÚ
,d->
mÚthnumšy—r
,d->
daynumšmÚth
);

796 
d
->
¦’
 = 
	`¡¾’
(d->
£Îšg£asÚ
);

797 
	`g’_hŞiday_æ
(
d
->
hŞidayæ
,d->
mÚthnumšy—r
,d->
daynumšmÚth
);

799 
	}
}

801 
	$g’_hŞiday_æ
(* 
de¡
, 
mÚth
, 
day
){

802 
i
;

803 
i
 = 0; i< 
NUM_HOLIDAYS
; i++){

804 if(
hŞidays
[
i
].
mÚth
 =ğmÚth && hŞidays[i].
day
 == day){

805 
	`¡rıy
(
de¡
,"1");

809 
	`¡rıy
(
de¡
,"0");

811 
	}
}

815 
	$is_Ï¡_day_š_mÚth
(
y—r
,
mÚth
,
day
){

816 * 
days
;

817 if(
	`LEAP
(
y—r
))

818 
days
 = 
days_š_a_mÚth_l
;

820 
days
 = 
days_š_a_mÚth
;

821 if(
day
 =ğ
days
[
mÚth
-1])  1;

823 
	}
}

825 
	$g’_£asÚ
(* 
de¡
,
mÚth
,
day
)

827 
i
;

828 
i
 =0;i<
NUM_SEASONS
;i++){

829 
£asÚ
 *
£as
;

830 
£as
 = &
£asÚs
[
i
];

832 if(
mÚth
>=
£as
->
¡¬t_mÚth
 && mÚth<=£as->
’d_mÚth
 &&

833 
day
 >ğ
£as
->
¡¬t_day
 && day <ğ£as->
’d_day
){

834 
	`¡rıy
(
de¡
, 
£as
->
Çme
);

838 
	`¡rıy
(
de¡
,"");

841 
	}
}

845 
EXIT_NAMESPACE
(
dbg’ssb
)

	@src/workload/ssb/dbgen/ssb_driver.cpp

4 
	#DECLARER


	)

5 
	#NO_FUNC
 ((*è()è
NULL


	)

6 
	#NO_LFUNC
 ((*è()è
NULL


	)

8 
	~"wÜklßd/ssb/dbg’/cÚfig.h
"

9 
	~<c¡dlib
>

10 #ià(
defšed
(
_POSIX_
)||!defšed(
WIN32
))

11 #iâdeà
DOS


12 
	~<uni¡d.h
>

13 
	~<g‘İt.h
>

14 
	~<sys/wa™.h
>

18 
	~<¡dio.h
>

19 
	~<lim™s.h
>

20 
	~<m©h.h
>

21 
	~<ùy³.h
>

22 
	~<sigÇl.h
>

23 
	~<¡ršg.h
>

24 
	~<”ºo.h
>

25 #ifdeà
HP


26 
	~<¡ršgs.h
>

28 #ià(
defšed
(
WIN32
)&&!defšed(
_POSIX_
))

29 
	~<´oûss.h
>

30 #´agm¨
w¬nšg
(
di§bË
:4201)

31 #´agm¨
w¬nšg
(
di§bË
:4214)

32 #´agm¨
w¬nšg
(
di§bË
:4514)

33 
	#WIN32_LEAN_AND_MEAN


	)

34 
	#NOATOM


	)

35 
	#NOGDICAPMASKS


	)

36 
	#NOMETAFILE


	)

37 
	#NOMINMAX


	)

38 
	#NOMSG


	)

39 
	#NOOPENFILE


	)

40 
	#NORASTEROPS


	)

41 
	#NOSCROLL


	)

42 
	#NOSOUND


	)

43 
	#NOSYSMETRICS


	)

44 
	#NOTEXTMETRIC


	)

45 
	#NOWH


	)

46 
	#NOCOMM


	)

47 
	#NOKANJI


	)

48 
	#NOMCX


	)

50 
	~"wšdows.h
"

52 #´agm¨
w¬nšg
(:4201)

53 #´agm¨
w¬nšg
(:4214)

56 
	~"wÜklßd/ssb/dbg’/dss.h
"

57 
	~"wÜklßd/ssb/dbg’/ds¡y³s.h
"

58 
	~"wÜklßd/ssb/dbg’/bcd2.h
"

60 
İtšd
, 
İ‹¼
;

61 *
İrg
;

64 
	$ENTER_NAMESPACE
(
dbg’ssb
)

69 
	`u§ge
 ();

70 
	`´•_dœeù
 (*);

71 
	`şo£_dœeù
 ();

72 
	`kl_lßd
 ();

73 
	`¶ßd
 (
tbl
);

74 
	`g’_tbl
 (
Šum
, 
¡¬t
, 
couÁ
, 
upd_num
);

75 
	`´_d¿nge
 (
tbl
, 
mš
, 
út
, 
num
);

76 
	`£t_fes
 (
t
, 
¶ßd
);

77 
	`·¹Ÿl
 (, );

81 
rowút
 = 0, 
mšrow
 = 0, 
upd_num
 = 0;

82 
æt_sÿË
;

83 #ià(
	`defšed
(
WIN32
)&&!defšed(
_POSIX_
))

84 *
¥awn_¬gs
[25];

114 #ifdeà
SSBM


115 
	`´_cu¡
 (* 
c
, 
mode
);

116 
	`´_·¹
 (* 
p
, 
mode
);

117 
	`´_suµ
 (* 
s
, 
mode
);

118 
	`´_lše
 (* 
o
, 
mode
);

120 
	`´_cu¡
 (* 
c
, 
mode
);

121 
	`´_lše
 (* 
o
, 
mode
);

122 
	`´_Üd”
 (* 
o
, 
mode
);

123 
	`´_·¹
 (* 
p
, 
mode
);

124 
	`´_psuµ
 (* 
p
, 
mode
);

125 
	`´_suµ
 (* 
s
, 
mode
);

126 
	`´_Üd”_lše
 (* 
o
, 
mode
);

127 
	`´_·¹_psuµ
 (* 
p
, 
mode
);

128 
	`´_ÇtiÚ
 (* 
c
, 
mode
);

129 
	`´_»giÚ
 (* 
c
, 
mode
);

135 #ifdeà
SSBM


136 
	`ld_cu¡
 (* 
c
, 
mode
);

137 
	`ld_·¹
 (* 
p
, 
mode
);

138 
	`ld_suµ
 (* 
s
, 
mode
);

141 
	`ld_lše
 (* 
o
, 
mode
);

142 
	`ld_Üd”
 (* 
o
, 
mode
);

145 
	`ld_cu¡
 (* 
c
, 
mode
);

146 
	`ld_lše
 (* 
o
, 
mode
);

147 
	`ld_Üd”
 (* 
o
, 
mode
);

148 
	`ld_·¹
 (* 
p
, 
mode
);

149 
	`ld_psuµ
 (* 
p
, 
mode
);

150 
	`ld_suµ
 (* 
s
, 
mode
);

151 
	`ld_Üd”_lše
 (* 
o
, 
mode
);

152 
	`ld_·¹_psuµ
 (* 
p
, 
mode
);

153 
	`ld_ÇtiÚ
 (* 
c
, 
mode
);

154 
	`ld_»giÚ
 (* 
c
, 
mode
);

160 #ifdeà
SSBM


161 
	`sd_cu¡
 (
chd
, 
sk_couÁ
);

162 
	`sd_·¹
 (
chd
, 
sk_couÁ
);

163 
	`sd_suµ
 (
chd
, 
sk_couÁ
);

165 
	`sd_lše
 (
chd
, 
sk_couÁ
);

166 
	`sd_Üd”
 (
chd
, 
sk_couÁ
);

169 
	`sd_cu¡
 (
chd
, 
sk_couÁ
);

170 
	`sd_lše
 (
chd
, 
sk_couÁ
);

171 
	`sd_Üd”
 (
chd
, 
sk_couÁ
);

172 
	`sd_·¹
 (
chd
, 
sk_couÁ
);

173 
	`sd_psuµ
 (
chd
, 
sk_couÁ
);

174 
	`sd_suµ
 (
chd
, 
sk_couÁ
);

175 
	`sd_Üd”_lše
 (
chd
, 
sk_couÁ
);

176 
	`sd_·¹_psuµ
 (
chd
, 
sk_couÁ
);

182 #ifdeà
SSBM


183 
	`hd_cu¡
 (
FILE
 * 
f
);

184 
	`hd_·¹
 (
FILE
 * 
f
);

185 
	`hd_suµ
 (
FILE
 * 
f
);

186 
	`hd_lše
 (
FILE
 * 
f
);

189 
	`hd_cu¡
 (
FILE
 * 
f
);

190 
	`hd_lše
 (
FILE
 * 
f
);

191 
	`hd_Üd”
 (
FILE
 * 
f
);

192 
	`hd_·¹
 (
FILE
 * 
f
);

193 
	`hd_psuµ
 (
FILE
 * 
f
);

194 
	`hd_suµ
 (
FILE
 * 
f
);

195 
	`hd_Üd”_lše
 (
FILE
 * 
f
);

196 
	`hd_·¹_psuµ
 (
FILE
 * 
f
);

197 
	`hd_ÇtiÚ
 (
FILE
 * 
f
);

198 
	`hd_»giÚ
 (
FILE
 * 
f
);

204 #ifdeà
SSBM


205 
	`vrf_cu¡
 (* 
c
, 
mode
);

206 
	`vrf_·¹
 (* 
p
, 
mode
);

207 
	`vrf_suµ
 (* 
s
, 
mode
);

208 
	`vrf_lše
 (* 
o
, 
mode
);

209 
	`vrf_Üd”
 (* 
o
, 
mode
);

210 
	`vrf_d©e
 (*
d
 ,
mode
);

212 
	`vrf_cu¡
 (* 
c
, 
mode
);

213 
	`vrf_lše
 (* 
o
, 
mode
);

214 
	`vrf_Üd”
 (* 
o
, 
mode
);

215 
	`vrf_·¹
 (* 
p
, 
mode
);

216 
	`vrf_psuµ
 (* 
p
, 
mode
);

217 
	`vrf_suµ
 (* 
s
, 
mode
);

218 
	`vrf_Üd”_lše
 (* 
o
, 
mode
);

219 
	`vrf_·¹_psuµ
 (* 
p
, 
mode
);

220 
	`vrf_ÇtiÚ
 (* 
c
, 
mode
);

221 
	`vrf_»giÚ
 (* 
c
, 
mode
);

225 #ifdeà
SSBM


226 
tdef
 
tdefs
[] =

229 {"·¹.tbl", "·¹abË", 200000, 
hd_·¹
,

230 {
´_·¹
, 
ld_·¹
}, 
sd_·¹
, 
vrf_·¹
, 
PSUPP
, 0},

232 {"suµl›r.tbl", "suµl›r bË", 10000, 
hd_suµ
,

233 {
´_suµ
, 
ld_suµ
}, 
sd_suµ
, 
vrf_suµ
, 
NONE
, 0},

235 {"cu¡om”.tbl", "cu¡om” bË", 30000, 
hd_cu¡
,

236 {
´_cu¡
, 
ld_cu¡
}, 
sd_cu¡
, 
vrf_cu¡
, 
NONE
, 0},

237 {"d©e.tbl","d©bË",2556,0,{
´_d©e
,
ld_d©e
}, 0,
vrf_d©e
, 
NONE
,0},

240 {"lšeÜd”.tbl", "lšeÜd”abË", 150000, 
hd_lše
,

241 {
´_lše
, 
ld_lše
}, 
sd_lše
, 
vrf_lše
, 
NONE
, 0},

246 
	}
};

250 
tdef
 
	gtdefs
[] =

252 {"·¹.tbl", "·¹abË", 200000, 
hd_·¹
,

253 {
´_·¹
, 
ld_·¹
}, 
sd_·¹
, 
vrf_·¹
, 
PSUPP
, 0},

254 {"·¹suµ.tbl", "·¹suµl›¸bË", 200000, 
hd_psuµ
,

255 {
´_psuµ
, 
ld_psuµ
}, 
sd_psuµ
, 
vrf_psuµ
, 
NONE
, 0},

256 {"suµl›r.tbl", "suµl›r bË", 10000, 
hd_suµ
,

257 {
´_suµ
, 
ld_suµ
}, 
sd_suµ
, 
vrf_suµ
, 
NONE
, 0},

258 {"cu¡om”.tbl", "cu¡om” bË", 150000, 
hd_cu¡
,

259 {
´_cu¡
, 
ld_cu¡
}, 
sd_cu¡
, 
vrf_cu¡
, 
NONE
, 0},

260 {"Üd”s.tbl", "Üd”abË", 150000, 
hd_Üd”
,

261 {
´_Üd”
, 
ld_Üd”
}, 
sd_Üd”
, 
vrf_Üd”
, 
LINE
, 0},

262 {"lše™em.tbl", "lše™emabË", 150000, 
hd_lše
,

263 {
´_lše
, 
ld_lše
}, 
sd_lše
, 
vrf_lše
, 
NONE
, 0},

264 {"Üd”s.tbl", "Üd”s/lše™emabËs", 150000, 
hd_Üd”_lše
,

265 {
´_Üd”_lše
, 
ld_Üd”_lše
}, 
sd_Üd”
, 
vrf_Üd”_lše
, 
LINE
, 0},

266 {"·¹.tbl", "·¹/·¹suµl›¸bËs", 200000, 
hd_·¹_psuµ
,

267 {
´_·¹_psuµ
, 
ld_·¹_psuµ
}, 
sd_·¹
, 
vrf_·¹_psuµ
, 
PSUPP
, 0},

268 {"ÇtiÚ.tbl", "ÇtiÚabË", 
NATIONS_MAX
, 
hd_ÇtiÚ
,

269 {
´_ÇtiÚ
, 
ld_ÇtiÚ
}, 
NO_LFUNC
, 
vrf_ÇtiÚ
, 
NONE
, 0},

270 {"»giÚ.tbl", "»giÚabË", 
NATIONS_MAX
, 
hd_»giÚ
,

271 {
´_»giÚ
, 
ld_»giÚ
}, 
NO_LFUNC
, 
vrf_»giÚ
, 
NONE
, 0},

274 *
	gpids
;

282 
	$¡İ_´oc
 ()

284 
	`ex™
 (0);

285 
	}
}

288 
	$kl_lßd
 ()

290 
i
;

292 #ià!
	`defšed
(
U2200
è&& !defšed(
DOS
)

293 
i
 = 0; i < 
chd»n
; i++)

294 ià(
pids
[
i
])

295 
	`KILL
 (
pids
[
i
]);

298 
	}
}

304 
	$£t_fes
 (
i
, 
¶ßd
)

306 
lše
[80], *
Ãw_Çme
;

308 ià(
bË
 & (1 << 
i
))

309 
chd_bË
:

311 ià(
¶ßd
 != -1)

312 
	`¥rštf
 (
lše
, "%s.%d", 
tdefs
[
i
].
Çme
, 
¶ßd
);

315 
	`´štf
 ("Enter‚ew destination for %s data: ",

316 
tdefs
[
i
].
Çme
);

317 ià(
	`fg‘s
 (
lše
,  (lše), 
¡dš
è=ğ
NULL
)

319 ià((
Ãw_Çme
 = 
	`¡rchr
 (
lše
, '\n')è!ğ
NULL
)

320 *
Ãw_Çme
 = '\0';

321 ià(
	`¡¾’
 (
lše
) == 0)

324 
Ãw_Çme
 = (*è
	`m®loc
 (
	`¡¾’
 (
lše
) + 1);

325 
	`MALLOC_CHECK
 (
Ãw_Çme
);

326 
	`¡rıy
 (
Ãw_Çme
, 
lše
);

327 
tdefs
[
i
].
Çme
 = 
Ãw_Çme
;

328 ià(
tdefs
[
i
].
chd
 !ğ
NONE
)

330 
i
 = 
tdefs
[i].
chd
;

331 
tdefs
[
i
].
chd
 = 
NONE
;

332 
chd_bË
;

337 
	}
}

345 
	$lßd_di¡s
 ()

347 
	`»ad_di¡
 (
	`’v_cÚfig
 ((*)
DIST_TAG
, (*)
DIST_DFLT
), (*)"p_úŒ", &
p_úŒ_£t
);

348 
	`»ad_di¡
 (
	`’v_cÚfig
 ((*)
DIST_TAG
, (*)
DIST_DFLT
), (*)"cŞÜs", &
cŞÜs
);

349 
	`»ad_di¡
 (
	`’v_cÚfig
 ((*)
DIST_TAG
, (*)
DIST_DFLT
), (*)"p_ty³s", &
p_ty³s_£t
);

350 
	`»ad_di¡
 (
	`’v_cÚfig
 ((*)
DIST_TAG
, (*)
DIST_DFLT
), (*)"ÇtiÚs", &
ÇtiÚs
);

351 
	`»ad_di¡
 (
	`’v_cÚfig
 ((*)
DIST_TAG
, (*)
DIST_DFLT
), (*)"»giÚs", &
»giÚs
);

352 
	`»ad_di¡
 (
	`’v_cÚfig
 ((*)
DIST_TAG
, (*)
DIST_DFLT
), (*)"o_oprio",

353 &
o_´iÜ™y_£t
);

354 
	`»ad_di¡
 (
	`’v_cÚfig
 ((*)
DIST_TAG
, (*)
DIST_DFLT
), (*)"instruct",

355 &
l_š¡ruù_£t
);

356 
	`»ad_di¡
 (
	`’v_cÚfig
 ((*)
DIST_TAG
, (*)
DIST_DFLT
), (*)"smode", &
l_smode_£t
);

357 
	`»ad_di¡
 (
	`’v_cÚfig
 ((*)
DIST_TAG
, (*)
DIST_DFLT
), (*)"category",

358 &
l_ÿ‹gÜy_£t
);

359 
	`»ad_di¡
 (
	`’v_cÚfig
 ((*)
DIST_TAG
, (*)
DIST_DFLT
), (*)"ræag", &
l_ræag_£t
);

360 
	`»ad_di¡
 (
	`’v_cÚfig
 ((*)
DIST_TAG
, (*)
DIST_DFLT
), (*)"m£gmÁ", &
c_m£g_£t
);

363 
	`»ad_di¡
 (
	`’v_cÚfig
 ((*)
DIST_TAG
, (*)
DIST_DFLT
), (*)"nouns", &
nouns
);

364 
	`»ad_di¡
 (
	`’v_cÚfig
 ((*)
DIST_TAG
, (*)
DIST_DFLT
), (*)"v”bs", &
v”bs
);

365 
	`»ad_di¡
 (
	`’v_cÚfig
 ((*)
DIST_TAG
, (*)
DIST_DFLT
), (*)"adjeùives", &
adjeùives
);

366 
	`»ad_di¡
 (
	`’v_cÚfig
 ((*)
DIST_TAG
, (*)
DIST_DFLT
), (*)"adv”bs", &
adv”bs
);

367 
	`»ad_di¡
 (
	`’v_cÚfig
 ((*)
DIST_TAG
, (*)
DIST_DFLT
), (*)"auxÏr›s", &
auxÏr›s
);

368 
	`»ad_di¡
 (
	`’v_cÚfig
 ((*)
DIST_TAG
, (*)
DIST_DFLT
), (*)"‹rmš©Üs", &
‹rmš©Üs
);

369 
	`»ad_di¡
 (
	`’v_cÚfig
 ((*)
DIST_TAG
, (*)
DIST_DFLT
), (*)"¬tişes", &
¬tişes
);

370 
	`»ad_di¡
 (
	`’v_cÚfig
 ((*)
DIST_TAG
, (*)
DIST_DFLT
), (*)"´•os™iÚs", &
´•os™iÚs
);

371 
	`»ad_di¡
 (
	`’v_cÚfig
 ((*)
DIST_TAG
, (*)
DIST_DFLT
), (*)"g¿mm¬", &
g¿mm¬
);

372 
	`»ad_di¡
 (
	`’v_cÚfig
 ((*)
DIST_TAG
, (*)
DIST_DFLT
), (*)"Å", &
Å
);

373 
	`»ad_di¡
 (
	`’v_cÚfig
 ((*)
DIST_TAG
, (*)
DIST_DFLT
), (*)"vp", &
vp
);

375 
	}
}

381 
	$g’_tbl
 (
Šum
, 
¡¬t
, 
couÁ
, 
upd_num
)

383 
Üd”_t
 
o
;

384 
suµl›r_t
 
suµ
;

385 
cu¡om”_t
 
cu¡
;

386 
·¹_t
 
·¹
;

387 #ifdeà
SSBM


388 
d©e_t
 
dt
;

390 
code_t
 
code
;

392 
com¶‘ed
 = 0;

393 
š™
 = 0;

394 
i
;

396 
rows_³r_£gm’t
=0;

397 
rows_this_£gm’t
=-1;

398 
»sidu®_rows
=0;

400 ià(
š£¹_£gm’ts
)

402 
rows_³r_£gm’t
 = 
couÁ
 / 
š£¹_£gm’ts
;

403 
»sidu®_rows
 = 
couÁ
 - (
rows_³r_£gm’t
 * 
š£¹_£gm’ts
);

406 ià(
š™
 == 0)

408 
	`INIT_HUGE
(
o
.
okey
);

409 
i
=0; i < 
O_LCNT_MAX
; i++)

410 #ifdeà
SSBM


411 
	`INIT_HUGE
(
o
.
lšeÜd”s
[
i
].
okey
);

413 
	`INIT_HUGE
(
o
.
l
[
i
].
okey
);

415 
š™
 = 1;

418 
i
 = 
¡¬t
; 
couÁ
; count--, i++)

420 
	`LIFENOISE
 (1000, 
i
);

421 
	`row_¡¬t
(
Šum
);

423 
Šum
)

425 
LINE
:

426 #ifdeà
SSBM


428 
ORDER
:

429 
ORDER_LINE
:

431 
	`mk_Üd”
 (
i
, &
o
, 
upd_num
 % 10000);

433 ià(
š£¹_£gm’ts
 && (
upd_num
 > 0))

435 if((
upd_num
 / 10000è< 
»sidu®_rows
)

437 if((++
rows_this_£gm’t
è> 
rows_³r_£gm’t
)

439 
rows_this_£gm’t
=0;

440 
upd_num
 += 10000;

445 if((++
rows_this_£gm’t
è>ğ
rows_³r_£gm’t
)

447 
rows_this_£gm’t
=0;

448 
upd_num
 += 10000;

452 ià(
£t_£eds
 == 0)

454 ià(
v®id©e
)

455 
tdefs
[
Šum
].
	`v”ify
((*)&
o
, 0);

457 
tdefs
[
Šum
].
lßd”
[
dœeù
] ((*)&
o
, 
upd_num
);

460 
SUPP
:

461 
	`mk_suµ
 (
i
, &
suµ
);

462 ià(
£t_£eds
 == 0)

464 ià(
v®id©e
)

465 
tdefs
[
Šum
].
	`v”ify
((*)&
suµ
, 0);

467 
tdefs
[
Šum
].
lßd”
[
dœeù
] ((*)&
suµ
, 
upd_num
);

470 
CUST
:

471 
	`mk_cu¡
 (
i
, &
cu¡
);

472 ià(
£t_£eds
 == 0)

474 ià(
v®id©e
)

475 
tdefs
[
Šum
].
	`v”ify
((*)&
cu¡
, 0);

477 
tdefs
[
Šum
].
lßd”
[
dœeù
] ((*)&
cu¡
, 
upd_num
);

480 #ifdeà
SSBM


481 
PART
:

483 
PSUPP
:

484 
PART
:

485 
PART_PSUPP
:

487 
	`mk_·¹
 (
i
, &
·¹
);

488 ià(
£t_£eds
 == 0)

490 ià(
v®id©e
)

491 
tdefs
[
Šum
].
	`v”ify
((*)&
·¹
, 0);

493 
tdefs
[
Šum
].
lßd”
[
dœeù
] ((*)&
·¹
, 
upd_num
);

496 #ifdeà
SSBM


497 
DATE
:

498 
	`mk_d©e
 (
i
, &
dt
);

499 ià(
£t_£eds
 == 0)

501 ià(
v®id©e
)

502 
tdefs
[
Šum
].
	`v”ify
((*)&
dt
, 0);

504 
tdefs
[
Šum
].
lßd”
[
dœeù
] ((*)&
dt
, 0);

508 
NATION
:

509 
	`mk_ÇtiÚ
 (
i
, &
code
);

510 ià(
£t_£eds
 == 0)

512 ià(
v®id©e
)

513 
tdefs
[
Šum
].
	`v”ify
((*)&
code
, 0);

515 
tdefs
[
Šum
].
lßd”
[
dœeù
] ((*)&
code
, 0);

518 
REGION
:

519 
	`mk_»giÚ
 (
i
, &
code
);

520 ià(
£t_£eds
 == 0)

522 ià(
v®id©e
)

523 
tdefs
[
Šum
].
	`v”ify
((*)&
code
, 0);

525 
tdefs
[
Šum
].
lßd”
[
dœeù
] ((*)&
code
, 0);

530 
	`row_¡İ
(
Šum
);

531 ià(
£t_£eds
 && (
i
 % 
tdefs
[
Šum
].
ba£
) < 2)

533 
	`´štf
("\nS“d fÜ % ©„owcouÁ %ld\n", 
tdefs
[
Šum
].
comm’t
, 
i
);

534 
	`dump_£eds
(
Šum
);

537 
com¶‘ed
 |ğ1 << 
Šum
;

538 
	}
}

543 
	$u§ge
 ()

545 #ifdeà
SSBM


546 
	`årštf
 (
¡d”r
, "%s\n%s\n\t%s\n%s %s\n\n",

554 
	`årštf
 (
¡d”r
, "%s\n%s\n\t%s\n%s %s\n\n",

561 
	`årštf
 (
¡d”r
, "-b <s> --†oad distributions for <s>\n");

562 
	`årštf
 (
¡d”r
, "-C <n> -- use <n>…rocesseso generate data\n");

563 
	`årštf
 (
¡d”r
, " [Under DOS, must be used with -S]\n");

564 
	`årštf
 (
¡d”r
, "-D -- do database†oad in†ine\n");

565 
	`årštf
 (
¡d”r
, "-d <n> -- split deletes between <n> files\n");

566 
	`årštf
 (
¡d”r
, "-f -- force. Overwriteƒxisting files\n");

567 
	`årštf
 (
¡d”r
, "-F -- generate flat files output\n");

568 
	`årštf
 (
¡d”r
, "-h -- displayhis message\n");

569 
	`årštf
 (
¡d”r
, "-i <n> -- split inserts between <n> files\n");

570 
	`årštf
 (
¡d”r
, "-n <s> -- inline†oad into database <s>\n");

571 
	`årštf
 (
¡d”r
, "-O d -- generate SQL syntax for deletes\n");

572 
	`årštf
 (
¡d”r
, "-O f -- over-ride default output file‚ames\n");

573 
	`årštf
 (
¡d”r
, "-O h -- output files with headers\n");

574 
	`årštf
 (
¡d”r
, "-O m --…roduce columnar output\n");

575 
	`årštf
 (
¡d”r
, "-O„ -- generate key„anges for deletes.\n");

576 
	`årštf
 (
¡d”r
, "-O v -- Verify data set without generating it.\n");

577 
	`årštf
 (
¡d”r
, "-q --ƒnable QUIET mode\n");

578 
	`årštf
 (
¡d”r
, "-r <n> -- updates„efresh (n/100)%% ofhe\n");

579 
	`årštf
 (
¡d”r
, " data set\n");

580 
	`årštf
 (
¡d”r
, "-s <n> -- set Scale Factor (SF)o <n> \n");

581 
	`årštf
 (
¡d”r
, "-S <n> -- buildhe <n>th step ofhe data/update set\n");

583 #ifdeà
SSBM


584 
	`årštf
 (
¡d”r
, "-T c -- generate cutomers dimensionable ONLY\n");

585 
	`årštf
 (
¡d”r
, "-T… -- generate…arts dimensionable ONLY\n");

586 
	`årštf
 (
¡d”r
, "-T s -- generate suppliers dimensionable ONLY\n");

587 
	`årštf
 (
¡d”r
, "-T d -- generate date dimensionable ONLY\n");

588 
	`årštf
 (
¡d”r
, "-T† -- generate†ineorder factable ONLY\n");

590 
	`årštf
 (
¡d”r
, "-T c -- generate cutomers ONLY\n");

591 
	`årštf
 (
¡d”r
, "-T† -- generate‚ation/region ONLY\n");

592 
	`årštf
 (
¡d”r
, "-T L -- generate†ineitem ONLY\n");

593 
	`årštf
 (
¡d”r
, "-T‚ -- generate‚ation ONLY\n");

594 
	`årštf
 (
¡d”r
, "-T o -- generate orders/lineitem ONLY\n");

595 
	`årštf
 (
¡d”r
, "-T O -- generate orders ONLY\n");

596 
	`årštf
 (
¡d”r
, "-T… -- generate…arts/partsupp ONLY\n");

597 
	`årštf
 (
¡d”r
, "-T P -- generate…arts ONLY\n");

598 
	`årštf
 (
¡d”r
, "-T„ -- generate„egion ONLY\n");

599 
	`årštf
 (
¡d”r
, "-T s -- generate suppliers ONLY\n");

600 
	`årštf
 (
¡d”r
, "-T S -- generate…artsupp ONLY\n");

603 
	`årštf
 (
¡d”r
, "-U <s> -- generate <s> update sets\n");

604 
	`årštf
 (
¡d”r
, "-v --ƒnable VERBOSE mode\n");

605 
	`årštf
 (
¡d”r
,

607 
	`årštf
 (
¡d”r
, "\tdbgen -vfF -s 1\n");

608 
	`årštf
 (
¡d”r
, "\nTo generate updates for‡ SF=1 (1GB), use:\n");

609 
	`årštf
 (
¡d”r
, "\tdbgen -v -U 1 -s 1\n");

610 
	}
}

619 
	$·¹Ÿl
 (
tbl
, 
s
)

621 
rowút
;

622 
exŒa
;

624 ià(
v”bo£
 > 0)

626 
	`årštf
 (
¡d”r
, "\tStartingo†oad stage %d of %ld for %s...",

627 
s
, 
chd»n
, 
tdefs
[
tbl
].
comm’t
);

630 ià(
dœeù
 == 0)

631 
	`£t_fes
 (
tbl
, 
s
);

633 
rowút
 = 
	`£t_¡©e
(
tbl
, 
sÿË
, 
chd»n
, 
s
, &
exŒa
);

635 ià(
s
 =ğ
chd»n
)

636 
	`g’_tbl
 (
tbl
, 
rowút
 * (
s
 - 1è+ 1,„owúˆ+ 
exŒa
, 
upd_num
);

638 
	`g’_tbl
 (
tbl
, 
rowút
 * (
s
 - 1è+ 1,„owút, 
upd_num
);

640 ià(
v”bo£
 > 0)

641 
	`årštf
 (
¡d”r
, "done.\n");

644 
	}
}

646 #iâdeà
DOS


649 
	$¶ßd
 (
tbl
)

651 
c
 = 0, 
i
, 
¡©us
;

653 ià(
v”bo£
 > 0)

655 
	`årštf
 (
¡d”r
, "Starting %ld childreno†oad %s",

656 
chd»n
, 
tdefs
[
tbl
].
comm’t
);

658 
c
 = 0; c < 
chd»n
; c++)

660 
pids
[
c
] = 
	`SPAWN
 ();

661 ià(
pids
[
c
] == -1)

663 
	`³¼Ü
 ("Child†oader‚ot created");

664 
	`kl_lßd
 ();

665 
	`ex™
 (-1);

667 ià(
pids
[
c
] == 0)

669 
	`SET_HANDLER
 (
¡İ_´oc
);

670 
v”bo£
 = 0;

671 
	`·¹Ÿl
 (
tbl
, 
c
+1);

672 
	`ex™
 (0);

674 ià(
v”bo£
 > 0)

675 
	`årštf
 (
¡d”r
, ".");

678 ià(
v”bo£
 > 0)

679 
	`årštf
 (
¡d”r
, "waiting...");

681 
c
 = 
chd»n
;

682 
c
)

684 
i
 = 
	`WAIT
 (&
¡©us
, 
pids
[
c
 - 1]);

685 ià(
i
 =ğ-1 && 
chd»n
)

687 ià(
”ºo
 =ğ
ECHILD
)

688 
	`årštf
 (
¡d”r
, "\nCould‚Ù wa™ oÀpid %d\n", 
pids
[
c
 - 1]);

689 ià(
”ºo
 =ğ
EINTR
)

690 
	`årštf
 (
¡d”r
, "\nProûs %d stİ³d‡bnÜm®ly\n", 
pids
[
c
 - 1]);

691 ià(
”ºo
 =ğ
EINVAL
)

692 
	`årštf
 (
¡d”r
, "\nProgram bug\n");

694 ià(! 
	`WIFEXITED
(
¡©us
)) {

695 (è
	`årštf
(
¡d”r
, "\nProûs %d: ", 
i
);

696 ià(
	`WIFSIGNALED
(
¡©us
)) {

697 (è
	`årštf
(
¡d”r
, "rcvd signal %d\n",

698 
	`WTERMSIG
(
¡©us
));

699 } ià(
	`WIFSTOPPED
(
¡©us
)) {

700 (è
	`årštf
(
¡d”r
, "stopped, signal %d\n",

701 
	`WSTOPSIG
(
¡©us
));

705 
c
--;

708 ià(
v”bo£
 > 0)

709 
	`årštf
 (
¡d”r
, "done\n");

711 
	}
}

716 
	$´oûss_İtiÚs
 (
couÁ
, **
veùÜ
)

718 
İtiÚ
;

720 (
İtiÚ
 = 
	`g‘İt
 (
couÁ
, 
veùÜ
,

726 
İtiÚ
)

729 
d_·th
 = (*)
	`m®loc
(
	`¡¾’
(
İrg
) + 1);

730 
	`MALLOC_CHECK
(
d_·th
);

731 
	`¡rıy
(
d_·th
, 
İrg
);

734 
v”bo£
 = -1;

737 
š£¹_£gm’ts
 = 
	`©oi
 (
İrg
);

740 
d–‘e_£gm’ts
 = 
	`©oi
 (
İrg
);

743 
¡•
 = 
	`©oi
 (
İrg
);

746 
v”bo£
 = 1;

749 
fÜû
 = 1;

752 *
İrg
)

754 #ifdeà
SSBM


756 
bË
 = 1 << 
CUST
;

759 
bË
 = 1 << 
PART
;

762 
bË
 = 1 << 
SUPP
;

765 
bË
 = 1 << 
DATE
;

768 
bË
 = 1 << 
LINE
;

771 
bË
 = 1 << 
CUST
;

772 
bË
 |ğ1 << 
PART
;

773 
bË
 |ğ1 << 
SUPP
;

774 
bË
 |ğ1 << 
DATE
;

775 
bË
 |ğ1 << 
LINE
;

779 
bË
 = 1 << 
CUST
;

782 
bË
 = 1 << 
LINE
;

785 
bË
 = 1 << 
NATION
;

786 
bË
 |ğ1 << 
REGION
;

789 
bË
 = 1 << 
NATION
;

792 
bË
 = 1 << 
ORDER
;

795 
bË
 = 1 << 
ORDER_LINE
;

798 
bË
 = 1 << 
PART
;

801 
bË
 = 1 << 
PART_PSUPP
;

804 
bË
 = 1 << 
REGION
;

807 
bË
 = 1 << 
PSUPP
;

810 
bË
 = 1 << 
SUPP
;

814 
	`årštf
 (
¡d”r
, "Unknownable‚ame %s\n",

815 
İrg
);

816 
	`u§ge
 ();

817 
	`ex™
 (1);

822 
æt_sÿË
 = 
	`©of
 (
İrg
);

823 ià(
æt_sÿË
 < 
MIN_SCALE
)

825 
i
;

827 
sÿË
 = 1;

828 
i
 = 
PART
; i < 
REGION
; i++)

830 
tdefs
[
i
].
ba£
 *ğ
æt_sÿË
;

831 ià(
tdefs
[
i
].
ba£
 < 1)

832 
tdefs
[
i
].
ba£
 = 1;

836 
sÿË
 = (è
æt_sÿË
;

837 ià(
sÿË
 > 
MAX_SCALE
)

839 
	`årštf
 (
¡d”r
, "%s %5.0f %s\n\t%s\n\n",

841 
MAX_SCALE
,

844 
	`årštf
 (
¡d”r
,

849 
	`tŞow”
 (*
İrg
))

852 
g’_sql
 = 1;

855 
âames
 = 1;

858 
h—d”
 = 1;

861 
cŞumÇr
 = 1;

864 
g’_ºg
 = 1;

867 
£t_£eds
 = 1;

870 
v®id©e
 = 1;

873 
	`årštf
 (
¡d”r
, "Unknown option‚ame %s\n",

874 
İrg
);

875 
	`u§ge
 ();

876 
	`ex™
 (1);

880 
dœeù
 = 1;

883 
dœeù
 = 0;

886 
upd©es
 = 
	`©oi
 (
İrg
);

889 
»äesh
 = 
	`©oi
 (
İrg
);

891 #iâdeà
DOS


893 
chd»n
 = 
	`©oi
 (
İrg
);

897 
db_Çme
 = (*è
	`m®loc
 (
	`¡¾’
 (
İrg
) + 1);

898 
	`MALLOC_CHECK
 (
db_Çme
);

899 
	`¡rıy
 (
db_Çme
, 
İrg
);

902 
	`´štf
 ("ERROR: option '%c' unknown.\n",

903 *(
veùÜ
[
İtšd
] + 1));

905 
	`årštf
 (
¡d”r
,

907 
NAME
, 
VERSION
, 
RELEASE
,

908 
MODIFICATION
, 
PATCH
);

911 
	`årštf
 (
¡d”r
, "Cİyrighˆ% %s\n", 
TPC
, 
C_DATES
);

912 
	`u§ge
 ();

913 
	`ex™
 (1);

920 #iâdeà
DOS


921 ià(
chd»n
 !ğ1 && 
¡•
 == -1)

923 
pids
 = (*)
	`m®loc
(
chd»n
 * (
pid_t
));

924 
	`MALLOC_CHECK
(
pids
)

927 ià(
chd»n
 !ğ1 && 
¡•
 < 0)

929 
	`årštf
(
¡d”r
, "ERROR: -C must be‡ccompanied by -S onhis…latform\n");

930 
	`ex™
(1);

935 
	}
}

937 
	$ssb_dbg’_š™
()

940 
bË
 = (1 << 
PART
) |

941 (1 << 
SUPP
) |

942 (1 << 
CUST
) |

943 (1 << 
DATE
) |

944 (1 << 
LINE
);

945 
fÜû
 = 0;

946 
š£¹_£gm’ts
=0;

947 
d–‘e_£gm’ts
=0;

948 
š£¹_Üd”s_£gm’t
=0;

949 
š£¹_lše™em_£gm’t
=0;

950 
d–‘e_£gm’t
=0;

951 
v”bo£
 = 0;

952 
cŞumÇr
 = 0;

953 
£t_£eds
 = 0;

954 
h—d”
 = 0;

955 
dœeù
 = 0;

956 
sÿË
 = 1;

957 
æt_sÿË
 = 1.0;

958 
upd©es
 = 0;

959 
»äesh
 = 
UPD_PCT
;

960 
¡•
 = -1;

962 
tdefs
[
LINE
].
ba£
 *=

963 
ORDERS_PER_CUST
;

965 
âames
 = 0;

966 
db_Çme
 = 
NULL
;

967 
g’_sql
 = 0;

968 
g’_ºg
 = 0;

969 
chd»n
 = 1;

970 
d_·th
 = 
NULL
;

972 
	`lßd_di¡s
 ();

974 
tdefs
[
NATION
].
ba£
 = 
ÇtiÚs
.
couÁ
;

975 
tdefs
[
REGION
].
ba£
 = 
»giÚs
.
couÁ
;

978 
	}
}

982 
	$EXIT_NAMESPACE
(
dbg’ssb
)

984 
usšg
 
Çme¥aû
 
dbg’ssb
;

991 
	$maš22
 (
ac
, **
av
)

993 
i
;

1001 
bË
 = (1 << 
PART
) |

1002 (1 << 
SUPP
) |

1003 (1 << 
CUST
) |

1004 (1 << 
DATE
) |

1005 (1 << 
LINE
);

1006 
fÜû
 = 0;

1007 
š£¹_£gm’ts
=0;

1008 
d–‘e_£gm’ts
=0;

1009 
š£¹_Üd”s_£gm’t
=0;

1010 
š£¹_lše™em_£gm’t
=0;

1011 
d–‘e_£gm’t
=0;

1012 
v”bo£
 = 0;

1013 
cŞumÇr
 = 0;

1014 
£t_£eds
 = 0;

1015 
h—d”
 = 0;

1016 
dœeù
 = 0;

1017 
sÿË
 = 1;

1018 
æt_sÿË
 = 1.0;

1019 
upd©es
 = 0;

1020 
»äesh
 = 
UPD_PCT
;

1021 
¡•
 = -1;

1023 
tdefs
[
LINE
].
ba£
 *=

1024 
ORDERS_PER_CUST
;

1026 
âames
 = 0;

1027 
db_Çme
 = 
NULL
;

1028 
g’_sql
 = 0;

1029 
g’_ºg
 = 0;

1030 
chd»n
 = 1;

1031 
d_·th
 = 
NULL
;

1034 
	`´oûss_İtiÚs
 (
ac
, 
av
);

1037 
	`lßd_di¡s
 ();

1039 
tdefs
[
NATION
].
ba£
 = 
ÇtiÚs
.
couÁ
;

1040 
tdefs
[
REGION
].
ba£
 = 
»giÚs
.
couÁ
;

1050 
i
 = 
PART
; i <ğ
REGION
; i++)

1051 ià(
bË
 & (1 << 
i
))

1053 ià(
chd»n
 > 1 && 
i
 < 
NATION
)

1055 ià(
¡•
 >= 0)

1057 ià(
v®id©e
)

1059 
	`INTERNAL_ERROR
("Cannot validate…arallel data generation");

1063 
	`·¹Ÿl
 (
i
, 
¡•
);

1068 ià(
v®id©e
)

1070 
	`INTERNAL_ERROR
("Cannot validate…arallel data generation");

1074 
	`¶ßd
 (
i
);

1080 
mšrow
 = 1;

1081 ià(
i
 < 
NATION
) {

1082 
rowút
 = 
tdefs
[
i
].
ba£
 * 
sÿË
;

1085 
rowút
 = 
tdefs
[
i
].
ba£
;

1087 if(
i
==
PART
){

1088 
rowút
 = 
tdefs
[
i
].
ba£
 * (
	`æoÜ
(1+
	`log
(()(
sÿË
))/(log(2.))));

1090 if(
i
==
DATE
){

1091 
rowút
 = 
tdefs
[
i
].
ba£
;

1093 ià(
v”bo£
 > 0){

1094 
	`årštf
 (
¡d”r
, "%s data for %s [pid: %ld]",

1095 (
v®id©e
)?"V®id©šg":"G’”©šg", 
tdefs
[
i
].
comm’t
, ()
DSS_PROC
);

1097 
	`g’_tbl
 (
i
, 
mšrow
, 
rowút
, 
upd_num
);

1098 ià(
v”bo£
 > 0){

1099 
	`årštf
 (
¡d”r
, "done.\n");

1102 ià(
v®id©e
)

1104 
	`´štf
("Validation checksum for %s‡t %ld GB: %0x\n",

1105 
tdefs
[
i
].
Çme
, 
sÿË
, (édefs[i].
vtÙ®
);

1112 
	}
}

	@src/workload/ssb/dbgen/ssb_load_stub.cpp

12 
	~<¡dio.h
>

13 
	~"wÜklßd/ssb/dbg’/cÚfig.h
"

14 
	~"wÜklßd/ssb/dbg’/dss.h
"

15 
	~"wÜklßd/ssb/dbg’/ds¡y³s.h
"

17 
	$ENTER_NAMESPACE
(
dbg’ssb
)

20 
	$şo£_dœeù
()

24 
	}
}

27 
	$´•_dœeù
(*)

31 
	}
}

34 
	$hd_cu¡
 (
FILE
 * )

36 
couÁ
 = 0;

38 ià(! 
couÁ
++)

39 
	`´štf
("No header has been defined forhe customerable\n");

42 
	}
}

46 
	$ld_cu¡
 (* , )

48 
couÁ
 = 0;

50 ià(! 
couÁ
++)

51 
	`´štf
("%s %s\n",

56 
	}
}

59 
	$hd_·¹
 (
FILE
 * )

61 
couÁ
 = 0;

63 ià(! 
couÁ
++)

64 
	`´štf
("No header has been defined forhe…artable\n");

67 
	}
}

70 
	$ld_·¹
 (* , )

72 
couÁ
 = 0;

74 ià(! 
couÁ
++)

75 
	`´štf
("No†oad„outine has been defined forhe…artable\n");

78 
	}
}

81 
	$ld_psuµ
 (* , )

83 
couÁ
 = 0;

85 ià(! 
couÁ
++)

86 
	`´štf
("%s %s\n",

92 
	}
}

96 
	$hd_suµ
 (
FILE
 * )

98 
couÁ
 = 0;

100 ià(! 
couÁ
++)

101 
	`´štf
("No header has been defined forhe supplierable\n");

104 
	}
}

107 
	$ld_suµ
 (* , )

109 
couÁ
 = 0;

111 ià(! 
couÁ
++)

112 
	`´štf
("%s %s\n",

117 
	}
}

121 
	$hd_Üd”
 (
FILE
 * )

123 
couÁ
 = 0;

125 ià(! 
couÁ
++)

126 
	`´štf
("No header has been defined forhe orderable\n");

129 
	}
}

132 
	$ld_Üd”
 (* , )

134 
couÁ
 = 0;

136 ià(! 
couÁ
++)

137 
	`´štf
("%s %s\n",

142 
	}
}

145 
	$ld_lše
 (* , )

147 
couÁ
 = 0;

149 ià(! 
couÁ
++)

150 
	`´štf
("%s %s\n",

155 
	}
}

160 
	$hd_psuµ
 (
FILE
 * )

162 
couÁ
 = 0;

164 ià(! 
couÁ
++)

165 
	`´štf
("%s %s\n",

170 
	}
}

174 
	$hd_lše
 (
FILE
 * )

176 
couÁ
 = 0;

178 ià(! 
couÁ
++)

179 
	`´štf
("No header has been defined forhe†ineitemable\n");

182 
	}
}

185 
	$hd_ÇtiÚ
 (
FILE
 * )

187 
couÁ
 = 0;

189 ià(! 
couÁ
++)

190 
	`´štf
("No header has been defined forhe‚ationable\n");

193 
	}
}

195 #ifdeà
SSBM


198 
	$ld_ÇtiÚ
 (* , )

200 
couÁ
 = 0;

202 ià(! 
couÁ
++)

203 
	`´štf
("%s %s\n",

208 
	}
}

211 
	$hd_»giÚ
 (
FILE
 * )

213 
couÁ
 = 0;

215 ià(! 
couÁ
++)

216 
	`´štf
("No header has been defined forhe„egionable\n");

219 
	}
}

222 
	$ld_»giÚ
 (* , )

224 
couÁ
 = 0;

226 ià(! 
couÁ
++)

227 
	`´štf
("%s %s\n",

232 
	}
}

235 
	$ld_Üd”_lše
 (* , )

237 
Üd”_t
*
µ
=(Üd”_t*)
p
;

238 
	`ld_Üd”
(
µ
, 
mode
);

239 
	`ld_lše
 (
µ
, 
mode
);

242 
	}
}

245 
	$hd_Üd”_lše
 (
FILE
 * )

247 
	`hd_Üd”
(
f
);

248 
	`hd_lše
 (
f
);

251 
	}
}

254 
	$ld_·¹_psuµ
 (* , )

256 
·¹_t
 *
µ
=Õ¬t_ˆ*)
p
;

257 
	`ld_·¹
(
µ
, 
mode
);

258 
	`ld_psuµ
 (
µ
, 
mode
);

261 
	}
}

264 
	$hd_·¹_psuµ
 (
FILE
 * )

266 
	`hd_·¹
(
f
);

267 
	`hd_psuµ
(
f
);

270 
	}
}

273 #ifdeà
SSBM


275 
	$ld_d©e
 (* , )

279 
	}
}

284 
EXIT_NAMESPACE
(
dbg’ssb
)

	@src/workload/ssb/dbgen/ssb_permute.cpp

7 #ifdeà
TEST


8 
	#DECLARER


	)

10 
	~"wÜklßd/ssb/dbg’/cÚfig.h
"

11 
	~"wÜklßd/ssb/dbg’/dss.h
"

12 #ifdeà
TEST


13 
	~<¡dlib.h
>

14 #ià(
defšed
(
_POSIX_
)||!defšed(
WIN32
))

15 
	~<uni¡d.h
>

16 
	~<sys/wa™.h
>

18 
	~<¡dio.h
>

19 
	~<lim™s.h
>

20 
	~<m©h.h
>

21 
	~<ùy³.h
>

22 
	~<sigÇl.h
>

23 
	~<¡ršg.h
>

24 
	~<”ºo.h
>

25 #ifdeà
HP


26 
	~<¡ršgs.h
>

28 #ià(
defšed
(
WIN32
)&&!defšed(
_POSIX_
))

29 
	~<´oûss.h
>

30 #´agm¨
w¬nšg
(
di§bË
:4201)

31 #´agm¨
w¬nšg
(
di§bË
:4214)

32 #´agm¨
w¬nšg
(
di§bË
:4514)

33 
	#WIN32_LEAN_AND_MEAN


	)

34 
	#NOATOM


	)

35 
	#NOGDICAPMASKS


	)

36 
	#NOMETAFILE


	)

37 
	#NOMINMAX


	)

38 
	#NOMSG


	)

39 
	#NOOPENFILE


	)

40 
	#NORASTEROPS


	)

41 
	#NOSCROLL


	)

42 
	#NOSOUND


	)

43 
	#NOSYSMETRICS


	)

44 
	#NOTEXTMETRIC


	)

45 
	#NOWH


	)

46 
	#NOCOMM


	)

47 
	#NOKANJI


	)

48 
	#NOMCX


	)

49 
	~<wšdows.h
>

50 #´agm¨
w¬nšg
(:4201)

51 #´agm¨
w¬nšg
(:4214)

55 
ENTER_NAMESPACE
(
dbg’ssb
);

57 
NextRªd
(
£ed
);

58 *
³rmu‹
(*
£t
, 
út
, 
¡»am
);

59 *
³rmu‹_di¡
(
di¡ributiÚ
 *
d
, 
¡»am
);

60 
	g£ed
;

61 *
	geŞ
[2] = {" ", "},"};

62 
£ed_t
 
S“d
[];

63 #ifdeà
TEST


64 
tdef
 
	gtdefs
 = { 
NULL
 };

68 
	#MAX_QUERY
 22

	)

69 
	#ITERATIONS
 1000

	)

70 
	#UNSET
 0

	)

73 
	$³rmu‹
(*
a
, 
c
, 
s
)

75 
i
;

76 
sourû
;

77 *
£t
, 
‹mp
;

79 ià(
a
 !ğ(*)
NULL
)

81 
£t
 = 
a
;

82 
i
=0; i < 
c
; i++)

83 *(
a
 + 
i
) = i;

84 
i
=0; i < 
c
; i++)

86 
	`RANDOM
(
sourû
, 0L, ()(
c
 - 1), 
s
);

87 
‹mp
 = *(
a
 + 
sourû
);

88 *(
a
 + 
sourû
èğ*× + 
i
) ;

89 *(
a
 + 
i
èğ
‹mp
;

90 
sourû
 = 0;

94 
sourû
 += 1;

96 ià(
sourû
 >ğ
c
)

97 
sourû
 -ğ
c
;

99 (
£t
 + 
sourû
);

100 
	}
}

103 
	$³rmu‹_di¡
(
di¡ributiÚ
 *
d
, 
¡»am
)

105 
di¡ributiÚ
 *
di¡
 = 
NULL
;

106 
i
;

108 ià(
d
 !ğ
NULL
)

110 ià(
d
->
³rmu‹
 =ğ(*)
NULL
)

112 
d
->
³rmu‹
 = (*)
	`m®loc
((è* 
	`DIST_SIZE
(d));

113 
	`MALLOC_CHECK
(
d
->
³rmu‹
);

114 
i
=0; i < 
	`DIST_SIZE
(
d
); i++)

115 *(
d
->
³rmu‹
 + 
i
) = i;

117 
di¡
 = 
d
;

118 (
	`³rmu‹
(
di¡
->
³rmu‹
, 
	`DIST_SIZE
(di¡), 
¡»am
));

122 ià(
di¡
 !ğ
NULL
)

123 (
	`³rmu‹
(
NULL
, 
	`DIST_SIZE
(
di¡
), 
¡»am
));

125 
	`INTERNAL_ERROR
("Bad callo…ermute_dist");

126 
	}
}

129 #ifdeà
TEST


131 
	$maš_‹¡
(
ac
, **
av
)

133 *
£qu’û
,

134 
i
,

135 
j
,

136 
¡»ams
 = 
UNSET
,

137 *
a
;

138 
£p
;

139 
šdex
 = 0;

141 
£t_£eds
 = 0;

142 
£qu’û
 = (*)
	`m®loc
(
MAX_QUERY
 * ());

143 
a
 = 
£qu’û
;

144 
i
=0; i < 
MAX_QUERY
; i++)

145 *(
£qu’û
 + 
i
) = i;

146 ià(
ac
 < 3)

147 
u§ge
;

148 
S“d
[0].
v®ue
 = ()
	`©oi
(
av
[1]);

149 
¡»ams
 = 
	`©oi
(
av
[2]);

150 ià(
S“d
[0].
v®ue
 =ğ
UNSET
 || 
¡»ams
 == UNSET)

151 
u§ge
;

153 
šdex
 = 0;

154 
	`´štf
("lÚg…”mutiÚ[%d][%d] = {\n", 
¡»ams
, 
MAX_QUERY
);

155 
j
=0; j < 
¡»ams
; j++)

157 
£p
 = '{';

158 
	`´štf
("%s\n", 
eŞ
[
šdex
]);

159 
i
=0; i < 
MAX_QUERY
; i++)

161 
	`´štf
("%c%2d", 
£p
, *
	`³rmu‹
(
a
, 
MAX_QUERY
, 0) + 1);

162 
a
 = (*)
NULL
;

163 
£p
 = ',';

165 
a
 = 
£qu’û
;

166 
šdex
=1;

168 
	`´štf
("}\n};\n");

171 
u§ge
:

172 
	`´štf
("U§ge: % <£ed> <¡»ams>\n",
av
[0]);

173 
	`´štf
(" u£ <£ed>Ø¡¬ˆthg’”©iÚ oà<¡»ams>…”mutiÚ oà[1..%d]\n", 
MAX_QUERY
);

176 
	}
}

179 
EXIT_NAMESPACE
(
dbg’ssb
);

	@src/workload/ssb/dbgen/ssb_print.cpp

3 
	~<¡dio.h
>

4 #iâdeà
VMS


5 
	~<sys/ty³s.h
>

8 #ià
defšed
(
SUN
)

9 
	~<uni¡d.h
>

12 #ià
defšed
(
LINUX
)

13 
	~<uni¡d.h
>

16 
	~<m©h.h
>

18 
	~"wÜklßd/ssb/dbg’/dss.h
"

19 
	~"wÜklßd/ssb/dbg’/ds¡y³s.h
"

20 
	~<¡ršg.h
>

22 
	~<¡dio.h
>

23 
	~<time.h
>

26 
	$ENTER_NAMESPACE
(
dbg’ssb
)

32 
FILE
 *
´št_´•
 
	`PROTO
((
bË
, 
upd©e
));

33 
´_d¿nge
 
	`PROTO
((
tbl
, 
mš
, 
út
, 
num
));

35 
FILE
 *

36 
	$´št_´•
(
bË
, 
upd©e
)

38 
u·th
[128];

39 
FILE
 *
»s
;

41 ià(
upd©es
)

43 ià(
upd©e
 > 0)

44 iàĞ
š£¹_£gm’ts
 )

46 
this_£gm’t
;

47 if(
	`¡rcmp
(
tdefs
[
bË
].
Çme
,"orders.tbl"))

48 
this_£gm’t
=++
š£¹_Üd”s_£gm’t
;

50 
this_£gm’t
=++
š£¹_lše™em_£gm’t
;

51 
	`¥rštf
(
u·th
, "%s%c%s.u%d.%d",

52 
	`’v_cÚfig
((*)
PATH_TAG
, (*)
PATH_DFLT
),

53 
PATH_SEP
, 
tdefs
[
bË
].
Çme
, 
upd©e
%10000,
this_£gm’t
);

57 
	`¥rštf
(
u·th
, "%s%c%s.u%d",

58 
	`’v_cÚfig
((*)
PATH_TAG
, (*)
PATH_DFLT
),

59 
PATH_SEP
, 
tdefs
[
bË
].
Çme
, 
upd©e
);

62 iàĞ
d–‘e_£gm’ts
 )

64 ++
d–‘e_£gm’t
;

65 
	`¥rštf
(
u·th
, "%s%cdelete.u%d.%d",

66 
	`’v_cÚfig
((*)
PATH_TAG
, (*)
PATH_DFLT
), 
PATH_SEP
, -
upd©e
%10000,

67 
d–‘e_£gm’t
);

71 
	`¥rštf
(
u·th
, "%s%cdelete.%d",

72 
	`’v_cÚfig
((*)
PATH_TAG
, (*)
PATH_DFLT
), 
PATH_SEP
, -
upd©e
);

74 (
	`fİ’
(
u·th
, "w"));

76 
»s
 = 
	`tbl_İ’
(
bË
, (*)"w");

77 
	`OPEN_CHECK
(
»s
, 
tdefs
[
bË
].
Çme
);

78 (
»s
);

79 
	}
}

82 
	$dbg_´št
(
fÜm©
, 
FILE
 *
rg‘
, *
d©a
, 
Ën
, 
£p
)

84 
dŞÏrs
,

85 
ûÁs
;

87 
fÜm©
)

89 
DT_STR
:

90 ià(
cŞumÇr
)

91 
	`årštf
(
rg‘
, "%-*s", 
Ën
, (*)
d©a
);

93 
	`årštf
(
rg‘
, "%s", (*)
d©a
);

95 #ifdeà
MVS


96 
DT_VSTR
:

98 
	`årštf
(
rg‘
, "%c%c%-*s",

99 (
Ën
 >> 8è& 0xFF,†’ & 0xFF,†’, (*)
d©a
);

102 
DT_INT
:

103 ià(
cŞumÇr
)

104 
	`årštf
(
rg‘
, "%12ld", ()
d©a
);

106 
	`årštf
(
rg‘
, "%ld", ()
d©a
);

108 
DT_HUGE
:

109 #iâdeà
SUPPORT_64BITS


110 ià(*(*)((*)
d©a
 + 1) == 0) \

111 ià(
cŞumÇr
è
	`årštf
(
rg‘
, "%12ld", *(*)
d©a
);

112 
	`årštf
(
rg‘
, "%ld", *(*)
d©a
);

114 ià(
cŞumÇr
è
	`årštf
(
rg‘
, "%5ld%07ld",

115 *(*)((*)
d©a
 + 1), *(*)data);

116 
	`årštf
(
rg‘
,"%ld%07ld",

117 *(*)((*)
d©a
 + 1), *(*)data);

119 
	`årštf
(
rg‘
, 
HUGE_FORMAT
, *(
DSS_HUGE
 *)
d©a
);

122 
DT_KEY
:

123 
	`årštf
(
rg‘
, "%ld", ()
d©a
);

125 
DT_MONEY
:

126 
ûÁs
 = ()
d©a
;

127 ià(
ûÁs
 < 0)

129 
	`årštf
(
rg‘
, "-");

130 
ûÁs
 = -cents;

132 
dŞÏrs
 = 
ûÁs
 / 100;

133 
ûÁs
 %= 100;

134 ià(
cŞumÇr
)

135 
	`årštf
(
rg‘
, "%12ld.%02ld", 
dŞÏrs
, 
ûÁs
);

137 
	`årštf
(
rg‘
, "%ld.%02ld", 
dŞÏrs
, 
ûÁs
);

139 
DT_CHR
:

140 ià(
cŞumÇr
)

141 
	`årštf
(
rg‘
, "%ø", *(*)
d©a
);

143 
	`årštf
(
rg‘
, "%c", *(*)
d©a
);

147 #ifdeà
EOL_HANDLING


148 ià(
£p
)

150 ià(!
cŞumÇr
 && (
£p
 != -1))

151 
	`årštf
(
rg‘
, "%c", 
SEPARATOR
);

154 
	}
}

156 #ifdeà
SSBM


158 
	$´_cu¡
(*
c
, )

160 
FILE
 *
å
 = 
NULL
;

161 
cu¡om”_t
 *
ı
=(cu¡om”_ˆ*)
c
;

162 ià(
å
 =ğ
NULL
)

163 
å
 = 
	`´št_´•
(
CUST
, 0);

165 
	`PR_STRT
(
å
);

166 
	`PR_INT
(
å
, 
ı
->
cu¡key
);

167 
	`PR_VSTR
(
å
, 
ı
->
Çme
, 
C_NAME_LEN
);

168 
	`PR_VSTR
(
å
, 
ı
->
add»ss
,

169 (
cŞumÇr
)?()(
	`û
(
C_ADDR_LEN
 * 
V_STR_HGH
)):
ı
->
®’
);

170 
	`PR_STR
(
å
, 
ı
->
c™y
,
CITY_FIX
);

171 
	`PR_STR
(
å
, 
ı
->
ÇtiÚ_Çme
, 
C_NATION_NAME_LEN
);

172 
	`PR_STR
(
å
, 
ı
->
»giÚ_Çme
, 
C_REGION_NAME_LEN
);

173 
	`PR_STR
(
å
, 
ı
->
phÚe
, 
PHONE_LEN
);

174 
	`PR_STR
(
å
, 
ı
->
mkt£gm’t
,
MAXAGG_LEN
);

175 
	`PR_END
(
å
);

178 
	}
}

182 
	$´_cu¡
(*
c
, 
mode
)

184 
FILE
 *
å
 = 
NULL
;

185 
cu¡om”_t
 *
ı
=(cu¡om”_ˆ*)
c
;

186 ià(
å
 =ğ
NULL
)

187 
å
 = 
	`´št_´•
(
CUST
, 0);

189 
	`PR_STRT
(
å
);

190 
	`PR_INT
(
å
, 
ı
->
cu¡key
);

191 
	`PR_VSTR
(
å
, 
ı
->
Çme
, 
C_NAME_LEN
);

192 
	`PR_VSTR
(
å
, 
ı
->
add»ss
,

193 (
cŞumÇr
)?()(
	`û
(
C_ADDR_LEN
 * 
V_STR_HGH
)):
ı
->
®’
);

194 
	`PR_INT
(
å
, 
ı
->
ÇtiÚ_code
);

195 
	`PR_STR
(
å
, 
ı
->
phÚe
, 
PHONE_LEN
);

196 
	`PR_MONEY
(
å
, 
ı
->
acùb®
);

197 
	`PR_STR
(
å
, 
ı
->
mkt£gm’t
, 
C_MSEG_LEN
);

198 
	`PR_VSTR_LAST
(
å
, 
ı
->
comm’t
,

199 (
cŞumÇr
)?()(
	`û
(
C_CMNT_LEN
 * 
V_STR_HGH
)):
ı
->
ş’
);

200 
	`PR_END
(
å
);

203 
	}
}

209 #ifdeà
SSBM


213 
	$´_Üd”
(*
o
, 
mode
)

215 
FILE
 *
å_o
 = 
NULL
;

216 
Ï¡_mode
 = 0;

217 
Üd”_t
 *
İ
=(Üd”_ˆ*)
o
;

218 ià(
å_o
 =ğ
NULL
 || 
mode
 !ğ
Ï¡_mode
)

220 ià(
å_o
)

221 
	`fşo£
(
å_o
);

222 
å_o
 = 
	`´št_´•
(
ORDER
, 
mode
);

223 
Ï¡_mode
 = 
mode
;

225 
	`PR_STRT
(
å_o
);

226 
	`PR_HUGE
(
å_o
, 
İ
->
okey
);

227 
	`PR_INT
(
å_o
, 
İ
->
cu¡key
);

228 
	`PR_CHR
(
å_o
, 
İ
->
Üd”¡©us
);

229 
	`PR_MONEY
(
å_o
, 
İ
->
tÙ®´iû
);

230 
	`PR_STR
(
å_o
, 
İ
->
od©e
, 
DATE_LEN
);

231 
	`PR_STR
(
å_o
, 
İ
->
İriÜ™y
, 
O_OPRIO_LEN
);

232 
	`PR_STR
(
å_o
, 
İ
->
ş”k
, 
O_CLRK_LEN
);

233 
	`PR_INT
(
å_o
, 
İ
->
¥riÜ™y
);

234 
	`PR_VSTR_LAST
(
å_o
, 
İ
->
comm’t
,

235 (
cŞumÇr
)?()(
	`û
(
O_CMNT_LEN
 * 
V_STR_HGH
)):
İ
->
ş’
);

236 
	`PR_END
(
å_o
);

239 
	}
}

245 #ifdeà
SSBM


247 
	$´_lše
(*
o
, 
mode
)

250 
FILE
 *
å_l
 = 
NULL
;

251 
Ï¡_mode
 = 0;

253 
Üd”_t
 *
İ
=(Üd”_ˆ*)
o
;

255 
i
;

259 ià(
å_l
 =ğ
NULL
 || 
mode
 !ğ
Ï¡_mode
)

261 ià(
å_l
)

262 
	`fşo£
(
å_l
);

263 
å_l
 = 
	`´št_´•
(
LINE
, 
mode
);

264 
Ï¡_mode
 = 
mode
;

267 
i
 = 0; i < 
İ
->
lšes
; i++)

269 
	`PR_STRT
(
å_l
);

270 
	`PR_HUGE
(
å_l
, 
İ
->
lšeÜd”s
[
i
].
okey
);

271 
	`PR_INT
(
å_l
, 
İ
->
lšeÜd”s
[
i
].
lš’umb”
);

272 
	`PR_INT
(
å_l
, 
İ
->
lšeÜd”s
[
i
].
cu¡key
);

273 
	`PR_INT
(
å_l
, 
İ
->
lšeÜd”s
[
i
].
·¹key
);

274 
	`PR_INT
(
å_l
, 
İ
->
lšeÜd”s
[
i
].
suµkey
);

275 
	`PR_STR
(
å_l
, 
İ
->
lšeÜd”s
[
i
].
Üd”d©e
, 
DATE_LEN
);

276 
	`PR_STR
(
å_l
, 
İ
->
lšeÜd”s
[
i
].
İriÜ™y
, 
O_OPRIO_LEN
);

277 
	`PR_INT
(
å_l
, 
İ
->
lšeÜd”s
[
i
].
sh_´iÜ™y
);

278 
	`PR_INT
(
å_l
, 
İ
->
lšeÜd”s
[
i
].
quªt™y
);

279 
	`PR_INT
(
å_l
, 
İ
->
lšeÜd”s
[
i
].
ex‹nded_´iû
);

280 
	`PR_INT
(
å_l
, 
İ
->
lšeÜd”s
[
i
].
Üd”_tÙ®´iû
);

281 
	`PR_INT
(
å_l
, 
İ
->
lšeÜd”s
[
i
].
discouÁ
);

282 
	`PR_INT
(
å_l
, 
İ
->
lšeÜd”s
[
i
].
»v’ue
);

283 
	`PR_INT
(
å_l
, 
İ
->
lšeÜd”s
[
i
].
suµ_co¡
);

284 
	`PR_INT
(
å_l
, 
İ
->
lšeÜd”s
[
i
].
x
);

285 
	`PR_STR
(
å_l
, 
İ
->
lšeÜd”s
[
i
].
comm™_d©e
, 
DATE_LEN
);

286 
	`PR_STR
(
å_l
, 
İ
->
lšeÜd”s
[
i
].
shmode
, 
O_SHIP_MODE_LEN
);

287 
	`PR_END
(
å_l
);

291 
	}
}

294 
	$´_lše
(*
o
, 
mode
)

296 
FILE
 *
å_l
 = 
NULL
;

297 
Ï¡_mode
 = 0;

298 
Üd”_t
 *
İ
=(Üd”_ˆ*)
o
;

300 
i
;

301 
days
;

302 
buf
[100];

304 ià(
å_l
 =ğ
NULL
 || 
mode
 !ğ
Ï¡_mode
)

306 ià(
å_l
)

307 
	`fşo£
(
å_l
);

308 
å_l
 = 
	`´št_´•
(
LINE
, 
mode
);

309 
Ï¡_mode
 = 
mode
;

312 
i
 = 0; i < 
İ
->
lšes
; i++)

314 
	`PR_STRT
(
å_l
);

315 
	`PR_HUGE
(
å_l
, 
İ
->
l
[
i
].
okey
);

316 
	`PR_INT
(
å_l
, 
İ
->
l
[
i
].
·¹key
);

317 
	`PR_INT
(
å_l
, 
İ
->
l
[
i
].
suµkey
);

318 
	`PR_INT
(
å_l
, 
İ
->
l
[
i
].
lút
);

319 
	`PR_INT
(
å_l
, 
İ
->
l
[
i
].
quªt™y
);

320 
	`PR_MONEY
(
å_l
, 
İ
->
l
[
i
].
•riû
);

321 
	`PR_MONEY
(
å_l
, 
İ
->
l
[
i
].
discouÁ
);

322 
	`PR_MONEY
(
å_l
, 
İ
->
l
[
i
].
x
);

323 
	`PR_CHR
(
å_l
, 
İ
->
l
[
i
].
ræag
[0]);

324 
	`PR_CHR
(
å_l
, 
İ
->
l
[
i
].
l¡©us
[0]);

325 
	`PR_STR
(
å_l
, 
İ
->
l
[
i
].
sd©e
, 
DATE_LEN
);

326 
	`PR_STR
(
å_l
, 
İ
->
l
[
i
].
cd©e
, 
DATE_LEN
);

327 
	`PR_STR
(
å_l
, 
İ
->
l
[
i
].
rd©e
, 
DATE_LEN
);

328 
	`PR_STR
(
å_l
, 
İ
->
l
[
i
].
shš¡ruù
, 
L_INST_LEN
);

329 
	`PR_STR
(
å_l
, 
İ
->
l
[
i
].
shmode
, 
L_SMODE_LEN
);

330 
	`PR_VSTR_LAST
(
å_l
, 
İ
->
l
[
i
].
comm’t
,

331 (
cŞumÇr
)?()(
	`û
(
L_CMNT_LEN
 *

332 
V_STR_HGH
)):
İ
->
l
[
i
].
ş’
);

333 
	`PR_END
(
å_l
);

337 
	}
}

343 #ifdeà
SSBM


346 
	$´_Üd”_lše
(*
o
, 
mode
)

348 
Üd”_t
 *
İ
=(Üd”_ˆ*)
o
;

349 
tdefs
[
ORDER
].
Çme
 =defs[
ORDER_LINE
].name;

350 
	`´_Üd”
(
İ
, 
mode
);

351 
	`´_lše
(
İ
, 
mode
);

354 
	}
}

360 #ifdeà
SSBM


362 
	$´_·¹
(*
·¹
, )

364 
FILE
 *
p_å
 = 
NULL
;

366 
·¹_t
 *
·¹_p
=Õ¬t_ˆ*)
·¹
;

368 ià(
p_å
 =ğ
NULL
)

369 
p_å
 = 
	`´št_´•
(
PART
, 0);

371 
	`PR_STRT
(
p_å
);

372 
	`PR_INT
(
p_å
, 
·¹_p
->
·¹key
);

373 
	`PR_VSTR
(
p_å
, 
·¹_p
->
Çme
,

374 (
cŞumÇr
)?()
P_NAME_LEN
:
·¹_p
->
Æ’
);

375 
	`PR_STR
(
p_å
, 
·¹_p
->
mfgr
, 
P_MFG_LEN
);

376 
	`PR_STR
(
p_å
, 
·¹_p
->
ÿ‹gÜy
, 
P_CAT_LEN
);

377 
	`PR_STR
(
p_å
, 
·¹_p
->
b¿nd
, 
P_BRND_LEN
);

380 
	`PR_VSTR
(
p_å
, 
·¹_p
->
cŞÜ
,(
cŞumÇr
)?()
P_COLOR_LEN
:·¹_p->
ş’
);

381 
	`PR_VSTR
(
p_å
, 
·¹_p
->
ty³
,

382 (
cŞumÇr
)?()
P_TYPE_LEN
:
·¹_p
->
’
);

383 
	`PR_INT
(
p_å
, 
·¹_p
->
size
);

384 
	`PR_STR
(
p_å
, 
·¹_p
->
cÚš”
, 
P_CNTR_LEN
);

385 
	`PR_END
(
p_å
);

387 
	}
}

391 
	$´_·¹
(*
·¹
, 
mode
)

393 
FILE
 *
p_å
 = 
NULL
;

394 
·¹_t
 *
·¹_p
=Õ¬t_ˆ*)
·¹
;

396 ià(
p_å
 =ğ
NULL
)

397 
p_å
 = 
	`´št_´•
(
PART
, 0);

399 
	`PR_STRT
(
p_å
);

400 
	`PR_INT
(
p_å
, 
·¹_p
->
·¹key
);

401 
	`PR_VSTR
(
p_å
, 
·¹_p
->
Çme
,

402 (
cŞumÇr
)?()
P_NAME_LEN
:
·¹_p
->
Æ’
);

403 
	`PR_STR
(
p_å
, 
·¹_p
->
mfgr
, 
P_MFG_LEN
);

404 
	`PR_STR
(
p_å
, 
·¹_p
->
b¿nd
, 
P_BRND_LEN
);

405 
	`PR_VSTR
(
p_å
, 
·¹_p
->
ty³
,

406 (
cŞumÇr
)?()
P_TYPE_LEN
:
·¹_p
->
’
);

407 
	`PR_INT
(
p_å
, 
·¹_p
->
size
);

408 
	`PR_STR
(
p_å
, 
·¹_p
->
cÚš”
, 
P_CNTR_LEN
);

409 
	`PR_MONEY
(
p_å
, 
·¹_p
->
»´iû
);

410 
	`PR_VSTR_LAST
(
p_å
, 
·¹_p
->
comm’t
,

411 (
cŞumÇr
)?()(
	`û
(
P_CMNT_LEN
 * 
V_STR_HGH
)):
·¹_p
->
ş’
);

412 
	`PR_END
(
p_å
);

415 
	}
}

421 #ifdeà
SSBM


425 
	$´_psuµ
(*
·¹
, 
mode
)

427 
FILE
 *
ps_å
 = 
NULL
;

428 
·¹_t
 *
·¹_p
=Õ¬t_ˆ*)
·¹
;

430 
i
;

432 ià(
ps_å
 =ğ
NULL
)

433 
ps_å
 = 
	`´št_´•
(
PSUPP
, 
mode
);

435 
i
 = 0; i < 
SUPP_PER_PART
; i++)

437 
	`PR_STRT
(
ps_å
);

438 
	`PR_INT
(
ps_å
, 
·¹_p
->
s
[
i
].
·¹key
);

439 
	`PR_INT
(
ps_å
, 
·¹_p
->
s
[
i
].
suµkey
);

440 
	`PR_INT
(
ps_å
, 
·¹_p
->
s
[
i
].
qty
);

441 
	`PR_MONEY
(
ps_å
, 
·¹_p
->
s
[
i
].
sco¡
);

442 
	`PR_VSTR_LAST
(
ps_å
, 
·¹_p
->
s
[
i
].
comm’t
,

443 (
cŞumÇr
)?()(
	`û
(
PS_CMNT_LEN
 * 
V_STR_HGH
)):
·¹_p
->
s
[
i
].
ş’
);

444 
	`PR_END
(
ps_å
);

448 
	}
}

454 #ifdeà
SSBM


458 
	$´_·¹_psuµ
(*
·¹
, 
mode
)

460 
·¹_t
 *
·¹_p
=Õ¬t_ˆ*)
·¹
;

462 
tdefs
[
PART
].
Çme
 =defs[
PART_PSUPP
].name;

463 
	`´_·¹
(
·¹_p
, 
mode
);

464 
	`´_psuµ
(
·¹_p
, 
mode
);

467 
	}
}

471 #ifdeà
SSBM


473 
	$´_suµ
(*
suµ
, 
mode
)

475 
FILE
 *
å
 = 
NULL
;

476 
suµl›r_t
 *
suµ_p
=(suµl›r_ˆ*)
suµ
;

477 ià(
å
 =ğ
NULL
)

478 
å
 = 
	`´št_´•
(
SUPP
, 
mode
);

480 
	`PR_STRT
(
å
);

481 
	`PR_INT
(
å
, 
suµ_p
->
suµkey
);

482 
	`PR_STR
(
å
, 
suµ_p
->
Çme
, 
S_NAME_LEN
);

484 
	`PR_VSTR
(
å
, 
suµ_p
->
add»ss
,

485 (
cŞumÇr
)?()(
	`û
(
S_ADDR_LEN
 * 
V_STR_HGH
)):
suµ_p
->
®’
);

486 
	`PR_STR
(
å
, 
suµ_p
->
c™y
, 
CITY_FIX
);

487 
	`PR_STR
(
å
, 
suµ_p
->
ÇtiÚ_Çme
, 
C_NATION_NAME_LEN
);

488 
	`PR_STR
(
å
, 
suµ_p
->
»giÚ_Çme
, 
C_REGION_NAME_LEN
);

489 
	`PR_STR
(
å
, 
suµ_p
->
phÚe
, 
PHONE_LEN
);

490 
	`PR_END
(
å
);

493 
	}
}

496 
	$´_suµ
(*
suµ
, 
mode
)

498 
FILE
 *
å
 = 
NULL
;

499 
suµl›r_t
 *
suµ_p
=(suµl›r_ˆ*)
suµ
;

501 ià(
å
 =ğ
NULL
)

502 
å
 = 
	`´št_´•
(
SUPP
, 
mode
);

504 
	`PR_STRT
(
å
);

505 
	`PR_INT
(
å
, 
suµ_p
->
suµkey
);

506 
	`PR_STR
(
å
, 
suµ_p
->
Çme
, 
S_NAME_LEN
);

507 
	`PR_VSTR
(
å
, 
suµ_p
->
add»ss
,

508 (
cŞumÇr
)?()(
	`û
(
S_ADDR_LEN
 * 
V_STR_HGH
)):
suµ_p
->
®’
);

509 
	`PR_INT
(
å
, 
suµ_p
->
ÇtiÚ_code
);

510 
	`PR_STR
(
å
, 
suµ_p
->
phÚe
, 
PHONE_LEN
);

511 
	`PR_MONEY
(
å
, 
suµ_p
->
acùb®
);

512 
	`PR_VSTR_LAST
(
å
, 
suµ_p
->
comm’t
,

513 (
cŞumÇr
)?()(
	`û
(
S_CMNT_LEN
 * 
V_STR_HGH
)):
suµ_p
->
ş’
);

514 
	`PR_END
(
å
);

517 
	}
}

520 #ifdeà
SSBM


523 
	$´_ÇtiÚ
(*
c
, 
mode
)

525 
FILE
 *
å
 = 
NULL
;

526 
code_t
 *
ı
=(code_ˆ*)
c
;

527 ià(
å
 =ğ
NULL
)

528 
å
 = 
	`´št_´•
(
NATION
, 
mode
);

530 
	`PR_STRT
(
å
);

531 
	`PR_INT
(
å
, 
ı
->
code
);

532 
	`PR_STR
(
å
, 
ı
->
‹xt
, 
NATION_LEN
);

533 
	`PR_INT
(
å
, 
ı
->
još
);

534 
	`PR_VSTR_LAST
(
å
, 
ı
->
comm’t
, 
code_t
 *ı=(code_ˆ*)
c
;

536 (
cŞumÇr
)?()(
	`û
(
N_CMNT_LEN
 * 
V_STR_HGH
)):
ı
->
ş’
);

537 
	`PR_END
(
å
);

540 
	}
}

543 
	$´_»giÚ
(*
c
, 
mode
)

545 
FILE
 *
å
 = 
NULL
;

546 
code_t
 *
ı
=(code_ˆ*)
c
;

548 ià(
å
 =ğ
NULL
)

549 
å
 = 
	`´št_´•
(
REGION
, 
mode
);

551 
	`PR_STRT
(
å
);

552 
	`PR_INT
(
å
, 
ı
->
code
);

553 
	`PR_STR
(
å
, 
ı
->
‹xt
, 
REGION_LEN
);

554 
	`PR_VSTR_LAST
(
å
, 
ı
->
comm’t
,

555 (
cŞumÇr
)?()(
	`û
(
R_CMNT_LEN
 * 
V_STR_HGH
)):
ı
->
ş’
);

556 
	`PR_END
(
å
);

559 
	}
}

569 
	$´_d¿nge
(
tbl
, 
mš
, 
út
, 
num
)

571 
Ï¡_num
 = 0;

572 
FILE
 *
då
 = 
NULL
;

573 
chd
 = -1;

574 
¡¬t
, 
Ï¡
, 
ªew
;

576 
rows_³r_£gm’t
=0;

577 
rows_this_£gm’t
=0;

578 
»sidu®_rows
=0;

580 ià(
Ï¡_num
 !ğ
num
)

582 ià(
då
)

583 
	`fşo£
(
då
);

584 
då
 = 
	`´št_´•
(
tbl
, -
num
);

585 ià(
då
 =ğ
NULL
)

587 
Ï¡_num
 = 
num
;

588 
rows_this_£gm’t
=0;

591 
¡¬t
 = 
	`MK_SPARSE
(
mš
, (
num
 - 1)/ (10000 / 
»äesh
));

592 
Ï¡
 = 
¡¬t
 - 1;

593 
chd
=
mš
; 
út
 > 0; child++, cnt--)

595 
ªew
 = 
	`MK_SPARSE
(
chd
, (
num
 - 1è/ (10000 / 
»äesh
));

596 ià(
g’_ºg
 =ğ1 && 
ªew
 - 
Ï¡
 == 1)

598 
Ï¡
 = 
ªew
;

601 ià(
g’_sql
)

603 
	`årštf
(
då
,

605 
tdefs
[
ORDER
].
Çme
, "o_Üd”key", 
¡¬t
, 
Ï¡
);

606 
	`årštf
(
då
,

608 
tdefs
[
LINE
].
Çme
, "l_Üd”key", 
¡¬t
, 
Ï¡
);

609 
	`årštf
(
då
, "commit work;\n");

612 ià(
g’_ºg
)

614 
	`PR_STRT
(
då
);

615 
	`PR_INT
(
då
, 
¡¬t
);

616 
	`PR_INT
(
då
, 
Ï¡
);

617 
	`PR_END
(
då
);

621 ià(
d–‘e_£gm’ts
)

623 if(
rows_³r_£gm’t
==0)

625 
rows_³r_£gm’t
 = (
út
 / 
d–‘e_£gm’ts
);

626 
»sidu®_rows
 = (
út
 % 
d–‘e_£gm’ts
);

627 
rows_³r_£gm’t
++;

629 if(
d–‘e_£gm’t
 <ğ
»sidu®_rows
)

631 if((++
rows_this_£gm’t
è> 
rows_³r_£gm’t
)

633 
	`fşo£
(
då
);

634 
då
 = 
	`´št_´•
(
tbl
, -
num
);

635 ià(
då
 =ğ
NULL
) (-1);

636 
Ï¡_num
 = 
num
;

637 
rows_this_£gm’t
=1;

642 if((++
rows_this_£gm’t
è>ğ
rows_³r_£gm’t
)

644 
	`fşo£
(
då
);

645 
då
 = 
	`´št_´•
(
tbl
, -
num
);

646 ià(
då
 =ğ
NULL
) (-1);

647 
Ï¡_num
 = 
num
;

648 
rows_this_£gm’t
=1;

652 
	`PR_STRT
(
då
);

653 
	`PR_KEY
(
då
, 
ªew
);

654 
	`PR_END
(
då
);

656 
¡¬t
 = 
ªew
;

657 
Ï¡
 = 
ªew
;

659 ià(
g’_ºg
)

661 
	`PR_STRT
(
då
);

662 
	`PR_INT
(
då
, 
¡¬t
);

663 
	`PR_INT
(
då
, 
Ï¡
);

664 
	`PR_END
(
då
);

668 
	}
}

670 #ifdeà
SSBM


671 
	$´_d©e
(*
d
, ){

672 
FILE
 *
d_å
 = 
NULL
;

673 
d©e_t
 *
dp
=(d©e_ˆ*)
d
;

674 ià(
d_å
 =ğ
NULL
)

675 
d_å
 = 
	`´št_´•
(
DATE
, 0);

677 
	`PR_STRT
(
d_å
);

678 
	`PR_INT
(
d_å
, 
dp
->
d©ekey
);

679 
	`PR_STR
(
d_å
, 
dp
->
d©e
,
D_DATE_LEN
);

680 
	`PR_STR
(
d_å
, 
dp
->
dayofw“k
,
D_DAYWEEK_LEN
);

681 
	`PR_STR
(
d_å
, 
dp
->
mÚth
,
D_MONTH_LEN
);

682 
	`PR_INT
(
d_å
, 
dp
->
y—r
);

683 
	`PR_INT
(
d_å
, 
dp
->
y—rmÚthnum
);

684 
	`PR_STR
(
d_å
, 
dp
->
y—rmÚth
,
D_YEARMONTH_LEN
);

685 
	`PR_INT
(
d_å
, 
dp
->
daynumšw“k
);

686 
	`PR_INT
(
d_å
, 
dp
->
daynumšmÚth
);

687 
	`PR_INT
(
d_å
, 
dp
->
daynumšy—r
);

688 
	`PR_INT
(
d_å
, 
dp
->
mÚthnumšy—r
);

689 
	`PR_INT
(
d_å
, 
dp
->
w“knumšy—r
);

690 
	`PR_VSTR
(
d_å
,

691 
dp
->
£Îšg£asÚ
,(
cŞumÇr
)?()
D_SEASON_LEN
:dp->
¦’
);

692 
	`PR_STR
(
d_å
,
dp
->
Ï¡dayšw“kæ
,2);

693 
	`PR_STR
(
d_å
,
dp
->
Ï¡dayšmÚthæ
,2);

694 
	`PR_STR
(
d_å
,
dp
->
hŞidayæ
,2);

695 
	`PR_STR
(
d_å
,
dp
->
w“kdayæ
,2);

697 
	`PR_END
(
d_å
);

700 
	}
}

708 #ifdeà
SSBM


710 
	$vrf_cu¡
(*
c
, )

712 
cu¡om”_t
 *
ı
=(cu¡om”_ˆ*)
c
;

713 
	`VRF_STRT
(
CUST
);

714 
	`VRF_INT
(
CUST
, 
ı
->
cu¡key
);

715 
	`VRF_STR
(
CUST
, 
ı
->
Çme
);

716 
	`VRF_STR
(
CUST
, 
ı
->
add»ss
);

717 
	`VRF_STR
(
CUST
, 
ı
->
c™y
);

718 
	`VRF_STR
(
CUST
, 
ı
->
ÇtiÚ_Çme
);

719 
	`VRF_STR
(
CUST
, 
ı
->
»giÚ_Çme
);

720 
	`VRF_STR
(
CUST
, 
ı
->
phÚe
);

721 
	`VRF_STR
(
CUST
, 
ı
->
mkt£gm’t
);

722 
	`VRF_END
(
CUST
);

725 
	}
}

729 
	$vrf_cu¡
(*
c
, 
mode
)

731 
cu¡om”_t
 *
ı
=(cu¡om”_ˆ*)
c
;

732 
	`VRF_STRT
(
CUST
);

733 
	`VRF_INT
(
CUST
, 
ı
->
cu¡key
);

734 
	`VRF_STR
(
CUST
, 
ı
->
Çme
);

735 
	`VRF_STR
(
CUST
, 
ı
->
add»ss
);

736 
	`VRF_INT
(
CUST
, 
ı
->
ÇtiÚ_code
);

737 
	`VRF_STR
(
CUST
, 
ı
->
phÚe
);

738 
	`VRF_MONEY
(
CUST
, 
ı
->
acùb®
);

739 
	`VRF_STR
(
CUST
, 
ı
->
mkt£gm’t
);

740 
	`VRF_STR
(
CUST
, 
ı
->
comm’t
);

741 
	`VRF_END
(
CUST
);

744 
	}
}

750 #ifdeà
SSBM


753 
	$vrf_Üd”
(*
o
, 
mode
)

755 
Üd”_t
 *
o
=(order_t *)o;

756 
	`VRF_STRT
(
ORDER
);

757 
	`VRF_HUGE
(
ORDER
, 
İ
->
okey
);

758 
	`VRF_INT
(
ORDER
, 
İ
->
cu¡key
);

759 
	`VRF_CHR
(
ORDER
, 
İ
->
Üd”¡©us
);

760 
	`VRF_MONEY
(
ORDER
, 
İ
->
tÙ®´iû
);

761 
	`VRF_STR
(
ORDER
, 
İ
->
od©e
);

762 
	`VRF_STR
(
ORDER
, 
İ
->
İriÜ™y
);

763 
	`VRF_STR
(
ORDER
, 
İ
->
ş”k
);

764 
	`VRF_INT
(
ORDER
, 
İ
->
¥riÜ™y
);

765 
	`VRF_STR
(
ORDER
, 
İ
->
comm’t
);

766 
	`VRF_END
(
ORDER
);

769 
	}
}

775 #ifdeà
SSBM


777 
	$vrf_lše
(*
o
, )

779 
Üd”_t
 * 
İ
 =(Üd”_ˆ*)
o
;

780 
i
;

782 
i
 = 0; i < 
İ
->
lšes
; i++)

784 
	`VRF_STRT
(
LINE
);

785 
	`VRF_HUGE
(
LINE
, 
İ
->
lšeÜd”s
[
i
].
okey
);

786 
	`VRF_INT
(
LINE
, 
İ
->
lšeÜd”s
[
i
].
lš’umb”
);

787 
	`VRF_INT
(
LINE
, 
İ
->
lšeÜd”s
[
i
].
cu¡key
);

788 
	`VRF_INT
(
LINE
, 
İ
->
lšeÜd”s
[
i
].
·¹key
);

789 
	`VRF_INT
(
LINE
, 
İ
->
lšeÜd”s
[
i
].
suµkey
);

790 
	`VRF_STR
(
LINE
, 
İ
->
lšeÜd”s
[
i
].
Üd”d©e
);

791 
	`VRF_STR
(
LINE
, 
İ
->
lšeÜd”s
[
i
].
İriÜ™y
);

792 
	`VRF_INT
(
LINE
, 
İ
->
lšeÜd”s
[
i
].
sh_´iÜ™y
);

793 
	`VRF_INT
(
LINE
, 
İ
->
lšeÜd”s
[
i
].
quªt™y
);

794 
	`VRF_INT
(
LINE
, 
İ
->
lšeÜd”s
[
i
].
ex‹nded_´iû
);

795 
	`VRF_INT
(
LINE
, 
İ
->
lšeÜd”s
[
i
].
Üd”_tÙ®´iû
);

796 
	`VRF_INT
(
LINE
, 
İ
->
lšeÜd”s
[
i
].
discouÁ
);

797 
	`VRF_INT
(
LINE
, 
İ
->
lšeÜd”s
[
i
].
»v’ue
);

798 
	`VRF_INT
(
LINE
, 
İ
->
lšeÜd”s
[
i
].
suµ_co¡
);

799 
	`VRF_INT
(
LINE
, 
İ
->
lšeÜd”s
[
i
].
x
);

800 
	`VRF_STR
(
LINE
, 
İ
->
lšeÜd”s
[
i
].
comm™_d©e
);

801 
	`VRF_STR
(
LINE
, 
İ
->
lšeÜd”s
[
i
].
shmode
);

802 
	`VRF_END
(
LINE
);

806 
	}
}

810 
	$vrf_lše
(*
o
, 
mode
)

812 
Üd”_t
 *
İ
=(Üd”_ˆ*)
o
;

813 
i
;

815 
i
 = 0; i < 
İ
->
lšes
; i++)

817 
	`VRF_STRT
(
LINE
);

818 
	`VRF_HUGE
(
LINE
, 
İ
->
l
[
i
].
okey
);

819 
	`VRF_INT
(
LINE
, 
İ
->
l
[
i
].
·¹key
);

820 
	`VRF_INT
(
LINE
, 
İ
->
l
[
i
].
suµkey
);

821 
	`VRF_INT
(
LINE
, 
İ
->
l
[
i
].
lút
);

822 
	`VRF_INT
(
LINE
, 
İ
->
l
[
i
].
quªt™y
);

823 
	`VRF_MONEY
(
LINE
, 
İ
->
l
[
i
].
•riû
);

824 
	`VRF_MONEY
(
LINE
, 
İ
->
l
[
i
].
discouÁ
);

825 
	`VRF_MONEY
(
LINE
, 
İ
->
l
[
i
].
x
);

826 
	`VRF_CHR
(
LINE
, 
İ
->
l
[
i
].
ræag
[0]);

827 
	`VRF_CHR
(
LINE
, 
İ
->
l
[
i
].
l¡©us
[0]);

828 
	`VRF_STR
(
LINE
, 
İ
->
l
[
i
].
sd©e
);

829 
	`VRF_STR
(
LINE
, 
İ
->
l
[
i
].
cd©e
);

830 
	`VRF_STR
(
LINE
, 
İ
->
l
[
i
].
rd©e
);

831 
	`VRF_STR
(
LINE
, 
İ
->
l
[
i
].
shš¡ruù
);

832 
	`VRF_STR
(
LINE
, 
İ
->
l
[
i
].
shmode
);

833 
	`VRF_STR
(
LINE
, 
İ
->
l
[
i
].
comm’t
);

834 
	`VRF_END
(
LINE
);

838 
	}
}

844 #ifdeà
SSBM


847 
	$vrf_Üd”_lše
(*
o
, 
mode
)

849 
Üd”_t
 *
İ
=(Üd”_ˆ*)
o
;

850 
	`vrf_Üd”
(
İ
, 
mode
);

851 
	`vrf_lše
(
İ
, 
mode
);

854 
	}
}

860 #ifdeà
SSBM


862 
	$vrf_·¹
(*
·¹
, )

864 
·¹_t
 *
·¹_p
=Õ¬t_t*)
·¹
;

865 
	`VRF_STRT
(
PART
);

866 
	`VRF_INT
(
PART
, 
·¹_p
->
·¹key
);

867 
	`VRF_STR
(
PART
, 
·¹_p
->
Çme
);

868 
	`VRF_STR
(
PART
, 
·¹_p
->
mfgr
);

869 
	`VRF_STR
(
PART
, 
·¹_p
->
b¿nd
);

870 
	`VRF_STR
(
PART
, 
·¹_p
->
ty³
);

871 
	`VRF_INT
(
PART
, 
·¹_p
->
size
);

872 
	`VRF_STR
(
PART
, 
·¹_p
->
cÚš”
);

873 
	`VRF_STR
(
PART
, 
·¹_p
->
ÿ‹gÜy
);

874 
	`VRF_END
(
PART
);

877 
	}
}

881 
	$vrf_·¹
(*
·¹
, 
mode
)

883 
·¹_t
 *
·¹_p
=Õ¬t_t*)
·¹
;

884 
	`VRF_STRT
(
PART
);

885 
	`VRF_INT
(
PART
, 
·¹_p
->
·¹key
);

886 
	`VRF_STR
(
PART
, 
·¹_p
->
Çme
);

887 
	`VRF_STR
(
PART
, 
·¹_p
->
mfgr
);

888 
	`VRF_STR
(
PART
, 
·¹_p
->
b¿nd
);

889 
	`VRF_STR
(
PART
, 
·¹_p
->
ty³
);

890 
	`VRF_INT
(
PART
, 
·¹_p
->
size
);

891 
	`VRF_STR
(
PART
, 
·¹_p
->
cÚš”
);

892 
	`VRF_MONEY
(
PART
, 
·¹_p
->
»´iû
);

893 
	`VRF_STR
(
PART
, 
·¹_p
->
comm’t
);

894 
	`VRF_END
(
PART
);

897 
	}
}

903 #ifdeà
SSBM


906 
	$vrf_psuµ
(*
·¹
, 
mode
)

908 
·¹_t
 *
·¹_p
=Õ¬t_t*)
·¹
;

909 
i
;

911 
i
 = 0; i < 
SUPP_PER_PART
; i++)

913 
	`VRF_STRT
(
PSUPP
);

914 
	`VRF_INT
(
PSUPP
, 
·¹_p
->
s
[
i
].
·¹key
);

915 
	`VRF_INT
(
PSUPP
, 
·¹_p
->
s
[
i
].
suµkey
);

916 
	`VRF_INT
(
PSUPP
, 
·¹_p
->
s
[
i
].
qty
);

917 
	`VRF_MONEY
(
PSUPP
, 
·¹_p
->
s
[
i
].
sco¡
);

918 
	`VRF_STR
(
PSUPP
, 
·¹_p
->
s
[
i
].
comm’t
);

919 
	`VRF_END
(
PSUPP
);

923 
	}
}

929 #ifdeà
SSBM


932 
	$vrf_·¹_psuµ
(*
·¹
, 
mode
)

934 
·¹_t
 *
·¹
=Õ¬t_ˆ*)
·¹_p
;

935 
	`vrf_·¹
(
·¹_p
, 
mode
);

936 
	`vrf_psuµ
(
·¹_p
, 
mode
);

939 
	}
}

942 #ifdeà
SSBM


944 
	$vrf_suµ
(*
suµ
, )

946 
suµl›r_t
* 
suµ_p
=(suµl›r_t*)
suµ
;

947 
	`VRF_STRT
(
SUPP
);

948 
	`VRF_INT
(
SUPP
, 
suµ_p
->
suµkey
);

949 
	`VRF_STR
(
SUPP
, 
suµ_p
->
Çme
);

951 
	`VRF_STR
(
CUST
, 
suµ_p
->
add»ss
);

952 
	`VRF_STR
(
CUST
, 
suµ_p
->
ÇtiÚ_Çme
);

953 
	`VRF_INT
(
CUST
, 
suµ_p
->
»giÚ_key
);

954 
	`VRF_STR
(
CUST
, 
suµ_p
->
»giÚ_Çme
);

955 
	`VRF_STR
(
CUST
, 
suµ_p
->
phÚe
);

956 
	`VRF_END
(
SUPP
);

959 
	}
}

963 
	$vrf_suµ
(*
suµ
, 
mode
)

965 
suµl›r_t
 *
suµ_p
=(suµl›r_t*)
suµ
;

966 
	`VRF_STRT
(
SUPP
);

967 
	`VRF_INT
(
SUPP
, 
suµ_p
->
suµkey
);

968 
	`VRF_STR
(
SUPP
, 
suµ_p
->
Çme
);

969 
	`VRF_STR
(
SUPP
, 
suµ_p
->
add»ss
);

970 
	`VRF_INT
(
SUPP
, 
suµ_p
->
ÇtiÚ_code
);

971 
	`VRF_STR
(
SUPP
, 
suµ_p
->
phÚe
);

972 
	`VRF_MONEY
(
SUPP
, 
suµ_p
->
acùb®
);

973 
	`VRF_STR
(
SUPP
, 
suµ_p
->
comm’t
);

974 
	`VRF_END
(
SUPP
);

977 
	}
}

980 #ifdeà
SSBM


983 
	$vrf_ÇtiÚ
(*
c
, 
mode
)

985 
code_t
*
ı
=(code_t*)
c
;

986 
	`VRF_STRT
(
NATION
);

987 
	`VRF_INT
(
NATION
, 
ı
->
code
);

988 
	`VRF_STR
(
NATION
, 
ı
->
‹xt
);

989 
	`VRF_INT
(
NATION
, 
ı
->
još
);

990 
	`VRF_STR
(
NATION
, 
ı
->
comm’t
);

991 
	`VRF_END
(
NATION
);

994 
	}
}

997 
	$vrf_»giÚ
(*
c
, 
mode
)

999 
code_t
*
ı
=(code_t*)
c
;

1000 
	`VRF_STRT
(
REGION
);

1001 
	`VRF_INT
(
REGION
, 
ı
->
code
);

1002 
	`VRF_STR
(
REGION
, 
ı
->
‹xt
);

1003 
	`VRF_STR
(
REGION
, 
ı
->
comm’t
);

1004 
	`VRF_END
(
å
);

1007 
	}
}

1011 #ifdeà
SSBM


1012 
	$vrf_d©e
(* 
d
, )

1014 
d©e_t
 * 
dp
 = (d©e_t*)
d
;

1015 
	`VRF_STRT
(
DATE
);

1016 
	`VRF_INT
(
DATE
, 
dp
->
d©ekey
);

1017 
	`VRF_STR
(
DATE
, 
dp
->
d©e
);

1018 
	`VRF_STR
(
DATE
, 
dp
->
dayofw“k
);

1019 
	`VRF_STR
(
DATE
, 
dp
->
mÚth
);

1020 
	`VRF_INT
(
DATE
, 
dp
->
y—r
);

1021 
	`VRF_INT
(
DATE
, 
dp
->
y—rmÚthnum
);

1022 
	`VRF_STR
(
DATE
, 
dp
->
y—rmÚth
);

1023 
	`VRF_INT
(
DATE
, 
dp
->
daynumšw“k
);

1024 
	`VRF_INT
(
DATE
, 
dp
->
daynumšmÚth
);

1025 
	`VRF_INT
(
DATE
, 
dp
->
daynumšy—r
);

1026 
	`VRF_INT
(
DATE
, 
dp
->
mÚthnumšy—r
);

1027 
	`VRF_INT
(
DATE
, 
dp
->
w“knumšy—r
);

1028 
	`VRF_STR
(
DATE
, 
dp
->
£Îšg£asÚ
);

1029 
	`VRF_STR
(
DATE
, 
dp
->
Ï¡dayšw“kæ
);

1030 
	`VRF_STR
(
DATE
, 
dp
->
Ï¡dayšmÚthæ
);

1031 
	`VRF_STR
(
DATE
, 
dp
->
w“kdayæ
);

1032 
	`VRF_END
(
DATE
);

1035 
	}
}

1038 
EXIT_NAMESPACE
(
dbg’ssb
)

	@src/workload/ssb/dbgen/ssb_rnd.cpp

15 
	~"wÜklßd/ssb/dbg’/cÚfig.h
"

16 
	~<¡dio.h
>

17 
	~<m©h.h
>

18 
	~"wÜklßd/ssb/dbg’/dss.h
"

19 
	~"wÜklßd/ssb/dbg’/ºd.h
"

21 
	$ENTER_NAMESPACE
(
dbg’ssb
)

23 *
’v_cÚfig
 
	`PROTO
((*
g
, *
dæt
));

24 
	`NthEËm’t
(, *);

27 
	$dss_¿ndom
(*
tgt
, 
low”
, 
uµ”
, 
¡»am
)

29 *
tgt
 = 
	`UnifIÁ
(()
low”
, ()
uµ”
, ()
¡»am
);

30 
S“d
[
¡»am
].
u§ge
 += 1;

33 
	}
}

36 
row_¡¬t
() \

38 
	gi
;

39 
	gi
=0; i <ğ
MAX_STREAM
; i++)

40 
	gS“d
[
i
].
	gu§ge
 = 0 ;

46 
row_¡İ
(
t
) \

48 
	gi
;

51 ià(
	gt
 =ğ
ORDER_LINE
)

52 
t
 = 
ORDER
;

53 ià(
	gt
 =ğ
PART_PSUPP
)

54 
t
 = 
PART
;

56 
	gi
=0; i <ğ
MAX_STREAM
; i++)

57 ià((
	gS“d
[
i
].
	gbË
 =ğ
t
è|| (
S“d
[i].
bË
 =ğ
tdefs
[t].
chd
))

59 ià(
£t_£eds
 && (
S“d
[
i
].
u§ge
 > S“d[i].
bound¬y
))

61 
årštf
(
¡d”r
, "\nSEED CHANGE: seed[%d].usage = %d\n",

62 
i
, 
S“d
[i].
u§ge
);

63 
	gS“d
[
i
].
	gbound¬y
 = 
S“d
[i].
u§ge
;

67 
NthEËm’t
((
S“d
[
i
].
bound¬y
 - S“d[i].
u§ge
), &S“d[i].
v®ue
);

74 
	$dump_£eds
(
tbl
)

76 
i
;

78 
i
=0; i <ğ
MAX_STREAM
; i++)

79 ià(
S“d
[
i
].
bË
 =ğ
tbl
)

80 
	`´štf
("%d:\t%ld\n", 
i
, 
S“d
[i].
v®ue
);

82 
	}
}

94 
	$NextRªd
(
nS“d
)

146 
nU
, 
nV
;

148 
nU
 = 
nS“d
 / 
nQ
;

149 
nV
 = 
nS“d
 - 
nQ
 * 
nU
;

150 
nS“d
 = 
nA
 * 
nV
 - 
nU
 * 
nR
;

151 ià(
nS“d
 < 0)

152 
nS“d
 +ğ
nM
;

153  (
nS“d
);

154 
	}
}

166 
	$UnifIÁ
(
nLow
, 
nHigh
, 
nSŒ—m
)

175 
dRªge
;

176 
nTemp
;

178 ià(
nSŒ—m
 < 0 ||‚SŒ—m > 
MAX_STREAM
)

179 
nSŒ—m
 = 0;

181 ià(
nLow
 > 
nHigh
)

183 
nTemp
 = 
nLow
;

184 
nLow
 = 
nHigh
;

185 
nHigh
 = 
nTemp
;

188 
dRªge
 = 
	`DOUBLE_CAST
 (
nHigh
 - 
nLow
 + 1);

189 
S“d
[
nSŒ—m
].
v®ue
 = 
	`NextRªd
(Seed[nStream].value);

190 
nTemp
 = (è(((è
S“d
[
nSŒ—m
].
v®ue
 / 
dM
è* (
dRªge
));

191  (
nLow
 + 
nTemp
);

192 
	}
}

206 
	$UnifR—l
(
dLow
, 
dHigh
, 
nSŒ—m
)

215 
dTemp
;

217 ià(
nSŒ—m
 < 0 ||‚SŒ—m > 
MAX_STREAM
)

218 
nSŒ—m
 = 0;

219 ià(
dLow
 =ğ
dHigh
)

220  (
dLow
);

221 ià(
dLow
 > 
dHigh
)

223 
dTemp
 = 
dLow
;

224 
dLow
 = 
dHigh
;

225 
dHigh
 = 
dTemp
;

227 
S“d
[
nSŒ—m
].
v®ue
 = 
	`NextRªd
(Seed[nStream].value);

228 
dTemp
 = ((è
S“d
[
nSŒ—m
].
v®ue
 / 
dM
è* (
dHigh
 - 
dLow
);

229  (
dLow
 + 
dTemp
);

230 
	}
}

244 
	$ExpÚ’tŸl
(
dM—n
, 
nSŒ—m
)

254 
dTemp
;

256 ià(
nSŒ—m
 < 0 ||‚SŒ—m > 
MAX_STREAM
)

257 
nSŒ—m
 = 0;

258 ià(
dM—n
 <= 0.0)

261 
S“d
[
nSŒ—m
].
v®ue
 = 
	`NextRªd
(Seed[nStream].value);

262 
dTemp
 = (è
S“d
[
nSŒ—m
].
v®ue
 / 
dM
;

263  (-
dM—n
 * 
	`log
(1.0 - 
dTemp
));

264 
	}
}

266 
EXIT_NAMESPACE
(
dbg’ssb
)

	@src/workload/ssb/dbgen/ssb_speed_seed.cpp

2 
	~<¡dio.h
>

3 
	~<¡dlib.h
>

4 
	~"wÜklßd/ssb/dbg’/dss.h
"

6 
ENTER_NAMESPACE
(
dbg’ssb
);

10 
	#FAKE_V_STR
(
avg
, 
sd
, 
út
) \

11 
	`ADVANCE_STREAM
(
sd
, \

12 ()(
S“d
[
sd
].
bound¬y
*
út
))

	)

13 
	#ADVANCE_STREAM
(
¡»am_id
, 
num_ÿÎs
) \

14 
	`NthEËm’t
(
num_ÿÎs
, &
S“d
[
¡»am_id
].
v®ue
)

	)

16 
	#MAX_COLOR
 92

	)

17 
	gÇme_b™s
[
MAX_COLOR
 / 
BITS_PER_LONG
];

18 
£ed_t
 
S“d
[];

27 
DSS_HUGE
 
	gMuÉl›r
 = 16807;

28 
DSS_HUGE
 
	gModulus
 = 2147483647;

48 #ifdeà
SUPPORT_64BITS


49 
	$NthEËm’t
 (
N
, *
S¹S“d
)

51 
DSS_HUGE
 
Z
;

52 
DSS_HUGE
 
MuÉ
;

53 
Ê
=-1;

54 
i
;

56 ià((
v”bo£
 > 0è&& ++
Ê
 % 1000 == 0)

58 
i
 = 
Ê
 % 
LN_CNT
;

59 
	`årštf
(
¡d”r
, "%c\b", 
Êoi£
[
i
]);

61 
MuÉ
 = 
MuÉl›r
;

62 
Z
 = (
DSS_HUGE
è*
S¹S“d
;

63 
N
 > 0 )

65 ià(
N
 % 2 != 0)

66 
Z
 = (
MuÉ
 * Zè% 
Modulus
;

67 
N
 = N / 2;

68 
MuÉ
 = (MuÉ * MuÉè% 
Modulus
;

70 *
S¹S“d
 = ()
Z
;

73 
	}
}

89 
	~<m©h.h
>

90 
	~<¡dio.h
>

92 sigÃd 
	tRND
;

93 
	tURND
;

95 
	#F©®E¼Ü
(
e
è
	`F_F©®E¼Ü
ĞÓ), 
__FILE__
, 
__LINE__
 )

	)

96 
	$F_F©®E¼Ü
Ğ, * , è{
	`årštf
(
¡d”r
, "Bªg!\n");
	}
}

100 
RND
 
RND_£ed
( RND );

101 
RND
 
RND_shiá
( RND, RND );

102 
RND
 
RND_ModMuÉ
( RND, RND );

106 
RND


107 
	$RND_£ed
 ( 
RND
 
Ord”
 )

109 cÚ¡ 
RND
 
TİMask
 = 0x40000000;

110 
RND
 
Mask
;

111 
RND
 
ResuÉ
;

114 ià(
Ord”
 <ğ-
Modulus
 || Order >= Modulus)

115 
	`F©®E¼Ü
(1023);

117 ià(
Ord”
 < 0èOrd” = 
Modulus
 - 1L + Order;

119 
Mask
 = 
TİMask
;

120 
ResuÉ
 = 1L;

122 
Mask
 > 
Ord”
) Mask >>= 1;

124 
Mask
 > 0)

126 ià(
Mask
 & 
Ord”
)

128 
ResuÉ
 = 
	`RND_ModMuÉ
( Result, Result);

129 
ResuÉ
 = 
	`RND_ModMuÉ
ĞResuÉ, 
MuÉl›r
 );

133 
ResuÉ
 = 
	`RND_ModMuÉ
( Result, Result );

135 
Mask
 >>= 1;

138  (
ResuÉ
);

140 
	}
}

151 
	$NthEËm’t
 ( 
Shiá
, *
S“d
)

154 
RND
 
Pow”
;

155 
Ê
=-1;

156 
i
;

158 ià((
v”bo£
 > 0è&& ++
Ê
 % 100 == 0)

160 
i
 = (
Ê
/100è% 
LN_CNT
;

161 
	`årštf
(
¡d”r
, "%c\b", 
Êoi£
[
i
]);

165 ià(*
S“d
 <ğ0 || *S“d >ğ
Modulus
)

166 
	`F©®E¼Ü
(1023);

167 ià(
Shiá
 <ğ-
Modulus
 || Shift >= Modulus)

168 
	`F©®E¼Ü
(1023);

170 
Pow”
 = 
	`RND_£ed
Ğ
Shiá
 );

172 *
S“d
 = 
	`RND_ModMuÉ
Ğ*S“d, 
Pow”
 );

175 
	}
}

185 
RND


186 
	$RND_ModMuÉ
 ( 
RND
 
nA
, RND 
nB
)

190 cÚ¡ 
dTwoPowPlus31
 = 2147483648.;

191 cÚ¡ 
dTwoPowMšus31
 = 1./2147483648.;

192 cÚ¡ 
dTwoPowPlus15
 = 32768.;

193 cÚ¡ 
dTwoPowMšus15
 = 1./32768.;

194 cÚ¡ 
RND
 
nLowMask
 = 0xFFFFL;

195 cÚ¡ 
URND
 
ulB™31
 = 1uL << 31;

197 
dAH
, 
dAL
, 
dX
, 
dY
, 
dZ
, 
dW
;

198 
RND
 
nH
, 
nL
;

199 
URND
 
ulP
, 
ulQ
, 
ulResuÉ
;

201 
nL
 = 
nB
 & 
nLowMask
;

202 
nH
 = (
nB
 - 
nL
) >> 16;

203 
dAH
 = ()
nA
 * ()
nH
;

204 
dAL
 = ()
nA
 * ()
nL
;

205 
dX
 = 
	`æoÜ
Ğ
dAH
 * 
dTwoPowMšus15
 );

206 
dY
 = 
dAH
 - 
dX
*
dTwoPowPlus15
;

207 
dZ
 = 
	`æoÜ
Ğ
dAL
 * 
dTwoPowMšus31
 );

208 
dW
 = 
dAL
 - 
dZ
*
dTwoPowPlus31
;

210 
ulQ
 = (
URND
)
dW
 + ((URND)
dY
 << 16);

211 
ulP
 = (
URND
)
dX
 + (URND)
dZ
;

212 ià(
ulQ
 & 
ulB™31
è{ ulQ -ğulB™31; 
ulP
++; }

214 
ulResuÉ
 = 
ulP
 + 
ulQ
;

215 ià(
ulResuÉ
 & 
ulB™31
) { ulResult -= ulBit31; ulResult++; }

217  (
RND
)
ulResuÉ
;

218 
	}
}

223 
	$çke_a_ºd
(
mš
, 
max
, 
cŞumn
)

225 
Ën
, 
™couÁ
;

226 
	`RANDOM
(
Ën
, ()
mš
, ()
max
, ()
cŞumn
);

227 ià(
Ën
 % 5L == 0)

228 
™couÁ
 = 
Ën
/5;

229 
™couÁ
 = 
Ën
/5 + 1L;

230 
	`NthEËm’t
(
™couÁ
, &
S“d
[
cŞumn
].
u§ge
);

232 
	}
}

236 
	$sd_·¹
(, 
sk_couÁ
)

238 
i
;

240 
i
=
P_MFG_SD
; i<ğ
P_CNTR_SD
; i++)

241 
	`ADVANCE_STREAM
(
i
, 
sk_couÁ
);

243 
	`FAKE_V_STR
(
P_CMNT_LEN
, 
P_CMNT_SD
, 
sk_couÁ
);

244 
	`ADVANCE_STREAM
(
P_NAME_SD
, 
sk_couÁ
 * 92);

247 
	}
}

250 
	$sd_lše
(
chd
, 
sk_couÁ
)

252 
i
,
j
;

254 
j
=0; j < 
O_LCNT_MAX
; j++)

256 
i
=
L_QTY_SD
; i<ğ
L_RFLG_SD
; i++)

257 
	`ADVANCE_STREAM
(
i
, 
sk_couÁ
);

260 
	`FAKE_V_STR
(
L_CMNT_LEN
, 
L_CMNT_SD
, 
sk_couÁ
);

262 ià(
chd
 == 1)

264 
	`ADVANCE_STREAM
(
O_ODATE_SD
, 
sk_couÁ
);

265 
	`ADVANCE_STREAM
(
O_LCNT_SD
, 
sk_couÁ
);

269 
	}
}

272 
	$sd_Üd”
(, 
sk_couÁ
)

274 
	`ADVANCE_STREAM
(
O_LCNT_SD
, 
sk_couÁ
);

275 
	`ADVANCE_STREAM
(
O_CKEY_SD
, 
sk_couÁ
);

276 
	`FAKE_V_STR
(
O_CMNT_LEN
, 
O_CMNT_SD
, 
sk_couÁ
);

277 
	`ADVANCE_STREAM
(
O_SUPP_SD
, 
sk_couÁ
);

278 
	`ADVANCE_STREAM
(
O_CLRK_SD
, 
sk_couÁ
);

279 
	`ADVANCE_STREAM
(
O_PRIO_SD
, 
sk_couÁ
);

280 
	`ADVANCE_STREAM
(
O_ODATE_SD
, 
sk_couÁ
);

283 
	}
}

286 
	$sd_psuµ
(, 
sk_couÁ
)

288 
j
;

290 
j
=0; j < 
SUPP_PER_PART
; j++)

292 
	`ADVANCE_STREAM
(
PS_QTY_SD
, 
sk_couÁ
);

293 
	`ADVANCE_STREAM
(
PS_SCST_SD
, 
sk_couÁ
);

295 
	`FAKE_V_STR
(
PS_CMNT_LEN
, 
PS_CMNT_SD
, 
sk_couÁ
);

298 
	}
}

301 
	$sd_cu¡
(, 
sk_couÁ
)

304 
	`FAKE_V_STR
(
C_ADDR_LEN
, 
C_ADDR_SD
, 
sk_couÁ
);

305 
	`FAKE_V_STR
(
C_CMNT_LEN
, 
C_CMNT_SD
, 
sk_couÁ
);

306 
	`ADVANCE_STREAM
(
C_NTRG_SD
, 
sk_couÁ
);

307 
	`ADVANCE_STREAM
(
C_PHNE_SD
, 3L * 
sk_couÁ
);

308 
	`ADVANCE_STREAM
(
C_ABAL_SD
, 
sk_couÁ
);

309 
	`ADVANCE_STREAM
(
C_MSEG_SD
, 
sk_couÁ
);

311 
	}
}

314 
	$sd_suµ
(, 
sk_couÁ
)

316 
	`ADVANCE_STREAM
(
S_NTRG_SD
, 
sk_couÁ
);

317 
	`ADVANCE_STREAM
(
S_PHNE_SD
, 3L * 
sk_couÁ
);

318 
	`ADVANCE_STREAM
(
S_ABAL_SD
, 
sk_couÁ
);

319 
	`FAKE_V_STR
(
S_ADDR_LEN
, 
S_ADDR_SD
, 
sk_couÁ
);

320 
	`FAKE_V_STR
(
S_CMNT_LEN
, 
S_CMNT_SD
, 
sk_couÁ
);

321 
	`ADVANCE_STREAM
(
BBB_CMNT_SD
, 
sk_couÁ
);

322 
	`ADVANCE_STREAM
(
BBB_JNK_SD
, 
sk_couÁ
);

323 
	`ADVANCE_STREAM
(
BBB_OFFSET_SD
, 
sk_couÁ
);

324 
	`ADVANCE_STREAM
(
BBB_TYPE_SD
, 
sk_couÁ
);

327 
	}
}

329 
EXIT_NAMESPACE
(
dbg’ssb
);

	@src/workload/ssb/dbgen/ssb_text.cpp

9 #ifdeà
TEST


10 
	#DECLARER


	)

13 
	~"wÜklßd/ssb/dbg’/cÚfig.h
"

14 
	~<¡dlib.h
>

15 #ià(
defšed
(
_POSIX_
)||!defšed(
WIN32
))

19 
	~<¡dio.h
>

20 
	~<lim™s.h
>

21 
	~<m©h.h
>

22 
	~<ùy³.h
>

23 
	~<sigÇl.h
>

24 
	~<¡ršg.h
>

25 
	~<”ºo.h
>

26 #ifdeà
HP


27 
	~<¡ršgs.h
>

29 #ià(
defšed
(
WIN32
)&&!defšed(
_POSIX_
))

30 
	~<´oûss.h
>

31 #´agm¨
w¬nšg
(
di§bË
:4201)

32 #´agm¨
w¬nšg
(
di§bË
:4214)

33 #´agm¨
w¬nšg
(
di§bË
:4514)

34 
	#WIN32_LEAN_AND_MEAN


	)

35 
	#NOATOM


	)

36 
	#NOGDICAPMASKS


	)

37 
	#NOMETAFILE


	)

38 
	#NOMINMAX


	)

39 
	#NOMSG


	)

40 
	#NOOPENFILE


	)

41 
	#NORASTEROPS


	)

42 
	#NOSCROLL


	)

43 
	#NOSOUND


	)

44 
	#NOSYSMETRICS


	)

45 
	#NOTEXTMETRIC


	)

46 
	#NOWH


	)

47 
	#NOCOMM


	)

48 
	#NOKANJI


	)

49 
	#NOMCX


	)

50 
	~<wšdows.h
>

51 #´agm¨
w¬nšg
(:4201)

52 #´agm¨
w¬nšg
(:4214)

55 
	~"wÜklßd/ssb/dbg’/dss.h
"

56 
	~"wÜklßd/ssb/dbg’/ds¡y³s.h
"

58 
ENTER_NAMESPACE
(
dbg’ssb
);

73 
	$txt_vp
(*
de¡
, 
sd
)

75 
syÁax
[
MAX_GRAMMAR_LEN
 + 1],

76 *
ıŒ
,

77 *
·r£_rg‘
;

78 
di¡ributiÚ
 *
¤c
;

79 
i
,

80 
»s
 = 0;

83 
	`pick_¡r
(&
vp
, 
sd
, &
syÁax
[0]);

84 
·r£_rg‘
 = 
syÁax
;

85 (
ıŒ
 = 
	`¡¹ok
(
·r£_rg‘
, " ")è!ğ
NULL
)

87 
¤c
 = 
NULL
;

88 *
ıŒ
)

91 
¤c
 = &
adv”bs
;

94 
¤c
 = &
v”bs
;

97 
¤c
 = &
auxÏr›s
;

100 
i
 = 
	`pick_¡r
(
¤c
, 
sd
, 
de¡
);

101 
i
 = 
	`¡¾’
(
	`DIST_MEMBER
(
¤c
, i));

102 
de¡
 +ğ
i
;

103 
»s
 +ğ
i
;

104 ià(*(++
ıŒ
))

106 
de¡
 += 1;

107 
»s
 += 1;

108 *
de¡
 = *
ıŒ
;

110 *
de¡
 = ' ';

111 
de¡
++;

112 
»s
++;

113 
·r£_rg‘
 = 
NULL
;

116 (
»s
);

117 
	}
}

132 
	$txt_Å
(*
de¡
, 
sd
)

134 
syÁax
[
MAX_GRAMMAR_LEN
 + 1],

135 *
ıŒ
,

136 *
·r£_rg‘
;

137 
di¡ributiÚ
 *
¤c
;

138 
i
,

139 
»s
 = 0;

142 
	`pick_¡r
(&
Å
, 
sd
, &
syÁax
[0]);

143 
·r£_rg‘
 = 
syÁax
;

144 (
ıŒ
 = 
	`¡¹ok
(
·r£_rg‘
, " ")è!ğ
NULL
)

146 
¤c
 = 
NULL
;

147 *
ıŒ
)

150 
¤c
 = &
¬tişes
;

153 
¤c
 = &
adjeùives
;

156 
¤c
 = &
adv”bs
;

159 
¤c
 = &
nouns
;

162 
i
 = 
	`pick_¡r
(
¤c
, 
sd
, 
de¡
);

163 
i
 = 
	`¡¾’
(
	`DIST_MEMBER
(
¤c
, i));

164 
de¡
 +ğ
i
;

165 
»s
 +ğ
i
;

166 ià(*(++
ıŒ
))

168 *
de¡
 = *
ıŒ
;

169 
de¡
 += 1;

170 
»s
 += 1;

172 *
de¡
 = ' ';

173 
de¡
++;

174 
»s
++;

175 
·r£_rg‘
 = 
NULL
;

178 (
»s
);

179 
	}
}

194 
	$txt_£Á’û
(*
de¡
, 
sd
)

196 
syÁax
[
MAX_GRAMMAR_LEN
 + 1],

197 *
ıŒ
;

198 
i
,

199 
»s
 = 0,

200 
Ën
 = 0;

203 
	`pick_¡r
(&
g¿mm¬
, 
sd
, 
syÁax
);

204 
ıŒ
 = 
syÁax
;

206 
Ãxt_tok’
:

207 *
ıŒ
 && *cptr == ' ')

208 
ıŒ
++;

209 ià(*
ıŒ
 == '\0')

210 
dÚe
;

211 *
ıŒ
)

214 
Ën
 = 
	`txt_vp
(
de¡
, 
sd
);

217 
Ën
 = 
	`txt_Å
(
de¡
, 
sd
);

220 
i
 = 
	`pick_¡r
(&
´•os™iÚs
, 
sd
, 
de¡
);

221 
Ën
 = 
	`¡¾’
(
	`DIST_MEMBER
(&
´•os™iÚs
, 
i
));

222 
	`¡rıy
((
de¡
 + 
Ën
), "he ");

223 
Ën
 += 5;

224 
Ën
 +ğ
	`txt_Å
(
de¡
 +†’, 
sd
);

227 
i
 = 
	`pick_¡r
(&
‹rmš©Üs
, 
sd
, --
de¡
);

228 
Ën
 = 
	`¡¾’
(
	`DIST_MEMBER
(&
‹rmš©Üs
, 
i
));

231 
de¡
 +ğ
Ën
;

232 
»s
 +ğ
Ën
;

233 
ıŒ
++;

234 ià(*
ıŒ
 && *cptr != ' ')

236 
de¡
 += 1;

237 
»s
 += 1;

238 *
de¡
 = *
ıŒ
;

240 
Ãxt_tok’
;

241 
dÚe
:

242 *
de¡
 = '\0';

243 (--
»s
);

244 
	}
}

252 
	$dbg_‹xt
(*
tgt
, 
mš
, 
max
, 
sd
)

254 
Ëngth
 = 0;

255 
wÜdËn
 = 0,

256 
Ãeded
,

257 
s_Ën
;

258 
£Á’û
[
MAX_SENT_LEN
 + 1];

260 
	`RANDOM
(
Ëngth
, 
mš
, 
max
, 
sd
);

262 
wÜdËn
 < 
Ëngth
)

264 
s_Ën
 = 
	`txt_£Á’û
(
£Á’û
, 
sd
);

265 iàĞ
s_Ën
 < 0)

266 
	`INTERNAL_ERROR
("Bad sentence formation");

267 
Ãeded
 = 
Ëngth
 - 
wÜdËn
;

268 ià(
Ãeded
 >ğ
s_Ën
 + 1)

270 
	`¡rıy
(
tgt
, 
£Á’û
);

271 
tgt
 +ğ
s_Ën
;

272 
wÜdËn
 +ğ
s_Ën
 + 1;

273 *(
tgt
++) = ' ';

277 
£Á’û
[
Ãeded
] = '\0';

278 
	`¡rıy
(
tgt
, 
£Á’û
);

279 
wÜdËn
 +ğ
Ãeded
;

280 
tgt
 +ğ
Ãeded
;

283 *
tgt
 = '\0';

285 (
wÜdËn
);

286 
	}
}

288 #ifdeà
TEST


289 
tdef
 
	gtdefs
 = { 
NULL
 };

291 
	$maš_‹¡
(, **)

293 
´©e
[401];

295 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "nouns", &
nouns
);

296 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "v”bs", &
v”bs
);

297 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "adjeùives", &
adjeùives
);

298 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "adv”bs", &
adv”bs
);

299 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "auxÏr›s", &
auxÏr›s
);

300 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "‹rmš©Üs", &
‹rmš©Üs
);

301 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "¬tişes", &
¬tişes
);

302 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "´•os™iÚs", &
´•os™iÚs
);

303 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "g¿mm¬", &
g¿mm¬
);

304 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "Å", &
Å
);

305 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "vp", &
vp
);

309 
	`dbg_‹xt
(&
´©e
[0], 300, 400, 0);

310 
	`´štf
("<%s>\n", 
´©e
);

314 
	}
}

317 
EXIT_NAMESPACE
(
dbg’ssb
);

	@src/workload/ssb/qpipe/qpipe_q1_1.cpp

32 
	~"wÜklßd/ssb/shÜe_ssb_’v.h
"

33 
	~"qpe.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
usšg
 
Çme¥aû
 
	gqpe
;

40 
ENTER_NAMESPACE
(
ssb
);

63 
	sq11_lo_tu¶e


65 
	mLO_EXTENDEDPRICE
;

66 
	mLO_ORDERDATE
;

67 
	mLO_DISCOUNT
;

70 
	sq11_d_tu¶e


72 
	mD_DATEKEY
;

75 
	sq11_još_tu¶e


77 
	mLO_EXTENDEDPRICE
;

78 
	mLO_DISCOUNT
;

81 
	sq11_agg_tu¶e


83 
	mTOTAL_SUM
;

84 
	mREVENUE
;

92 
q11_agg_tu¶e
 
	t´ojeùed_tu¶e
;

95 şas 
	cq11_lšeÜd”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


97 
´iv©e
:

98 
ShÜeSSBEnv
* 
_ssbdb
;

99 
bË_row_t
* 
	m_´lše
;

100 
»p_row_t
 
	m_¼
;

102 
ssb_lšeÜd”_tu¶e
 
	m_lšeÜd”
;

105 
	mDISCOUNT_1
;

106 
	mDISCOUNT_2
;

107 
	mQUANTITY
;

109 
	mpublic
:

111 
	$q11_lšeÜd”_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
)

112 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

116 
_´lše
 = 
_ssbdb
->
	`lšeÜd”_mª
()->
	`g‘_tu¶e
();

117 
_¼
.
	`£t_ts
(
_ssbdb
->
	`lšeÜd”_mª
()->
	`ts
(),

118 
_ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
());

119 
_´lše
->
_»p
 = &
_¼
;

121 
DISCOUNT_1
=1;

122 
DISCOUNT_2
=3;

123 
QUANTITY
=25;

127 ~
	$q11_lšeÜd”_tsÿn_f‹r_t
()

130 
_ssbdb
->
	`lšeÜd”_mª
()->
	`give_tu¶e
(
_´lše
);

131 
	}
}

135 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

138 ià(!
_ssbdb
->
	`lšeÜd”_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

139 
	`as£¹
(
çl£
);

142 
_´lše
->
	`g‘_v®ue
(11, 
_lšeÜd”
.
LO_DISCOUNT
);

143 
_´lše
->
	`g‘_v®ue
(8, 
_lšeÜd”
.
LO_QUANTITY
);

145 ià(
_lšeÜd”
.
LO_DISCOUNT
>=
DISCOUNT_1
 && _lšeÜd”.LO_DISCOUNT<=
DISCOUNT_2
 && _lšeÜd”.
LO_QUANTITY
<
QUANTITY
)

147 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ DISCOUNT |%d QUANTITY |%d --d\n",

148 
_lšeÜd”
.
LO_DISCOUNT
, _lšeÜd”.
LO_QUANTITY
);

149  (
Œue
);

155  (
çl£
);

157 
	}
}

161 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

163 
q11_lo_tu¶e
 *
de¡
;

164 
de¡
 = 
®igÃd_ÿ¡
<
q11_lo_tu¶e
>(
d
.
d©a
);

166 
_´lše
->
	`g‘_v®ue
(5, 
_lšeÜd”
.
LO_ORDERDATE
);

167 
_´lše
->
	`g‘_v®ue
(9, 
_lšeÜd”
.
LO_EXTENDEDPRICE
);

168 
_´lše
->
	`g‘_v®ue
(11, 
_lšeÜd”
.
LO_DISCOUNT
);

171 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%d|%d --d\n",

172 
_lšeÜd”
.
LO_ORDERDATE
,

173 
_lšeÜd”
.
LO_EXTENDEDPRICE
,

174 
_lšeÜd”
.
LO_DISCOUNT
);

176 
de¡
->
LO_ORDERDATE
 = 
_lšeÜd”
.LO_ORDERDATE;

177 
de¡
->
LO_EXTENDEDPRICE
 = 
_lšeÜd”
.LO_EXTENDEDPRICE;

178 
de¡
->
LO_DISCOUNT
 = 
_lšeÜd”
.LO_DISCOUNT;

180 
	}
}

182 
q11_lšeÜd”_tsÿn_f‹r_t
* 
	$şÚe
() const {

183  
Ãw
 
	`q11_lšeÜd”_tsÿn_f‹r_t
(*
this
);

184 
	}
}

186 
c_¡r
 
	$to_¡ršg
() const {

187  
	`c_¡r
("q11_lineorder_tscan_filter_t()");

188 
	}
}

195 şas 
	cq11_d©e_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


197 
´iv©e
:

198 
ShÜeSSBEnv
* 
_ssbdb
;

199 
bË_row_t
* 
	m_´d©e
;

200 
»p_row_t
 
	m_¼
;

202 
ssb_d©e_tu¶e
 
	m_d©e
;

205 
	mYEAR
;

207 
	mpublic
:

209 
	$q11_d©e_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q1_1_šput_t
 &
š
)

210 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`d©e_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

214 
_´d©e
 = 
_ssbdb
->
	`d©e_mª
()->
	`g‘_tu¶e
();

215 
_¼
.
	`£t_ts
(
_ssbdb
->
	`d©e_mª
()->
	`ts
(),

216 
_ssbdb
->
	`d©e_desc
()->
	`maxsize
());

217 
_´d©e
->
_»p
 = &
_¼
;

219 
YEAR
=1993;

222 ~
	$q11_d©e_tsÿn_f‹r_t
()

225 
_ssbdb
->
	`d©e_mª
()->
	`give_tu¶e
(
_´d©e
);

226 
	}
}

230 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

233 ià(!
_ssbdb
->
	`d©e_mª
()->
	`lßd
(
_´d©e
, 
šput
.
d©a
)) {

234 
	`as£¹
(
çl£
);

237 
_´d©e
->
	`g‘_v®ue
(4, 
_d©e
.
D_YEAR
);

240 ià(
_d©e
.
D_YEAR
==
YEAR
)

242 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ YEAR |%d --d\n",

243 
_d©e
.
D_YEAR
);

244  (
Œue
);

248 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". YEAR |%d --d\n",

249 
_d©e
.
D_YEAR
);

250  (
çl£
);

253 
	}
}

257 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

259 
q11_d_tu¶e
 *
de¡
;

260 
de¡
 = 
®igÃd_ÿ¡
<
q11_d_tu¶e
>(
d
.
d©a
);

262 
_´d©e
->
	`g‘_v®ue
(0, 
_d©e
.
D_DATEKEY
);

264 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d --d\n",

265 
_d©e
.
D_DATEKEY
);

268 
de¡
->
D_DATEKEY
 = 
_d©e
.D_DATEKEY;

269 
	}
}

271 
q11_d©e_tsÿn_f‹r_t
* 
	$şÚe
() const {

272  
Ãw
 
	`q11_d©e_tsÿn_f‹r_t
(*
this
);

273 
	}
}

275 
c_¡r
 
	$to_¡ršg
() const {

276  
	`c_¡r
("q11_date_tscan_filter_t()");

277 
	}
}

282 
	gq11_još_t
 : 
public
 
tu¶e_još_t
 {

285 
q11_još_t
 ()

286 : 
tu¶e_još_t
((
q11_lo_tu¶e
),

287 
off£tof
(
q11_lo_tu¶e
, 
LO_ORDERDATE
),

288 (
q11_d_tu¶e
),

289 
off£tof
(
q11_d_tu¶e
, 
D_DATEKEY
),

291 (
q11_još_tu¶e
))

296 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

297 cÚ¡ 
tu¶e_t
 &
Ëá
,

298 cÚ¡ 
tu¶e_t
 &
right
)

301 
q11_lo_tu¶e
* 
	glo
 = 
®igÃd_ÿ¡
<q11_lo_tu¶e>(
Ëá
.
d©a
);

302 
q11_d_tu¶e
* 
	gd
 = 
®igÃd_ÿ¡
<q11_d_tu¶e>(
right
.
d©a
);

303 
q11_još_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q11_još_tu¶e>(
de¡
.
d©a
);

305 
	g»t
->
	gLO_EXTENDEDPRICE
 = 
lo
->
LO_EXTENDEDPRICE
;

306 
	g»t
->
	gLO_DISCOUNT
 = 
lo
->
LO_DISCOUNT
;

308 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN %d %d \n",
»t
->
LO_EXTENDEDPRICE
,„‘->
LO_DISCOUNT
);

312 
vœtu®
 
q11_još_t
* 
şÚe
() const {

313  
Ãw
 
q11_još_t
(*
this
);

316 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

322 
	gq11_agg»g©e
 : 
tu¶e_agg»g©e_t
 {

323 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

326 
q11_agg»g©e
()

327 : 
tu¶e_agg»g©e_t
((
q11_agg_tu¶e
)),

328 
_exŒaùÜ
(0, 0)

333 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
() {

334  &
	g_exŒaùÜ
;

336 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
t
) {

337 
q11_agg_tu¶e
* 
	gagg
 = 
®igÃd_ÿ¡
<q11_agg_tu¶e>(
agg_d©a
);

338 
q11_još_tu¶e
* 
	gtu¶e
 = 
®igÃd_ÿ¡
<q11_još_tu¶e>(
t
.
d©a
);

340 
	gv®ue
 = (
tu¶e
->
LO_EXTENDEDPRICE
 *u¶e->
LO_DISCOUNT
)/100;

341 
	gagg
->
	gTOTAL_SUM
 +ğ
v®ue
;

344 
vœtu®
 
fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

345 
q11_agg_tu¶e
* 
	gde¡
 = 
®igÃd_ÿ¡
<q11_agg_tu¶e>(
d
.
d©a
);

346 
q11_agg_tu¶e
* 
	gagg
 = 
®igÃd_ÿ¡
<q11_agg_tu¶e>(
agg_d©a
);

347 
	gde¡
->
	gREVENUE
 = 
agg
->
TOTAL_SUM
;

349 
vœtu®
 
q11_agg»g©e
* 
şÚe
() const {

350  
Ãw
 
q11_agg»g©e
(*
this
);

352 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

363 şas 
	cssb_q11_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


365 
public
:

367 
	$begš
() {

368 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** q1_1 ANSWER ...\n");

369 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** ...\n");

372 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

373 
´ojeùed_tu¶e
 *
tu¶e
;

374 
tu¶e
 = 
®igÃd_ÿ¡
<
´ojeùed_tu¶e
>(
ouut
.
d©a
);

375 
	`TRACE
 ( 
TRACE_QUERY_RESULTS
, "PROCESS %là\n",
tu¶e
->
REVENUE
);

378 
	}
}

389 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_qpe_q1_1
(cÚ¡ 
xù_id
,

390 
q1_1_šput_t
& 
š
)

392 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** q1_1 *********\n");

395 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

396 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

400 
tu¶e_fifo
* 
lo_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q11_lo_tu¶e
));

401 
tsÿn_·ck‘_t
* 
q11_lo_tsÿn_·ck‘
 =

402 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN LINEORDER",

403 
lo_out_bufãr
,

404 
Ãw
 
	`q11_lšeÜd”_tsÿn_f‹r_t
(
this
),

405 
this
->
	`db
(),

406 
_¶šeÜd”_desc
.
	`g‘
(),

407 
pxù


412 
tu¶e_fifo
* 
d_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q11_d_tu¶e
));

413 
tsÿn_·ck‘_t
* 
q11_d_tsÿn_·ck‘
 =

414 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN DATE",

415 
d_out_bufãr
,

416 
Ãw
 
	`q11_d©e_tsÿn_f‹r_t
(
this
,
š
),

417 
this
->
	`db
(),

418 
_pd©e_desc
.
	`g‘
(),

419 
pxù


426 
tu¶e_fifo
* 
još_out
 = 
Ãw
 
	`tu¶e_fifo
((
q11_još_tu¶e
));

427 
·ck‘_t
* 
q11_još_·ck‘
 =

428 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Date JOIN",

429 
još_out
,

430 
Ãw
 
	`ŒivŸl_f‹r_t
((
q11_još_tu¶e
)),

431 
q11_lo_tsÿn_·ck‘
,

432 
q11_d_tsÿn_·ck‘
,

433 
Ãw
 
	`q11_još_t
() );

436 
tu¶e_fifo
* 
q11_agg_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q11_agg_tu¶e
));

437 
·ck‘_t
* 
q11_agg_·ck‘
 = 
Ãw
 
	`agg»g©e_·ck‘_t
("AGG Q1_1",

438 
q11_agg_bufãr
,

439 
Ãw
 
	`ŒivŸl_f‹r_t
((
q11_agg_tu¶e
)),

440 
Ãw
 
	`q11_agg»g©e
(),

441 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
(0, 0),

442 
q11_još_·ck‘
);

445 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

446 
q11_lo_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

447 
q11_d_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

448 
q11_još_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

449 
q11_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

453 
ssb_q11_´oûss_tu¶e_t
 
±
;

454 
	`´oûss_qu”y
(
q11_agg_·ck‘
, 
±
);

455 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

457  (
RCOK
);

458 
	}
}

461 
EXIT_NAMESPACE
(
ssb
);

	@src/workload/ssb/qpipe/qpipe_q1_2.cpp

32 
	~"wÜklßd/ssb/shÜe_ssb_’v.h
"

33 
	~"qpe.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
usšg
 
Çme¥aû
 
	gqpe
;

40 
ENTER_NAMESPACE
(
ssb
);

62 
	sq12_lo_tu¶e


64 
	mLO_EXTENDEDPRICE
;

65 
	mLO_ORDERDATE
;

66 
	mLO_DISCOUNT
;

69 
	sq12_d_tu¶e


71 
	mD_DATEKEY
;

74 
	sq12_još_tu¶e


76 
	mLO_EXTENDEDPRICE
;

77 
	mLO_DISCOUNT
;

80 
	sq12_agg_tu¶e


82 
	mTOTAL_SUM
;

83 
	mREVENUE
;

91 
q12_agg_tu¶e
 
	t´ojeùed_tu¶e
;

95 şas 
	cq12_lšeÜd”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


97 
´iv©e
:

98 
ShÜeSSBEnv
* 
_ssbdb
;

99 
bË_row_t
* 
	m_´lše
;

100 
»p_row_t
 
	m_¼
;

102 
ssb_lšeÜd”_tu¶e
 
	m_lšeÜd”
;

105 
	mDISCOUNT_1
;

106 
	mDISCOUNT_2
;

107 
	mQUANTITY_1
;

108 
	mQUANTITY_2
;

110 
	mpublic
:

112 
	$q12_lšeÜd”_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
)

113 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

117 
_´lše
 = 
_ssbdb
->
	`lšeÜd”_mª
()->
	`g‘_tu¶e
();

118 
_¼
.
	`£t_ts
(
_ssbdb
->
	`lšeÜd”_mª
()->
	`ts
(),

119 
_ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
());

120 
_´lše
->
_»p
 = &
_¼
;

122 
DISCOUNT_1
=4;

123 
DISCOUNT_2
=6;

124 
QUANTITY_1
=26;

125 
QUANTITY_2
=35;

129 ~
	$q12_lšeÜd”_tsÿn_f‹r_t
()

132 
_ssbdb
->
	`lšeÜd”_mª
()->
	`give_tu¶e
(
_´lše
);

133 
	}
}

137 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

140 ià(!
_ssbdb
->
	`lšeÜd”_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

141 
	`as£¹
(
çl£
);

144 
_´lše
->
	`g‘_v®ue
(11, 
_lšeÜd”
.
LO_DISCOUNT
);

145 
_´lše
->
	`g‘_v®ue
(8, 
_lšeÜd”
.
LO_QUANTITY
);

147 ià(
_lšeÜd”
.
LO_DISCOUNT
>=
DISCOUNT_1
 && _lšeÜd”.LO_DISCOUNT<=
DISCOUNT_2
 && _lšeÜd”.
LO_QUANTITY
>=
QUANTITY_1
 && _lšeÜd”.LO_QUANTITY<=
QUANTITY_2
)

149 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ DISCOUNT |%d QUANTITY |%d --d\n",

150 
_lšeÜd”
.
LO_DISCOUNT
, _lšeÜd”.
LO_QUANTITY
);

151  (
Œue
);

155 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". DISCOUNT |%d QUANTITY |%d --d\n",

156 
_lšeÜd”
.
LO_DISCOUNT
, _lšeÜd”.
LO_QUANTITY
);

157  (
çl£
);

159 
	}
}

163 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

165 
q12_lo_tu¶e
 *
de¡
;

166 
de¡
 = 
®igÃd_ÿ¡
<
q12_lo_tu¶e
>(
d
.
d©a
);

168 
_´lše
->
	`g‘_v®ue
(5, 
_lšeÜd”
.
LO_ORDERDATE
);

169 
_´lše
->
	`g‘_v®ue
(9, 
_lšeÜd”
.
LO_EXTENDEDPRICE
);

170 
_´lše
->
	`g‘_v®ue
(11, 
_lšeÜd”
.
LO_DISCOUNT
);

173 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%d|%d --d\n",

174 
_lšeÜd”
.
LO_ORDERDATE
,

175 
_lšeÜd”
.
LO_EXTENDEDPRICE
,

176 
_lšeÜd”
.
LO_DISCOUNT
);

178 
de¡
->
LO_ORDERDATE
 = 
_lšeÜd”
.LO_ORDERDATE;

179 
de¡
->
LO_EXTENDEDPRICE
 = 
_lšeÜd”
.LO_EXTENDEDPRICE;

180 
de¡
->
LO_DISCOUNT
 = 
_lšeÜd”
.LO_DISCOUNT;

182 
	}
}

184 
q12_lšeÜd”_tsÿn_f‹r_t
* 
	$şÚe
() const {

185  
Ãw
 
	`q12_lšeÜd”_tsÿn_f‹r_t
(*
this
);

186 
	}
}

188 
c_¡r
 
	$to_¡ršg
() const {

189  
	`c_¡r
("q1_2_lineorder_tscan_filter_t()");

190 
	}
}

197 şas 
	cq12_d©e_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


199 
´iv©e
:

200 
ShÜeSSBEnv
* 
_ssbdb
;

201 
bË_row_t
* 
	m_´d©e
;

202 
»p_row_t
 
	m_¼
;

204 
ssb_d©e_tu¶e
 
	m_d©e
;

207 
	mYEARMONTHNUM
;

209 
	mpublic
:

211 
	$q12_d©e_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q1_2_šput_t
 &
š
)

212 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`d©e_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

216 
_´d©e
 = 
_ssbdb
->
	`d©e_mª
()->
	`g‘_tu¶e
();

217 
_¼
.
	`£t_ts
(
_ssbdb
->
	`d©e_mª
()->
	`ts
(),

218 
_ssbdb
->
	`d©e_desc
()->
	`maxsize
());

219 
_´d©e
->
_»p
 = &
_¼
;

221 
YEARMONTHNUM
=199401;

224 ~
	$q12_d©e_tsÿn_f‹r_t
()

227 
_ssbdb
->
	`d©e_mª
()->
	`give_tu¶e
(
_´d©e
);

228 
	}
}

232 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

235 ià(!
_ssbdb
->
	`d©e_mª
()->
	`lßd
(
_´d©e
, 
šput
.
d©a
)) {

236 
	`as£¹
(
çl£
);

239 
_´d©e
->
	`g‘_v®ue
(5, 
_d©e
.
D_YEARMONTHNUM
);

242 ià(
_d©e
.
D_YEARMONTHNUM
==
YEARMONTHNUM
)

244 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ YEARMONTHNUM |%d --d\n",

245 
_d©e
.
D_YEARMONTHNUM
);

246  (
Œue
);

250 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". YEARMONTHNUM |%d --d\n",

251 
_d©e
.
D_YEARMONTHNUM
);

252  (
çl£
);

255 
	}
}

259 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

261 
q12_d_tu¶e
 *
de¡
;

262 
de¡
 = 
®igÃd_ÿ¡
<
q12_d_tu¶e
>(
d
.
d©a
);

264 
_´d©e
->
	`g‘_v®ue
(0, 
_d©e
.
D_DATEKEY
);

266 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d --d\n",

267 
_d©e
.
D_DATEKEY
);

270 
de¡
->
D_DATEKEY
 = 
_d©e
.D_DATEKEY;

271 
	}
}

273 
q12_d©e_tsÿn_f‹r_t
* 
	$şÚe
() const {

274  
Ãw
 
	`q12_d©e_tsÿn_f‹r_t
(*
this
);

275 
	}
}

277 
c_¡r
 
	$to_¡ršg
() const {

278  
	`c_¡r
("q12_date_tscan_filter_t()");

279 
	}
}

284 
	gq12_još_t
 : 
public
 
tu¶e_još_t
 {

287 
q12_još_t
 ()

288 : 
tu¶e_još_t
((
q12_lo_tu¶e
),

289 
off£tof
(
q12_lo_tu¶e
, 
LO_ORDERDATE
),

290 (
q12_d_tu¶e
),

291 
off£tof
(
q12_d_tu¶e
, 
D_DATEKEY
),

293 (
q12_još_tu¶e
))

298 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

299 cÚ¡ 
tu¶e_t
 &
Ëá
,

300 cÚ¡ 
tu¶e_t
 &
right
)

303 
q12_lo_tu¶e
* 
	glo
 = 
®igÃd_ÿ¡
<q12_lo_tu¶e>(
Ëá
.
d©a
);

304 
q12_d_tu¶e
* 
	gd
 = 
®igÃd_ÿ¡
<q12_d_tu¶e>(
right
.
d©a
);

305 
q12_još_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q12_još_tu¶e>(
de¡
.
d©a
);

307 
	g»t
->
	gLO_EXTENDEDPRICE
 = 
lo
->
LO_EXTENDEDPRICE
;

308 
	g»t
->
	gLO_DISCOUNT
 = 
lo
->
LO_DISCOUNT
;

310 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN %d %d \n",
»t
->
LO_EXTENDEDPRICE
,„‘->
LO_DISCOUNT
);

314 
vœtu®
 
q12_još_t
* 
şÚe
() const {

315  
Ãw
 
q12_još_t
(*
this
);

318 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

354 
	gq12_agg»g©e
 : 
tu¶e_agg»g©e_t
 {

355 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

358 
q12_agg»g©e
()

359 : 
tu¶e_agg»g©e_t
((
q12_agg_tu¶e
)),

360 
_exŒaùÜ
(0, 0)

365 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
() {

366  &
	g_exŒaùÜ
;

368 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
t
) {

369 
q12_agg_tu¶e
* 
	gagg
 = 
®igÃd_ÿ¡
<q12_agg_tu¶e>(
agg_d©a
);

370 
q12_još_tu¶e
* 
	gtu¶e
 = 
®igÃd_ÿ¡
<q12_još_tu¶e>(
t
.
d©a
);

372 
	gv®ue
 = (
tu¶e
->
LO_EXTENDEDPRICE
 *u¶e->
LO_DISCOUNT
)/100;

373 
	gagg
->
	gTOTAL_SUM
 +ğ
v®ue
;

376 
vœtu®
 
fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

377 
q12_agg_tu¶e
* 
	gde¡
 = 
®igÃd_ÿ¡
<q12_agg_tu¶e>(
d
.
d©a
);

378 
q12_agg_tu¶e
* 
	gagg
 = 
®igÃd_ÿ¡
<q12_agg_tu¶e>(
agg_d©a
);

379 
	gde¡
->
	gREVENUE
 = 
agg
->
TOTAL_SUM
;

381 
vœtu®
 
q12_agg»g©e
* 
şÚe
() const {

382  
Ãw
 
q12_agg»g©e
(*
this
);

384 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

390 şas 
	cssb_q12_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


392 
public
:

394 
	$begš
() {

395 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** q1_2 ANSWER ...\n");

396 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** ...\n");

399 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

400 
´ojeùed_tu¶e
 *
tu¶e
;

402 
tu¶e
 = 
®igÃd_ÿ¡
<
´ojeùed_tu¶e
>(
ouut
.
d©a
);

403 
	`TRACE
 ( 
TRACE_QUERY_RESULTS
, "PROCESS %là\n", 
tu¶e
->
REVENUE
);

407 
	}
}

418 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_qpe_q1_2
(cÚ¡ 
xù_id
,

419 
q1_2_šput_t
& 
š
)

421 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** q1_2 *********\n");

424 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

425 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

429 
tu¶e_fifo
* 
lo_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q12_lo_tu¶e
));

430 
tsÿn_·ck‘_t
* 
lo_tsÿn_·ck‘
 =

431 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN LINEORDER",

432 
lo_out_bufãr
,

433 
Ãw
 
	`q12_lšeÜd”_tsÿn_f‹r_t
(
this
),

434 
this
->
	`db
(),

435 
_¶šeÜd”_desc
.
	`g‘
(),

436 
pxù


441 
tu¶e_fifo
* 
d_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q12_d_tu¶e
));

442 
tsÿn_·ck‘_t
* 
d_tsÿn_·ck‘
 =

443 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN DATE",

444 
d_out_bufãr
,

445 
Ãw
 
	`q12_d©e_tsÿn_f‹r_t
(
this
,
š
),

446 
this
->
	`db
(),

447 
_pd©e_desc
.
	`g‘
(),

448 
pxù


455 
tu¶e_fifo
* 
još_out
 = 
Ãw
 
	`tu¶e_fifo
((
q12_još_tu¶e
));

456 
·ck‘_t
* 
još_·ck‘
 =

457 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Date JOIN",

458 
još_out
,

459 
Ãw
 
	`ŒivŸl_f‹r_t
((
q12_još_tu¶e
)),

460 
lo_tsÿn_·ck‘
,

461 
d_tsÿn_·ck‘
,

462 
Ãw
 
	`q12_još_t
() );

466 
tu¶e_fifo
* 
q12_agg_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q12_agg_tu¶e
));

467 
·ck‘_t
* 
q12_agg_·ck‘
 = 
Ãw
 
	`agg»g©e_·ck‘_t
("AGG Q1_2",

468 
q12_agg_bufãr
,

469 
Ãw
 
	`ŒivŸl_f‹r_t
((
q12_agg_tu¶e
)),

470 
Ãw
 
	`q12_agg»g©e
(),

471 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
(0, 0),

472 
još_·ck‘
);

475 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

476 
lo_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

477 
d_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

478 
još_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

479 
q12_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

482 
ssb_q12_´oûss_tu¶e_t
 
±
;

484 
	`´oûss_qu”y
(
q12_agg_·ck‘
, 
±
);

485 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

487  (
RCOK
);

488 
	}
}

491 
EXIT_NAMESPACE
(
ssb
);

	@src/workload/ssb/qpipe/qpipe_q1_3.cpp

32 
	~"wÜklßd/ssb/shÜe_ssb_’v.h
"

33 
	~"qpe.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
usšg
 
Çme¥aû
 
	gqpe
;

40 
ENTER_NAMESPACE
(
ssb
);

61 
	sq13_lo_tu¶e


63 
	mLO_EXTENDEDPRICE
;

64 
	mLO_ORDERDATE
;

65 
	mLO_DISCOUNT
;

68 
	sq13_d_tu¶e


70 
	mD_DATEKEY
;

73 
	sq13_još_tu¶e


75 
	mLO_EXTENDEDPRICE
;

76 
	mLO_DISCOUNT
;

79 
	sq13_agg_tu¶e


81 
	mTOTAL_SUM
;

82 
	mREVENUE
;

91 
q13_agg_tu¶e
 
	t´ojeùed_tu¶e
;

94 şas 
	cq13_lšeÜd”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


96 
´iv©e
:

97 
ShÜeSSBEnv
* 
_ssbdb
;

98 
bË_row_t
* 
	m_´lše
;

99 
»p_row_t
 
	m_¼
;

101 
ssb_lšeÜd”_tu¶e
 
	m_lšeÜd”
;

104 
	mDISCOUNT_1
;

105 
	mDISCOUNT_2
;

106 
	mQUANTITY_1
;

107 
	mQUANTITY_2
;

109 
	mpublic
:

111 
	$q13_lšeÜd”_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
)

112 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

116 
_´lše
 = 
_ssbdb
->
	`lšeÜd”_mª
()->
	`g‘_tu¶e
();

117 
_¼
.
	`£t_ts
(
_ssbdb
->
	`lšeÜd”_mª
()->
	`ts
(),

118 
_ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
());

119 
_´lše
->
_»p
 = &
_¼
;

121 
DISCOUNT_1
=5;

122 
DISCOUNT_2
=7;

123 
QUANTITY_1
=26;

124 
QUANTITY_2
=35;

128 ~
	$q13_lšeÜd”_tsÿn_f‹r_t
()

131 
_ssbdb
->
	`lšeÜd”_mª
()->
	`give_tu¶e
(
_´lše
);

132 
	}
}

136 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

139 ià(!
_ssbdb
->
	`lšeÜd”_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

140 
	`as£¹
(
çl£
);

143 
_´lše
->
	`g‘_v®ue
(11, 
_lšeÜd”
.
LO_DISCOUNT
);

144 
_´lše
->
	`g‘_v®ue
(8, 
_lšeÜd”
.
LO_QUANTITY
);

146 ià(
_lšeÜd”
.
LO_DISCOUNT
>=
DISCOUNT_1
 && _lšeÜd”.LO_DISCOUNT<=
DISCOUNT_2
 && _lšeÜd”.
LO_QUANTITY
>=
QUANTITY_1
 && _lšeÜd”.LO_QUANTITY<=
QUANTITY_2
)

148 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ DISCOUNT |%d QUANTITY |%d --d\n",

149 
_lšeÜd”
.
LO_DISCOUNT
, _lšeÜd”.
LO_QUANTITY
);

150  (
Œue
);

154 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". DISCOUNT |%d QUANTITY |%d --d\n",

155 
_lšeÜd”
.
LO_DISCOUNT
, _lšeÜd”.
LO_QUANTITY
);

156  (
çl£
);

158 
	}
}

162 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

164 
q13_lo_tu¶e
 *
de¡
;

165 
de¡
 = 
®igÃd_ÿ¡
<
q13_lo_tu¶e
>(
d
.
d©a
);

167 
_´lše
->
	`g‘_v®ue
(5, 
_lšeÜd”
.
LO_ORDERDATE
);

168 
_´lše
->
	`g‘_v®ue
(9, 
_lšeÜd”
.
LO_EXTENDEDPRICE
);

169 
_´lše
->
	`g‘_v®ue
(11, 
_lšeÜd”
.
LO_DISCOUNT
);

172 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%d|%d --d\n",

173 
_lšeÜd”
.
LO_ORDERDATE
,

174 
_lšeÜd”
.
LO_EXTENDEDPRICE
,

175 
_lšeÜd”
.
LO_DISCOUNT
);

177 
de¡
->
LO_ORDERDATE
 = 
_lšeÜd”
.LO_ORDERDATE;

178 
de¡
->
LO_EXTENDEDPRICE
 = 
_lšeÜd”
.LO_EXTENDEDPRICE;

179 
de¡
->
LO_DISCOUNT
 = 
_lšeÜd”
.LO_DISCOUNT;

181 
	}
}

183 
q13_lšeÜd”_tsÿn_f‹r_t
* 
	$şÚe
() const {

184  
Ãw
 
	`q13_lšeÜd”_tsÿn_f‹r_t
(*
this
);

185 
	}
}

187 
c_¡r
 
	$to_¡ršg
() const {

188  
	`c_¡r
("q13_lineorder_tscan_filter_t()");

189 
	}
}

196 şas 
	cq13_d©e_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


198 
´iv©e
:

199 
ShÜeSSBEnv
* 
_ssbdb
;

200 
bË_row_t
* 
	m_´d©e
;

201 
»p_row_t
 
	m_¼
;

203 
ssb_d©e_tu¶e
 
	m_d©e
;

206 
	mYEAR
;

207 
	mWEEKNUMINYEAR
;

209 
	mpublic
:

211 
	$q13_d©e_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q1_3_šput_t
 &
š
)

212 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`d©e_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

216 
_´d©e
 = 
_ssbdb
->
	`d©e_mª
()->
	`g‘_tu¶e
();

217 
_¼
.
	`£t_ts
(
_ssbdb
->
	`d©e_mª
()->
	`ts
(),

218 
_ssbdb
->
	`d©e_desc
()->
	`maxsize
());

219 
_´d©e
->
_»p
 = &
_¼
;

221 
YEAR
=1994;

222 
WEEKNUMINYEAR
=6;

225 ~
	$q13_d©e_tsÿn_f‹r_t
()

228 
_ssbdb
->
	`d©e_mª
()->
	`give_tu¶e
(
_´d©e
);

229 
	}
}

233 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

236 ià(!
_ssbdb
->
	`d©e_mª
()->
	`lßd
(
_´d©e
, 
šput
.
d©a
)) {

237 
	`as£¹
(
çl£
);

240 
_´d©e
->
	`g‘_v®ue
(4, 
_d©e
.
D_YEAR
);

241 
_´d©e
->
	`g‘_v®ue
(11, 
_d©e
.
D_WEEKNUMINYEAR
);

244 ià(
_d©e
.
D_YEAR
==
YEAR
 && _d©e.
D_WEEKNUMINYEAR
==
WEEKNUMINYEAR
)

246 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ WEEKNUMINYEAR |%d YEAR |%d --d\n",

247 
_d©e
.
D_WEEKNUMINYEAR
, _d©e.
D_YEAR
);

248  (
Œue
);

252 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". WEEKNUMINYEAR |%d YEAR |%d --d\n",

253 
_d©e
.
D_WEEKNUMINYEAR
, _d©e.
D_YEAR
);

254  (
çl£
);

257 
	}
}

261 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

263 
q13_d_tu¶e
 *
de¡
;

264 
de¡
 = 
®igÃd_ÿ¡
<
q13_d_tu¶e
>(
d
.
d©a
);

266 
_´d©e
->
	`g‘_v®ue
(0, 
_d©e
.
D_DATEKEY
);

268 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d --d\n",

269 
_d©e
.
D_DATEKEY
);

272 
de¡
->
D_DATEKEY
 = 
_d©e
.D_DATEKEY;

273 
	}
}

275 
q13_d©e_tsÿn_f‹r_t
* 
	$şÚe
() const {

276  
Ãw
 
	`q13_d©e_tsÿn_f‹r_t
(*
this
);

277 
	}
}

279 
c_¡r
 
	$to_¡ršg
() const {

280  
	`c_¡r
("q13_date_tscan_filter_t()");

281 
	}
}

286 
	gq13_još_t
 : 
public
 
tu¶e_još_t
 {

289 
q13_još_t
 ()

290 : 
tu¶e_još_t
((
q13_lo_tu¶e
),

291 
off£tof
(
q13_lo_tu¶e
, 
LO_ORDERDATE
),

292 (
q13_d_tu¶e
),

293 
off£tof
(
q13_d_tu¶e
, 
D_DATEKEY
),

295 (
q13_još_tu¶e
))

300 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

301 cÚ¡ 
tu¶e_t
 &
Ëá
,

302 cÚ¡ 
tu¶e_t
 &
right
)

305 
q13_lo_tu¶e
* 
	glo
 = 
®igÃd_ÿ¡
<q13_lo_tu¶e>(
Ëá
.
d©a
);

306 
q13_d_tu¶e
* 
	gd
 = 
®igÃd_ÿ¡
<q13_d_tu¶e>(
right
.
d©a
);

307 
q13_još_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q13_još_tu¶e>(
de¡
.
d©a
);

309 
	g»t
->
	gLO_EXTENDEDPRICE
 = 
lo
->
LO_EXTENDEDPRICE
;

310 
	g»t
->
	gLO_DISCOUNT
 = 
lo
->
LO_DISCOUNT
;

312 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN %d %d \n",
»t
->
LO_EXTENDEDPRICE
,„‘->
LO_DISCOUNT
);

316 
vœtu®
 
q13_još_t
* 
şÚe
() const {

317  
Ãw
 
q13_još_t
(*
this
);

320 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

357 
	gq13_agg»g©e
 : 
tu¶e_agg»g©e_t
 {

358 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

361 
q13_agg»g©e
()

362 : 
tu¶e_agg»g©e_t
((
q13_agg_tu¶e
)),

363 
_exŒaùÜ
(0, 0)

368 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
() {

369  &
	g_exŒaùÜ
;

371 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
t
) {

372 
q13_agg_tu¶e
* 
	gagg
 = 
®igÃd_ÿ¡
<q13_agg_tu¶e>(
agg_d©a
);

373 
q13_još_tu¶e
* 
	gtu¶e
 = 
®igÃd_ÿ¡
<q13_još_tu¶e>(
t
.
d©a
);

375 
	gv®ue
 = (
tu¶e
->
LO_EXTENDEDPRICE
 *u¶e->
LO_DISCOUNT
)/100;

376 
	gagg
->
	gTOTAL_SUM
 +ğ
v®ue
;

379 
vœtu®
 
fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

380 
q13_agg_tu¶e
* 
	gde¡
 = 
®igÃd_ÿ¡
<q13_agg_tu¶e>(
d
.
d©a
);

381 
q13_agg_tu¶e
* 
	gagg
 = 
®igÃd_ÿ¡
<q13_agg_tu¶e>(
agg_d©a
);

382 
	gde¡
->
	gREVENUE
 = 
agg
->
TOTAL_SUM
;

384 
vœtu®
 
q13_agg»g©e
* 
şÚe
() const {

385  
Ãw
 
q13_agg»g©e
(*
this
);

387 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

396 şas 
	cssb_q13_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


398 
public
:

400 
	$begš
() {

401 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** q1_3 ANSWER ...\n");

402 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** ...\n");

405 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

406 
´ojeùed_tu¶e
 *
tu¶e
;

407 
tu¶e
 = 
®igÃd_ÿ¡
<
´ojeùed_tu¶e
>(
ouut
.
d©a
);

408 
	`TRACE
 ( 
TRACE_QUERY_RESULTS
, "PROCESS %là\n", 
tu¶e
->
REVENUE
);

411 
	}
}

422 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_qpe_q1_3
(cÚ¡ 
xù_id
,

423 
q1_3_šput_t
& 
š
)

425 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** q1_3 *********\n");

428 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

429 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

433 
tu¶e_fifo
* 
lo_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q13_lo_tu¶e
));

434 
tsÿn_·ck‘_t
* 
lo_tsÿn_·ck‘
 =

435 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN LINEORDER",

436 
lo_out_bufãr
,

437 
Ãw
 
	`q13_lšeÜd”_tsÿn_f‹r_t
(
this
),

438 
this
->
	`db
(),

439 
_¶šeÜd”_desc
.
	`g‘
(),

440 
pxù


445 
tu¶e_fifo
* 
d_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q13_d_tu¶e
));

446 
tsÿn_·ck‘_t
* 
d_tsÿn_·ck‘
 =

447 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN DATE",

448 
d_out_bufãr
,

449 
Ãw
 
	`q13_d©e_tsÿn_f‹r_t
(
this
,
š
),

450 
this
->
	`db
(),

451 
_pd©e_desc
.
	`g‘
(),

452 
pxù


459 
tu¶e_fifo
* 
još_out
 = 
Ãw
 
	`tu¶e_fifo
((
q13_još_tu¶e
));

460 
·ck‘_t
* 
još_·ck‘
 =

461 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Date JOIN",

462 
još_out
,

463 
Ãw
 
	`ŒivŸl_f‹r_t
((
q13_još_tu¶e
)),

464 
lo_tsÿn_·ck‘
,

465 
d_tsÿn_·ck‘
,

466 
Ãw
 
	`q13_još_t
() );

468 
tu¶e_fifo
* 
q13_agg_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q13_agg_tu¶e
));

469 
·ck‘_t
* 
q13_agg_·ck‘
 = 
Ãw
 
	`agg»g©e_·ck‘_t
("AGG Q1_3",

470 
q13_agg_bufãr
,

471 
Ãw
 
	`ŒivŸl_f‹r_t
((
q13_agg_tu¶e
)),

472 
Ãw
 
	`q13_agg»g©e
(),

473 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
(0, 0),

474 
još_·ck‘
);

478 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

479 
lo_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

480 
d_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

481 
još_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

482 
q13_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

486 
ssb_q13_´oûss_tu¶e_t
 
±
;

487 
	`´oûss_qu”y
(
q13_agg_·ck‘
, 
±
);

488 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

490  (
RCOK
);

491 
	}
}

494 
EXIT_NAMESPACE
(
ssb
);

	@src/workload/ssb/qpipe/qpipe_q2_1.cpp

32 
	~"wÜklßd/ssb/shÜe_ssb_’v.h
"

33 
	~"qpe.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
usšg
 
Çme¥aû
 
	gqpe
;

40 
ENTER_NAMESPACE
(
ssb
);

67 
	sq21_lo_tu¶e
 {

68 
	mLO_PARTKEY
;

69 
	mLO_SUPPKEY
;

70 
	mLO_ORDERDATE
;

71 
	mLO_REVENUE
;

74 
	sq21_p_tu¶e
 {

75 
	mP_PARTKEY
;

76 
	mP_BRAND
[10];

79 
	sq21_s_tu¶e
 {

80 
	mS_SUPPKEY
;

83 
	sq21_d_tu¶e
 {

84 
	mD_DATEKEY
;

85 
	mD_YEAR
;

88 
	sq21_još_s_tu¶e
 {

89 
	mLO_ORDERDATE
;

90 
	mLO_PARTKEY
;

91 
	mLO_REVENUE
;

94 
	sq21_još_s_p_tu¶e
 {

95 
	mLO_ORDERDATE
;

96 
	mP_BRAND
[10];

97 
	mLO_REVENUE
;

100 
	sq21_još_tu¶e
 {

101 
	mP_BRAND
[10];

102 
	mD_YEAR
;

103 
	mLO_REVENUE
;

106 
	sq21_agg»g©e_tu¶e
 {

107 
	mP_BRAND
[10];

108 
	mD_YEAR
;

109 
	mREVENUE
;

117 
q21_agg»g©e_tu¶e
 
	t´ojeùed_tu¶e
;

119 şas 
	cq21_lšeÜd”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t
 {

120 
´iv©e
:

121 
ShÜeSSBEnv
* 
_ssbdb
;

122 
bË_row_t
* 
	m_´lše
;

123 
»p_row_t
 
	m_¼
;

125 
ssb_lšeÜd”_tu¶e
 
	m_lšeÜd”
;

127 
	mpublic
:

129 
	$q21_lšeÜd”_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
)

130 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
) {

133 
_´lše
 = 
_ssbdb
->
	`lšeÜd”_mª
()->
	`g‘_tu¶e
();

134 
_¼
.
	`£t_ts
(
_ssbdb
->
	`lšeÜd”_mª
()->
	`ts
(),

135 
_ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
());

136 
_´lše
->
_»p
 = &
_¼
;

140 ~
	$q21_lšeÜd”_tsÿn_f‹r_t
() {

142 
_ssbdb
->
	`lšeÜd”_mª
()->
	`give_tu¶e
(
_´lše
);

143 
	}
}

148 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

151 ià(!
_ssbdb
->
	`lšeÜd”_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

152 
	`as£¹
(
çl£
);

155  (
Œue
);

156 
	}
}

161 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

163 
q21_lo_tu¶e
 *
de¡
;

164 
de¡
 = 
®igÃd_ÿ¡
<
q21_lo_tu¶e
 > (
d
.
d©a
);

166 
_´lše
->
	`g‘_v®ue
(3, 
_lšeÜd”
.
LO_PARTKEY
);

167 
_´lše
->
	`g‘_v®ue
(4, 
_lšeÜd”
.
LO_SUPPKEY
);

168 
_´lše
->
	`g‘_v®ue
(5, 
_lšeÜd”
.
LO_ORDERDATE
);

169 
_´lše
->
	`g‘_v®ue
(12, 
_lšeÜd”
.
LO_REVENUE
);

172 
	`TRACE
(
TRACE_RECORD_FLOW
, "%d|%d|%d|%d --d\n",

173 
_lšeÜd”
.
LO_PARTKEY
,

174 
_lšeÜd”
.
LO_SUPPKEY
,

175 
_lšeÜd”
.
LO_ORDERDATE
,

176 
_lšeÜd”
.
LO_REVENUE
);

178 
de¡
->
LO_PARTKEY
 = 
_lšeÜd”
.LO_PARTKEY;

179 
de¡
->
LO_SUPPKEY
 = 
_lšeÜd”
.LO_SUPPKEY;

180 
de¡
->
LO_ORDERDATE
 = 
_lšeÜd”
.LO_ORDERDATE;

181 
de¡
->
LO_REVENUE
 = 
_lšeÜd”
.LO_REVENUE;

183 
	}
}

185 
q21_lšeÜd”_tsÿn_f‹r_t
* 
	$şÚe
() const {

186  
Ãw
 
	`q21_lšeÜd”_tsÿn_f‹r_t
(*
this
);

187 
	}
}

189 
c_¡r
 
	$to_¡ršg
() const {

190  
	`c_¡r
("q21_lineorder_tscan_filter_t()");

191 
	}
}

194 şas 
	cq21_·¹_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t
 {

195 
´iv©e
:

196 
ShÜeSSBEnv
* 
_ssbdb
;

197 
bË_row_t
* 
	m_´·¹
;

198 
»p_row_t
 
	m_¼
;

200 
ssb_·¹_tu¶e
 
	m_·¹
;

203 
	mCATEGORY
[8];

204 
	mpublic
:

206 
	$q21_·¹_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q2_1_šput_t
 &
š
)

207 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`·¹_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
) {

210 
_´·¹
 = 
_ssbdb
->
	`·¹_mª
()->
	`g‘_tu¶e
();

211 
_¼
.
	`£t_ts
(
_ssbdb
->
	`·¹_mª
()->
	`ts
(),

212 
_ssbdb
->
	`·¹_desc
()->
	`maxsize
());

213 
_´·¹
->
_»p
 = &
_¼
;

216 
	`¡rıy
(
CATEGORY
, "MFGR#12");

219 ~
	$q21_·¹_tsÿn_f‹r_t
() {

221 
_ssbdb
->
	`·¹_mª
()->
	`give_tu¶e
(
_´·¹
);

222 
	}
}

227 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

230 ià(!
_ssbdb
->
	`·¹_mª
()->
	`lßd
(
_´·¹
, 
šput
.
d©a
)) {

231 
	`as£¹
(
çl£
);

234 
_´·¹
->
	`g‘_v®ue
(3, 
_·¹
.
P_CATEGORY
, 
	`STRSIZE
(7));

236 ià(
	`¡rcmp
(
_·¹
.
P_CATEGORY
, 
CATEGORY
) == 0) {

237 
	`TRACE
(
TRACE_RECORD_FLOW
, "+ CATEGORY |%s --d\n",

238 
_·¹
.
P_CATEGORY
);

239  (
Œue
);

241 
	`TRACE
(
TRACE_RECORD_FLOW
, ". CATEGORY |%s --d\n",

242 
_·¹
.
P_CATEGORY
);

243  (
çl£
);

245 
	}
}

250 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

252 
q21_p_tu¶e
 *
de¡
;

253 
de¡
 = 
®igÃd_ÿ¡
<
q21_p_tu¶e
 > (
d
.
d©a
);

255 
_´·¹
->
	`g‘_v®ue
(0, 
_·¹
.
P_PARTKEY
);

256 
_´·¹
->
	`g‘_v®ue
(4, 
_·¹
.
P_BRAND
, 
	`STRSIZE
(9));

258 
	`TRACE
(
TRACE_RECORD_FLOW
, "%d|%s --d\n",

259 
_·¹
.
P_PARTKEY
,

260 
_·¹
.
P_BRAND
);

263 
de¡
->
P_PARTKEY
 = 
_·¹
.P_PARTKEY;

264 
	`¡rıy
(
de¡
->
P_BRAND
, 
_·¹
.P_BRAND);

265 
	}
}

267 
q21_·¹_tsÿn_f‹r_t
* 
	$şÚe
() const {

268  
Ãw
 
	`q21_·¹_tsÿn_f‹r_t
(*
this
);

269 
	}
}

271 
c_¡r
 
	$to_¡ršg
() const {

272  
	`c_¡r
("q21_part_tscan_filter_t()");

273 
	}
}

276 şas 
	cq21_suµl›r_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t
 {

277 
´iv©e
:

278 
ShÜeSSBEnv
* 
_ssbdb
;

279 
bË_row_t
* 
	m_´suµ
;

280 
»p_row_t
 
	m_¼
;

282 
ssb_suµl›r_tu¶e
 
	m_suµl›r
;

285 
	mREGION
[13];

286 
	mpublic
:

288 
	$q21_suµl›r_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q2_1_šput_t
 &
š
)

289 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`suµl›r_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
) {

292 
_´suµ
 = 
_ssbdb
->
	`suµl›r_mª
()->
	`g‘_tu¶e
();

293 
_¼
.
	`£t_ts
(
_ssbdb
->
	`suµl›r_mª
()->
	`ts
(),

294 
_ssbdb
->
	`suµl›r_desc
()->
	`maxsize
());

295 
_´suµ
->
_»p
 = &
_¼
;

298 
	`¡rıy
(
REGION
, "AMERICA");

301 ~
	$q21_suµl›r_tsÿn_f‹r_t
() {

303 
_ssbdb
->
	`suµl›r_mª
()->
	`give_tu¶e
(
_´suµ
);

304 
	}
}

309 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

312 ià(!
_ssbdb
->
	`suµl›r_mª
()->
	`lßd
(
_´suµ
, 
šput
.
d©a
)) {

313 
	`as£¹
(
çl£
);

316 
_´suµ
->
	`g‘_v®ue
(5, 
_suµl›r
.
S_REGION
, 
	`STRSIZE
(12));

319 ià(
	`¡rcmp
(
_suµl›r
.
S_REGION
, 
REGION
) == 0) {

320 
	`TRACE
(
TRACE_RECORD_FLOW
, "+ REGION |%s --d\n",

321 
_suµl›r
.
S_REGION
);

322  (
Œue
);

324 
	`TRACE
(
TRACE_RECORD_FLOW
, ". REGION |%s --d\n",

325 
_suµl›r
.
S_REGION
);

326  (
çl£
);

328 
	}
}

333 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

335 
q21_s_tu¶e
 *
de¡
;

336 
de¡
 = 
®igÃd_ÿ¡
<
q21_s_tu¶e
 > (
d
.
d©a
);

338 
_´suµ
->
	`g‘_v®ue
(0, 
_suµl›r
.
S_SUPPKEY
);

340 
	`TRACE
(
TRACE_RECORD_FLOW
, "%d --d\n",

341 
_suµl›r
.
S_SUPPKEY
);

344 
de¡
->
S_SUPPKEY
 = 
_suµl›r
.S_SUPPKEY;

345 
	}
}

347 
q21_suµl›r_tsÿn_f‹r_t
* 
	$şÚe
() const {

348  
Ãw
 
	`q21_suµl›r_tsÿn_f‹r_t
(*
this
);

349 
	}
}

351 
c_¡r
 
	$to_¡ršg
() const {

352  
	`c_¡r
("q2_1_supplier_tscan_filter_t()");

353 
	}
}

356 şas 
	cq21_d©e_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t
 {

357 
´iv©e
:

358 
ShÜeSSBEnv
* 
_ssbdb
;

359 
bË_row_t
* 
	m_´d©e
;

360 
»p_row_t
 
	m_¼
;

362 
ssb_d©e_tu¶e
 
	m_d©e
;

365 
	mpublic
:

367 
	$q21_d©e_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q2_1_šput_t
 &
š
)

368 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`d©e_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
) {

371 
_´d©e
 = 
_ssbdb
->
	`d©e_mª
()->
	`g‘_tu¶e
();

372 
_¼
.
	`£t_ts
(
_ssbdb
->
	`d©e_mª
()->
	`ts
(),

373 
_ssbdb
->
	`d©e_desc
()->
	`maxsize
());

374 
_´d©e
->
_»p
 = &
_¼
;

378 ~
	$q21_d©e_tsÿn_f‹r_t
() {

380 
_ssbdb
->
	`d©e_mª
()->
	`give_tu¶e
(
_´d©e
);

381 
	}
}

386 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

389 ià(!
_ssbdb
->
	`d©e_mª
()->
	`lßd
(
_´d©e
, 
šput
.
d©a
)) {

390 
	`as£¹
(
çl£
);

393  (
Œue
);

394 
	}
}

399 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

401 
q21_d_tu¶e
 *
de¡
;

402 
de¡
 = 
®igÃd_ÿ¡
<
q21_d_tu¶e
 > (
d
.
d©a
);

404 
_´d©e
->
	`g‘_v®ue
(0, 
_d©e
.
D_DATEKEY
);

405 
_´d©e
->
	`g‘_v®ue
(4, 
_d©e
.
D_YEAR
);

407 
	`TRACE
(
TRACE_RECORD_FLOW
, "%d|%d --d\n",

408 
_d©e
.
D_DATEKEY
,

409 
_d©e
.
D_YEAR
);

412 
de¡
->
D_DATEKEY
 = 
_d©e
.D_DATEKEY;

413 
de¡
->
D_YEAR
 = 
_d©e
.D_YEAR;

414 
	}
}

416 
q21_d©e_tsÿn_f‹r_t
* 
	$şÚe
() const {

417  
Ãw
 
	`q21_d©e_tsÿn_f‹r_t
(*
this
);

418 
	}
}

420 
c_¡r
 
	$to_¡ršg
() const {

421  
	`c_¡r
("q21_date_tscan_filter_t()");

422 
	}
}

428 
	gq21_lo_s_još_t
 : 
public
 
tu¶e_još_t
 {

430 
q21_lo_s_još_t
()

431 : 
tu¶e_još_t
( (
q21_lo_tu¶e
),

432 
off£tof
(
q21_lo_tu¶e
, 
LO_SUPPKEY
),

433  (
q21_s_tu¶e
),

434 
off£tof
(
q21_s_tu¶e
, 
S_SUPPKEY
),

436  (
q21_još_s_tu¶e
)) {

439 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

440 cÚ¡ 
tu¶e_t
 &
Ëá
,

441 cÚ¡ 
tu¶e_t
 & 
right
) {

443 
q21_lo_tu¶e
* 
	glo
 = 
®igÃd_ÿ¡
<q21_lo_tu¶> (
Ëá
.
d©a
);

444 
q21_s_tu¶e
* 
	gs
 = 
®igÃd_ÿ¡
<q21_s_tu¶> (
right
.
d©a
);

445 
q21_još_s_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q21_još_s_tu¶> (
de¡
.
d©a
);

447 
	g»t
->
	gLO_ORDERDATE
 = 
lo
->
LO_ORDERDATE
;

448 
	g»t
->
	gLO_PARTKEY
 = 
lo
->
LO_PARTKEY
;

449 
	g»t
->
	gLO_REVENUE
 = 
lo
->
LO_REVENUE
;

452 
TRACE
(
TRACE_RECORD_FLOW
, "JOIN %d %d %d\n", 
»t
->
LO_ORDERDATE
,„‘->
LO_PARTKEY
,„‘->
LO_REVENUE
);

456 
vœtu®
 
q21_lo_s_još_t
 * 
şÚe
() const {

457  
Ãw
 
q21_lo_s_još_t
(*
this
);

460 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

468 
	gq21_lo_s_p_još_t
 : 
public
 
tu¶e_još_t
 {

470 
q21_lo_s_p_još_t
()

471 : 
tu¶e_još_t
( (
q21_još_s_tu¶e
),

472 
off£tof
(
q21_još_s_tu¶e
, 
LO_PARTKEY
),

473  (
q21_p_tu¶e
),

474 
off£tof
(
q21_p_tu¶e
, 
P_PARTKEY
),

476  (
q21_još_s_p_tu¶e
)) {

479 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

480 cÚ¡ 
tu¶e_t
 &
Ëá
,

481 cÚ¡ 
tu¶e_t
 & 
right
) {

483 
q21_još_s_tu¶e
* 
	gjo
 = 
®igÃd_ÿ¡
<q21_još_s_tu¶> (
Ëá
.
d©a
);

484 
q21_p_tu¶e
* 
	gp
 = 
®igÃd_ÿ¡
<q21_p_tu¶> (
right
.
d©a
);

485 
q21_još_s_p_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q21_još_s_p_tu¶> (
de¡
.
d©a
);

487 
	g»t
->
	gLO_ORDERDATE
 = 
jo
->
LO_ORDERDATE
;

488 
	g»t
->
	gLO_REVENUE
 = 
jo
->
LO_REVENUE
;

489 
¡rıy
(
»t
->
P_BRAND
, 
p
->P_BRAND);

491 
TRACE
(
TRACE_RECORD_FLOW
, "JOIN %d {%s} %d\n", 
»t
->
LO_ORDERDATE
,„‘->
P_BRAND
,„‘->
LO_REVENUE
);

495 
vœtu®
 
q21_lo_s_p_još_t
 * 
şÚe
() const {

496  
Ãw
 
q21_lo_s_p_još_t
(*
this
);

499 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

507 
	gq21_još_t
 : 
public
 
tu¶e_još_t
 {

509 
q21_još_t
()

510 : 
tu¶e_još_t
( (
q21_još_s_p_tu¶e
),

511 
off£tof
(
q21_još_s_p_tu¶e
, 
LO_ORDERDATE
),

512  (
q21_d_tu¶e
),

513 
off£tof
(
q21_d_tu¶e
, 
D_DATEKEY
),

515  (
q21_još_tu¶e
)) {

518 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

519 cÚ¡ 
tu¶e_t
 &
Ëá
,

520 cÚ¡ 
tu¶e_t
 & 
right
) {

522 
q21_još_s_p_tu¶e
* 
	gjo
 = 
®igÃd_ÿ¡
<q21_još_s_p_tu¶> (
Ëá
.
d©a
);

523 
q21_d_tu¶e
* 
	gd
 = 
®igÃd_ÿ¡
<q21_d_tu¶> (
right
.
d©a
);

524 
q21_još_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q21_još_tu¶> (
de¡
.
d©a
);

526 
¡rıy
(
»t
->
P_BRAND
, 
jo
->P_BRAND);

527 
	g»t
->
	gLO_REVENUE
 = 
jo
->
LO_REVENUE
;

528 
	g»t
->
	gD_YEAR
 = 
d
->
D_YEAR
;

531 
TRACE
(
TRACE_RECORD_FLOW
, "JOIN {%s} %d %d\n", 
»t
->
P_BRAND
,„‘->
D_YEAR
,„‘->
LO_REVENUE
);

535 
vœtu®
 
q21_još_t
 * 
şÚe
() const {

536  
Ãw
 
q21_još_t
(*
this
);

539 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

549 
	sq21_agg_šput_tu¶e_key
 {

550 
	mP_BRAND
[
STRSIZE
(9)];

551 
	mD_YEAR
;

553 
exŒaù_hšt
() {

554  (
	mthis
->
	mD_YEAR
 - 1990 << 24è+ (this->
	mP_BRAND
[5] << 16) + (this->P_BRAND[6] << 8) + (this->P_BRAND[7]);

558 
	gq21_agg_šput_tu¶e_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

560 
q21_agg_šput_tu¶e_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
( (
q21_agg_šput_tu¶e_key
), 
off£tof
(
q21_još_tu¶e
, 
P_BRAND
)) {

563 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

564 
q21_agg_šput_tu¶e_key
* 
	g®igÃd_key
 = 
®igÃd_ÿ¡
<q21_agg_šput_tu¶e_key > (
key
);

584  
	g®igÃd_key
->
exŒaù_hšt
();

589 
vœtu®
 
q21_agg_šput_tu¶e_key_exŒaùÜ_t
 * 
şÚe
() const {

590  
Ãw
 
q21_agg_šput_tu¶e_key_exŒaùÜ_t
(*
this
);

594 
	gq21_agg_šput_tu¶e_key_com·»_t
 : 
public
 
key_com·»_t
 {

596 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

597 
q21_agg_šput_tu¶e_key
* 
	ga
 = 
®igÃd_ÿ¡
<q21_agg_šput_tu¶e_key > (
key1
);

598 
q21_agg_šput_tu¶e_key
* 
	gb
 = 
®igÃd_ÿ¡
<q21_agg_šput_tu¶e_key > (
key2
);

600 
	gpb¿ndcom·risÚ
 = 
¡rcmp
(
a
->
P_BRAND
, 
b
->P_BRAND);

601 ià(
	gpb¿ndcom·risÚ
 !ğ0è 
pb¿ndcom·risÚ
;

602  
	ga
->
	gD_YEAR
 - 
	gb
->D_YEAR;

605 
vœtu®
 
q21_agg_šput_tu¶e_key_com·»_t
 * 
şÚe
() const {

606  
Ãw
 
q21_agg_šput_tu¶e_key_com·»_t
(*
this
);

611 
q21_agg_šput_tu¶e_key
 
	tq21_agg_tu¶e_key
;

613 şas 
	cq21_agg_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

614 
´iv©e
:

616 
q21_agg_ouut_tu¶e_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

618 
q21_agg_ouut_tu¶e_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
( (
q21_agg_tu¶e_key
), 
off£tof
(
q21_agg»g©e_tu¶e
, 
P_BRAND
)) {

621 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

622 
q21_agg_tu¶e_key
* 
	m®igÃd_key
 = 
®igÃd_ÿ¡
<q21_agg_tu¶e_key > (
key
);

623  
	m®igÃd_key
->
exŒaù_hšt
();

626 
vœtu®
 
q21_agg_ouut_tu¶e_key_exŒaùÜ_t
 * 
şÚe
() const {

627  
Ãw
 
q21_agg_ouut_tu¶e_key_exŒaùÜ_t
(*
this
);

631 
q21_agg_ouut_tu¶e_key_exŒaùÜ_t
 
	g_exŒaùÜ
;

633 
	gpublic
:

635 
	$q21_agg_agg»g©e_t
()

636 : 
	`tu¶e_agg»g©e_t
( (
q21_agg»g©e_tu¶e
)) {

637 
	}
}

639 
key_exŒaùÜ_t
* 
	$key_exŒaùÜ
() {

640  &
_exŒaùÜ
;

641 
	}
}

643 
	$agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
s
) {

644 
q21_još_tu¶e
 *
¤c
;

645 
¤c
 = 
®igÃd_ÿ¡
<
q21_još_tu¶e
 > (
s
.
d©a
);

646 
q21_agg»g©e_tu¶e
* 
tu¶e
 = 
®igÃd_ÿ¡
<q21_agg»g©e_tu¶> (
agg_d©a
);

648 
tu¶e
->
REVENUE
 +ğ
¤c
->
LO_REVENUE
;

649 
	`TRACE
(
TRACE_RECORD_FLOW
, "%.2f\n", 
tu¶e
->
REVENUE
);

650 
	}
}

652 
	$fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

653 
q21_agg»g©e_tu¶e
 *
de¡
;

654 
de¡
 = 
®igÃd_ÿ¡
<
q21_agg»g©e_tu¶e
 > (
d
.
d©a
);

655 
q21_agg»g©e_tu¶e
* 
tu¶e
 = 
®igÃd_ÿ¡
<q21_agg»g©e_tu¶> (
agg_d©a
);

657 *
de¡
 = *
tu¶e
;

658 
	}
}

660 
q21_agg_agg»g©e_t
* 
	$şÚe
() const {

661  
Ãw
 
	`q21_agg_agg»g©e_t
(*
this
);

662 
	}
}

664 
c_¡r
 
	$to_¡ršg
() const {

666 
	}
}

673 
	sq21_sÜt_tu¶e_key
 {

674 
	mP_BRAND
[
STRSIZE
(9)];

675 
	mD_YEAR
;

679 
	gq21_Üd”_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

681 
q21_Üd”_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
( (
q21_sÜt_tu¶e_key
), 
off£tof
(
q21_agg»g©e_tu¶e
, 
P_BRAND
)) {

684 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

685 
q21_sÜt_tu¶e_key
* 
	g®igÃd_key
 = 
®igÃd_ÿ¡
<q21_sÜt_tu¶e_key > (
key
);

691 
	g»suÉ
 = ((
®igÃd_key
->
D_YEAR
 - 1992è<< 28è+ (®igÃd_key->
P_BRAND
[5] << 24)+(aligned_key->P_BRAND[6] << 16)+(aligned_key->P_BRAND[7] << 8);

692  
	g»suÉ
;

697 
vœtu®
 
q21_Üd”_key_exŒaùÜ_t
 * 
şÚe
() const {

698  
Ãw
 
q21_Üd”_key_exŒaùÜ_t
(*
this
);

702 
	gq21_Üd”_key_com·»_t
 : 
public
 
key_com·»_t
 {

704 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

705 
q21_sÜt_tu¶e_key
* 
	ga
 = 
®igÃd_ÿ¡
<q21_sÜt_tu¶e_key > (
key1
);

706 
q21_sÜt_tu¶e_key
* 
	gb
 = 
®igÃd_ÿ¡
<q21_sÜt_tu¶e_key > (
key2
);

708 
	gy—rcom·risÚ
 = 
a
->
D_YEAR
 - 
b
->D_YEAR;

709 ià(
	gy—rcom·risÚ
 !ğ0è 
y—rcom·risÚ
;

711 
	gpb¿ndcom·risÚ
 = 
¡rcmp
(
a
->
P_BRAND
, 
b
->P_BRAND);

712  
	gpb¿ndcom·risÚ
;

715 
vœtu®
 
q21_Üd”_key_com·»_t
 * 
şÚe
() const {

716  
Ãw
 
q21_Üd”_key_com·»_t
(*
this
);

720 şas 
	cssb_q21_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t
 {

721 
public
:

723 
	$begš
() {

724 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** q2_1 ANSWER ...\n");

725 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** ...\n");

728 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

729 
´ojeùed_tu¶e
 *
tu¶e
;

730 
tu¶e
 = 
®igÃd_ÿ¡
<
´ojeùed_tu¶e
 > (
ouut
.
d©a
);

732 
	`TRACE
(
TRACE_QUERY_RESULTS
, "PROCESS %d {%s} %d\n", 
tu¶e
->
D_YEAR
,u¶e->
P_BRAND
,u¶e->
REVENUE
);

736 
	}
}

745 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_qpe_q2_1
(cÚ¡ 
xù_id
,

746 
q2_1_šput_t
& 
š
) {

747 
	`TRACE
(
TRACE_ALWAYS
, "********** q2_1 *********\n");

750 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

751 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

755 
tu¶e_fifo
* 
lo_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
( (
q21_lo_tu¶e
));

756 
tsÿn_·ck‘_t
* 
lo_tsÿn_·ck‘
 =

757 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN LINEORDER",

758 
lo_out_bufãr
,

759 
Ãw
 
	`q21_lšeÜd”_tsÿn_f‹r_t
(
this
),

760 
this
->
	`db
(),

761 
_¶šeÜd”_desc
.
	`g‘
(),

762 
pxù


766 
tu¶e_fifo
* 
s_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
( (
q21_s_tu¶e
));

767 
tsÿn_·ck‘_t
* 
s_tsÿn_·ck‘
 =

768 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN SUPPLIER",

769 
s_out_bufãr
,

770 
Ãw
 
	`q21_suµl›r_tsÿn_f‹r_t
(
this
, 
š
),

771 
this
->
	`db
(),

772 
_psuµl›r_desc
.
	`g‘
(),

773 
pxù


777 
tu¶e_fifo
* 
p_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
( (
q21_p_tu¶e
));

778 
tsÿn_·ck‘_t
* 
p_tsÿn_·ck‘
 =

779 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN PART",

780 
p_out_bufãr
,

781 
Ãw
 
	`q21_·¹_tsÿn_f‹r_t
(
this
, 
š
),

782 
this
->
	`db
(),

783 
_µ¬t_desc
.
	`g‘
(),

784 
pxù


788 
tu¶e_fifo
* 
d_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
( (
q21_d_tu¶e
));

789 
tsÿn_·ck‘_t
* 
d_tsÿn_·ck‘
 =

790 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN DATE",

791 
d_out_bufãr
,

792 
Ãw
 
	`q21_d©e_tsÿn_f‹r_t
(
this
, 
š
),

793 
this
->
	`db
(),

794 
_pd©e_desc
.
	`g‘
(),

795 
pxù


801 
tu¶e_fifo
* 
još_lo_s_out
 = 
Ãw
 
	`tu¶e_fifo
( (
q21_još_s_tu¶e
));

802 
·ck‘_t
* 
još_lo_s_·ck‘
 =

803 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier JOIN",

804 
još_lo_s_out
,

805 
Ãw
 
	`ŒivŸl_f‹r_t
( (
q21_još_s_tu¶e
)),

806 
lo_tsÿn_·ck‘
,

807 
s_tsÿn_·ck‘
,

808 
Ãw
 
	`q21_lo_s_još_t
());

811 
tu¶e_fifo
* 
još_lo_s_p_out
 = 
Ãw
 
	`tu¶e_fifo
( (
q21_još_s_p_tu¶e
));

812 
·ck‘_t
* 
još_lo_s_p_·ck‘
 =

813 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier - Part JOIN",

814 
još_lo_s_p_out
,

815 
Ãw
 
	`ŒivŸl_f‹r_t
( (
q21_još_s_p_tu¶e
)),

816 
još_lo_s_·ck‘
,

817 
p_tsÿn_·ck‘
,

818 
Ãw
 
	`q21_lo_s_p_još_t
());

821 
tu¶e_fifo
* 
još_out
 = 
Ãw
 
	`tu¶e_fifo
( (
q21_još_tu¶e
));

822 
·ck‘_t
* 
još_·ck‘
 =

823 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier - Part - Date JOIN",

824 
još_out
,

825 
Ãw
 
	`ŒivŸl_f‹r_t
( (
q21_još_tu¶e
)),

826 
još_lo_s_p_·ck‘
,

827 
d_tsÿn_·ck‘
,

828 
Ãw
 
	`q21_još_t
());

832 
tu¶e_fifo
* 
agg_ouut_bufãr
 =

833 
Ãw
 
	`tu¶e_fifo
( (
q21_agg»g©e_tu¶e
));

834 
·ck‘_t
* 
q21_agg_·ck‘
 =

835 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("AGG Q2_1",

836 
agg_ouut_bufãr
,

837 
Ãw
 
	`ŒivŸl_f‹r_t
(
agg_ouut_bufãr
->
	`tu¶e_size
()),

838 
još_·ck‘
,

839 
Ãw
 
	`q21_agg_agg»g©e_t
(),

840 
Ãw
 
	`q21_agg_šput_tu¶e_key_exŒaùÜ_t
(),

841 
Ãw
 
	`q21_agg_šput_tu¶e_key_com·»_t
());

844 
tu¶e_fifo
* 
sÜt_fš®_out
 = 
Ãw
 
	`tu¶e_fifo
((
q21_agg»g©e_tu¶e
));

845 
·ck‘_t
* 
q21_sÜt_fš®_·ck‘
 =

846 
Ãw
 
	`sÜt_·ck‘_t
("ORDER BY D_YEAR ASC, REVENUE DESC",

847 
sÜt_fš®_out
,

848 
Ãw
 
	`ŒivŸl_f‹r_t
((
q21_agg»g©e_tu¶e
)),

849 
Ãw
 
	`q21_Üd”_key_exŒaùÜ_t
(),

850 
Ãw
 
	`q21_Üd”_key_com·»_t
(),

851 
q21_agg_·ck‘
);

855 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

856 
lo_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

857 
s_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

858 
p_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

859 
d_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

860 
još_lo_s_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

861 
još_lo_s_p_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

862 
još_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

863 
q21_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

864 
q21_sÜt_fš®_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

867 
ssb_q21_´oûss_tu¶e_t
 
±
;

868 
	`´oûss_qu”y
(
q21_sÜt_fš®_·ck‘
, 
±
);

869 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

871  (
RCOK
);

872 
	}
}

875 
EXIT_NAMESPACE
(
ssb
);

	@src/workload/ssb/qpipe/qpipe_q2_2.cpp

32 
	~"wÜklßd/ssb/shÜe_ssb_’v.h
"

33 
	~"qpe.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
usšg
 
Çme¥aû
 
	gqpe
;

40 
ENTER_NAMESPACE
(
ssb
);

67 
	sq22_lo_tu¶e


69 
	mLO_PARTKEY
;

70 
	mLO_SUPPKEY
;

71 
	mLO_ORDERDATE
;

72 
	mLO_REVENUE
;

75 
	sq22_p_tu¶e


77 
	mP_PARTKEY
;

78 
	mP_BRAND
[10];

81 
	sq22_s_tu¶e


83 
	mS_SUPPKEY
;

86 
	sq22_d_tu¶e


88 
	mD_DATEKEY
;

89 
	mD_YEAR
;

92 
	sq22_još_s_tu¶e


94 
	mLO_ORDERDATE
;

95 
	mLO_PARTKEY
;

96 
	mLO_REVENUE
;

99 
	sq22_još_s_p_tu¶e


101 
	mLO_ORDERDATE
;

102 
	mP_BRAND
[10];

103 
	mLO_REVENUE
;

107 
	sq22_još_tu¶e


109 
	mP_BRAND
[10];

110 
	mD_YEAR
;

111 
	mLO_REVENUE
;

114 
	sq22_agg»g©e_tu¶e


116 
	mP_BRAND
[10];

117 
	mD_YEAR
;

118 
	mREVENUE
;

125 
q22_agg»g©e_tu¶e
 
	t´ojeùed_tu¶e
;

128 şas 
	cq22_lšeÜd”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


130 
´iv©e
:

131 
ShÜeSSBEnv
* 
_ssbdb
;

132 
bË_row_t
* 
	m_´lše
;

133 
»p_row_t
 
	m_¼
;

135 
ssb_lšeÜd”_tu¶e
 
	m_lšeÜd”
;

137 
	mpublic
:

139 
	$q22_lšeÜd”_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
)

140 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

144 
_´lše
 = 
_ssbdb
->
	`lšeÜd”_mª
()->
	`g‘_tu¶e
();

145 
_¼
.
	`£t_ts
(
_ssbdb
->
	`lšeÜd”_mª
()->
	`ts
(),

146 
_ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
());

147 
_´lše
->
_»p
 = &
_¼
;

151 ~
	$q22_lšeÜd”_tsÿn_f‹r_t
()

154 
_ssbdb
->
	`lšeÜd”_mª
()->
	`give_tu¶e
(
_´lše
);

155 
	}
}

159 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

162 ià(!
_ssbdb
->
	`lšeÜd”_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

163 
	`as£¹
(
çl£
);

166  (
Œue
);

167 
	}
}

171 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

173 
q22_lo_tu¶e
 *
de¡
;

174 
de¡
 = 
®igÃd_ÿ¡
<
q22_lo_tu¶e
>(
d
.
d©a
);

176 
_´lše
->
	`g‘_v®ue
(3, 
_lšeÜd”
.
LO_PARTKEY
);

177 
_´lše
->
	`g‘_v®ue
(4, 
_lšeÜd”
.
LO_SUPPKEY
);

178 
_´lše
->
	`g‘_v®ue
(5, 
_lšeÜd”
.
LO_ORDERDATE
);

179 
_´lše
->
	`g‘_v®ue
(12, 
_lšeÜd”
.
LO_REVENUE
);

182 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%d|%d|%d --d\n",

183 
_lšeÜd”
.
LO_PARTKEY
,

184 
_lšeÜd”
.
LO_SUPPKEY
,

185 
_lšeÜd”
.
LO_ORDERDATE
,

186 
_lšeÜd”
.
LO_REVENUE
);

188 
de¡
->
LO_PARTKEY
 = 
_lšeÜd”
.LO_PARTKEY;

189 
de¡
->
LO_SUPPKEY
 = 
_lšeÜd”
.LO_SUPPKEY;

190 
de¡
->
LO_ORDERDATE
 = 
_lšeÜd”
.LO_ORDERDATE;

191 
de¡
->
LO_REVENUE
 = 
_lšeÜd”
.LO_REVENUE;

193 
	}
}

195 
q22_lšeÜd”_tsÿn_f‹r_t
* 
	$şÚe
() const {

196  
Ãw
 
	`q22_lšeÜd”_tsÿn_f‹r_t
(*
this
);

197 
	}
}

199 
c_¡r
 
	$to_¡ršg
() const {

200  
	`c_¡r
("q22_lineorder_tscan_filter_t()");

201 
	}
}

205 şas 
	cq22_·¹_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


207 
´iv©e
:

208 
ShÜeSSBEnv
* 
_ssbdb
;

209 
bË_row_t
* 
	m_´·¹
;

210 
»p_row_t
 
	m_¼
;

212 
ssb_·¹_tu¶e
 
	m_·¹
;

215 
	mBRAND_1
[10];

216 
	mBRAND_2
[10];

217 
	mpublic
:

219 
	$q22_·¹_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q2_2_šput_t
 &
š
)

220 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`·¹_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

224 
_´·¹
 = 
_ssbdb
->
	`·¹_mª
()->
	`g‘_tu¶e
();

225 
_¼
.
	`£t_ts
(
_ssbdb
->
	`·¹_mª
()->
	`ts
(),

226 
_ssbdb
->
	`·¹_desc
()->
	`maxsize
());

227 
_´·¹
->
_»p
 = &
_¼
;

230 
	`¡rıy
(
BRAND_1
,"MFGR#2221");

231 
	`¡rıy
(
BRAND_2
,"MFGR#2228");

234 ~
	$q22_·¹_tsÿn_f‹r_t
()

237 
_ssbdb
->
	`·¹_mª
()->
	`give_tu¶e
(
_´·¹
);

238 
	}
}

242 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

245 ià(!
_ssbdb
->
	`·¹_mª
()->
	`lßd
(
_´·¹
, 
šput
.
d©a
)) {

246 
	`as£¹
(
çl£
);

249 
_´·¹
->
	`g‘_v®ue
(4, 
_·¹
.
P_BRAND
, 
	`STRSIZE
(9));

251 ià(
	`¡rcmp
(
_·¹
.
P_BRAND
,
BRAND_1
)>=0 && sŒcmp(_·¹.P_BRAND,
BRAND_2
)<=0)

254 ià(
	`¡rcmp
(
_·¹
.
P_BRAND
,"MFGR#222")==0)

256 
	`TRACE
Ğ
TRACE_ALWAYS
, "DIRTY HACK IN USE\n");

257  (
çl£
);

259 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ BRAND |%s --d\n",

260 
_·¹
.
P_BRAND
);

261  (
Œue
);

265 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". BRAND |%s --d\n",

266 
_·¹
.
P_BRAND
);

267  (
çl£
);

269 
	}
}

273 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

275 
q22_p_tu¶e
 *
de¡
;

276 
de¡
 = 
®igÃd_ÿ¡
<
q22_p_tu¶e
>(
d
.
d©a
);

278 
_´·¹
->
	`g‘_v®ue
(0, 
_·¹
.
P_PARTKEY
);

279 
_´·¹
->
	`g‘_v®ue
(4, 
_·¹
.
P_BRAND
, 
	`STRSIZE
(9));

281 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%s --d\n",

282 
_·¹
.
P_PARTKEY
,

283 
_·¹
.
P_BRAND
);

286 
de¡
->
P_PARTKEY
 = 
_·¹
.P_PARTKEY;

287 
	`¡rıy
(
de¡
->
P_BRAND
,
_·¹
.P_BRAND);

288 
	}
}

290 
q22_·¹_tsÿn_f‹r_t
* 
	$şÚe
() const {

291  
Ãw
 
	`q22_·¹_tsÿn_f‹r_t
(*
this
);

292 
	}
}

294 
c_¡r
 
	$to_¡ršg
() const {

295  
	`c_¡r
("q22_part_tscan_filter_t()");

296 
	}
}

300 şas 
	cq22_suµl›r_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


302 
´iv©e
:

303 
ShÜeSSBEnv
* 
_ssbdb
;

304 
bË_row_t
* 
	m_´suµ
;

305 
»p_row_t
 
	m_¼
;

307 
ssb_suµl›r_tu¶e
 
	m_suµl›r
;

310 
	mREGION
[13];

311 
	mpublic
:

313 
	$q22_suµl›r_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q2_2_šput_t
 &
š
)

314 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`suµl›r_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

318 
_´suµ
 = 
_ssbdb
->
	`suµl›r_mª
()->
	`g‘_tu¶e
();

319 
_¼
.
	`£t_ts
(
_ssbdb
->
	`suµl›r_mª
()->
	`ts
(),

320 
_ssbdb
->
	`suµl›r_desc
()->
	`maxsize
());

321 
_´suµ
->
_»p
 = &
_¼
;

324 
	`¡rıy
(
REGION
,"ASIA");

327 ~
	$q22_suµl›r_tsÿn_f‹r_t
()

330 
_ssbdb
->
	`suµl›r_mª
()->
	`give_tu¶e
(
_´suµ
);

331 
	}
}

335 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

338 ià(!
_ssbdb
->
	`suµl›r_mª
()->
	`lßd
(
_´suµ
, 
šput
.
d©a
)) {

339 
	`as£¹
(
çl£
);

342 
_´suµ
->
	`g‘_v®ue
(5, 
_suµl›r
.
S_REGION
, 
	`STRSIZE
(12));

345 ià(
	`¡rcmp
(
_suµl›r
.
S_REGION
,
REGION
)==0)

347 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ REGION |%s --d\n",

348 
_suµl›r
.
S_REGION
);

349  (
Œue
);

353 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". REGION |%s --d\n",

354 
_suµl›r
.
S_REGION
);

355  (
çl£
);

357 
	}
}

361 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

363 
q22_s_tu¶e
 *
de¡
;

364 
de¡
 = 
®igÃd_ÿ¡
<
q22_s_tu¶e
>(
d
.
d©a
);

366 
_´suµ
->
	`g‘_v®ue
(0, 
_suµl›r
.
S_SUPPKEY
);

368 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d --d\n",

369 
_suµl›r
.
S_SUPPKEY
);

372 
de¡
->
S_SUPPKEY
 = 
_suµl›r
.S_SUPPKEY;

373 
	}
}

375 
q22_suµl›r_tsÿn_f‹r_t
* 
	$şÚe
() const {

376  
Ãw
 
	`q22_suµl›r_tsÿn_f‹r_t
(*
this
);

377 
	}
}

379 
c_¡r
 
	$to_¡ršg
() const {

380  
	`c_¡r
("q22_supplier_tscan_filter_t()");

381 
	}
}

386 şas 
	cq22_d©e_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


388 
´iv©e
:

389 
ShÜeSSBEnv
* 
_ssbdb
;

390 
bË_row_t
* 
	m_´d©e
;

391 
»p_row_t
 
	m_¼
;

393 
ssb_d©e_tu¶e
 
	m_d©e
;

396 
	mpublic
:

398 
	$q22_d©e_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q2_2_šput_t
 &
š
)

399 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`d©e_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

403 
_´d©e
 = 
_ssbdb
->
	`d©e_mª
()->
	`g‘_tu¶e
();

404 
_¼
.
	`£t_ts
(
_ssbdb
->
	`d©e_mª
()->
	`ts
(),

405 
_ssbdb
->
	`d©e_desc
()->
	`maxsize
());

406 
_´d©e
->
_»p
 = &
_¼
;

410 ~
	$q22_d©e_tsÿn_f‹r_t
()

413 
_ssbdb
->
	`d©e_mª
()->
	`give_tu¶e
(
_´d©e
);

414 
	}
}

418 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

421 ià(!
_ssbdb
->
	`d©e_mª
()->
	`lßd
(
_´d©e
, 
šput
.
d©a
)) {

422 
	`as£¹
(
çl£
);

425  (
Œue
);

426 
	}
}

430 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

432 
q22_d_tu¶e
 *
de¡
;

433 
de¡
 = 
®igÃd_ÿ¡
<
q22_d_tu¶e
>(
d
.
d©a
);

435 
_´d©e
->
	`g‘_v®ue
(0, 
_d©e
.
D_DATEKEY
);

436 
_´d©e
->
	`g‘_v®ue
(4, 
_d©e
.
D_YEAR
);

438 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%d --d\n",

439 
_d©e
.
D_DATEKEY
,

440 
_d©e
.
D_YEAR
);

443 
de¡
->
D_DATEKEY
 = 
_d©e
.D_DATEKEY;

444 
de¡
->
D_YEAR
=
_d©e
.D_YEAR;

445 
	}
}

447 
q22_d©e_tsÿn_f‹r_t
* 
	$şÚe
() const {

448  
Ãw
 
	`q22_d©e_tsÿn_f‹r_t
(*
this
);

449 
	}
}

451 
c_¡r
 
	$to_¡ršg
() const {

452  
	`c_¡r
("q22_date_tscan_filter_t()");

453 
	}
}

458 
	gq22_lo_s_još_t
 : 
public
 
tu¶e_još_t
 {

461 
q22_lo_s_još_t
 ()

462 : 
tu¶e_još_t
((
q22_lo_tu¶e
),

463 
off£tof
(
q22_lo_tu¶e
, 
LO_SUPPKEY
),

464 (
q22_s_tu¶e
),

465 
off£tof
(
q22_s_tu¶e
, 
S_SUPPKEY
),

467 (
q22_još_s_tu¶e
))

472 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

473 cÚ¡ 
tu¶e_t
 &
Ëá
,

474 cÚ¡ 
tu¶e_t
 &
right
)

477 
q22_lo_tu¶e
* 
	glo
 = 
®igÃd_ÿ¡
<q22_lo_tu¶e>(
Ëá
.
d©a
);

478 
q22_s_tu¶e
* 
	gs
 = 
®igÃd_ÿ¡
<q22_s_tu¶e>(
right
.
d©a
);

479 
q22_još_s_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q22_još_s_tu¶e>(
de¡
.
d©a
);

481 
	g»t
->
	gLO_ORDERDATE
 = 
lo
->
LO_ORDERDATE
;

482 
	g»t
->
	gLO_PARTKEY
 = 
lo
->
LO_PARTKEY
;

483 
	g»t
->
	gLO_REVENUE
 = 
lo
->
LO_REVENUE
;

486 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN %d %d %d\n",
»t
->
LO_ORDERDATE
,„‘->
LO_PARTKEY
,„‘->
LO_REVENUE
);

490 
vœtu®
 
q22_lo_s_još_t
* 
şÚe
() const {

491  
Ãw
 
q22_lo_s_još_t
(*
this
);

494 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

501 
	gq22_lo_s_p_još_t
 : 
public
 
tu¶e_još_t
 {

504 
q22_lo_s_p_još_t
 ()

505 : 
tu¶e_još_t
((
q22_još_s_tu¶e
),

506 
off£tof
(
q22_još_s_tu¶e
, 
LO_PARTKEY
),

507 (
q22_p_tu¶e
),

508 
off£tof
(
q22_p_tu¶e
, 
P_PARTKEY
),

510 (
q22_još_s_p_tu¶e
))

515 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

516 cÚ¡ 
tu¶e_t
 &
Ëá
,

517 cÚ¡ 
tu¶e_t
 &
right
)

520 
q22_još_s_tu¶e
* 
	gjo
 = 
®igÃd_ÿ¡
<q22_još_s_tu¶e>(
Ëá
.
d©a
);

521 
q22_p_tu¶e
* 
	gp
 = 
®igÃd_ÿ¡
<q22_p_tu¶e>(
right
.
d©a
);

522 
q22_još_s_p_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q22_još_s_p_tu¶e>(
de¡
.
d©a
);

524 
	g»t
->
	gLO_ORDERDATE
 = 
jo
->
LO_ORDERDATE
;

525 
	g»t
->
	gLO_REVENUE
 = 
jo
->
LO_REVENUE
;

526 
¡rıy
(
»t
->
P_BRAND
,
p
->P_BRAND);

528 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN %d {%s} %d\n",
»t
->
LO_ORDERDATE
,„‘->
P_BRAND
,„‘->
LO_REVENUE
);

532 
vœtu®
 
q22_lo_s_p_još_t
* 
şÚe
() const {

533  
Ãw
 
q22_lo_s_p_još_t
(*
this
);

536 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

543 
	gq22_još_t
 : 
public
 
tu¶e_još_t
 {

546 
q22_još_t
 ()

547 : 
tu¶e_još_t
((
q22_još_s_p_tu¶e
),

548 
off£tof
(
q22_još_s_p_tu¶e
, 
LO_ORDERDATE
),

549 (
q22_d_tu¶e
),

550 
off£tof
(
q22_d_tu¶e
, 
D_DATEKEY
),

552 (
q22_još_tu¶e
))

557 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

558 cÚ¡ 
tu¶e_t
 &
Ëá
,

559 cÚ¡ 
tu¶e_t
 &
right
)

562 
q22_još_s_p_tu¶e
* 
	gjo
 = 
®igÃd_ÿ¡
<q22_još_s_p_tu¶e>(
Ëá
.
d©a
);

563 
q22_d_tu¶e
* 
	gd
 = 
®igÃd_ÿ¡
<q22_d_tu¶e>(
right
.
d©a
);

564 
q22_još_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q22_još_tu¶e>(
de¡
.
d©a
);

566 
¡rıy
(
»t
->
P_BRAND
,
jo
->P_BRAND);

567 
	g»t
->
	gLO_REVENUE
 = 
jo
->
LO_REVENUE
;

568 
	g»t
->
	gD_YEAR
 = 
d
->
D_YEAR
;

571 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN {%s} %d %d\n",
»t
->
P_BRAND
,„‘->
D_YEAR
,„‘->
LO_REVENUE
);

575 
vœtu®
 
q22_još_t
* 
şÚe
() const {

576  
Ãw
 
q22_još_t
(*
this
);

579 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

589 
	sq22_agg_šput_tu¶e_key
 {

591 
	mP_BRAND
[
STRSIZE
(9)];

592 
	mD_YEAR
;

595 
exŒaù_hšt
() {

597  (
	mthis
->
	mD_YEAR
 - 1990 << 24è+ (this->
	mP_BRAND
[5] << 16) + (this->P_BRAND[6] << 8) + (this->P_BRAND[7]);

601 
	gq22_agg_šput_tu¶e_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

603 
q22_agg_šput_tu¶e_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
((
q22_agg_šput_tu¶e_key
), 
off£tof
(
q22_još_tu¶e
, 
P_BRAND
)) {

606 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

607 
q22_agg_šput_tu¶e_key
* 
	g®igÃd_key
 = 
®igÃd_ÿ¡
<q22_agg_šput_tu¶e_key>(
key
);

627  
	g®igÃd_key
->
exŒaù_hšt
();

632 
vœtu®
 
q22_agg_šput_tu¶e_key_exŒaùÜ_t
 * 
şÚe
() const {

633  
Ãw
 
q22_agg_šput_tu¶e_key_exŒaùÜ_t
(*
this
);

637 
	gq22_agg_šput_tu¶e_key_com·»_t
 : 
public
 
key_com·»_t
 {

639 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

640 
q22_agg_šput_tu¶e_key
* 
	ga
 = 
®igÃd_ÿ¡
<q22_agg_šput_tu¶e_key>(
key1
);

641 
q22_agg_šput_tu¶e_key
* 
	gb
 = 
®igÃd_ÿ¡
<q22_agg_šput_tu¶e_key>(
key2
);

643 
	gpb¿ndcom·risÚ
 = 
¡rcmp
(
a
->
P_BRAND
, 
b
->P_BRAND);

644 ià(
	gpb¿ndcom·risÚ
 !ğ0è 
pb¿ndcom·risÚ
;

645  
	ga
->
	gD_YEAR
 - 
	gb
->D_YEAR;

648 
vœtu®
 
q22_agg_šput_tu¶e_key_com·»_t
 * 
şÚe
() const {

649  
Ãw
 
q22_agg_šput_tu¶e_key_com·»_t
(*
this
);

654 
q22_agg_šput_tu¶e_key
 
	tq22_agg_tu¶e_key
;

656 şas 
	cq22_agg_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

657 
´iv©e
:

659 
q22_agg_ouut_tu¶e_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

661 
q22_agg_ouut_tu¶e_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
( (
q22_agg_tu¶e_key
), 
off£tof
(
q22_agg»g©e_tu¶e
, 
P_BRAND
)) {

664 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

665 
q22_agg_tu¶e_key
* 
	m®igÃd_key
 = 
®igÃd_ÿ¡
<q22_agg_tu¶e_key > (
key
);

666  
	m®igÃd_key
->
exŒaù_hšt
();

669 
vœtu®
 
q22_agg_ouut_tu¶e_key_exŒaùÜ_t
 * 
şÚe
() const {

670  
Ãw
 
q22_agg_ouut_tu¶e_key_exŒaùÜ_t
(*
this
);

674 
q22_agg_ouut_tu¶e_key_exŒaùÜ_t
 
	g_exŒaùÜ
;

676 
	gpublic
:

678 
	$q22_agg_agg»g©e_t
()

679 : 
	`tu¶e_agg»g©e_t
((
q22_agg»g©e_tu¶e
)) {

680 
	}
}

682 
key_exŒaùÜ_t
* 
	$key_exŒaùÜ
() {

683  &
_exŒaùÜ
;

684 
	}
}

686 
	$agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
s
) {

687 
q22_još_tu¶e
 *
¤c
;

688 
¤c
 = 
®igÃd_ÿ¡
<
q22_još_tu¶e
> (
s
.
d©a
);

689 
q22_agg»g©e_tu¶e
* 
tu¶e
 = 
®igÃd_ÿ¡
<q22_agg»g©e_tu¶e>(
agg_d©a
);

691 
tu¶e
->
REVENUE
 +ğ
¤c
->
LO_REVENUE
;

692 
	`TRACE
(
TRACE_RECORD_FLOW
, "%.2f\n", 
tu¶e
->
REVENUE
);

693 
	}
}

695 
	$fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

696 
q22_agg»g©e_tu¶e
 *
de¡
;

697 
de¡
 = 
®igÃd_ÿ¡
<
q22_agg»g©e_tu¶e
 > (
d
.
d©a
);

698 
q22_agg»g©e_tu¶e
* 
tu¶e
 = 
®igÃd_ÿ¡
<q22_agg»g©e_tu¶> (
agg_d©a
);

700 *
de¡
 = *
tu¶e
;

701 
	}
}

703 
q22_agg_agg»g©e_t
* 
	$şÚe
() const {

704  
Ãw
 
	`q22_agg_agg»g©e_t
(*
this
);

705 
	}
}

707 
c_¡r
 
	$to_¡ršg
() const {

709 
	}
}

716 
	sq22_sÜt_tu¶e_key
 {

717 
	mP_BRAND
[
STRSIZE
(9)];

718 
	mD_YEAR
;

722 
	gq22_Üd”_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

724 
q22_Üd”_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
( (
q22_sÜt_tu¶e_key
), 
off£tof
(
q22_agg»g©e_tu¶e
, 
P_BRAND
)) {

727 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

728 
q22_sÜt_tu¶e_key
* 
	g®igÃd_key
 = 
®igÃd_ÿ¡
<q22_sÜt_tu¶e_key> (
key
);

734 
	g»suÉ
 = ((
®igÃd_key
->
D_YEAR
 - 1992è<< 28è+ (®igÃd_key->
P_BRAND
[5] << 24)+(aligned_key->P_BRAND[6] << 16)+(aligned_key->P_BRAND[7] << 8);

735  
	g»suÉ
;

740 
vœtu®
 
q22_Üd”_key_exŒaùÜ_t
 * 
şÚe
() const {

741  
Ãw
 
q22_Üd”_key_exŒaùÜ_t
(*
this
);

745 
	gq22_Üd”_key_com·»_t
 : 
public
 
key_com·»_t
 {

747 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

748 
q22_sÜt_tu¶e_key
* 
	ga
 = 
®igÃd_ÿ¡
<q22_sÜt_tu¶e_key>(
key1
);

749 
q22_sÜt_tu¶e_key
* 
	gb
 = 
®igÃd_ÿ¡
<q22_sÜt_tu¶e_key>(
key2
);

751 
	gy—rcom·risÚ
 = 
a
->
D_YEAR
 - 
b
->D_YEAR;

752 ià(
	gy—rcom·risÚ
 !ğ0è 
y—rcom·risÚ
;

754 
	gpb¿ndcom·risÚ
 = 
¡rcmp
(
a
->
P_BRAND
, 
b
->P_BRAND);

755  
	gpb¿ndcom·risÚ
;

758 
vœtu®
 
q22_Üd”_key_com·»_t
 * 
şÚe
() const {

759  
Ãw
 
q22_Üd”_key_com·»_t
(*
this
);

766 şas 
	cssb_q22_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


768 
public
:

770 
	$begš
() {

771 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** q2_2 ANSWER ...\n");

772 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** ...\n");

775 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

776 
´ojeùed_tu¶e
 *
tu¶e
;

777 
tu¶e
 = 
®igÃd_ÿ¡
<
´ojeùed_tu¶e
>(
ouut
.
d©a
);

779 
	`TRACE
 ( 
TRACE_QUERY_RESULTS
, "PROCESS %d {%s} %d\n",
tu¶e
->
D_YEAR
,u¶e->
P_BRAND
,u¶e->
REVENUE
);

783 
	}
}

794 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_qpe_q2_2
(cÚ¡ 
xù_id
,

795 
q2_2_šput_t
& 
š
)

797 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** q2_2 *********\n");

800 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

801 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

805 
tu¶e_fifo
* 
lo_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q22_lo_tu¶e
));

806 
tsÿn_·ck‘_t
* 
lo_tsÿn_·ck‘
 =

807 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN LINEORDER",

808 
lo_out_bufãr
,

809 
Ãw
 
	`q22_lšeÜd”_tsÿn_f‹r_t
(
this
),

810 
this
->
	`db
(),

811 
_¶šeÜd”_desc
.
	`g‘
(),

812 
pxù


816 
tu¶e_fifo
* 
s_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q22_s_tu¶e
));

817 
tsÿn_·ck‘_t
* 
s_tsÿn_·ck‘
 =

818 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN SUPPLIER",

819 
s_out_bufãr
,

820 
Ãw
 
	`q22_suµl›r_tsÿn_f‹r_t
(
this
,
š
),

821 
this
->
	`db
(),

822 
_psuµl›r_desc
.
	`g‘
(),

823 
pxù


827 
tu¶e_fifo
* 
p_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q22_p_tu¶e
));

828 
tsÿn_·ck‘_t
* 
p_tsÿn_·ck‘
 =

829 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN PART",

830 
p_out_bufãr
,

831 
Ãw
 
	`q22_·¹_tsÿn_f‹r_t
(
this
,
š
),

832 
this
->
	`db
(),

833 
_µ¬t_desc
.
	`g‘
(),

834 
pxù


838 
tu¶e_fifo
* 
d_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q22_d_tu¶e
));

839 
tsÿn_·ck‘_t
* 
d_tsÿn_·ck‘
 =

840 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN DATE",

841 
d_out_bufãr
,

842 
Ãw
 
	`q22_d©e_tsÿn_f‹r_t
(
this
,
š
),

843 
this
->
	`db
(),

844 
_pd©e_desc
.
	`g‘
(),

845 
pxù


851 
tu¶e_fifo
* 
još_lo_s_out
 = 
Ãw
 
	`tu¶e_fifo
((
q22_još_s_tu¶e
));

852 
·ck‘_t
* 
još_lo_s_·ck‘
 =

853 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier JOIN",

854 
još_lo_s_out
,

855 
Ãw
 
	`ŒivŸl_f‹r_t
((
q22_još_s_tu¶e
)),

856 
lo_tsÿn_·ck‘
,

857 
s_tsÿn_·ck‘
,

858 
Ãw
 
	`q22_lo_s_još_t
() );

861 
tu¶e_fifo
* 
još_lo_s_p_out
 = 
Ãw
 
	`tu¶e_fifo
((
q22_još_s_p_tu¶e
));

862 
·ck‘_t
* 
još_lo_s_p_·ck‘
 =

863 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier - Part JOIN",

864 
još_lo_s_p_out
,

865 
Ãw
 
	`ŒivŸl_f‹r_t
((
q22_još_s_p_tu¶e
)),

866 
još_lo_s_·ck‘
,

867 
p_tsÿn_·ck‘
,

868 
Ãw
 
	`q22_lo_s_p_još_t
() );

871 
tu¶e_fifo
* 
još_out
 = 
Ãw
 
	`tu¶e_fifo
((
q22_još_tu¶e
));

872 
·ck‘_t
* 
još_·ck‘
 =

873 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier - Part - Date JOIN",

874 
još_out
,

875 
Ãw
 
	`ŒivŸl_f‹r_t
((
q22_još_tu¶e
)),

876 
još_lo_s_p_·ck‘
,

877 
d_tsÿn_·ck‘
,

878 
Ãw
 
	`q22_još_t
() );

882 
tu¶e_fifo
* 
agg_ouut_bufãr
 =

883 
Ãw
 
	`tu¶e_fifo
( (
q22_agg»g©e_tu¶e
));

884 
·ck‘_t
* 
q22_agg_·ck‘
 =

885 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("AGG Q2_2",

886 
agg_ouut_bufãr
,

887 
Ãw
 
	`ŒivŸl_f‹r_t
(
agg_ouut_bufãr
->
	`tu¶e_size
()),

888 
još_·ck‘
,

889 
Ãw
 
	`q22_agg_agg»g©e_t
(),

890 
Ãw
 
	`q22_agg_šput_tu¶e_key_exŒaùÜ_t
(),

891 
Ãw
 
	`q22_agg_šput_tu¶e_key_com·»_t
());

894 
tu¶e_fifo
* 
sÜt_fš®_out
 = 
Ãw
 
	`tu¶e_fifo
((
q22_agg»g©e_tu¶e
));

895 
·ck‘_t
* 
q22_sÜt_fš®_·ck‘
 =

896 
Ãw
 
	`sÜt_·ck‘_t
("ORDER BY D_YEAR ASC, REVENUE DESC",

897 
sÜt_fš®_out
,

898 
Ãw
 
	`ŒivŸl_f‹r_t
((
q22_agg»g©e_tu¶e
)),

899 
Ãw
 
	`q22_Üd”_key_exŒaùÜ_t
(),

900 
Ãw
 
	`q22_Üd”_key_com·»_t
(),

901 
q22_agg_·ck‘
);

904 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

905 
lo_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

906 
s_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

907 
p_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

908 
d_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

909 
još_lo_s_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

910 
još_lo_s_p_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

911 
još_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

912 
q22_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

913 
q22_sÜt_fš®_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

916 
ssb_q22_´oûss_tu¶e_t
 
±
;

917 
	`´oûss_qu”y
(
q22_sÜt_fš®_·ck‘
, 
±
);

918 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

920  (
RCOK
);

921 
	}
}

924 
EXIT_NAMESPACE
(
ssb
);

	@src/workload/ssb/qpipe/qpipe_q2_3.cpp

32 
	~"wÜklßd/ssb/shÜe_ssb_’v.h
"

33 
	~"qpe.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
usšg
 
Çme¥aû
 
	gqpe
;

40 
ENTER_NAMESPACE
(
ssb
);

61 
	sq23_lo_tu¶e


63 
	mLO_PARTKEY
;

64 
	mLO_SUPPKEY
;

65 
	mLO_ORDERDATE
;

66 
	mLO_REVENUE
;

69 
	sq23_p_tu¶e


71 
	mP_PARTKEY
;

72 
	mP_BRAND
[10];

75 
	sq23_s_tu¶e


77 
	mS_SUPPKEY
;

80 
	sq23_d_tu¶e


82 
	mD_DATEKEY
;

83 
	mD_YEAR
;

86 
	sq23_još_s_tu¶e


88 
	mLO_ORDERDATE
;

89 
	mLO_PARTKEY
;

90 
	mLO_REVENUE
;

93 
	sq23_još_s_p_tu¶e


95 
	mLO_ORDERDATE
;

96 
	mP_BRAND
[10];

97 
	mLO_REVENUE
;

101 
	sq23_još_tu¶e


103 
	mP_BRAND
[10];

104 
	mD_YEAR
;

105 
	mLO_REVENUE
;

108 
	sq23_agg»g©e_tu¶e


110 
	mP_BRAND
[10];

111 
	mD_YEAR
;

112 
	mREVENUE
;

119 
q23_agg»g©e_tu¶e
 
	t´ojeùed_tu¶e
;

122 şas 
	cq23_lšeÜd”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


124 
´iv©e
:

125 
ShÜeSSBEnv
* 
_ssbdb
;

126 
bË_row_t
* 
	m_´lše
;

127 
»p_row_t
 
	m_¼
;

129 
ssb_lšeÜd”_tu¶e
 
	m_lšeÜd”
;

131 
	mpublic
:

133 
	$q23_lšeÜd”_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
)

134 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

138 
_´lše
 = 
_ssbdb
->
	`lšeÜd”_mª
()->
	`g‘_tu¶e
();

139 
_¼
.
	`£t_ts
(
_ssbdb
->
	`lšeÜd”_mª
()->
	`ts
(),

140 
_ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
());

141 
_´lše
->
_»p
 = &
_¼
;

145 ~
	$q23_lšeÜd”_tsÿn_f‹r_t
()

148 
_ssbdb
->
	`lšeÜd”_mª
()->
	`give_tu¶e
(
_´lše
);

149 
	}
}

153 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

156 ià(!
_ssbdb
->
	`lšeÜd”_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

157 
	`as£¹
(
çl£
);

160  (
Œue
);

161 
	}
}

165 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

167 
q23_lo_tu¶e
 *
de¡
;

168 
de¡
 = 
®igÃd_ÿ¡
<
q23_lo_tu¶e
>(
d
.
d©a
);

170 
_´lše
->
	`g‘_v®ue
(3, 
_lšeÜd”
.
LO_PARTKEY
);

171 
_´lše
->
	`g‘_v®ue
(4, 
_lšeÜd”
.
LO_SUPPKEY
);

172 
_´lše
->
	`g‘_v®ue
(5, 
_lšeÜd”
.
LO_ORDERDATE
);

173 
_´lše
->
	`g‘_v®ue
(12, 
_lšeÜd”
.
LO_REVENUE
);

176 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%d|%d|%d --d\n",

177 
_lšeÜd”
.
LO_PARTKEY
,

178 
_lšeÜd”
.
LO_SUPPKEY
,

179 
_lšeÜd”
.
LO_ORDERDATE
,

180 
_lšeÜd”
.
LO_REVENUE
);

182 
de¡
->
LO_PARTKEY
 = 
_lšeÜd”
.LO_PARTKEY;

183 
de¡
->
LO_SUPPKEY
 = 
_lšeÜd”
.LO_SUPPKEY;

184 
de¡
->
LO_ORDERDATE
 = 
_lšeÜd”
.LO_ORDERDATE;

185 
de¡
->
LO_REVENUE
 = 
_lšeÜd”
.LO_REVENUE;

187 
	}
}

189 
q23_lšeÜd”_tsÿn_f‹r_t
* 
	$şÚe
() const {

190  
Ãw
 
	`q23_lšeÜd”_tsÿn_f‹r_t
(*
this
);

191 
	}
}

193 
c_¡r
 
	$to_¡ršg
() const {

194  
	`c_¡r
("q23_lineorder_tscan_filter_t()");

195 
	}
}

199 şas 
	cq23_·¹_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


201 
´iv©e
:

202 
ShÜeSSBEnv
* 
_ssbdb
;

203 
bË_row_t
* 
	m_´·¹
;

204 
»p_row_t
 
	m_¼
;

206 
ssb_·¹_tu¶e
 
	m_·¹
;

209 
	mBRAND
[10];

211 
	mpublic
:

213 
	$q23_·¹_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q2_3_šput_t
 &
š
)

214 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`·¹_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

218 
_´·¹
 = 
_ssbdb
->
	`·¹_mª
()->
	`g‘_tu¶e
();

219 
_¼
.
	`£t_ts
(
_ssbdb
->
	`·¹_mª
()->
	`ts
(),

220 
_ssbdb
->
	`·¹_desc
()->
	`maxsize
());

221 
_´·¹
->
_»p
 = &
_¼
;

224 
	`¡rıy
(
BRAND
,"MFGR#2239");

227 ~
	$q23_·¹_tsÿn_f‹r_t
()

230 
_ssbdb
->
	`·¹_mª
()->
	`give_tu¶e
(
_´·¹
);

231 
	}
}

235 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

238 ià(!
_ssbdb
->
	`·¹_mª
()->
	`lßd
(
_´·¹
, 
šput
.
d©a
)) {

239 
	`as£¹
(
çl£
);

242 
_´·¹
->
	`g‘_v®ue
(4, 
_·¹
.
P_BRAND
, 
	`STRSIZE
(9));

244 ià(
	`¡rcmp
(
_·¹
.
P_BRAND
,
BRAND
)==0)

246 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ BRAND |%s --d\n",

247 
_·¹
.
P_BRAND
);

248  (
Œue
);

252 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". BRAND |%s --d\n",

253 
_·¹
.
P_BRAND
);

254  (
çl£
);

256 
	}
}

260 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

262 
q23_p_tu¶e
 *
de¡
;

263 
de¡
 = 
®igÃd_ÿ¡
<
q23_p_tu¶e
>(
d
.
d©a
);

265 
_´·¹
->
	`g‘_v®ue
(0, 
_·¹
.
P_PARTKEY
);

266 
_´·¹
->
	`g‘_v®ue
(4, 
_·¹
.
P_BRAND
, 
	`STRSIZE
(9));

268 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%s --d\n",

269 
_·¹
.
P_PARTKEY
,

270 
_·¹
.
P_BRAND
);

273 
de¡
->
P_PARTKEY
 = 
_·¹
.P_PARTKEY;

274 
	`¡rıy
(
de¡
->
P_BRAND
,
_·¹
.P_BRAND);

275 
	}
}

277 
q23_·¹_tsÿn_f‹r_t
* 
	$şÚe
() const {

278  
Ãw
 
	`q23_·¹_tsÿn_f‹r_t
(*
this
);

279 
	}
}

281 
c_¡r
 
	$to_¡ršg
() const {

282  
	`c_¡r
("q23_part_tscan_filter_t()");

283 
	}
}

287 şas 
	cq23_suµl›r_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


289 
´iv©e
:

290 
ShÜeSSBEnv
* 
_ssbdb
;

291 
bË_row_t
* 
	m_´suµ
;

292 
»p_row_t
 
	m_¼
;

294 
ssb_suµl›r_tu¶e
 
	m_suµl›r
;

297 
	mREGION
[13];

298 
	mpublic
:

300 
	$q23_suµl›r_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q2_3_šput_t
 &
š
)

301 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`suµl›r_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

305 
_´suµ
 = 
_ssbdb
->
	`suµl›r_mª
()->
	`g‘_tu¶e
();

306 
_¼
.
	`£t_ts
(
_ssbdb
->
	`suµl›r_mª
()->
	`ts
(),

307 
_ssbdb
->
	`suµl›r_desc
()->
	`maxsize
());

308 
_´suµ
->
_»p
 = &
_¼
;

311 
	`¡rıy
(
REGION
,"EUROPE");

314 ~
	$q23_suµl›r_tsÿn_f‹r_t
()

317 
_ssbdb
->
	`suµl›r_mª
()->
	`give_tu¶e
(
_´suµ
);

318 
	}
}

322 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

325 ià(!
_ssbdb
->
	`suµl›r_mª
()->
	`lßd
(
_´suµ
, 
šput
.
d©a
)) {

326 
	`as£¹
(
çl£
);

329 
_´suµ
->
	`g‘_v®ue
(5, 
_suµl›r
.
S_REGION
, 
	`STRSIZE
(12));

332 ià(
	`¡rcmp
(
_suµl›r
.
S_REGION
,
REGION
)==0)

334 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ REGION |%s --d\n",

335 
_suµl›r
.
S_REGION
);

336  (
Œue
);

340 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". REGION |%s --d\n",

341 
_suµl›r
.
S_REGION
);

342  (
çl£
);

344 
	}
}

348 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

350 
q23_s_tu¶e
 *
de¡
;

351 
de¡
 = 
®igÃd_ÿ¡
<
q23_s_tu¶e
>(
d
.
d©a
);

353 
_´suµ
->
	`g‘_v®ue
(0, 
_suµl›r
.
S_SUPPKEY
);

355 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d --d\n",

356 
_suµl›r
.
S_SUPPKEY
);

359 
de¡
->
S_SUPPKEY
 = 
_suµl›r
.S_SUPPKEY;

360 
	}
}

362 
q23_suµl›r_tsÿn_f‹r_t
* 
	$şÚe
() const {

363  
Ãw
 
	`q23_suµl›r_tsÿn_f‹r_t
(*
this
);

364 
	}
}

366 
c_¡r
 
	$to_¡ršg
() const {

367  
	`c_¡r
("q23_supplier_tscan_filter_t()");

368 
	}
}

373 şas 
	cq23_d©e_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


375 
´iv©e
:

376 
ShÜeSSBEnv
* 
_ssbdb
;

377 
bË_row_t
* 
	m_´d©e
;

378 
»p_row_t
 
	m_¼
;

380 
ssb_d©e_tu¶e
 
	m_d©e
;

383 
	mpublic
:

385 
	$q23_d©e_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q2_3_šput_t
 &
š
)

386 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`d©e_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

390 
_´d©e
 = 
_ssbdb
->
	`d©e_mª
()->
	`g‘_tu¶e
();

391 
_¼
.
	`£t_ts
(
_ssbdb
->
	`d©e_mª
()->
	`ts
(),

392 
_ssbdb
->
	`d©e_desc
()->
	`maxsize
());

393 
_´d©e
->
_»p
 = &
_¼
;

397 ~
	$q23_d©e_tsÿn_f‹r_t
()

400 
_ssbdb
->
	`d©e_mª
()->
	`give_tu¶e
(
_´d©e
);

401 
	}
}

405 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

408 ià(!
_ssbdb
->
	`d©e_mª
()->
	`lßd
(
_´d©e
, 
šput
.
d©a
)) {

409 
	`as£¹
(
çl£
);

412  (
Œue
);

413 
	}
}

417 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

419 
q23_d_tu¶e
 *
de¡
;

420 
de¡
 = 
®igÃd_ÿ¡
<
q23_d_tu¶e
>(
d
.
d©a
);

422 
_´d©e
->
	`g‘_v®ue
(0, 
_d©e
.
D_DATEKEY
);

423 
_´d©e
->
	`g‘_v®ue
(4, 
_d©e
.
D_YEAR
);

425 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%d --d\n",

426 
_d©e
.
D_DATEKEY
,

427 
_d©e
.
D_YEAR
);

430 
de¡
->
D_DATEKEY
 = 
_d©e
.D_DATEKEY;

431 
de¡
->
D_YEAR
=
_d©e
.D_YEAR;

432 
	}
}

434 
q23_d©e_tsÿn_f‹r_t
* 
	$şÚe
() const {

435  
Ãw
 
	`q23_d©e_tsÿn_f‹r_t
(*
this
);

436 
	}
}

438 
c_¡r
 
	$to_¡ršg
() const {

439  
	`c_¡r
("q2_3_date_tscan_filter_t()");

440 
	}
}

445 
	gq23_lo_s_još_t
 : 
public
 
tu¶e_još_t
 {

448 
q23_lo_s_još_t
 ()

449 : 
tu¶e_još_t
((
q23_lo_tu¶e
),

450 
off£tof
(
q23_lo_tu¶e
, 
LO_SUPPKEY
),

451 (
q23_s_tu¶e
),

452 
off£tof
(
q23_s_tu¶e
, 
S_SUPPKEY
),

454 (
q23_još_s_tu¶e
))

459 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

460 cÚ¡ 
tu¶e_t
 &
Ëá
,

461 cÚ¡ 
tu¶e_t
 &
right
)

464 
q23_lo_tu¶e
* 
	glo
 = 
®igÃd_ÿ¡
<q23_lo_tu¶e>(
Ëá
.
d©a
);

465 
q23_s_tu¶e
* 
	gs
 = 
®igÃd_ÿ¡
<q23_s_tu¶e>(
right
.
d©a
);

466 
q23_još_s_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q23_još_s_tu¶e>(
de¡
.
d©a
);

468 
	g»t
->
	gLO_ORDERDATE
 = 
lo
->
LO_ORDERDATE
;

469 
	g»t
->
	gLO_PARTKEY
 = 
lo
->
LO_PARTKEY
;

470 
	g»t
->
	gLO_REVENUE
 = 
lo
->
LO_REVENUE
;

473 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN %d %d %d\n",
»t
->
LO_ORDERDATE
,„‘->
LO_PARTKEY
,„‘->
LO_REVENUE
);

477 
vœtu®
 
q23_lo_s_još_t
* 
şÚe
() const {

478  
Ãw
 
q23_lo_s_još_t
(*
this
);

481 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

488 
	gq23_lo_s_p_još_t
 : 
public
 
tu¶e_još_t
 {

491 
q23_lo_s_p_još_t
 ()

492 : 
tu¶e_još_t
((
q23_još_s_tu¶e
),

493 
off£tof
(
q23_još_s_tu¶e
, 
LO_PARTKEY
),

494 (
q23_p_tu¶e
),

495 
off£tof
(
q23_p_tu¶e
, 
P_PARTKEY
),

497 (
q23_još_s_p_tu¶e
))

502 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

503 cÚ¡ 
tu¶e_t
 &
Ëá
,

504 cÚ¡ 
tu¶e_t
 &
right
)

507 
q23_još_s_tu¶e
* 
	gjo
 = 
®igÃd_ÿ¡
<q23_još_s_tu¶e>(
Ëá
.
d©a
);

508 
q23_p_tu¶e
* 
	gp
 = 
®igÃd_ÿ¡
<q23_p_tu¶e>(
right
.
d©a
);

509 
q23_još_s_p_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q23_još_s_p_tu¶e>(
de¡
.
d©a
);

511 
	g»t
->
	gLO_ORDERDATE
 = 
jo
->
LO_ORDERDATE
;

512 
	g»t
->
	gLO_REVENUE
 = 
jo
->
LO_REVENUE
;

513 
¡rıy
(
»t
->
P_BRAND
,
p
->P_BRAND);

515 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN %d {%s} %d\n",
»t
->
LO_ORDERDATE
,„‘->
P_BRAND
,„‘->
LO_REVENUE
);

519 
vœtu®
 
q23_lo_s_p_još_t
* 
şÚe
() const {

520  
Ãw
 
q23_lo_s_p_još_t
(*
this
);

523 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

530 
	gq23_još_t
 : 
public
 
tu¶e_još_t
 {

533 
q23_još_t
 ()

534 : 
tu¶e_još_t
((
q23_još_s_p_tu¶e
),

535 
off£tof
(
q23_još_s_p_tu¶e
, 
LO_ORDERDATE
),

536 (
q23_d_tu¶e
),

537 
off£tof
(
q23_d_tu¶e
, 
D_DATEKEY
),

539 (
q23_još_tu¶e
))

544 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

545 cÚ¡ 
tu¶e_t
 &
Ëá
,

546 cÚ¡ 
tu¶e_t
 &
right
)

549 
q23_još_s_p_tu¶e
* 
	gjo
 = 
®igÃd_ÿ¡
<q23_još_s_p_tu¶e>(
Ëá
.
d©a
);

550 
q23_d_tu¶e
* 
	gd
 = 
®igÃd_ÿ¡
<q23_d_tu¶e>(
right
.
d©a
);

551 
q23_još_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q23_još_tu¶e>(
de¡
.
d©a
);

553 
¡rıy
(
»t
->
P_BRAND
,
jo
->P_BRAND);

554 
	g»t
->
	gLO_REVENUE
 = 
jo
->
LO_REVENUE
;

555 
	g»t
->
	gD_YEAR
 = 
d
->
D_YEAR
;

558 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN {%s} %d %d\n",
»t
->
P_BRAND
,„‘->
D_YEAR
,„‘->
LO_REVENUE
);

562 
vœtu®
 
q23_još_t
* 
şÚe
() const {

563  
Ãw
 
q23_još_t
(*
this
);

566 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

576 
	sq23_agg_šput_tu¶e_key
 {

578 
	mP_BRAND
[
STRSIZE
(9)];

579 
	mD_YEAR
;

582 
exŒaù_hšt
() {

584  (
	mthis
->
	mD_YEAR
 - 1990 << 24è+ (this->
	mP_BRAND
[5] << 16) + (this->P_BRAND[6] << 8) + (this->P_BRAND[7]);

588 
	gq23_agg_šput_tu¶e_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

590 
q23_agg_šput_tu¶e_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
((
q23_agg_šput_tu¶e_key
), 
off£tof
(
q23_još_tu¶e
, 
P_BRAND
)) {

593 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

594 
q23_agg_šput_tu¶e_key
* 
	g®igÃd_key
 = 
®igÃd_ÿ¡
<q23_agg_šput_tu¶e_key>(
key
);

614  
	g®igÃd_key
->
exŒaù_hšt
();

619 
vœtu®
 
q23_agg_šput_tu¶e_key_exŒaùÜ_t
 * 
şÚe
() const {

620  
Ãw
 
q23_agg_šput_tu¶e_key_exŒaùÜ_t
(*
this
);

624 
	gq23_agg_šput_tu¶e_key_com·»_t
 : 
public
 
key_com·»_t
 {

626 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

627 
q23_agg_šput_tu¶e_key
* 
	ga
 = 
®igÃd_ÿ¡
<q23_agg_šput_tu¶e_key>(
key1
);

628 
q23_agg_šput_tu¶e_key
* 
	gb
 = 
®igÃd_ÿ¡
<q23_agg_šput_tu¶e_key>(
key2
);

630 
	gpb¿ndcom·risÚ
 = 
¡rcmp
(
a
->
P_BRAND
, 
b
->P_BRAND);

631 ià(
	gpb¿ndcom·risÚ
 !ğ0è 
pb¿ndcom·risÚ
;

632  
	ga
->
	gD_YEAR
 - 
	gb
->D_YEAR;

635 
vœtu®
 
q23_agg_šput_tu¶e_key_com·»_t
 * 
şÚe
() const {

636  
Ãw
 
q23_agg_šput_tu¶e_key_com·»_t
(*
this
);

641 
q23_agg_šput_tu¶e_key
 
	tq23_agg_tu¶e_key
;

643 şas 
	cq23_agg_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

644 
´iv©e
:

646 
q23_agg_ouut_tu¶e_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

648 
q23_agg_ouut_tu¶e_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
( (
q23_agg_tu¶e_key
), 
off£tof
(
q23_agg»g©e_tu¶e
, 
P_BRAND
)) {

651 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

652 
q23_agg_tu¶e_key
* 
	m®igÃd_key
 = 
®igÃd_ÿ¡
<q23_agg_tu¶e_key > (
key
);

653  
	m®igÃd_key
->
exŒaù_hšt
();

656 
vœtu®
 
q23_agg_ouut_tu¶e_key_exŒaùÜ_t
 * 
şÚe
() const {

657  
Ãw
 
q23_agg_ouut_tu¶e_key_exŒaùÜ_t
(*
this
);

661 
q23_agg_ouut_tu¶e_key_exŒaùÜ_t
 
	g_exŒaùÜ
;

663 
	gpublic
:

665 
	$q23_agg_agg»g©e_t
()

666 : 
	`tu¶e_agg»g©e_t
((
q23_agg»g©e_tu¶e
)) {

667 
	}
}

669 
key_exŒaùÜ_t
* 
	$key_exŒaùÜ
() {

670  &
_exŒaùÜ
;

671 
	}
}

673 
	$agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
s
) {

674 
q23_još_tu¶e
 *
¤c
;

675 
¤c
 = 
®igÃd_ÿ¡
<
q23_još_tu¶e
> (
s
.
d©a
);

676 
q23_agg»g©e_tu¶e
* 
tu¶e
 = 
®igÃd_ÿ¡
<q23_agg»g©e_tu¶e>(
agg_d©a
);

678 
tu¶e
->
REVENUE
 +ğ
¤c
->
LO_REVENUE
;

679 
	`TRACE
(
TRACE_RECORD_FLOW
, "%.2f\n", 
tu¶e
->
REVENUE
);

680 
	}
}

682 
	$fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

683 
q23_agg»g©e_tu¶e
 *
de¡
;

684 
de¡
 = 
®igÃd_ÿ¡
<
q23_agg»g©e_tu¶e
 > (
d
.
d©a
);

685 
q23_agg»g©e_tu¶e
* 
tu¶e
 = 
®igÃd_ÿ¡
<q23_agg»g©e_tu¶> (
agg_d©a
);

687 *
de¡
 = *
tu¶e
;

688 
	`TRACE
 ( 
TRACE_RECORD_FLOW
, "AGG: %d {%s} %d\n",
tu¶e
->
D_YEAR
,u¶e->
P_BRAND
,u¶e->
REVENUE
);

689 
	}
}

691 
q23_agg_agg»g©e_t
* 
	$şÚe
() const {

692  
Ãw
 
	`q23_agg_agg»g©e_t
(*
this
);

693 
	}
}

695 
c_¡r
 
	$to_¡ršg
() const {

697 
	}
}

704 
	sq23_sÜt_tu¶e_key
 {

705 
	mP_BRAND
[
STRSIZE
(9)];

706 
	mD_YEAR
;

710 
	gq23_Üd”_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

712 
q23_Üd”_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
( (
q23_sÜt_tu¶e_key
), 
off£tof
(
q23_agg»g©e_tu¶e
, 
P_BRAND
)) {

715 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

716 
q23_sÜt_tu¶e_key
* 
	g®igÃd_key
 = 
®igÃd_ÿ¡
<q23_sÜt_tu¶e_key> (
key
);

724 
	g»suÉ
=0;

725  
	g»suÉ
;

730 
vœtu®
 
q23_Üd”_key_exŒaùÜ_t
 * 
şÚe
() const {

731  
Ãw
 
q23_Üd”_key_exŒaùÜ_t
(*
this
);

735 
	gq23_Üd”_key_com·»_t
 : 
public
 
key_com·»_t
 {

737 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

738 
q23_sÜt_tu¶e_key
* 
	ga
 = 
®igÃd_ÿ¡
<q23_sÜt_tu¶e_key>(
key1
);

739 
q23_sÜt_tu¶e_key
* 
	gb
 = 
®igÃd_ÿ¡
<q23_sÜt_tu¶e_key>(
key2
);

741 
	gy—rcom·risÚ
 = 
a
->
D_YEAR
 - 
b
->D_YEAR;

742 ià(
	gy—rcom·risÚ
 !ğ0è 
y—rcom·risÚ
;

750 
vœtu®
 
q23_Üd”_key_com·»_t
 * 
şÚe
() const {

751  
Ãw
 
q23_Üd”_key_com·»_t
(*
this
);

760 şas 
	cssb_q23_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


762 
public
:

764 
	$begš
() {

765 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** q2_3 ANSWER ...\n");

766 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** ...\n");

769 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

770 
´ojeùed_tu¶e
 *
tu¶e
;

771 
tu¶e
 = 
®igÃd_ÿ¡
<
´ojeùed_tu¶e
>(
ouut
.
d©a
);

773 
	`TRACE
 ( 
TRACE_QUERY_RESULTS
, "PROCESS %d {%s} %d\n",
tu¶e
->
D_YEAR
,u¶e->
P_BRAND
,u¶e->
REVENUE
);

777 
	}
}

788 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_qpe_q2_3
(cÚ¡ 
xù_id
,

789 
q2_3_šput_t
& 
š
)

791 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** q2_3 *********\n");

794 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

795 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

799 
tu¶e_fifo
* 
lo_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q23_lo_tu¶e
));

800 
tsÿn_·ck‘_t
* 
q23_lo_tsÿn_·ck‘
 =

801 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN LINEORDER",

802 
lo_out_bufãr
,

803 
Ãw
 
	`q23_lšeÜd”_tsÿn_f‹r_t
(
this
),

804 
this
->
	`db
(),

805 
_¶šeÜd”_desc
.
	`g‘
(),

806 
pxù


810 
tu¶e_fifo
* 
s_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q23_s_tu¶e
));

811 
tsÿn_·ck‘_t
* 
q23_s_tsÿn_·ck‘
 =

812 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN SUPPLIER",

813 
s_out_bufãr
,

814 
Ãw
 
	`q23_suµl›r_tsÿn_f‹r_t
(
this
,
š
),

815 
this
->
	`db
(),

816 
_psuµl›r_desc
.
	`g‘
(),

817 
pxù


821 
tu¶e_fifo
* 
p_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q23_p_tu¶e
));

822 
tsÿn_·ck‘_t
* 
q23_p_tsÿn_·ck‘
 =

823 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN PART",

824 
p_out_bufãr
,

825 
Ãw
 
	`q23_·¹_tsÿn_f‹r_t
(
this
,
š
),

826 
this
->
	`db
(),

827 
_µ¬t_desc
.
	`g‘
(),

828 
pxù


832 
tu¶e_fifo
* 
d_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q23_d_tu¶e
));

833 
tsÿn_·ck‘_t
* 
q23_d_tsÿn_·ck‘
 =

834 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN DATE",

835 
d_out_bufãr
,

836 
Ãw
 
	`q23_d©e_tsÿn_f‹r_t
(
this
,
š
),

837 
this
->
	`db
(),

838 
_pd©e_desc
.
	`g‘
(),

839 
pxù


845 
tu¶e_fifo
* 
još_lo_s_out
 = 
Ãw
 
	`tu¶e_fifo
((
q23_još_s_tu¶e
));

846 
·ck‘_t
* 
q23_još_lo_s_·ck‘
 =

847 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier JOIN",

848 
još_lo_s_out
,

849 
Ãw
 
	`ŒivŸl_f‹r_t
((
q23_još_s_tu¶e
)),

850 
q23_lo_tsÿn_·ck‘
,

851 
q23_s_tsÿn_·ck‘
,

852 
Ãw
 
	`q23_lo_s_još_t
() );

855 
tu¶e_fifo
* 
još_lo_s_p_out
 = 
Ãw
 
	`tu¶e_fifo
((
q23_još_s_p_tu¶e
));

856 
·ck‘_t
* 
q23_još_lo_s_p_·ck‘
 =

857 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier - Part JOIN",

858 
još_lo_s_p_out
,

859 
Ãw
 
	`ŒivŸl_f‹r_t
((
q23_još_s_p_tu¶e
)),

860 
q23_još_lo_s_·ck‘
,

861 
q23_p_tsÿn_·ck‘
,

862 
Ãw
 
	`q23_lo_s_p_još_t
() );

865 
tu¶e_fifo
* 
još_out
 = 
Ãw
 
	`tu¶e_fifo
((
q23_još_tu¶e
));

866 
·ck‘_t
* 
q23_još_·ck‘
 =

867 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier - Part - Date JOIN",

868 
još_out
,

869 
Ãw
 
	`ŒivŸl_f‹r_t
((
q23_još_tu¶e
)),

870 
q23_još_lo_s_p_·ck‘
,

871 
q23_d_tsÿn_·ck‘
,

872 
Ãw
 
	`q23_još_t
() );

876 
tu¶e_fifo
* 
agg_ouut_bufãr
 =

877 
Ãw
 
	`tu¶e_fifo
( (
q23_agg»g©e_tu¶e
));

878 
·ck‘_t
* 
q23_agg_·ck‘
 =

879 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("AGG Q2_3",

880 
agg_ouut_bufãr
,

881 
Ãw
 
	`ŒivŸl_f‹r_t
(
agg_ouut_bufãr
->
	`tu¶e_size
()),

882 
q23_još_·ck‘
,

883 
Ãw
 
	`q23_agg_agg»g©e_t
(),

884 
Ãw
 
	`q23_agg_šput_tu¶e_key_exŒaùÜ_t
(),

885 
Ãw
 
	`q23_agg_šput_tu¶e_key_com·»_t
());

888 
tu¶e_fifo
* 
sÜt_fš®_out
 = 
Ãw
 
	`tu¶e_fifo
((
q23_agg»g©e_tu¶e
));

889 
·ck‘_t
* 
q23_sÜt_fš®_·ck‘
 =

890 
Ãw
 
	`sÜt_·ck‘_t
("ORDER BY D_YEAR ASC, REVENUE DESC",

891 
sÜt_fš®_out
,

892 
Ãw
 
	`ŒivŸl_f‹r_t
((
q23_agg»g©e_tu¶e
)),

893 
Ãw
 
	`q23_Üd”_key_exŒaùÜ_t
(),

894 
Ãw
 
	`q23_Üd”_key_com·»_t
(),

895 
q23_agg_·ck‘
);

898 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

899 
q23_lo_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

900 
q23_s_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

901 
q23_p_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

902 
q23_d_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

903 
q23_još_lo_s_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

904 
q23_još_lo_s_p_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

905 
q23_još_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

906 
q23_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

907 
q23_sÜt_fš®_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

910 
ssb_q23_´oûss_tu¶e_t
 
±
;

912 
	`´oûss_qu”y
(
q23_sÜt_fš®_·ck‘
, 
±
);

913 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

915  (
RCOK
);

916 
	}
}

919 
EXIT_NAMESPACE
(
ssb
);

	@src/workload/ssb/qpipe/qpipe_q3_1.cpp

33 
	~"wÜklßd/ssb/shÜe_ssb_’v.h
"

34 
	~"qpe.h
"

36 
usšg
 
Çme¥aû
 
	gshÜe
;

37 
usšg
 
Çme¥aû
 
	gqpe
;

41 
ENTER_NAMESPACE
(
ssb
);

64 
	sq31_lo_tu¶e


66 
	mLO_CUSTKEY
;

67 
	mLO_SUPPKEY
;

68 
	mLO_ORDERDATE
;

69 
	mLO_REVENUE
;

72 
	sq31_s_tu¶e


74 
	mS_SUPPKEY
;

75 
	mS_NATION
[16];

78 
	sq31_c_tu¶e


80 
	mC_CUSTKEY
;

81 
	mC_NATION
[16];

84 
	sq31_d_tu¶e


86 
	mD_DATEKEY
;

87 
	mD_YEAR
;

90 
	sq31_još_s_tu¶e


92 
	mLO_CUSTKEY
;

93 
	mS_NATION
[16];

94 
	mLO_REVENUE
;

95 
	mLO_ORDERDATE
;

98 
	sq31_još_s_c_tu¶e


100 
	mS_NATION
[16];

101 
	mC_NATION
[16];

102 
	mLO_REVENUE
;

103 
	mLO_ORDERDATE
;

107 
	sq31_još_tu¶e


109 
	mC_NATION
[16];

110 
	mS_NATION
[16];

111 
	mD_YEAR
;

112 
	mLO_REVENUE
;

116 
	sq31_agg»g©e_tu¶e


118 
	mC_NATION
[16];

119 
	mS_NATION
[16];

120 
	mD_YEAR
;

121 
	mREVENUE
;

128 
q31_agg»g©e_tu¶e
 
	t´ojeùed_tu¶e
;

131 şas 
	cq31_lšeÜd”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


133 
´iv©e
:

134 
ShÜeSSBEnv
* 
_ssbdb
;

135 
bË_row_t
* 
	m_´lše
;

136 
»p_row_t
 
	m_¼
;

138 
ssb_lšeÜd”_tu¶e
 
	m_lšeÜd”
;

140 
	mpublic
:

142 
	$q31_lšeÜd”_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
)

143 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

147 
_´lše
 = 
_ssbdb
->
	`lšeÜd”_mª
()->
	`g‘_tu¶e
();

148 
_¼
.
	`£t_ts
(
_ssbdb
->
	`lšeÜd”_mª
()->
	`ts
(),

149 
_ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
());

150 
_´lše
->
_»p
 = &
_¼
;

154 ~
	$q31_lšeÜd”_tsÿn_f‹r_t
()

157 
_ssbdb
->
	`lšeÜd”_mª
()->
	`give_tu¶e
(
_´lše
);

158 
	}
}

162 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

165 ià(!
_ssbdb
->
	`lšeÜd”_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

166 
	`as£¹
(
çl£
);

169  (
Œue
);

170 
	}
}

174 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

176 
q31_lo_tu¶e
 *
de¡
;

177 
de¡
 = 
®igÃd_ÿ¡
<
q31_lo_tu¶e
>(
d
.
d©a
);

179 
_´lše
->
	`g‘_v®ue
(2, 
_lšeÜd”
.
LO_CUSTKEY
);

180 
_´lše
->
	`g‘_v®ue
(4, 
_lšeÜd”
.
LO_SUPPKEY
);

181 
_´lše
->
	`g‘_v®ue
(5, 
_lšeÜd”
.
LO_ORDERDATE
);

182 
_´lše
->
	`g‘_v®ue
(12, 
_lšeÜd”
.
LO_REVENUE
);

185 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%d|%d|%d --d\n",

186 
_lšeÜd”
.
LO_CUSTKEY
,

187 
_lšeÜd”
.
LO_SUPPKEY
,

188 
_lšeÜd”
.
LO_ORDERDATE
,

189 
_lšeÜd”
.
LO_REVENUE
);

191 
de¡
->
LO_CUSTKEY
 = 
_lšeÜd”
.LO_CUSTKEY;

192 
de¡
->
LO_SUPPKEY
 = 
_lšeÜd”
.LO_SUPPKEY;

193 
de¡
->
LO_ORDERDATE
 = 
_lšeÜd”
.LO_ORDERDATE;

194 
de¡
->
LO_REVENUE
 = 
_lšeÜd”
.LO_REVENUE;

196 
	}
}

198 
q31_lšeÜd”_tsÿn_f‹r_t
* 
	$şÚe
() const {

199  
Ãw
 
	`q31_lšeÜd”_tsÿn_f‹r_t
(*
this
);

200 
	}
}

202 
c_¡r
 
	$to_¡ršg
() const {

203  
	`c_¡r
("q3_1_lineorder_tscan_filter_t()");

204 
	}
}

208 şas 
	cq31_cu¡om”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


210 
´iv©e
:

211 
ShÜeSSBEnv
* 
_ssbdb
;

212 
bË_row_t
* 
	m_´cu¡
;

213 
»p_row_t
 
	m_¼
;

215 
ssb_cu¡om”_tu¶e
 
	m_cu¡om”
;

218 
	mREGION
[13];

219 
	mpublic
:

221 
	$q31_cu¡om”_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q3_1_šput_t
 &
š
)

222 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`cu¡om”_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

226 
_´cu¡
 = 
_ssbdb
->
	`cu¡om”_mª
()->
	`g‘_tu¶e
();

227 
_¼
.
	`£t_ts
(
_ssbdb
->
	`cu¡om”_mª
()->
	`ts
(),

228 
_ssbdb
->
	`cu¡om”_desc
()->
	`maxsize
());

229 
_´cu¡
->
_»p
 = &
_¼
;

232 
	`¡rıy
(
REGION
,"ASIA");

235 ~
	$q31_cu¡om”_tsÿn_f‹r_t
()

238 
_ssbdb
->
	`cu¡om”_mª
()->
	`give_tu¶e
(
_´cu¡
);

239 
	}
}

243 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

246 ià(!
_ssbdb
->
	`cu¡om”_mª
()->
	`lßd
(
_´cu¡
, 
šput
.
d©a
)) {

247 
	`as£¹
(
çl£
);

250 
_´cu¡
->
	`g‘_v®ue
(5, 
_cu¡om”
.
C_REGION
, 
	`STRSIZE
(12));

252 ià(
	`¡rcmp
(
_cu¡om”
.
C_REGION
,
REGION
)==0)

254 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ REGION |%s --d\n",

255 
_cu¡om”
.
C_REGION
);

256  (
Œue
);

260 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". REGION |%s --d\n",

261 
_cu¡om”
.
C_REGION
);

262  (
çl£
);

264 
	}
}

268 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

270 
q31_c_tu¶e
 *
de¡
;

271 
de¡
 = 
®igÃd_ÿ¡
<
q31_c_tu¶e
>(
d
.
d©a
);

273 
_´cu¡
->
	`g‘_v®ue
(0, 
_cu¡om”
.
C_CUSTKEY
);

274 
_´cu¡
->
	`g‘_v®ue
(4, 
_cu¡om”
.
C_NATION
, 
	`STRSIZE
(15));

276 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%s --d\n",

277 
_cu¡om”
.
C_CUSTKEY
,

278 
_cu¡om”
.
C_NATION
);

281 
de¡
->
C_CUSTKEY
 = 
_cu¡om”
.C_CUSTKEY;

282 
	`¡rıy
(
de¡
->
C_NATION
,
_cu¡om”
.C_NATION);

283 
	}
}

285 
q31_cu¡om”_tsÿn_f‹r_t
* 
	$şÚe
() const {

286  
Ãw
 
	`q31_cu¡om”_tsÿn_f‹r_t
(*
this
);

287 
	}
}

289 
c_¡r
 
	$to_¡ršg
() const {

290  
	`c_¡r
("q31_customer_tscan_filter_t()");

291 
	}
}

295 şas 
	cq31_suµl›r_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


297 
´iv©e
:

298 
ShÜeSSBEnv
* 
_ssbdb
;

299 
bË_row_t
* 
	m_´suµ
;

300 
»p_row_t
 
	m_¼
;

302 
ssb_suµl›r_tu¶e
 
	m_suµl›r
;

305 
	mREGION
[13];

306 
	mpublic
:

308 
	$q31_suµl›r_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q3_1_šput_t
 &
š
)

309 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`suµl›r_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

313 
_´suµ
 = 
_ssbdb
->
	`suµl›r_mª
()->
	`g‘_tu¶e
();

314 
_¼
.
	`£t_ts
(
_ssbdb
->
	`suµl›r_mª
()->
	`ts
(),

315 
_ssbdb
->
	`suµl›r_desc
()->
	`maxsize
());

316 
_´suµ
->
_»p
 = &
_¼
;

319 
	`¡rıy
(
REGION
,"ASIA");

322 ~
	$q31_suµl›r_tsÿn_f‹r_t
()

325 
_ssbdb
->
	`suµl›r_mª
()->
	`give_tu¶e
(
_´suµ
);

326 
	}
}

330 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

333 ià(!
_ssbdb
->
	`suµl›r_mª
()->
	`lßd
(
_´suµ
, 
šput
.
d©a
)) {

334 
	`as£¹
(
çl£
);

337 
_´suµ
->
	`g‘_v®ue
(5, 
_suµl›r
.
S_REGION
, 
	`STRSIZE
(12));

340 ià(
	`¡rcmp
(
_suµl›r
.
S_REGION
,
REGION
)==0)

342 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ REGION |%s --d\n",

343 
_suµl›r
.
S_REGION
);

344  (
Œue
);

348 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". REGION |%s --d\n",

349 
_suµl›r
.
S_REGION
);

350  (
çl£
);

352 
	}
}

356 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

358 
q31_s_tu¶e
 *
de¡
;

359 
de¡
 = 
®igÃd_ÿ¡
<
q31_s_tu¶e
>(
d
.
d©a
);

361 
_´suµ
->
	`g‘_v®ue
(0, 
_suµl›r
.
S_SUPPKEY
);

362 
_´suµ
->
	`g‘_v®ue
(4, 
_suµl›r
.
S_NATION
, 
	`STRSIZE
(15));

364 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%s --d\n",

365 
_suµl›r
.
S_SUPPKEY
,

366 
_suµl›r
.
S_NATION
);

369 
de¡
->
S_SUPPKEY
 = 
_suµl›r
.S_SUPPKEY;

370 
	`¡rıy
(
de¡
->
S_NATION
,
_suµl›r
.S_NATION);

371 
	}
}

373 
q31_suµl›r_tsÿn_f‹r_t
* 
	$şÚe
() const {

374  
Ãw
 
	`q31_suµl›r_tsÿn_f‹r_t
(*
this
);

375 
	}
}

377 
c_¡r
 
	$to_¡ršg
() const {

378  
	`c_¡r
("q31_supplier_tscan_filter_t()");

379 
	}
}

384 şas 
	cq31_d©e_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


386 
´iv©e
:

387 
ShÜeSSBEnv
* 
_ssbdb
;

388 
bË_row_t
* 
	m_´d©e
;

389 
»p_row_t
 
	m_¼
;

391 
ssb_d©e_tu¶e
 
	m_d©e
;

394 
	mYEAR_LOW
;

395 
	mYEAR_HIGH
;

397 
	mpublic
:

399 
	$q31_d©e_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q3_1_šput_t
 &
š
)

400 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`d©e_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

404 
_´d©e
 = 
_ssbdb
->
	`d©e_mª
()->
	`g‘_tu¶e
();

405 
_¼
.
	`£t_ts
(
_ssbdb
->
	`d©e_mª
()->
	`ts
(),

406 
_ssbdb
->
	`d©e_desc
()->
	`maxsize
());

407 
_´d©e
->
_»p
 = &
_¼
;

409 
YEAR_LOW
=1992;

410 
YEAR_HIGH
=1997;

413 ~
	$q31_d©e_tsÿn_f‹r_t
()

416 
_ssbdb
->
	`d©e_mª
()->
	`give_tu¶e
(
_´d©e
);

417 
	}
}

421 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

424 ià(!
_ssbdb
->
	`d©e_mª
()->
	`lßd
(
_´d©e
, 
šput
.
d©a
)) {

425 
	`as£¹
(
çl£
);

428 
_´d©e
->
	`g‘_v®ue
(4, 
_d©e
.
D_YEAR
);

431 ià(
_d©e
.
D_YEAR
>=
YEAR_LOW
 && _d©e.D_YEAR<=
YEAR_HIGH
)

433 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ YEAR |%d --d\n",

434 
_d©e
.
D_YEAR
);

435  (
Œue
);

439 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". YEAR |%d --d\n",

440 
_d©e
.
D_YEAR
);

441  (
çl£
);

444 
	}
}

448 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

450 
q31_d_tu¶e
 *
de¡
;

451 
de¡
 = 
®igÃd_ÿ¡
<
q31_d_tu¶e
>(
d
.
d©a
);

453 
_´d©e
->
	`g‘_v®ue
(0, 
_d©e
.
D_DATEKEY
);

454 
_´d©e
->
	`g‘_v®ue
(4, 
_d©e
.
D_YEAR
);

456 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%d --d\n",

457 
_d©e
.
D_DATEKEY
,

458 
_d©e
.
D_YEAR
);

461 
de¡
->
D_DATEKEY
 = 
_d©e
.D_DATEKEY;

462 
de¡
->
D_YEAR
=
_d©e
.D_YEAR;

463 
	}
}

465 
q31_d©e_tsÿn_f‹r_t
* 
	$şÚe
() const {

466  
Ãw
 
	`q31_d©e_tsÿn_f‹r_t
(*
this
);

467 
	}
}

469 
c_¡r
 
	$to_¡ršg
() const {

470  
	`c_¡r
("q3_1_date_tscan_filter_t()");

471 
	}
}

476 
	gq31_lo_s_još_t
 : 
public
 
tu¶e_još_t
 {

479 
q31_lo_s_još_t
 ()

480 : 
tu¶e_još_t
((
q31_lo_tu¶e
),

481 
off£tof
(
q31_lo_tu¶e
, 
LO_SUPPKEY
),

482 (
q31_s_tu¶e
),

483 
off£tof
(
q31_s_tu¶e
, 
S_SUPPKEY
),

485 (
q31_još_s_tu¶e
))

490 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

491 cÚ¡ 
tu¶e_t
 &
Ëá
,

492 cÚ¡ 
tu¶e_t
 &
right
)

495 
q31_lo_tu¶e
* 
	glo
 = 
®igÃd_ÿ¡
<q31_lo_tu¶e>(
Ëá
.
d©a
);

496 
q31_s_tu¶e
* 
	gs
 = 
®igÃd_ÿ¡
<q31_s_tu¶e>(
right
.
d©a
);

497 
q31_još_s_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q31_još_s_tu¶e>(
de¡
.
d©a
);

500 
	g»t
->
	gLO_CUSTKEY
 = 
lo
->
LO_CUSTKEY
;

501 
	g»t
->
	gLO_ORDERDATE
 = 
lo
->
LO_ORDERDATE
;

502 
	g»t
->
	gLO_REVENUE
 = 
lo
->
LO_REVENUE
;

504 
¡rıy
(
»t
->
S_NATION
,
s
->S_NATION);

506 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN %d {%s} %d %d\n",
»t
->
LO_CUSTKEY
,„‘->
S_NATION
,„‘->
LO_ORDERDATE
,„‘->
LO_REVENUE
);

510 
vœtu®
 
q31_lo_s_još_t
* 
şÚe
() const {

511  
Ãw
 
q31_lo_s_još_t
(*
this
);

514 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

521 
	gq31_lo_s_c_još_t
 : 
public
 
tu¶e_još_t
 {

524 
q31_lo_s_c_još_t
 ()

525 : 
tu¶e_još_t
((
q31_još_s_tu¶e
),

526 
off£tof
(
q31_još_s_tu¶e
, 
LO_CUSTKEY
),

527 (
q31_c_tu¶e
),

528 
off£tof
(
q31_c_tu¶e
, 
C_CUSTKEY
),

530 (
q31_još_s_c_tu¶e
))

535 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

536 cÚ¡ 
tu¶e_t
 &
Ëá
,

537 cÚ¡ 
tu¶e_t
 &
right
)

540 
q31_još_s_tu¶e
* 
	gjo
 = 
®igÃd_ÿ¡
<q31_još_s_tu¶e>(
Ëá
.
d©a
);

541 
q31_c_tu¶e
* 
	gc
 = 
®igÃd_ÿ¡
<q31_c_tu¶e>(
right
.
d©a
);

542 
q31_još_s_c_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q31_još_s_c_tu¶e>(
de¡
.
d©a
);

544 
	g»t
->
	gLO_ORDERDATE
 = 
jo
->
LO_ORDERDATE
;

545 
	g»t
->
	gLO_REVENUE
 = 
jo
->
LO_REVENUE
;

546 
¡rıy
(
»t
->
S_NATION
,
jo
->S_NATION);

548 
¡rıy
(
»t
->
C_NATION
,
c
->C_NATION);

550 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN {%s} {%s} %d %d\n",
»t
->
C_NATION
,„‘->
S_NATION
,„‘->
LO_ORDERDATE
,„‘->
LO_REVENUE
);

554 
vœtu®
 
q31_lo_s_c_još_t
* 
şÚe
() const {

555  
Ãw
 
q31_lo_s_c_još_t
(*
this
);

558 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

565 
	gq31_još_t
 : 
public
 
tu¶e_još_t
 {

568 
q31_još_t
 ()

569 : 
tu¶e_još_t
((
q31_još_s_c_tu¶e
),

570 
off£tof
(
q31_još_s_c_tu¶e
, 
LO_ORDERDATE
),

571 (
q31_d_tu¶e
),

572 
off£tof
(
q31_d_tu¶e
, 
D_DATEKEY
),

574 (
q31_još_tu¶e
))

579 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

580 cÚ¡ 
tu¶e_t
 &
Ëá
,

581 cÚ¡ 
tu¶e_t
 &
right
)

584 
q31_još_s_c_tu¶e
* 
	gjo
 = 
®igÃd_ÿ¡
<q31_još_s_c_tu¶e>(
Ëá
.
d©a
);

585 
q31_d_tu¶e
* 
	gd
 = 
®igÃd_ÿ¡
<q31_d_tu¶e>(
right
.
d©a
);

586 
q31_još_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q31_još_tu¶e>(
de¡
.
d©a
);

588 
¡rıy
(
»t
->
C_NATION
,
jo
->C_NATION);

589 
¡rıy
(
»t
->
S_NATION
,
jo
->S_NATION);

590 
	g»t
->
	gLO_REVENUE
 = 
jo
->
LO_REVENUE
;

592 
	g»t
->
	gD_YEAR
 = 
d
->
D_YEAR
;

593 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN {%s} {%s} %d %d\n",
»t
->
C_NATION
,„‘->
S_NATION
,„‘->
D_YEAR
,„‘->
LO_REVENUE
);

597 
vœtu®
 
q31_još_t
* 
şÚe
() const {

598  
Ãw
 
q31_još_t
(*
this
);

601 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

610 
	sq31_agg_šput_tu¶e_key
 {

612 
	mS_NATION
[
STRSIZE
(15)];

613 
	mC_NATION
[
STRSIZE
(15)];

614 
	mD_YEAR
;

616 
exŒaù_hšt
() {

617  (
	mthis
->
	mC_NATION
[0] << 24è+ (this->C_NATION[1] << 16è+ (this->
	mS_NATION
[0] << 8è+ (this->
	mD_YEAR
 - 1990);

621 
	gq31_agg_šput_tu¶e_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

623 
q31_agg_šput_tu¶e_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
((
q31_agg_šput_tu¶e_key
), 
off£tof
(
q31_još_tu¶e
, 
C_NATION
)) {

626 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

627 
q31_agg_šput_tu¶e_key
* 
	g®igÃd_key
 = 
®igÃd_ÿ¡
<q31_agg_šput_tu¶e_key>(
key
);

647  
	g®igÃd_key
->
exŒaù_hšt
();

652 
vœtu®
 
q31_agg_šput_tu¶e_key_exŒaùÜ_t
 * 
şÚe
() const {

653  
Ãw
 
q31_agg_šput_tu¶e_key_exŒaùÜ_t
(*
this
);

657 
	gq31_agg_šput_tu¶e_key_com·»_t
 : 
public
 
key_com·»_t
 {

659 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

660 
q31_agg_šput_tu¶e_key
* 
	ga
 = 
®igÃd_ÿ¡
<q31_agg_šput_tu¶e_key>(
key1
);

661 
q31_agg_šput_tu¶e_key
* 
	gb
 = 
®igÃd_ÿ¡
<q31_agg_šput_tu¶e_key>(
key2
);

663 
	gcc™ycom·risÚ
 = 
¡rcmp
(
a
->
C_NATION
, 
b
->C_NATION);

664 ià(
	gcc™ycom·risÚ
 !ğ0è 
cc™ycom·risÚ
;

665 
	gsc™ycom·risÚ
 = 
¡rcmp
(
a
->
S_NATION
, 
b
->S_NATION);

666 ià(
	gsc™ycom·risÚ
 !ğ0è 
sc™ycom·risÚ
;

667  
	ga
->
	gD_YEAR
 - 
	gb
->D_YEAR;

670 
vœtu®
 
q31_agg_šput_tu¶e_key_com·»_t
 * 
şÚe
() const {

671  
Ãw
 
q31_agg_šput_tu¶e_key_com·»_t
(*
this
);

676 
q31_agg_šput_tu¶e_key
 
	tq31_agg_tu¶e_key
;

678 şas 
	cq31_agg_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

679 
´iv©e
:

681 
q31_agg_ouut_tu¶e_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

683 
q31_agg_ouut_tu¶e_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
( (
q31_agg_tu¶e_key
), 
off£tof
(
q31_agg»g©e_tu¶e
, 
C_NATION
)) {

686 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

687 
q31_agg_tu¶e_key
* 
	m®igÃd_key
 = 
®igÃd_ÿ¡
<q31_agg_tu¶e_key > (
key
);

688  
	m®igÃd_key
->
exŒaù_hšt
();

691 
vœtu®
 
q31_agg_ouut_tu¶e_key_exŒaùÜ_t
 * 
şÚe
() const {

692  
Ãw
 
q31_agg_ouut_tu¶e_key_exŒaùÜ_t
(*
this
);

696 
q31_agg_ouut_tu¶e_key_exŒaùÜ_t
 
	g_exŒaùÜ
;

698 
	gpublic
:

700 
	$q31_agg_agg»g©e_t
()

701 : 
	`tu¶e_agg»g©e_t
((
q31_agg»g©e_tu¶e
)) {

702 
	}
}

704 
key_exŒaùÜ_t
* 
	$key_exŒaùÜ
() {

705  &
_exŒaùÜ
;

706 
	}
}

708 
	$agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
s
) {

709 
q31_još_tu¶e
 *
¤c
;

710 
¤c
 = 
®igÃd_ÿ¡
<
q31_još_tu¶e
> (
s
.
d©a
);

711 
q31_agg»g©e_tu¶e
* 
tu¶e
 = 
®igÃd_ÿ¡
<q31_agg»g©e_tu¶e>(
agg_d©a
);

713 
tu¶e
->
REVENUE
 +ğ
¤c
->
LO_REVENUE
;

714 
	`TRACE
(
TRACE_RECORD_FLOW
, "%.2f\n", 
tu¶e
->
REVENUE
);

715 
	}
}

717 
	$fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

718 
q31_agg»g©e_tu¶e
 *
de¡
;

719 
de¡
 = 
®igÃd_ÿ¡
<
q31_agg»g©e_tu¶e
 > (
d
.
d©a
);

720 
q31_agg»g©e_tu¶e
* 
tu¶e
 = 
®igÃd_ÿ¡
<q31_agg»g©e_tu¶> (
agg_d©a
);

722 *
de¡
 = *
tu¶e
;

723 
	}
}

725 
q31_agg_agg»g©e_t
* 
	$şÚe
() const {

726  
Ãw
 
	`q31_agg_agg»g©e_t
(*
this
);

727 
	}
}

729 
c_¡r
 
	$to_¡ršg
() const {

731 
	}
}

736 
	sq31_sÜt_tu¶e_key
 {

737 
	mD_YEAR
;

738 
	mREVENUE
;

741 
	gq31_Üd”_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

743 
q31_Üd”_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
( (
q31_sÜt_tu¶e_key
), 
off£tof
(
q31_agg»g©e_tu¶e
, 
D_YEAR
)) {

746 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

747 
q31_sÜt_tu¶e_key
* 
	g®igÃd_key
 = 
®igÃd_ÿ¡
<q31_sÜt_tu¶e_key> (
key
);

753 
	g»suÉ
 = ((
®igÃd_key
->
D_YEAR
 - 1992è<< 28è- ((×ligÃd_key->
REVENUE
) & ~(15)) >> 4);

766  
	g»suÉ
;

771 
vœtu®
 
q31_Üd”_key_exŒaùÜ_t
 * 
şÚe
() const {

772  
Ãw
 
q31_Üd”_key_exŒaùÜ_t
(*
this
);

776 
	gq31_Üd”_key_com·»_t
 : 
public
 
key_com·»_t
 {

778 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

779 
q31_sÜt_tu¶e_key
* 
	ga
 = 
®igÃd_ÿ¡
<q31_sÜt_tu¶e_key>(
key1
);

780 
q31_sÜt_tu¶e_key
* 
	gb
 = 
®igÃd_ÿ¡
<q31_sÜt_tu¶e_key>(
key2
);

782 
	gy—rcom·risÚ
 = 
a
->
D_YEAR
 - 
b
->D_YEAR;

783 ià(
	gy—rcom·risÚ
 !ğ0è 
y—rcom·risÚ
;

784 ià(
	ga
->
	gREVENUE
 > 
	gb
->REVENUE)

786 ià(
	ga
->
	gREVENUE
 < 
	gb
->REVENUE)

792 
vœtu®
 
q31_Üd”_key_com·»_t
 * 
şÚe
() const {

793  
Ãw
 
q31_Üd”_key_com·»_t
(*
this
);

799 şas 
	cssb_q31_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


801 
public
:

803 
	$begš
() {

804 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** q3_1 ANSWER ...\n");

805 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** ...\n");

808 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

809 
´ojeùed_tu¶e
 *
tu¶e
;

810 
tu¶e
 = 
®igÃd_ÿ¡
<
´ojeùed_tu¶e
>(
ouut
.
d©a
);

812 
	`TRACE
 ( 
TRACE_QUERY_RESULTS
, "PROCESS {%15s} {%15s} %d %d\n",
tu¶e
->
C_NATION
 ,u¶e->
S_NATION
,u¶e->
D_YEAR
,u¶e->
REVENUE
);

815 
	}
}

826 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_qpe_q3_1
(cÚ¡ 
xù_id
,

827 
q3_1_šput_t
& 
š
)

829 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** q3_1 *********\n");

832 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

833 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

837 
tu¶e_fifo
* 
lo_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q31_lo_tu¶e
));

838 
tsÿn_·ck‘_t
* 
lo_tsÿn_·ck‘
 =

839 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN LINEORDER",

840 
lo_out_bufãr
,

841 
Ãw
 
	`q31_lšeÜd”_tsÿn_f‹r_t
(
this
),

842 
this
->
	`db
(),

843 
_¶šeÜd”_desc
.
	`g‘
(),

844 
pxù


849 
tu¶e_fifo
* 
s_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q31_s_tu¶e
));

850 
tsÿn_·ck‘_t
* 
s_tsÿn_·ck‘
 =

851 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN SUPPLIER",

852 
s_out_bufãr
,

853 
Ãw
 
	`q31_suµl›r_tsÿn_f‹r_t
(
this
,
š
),

854 
this
->
	`db
(),

855 
_psuµl›r_desc
.
	`g‘
(),

856 
pxù


861 
tu¶e_fifo
* 
c_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q31_c_tu¶e
));

862 
tsÿn_·ck‘_t
* 
c_tsÿn_·ck‘
 =

863 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN CUSTOMER",

864 
c_out_bufãr
,

865 
Ãw
 
	`q31_cu¡om”_tsÿn_f‹r_t
(
this
,
š
),

866 
this
->
	`db
(),

867 
_pcu¡om”_desc
.
	`g‘
(),

868 
pxù


873 
tu¶e_fifo
* 
d_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q31_d_tu¶e
));

874 
tsÿn_·ck‘_t
* 
d_tsÿn_·ck‘
 =

875 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN DATE",

876 
d_out_bufãr
,

877 
Ãw
 
	`q31_d©e_tsÿn_f‹r_t
(
this
,
š
),

878 
this
->
	`db
(),

879 
_pd©e_desc
.
	`g‘
(),

880 
pxù


886 
tu¶e_fifo
* 
još_lo_s_out
 = 
Ãw
 
	`tu¶e_fifo
((
q31_još_s_tu¶e
));

887 
·ck‘_t
* 
još_lo_s_·ck‘
 =

888 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier JOIN",

889 
još_lo_s_out
,

890 
Ãw
 
	`ŒivŸl_f‹r_t
((
q31_još_s_tu¶e
)),

891 
lo_tsÿn_·ck‘
,

892 
s_tsÿn_·ck‘
,

893 
Ãw
 
	`q31_lo_s_još_t
() );

896 
tu¶e_fifo
* 
još_lo_s_c_out
 = 
Ãw
 
	`tu¶e_fifo
((
q31_još_s_c_tu¶e
));

897 
·ck‘_t
* 
još_lo_s_c_·ck‘
 =

898 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier - Customer JOIN",

899 
još_lo_s_c_out
,

900 
Ãw
 
	`ŒivŸl_f‹r_t
((
q31_još_s_c_tu¶e
)),

901 
još_lo_s_·ck‘
,

902 
c_tsÿn_·ck‘
,

903 
Ãw
 
	`q31_lo_s_c_još_t
() );

906 
tu¶e_fifo
* 
još_out
 = 
Ãw
 
	`tu¶e_fifo
((
q31_još_tu¶e
));

907 
·ck‘_t
* 
još_·ck‘
 =

908 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier - Customer - Date JOIN",

909 
još_out
,

910 
Ãw
 
	`ŒivŸl_f‹r_t
((
q31_još_tu¶e
)),

911 
još_lo_s_c_·ck‘
,

912 
d_tsÿn_·ck‘
,

913 
Ãw
 
	`q31_još_t
() );

916 
tu¶e_fifo
* 
agg_ouut_bufãr
 =

917 
Ãw
 
	`tu¶e_fifo
( (
q31_agg»g©e_tu¶e
));

918 
·ck‘_t
* 
q31_agg_·ck‘
 =

919 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("AGG Q3_1",

920 
agg_ouut_bufãr
,

921 
Ãw
 
	`ŒivŸl_f‹r_t
(
agg_ouut_bufãr
->
	`tu¶e_size
()),

922 
još_·ck‘
,

923 
Ãw
 
	`q31_agg_agg»g©e_t
(),

924 
Ãw
 
	`q31_agg_šput_tu¶e_key_exŒaùÜ_t
(),

925 
Ãw
 
	`q31_agg_šput_tu¶e_key_com·»_t
());

927 
tu¶e_fifo
* 
sÜt_fš®_out
 = 
Ãw
 
	`tu¶e_fifo
((
q31_agg»g©e_tu¶e
));

928 
·ck‘_t
* 
q31_sÜt_fš®_·ck‘
 =

929 
Ãw
 
	`sÜt_·ck‘_t
("ORDER BY D_YEAR ASC, REVENUE DESC",

930 
sÜt_fš®_out
,

931 
Ãw
 
	`ŒivŸl_f‹r_t
((
q31_agg»g©e_tu¶e
)),

932 
Ãw
 
	`q31_Üd”_key_exŒaùÜ_t
(),

933 
Ãw
 
	`q31_Üd”_key_com·»_t
(),

934 
q31_agg_·ck‘
);

936 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

937 
lo_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

938 
s_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

939 
c_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

940 
d_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

941 
još_lo_s_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

942 
još_lo_s_c_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

943 
još_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

944 
q31_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

945 
q31_sÜt_fš®_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

948 
ssb_q31_´oûss_tu¶e_t
 
±
;

949 
	`´oûss_qu”y
(
q31_sÜt_fš®_·ck‘
, 
±
);

950 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

952  (
RCOK
);

953 
	}
}

956 
EXIT_NAMESPACE
(
ssb
);

	@src/workload/ssb/qpipe/qpipe_q3_2.cpp

32 
	~"wÜklßd/ssb/shÜe_ssb_’v.h
"

33 
	~"qpe.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
usšg
 
Çme¥aû
 
	gqpe
;

40 
ENTER_NAMESPACE
(
ssb
);

63 
	sq32_lo_tu¶e


65 
	mLO_CUSTKEY
;

66 
	mLO_SUPPKEY
;

67 
	mLO_ORDERDATE
;

68 
	mLO_REVENUE
;

71 
	sq32_c_tu¶e


73 
	mC_CUSTKEY
;

74 
	mC_CITY
[11];

77 
	sq32_s_tu¶e


79 
	mS_SUPPKEY
;

80 
	mS_CITY
[11];

83 
	sq32_d_tu¶e


85 
	mD_DATEKEY
;

86 
	mD_YEAR
;

89 
	sq32_još_d_tu¶e


91 
	mLO_CUSTKEY
;

92 
	mLO_SUPPKEY
;

93 
	mD_YEAR
;

94 
	mLO_REVENUE
;

97 
	sq32_još_d_s_tu¶e


99 
	mLO_CUSTKEY
;

100 
	mS_CITY
[11];

101 
	mD_YEAR
;

102 
	mLO_REVENUE
;

106 
	sq32_još_tu¶e


108 
	mC_CITY
[11];

109 
	mS_CITY
[11];

110 
	mD_YEAR
;

111 
	mLO_REVENUE
;

114 
	sq32_agg»g©e_tu¶e


116 
	mC_CITY
[11];

117 
	mS_CITY
[11];

118 
	mD_YEAR
;

119 
	mREVENUE
;

127 
q32_agg»g©e_tu¶e
 
	t´ojeùed_tu¶e
;

130 şas 
	cq32_lšeÜd”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


132 
´iv©e
:

133 
ShÜeSSBEnv
* 
_ssbdb
;

134 
bË_row_t
* 
	m_´lše
;

135 
»p_row_t
 
	m_¼
;

137 
ssb_lšeÜd”_tu¶e
 
	m_lšeÜd”
;

139 
	mpublic
:

141 
	$q32_lšeÜd”_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
)

142 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

146 
_´lše
 = 
_ssbdb
->
	`lšeÜd”_mª
()->
	`g‘_tu¶e
();

147 
_¼
.
	`£t_ts
(
_ssbdb
->
	`lšeÜd”_mª
()->
	`ts
(),

148 
_ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
());

149 
_´lše
->
_»p
 = &
_¼
;

153 ~
	$q32_lšeÜd”_tsÿn_f‹r_t
()

156 
_ssbdb
->
	`lšeÜd”_mª
()->
	`give_tu¶e
(
_´lše
);

157 
	}
}

161 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

164 ià(!
_ssbdb
->
	`lšeÜd”_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

165 
	`as£¹
(
çl£
);

168  (
Œue
);

169 
	}
}

173 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

175 
q32_lo_tu¶e
 *
de¡
;

176 
de¡
 = 
®igÃd_ÿ¡
<
q32_lo_tu¶e
>(
d
.
d©a
);

178 
_´lše
->
	`g‘_v®ue
(2, 
_lšeÜd”
.
LO_CUSTKEY
);

179 
_´lše
->
	`g‘_v®ue
(4, 
_lšeÜd”
.
LO_SUPPKEY
);

180 
_´lše
->
	`g‘_v®ue
(5, 
_lšeÜd”
.
LO_ORDERDATE
);

181 
_´lše
->
	`g‘_v®ue
(12, 
_lšeÜd”
.
LO_REVENUE
);

184 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%d|%d|%d --d\n",

185 
_lšeÜd”
.
LO_CUSTKEY
,

186 
_lšeÜd”
.
LO_SUPPKEY
,

187 
_lšeÜd”
.
LO_ORDERDATE
,

188 
_lšeÜd”
.
LO_REVENUE
);

190 
de¡
->
LO_CUSTKEY
 = 
_lšeÜd”
.LO_CUSTKEY;

191 
de¡
->
LO_SUPPKEY
 = 
_lšeÜd”
.LO_SUPPKEY;

192 
de¡
->
LO_ORDERDATE
 = 
_lšeÜd”
.LO_ORDERDATE;

193 
de¡
->
LO_REVENUE
 = 
_lšeÜd”
.LO_REVENUE;

195 
	}
}

197 
q32_lšeÜd”_tsÿn_f‹r_t
* 
	$şÚe
() const {

198  
Ãw
 
	`q32_lšeÜd”_tsÿn_f‹r_t
(*
this
);

199 
	}
}

201 
c_¡r
 
	$to_¡ršg
() const {

202  
	`c_¡r
("q32_lineorder_tscan_filter_t()");

203 
	}
}

207 şas 
	cq32_cu¡om”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


209 
´iv©e
:

210 
ShÜeSSBEnv
* 
_ssbdb
;

211 
bË_row_t
* 
	m_´cu¡
;

212 
»p_row_t
 
	m_¼
;

214 
ssb_cu¡om”_tu¶e
 
	m_cu¡om”
;

217 
	mNATION
[16];

218 
	mpublic
:

220 
	$q32_cu¡om”_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q3_2_šput_t
 &
š
)

221 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`cu¡om”_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

225 
_´cu¡
 = 
_ssbdb
->
	`cu¡om”_mª
()->
	`g‘_tu¶e
();

226 
_¼
.
	`£t_ts
(
_ssbdb
->
	`cu¡om”_mª
()->
	`ts
(),

227 
_ssbdb
->
	`cu¡om”_desc
()->
	`maxsize
());

228 
_´cu¡
->
_»p
 = &
_¼
;

231 
	`¡rıy
(
NATION
,"UNITED STATES");

234 ~
	$q32_cu¡om”_tsÿn_f‹r_t
()

237 
_ssbdb
->
	`cu¡om”_mª
()->
	`give_tu¶e
(
_´cu¡
);

238 
	}
}

242 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

245 ià(!
_ssbdb
->
	`cu¡om”_mª
()->
	`lßd
(
_´cu¡
, 
šput
.
d©a
)) {

246 
	`as£¹
(
çl£
);

249 
_´cu¡
->
	`g‘_v®ue
(4, 
_cu¡om”
.
C_NATION
, 
	`STRSIZE
(15));

251 ià(
	`¡rcmp
(
_cu¡om”
.
C_NATION
,
NATION
)==0)

253 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ NATION |%s --d\n",

254 
_cu¡om”
.
C_NATION
);

255  (
Œue
);

259 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". NATION |%s --d\n",

260 
_cu¡om”
.
C_NATION
);

261  (
çl£
);

263 
	}
}

267 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

269 
q32_c_tu¶e
 *
de¡
;

270 
de¡
 = 
®igÃd_ÿ¡
<
q32_c_tu¶e
>(
d
.
d©a
);

272 
_´cu¡
->
	`g‘_v®ue
(0, 
_cu¡om”
.
C_CUSTKEY
);

273 
_´cu¡
->
	`g‘_v®ue
(3, 
_cu¡om”
.
C_CITY
, 
	`STRSIZE
(10));

275 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%s --d\n",

276 
_cu¡om”
.
C_CUSTKEY
,

277 
_cu¡om”
.
C_CITY
);

280 
de¡
->
C_CUSTKEY
 = 
_cu¡om”
.C_CUSTKEY;

281 
	`¡rıy
(
de¡
->
C_CITY
,
_cu¡om”
.C_CITY);

282 
	}
}

284 
q32_cu¡om”_tsÿn_f‹r_t
* 
	$şÚe
() const {

285  
Ãw
 
	`q32_cu¡om”_tsÿn_f‹r_t
(*
this
);

286 
	}
}

288 
c_¡r
 
	$to_¡ršg
() const {

289  
	`c_¡r
("q32_customer_tscan_filter_t()");

290 
	}
}

294 şas 
	cq32_suµl›r_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


296 
´iv©e
:

297 
ShÜeSSBEnv
* 
_ssbdb
;

298 
bË_row_t
* 
	m_´suµ
;

299 
»p_row_t
 
	m_¼
;

301 
ssb_suµl›r_tu¶e
 
	m_suµl›r
;

304 
	mNATION
[16];

305 
	mpublic
:

307 
	$q32_suµl›r_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q3_2_šput_t
 &
š
)

308 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`suµl›r_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

312 
_´suµ
 = 
_ssbdb
->
	`suµl›r_mª
()->
	`g‘_tu¶e
();

313 
_¼
.
	`£t_ts
(
_ssbdb
->
	`suµl›r_mª
()->
	`ts
(),

314 
_ssbdb
->
	`suµl›r_desc
()->
	`maxsize
());

315 
_´suµ
->
_»p
 = &
_¼
;

318 
	`¡rıy
(
NATION
,"UNITED STATES");

321 ~
	$q32_suµl›r_tsÿn_f‹r_t
()

324 
_ssbdb
->
	`suµl›r_mª
()->
	`give_tu¶e
(
_´suµ
);

325 
	}
}

329 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

332 ià(!
_ssbdb
->
	`suµl›r_mª
()->
	`lßd
(
_´suµ
, 
šput
.
d©a
)) {

333 
	`as£¹
(
çl£
);

336 
_´suµ
->
	`g‘_v®ue
(4, 
_suµl›r
.
S_NATION
, 
	`STRSIZE
(15));

339 ià(
	`¡rcmp
(
_suµl›r
.
S_NATION
,
NATION
)==0)

341 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ NATION |%s --d\n",

342 
_suµl›r
.
S_NATION
);

343  (
Œue
);

347 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". NATION |%s --d\n",

348 
_suµl›r
.
S_NATION
);

349  (
çl£
);

351 
	}
}

355 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

357 
q32_s_tu¶e
 *
de¡
;

358 
de¡
 = 
®igÃd_ÿ¡
<
q32_s_tu¶e
>(
d
.
d©a
);

360 
_´suµ
->
	`g‘_v®ue
(0, 
_suµl›r
.
S_SUPPKEY
);

361 
_´suµ
->
	`g‘_v®ue
(3, 
_suµl›r
.
S_CITY
, 
	`STRSIZE
(10));

363 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%s --d\n",

364 
_suµl›r
.
S_SUPPKEY
,

365 
_suµl›r
.
S_CITY
);

368 
de¡
->
S_SUPPKEY
 = 
_suµl›r
.S_SUPPKEY;

369 
	`¡rıy
(
de¡
->
S_CITY
,
_suµl›r
.S_CITY);

370 
	}
}

372 
q32_suµl›r_tsÿn_f‹r_t
* 
	$şÚe
() const {

373  
Ãw
 
	`q32_suµl›r_tsÿn_f‹r_t
(*
this
);

374 
	}
}

376 
c_¡r
 
	$to_¡ršg
() const {

377  
	`c_¡r
("q32_supplier_tscan_filter_t()");

378 
	}
}

383 şas 
	cq32_d©e_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


385 
´iv©e
:

386 
ShÜeSSBEnv
* 
_ssbdb
;

387 
bË_row_t
* 
	m_´d©e
;

388 
»p_row_t
 
	m_¼
;

390 
ssb_d©e_tu¶e
 
	m_d©e
;

393 
	mYEAR_LOW
;

394 
	mYEAR_HIGH
;

396 
	mpublic
:

398 
	$q32_d©e_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q3_2_šput_t
 &
š
)

399 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`d©e_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

403 
_´d©e
 = 
_ssbdb
->
	`d©e_mª
()->
	`g‘_tu¶e
();

404 
_¼
.
	`£t_ts
(
_ssbdb
->
	`d©e_mª
()->
	`ts
(),

405 
_ssbdb
->
	`d©e_desc
()->
	`maxsize
());

406 
_´d©e
->
_»p
 = &
_¼
;

408 
YEAR_LOW
=1992;

409 
YEAR_HIGH
=1997;

412 ~
	$q32_d©e_tsÿn_f‹r_t
()

415 
_ssbdb
->
	`d©e_mª
()->
	`give_tu¶e
(
_´d©e
);

416 
	}
}

420 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

423 ià(!
_ssbdb
->
	`d©e_mª
()->
	`lßd
(
_´d©e
, 
šput
.
d©a
)) {

424 
	`as£¹
(
çl£
);

427 
_´d©e
->
	`g‘_v®ue
(4, 
_d©e
.
D_YEAR
);

430 ià(
_d©e
.
D_YEAR
>=
YEAR_LOW
 && _d©e.D_YEAR<=
YEAR_HIGH
)

432 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ YEAR |%d --d\n",

433 
_d©e
.
D_YEAR
);

434  (
Œue
);

438 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". YEAR |%d --d\n",

439 
_d©e
.
D_YEAR
);

440  (
çl£
);

443 
	}
}

447 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

449 
q32_d_tu¶e
 *
de¡
;

450 
de¡
 = 
®igÃd_ÿ¡
<
q32_d_tu¶e
>(
d
.
d©a
);

452 
_´d©e
->
	`g‘_v®ue
(0, 
_d©e
.
D_DATEKEY
);

453 
_´d©e
->
	`g‘_v®ue
(4, 
_d©e
.
D_YEAR
);

455 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%d --d\n",

456 
_d©e
.
D_DATEKEY
,

457 
_d©e
.
D_YEAR
);

460 
de¡
->
D_DATEKEY
 = 
_d©e
.D_DATEKEY;

461 
de¡
->
D_YEAR
=
_d©e
.D_YEAR;

462 
	}
}

464 
q32_d©e_tsÿn_f‹r_t
* 
	$şÚe
() const {

465  
Ãw
 
	`q32_d©e_tsÿn_f‹r_t
(*
this
);

466 
	}
}

468 
c_¡r
 
	$to_¡ršg
() const {

469  
	`c_¡r
("q32_date_tscan_filter_t()");

470 
	}
}

475 
	gq32_lo_d_još_t
 : 
public
 
tu¶e_još_t
 {

478 
q32_lo_d_još_t
 ()

479 : 
tu¶e_još_t
((
q32_lo_tu¶e
),

480 
off£tof
(
q32_lo_tu¶e
, 
LO_ORDERDATE
),

481 (
q32_d_tu¶e
),

482 
off£tof
(
q32_d_tu¶e
, 
D_DATEKEY
),

484 (
q32_još_d_tu¶e
))

489 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

490 cÚ¡ 
tu¶e_t
 &
Ëá
,

491 cÚ¡ 
tu¶e_t
 &
right
)

494 
q32_lo_tu¶e
* 
	glo
 = 
®igÃd_ÿ¡
<q32_lo_tu¶e>(
Ëá
.
d©a
);

495 
q32_d_tu¶e
* 
	gd
 = 
®igÃd_ÿ¡
<q32_d_tu¶e>(
right
.
d©a
);

496 
q32_još_d_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q32_još_d_tu¶e>(
de¡
.
d©a
);

498 
	g»t
->
	gLO_CUSTKEY
 = 
lo
->
LO_CUSTKEY
;

499 
	g»t
->
	gLO_SUPPKEY
 = 
lo
->
LO_SUPPKEY
;

500 
	g»t
->
	gLO_REVENUE
 = 
lo
->
LO_REVENUE
;

502 
	g»t
->
	gD_YEAR
 = 
d
->
D_YEAR
;

504 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN %d %d %d %d\n",
»t
->
LO_CUSTKEY
,„‘->
LO_SUPPKEY
,„‘->
D_YEAR
,„‘->
LO_REVENUE
);

508 
vœtu®
 
q32_lo_d_još_t
* 
şÚe
() const {

509  
Ãw
 
q32_lo_d_još_t
(*
this
);

512 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

519 
	gq32_lo_d_s_još_t
 : 
public
 
tu¶e_još_t
 {

522 
q32_lo_d_s_još_t
 ()

523 : 
tu¶e_još_t
((
q32_još_d_tu¶e
),

524 
off£tof
(
q32_još_d_tu¶e
, 
LO_SUPPKEY
),

525 (
q32_s_tu¶e
),

526 
off£tof
(
q32_s_tu¶e
, 
S_SUPPKEY
),

528 (
q32_još_d_s_tu¶e
))

533 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

534 cÚ¡ 
tu¶e_t
 &
Ëá
,

535 cÚ¡ 
tu¶e_t
 &
right
)

538 
q32_još_d_tu¶e
* 
	gjo
 = 
®igÃd_ÿ¡
<q32_još_d_tu¶e>(
Ëá
.
d©a
);

539 
q32_s_tu¶e
* 
	gs
 = 
®igÃd_ÿ¡
<q32_s_tu¶e>(
right
.
d©a
);

540 
q32_još_d_s_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q32_još_d_s_tu¶e>(
de¡
.
d©a
);

542 
	g»t
->
	gLO_CUSTKEY
 = 
jo
->
LO_CUSTKEY
;

543 
	g»t
->
	gD_YEAR
 = 
jo
->
D_YEAR
;

544 
	g»t
->
	gLO_REVENUE
 = 
jo
->
LO_REVENUE
;

547 
¡rıy
(
»t
->
S_CITY
,
s
->S_CITY);

549 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN %d {%s} %d %d\n",
»t
->
LO_CUSTKEY
,„‘->
S_CITY
,„‘->
D_YEAR
,„‘->
LO_REVENUE
);

553 
vœtu®
 
q32_lo_d_s_još_t
* 
şÚe
() const {

554  
Ãw
 
q32_lo_d_s_još_t
(*
this
);

557 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

564 
	gq32_još_t
 : 
public
 
tu¶e_još_t
 {

567 
q32_još_t
 ()

568 : 
tu¶e_još_t
((
q32_još_d_s_tu¶e
),

569 
off£tof
(
q32_još_d_s_tu¶e
, 
LO_CUSTKEY
),

570 (
q32_c_tu¶e
),

571 
off£tof
(
q32_c_tu¶e
, 
C_CUSTKEY
),

573 (
q32_još_tu¶e
))

578 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

579 cÚ¡ 
tu¶e_t
 &
Ëá
,

580 cÚ¡ 
tu¶e_t
 &
right
)

583 
q32_još_d_s_tu¶e
* 
	gjo
 = 
®igÃd_ÿ¡
<q32_još_d_s_tu¶e>(
Ëá
.
d©a
);

584 
q32_c_tu¶e
* 
	gc
 = 
®igÃd_ÿ¡
<q32_c_tu¶e>(
right
.
d©a
);

585 
q32_još_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q32_još_tu¶e>(
de¡
.
d©a
);

587 
¡rıy
(
»t
->
S_CITY
,
jo
->S_CITY);

588 
	g»t
->
	gD_YEAR
 = 
jo
->
D_YEAR
;

589 
	g»t
->
	gLO_REVENUE
 = 
jo
->
LO_REVENUE
;

591 
¡rıy
(
»t
->
C_CITY
,
c
->C_CITY);

593 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN {%s} {%s} %d %d\n",
»t
->
C_CITY
,„‘->
S_CITY
,„‘->
D_YEAR
,„‘->
LO_REVENUE
);

597 
vœtu®
 
q32_još_t
* 
şÚe
() const {

598  
Ãw
 
q32_još_t
(*
this
);

601 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

612 
	sq32_agg_šput_tu¶e_key
 {

613 
	mC_CITY
[
STRSIZE
(10)];

614 
	mS_CITY
[
STRSIZE
(10)];

615 
	mD_YEAR
;

617 
exŒaù_hšt
() {

618  (
	mthis
->
	mC_CITY
[0] << 24è+ (this->C_CITY[1] << 16è+ (this->
	mS_CITY
[0] << 8è+ (this->
	mD_YEAR
 - 1990);

622 
	gq32_agg_šput_tu¶e_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

624 
q32_agg_šput_tu¶e_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
((
q32_agg_šput_tu¶e_key
), 
off£tof
(
q32_još_tu¶e
, 
C_CITY
)) {

627 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

628 
q32_agg_šput_tu¶e_key
* 
	g®igÃd_key
 = 
®igÃd_ÿ¡
<q32_agg_šput_tu¶e_key>(
key
);

648  
	g®igÃd_key
->
exŒaù_hšt
();

653 
vœtu®
 
q32_agg_šput_tu¶e_key_exŒaùÜ_t
 * 
şÚe
() const {

654  
Ãw
 
q32_agg_šput_tu¶e_key_exŒaùÜ_t
(*
this
);

658 
	gq32_agg_šput_tu¶e_key_com·»_t
 : 
public
 
key_com·»_t
 {

660 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

661 
q32_agg_šput_tu¶e_key
* 
	ga
 = 
®igÃd_ÿ¡
<q32_agg_šput_tu¶e_key>(
key1
);

662 
q32_agg_šput_tu¶e_key
* 
	gb
 = 
®igÃd_ÿ¡
<q32_agg_šput_tu¶e_key>(
key2
);

664 
	gcc™ycom·risÚ
 = 
¡rcmp
(
a
->
C_CITY
, 
b
->C_CITY);

665 ià(
	gcc™ycom·risÚ
 !ğ0è 
cc™ycom·risÚ
;

666 
	gsc™ycom·risÚ
 = 
¡rcmp
(
a
->
S_CITY
, 
b
->S_CITY);

667 ià(
	gsc™ycom·risÚ
 !ğ0è 
sc™ycom·risÚ
;

668  
	ga
->
	gD_YEAR
 - 
	gb
->D_YEAR;

671 
vœtu®
 
q32_agg_šput_tu¶e_key_com·»_t
 * 
şÚe
() const {

672  
Ãw
 
q32_agg_šput_tu¶e_key_com·»_t
(*
this
);

677 
q32_agg_šput_tu¶e_key
 
	tq32_agg_tu¶e_key
;

679 şas 
	cq32_agg_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

680 
´iv©e
:

682 
q32_agg_ouut_tu¶e_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

684 
q32_agg_ouut_tu¶e_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
( (
q32_agg_tu¶e_key
), 
off£tof
(
q32_agg»g©e_tu¶e
, 
C_CITY
)) {

687 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

688 
q32_agg_tu¶e_key
* 
	m®igÃd_key
 = 
®igÃd_ÿ¡
<q32_agg_tu¶e_key > (
key
);

689  
	m®igÃd_key
->
exŒaù_hšt
();

692 
vœtu®
 
q32_agg_ouut_tu¶e_key_exŒaùÜ_t
 * 
şÚe
() const {

693  
Ãw
 
q32_agg_ouut_tu¶e_key_exŒaùÜ_t
(*
this
);

697 
q32_agg_ouut_tu¶e_key_exŒaùÜ_t
 
	g_exŒaùÜ
;

699 
	gpublic
:

701 
	$q32_agg_agg»g©e_t
()

702 : 
	`tu¶e_agg»g©e_t
((
q32_agg»g©e_tu¶e
)) {

703 
	}
}

705 
key_exŒaùÜ_t
* 
	$key_exŒaùÜ
() {

706  &
_exŒaùÜ
;

707 
	}
}

709 
	$agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
s
) {

710 
q32_još_tu¶e
 *
¤c
;

711 
¤c
 = 
®igÃd_ÿ¡
<
q32_još_tu¶e
> (
s
.
d©a
);

712 
q32_agg»g©e_tu¶e
* 
tu¶e
 = 
®igÃd_ÿ¡
<q32_agg»g©e_tu¶e>(
agg_d©a
);

714 
tu¶e
->
REVENUE
 +ğ
¤c
->
LO_REVENUE
;

715 
	`TRACE
(
TRACE_RECORD_FLOW
, "%.2f\n", 
tu¶e
->
REVENUE
);

716 
	}
}

718 
	$fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

719 
q32_agg»g©e_tu¶e
 *
de¡
;

720 
de¡
 = 
®igÃd_ÿ¡
<
q32_agg»g©e_tu¶e
 > (
d
.
d©a
);

721 
q32_agg»g©e_tu¶e
* 
tu¶e
 = 
®igÃd_ÿ¡
<q32_agg»g©e_tu¶> (
agg_d©a
);

723 *
de¡
 = *
tu¶e
;

724 
	}
}

726 
q32_agg_agg»g©e_t
* 
	$şÚe
() const {

727  
Ãw
 
	`q32_agg_agg»g©e_t
(*
this
);

728 
	}
}

730 
c_¡r
 
	$to_¡ršg
() const {

732 
	}
}

737 
	sq32_sÜt_tu¶e_key
 {

738 
	mD_YEAR
;

739 
	mREVENUE
;

742 
	gq32_Üd”_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

744 
q32_Üd”_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
( (
q32_sÜt_tu¶e_key
), 
off£tof
(
q32_agg»g©e_tu¶e
, 
D_YEAR
)) {

747 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

748 
q32_sÜt_tu¶e_key
* 
	g®igÃd_key
 = 
®igÃd_ÿ¡
<q32_sÜt_tu¶e_key> (
key
);

755 
	g»suÉ
 = ((
®igÃd_key
->
D_YEAR
 - 1992è<< 28è- ((×ligÃd_key->
REVENUE
) & ~(15)) >> 4);

756  
	g»suÉ
;

761 
vœtu®
 
q32_Üd”_key_exŒaùÜ_t
 * 
şÚe
() const {

762  
Ãw
 
q32_Üd”_key_exŒaùÜ_t
(*
this
);

766 
	gq32_Üd”_key_com·»_t
 : 
public
 
key_com·»_t
 {

768 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

769 
q32_sÜt_tu¶e_key
* 
	ga
 = 
®igÃd_ÿ¡
<q32_sÜt_tu¶e_key>(
key1
);

770 
q32_sÜt_tu¶e_key
* 
	gb
 = 
®igÃd_ÿ¡
<q32_sÜt_tu¶e_key>(
key2
);

772 
	gy—rcom·risÚ
 = 
a
->
D_YEAR
 - 
b
->D_YEAR;

773 ià(
	gy—rcom·risÚ
 !ğ0è 
y—rcom·risÚ
;

774 ià(
	ga
->
	gREVENUE
 > 
	gb
->REVENUE)

776 ià(
	ga
->
	gREVENUE
 < 
	gb
->REVENUE)

782 
vœtu®
 
q32_Üd”_key_com·»_t
 * 
şÚe
() const {

783  
Ãw
 
q32_Üd”_key_com·»_t
(*
this
);

789 şas 
	cssb_q32_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


791 
public
:

793 
	$begš
() {

794 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** q3_2 ANSWER ...\n");

795 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** ...\n");

798 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

799 
´ojeùed_tu¶e
 *
tu¶e
;

800 
tu¶e
 = 
®igÃd_ÿ¡
<
´ojeùed_tu¶e
>(
ouut
.
d©a
);

802 
	`TRACE
 ( 
TRACE_QUERY_RESULTS
, "PROCESS {%s} {%s} %d %d\n",
tu¶e
->
C_CITY
,u¶e->
S_CITY
,u¶e->
D_YEAR
,u¶e->
REVENUE
);

805 
	}
}

816 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_qpe_q3_2
(cÚ¡ 
xù_id
,

817 
q3_2_šput_t
& 
š
)

819 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** q3_2 *********\n");

822 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

823 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

827 
tu¶e_fifo
* 
lo_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q32_lo_tu¶e
));

828 
tsÿn_·ck‘_t
* 
lo_tsÿn_·ck‘
 =

829 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN LINEORDER",

830 
lo_out_bufãr
,

831 
Ãw
 
	`q32_lšeÜd”_tsÿn_f‹r_t
(
this
),

832 
this
->
	`db
(),

833 
_¶šeÜd”_desc
.
	`g‘
(),

834 
pxù


838 
tu¶e_fifo
* 
c_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q32_c_tu¶e
));

839 
tsÿn_·ck‘_t
* 
c_tsÿn_·ck‘
 =

840 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN CUSTOMER",

841 
c_out_bufãr
,

842 
Ãw
 
	`q32_cu¡om”_tsÿn_f‹r_t
(
this
,
š
),

843 
this
->
	`db
(),

844 
_pcu¡om”_desc
.
	`g‘
(),

845 
pxù


849 
tu¶e_fifo
* 
s_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q32_s_tu¶e
));

850 
tsÿn_·ck‘_t
* 
s_tsÿn_·ck‘
 =

851 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN SUPPLIER",

852 
s_out_bufãr
,

853 
Ãw
 
	`q32_suµl›r_tsÿn_f‹r_t
(
this
,
š
),

854 
this
->
	`db
(),

855 
_psuµl›r_desc
.
	`g‘
(),

856 
pxù


860 
tu¶e_fifo
* 
d_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q32_d_tu¶e
));

861 
tsÿn_·ck‘_t
* 
d_tsÿn_·ck‘
 =

862 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN DATE",

863 
d_out_bufãr
,

864 
Ãw
 
	`q32_d©e_tsÿn_f‹r_t
(
this
,
š
),

865 
this
->
	`db
(),

866 
_pd©e_desc
.
	`g‘
(),

867 
pxù


873 
tu¶e_fifo
* 
još_lo_d_out
 = 
Ãw
 
	`tu¶e_fifo
((
q32_još_d_tu¶e
));

874 
·ck‘_t
* 
još_lo_d_·ck‘
 =

875 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Date JOIN",

876 
još_lo_d_out
,

877 
Ãw
 
	`ŒivŸl_f‹r_t
((
q32_još_d_tu¶e
)),

878 
lo_tsÿn_·ck‘
,

879 
d_tsÿn_·ck‘
,

880 
Ãw
 
	`q32_lo_d_još_t
() );

883 
tu¶e_fifo
* 
još_lo_d_s_out
 = 
Ãw
 
	`tu¶e_fifo
((
q32_još_d_s_tu¶e
));

884 
·ck‘_t
* 
još_lo_d_s_·ck‘
 =

885 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Date - Supplier JOIN",

886 
još_lo_d_s_out
,

887 
Ãw
 
	`ŒivŸl_f‹r_t
((
q32_još_d_s_tu¶e
)),

888 
još_lo_d_·ck‘
,

889 
s_tsÿn_·ck‘
,

890 
Ãw
 
	`q32_lo_d_s_još_t
() );

893 
tu¶e_fifo
* 
još_out
 = 
Ãw
 
	`tu¶e_fifo
((
q32_još_tu¶e
));

894 
·ck‘_t
* 
još_·ck‘
 =

895 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Date - Supplier - Customer JOIN",

896 
još_out
,

897 
Ãw
 
	`ŒivŸl_f‹r_t
((
q32_još_tu¶e
)),

898 
još_lo_d_s_·ck‘
,

899 
c_tsÿn_·ck‘
,

900 
Ãw
 
	`q32_još_t
() );

903 
tu¶e_fifo
* 
agg_ouut_bufãr
 =

904 
Ãw
 
	`tu¶e_fifo
( (
q32_agg»g©e_tu¶e
));

905 
·ck‘_t
* 
q32_agg_·ck‘
 =

906 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("AGG Q3_2",

907 
agg_ouut_bufãr
,

908 
Ãw
 
	`ŒivŸl_f‹r_t
(
agg_ouut_bufãr
->
	`tu¶e_size
()),

909 
još_·ck‘
,

910 
Ãw
 
	`q32_agg_agg»g©e_t
(),

911 
Ãw
 
	`q32_agg_šput_tu¶e_key_exŒaùÜ_t
(),

912 
Ãw
 
	`q32_agg_šput_tu¶e_key_com·»_t
());

914 
tu¶e_fifo
* 
sÜt_fš®_out
 = 
Ãw
 
	`tu¶e_fifo
((
q32_agg»g©e_tu¶e
));

915 
·ck‘_t
* 
q32_sÜt_fš®_·ck‘
 =

916 
Ãw
 
	`sÜt_·ck‘_t
("ORDER BY D_YEAR ASC, REVENUE DESC",

917 
sÜt_fš®_out
,

918 
Ãw
 
	`ŒivŸl_f‹r_t
((
q32_agg»g©e_tu¶e
)),

919 
Ãw
 
	`q32_Üd”_key_exŒaùÜ_t
(),

920 
Ãw
 
	`q32_Üd”_key_com·»_t
(),

921 
q32_agg_·ck‘
);

923 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

924 
lo_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

925 
s_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

926 
c_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

927 
d_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

928 
još_lo_d_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

929 
još_lo_d_s_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

930 
još_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

931 
q32_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

932 
q32_sÜt_fš®_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

935 
ssb_q32_´oûss_tu¶e_t
 
±
;

936 
	`´oûss_qu”y
(
q32_sÜt_fš®_·ck‘
, 
±
);

937 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

939  (
RCOK
);

940 
	}
}

943 
EXIT_NAMESPACE
(
ssb
);

	@src/workload/ssb/qpipe/qpipe_q3_3.cpp

32 
	~"wÜklßd/ssb/shÜe_ssb_’v.h
"

33 
	~"qpe.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
usšg
 
Çme¥aû
 
	gqpe
;

40 
ENTER_NAMESPACE
(
ssb
);

65 
	sq33_lo_tu¶e


67 
	mLO_CUSTKEY
;

68 
	mLO_SUPPKEY
;

69 
	mLO_ORDERDATE
;

70 
	mLO_REVENUE
;

73 
	sq33_s_tu¶e


75 
	mS_SUPPKEY
;

76 
	mS_CITY
[11];

79 
	sq33_c_tu¶e


81 
	mC_CUSTKEY
;

82 
	mC_CITY
[11];

85 
	sq33_d_tu¶e


87 
	mD_DATEKEY
;

88 
	mD_YEAR
;

91 
	sq33_još_s_tu¶e


93 
	mLO_CUSTKEY
;

94 
	mS_CITY
[11];

95 
	mLO_REVENUE
;

96 
	mLO_ORDERDATE
;

99 
	sq33_još_s_c_tu¶e


101 
	mC_CITY
[11];

102 
	mS_CITY
[11];

103 
	mLO_REVENUE
;

104 
	mLO_ORDERDATE
;

108 
	sq33_još_tu¶e


110 
	mC_CITY
[11];

111 
	mS_CITY
[11];

112 
	mD_YEAR
;

113 
	mLO_REVENUE
;

116 
	sq33_agg»g©e_tu¶e


118 
	mC_CITY
[11];

119 
	mS_CITY
[11];

120 
	mD_YEAR
;

121 
	mREVENUE
;

130 
q33_agg»g©e_tu¶e
 
	t´ojeùed_tu¶e
;

133 şas 
	cq33_lšeÜd”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


135 
´iv©e
:

136 
ShÜeSSBEnv
* 
_ssbdb
;

137 
bË_row_t
* 
	m_´lše
;

138 
»p_row_t
 
	m_¼
;

140 
ssb_lšeÜd”_tu¶e
 
	m_lšeÜd”
;

142 
	mpublic
:

144 
	$q33_lšeÜd”_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
)

145 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

149 
_´lše
 = 
_ssbdb
->
	`lšeÜd”_mª
()->
	`g‘_tu¶e
();

150 
_¼
.
	`£t_ts
(
_ssbdb
->
	`lšeÜd”_mª
()->
	`ts
(),

151 
_ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
());

152 
_´lše
->
_»p
 = &
_¼
;

156 ~
	$q33_lšeÜd”_tsÿn_f‹r_t
()

159 
_ssbdb
->
	`lšeÜd”_mª
()->
	`give_tu¶e
(
_´lše
);

160 
	}
}

164 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

167 ià(!
_ssbdb
->
	`lšeÜd”_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

168 
	`as£¹
(
çl£
);

171  (
Œue
);

172 
	}
}

176 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

178 
q33_lo_tu¶e
 *
de¡
;

179 
de¡
 = 
®igÃd_ÿ¡
<
q33_lo_tu¶e
>(
d
.
d©a
);

181 
_´lše
->
	`g‘_v®ue
(2, 
_lšeÜd”
.
LO_CUSTKEY
);

182 
_´lše
->
	`g‘_v®ue
(4, 
_lšeÜd”
.
LO_SUPPKEY
);

183 
_´lše
->
	`g‘_v®ue
(5, 
_lšeÜd”
.
LO_ORDERDATE
);

184 
_´lše
->
	`g‘_v®ue
(12, 
_lšeÜd”
.
LO_REVENUE
);

187 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%d|%d|%d --d\n",

188 
_lšeÜd”
.
LO_CUSTKEY
,

189 
_lšeÜd”
.
LO_SUPPKEY
,

190 
_lšeÜd”
.
LO_ORDERDATE
,

191 
_lšeÜd”
.
LO_REVENUE
);

193 
de¡
->
LO_CUSTKEY
 = 
_lšeÜd”
.LO_CUSTKEY;

194 
de¡
->
LO_SUPPKEY
 = 
_lšeÜd”
.LO_SUPPKEY;

195 
de¡
->
LO_ORDERDATE
 = 
_lšeÜd”
.LO_ORDERDATE;

196 
de¡
->
LO_REVENUE
 = 
_lšeÜd”
.LO_REVENUE;

198 
	}
}

200 
q33_lšeÜd”_tsÿn_f‹r_t
* 
	$şÚe
() const {

201  
Ãw
 
	`q33_lšeÜd”_tsÿn_f‹r_t
(*
this
);

202 
	}
}

204 
c_¡r
 
	$to_¡ršg
() const {

205  
	`c_¡r
("q33_lineorder_tscan_filter_t()");

206 
	}
}

210 şas 
	cq33_cu¡om”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


212 
´iv©e
:

213 
ShÜeSSBEnv
* 
_ssbdb
;

214 
bË_row_t
* 
	m_´cu¡
;

215 
»p_row_t
 
	m_¼
;

217 
ssb_cu¡om”_tu¶e
 
	m_cu¡om”
;

220 
	mCITY_1
[11];

221 
	mCITY_2
[11];

222 
	mpublic
:

224 
	$q33_cu¡om”_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q3_3_šput_t
 &
š
)

225 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`cu¡om”_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

229 
_´cu¡
 = 
_ssbdb
->
	`cu¡om”_mª
()->
	`g‘_tu¶e
();

230 
_¼
.
	`£t_ts
(
_ssbdb
->
	`cu¡om”_mª
()->
	`ts
(),

231 
_ssbdb
->
	`cu¡om”_desc
()->
	`maxsize
());

232 
_´cu¡
->
_»p
 = &
_¼
;

235 
	`¡rıy
(
CITY_1
,"UNITED KI1");

236 
	`¡rıy
(
CITY_2
,"UNITED KI5");

239 ~
	$q33_cu¡om”_tsÿn_f‹r_t
()

242 
_ssbdb
->
	`cu¡om”_mª
()->
	`give_tu¶e
(
_´cu¡
);

243 
	}
}

247 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

250 ià(!
_ssbdb
->
	`cu¡om”_mª
()->
	`lßd
(
_´cu¡
, 
šput
.
d©a
)) {

251 
	`as£¹
(
çl£
);

254 
_´cu¡
->
	`g‘_v®ue
(3, 
_cu¡om”
.
C_CITY
, 
	`STRSIZE
(10));

256 ià(
	`¡rcmp
(
_cu¡om”
.
C_CITY
,
CITY_1
)==0 || sŒcmp(_cu¡om”.C_CITY,
CITY_2
)==0)

258 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ CITY |%s --d\n",

259 
_cu¡om”
.
C_CITY
);

260  (
Œue
);

264 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". CITY |%s --d\n",

265 
_cu¡om”
.
C_CITY
);

266  (
çl£
);

268 
	}
}

272 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

274 
q33_c_tu¶e
 *
de¡
;

275 
de¡
 = 
®igÃd_ÿ¡
<
q33_c_tu¶e
>(
d
.
d©a
);

277 
_´cu¡
->
	`g‘_v®ue
(0, 
_cu¡om”
.
C_CUSTKEY
);

278 
_´cu¡
->
	`g‘_v®ue
(3, 
_cu¡om”
.
C_CITY
, 
	`STRSIZE
(10));

280 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%s --d\n",

281 
_cu¡om”
.
C_CUSTKEY
,

282 
_cu¡om”
.
C_CITY
);

285 
de¡
->
C_CUSTKEY
 = 
_cu¡om”
.C_CUSTKEY;

286 
	`¡rıy
(
de¡
->
C_CITY
,
_cu¡om”
.C_CITY);

287 
	}
}

289 
q33_cu¡om”_tsÿn_f‹r_t
* 
	$şÚe
() const {

290  
Ãw
 
	`q33_cu¡om”_tsÿn_f‹r_t
(*
this
);

291 
	}
}

293 
c_¡r
 
	$to_¡ršg
() const {

294  
	`c_¡r
("q33_customer_tscan_filter_t()");

295 
	}
}

299 şas 
	cq33_suµl›r_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


301 
´iv©e
:

302 
ShÜeSSBEnv
* 
_ssbdb
;

303 
bË_row_t
* 
	m_´suµ
;

304 
»p_row_t
 
	m_¼
;

306 
ssb_suµl›r_tu¶e
 
	m_suµl›r
;

309 
	mCITY_1
[11];

310 
	mCITY_2
[11];

311 
	mpublic
:

313 
	$q33_suµl›r_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q3_3_šput_t
 &
š
)

314 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`suµl›r_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

318 
_´suµ
 = 
_ssbdb
->
	`suµl›r_mª
()->
	`g‘_tu¶e
();

319 
_¼
.
	`£t_ts
(
_ssbdb
->
	`suµl›r_mª
()->
	`ts
(),

320 
_ssbdb
->
	`suµl›r_desc
()->
	`maxsize
());

321 
_´suµ
->
_»p
 = &
_¼
;

324 
	`¡rıy
(
CITY_1
,"UNITED KI1");

325 
	`¡rıy
(
CITY_2
,"UNITED KI5");

328 ~
	$q33_suµl›r_tsÿn_f‹r_t
()

331 
_ssbdb
->
	`suµl›r_mª
()->
	`give_tu¶e
(
_´suµ
);

332 
	}
}

336 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

339 ià(!
_ssbdb
->
	`suµl›r_mª
()->
	`lßd
(
_´suµ
, 
šput
.
d©a
)) {

340 
	`as£¹
(
çl£
);

343 
_´suµ
->
	`g‘_v®ue
(3, 
_suµl›r
.
S_CITY
, 
	`STRSIZE
(10));

346 ià(
	`¡rcmp
(
_suµl›r
.
S_CITY
,
CITY_1
)==0 || sŒcmp(_suµl›r.S_CITY,
CITY_2
)==0)

348 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ CITY |%s --d\n",

349 
_suµl›r
.
S_CITY
);

350  (
Œue
);

354 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". CITY |%s --d\n",

355 
_suµl›r
.
S_CITY
);

356  (
çl£
);

358 
	}
}

362 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

364 
q33_s_tu¶e
 *
de¡
;

365 
de¡
 = 
®igÃd_ÿ¡
<
q33_s_tu¶e
>(
d
.
d©a
);

367 
_´suµ
->
	`g‘_v®ue
(0, 
_suµl›r
.
S_SUPPKEY
);

368 
_´suµ
->
	`g‘_v®ue
(3, 
_suµl›r
.
S_CITY
, 
	`STRSIZE
(10));

370 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%s --d\n",

371 
_suµl›r
.
S_SUPPKEY
,

372 
_suµl›r
.
S_CITY
);

375 
de¡
->
S_SUPPKEY
 = 
_suµl›r
.S_SUPPKEY;

376 
	`¡rıy
(
de¡
->
S_CITY
,
_suµl›r
.S_CITY);

377 
	}
}

379 
q33_suµl›r_tsÿn_f‹r_t
* 
	$şÚe
() const {

380  
Ãw
 
	`q33_suµl›r_tsÿn_f‹r_t
(*
this
);

381 
	}
}

383 
c_¡r
 
	$to_¡ršg
() const {

384  
	`c_¡r
("q33_supplier_tscan_filter_t()");

385 
	}
}

390 şas 
	cq33_d©e_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


392 
´iv©e
:

393 
ShÜeSSBEnv
* 
_ssbdb
;

394 
bË_row_t
* 
	m_´d©e
;

395 
»p_row_t
 
	m_¼
;

397 
ssb_d©e_tu¶e
 
	m_d©e
;

400 
	mYEAR_LOW
;

401 
	mYEAR_HIGH
;

403 
	mpublic
:

405 
	$q33_d©e_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q3_3_šput_t
 &
š
)

406 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`d©e_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

410 
_´d©e
 = 
_ssbdb
->
	`d©e_mª
()->
	`g‘_tu¶e
();

411 
_¼
.
	`£t_ts
(
_ssbdb
->
	`d©e_mª
()->
	`ts
(),

412 
_ssbdb
->
	`d©e_desc
()->
	`maxsize
());

413 
_´d©e
->
_»p
 = &
_¼
;

415 
YEAR_LOW
=1992;

416 
YEAR_HIGH
=1997;

419 ~
	$q33_d©e_tsÿn_f‹r_t
()

422 
_ssbdb
->
	`d©e_mª
()->
	`give_tu¶e
(
_´d©e
);

423 
	}
}

427 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

430 ià(!
_ssbdb
->
	`d©e_mª
()->
	`lßd
(
_´d©e
, 
šput
.
d©a
)) {

431 
	`as£¹
(
çl£
);

434 
_´d©e
->
	`g‘_v®ue
(4, 
_d©e
.
D_YEAR
);

437 ià(
_d©e
.
D_YEAR
>=
YEAR_LOW
 && _d©e.D_YEAR<=
YEAR_HIGH
)

439 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ YEAR |%d --d\n",

440 
_d©e
.
D_YEAR
);

441  (
Œue
);

445 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". YEAR |%d --d\n",

446 
_d©e
.
D_YEAR
);

447  (
çl£
);

450 
	}
}

454 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

456 
q33_d_tu¶e
 *
de¡
;

457 
de¡
 = 
®igÃd_ÿ¡
<
q33_d_tu¶e
>(
d
.
d©a
);

459 
_´d©e
->
	`g‘_v®ue
(0, 
_d©e
.
D_DATEKEY
);

460 
_´d©e
->
	`g‘_v®ue
(4, 
_d©e
.
D_YEAR
);

462 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%d --d\n",

463 
_d©e
.
D_DATEKEY
,

464 
_d©e
.
D_YEAR
);

467 
de¡
->
D_DATEKEY
 = 
_d©e
.D_DATEKEY;

468 
de¡
->
D_YEAR
=
_d©e
.D_YEAR;

469 
	}
}

471 
q33_d©e_tsÿn_f‹r_t
* 
	$şÚe
() const {

472  
Ãw
 
	`q33_d©e_tsÿn_f‹r_t
(*
this
);

473 
	}
}

475 
c_¡r
 
	$to_¡ršg
() const {

476  
	`c_¡r
("q33_date_tscan_filter_t()");

477 
	}
}

482 
	gq33_lo_s_još_t
 : 
public
 
tu¶e_još_t
 {

485 
q33_lo_s_još_t
 ()

486 : 
tu¶e_još_t
((
q33_lo_tu¶e
),

487 
off£tof
(
q33_lo_tu¶e
, 
LO_SUPPKEY
),

488 (
q33_s_tu¶e
),

489 
off£tof
(
q33_s_tu¶e
, 
S_SUPPKEY
),

491 (
q33_još_s_tu¶e
))

496 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

497 cÚ¡ 
tu¶e_t
 &
Ëá
,

498 cÚ¡ 
tu¶e_t
 &
right
)

501 
q33_lo_tu¶e
* 
	glo
 = 
®igÃd_ÿ¡
<q33_lo_tu¶e>(
Ëá
.
d©a
);

502 
q33_s_tu¶e
* 
	gs
 = 
®igÃd_ÿ¡
<q33_s_tu¶e>(
right
.
d©a
);

503 
q33_još_s_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q33_još_s_tu¶e>(
de¡
.
d©a
);

505 
	g»t
->
	gLO_CUSTKEY
 = 
lo
->
LO_CUSTKEY
;

506 
¡rıy
(
»t
->
S_CITY
,
s
->S_CITY);

507 
	g»t
->
	gLO_ORDERDATE
 = 
lo
->
LO_ORDERDATE
;

508 
	g»t
->
	gLO_REVENUE
 = 
lo
->
LO_REVENUE
;

511 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN %d {%s} %d %d\n",
»t
->
LO_CUSTKEY
,„‘->
S_CITY
,„‘->
LO_ORDERDATE
,„‘->
LO_REVENUE
);

515 
vœtu®
 
q33_lo_s_još_t
* 
şÚe
() const {

516  
Ãw
 
q33_lo_s_još_t
(*
this
);

519 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

526 
	gq33_lo_s_c_još_t
 : 
public
 
tu¶e_još_t
 {

529 
q33_lo_s_c_još_t
 ()

530 : 
tu¶e_još_t
((
q33_još_s_tu¶e
),

531 
off£tof
(
q33_još_s_tu¶e
, 
LO_CUSTKEY
),

532 (
q33_c_tu¶e
),

533 
off£tof
(
q33_c_tu¶e
, 
C_CUSTKEY
),

535 (
q33_još_s_c_tu¶e
))

540 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

541 cÚ¡ 
tu¶e_t
 &
Ëá
,

542 cÚ¡ 
tu¶e_t
 &
right
)

545 
q33_još_s_tu¶e
* 
	gjo
 = 
®igÃd_ÿ¡
<q33_još_s_tu¶e>(
Ëá
.
d©a
);

546 
q33_c_tu¶e
* 
	gc
 = 
®igÃd_ÿ¡
<q33_c_tu¶e>(
right
.
d©a
);

547 
q33_još_s_c_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q33_još_s_c_tu¶e>(
de¡
.
d©a
);

550 
¡rıy
(
»t
->
S_CITY
,
jo
->S_CITY);

551 
	g»t
->
	gLO_ORDERDATE
 = 
jo
->
LO_ORDERDATE
;

552 
	g»t
->
	gLO_REVENUE
 = 
jo
->
LO_REVENUE
;

554 
¡rıy
(
»t
->
C_CITY
,
c
->C_CITY);

556 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN {%s} {%s} %d %lf\n",
»t
->
C_CITY
,„‘->
S_CITY
,„‘->
LO_ORDERDATE
,„‘->
LO_REVENUE
);

560 
vœtu®
 
q33_lo_s_c_još_t
* 
şÚe
() const {

561  
Ãw
 
q33_lo_s_c_još_t
(*
this
);

564 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

571 
	gq33_još_t
 : 
public
 
tu¶e_još_t
 {

574 
q33_još_t
 ()

575 : 
tu¶e_još_t
((
q33_još_s_c_tu¶e
),

576 
off£tof
(
q33_još_s_c_tu¶e
, 
LO_ORDERDATE
),

577 (
q33_d_tu¶e
),

578 
off£tof
(
q33_d_tu¶e
, 
D_DATEKEY
),

580 (
q33_još_tu¶e
))

585 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

586 cÚ¡ 
tu¶e_t
 &
Ëá
,

587 cÚ¡ 
tu¶e_t
 &
right
)

590 
q33_još_s_c_tu¶e
* 
	gjo
 = 
®igÃd_ÿ¡
<q33_još_s_c_tu¶e>(
Ëá
.
d©a
);

591 
q33_d_tu¶e
* 
	gd
 = 
®igÃd_ÿ¡
<q33_d_tu¶e>(
right
.
d©a
);

592 
q33_još_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q33_još_tu¶e>(
de¡
.
d©a
);

594 
¡rıy
(
»t
->
C_CITY
,
jo
->C_CITY);

595 
¡rıy
(
»t
->
S_CITY
,
jo
->S_CITY);

596 
	g»t
->
	gLO_REVENUE
 = 
jo
->
LO_REVENUE
;

598 
	g»t
->
	gD_YEAR
 = 
d
->
D_YEAR
;

600 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN {%s} {%s} %d %d\n",
»t
->
C_CITY
,„‘->
S_CITY
,„‘->
D_YEAR
,„‘->
LO_REVENUE
);

604 
vœtu®
 
q33_još_t
* 
şÚe
() const {

605  
Ãw
 
q33_još_t
(*
this
);

608 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

617 
	sq33_agg_šput_tu¶e_key
 {

618 
	mC_CITY
[
STRSIZE
(10)];

619 
	mS_CITY
[
STRSIZE
(10)];

620 
	mD_YEAR
;

622 
exŒaù_hšt
() {

623  (
	mthis
->
	mC_CITY
[0] << 24è+ (this->C_CITY[1] << 16è+ (this->
	mS_CITY
[0] << 8è+ (this->
	mD_YEAR
 - 1990);

627 
	gq33_agg_šput_tu¶e_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

629 
q33_agg_šput_tu¶e_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
((
q33_agg_šput_tu¶e_key
), 
off£tof
(
q33_još_tu¶e
, 
C_CITY
)) {

632 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

633 
q33_agg_šput_tu¶e_key
* 
	g®igÃd_key
 = 
®igÃd_ÿ¡
<q33_agg_šput_tu¶e_key>(
key
);

653  
	g®igÃd_key
->
exŒaù_hšt
();

658 
vœtu®
 
q33_agg_šput_tu¶e_key_exŒaùÜ_t
 * 
şÚe
() const {

659  
Ãw
 
q33_agg_šput_tu¶e_key_exŒaùÜ_t
(*
this
);

663 
	gq33_agg_šput_tu¶e_key_com·»_t
 : 
public
 
key_com·»_t
 {

665 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

666 
q33_agg_šput_tu¶e_key
* 
	ga
 = 
®igÃd_ÿ¡
<q33_agg_šput_tu¶e_key>(
key1
);

667 
q33_agg_šput_tu¶e_key
* 
	gb
 = 
®igÃd_ÿ¡
<q33_agg_šput_tu¶e_key>(
key2
);

669 
	gcc™ycom·risÚ
 = 
¡rcmp
(
a
->
C_CITY
, 
b
->C_CITY);

670 ià(
	gcc™ycom·risÚ
 !ğ0è 
cc™ycom·risÚ
;

671 
	gsc™ycom·risÚ
 = 
¡rcmp
(
a
->
S_CITY
, 
b
->S_CITY);

672 ià(
	gsc™ycom·risÚ
 !ğ0è 
sc™ycom·risÚ
;

673  
	ga
->
	gD_YEAR
 - 
	gb
->D_YEAR;

676 
vœtu®
 
q33_agg_šput_tu¶e_key_com·»_t
 * 
şÚe
() const {

677  
Ãw
 
q33_agg_šput_tu¶e_key_com·»_t
(*
this
);

682 
q33_agg_šput_tu¶e_key
 
	tq33_agg_tu¶e_key
;

684 şas 
	cq33_agg_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

685 
´iv©e
:

687 
q33_agg_ouut_tu¶e_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

689 
q33_agg_ouut_tu¶e_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
( (
q33_agg_tu¶e_key
), 
off£tof
(
q33_agg»g©e_tu¶e
, 
C_CITY
)) {

692 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

693 
q33_agg_tu¶e_key
* 
	m®igÃd_key
 = 
®igÃd_ÿ¡
<q33_agg_tu¶e_key > (
key
);

694  
	m®igÃd_key
->
exŒaù_hšt
();

697 
vœtu®
 
q33_agg_ouut_tu¶e_key_exŒaùÜ_t
 * 
şÚe
() const {

698  
Ãw
 
q33_agg_ouut_tu¶e_key_exŒaùÜ_t
(*
this
);

702 
q33_agg_ouut_tu¶e_key_exŒaùÜ_t
 
	g_exŒaùÜ
;

704 
	gpublic
:

706 
	$q33_agg_agg»g©e_t
()

707 : 
	`tu¶e_agg»g©e_t
((
q33_agg»g©e_tu¶e
)) {

708 
	}
}

710 
key_exŒaùÜ_t
* 
	$key_exŒaùÜ
() {

711  &
_exŒaùÜ
;

712 
	}
}

714 
	$agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
s
) {

715 
q33_još_tu¶e
 *
¤c
;

716 
¤c
 = 
®igÃd_ÿ¡
<
q33_još_tu¶e
> (
s
.
d©a
);

717 
q33_agg»g©e_tu¶e
* 
tu¶e
 = 
®igÃd_ÿ¡
<q33_agg»g©e_tu¶e>(
agg_d©a
);

719 
tu¶e
->
REVENUE
 +ğ
¤c
->
LO_REVENUE
;

720 
	`TRACE
(
TRACE_RECORD_FLOW
, "%.2f\n", 
tu¶e
->
REVENUE
);

721 
	}
}

723 
	$fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

724 
q33_agg»g©e_tu¶e
 *
de¡
;

725 
de¡
 = 
®igÃd_ÿ¡
<
q33_agg»g©e_tu¶e
 > (
d
.
d©a
);

726 
q33_agg»g©e_tu¶e
* 
tu¶e
 = 
®igÃd_ÿ¡
<q33_agg»g©e_tu¶> (
agg_d©a
);

728 *
de¡
 = *
tu¶e
;

729 
	}
}

731 
q33_agg_agg»g©e_t
* 
	$şÚe
() const {

732  
Ãw
 
	`q33_agg_agg»g©e_t
(*
this
);

733 
	}
}

735 
c_¡r
 
	$to_¡ršg
() const {

737 
	}
}

742 
	sq33_sÜt_tu¶e_key
 {

743 
	mD_YEAR
;

744 
	mREVENUE
;

747 
	gq33_Üd”_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

749 
q33_Üd”_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
( (
q33_sÜt_tu¶e_key
), 
off£tof
(
q33_agg»g©e_tu¶e
, 
D_YEAR
)) {

752 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

753 
q33_sÜt_tu¶e_key
* 
	g®igÃd_key
 = 
®igÃd_ÿ¡
<q33_sÜt_tu¶e_key> (
key
);

759 
	g»suÉ
 = ((
®igÃd_key
->
D_YEAR
 - 1992è<< 28è- ((×ligÃd_key->
REVENUE
) & ~(15)) >> 4);

760  
	g»suÉ
;

765 
vœtu®
 
q33_Üd”_key_exŒaùÜ_t
 * 
şÚe
() const {

766  
Ãw
 
q33_Üd”_key_exŒaùÜ_t
(*
this
);

770 
	gq33_Üd”_key_com·»_t
 : 
public
 
key_com·»_t
 {

772 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

773 
q33_sÜt_tu¶e_key
* 
	ga
 = 
®igÃd_ÿ¡
<q33_sÜt_tu¶e_key>(
key1
);

774 
q33_sÜt_tu¶e_key
* 
	gb
 = 
®igÃd_ÿ¡
<q33_sÜt_tu¶e_key>(
key2
);

776 
	gy—rcom·risÚ
 = 
a
->
D_YEAR
 - 
b
->D_YEAR;

777 ià(
	gy—rcom·risÚ
 !ğ0è 
y—rcom·risÚ
;

778 ià(
	ga
->
	gREVENUE
 > 
	gb
->REVENUE)

780 ià(
	ga
->
	gREVENUE
 < 
	gb
->REVENUE)

786 
vœtu®
 
q33_Üd”_key_com·»_t
 * 
şÚe
() const {

787  
Ãw
 
q33_Üd”_key_com·»_t
(*
this
);

795 şas 
	cssb_q33_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


797 
public
:

799 
	$begš
() {

800 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** q3_3 ANSWER ...\n");

801 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** ...\n");

804 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

805 
´ojeùed_tu¶e
 *
tu¶e
;

806 
tu¶e
 = 
®igÃd_ÿ¡
<
´ojeùed_tu¶e
>(
ouut
.
d©a
);

809 
	`TRACE
 ( 
TRACE_QUERY_RESULTS
, "PROCESS {%s} {%s} %d %d\n",
tu¶e
->
S_CITY
,u¶e->
C_CITY
,u¶e->
D_YEAR
,u¶e->
REVENUE
);

812 
	}
}

823 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_qpe_q3_3
(cÚ¡ 
xù_id
,

824 
q3_3_šput_t
& 
š
)

826 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** q3_3 *********\n");

829 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

830 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

834 
tu¶e_fifo
* 
lo_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q33_lo_tu¶e
));

835 
tsÿn_·ck‘_t
* 
lo_tsÿn_·ck‘
 =

836 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN LINEORDER",

837 
lo_out_bufãr
,

838 
Ãw
 
	`q33_lšeÜd”_tsÿn_f‹r_t
(
this
),

839 
this
->
	`db
(),

840 
_¶šeÜd”_desc
.
	`g‘
(),

841 
pxù


846 
tu¶e_fifo
* 
s_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q33_s_tu¶e
));

847 
tsÿn_·ck‘_t
* 
s_tsÿn_·ck‘
 =

848 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN SUPPLIER",

849 
s_out_bufãr
,

850 
Ãw
 
	`q33_suµl›r_tsÿn_f‹r_t
(
this
,
š
),

851 
this
->
	`db
(),

852 
_psuµl›r_desc
.
	`g‘
(),

853 
pxù


858 
tu¶e_fifo
* 
c_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q33_c_tu¶e
));

859 
tsÿn_·ck‘_t
* 
c_tsÿn_·ck‘
 =

860 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN CUSTOMER",

861 
c_out_bufãr
,

862 
Ãw
 
	`q33_cu¡om”_tsÿn_f‹r_t
(
this
,
š
),

863 
this
->
	`db
(),

864 
_pcu¡om”_desc
.
	`g‘
(),

865 
pxù


870 
tu¶e_fifo
* 
d_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q33_d_tu¶e
));

871 
tsÿn_·ck‘_t
* 
d_tsÿn_·ck‘
 =

872 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN DATE",

873 
d_out_bufãr
,

874 
Ãw
 
	`q33_d©e_tsÿn_f‹r_t
(
this
,
š
),

875 
this
->
	`db
(),

876 
_pd©e_desc
.
	`g‘
(),

877 
pxù


883 
tu¶e_fifo
* 
još_lo_s_out
 = 
Ãw
 
	`tu¶e_fifo
((
q33_još_s_tu¶e
));

884 
·ck‘_t
* 
još_lo_s_·ck‘
 =

885 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier JOIN",

886 
još_lo_s_out
,

887 
Ãw
 
	`ŒivŸl_f‹r_t
((
q33_još_s_tu¶e
)),

888 
lo_tsÿn_·ck‘
,

889 
s_tsÿn_·ck‘
,

890 
Ãw
 
	`q33_lo_s_još_t
() );

893 
tu¶e_fifo
* 
još_lo_s_c_out
 = 
Ãw
 
	`tu¶e_fifo
((
q33_još_s_c_tu¶e
));

894 
·ck‘_t
* 
još_lo_s_c_·ck‘
 =

895 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier - Customer JOIN",

896 
još_lo_s_c_out
,

897 
Ãw
 
	`ŒivŸl_f‹r_t
((
q33_još_s_c_tu¶e
)),

898 
još_lo_s_·ck‘
,

899 
c_tsÿn_·ck‘
,

900 
Ãw
 
	`q33_lo_s_c_još_t
() );

903 
tu¶e_fifo
* 
još_out
 = 
Ãw
 
	`tu¶e_fifo
((
q33_još_tu¶e
));

904 
·ck‘_t
* 
još_·ck‘
 =

905 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier - Customer - Date JOIN",

906 
još_out
,

907 
Ãw
 
	`ŒivŸl_f‹r_t
((
q33_još_tu¶e
)),

908 
još_lo_s_c_·ck‘
,

909 
d_tsÿn_·ck‘
,

910 
Ãw
 
	`q33_još_t
() );

914 
tu¶e_fifo
* 
agg_ouut_bufãr
 =

915 
Ãw
 
	`tu¶e_fifo
( (
q33_agg»g©e_tu¶e
));

916 
·ck‘_t
* 
q33_agg_·ck‘
 =

917 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("AGG Q3_3",

918 
agg_ouut_bufãr
,

919 
Ãw
 
	`ŒivŸl_f‹r_t
(
agg_ouut_bufãr
->
	`tu¶e_size
()),

920 
još_·ck‘
,

921 
Ãw
 
	`q33_agg_agg»g©e_t
(),

922 
Ãw
 
	`q33_agg_šput_tu¶e_key_exŒaùÜ_t
(),

923 
Ãw
 
	`q33_agg_šput_tu¶e_key_com·»_t
());

925 
tu¶e_fifo
* 
sÜt_fš®_out
 = 
Ãw
 
	`tu¶e_fifo
((
q33_agg»g©e_tu¶e
));

926 
·ck‘_t
* 
q33_sÜt_fš®_·ck‘
 =

927 
Ãw
 
	`sÜt_·ck‘_t
("ORDER BY D_YEAR ASC, REVENUE DESC",

928 
sÜt_fš®_out
,

929 
Ãw
 
	`ŒivŸl_f‹r_t
((
q33_agg»g©e_tu¶e
)),

930 
Ãw
 
	`q33_Üd”_key_exŒaùÜ_t
(),

931 
Ãw
 
	`q33_Üd”_key_com·»_t
(),

932 
q33_agg_·ck‘
);

934 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

935 
lo_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

936 
s_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

937 
c_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

938 
d_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

939 
još_lo_s_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

940 
još_lo_s_c_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

941 
još_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

942 
q33_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

943 
q33_sÜt_fš®_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

946 
ssb_q33_´oûss_tu¶e_t
 
±
;

948 
	`´oûss_qu”y
(
q33_sÜt_fš®_·ck‘
, 
±
);

949 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

951  (
RCOK
);

952 
	}
}

955 
EXIT_NAMESPACE
(
ssb
);

	@src/workload/ssb/qpipe/qpipe_q3_4.cpp

32 
	~"wÜklßd/ssb/shÜe_ssb_’v.h
"

33 
	~"qpe.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
usšg
 
Çme¥aû
 
	gqpe
;

40 
ENTER_NAMESPACE
(
ssb
);

67 
	sq34_lo_tu¶e


69 
	mLO_CUSTKEY
;

70 
	mLO_SUPPKEY
;

71 
	mLO_ORDERDATE
;

72 
	mLO_REVENUE
;

75 
	sq34_s_tu¶e


77 
	mS_SUPPKEY
;

78 
	mS_CITY
[11];

81 
	sq34_c_tu¶e


83 
	mC_CUSTKEY
;

84 
	mC_CITY
[11];

87 
	sq34_d_tu¶e


89 
	mD_DATEKEY
;

90 
	mD_YEAR
;

93 
	sq34_još_s_tu¶e


95 
	mLO_CUSTKEY
;

96 
	mS_CITY
[11];

97 
	mLO_REVENUE
;

98 
	mLO_ORDERDATE
;

101 
	sq34_još_s_d_tu¶e


103 
	mS_CITY
[11];

104 
	mD_YEAR
;

105 
	mLO_CUSTKEY
;

106 
	mLO_REVENUE
;

110 
	sq34_još_tu¶e


112 
	mS_CITY
[11];

113 
	mC_CITY
[11];

114 
	mD_YEAR
;

115 
	mLO_REVENUE
;

118 
	sq34_agg»g©e_tu¶e


120 
	mC_CITY
[11];

121 
	mS_CITY
[11];

122 
	mD_YEAR
;

123 
	mREVENUE
;

131 
q34_agg»g©e_tu¶e
 
	t´ojeùed_tu¶e
;

134 şas 
	cq34_lšeÜd”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


136 
´iv©e
:

137 
ShÜeSSBEnv
* 
_ssbdb
;

138 
bË_row_t
* 
	m_´lše
;

139 
»p_row_t
 
	m_¼
;

141 
ssb_lšeÜd”_tu¶e
 
	m_lšeÜd”
;

143 
	mpublic
:

145 
	$q34_lšeÜd”_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
)

146 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

150 
_´lše
 = 
_ssbdb
->
	`lšeÜd”_mª
()->
	`g‘_tu¶e
();

151 
_¼
.
	`£t_ts
(
_ssbdb
->
	`lšeÜd”_mª
()->
	`ts
(),

152 
_ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
());

153 
_´lše
->
_»p
 = &
_¼
;

157 ~
	$q34_lšeÜd”_tsÿn_f‹r_t
()

160 
_ssbdb
->
	`lšeÜd”_mª
()->
	`give_tu¶e
(
_´lše
);

161 
	}
}

165 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

168 ià(!
_ssbdb
->
	`lšeÜd”_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

169 
	`as£¹
(
çl£
);

172  (
Œue
);

173 
	}
}

177 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

179 
q34_lo_tu¶e
 *
de¡
;

180 
de¡
 = 
®igÃd_ÿ¡
<
q34_lo_tu¶e
>(
d
.
d©a
);

182 
_´lše
->
	`g‘_v®ue
(2, 
_lšeÜd”
.
LO_CUSTKEY
);

183 
_´lše
->
	`g‘_v®ue
(4, 
_lšeÜd”
.
LO_SUPPKEY
);

184 
_´lše
->
	`g‘_v®ue
(5, 
_lšeÜd”
.
LO_ORDERDATE
);

185 
_´lše
->
	`g‘_v®ue
(12, 
_lšeÜd”
.
LO_REVENUE
);

194 
de¡
->
LO_CUSTKEY
 = 
_lšeÜd”
.LO_CUSTKEY;

195 
de¡
->
LO_SUPPKEY
 = 
_lšeÜd”
.LO_SUPPKEY;

196 
de¡
->
LO_ORDERDATE
 = 
_lšeÜd”
.LO_ORDERDATE;

197 
de¡
->
LO_REVENUE
 = 
_lšeÜd”
.LO_REVENUE;

199 
	}
}

201 
q34_lšeÜd”_tsÿn_f‹r_t
* 
	$şÚe
() const {

202  
Ãw
 
	`q34_lšeÜd”_tsÿn_f‹r_t
(*
this
);

203 
	}
}

205 
c_¡r
 
	$to_¡ršg
() const {

206  
	`c_¡r
("q34_lineorder_tscan_filter_t()");

207 
	}
}

211 şas 
	cq34_cu¡om”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


213 
´iv©e
:

214 
ShÜeSSBEnv
* 
_ssbdb
;

215 
bË_row_t
* 
	m_´cu¡
;

216 
»p_row_t
 
	m_¼
;

218 
ssb_cu¡om”_tu¶e
 
	m_cu¡om”
;

221 
	mCITY_1
[11];

222 
	mCITY_2
[11];

223 
	mpublic
:

225 
	$q34_cu¡om”_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q3_4_šput_t
 &
š
)

226 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`cu¡om”_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

230 
_´cu¡
 = 
_ssbdb
->
	`cu¡om”_mª
()->
	`g‘_tu¶e
();

231 
_¼
.
	`£t_ts
(
_ssbdb
->
	`cu¡om”_mª
()->
	`ts
(),

232 
_ssbdb
->
	`cu¡om”_desc
()->
	`maxsize
());

233 
_´cu¡
->
_»p
 = &
_¼
;

236 
	`¡rıy
(
CITY_1
,"UNITED KI1");

237 
	`¡rıy
(
CITY_2
,"UNITED KI5");

240 ~
	$q34_cu¡om”_tsÿn_f‹r_t
()

243 
_ssbdb
->
	`cu¡om”_mª
()->
	`give_tu¶e
(
_´cu¡
);

244 
	}
}

248 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

251 ià(!
_ssbdb
->
	`cu¡om”_mª
()->
	`lßd
(
_´cu¡
, 
šput
.
d©a
)) {

252 
	`as£¹
(
çl£
);

255 
_´cu¡
->
	`g‘_v®ue
(3, 
_cu¡om”
.
C_CITY
, 
	`STRSIZE
(10));

257 ià(
	`¡rcmp
(
_cu¡om”
.
C_CITY
,
CITY_1
)==0 || sŒcmp(_cu¡om”.C_CITY,
CITY_2
)==0)

261  (
Œue
);

267  (
çl£
);

269 
	}
}

273 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

275 
q34_c_tu¶e
 *
de¡
;

276 
de¡
 = 
®igÃd_ÿ¡
<
q34_c_tu¶e
>(
d
.
d©a
);

278 
_´cu¡
->
	`g‘_v®ue
(0, 
_cu¡om”
.
C_CUSTKEY
);

279 
_´cu¡
->
	`g‘_v®ue
(3, 
_cu¡om”
.
C_CITY
, 
	`STRSIZE
(10));

281 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "C_CUSTKEY %d| C_CITY %s --d\n",

282 
_cu¡om”
.
C_CUSTKEY
,

283 
_cu¡om”
.
C_CITY
);

286 
de¡
->
C_CUSTKEY
 = 
_cu¡om”
.C_CUSTKEY;

287 
	`¡rıy
(
de¡
->
C_CITY
,
_cu¡om”
.C_CITY);

288 
	}
}

290 
q34_cu¡om”_tsÿn_f‹r_t
* 
	$şÚe
() const {

291  
Ãw
 
	`q34_cu¡om”_tsÿn_f‹r_t
(*
this
);

292 
	}
}

294 
c_¡r
 
	$to_¡ršg
() const {

295  
	`c_¡r
("q34_customer_tscan_filter_t()");

296 
	}
}

300 şas 
	cq34_suµl›r_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


302 
´iv©e
:

303 
ShÜeSSBEnv
* 
_ssbdb
;

304 
bË_row_t
* 
	m_´suµ
;

305 
»p_row_t
 
	m_¼
;

307 
ssb_suµl›r_tu¶e
 
	m_suµl›r
;

310 
	mCITY_1
[11];

311 
	mCITY_2
[11];

312 
	mpublic
:

314 
	$q34_suµl›r_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q3_4_šput_t
 &
š
)

315 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`suµl›r_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

319 
_´suµ
 = 
_ssbdb
->
	`suµl›r_mª
()->
	`g‘_tu¶e
();

320 
_¼
.
	`£t_ts
(
_ssbdb
->
	`suµl›r_mª
()->
	`ts
(),

321 
_ssbdb
->
	`suµl›r_desc
()->
	`maxsize
());

322 
_´suµ
->
_»p
 = &
_¼
;

325 
	`¡rıy
(
CITY_1
,"UNITED KI1");

326 
	`¡rıy
(
CITY_2
,"UNITED KI5");

329 ~
	$q34_suµl›r_tsÿn_f‹r_t
()

332 
_ssbdb
->
	`suµl›r_mª
()->
	`give_tu¶e
(
_´suµ
);

333 
	}
}

337 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

340 ià(!
_ssbdb
->
	`suµl›r_mª
()->
	`lßd
(
_´suµ
, 
šput
.
d©a
)) {

341 
	`as£¹
(
çl£
);

344 
_´suµ
->
	`g‘_v®ue
(3, 
_suµl›r
.
S_CITY
, 
	`STRSIZE
(10));

347 ià(
	`¡rcmp
(
_suµl›r
.
S_CITY
,
CITY_1
)==0 || sŒcmp(_suµl›r.S_CITY,
CITY_2
)==0)

351  (
Œue
);

357  (
çl£
);

359 
	}
}

363 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

365 
q34_s_tu¶e
 *
de¡
;

366 
de¡
 = 
®igÃd_ÿ¡
<
q34_s_tu¶e
>(
d
.
d©a
);

368 
_´suµ
->
	`g‘_v®ue
(0, 
_suµl›r
.
S_SUPPKEY
);

369 
_´suµ
->
	`g‘_v®ue
(3, 
_suµl›r
.
S_CITY
, 
	`STRSIZE
(10));

376 
de¡
->
S_SUPPKEY
 = 
_suµl›r
.S_SUPPKEY;

377 
	`¡rıy
(
de¡
->
S_CITY
,
_suµl›r
.S_CITY);

378 
	}
}

380 
q34_suµl›r_tsÿn_f‹r_t
* 
	$şÚe
() const {

381  
Ãw
 
	`q34_suµl›r_tsÿn_f‹r_t
(*
this
);

382 
	}
}

384 
c_¡r
 
	$to_¡ršg
() const {

385  
	`c_¡r
("q34_supplier_tscan_filter_t()");

386 
	}
}

391 şas 
	cq34_d©e_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


393 
´iv©e
:

394 
ShÜeSSBEnv
* 
_ssbdb
;

395 
bË_row_t
* 
	m_´d©e
;

396 
»p_row_t
 
	m_¼
;

398 
ssb_d©e_tu¶e
 
	m_d©e
;

401 
	mYEARMONTH
[8];

403 
	mpublic
:

405 
	$q34_d©e_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q3_4_šput_t
 &
š
)

406 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`d©e_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

410 
_´d©e
 = 
_ssbdb
->
	`d©e_mª
()->
	`g‘_tu¶e
();

411 
_¼
.
	`£t_ts
(
_ssbdb
->
	`d©e_mª
()->
	`ts
(),

412 
_ssbdb
->
	`d©e_desc
()->
	`maxsize
());

413 
_´d©e
->
_»p
 = &
_¼
;

415 
	`¡rıy
(
YEARMONTH
,"Jan1992");

418 ~
	$q34_d©e_tsÿn_f‹r_t
()

421 
_ssbdb
->
	`d©e_mª
()->
	`give_tu¶e
(
_´d©e
);

422 
	}
}

426 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

429 ià(!
_ssbdb
->
	`d©e_mª
()->
	`lßd
(
_´d©e
, 
šput
.
d©a
)) {

430 
	`as£¹
(
çl£
);

433 
_´d©e
->
	`g‘_v®ue
(6, 
_d©e
.
D_YEARMONTH
, 
	`STRSIZE
(7));

436 iàĞ
	`¡rcmp
(
_d©e
.
D_YEARMONTH
,
YEARMONTH
)==0 )

442  (
Œue
);

448  (
çl£
);

451 
	}
}

455 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

457 
q34_d_tu¶e
 *
de¡
;

458 
de¡
 = 
®igÃd_ÿ¡
<
q34_d_tu¶e
>(
d
.
d©a
);

460 
_´d©e
->
	`g‘_v®ue
(0, 
_d©e
.
D_DATEKEY
);

461 
_´d©e
->
	`g‘_v®ue
(4, 
_d©e
.
D_YEAR
);

468 
de¡
->
D_DATEKEY
 = 
_d©e
.D_DATEKEY;

469 
de¡
->
D_YEAR
=
_d©e
.D_YEAR;

470 
	}
}

472 
q34_d©e_tsÿn_f‹r_t
* 
	$şÚe
() const {

473  
Ãw
 
	`q34_d©e_tsÿn_f‹r_t
(*
this
);

474 
	}
}

476 
c_¡r
 
	$to_¡ršg
() const {

477  
	`c_¡r
("q34_date_tscan_filter_t()");

478 
	}
}

483 
	gq34_lo_s_još_t
 : 
public
 
tu¶e_još_t
 {

486 
q34_lo_s_još_t
 ()

487 : 
tu¶e_još_t
((
q34_lo_tu¶e
),

488 
off£tof
(
q34_lo_tu¶e
, 
LO_SUPPKEY
),

489 (
q34_s_tu¶e
),

490 
off£tof
(
q34_s_tu¶e
, 
S_SUPPKEY
),

492 (
q34_još_s_tu¶e
))

497 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

498 cÚ¡ 
tu¶e_t
 &
Ëá
,

499 cÚ¡ 
tu¶e_t
 &
right
)

502 
q34_lo_tu¶e
* 
	glo
 = 
®igÃd_ÿ¡
<q34_lo_tu¶e>(
Ëá
.
d©a
);

503 
q34_s_tu¶e
* 
	gs
 = 
®igÃd_ÿ¡
<q34_s_tu¶e>(
right
.
d©a
);

504 
q34_još_s_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q34_još_s_tu¶e>(
de¡
.
d©a
);

506 
	g»t
->
	gLO_CUSTKEY
 = 
lo
->
LO_CUSTKEY
;

507 
¡rıy
(
»t
->
S_CITY
,
s
->S_CITY);

508 
	g»t
->
	gLO_ORDERDATE
 = 
lo
->
LO_ORDERDATE
;

509 
	g»t
->
	gLO_REVENUE
 = 
lo
->
LO_REVENUE
;

516 
vœtu®
 
q34_lo_s_još_t
* 
şÚe
() const {

517  
Ãw
 
q34_lo_s_još_t
(*
this
);

520 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

527 
	gq34_lo_s_d_još_t
 : 
public
 
tu¶e_još_t
 {

530 
q34_lo_s_d_još_t
 ()

531 : 
tu¶e_još_t
((
q34_još_s_tu¶e
),

532 
off£tof
(
q34_još_s_tu¶e
, 
LO_ORDERDATE
),

533 (
q34_d_tu¶e
),

534 
off£tof
(
q34_d_tu¶e
, 
D_DATEKEY
),

536 (
q34_još_s_d_tu¶e
))

541 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

542 cÚ¡ 
tu¶e_t
 &
Ëá
,

543 cÚ¡ 
tu¶e_t
 &
right
)

546 
q34_još_s_tu¶e
* 
	gjo
 = 
®igÃd_ÿ¡
<q34_još_s_tu¶e>(
Ëá
.
d©a
);

547 
q34_d_tu¶e
* 
	gd
 = 
®igÃd_ÿ¡
<q34_d_tu¶e>(
right
.
d©a
);

548 
q34_još_s_d_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q34_još_s_d_tu¶e>(
de¡
.
d©a
);

550 
	g»t
->
	gLO_CUSTKEY
 = 
jo
->
LO_CUSTKEY
;

551 
¡rıy
(
»t
->
S_CITY
,
jo
->S_CITY);

552 
	g»t
->
	gD_YEAR
 = 
d
->
D_YEAR
 ;

553 
	g»t
->
	gLO_REVENUE
 = 
jo
->
LO_REVENUE
;

555 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN LO S D %d {%s} %d %d\n",
»t
->
LO_CUSTKEY
,„‘->
S_CITY
,„‘->
D_YEAR
,„‘->
LO_REVENUE
);

559 
vœtu®
 
q34_lo_s_d_još_t
* 
şÚe
() const {

560  
Ãw
 
q34_lo_s_d_još_t
(*
this
);

563 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

612 
	gq34_još_t
 : 
public
 
tu¶e_još_t
 {

615 
q34_još_t
 ()

616 : 
tu¶e_još_t
((
q34_još_s_d_tu¶e
),

617 
off£tof
(
q34_još_s_d_tu¶e
, 
LO_CUSTKEY
),

618 (
q34_c_tu¶e
),

619 
off£tof
(
q34_c_tu¶e
, 
C_CUSTKEY
),

621 (
q34_još_tu¶e
))

626 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

627 cÚ¡ 
tu¶e_t
 &
Ëá
,

628 cÚ¡ 
tu¶e_t
 &
right
)

631 
q34_još_s_d_tu¶e
* 
	gjo
 = 
®igÃd_ÿ¡
<q34_još_s_d_tu¶e>(
Ëá
.
d©a
);

632 
q34_c_tu¶e
* 
	gc
 = 
®igÃd_ÿ¡
<q34_c_tu¶e>(
right
.
d©a
);

633 
q34_još_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q34_još_tu¶e>(
de¡
.
d©a
);

635 
¡rıy
(
»t
->
C_CITY
,
c
->C_CITY);

636 
¡rıy
(
»t
->
S_CITY
,
jo
->S_CITY);

637 
	g»t
->
	gD_YEAR
 = 
jo
->
D_YEAR
;

638 
	g»t
->
	gLO_REVENUE
 = 
jo
->
LO_REVENUE
;

642 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN LO S D C {%s} {%s} %d %d\n",
»t
->
C_CITY
,„‘->
S_CITY
,„‘->
D_YEAR
,„‘->
LO_REVENUE
);

646 
vœtu®
 
q34_još_t
* 
şÚe
() const {

647  
Ãw
 
q34_još_t
(*
this
);

650 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

659 
	sq34_agg_šput_tu¶e_key
 {

660 
	mC_CITY
[
STRSIZE
(10)];

661 
	mS_CITY
[
STRSIZE
(10)];

662 
	mD_YEAR
;

664 
exŒaù_hšt
() {

665  (
	mthis
->
	mC_CITY
[0] << 24è+ (this->C_CITY[1] << 16è+ (this->
	mS_CITY
[0] << 8è+ (this->
	mD_YEAR
 - 1990);

669 
	gq34_agg_šput_tu¶e_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

671 
q34_agg_šput_tu¶e_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
((
q34_agg_šput_tu¶e_key
), 
off£tof
(
q34_još_tu¶e
, 
C_CITY
)) {

674 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

675 
q34_agg_šput_tu¶e_key
* 
	g®igÃd_key
 = 
®igÃd_ÿ¡
<q34_agg_šput_tu¶e_key>(
key
);

695  
	g®igÃd_key
->
exŒaù_hšt
();

700 
vœtu®
 
q34_agg_šput_tu¶e_key_exŒaùÜ_t
 * 
şÚe
() const {

701  
Ãw
 
q34_agg_šput_tu¶e_key_exŒaùÜ_t
(*
this
);

705 
	gq34_agg_šput_tu¶e_key_com·»_t
 : 
public
 
key_com·»_t
 {

707 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

708 
q34_agg_šput_tu¶e_key
* 
	ga
 = 
®igÃd_ÿ¡
<q34_agg_šput_tu¶e_key>(
key1
);

709 
q34_agg_šput_tu¶e_key
* 
	gb
 = 
®igÃd_ÿ¡
<q34_agg_šput_tu¶e_key>(
key2
);

711 
	gcc™ycom·risÚ
 = 
¡rcmp
(
a
->
C_CITY
, 
b
->C_CITY);

712 ià(
	gcc™ycom·risÚ
 !ğ0è 
cc™ycom·risÚ
;

713 
	gsc™ycom·risÚ
 = 
¡rcmp
(
a
->
S_CITY
, 
b
->S_CITY);

714 ià(
	gsc™ycom·risÚ
 !ğ0è 
sc™ycom·risÚ
;

715  
	ga
->
	gD_YEAR
 - 
	gb
->D_YEAR;

718 
vœtu®
 
q34_agg_šput_tu¶e_key_com·»_t
 * 
şÚe
() const {

719  
Ãw
 
q34_agg_šput_tu¶e_key_com·»_t
(*
this
);

724 
q34_agg_šput_tu¶e_key
 
	tq34_agg_tu¶e_key
;

726 şas 
	cq34_agg_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

727 
´iv©e
:

729 
q34_agg_ouut_tu¶e_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

731 
q34_agg_ouut_tu¶e_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
( (
q34_agg_tu¶e_key
), 
off£tof
(
q34_agg»g©e_tu¶e
, 
C_CITY
)) {

734 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

735 
q34_agg_tu¶e_key
* 
	m®igÃd_key
 = 
®igÃd_ÿ¡
<q34_agg_tu¶e_key > (
key
);

736  
	m®igÃd_key
->
exŒaù_hšt
();

739 
vœtu®
 
q34_agg_ouut_tu¶e_key_exŒaùÜ_t
 * 
şÚe
() const {

740  
Ãw
 
q34_agg_ouut_tu¶e_key_exŒaùÜ_t
(*
this
);

744 
q34_agg_ouut_tu¶e_key_exŒaùÜ_t
 
	g_exŒaùÜ
;

746 
	gpublic
:

748 
	$q34_agg_agg»g©e_t
()

749 : 
	`tu¶e_agg»g©e_t
((
q34_agg»g©e_tu¶e
)) {

750 
	}
}

752 
key_exŒaùÜ_t
* 
	$key_exŒaùÜ
() {

753  &
_exŒaùÜ
;

754 
	}
}

756 
	$agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
s
) {

757 
q34_još_tu¶e
 *
¤c
;

758 
¤c
 = 
®igÃd_ÿ¡
<
q34_još_tu¶e
> (
s
.
d©a
);

759 
q34_agg»g©e_tu¶e
* 
tu¶e
 = 
®igÃd_ÿ¡
<q34_agg»g©e_tu¶e>(
agg_d©a
);

761 
	`¡rıy
(
tu¶e
->
C_CITY
,
¤c
->C_CITY);

762 
	`¡rıy
(
tu¶e
->
S_CITY
,
¤c
->S_CITY);

763 
tu¶e
->
D_YEAR
 = 
¤c
->D_YEAR;

764 
tu¶e
->
REVENUE
 +ğ
¤c
->
LO_REVENUE
;

765 
	`TRACE
(
TRACE_RECORD_FLOW
, "--> %d\n", 
tu¶e
->
REVENUE
);

766 
	}
}

768 
	$fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

769 
q34_agg»g©e_tu¶e
 *
de¡
;

770 
de¡
 = 
®igÃd_ÿ¡
<
q34_agg»g©e_tu¶e
 > (
d
.
d©a
);

771 
q34_agg»g©e_tu¶e
* 
tu¶e
 = 
®igÃd_ÿ¡
<q34_agg»g©e_tu¶> (
agg_d©a
);

777 *
de¡
 = *
tu¶e
;

778 
	`TRACE
(
TRACE_RECORD_FLOW
, "AGG % % %d %d \n", 
de¡
->
C_CITY
, de¡->
S_CITY
, de¡->
D_YEAR
, de¡->
REVENUE
);

779 
	}
}

781 
q34_agg_agg»g©e_t
* 
	$şÚe
() const {

782  
Ãw
 
	`q34_agg_agg»g©e_t
(*
this
);

783 
	}
}

785 
c_¡r
 
	$to_¡ršg
() const {

787 
	}
}

792 
	sq34_sÜt_tu¶e_key
 {

793 
	mD_YEAR
;

794 
	mREVENUE
;

797 
	gq34_Üd”_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

799 
q34_Üd”_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
( (
q34_sÜt_tu¶e_key
), 
off£tof
(
q34_agg»g©e_tu¶e
, 
D_YEAR
)) {

802 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

803 
q34_sÜt_tu¶e_key
* 
	g®igÃd_key
 = 
®igÃd_ÿ¡
<q34_sÜt_tu¶e_key> (
key
);

810 
	g»suÉ
 = ((
®igÃd_key
->
D_YEAR
 - 1992è<< 28è- ((×ligÃd_key->
REVENUE
) & ~(15)) >> 4);

811  
	g»suÉ
;

816 
vœtu®
 
q34_Üd”_key_exŒaùÜ_t
 * 
şÚe
() const {

817  
Ãw
 
q34_Üd”_key_exŒaùÜ_t
(*
this
);

821 
	gq34_Üd”_key_com·»_t
 : 
public
 
key_com·»_t
 {

823 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

824 
q34_sÜt_tu¶e_key
* 
	ga
 = 
®igÃd_ÿ¡
<q34_sÜt_tu¶e_key>(
key1
);

825 
q34_sÜt_tu¶e_key
* 
	gb
 = 
®igÃd_ÿ¡
<q34_sÜt_tu¶e_key>(
key2
);

827 
	gy—rcom·risÚ
 = 
a
->
D_YEAR
 - 
b
->D_YEAR;

828 ià(
	gy—rcom·risÚ
 !ğ0è 
y—rcom·risÚ
;

829 ià(
	ga
->
	gREVENUE
 > 
	gb
->REVENUE)

831 ià(
	ga
->
	gREVENUE
 < 
	gb
->REVENUE)

837 
vœtu®
 
q34_Üd”_key_com·»_t
 * 
şÚe
() const {

838  
Ãw
 
q34_Üd”_key_com·»_t
(*
this
);

845 şas 
	cssb_q34_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


847 
public
:

849 
	$begš
() {

850 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** q3_4 ANSWER ...\n");

851 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** ...\n");

854 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

855 
´ojeùed_tu¶e
 *
tu¶e
;

856 
tu¶e
 = 
®igÃd_ÿ¡
<
´ojeùed_tu¶e
>(
ouut
.
d©a
);

858 
	`TRACE
 ( 
TRACE_QUERY_RESULTS
, "PROCESS {%s} {%s} %d %d\n",
tu¶e
->
C_CITY
,u¶e->
S_CITY
,u¶e->
D_YEAR
,u¶e->
REVENUE
);

861 
	}
}

872 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_qpe_q3_4
(cÚ¡ 
xù_id
,

873 
q3_4_šput_t
& 
š
)

875 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** q3_4 *********\n");

878 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

879 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

883 
tu¶e_fifo
* 
lo_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q34_lo_tu¶e
));

884 
tsÿn_·ck‘_t
* 
lo_tsÿn_·ck‘
 =

885 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN LINEORDER",

886 
lo_out_bufãr
,

887 
Ãw
 
	`q34_lšeÜd”_tsÿn_f‹r_t
(
this
),

888 
this
->
	`db
(),

889 
_¶šeÜd”_desc
.
	`g‘
(),

890 
pxù


895 
tu¶e_fifo
* 
s_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q34_s_tu¶e
));

896 
tsÿn_·ck‘_t
* 
s_tsÿn_·ck‘
 =

897 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN SUPPLIER",

898 
s_out_bufãr
,

899 
Ãw
 
	`q34_suµl›r_tsÿn_f‹r_t
(
this
,
š
),

900 
this
->
	`db
(),

901 
_psuµl›r_desc
.
	`g‘
(),

902 
pxù


907 
tu¶e_fifo
* 
c_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q34_c_tu¶e
));

908 
tsÿn_·ck‘_t
* 
c_tsÿn_·ck‘
 =

909 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN CUSTOMER",

910 
c_out_bufãr
,

911 
Ãw
 
	`q34_cu¡om”_tsÿn_f‹r_t
(
this
,
š
),

912 
this
->
	`db
(),

913 
_pcu¡om”_desc
.
	`g‘
(),

914 
pxù


919 
tu¶e_fifo
* 
d_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q34_d_tu¶e
));

920 
tsÿn_·ck‘_t
* 
d_tsÿn_·ck‘
 =

921 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN DATE",

922 
d_out_bufãr
,

923 
Ãw
 
	`q34_d©e_tsÿn_f‹r_t
(
this
,
š
),

924 
this
->
	`db
(),

925 
_pd©e_desc
.
	`g‘
(),

926 
pxù


932 
tu¶e_fifo
* 
još_lo_s_out
 = 
Ãw
 
	`tu¶e_fifo
((
q34_još_s_tu¶e
));

933 
·ck‘_t
* 
još_lo_s_·ck‘
 =

934 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier JOIN",

935 
još_lo_s_out
,

936 
Ãw
 
	`ŒivŸl_f‹r_t
((
q34_još_s_tu¶e
)),

937 
lo_tsÿn_·ck‘
,

938 
s_tsÿn_·ck‘
,

939 
Ãw
 
	`q34_lo_s_još_t
() );

942 
tu¶e_fifo
* 
još_lo_s_d_out
 = 
Ãw
 
	`tu¶e_fifo
((
q34_još_s_d_tu¶e
));

943 
·ck‘_t
* 
još_lo_s_d_·ck‘
 =

944 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier - Date JOIN",

945 
još_lo_s_d_out
,

946 
Ãw
 
	`ŒivŸl_f‹r_t
((
q34_još_s_d_tu¶e
)),

947 
još_lo_s_·ck‘
,

948 
d_tsÿn_·ck‘
,

949 
Ãw
 
	`q34_lo_s_d_još_t
() );

952 
tu¶e_fifo
* 
još_out
 = 
Ãw
 
	`tu¶e_fifo
((
q34_još_tu¶e
));

953 
·ck‘_t
* 
još_·ck‘
 =

954 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier - Date - Customer JOIN",

955 
još_out
,

956 
Ãw
 
	`ŒivŸl_f‹r_t
((
q34_još_tu¶e
)),

957 
još_lo_s_d_·ck‘
,

958 
c_tsÿn_·ck‘
,

959 
Ãw
 
	`q34_još_t
() );

963 
tu¶e_fifo
* 
agg_ouut_bufãr
 =

964 
Ãw
 
	`tu¶e_fifo
( (
q34_agg»g©e_tu¶e
));

965 
·ck‘_t
* 
q34_agg_·ck‘
 =

966 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("AGG Q3_4",

967 
agg_ouut_bufãr
,

968 
Ãw
 
	`ŒivŸl_f‹r_t
(
agg_ouut_bufãr
->
	`tu¶e_size
()),

969 
još_·ck‘
,

970 
Ãw
 
	`q34_agg_agg»g©e_t
(),

971 
Ãw
 
	`q34_agg_šput_tu¶e_key_exŒaùÜ_t
(),

972 
Ãw
 
	`q34_agg_šput_tu¶e_key_com·»_t
());

974 
tu¶e_fifo
* 
sÜt_fš®_out
 = 
Ãw
 
	`tu¶e_fifo
((
q34_agg»g©e_tu¶e
));

975 
·ck‘_t
* 
q34_sÜt_fš®_·ck‘
 =

976 
Ãw
 
	`sÜt_·ck‘_t
("ORDER BY D_YEAR ASC, REVENUE DESC",

977 
sÜt_fš®_out
,

978 
Ãw
 
	`ŒivŸl_f‹r_t
((
q34_agg»g©e_tu¶e
)),

979 
Ãw
 
	`q34_Üd”_key_exŒaùÜ_t
(),

980 
Ãw
 
	`q34_Üd”_key_com·»_t
(),

981 
q34_agg_·ck‘
);

983 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

984 
lo_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

985 
s_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

986 
c_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

987 
d_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

988 
još_lo_s_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

989 
još_lo_s_d_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

990 
još_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

991 
q34_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

992 
q34_sÜt_fš®_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

995 
ssb_q34_´oûss_tu¶e_t
 
±
;

996 
	`´oûss_qu”y
(
q34_sÜt_fš®_·ck‘
, 
±
);

998 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

1000  (
RCOK
);

1001 
	}
}

1004 
EXIT_NAMESPACE
(
ssb
);

	@src/workload/ssb/qpipe/qpipe_q4_1.cpp

32 
	~"wÜklßd/ssb/shÜe_ssb_’v.h
"

33 
	~"qpe.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
usšg
 
Çme¥aû
 
	gqpe
;

40 
ENTER_NAMESPACE
(
ssb
);

65 
	sq41_lo_tu¶e


67 
	mLO_CUSTKEY
;

68 
	mLO_SUPPKEY
;

69 
	mLO_ORDERDATE
;

70 
	mLO_PARTKEY
;

71 
	mLO_REVENUE
;

72 
	mLO_SUPPLYCOST
;

75 
	sq41_c_tu¶e


77 
	mC_CUSTKEY
;

78 
	mC_NATION
[16];

81 
	sq41_s_tu¶e


83 
	mS_SUPPKEY
;

86 
	sq41_p_tu¶e


88 
	mP_PARTKEY
;

91 
	sq41_d_tu¶e


93 
	mD_DATEKEY
;

94 
	mD_YEAR
;

97 
	sq41_još_s_tu¶e


99 
	mLO_CUSTKEY
;

100 
	mLO_ORDERDATE
;

101 
	mLO_PARTKEY
;

102 
	mLO_REVENUE
;

103 
	mLO_SUPPLYCOST
;

106 
	sq41_još_s_c_tu¶e


108 
	mC_NATION
[16];

109 
	mLO_ORDERDATE
;

110 
	mLO_PARTKEY
;

111 
	mLO_REVENUE
;

112 
	mLO_SUPPLYCOST
;

116 
	sq41_još_s_c_p_tu¶e


118 
	mC_NATION
[16];

119 
	mLO_ORDERDATE
;

120 
	mLO_REVENUE
;

121 
	mLO_SUPPLYCOST
;

124 
	sq41_još_tu¶e


126 
	mC_NATION
[16];

127 
	mD_YEAR
;

128 
	mLO_REVENUE
;

129 
	mLO_SUPPLYCOST
;

132 
	sq41_agg»g©e_tu¶e


134 
	mC_NATION
[16];

135 
	mD_YEAR
;

136 
	mPROFIT
;

144 
q41_agg»g©e_tu¶e
 
	t´ojeùed_tu¶e
;

147 şas 
	cq41_lšeÜd”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


149 
´iv©e
:

150 
ShÜeSSBEnv
* 
_ssbdb
;

151 
bË_row_t
* 
	m_´lše
;

152 
»p_row_t
 
	m_¼
;

154 
ssb_lšeÜd”_tu¶e
 
	m_lšeÜd”
;

156 
	mpublic
:

158 
	$q41_lšeÜd”_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
)

159 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

163 
_´lše
 = 
_ssbdb
->
	`lšeÜd”_mª
()->
	`g‘_tu¶e
();

164 
_¼
.
	`£t_ts
(
_ssbdb
->
	`lšeÜd”_mª
()->
	`ts
(),

165 
_ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
());

166 
_´lše
->
_»p
 = &
_¼
;

170 ~
	$q41_lšeÜd”_tsÿn_f‹r_t
()

173 
_ssbdb
->
	`lšeÜd”_mª
()->
	`give_tu¶e
(
_´lše
);

174 
	}
}

178 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

181 ià(!
_ssbdb
->
	`lšeÜd”_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

182 
	`as£¹
(
çl£
);

185  (
Œue
);

186 
	}
}

190 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

192 
q41_lo_tu¶e
 *
de¡
;

193 
de¡
 = 
®igÃd_ÿ¡
<
q41_lo_tu¶e
>(
d
.
d©a
);

195 
_´lše
->
	`g‘_v®ue
(2, 
_lšeÜd”
.
LO_CUSTKEY
);

196 
_´lše
->
	`g‘_v®ue
(3, 
_lšeÜd”
.
LO_PARTKEY
);

197 
_´lše
->
	`g‘_v®ue
(4, 
_lšeÜd”
.
LO_SUPPKEY
);

198 
_´lše
->
	`g‘_v®ue
(5, 
_lšeÜd”
.
LO_ORDERDATE
);

199 
_´lše
->
	`g‘_v®ue
(12, 
_lšeÜd”
.
LO_REVENUE
);

200 
_´lše
->
	`g‘_v®ue
(13, 
_lšeÜd”
.
LO_SUPPLYCOST
);

202 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%d|%d|%d|%d|%d --d\n",

203 
_lšeÜd”
.
LO_CUSTKEY
,

204 
_lšeÜd”
.
LO_PARTKEY
,

205 
_lšeÜd”
.
LO_SUPPKEY
,

206 
_lšeÜd”
.
LO_ORDERDATE
,

207 
_lšeÜd”
.
LO_REVENUE
,

208 
_lšeÜd”
.
LO_SUPPLYCOST
);

210 
de¡
->
LO_CUSTKEY
 = 
_lšeÜd”
.LO_CUSTKEY;

211 
de¡
->
LO_PARTKEY
 = 
_lšeÜd”
.LO_PARTKEY;

212 
de¡
->
LO_SUPPKEY
 = 
_lšeÜd”
.LO_SUPPKEY;

213 
de¡
->
LO_ORDERDATE
 = 
_lšeÜd”
.LO_ORDERDATE;

214 
de¡
->
LO_REVENUE
 = 
_lšeÜd”
.LO_REVENUE;

215 
de¡
->
LO_SUPPLYCOST
 = 
_lšeÜd”
.LO_SUPPLYCOST;

217 
	}
}

219 
q41_lšeÜd”_tsÿn_f‹r_t
* 
	$şÚe
() const {

220  
Ãw
 
	`q41_lšeÜd”_tsÿn_f‹r_t
(*
this
);

221 
	}
}

223 
c_¡r
 
	$to_¡ršg
() const {

224  
	`c_¡r
("q41_lineorder_tscan_filter_t()");

225 
	}
}

229 şas 
	cq41_suµl›r_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


231 
´iv©e
:

232 
ShÜeSSBEnv
* 
_ssbdb
;

233 
bË_row_t
* 
	m_´suµ
;

234 
»p_row_t
 
	m_¼
;

236 
ssb_suµl›r_tu¶e
 
	m_suµl›r
;

239 
	mREGION
[13];

240 
	mpublic
:

242 
	$q41_suµl›r_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q4_1_šput_t
 &
š
)

243 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`suµl›r_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

247 
_´suµ
 = 
_ssbdb
->
	`suµl›r_mª
()->
	`g‘_tu¶e
();

248 
_¼
.
	`£t_ts
(
_ssbdb
->
	`suµl›r_mª
()->
	`ts
(),

249 
_ssbdb
->
	`suµl›r_desc
()->
	`maxsize
());

250 
_´suµ
->
_»p
 = &
_¼
;

253 
	`¡rıy
(
REGION
,"AMERICA");

256 ~
	$q41_suµl›r_tsÿn_f‹r_t
()

259 
_ssbdb
->
	`suµl›r_mª
()->
	`give_tu¶e
(
_´suµ
);

260 
	}
}

264 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

267 ià(!
_ssbdb
->
	`suµl›r_mª
()->
	`lßd
(
_´suµ
, 
šput
.
d©a
)) {

268 
	`as£¹
(
çl£
);

271 
_´suµ
->
	`g‘_v®ue
(5, 
_suµl›r
.
S_REGION
, 
	`STRSIZE
(12));

274 ià(
	`¡rcmp
(
_suµl›r
.
S_REGION
,
REGION
)==0)

276 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ REGION |%s --d\n",

277 
_suµl›r
.
S_REGION
);

278  (
Œue
);

282 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". REGION |%s --d\n",

283 
_suµl›r
.
S_REGION
);

284  (
çl£
);

286 
	}
}

290 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

292 
q41_s_tu¶e
 *
de¡
;

293 
de¡
 = 
®igÃd_ÿ¡
<
q41_s_tu¶e
>(
d
.
d©a
);

295 
_´suµ
->
	`g‘_v®ue
(0, 
_suµl›r
.
S_SUPPKEY
);

297 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d --d\n",

298 
_suµl›r
.
S_SUPPKEY
);

301 
de¡
->
S_SUPPKEY
 = 
_suµl›r
.S_SUPPKEY;

302 
	}
}

304 
q41_suµl›r_tsÿn_f‹r_t
* 
	$şÚe
() const {

305  
Ãw
 
	`q41_suµl›r_tsÿn_f‹r_t
(*
this
);

306 
	}
}

308 
c_¡r
 
	$to_¡ršg
() const {

309  
	`c_¡r
("q41_supplier_tscan_filter_t()");

310 
	}
}

314 şas 
	cq41_cu¡om”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


316 
´iv©e
:

317 
ShÜeSSBEnv
* 
_ssbdb
;

318 
bË_row_t
* 
	m_´cu¡
;

319 
»p_row_t
 
	m_¼
;

321 
ssb_cu¡om”_tu¶e
 
	m_cu¡om”
;

324 
	mREGION
[13];

325 
	mpublic
:

327 
	$q41_cu¡om”_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q4_1_šput_t
 &
š
)

328 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`cu¡om”_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

332 
_´cu¡
 = 
_ssbdb
->
	`cu¡om”_mª
()->
	`g‘_tu¶e
();

333 
_¼
.
	`£t_ts
(
_ssbdb
->
	`cu¡om”_mª
()->
	`ts
(),

334 
_ssbdb
->
	`cu¡om”_desc
()->
	`maxsize
());

335 
_´cu¡
->
_»p
 = &
_¼
;

338 
	`¡rıy
(
REGION
,"AMERICA");

341 ~
	$q41_cu¡om”_tsÿn_f‹r_t
()

344 
_ssbdb
->
	`cu¡om”_mª
()->
	`give_tu¶e
(
_´cu¡
);

345 
	}
}

349 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

352 ià(!
_ssbdb
->
	`cu¡om”_mª
()->
	`lßd
(
_´cu¡
, 
šput
.
d©a
)) {

353 
	`as£¹
(
çl£
);

356 
_´cu¡
->
	`g‘_v®ue
(5, 
_cu¡om”
.
C_REGION
, 
	`STRSIZE
(12));

358 ià(
	`¡rcmp
(
_cu¡om”
.
C_REGION
,
REGION
)==0)

360 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ REGION |%s --d\n",

361 
_cu¡om”
.
C_REGION
);

362  (
Œue
);

366 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". REGION |%s --d\n",

367 
_cu¡om”
.
C_REGION
);

368  (
çl£
);

370 
	}
}

374 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

376 
q41_c_tu¶e
 *
de¡
;

377 
de¡
 = 
®igÃd_ÿ¡
<
q41_c_tu¶e
>(
d
.
d©a
);

379 
_´cu¡
->
	`g‘_v®ue
(0, 
_cu¡om”
.
C_CUSTKEY
);

380 
_´cu¡
->
	`g‘_v®ue
(4, 
_cu¡om”
.
C_NATION
, 
	`STRSIZE
(15));

382 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%s --d\n",

383 
_cu¡om”
.
C_CUSTKEY
,

384 
_cu¡om”
.
C_NATION
);

387 
de¡
->
C_CUSTKEY
 = 
_cu¡om”
.C_CUSTKEY;

388 
	`¡rıy
(
de¡
->
C_NATION
,
_cu¡om”
.C_NATION);

389 
	}
}

391 
q41_cu¡om”_tsÿn_f‹r_t
* 
	$şÚe
() const {

392  
Ãw
 
	`q41_cu¡om”_tsÿn_f‹r_t
(*
this
);

393 
	}
}

395 
c_¡r
 
	$to_¡ršg
() const {

396  
	`c_¡r
("q41_customer_tscan_filter_t()");

397 
	}
}

401 şas 
	cq41_·¹_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


403 
´iv©e
:

404 
ShÜeSSBEnv
* 
_ssbdb
;

405 
bË_row_t
* 
	m_´·¹
;

406 
»p_row_t
 
	m_¼
;

408 
ssb_·¹_tu¶e
 
	m_·¹
;

411 
	mMFGR_1
[7];

412 
	mMFGR_2
[7];

414 
	mpublic
:

416 
	$q41_·¹_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q4_1_šput_t
 &
š
)

417 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`·¹_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

421 
_´·¹
 = 
_ssbdb
->
	`·¹_mª
()->
	`g‘_tu¶e
();

422 
_¼
.
	`£t_ts
(
_ssbdb
->
	`·¹_mª
()->
	`ts
(),

423 
_ssbdb
->
	`·¹_desc
()->
	`maxsize
());

424 
_´·¹
->
_»p
 = &
_¼
;

426 
	`¡rıy
(
MFGR_1
,"MFGR#1");

427 
	`¡rıy
(
MFGR_2
,"MFGR#2");

430 ~
	$q41_·¹_tsÿn_f‹r_t
()

433 
_ssbdb
->
	`·¹_mª
()->
	`give_tu¶e
(
_´·¹
);

434 
	}
}

438 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

441 ià(!
_ssbdb
->
	`·¹_mª
()->
	`lßd
(
_´·¹
, 
šput
.
d©a
)) {

442 
	`as£¹
(
çl£
);

445 
_´·¹
->
	`g‘_v®ue
(2, 
_·¹
.
P_MFGR
, 
	`STRSIZE
(6));

448 ià(
	`¡rcmp
(
_·¹
.
P_MFGR
, 
MFGR_1
)==0 || sŒcmp(_·¹.P_MFGR, 
MFGR_2
)==0)

450 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ MFGR |%s --d\n",

451 
_·¹
.
P_MFGR
);

452  (
Œue
);

456 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". MFGR |%s --d\n",

457 
_·¹
.
P_MFGR
);

458  (
çl£
);

461 
	}
}

465 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

467 
q41_p_tu¶e
 *
de¡
;

468 
de¡
 = 
®igÃd_ÿ¡
<
q41_p_tu¶e
>(
d
.
d©a
);

470 
_´·¹
->
	`g‘_v®ue
(0, 
_·¹
.
P_PARTKEY
);

472 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d --d\n",

473 
_·¹
.
P_PARTKEY
);

476 
de¡
->
P_PARTKEY
 = 
_·¹
.P_PARTKEY;

477 
	}
}

479 
q41_·¹_tsÿn_f‹r_t
* 
	$şÚe
() const {

480  
Ãw
 
	`q41_·¹_tsÿn_f‹r_t
(*
this
);

481 
	}
}

483 
c_¡r
 
	$to_¡ršg
() const {

484  
	`c_¡r
("q4_1_part_tscan_filter_t()");

485 
	}
}

489 şas 
	cq41_d©e_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


491 
´iv©e
:

492 
ShÜeSSBEnv
* 
_ssbdb
;

493 
bË_row_t
* 
	m_´d©e
;

494 
»p_row_t
 
	m_¼
;

496 
ssb_d©e_tu¶e
 
	m_d©e
;

499 
	mpublic
:

501 
	$q41_d©e_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q4_1_šput_t
 &
š
)

502 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`d©e_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

506 
_´d©e
 = 
_ssbdb
->
	`d©e_mª
()->
	`g‘_tu¶e
();

507 
_¼
.
	`£t_ts
(
_ssbdb
->
	`d©e_mª
()->
	`ts
(),

508 
_ssbdb
->
	`d©e_desc
()->
	`maxsize
());

509 
_´d©e
->
_»p
 = &
_¼
;

513 ~
	$q41_d©e_tsÿn_f‹r_t
()

516 
_ssbdb
->
	`d©e_mª
()->
	`give_tu¶e
(
_´d©e
);

517 
	}
}

521 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

524 ià(!
_ssbdb
->
	`d©e_mª
()->
	`lßd
(
_´d©e
, 
šput
.
d©a
)) {

525 
	`as£¹
(
çl£
);

528  (
Œue
);

530 
	}
}

534 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

536 
q41_d_tu¶e
 *
de¡
;

537 
de¡
 = 
®igÃd_ÿ¡
<
q41_d_tu¶e
>(
d
.
d©a
);

539 
_´d©e
->
	`g‘_v®ue
(0, 
_d©e
.
D_DATEKEY
);

540 
_´d©e
->
	`g‘_v®ue
(4, 
_d©e
.
D_YEAR
);

542 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%d --d\n",

543 
_d©e
.
D_DATEKEY
,

544 
_d©e
.
D_YEAR
);

547 
de¡
->
D_DATEKEY
 = 
_d©e
.D_DATEKEY;

548 
de¡
->
D_YEAR
=
_d©e
.D_YEAR;

549 
	}
}

551 
q41_d©e_tsÿn_f‹r_t
* 
	$şÚe
() const {

552  
Ãw
 
	`q41_d©e_tsÿn_f‹r_t
(*
this
);

553 
	}
}

555 
c_¡r
 
	$to_¡ršg
() const {

556  
	`c_¡r
("q4_1_date_tscan_filter_t()");

557 
	}
}

563 
	gq41_lo_s_još_t
 : 
public
 
tu¶e_još_t
 {

566 
q41_lo_s_još_t
 ()

567 : 
tu¶e_još_t
((
q41_lo_tu¶e
),

568 
off£tof
(
q41_lo_tu¶e
, 
LO_SUPPKEY
),

569 (
q41_s_tu¶e
),

570 
off£tof
(
q41_s_tu¶e
, 
S_SUPPKEY
),

572 (
q41_još_s_tu¶e
))

577 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

578 cÚ¡ 
tu¶e_t
 &
Ëá
,

579 cÚ¡ 
tu¶e_t
 &
right
)

582 
q41_lo_tu¶e
* 
	glo
 = 
®igÃd_ÿ¡
<q41_lo_tu¶e>(
Ëá
.
d©a
);

583 
q41_s_tu¶e
* 
	gs
 = 
®igÃd_ÿ¡
<q41_s_tu¶e>(
right
.
d©a
);

584 
q41_još_s_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q41_još_s_tu¶e>(
de¡
.
d©a
);

586 
	g»t
->
	gLO_CUSTKEY
 = 
lo
->
LO_CUSTKEY
;

587 
	g»t
->
	gLO_PARTKEY
 = 
lo
->
LO_PARTKEY
;

588 
	g»t
->
	gLO_ORDERDATE
 = 
lo
->
LO_ORDERDATE
;

589 
	g»t
->
	gLO_REVENUE
 = 
lo
->
LO_REVENUE
;

590 
	g»t
->
	gLO_SUPPLYCOST
 = 
lo
->
LO_SUPPLYCOST
;

593 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN %d %d %d %d %d\n",
»t
->
LO_CUSTKEY
,„‘->
LO_PARTKEY
,„‘->
LO_ORDERDATE
,„‘->
LO_REVENUE
,„‘->
LO_SUPPLYCOST
);

597 
vœtu®
 
q41_lo_s_još_t
* 
şÚe
() const {

598  
Ãw
 
q41_lo_s_još_t
(*
this
);

601 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

608 
	gq41_lo_s_c_još_t
 : 
public
 
tu¶e_još_t
 {

611 
q41_lo_s_c_još_t
 ()

612 : 
tu¶e_još_t
((
q41_još_s_tu¶e
),

613 
off£tof
(
q41_još_s_tu¶e
, 
LO_CUSTKEY
),

614 (
q41_c_tu¶e
),

615 
off£tof
(
q41_c_tu¶e
, 
C_CUSTKEY
),

617 (
q41_još_s_c_tu¶e
))

622 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

623 cÚ¡ 
tu¶e_t
 &
Ëá
,

624 cÚ¡ 
tu¶e_t
 &
right
)

627 
q41_još_s_tu¶e
* 
	gjo
 = 
®igÃd_ÿ¡
<q41_još_s_tu¶e>(
Ëá
.
d©a
);

628 
q41_c_tu¶e
* 
	gc
 = 
®igÃd_ÿ¡
<q41_c_tu¶e>(
right
.
d©a
);

629 
q41_još_s_c_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q41_još_s_c_tu¶e>(
de¡
.
d©a
);

631 
	g»t
->
	gLO_PARTKEY
 = 
jo
->
LO_PARTKEY
 ;

632 
	g»t
->
	gLO_ORDERDATE
 = 
jo
->
LO_ORDERDATE
 ;

633 
	g»t
->
	gLO_REVENUE
 = 
jo
->
LO_REVENUE
 ;

634 
	g»t
->
	gLO_SUPPLYCOST
 = 
jo
->
LO_SUPPLYCOST
 ;

636 
¡rıy
(
»t
->
C_NATION
,
c
->C_NATION);

638 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN {%s} %d %d %d %d\n",
»t
->
C_NATION
,„‘->
LO_PARTKEY
,„‘->
LO_ORDERDATE
,„‘->
LO_REVENUE
,„‘->
LO_SUPPLYCOST
);

642 
vœtu®
 
q41_lo_s_c_još_t
* 
şÚe
() const {

643  
Ãw
 
q41_lo_s_c_još_t
(*
this
);

646 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

653 
	gq41_lo_s_c_p_još_t
 : 
public
 
tu¶e_još_t
 {

656 
q41_lo_s_c_p_još_t
 ()

657 : 
tu¶e_još_t
((
q41_još_s_c_tu¶e
),

658 
off£tof
(
q41_još_s_c_tu¶e
, 
LO_PARTKEY
),

659 (
q41_p_tu¶e
),

660 
off£tof
(
q41_p_tu¶e
, 
P_PARTKEY
),

662 (
q41_još_s_c_p_tu¶e
))

667 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

668 cÚ¡ 
tu¶e_t
 &
Ëá
,

669 cÚ¡ 
tu¶e_t
 &
right
)

672 
q41_još_s_c_tu¶e
* 
	gjo
 = 
®igÃd_ÿ¡
<q41_još_s_c_tu¶e>(
Ëá
.
d©a
);

673 
q41_p_tu¶e
* 
	gp
 = 
®igÃd_ÿ¡
<q41_p_tu¶e>(
right
.
d©a
);

674 
q41_još_s_c_p_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q41_još_s_c_p_tu¶e>(
de¡
.
d©a
);

676 
	g»t
->
	gLO_ORDERDATE
 = 
jo
->
LO_ORDERDATE
 ;

677 
	g»t
->
	gLO_REVENUE
 = 
jo
->
LO_REVENUE
 ;

678 
	g»t
->
	gLO_SUPPLYCOST
 = 
jo
->
LO_SUPPLYCOST
 ;

681 
¡rıy
(
»t
->
C_NATION
,
jo
->C_NATION);

683 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN {%s} %d %d %d\n",
»t
->
C_NATION
,„‘->
LO_ORDERDATE
,„‘->
LO_REVENUE
,„‘->
LO_SUPPLYCOST
);

687 
vœtu®
 
q41_lo_s_c_p_još_t
* 
şÚe
() const {

688  
Ãw
 
q41_lo_s_c_p_još_t
(*
this
);

691 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

698 
	gq41_još_t
 : 
public
 
tu¶e_još_t
 {

701 
q41_još_t
 ()

702 : 
tu¶e_još_t
((
q41_još_s_c_p_tu¶e
),

703 
off£tof
(
q41_još_s_c_p_tu¶e
, 
LO_ORDERDATE
),

704 (
q41_d_tu¶e
),

705 
off£tof
(
q41_d_tu¶e
, 
D_DATEKEY
),

707 (
q41_još_tu¶e
))

712 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

713 cÚ¡ 
tu¶e_t
 &
Ëá
,

714 cÚ¡ 
tu¶e_t
 &
right
)

717 
q41_još_s_c_p_tu¶e
* 
	gjo
 = 
®igÃd_ÿ¡
<q41_još_s_c_p_tu¶e>(
Ëá
.
d©a
);

718 
q41_d_tu¶e
* 
	gd
 = 
®igÃd_ÿ¡
<q41_d_tu¶e>(
right
.
d©a
);

719 
q41_još_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q41_još_tu¶e>(
de¡
.
d©a
);

721 
¡rıy
(
»t
->
C_NATION
,
jo
->C_NATION);

722 
	g»t
->
	gD_YEAR
 = 
d
->
D_YEAR
;

723 
	g»t
->
	gLO_REVENUE
 = 
jo
->
LO_REVENUE
;

724 
	g»t
->
	gLO_SUPPLYCOST
 = 
jo
->
LO_SUPPLYCOST
;

727 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN {%s} %d %d %d\n",
»t
->
C_NATION
,„‘->
D_YEAR
,„‘->
LO_REVENUE
,„‘->
LO_SUPPLYCOST
);

731 
vœtu®
 
q41_još_t
* 
şÚe
() const {

732  
Ãw
 
q41_još_t
(*
this
);

735 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

743 
	sq41_agg_šput_tu¶e_key
 {

745 
	mC_NATION
[
STRSIZE
(15)];

746 
	mD_YEAR
;

749 
exŒaù_hšt
() {

750  (
	mthis
->
	mD_YEAR
 - 1990<< 24è+ (this->
	mC_NATION
[0] << 16) + (this->C_NATION[1] << 8) + (this->C_NATION[2]);

754 
	gq41_agg_šput_tu¶e_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

756 
q41_agg_šput_tu¶e_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
((
q41_agg_šput_tu¶e_key
), 
off£tof
(
q41_još_tu¶e
, 
C_NATION
)) {

759 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

760 
q41_agg_šput_tu¶e_key
* 
	g®igÃd_key
 = 
®igÃd_ÿ¡
<q41_agg_šput_tu¶e_key>(
key
);

780  
	g®igÃd_key
->
exŒaù_hšt
();

785 
vœtu®
 
q41_agg_šput_tu¶e_key_exŒaùÜ_t
 * 
şÚe
() const {

786  
Ãw
 
q41_agg_šput_tu¶e_key_exŒaùÜ_t
(*
this
);

790 
	gq41_agg_šput_tu¶e_key_com·»_t
 : 
public
 
key_com·»_t
 {

792 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

793 
q41_agg_šput_tu¶e_key
* 
	ga
 = 
®igÃd_ÿ¡
<q41_agg_šput_tu¶e_key>(
key1
);

794 
q41_agg_šput_tu¶e_key
* 
	gb
 = 
®igÃd_ÿ¡
<q41_agg_šput_tu¶e_key>(
key2
);

796 
	gú©iÚcom·risÚ
 = 
¡rcmp
(
a
->
C_NATION
, 
b
->C_NATION);

797 ià(
	gú©iÚcom·risÚ
 !ğ0è 
ú©iÚcom·risÚ
;

798  
	ga
->
	gD_YEAR
 - 
	gb
->D_YEAR;

801 
vœtu®
 
q41_agg_šput_tu¶e_key_com·»_t
 * 
şÚe
() const {

802  
Ãw
 
q41_agg_šput_tu¶e_key_com·»_t
(*
this
);

807 
q41_agg_šput_tu¶e_key
 
	tq41_agg_tu¶e_key
;

809 şas 
	cq41_agg_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

810 
´iv©e
:

812 
q41_agg_ouut_tu¶e_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

814 
q41_agg_ouut_tu¶e_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
( (
q41_agg_tu¶e_key
), 
off£tof
(
q41_agg»g©e_tu¶e
, 
C_NATION
)) {

817 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

818 
q41_agg_tu¶e_key
* 
	m®igÃd_key
 = 
®igÃd_ÿ¡
<q41_agg_tu¶e_key > (
key
);

819  
	m®igÃd_key
->
exŒaù_hšt
();

822 
vœtu®
 
q41_agg_ouut_tu¶e_key_exŒaùÜ_t
 * 
şÚe
() const {

823  
Ãw
 
q41_agg_ouut_tu¶e_key_exŒaùÜ_t
(*
this
);

827 
q41_agg_ouut_tu¶e_key_exŒaùÜ_t
 
	g_exŒaùÜ
;

829 
	gpublic
:

831 
	$q41_agg_agg»g©e_t
()

832 : 
	`tu¶e_agg»g©e_t
((
q41_agg»g©e_tu¶e
)) {

833 
	}
}

835 
key_exŒaùÜ_t
* 
	$key_exŒaùÜ
() {

836  &
_exŒaùÜ
;

837 
	}
}

839 
	$agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
s
) {

840 
q41_još_tu¶e
 *
¤c
;

841 
¤c
 = 
®igÃd_ÿ¡
<
q41_još_tu¶e
> (
s
.
d©a
);

842 
q41_agg»g©e_tu¶e
* 
tu¶e
 = 
®igÃd_ÿ¡
<q41_agg»g©e_tu¶e>(
agg_d©a
);

844 
tu¶e
->
PROFIT
 +ğ(
¤c
->
LO_REVENUE
 - src->
LO_SUPPLYCOST
);

845 
	`TRACE
(
TRACE_RECORD_FLOW
, "%.2f\n", 
tu¶e
->
PROFIT
);

846 
	}
}

848 
	$fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

849 
q41_agg»g©e_tu¶e
 *
de¡
;

850 
de¡
 = 
®igÃd_ÿ¡
<
q41_agg»g©e_tu¶e
 > (
d
.
d©a
);

851 
q41_agg»g©e_tu¶e
* 
tu¶e
 = 
®igÃd_ÿ¡
<q41_agg»g©e_tu¶> (
agg_d©a
);

853 *
de¡
 = *
tu¶e
;

854 
	}
}

856 
q41_agg_agg»g©e_t
* 
	$şÚe
() const {

857  
Ãw
 
	`q41_agg_agg»g©e_t
(*
this
);

858 
	}
}

860 
c_¡r
 
	$to_¡ršg
() const {

862 
	}
}

869 
	sq41_sÜt_tu¶e_key
 {

870 
	mC_NATION
[
STRSIZE
(15)];

871 
	mD_YEAR
;

875 
	gq41_Üd”_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

877 
q41_Üd”_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
( (
q41_sÜt_tu¶e_key
), 
off£tof
(
q41_agg»g©e_tu¶e
, 
C_NATION
)) {

880 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

881 
q41_sÜt_tu¶e_key
* 
	g®igÃd_key
 = 
®igÃd_ÿ¡
<q41_sÜt_tu¶e_key> (
key
);

888 
	g»suÉ
 = ((
®igÃd_key
->
D_YEAR
 - 1992è<< 28è+ (®igÃd_key->
C_NATION
[0] << 16)+(aligned_key->C_NATION[1] << 8)+(aligned_key->C_NATION[2]);

889  
	g»suÉ
;

894 
vœtu®
 
q41_Üd”_key_exŒaùÜ_t
 * 
şÚe
() const {

895  
Ãw
 
q41_Üd”_key_exŒaùÜ_t
(*
this
);

899 
	gq41_Üd”_key_com·»_t
 : 
public
 
key_com·»_t
 {

901 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

902 
q41_sÜt_tu¶e_key
* 
	ga
 = 
®igÃd_ÿ¡
<q41_sÜt_tu¶e_key>(
key1
);

903 
q41_sÜt_tu¶e_key
* 
	gb
 = 
®igÃd_ÿ¡
<q41_sÜt_tu¶e_key>(
key2
);

905 
	gy—rcom·risÚ
 = 
a
->
D_YEAR
 - 
b
->D_YEAR;

906 ià(
	gy—rcom·risÚ
 !ğ0è 
y—rcom·risÚ
;

907 
	gú©iÚcom·risÚ
 = 
¡rcmp
(
a
->
C_NATION
, 
b
->C_NATION);

908  
	gú©iÚcom·risÚ
;

911 
vœtu®
 
q41_Üd”_key_com·»_t
 * 
şÚe
() const {

912  
Ãw
 
q41_Üd”_key_com·»_t
(*
this
);

920 şas 
	cssb_q41_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


922 
public
:

924 
	$begš
() {

925 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** q4_1 ANSWER ...\n");

926 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** ...\n");

929 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

930 
´ojeùed_tu¶e
 *
tu¶e
;

931 
tu¶e
 = 
®igÃd_ÿ¡
<
´ojeùed_tu¶e
>(
ouut
.
d©a
);

933 
	`TRACE
 ( 
TRACE_QUERY_RESULTS
, "PROCESS %d {%s} %d\n",
tu¶e
->
D_YEAR
,u¶e->
C_NATION
,u¶e->
PROFIT
);

937 
	}
}

948 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_qpe_q4_1
(cÚ¡ 
xù_id
,

949 
q4_1_šput_t
& 
š
)

951 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** q4_1 *********\n");

954 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

955 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

960 
tu¶e_fifo
* 
lo_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q41_lo_tu¶e
));

961 
tsÿn_·ck‘_t
* 
lo_tsÿn_·ck‘
 =

962 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN LINEORDER",

963 
lo_out_bufãr
,

964 
Ãw
 
	`q41_lšeÜd”_tsÿn_f‹r_t
(
this
),

965 
this
->
	`db
(),

966 
_¶šeÜd”_desc
.
	`g‘
(),

967 
pxù


971 
tu¶e_fifo
* 
s_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q41_s_tu¶e
));

972 
tsÿn_·ck‘_t
* 
s_tsÿn_·ck‘
 =

973 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN SUPPLIER",

974 
s_out_bufãr
,

975 
Ãw
 
	`q41_suµl›r_tsÿn_f‹r_t
(
this
,
š
),

976 
this
->
	`db
(),

977 
_psuµl›r_desc
.
	`g‘
(),

978 
pxù


982 
tu¶e_fifo
* 
c_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q41_c_tu¶e
));

983 
tsÿn_·ck‘_t
* 
c_tsÿn_·ck‘
 =

984 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN CUSTOMER",

985 
c_out_bufãr
,

986 
Ãw
 
	`q41_cu¡om”_tsÿn_f‹r_t
(
this
,
š
),

987 
this
->
	`db
(),

988 
_pcu¡om”_desc
.
	`g‘
(),

989 
pxù


993 
tu¶e_fifo
* 
p_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q41_p_tu¶e
));

994 
tsÿn_·ck‘_t
* 
p_tsÿn_·ck‘
 =

995 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN…art",

996 
p_out_bufãr
,

997 
Ãw
 
	`q41_·¹_tsÿn_f‹r_t
(
this
,
š
),

998 
this
->
	`db
(),

999 
_µ¬t_desc
.
	`g‘
(),

1000 
pxù


1004 
tu¶e_fifo
* 
d_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q41_d_tu¶e
));

1005 
tsÿn_·ck‘_t
* 
d_tsÿn_·ck‘
 =

1006 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN DATE",

1007 
d_out_bufãr
,

1008 
Ãw
 
	`q41_d©e_tsÿn_f‹r_t
(
this
,
š
),

1009 
this
->
	`db
(),

1010 
_pd©e_desc
.
	`g‘
(),

1011 
pxù


1017 
tu¶e_fifo
* 
još_lo_s_out
 = 
Ãw
 
	`tu¶e_fifo
((
q41_još_s_tu¶e
));

1018 
·ck‘_t
* 
još_lo_s_·ck‘
 =

1019 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier JOIN",

1020 
još_lo_s_out
,

1021 
Ãw
 
	`ŒivŸl_f‹r_t
((
q41_još_s_tu¶e
)),

1022 
lo_tsÿn_·ck‘
,

1023 
s_tsÿn_·ck‘
,

1024 
Ãw
 
	`q41_lo_s_još_t
() );

1027 
tu¶e_fifo
* 
još_lo_s_c_out
 = 
Ãw
 
	`tu¶e_fifo
((
q41_još_s_c_tu¶e
));

1028 
·ck‘_t
* 
još_lo_s_c_·ck‘
 =

1029 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier - Customer JOIN",

1030 
još_lo_s_c_out
,

1031 
Ãw
 
	`ŒivŸl_f‹r_t
((
q41_još_s_c_tu¶e
)),

1032 
još_lo_s_·ck‘
,

1033 
c_tsÿn_·ck‘
,

1034 
Ãw
 
	`q41_lo_s_c_još_t
() );

1037 
tu¶e_fifo
* 
još_lo_s_c_p_out
 = 
Ãw
 
	`tu¶e_fifo
((
q41_još_s_c_p_tu¶e
));

1038 
·ck‘_t
* 
još_lo_s_c_p_·ck‘
 =

1039 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier - Customer - Part JOIN",

1040 
još_lo_s_c_p_out
,

1041 
Ãw
 
	`ŒivŸl_f‹r_t
((
q41_još_s_c_p_tu¶e
)),

1042 
još_lo_s_c_·ck‘
,

1043 
p_tsÿn_·ck‘
,

1044 
Ãw
 
	`q41_lo_s_c_p_još_t
() );

1047 
tu¶e_fifo
* 
još_out
 = 
Ãw
 
	`tu¶e_fifo
((
q41_još_tu¶e
));

1048 
·ck‘_t
* 
još_·ck‘
 =

1049 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier - Customer - Part - Date JOIN",

1050 
još_out
,

1051 
Ãw
 
	`ŒivŸl_f‹r_t
((
q41_još_tu¶e
)),

1052 
još_lo_s_c_p_·ck‘
,

1053 
d_tsÿn_·ck‘
,

1054 
Ãw
 
	`q41_još_t
() );

1058 
tu¶e_fifo
* 
agg_ouut_bufãr
 =

1059 
Ãw
 
	`tu¶e_fifo
( (
q41_agg»g©e_tu¶e
));

1060 
·ck‘_t
* 
q41_agg_·ck‘
 =

1061 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("AGG Q4_1",

1062 
agg_ouut_bufãr
,

1063 
Ãw
 
	`ŒivŸl_f‹r_t
(
agg_ouut_bufãr
->
	`tu¶e_size
()),

1064 
još_·ck‘
,

1065 
Ãw
 
	`q41_agg_agg»g©e_t
(),

1066 
Ãw
 
	`q41_agg_šput_tu¶e_key_exŒaùÜ_t
(),

1067 
Ãw
 
	`q41_agg_šput_tu¶e_key_com·»_t
());

1070 
tu¶e_fifo
* 
sÜt_fš®_out
 = 
Ãw
 
	`tu¶e_fifo
((
q41_agg»g©e_tu¶e
));

1071 
·ck‘_t
* 
q41_sÜt_fš®_·ck‘
 =

1072 
Ãw
 
	`sÜt_·ck‘_t
("ORDER BY D_YEAR ASC, REVENUE DESC",

1073 
sÜt_fš®_out
,

1074 
Ãw
 
	`ŒivŸl_f‹r_t
((
q41_agg»g©e_tu¶e
)),

1075 
Ãw
 
	`q41_Üd”_key_exŒaùÜ_t
(),

1076 
Ãw
 
	`q41_Üd”_key_com·»_t
(),

1077 
q41_agg_·ck‘
);

1080 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

1081 
lo_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1082 
s_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1083 
c_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1084 
p_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1085 
d_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1086 
još_lo_s_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1087 
još_lo_s_c_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1088 
još_lo_s_c_p_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1089 
još_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1090 
q41_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1091 
q41_sÜt_fš®_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1094 
ssb_q41_´oûss_tu¶e_t
 
±
;

1095 
	`´oûss_qu”y
(
q41_sÜt_fš®_·ck‘
, 
±
);

1096 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

1098  (
RCOK
);

1099 
	}
}

1102 
EXIT_NAMESPACE
(
ssb
);

	@src/workload/ssb/qpipe/qpipe_q4_2.cpp

33 
	~"wÜklßd/ssb/shÜe_ssb_’v.h
"

34 
	~"qpe.h
"

36 
usšg
 
Çme¥aû
 
	gshÜe
;

37 
usšg
 
Çme¥aû
 
	gqpe
;

41 
ENTER_NAMESPACE
(
ssb
);

67 
	sq42_lo_tu¶e


69 
	mLO_CUSTKEY
;

70 
	mLO_SUPPKEY
;

71 
	mLO_ORDERDATE
;

72 
	mLO_PARTKEY
;

73 
	mLO_REVENUE
;

74 
	mLO_SUPPLYCOST
;

77 
	sq42_c_tu¶e


79 
	mC_CUSTKEY
;

82 
	sq42_s_tu¶e


84 
	mS_SUPPKEY
;

85 
	mS_NATION
[16];

88 
	sq42_p_tu¶e


90 
	mP_PARTKEY
;

91 
	mP_CATEGORY
[8];

94 
	sq42_d_tu¶e


96 
	mD_DATEKEY
;

97 
	mD_YEAR
;

100 
	sq42_još_s_tu¶e


102 
	mS_NATION
[16];

103 
	mLO_CUSTKEY
;

104 
	mLO_ORDERDATE
;

105 
	mLO_PARTKEY
;

106 
	mLO_REVENUE
;

107 
	mLO_SUPPLYCOST
;

110 
	sq42_još_s_d_tu¶e


112 
	mD_YEAR
;

113 
	mS_NATION
[16];

114 
	mLO_CUSTKEY
;

115 
	mLO_PARTKEY
;

116 
	mLO_REVENUE
;

117 
	mLO_SUPPLYCOST
;

121 
	sq42_još_s_d_p_tu¶e


123 
	mD_YEAR
;

124 
	mS_NATION
[16];

125 
	mP_CATEGORY
[8];

126 
	mLO_CUSTKEY
;

127 
	mLO_REVENUE
;

128 
	mLO_SUPPLYCOST
;

131 
	sq42_još_tu¶e


133 
	mS_NATION
[16];

134 
	mP_CATEGORY
[8];

135 
	mD_YEAR
;

136 
	mLO_REVENUE
;

137 
	mLO_SUPPLYCOST
;

140 
	sq42_agg»g©e_tu¶e


142 
	mS_NATION
[16];

143 
	mP_CATEGORY
[8];

144 
	mD_YEAR
;

145 
	mPROFIT
;

154 
q42_agg»g©e_tu¶e
 
	t´ojeùed_tu¶e
;

157 şas 
	cq42_lšeÜd”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


159 
´iv©e
:

160 
ShÜeSSBEnv
* 
_ssbdb
;

161 
bË_row_t
* 
	m_´lše
;

162 
»p_row_t
 
	m_¼
;

164 
ssb_lšeÜd”_tu¶e
 
	m_lšeÜd”
;

166 
	mpublic
:

168 
	$q42_lšeÜd”_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
)

169 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

173 
_´lše
 = 
_ssbdb
->
	`lšeÜd”_mª
()->
	`g‘_tu¶e
();

174 
_¼
.
	`£t_ts
(
_ssbdb
->
	`lšeÜd”_mª
()->
	`ts
(),

175 
_ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
());

176 
_´lše
->
_»p
 = &
_¼
;

180 ~
	$q42_lšeÜd”_tsÿn_f‹r_t
()

183 
_ssbdb
->
	`lšeÜd”_mª
()->
	`give_tu¶e
(
_´lše
);

184 
	}
}

188 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

191 ià(!
_ssbdb
->
	`lšeÜd”_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

192 
	`as£¹
(
çl£
);

195  (
Œue
);

196 
	}
}

200 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

202 
q42_lo_tu¶e
 *
de¡
;

203 
de¡
 = 
®igÃd_ÿ¡
<
q42_lo_tu¶e
>(
d
.
d©a
);

205 
_´lše
->
	`g‘_v®ue
(2, 
_lšeÜd”
.
LO_CUSTKEY
);

206 
_´lše
->
	`g‘_v®ue
(3, 
_lšeÜd”
.
LO_PARTKEY
);

207 
_´lše
->
	`g‘_v®ue
(4, 
_lšeÜd”
.
LO_SUPPKEY
);

208 
_´lše
->
	`g‘_v®ue
(5, 
_lšeÜd”
.
LO_ORDERDATE
);

209 
_´lše
->
	`g‘_v®ue
(12, 
_lšeÜd”
.
LO_REVENUE
);

210 
_´lše
->
	`g‘_v®ue
(13, 
_lšeÜd”
.
LO_SUPPLYCOST
);

212 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%d|%d|%d|%d|%d --d\n",

213 
_lšeÜd”
.
LO_CUSTKEY
,

214 
_lšeÜd”
.
LO_PARTKEY
,

215 
_lšeÜd”
.
LO_SUPPKEY
,

216 
_lšeÜd”
.
LO_ORDERDATE
,

217 
_lšeÜd”
.
LO_REVENUE
,

218 
_lšeÜd”
.
LO_SUPPLYCOST
);

220 
de¡
->
LO_CUSTKEY
 = 
_lšeÜd”
.LO_CUSTKEY;

221 
de¡
->
LO_PARTKEY
 = 
_lšeÜd”
.LO_PARTKEY;

222 
de¡
->
LO_SUPPKEY
 = 
_lšeÜd”
.LO_SUPPKEY;

223 
de¡
->
LO_ORDERDATE
 = 
_lšeÜd”
.LO_ORDERDATE;

224 
de¡
->
LO_REVENUE
 = 
_lšeÜd”
.LO_REVENUE;

225 
de¡
->
LO_SUPPLYCOST
 = 
_lšeÜd”
.LO_SUPPLYCOST;

227 
	}
}

229 
q42_lšeÜd”_tsÿn_f‹r_t
* 
	$şÚe
() const {

230  
Ãw
 
	`q42_lšeÜd”_tsÿn_f‹r_t
(*
this
);

231 
	}
}

233 
c_¡r
 
	$to_¡ršg
() const {

234  
	`c_¡r
("q42_lineorder_tscan_filter_t()");

235 
	}
}

239 şas 
	cq42_suµl›r_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


241 
´iv©e
:

242 
ShÜeSSBEnv
* 
_ssbdb
;

243 
bË_row_t
* 
	m_´suµ
;

244 
»p_row_t
 
	m_¼
;

246 
ssb_suµl›r_tu¶e
 
	m_suµl›r
;

249 
	mREGION
[13];

250 
	mpublic
:

252 
	$q42_suµl›r_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q4_2_šput_t
 &
š
)

253 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`suµl›r_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

257 
_´suµ
 = 
_ssbdb
->
	`suµl›r_mª
()->
	`g‘_tu¶e
();

258 
_¼
.
	`£t_ts
(
_ssbdb
->
	`suµl›r_mª
()->
	`ts
(),

259 
_ssbdb
->
	`suµl›r_desc
()->
	`maxsize
());

260 
_´suµ
->
_»p
 = &
_¼
;

263 
	`¡rıy
(
REGION
,"AMERICA");

266 ~
	$q42_suµl›r_tsÿn_f‹r_t
()

269 
_ssbdb
->
	`suµl›r_mª
()->
	`give_tu¶e
(
_´suµ
);

270 
	}
}

274 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

277 ià(!
_ssbdb
->
	`suµl›r_mª
()->
	`lßd
(
_´suµ
, 
šput
.
d©a
)) {

278 
	`as£¹
(
çl£
);

281 
_´suµ
->
	`g‘_v®ue
(5, 
_suµl›r
.
S_REGION
, 
	`STRSIZE
(12));

284 ià(
	`¡rcmp
(
_suµl›r
.
S_REGION
,
REGION
)==0)

286 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ REGION |%s --d\n",

287 
_suµl›r
.
S_REGION
);

288  (
Œue
);

292 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". REGION |%s --d\n",

293 
_suµl›r
.
S_REGION
);

294  (
çl£
);

296 
	}
}

300 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

302 
q42_s_tu¶e
 *
de¡
;

303 
de¡
 = 
®igÃd_ÿ¡
<
q42_s_tu¶e
>(
d
.
d©a
);

305 
_´suµ
->
	`g‘_v®ue
(0, 
_suµl›r
.
S_SUPPKEY
);

306 
_´suµ
->
	`g‘_v®ue
(4, 
_suµl›r
.
S_NATION
, 
	`STRSIZE
(15));

308 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d {%s} --d\n",

309 
_suµl›r
.
S_SUPPKEY
,

310 
_suµl›r
.
S_NATION
);

313 
de¡
->
S_SUPPKEY
 = 
_suµl›r
.S_SUPPKEY;

314 
	`¡rıy
(
de¡
->
S_NATION
, 
_suµl›r
.S_NATION);

315 
	}
}

317 
q42_suµl›r_tsÿn_f‹r_t
* 
	$şÚe
() const {

318  
Ãw
 
	`q42_suµl›r_tsÿn_f‹r_t
(*
this
);

319 
	}
}

321 
c_¡r
 
	$to_¡ršg
() const {

322  
	`c_¡r
("q42_supplier_tscan_filter_t()");

323 
	}
}

327 şas 
	cq42_cu¡om”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


329 
´iv©e
:

330 
ShÜeSSBEnv
* 
_ssbdb
;

331 
bË_row_t
* 
	m_´cu¡
;

332 
»p_row_t
 
	m_¼
;

334 
ssb_cu¡om”_tu¶e
 
	m_cu¡om”
;

337 
	mREGION
[13];

338 
	mpublic
:

340 
	$q42_cu¡om”_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q4_2_šput_t
 &
š
)

341 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`cu¡om”_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

345 
_´cu¡
 = 
_ssbdb
->
	`cu¡om”_mª
()->
	`g‘_tu¶e
();

346 
_¼
.
	`£t_ts
(
_ssbdb
->
	`cu¡om”_mª
()->
	`ts
(),

347 
_ssbdb
->
	`cu¡om”_desc
()->
	`maxsize
());

348 
_´cu¡
->
_»p
 = &
_¼
;

351 
	`¡rıy
(
REGION
,"AMERICA");

354 ~
	$q42_cu¡om”_tsÿn_f‹r_t
()

357 
_ssbdb
->
	`cu¡om”_mª
()->
	`give_tu¶e
(
_´cu¡
);

358 
	}
}

362 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

365 ià(!
_ssbdb
->
	`cu¡om”_mª
()->
	`lßd
(
_´cu¡
, 
šput
.
d©a
)) {

366 
	`as£¹
(
çl£
);

369 
_´cu¡
->
	`g‘_v®ue
(5, 
_cu¡om”
.
C_REGION
, 
	`STRSIZE
(12));

371 ià(
	`¡rcmp
(
_cu¡om”
.
C_REGION
,
REGION
)==0)

373 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ REGION |%s --d\n",

374 
_cu¡om”
.
C_REGION
);

375  (
Œue
);

379 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". REGION |%s --d\n",

380 
_cu¡om”
.
C_REGION
);

381  (
çl£
);

383 
	}
}

387 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

389 
q42_c_tu¶e
 *
de¡
;

390 
de¡
 = 
®igÃd_ÿ¡
<
q42_c_tu¶e
>(
d
.
d©a
);

392 
_´cu¡
->
	`g‘_v®ue
(0, 
_cu¡om”
.
C_CUSTKEY
);

394 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d --d\n",

395 
_cu¡om”
.
C_CUSTKEY
);

398 
de¡
->
C_CUSTKEY
 = 
_cu¡om”
.C_CUSTKEY;

399 
	}
}

401 
q42_cu¡om”_tsÿn_f‹r_t
* 
	$şÚe
() const {

402  
Ãw
 
	`q42_cu¡om”_tsÿn_f‹r_t
(*
this
);

403 
	}
}

405 
c_¡r
 
	$to_¡ršg
() const {

406  
	`c_¡r
("q42_customer_tscan_filter_t()");

407 
	}
}

411 şas 
	cq42_·¹_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


413 
´iv©e
:

414 
ShÜeSSBEnv
* 
_ssbdb
;

415 
bË_row_t
* 
	m_´·¹
;

416 
»p_row_t
 
	m_¼
;

418 
ssb_·¹_tu¶e
 
	m_·¹
;

421 
	mMFGR_1
[7];

422 
	mMFGR_2
[7];

424 
	mpublic
:

426 
	$q42_·¹_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q4_2_šput_t
 &
š
)

427 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`·¹_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

431 
_´·¹
 = 
_ssbdb
->
	`·¹_mª
()->
	`g‘_tu¶e
();

432 
_¼
.
	`£t_ts
(
_ssbdb
->
	`·¹_mª
()->
	`ts
(),

433 
_ssbdb
->
	`·¹_desc
()->
	`maxsize
());

434 
_´·¹
->
_»p
 = &
_¼
;

436 
	`¡rıy
(
MFGR_1
,"MFGR#1");

437 
	`¡rıy
(
MFGR_2
,"MFGR#2");

440 ~
	$q42_·¹_tsÿn_f‹r_t
()

443 
_ssbdb
->
	`·¹_mª
()->
	`give_tu¶e
(
_´·¹
);

444 
	}
}

448 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

451 ià(!
_ssbdb
->
	`·¹_mª
()->
	`lßd
(
_´·¹
, 
šput
.
d©a
)) {

452 
	`as£¹
(
çl£
);

455 
_´·¹
->
	`g‘_v®ue
(2, 
_·¹
.
P_MFGR
, 
	`STRSIZE
(6));

458 ià(
	`¡rcmp
(
_·¹
.
P_MFGR
, 
MFGR_1
)==0 || sŒcmp(_·¹.P_MFGR, 
MFGR_2
)==0)

460 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ MFGR |%s --d\n",

461 
_·¹
.
P_MFGR
);

462  (
Œue
);

466 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". MFGR |%s --d\n",

467 
_·¹
.
P_MFGR
);

468  (
çl£
);

471 
	}
}

475 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

477 
q42_p_tu¶e
 *
de¡
;

478 
de¡
 = 
®igÃd_ÿ¡
<
q42_p_tu¶e
>(
d
.
d©a
);

480 
_´·¹
->
	`g‘_v®ue
(0, 
_·¹
.
P_PARTKEY
);

481 
_´·¹
->
	`g‘_v®ue
(3, 
_·¹
.
P_CATEGORY
, 
	`STRSIZE
(7));

484 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d |%s --d\n",

485 
_·¹
.
P_PARTKEY
,

486 
_·¹
.
P_CATEGORY
);

489 
de¡
->
P_PARTKEY
 = 
_·¹
.P_PARTKEY;

490 
	`¡rıy
(
de¡
->
P_CATEGORY
, 
_·¹
.P_CATEGORY);

492 
	}
}

494 
q42_·¹_tsÿn_f‹r_t
* 
	$şÚe
() const {

495  
Ãw
 
	`q42_·¹_tsÿn_f‹r_t
(*
this
);

496 
	}
}

498 
c_¡r
 
	$to_¡ršg
() const {

499  
	`c_¡r
("q42_part_tscan_filter_t()");

500 
	}
}

504 şas 
	cq42_d©e_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


506 
´iv©e
:

507 
ShÜeSSBEnv
* 
_ssbdb
;

508 
bË_row_t
* 
	m_´d©e
;

509 
»p_row_t
 
	m_¼
;

511 
ssb_d©e_tu¶e
 
	m_d©e
;

513 
	mYEAR_LOW
;

514 
	mYEAR_HIGH
;

516 
	mpublic
:

518 
	$q42_d©e_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q4_2_šput_t
 &
š
)

519 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`d©e_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

523 
_´d©e
 = 
_ssbdb
->
	`d©e_mª
()->
	`g‘_tu¶e
();

524 
_¼
.
	`£t_ts
(
_ssbdb
->
	`d©e_mª
()->
	`ts
(),

525 
_ssbdb
->
	`d©e_desc
()->
	`maxsize
());

526 
_´d©e
->
_»p
 = &
_¼
;

528 
YEAR_LOW
=1997;

529 
YEAR_HIGH
=1998;

532 ~
	$q42_d©e_tsÿn_f‹r_t
()

535 
_ssbdb
->
	`d©e_mª
()->
	`give_tu¶e
(
_´d©e
);

536 
	}
}

540 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

543 ià(!
_ssbdb
->
	`d©e_mª
()->
	`lßd
(
_´d©e
, 
šput
.
d©a
)) {

544 
	`as£¹
(
çl£
);

547 
_´d©e
->
	`g‘_v®ue
(4, 
_d©e
.
D_YEAR
);

550 ià(
_d©e
.
D_YEAR
==
YEAR_LOW
 || _d©e.D_YEAR==
YEAR_HIGH
)

552 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ YEAR |%d --d\n",

553 
_d©e
.
D_YEAR
);

554  (
Œue
);

558 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". YEAR |%d --d\n",

559 
_d©e
.
D_YEAR
);

560  (
çl£
);

563 
	}
}

567 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

569 
q42_d_tu¶e
 *
de¡
;

570 
de¡
 = 
®igÃd_ÿ¡
<
q42_d_tu¶e
>(
d
.
d©a
);

572 
_´d©e
->
	`g‘_v®ue
(0, 
_d©e
.
D_DATEKEY
);

573 
_´d©e
->
	`g‘_v®ue
(4, 
_d©e
.
D_YEAR
);

575 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%d --d\n",

576 
_d©e
.
D_DATEKEY
,

577 
_d©e
.
D_YEAR
);

580 
de¡
->
D_DATEKEY
 = 
_d©e
.D_DATEKEY;

581 
de¡
->
D_YEAR
=
_d©e
.D_YEAR;

582 
	}
}

584 
q42_d©e_tsÿn_f‹r_t
* 
	$şÚe
() const {

585  
Ãw
 
	`q42_d©e_tsÿn_f‹r_t
(*
this
);

586 
	}
}

588 
c_¡r
 
	$to_¡ršg
() const {

589  
	`c_¡r
("q42_date_tscan_filter_t()");

590 
	}
}

596 
	gq42_lo_s_još_t
 : 
public
 
tu¶e_još_t
 {

599 
q42_lo_s_još_t
 ()

600 : 
tu¶e_još_t
((
q42_lo_tu¶e
),

601 
off£tof
(
q42_lo_tu¶e
, 
LO_SUPPKEY
),

602 (
q42_s_tu¶e
),

603 
off£tof
(
q42_s_tu¶e
, 
S_SUPPKEY
),

605 (
q42_još_s_tu¶e
))

610 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

611 cÚ¡ 
tu¶e_t
 &
Ëá
,

612 cÚ¡ 
tu¶e_t
 &
right
)

615 
q42_lo_tu¶e
* 
	glo
 = 
®igÃd_ÿ¡
<q42_lo_tu¶e>(
Ëá
.
d©a
);

616 
q42_s_tu¶e
* 
	gs
 = 
®igÃd_ÿ¡
<q42_s_tu¶e>(
right
.
d©a
);

617 
q42_još_s_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q42_još_s_tu¶e>(
de¡
.
d©a
);

619 
	g»t
->
	gLO_CUSTKEY
 = 
lo
->
LO_CUSTKEY
;

620 
	g»t
->
	gLO_PARTKEY
 = 
lo
->
LO_PARTKEY
;

621 
	g»t
->
	gLO_ORDERDATE
 = 
lo
->
LO_ORDERDATE
;

622 
	g»t
->
	gLO_REVENUE
 = 
lo
->
LO_REVENUE
;

623 
	g»t
->
	gLO_SUPPLYCOST
 = 
lo
->
LO_SUPPLYCOST
;

625 
¡rıy
(
»t
->
S_NATION
, 
s
->S_NATION);

627 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN {%s} %d %d %d %d %d\n",
»t
->
S_NATION
,„‘->
LO_CUSTKEY
,„‘->
LO_PARTKEY
,„‘->
LO_ORDERDATE
,„‘->
LO_REVENUE
,„‘->
LO_SUPPLYCOST
);

631 
vœtu®
 
q42_lo_s_još_t
* 
şÚe
() const {

632  
Ãw
 
q42_lo_s_još_t
(*
this
);

635 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

642 
	gq42_lo_s_d_još_t
 : 
public
 
tu¶e_još_t
 {

645 
q42_lo_s_d_još_t
 ()

646 : 
tu¶e_još_t
((
q42_još_s_tu¶e
),

647 
off£tof
(
q42_još_s_tu¶e
, 
LO_ORDERDATE
),

648 (
q42_d_tu¶e
),

649 
off£tof
(
q42_d_tu¶e
, 
D_DATEKEY
),

651 (
q42_još_s_d_tu¶e
))

656 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

657 cÚ¡ 
tu¶e_t
 &
Ëá
,

658 cÚ¡ 
tu¶e_t
 &
right
)

661 
q42_još_s_tu¶e
* 
	gjo
 = 
®igÃd_ÿ¡
<q42_još_s_tu¶e>(
Ëá
.
d©a
);

662 
q42_d_tu¶e
* 
	gd
 = 
®igÃd_ÿ¡
<q42_d_tu¶e>(
right
.
d©a
);

663 
q42_još_s_d_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q42_još_s_d_tu¶e>(
de¡
.
d©a
);

665 
	g»t
->
	gD_YEAR
 = 
d
->
D_YEAR
 ;

666 
	g»t
->
	gLO_CUSTKEY
 = 
jo
->
LO_CUSTKEY
 ;

667 
	g»t
->
	gLO_PARTKEY
 = 
jo
->
LO_PARTKEY
 ;

668 
	g»t
->
	gLO_REVENUE
 = 
jo
->
LO_REVENUE
 ;

669 
	g»t
->
	gLO_SUPPLYCOST
 = 
jo
->
LO_SUPPLYCOST
;

671 
¡rıy
(
»t
->
S_NATION
,
jo
->S_NATION);

673 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN {%s} %d %d %d %d %d\n",
»t
->
S_NATION
,„‘->
D_YEAR
,„‘->
LO_CUSTKEY
,„‘->
LO_PARTKEY
,„‘->
LO_REVENUE
,„‘->
LO_SUPPLYCOST
);

677 
vœtu®
 
q42_lo_s_d_još_t
* 
şÚe
() const {

678  
Ãw
 
q42_lo_s_d_još_t
(*
this
);

681 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

688 
	gq42_lo_s_d_p_još_t
 : 
public
 
tu¶e_još_t
 {

691 
q42_lo_s_d_p_još_t
 ()

692 : 
tu¶e_još_t
((
q42_još_s_d_tu¶e
),

693 
off£tof
(
q42_još_s_d_tu¶e
, 
LO_PARTKEY
),

694 (
q42_p_tu¶e
),

695 
off£tof
(
q42_p_tu¶e
, 
P_PARTKEY
),

697 (
q42_još_s_d_p_tu¶e
))

702 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

703 cÚ¡ 
tu¶e_t
 &
Ëá
,

704 cÚ¡ 
tu¶e_t
 &
right
)

707 
q42_još_s_d_tu¶e
* 
	gjo
 = 
®igÃd_ÿ¡
<q42_još_s_d_tu¶e>(
Ëá
.
d©a
);

708 
q42_p_tu¶e
* 
	gp
 = 
®igÃd_ÿ¡
<q42_p_tu¶e>(
right
.
d©a
);

709 
q42_još_s_d_p_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q42_još_s_d_p_tu¶e>(
de¡
.
d©a
);

711 
	g»t
->
	gD_YEAR
 = 
jo
->
D_YEAR
 ;

712 
	g»t
->
	gLO_CUSTKEY
 = 
jo
->
LO_CUSTKEY
;

713 
	g»t
->
	gLO_REVENUE
 = 
jo
->
LO_REVENUE
 ;

714 
	g»t
->
	gLO_SUPPLYCOST
 = 
jo
->
LO_SUPPLYCOST
 ;

716 
¡rıy
(
»t
->
S_NATION
,
jo
->S_NATION);

717 
¡rıy
(
»t
->
P_CATEGORY
, 
p
->P_CATEGORY);

719 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN {%s} {%s} %d %d %d %d\n",
»t
->
S_NATION
,„‘->
P_CATEGORY
,„‘->
D_YEAR
,„‘->
LO_CUSTKEY
,„‘->
LO_REVENUE
,„‘->
LO_SUPPLYCOST
);

723 
vœtu®
 
q42_lo_s_d_p_još_t
* 
şÚe
() const {

724  
Ãw
 
q42_lo_s_d_p_još_t
(*
this
);

727 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

734 
	gq42_još_t
 : 
public
 
tu¶e_još_t
 {

737 
q42_još_t
 ()

738 : 
tu¶e_još_t
((
q42_još_s_d_p_tu¶e
),

739 
off£tof
(
q42_još_s_d_p_tu¶e
, 
LO_CUSTKEY
),

740 (
q42_c_tu¶e
),

741 
off£tof
(
q42_c_tu¶e
, 
C_CUSTKEY
),

743 (
q42_još_tu¶e
))

748 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

749 cÚ¡ 
tu¶e_t
 &
Ëá
,

750 cÚ¡ 
tu¶e_t
 &
right
)

753 
q42_još_s_d_p_tu¶e
* 
	gjo
 = 
®igÃd_ÿ¡
<q42_još_s_d_p_tu¶e>(
Ëá
.
d©a
);

754 
q42_c_tu¶e
* 
	gc
 = 
®igÃd_ÿ¡
<q42_c_tu¶e>(
right
.
d©a
);

755 
q42_još_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q42_još_tu¶e>(
de¡
.
d©a
);

757 
	g»t
->
	gD_YEAR
 = 
jo
->
D_YEAR
;

758 
	g»t
->
	gLO_REVENUE
 = 
jo
->
LO_REVENUE
;

759 
	g»t
->
	gLO_SUPPLYCOST
 = 
jo
->
LO_SUPPLYCOST
;

761 
¡rıy
(
»t
->
S_NATION
,
jo
->S_NATION);

762 
¡rıy
(
»t
->
P_CATEGORY
,
jo
->P_CATEGORY);

764 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN {%s} {%s} %d %d %d\n",
»t
->
S_NATION
,„‘->
P_CATEGORY
,„‘->
D_YEAR
,„‘->
LO_REVENUE
,„‘->
LO_SUPPLYCOST
);

768 
vœtu®
 
q42_još_t
* 
şÚe
() const {

769  
Ãw
 
q42_još_t
(*
this
);

772 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

781 
	sq42_agg_šput_tu¶e_key
 {

783 
	mS_NATION
[
STRSIZE
(15)];

784 
	mP_CATEGORY
[
STRSIZE
(7)];

785 
	mD_YEAR
;

787 
exŒaù_hšt
() {

789  (
	mthis
->
	mD_YEAR
 - 1990 << 24è+ (this->
	mS_NATION
[0] << 16è+ (this->
	mP_CATEGORY
[5] << 8) + (this->P_CATEGORY[6]);

793 
	gq42_agg_šput_tu¶e_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

795 
q42_agg_šput_tu¶e_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
((
q42_agg_šput_tu¶e_key
), 
off£tof
(
q42_još_tu¶e
, 
S_NATION
)) {

798 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

799 
q42_agg_šput_tu¶e_key
* 
	g®igÃd_key
 = 
®igÃd_ÿ¡
<q42_agg_šput_tu¶e_key>(
key
);

819  
	g®igÃd_key
->
exŒaù_hšt
();

824 
vœtu®
 
q42_agg_šput_tu¶e_key_exŒaùÜ_t
 * 
şÚe
() const {

825  
Ãw
 
q42_agg_šput_tu¶e_key_exŒaùÜ_t
(*
this
);

829 
	gq42_agg_šput_tu¶e_key_com·»_t
 : 
public
 
key_com·»_t
 {

831 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

832 
q42_agg_šput_tu¶e_key
* 
	ga
 = 
®igÃd_ÿ¡
<q42_agg_šput_tu¶e_key>(
key1
);

833 
q42_agg_šput_tu¶e_key
* 
	gb
 = 
®igÃd_ÿ¡
<q42_agg_šput_tu¶e_key>(
key2
);

836 
	g¢©iÚcom·risÚ
 = 
¡rcmp
(
a
->
S_NATION
, 
b
->S_NATION);

837 ià(
	g¢©iÚcom·risÚ
 !ğ0è 
¢©iÚcom·risÚ
;

838 
	gpÿ‹gÜycom·risÚ
 = 
¡rcmp
(
a
->
P_CATEGORY
, 
b
->P_CATEGORY);

839 ià(
	gpÿ‹gÜycom·risÚ
 !ğ0è 
pÿ‹gÜycom·risÚ
;

840  
	ga
->
	gD_YEAR
 - 
	gb
->D_YEAR;

843 
vœtu®
 
q42_agg_šput_tu¶e_key_com·»_t
 * 
şÚe
() const {

844  
Ãw
 
q42_agg_šput_tu¶e_key_com·»_t
(*
this
);

849 
q42_agg_šput_tu¶e_key
 
	tq42_agg_tu¶e_key
;

851 şas 
	cq42_agg_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

852 
´iv©e
:

854 
q42_agg_ouut_tu¶e_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

856 
q42_agg_ouut_tu¶e_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
( (
q42_agg_tu¶e_key
), 
off£tof
(
q42_agg»g©e_tu¶e
, 
S_NATION
)) {

859 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

860 
q42_agg_tu¶e_key
* 
	m®igÃd_key
 = 
®igÃd_ÿ¡
<q42_agg_tu¶e_key > (
key
);

861  
	m®igÃd_key
->
exŒaù_hšt
();

864 
vœtu®
 
q42_agg_ouut_tu¶e_key_exŒaùÜ_t
 * 
şÚe
() const {

865  
Ãw
 
q42_agg_ouut_tu¶e_key_exŒaùÜ_t
(*
this
);

869 
q42_agg_ouut_tu¶e_key_exŒaùÜ_t
 
	g_exŒaùÜ
;

871 
	gpublic
:

873 
	$q42_agg_agg»g©e_t
()

874 : 
	`tu¶e_agg»g©e_t
((
q42_agg»g©e_tu¶e
)) {

875 
	}
}

877 
key_exŒaùÜ_t
* 
	$key_exŒaùÜ
() {

878  &
_exŒaùÜ
;

879 
	}
}

881 
	$agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
s
) {

882 
q42_još_tu¶e
 *
¤c
;

883 
¤c
 = 
®igÃd_ÿ¡
<
q42_još_tu¶e
> (
s
.
d©a
);

884 
q42_agg»g©e_tu¶e
* 
tu¶e
 = 
®igÃd_ÿ¡
<q42_agg»g©e_tu¶e>(
agg_d©a
);

886 
tu¶e
->
PROFIT
 +ğ(
¤c
->
LO_REVENUE
 - src->
LO_SUPPLYCOST
);

887 
	`TRACE
(
TRACE_RECORD_FLOW
, "%.2f\n", 
tu¶e
->
PROFIT
);

888 
	}
}

890 
	$fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

891 
q42_agg»g©e_tu¶e
 *
de¡
;

892 
de¡
 = 
®igÃd_ÿ¡
<
q42_agg»g©e_tu¶e
 > (
d
.
d©a
);

893 
q42_agg»g©e_tu¶e
* 
tu¶e
 = 
®igÃd_ÿ¡
<q42_agg»g©e_tu¶> (
agg_d©a
);

895 *
de¡
 = *
tu¶e
;

896 
	}
}

898 
q42_agg_agg»g©e_t
* 
	$şÚe
() const {

899  
Ãw
 
	`q42_agg_agg»g©e_t
(*
this
);

900 
	}
}

902 
c_¡r
 
	$to_¡ršg
() const {

904 
	}
}

911 
	sq42_sÜt_tu¶e_key
 {

912 
	mS_NATION
[
STRSIZE
(15)];

913 
	mP_CATEGORY
[
STRSIZE
(7)];

914 
	mD_YEAR
;

917 
	gq42_Üd”_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

919 
q42_Üd”_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
( (
q42_sÜt_tu¶e_key
), 
off£tof
(
q42_agg»g©e_tu¶e
, 
S_NATION
)) {

922 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

923 
q42_sÜt_tu¶e_key
* 
	g®igÃd_key
 = 
®igÃd_ÿ¡
<q42_sÜt_tu¶e_key> (
key
);

929 
	g»suÉ
 = ((
®igÃd_key
->
D_YEAR
 - 1992è<< 28è+ (®igÃd_key->
S_NATION
[0] << 16)+×ligÃd_key->
P_CATEGORY
[5] << 8)+(aligned_key->P_CATEGORY[6]);

930  
	g»suÉ
;

935 
vœtu®
 
q42_Üd”_key_exŒaùÜ_t
 * 
şÚe
() const {

936  
Ãw
 
q42_Üd”_key_exŒaùÜ_t
(*
this
);

940 
	gq42_Üd”_key_com·»_t
 : 
public
 
key_com·»_t
 {

942 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

943 
q42_sÜt_tu¶e_key
* 
	ga
 = 
®igÃd_ÿ¡
<q42_sÜt_tu¶e_key>(
key1
);

944 
q42_sÜt_tu¶e_key
* 
	gb
 = 
®igÃd_ÿ¡
<q42_sÜt_tu¶e_key>(
key2
);

946 
	gy—rcom·risÚ
 = 
a
->
D_YEAR
 - 
b
->D_YEAR;

947 ià(
	gy—rcom·risÚ
 !ğ0è 
y—rcom·risÚ
;

948 
	gú©iÚcom·risÚ
 = 
¡rcmp
(
a
->
S_NATION
, 
b
->S_NATION);

949  
	gú©iÚcom·risÚ
;

950 
	gpÿ‹gÜycom·risÚ
 = 
¡rcmp
(
a
->
P_CATEGORY
, 
b
->P_CATEGORY);

951  
	gpÿ‹gÜycom·risÚ
;

954 
vœtu®
 
q42_Üd”_key_com·»_t
 * 
şÚe
() const {

955  
Ãw
 
q42_Üd”_key_com·»_t
(*
this
);

963 şas 
	cssb_q42_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


965 
public
:

967 
	$begš
() {

968 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** q4_2 ANSWER ...\n");

969 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** ...\n");

972 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

973 
´ojeùed_tu¶e
 *
tu¶e
;

974 
tu¶e
 = 
®igÃd_ÿ¡
<
´ojeùed_tu¶e
>(
ouut
.
d©a
);

976 
	`TRACE
 ( 
TRACE_QUERY_RESULTS
, "PROCESS %d {%s} {%s} %d\n",
tu¶e
->
D_YEAR
,u¶e->
S_NATION
,u¶e->
P_CATEGORY
,u¶e->
PROFIT
);

980 
	}
}

991 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_qpe_q4_2
(cÚ¡ 
xù_id
,

992 
q4_2_šput_t
& 
š
)

994 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** q4_2 *********\n");

997 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

998 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

1003 
tu¶e_fifo
* 
lo_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q42_lo_tu¶e
));

1004 
tsÿn_·ck‘_t
* 
lo_tsÿn_·ck‘
 =

1005 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN LINEORDER",

1006 
lo_out_bufãr
,

1007 
Ãw
 
	`q42_lšeÜd”_tsÿn_f‹r_t
(
this
),

1008 
this
->
	`db
(),

1009 
_¶šeÜd”_desc
.
	`g‘
(),

1010 
pxù


1014 
tu¶e_fifo
* 
s_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q42_s_tu¶e
));

1015 
tsÿn_·ck‘_t
* 
s_tsÿn_·ck‘
 =

1016 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN SUPPLIER",

1017 
s_out_bufãr
,

1018 
Ãw
 
	`q42_suµl›r_tsÿn_f‹r_t
(
this
,
š
),

1019 
this
->
	`db
(),

1020 
_psuµl›r_desc
.
	`g‘
(),

1021 
pxù


1025 
tu¶e_fifo
* 
d_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q42_d_tu¶e
));

1026 
tsÿn_·ck‘_t
* 
d_tsÿn_·ck‘
 =

1027 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN DATE",

1028 
d_out_bufãr
,

1029 
Ãw
 
	`q42_d©e_tsÿn_f‹r_t
(
this
,
š
),

1030 
this
->
	`db
(),

1031 
_pd©e_desc
.
	`g‘
(),

1032 
pxù


1036 
tu¶e_fifo
* 
p_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q42_p_tu¶e
));

1037 
tsÿn_·ck‘_t
* 
p_tsÿn_·ck‘
 =

1038 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN…art",

1039 
p_out_bufãr
,

1040 
Ãw
 
	`q42_·¹_tsÿn_f‹r_t
(
this
,
š
),

1041 
this
->
	`db
(),

1042 
_µ¬t_desc
.
	`g‘
(),

1043 
pxù


1047 
tu¶e_fifo
* 
c_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q42_c_tu¶e
));

1048 
tsÿn_·ck‘_t
* 
c_tsÿn_·ck‘
 =

1049 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN CUSTOMER",

1050 
c_out_bufãr
,

1051 
Ãw
 
	`q42_cu¡om”_tsÿn_f‹r_t
(
this
,
š
),

1052 
this
->
	`db
(),

1053 
_pcu¡om”_desc
.
	`g‘
(),

1054 
pxù


1059 
tu¶e_fifo
* 
još_lo_s_out
 = 
Ãw
 
	`tu¶e_fifo
((
q42_još_s_tu¶e
));

1060 
·ck‘_t
* 
još_lo_s_·ck‘
 =

1061 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier JOIN",

1062 
još_lo_s_out
,

1063 
Ãw
 
	`ŒivŸl_f‹r_t
((
q42_još_s_tu¶e
)),

1064 
lo_tsÿn_·ck‘
,

1065 
s_tsÿn_·ck‘
,

1066 
Ãw
 
	`q42_lo_s_još_t
() );

1069 
tu¶e_fifo
* 
još_lo_s_d_out
 = 
Ãw
 
	`tu¶e_fifo
((
q42_još_s_d_tu¶e
));

1070 
·ck‘_t
* 
još_lo_s_d_·ck‘
 =

1071 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier - Date JOIN",

1072 
još_lo_s_d_out
,

1073 
Ãw
 
	`ŒivŸl_f‹r_t
((
q42_još_s_d_tu¶e
)),

1074 
još_lo_s_·ck‘
,

1075 
d_tsÿn_·ck‘
,

1076 
Ãw
 
	`q42_lo_s_d_još_t
() );

1079 
tu¶e_fifo
* 
još_lo_s_d_p_out
 = 
Ãw
 
	`tu¶e_fifo
((
q42_još_s_d_p_tu¶e
));

1080 
·ck‘_t
* 
još_lo_s_d_p_·ck‘
 =

1081 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier - Date - Part JOIN",

1082 
još_lo_s_d_p_out
,

1083 
Ãw
 
	`ŒivŸl_f‹r_t
((
q42_još_s_d_p_tu¶e
)),

1084 
još_lo_s_d_·ck‘
,

1085 
p_tsÿn_·ck‘
,

1086 
Ãw
 
	`q42_lo_s_d_p_još_t
() );

1089 
tu¶e_fifo
* 
još_out
 = 
Ãw
 
	`tu¶e_fifo
((
q42_još_tu¶e
));

1090 
·ck‘_t
* 
još_·ck‘
 =

1091 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier - Date - Part - Customer JOIN",

1092 
još_out
,

1093 
Ãw
 
	`ŒivŸl_f‹r_t
((
q42_još_tu¶e
)),

1094 
još_lo_s_d_p_·ck‘
,

1095 
c_tsÿn_·ck‘
,

1096 
Ãw
 
	`q42_još_t
() );

1099 
tu¶e_fifo
* 
agg_ouut_bufãr
 =

1100 
Ãw
 
	`tu¶e_fifo
( (
q42_agg»g©e_tu¶e
));

1101 
·ck‘_t
* 
q42_agg_·ck‘
 =

1102 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("AGG Q4_2",

1103 
agg_ouut_bufãr
,

1104 
Ãw
 
	`ŒivŸl_f‹r_t
(
agg_ouut_bufãr
->
	`tu¶e_size
()),

1105 
još_·ck‘
,

1106 
Ãw
 
	`q42_agg_agg»g©e_t
(),

1107 
Ãw
 
	`q42_agg_šput_tu¶e_key_exŒaùÜ_t
(),

1108 
Ãw
 
	`q42_agg_šput_tu¶e_key_com·»_t
());

1111 
tu¶e_fifo
* 
sÜt_fš®_out
 = 
Ãw
 
	`tu¶e_fifo
((
q42_agg»g©e_tu¶e
));

1112 
·ck‘_t
* 
q42_sÜt_fš®_·ck‘
 =

1113 
Ãw
 
	`sÜt_·ck‘_t
("ORDER BY D_YEAR ASC, REVENUE DESC",

1114 
sÜt_fš®_out
,

1115 
Ãw
 
	`ŒivŸl_f‹r_t
((
q42_agg»g©e_tu¶e
)),

1116 
Ãw
 
	`q42_Üd”_key_exŒaùÜ_t
(),

1117 
Ãw
 
	`q42_Üd”_key_com·»_t
(),

1118 
q42_agg_·ck‘
);

1121 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

1122 
lo_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1123 
s_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1124 
d_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1125 
p_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1126 
c_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1127 
još_lo_s_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1128 
još_lo_s_d_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1129 
još_lo_s_d_p_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1130 
još_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1131 
q42_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1132 
q42_sÜt_fš®_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1135 
ssb_q42_´oûss_tu¶e_t
 
±
;

1136 
	`´oûss_qu”y
(
q42_sÜt_fš®_·ck‘
, 
±
);

1137 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

1139  (
RCOK
);

1140 
	}
}

1143 
EXIT_NAMESPACE
(
ssb
);

	@src/workload/ssb/qpipe/qpipe_q4_3.cpp

34 
	~"wÜklßd/ssb/shÜe_ssb_’v.h
"

35 
	~"qpe.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
usšg
 
Çme¥aû
 
	gqpe
;

42 
ENTER_NAMESPACE
(
ssb
);

67 
	sq43_lo_tu¶e


69 
	mLO_CUSTKEY
;

70 
	mLO_SUPPKEY
;

71 
	mLO_ORDERDATE
;

72 
	mLO_PARTKEY
;

73 
	mLO_REVENUE
;

74 
	mLO_SUPPLYCOST
;

77 
	sq43_c_tu¶e


79 
	mC_CUSTKEY
;

82 
	sq43_s_tu¶e


84 
	mS_SUPPKEY
;

85 
	mS_CITY
[10];

88 
	sq43_p_tu¶e


90 
	mP_PARTKEY
;

91 
	mP_BRAND
[10];

94 
	sq43_d_tu¶e


96 
	mD_DATEKEY
;

97 
	mD_YEAR
;

100 
	sq43_još_s_tu¶e


102 
	mS_CITY
[11];

103 
	mLO_CUSTKEY
;

104 
	mLO_ORDERDATE
;

105 
	mLO_PARTKEY
;

106 
	mLO_REVENUE
;

107 
	mLO_SUPPLYCOST
;

110 
	sq43_još_s_p_tu¶e


112 
	mP_BRAND
[10];

113 
	mS_CITY
[11];

114 
	mLO_CUSTKEY
;

115 
	mLO_ORDERDATE
;

116 
	mLO_REVENUE
;

117 
	mLO_SUPPLYCOST
;

121 
	sq43_još_s_p_d_tu¶e


123 
	mD_YEAR
;

124 
	mP_BRAND
[10];

125 
	mS_CITY
[11];

126 
	mLO_CUSTKEY
;

127 
	mLO_REVENUE
;

128 
	mLO_SUPPLYCOST
;

131 
	sq43_još_tu¶e


133 
	mS_CITY
[11];

134 
	mP_BRAND
[10];

135 
	mD_YEAR
;

136 
	mLO_REVENUE
;

137 
	mLO_SUPPLYCOST
;

140 
	sq43_agg»g©e_tu¶e


143 
	mS_CITY
[11];

144 
	mP_BRAND
[10];

145 
	mD_YEAR
;

146 
	mPROFIT
;

153 
q43_agg»g©e_tu¶e
 
	t´ojeùed_tu¶e
;

156 şas 
	cq43_lšeÜd”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


158 
´iv©e
:

159 
ShÜeSSBEnv
* 
_ssbdb
;

160 
bË_row_t
* 
	m_´lše
;

161 
»p_row_t
 
	m_¼
;

163 
ssb_lšeÜd”_tu¶e
 
	m_lšeÜd”
;

165 
	mpublic
:

167 
	$q43_lšeÜd”_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
)

168 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

172 
_´lše
 = 
_ssbdb
->
	`lšeÜd”_mª
()->
	`g‘_tu¶e
();

173 
_¼
.
	`£t_ts
(
_ssbdb
->
	`lšeÜd”_mª
()->
	`ts
(),

174 
_ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
());

175 
_´lše
->
_»p
 = &
_¼
;

179 ~
	$q43_lšeÜd”_tsÿn_f‹r_t
()

182 
_ssbdb
->
	`lšeÜd”_mª
()->
	`give_tu¶e
(
_´lše
);

183 
	}
}

187 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

190 ià(!
_ssbdb
->
	`lšeÜd”_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

191 
	`as£¹
(
çl£
);

194  (
Œue
);

195 
	}
}

199 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

201 
q43_lo_tu¶e
 *
de¡
;

202 
de¡
 = 
®igÃd_ÿ¡
<
q43_lo_tu¶e
>(
d
.
d©a
);

204 
_´lše
->
	`g‘_v®ue
(2, 
_lšeÜd”
.
LO_CUSTKEY
);

205 
_´lše
->
	`g‘_v®ue
(3, 
_lšeÜd”
.
LO_PARTKEY
);

206 
_´lše
->
	`g‘_v®ue
(4, 
_lšeÜd”
.
LO_SUPPKEY
);

207 
_´lše
->
	`g‘_v®ue
(5, 
_lšeÜd”
.
LO_ORDERDATE
);

208 
_´lše
->
	`g‘_v®ue
(12, 
_lšeÜd”
.
LO_REVENUE
);

209 
_´lše
->
	`g‘_v®ue
(13, 
_lšeÜd”
.
LO_SUPPLYCOST
);

211 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%d|%d|%d|%d|%d --d\n",

212 
_lšeÜd”
.
LO_CUSTKEY
,

213 
_lšeÜd”
.
LO_PARTKEY
,

214 
_lšeÜd”
.
LO_SUPPKEY
,

215 
_lšeÜd”
.
LO_ORDERDATE
,

216 
_lšeÜd”
.
LO_REVENUE
,

217 
_lšeÜd”
.
LO_SUPPLYCOST
);

219 
de¡
->
LO_CUSTKEY
 = 
_lšeÜd”
.LO_CUSTKEY;

220 
de¡
->
LO_PARTKEY
 = 
_lšeÜd”
.LO_PARTKEY;

221 
de¡
->
LO_SUPPKEY
 = 
_lšeÜd”
.LO_SUPPKEY;

222 
de¡
->
LO_ORDERDATE
 = 
_lšeÜd”
.LO_ORDERDATE;

223 
de¡
->
LO_REVENUE
 = 
_lšeÜd”
.LO_REVENUE;

224 
de¡
->
LO_SUPPLYCOST
 = 
_lšeÜd”
.LO_SUPPLYCOST;

226 
	}
}

228 
q43_lšeÜd”_tsÿn_f‹r_t
* 
	$şÚe
() const {

229  
Ãw
 
	`q43_lšeÜd”_tsÿn_f‹r_t
(*
this
);

230 
	}
}

232 
c_¡r
 
	$to_¡ršg
() const {

233  
	`c_¡r
("q43_lineorder_tscan_filter_t()");

234 
	}
}

238 şas 
	cq43_suµl›r_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


240 
´iv©e
:

241 
ShÜeSSBEnv
* 
_ssbdb
;

242 
bË_row_t
* 
	m_´suµ
;

243 
»p_row_t
 
	m_¼
;

245 
ssb_suµl›r_tu¶e
 
	m_suµl›r
;

248 
	mNATION
[16];

249 
	mpublic
:

251 
	$q43_suµl›r_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q4_3_šput_t
 &
š
)

252 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`suµl›r_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

256 
_´suµ
 = 
_ssbdb
->
	`suµl›r_mª
()->
	`g‘_tu¶e
();

257 
_¼
.
	`£t_ts
(
_ssbdb
->
	`suµl›r_mª
()->
	`ts
(),

258 
_ssbdb
->
	`suµl›r_desc
()->
	`maxsize
());

259 
_´suµ
->
_»p
 = &
_¼
;

262 
	`¡rıy
(
NATION
,"UNITED STATES");

265 ~
	$q43_suµl›r_tsÿn_f‹r_t
()

268 
_ssbdb
->
	`suµl›r_mª
()->
	`give_tu¶e
(
_´suµ
);

269 
	}
}

273 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

276 ià(!
_ssbdb
->
	`suµl›r_mª
()->
	`lßd
(
_´suµ
, 
šput
.
d©a
)) {

277 
	`as£¹
(
çl£
);

280 
_´suµ
->
	`g‘_v®ue
(4, 
_suµl›r
.
S_NATION
, 
	`STRSIZE
(15));

283 ià(
	`¡rcmp
(
_suµl›r
.
S_NATION
,
NATION
)==0)

285 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ NATION |%s --d\n",

286 
_suµl›r
.
S_NATION
);

287  (
Œue
);

291 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". NATION |%s --d\n",

292 
_suµl›r
.
S_NATION
);

293  (
çl£
);

295 
	}
}

299 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

301 
q43_s_tu¶e
 *
de¡
;

302 
de¡
 = 
®igÃd_ÿ¡
<
q43_s_tu¶e
>(
d
.
d©a
);

304 
_´suµ
->
	`g‘_v®ue
(0, 
_suµl›r
.
S_SUPPKEY
);

305 
_´suµ
->
	`g‘_v®ue
(3, 
_suµl›r
.
S_CITY
, 
	`STRSIZE
(10));

307 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%s --d\n",

308 
_suµl›r
.
S_SUPPKEY
,

309 
_suµl›r
.
S_CITY
);

312 
de¡
->
S_SUPPKEY
 = 
_suµl›r
.S_SUPPKEY;

313 
	`¡rıy
(
de¡
->
S_CITY
,
_suµl›r
.S_CITY);

314 
	}
}

316 
q43_suµl›r_tsÿn_f‹r_t
* 
	$şÚe
() const {

317  
Ãw
 
	`q43_suµl›r_tsÿn_f‹r_t
(*
this
);

318 
	}
}

320 
c_¡r
 
	$to_¡ršg
() const {

321  
	`c_¡r
("q43_supplier_tscan_filter_t()");

322 
	}
}

326 şas 
	cq43_cu¡om”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


328 
´iv©e
:

329 
ShÜeSSBEnv
* 
_ssbdb
;

330 
bË_row_t
* 
	m_´cu¡
;

331 
»p_row_t
 
	m_¼
;

333 
ssb_cu¡om”_tu¶e
 
	m_cu¡om”
;

337 
	mpublic
:

339 
	$q43_cu¡om”_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q4_3_šput_t
 &
š
)

340 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`cu¡om”_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

344 
_´cu¡
 = 
_ssbdb
->
	`cu¡om”_mª
()->
	`g‘_tu¶e
();

345 
_¼
.
	`£t_ts
(
_ssbdb
->
	`cu¡om”_mª
()->
	`ts
(),

346 
_ssbdb
->
	`cu¡om”_desc
()->
	`maxsize
());

347 
_´cu¡
->
_»p
 = &
_¼
;

351 ~
	$q43_cu¡om”_tsÿn_f‹r_t
()

354 
_ssbdb
->
	`cu¡om”_mª
()->
	`give_tu¶e
(
_´cu¡
);

355 
	}
}

359 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

362 ià(!
_ssbdb
->
	`cu¡om”_mª
()->
	`lßd
(
_´cu¡
, 
šput
.
d©a
)) {

363 
	`as£¹
(
çl£
);

366  (
Œue
);

368 
	}
}

372 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

374 
q43_c_tu¶e
 *
de¡
;

375 
de¡
 = 
®igÃd_ÿ¡
<
q43_c_tu¶e
>(
d
.
d©a
);

377 
_´cu¡
->
	`g‘_v®ue
(0, 
_cu¡om”
.
C_CUSTKEY
);

379 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d --d\n",

380 
_cu¡om”
.
C_CUSTKEY
);

383 
de¡
->
C_CUSTKEY
 = 
_cu¡om”
.C_CUSTKEY;

384 
	}
}

386 
q43_cu¡om”_tsÿn_f‹r_t
* 
	$şÚe
() const {

387  
Ãw
 
	`q43_cu¡om”_tsÿn_f‹r_t
(*
this
);

388 
	}
}

390 
c_¡r
 
	$to_¡ršg
() const {

391  
	`c_¡r
("q43_customer_tscan_filter_t()");

392 
	}
}

396 şas 
	cq43_·¹_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


398 
´iv©e
:

399 
ShÜeSSBEnv
* 
_ssbdb
;

400 
bË_row_t
* 
	m_´·¹
;

401 
»p_row_t
 
	m_¼
;

403 
ssb_·¹_tu¶e
 
	m_·¹
;

406 
	mCATEGORY
[8];

408 
	mpublic
:

410 
	$q43_·¹_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q4_3_šput_t
 &
š
)

411 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`·¹_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

415 
_´·¹
 = 
_ssbdb
->
	`·¹_mª
()->
	`g‘_tu¶e
();

416 
_¼
.
	`£t_ts
(
_ssbdb
->
	`·¹_mª
()->
	`ts
(),

417 
_ssbdb
->
	`·¹_desc
()->
	`maxsize
());

418 
_´·¹
->
_»p
 = &
_¼
;

420 
	`¡rıy
(
CATEGORY
,"MFGR#14");

424 ~
	$q43_·¹_tsÿn_f‹r_t
()

427 
_ssbdb
->
	`·¹_mª
()->
	`give_tu¶e
(
_´·¹
);

428 
	}
}

432 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

435 ià(!
_ssbdb
->
	`·¹_mª
()->
	`lßd
(
_´·¹
, 
šput
.
d©a
)) {

436 
	`as£¹
(
çl£
);

439 
_´·¹
->
	`g‘_v®ue
(3, 
_·¹
.
P_CATEGORY
, 
	`STRSIZE
(7));

442 ià(
	`¡rcmp
(
_·¹
.
P_CATEGORY
, 
CATEGORY
)==0)

444 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ CATEGORY |%s --d\n",

445 
_·¹
.
P_CATEGORY
);

446  (
Œue
);

450 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". CATEGORY |%s --d\n",

451 
_·¹
.
P_CATEGORY
);

452  (
çl£
);

455 
	}
}

459 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

461 
q43_p_tu¶e
 *
de¡
;

462 
de¡
 = 
®igÃd_ÿ¡
<
q43_p_tu¶e
>(
d
.
d©a
);

464 
_´·¹
->
	`g‘_v®ue
(0, 
_·¹
.
P_PARTKEY
);

465 
_´·¹
->
	`g‘_v®ue
(4, 
_·¹
.
P_BRAND
, 
	`STRSIZE
(9));

468 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d |%s --d\n",

469 
_·¹
.
P_PARTKEY
,

470 
_·¹
.
P_BRAND
);

473 
de¡
->
P_PARTKEY
 = 
_·¹
.P_PARTKEY;

474 
	`¡rıy
(
de¡
->
P_BRAND
, 
_·¹
.P_BRAND);

476 
	}
}

478 
q43_·¹_tsÿn_f‹r_t
* 
	$şÚe
() const {

479  
Ãw
 
	`q43_·¹_tsÿn_f‹r_t
(*
this
);

480 
	}
}

482 
c_¡r
 
	$to_¡ršg
() const {

483  
	`c_¡r
("q43_part_tscan_filter_t()");

484 
	}
}

488 şas 
	cq43_d©e_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


490 
´iv©e
:

491 
ShÜeSSBEnv
* 
_ssbdb
;

492 
bË_row_t
* 
	m_´d©e
;

493 
»p_row_t
 
	m_¼
;

495 
ssb_d©e_tu¶e
 
	m_d©e
;

497 
	mYEAR_LOW
;

498 
	mYEAR_HIGH
;

500 
	mpublic
:

502 
	$q43_d©e_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q4_3_šput_t
 &
š
)

503 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`d©e_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

507 
_´d©e
 = 
_ssbdb
->
	`d©e_mª
()->
	`g‘_tu¶e
();

508 
_¼
.
	`£t_ts
(
_ssbdb
->
	`d©e_mª
()->
	`ts
(),

509 
_ssbdb
->
	`d©e_desc
()->
	`maxsize
());

510 
_´d©e
->
_»p
 = &
_¼
;

512 
YEAR_LOW
=1997;

513 
YEAR_HIGH
=1998;

516 ~
	$q43_d©e_tsÿn_f‹r_t
()

519 
_ssbdb
->
	`d©e_mª
()->
	`give_tu¶e
(
_´d©e
);

520 
	}
}

524 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

527 ià(!
_ssbdb
->
	`d©e_mª
()->
	`lßd
(
_´d©e
, 
šput
.
d©a
)) {

528 
	`as£¹
(
çl£
);

531 
_´d©e
->
	`g‘_v®ue
(4, 
_d©e
.
D_YEAR
);

534 ià(
_d©e
.
D_YEAR
==
YEAR_LOW
 || _d©e.D_YEAR==
YEAR_HIGH
)

536 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "+ YEAR |%d --d\n",

537 
_d©e
.
D_YEAR
);

538  (
Œue
);

542 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, ". YEAR |%d --d\n",

543 
_d©e
.
D_YEAR
);

544  (
çl£
);

547 
	}
}

551 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

553 
q43_d_tu¶e
 *
de¡
;

554 
de¡
 = 
®igÃd_ÿ¡
<
q43_d_tu¶e
>(
d
.
d©a
);

556 
_´d©e
->
	`g‘_v®ue
(0, 
_d©e
.
D_DATEKEY
);

557 
_´d©e
->
	`g‘_v®ue
(4, 
_d©e
.
D_YEAR
);

559 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%d --d\n",

560 
_d©e
.
D_DATEKEY
,

561 
_d©e
.
D_YEAR
);

564 
de¡
->
D_DATEKEY
 = 
_d©e
.D_DATEKEY;

565 
de¡
->
D_YEAR
=
_d©e
.D_YEAR;

566 
	}
}

568 
q43_d©e_tsÿn_f‹r_t
* 
	$şÚe
() const {

569  
Ãw
 
	`q43_d©e_tsÿn_f‹r_t
(*
this
);

570 
	}
}

572 
c_¡r
 
	$to_¡ršg
() const {

573  
	`c_¡r
("q4_3_date_tscan_filter_t()");

574 
	}
}

580 
	gq43_lo_s_još_t
 : 
public
 
tu¶e_još_t
 {

583 
q43_lo_s_još_t
 ()

584 : 
tu¶e_još_t
((
q43_lo_tu¶e
),

585 
off£tof
(
q43_lo_tu¶e
, 
LO_SUPPKEY
),

586 (
q43_s_tu¶e
),

587 
off£tof
(
q43_s_tu¶e
, 
S_SUPPKEY
),

589 (
q43_još_s_tu¶e
))

594 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

595 cÚ¡ 
tu¶e_t
 &
Ëá
,

596 cÚ¡ 
tu¶e_t
 &
right
)

599 
q43_lo_tu¶e
* 
	glo
 = 
®igÃd_ÿ¡
<q43_lo_tu¶e>(
Ëá
.
d©a
);

600 
q43_s_tu¶e
* 
	gs
 = 
®igÃd_ÿ¡
<q43_s_tu¶e>(
right
.
d©a
);

601 
q43_još_s_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q43_još_s_tu¶e>(
de¡
.
d©a
);

603 
	g»t
->
	gLO_CUSTKEY
 = 
lo
->
LO_CUSTKEY
;

604 
	g»t
->
	gLO_PARTKEY
 = 
lo
->
LO_PARTKEY
;

605 
	g»t
->
	gLO_ORDERDATE
 = 
lo
->
LO_ORDERDATE
;

606 
	g»t
->
	gLO_REVENUE
 = 
lo
->
LO_REVENUE
;

607 
	g»t
->
	gLO_SUPPLYCOST
 = 
lo
->
LO_SUPPLYCOST
;

609 
¡rıy
(
»t
->
S_CITY
, 
s
->S_CITY);

611 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN {%s} %d %d %d %d %d\n",
»t
->
S_CITY
,„‘->
LO_CUSTKEY
,„‘->
LO_PARTKEY
,„‘->
LO_ORDERDATE
,„‘->
LO_REVENUE
,„‘->
LO_SUPPLYCOST
);

615 
vœtu®
 
q43_lo_s_još_t
* 
şÚe
() const {

616  
Ãw
 
q43_lo_s_još_t
(*
this
);

619 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

626 
	gq43_lo_s_p_još_t
 : 
public
 
tu¶e_još_t
 {

629 
q43_lo_s_p_još_t
 ()

630 : 
tu¶e_još_t
((
q43_još_s_tu¶e
),

631 
off£tof
(
q43_još_s_tu¶e
, 
LO_PARTKEY
),

632 (
q43_p_tu¶e
),

633 
off£tof
(
q43_p_tu¶e
, 
P_PARTKEY
),

635 (
q43_još_s_p_tu¶e
))

640 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

641 cÚ¡ 
tu¶e_t
 &
Ëá
,

642 cÚ¡ 
tu¶e_t
 &
right
)

645 
q43_još_s_tu¶e
* 
	gjo
 = 
®igÃd_ÿ¡
<q43_još_s_tu¶e>(
Ëá
.
d©a
);

646 
q43_p_tu¶e
* 
	gp
 = 
®igÃd_ÿ¡
<q43_p_tu¶e>(
right
.
d©a
);

647 
q43_još_s_p_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q43_još_s_p_tu¶e>(
de¡
.
d©a
);

650 
	g»t
->
	gLO_CUSTKEY
 = 
jo
->
LO_CUSTKEY
 ;

651 
	g»t
->
	gLO_ORDERDATE
 = 
jo
->
LO_ORDERDATE
 ;

652 
	g»t
->
	gLO_REVENUE
 = 
jo
->
LO_REVENUE
 ;

653 
	g»t
->
	gLO_SUPPLYCOST
 = 
jo
->
LO_SUPPLYCOST
;

655 
¡rıy
(
»t
->
P_BRAND
,
p
->P_BRAND);

656 
¡rıy
(
»t
->
S_CITY
, 
jo
->S_CITY);

658 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN {%s} {%s} %d %d %d %d\n",
»t
->
P_BRAND
,„‘->
S_CITY
,„‘->
LO_CUSTKEY
,„‘->
LO_ORDERDATE
,„‘->
LO_REVENUE
,„‘->
LO_SUPPLYCOST
);

662 
vœtu®
 
q43_lo_s_p_još_t
* 
şÚe
() const {

663  
Ãw
 
q43_lo_s_p_još_t
(*
this
);

666 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

673 
	gq43_lo_s_p_d_još_t
 : 
public
 
tu¶e_još_t
 {

676 
q43_lo_s_p_d_još_t
 ()

677 : 
tu¶e_još_t
((
q43_još_s_p_tu¶e
),

678 
off£tof
(
q43_još_s_p_tu¶e
, 
LO_ORDERDATE
),

679 (
q43_d_tu¶e
),

680 
off£tof
(
q43_d_tu¶e
, 
D_DATEKEY
),

682 (
q43_još_s_p_d_tu¶e
))

687 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

688 cÚ¡ 
tu¶e_t
 &
Ëá
,

689 cÚ¡ 
tu¶e_t
 &
right
)

692 
q43_još_s_p_tu¶e
* 
	gjo
 = 
®igÃd_ÿ¡
<q43_još_s_p_tu¶e>(
Ëá
.
d©a
);

693 
q43_d_tu¶e
* 
	gd
 = 
®igÃd_ÿ¡
<q43_d_tu¶e>(
right
.
d©a
);

694 
q43_još_s_p_d_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q43_još_s_p_d_tu¶e>(
de¡
.
d©a
);

696 
	g»t
->
	gLO_CUSTKEY
 = 
jo
->
LO_CUSTKEY
 ;

697 
	g»t
->
	gD_YEAR
 = 
d
->
D_YEAR
 ;

698 
	g»t
->
	gLO_REVENUE
 = 
jo
->
LO_REVENUE
 ;

699 
	g»t
->
	gLO_SUPPLYCOST
 = 
jo
->
LO_SUPPLYCOST
;

701 
¡rıy
(
»t
->
P_BRAND
,
jo
->P_BRAND);

702 
¡rıy
(
»t
->
S_CITY
, 
jo
->S_CITY);

704 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN {%s} {%s} %d %d %d %d\n",
»t
->
P_BRAND
,„‘->
S_CITY
,„‘->
LO_CUSTKEY
,„‘->
D_YEAR
,„‘->
LO_REVENUE
,„‘->
LO_SUPPLYCOST
);

708 
vœtu®
 
q43_lo_s_p_d_još_t
* 
şÚe
() const {

709  
Ãw
 
q43_lo_s_p_d_još_t
(*
this
);

712 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

719 
	gq43_još_t
 : 
public
 
tu¶e_još_t
 {

722 
q43_još_t
 ()

723 : 
tu¶e_još_t
((
q43_još_s_p_d_tu¶e
),

724 
off£tof
(
q43_još_s_p_d_tu¶e
, 
LO_CUSTKEY
),

725 (
q43_c_tu¶e
),

726 
off£tof
(
q43_c_tu¶e
, 
C_CUSTKEY
),

728 (
q43_još_tu¶e
))

733 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

734 cÚ¡ 
tu¶e_t
 &
Ëá
,

735 cÚ¡ 
tu¶e_t
 &
right
)

738 
q43_još_s_p_d_tu¶e
* 
	gjo
 = 
®igÃd_ÿ¡
<q43_još_s_p_d_tu¶e>(
Ëá
.
d©a
);

739 
q43_c_tu¶e
* 
	gc
 = 
®igÃd_ÿ¡
<q43_c_tu¶e>(
right
.
d©a
);

740 
q43_još_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q43_još_tu¶e>(
de¡
.
d©a
);

742 
	g»t
->
	gD_YEAR
 = 
jo
->
D_YEAR
;

743 
	g»t
->
	gLO_REVENUE
 = 
jo
->
LO_REVENUE
;

744 
	g»t
->
	gLO_SUPPLYCOST
 = 
jo
->
LO_SUPPLYCOST
;

746 
¡rıy
(
»t
->
P_BRAND
,
jo
->P_BRAND);

747 
¡rıy
(
»t
->
S_CITY
, 
jo
->S_CITY);

749 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN {%s} {%s} %d %d %d\n",
»t
->
P_BRAND
,„‘->
S_CITY
,„‘->
D_YEAR
,„‘->
LO_REVENUE
,„‘->
LO_SUPPLYCOST
);

753 
vœtu®
 
q43_još_t
* 
şÚe
() const {

754  
Ãw
 
q43_još_t
(*
this
);

757 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

766 
	sq43_agg_šput_tu¶e_key
 {

768 
	mS_CITY
[
STRSIZE
(10)];

769 
	mP_BRAND
[
STRSIZE
(9)];

770 
	mD_YEAR
;

773 
exŒaù_hšt
() {

774  (
	mthis
->
	mD_YEAR
 - 1990 << 24è+ (this->
	mS_CITY
[9] << 16è+ (this->
	mP_BRAND
[7] << 8) + (this->P_BRAND[8]);

779 
	gq43_agg_šput_tu¶e_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

781 
q43_agg_šput_tu¶e_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
((
q43_agg_šput_tu¶e_key
), 
off£tof
(
q43_još_tu¶e
, 
S_CITY
)) {

784 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

785 
q43_agg_šput_tu¶e_key
* 
	g®igÃd_key
 = 
®igÃd_ÿ¡
<q43_agg_šput_tu¶e_key>(
key
);

805  
	g®igÃd_key
->
exŒaù_hšt
();

810 
vœtu®
 
q43_agg_šput_tu¶e_key_exŒaùÜ_t
 * 
şÚe
() const {

811  
Ãw
 
q43_agg_šput_tu¶e_key_exŒaùÜ_t
(*
this
);

815 
	gq43_agg_šput_tu¶e_key_com·»_t
 : 
public
 
key_com·»_t
 {

817 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

818 
q43_agg_šput_tu¶e_key
* 
	ga
 = 
®igÃd_ÿ¡
<q43_agg_šput_tu¶e_key>(
key1
);

819 
q43_agg_šput_tu¶e_key
* 
	gb
 = 
®igÃd_ÿ¡
<q43_agg_šput_tu¶e_key>(
key2
);

822 
	gsc™ycom·risÚ
 = 
¡rcmp
(
a
->
S_CITY
, 
b
->S_CITY);

823 ià(
	gsc™ycom·risÚ
 !ğ0è 
sc™ycom·risÚ
;

824 
	gpb¿ndcom·risÚ
 = 
¡rcmp
(
a
->
P_BRAND
, 
b
->P_BRAND);

825 ià(
	gpb¿ndcom·risÚ
 !ğ0è 
pb¿ndcom·risÚ
;

826  
	ga
->
	gD_YEAR
 - 
	gb
->D_YEAR;

829 
vœtu®
 
q43_agg_šput_tu¶e_key_com·»_t
 * 
şÚe
() const {

830  
Ãw
 
q43_agg_šput_tu¶e_key_com·»_t
(*
this
);

835 
q43_agg_šput_tu¶e_key
 
	tq43_agg_tu¶e_key
;

837 şas 
	cq43_agg_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

838 
´iv©e
:

840 
q43_agg_ouut_tu¶e_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

842 
q43_agg_ouut_tu¶e_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
( (
q43_agg_tu¶e_key
), 
off£tof
(
q43_agg»g©e_tu¶e
, 
S_CITY
)) {

845 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

846 
q43_agg_tu¶e_key
* 
	m®igÃd_key
 = 
®igÃd_ÿ¡
<q43_agg_tu¶e_key > (
key
);

847  
	m®igÃd_key
->
exŒaù_hšt
();

850 
vœtu®
 
q43_agg_ouut_tu¶e_key_exŒaùÜ_t
 * 
şÚe
() const {

851  
Ãw
 
q43_agg_ouut_tu¶e_key_exŒaùÜ_t
(*
this
);

855 
q43_agg_ouut_tu¶e_key_exŒaùÜ_t
 
	g_exŒaùÜ
;

857 
	gpublic
:

859 
	$q43_agg_agg»g©e_t
()

860 : 
	`tu¶e_agg»g©e_t
((
q43_agg»g©e_tu¶e
)) {

861 
	}
}

863 
key_exŒaùÜ_t
* 
	$key_exŒaùÜ
() {

864  &
_exŒaùÜ
;

865 
	}
}

867 
	$agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
s
) {

868 
q43_još_tu¶e
 *
¤c
;

869 
¤c
 = 
®igÃd_ÿ¡
<
q43_još_tu¶e
> (
s
.
d©a
);

870 
q43_agg»g©e_tu¶e
* 
tu¶e
 = 
®igÃd_ÿ¡
<q43_agg»g©e_tu¶e>(
agg_d©a
);

872 
tu¶e
->
PROFIT
 +ğ(
¤c
->
LO_REVENUE
 - src->
LO_SUPPLYCOST
);

873 
	`TRACE
(
TRACE_RECORD_FLOW
, "%.2f\n", 
tu¶e
->
PROFIT
);

874 
	}
}

876 
	$fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

877 
q43_agg»g©e_tu¶e
 *
de¡
;

878 
de¡
 = 
®igÃd_ÿ¡
<
q43_agg»g©e_tu¶e
 > (
d
.
d©a
);

879 
q43_agg»g©e_tu¶e
* 
tu¶e
 = 
®igÃd_ÿ¡
<q43_agg»g©e_tu¶> (
agg_d©a
);

881 *
de¡
 = *
tu¶e
;

882 
	}
}

884 
q43_agg_agg»g©e_t
* 
	$şÚe
() const {

885  
Ãw
 
	`q43_agg_agg»g©e_t
(*
this
);

886 
	}
}

888 
c_¡r
 
	$to_¡ršg
() const {

890 
	}
}

897 
	sq43_sÜt_tu¶e_key
 {

898 
	mS_CITY
[
STRSIZE
(10)];

899 
	mP_BRAND
[
STRSIZE
(9)];

900 
	mD_YEAR
;

903 
	gq43_Üd”_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

905 
q43_Üd”_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
( (
q43_sÜt_tu¶e_key
), 
off£tof
(
q43_agg»g©e_tu¶e
, 
S_CITY
)) {

908 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

909 
q43_sÜt_tu¶e_key
* 
	g®igÃd_key
 = 
®igÃd_ÿ¡
<q43_sÜt_tu¶e_key> (
key
);

916 
	g»suÉ
 = ((
®igÃd_key
->
D_YEAR
 - 1992è<< 28è+ (®igÃd_key->
S_CITY
[9] << 16)+×ligÃd_key->
P_BRAND
[7] << 8)+(aligned_key->P_BRAND[8] );

918  
	g»suÉ
;

923 
vœtu®
 
q43_Üd”_key_exŒaùÜ_t
 * 
şÚe
() const {

924  
Ãw
 
q43_Üd”_key_exŒaùÜ_t
(*
this
);

928 
	gq43_Üd”_key_com·»_t
 : 
public
 
key_com·»_t
 {

930 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

931 
q43_sÜt_tu¶e_key
* 
	ga
 = 
®igÃd_ÿ¡
<q43_sÜt_tu¶e_key>(
key1
);

932 
q43_sÜt_tu¶e_key
* 
	gb
 = 
®igÃd_ÿ¡
<q43_sÜt_tu¶e_key>(
key2
);

934 
	gy—rcom·risÚ
 = 
a
->
D_YEAR
 - 
b
->D_YEAR;

935 ià(
	gy—rcom·risÚ
 !ğ0è 
y—rcom·risÚ
;

936 
	gcc™ycom·risÚ
 = 
¡rcmp
(
a
->
S_CITY
, 
b
->S_CITY);

937  
	gcc™ycom·risÚ
;

938 
	gpb¿ndcom·risÚ
 = 
¡rcmp
(
a
->
P_BRAND
, 
b
->P_BRAND);

939  
	gpb¿ndcom·risÚ
;

942 
vœtu®
 
q43_Üd”_key_com·»_t
 * 
şÚe
() const {

943  
Ãw
 
q43_Üd”_key_com·»_t
(*
this
);

951 şas 
	cssb_q43_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


953 
public
:

955 
	$begš
() {

956 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** q4_3 ANSWER ...\n");

957 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** ...\n");

960 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

961 
´ojeùed_tu¶e
 *
tu¶e
;

962 
tu¶e
 = 
®igÃd_ÿ¡
<
´ojeùed_tu¶e
>(
ouut
.
d©a
);

964 
	`TRACE
 ( 
TRACE_QUERY_RESULTS
, "PROCESS %d {%s} {%s} %d\n",
tu¶e
->
D_YEAR
,u¶e->
S_CITY
,u¶e->
P_BRAND
,u¶e->
PROFIT
);

968 
	}
}

979 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_qpe_q4_3
(cÚ¡ 
xù_id
,

980 
q4_3_šput_t
& 
š
)

982 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** q4_3 *********\n");

985 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

986 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

991 
tu¶e_fifo
* 
lo_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q43_lo_tu¶e
));

992 
tsÿn_·ck‘_t
* 
lo_tsÿn_·ck‘
 =

993 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN LINEORDER",

994 
lo_out_bufãr
,

995 
Ãw
 
	`q43_lšeÜd”_tsÿn_f‹r_t
(
this
),

996 
this
->
	`db
(),

997 
_¶šeÜd”_desc
.
	`g‘
(),

998 
pxù


1002 
tu¶e_fifo
* 
s_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q43_s_tu¶e
));

1003 
tsÿn_·ck‘_t
* 
s_tsÿn_·ck‘
 =

1004 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN SUPPLIER",

1005 
s_out_bufãr
,

1006 
Ãw
 
	`q43_suµl›r_tsÿn_f‹r_t
(
this
,
š
),

1007 
this
->
	`db
(),

1008 
_psuµl›r_desc
.
	`g‘
(),

1009 
pxù


1013 
tu¶e_fifo
* 
p_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q43_p_tu¶e
));

1014 
tsÿn_·ck‘_t
* 
p_tsÿn_·ck‘
 =

1015 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN…art",

1016 
p_out_bufãr
,

1017 
Ãw
 
	`q43_·¹_tsÿn_f‹r_t
(
this
,
š
),

1018 
this
->
	`db
(),

1019 
_µ¬t_desc
.
	`g‘
(),

1020 
pxù


1024 
tu¶e_fifo
* 
d_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q43_d_tu¶e
));

1025 
tsÿn_·ck‘_t
* 
d_tsÿn_·ck‘
 =

1026 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN DATE",

1027 
d_out_bufãr
,

1028 
Ãw
 
	`q43_d©e_tsÿn_f‹r_t
(
this
,
š
),

1029 
this
->
	`db
(),

1030 
_pd©e_desc
.
	`g‘
(),

1031 
pxù


1035 
tu¶e_fifo
* 
c_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q43_c_tu¶e
));

1036 
tsÿn_·ck‘_t
* 
c_tsÿn_·ck‘
 =

1037 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN CUSTOMER",

1038 
c_out_bufãr
,

1039 
Ãw
 
	`q43_cu¡om”_tsÿn_f‹r_t
(
this
,
š
),

1040 
this
->
	`db
(),

1041 
_pcu¡om”_desc
.
	`g‘
(),

1042 
pxù


1047 
tu¶e_fifo
* 
još_lo_s_out
 = 
Ãw
 
	`tu¶e_fifo
((
q43_još_s_tu¶e
));

1048 
·ck‘_t
* 
još_lo_s_·ck‘
 =

1049 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier JOIN",

1050 
još_lo_s_out
,

1051 
Ãw
 
	`ŒivŸl_f‹r_t
((
q43_još_s_tu¶e
)),

1052 
lo_tsÿn_·ck‘
,

1053 
s_tsÿn_·ck‘
,

1054 
Ãw
 
	`q43_lo_s_još_t
() );

1057 
tu¶e_fifo
* 
još_lo_s_p_out
 = 
Ãw
 
	`tu¶e_fifo
((
q43_još_s_p_tu¶e
));

1058 
·ck‘_t
* 
još_lo_s_p_·ck‘
 =

1059 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier - Part JOIN",

1060 
još_lo_s_p_out
,

1061 
Ãw
 
	`ŒivŸl_f‹r_t
((
q43_još_s_p_tu¶e
)),

1062 
još_lo_s_·ck‘
,

1063 
p_tsÿn_·ck‘
,

1064 
Ãw
 
	`q43_lo_s_p_još_t
() );

1067 
tu¶e_fifo
* 
još_lo_s_p_d_out
 = 
Ãw
 
	`tu¶e_fifo
((
q43_još_s_p_d_tu¶e
));

1068 
·ck‘_t
* 
još_lo_s_p_d_·ck‘
 =

1069 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier - Part - Date JOIN",

1070 
još_lo_s_p_d_out
,

1071 
Ãw
 
	`ŒivŸl_f‹r_t
((
q43_još_s_p_d_tu¶e
)),

1072 
još_lo_s_p_·ck‘
,

1073 
d_tsÿn_·ck‘
,

1074 
Ãw
 
	`q43_lo_s_p_d_još_t
() );

1077 
tu¶e_fifo
* 
još_out
 = 
Ãw
 
	`tu¶e_fifo
((
q43_još_tu¶e
));

1078 
·ck‘_t
* 
još_·ck‘
 =

1079 
Ãw
 
	`hash_još_·ck‘_t
("Lineorder - Supplier - Part - Date - Customer JOIN",

1080 
još_out
,

1081 
Ãw
 
	`ŒivŸl_f‹r_t
((
q43_još_tu¶e
)),

1082 
još_lo_s_p_d_·ck‘
,

1083 
c_tsÿn_·ck‘
,

1084 
Ãw
 
	`q43_još_t
() );

1087 
tu¶e_fifo
* 
agg_ouut_bufãr
 =

1088 
Ãw
 
	`tu¶e_fifo
( (
q43_agg»g©e_tu¶e
));

1089 
·ck‘_t
* 
q43_agg_·ck‘
 =

1090 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("AGG Q4_3",

1091 
agg_ouut_bufãr
,

1092 
Ãw
 
	`ŒivŸl_f‹r_t
(
agg_ouut_bufãr
->
	`tu¶e_size
()),

1093 
još_·ck‘
,

1094 
Ãw
 
	`q43_agg_agg»g©e_t
(),

1095 
Ãw
 
	`q43_agg_šput_tu¶e_key_exŒaùÜ_t
(),

1096 
Ãw
 
	`q43_agg_šput_tu¶e_key_com·»_t
());

1099 
tu¶e_fifo
* 
sÜt_fš®_out
 = 
Ãw
 
	`tu¶e_fifo
((
q43_agg»g©e_tu¶e
));

1100 
·ck‘_t
* 
q43_sÜt_fš®_·ck‘
 =

1101 
Ãw
 
	`sÜt_·ck‘_t
("ORDER BY D_YEAR ASC, REVENUE DESC",

1102 
sÜt_fš®_out
,

1103 
Ãw
 
	`ŒivŸl_f‹r_t
((
q43_agg»g©e_tu¶e
)),

1104 
Ãw
 
	`q43_Üd”_key_exŒaùÜ_t
(),

1105 
Ãw
 
	`q43_Üd”_key_com·»_t
(),

1106 
q43_agg_·ck‘
);

1109 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

1110 
lo_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1111 
s_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1112 
p_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1113 
d_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1114 
c_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1115 
još_lo_s_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1116 
još_lo_s_p_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1117 
još_lo_s_p_d_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1118 
još_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1119 
q43_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1120 
q43_sÜt_fš®_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1123 
ssb_q43_´oûss_tu¶e_t
 
±
;

1124 
	`´oûss_qu”y
(
q43_sÜt_fš®_·ck‘
, 
±
);

1125 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

1127  (
RCOK
);

1128 
	}
}

1131 
EXIT_NAMESPACE
(
ssb
);

	@src/workload/ssb/qpipe/qpipe_qcustomer.cpp

32 
	~"wÜklßd/ssb/shÜe_ssb_’v.h
"

33 
	~"qpe.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
usšg
 
Çme¥aû
 
	gqpe
;

40 
ENTER_NAMESPACE
(
ssb
);

53 şas 
	cssb_qcu¡om”
 {

55 
	mpublic
:

57 
ssb_cu¡om”_tu¶e
 
	tcu¡om”_tu¶e
;

59 
	scouÁ_tu¶e
 {

60 
	mCOUNT
;

63 
	gssb_qcu¡om”
::
	tcouÁ_tu¶e
 
	t´ojeùed_tu¶e
;

65 şas 
	ccu¡om”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t
 {

66 
´iv©e
:

67 
ShÜeSSBEnv
* 
_ssbdb
;

68 
bË_row_t
* 
	g_´cu¡
;

69 
»p_row_t
 
	g_¼
;

71 
ssb_cu¡om”_tu¶e
 
	g_cu¡om”
;

73 
	gpublic
:

75 
cu¡om”_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
qcu¡om”_šput_t
 &
š
)

76 : 
tu¶e_f‹r_t
(
ssbdb
->
cu¡om”_desc
()->
maxsize
()), 
_ssbdb
(ssbdb) {

79 
	g_´cu¡
 = 
_ssbdb
->
cu¡om”_mª
()->
g‘_tu¶e
();

80 
	g_¼
.
£t_ts
(
_ssbdb
->
cu¡om”_mª
()->
ts
(),

81 
_ssbdb
->
cu¡om”_desc
()->
maxsize
());

82 
	g_´cu¡
->
	g_»p
 = &
_¼
;

86 ~
cu¡om”_tsÿn_f‹r_t
() {

88 
	g_ssbdb
->
cu¡om”_mª
()->
give_tu¶e
(
_´cu¡
);

94 
boŞ
 
£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

97 ià(!
	g_ssbdb
->
cu¡om”_mª
()->
lßd
(
_´cu¡
, 
šput
.
d©a
)) {

98 
as£¹
(
çl£
);

101  (
	gŒue
);

107 
´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

108 
cu¡om”_tu¶e
 *
	gde¡
;

109 
	gde¡
 = 
®igÃd_ÿ¡
<
cu¡om”_tu¶e
 > (
d
.
d©a
);

111 
	g_´cu¡
->
g‘_v®ue
(0, 
_cu¡om”
.
C_CUSTKEY
);

112 
	g_´cu¡
->
g‘_v®ue
(1, 
_cu¡om”
.
C_NAME
, 
STRSIZE
(25));

113 
	g_´cu¡
->
g‘_v®ue
(2, 
_cu¡om”
.
C_ADDRESS
, 
STRSIZE
(25));

114 
	g_´cu¡
->
g‘_v®ue
(3, 
_cu¡om”
.
C_CITY
, 
STRSIZE
(10));

115 
	g_´cu¡
->
g‘_v®ue
(4, 
_cu¡om”
.
C_NATION
, 
STRSIZE
(15));

116 
	g_´cu¡
->
g‘_v®ue
(5, 
_cu¡om”
.
C_REGION
, 
STRSIZE
(12));

117 
	g_´cu¡
->
g‘_v®ue
(6, 
_cu¡om”
.
C_PHONE
, 
STRSIZE
(15));

118 
	g_´cu¡
->
g‘_v®ue
(7, 
_cu¡om”
.
C_MKTSEGMENT
, 
STRSIZE
(10));

121 
TRACE
(
TRACE_RECORD_FLOW
, "CUSTOMER: %s --d\n",

122 
_cu¡om”
.
C_NATION
);

124 
memıy
(
de¡
, &
_cu¡om”
,  (_customer));

127 
cu¡om”_tsÿn_f‹r_t
* 
şÚe
() const {

128  
Ãw
 
cu¡om”_tsÿn_f‹r_t
(*
this
);

131 
c_¡r
 
to_¡ršg
() const {

132  
c_¡r
("customer_tscan_filter_t()");

136 
	gqcu¡om”_couÁ_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

138 şas 
	ccouÁ_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

139 
public
:

141 
couÁ_key_exŒaùÜ_t
()

142 : 
key_exŒaùÜ_t
(0, 0) {

148 
vœtu®
 
key_exŒaùÜ_t
* 
şÚe
() const {

149  
Ãw
 
couÁ_key_exŒaùÜ_t
(*
this
);

153 
couÁ_key_exŒaùÜ_t
 
	g_exŒaùÜ
;

155 
qcu¡om”_couÁ_agg»g©e_t
()

156 : 
tu¶e_agg»g©e_t
( (
couÁ_tu¶e
)) {

160 
vœtu®
 
key_exŒaùÜ_t
 * 
key_exŒaùÜ
() {

161  &
_exŒaùÜ
;

164 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &) {

165 
couÁ_tu¶e
* 
	gagg
 = 
®igÃd_ÿ¡
<couÁ_tu¶> (
agg_d©a
);

166 
	gagg
->
	gCOUNT
++;

169 
vœtu®
 
fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

170 
couÁ_tu¶e
* 
	gagg
 = 
®igÃd_ÿ¡
<couÁ_tu¶> (
agg_d©a
);

171 
couÁ_tu¶e
* 
	gouut
 = 
®igÃd_ÿ¡
<couÁ_tu¶> (
d
.
d©a
);

172 
	gouut
->
	gCOUNT
 = 
agg
->
COUNT
;

175 
vœtu®
 
qcu¡om”_couÁ_agg»g©e_t
 * 
şÚe
() const {

176  
Ãw
 
qcu¡om”_couÁ_agg»g©e_t
(*
this
);

179 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

184 cÚ¡ 
c_¡r
* 
	$dump_tu¶e
(
tu¶e_t
* 
tup
) {

185 
ssb_qcu¡om”
::
cu¡om”_tu¶e
 *
de¡
;

186 
de¡
 = 
®igÃd_ÿ¡
<
ssb_qcu¡om”
::
cu¡om”_tu¶e
> (
tup
->
d©a
);

187  
Ãw
 
	`c_¡r
("%d|%s|%s|%s|%s|%s|%s|%s|\n",

188 
de¡
->
C_CUSTKEY
,

189 
de¡
->
C_NAME
,

190 
de¡
->
C_ADDRESS
,

191 
de¡
->
C_CITY
,

192 
de¡
->
C_NATION
,

193 
de¡
->
C_REGION
,

194 
de¡
->
C_PHONE
,

195 
de¡
->
C_MKTSEGMENT
);

196 
	}
}

204 şas 
	cssb_qcu¡om”_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


206 
public
:

208 
	$begš
() {

209 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** qcustomer ANSWER ...\n");

210 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** qcustomer COUNT...\n");

213 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

214 
ssb_qcu¡om”
::
´ojeùed_tu¶e
 *
tu¶e
;

215 
tu¶e
 = 
®igÃd_ÿ¡
<
ssb_qcu¡om”
::
´ojeùed_tu¶e
>(
ouut
.
d©a
);

216 
	`TRACE
(
TRACE_QUERY_RESULTS
, "%d\n", 
tu¶e
->
COUNT
);

217 
	}
}

228 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_qpe_qcu¡om”
(cÚ¡ 
xù_id
,

229 
qcu¡om”_šput_t
& 
š
)

231 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** qcustomer *********\n");

234 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

235 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

239 
tu¶e_fifo
* 
tsÿn_out_bufãr
 =

240 
Ãw
 
	`tu¶e_fifo
((
ssb_qcu¡om”
::
cu¡om”_tu¶e
));

241 
tsÿn_·ck‘_t
* 
cu¡om”_tsÿn_·ck‘
 =

242 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN CUSTOMER",

243 
tsÿn_out_bufãr
,

244 
Ãw
 
ssb_qcu¡om”
::
	`cu¡om”_tsÿn_f‹r_t
(
this
,
š
),

245 
this
->
	`db
(),

246 
_pcu¡om”_desc
.
	`g‘
(),

247 
pxù


251 
tu¶e_fifo
* 
fdump_ouut
 = 
Ãw
 
	`tu¶e_fifo
((
ssb_qcu¡om”
::
cu¡om”_tu¶e
));

252 
fdump_·ck‘_t
* 
fdump_·ck‘
 =

253 
Ãw
 
	`fdump_·ck‘_t
(
	`c_¡r
("FDUMP"),

254 
fdump_ouut
,

255 
Ãw
 
	`ŒivŸl_f‹r_t
(
fdump_ouut
->
	`tu¶e_size
()),

256 
NULL
,

257 
	`c_¡r
("%s/cu¡om”s.tbl", 
	`g‘’v
("HOME")),

258 
NULL
,

259 
cu¡om”_tsÿn_·ck‘
,

260 
ssb_qcu¡om”
::
dump_tu¶e
);

262 
tu¶e_fifo
* 
agg_ouut
 = 
Ãw
 
	`tu¶e_fifo
( (
ssb_qcu¡om”
::
´ojeùed_tu¶e
));

263 
agg»g©e_·ck‘_t
* 
agg_·ck‘
 =

264 
Ãw
 
	`agg»g©e_·ck‘_t
(
	`c_¡r
("COUNT_AGGREGATE"),

265 
agg_ouut
,

266 
Ãw
 
	`ŒivŸl_f‹r_t
(
agg_ouut
->
	`tu¶e_size
()),

267 
Ãw
 
ssb_qcu¡om”
::
	`qcu¡om”_couÁ_agg»g©e_t
(),

268 
Ãw
 
ssb_qcu¡om”
::
qcu¡om”_couÁ_agg»g©e_t
::
	`couÁ_key_exŒaùÜ_t
(),

269 
fdump_·ck‘
);

271 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

272 
cu¡om”_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

273 
fdump_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

274 
agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

277 
ssb_qcu¡om”_´oûss_tu¶e_t
 
±
;

278 
	`´oûss_qu”y
(
agg_·ck‘
, 
±
);

279 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

281  (
RCOK
);

282 
	}
}

285 
EXIT_NAMESPACE
(
ssb
);

	@src/workload/ssb/qpipe/qpipe_qdate.cpp

32 
	~"wÜklßd/ssb/shÜe_ssb_’v.h
"

33 
	~"qpe.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
usšg
 
Çme¥aû
 
	gqpe
;

40 
ENTER_NAMESPACE
(
ssb
);

53 şas 
	cssb_qd©e
 {

55 
	mpublic
:

57 
ssb_d©e_tu¶e
 
	td©e_tu¶e
;

59 
	scouÁ_tu¶e
 {

60 
	mCOUNT
;

63 
couÁ_tu¶e
 
	t´ojeùed_tu¶e
;

65 şas 
	cd©e_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t
 {

66 
´iv©e
:

67 
ShÜeSSBEnv
* 
_ssbdb
;

68 
bË_row_t
* 
	g_´d©e
;

69 
»p_row_t
 
	g_¼
;

71 
ssb_d©e_tu¶e
 
	g_d©e
;

73 
	gpublic
:

75 
d©e_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
qd©e_šput_t
 &
š
)

76 : 
tu¶e_f‹r_t
(
ssbdb
->
d©e_desc
()->
maxsize
()), 
_ssbdb
(ssbdb) {

79 
	g_´d©e
 = 
_ssbdb
->
d©e_mª
()->
g‘_tu¶e
();

80 
	g_¼
.
£t_ts
(
_ssbdb
->
d©e_mª
()->
ts
(),

81 
_ssbdb
->
d©e_desc
()->
maxsize
());

82 
	g_´d©e
->
	g_»p
 = &
_¼
;

86 ~
d©e_tsÿn_f‹r_t
() {

88 
	g_ssbdb
->
d©e_mª
()->
give_tu¶e
(
_´d©e
);

94 
boŞ
 
£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

97 ià(!
	g_ssbdb
->
d©e_mª
()->
lßd
(
_´d©e
, 
šput
.
d©a
)) {

98 
as£¹
(
çl£
);

101  
	gŒue
;

107 
´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

109 
	gssb_qd©e
::
d©e_tu¶e
 *
de¡
;

110 
	gde¡
 = 
®igÃd_ÿ¡
<
ssb_qd©e
::
d©e_tu¶e
> (
d
.
d©a
);

112 
	g_´d©e
->
g‘_v®ue
(0, 
_d©e
.
D_DATEKEY
);

113 
	g_´d©e
->
g‘_v®ue
(1, 
_d©e
.
D_DATE
, 
STRSIZE
(18));

114 
	g_´d©e
->
g‘_v®ue
(2, 
_d©e
.
D_DAYOFWEEK
, 
STRSIZE
(9));

115 
	g_´d©e
->
g‘_v®ue
(3, 
_d©e
.
D_MONTH
, 
STRSIZE
(9));

116 
	g_´d©e
->
g‘_v®ue
(4, 
_d©e
.
D_YEAR
);

117 
	g_´d©e
->
g‘_v®ue
(5, 
_d©e
.
D_YEARMONTHNUM
);

118 
	g_´d©e
->
g‘_v®ue
(6, 
_d©e
.
D_YEARMONTH
, 
STRSIZE
(7));

119 
	g_´d©e
->
g‘_v®ue
(7, 
_d©e
.
D_DAYNUMINWEEK
);

120 
	g_´d©e
->
g‘_v®ue
(8, 
_d©e
.
D_DAYNUMINMONTH
);

121 
	g_´d©e
->
g‘_v®ue
(9, 
_d©e
.
D_DAYNUMINYEAR
);

122 
	g_´d©e
->
g‘_v®ue
(10, 
_d©e
.
D_MONTHNUMINYEAR
);

123 
	g_´d©e
->
g‘_v®ue
(11, 
_d©e
.
D_WEEKNUMINYEAR
);

124 
	g_´d©e
->
g‘_v®ue
(12, 
_d©e
.
D_SELLINGSEASON
, 
STRSIZE
(12));

125 
	g_´d©e
->
g‘_v®ue
(13, 
_d©e
.
D_LASTDAYINWEEKFL
, 2);

126 
	g_´d©e
->
g‘_v®ue
(14, 
_d©e
.
D_LASTDAYINMONTHFL
, 2);

127 
	g_´d©e
->
g‘_v®ue
(15, 
_d©e
.
D_HOLIDAYFL
, 2);

128 
	g_´d©e
->
g‘_v®ue
(16, 
_d©e
.
D_WEEKDAYFL
, 2);

130 
TRACE
(
TRACE_RECORD_FLOW
, "%d|%s --\n",

131 
_d©e
.
D_DATEKEY
,

132 
_d©e
.
D_DATE
);

134 
memıy
(
de¡
, &
_d©e
, (_date));

137 
d©e_tsÿn_f‹r_t
* 
şÚe
() const {

138  
Ãw
 
d©e_tsÿn_f‹r_t
(*
this
);

141 
c_¡r
 
to_¡ršg
() const {

142  
c_¡r
("date_tscan_filter_t()");

146 
	gqd©e_couÁ_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

148 şas 
	ccouÁ_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

149 
public
:

151 
couÁ_key_exŒaùÜ_t
()

152 : 
key_exŒaùÜ_t
(0, 0) {

158 
vœtu®
 
key_exŒaùÜ_t
* 
şÚe
() const {

159  
Ãw
 
couÁ_key_exŒaùÜ_t
(*
this
);

163 
couÁ_key_exŒaùÜ_t
 
	g_exŒaùÜ
;

165 
qd©e_couÁ_agg»g©e_t
()

166 : 
tu¶e_agg»g©e_t
( (
couÁ_tu¶e
)) {

170 
vœtu®
 
key_exŒaùÜ_t
 * 
key_exŒaùÜ
() {

171  &
_exŒaùÜ
;

174 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &) {

175 
couÁ_tu¶e
* 
	gagg
 = 
®igÃd_ÿ¡
<couÁ_tu¶> (
agg_d©a
);

176 
	gagg
->
	gCOUNT
++;

179 
vœtu®
 
fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

180 
couÁ_tu¶e
* 
	gagg
 = 
®igÃd_ÿ¡
<couÁ_tu¶> (
agg_d©a
);

181 
couÁ_tu¶e
* 
	gouut
 = 
®igÃd_ÿ¡
<couÁ_tu¶> (
d
.
d©a
);

182 
	gouut
->
	gCOUNT
 = 
agg
->
COUNT
;

185 
vœtu®
 
qd©e_couÁ_agg»g©e_t
 * 
şÚe
() const {

186  
Ãw
 
qd©e_couÁ_agg»g©e_t
(*
this
);

189 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

194 cÚ¡ 
c_¡r
* 
	$dump_tu¶e
(
tu¶e_t
* 
tup
) {

195 
ssb_qd©e
::
d©e_tu¶e
 *
de¡
;

196 
de¡
 = 
®igÃd_ÿ¡
<
ssb_qd©e
::
d©e_tu¶e
> (
tup
->
d©a
);

197  
Ãw
 
	`c_¡r
("%d|%s|%s|%s|%d|%d|%s|%d|%d|%d|%d|%d|%s|%s|%s|%s|%s|\n",

198 
de¡
->
D_DATEKEY
,

199 
de¡
->
D_DATE
,

200 
de¡
->
D_DAYOFWEEK
,

201 
de¡
->
D_MONTH
,

202 
de¡
->
D_YEAR
,

203 
de¡
->
D_YEARMONTHNUM
,

204 
de¡
->
D_YEARMONTH
,

205 
de¡
->
D_DAYNUMINWEEK
,

206 
de¡
->
D_DAYNUMINMONTH
,

207 
de¡
->
D_DAYNUMINYEAR
,

208 
de¡
->
D_MONTHNUMINYEAR
,

209 
de¡
->
D_WEEKNUMINYEAR
,

210 
de¡
->
D_SELLINGSEASON
,

211 
de¡
->
D_LASTDAYINWEEKFL
,

212 
de¡
->
D_LASTDAYINMONTHFL
,

213 
de¡
->
D_HOLIDAYFL
,

214 
de¡
->
D_WEEKDAYFL
);

215 
	}
}

219 şas 
	cssb_qd©e_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


221 
public
:

223 
	$begš
() {

224 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** QDATE ANSWER ...\n");

225 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** QDATE COUNT...\n");

228 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

229 
ssb_qd©e
::
´ojeùed_tu¶e
 *
tu¶e
;

230 
tu¶e
 = 
®igÃd_ÿ¡
<
ssb_qd©e
::
´ojeùed_tu¶e
>(
ouut
.
d©a
);

231 
	`TRACE
Ğ
TRACE_QUERY_RESULTS
, "%d\n", 
tu¶e
->
COUNT
);

232 
	}
}

243 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_qpe_qd©e
(cÚ¡ 
xù_id
,

244 
qd©e_šput_t
& 
š
)

246 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** qdate *********\n");

249 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

250 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

254 
tu¶e_fifo
* 
tsÿn_out_bufãr
 =

255 
Ãw
 
	`tu¶e_fifo
((
ssb_qd©e
::
d©e_tu¶e
));

256 
tsÿn_·ck‘_t
* 
d©e_tsÿn_·ck‘
 =

257 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN DATE",

258 
tsÿn_out_bufãr
,

259 
Ãw
 
ssb_qd©e
::
	`d©e_tsÿn_f‹r_t
(
this
,
š
),

260 
this
->
	`db
(),

261 
_pd©e_desc
.
	`g‘
(),

262 
pxù


266 
tu¶e_fifo
* 
fdump_ouut
 = 
Ãw
 
	`tu¶e_fifo
( (
ssb_qd©e
::
d©e_tu¶e
));

267 
fdump_·ck‘_t
* 
fdump_·ck‘
 =

268 
Ãw
 
	`fdump_·ck‘_t
(
	`c_¡r
("FDUMP"),

269 
fdump_ouut
,

270 
Ãw
 
	`ŒivŸl_f‹r_t
(
fdump_ouut
->
	`tu¶e_size
()),

271 
NULL
,

272 
	`c_¡r
("%s/d©es.tbl", 
	`g‘’v
("HOME")),

273 
NULL
,

274 
d©e_tsÿn_·ck‘
,

275 
ssb_qd©e
::
dump_tu¶e
);

277 
tu¶e_fifo
* 
agg_ouut
 = 
Ãw
 
	`tu¶e_fifo
( (
ssb_qd©e
::
´ojeùed_tu¶e
));

278 
agg»g©e_·ck‘_t
* 
agg_·ck‘
 =

279 
Ãw
 
	`agg»g©e_·ck‘_t
(
	`c_¡r
("COUNT_AGGREGATE"),

280 
agg_ouut
,

281 
Ãw
 
	`ŒivŸl_f‹r_t
(
agg_ouut
->
	`tu¶e_size
()),

282 
Ãw
 
ssb_qd©e
::
qd©e_couÁ_agg»g©e_t
,

283 
Ãw
 
ssb_qd©e
::
qd©e_couÁ_agg»g©e_t
::
	`couÁ_key_exŒaùÜ_t
(),

284 
fdump_·ck‘
);

286 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

287 
d©e_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

288 
fdump_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

289 
agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

292 
ssb_qd©e_´oûss_tu¶e_t
 
±
;

293 
	`´oûss_qu”y
(
agg_·ck‘
, 
±
);

294 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

296  (
RCOK
);

297 
	}
}

300 
EXIT_NAMESPACE
(
ssb
);

	@src/workload/ssb/qpipe/qpipe_qlineorder.cpp

32 
	~"wÜklßd/ssb/shÜe_ssb_’v.h
"

33 
	~"qpe.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
usšg
 
Çme¥aû
 
	gqpe
;

40 
ENTER_NAMESPACE
(
ssb
);

53 şas 
	cssb_qlšeÜd”
 {

55 
	mpublic
:

57 
ssb_lšeÜd”_tu¶e
 
	tlšeÜd”_tu¶e
;

64 
	scouÁ_tu¶e
 {

65 
	mCOUNT
;

68 
couÁ_tu¶e
 
	t´ojeùed_tu¶e
;

70 şas 
	clšeÜd”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t
 {

71 
´iv©e
:

72 
ShÜeSSBEnv
* 
_ssbdb
;

73 
bË_row_t
* 
	g_´lše
;

74 
»p_row_t
 
	g_¼
;

76 
ssb_lšeÜd”_tu¶e
 
	g_lšeÜd”
;

78 
	gpublic
:

80 
lšeÜd”_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
qlšeÜd”_šput_t
 &
š
)

81 : 
tu¶e_f‹r_t
(
ssbdb
->
lšeÜd”_desc
()->
maxsize
()), 
_ssbdb
(ssbdb) {

84 
	g_´lše
 = 
_ssbdb
->
lšeÜd”_mª
()->
g‘_tu¶e
();

85 
	g_¼
.
£t_ts
(
_ssbdb
->
lšeÜd”_mª
()->
ts
(),

86 
_ssbdb
->
lšeÜd”_desc
()->
maxsize
());

87 
	g_´lše
->
	g_»p
 = &
_¼
;

91 ~
lšeÜd”_tsÿn_f‹r_t
() {

93 
	g_ssbdb
->
lšeÜd”_mª
()->
give_tu¶e
(
_´lše
);

99 
boŞ
 
£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

102 ià(!
	g_ssbdb
->
lšeÜd”_mª
()->
lßd
(
_´lše
, 
šput
.
d©a
)) {

103 
as£¹
(
çl£
);

106  (
	gŒue
);

112 
´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

114 
	gssb_qlšeÜd”
::
lšeÜd”_tu¶e
 *
de¡
;

115 
	gde¡
 = 
®igÃd_ÿ¡
<
ssb_qlšeÜd”
::
lšeÜd”_tu¶e
> (
d
.
d©a
);

117 
	g_´lše
->
g‘_v®ue
(0, 
_lšeÜd”
.
LO_ORDERKEY
);

118 
	g_´lše
->
g‘_v®ue
(1, 
_lšeÜd”
.
LO_LINENUMBER
);

119 
	g_´lše
->
g‘_v®ue
(2, 
_lšeÜd”
.
LO_CUSTKEY
);

120 
	g_´lše
->
g‘_v®ue
(3, 
_lšeÜd”
.
LO_PARTKEY
);

121 
	g_´lše
->
g‘_v®ue
(4, 
_lšeÜd”
.
LO_SUPPKEY
);

122 
	g_´lše
->
g‘_v®ue
(5, 
_lšeÜd”
.
LO_ORDERDATE
);

123 
	g_´lše
->
g‘_v®ue
(6, 
_lšeÜd”
.
LO_ORDERPRIORITY
, 
STRSIZE
(15));

124 
	g_´lše
->
g‘_v®ue
(7, 
_lšeÜd”
.
LO_SHIPPRIORITY
);

125 
	g_´lše
->
g‘_v®ue
(8, 
_lšeÜd”
.
LO_QUANTITY
);

126 
	g_´lše
->
g‘_v®ue
(9, 
_lšeÜd”
.
LO_EXTENDEDPRICE
);

127 
	g_´lše
->
g‘_v®ue
(10, 
_lšeÜd”
.
LO_ORDTOTALPRICE
);

128 
	g_´lše
->
g‘_v®ue
(11, 
_lšeÜd”
.
LO_DISCOUNT
);

129 
	g_´lše
->
g‘_v®ue
(12, 
_lšeÜd”
.
LO_REVENUE
);

130 
	g_´lše
->
g‘_v®ue
(13, 
_lšeÜd”
.
LO_SUPPLYCOST
);

131 
	g_´lše
->
g‘_v®ue
(14, 
_lšeÜd”
.
LO_TAX
);

132 
	g_´lše
->
g‘_v®ue
(15, 
_lšeÜd”
.
LO_COMMIDATE
);

133 
	g_´lše
->
g‘_v®ue
(16, 
_lšeÜd”
.
LO_SHIPMODE
, 
STRSIZE
(10));

135 
TRACE
(
TRACE_RECORD_FLOW
, "%d|%d --d\n",

136 
_lšeÜd”
.
LO_ORDERKEY
,

137 
_lšeÜd”
.
LO_LINENUMBER
);

141 
memıy
(
de¡
, &
_lšeÜd”
,  (_lineorder));

144 
lšeÜd”_tsÿn_f‹r_t
* 
şÚe
() const {

145  
Ãw
 
lšeÜd”_tsÿn_f‹r_t
(*
this
);

148 
c_¡r
 
to_¡ršg
() const {

149  
c_¡r
("lineorder_tscan_filter_t()");

153 
	gqlšeÜd”_couÁ_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

155 şas 
	ccouÁ_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

156 
public
:

158 
couÁ_key_exŒaùÜ_t
()

159 : 
key_exŒaùÜ_t
(0, 0) {

165 
vœtu®
 
key_exŒaùÜ_t
* 
şÚe
() const {

166  
Ãw
 
couÁ_key_exŒaùÜ_t
(*
this
);

170 
couÁ_key_exŒaùÜ_t
 
	g_exŒaùÜ
;

172 
qlšeÜd”_couÁ_agg»g©e_t
()

173 : 
tu¶e_agg»g©e_t
( (
couÁ_tu¶e
)) {

177 
vœtu®
 
key_exŒaùÜ_t
 * 
key_exŒaùÜ
() {

178  &
_exŒaùÜ
;

181 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &) {

182 
couÁ_tu¶e
* 
	gagg
 = 
®igÃd_ÿ¡
<couÁ_tu¶> (
agg_d©a
);

183 
	gagg
->
	gCOUNT
++;

186 
vœtu®
 
fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

187 
couÁ_tu¶e
* 
	gagg
 = 
®igÃd_ÿ¡
<couÁ_tu¶> (
agg_d©a
);

188 
couÁ_tu¶e
* 
	gouut
 = 
®igÃd_ÿ¡
<couÁ_tu¶> (
d
.
d©a
);

189 
	gouut
->
	gCOUNT
 = 
agg
->
COUNT
;

192 
vœtu®
 
qlšeÜd”_couÁ_agg»g©e_t
 * 
şÚe
() const {

193  
Ãw
 
qlšeÜd”_couÁ_agg»g©e_t
(*
this
);

196 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

201 cÚ¡ 
c_¡r
* 
	$dump_tu¶e
(
tu¶e_t
* 
tup
) {

202 
ssb_qlšeÜd”
::
lšeÜd”_tu¶e
 *
de¡
;

203 
de¡
 = 
®igÃd_ÿ¡
<
ssb_qlšeÜd”
::
lšeÜd”_tu¶e
> (
tup
->
d©a
);

204  
Ãw
 
	`c_¡r
("%d|%d|%d|%d|%d|%d|%s|%d|%d|%d|%d|%d|%d|%d|%d|%d|%s|\n",

205 
de¡
->
LO_ORDERKEY
,

206 
de¡
->
LO_LINENUMBER
,

207 
de¡
->
LO_CUSTKEY
,

208 
de¡
->
LO_PARTKEY
,

209 
de¡
->
LO_SUPPKEY
,

210 
de¡
->
LO_ORDERDATE
,

211 
de¡
->
LO_ORDERPRIORITY
,

212 
de¡
->
LO_SHIPPRIORITY
,

213 
de¡
->
LO_QUANTITY
,

214 
de¡
->
LO_EXTENDEDPRICE
,

215 
de¡
->
LO_ORDTOTALPRICE
,

216 
de¡
->
LO_DISCOUNT
,

217 
de¡
->
LO_REVENUE
,

218 
de¡
->
LO_SUPPLYCOST
,

219 
de¡
->
LO_TAX
,

220 
de¡
->
LO_COMMIDATE
,

221 
de¡
->
LO_SHIPMODE
);

222 
	}
}

226 şas 
	cssb_qlšeÜd”_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


228 
public
:

230 
	$begš
() {

231 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** qlineorder ANSWER ...\n");

232 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** qlineorder COUNT...\n");

235 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

236 
ssb_qlšeÜd”
::
´ojeùed_tu¶e
 *
tu¶e
;

237 
tu¶e
 = 
®igÃd_ÿ¡
<
ssb_qlšeÜd”
::
´ojeùed_tu¶e
>(
ouut
.
d©a
);

238 
	`TRACE
(
TRACE_QUERY_RESULTS
, "%d\n", 
tu¶e
->
COUNT
);

239 
	}
}

250 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_qpe_qlšeÜd”
(cÚ¡ 
xù_id
,

251 
qlšeÜd”_šput_t
& 
š
)

253 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** qlineorder *********\n");

256 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

257 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

261 
tu¶e_fifo
* 
tsÿn_out_bufãr
 =

262 
Ãw
 
	`tu¶e_fifo
( (
ssb_qlšeÜd”
::
lšeÜd”_tu¶e
));

263 
tsÿn_·ck‘_t
* 
lšeÜd”_tsÿn_·ck‘
 =

264 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN LINEORDER",

265 
tsÿn_out_bufãr
,

266 
Ãw
 
ssb_qlšeÜd”
::
	`lšeÜd”_tsÿn_f‹r_t
(
this
,
š
),

267 
this
->
	`db
(),

268 
_¶šeÜd”_desc
.
	`g‘
(),

269 
pxù


273 
tu¶e_fifo
* 
fdump_ouut
 = 
Ãw
 
	`tu¶e_fifo
( (
ssb_qlšeÜd”
::
lšeÜd”_tu¶e
));

274 
fdump_·ck‘_t
* 
fdump_·ck‘
 =

275 
Ãw
 
	`fdump_·ck‘_t
(
	`c_¡r
("FDUMP"),

276 
fdump_ouut
,

277 
Ãw
 
	`ŒivŸl_f‹r_t
(
fdump_ouut
->
	`tu¶e_size
()),

278 
NULL
,

279 
	`c_¡r
("%s/lšeÜd”s.tbl", 
	`g‘’v
("HOME")),

280 
NULL
,

281 
lšeÜd”_tsÿn_·ck‘
,

282 
ssb_qlšeÜd”
::
dump_tu¶e
);

284 
tu¶e_fifo
* 
agg_ouut
 = 
Ãw
 
	`tu¶e_fifo
((
ssb_qlšeÜd”
::
couÁ_tu¶e
));

285 
agg»g©e_·ck‘_t
* 
agg_·ck‘
 =

286 
Ãw
 
	`agg»g©e_·ck‘_t
(
	`c_¡r
("COUNT_AGGREGATE"),

287 
agg_ouut
,

288 
Ãw
 
	`ŒivŸl_f‹r_t
(
agg_ouut
->
	`tu¶e_size
()),

289 
Ãw
 
ssb_qlšeÜd”
::
	`qlšeÜd”_couÁ_agg»g©e_t
(),

290 
Ãw
 
ssb_qlšeÜd”
::
qlšeÜd”_couÁ_agg»g©e_t
::
	`couÁ_key_exŒaùÜ_t
(),

291 
fdump_·ck‘
);

293 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

294 
lšeÜd”_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

295 
fdump_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

296 
agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

299 
ssb_qlšeÜd”_´oûss_tu¶e_t
 
±
;

300 
	`´oûss_qu”y
(
agg_·ck‘
, 
±
);

301 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

303  (
RCOK
);

304 
	}
}

307 
EXIT_NAMESPACE
(
ssb
);

	@src/workload/ssb/qpipe/qpipe_qpart.cpp

32 
	~"wÜklßd/ssb/shÜe_ssb_’v.h
"

33 
	~"qpe.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
usšg
 
Çme¥aû
 
	gqpe
;

40 
ENTER_NAMESPACE
(
ssb
);

53 şas 
	cssb_q·¹
 {

55 
	mpublic
:

57 
ssb_·¹_tu¶e
 
	t·¹_tu¶e
;

64 
	scouÁ_tu¶e
 {

65 
	mCOUNT
;

68 
couÁ_tu¶e
 
	t´ojeùed_tu¶e
;

70 şas 
	c·¹_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t
 {

71 
´iv©e
:

72 
ShÜeSSBEnv
* 
_ssbdb
;

73 
bË_row_t
* 
	g_´·¹
;

74 
»p_row_t
 
	g_¼
;

76 
ssb_·¹_tu¶e
 
	g_·¹
;

78 
	gpublic
:

80 
·¹_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q·¹_šput_t
 &
š
)

81 : 
tu¶e_f‹r_t
(
ssbdb
->
·¹_desc
()->
maxsize
()), 
_ssbdb
(ssbdb) {

84 
	g_´·¹
 = 
_ssbdb
->
·¹_mª
()->
g‘_tu¶e
();

85 
	g_¼
.
£t_ts
(
_ssbdb
->
·¹_mª
()->
ts
(),

86 
_ssbdb
->
·¹_desc
()->
maxsize
());

87 
	g_´·¹
->
	g_»p
 = &
_¼
;

91 ~
·¹_tsÿn_f‹r_t
() {

93 
	g_ssbdb
->
·¹_mª
()->
give_tu¶e
(
_´·¹
);

99 
boŞ
 
£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

102 ià(!
	g_ssbdb
->
·¹_mª
()->
lßd
(
_´·¹
, 
šput
.
d©a
)) {

103 
as£¹
(
çl£
);

106  (
	gŒue
);

112 
´ojeù
(
tu¶e_t
 &
d
, constuple_t & ) {

114 
	gssb_q·¹
::
·¹_tu¶e
 *
de¡
;

115 
	gde¡
 = 
®igÃd_ÿ¡
<
ssb_q·¹
::
·¹_tu¶e
> (
d
.
d©a
);

117 
	g_´·¹
->
g‘_v®ue
(0, 
_·¹
.
P_PARTKEY
);

118 
	g_´·¹
->
g‘_v®ue
(1, 
_·¹
.
P_NAME
, 
STRSIZE
(22));

119 
	g_´·¹
->
g‘_v®ue
(2, 
_·¹
.
P_MFGR
, 
STRSIZE
(6));

120 
	g_´·¹
->
g‘_v®ue
(3, 
_·¹
.
P_CATEGORY
, 
STRSIZE
(7));

121 
	g_´·¹
->
g‘_v®ue
(4, 
_·¹
.
P_BRAND
, 
STRSIZE
(9));

122 
	g_´·¹
->
g‘_v®ue
(5, 
_·¹
.
P_COLOR
, 
STRSIZE
(11));

123 
	g_´·¹
->
g‘_v®ue
(6, 
_·¹
.
P_TYPE
, 
STRSIZE
(25));

124 
	g_´·¹
->
g‘_v®ue
(7, 
_·¹
.
P_SIZE
);

125 
	g_´·¹
->
g‘_v®ue
(8, 
_·¹
.
P_CONTAINER
, 
STRSIZE
(10));

127 
TRACE
(
TRACE_RECORD_FLOW
, "%d|%s|%s| --d\n",

128 
_·¹
.
P_PARTKEY
,

129 
_·¹
.
P_NAME
,

130 
_·¹
.
P_CATEGORY
);

134 
memıy
(
de¡
, &
_·¹
, (_part));

137 
·¹_tsÿn_f‹r_t
* 
şÚe
() const {

138  
Ãw
 
·¹_tsÿn_f‹r_t
(*
this
);

141 
c_¡r
 
to_¡ršg
() const {

142  
c_¡r
("part_tscan_filter_t()");

146 
	gq·¹_couÁ_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

148 şas 
	ccouÁ_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

149 
public
:

151 
couÁ_key_exŒaùÜ_t
()

152 : 
key_exŒaùÜ_t
(0, 0) {

158 
vœtu®
 
key_exŒaùÜ_t
* 
şÚe
() const {

159  
Ãw
 
couÁ_key_exŒaùÜ_t
(*
this
);

163 
couÁ_key_exŒaùÜ_t
 
	g_exŒaùÜ
;

165 
q·¹_couÁ_agg»g©e_t
()

166 : 
tu¶e_agg»g©e_t
((
couÁ_tu¶e
)) {

170 
vœtu®
 
key_exŒaùÜ_t
 * 
key_exŒaùÜ
() {

171  &
_exŒaùÜ
;

174 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &) {

175 
couÁ_tu¶e
* 
	gagg
 = 
®igÃd_ÿ¡
<couÁ_tu¶> (
agg_d©a
);

176 
	gagg
->
	gCOUNT
++;

179 
vœtu®
 
fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

180 
couÁ_tu¶e
* 
	gagg
 = 
®igÃd_ÿ¡
<couÁ_tu¶> (
agg_d©a
);

181 
couÁ_tu¶e
* 
	gouut
 = 
®igÃd_ÿ¡
<couÁ_tu¶> (
d
.
d©a
);

182 
	gouut
->
	gCOUNT
 = 
agg
->
COUNT
;

185 
vœtu®
 
q·¹_couÁ_agg»g©e_t
 * 
şÚe
() const {

186  
Ãw
 
q·¹_couÁ_agg»g©e_t
(*
this
);

189 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

194 cÚ¡ 
c_¡r
* 
	$dump_tu¶e
(
tu¶e_t
* 
tup
) {

195 
ssb_q·¹
::
·¹_tu¶e
 *
de¡
;

196 
de¡
 = 
®igÃd_ÿ¡
<
ssb_q·¹
::
·¹_tu¶e
> (
tup
->
d©a
);

197  
Ãw
 
	`c_¡r
("%d|%s|%s|%s|%s|%s|%s|%d|%s|\n",

198 
de¡
->
P_PARTKEY
,

199 
de¡
->
P_NAME
,

200 
de¡
->
P_MFGR
,

201 
de¡
->
P_CATEGORY
,

202 
de¡
->
P_BRAND
,

203 
de¡
->
P_COLOR
,

204 
de¡
->
P_TYPE
,

205 
de¡
->
P_SIZE
,

206 
de¡
->
P_CONTAINER
);

207 
	}
}

211 şas 
	cssb_q·¹_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


213 
public
:

215 
	$begš
() {

216 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** QPART ANSWER ...\n");

217 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** SUM_QTY\tSUM_BASE\tSUM_DISC...\n");

220 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

221 
ssb_q·¹
::
´ojeùed_tu¶e
 *
tu¶e
;

222 
tu¶e
 = 
®igÃd_ÿ¡
<
ssb_q·¹
::
´ojeùed_tu¶e
>(
ouut
.
d©a
);

223 
	`TRACE
Ğ
TRACE_QUERY_RESULTS
, "%ld\n", 
tu¶e
->
COUNT
);

225 
	}
}

236 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_qpe_q·¹
(cÚ¡ 
xù_id
,

237 
q·¹_šput_t
& 
š
)

239 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** QPART *********\n");

242 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

243 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

247 
tu¶e_fifo
* 
tsÿn_out_bufãr
 =

248 
Ãw
 
	`tu¶e_fifo
( (
ssb_q·¹
::
·¹_tu¶e
));

249 
tsÿn_·ck‘_t
* 
·¹_tsÿn_·ck‘
 =

250 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN PART",

251 
tsÿn_out_bufãr
,

252 
Ãw
 
ssb_q·¹
::
	`·¹_tsÿn_f‹r_t
(
this
,
š
),

253 
this
->
	`db
(),

254 
_µ¬t_desc
.
	`g‘
(),

255 
pxù


259 
tu¶e_fifo
* 
fdump_ouut
 = 
Ãw
 
	`tu¶e_fifo
( (
ssb_q·¹
::
·¹_tu¶e
));

260 
fdump_·ck‘_t
* 
fdump_·ck‘
 =

261 
Ãw
 
	`fdump_·ck‘_t
(
	`c_¡r
("FDUMP"),

262 
fdump_ouut
,

263 
Ãw
 
	`ŒivŸl_f‹r_t
(
fdump_ouut
->
	`tu¶e_size
()),

264 
NULL
,

265 
	`c_¡r
("%s/·¹s.tbl", 
	`g‘’v
("HOME")),

266 
NULL
,

267 
·¹_tsÿn_·ck‘
,

268 
ssb_q·¹
::
dump_tu¶e
);

270 
tu¶e_fifo
* 
agg_ouut
 = 
Ãw
 
	`tu¶e_fifo
( (
ssb_q·¹
::
couÁ_tu¶e
));

271 
agg»g©e_·ck‘_t
* 
agg_·ck‘
 =

272 
Ãw
 
	`agg»g©e_·ck‘_t
(
	`c_¡r
("COUNT_AGGREGATE"),

273 
agg_ouut
,

274 
Ãw
 
	`ŒivŸl_f‹r_t
(
agg_ouut
->
	`tu¶e_size
()),

275 
Ãw
 
ssb_q·¹
::
	`q·¹_couÁ_agg»g©e_t
(),

276 
Ãw
 
ssb_q·¹
::
q·¹_couÁ_agg»g©e_t
::
	`couÁ_key_exŒaùÜ_t
(),

277 
fdump_·ck‘
);

279 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

280 
·¹_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

281 
fdump_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

282 
agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

285 
ssb_q·¹_´oûss_tu¶e_t
 
±
;

286 
	`´oûss_qu”y
(
agg_·ck‘
, 
±
);

287 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

289  (
RCOK
);

290 
	}
}

293 
EXIT_NAMESPACE
(
ssb
);

	@src/workload/ssb/qpipe/qpipe_qsupplier.cpp

32 
	~"wÜklßd/ssb/shÜe_ssb_’v.h
"

33 
	~"qpe.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
usšg
 
Çme¥aû
 
	gqpe
;

40 
ENTER_NAMESPACE
(
ssb
);

53 şas 
	cssb_qsuµl›r
 {

54 
	mpublic
:

56 
ssb_suµl›r_tu¶e
 
	tqsuµl›r_suµl›r_tu¶e
;

58 
	scouÁ_tu¶e
 {

59 
	mCOUNT
;

62 şas 
	csuµl›r_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t
 {

63 
´iv©e
:

64 
ShÜeSSBEnv
* 
_ssbdb
;

65 
bË_row_t
* 
	g_´suµ
;

66 
»p_row_t
 
	g_¼
;

68 
ssb_suµl›r_tu¶e
 
	g_suµl›r
;

70 
	gpublic
:

72 
suµl›r_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
qsuµl›r_šput_t
 &
š
)

73 : 
tu¶e_f‹r_t
(
ssbdb
->
suµl›r_desc
()->
maxsize
()), 
_ssbdb
(ssbdb) {

76 
	g_´suµ
 = 
_ssbdb
->
suµl›r_mª
()->
g‘_tu¶e
();

77 
	g_¼
.
£t_ts
(
_ssbdb
->
suµl›r_mª
()->
ts
(),

78 
_ssbdb
->
suµl›r_desc
()->
maxsize
());

79 
	g_´suµ
->
	g_»p
 = &
_¼
;

83 ~
suµl›r_tsÿn_f‹r_t
() {

92 
boŞ
 
£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

95 ià(!
	g_ssbdb
->
suµl›r_mª
()->
lßd
(
_´suµ
, 
šput
.
d©a
)) {

96 
as£¹
(
çl£
);

99  (
	gŒue
);

105 
´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

107 
qsuµl›r_suµl›r_tu¶e
 *
	gde¡
;

108 
	gde¡
 = 
®igÃd_ÿ¡
<
qsuµl›r_suµl›r_tu¶e
>(
d
.
d©a
);

110 
	g_´suµ
->
g‘_v®ue
(0, 
_suµl›r
.
S_SUPPKEY
);

111 
	g_´suµ
->
g‘_v®ue
(1, 
_suµl›r
.
S_NAME
, 
STRSIZE
(25));

112 
	g_´suµ
->
g‘_v®ue
(2, 
_suµl›r
.
S_ADDRESS
, 
STRSIZE
(25));

113 
	g_´suµ
->
g‘_v®ue
(3, 
_suµl›r
.
S_CITY
, 
STRSIZE
(10));

114 
	g_´suµ
->
g‘_v®ue
(4, 
_suµl›r
.
S_NATION
, 
STRSIZE
(15));

115 
	g_´suµ
->
g‘_v®ue
(5, 
_suµl›r
.
S_REGION
, 
STRSIZE
(12));

116 
	g_´suµ
->
g‘_v®ue
(6, 
_suµl›r
.
S_PHONE
, 
STRSIZE
(15));

118 
TRACE
(
TRACE_RECORD_FLOW
, "%d|%s --d\n",

119 
_suµl›r
.
S_SUPPKEY
,

120 
_suµl›r
.
S_NAME
);

122 
memıy
(
de¡
, &
_suµl›r
, (_supplier));

125 
suµl›r_tsÿn_f‹r_t
* 
şÚe
() const {

126  
Ãw
 
suµl›r_tsÿn_f‹r_t
(*
this
);

129 
c_¡r
 
to_¡ršg
() const {

130  
c_¡r
("supplier_tscan_filter_t()");

134 
	gqsuµl›r_couÁ_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

136 şas 
	ccouÁ_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

137 
public
:

139 
couÁ_key_exŒaùÜ_t
()

140 : 
key_exŒaùÜ_t
(0, 0) {

146 
vœtu®
 
key_exŒaùÜ_t
* 
şÚe
() const {

147  
Ãw
 
couÁ_key_exŒaùÜ_t
(*
this
);

151 
couÁ_key_exŒaùÜ_t
 
	g_exŒaùÜ
;

153 
qsuµl›r_couÁ_agg»g©e_t
()

154 : 
tu¶e_agg»g©e_t
( (
couÁ_tu¶e
)) {

158 
vœtu®
 
key_exŒaùÜ_t
 * 
key_exŒaùÜ
() {

159  &
_exŒaùÜ
;

162 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &) {

163 
couÁ_tu¶e
* 
	gagg
 = 
®igÃd_ÿ¡
<couÁ_tu¶> (
agg_d©a
);

164 
	gagg
->
	gCOUNT
++;

167 
vœtu®
 
fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

168 
couÁ_tu¶e
* 
	gagg
 = 
®igÃd_ÿ¡
<couÁ_tu¶> (
agg_d©a
);

169 
couÁ_tu¶e
* 
	gouut
 = 
®igÃd_ÿ¡
<couÁ_tu¶> (
d
.
d©a
);

170 
	gouut
->
	gCOUNT
 = 
agg
->
COUNT
;

173 
vœtu®
 
qsuµl›r_couÁ_agg»g©e_t
 * 
şÚe
() const {

174  
Ãw
 
qsuµl›r_couÁ_agg»g©e_t
(*
this
);

177 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

182 cÚ¡ 
c_¡r
* 
	$dump_tu¶e
(
tu¶e_t
* 
tup
) {

183 
qsuµl›r_suµl›r_tu¶e
 *
de¡
;

184 
de¡
 = 
®igÃd_ÿ¡
<
qsuµl›r_suµl›r_tu¶e
>(
tup
->
d©a
);

185  
Ãw
 
	`c_¡r
("%d|%s|%s|%s|%s|%s|%s|\n",

186 
de¡
->
S_SUPPKEY
,

187 
de¡
->
S_NAME
,

188 
de¡
->
S_ADDRESS
,

189 
de¡
->
S_CITY
,

190 
de¡
->
S_NATION
,

191 
de¡
->
S_REGION
,

192 
de¡
->
S_PHONE
);

193 
	}
}

197 şas 
	cssb_qsuµl›r_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t
 {

198 
public
:

200 
	$begš
() {

201 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** qsupplier ANSWER ...\n");

202 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** qsupplier COUNT...\n");

205 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

206 
ssb_qsuµl›r
::
couÁ_tu¶e
 *
tu¶e
;

207 
tu¶e
 = 
®igÃd_ÿ¡
<
ssb_qsuµl›r
::
couÁ_tu¶e
 > (
ouut
.
d©a
);

208 
	`TRACE
(
TRACE_QUERY_RESULTS
, "%d\n",

209 
tu¶e
->
COUNT
);

210 
	}
}

219 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_qpe_qsuµl›r
(cÚ¡ 
xù_id
,

220 
qsuµl›r_šput_t
& 
š
) {

221 
	`TRACE
(
TRACE_ALWAYS
, "********** qsupplier *********\n");

224 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

225 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

229 
tu¶e_fifo
* 
tsÿn_out_bufãr
 =

230 
Ãw
 
	`tu¶e_fifo
( (
ssb_qsuµl›r
::
qsuµl›r_suµl›r_tu¶e
));

231 
tsÿn_·ck‘_t
* 
suµl›r_tsÿn_·ck‘
 =

232 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN SUPPLIER",

233 
tsÿn_out_bufãr
,

234 
Ãw
 
ssb_qsuµl›r
::
	`suµl›r_tsÿn_f‹r_t
(
this
, 
š
),

235 
this
->
	`db
(),

236 
_psuµl›r_desc
.
	`g‘
(),

237 
pxù


241 
tu¶e_fifo
* 
fdump_ouut
 = 
Ãw
 
	`tu¶e_fifo
( (
ssb_qsuµl›r
::
qsuµl›r_suµl›r_tu¶e
));

242 
fdump_·ck‘_t
* 
fdump_·ck‘
 =

243 
Ãw
 
	`fdump_·ck‘_t
(
	`c_¡r
("FDUMP"),

244 
fdump_ouut
,

245 
Ãw
 
	`ŒivŸl_f‹r_t
(
fdump_ouut
->
	`tu¶e_size
()),

246 
NULL
,

247 
	`c_¡r
("%s/suµl›rs.tbl", 
	`g‘’v
("HOME")),

248 
NULL
,

249 
suµl›r_tsÿn_·ck‘
,

250 
ssb_qsuµl›r
::
dump_tu¶e
);

252 
tu¶e_fifo
* 
agg_ouut
 = 
Ãw
 
	`tu¶e_fifo
( (
ssb_qsuµl›r
::
couÁ_tu¶e
));

253 
agg»g©e_·ck‘_t
* 
agg_·ck‘
 =

254 
Ãw
 
	`agg»g©e_·ck‘_t
(
	`c_¡r
("COUNT_AGGREGATE"),

255 
agg_ouut
,

256 
Ãw
 
	`ŒivŸl_f‹r_t
(
agg_ouut
->
	`tu¶e_size
()),

257 
Ãw
 
ssb_qsuµl›r
::
	`qsuµl›r_couÁ_agg»g©e_t
(),

258 
Ãw
 
ssb_qsuµl›r
::
qsuµl›r_couÁ_agg»g©e_t
::
	`couÁ_key_exŒaùÜ_t
(),

259 
fdump_·ck‘
);

261 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

262 
suµl›r_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

263 
fdump_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

264 
agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

267 
ssb_qsuµl›r_´oûss_tu¶e_t
 
±
;

268 
	`´oûss_qu”y
(
agg_·ck‘
, 
±
);

269 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

271  (
RCOK
);

272 
	}
}

275 
EXIT_NAMESPACE
(
ssb
);

	@src/workload/ssb/qpipe/qpipe_qtest.cpp

34 
	~"wÜklßd/ssb/shÜe_ssb_’v.h
"

35 
	~"qpe.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
usšg
 
Çme¥aû
 
	gqpe
;

40 
ENTER_NAMESPACE
(
ssb
);

54 
	sq‹¡_lo_tu¶e


56 
	mLO_ORDERKEY
;

57 
	mLO_LINENUMBER
;

58 
	mLO_ORDERDATE
;

59 
	mLO_REVENUE
;

63 
	sq‹¡_d_tu¶e


65 
	mD_DATEKEY
;

66 
	mD_YEAR
;

67 
	mD_DAYNUMINWEEK
;

68 
	mD_DATE
 [
STRSIZE
(18)];

72 
	sq‹¡_još_d_tu¶e


74 
	mLO_ORDERKEY
;

75 
	mLO_LINENUMBER
;

76 
	mLO_ORDERDATE
;

77 
	mD_DATEKEY
;

78 
	mD_DATE
 [
STRSIZE
(18)];

79 
	mLO_REVENUE
;

83 
q‹¡_još_d_tu¶e
 
	t´ojeùed_tu¶e
;

89 şas 
	cq‹¡_lšeÜd”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


91 
´iv©e
:

92 
ShÜeSSBEnv
* 
_ssbdb
;

93 
bË_row_t
* 
	m_´lše
;

94 
»p_row_t
 
	m_¼
;

96 
ssb_lšeÜd”_tu¶e
 
	m_lšeÜd”
;

98 
	mpublic
:

100 
	$q‹¡_lšeÜd”_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
)

101 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

103 
_´lše
 = 
_ssbdb
->
	`lšeÜd”_mª
()->
	`g‘_tu¶e
();

104 
_¼
.
	`£t_ts
(
_ssbdb
->
	`lšeÜd”_mª
()->
	`ts
(),

105 
_ssbdb
->
	`lšeÜd”_desc
()->
	`maxsize
());

106 
_´lše
->
_»p
 = &
_¼
;

109 ~
	$q‹¡_lšeÜd”_tsÿn_f‹r_t
()

111 
_ssbdb
->
	`lšeÜd”_mª
()->
	`give_tu¶e
(
_´lše
);

112 
	}
}

114 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

115 ià(!
_ssbdb
->
	`lšeÜd”_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

116 
	`as£¹
(
çl£
);

120  (
Œue
);

121 
	}
}

123 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

124 
q‹¡_lo_tu¶e
 *
de¡
;

125 
de¡
 = 
®igÃd_ÿ¡
<
q‹¡_lo_tu¶e
>(
d
.
d©a
);

127 
_´lše
->
	`g‘_v®ue
(0, 
_lšeÜd”
.
LO_ORDERKEY
);

128 
_´lše
->
	`g‘_v®ue
(1, 
_lšeÜd”
.
LO_LINENUMBER
);

129 
_´lše
->
	`g‘_v®ue
(5, 
_lšeÜd”
.
LO_ORDERDATE
);

130 
_´lše
->
	`g‘_v®ue
(12, 
_lšeÜd”
.
LO_REVENUE
);

132 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%d|%d|%d|%d --d\n",

133 
_lšeÜd”
.
LO_ORDERKEY
,

134 
_lšeÜd”
.
LO_LINENUMBER
,

135 
_lšeÜd”
.
LO_ORDERDATE
,

136 
_lšeÜd”
.
LO_REVENUE
);

138 
de¡
->
LO_ORDERKEY
 = 
_lšeÜd”
.LO_ORDERKEY;

139 
de¡
->
LO_LINENUMBER
 = 
_lšeÜd”
.LO_LINENUMBER;

140 
de¡
->
LO_ORDERDATE
 = 
_lšeÜd”
.LO_ORDERDATE;

141 
de¡
->
LO_REVENUE
 = 
_lšeÜd”
.LO_REVENUE;

142 
	}
}

144 
q‹¡_lšeÜd”_tsÿn_f‹r_t
* 
	$şÚe
() const {

145  
Ãw
 
	`q‹¡_lšeÜd”_tsÿn_f‹r_t
(*
this
);

146 
	}
}

148 
c_¡r
 
	$to_¡ršg
() const {

149  
	`c_¡r
("qtest_lineorder_tscan_filter_t()");

150 
	}
}

157 şas 
	cq‹¡_d©e_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


159 
´iv©e
:

160 
ShÜeSSBEnv
* 
_ssbdb
;

161 
bË_row_t
* 
	m_´d©e
;

162 
»p_row_t
 
	m_¼
;

164 
ssb_d©e_tu¶e
 
	m_d©e
;

166 
	mpublic
:

168 
	$q‹¡_d©e_tsÿn_f‹r_t
(
ShÜeSSBEnv
* 
ssbdb
, 
q‹¡_šput_t
 &
š
)

169 : 
	`tu¶e_f‹r_t
(
ssbdb
->
	`d©e_desc
()->
	`maxsize
()), 
	$_ssbdb
(
ssbdb
)

171 
_´d©e
 = 
_ssbdb
->
	`d©e_mª
()->
	`g‘_tu¶e
();

172 
_¼
.
	`£t_ts
(
_ssbdb
->
	`d©e_mª
()->
	`ts
(),

173 
_ssbdb
->
	`d©e_desc
()->
	`maxsize
());

174 
_´d©e
->
_»p
 = &
_¼
;

177 ~
	$q‹¡_d©e_tsÿn_f‹r_t
()

179 
_ssbdb
->
	`d©e_mª
()->
	`give_tu¶e
(
_´d©e
);

180 
	}
}

182 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

183 ià(!
_ssbdb
->
	`d©e_mª
()->
	`lßd
(
_´d©e
, 
šput
.
d©a
)) {

184 
	`as£¹
(
çl£
);

188  
Œue
;

189 
	}
}

191 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

192 
q‹¡_d_tu¶e
 *
de¡
;

193 
de¡
 = 
®igÃd_ÿ¡
<
q‹¡_d_tu¶e
>(
d
.
d©a
);

195 
_´d©e
->
	`g‘_v®ue
(0, 
_d©e
.
D_DATEKEY
);

196 
_´d©e
->
	`g‘_v®ue
(1, 
_d©e
.
D_DATE
, 
	`STRSIZE
(18));

197 
_´d©e
->
	`g‘_v®ue
(4, 
_d©e
.
D_YEAR
);

198 
_´d©e
->
	`g‘_v®ue
(7, 
_d©e
.
D_DAYNUMINWEEK
);

200 
	`TRACE
Ğ
TRACE_RECORD_FLOW
, "%s|%d|%d|%d --d\n",

201 
_d©e
.
D_DATE
,

202 
_d©e
.
D_DATEKEY
,

203 
_d©e
.
D_YEAR
,

204 
_d©e
.
D_DAYNUMINWEEK
);

206 
de¡
->
D_DATEKEY
 = 
_d©e
.D_DATEKEY;

207 
	`¡rıy
(
de¡
->
D_DATE
,
_d©e
.D_DATE);

208 
de¡
->
D_YEAR
=
_d©e
.D_YEAR;

209 
de¡
->
D_DAYNUMINWEEK
=
_d©e
.D_DAYNUMINWEEK;

210 
	}
}

212 
q‹¡_d©e_tsÿn_f‹r_t
* 
	$şÚe
() const {

213  
Ãw
 
	`q‹¡_d©e_tsÿn_f‹r_t
(*
this
);

214 
	}
}

216 
c_¡r
 
	$to_¡ršg
() const {

217  
	`c_¡r
("qtest_date_tscan_filter_t()");

218 
	}
}

225 
	gq‹¡_d©e_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t


227 
q‹¡_d©e_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
((
q‹¡_d_tu¶e
), 0) { }

229 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
tu¶e_d©a
) const {

230 
q‹¡_d_tu¶e
* 
	gtu¶e
 = 
®igÃd_ÿ¡
<q‹¡_d_tu¶e>(
tu¶e_d©a
);

231  
	gtu¶e
->
	gD_DATEKEY
;

234 
vœtu®
 
q‹¡_d©e_key_exŒaùÜ_t
* 
şÚe
() const {

235  
Ãw
 
q‹¡_d©e_key_exŒaùÜ_t
(*
this
);

239 
	gq‹¡_d©e_key_com·»_t
 : 
public
 
key_com·»_t


241 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

242 
q‹¡_d_tu¶e
* 
	ga
 = 
®igÃd_ÿ¡
<q‹¡_d_tu¶e>(
key1
);

243 
q‹¡_d_tu¶e
* 
	gb
 = 
®igÃd_ÿ¡
<q‹¡_d_tu¶e>(
key2
);

245  
	ga
->
	gD_DATEKEY
 - 
	gb
->D_DATEKEY;

247 
vœtu®
 
q‹¡_d©e_key_com·»_t
* 
şÚe
() const {

248  
Ãw
 
q‹¡_d©e_key_com·»_t
(*
this
);

256 
	gq‹¡_lo_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t


258 
q‹¡_lo_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
((
q‹¡_lo_tu¶e
), 0) { }

260 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
tu¶e_d©a
) const {

261 
q‹¡_lo_tu¶e
* 
	gtu¶e
 = 
®igÃd_ÿ¡
<q‹¡_lo_tu¶e>(
tu¶e_d©a
);

262  
	gtu¶e
->
	gLO_ORDERDATE
;

265 
vœtu®
 
q‹¡_lo_key_exŒaùÜ_t
* 
şÚe
() const {

266  
Ãw
 
q‹¡_lo_key_exŒaùÜ_t
(*
this
);

270 
	gq‹¡_lo_key_com·»_t
 : 
public
 
key_com·»_t


272 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

273 
q‹¡_lo_tu¶e
* 
	ga
 = 
®igÃd_ÿ¡
<q‹¡_lo_tu¶e>(
key1
);

274 
q‹¡_lo_tu¶e
* 
	gb
 = 
®igÃd_ÿ¡
<q‹¡_lo_tu¶e>(
key2
);

276  
	ga
->
	gLO_ORDERDATE
 - 
	gb
->LO_ORDERDATE;

278 
vœtu®
 
q‹¡_lo_key_com·»_t
* 
şÚe
() const {

279  
Ãw
 
q‹¡_lo_key_com·»_t
(*
this
);

290 
	gq‹¡_lo_d_još_t
 : 
public
 
tu¶e_još_t
 {

292 
q‹¡_lo_d_još_t
 ()

293 : 
tu¶e_još_t
((
q‹¡_lo_tu¶e
),

294 
off£tof
(
q‹¡_lo_tu¶e
, 
LO_ORDERDATE
),

295 (
q‹¡_d_tu¶e
),

296 
off£tof
(
q‹¡_d_tu¶e
, 
D_DATEKEY
),

298 (
q‹¡_još_d_tu¶e
))

301 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

302 cÚ¡ 
tu¶e_t
 &
Ëá
,

303 cÚ¡ 
tu¶e_t
 &
right
)

305 
q‹¡_lo_tu¶e
* 
	glo
 = 
®igÃd_ÿ¡
<q‹¡_lo_tu¶e>(
Ëá
.
d©a
);

306 
q‹¡_d_tu¶e
* 
	gd
 = 
®igÃd_ÿ¡
<q‹¡_d_tu¶e>(
right
.
d©a
);

307 
q‹¡_još_d_tu¶e
* 
	g»t
 = 
®igÃd_ÿ¡
<q‹¡_još_d_tu¶e>(
de¡
.
d©a
);

309 
¡rıy
(
»t
->
D_DATE
, 
d
->D_DATE);

310 
	g»t
->
	gD_DATEKEY
 = 
d
->
D_DATEKEY
;

311 
	g»t
->
	gLO_ORDERDATE
 = 
lo
->
LO_ORDERDATE
;

312 
	g»t
->
	gLO_ORDERKEY
 = 
lo
->
LO_ORDERKEY
;

313 
	g»t
->
	gLO_LINENUMBER
 = 
lo
->
LO_LINENUMBER
;

314 
	g»t
->
	gLO_REVENUE
 = 
lo
->
LO_REVENUE
;

316 
TRACE
 ( 
TRACE_RECORD_FLOW
, "JOIN %d %d %d %d {%s} %d\n",
»t
->
LO_LINENUMBER
,»t->
LO_ORDERKEY
,»t->
LO_ORDERDATE
,„‘->
D_DATEKEY
,„‘->
D_DATE
,„‘->
LO_REVENUE
);

319 
vœtu®
 
q‹¡_lo_d_još_t
* 
şÚe
() const {

320  
Ãw
 
q‹¡_lo_d_još_t
(*
this
);

323 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

330 
	gq‹¡_lo_d_key_com·»_t
 : 
public
 
key_com·»_t


332 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

333 * 
	ga
 = 
®igÃd_ÿ¡
<>(
key1
);

334 * 
	gb
 = 
®igÃd_ÿ¡
<>(
key2
);

336  (*
	ga
è- (*
	gb
);

338 
vœtu®
 
q‹¡_lo_d_key_com·»_t
* 
şÚe
() const {

339  
Ãw
 
q‹¡_lo_d_key_com·»_t
(*
this
);

347 şas 
	cssb_q‹¡_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


349 
public
:

351 
	$begš
() {

352 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** qtest ANSWER ...\n");

353 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** ...\n");

356 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

357 
´ojeùed_tu¶e
 *
tu¶e
;

358 
tu¶e
 = 
®igÃd_ÿ¡
<
´ojeùed_tu¶e
>(
ouut
.
d©a
);

364 
	`TRACE
 ( 
TRACE_QUERY_RESULTS
, "PROCESS %d %d %d %d {%s} %d\n", 
tu¶e
->
LO_LINENUMBER
,u¶e->
LO_ORDERKEY
,u¶e->
LO_ORDERDATE
,u¶e->
D_DATEKEY
,u¶e->
D_DATE
,u¶e->
LO_REVENUE
);

365 
	}
}

375 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_qpe_q‹¡
(cÚ¡ 
xù_id
, 
q‹¡_šput_t
& 
š
) {

376 
	`TRACE
(
TRACE_ALWAYS
, "********** qtest *********\n");

378 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

379 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

382 
tu¶e_fifo
* 
d_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
( (
q‹¡_d_tu¶e
));

383 
tsÿn_·ck‘_t
* 
d_tsÿn_·ck‘
 =

384 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN DATE",

385 
d_out_bufãr
,

386 
Ãw
 
	`q‹¡_d©e_tsÿn_f‹r_t
(
this
, 
š
),

387 
this
->
	`db
(),

388 
_pd©e_desc
.
	`g‘
(),

389 
pxù


394 
tu¶e_fifo
* 
sÜt_d©e_out
 = 
Ãw
 
	`tu¶e_fifo
( (
q‹¡_d_tu¶e
));

395 
·ck‘_t
* 
sÜt_d©e_·ck‘
 =

396 
Ãw
 
	`sÜt_·ck‘_t
("ORDER BY D_DATEKEY",

397 
sÜt_d©e_out
,

398 
Ãw
 
	`ŒivŸl_f‹r_t
( (
q‹¡_d_tu¶e
)),

399 
Ãw
 
	`q‹¡_d©e_key_exŒaùÜ_t
(),

400 
Ãw
 
	`q‹¡_d©e_key_com·»_t
(),

401 
d_tsÿn_·ck‘
);

404 
tu¶e_fifo
* 
lo_out_bufãr
 = 
Ãw
 
	`tu¶e_fifo
( (
q‹¡_lo_tu¶e
));

405 
tsÿn_·ck‘_t
* 
lo_tsÿn_·ck‘
 =

406 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN LINEORDER",

407 
lo_out_bufãr
,

408 
Ãw
 
	`q‹¡_lšeÜd”_tsÿn_f‹r_t
(
this
),

409 
this
->
	`db
(),

410 
_¶šeÜd”_desc
.
	`g‘
(),

411 
pxù


416 
tu¶e_fifo
* 
sÜt_lo_out
 = 
Ãw
 
	`tu¶e_fifo
( (
q‹¡_lo_tu¶e
));

417 
·ck‘_t
* 
sÜt_lo_·ck‘
 =

418 
Ãw
 
	`sÜt_·ck‘_t
("ORDER BY LO_ORDERDATE",

419 
sÜt_lo_out
,

420 
Ãw
 
	`ŒivŸl_f‹r_t
( (
q‹¡_lo_tu¶e
)),

421 
Ãw
 
	`q‹¡_lo_key_exŒaùÜ_t
(),

422 
Ãw
 
	`q‹¡_lo_key_com·»_t
(),

423 
lo_tsÿn_·ck‘
);

426 
tu¶e_fifo
* 
još_lo_d_out
 = 
Ãw
 
	`tu¶e_fifo
( (
q‹¡_još_d_tu¶e
));

427 
·ck‘_t
* 
još_lo_d_·ck‘
 =

428 
Ãw
 
	`sÜt_m”ge_još_·ck‘_t
("Lineorder - Date JOIN",

429 
još_lo_d_out
,

430 
Ãw
 
	`ŒivŸl_f‹r_t
( (
q‹¡_još_d_tu¶e
)),

431 
sÜt_lo_·ck‘
,

432 
sÜt_d©e_·ck‘
,

433 
Ãw
 
	`q‹¡_lo_d_još_t
(),

434 
Ãw
 
	`q‹¡_lo_d_key_com·»_t
());

436 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

437 
lo_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

438 
d_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

439 
sÜt_d©e_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

440 
sÜt_lo_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

441 
još_lo_d_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

444 
ssb_q‹¡_´oûss_tu¶e_t
 
±
;

446 
	`TRACE
(
TRACE_ALWAYS
, "********** Executing Q TEST *********\n");

448 
	`´oûss_qu”y
(
još_lo_d_·ck‘
, 
±
);

449 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

451  (
RCOK
);

452 
	}
}

455 
EXIT_NAMESPACE
(
ssb
);

	@src/workload/ssb/qpipe_ssb_xct.cpp

32 
	~"wÜklßd/ssb/shÜe_ssb_’v.h
"

33 
	~"qpe/¡ages.h
"

34 
	~"qpe/qcommÚ.h
"

36 
usšg
 
Çme¥aû
 
	gshÜe
;

37 
usšg
 
Çme¥aû
 
	gqpe
;

41 
ENTER_NAMESPACE
(
ssb
);

76 
DEFINE_QPIPE_TRX
(
ShÜeSSBEnv
,
q·¹
);

77 
DEFINE_QPIPE_TRX
(
ShÜeSSBEnv
,
qd©e
);

78 
DEFINE_QPIPE_TRX
(
ShÜeSSBEnv
,
qsuµl›r
);

79 
DEFINE_QPIPE_TRX
(
ShÜeSSBEnv
,
qcu¡om”
);

80 
DEFINE_QPIPE_TRX
(
ShÜeSSBEnv
,
qlšeÜd”
);

81 
DEFINE_QPIPE_TRX
(
ShÜeSSBEnv
,
q1_1
);

82 
DEFINE_QPIPE_TRX
(
ShÜeSSBEnv
,
q1_2
);

83 
DEFINE_QPIPE_TRX
(
ShÜeSSBEnv
,
q1_3
);

84 
DEFINE_QPIPE_TRX
(
ShÜeSSBEnv
,
q2_1
);

85 
DEFINE_QPIPE_TRX
(
ShÜeSSBEnv
,
q2_2
);

86 
DEFINE_QPIPE_TRX
(
ShÜeSSBEnv
,
q2_3
);

87 
DEFINE_QPIPE_TRX
(
ShÜeSSBEnv
,
q3_1
);

88 
DEFINE_QPIPE_TRX
(
ShÜeSSBEnv
,
q3_2
);

89 
DEFINE_QPIPE_TRX
(
ShÜeSSBEnv
,
q3_3
);

90 
DEFINE_QPIPE_TRX
(
ShÜeSSBEnv
,
q3_4
);

91 
DEFINE_QPIPE_TRX
(
ShÜeSSBEnv
,
q4_1
);

92 
DEFINE_QPIPE_TRX
(
ShÜeSSBEnv
,
q4_2
);

93 
DEFINE_QPIPE_TRX
(
ShÜeSSBEnv
,
q4_3
);

104 
w_rc_t
 
	gShÜeSSBEnv
::
	$run_Úe_qpe_xù
(
Reque¡
* 
´eque¡
)

108 
ty³
 = 
´eque¡
->
	`ty³
();

109 
	`as£¹
 (
ty³
 >ğ
XCT_QPIPE_SSB_MIX
);

110 ià(
ty³
 =ğ
XCT_QPIPE_SSB_MIX
) {

111 
ty³
 = 
	`abs
(
smth»ad_t
::
	`me
()->
	`¿nd
()%22);

115 
ty³
 -ğ(
XCT_QPIPE_SSB_MIX
 - 
XCT_SSB_MIX
);

118 
ty³
) {

121 
XCT_SSB_QDATE
:

122  (
	`run_qpe_qd©e
(
´eque¡
));

124 
XCT_SSB_QPART
:

125  (
	`run_qpe_q·¹
(
´eque¡
));

127 
XCT_SSB_QSUPPLIER
:

128  (
	`run_qpe_qsuµl›r
(
´eque¡
));

130 
XCT_SSB_QCUSTOMER
:

131  (
	`run_qpe_qcu¡om”
(
´eque¡
));

133 
XCT_SSB_QLINEORDER
:

134  (
	`run_qpe_qlšeÜd”
(
´eque¡
));

136 
XCT_SSB_Q1_1
:

137  (
	`run_qpe_q1_1
(
´eque¡
));

139 
XCT_SSB_Q1_2
:

140  (
	`run_qpe_q1_2
(
´eque¡
));

142 
XCT_SSB_Q1_3
:

143  (
	`run_qpe_q1_3
(
´eque¡
));

145 
XCT_SSB_Q2_1
:

146  (
	`run_qpe_q2_1
(
´eque¡
));

148 
XCT_SSB_Q2_2
:

149  (
	`run_qpe_q2_2
(
´eque¡
));

151 
XCT_SSB_Q2_3
:

152  (
	`run_qpe_q2_3
(
´eque¡
));

154 
XCT_SSB_Q3_1
:

155  (
	`run_qpe_q3_1
(
´eque¡
));

157 
XCT_SSB_Q3_2
:

158  (
	`run_qpe_q3_2
(
´eque¡
));

160 
XCT_SSB_Q3_3
:

161  (
	`run_qpe_q3_3
(
´eque¡
));

163 
XCT_SSB_Q3_4
:

164  (
	`run_qpe_q3_4
(
´eque¡
));

166 
XCT_SSB_Q4_1
:

167  (
	`run_qpe_q4_1
(
´eque¡
));

169 
XCT_SSB_Q4_2
:

170  (
	`run_qpe_q4_2
(
´eque¡
));

172 
XCT_SSB_Q4_3
:

173  (
	`run_qpe_q4_3
(
´eque¡
));

177 
	`TRACE
Ğ
TRACE_ALWAYS
, "Unknownransaction\n");

179  (
RCOK
);

180 
	}
}

187 
EXIT_NAMESPACE
(
qpe
);

	@src/workload/ssb/shore_ssb_client.cpp

31 
	~"wÜklßd/ssb/shÜe_ssb_ş›Á.h
"

33 
ENTER_NAMESPACE
(
ssb
);

42 
	gba£lše_ssb_ş›Á_t
::
	$ba£lše_ssb_ş›Á_t
(
c_¡r
 
Šame
, cÚ¡ 
id
,

43 
ShÜeSSBEnv
* 
’v
,

44 cÚ¡ 
M—su»m’tTy³
 
aTy³
,

45 cÚ¡ 
Œxid
,

46 cÚ¡ 
numOfTrxs
,

47 
´oûssÜid_t
 
­rsid
,

48 cÚ¡ 
£lID
, cÚ¡ 
qf
)

49 : 
	`ba£_ş›Á_t
(
Šame
,
id
,
’v
,
aTy³
,
Œxid
,
numOfTrxs
,
­rsid
),

50 
	`_£lid
(
£lID
), 
	$_qf
(
qf
)

52 
	`as£¹
 (
’v
);

53 
	`as£¹
 (
_id
>=0 && 
_qf
>0);

56 
_wÜk”
 = 
_’v
->
	`wÜk”
(
_id
);

57 
	`as£¹
 (
_wÜk”
);

58 
	}
}

60 
	gba£lše_ssb_ş›Á_t
::
	$lßd_sup_xù
(
m­SupTrxs
& 
¡m­
)

63 
¡m­
.
	`ş—r
();

66 
¡m­
[
XCT_SSB_MIX
] = "SSB-Mix";

83 #ifdeà
CFG_QPIPE


85 
¡m­
[
XCT_QPIPE_SSB_MIX
] = "QPIPE-SSB-MIX";

87 
ušt
 
qpeba£
 = 
XCT_QPIPE_SSB_MIX
 - 
XCT_SSB_MIX
;

89 
¡m­
[
qpeba£
 + 
XCT_SSB_Q1_1
] = "QPIPE-SSB-Q1_1";

90 
¡m­
[
qpeba£
 + 
XCT_SSB_Q1_2
] = "QPIPE-SSB-Q1_2";

91 
¡m­
[
qpeba£
 + 
XCT_SSB_Q1_3
] = "QPIPE-SSB-Q1_3";

92 
¡m­
[
qpeba£
 + 
XCT_SSB_Q2_1
] = "QPIPE-SSB-Q2_1";

93 
¡m­
[
qpeba£
 + 
XCT_SSB_Q2_2
] = "QPIPE-SSB-Q2_2";

94 
¡m­
[
qpeba£
 + 
XCT_SSB_Q2_3
] = "QPIPE-SSB-Q2_3";

95 
¡m­
[
qpeba£
 + 
XCT_SSB_Q3_1
] = "QPIPE-SSB-Q3_1";

96 
¡m­
[
qpeba£
 + 
XCT_SSB_Q3_2
] = "QPIPE-SSB-Q3_2";

97 
¡m­
[
qpeba£
 + 
XCT_SSB_Q3_3
] = "QPIPE-SSB-Q3_3";

98 
¡m­
[
qpeba£
 + 
XCT_SSB_Q3_4
] = "QPIPE-SSB-Q3_4";

99 
¡m­
[
qpeba£
 + 
XCT_SSB_Q4_1
] = "QPIPE-SSB-Q4_1";

100 
¡m­
[
qpeba£
 + 
XCT_SSB_Q4_2
] = "QPIPE-SSB-Q4_2";

101 
¡m­
[
qpeba£
 + 
XCT_SSB_Q4_3
] = "QPIPE-SSB-Q4_3";

102 
¡m­
[
qpeba£
 + 
XCT_SSB_QPART
] = "QPIPE-SSB-QPART";

103 
¡m­
[
qpeba£
 + 
XCT_SSB_QDATE
] = "QPIPE-SSB-QDATE";

104 
¡m­
[
qpeba£
 + 
XCT_SSB_QSUPPLIER
] = "QPIPE-SSB-QSUPPLIER";

105 
¡m­
[
qpeba£
 + 
XCT_SSB_QCUSTOMER
] = "QPIPE-SSB-QCUSTOMER";

106 
¡m­
[
qpeba£
 + 
XCT_SSB_QLINEORDER
] = "QPIPE-SSB-QLINEORDER";

112  (
¡m­
.
	`size
());

113 
	}
}

127 
w_rc_t
 
	gba£lše_ssb_ş›Á_t
::
	$subm™_Úe
(
xù_ty³
, 
xùid
)

130 
Œx_»suÉ_tu¶e_t
 
©¹
;

131 
boŞ
 
bWake
 = 
çl£
;

132 ià(
cÚdex
* 
c
 = 
_ı
->
	`ke_Úe
()) {

133 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Sleeping\n");

134 
©¹
.
	`£t_nÙify
(
c
);

135 
bWake
 = 
Œue
;

139 
£lid
 = 
_£lid
;

144 
Œx_»que¡_t
* 
¬eque¡
 = 
	`Ãw
 (
_’v
->
_»que¡_poŞ
)rx_request_t;

145 
tid_t
 
©id
;

146 
¬eque¡
->
	`£t
(
NULL
,
©id
,
xùid
,
©¹
,
xù_ty³
,
£lid
);

149 
	`as£¹
 (
_wÜk”
);

150 
_wÜk”
->
	`’queue
(
¬eque¡
,
bWake
);

151  (
RCOK
);

152 
	}
}

155 
EXIT_NAMESPACE
(
ssb
);

	@src/workload/ssb/shore_ssb_env.cpp

31 
	~"wÜklßd/ssb/shÜe_ssb_’v.h
"

32 
	~"sm/shÜe/shÜe_h–³r_lßd”.h
"

34 
	~"wÜklßd/ssb/ssb_¿ndom.h
"

36 
	~"wÜklßd/ssb/dbg’/dss.h
"

37 
	~"wÜklßd/ssb/dbg’/ds¡y³s.h
"

40 
usšg
 
Çme¥aû
 
	gshÜe
;

41 
usšg
 
Çme¥aû
 
	gdbg’ssb
;

44 
ENTER_NAMESPACE
(
shÜe
);

45 
DEFINE_ROW_CACHE_TLS
(
ssb
, 
·¹
);

46 
DEFINE_ROW_CACHE_TLS
(
ssb
, 
suµl›r
);

47 
DEFINE_ROW_CACHE_TLS
(
ssb
, 
d©e
);

48 
DEFINE_ROW_CACHE_TLS
(
ssb
, 
cu¡om”
);

49 
DEFINE_ROW_CACHE_TLS
(
ssb
, 
lšeÜd”
);

50 
EXIT_NAMESPACE
(
shÜe
);

53 
ENTER_NAMESPACE
(
ssb
);

72 cÚ¡ 
	gDIVISOR
 = 50;

75 cÚ¡ 
	gLINEORDER_COUNT
 = 10000;

77 cÚ¡ 
	gLINEORDER_UNIT_PER_SF
 = 
LINEORDER_PER_SF
;

79 
	gShÜeSSBEnv
::
checkpoš‹r_t
 : 
public
 
th»ad_t


81 
ShÜeSSBEnv
* 
_’v
;

82 
checkpoš‹r_t
(
ShÜeSSBEnv
* 
’v
)

83 : 
th»ad_t
("SSB Lßd Checkpoš‹r"), 
_’v
(
’v
) { }

84 
vœtu®
 
wÜk
();

87 şas 
	cShÜeSSBEnv
::
bË_bud”_t
 : 
public
 
th»ad_t


89 
ShÜeSSBEnv
* 
_’v
;

90 
	m_lšeÜd”_¡¬t
;

91 
	m_lšeÜd”_’d
;

92 
	m_sf
;

94 
	mpublic
:

95 
	$bË_bud”_t
(
ShÜeSSBEnv
* 
’v
, cÚ¡ 
id
,

96 cÚ¡ 
lšeÜd”_¡¬t
, cÚ¡ 
lšeÜd”_’d
,

97 cÚ¡ 
sf
)

98 : 
	`th»ad_t
(
	`c_¡r
("SSB L-%d",
id
)), 
	`_’v
(
’v
),

99 
	`_lšeÜd”_¡¬t
(
lšeÜd”_¡¬t
), 
	`_lšeÜd”_’d
(
lšeÜd”_’d
),

100 
	$_sf
(
sf
)

102 
vœtu®
 
	`wÜk
();

103 
	}
};

105 
	gShÜeSSBEnv
::
bË_ü—tÜ_t
 : 
public
 
th»ad_t


107 
ShÜeSSBEnv
* 
_’v
;

108 
	g_sf
;

109 
	g_lßd”_couÁ
;

110 
	g_lšeÜd”_³r_th»ad
;

114 
bË_ü—tÜ_t
(
ShÜeSSBEnv
* 
’v
, cÚ¡ 
sf
, cÚ¡ 
lßd”_couÁ
,

115 cÚ¡ 
lšeÜd”_³r_th»ad
)

116 : 
th»ad_t
("SSB C"),

117 
_’v
(
’v
), 
_sf
(
sf
),

118 
_lßd”_couÁ
(
lßd”_couÁ
),

119 
_lšeÜd”_³r_th»ad
(
lšeÜd”_³r_th»ad
)

121 
vœtu®
 
wÜk
();

125 
	gShÜeSSBEnv
::
checkpoš‹r_t
::
	$wÜk
()

127 
boŞ
 vŞ©e* 
lßded
 = &
_’v
->
_lßded
;

128 !*
lßded
) {

129 
_’v
->
	`£t_m—su»
(
MST_MEASURE
);

130 
i
=0; i < 60 && ! *
lßded
; i++) {

131 ::
	`¦“p
(1);

134 
	`TRACE
Ğ
TRACE_ALWAYS
, "db checkpoint - start\n");

135 
_’v
->
	`checkpošt
();

136 
	`TRACE
Ğ
TRACE_ALWAYS
, "db checkpoint -ƒnd\n");

138 
_’v
->
	`£t_m—su»
(
MST_PAUSE
);

139 
	}
}

142 
	gShÜeSSBEnv
::
bË_ü—tÜ_t
::
	$wÜk
()

153 
	`W_COERCE
(
_’v
->
	`db
()->
	`begš_xù
());

154 
	`W_COERCE
(
_’v
->
_µ¬t_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

155 
	`W_COERCE
(
_’v
->
_psuµl›r_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

156 
	`W_COERCE
(
_’v
->
_pd©e_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

157 
	`W_COERCE
(
_’v
->
_pcu¡om”_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

158 
	`W_COERCE
(
_’v
->
_¶šeÜd”_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

159 
	`W_COERCE
(
_’v
->
	`db
()->
	`comm™_xù
());

162 
_’v
->
_µ¬t_mª
->
	`»gi¡”_bË_mª
();

163 
_’v
->
_psuµl›r_mª
->
	`»gi¡”_bË_mª
();

164 
_’v
->
_pd©e_mª
->
	`»gi¡”_bË_mª
();

165 
_’v
->
_pcu¡om”_mª
->
	`»gi¡”_bË_mª
();

166 
_’v
->
_¶šeÜd”_mª
->
	`»gi¡”_bË_mª
();

171 
pİuÏ‹_ba£lše_šput_t
 
š
 = {
_sf
, 
_lßd”_couÁ
, 
DIVISOR
,

172 
_lšeÜd”_³r_th»ad
};

174 
w_rc_t
 
e
 = 
RCOK
;

176 
log_¥aû_Ãeded
 = 0;

177 
»Œyba£lše
:

178 
	`W_COERCE
(
_’v
->
	`db
()->
	`begš_xù
());

179 #ifdeà
USE_SHORE_6


180 if(
log_¥aû_Ãeded
 > 0) {

181 
	`W_COERCE
(
_’v
->
	`db
()->
	`xù_»£rve_log_¥aû
(
log_¥aû_Ãeded
));

184 
e
 = 
_’v
->
	`xù_pİuÏ‹_ba£lše
(0, 
š
);

186 
	`CHECK_XCT_RETURN
(
e
,
log_¥aû_Ãeded
,
»Œyba£lše
,
_’v
);

188 
	`W_COERCE
(
_’v
->
	`db
()->
	`begš_xù
());

189 
	`W_COERCE
(
_’v
->
	`_po¡_š™_im¶
());

190 
	`W_COERCE
(
_’v
->
	`db
()->
	`comm™_xù
());

191 
	}
}

196 
	glo_com¶‘ed
 = 0;

198 
	gShÜeSSBEnv
::
bË_bud”_t
::
	$wÜk
()

200 
w_rc_t
 
e
 = 
RCOK
;

203 
i
=
_lšeÜd”_¡¬t
 ; i < 
_lšeÜd”_’d
; i+=
LO_POP_UNIT
) {

204 
_’v
->
	`g‘_m—su»
(è!ğ
MST_MEASURE
) {

205 
	`u¦“p
(1000);

208 
oid
 = 
i
;

209 
pİuÏ‹_some_lšeÜd”s_šput_t
 
š
 = {
oid
};

211 
oid
 = 
¡d
::
	`mš
(
_lšeÜd”_’d
-
i
,
LO_POP_UNIT
);

213 
log_¥aû_Ãeded
 = 0;

214 
»Œy·¹
:

215 
	`W_COERCE
(
_’v
->
	`db
()->
	`begš_xù
());

216 #ifdeà
USE_SHORE_6


217 if(
log_¥aû_Ãeded
 > 0) {

218 
	`W_COERCE
(
_’v
->
	`db
()->
	`xù_»£rve_log_¥aû
(
log_¥aû_Ãeded
));

221 
e
 = 
_’v
->
	`xù_pİuÏ‹_some_lšeÜd”s
(
oid
, 
š
);

223 
	`CHECK_XCT_RETURN
(
e
,
log_¥aû_Ãeded
,
»Œy·¹
,
_’v
);

225 
nv®
 = 
	`©omic_add_64_nv
(&
lo_com¶‘ed
,
oid
);

227 ià(
nv®
 % 
LINEORDER_COUNT
 == 0) {

228 
	`TRACE
Ğ
TRACE_ALWAYS
, "Lineorder %d/%d (%.0f%%)\n",

229 
nv®
, ()(
_sf
*
LINEORDER_UNIT_PER_SF
),

230 ()(100*
nv®
)/()(
_sf
*
LINEORDER_UNIT_PER_SF
));

234 
	`TRACE
Ğ
TRACE_ALWAYS
, "Fšished LšeÜd” %d .. %d \n", 
_lšeÜd”_¡¬t
, 
_lšeÜd”_’d
);

269 
	}
}

280 
	gShÜeSSBEnv
::
	$ShÜeSSBEnv
()

281 : 
	$ShÜeEnv
()

283 
_sÿlšg_çùÜ
 = 
SSB_SCALING_FACTOR
;

285 #ifdeà
CFG_QPIPE


288 
	`£t_sched_pŞicy
(
NULL
);

291 
	`»gi¡”_¡age_cÚš”s
();

293 
	}
}

296 
	gShÜeSSBEnv
::~
	$ShÜeSSBEnv
()

298 
	}
}

302 
w_rc_t
 
ShÜeSSBEnv
::
	$lßd_schema
()

305 
_µ¬t_desc
 = 
Ãw
 
	`·¹_t
(
	`g‘_pd
());

306 
_psuµl›r_desc
 = 
Ãw
 
	`suµl›r_t
(
	`g‘_pd
());

307 
_pd©e_desc
 = 
Ãw
 
	`d©e_t
(
	`g‘_pd
());

308 
_pcu¡om”_desc
 = 
Ãw
 
	`cu¡om”_t
(
	`g‘_pd
());

309 
_¶šeÜd”_desc
 = 
Ãw
 
	`lšeÜd”_t
(
	`g‘_pd
());

312 
_µ¬t_mª
 = 
Ãw
 
	`·¹_mª_im¶
(
_µ¬t_desc
.
	`g‘
());

313 
_psuµl›r_mª
 = 
Ãw
 
	`suµl›r_mª_im¶
(
_psuµl›r_desc
.
	`g‘
());

314 
_pd©e_mª
 = 
Ãw
 
	`d©e_mª_im¶
(
_pd©e_desc
.
	`g‘
());

315 
_pcu¡om”_mª
 = 
Ãw
 
	`cu¡om”_mª_im¶
(
_pcu¡om”_desc
.
	`g‘
());

316 
_¶šeÜd”_mª
 = 
Ãw
 
	`lšeÜd”_mª_im¶
(
_¶šeÜd”_desc
.
	`g‘
());

318  (
RCOK
);

319 
	}
}

322 
w_rc_t
 
	gShÜeSSBEnv
::
	$lßd_ªd_»gi¡”_fids
()

324 
	`W_DO
(
_µ¬t_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

325 
	`W_DO
(
_psuµl›r_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

326 
	`W_DO
(
_pd©e_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

327 
	`W_DO
(
_pcu¡om”_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

328 
	`W_DO
(
_¶šeÜd”_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

329  (
RCOK
);

330 
	}
}

333 #ifdeà
CFG_QPIPE


341 
pŞicy_t
* 
	gShÜeSSBEnv
::
	$g‘_sched_pŞicy
()

343 
	`CRITICAL_SECTION
(
š™_cs
,
_lßd_mu‹x
);

344  (
_sched_pŞicy
.
	`g‘
());

345 
	}
}

347 
pŞicy_t
* 
	gShÜeSSBEnv
::
	$£t_sched_pŞicy
(cÚ¡ * 
¥Şicy
)

349 
	`CRITICAL_SECTION
(
š™_cs
,
_lßd_mu‹x
);

350 ià(
¥Şicy
) {

352 
	`TRACE
Ğ
TRACE_ALWAYS
, "S‘tšg…Şicy (%s)\n", 
¥Şicy
);

354 iàĞ!
	`¡rcmp
(
¥Şicy
, "OS") ) {

355 
_sched_pŞicy
 = 
Ãw
 
	`pŞicy_os_t
();

356  (
_sched_pŞicy
);

359 iàĞ!
	`¡rcmp
(
¥Şicy
, "RR_CPU") ) {

360 
_sched_pŞicy
 = 
Ãw
 
	`pŞicy_¼_ıu_t
();

361  (
_sched_pŞicy
);

364 iàĞ!
	`¡rcmp
(
¥Şicy
, "QUERY_CPU") ) {

365 
_sched_pŞicy
 = 
Ãw
 
	`pŞicy_qu”y_ıu_t
();

366  (
_sched_pŞicy
);

369 iàĞ!
	`¡rcmp
(
¥Şicy
, "RR_MODULE") ) {

370 
_sched_pŞicy
 = 
Ãw
 
	`pŞicy_¼_moduË_t
();

371  (
_sched_pŞicy
);

375 
	`TRACE
Ğ
TRACE_ALWAYS
, "Default scheduling…olicy (OS)\n");

376 
_sched_pŞicy
 = 
Ãw
 
	`pŞicy_os_t
();

377  (
_sched_pŞicy
);

378 
	}
}

391 
	gShÜeSSBEnv
::
	$šfo
() const

393 
	`TRACE
Ğ
TRACE_ALWAYS
, "SF = (%.1f)\n", 
_sÿlšg_çùÜ
);

395 
	}
}

407 
	gShÜeSSBEnv
::
	$¡©i¡ics
()

410 
	}
}

422 
	gShÜeSSBEnv
::
	$¡¬t
()

424  (
ShÜeEnv
::
	`¡¬t
());

425 
	}
}

427 
	gShÜeSSBEnv
::
	$¡İ
()

429  (
ShÜeEnv
::
	`¡İ
());

430 
	}
}

450 
w_rc_t
 
	gShÜeSSBEnv
::
	$lßdd©a
()

453 
	`CRITICAL_SECTION
(
lßd_cs
, 
_lßd_mu‹x
);

454 ià(
_lßded
) {

455 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

457  (
RCOK
);

459 
	`CRITICAL_SECTION
(
sÿË_cs
, 
_sÿlšg_mu‹x
);

462 
	`ssb_dbg’_š™
();

465 
time_t
 
t¡¬t
 = 
	`time
(
NULL
);

475 
lßd”s_to_u£
 = 
’vV¬
::
	`š¡ªû
()->
	`g‘V¬IÁ
("db-loaders",10);

480 
tÙ®_lšeÜd”s
 = 
_sÿlšg_çùÜ
*
LINEORDER_UNIT_PER_SF
;

481 
lšeÜd”s_³r_th»ad
 = 
tÙ®_lšeÜd”s
/
lßd”s_to_u£
;

485 
gu¬d
<
bË_ü—tÜ_t
> 
tc
;

486 
tc
 = 
Ãw
 
	`bË_ü—tÜ_t
(
this
, 
_sÿlšg_çùÜ
, 
lßd”s_to_u£
,

487 
lšeÜd”s_³r_th»ad
);

488 
tc
->
	`fÜk
();

489 
tc
->
	`još
();

493 
gu¬d
<
checkpoš‹r_t
> 
	`chk
(
Ãw
 
	`checkpoš‹r_t
(
this
));

494 
chk
->
	`fÜk
();

497 
	`TRACE
Ğ
TRACE_ALWAYS
, "Fœšg u°%d†ßd” ..\n", 
lßd”s_to_u£
);

498 
¬¿y_gu¬d_t
< 
gu¬d
<
bË_bud”_t
> > 
	`lßd”s
(
Ãw
 gu¬d<bË_bud”_t>[
lßd”s_to_u£
]);

499 
i
=0; i < 
lßd”s_to_u£
; i++) {

500 
lšeÜd”_¡¬t
 = (
i
*
lšeÜd”s_³r_th»ad
è+ 
DIVISOR
 + 1;

501 
lšeÜd”_’d
 = ((
i
+1)*
lšeÜd”s_³r_th»ad
 > 
tÙ®_lšeÜd”s
) ?

502 
tÙ®_lšeÜd”s
 : (
i
+1)*
lšeÜd”s_³r_th»ad
;

503 
	`as£¹
 (
lšeÜd”_¡¬t
 <ğ
lšeÜd”_’d
);

510 
lßd”s
[
i
] = 
Ãw
 
	`bË_bud”_t
(
this
, i,

511 
lšeÜd”_¡¬t
, 
lšeÜd”_’d
,

512 
_sÿlšg_çùÜ
);

513 
lßd”s
[
i
]->
	`fÜk
();

516 
i
=0; i < 
lßd”s_to_u£
; i++) {

517 
lßd”s
[
i
]->
	`još
();

520 
time_t
 
t¡İ
 = 
	`time
(
NULL
);

523 
	`TRACE
Ğ
TRACE_STATISTICS
, "Loading finished. %dables†oaded in (%d) secs...\n",

524 
SHORE_SSB_TABLES
, (
t¡İ
 - 
t¡¬t
));

526 
dbg’ssb
::
	`ä“_asc_d©e
();

529 
_lßded
 = 
Œue
;

530 
chk
->
	`još
();

532  (
RCOK
);

533 
	}
}

545 
w_rc_t
 
	gShÜeSSBEnv
::
	$check_cÚsi¡’cy
()

547  (
RCOK
);

548 
	}
}

560 
w_rc_t
 
	gShÜeSSBEnv
::
	$w¬mup
()

562  (
	`check_cÚsi¡’cy
());

563 
	}
}

574 
	gShÜeSSBEnv
::
	$dump
()

577 
	}
}

580 
	gShÜeSSBEnv
::
	$cÚf
()

583 
ShÜeEnv
::
	`cÚf
();

584 
	`upd_sf
();

586 
	}
}

605 
	gShÜeSSBEnv
::
	$po¡_š™
()

607 
	`cÚf
();

609 
	`W_COERCE
(
	`db
()->
	`begš_xù
());

610 
w_rc_t
 
rc
 = 
	`_po¡_š™_im¶
();

611 if(
rc
.
	`is_”rÜ
()) {

612 
	`db
()->
	`abÜt_xù
();

613  (
rc
.
	`”r_num
());

616 
	`TRACE
Ğ
TRACE_ALWAYS
, "-> Done\n");

617 
	`db
()->
	`comm™_xù
();

620 
	}
}

631 
w_rc_t


632 
	gShÜeSSBEnv
::
	$_po¡_š™_im¶
()

634 
	`TRACE
Ğ
TRACE_DEBUG
, "So far,‚othingo…ad in SSB..\n");

635  (
RCOK
);

636 
	}
}

640 
EXIT_NAMESPACE
(
ssb
);

	@src/workload/ssb/shore_ssb_schema.cpp

65 
	~"wÜklßd/ssb/shÜe_ssb_schema.h
"

67 
usšg
 
Çme¥aû
 
	gshÜe
;

69 
ENTER_NAMESPACE
(
ssb
);

71 
	gsuµl›r_t
::
	$suµl›r_t
(cÚ¡ 
ušt4_t
& 
pd
) :

72 
	`bË_desc_t
("SUPPLIER", 
SSB_SUPPLIER_FCOUNT
, 
pd
)

75 
_desc
[0].
	`£tup
(
SQL_INT
, "S_SUPPKEY");

76 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "S_NAME", 25);

77 
_desc
[2].
	`£tup
(
SQL_FIXCHAR
, "S_ADDRESS", 25);

78 
_desc
[3].
	`£tup
(
SQL_FIXCHAR
, "S_CITY", 10);

79 
_desc
[4].
	`£tup
(
SQL_FIXCHAR
, "S_NATION", 15);

80 
_desc
[5].
	`£tup
(
SQL_FIXCHAR
, "S_REGION", 12);

81 
_desc
[6].
	`£tup
(
SQL_FIXCHAR
, "S_PHONE", 15);

83 
ušt
 
keys
[1] = {0};

86 ià((
pd
 & 
PD_NORMAL
è&& !Õd & 
PD_NOLOCK
)) {

87 
	`TRACE
Ğ
TRACE_DEBUG
, "ReguÏ¸idx fÜ (%s)\n", 
_Çme
);

90 
	`ü—‹_´im¬y_idx_desc
("S_IDX", 0, 
keys
, 1);

92 
	}
}

95 
	g·¹_t
::
	$·¹_t
(cÚ¡ 
ušt4_t
& 
pd
) :

96 
	`bË_desc_t
("PART", 
SSB_PART_FCOUNT
, 
pd
)

99 
_desc
[0].
	`£tup
(
SQL_INT
, "P_PARTKEY");

100 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "P_NAME", 22);

101 
_desc
[2].
	`£tup
(
SQL_FIXCHAR
, "P_MFGR", 6);

102 
_desc
[3].
	`£tup
(
SQL_FIXCHAR
, "P_CATEGORY", 7);

103 
_desc
[4].
	`£tup
(
SQL_FIXCHAR
, "P_BRAND", 9);

104 
_desc
[5].
	`£tup
(
SQL_FIXCHAR
, "P_COLOR", 11);

105 
_desc
[6].
	`£tup
(
SQL_FIXCHAR
, "P_TYPE", 25);

106 
_desc
[7].
	`£tup
(
SQL_INT
, "P_SIZE");

107 
_desc
[8].
	`£tup
(
SQL_FIXCHAR
, "P_CONTAINER", 10);

109 
ušt
 
keys
[1] = { 0 };

111 ià((
pd
 & 
PD_NORMAL
è&& !Õd & 
PD_NOLOCK
)) {

112 
	`TRACE
(
TRACE_DEBUG
, "ReguÏ¸idx fÜ (%s)\n", 
_Çme
);

114 
	`ü—‹_´im¬y_idx_desc
("P_IDX", 0, 
keys
, 1);

116 
	}
}

119 
	gcu¡om”_t
::
	$cu¡om”_t
(cÚ¡ 
ušt4_t
& 
pd
) :

120 
	`bË_desc_t
("CUSTOMER", 
SSB_CUSTOMER_FCOUNT
, 
pd
)

123 
_desc
[0].
	`£tup
(
SQL_INT
, "C_CUSTKEY");

124 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "C_NAME", 25);

125 
_desc
[2].
	`£tup
(
SQL_FIXCHAR
, "C_ADDRESS", 25);

126 
_desc
[3].
	`£tup
(
SQL_FIXCHAR
, "C_CITY", 10);

127 
_desc
[4].
	`£tup
(
SQL_FIXCHAR
, "C_NATION", 15);

128 
_desc
[5].
	`£tup
(
SQL_FIXCHAR
, "C_REGION", 12);

129 
_desc
[6].
	`£tup
(
SQL_FIXCHAR
, "C_PHONE", 15);

130 
_desc
[7].
	`£tup
(
SQL_FIXCHAR
, "C_MKTSEGMENT", 10);

132 
ušt
 
keys
[1] = { 0 };

137 ià((
pd
 & 
PD_NORMAL
è&& !Õd & 
PD_NOLOCK
)) {

138 
	`TRACE
Ğ
TRACE_DEBUG
, "ReguÏ¸idx fÜ (%s)\n", 
_Çme
);

141 
	`ü—‹_´im¬y_idx_desc
("C_IDX", 0, 
keys
, 1);

143 
	}
}

145 
	gd©e_t
::
	$d©e_t
(cÚ¡ 
ušt4_t
& 
pd
) :

146 
	`bË_desc_t
("DATE", 
SSB_DATE_FCOUNT
, 
pd
)

149 
_desc
[0].
	`£tup
(
SQL_INT
, "D_DATEKEY");

150 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "D_DATE", 18);

151 
_desc
[2].
	`£tup
(
SQL_FIXCHAR
, "D_DAYOFWEEK", 10);

152 
_desc
[3].
	`£tup
(
SQL_FIXCHAR
, "D_MONTH", 9);

153 
_desc
[4].
	`£tup
(
SQL_INT
, "D_YEAR");

154 
_desc
[5].
	`£tup
(
SQL_INT
, "D_YEARMONTHNUM");

155 
_desc
[6].
	`£tup
(
SQL_FIXCHAR
, "D_YEARMONTH", 7);

156 
_desc
[7].
	`£tup
(
SQL_INT
, "D_DAYNUMINWEEK");

157 
_desc
[8].
	`£tup
(
SQL_INT
, "D_DATNUMINMONTH");

158 
_desc
[9].
	`£tup
(
SQL_INT
, "D_DATNUMINYEAR");

159 
_desc
[10].
	`£tup
(
SQL_INT
, "D_MONTHNUMINYEAR");

160 
_desc
[11].
	`£tup
(
SQL_INT
, "D_WEEKNUMINYEAR");

161 
_desc
[12].
	`£tup
(
SQL_FIXCHAR
, "D_SELLINGSEASON", 12);

162 
_desc
[13].
	`£tup
(
SQL_FIXCHAR
, "D_LASTDAYINWEEKFL",2);

163 
_desc
[14].
	`£tup
(
SQL_FIXCHAR
, "D_LASTDAYINMONTHFL",2);

164 
_desc
[15].
	`£tup
(
SQL_FIXCHAR
, "D_HOLIDAYFL",2);

165 
_desc
[16].
	`£tup
(
SQL_FIXCHAR
, "D_WEEKDAYFL",2);

167 
ušt
 
keys
[1] = { 0 };

170 ià((
pd
 & 
PD_NORMAL
è&& !Õd & 
PD_NOLOCK
)) {

171 
	`TRACE
Ğ
TRACE_DEBUG
, "ReguÏ¸idx fÜ (%s)\n", 
_Çme
);

174 
	`ü—‹_´im¬y_idx_desc
("D_IDX", 0, 
keys
, 1);

176 
	}
}

183 
	glšeÜd”_t
::
	$lšeÜd”_t
(cÚ¡ 
ušt4_t
& 
pd
) :

184 
	`bË_desc_t
("LINEORDER", 
SSB_LINEORDER_FCOUNT
, 
pd
)

187 
_desc
[0].
	`£tup
(
SQL_INT
, "LO_ORDERKEY");

188 
_desc
[1].
	`£tup
(
SQL_INT
, "LO_LINENUMBER");

189 
_desc
[2].
	`£tup
(
SQL_INT
, "LO_CUSTKEY");

190 
_desc
[3].
	`£tup
(
SQL_INT
, "LO_PARTKEY");

191 
_desc
[4].
	`£tup
(
SQL_INT
, "LO_SUPPKEY");

192 
_desc
[5].
	`£tup
(
SQL_INT
, "LO_ORDERDATE");

193 
_desc
[6].
	`£tup
(
SQL_FIXCHAR
, "LO_ORDERPRIORITY", 15);

194 
_desc
[7].
	`£tup
(
SQL_INT
, "LO_SHIPPRIORITY");

195 
_desc
[8].
	`£tup
(
SQL_INT
, "LO_QUANTITY");

196 
_desc
[9].
	`£tup
(
SQL_INT
, "LO_EXTENDEDPRICE");

197 
_desc
[10].
	`£tup
(
SQL_INT
, "LO_ORDTOTALPRICE");

198 
_desc
[11].
	`£tup
(
SQL_INT
, "LO_DISCOUNT");

199 
_desc
[12].
	`£tup
(
SQL_INT
, "LO_REVENUE");

200 
_desc
[13].
	`£tup
(
SQL_INT
, "LO_SUPPLYCOST");

201 
_desc
[14].
	`£tup
(
SQL_INT
, "LO_TAX");

202 
_desc
[15].
	`£tup
(
SQL_INT
, "LO_COMMITDATE");

203 
_desc
[16].
	`£tup
(
SQL_FIXCHAR
,"LO_SHIPMODE", 10);

205 
ušt
 
keys
[2] = {0, 1};

207 
ušt
 
fkeys1
[1] = { 0 };

210 ià((
pd
 & 
PD_NORMAL
è&& !Õd & 
PD_NOLOCK
)) {

211 
	`TRACE
Ğ
TRACE_DEBUG
, "ReguÏ¸idx fÜ (%s)\n", 
_Çme
);

214 
	`ü—‹_´im¬y_idx_desc
("LO_IDX", 0, 
keys
, 2);

216 
	`ü—‹_šdex_desc
("LO_IDX_ORDERKEY", 0, 
fkeys1
, 1, 
çl£
);

218 
	}
}

221 
EXIT_NAMESPACE
(
ssb
);

	@src/workload/ssb/shore_ssb_schema_man.cpp

35 
	~"wÜklßd/ssb/shÜe_ssb_schema_mª.h
"

38 
usšg
 
Çme¥aû
 
	gshÜe
;

41 
ENTER_NAMESPACE
(
ssb
);

56 
w_rc_t
 
	g·¹_mª_im¶
::
	$p_šdex_´obe
(
ss_m
* 
db
,

57 
·¹_tu¶e
* 
±u¶e
,

58 cÚ¡ 
p_·¹key
)

60 
	`as£¹
(
±u¶e
);

62 
±u¶e
->
	`£t_v®ue
(0, 
p_·¹key
);

63  (
	`šdex_´obe_by_Çme
(
db
, "P_IDX", 
±u¶e
));

64 
	}
}

72 
w_rc_t
 
	gsuµl›r_mª_im¶
::
	$s_šdex_´obe
(
ss_m
* 
db
,

73 
suµl›r_tu¶e
* 
±u¶e
,

74 cÚ¡ 
s_suµkey
)

76 
	`as£¹
 (
±u¶e
);

77 
±u¶e
->
	`£t_v®ue
(0, 
s_suµkey
);

78  (
	`šdex_´obe_by_Çme
(
db
, "S_IDX", 
±u¶e
));

79 
	}
}

134 
w_rc_t
 
	gcu¡om”_mª_im¶
::
	$c_šdex_´obe
(
ss_m
* 
db
,

135 
cu¡om”_tu¶e
* 
±u¶e
,

136 cÚ¡ 
c_cu¡key
)

138 
	`as£¹
 (
±u¶e
);

139 
±u¶e
->
	`£t_v®ue
(0, 
c_cu¡key
);

140  (
	`šdex_´obe_by_Çme
(
db
, "C_IDX", 
±u¶e
));

141 
	}
}

159 
w_rc_t
 
	gd©e_mª_im¶
::
	$d_šdex_´obe
(
ss_m
* 
db
,

160 
d©e_tu¶e
* 
±u¶e
,

161 cÚ¡ 
d_d©ekey
)

163 
	`as£¹
 (
±u¶e
);

164 
±u¶e
->
	`£t_v®ue
(0, 
d_d©ekey
);

165  (
	`šdex_´obe_by_Çme
(
db
, "D_IDX", 
±u¶e
));

166 
	}
}

174 
w_rc_t
 
	glšeÜd”_mª_im¶
::
	$lo_šdex_´obe
(
ss_m
* 
db
,

175 
lšeÜd”_tu¶e
* 
±u¶e
,

176 cÚ¡ 
lo_Üd”key
,

177 cÚ¡ 
lo_lš’umb”
)

179 
	`as£¹
 (
±u¶e
);

180 
±u¶e
->
	`£t_v®ue
(0, 
lo_Üd”key
);

181 
±u¶e
->
	`£t_v®ue
(1, 
lo_lš’umb”
);

182  (
	`šdex_´obe_by_Çme
(
db
, "LO_IDX", 
±u¶e
));

183 
	}
}

246 
EXIT_NAMESPACE
(
ssb
);

	@src/workload/ssb/shore_ssb_xct.cpp

31 
	~"wÜklßd/ssb/shÜe_ssb_’v.h
"

32 
	~"wÜklßd/ssb/ssb_¿ndom.h
"

34 
	~<veùÜ
>

35 
	~<m­
>

36 
	~<num”ic
>

37 
	~<®gÜ™hm
>

39 
	~"wÜklßd/ssb/dbg’/dss.h
"

40 
	~"wÜklßd/ssb/dbg’/ds¡y³s.h
"

45 
	~"sm_ba£.h
"

48 
usšg
 
Çme¥aû
 
	gshÜe
;

49 
usšg
 
Çme¥aû
 
	gdbg’ssb
;

53 
ENTER_NAMESPACE
(
ssb
);

63 
__th»ad
 
ShÜeSSBTrxSts
 
	gmy_¡©s
;

65 
	gShÜeSSBEnv
::
	$’v_th»ad_š™
()

67 
	`CRITICAL_SECTION
(
¡©_mu‹x_cs
, 
_¡©m­_mu‹x
);

68 
_¡©m­
[
	`±h»ad_£lf
()] = &
my_¡©s
;

69 
	}
}

71 
	gShÜeSSBEnv
::
	$’v_th»ad_fši
()

73 
	`CRITICAL_SECTION
(
¡©_mu‹x_cs
, 
_¡©m­_mu‹x
);

74 
_¡©m­
.
	`”a£
(
	`±h»ad_£lf
());

75 
	}
}

86 
ShÜeSSBTrxSts
 
	gShÜeSSBEnv
::
	$_g‘_¡©s
()

88 
	`CRITICAL_SECTION
(
cs
, 
_¡©m­_mu‹x
);

89 
ShÜeSSBTrxSts
 
rv®
;

90 
rv®
 -=„val;

91 
¡©m­_t
::
™”©Ü
 
™
=
_¡©m­
.
	`begš
(); iˆ!ğ_¡©m­.
	`’d
(); ++it)

92 
rv®
 +ğ*
™
->
£cÚd
;

93  (
rv®
);

94 
	}
}

105 
	gShÜeSSBEnv
::
	$»£t_¡©s
()

107 
	`CRITICAL_SECTION
(
Ï¡_¡©s_cs
, 
_Ï¡_¡©s_mu‹x
);

108 
_Ï¡_¡©s
 = 
	`_g‘_¡©s
();

109 
	}
}

120 
	gShÜeSSBEnv
::
	$´št_throughput
(cÚ¡ 
iQu”›dSF
,

121 cÚ¡ 
iS´—d
,

122 cÚ¡ 
iNumOfTh»ads
,

123 cÚ¡ 
d–ay
,

124 cÚ¡ 
ulÚg_t
 
mioch
,

125 cÚ¡ 
avgıuu§ge
)

127 
	`CRITICAL_SECTION
(
Ï¡_¡©s_cs
, 
_Ï¡_¡©s_mu‹x
);

130 
ShÜeSSBTrxSts
 
cu¼’t_¡©s
 = 
	`_g‘_¡©s
();

133 
cu¼’t_¡©s
 -ğ
_Ï¡_¡©s
;

135 
ušt
 
Œxs_©t
 = 
cu¼’t_¡©s
.
©‹m±ed
.
	`tÙ®
();

136 
ušt
 
Œxs_abt
 = 
cu¼’t_¡©s
.
çed
.
	`tÙ®
();

137 
ušt
 
Œxs_dld
 = 
cu¼’t_¡©s
.
d—dlocked
.
	`tÙ®
();

139 
	`TRACE
Ğ
TRACE_ALWAYS
, "*******\n" \

150 
iQu”›dSF
,

151 (
iS´—d
 ? "Yes" : "No"),

152 
iNumOfTh»ads
, 
Œxs_©t
, 
Œxs_abt
, 
Œxs_dld
,

153 
d–ay
, 
mioch
/d–ay, 
avgıuu§ge
,

154 100*
avgıuu§ge
/
	`g‘_max_ıu_couÁ
(),

155 (
Œxs_©t
-
Œxs_abt
-
Œxs_dld
)/
d–ay
);

156 
	}
}

227 #undeà
DO_PRINT_SSB_RECS


231 
w_rc_t
 
	gShÜeSSBEnv
::
	$_g’_Úe_d©e
(cÚ¡ 
id
,

232 
»p_row_t
& 
¬•row
)

234 
tu¶e_gu¬d
<
d©e_mª_im¶
> 
	`´da
(
_pd©e_mª
);

236 
´da
->
_»p
 = &
¬•row
;

238 
dbg’ssb
::
d©e_t
 
ad
;

239 
	`mk_d©e
(
id
, &
ad
);

241 #ifdeà
DO_PRINT_SSB_RECS


242 
	`TRACE
Ğ
TRACE_ALWAYS
,

244 
ad
.
d©ekey
,‡d.
d©e
,‡d.
dayofw“k
,‡d.
mÚth
,‡d.
y—r
,

245 
ad
.
y—rmÚthnum
,‡d.
y—rmÚth
,‡d.
daynumšw“k
,‡d.
daynumšmÚth
,

246 
ad
.
daynumšy—r
,‡d.
mÚthnumšy—r
,‡d.
w“knumšy—r
,

247 
ad
.
£Îšg£asÚ
,‡d.
¦’
,‡d.
Ï¡dayšw“kæ
,‡d.
Ï¡dayšmÚthæ
,

248 
ad
.
hŞidayæ
,‡d.
w“kdayæ
);

251 
´da
->
	`£t_v®ue
(0, ()
ad
.
d©ekey
);

252 
´da
->
	`£t_v®ue
(1, 
ad
.
d©e
);

253 
´da
->
	`£t_v®ue
(2, 
ad
.
dayofw“k
);

254 
´da
->
	`£t_v®ue
(3, 
ad
.
mÚth
);

255 
´da
->
	`£t_v®ue
(4, ()
ad
.
y—r
);

256 
´da
->
	`£t_v®ue
(5, ()
ad
.
y—rmÚthnum
);

257 
´da
->
	`£t_v®ue
(6, 
ad
.
y—rmÚth
);

258 
´da
->
	`£t_v®ue
(7, ()
ad
.
daynumšw“k
);

259 
´da
->
	`£t_v®ue
(8, ()
ad
.
daynumšmÚth
);

260 
´da
->
	`£t_v®ue
(9, ()
ad
.
daynumšy—r
);

261 
´da
->
	`£t_v®ue
(10, ()
ad
.
mÚthnumšy—r
);

262 
´da
->
	`£t_v®ue
(11, ()
ad
.
w“knumšy—r
);

263 
´da
->
	`£t_v®ue
(12, 
ad
.
£Îšg£asÚ
);

264 
´da
->
	`£t_v®ue
(13, 
ad
.
Ï¡dayšw“kæ
);

265 
´da
->
	`£t_v®ue
(14, 
ad
.
Ï¡dayšmÚthæ
);

266 
´da
->
	`£t_v®ue
(15, 
ad
.
hŞidayæ
);

267 
´da
->
	`£t_v®ue
(16, 
ad
.
w“kdayæ
);

269 
	`W_DO
(
_pd©e_mª
->
	`add_tu¶e
(
_pssm
, 
´da
));

271  
RCOK
;

272 
	}
}

276 
w_rc_t
 
	gShÜeSSBEnv
::
	$_g’_Úe_suµl›r
(cÚ¡ 
id
,

277 
»p_row_t
& 
¬•row
)

279 
tu¶e_gu¬d
<
suµl›r_mª_im¶
> 
	`´su
(
_psuµl›r_mª
);

281 
´su
->
_»p
 = &
¬•row
;

283 
dbg’ssb
::
suµl›r_t
 
as
;

284 
	`mk_suµ
(
id
, &
as
);

286 #ifdeà
DO_PRINT_SSB_RECS


287 ià(
id
%100==0) {

288 
	`TRACE
(
TRACE_ALWAYS
, "%ld,%s,%s[len:%d],%s,%s,[%d:]%s,%s\n",

289 
as
.
suµkey
,‡s.
Çme
,‡s.
add»ss
,‡s.
®’
,‡s.
c™y
,

290 
as
.
ÇtiÚ_Çme
,‡s.
»giÚ_key
,‡s.
»giÚ_Çme
,‡s.
phÚe
);

294 
´su
->
	`£t_v®ue
(0, ()
as
.
suµkey
);

295 
´su
->
	`£t_v®ue
(1, 
as
.
Çme
);

296 
´su
->
	`£t_v®ue
(2, 
as
.
add»ss
);

297 
´su
->
	`£t_v®ue
(3, 
as
.
c™y
);

298 
´su
->
	`£t_v®ue
(4, 
as
.
ÇtiÚ_Çme
);

299 
´su
->
	`£t_v®ue
(5, 
as
.
»giÚ_Çme
);

300 
´su
->
	`£t_v®ue
(6, 
as
.
phÚe
);

302 
	`W_DO
(
_psuµl›r_mª
->
	`add_tu¶e
(
_pssm
, 
´su
));

304  
RCOK
;

305 
	}
}

309 
w_rc_t
 
	gShÜeSSBEnv
::
	$_g’_Úe_cu¡om”
(cÚ¡ 
id
,

310 
»p_row_t
& 
¬•row
)

312 
tu¶e_gu¬d
<
cu¡om”_mª_im¶
> 
	`´cu
(
_pcu¡om”_mª
);

314 
´cu
->
_»p
 = &
¬•row
;

316 
dbg’ssb
::
cu¡om”_t
 
ac
;

317 
	`mk_cu¡
(
id
, &
ac
);

319 #ifdeà
DO_PRINT_SSB_RECS


320 ià(
id
%100==0) {

321 
	`TRACE
(
TRACE_ALWAYS
,

323 
ac
.
cu¡key
,‡c.
Çme
, 
	`¡¾’
×c.Çme),‡c.
add»ss
,

324 
	`¡¾’
(
ac
.
add»ss
),‡c.
c™y
, sŒËn×c.c™y),‡c.
ÇtiÚ_Çme
,

325 
	`¡¾’
(
ac
.
ÇtiÚ_Çme
),‡c.
»giÚ_key
,‡c.
»giÚ_Çme
,

326 
	`¡¾’
(
ac
.
»giÚ_Çme
),‡c.
phÚe
,‡c.
mkt£gm’t
);

330 
´cu
->
	`£t_v®ue
(0, ()
ac
.
cu¡key
);

331 
´cu
->
	`£t_v®ue
(1, 
ac
.
Çme
);

332 
´cu
->
	`£t_v®ue
(2, 
ac
.
add»ss
);

333 
´cu
->
	`£t_v®ue
(3, 
ac
.
c™y
);

334 
´cu
->
	`£t_v®ue
(4, 
ac
.
ÇtiÚ_Çme
);

335 
´cu
->
	`£t_v®ue
(5, 
ac
.
»giÚ_Çme
);

336 
´cu
->
	`£t_v®ue
(6, 
ac
.
phÚe
);

337 
´cu
->
	`£t_v®ue
(7, 
ac
.
mkt£gm’t
);

339 
	`W_DO
(
_pcu¡om”_mª
->
	`add_tu¶e
(
_pssm
, 
´cu
));

341  
RCOK
;

342 
	}
}

346 
w_rc_t
 
	gShÜeSSBEnv
::
	$_g’_Úe_·¹
(cÚ¡ 
id
,

347 
»p_row_t
& 
¬•row
)

349 
tu¶e_gu¬d
<
·¹_mª_im¶
> 
	`´·
(
_µ¬t_mª
);

351 
´·
->
_»p
 = &
¬•row
;

353 
dbg’ssb
::
·¹_t
 
­
;

354 
	`mk_·¹
(
id
, &
­
);

356 #ifdeà
DO_PRINT_SSB_RECS


357 ià(
id
%100==0) {

358 
	`TRACE
Ğ
TRACE_ALWAYS
,

360 
­
.
·¹key
,­.
Çme
,­.
Æ’
,­.
mfgr
,­.
ÿ‹gÜy
,­.
b¿nd
,­.
cŞÜ
,

361 
­
.
ş’
,­.
ty³
,­.
’
,­.
size
,­.
cÚš”
);

365 
´·
->
	`£t_v®ue
(0, ()
­
.
·¹key
);

366 
´·
->
	`£t_v®ue
(1, 
­
.
Çme
);

367 
´·
->
	`£t_v®ue
(2, 
­
.
mfgr
);

368 
´·
->
	`£t_v®ue
(3, 
­
.
ÿ‹gÜy
);

369 
´·
->
	`£t_v®ue
(4, 
­
.
b¿nd
);

370 
´·
->
	`£t_v®ue
(5, 
­
.
cŞÜ
);

371 
´·
->
	`£t_v®ue
(6, 
­
.
ty³
);

372 
´·
->
	`£t_v®ue
(7, ()
­
.
size
);

373 
´·
->
	`£t_v®ue
(8, 
­
.
cÚš”
);

375 
	`W_DO
(
_µ¬t_mª
->
	`add_tu¶e
(
_pssm
, 
´·
));

377  
RCOK
;

378 
	}
}

382 
w_rc_t
 
	gShÜeSSBEnv
::
	$_g’_Úe_lšeÜd”
(cÚ¡ 
id
,

383 
»p_row_t
& 
¬•row
)

385 
dbg’ssb
::
Üd”_t
 
o
;

387 
	`INIT_HUGE
(
o
.
okey
);

388 
i
=0; i < 
O_LCNT_MAX
; i++) {

389 
	`INIT_HUGE
(
o
.
lšeÜd”s
[
i
].
okey
);

391 
	`mk_Üd”
(
id
, &
o
, 0);

393 #ifdeà
DO_PRINT_SSB_RECS


394 ià(
id
%100==0) {

395 
i
=0;i<
o
.
lšes
;i++) {

396 
	`TRACE
Ğ
TRACE_ALWAYS
,

398 ()
o
.
okey
[0], ()o.
lšeÜd”s
[
i
].
lš’umb”
,

399 ()
o
.
cu¡key
, ()o.
lšeÜd”s
[
i
].
·¹key
,

400 ()
o
.
lšeÜd”s
[
i
].
suµkey
,

401 ()
	`©oi
(
o
.
lšeÜd”s
[
i
].
Üd”d©e
),

402 
o
.
lšeÜd”s
[
i
].
İriÜ™y
,

403 ()
o
.
lšeÜd”s
[
i
].
sh_´iÜ™y
,

404 ()
o
.
lšeÜd”s
[
i
].
quªt™y
,

405 ()
o
.
lšeÜd”s
[
i
].
ex‹nded_´iû
,

406 ()
o
.
lšeÜd”s
[
i
].
Üd”_tÙ®´iû
,

407 ()
o
.
lšeÜd”s
[
i
].
discouÁ
,

408 ()
o
.
lšeÜd”s
[
i
].
»v’ue
, ()o.lšeÜd”s[i].
suµ_co¡
,

409 ()
o
.
lšeÜd”s
[
i
].
x
,

410 ()
	`©oi
(
o
.
lšeÜd”s
[
i
].
comm™_d©e
),

411 
o
.
lšeÜd”s
[
i
].
shmode
);

416 
i
=0;i<
o
.
lšes
;i++) {

418 
tu¶e_gu¬d
<
lšeÜd”_mª_im¶
> 
	`´lo
(
_¶šeÜd”_mª
);

420 
´lo
->
_»p
 = &
¬•row
;

422 
´lo
->
	`£t_v®ue
(0, ()
o
.
okey
[0]);

423 
´lo
->
	`£t_v®ue
(1, ()
o
.
lšeÜd”s
[
i
].
lš’umb”
);

424 
´lo
->
	`£t_v®ue
(2, ()
o
.
cu¡key
);

425 
´lo
->
	`£t_v®ue
(3, ()
o
.
lšeÜd”s
[
i
].
·¹key
);

426 
´lo
->
	`£t_v®ue
(4, ()
o
.
lšeÜd”s
[
i
].
suµkey
);

427 
´lo
->
	`£t_v®ue
(5, ()
	`©oi
(
o
.
lšeÜd”s
[
i
].
Üd”d©e
));

428 
´lo
->
	`£t_v®ue
(6, 
o
.
lšeÜd”s
[
i
].
İriÜ™y
);

429 
´lo
->
	`£t_v®ue
(7, ()
o
.
lšeÜd”s
[
i
].
sh_´iÜ™y
);

430 
´lo
->
	`£t_v®ue
(8, ()
o
.
lšeÜd”s
[
i
].
quªt™y
);

431 
´lo
->
	`£t_v®ue
(9, ()
o
.
lšeÜd”s
[
i
].
ex‹nded_´iû
);

432 
´lo
->
	`£t_v®ue
(10, ()
o
.
lšeÜd”s
[
i
].
Üd”_tÙ®´iû
);

433 
´lo
->
	`£t_v®ue
(11, ()
o
.
lšeÜd”s
[
i
].
discouÁ
);

434 
´lo
->
	`£t_v®ue
(12, ()
o
.
lšeÜd”s
[
i
].
»v’ue
);

435 
´lo
->
	`£t_v®ue
(13, ()
o
.
lšeÜd”s
[
i
].
suµ_co¡
);

436 
´lo
->
	`£t_v®ue
(14, ()
o
.
lšeÜd”s
[
i
].
x
);

437 
´lo
->
	`£t_v®ue
(15, ()
	`©oi
(
o
.
lšeÜd”s
[
i
].
comm™_d©e
));

438 
´lo
->
	`£t_v®ue
(16, 
o
.
lšeÜd”s
[
i
].
shmode
);

440 
	`W_DO
(
_¶šeÜd”_mª
->
	`add_tu¶e
(
_pssm
, 
´lo
));

443  
RCOK
;

444 
	}
}

455 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_pİuÏ‹_ba£lše
(const ,

456 
pİuÏ‹_ba£lše_šput_t
& 
š
)

459 
	`as£¹
 (
_pssm
);

460 
	`as£¹
 (
_š™Ÿlized
);

463 
»p_row_t
 
	`¬•row
(
_pcu¡om”_mª
->
	`ts
());

464 
¬•row
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

467 
	`TRACE
Ğ
TRACE_ALWAYS
, "LO MAX SIZE:%d \n",
_¶šeÜd”_desc
->
	`maxsize
());

468 
	`TRACE
Ğ
TRACE_ALWAYS
, "PA MAX SIZE:%d \n",
_µ¬t_desc
->
	`maxsize
());

469 
	`TRACE
Ğ
TRACE_ALWAYS
, "CU MAX SIZE:%d \n",
_pcu¡om”_desc
->
	`maxsize
());

470 
	`TRACE
Ğ
TRACE_ALWAYS
, "SU MAX SIZE:%d \n",
_psuµl›r_desc
->
	`maxsize
());

471 
	`TRACE
Ğ
TRACE_ALWAYS
, "DA MAX SIZE:%d \n",
_pd©e_desc
->
	`maxsize
());

474 
	`TRACE
Ğ
TRACE_ALWAYS
, "Building DATE !!!\n");

475 
i
=1; i<=
NO_DATE
; ++i) {

476 
	`W_DO
(
	`_g’_Úe_d©e
(
i
, 
¬•row
));

479 
	`TRACE
Ğ
TRACE_ALWAYS
, "Building SUPPLIER SF=%d*%d=%d!!!\n",

480 ()
š
.
_sf
, ()
SUPPLIER_PER_SF
, ()(in._sf*SUPPLIER_PER_SF));

481 
i
=1; i<=
š
.
_sf
*
SUPPLIER_PER_SF
; ++i) {

482 
	`W_DO
(
	`_g’_Úe_suµl›r
(
i
, 
¬•row
));

485 
	`TRACE
Ğ
TRACE_ALWAYS
, "Starting CUSTOMER SF=%d*%d=%d!!!\n",

486 ()
š
.
_sf
, ()
CUSTOMER_PER_SF
, ()(in._sf*CUSTOMER_PER_SF));

487 
i
=1; i<=
š
.
_sf
*
CUSTOMER_PER_SF
; ++i) {

488 
	`W_DO
(
	`_g’_Úe_cu¡om”
(
i
, 
¬•row
));

491 
	`TRACE
Ğ
TRACE_ALWAYS
, "Starting PART 1+log2(SF)=1+log2(%d)=%d*%d=%d!!!\n",

492 ()
š
.
_sf
, ()(1+
	`log2
(š._sf)), ()
PART_PER_SF
,

493 ()((1+
	`log2
(
š
.
_sf
))*
PART_PER_SF
));

494 
i
=1; i<=(1+
	`log2
(
š
.
_sf
))*
PART_PER_SF
; ++i) {

495 
	`W_DO
Ğ
	`_g’_Úe_·¹
(
i
, 
¬•row
));

499 
	`TRACE
Ğ
TRACE_ALWAYS
, "Starting LINEORDERS SF=%d*%d=%d!!!\n",

500 ()
š
.
_sf
, ()
LINEORDER_PER_SF
, ()(in._sf*LINEORDER_PER_SF));

502 
i
=0; i < 
š
.
_lßd”_couÁ
; ++i) {

503 
¡¬t
 = 
i
 * 
š
.
_lšeÜd”_³r_th»ad
 + 1;

504 
’d
 = 
¡¬t
 + 
š
.
_divisÜ
 - 1;

505 
	`TRACE
Ğ
TRACE_ALWAYS
, "LšeÜd” %d .. %d\n", 
¡¬t
, 
’d
);

507 
j
=
¡¬t
; j<
’d
; ++j) {

508 
	`W_DO
(
e
 = 
	`_g’_Úe_lšeÜd”
(
j
,
¬•row
));

512 
	`W_DO
(
_pssm
->
	`comm™_xù
());

513  
RCOK
;

514 
	}
}

519 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_pİuÏ‹_some_lšeÜd”s
(cÚ¡ 
xù_id
,

520 
pİuÏ‹_some_lšeÜd”s_šput_t
& 
š
)

523 
	`as£¹
 (
_pssm
);

524 
	`as£¹
 (
_š™Ÿlized
);

526 
»p_row_t
 
	`¬•row
(
_¶šeÜd”_mª
->
	`ts
());

527 
¬•row
.
	`£t
(
_¶šeÜd”_desc
->
	`maxsize
());

529 
id
 = 
š
.
_Üd”id
;

532 
id
=
š
.
_Üd”id
; id<š._Üd”id+
xù_id
; id++) {

533 
	`W_DO
(
	`_g’_Úe_lšeÜd”
(
id
, 
¬•row
));

536 
	`W_DO
(
_pssm
->
	`comm™_xù
());

537  
RCOK
;

538 
	}
}

618 
w_rc_t
 
	gShÜeSSBEnv
::
	$run_Úe_xù
(
Reque¡
* 
´eque¡
)

620 #ifdeà
CFG_QPIPE


621 ià(
´eque¡
->
	`ty³
(è>ğ
XCT_QPIPE_SSB_MIX
) {

622  (
	`run_Úe_qpe_xù
(
´eque¡
));

627 ià(
´eque¡
->
	`ty³
(è=ğ
XCT_SSB_MIX
) {

628 
´eque¡
->
	`£t_ty³
(
XCT_SSB_MIX
 + 
	`abs
(
smth»ad_t
::
	`me
()->
	`¿nd
()%22));

631 
´eque¡
->
	`ty³
()) {

634 
XCT_SSB_QDATE
:

635  (
	`run_qd©e
(
´eque¡
));

637 
XCT_SSB_QPART
:

638  (
	`run_q·¹
(
´eque¡
));

640 
XCT_SSB_QSUPPLIER
:

641  (
	`run_qsuµl›r
(
´eque¡
));

643 
XCT_SSB_QCUSTOMER
:

644  (
	`run_qcu¡om”
(
´eque¡
));

646 
XCT_SSB_QLINEORDER
:

647  (
	`run_qlšeÜd”
(
´eque¡
));

649 
XCT_SSB_QTEST
:

650  (
	`run_q‹¡
(
´eque¡
));

652 
XCT_SSB_Q1_1
:

653  (
	`run_q1_1
(
´eque¡
));

655 
XCT_SSB_Q1_2
:

656  (
	`run_q1_2
(
´eque¡
));

658 
XCT_SSB_Q1_3
:

659  (
	`run_q1_3
(
´eque¡
));

661 
XCT_SSB_Q2_1
:

662  (
	`run_q2_1
(
´eque¡
));

664 
XCT_SSB_Q2_2
:

665  (
	`run_q2_2
(
´eque¡
));

667 
XCT_SSB_Q2_3
:

668  (
	`run_q2_3
(
´eque¡
));;

670 
XCT_SSB_Q3_1
:

671  (
	`run_q3_1
(
´eque¡
));

673 
XCT_SSB_Q3_2
:

674  (
	`run_q3_2
(
´eque¡
));

676 
XCT_SSB_Q3_3
:

677  (
	`run_q3_3
(
´eque¡
));

679 
XCT_SSB_Q3_4
:

680  (
	`run_q3_4
(
´eque¡
));

682 
XCT_SSB_Q4_1
:

683  (
	`run_q4_1
(
´eque¡
));

685 
XCT_SSB_Q4_2
:

686  (
	`run_q4_2
(
´eque¡
));;

688 
XCT_SSB_Q4_3
:

689  (
	`run_q4_3
(
´eque¡
));

693 
	`TRACE
Ğ
TRACE_ALWAYS
, "Unknownransaction\n");

694 
	`as£¹
(0);

696  (
RCOK
);

697 
	}
}

717 
DEFINE_TRX
(
ShÜeSSBEnv
,
q1_1
);

718 
DEFINE_TRX
(
ShÜeSSBEnv
,
q1_2
);

719 
DEFINE_TRX
(
ShÜeSSBEnv
,
q1_3
);

720 
DEFINE_TRX
(
ShÜeSSBEnv
,
q2_1
);

721 
DEFINE_TRX
(
ShÜeSSBEnv
,
q2_2
);

722 
DEFINE_TRX
(
ShÜeSSBEnv
,
q2_3
);

723 
DEFINE_TRX
(
ShÜeSSBEnv
,
q3_1
);

724 
DEFINE_TRX
(
ShÜeSSBEnv
,
q3_2
);

725 
DEFINE_TRX
(
ShÜeSSBEnv
,
q3_3
);

726 
DEFINE_TRX
(
ShÜeSSBEnv
,
q3_4
);

727 
DEFINE_TRX
(
ShÜeSSBEnv
,
q4_1
);

728 
DEFINE_TRX
(
ShÜeSSBEnv
,
q4_2
);

729 
DEFINE_TRX
(
ShÜeSSBEnv
,
q4_3
);

730 
DEFINE_TRX
(
ShÜeSSBEnv
,
q·¹
);

731 
DEFINE_TRX
(
ShÜeSSBEnv
,
qd©e
);

732 
DEFINE_TRX
(
ShÜeSSBEnv
,
qcu¡om”
);

733 
DEFINE_TRX
(
ShÜeSSBEnv
,
qsuµl›r
);

734 
DEFINE_TRX
(
ShÜeSSBEnv
,
qlšeÜd”
);

735 
DEFINE_TRX
(
ShÜeSSBEnv
,
q‹¡
);

748 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_qd©e
(const ,

749 
qd©e_šput_t
& )

752 
	`as£¹
 (
_pssm
);

753 
	`as£¹
 (
_š™Ÿlized
);

754 
	`as£¹
 (
_lßded
);

755  (
	`RC
(
smËv–_0
::
eNOTIMPLEMENTED
));

756 
	}
}

765 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_q·¹
(const ,

766 
q·¹_šput_t
& )

769 
	`as£¹
 (
_pssm
);

770 
	`as£¹
 (
_š™Ÿlized
);

771 
	`as£¹
 (
_lßded
);

772  (
	`RC
(
smËv–_0
::
eNOTIMPLEMENTED
));

773 
	}
}

782 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_qcu¡om”
(const ,

783 
qcu¡om”_šput_t
& )

786 
	`as£¹
 (
_pssm
);

787 
	`as£¹
 (
_š™Ÿlized
);

788 
	`as£¹
 (
_lßded
);

789  (
	`RC
(
smËv–_0
::
eNOTIMPLEMENTED
));

790 
	}
}

799 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_qsuµl›r
(const ,

800 
qsuµl›r_šput_t
& )

803 
	`as£¹
 (
_pssm
);

804 
	`as£¹
 (
_š™Ÿlized
);

805 
	`as£¹
 (
_lßded
);

806  (
	`RC
(
smËv–_0
::
eNOTIMPLEMENTED
));

807 
	}
}

816 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_qlšeÜd”
(const ,

817 
qlšeÜd”_šput_t
& )

820 
	`as£¹
 (
_pssm
);

821 
	`as£¹
 (
_š™Ÿlized
);

822 
	`as£¹
 (
_lßded
);

823  (
	`RC
(
smËv–_0
::
eNOTIMPLEMENTED
));

824 
	}
}

832 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_q‹¡
(const ,

833 
q‹¡_šput_t
& )

836 
	`as£¹
 (
_pssm
);

837 
	`as£¹
 (
_š™Ÿlized
);

838 
	`as£¹
 (
_lßded
);

839  (
	`RC
(
smËv–_0
::
eNOTIMPLEMENTED
));

840 
	}
}

849 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_q1_1
(const ,

850 
q1_1_šput_t
& )

853 
	`as£¹
 (
_pssm
);

854 
	`as£¹
 (
_š™Ÿlized
);

855 
	`as£¹
 (
_lßded
);

856  (
	`RC
(
smËv–_0
::
eNOTIMPLEMENTED
));

857 
	}
}

866 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_q1_2
(const ,

867 
q1_2_šput_t
& )

870 
	`as£¹
 (
_pssm
);

871 
	`as£¹
 (
_š™Ÿlized
);

872 
	`as£¹
 (
_lßded
);

873  (
	`RC
(
smËv–_0
::
eNOTIMPLEMENTED
));

874 
	}
}

883 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_q1_3
(const ,

884 
q1_3_šput_t
& )

887 
	`as£¹
 (
_pssm
);

888 
	`as£¹
 (
_š™Ÿlized
);

889 
	`as£¹
 (
_lßded
);

890  (
	`RC
(
smËv–_0
::
eNOTIMPLEMENTED
));

891 
	}
}

901 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_q2_1
(const ,

902 
q2_1_šput_t
& )

905 
	`as£¹
 (
_pssm
);

906 
	`as£¹
 (
_š™Ÿlized
);

907 
	`as£¹
 (
_lßded
);

908  (
	`RC
(
smËv–_0
::
eNOTIMPLEMENTED
));

909 
	}
}

918 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_q2_2
(const ,

919 
q2_2_šput_t
& )

922 
	`as£¹
 (
_pssm
);

923 
	`as£¹
 (
_š™Ÿlized
);

924 
	`as£¹
 (
_lßded
);

925  (
	`RC
(
smËv–_0
::
eNOTIMPLEMENTED
));

926 
	}
}

935 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_q2_3
(const ,

936 
q2_3_šput_t
& )

939 
	`as£¹
 (
_pssm
);

940 
	`as£¹
 (
_š™Ÿlized
);

941 
	`as£¹
 (
_lßded
);

942  (
	`RC
(
smËv–_0
::
eNOTIMPLEMENTED
));

943 
	}
}

953 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_q3_1
(const ,

954 
q3_1_šput_t
& )

957 
	`as£¹
 (
_pssm
);

958 
	`as£¹
 (
_š™Ÿlized
);

959 
	`as£¹
 (
_lßded
);

960  (
	`RC
(
smËv–_0
::
eNOTIMPLEMENTED
));

961 
	}
}

970 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_q3_2
(const ,

971 
q3_2_šput_t
& )

974 
	`as£¹
 (
_pssm
);

975 
	`as£¹
 (
_š™Ÿlized
);

976 
	`as£¹
 (
_lßded
);

977  (
	`RC
(
smËv–_0
::
eNOTIMPLEMENTED
));

978 
	}
}

987 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_q3_3
(const ,

988 
q3_3_šput_t
& )

991 
	`as£¹
 (
_pssm
);

992 
	`as£¹
 (
_š™Ÿlized
);

993 
	`as£¹
 (
_lßded
);

994  (
	`RC
(
smËv–_0
::
eNOTIMPLEMENTED
));

995 
	}
}

1003 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_q3_4
(const ,

1004 
q3_4_šput_t
& )

1007 
	`as£¹
 (
_pssm
);

1008 
	`as£¹
 (
_š™Ÿlized
);

1009 
	`as£¹
 (
_lßded
);

1010  (
	`RC
(
smËv–_0
::
eNOTIMPLEMENTED
));

1011 
	}
}

1021 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_q4_1
(const ,

1022 
q4_1_šput_t
& )

1025 
	`as£¹
 (
_pssm
);

1026 
	`as£¹
 (
_š™Ÿlized
);

1027 
	`as£¹
 (
_lßded
);

1028  (
	`RC
(
smËv–_0
::
eNOTIMPLEMENTED
));

1029 
	}
}

1038 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_q4_2
(const ,

1039 
q4_2_šput_t
& )

1042 
	`as£¹
 (
_pssm
);

1043 
	`as£¹
 (
_š™Ÿlized
);

1044 
	`as£¹
 (
_lßded
);

1045  (
	`RC
(
smËv–_0
::
eNOTIMPLEMENTED
));

1046 
	}
}

1055 
w_rc_t
 
	gShÜeSSBEnv
::
	$xù_q4_3
(const ,

1056 
q4_3_šput_t
& )

1059 
	`as£¹
 (
_pssm
);

1060 
	`as£¹
 (
_š™Ÿlized
);

1061 
	`as£¹
 (
_lßded
);

1062  (
	`RC
(
smËv–_0
::
eNOTIMPLEMENTED
));

1063 
	}
}

1068 
EXIT_NAMESPACE
(
ssb
);

	@src/workload/ssb/ssb_input.cpp

33 
	~"ut.h
"

34 
	~"wÜklßd/ssb/ssb_¿ndom.h
"

35 
	~"wÜklßd/ssb/ssb_ut.h
"

36 
	~"wÜklßd/ssb/ssb_šput.h
"

38 
	~"wÜklßd/ssb/dbg’/dss.h
"

39 
	~"wÜklßd/ssb/dbg’/ds¡y³s.h
"

41 
usšg
 
Çme¥aû
 
	gdbg’ssb
;

43 
ENTER_NAMESPACE
(
ssb
);

45 
qd©e_šput_t
 
	$ü—‹_qd©e_šput
(const , const )

46 {
qd©e_šput_t
 
a
;‡;
	}
}

47 
q·¹_šput_t
 
	$ü—‹_q·¹_šput
(const , const )

48 {
q·¹_šput_t
 
a
;‡;
	}
}

49 
qsuµl›r_šput_t
 
	$ü—‹_qsuµl›r_šput
(const , const )

50 {
qsuµl›r_šput_t
 
a
;‡;
	}
}

51 
qcu¡om”_šput_t
 
	$ü—‹_qcu¡om”_šput
(const , const )

52 {
qcu¡om”_šput_t
 
a
;‡;
	}
}

53 
qlšeÜd”_šput_t
 
	$ü—‹_qlšeÜd”_šput
(const , const )

54 {
qlšeÜd”_šput_t
 
a
;‡;
	}
}

55 
q‹¡_šput_t
 
	$ü—‹_q‹¡_šput
(const , const )

56 {
q‹¡_šput_t
 
a
;‡;
	}
}

76 
	gq1_1_šput_t
& q1_1_šput_t::
İ”©Ü
=(cÚ¡ 
q1_1_šput_t
& 
rhs
)

78 
d_y—r
 = 
rhs
.d_year;

79 
	glo_discouÁ_lo
 = 
rhs
.
lo_discouÁ_lo
;

80 
	glo_discouÁ_hi
 = 
rhs
.
lo_discouÁ_hi
;

81 
	glo_quªt™y
 = 
rhs
.
lo_quªt™y
;

83  (*
	gthis
);

86 
q1_1_šput_t
 
	$ü—‹_q1_1_šput
(const , const )

89 
q1_1_šput_t
 
q1_1_š
;

91 
q1_1_š
.
d_y—r
 = 1993;

92 
q1_1_š
.
lo_discouÁ_lo
 = 1;

93 
q1_1_š
.
lo_discouÁ_hi
 = 3;

94 
q1_1_š
.
lo_quªt™y
 = 25;

96 
	`´štf
("q1_1_š: %d %d %d %d \n",
q1_1_š
.
d_y—r
,q1_1_š.
lo_discouÁ_lo
,q1_1_š.
lo_discouÁ_hi
,q1_1_š.
lo_quªt™y
);

98  
q1_1_š
;

99 
	}
}

106 
	gq1_2_šput_t
& q1_2_šput_t::
İ”©Ü
=(cÚ¡ 
q1_2_šput_t
& 
rhs
)

108 
d_y—rmÚthnum
 = 
rhs
.d_yearmonthnum;

109 
	glo_discouÁ_lo
 = 
rhs
.
lo_discouÁ_lo
;

110 
	glo_discouÁ_hi
 = 
rhs
.
lo_discouÁ_hi
;

111 
	glo_quªt™y_lo
 = 
rhs
.
lo_quªt™y_lo
;

112 
	glo_quªt™y_hi
 = 
rhs
.
lo_quªt™y_hi
;

114  (*
	gthis
);

117 
q1_2_šput_t
 
	$ü—‹_q1_2_šput
(const , const )

120 
q1_2_šput_t
 
q1_2_š
;

122 
q1_2_š
.
d_y—rmÚthnum
 = 199401;

123 
q1_2_š
.
lo_discouÁ_lo
 = 4;

124 
q1_2_š
.
lo_discouÁ_hi
 = 6;

125 
q1_2_š
.
lo_quªt™y_lo
 = 26;

126 
q1_2_š
.
lo_quªt™y_hi
 = 35;

128 
	`´štf
("q1_2_š: %d %d %d %d %d\n",
q1_2_š
.
d_y—rmÚthnum
,q1_2_š.
lo_discouÁ_lo
,q1_2_š.
lo_discouÁ_hi
,q1_2_š.
lo_quªt™y_lo
,q1_2_š.
lo_quªt™y_hi
);

130  
q1_2_š
;

131 
	}
}

139 
	gq1_3_šput_t
& q1_3_šput_t::
İ”©Ü
=(cÚ¡ 
q1_3_šput_t
& 
rhs
)

141 
d_w“knumšy—r
 = 
rhs
.d_weeknuminyear;

142 
	gd_y—r
 = 
rhs
.
d_y—r
;

143 
	glo_discouÁ_lo
 = 
rhs
.
lo_discouÁ_lo
;

144 
	glo_discouÁ_hi
 = 
rhs
.
lo_discouÁ_hi
;

145 
	glo_quªt™y_lo
 = 
rhs
.
lo_quªt™y_lo
;

146 
	glo_quªt™y_hi
 = 
rhs
.
lo_quªt™y_hi
;

148  (*
	gthis
);

151 
q1_3_šput_t
 
	$ü—‹_q1_3_šput
(const , const )

154 
q1_3_šput_t
 
q1_3_š
;

156 
q1_3_š
.
d_w“knumšy—r
 = 6;

157 
q1_3_š
.
d_y—r
 = 1994;

158 
q1_3_š
.
lo_discouÁ_lo
 = 5;

159 
q1_3_š
.
lo_discouÁ_hi
 = 7;

160 
q1_3_š
.
lo_quªt™y_lo
 = 26;

161 
q1_3_š
.
lo_quªt™y_hi
 = 35;

163 
	`´štf
("q1_3_š: %d %d %d %d %d %d\n",
q1_3_š
.
d_w“knumšy—r
,q1_3_š.
d_y—r
,q1_3_š.
lo_discouÁ_lo
,q1_3_š.
lo_discouÁ_hi
,q1_3_š.
lo_quªt™y_lo
,q1_3_š.
lo_quªt™y_hi
);

165  
q1_3_š
;

166 
	}
}

174 
	gq2_1_šput_t
& q2_1_šput_t::
İ”©Ü
=(cÚ¡ 
q2_1_šput_t
& 
rhs
)

176 
¡rıy
(
p_ÿ‹gÜy
,
rhs
.p_category);

177 
¡rıy
(
s_»giÚ
,
rhs
.s_region);

179  (*
	gthis
);

182 
q2_1_šput_t
 
	$ü—‹_q2_1_šput
(const , const )

185 
q2_1_šput_t
 
q2_1_š
;

187 
	`¡rıy
(
q2_1_š
.
p_ÿ‹gÜy
,"MFGR#12");

188 
	`¡rıy
(
q2_1_š
.
s_»giÚ
,"AMERICA");

190 
	`´štf
("q2_1_š: % %s\n",
q2_1_š
.
p_ÿ‹gÜy
,q2_1_š.
s_»giÚ
);

192  
q2_1_š
;

193 
	}
}

201 
	gq2_2_šput_t
& q2_2_šput_t::
İ”©Ü
=(cÚ¡ 
q2_2_šput_t
& 
rhs
)

203 
¡rıy
(
p_b¿nd_1
,
rhs
.p_brand_1);

204 
¡rıy
(
p_b¿nd_2
,
rhs
.p_brand_2);

205 
¡rıy
(
s_»giÚ
,
rhs
.s_region);

207  (*
	gthis
);

210 
q2_2_šput_t
 
	$ü—‹_q2_2_šput
(const , const )

213 
q2_2_šput_t
 
q2_2_š
;

215 
	`¡rıy
(
q2_2_š
.
p_b¿nd_1
,"MFGR#2221");

216 
	`¡rıy
(
q2_2_š
.
p_b¿nd_2
,"MFGR#2228");

217 
	`¡rıy
(
q2_2_š
.
s_»giÚ
 ,"ASIA");

219 
	`´štf
("q2_2_š: % % %s\n",
q2_2_š
.
p_b¿nd_1
,q2_2_š.
p_b¿nd_2
,q2_2_š.
s_»giÚ
);

221  
q2_2_š
;

222 
	}
}

231 
	gq2_3_šput_t
& q2_3_šput_t::
İ”©Ü
=(cÚ¡ 
q2_3_šput_t
& 
rhs
)

233 
¡rıy
(
p_b¿nd
,
rhs
.p_brand);

234 
¡rıy
(
s_»giÚ
,
rhs
.s_region);

236  (*
	gthis
);

239 
q2_3_šput_t
 
	$ü—‹_q2_3_šput
(const , const )

242 
q2_3_šput_t
 
q2_3_š
;

244 
	`¡rıy
(
q2_3_š
.
p_b¿nd
 ,"MFGR#2239");

245 
	`¡rıy
(
q2_3_š
.
s_»giÚ
 ,"EUROPE");

247 
	`´štf
("q2_3_š: % %s\n",
q2_3_š
.
p_b¿nd
,q2_3_š.
s_»giÚ
);

249  
q2_3_š
;

250 
	}
}

258 
	gq3_1_šput_t
& q3_1_šput_t::
İ”©Ü
=(cÚ¡ 
q3_1_šput_t
& 
rhs
)

260 
_y—r_lo
 = 
rhs
._year_lo;

261 
	g_y—r_hi
 = 
rhs
.
_y—r_hi
;

263 
¡rıy
(
c_»giÚ
,
rhs
.c_region);

264 
¡rıy
(
s_»giÚ
,
rhs
.s_region);

266  (*
	gthis
);

270 
q3_1_šput_t
 
	$ü—‹_q3_1_šput
(const , const )

272 
q3_1_šput_t
 
q3_1_š
;

274 
q3_1_š
.
_y—r_lo
 = 1992;

275 
q3_1_š
.
_y—r_hi
 = 1997;

276 
	`¡rıy
(
q3_1_š
.
c_»giÚ
 ,"ASIA");

277 
	`¡rıy
(
q3_1_š
.
s_»giÚ
 ,"ASIA");

279 
	`´štf
("q3_1_š: %d %d % %s\n",
q3_1_š
.
_y—r_lo
,q3_1_š.
_y—r_hi
,q3_1_š.
c_»giÚ
,q3_1_š.
s_»giÚ
);

281  
q3_1_š
;

282 
	}
}

291 
	gq3_2_šput_t
& q3_2_šput_t::
İ”©Ü
=(cÚ¡ 
q3_2_šput_t
& 
rhs
)

293 
_y—r_lo
 = 
rhs
._year_lo;

294 
	g_y—r_hi
 = 
rhs
.
_y—r_hi
;

296 
¡rıy
(
_ÇtiÚ
,
rhs
._nation);

298  (*
	gthis
);

302 
q3_2_šput_t
 
	$ü—‹_q3_2_šput
(const , const )

304 
q3_2_šput_t
 
q3_2_š
;

305 
_id_ÇtiÚ
;

307 
q3_2_š
.
_y—r_lo
=
	`URªd
(1992,1998);

308 
q3_2_š
.
_y—r_hi
=
	`URªd
(q3_2_š.
_y—r_lo
,1998);

309 
_id_ÇtiÚ
=
	`URªd
(0,24);

310 
	`g‘_ÇtiÚ
(
q3_2_š
.
_ÇtiÚ
,(
ssb_ÇtiÚ
)
_id_ÇtiÚ
);

312 
	`´štf
("q3_2_š: %d %d %s\n",
q3_2_š
.
_y—r_lo
,q3_2_š.
_y—r_hi
,q3_2_š.
_ÇtiÚ
);

316  
q3_2_š
;

317 
	}
}

326 
	gq3_3_šput_t
& q3_3_šput_t::
İ”©Ü
=(cÚ¡ 
q3_3_šput_t
& 
rhs
)

328 
_y—r_lo
 = 
rhs
._year_lo;

329 
	g_y—r_hi
 = 
rhs
.
_y—r_hi
;

331 
¡rıy
(
c_c™y_1
,
rhs
.c_city_1);

332 
¡rıy
(
c_c™y_2
,
rhs
.c_city_2);

333 
¡rıy
(
s_c™y_1
,
rhs
.s_city_1);

334 
¡rıy
(
s_c™y_2
,
rhs
.s_city_2);

336  (*
	gthis
);

340 
q3_3_šput_t
 
	$ü—‹_q3_3_šput
(const , const )

342 
q3_3_šput_t
 
q3_3_š
;

344 
q3_3_š
.
_y—r_lo
=1992;

345 
q3_3_š
.
_y—r_hi
=1997;

346 
	`¡rıy
(
q3_3_š
.
c_c™y_1
,"UNITED KI1");

347 
	`¡rıy
(
q3_3_š
.
c_c™y_2
,"UNITED KI5");

348 
	`¡rıy
(
q3_3_š
.
s_c™y_1
,"UNITED KI1");

349 
	`¡rıy
(
q3_3_š
.
s_c™y_2
,"UNITED KI5");

352 
	`´štf
("q3_3_š: %d %d % % % %s\n",
q3_3_š
.
_y—r_lo
,q3_3_š.
_y—r_hi
,q3_3_š.
c_c™y_1
,q3_3_š.
c_c™y_2
,q3_3_š.
s_c™y_1
,q3_3_š.
s_c™y_2
);

354  
q3_3_š
;

355 
	}
}

364 
	gq3_4_šput_t
& q3_4_šput_t::
İ”©Ü
=(cÚ¡ 
q3_4_šput_t
& 
rhs
)

366 
¡rıy
(
c_c™y_1
,
rhs
.c_city_1);

367 
¡rıy
(
c_c™y_2
,
rhs
.c_city_2);

368 
¡rıy
(
s_c™y_1
,
rhs
.s_city_1);

369 
¡rıy
(
s_c™y_2
,
rhs
.s_city_2);

370 
¡rıy
(
d_y—rmÚth
,
rhs
.d_yearmonth);

372  (*
	gthis
);

376 
q3_4_šput_t
 
	$ü—‹_q3_4_šput
(const , const )

378 
q3_4_šput_t
 
q3_4_š
;

380 
	`¡rıy
(
q3_4_š
.
c_c™y_1
 , "UNITED KI1");

381 
	`¡rıy
(
q3_4_š
.
c_c™y_2
 , "UNITED KI5");

382 
	`¡rıy
(
q3_4_š
.
s_c™y_1
 , "UNITED KI1");

383 
	`¡rıy
(
q3_4_š
.
s_c™y_2
 , "UNITED KI5");

384 
	`¡rıy
(
q3_4_š
.
d_y—rmÚth
 , "Dec1997");

386 
	`´štf
("q3_4_š: % % % % %s\n",
q3_4_š
.
c_c™y_1
,q3_4_š.
c_c™y_2
,q3_4_š.
s_c™y_1
,q3_4_š.
s_c™y_2
,q3_4_š.
d_y—rmÚth
);

388  
q3_4_š
;

389 
	}
}

398 
	gq4_1_šput_t
& q4_1_šput_t::
İ”©Ü
=(cÚ¡ 
q4_1_šput_t
& 
rhs
)

400 
¡rıy
(
c_»giÚ
,
rhs
.c_region);

401 
¡rıy
(
s_»giÚ
,
rhs
.s_region);

402 
¡rıy
(
p_mfgr_1
,
rhs
.p_mfgr_1);

403 
¡rıy
(
p_mfgr_2
,
rhs
.p_mfgr_2);

405  (*
	gthis
);

409 
q4_1_šput_t
 
	$ü—‹_q4_1_šput
(const , const )

411 
q4_1_šput_t
 
q4_1_š
;

413 
	`¡rıy
(
q4_1_š
.
c_»giÚ
 , "AMERICA");

414 
	`¡rıy
(
q4_1_š
.
s_»giÚ
 , "AMERICA");

415 
	`¡rıy
(
q4_1_š
.
p_mfgr_1
 , "MFGR#1");

416 
	`¡rıy
(
q4_1_š
.
p_mfgr_2
 , "MFGR#2");

418 
	`´štf
("q4_1_š: % % % %s\n",
q4_1_š
.
c_»giÚ
,q4_1_š.
s_»giÚ
,q4_1_š.
p_mfgr_1
,q4_1_š.
p_mfgr_2
);

420  
q4_1_š
;

421 
	}
}

430 
	gq4_2_šput_t
& q4_2_šput_t::
İ”©Ü
=(cÚ¡ 
q4_2_šput_t
& 
rhs
)

432 
d_y—r_1
 = 
rhs
.d_year_1;

433 
	gd_y—r_2
 = 
rhs
.
d_y—r_2
;

434 
¡rıy
(
c_»giÚ
,
rhs
.c_region);

435 
¡rıy
(
s_»giÚ
,
rhs
.s_region);

436 
¡rıy
(
p_mfgr_1
,
rhs
.p_mfgr_1);

437 
¡rıy
(
p_mfgr_2
,
rhs
.p_mfgr_2);

439  (*
	gthis
);

443 
q4_2_šput_t
 
	$ü—‹_q4_2_šput
(const , const )

445 
q4_2_šput_t
 
q4_2_š
;

447 
q4_2_š
.
d_y—r_1
 = 1997;

448 
q4_2_š
.
d_y—r_2
 = 1998;

449 
	`¡rıy
(
q4_2_š
.
c_»giÚ
 , "AMERICA");

450 
	`¡rıy
(
q4_2_š
.
s_»giÚ
 , "AMERICA");

451 
	`¡rıy
(
q4_2_š
.
p_mfgr_1
 , "MFGR#1");

452 
	`¡rıy
(
q4_2_š
.
p_mfgr_2
 , "MFGR#2");

454 
	`´štf
("q4_2_š: %d %d % % % %s\n",
q4_2_š
.
d_y—r_1
,q4_2_š.
d_y—r_2
,q4_2_š.
c_»giÚ
,q4_2_š.
s_»giÚ
,q4_2_š.
p_mfgr_1
,q4_2_š.
p_mfgr_2
);

456  
q4_2_š
;

457 
	}
}

466 
	gq4_3_šput_t
& q4_3_šput_t::
İ”©Ü
=(cÚ¡ 
q4_3_šput_t
& 
rhs
)

468 
d_y—r_1
 = 
rhs
.d_year_1;

469 
	gd_y—r_2
 = 
rhs
.
d_y—r_2
;

470 
¡rıy
(
s_ÇtiÚ
,
rhs
.s_nation);

471 
¡rıy
(
p_ÿ‹gÜy
,
rhs
.p_category);

473  (*
	gthis
);

477 
q4_3_šput_t
 
	$ü—‹_q4_3_šput
(const , const )

479 
q4_3_šput_t
 
q4_3_š
;

481 
q4_3_š
.
d_y—r_1
 = 1997;

482 
q4_3_š
.
d_y—r_2
 = 1998;

483 
	`¡rıy
(
q4_3_š
.
s_ÇtiÚ
 , "UNITED STATES");

484 
	`¡rıy
(
q4_3_š
.
p_ÿ‹gÜy
 , "MFGR#14");

486 
	`´štf
("q4_3_š: %d %d % %s\n",
q4_3_š
.
d_y—r_1
,q4_3_š.
d_y—r_2
,q4_3_š.
s_ÇtiÚ
,q4_3_š.
p_ÿ‹gÜy
);

488  
q4_3_š
;

489 
	}
}

491 
EXIT_NAMESPACE
(
ssb
);

	@src/workload/ssb/ssb_random.cpp

33 
	~"wÜklßd/ssb/ssb_¿ndom.h
"

34 
	~"wÜklßd/ssb/ssb_cÚ¡.h
"

37 
ENTER_NAMESPACE
(
ssb
);

62 
	$¿ndom
(
low
, 
high
, 
¿ndg’_t
* 
½
) {

64  (
low
 + 
½
->
	`¿nd
(
high
 -†ow + 1));

65 
	}
}

73 
	$URªd
(
low
, 
high
) {

75 
th»ad_t
* 
£lf
 = 
	`th»ad_g‘_£lf
();

76 
	`as£¹
 (
£lf
);

77 
¿ndg’_t
* 
¿ndg’p
 = 
£lf
->
	`¿ndg’
();

78 
	`as£¹
 (
¿ndg’p
);

80 
d
 = 
high
 - 
low
 + 1;

90  (
low
 + 
¿ndg’p
->
	`¿nd
(
d
));

91 
	}
}

99 
	$NURªd
(
A
, 
low
, 
high
) {

101 
th»ad_t
* 
£lf
 = 
	`th»ad_g‘_£lf
();

102 
	`as£¹
 (
£lf
);

103 
¿ndg’_t
* 
¿ndg’p
 = 
£lf
->
	`¿ndg’
();

104 
	`as£¹
 (
¿ndg’p
);

106  ( (((
	`¿ndom
(0, 
A
, 
¿ndg’p
è|„ªdom(
low
, 
high
,„andgenp))

107 + 
	`¿ndom
(0, 
A
, 
¿ndg’p
))

108 % (
high
 - 
low
 + 1)) +†ow );

109 
	}
}

111 
EXIT_NAMESPACE
(
ssb
);

	@src/workload/ssb/ssb_util.cpp

2 
	~"wÜklßd/ssb/ssb_¡ruù.h
"

3 
	~"wÜklßd/ssb/ssb_ut.h
"

4 
	~<¡ršg
>

7 
ENTER_NAMESPACE
(
ssb
);

9 
ssb_l_shmode
 
	$¡r_to_shmode
(* 
shmode
)

11 
ssb_l_shmode
 
»t
;

12 iàĞ!
	`¡rcmp
(
shmode
,"REG_AIR") || !strcmp(shipmode,"REG AIR") )

13 { 
»t
=
REG_AIR
; }

14 ià(!
	`¡rcmp
(
shmode
,"AIR"))

15 { 
»t
=
AIR
; }

16 ià(!
	`¡rcmp
(
shmode
,"RAIL"))

17 { 
»t
=
RAIL
; }

18 ià(!
	`¡rcmp
(
shmode
,"TRUCK"))

19 { 
»t
=
TRUCK
; }

20 ià(!
	`¡rcmp
(
shmode
,"MAIL"))

21 { 
»t
=
MAIL
; }

22 ià(!
	`¡rcmp
(
shmode
,"FOB"))

23 { 
»t
=
FOB
; }

25 { 
»t
=
SHIP
; }

27  
»t
;

28 
	}
}

30 
	$shmode_to_¡r
(* 
¡r
, 
ssb_l_shmode
 
shmode
)

33 iàĞ
shmode
 =ğ
REG_AIR
 )

34 { 
	`¡rıy
(
¡r
,"REG AIR"); }

35 iàĞ
shmode
 =ğ
AIR
 )

36 { 
	`¡rıy
(
¡r
,"AIR"); }

37 iàĞ
shmode
 =ğ
RAIL
 )

38 { 
	`¡rıy
(
¡r
,"RAIL"); }

39 iàĞ
shmode
 =ğ
TRUCK
 )

40 { 
	`¡rıy
(
¡r
,"TRUCK"); }

41 iàĞ
shmode
 =ğ
MAIL
 )

42 { 
	`¡rıy
(
¡r
,"MAIL"); }

43 iàĞ
shmode
 =ğ
FOB
 )

44 { 
	`¡rıy
(
¡r
,"FOB"); }

46 { 
	`¡rıy
(
¡r
,"SHIP"); }

48 
	}
}

50 
	$g‘_ÇtiÚ
(* 
ÇtiÚ_Çme
, 
ssb_ÇtiÚ
 
ÇtiÚ_id
)

52 ià(
ÇtiÚ_id
==
ALGERIA
)

53 { 
	`¡rıy
(
ÇtiÚ_Çme
,"ALGERIA"); }

54 ià(
ÇtiÚ_id
==
ARGENTINA
)

55 { 
	`¡rıy
(
ÇtiÚ_Çme
,"ARGENTINA"); }

56 ià(
ÇtiÚ_id
==
BRAZIL
)

57 { 
	`¡rıy
(
ÇtiÚ_Çme
,"BRAZIL"); }

58 ià(
ÇtiÚ_id
==
CANADA
)

59 { 
	`¡rıy
(
ÇtiÚ_Çme
,"CANADA"); }

60 ià(
ÇtiÚ_id
==
CHINA
)

61 { 
	`¡rıy
(
ÇtiÚ_Çme
,"CHINA"); }

62 ià(
ÇtiÚ_id
==
EGYPT
)

63 { 
	`¡rıy
(
ÇtiÚ_Çme
,"EGYPT"); }

64 ià(
ÇtiÚ_id
==
ETHIOPIA
)

65 { 
	`¡rıy
(
ÇtiÚ_Çme
,"ETHIOPIA"); }

66 ià(
ÇtiÚ_id
==
FRANCE
)

67 { 
	`¡rıy
(
ÇtiÚ_Çme
,"FRANCE"); }

68 ià(
ÇtiÚ_id
==
GERMANY
)

69 { 
	`¡rıy
(
ÇtiÚ_Çme
,"GERMANY"); }

70 ià(
ÇtiÚ_id
==
INDIA
)

71 { 
	`¡rıy
(
ÇtiÚ_Çme
,"INDIA"); }

72 ià(
ÇtiÚ_id
==
INDONESIA
)

73 { 
	`¡rıy
(
ÇtiÚ_Çme
,"INDONESIA"); }

74 ià(
ÇtiÚ_id
==
IRAN
)

75 { 
	`¡rıy
(
ÇtiÚ_Çme
,"IRAN"); }

76 ià(
ÇtiÚ_id
==
IRAQ
)

77 { 
	`¡rıy
(
ÇtiÚ_Çme
,"IRAQ"); }

78 ià(
ÇtiÚ_id
==
JAPAN
)

79 { 
	`¡rıy
(
ÇtiÚ_Çme
,"JAPAN"); }

80 ià(
ÇtiÚ_id
==
JORDAN
)

81 { 
	`¡rıy
(
ÇtiÚ_Çme
,"JORDAN"); }

82 ià(
ÇtiÚ_id
==
KENYA
)

83 { 
	`¡rıy
(
ÇtiÚ_Çme
,"KENYA"); }

84 ià(
ÇtiÚ_id
==
MOROCCO
)

85 { 
	`¡rıy
(
ÇtiÚ_Çme
,"MOROCCO"); }

86 ià(
ÇtiÚ_id
==
MOZAMBIQUE
)

87 { 
	`¡rıy
(
ÇtiÚ_Çme
,"MOZAMBIQUE"); }

88 ià(
ÇtiÚ_id
==
PERU
)

89 { 
	`¡rıy
(
ÇtiÚ_Çme
,"PERU"); }

90 ià(
ÇtiÚ_id
==
ROMANIA
)

91 { 
	`¡rıy
(
ÇtiÚ_Çme
,"ROMANIA"); }

92 ià(
ÇtiÚ_id
==
RUSSIA
)

93 { 
	`¡rıy
(
ÇtiÚ_Çme
,"RUSSIA"); }

94 ià(
ÇtiÚ_id
==
SAUDI_ARABIA
)

95 { 
	`¡rıy
(
ÇtiÚ_Çme
,"SAUDI ARABIA"); }

96 ià(
ÇtiÚ_id
==
UNITED_KINGDOM
)

97 { 
	`¡rıy
(
ÇtiÚ_Çme
,"UNITED KINGDOM"); }

98 ià(
ÇtiÚ_id
==
UNITED_STATES
)

99 { 
	`¡rıy
(
ÇtiÚ_Çme
,"UNITED_STATES"); }

100 ià(
ÇtiÚ_id
==
VIETNAM
)

101 { 
	`¡rıy
(
ÇtiÚ_Çme
,"VIETNAM"); }

103 
	}
}

106 
EXIT_NAMESPACE
(
ssb
);

	@src/workload/tm1/shore_tm1_client.cpp

31 
	~"wÜklßd/tm1/shÜe_tm1_ş›Á.h
"

33 
ENTER_NAMESPACE
(
tm1
);

42 
	gba£lše_tm1_ş›Á_t
::
	$ba£lše_tm1_ş›Á_t
(
c_¡r
 
Šame
, cÚ¡ 
id
,

43 
ShÜeTM1Env
* 
’v
,

44 cÚ¡ 
M—su»m’tTy³
 
aTy³
,

45 cÚ¡ 
Œxid
,

46 cÚ¡ 
numOfTrxs
,

47 
´oûssÜid_t
 
­rsid
,

48 cÚ¡ 
£lID
, cÚ¡ 
qf
)

49 : 
	`ba£_ş›Á_t
(
Šame
,
id
,
’v
,
aTy³
,
Œxid
,
numOfTrxs
,
­rsid
),

50 
	`_£lid
(
£lID
), 
	$_qf
(
qf
)

52 
	`as£¹
 (
’v
);

53 
	`as£¹
 (
_id
>=0 && 
_qf
>0);

56 
_wÜk”
 = 
_’v
->
	`wÜk”
(
_id
);

57 
	`as£¹
 (
_wÜk”
);

58 
	}
}

61 
	gba£lše_tm1_ş›Á_t
::
	$lßd_sup_xù
(
m­SupTrxs
& 
¡m­
)

64 
¡m­
.
	`ş—r
();

67 
¡m­
[
XCT_TM1_MIX
] = "TM1-Mix";

68 
¡m­
[
XCT_TM1_GET_SUB_DATA
] = "TM1-GetSubData";

69 
¡m­
[
XCT_TM1_GET_NEW_DEST
] = "TM1-GetNewDest";

70 
¡m­
[
XCT_TM1_GET_ACC_DATA
] = "TM1-GetAccData";

71 
¡m­
[
XCT_TM1_UPD_SUB_DATA
] = "TM1-UpdSubData";

72 
¡m­
[
XCT_TM1_UPD_LOCATION
] = "TM1-UpdLocation";

73 
¡m­
[
XCT_TM1_CALL_FWD_MIX
] = "TM1-CallFwd-Mix";

74 
¡m­
[
XCT_TM1_INS_CALL_FWD
] = "TM1-InsCallFwd";

75 
¡m­
[
XCT_TM1_DEL_CALL_FWD
] = "TM1-DelCallFwd";

77 
¡m­
[
XCT_TM1_GET_SUB_NBR
] = "TM1-GetSubNbr";

79 
¡m­
[
XCT_TM1_CALL_FWD_MIX_BENCH
] = "TM1-CallFwd-Mix-Bench";

80 
¡m­
[
XCT_TM1_INS_CALL_FWD_BENCH
] = "TM1-InsCallFwd-Bench";

81 
¡m­
[
XCT_TM1_DEL_CALL_FWD_BENCH
] = "TM1-DelCallFwd-Bench";

83  (
¡m­
.
	`size
());

84 
	}
}

98 
w_rc_t
 
	gba£lše_tm1_ş›Á_t
::
	$subm™_Úe
(
xù_ty³
, 
xùid
)

101 
Œx_»suÉ_tu¶e_t
 
©¹
;

102 
boŞ
 
bWake
 = 
çl£
;

103 ià(
cÚdex
* 
c
 = 
_ı
->
	`ke_Úe
()) {

104 
©¹
.
	`£t_nÙify
(
c
);

105 
bWake
 = 
Œue
;

109 
£lsf
 = 
_£lid
;

110 ià(
_£lid
==0) {

111 
£lsf
 = 
	`URªd
(1,
_qf
);

115 
£lid
 = (
£lsf
-1)*
TM1_SUBS_PER_SF
 + 
	`URªd
(1,TM1_SUBS_PER_SF);

118 
Œx_»que¡_t
* 
¬eque¡
 = 
	`Ãw
 (
_’v
->
_»que¡_poŞ
)rx_request_t;

119 
tid_t
 
©id
;

120 
¬eque¡
->
	`£t
(
NULL
,
©id
,
xùid
,
©¹
,
xù_ty³
,
£lid
);

123 
	`as£¹
 (
_wÜk”
);

124 
_wÜk”
->
	`’queue
(
¬eque¡
,
bWake
);

125  (
RCOK
);

126 
	}
}

130 
EXIT_NAMESPACE
(
tm1
);

	@src/workload/tm1/shore_tm1_env.cpp

31 
	~"wÜklßd/tm1/shÜe_tm1_’v.h
"

32 
	~"sm/shÜe/shÜe_h–³r_lßd”.h
"

34 
usšg
 
Çme¥aû
 
	gshÜe
;

37 
ENTER_NAMESPACE
(
shÜe
);

38 
DEFINE_ROW_CACHE_TLS
(
tm1
, 
sub
);

39 
DEFINE_ROW_CACHE_TLS
(
tm1
, 
ai
);

40 
DEFINE_ROW_CACHE_TLS
(
tm1
, 
sf
);

41 
DEFINE_ROW_CACHE_TLS
(
tm1
, 
cf
);

42 
EXIT_NAMESPACE
(
shÜe
);

45 
ENTER_NAMESPACE
(
tm1
);

54 
	gShÜeTM1Env
::
	$ShÜeTM1Env
()

55 : 
	$ShÜeEnv
()

57 
_sÿlšg_çùÜ
 = 
TM1_DEF_SF
;

58 
_qu”›d_çùÜ
 = 
TM1_DEF_QF
;

59 
	}
}

61 
	gShÜeTM1Env
::~
	$ShÜeTM1Env
()

63 
	}
}

75 
w_rc_t
 
ShÜeTM1Env
::
	$lßd_schema
()

78 
_psub_desc
 = 
Ãw
 
	`subsüib”_t
(
	`g‘_pd
());

79 
_·i_desc
 = 
Ãw
 
	`acûss_šfo_t
(
	`g‘_pd
());

80 
_psf_desc
 = 
Ãw
 
	`¥ecŸl_çc™y_t
(
	`g‘_pd
());

81 
_pcf_desc
 = 
Ãw
 
	`ÿÎ_fÜw¬dšg_t
(
	`g‘_pd
());

84 
_psub_mª
 = 
Ãw
 
	`sub_mª_im¶
(
_psub_desc
.
	`g‘
());

85 
_·i_mª
 = 
Ãw
 
	`ai_mª_im¶
(
_·i_desc
.
	`g‘
());

86 
_psf_mª
 = 
Ãw
 
	`sf_mª_im¶
(
_psf_desc
.
	`g‘
());

87 
_pcf_mª
 = 
Ãw
 
	`cf_mª_im¶
(
_pcf_desc
.
	`g‘
());

89  (
RCOK
);

90 
	}
}

103 
w_rc_t
 
	gShÜeTM1Env
::
	$lßd_ªd_»gi¡”_fids
()

105 
	`W_DO
(
_psub_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

106 
	`W_DO
(
_·i_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

107 
	`W_DO
(
_psf_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

108 
	`W_DO
(
_pcf_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

109  (
RCOK
);

110 
	}
}

122 
w_rc_t
 
	gShÜeTM1Env
::
	$upd©e_·¹™iÚšg
()

127 
	`cÚf
();

130 
ušt
 
mrb¬ts
 = 
’vV¬
::
	`š¡ªû
()->
	`g‘V¬IÁ
("mrbt-partitions",10);

131 
mšKeyV®
 = 1;

132 
maxKeyV®
 = (
	`g‘_sf
()*
TM1_SUBS_PER_SF
)+1;

134 * 
mšKey
 = (*)
	`m®loc
(());

135 
	`mem£t
(
mšKey
,0,());

136 
	`memıy
(
mšKey
,&
mšKeyV®
,());

138 * 
maxKey
 = (*)
	`m®loc
(());

139 
	`mem£t
(
maxKey
,0,());

140 
	`memıy
(
maxKey
,&
maxKeyV®
,());

143 
_psub_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
mrb¬ts
);

144 
_·i_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
mrb¬ts
);

145 
_psf_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
mrb¬ts
);

146 
_pcf_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
mrb¬ts
);

148 
	`ä“
 (
mšKey
);

149 
	`ä“
 (
maxKey
);

151  (
RCOK
);

152 
	}
}

164 
	gShÜeTM1Env
::
	$¡¬t
()

166  (
ShÜeEnv
::
	`¡¬t
());

167 
	}
}

169 
	gShÜeTM1Env
::
	$¡İ
()

171  (
ShÜeEnv
::
	`¡İ
());

172 
	}
}

182 
	gShÜeTM1Env
::
	$£t_skew
(
¬—
, 
lßd
, 
¡¬t_imb®ªû
)

184 
ShÜeEnv
::
	`£t_skew
(
¬—
, 
lßd
, 
¡¬t_imb®ªû
);

186 
s_skew”
.
	`£t
(
¬—
, 1, 
_sÿlšg_çùÜ
 * 
TM1_SUBS_PER_SF
, 
lßd
);

187 
	}
}

198 
	gShÜeTM1Env
::
	$¡¬t_lßd_imb®ªû
()

200 if(
s_skew”
.
	`is_u£d
()) {

201 
_chªge_lßd
 = 
çl£
;

203 
s_skew”
.
	`»£t
(
_skew_ty³
);

205 if(
_skew_ty³
 !ğ
SKEW_CHAOTIC
 || 
	`URªd
(1,100) > 30) {

206 
_chªge_lßd
 = 
Œue
;

208 
ShÜeEnv
::
	`¡¬t_lßd_imb®ªû
();

209 
	}
}

220 
	gShÜeTM1Env
::
	$»£t_skew
()

222 
ShÜeEnv
::
	`»£t_skew
();

223 
_chªge_lßd
 = 
çl£
;

224 
s_skew”
.
	`ş—r
();

225 
	}
}

236 
	gShÜeTM1Env
::
	$šfo
() const

238 
	`TRACE
Ğ
TRACE_ALWAYS
, "SF = (%.1f)\n", 
_sÿlšg_çùÜ
);

239 
	`TRACE
Ğ
TRACE_ALWAYS
, "WÜk” ğ(%d)\n", 
_wÜk”_út
);

241 
	}
}

253 
	gShÜeTM1Env
::
	$¡©i¡ics
()

256 
	`CRITICAL_SECTION
(
cs
, 
_¡©m­_mu‹x
);

257 
ShÜeTM1TrxSts
 
rv®
;

258 
rv®
 -=„val;

259 
¡©m­_t
::
™”©Ü
 
™
=
_¡©m­
.
	`begš
(); iˆ!ğ_¡©m­.
	`’d
(); ++it)

260 
rv®
 +ğ*
™
->
£cÚd
;

262 
	`TRACE
Ğ
TRACE_STATISTICS
, "GebSubData. Att (%d). Abt (%d). Dld (%d)\n",

263 
rv®
.
©‹m±ed
.
g‘_sub_d©a
,

264 
rv®
.
çed
.
g‘_sub_d©a
,

265 
rv®
.
d—dlocked
.
g‘_sub_d©a
);

267 
	`TRACE
Ğ
TRACE_STATISTICS
, "GebNewDest. Att (%d). Abt (%d). Dld (%d)\n",

268 
rv®
.
©‹m±ed
.
g‘_Ãw_de¡
,

269 
rv®
.
çed
.
g‘_Ãw_de¡
,

270 
rv®
.
d—dlocked
.
g‘_Ãw_de¡
);

272 
	`TRACE
Ğ
TRACE_STATISTICS
, "GebAccData. Att (%d). Abt (%d). Dld (%d)\n",

273 
rv®
.
©‹m±ed
.
g‘_acc_d©a
,

274 
rv®
.
çed
.
g‘_acc_d©a
,

275 
rv®
.
d—dlocked
.
g‘_acc_d©a
);

277 
	`TRACE
Ğ
TRACE_STATISTICS
, "UpdSubData. Att (%d). Abt (%d). Dld (%d)\n",

278 
rv®
.
©‹m±ed
.
upd_sub_d©a
,

279 
rv®
.
çed
.
upd_sub_d©a
,

280 
rv®
.
d—dlocked
.
upd_sub_d©a
);

282 
	`TRACE
Ğ
TRACE_STATISTICS
, "UpdLocation. Att (%d). Abt (%d). Dld (%d)\n",

283 
rv®
.
©‹m±ed
.
upd_loc
,

284 
rv®
.
çed
.
upd_loc
,

285 
rv®
.
d—dlocked
.
upd_loc
);

287 
	`TRACE
Ğ
TRACE_STATISTICS
, "InsCallFwd. Att (%d). Abt (%d). Dld (%d)\n",

288 
rv®
.
©‹m±ed
.
šs_ÿÎ_fwd
,

289 
rv®
.
çed
.
šs_ÿÎ_fwd
,

290 
rv®
.
d—dlocked
.
šs_ÿÎ_fwd
);

292 
	`TRACE
Ğ
TRACE_STATISTICS
, "DelCallFwd. Att (%d). Abt (%d). Dld (%d)\n",

293 
rv®
.
©‹m±ed
.
d–_ÿÎ_fwd
,

294 
rv®
.
çed
.
d–_ÿÎ_fwd
,

295 
rv®
.
d—dlocked
.
d–_ÿÎ_fwd
);

297 
	`TRACE
Ğ
TRACE_STATISTICS
, "GetSubNbr. Att (%d). Abt (%d). Dld (%d)\n",

298 
rv®
.
©‹m±ed
.
g‘_sub_nbr
,

299 
rv®
.
çed
.
g‘_sub_nbr
,

300 
rv®
.
d—dlocked
.
g‘_sub_nbr
);

302 
	`TRACE
Ğ
TRACE_STATISTICS
, "InsCallFwdBench. Att (%d). Abt (%d). Dld (%d)\n",

303 
rv®
.
©‹m±ed
.
šs_ÿÎ_fwd_b’ch
,

304 
rv®
.
çed
.
šs_ÿÎ_fwd_b’ch
,

305 
rv®
.
d—dlocked
.
šs_ÿÎ_fwd_b’ch
);

307 
	`TRACE
Ğ
TRACE_STATISTICS
, "DelCallFwdBench. Att (%d). Abt (%d). Dld (%d)\n",

308 
rv®
.
©‹m±ed
.
d–_ÿÎ_fwd_b’ch
,

309 
rv®
.
çed
.
d–_ÿÎ_fwd_b’ch
,

310 
rv®
.
d—dlocked
.
d–_ÿÎ_fwd_b’ch
);

312 
ShÜeEnv
::
	`¡©i¡ics
();

315 
	}
}

329 
	gShÜeTM1Env
::
bË_ü—tÜ_t
 : 
public
 
th»ad_t


331 
ShÜeTM1Env
* 
_’v
;

332 
	g_lßd”s
;

333 
	g_subs_³r_wÜk”
;

334 
	g_´–ßds_³r_wÜk”
;

336 
bË_ü—tÜ_t
(
ShÜeTM1Env
* 
’v
,

337 cÚ¡ 
lßd”s
, cÚ¡ 
subs_³r_wÜk”
, cÚ¡ 
´–ßds_³r_wÜk”
)

338 : 
th»ad_t
("CR"), 
_’v
(
’v
),

339 
_lßd”s
(
lßd”s
),
_subs_³r_wÜk”
(
subs_³r_wÜk”
),
_´–ßds_³r_wÜk”
(
´–ßds_³r_wÜk”
)

341 
as£¹
 (
lßd”s
);

342 
as£¹
 (
subs_³r_wÜk”
);

343 
as£¹
 (
´–ßds_³r_wÜk”
>=0);

344 
as£¹
 (
subs_³r_wÜk”
>=
´–ßds_³r_wÜk”
);

346 
vœtu®
 
wÜk
();

351 
	gShÜeTM1Env
::
bË_ü—tÜ_t
::
	$wÜk
()

354 
	`W_COERCE
(
_’v
->
	`db
()->
	`begš_xù
());

355 
	`W_COERCE
(
_’v
->
_psub_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

356 
	`W_COERCE
(
_’v
->
_·i_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

357 
	`W_COERCE
(
_’v
->
_psf_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

358 
	`W_COERCE
(
_’v
->
_pcf_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

359 
	`W_COERCE
(
_’v
->
	`db
()->
	`comm™_xù
());

362 
_’v
->
_psub_mª
->
	`»gi¡”_bË_mª
();

363 
_’v
->
_·i_mª
->
	`»gi¡”_bË_mª
();

364 
_’v
->
_psf_mª
->
	`»gi¡”_bË_mª
();

365 
_’v
->
_pcf_mª
->
	`»gi¡”_bË_mª
();

369 
sub_id
 = 0;

370 
i
=0; i<
_lßd”s
; i++) {

371 
	`W_COERCE
(
_’v
->
	`db
()->
	`begš_xù
());

372 
	`TRACE
Ğ
TRACE_ALWAYS
, "Preloading (%d). Start (%d). Todo (%d)\n",

373 
i
, (i*
_subs_³r_wÜk”
), 
_´–ßds_³r_wÜk”
);

375 
j
=0; j<
_´–ßds_³r_wÜk”
; j++) {

376 
sub_id
 = 
i
*
_subs_³r_wÜk”
 + 
j
;

377 
	`W_COERCE
(
_’v
->
	`xù_pİuÏ‹_Úe
(
sub_id
+1));

379 
	`W_COERCE
(
_’v
->
	`db
()->
	`comm™_xù
());

381 
	}
}

392 şas 
	cShÜeTM1Env
::
bË_bud”_t
 : 
public
 
th»ad_t


394 
ShÜeTM1Env
* 
_’v
;

395 
	m_lßd”_id
;

396 
	m_¡¬t
;

397 
	m_couÁ
;

398 
	mpublic
:

399 
	$bË_bud”_t
(
ShÜeTM1Env
* 
’v
, 
lßd”id
, 
¡¬t
, 
couÁ
)

400 : 
	`th»ad_t
(
	`c_¡r
("LD-%d",
lßd”id
)),

401 
	`_’v
(
’v
), 
	`_lßd”_id
(
lßd”id
), 
	`_¡¬t
(
¡¬t
), 
	$_couÁ
(
couÁ
)

403 
vœtu®
 
	`wÜk
();

405 
	}
};

408 
	gShÜeTM1Env
::
bË_bud”_t
::
	$wÜk
()

410 
	`as£¹
 (
_couÁ
>=0);

412 
w_rc_t
 
e
 = 
RCOK
;

413 
comm™m¬k
 = 0;

414 
Œaûm¬k
 = 0;

415 
sub§dded
 = 0;

417 
	`W_COERCE
(
_’v
->
	`db
()->
	`begš_xù
());

420 
Ï¡_comm™
 = 0;

421 
sub§dded
=0; sub§dded<
_couÁ
; ++subsadded) {

422 
agaš
:

423 
sub_id
 = 
_¡¬t
 + 
sub§dded
;

426 
e
 = 
_’v
->
	`xù_pİuÏ‹_Úe
(
sub_id
+1);

428 if(
e
.
	`is_”rÜ
()) {

429 
	`W_COERCE
(
_’v
->
	`db
()->
	`abÜt_xù
());

430 if(
e
.
	`”r_num
(è=ğ
smËv–_0
::
eDEADLOCK
) {

431 
	`W_COERCE
(
_’v
->
	`db
()->
	`begš_xù
());

432 
sub§dded
 = 
Ï¡_comm™
 + 1;

433 
agaš
;

435 
¡ršg¡»am
 
os
;

436 
os
 << 
e
 << 
’ds
;

437 
¡ršg
 
¡r
 = 
os
.
	`¡r
();

438 
	`TRACE
Ğ
TRACE_ALWAYS
, "Unableo Insert Subscriber (%d) dueo:\n%s\n",

439 
sub_id
, 
¡r
.
	`c_¡r
());

443 ià(
sub§dded
>=
Œaûm¬k
) {

444 
	`TRACE
Ğ
TRACE_ALWAYS
, "Start (%d). Todo (%d). Added (%d)\n",

445 
_¡¬t
, 
_couÁ
, 
sub§dded
);

446 
Œaûm¬k
 +ğ
TM1_LOADING_TRACE_INTERVAL
;

450 ià(
sub§dded
>=
comm™m¬k
) {

451 
e
 = 
_’v
->
	`db
()->
	`comm™_xù
();

453 ià(
e
.
	`is_”rÜ
()) {

454 
¡ršg¡»am
 
os
;

455 
os
 << 
e
 << 
’ds
;

456 
¡ršg
 
¡r
 = 
os
.
	`¡r
();

457 
	`TRACE
Ğ
TRACE_ALWAYS
, "Unableo Commit (%d) dueo:\n%s\n",

458 
sub_id
, 
¡r
.
	`c_¡r
());

460 
w_rc_t
 
e2
 = 
_’v
->
	`db
()->
	`abÜt_xù
();

461 if(
e2
.
	`is_”rÜ
()) {

462 
	`TRACE
Ğ
TRACE_ALWAYS
,

464 
sub_id
, 
e2
.
	`”r_num
());

468 
Ï¡_comm™
 = 
sub§dded
;

469 
comm™m¬k
 +ğ
TM1_LOADING_COMMIT_INTERVAL
;

471 
	`W_COERCE
(
_’v
->
	`db
()->
	`begš_xù
());

476 
e
 = 
_’v
->
	`db
()->
	`comm™_xù
();

478 ià(
e
.
	`is_”rÜ
()) {

479 
¡ršg¡»am
 
os
;

480 
os
 << 
e
 << 
’ds
;

481 
¡ršg
 
¡r
 = 
os
.
	`¡r
();

482 
	`TRACE
Ğ
TRACE_ALWAYS
, "Unableo final Commit dueo:\n%s\n",

483 
¡r
.
	`c_¡r
());

485 
w_rc_t
 
e2
 = 
_’v
->
	`db
()->
	`abÜt_xù
();

486 if(
e2
.
	`is_”rÜ
()) {

487 
	`TRACE
Ğ
TRACE_ALWAYS
, "Unableo‡bortrx dueo [0x%x]\n",

488 
e2
.
	`”r_num
());

491 
	}
}

510 
w_rc_t
 
	gShÜeTM1Env
::
	$lßdd©a
()

513 
	`CRITICAL_SECTION
(
lßd_cs
, 
_lßd_mu‹x
);

514 ià(
_lßded
) {

515 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

517  (
RCOK
);

532 
lßd”s_to_u£
 = 
’vV¬
::
	`š¡ªû
()->
	`g‘V¬IÁ
("db-lßd”s",
TM1_LOADERS_TO_USE
);

533 
ü—tÜ_lßd”s_to_u£
 = 
lßd”s_to_u£
;

535 
tÙ®_subs
 = 
_sÿlšg_çùÜ
*
TM1_SUBS_PER_SF
;

536 
	`as£¹
 ((
tÙ®_subs
 % 
lßd”s_to_u£
) == 0);

538 
subs_³r_wÜk”
 = 
tÙ®_subs
/
lßd”s_to_u£
;

539 
´–ßds_³r_wÜk”
 = 
’vV¬
::
	`š¡ªû
()->
	`g‘V¬IÁ
("db-»cÜd-´–ßds",
TM1_SUBS_TO_PRELOAD
);

544 ià(
subs_³r_wÜk”
<
´–ßds_³r_wÜk”
) {

545 
´–ßds_³r_wÜk”
 = 
subs_³r_wÜk”
;

546 
lßd”s_to_u£
 = 0;

549 
time_t
 
t¡¬t
 = 
	`time
(
NULL
);

552 
gu¬d
<
bË_ü—tÜ_t
> 
tc
;

553 
tc
 = 
Ãw
 
	`bË_ü—tÜ_t
(
this
, 
ü—tÜ_lßd”s_to_u£
, 
subs_³r_wÜk”
, 
´–ßds_³r_wÜk”
);

554 
tc
->
	`fÜk
();

555 
tc
->
	`još
();

567 
¬¿y_gu¬d_t
< 
gu¬d
<
bË_bud”_t
> > 
	`lßd”s
(
Ãw
 gu¬d<bË_bud”_t>[
lßd”s_to_u£
]);

568 
i
=0; i<
lßd”s_to_u£
; i++) {

570 
¡¬t
 = 
i
*
subs_³r_wÜk”
 + 
´–ßds_³r_wÜk”
;

571 
couÁ
 = 
subs_³r_wÜk”
 - 
´–ßds_³r_wÜk”
;

572 
lßd”s
[
i
] = 
Ãw
 
	`bË_bud”_t
(
this
, i, 
¡¬t
, 
couÁ
);

573 
lßd”s
[
i
]->
	`fÜk
();

576 
i
=0; i<
lßd”s_to_u£
; i++) {

577 
lßd”s
[
i
]->
	`još
();

582 
time_t
 
t¡İ
 = 
	`time
(
NULL
);

585 
	`TRACE
Ğ
TRACE_STATISTICS
, "Loading finished. %d subscribers†oaded in (%d) secs...\n",

586 
tÙ®_subs
, (
t¡İ
 - 
t¡¬t
));

589 
_lßded
 = 
Œue
;

591  (
RCOK
);

592 
	}
}

601 
	gShÜeTM1Env
::
	$cÚf
()

604 
ShÜeEnv
::
	`cÚf
();

605 
	`upd_sf
();

606 
	`upd_wÜk”_út
();

608 
	}
}

618 
	gShÜeTM1Env
::
	$po¡_š™
()

621 
	}
}

624 
w_rc_t
 
	gShÜeTM1Env
::
	$_po¡_š™_im¶
()

626 
	`TRACE
(
TRACE_DEBUG
, "Doing‚othing\n");

627  (
RCOK
);

628 
	}
}

639 
w_rc_t
 
	gShÜeTM1Env
::
	$db_´št
(
lšes
)

642 
	`as£¹
 (
_pssm
);

643 
	`as£¹
 (
_š™Ÿlized
);

644 
	`as£¹
 (
_lßded
);

647 
	`W_DO
(
_psub_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

648 
	`W_DO
(
_·i_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

649 
	`W_DO
(
_psf_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

650 
	`W_DO
(
_pcf_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

652  (
RCOK
);

653 
	}
}

664 
w_rc_t
 
	gShÜeTM1Env
::
	$db_ãtch
()

667 
	`as£¹
 (
_pssm
);

668 
	`as£¹
 (
_š™Ÿlized
);

669 
	`as£¹
 (
_lßded
);

672 
	`W_DO
(
_psub_mª
->
	`ãtch_bË
(
_pssm
));

673 
	`W_DO
(
_·i_mª
->
	`ãtch_bË
(
_pssm
));

674 
	`W_DO
(
_psf_mª
->
	`ãtch_bË
(
_pssm
));

675 
	`W_DO
(
_pcf_mª
->
	`ãtch_bË
(
_pssm
));

677  (
RCOK
);

678 
	}
}

681 
EXIT_NAMESPACE
(
tm1
);

	@src/workload/tm1/shore_tm1_schema.cpp

31 
	~"wÜklßd/tm1/shÜe_tm1_schema.h
"

33 
usšg
 
Çme¥aû
 
	gshÜe
;

35 
ENTER_NAMESPACE
(
tm1
);

67 
	gsubsüib”_t
::
	$subsüib”_t
(cÚ¡ 
ušt4_t
& 
pd
)

68 #ifdeà
CFG_HACK


69 : 
	`bË_desc_t
("SUBSCRIBER", 
TM1_SUB_FCOUNT
+1, 
pd
)

71 : 
	`bË_desc_t
("SUBSCRIBER", 
TM1_SUB_FCOUNT
, 
pd
)

75 
_desc
[0].
	`£tup
(
SQL_INT
, "S_ID");

77 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "SUB_NBR", 
TM1_SUB_NBR_SZ
);

79 
_desc
[2].
	`£tup
(
SQL_BIT
, "BIT_1");

80 
_desc
[3].
	`£tup
(
SQL_BIT
, "BIT_2");

81 
_desc
[4].
	`£tup
(
SQL_BIT
, "BIT_3");

82 
_desc
[5].
	`£tup
(
SQL_BIT
, "BIT_4");

83 
_desc
[6].
	`£tup
(
SQL_BIT
, "BIT_5");

84 
_desc
[7].
	`£tup
(
SQL_BIT
, "BIT_6");

85 
_desc
[8].
	`£tup
(
SQL_BIT
, "BIT_7");

86 
_desc
[9].
	`£tup
(
SQL_BIT
, "BIT_8");

87 
_desc
[10].
	`£tup
(
SQL_BIT
, "BIT_9");

88 
_desc
[11].
	`£tup
(
SQL_BIT
, "BIT_10");

90 
_desc
[12].
	`£tup
(
SQL_SMALLINT
, "HEX_1");

91 
_desc
[13].
	`£tup
(
SQL_SMALLINT
, "HEX_2");

92 
_desc
[14].
	`£tup
(
SQL_SMALLINT
, "HEX_3");

93 
_desc
[15].
	`£tup
(
SQL_SMALLINT
, "HEX_4");

94 
_desc
[16].
	`£tup
(
SQL_SMALLINT
, "HEX_5");

95 
_desc
[17].
	`£tup
(
SQL_SMALLINT
, "HEX_6");

96 
_desc
[18].
	`£tup
(
SQL_SMALLINT
, "HEX_7");

97 
_desc
[19].
	`£tup
(
SQL_SMALLINT
, "HEX_8");

98 
_desc
[20].
	`£tup
(
SQL_SMALLINT
, "HEX_9");

99 
_desc
[21].
	`£tup
(
SQL_SMALLINT
, "HEX_10");

101 
_desc
[22].
	`£tup
(
SQL_SMALLINT
, "BYTE2_1");

102 
_desc
[23].
	`£tup
(
SQL_SMALLINT
, "BYTE2_2");

103 
_desc
[24].
	`£tup
(
SQL_SMALLINT
, "BYTE2_3");

104 
_desc
[25].
	`£tup
(
SQL_SMALLINT
, "BYTE2_4");

105 
_desc
[26].
	`£tup
(
SQL_SMALLINT
, "BYTE2_5");

106 
_desc
[27].
	`£tup
(
SQL_SMALLINT
, "BYTE2_6");

107 
_desc
[28].
	`£tup
(
SQL_SMALLINT
, "BYTE2_7");

108 
_desc
[29].
	`£tup
(
SQL_SMALLINT
, "BYTE2_8");

109 
_desc
[30].
	`£tup
(
SQL_SMALLINT
, "BYTE2_9");

110 
_desc
[31].
	`£tup
(
SQL_SMALLINT
, "BYTE2_10");

112 
_desc
[32].
	`£tup
(
SQL_INT
, "MSC_LOCATION");

113 
_desc
[33].
	`£tup
(
SQL_INT
, "VLR_LOCATION");

115 #ifdeà
CFG_HACK


116 
·ddšg_sz
 = 100-10*(
boŞ
)-20*()-3*()

117 -
TM1_SUB_NBR_SZ
*();

118 
_desc
[34].
	`£tup
(
SQL_FIXCHAR
, "S_PADDING", 
·ddšg_sz
);

122 
ušt
 
keys1
[1] = { 0 };

123 
	`ü—‹_´im¬y_idx_desc
("S_IDX", 0, 
keys1
, 1, 
pd
);

126 
ušt
 
keys2
[1] = { 1 };

128 #ifdeà
USE_DORA_EXT_IDX


129 ià(
pd
 & 
PD_NOLOCK
) {

133 
ušt
 
keys2_ext
[2] = { 1, 0 };

134 
	`ü—‹_šdex_desc
("SUB_NBR_IDX", 0, 
keys2_ext
, 2, 
Œue
, 
çl£
, (
pd
 ^ 
PD_NOLOCK
));

138 
	`ü—‹_šdex_desc
("SUB_NBR_IDX", 0, 
keys2
, 1, 
Œue
, 
çl£
, 
pd
);

139 
	}
}

142 
	gacûss_šfo_t
::
	$acûss_šfo_t
(cÚ¡ 
ušt4_t
& 
pd
)

143 #ifdeà
CFG_HACK


144 : 
	`bË_desc_t
("ACCESS_INFO", 
TM1_AI_FCOUNT
+1, 
pd
)

146 : 
	`bË_desc_t
("ACCESS_INFO", 
TM1_AI_FCOUNT
, 
pd
)

150 
_desc
[0].
	`£tup
(
SQL_INT
, "S_ID");

151 
_desc
[1].
	`£tup
(
SQL_SMALLINT
, "AI_TYPE");

152 
_desc
[2].
	`£tup
(
SQL_SMALLINT
, "DATA1");

153 
_desc
[3].
	`£tup
(
SQL_SMALLINT
, "DATA2");

154 
_desc
[4].
	`£tup
(
SQL_FIXCHAR
, "DATA3", 
TM1_AI_DATA3_SZ
);

155 
_desc
[5].
	`£tup
(
SQL_FIXCHAR
, "DATA4", 
TM1_AI_DATA4_SZ
);

158 #ifdeà
CFG_HACK


159 
·ddšg_sz
 = 50-3*()-1*()

160 -(
TM1_AI_DATA3_SZ
+
TM1_AI_DATA4_SZ
)*();

161 
_desc
[6].
	`£tup
(
SQL_FIXCHAR
, "AI_PADDING", 
·ddšg_sz
);

170 
ušt
 
keys
[2] = { 0, 1 };

171 
	`ü—‹_´im¬y_idx_desc
("AI_IDX", 0, 
keys
, 2, 
pd
);

172 
	}
}

176 
	g¥ecŸl_çc™y_t
::
	$¥ecŸl_çc™y_t
(cÚ¡ 
ušt4_t
& 
pd
)

177 #ifdeà
CFG_HACK


178 : 
	`bË_desc_t
("SPECIAL_FACILITY", 
TM1_SF_FCOUNT
+1, 
pd
)

180 : 
	`bË_desc_t
("SPECIAL_FACILITY", 
TM1_SF_FCOUNT
, 
pd
)

184 
_desc
[0].
	`£tup
(
SQL_INT
, "S_ID");

185 
_desc
[1].
	`£tup
(
SQL_SMALLINT
, "SF_TYPE");

186 
_desc
[2].
	`£tup
(
SQL_BIT
, "IS_ACTIVE");

187 
_desc
[3].
	`£tup
(
SQL_SMALLINT
, "ERROR_CNTRL");

188 
_desc
[4].
	`£tup
(
SQL_SMALLINT
, "DATA_A");

189 
_desc
[5].
	`£tup
(
SQL_FIXCHAR
, "DATA_B", 
TM1_SF_DATA_B_SZ
);

191 #ifdeà
CFG_HACK


192 
·ddšg_sz
 = 50-1*(
boŞ
)-3*()-1*()

193 -
TM1_SF_DATA_B_SZ
*();

194 
_desc
[6].
	`£tup
(
SQL_FIXCHAR
, "SF_PADDING", 
·ddšg_sz
);

203 
ušt
 
keys
[2] = { 0, 1 };

204 
	`ü—‹_´im¬y_idx_desc
("SF_IDX", 0, 
keys
, 2, 
pd
);

205 
	}
}

209 
	gÿÎ_fÜw¬dšg_t
::
	$ÿÎ_fÜw¬dšg_t
(cÚ¡ 
ušt4_t
& 
pd
)

210 #ifdeà
CFG_HACK


211 : 
	`bË_desc_t
("CALL_FORWARDING", 
TM1_CF_FCOUNT
+1, 
pd
)

213 : 
	`bË_desc_t
("CALL_FORWARDING", 
TM1_CF_FCOUNT
, 
pd
)

217 
_desc
[0].
	`£tup
(
SQL_INT
, "S_ID");

218 
_desc
[1].
	`£tup
(
SQL_SMALLINT
, "SF_TYPE");

219 
_desc
[2].
	`£tup
(
SQL_SMALLINT
, "START_TIME");

220 
_desc
[3].
	`£tup
(
SQL_SMALLINT
, "END_TIME");

221 
_desc
[4].
	`£tup
(
SQL_FIXCHAR
, "NUMBERX", 
TM1_CF_NUMBERX_SZ
);

223 #ifdeà
CFG_HACK


224 
·ddšg_sz
 = 50-3*()-1*()-
TM1_CF_NUMBERX_SZ
*();

225 
_desc
[5].
	`£tup
(
SQL_FIXCHAR
, "CF_PADDING", 
·ddšg_sz
);

229 
ušt
 
keys
[3] = { 0, 1, 2 };

230 
	`ü—‹_´im¬y_idx_desc
("CF_IDX", 0, 
keys
, 3, 
pd
);

231 
	}
}

234 
EXIT_NAMESPACE
(
tm1
);

	@src/workload/tm1/shore_tm1_schema_man.cpp

32 
	~"wÜklßd/tm1/shÜe_tm1_schema_mª.h
"

34 
usšg
 
Çme¥aû
 
	gshÜe
;

37 
ENTER_NAMESPACE
(
tm1
);

52 
w_rc_t
 
	gsub_mª_im¶
::
	$sub_idx_´obe
(
ss_m
* 
db
,

53 
sub_tu¶e
* 
±u¶e
,

54 cÚ¡ 
s_id
)

56 
	`as£¹
 (
±u¶e
);

57 
±u¶e
->
	`£t_v®ue
(0, 
s_id
);

58  (
	`šdex_´obe_by_Çme
(
db
, "S_IDX", 
±u¶e
));

59 
	}
}

61 
w_rc_t
 
	gsub_mª_im¶
::
	$sub_idx_upd
(
ss_m
* 
db
,

62 
sub_tu¶e
* 
±u¶e
,

63 cÚ¡ 
s_id
)

65 
	`as£¹
 (
±u¶e
);

66 
±u¶e
->
	`£t_v®ue
(0, 
s_id
);

67  (
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "S_IDX", 
±u¶e
));

68 
	}
}

70 
w_rc_t
 
	gsub_mª_im¶
::
	$sub_idx_Æ
(
ss_m
* 
db
,

71 
sub_tu¶e
* 
±u¶e
,

72 cÚ¡ 
s_id
)

74 
	`as£¹
 (
±u¶e
);

75 
±u¶e
->
	`£t_v®ue
(0, 
s_id
);

76  (
	`šdex_´obe_Æ_by_Çme
(
db
, "S_IDX", 
±u¶e
));

77 
	}
}

81 
w_rc_t
 
	gsub_mª_im¶
::
	$sub_nbr_idx_´obe
(
ss_m
* 
db
,

82 
sub_tu¶e
* 
±u¶e
,

83 cÚ¡ * 
s_nbr
)

85 
	`as£¹
 (
±u¶e
);

86 
±u¶e
->
	`£t_v®ue
(1, 
s_nbr
);

87  (
	`šdex_´obe_by_Çme
(
db
, "SUB_NBR_IDX", 
±u¶e
));

88 
	}
}

90 
w_rc_t
 
	gsub_mª_im¶
::
	$sub_nbr_idx_upd
(
ss_m
* 
db
,

91 
sub_tu¶e
* 
±u¶e
,

92 cÚ¡ * 
s_nbr
)

94 
	`as£¹
 (
±u¶e
);

95 
±u¶e
->
	`£t_v®ue
(1, 
s_nbr
);

96  (
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "SUB_NBR_IDX", 
±u¶e
));

97 
	}
}

99 
w_rc_t
 
	gsub_mª_im¶
::
	$sub_nbr_idx_Æ
(
ss_m
* 
db
,

100 
sub_tu¶e
* 
±u¶e
,

101 cÚ¡ * 
s_nbr
)

103 
	`as£¹
 (
±u¶e
);

104 
±u¶e
->
	`£t_v®ue
(1, 
s_nbr
);

105  (
	`šdex_´obe_Æ_by_Çme
(
db
, "SUB_NBR_IDX", 
±u¶e
));

106 
	}
}

110 
w_rc_t
 
	gsub_mª_im¶
::
	$sub_g‘_idx_™”
(
ss_m
* 
db
,

111 
sub_idx_™”
* &
™”
,

112 
sub_tu¶e
* 
±u¶e
,

113 
»p_row_t
 &
»¶ow
,

114 
»p_row_t
 &
»phigh
,

115 cÚ¡ 
sub_id
,

116 cÚ¡ 
ušt
 
¿nge
,

117 
lock_mode_t
 
®m
,

118 
boŞ
 
Ãed_tu¶e
)

120 
	`as£¹
 (
±u¶e
);

123 
	`as£¹
 (
_±abË
);

124 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("SUB_NBR_IDX");

125 
	`as£¹
 (
pšdex
);

127 
lowsz
, 
highsz
;

128 
aSubNbr
[
	`STRSIZE
(
TM1_SUB_NBR_SZ
)];

129 
	`mem£t
(
aSubNbr
,0,
	`STRSIZE
(
TM1_SUB_NBR_SZ
));

134 
	`¥rštf
(
aSubNbr
,"%015d",
sub_id
);

135 
±u¶e
->
	`£t_v®ue
(1, 
aSubNbr
);

137 #ifdeà
USE_DORA_EXT_IDX


139 if(!
Ãed_tu¶e
è{ 
±u¶e
->
	`£t_v®ue
(0, 0); }

142 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

143 
	`as£¹
 (
»¶ow
.
_de¡
);

146 
	`¥rštf
(
aSubNbr
,"%015d",(
sub_id
+
¿nge
));

147 
±u¶e
->
	`£t_v®ue
(1, 
aSubNbr
);

149 #ifdeà
USE_DORA_EXT_IDX


150 if(!
Ãed_tu¶e
è{ 
±u¶e
->
	`£t_v®ue
(0, 
MAX_INT
); }

153 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

154 
	`as£¹
 (
»phigh
.
_de¡
);

157 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
,

158 
®m
, 
Ãed_tu¶e
,

159 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

160 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

161  (
RCOK
);

162 
	}
}

170 
w_rc_t
 
	gai_mª_im¶
::
	$ai_idx_´obe
(
ss_m
* 
db
,

171 
ai_tu¶e
* 
±u¶e
,

172 cÚ¡ 
s_id
, cÚ¡ 
ai_ty³
)

174 
	`as£¹
 (
±u¶e
);

175 
±u¶e
->
	`£t_v®ue
(0, 
s_id
);

176 
±u¶e
->
	`£t_v®ue
(1, 
ai_ty³
);

177  (
	`šdex_´obe_by_Çme
(
db
, "AI_IDX", 
±u¶e
));

178 
	}
}

180 
w_rc_t
 
	gai_mª_im¶
::
	$ai_idx_upd
(
ss_m
* 
db
,

181 
ai_tu¶e
* 
±u¶e
,

182 cÚ¡ 
s_id
, cÚ¡ 
ai_ty³
)

184 
	`as£¹
 (
±u¶e
);

185 
±u¶e
->
	`£t_v®ue
(0, 
s_id
);

186 
±u¶e
->
	`£t_v®ue
(1, 
ai_ty³
);

187  (
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "AI_IDX", 
±u¶e
));

188 
	}
}

190 
w_rc_t
 
	gai_mª_im¶
::
	$ai_idx_Æ
(
ss_m
* 
db
,

191 
ai_tu¶e
* 
±u¶e
,

192 cÚ¡ 
s_id
, cÚ¡ 
ai_ty³
)

194 
	`as£¹
 (
±u¶e
);

195 
±u¶e
->
	`£t_v®ue
(0, 
s_id
);

196 
±u¶e
->
	`£t_v®ue
(1, 
ai_ty³
);

197  (
	`šdex_´obe_Æ_by_Çme
(
db
, "AI_IDX", 
±u¶e
));

198 
	}
}

207 
w_rc_t
 
	gsf_mª_im¶
::
	$sf_idx_´obe
(
ss_m
* 
db
,

208 
sf_tu¶e
* 
±u¶e
,

209 cÚ¡ 
s_id
, cÚ¡ 
sf_ty³
)

211 
	`as£¹
 (
±u¶e
);

212 
±u¶e
->
	`£t_v®ue
(0, 
s_id
);

213 
±u¶e
->
	`£t_v®ue
(1, 
sf_ty³
);

214  (
	`šdex_´obe_by_Çme
(
db
, "SF_IDX", 
±u¶e
));

215 
	}
}

217 
w_rc_t
 
	gsf_mª_im¶
::
	$sf_idx_upd
(
ss_m
* 
db
,

218 
sf_tu¶e
* 
±u¶e
,

219 cÚ¡ 
s_id
, cÚ¡ 
sf_ty³
)

221 
	`as£¹
 (
±u¶e
);

222 
±u¶e
->
	`£t_v®ue
(0, 
s_id
);

223 
±u¶e
->
	`£t_v®ue
(1, 
sf_ty³
);

224  (
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "SF_IDX", 
±u¶e
));

225 
	}
}

227 
w_rc_t
 
	gsf_mª_im¶
::
	$sf_idx_Æ
(
ss_m
* 
db
,

228 
sf_tu¶e
* 
±u¶e
,

229 cÚ¡ 
s_id
, cÚ¡ 
sf_ty³
)

231 
	`as£¹
 (
±u¶e
);

232 
±u¶e
->
	`£t_v®ue
(0, 
s_id
);

233 
±u¶e
->
	`£t_v®ue
(1, 
sf_ty³
);

234  (
	`šdex_´obe_Æ_by_Çme
(
db
, "SF_IDX", 
±u¶e
));

235 
	}
}

240 
w_rc_t
 
	gsf_mª_im¶
::
	$sf_g‘_idx_™”
(
ss_m
* 
db
,

241 
sf_idx_™”
* &
™”
,

242 
sf_tu¶e
* 
±u¶e
,

243 
»p_row_t
 &
»¶ow
,

244 
»p_row_t
 &
»phigh
,

245 cÚ¡ 
sub_id
,

246 
lock_mode_t
 
®m
,

247 
boŞ
 
Ãed_tu¶e
)

249 
	`as£¹
 (
±u¶e
);

252 
	`as£¹
 (
_±abË
);

253 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("SF_IDX");

254 
	`as£¹
 (
pšdex
);

259 
±u¶e
->
	`£t_v®ue
(0, 
sub_id
);

260 
±u¶e
->
	`£t_v®ue
(1, ()1);

262 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

263 
	`as£¹
 (
»¶ow
.
_de¡
);

265 
±u¶e
->
	`£t_v®ue
(1, ()4);

267 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

268 
	`as£¹
 (
»phigh
.
_de¡
);

271 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
,

272 
®m
, 
Ãed_tu¶e
,

273 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

274 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

275  (
RCOK
);

276 
	}
}

279 
w_rc_t
 
	gsf_mª_im¶
::
	$sf_g‘_idx_™”_Æ
(
ss_m
* 
db
,

280 
sf_idx_™”
* &
™”
,

281 
sf_tu¶e
* 
±u¶e
,

282 
»p_row_t
 &
»¶ow
,

283 
»p_row_t
 &
»phigh
,

284 cÚ¡ 
sub_id
,

285 
boŞ
 
Ãed_tu¶e
)

287  (
	`sf_g‘_idx_™”
(
db
,
™”
,
±u¶e
,
»¶ow
,
»phigh
,
sub_id
,
NL
,
Ãed_tu¶e
));

288 
	}
}

298 
w_rc_t
 
	gcf_mª_im¶
::
	$cf_idx_´obe
(
ss_m
* 
db
,

299 
cf_tu¶e
* 
±u¶e
,

300 cÚ¡ 
s_id
, cÚ¡ 
sf_ty³
,

301 cÚ¡ 
¡ime
)

303 
	`as£¹
 (
±u¶e
);

304 
±u¶e
->
	`£t_v®ue
(0, 
s_id
);

305 
±u¶e
->
	`£t_v®ue
(1, 
sf_ty³
);

306 
±u¶e
->
	`£t_v®ue
(2, 
¡ime
);

307  (
	`šdex_´obe_by_Çme
(
db
, "CF_IDX", 
±u¶e
));

308 
	}
}

310 
w_rc_t
 
	gcf_mª_im¶
::
	$cf_idx_upd
(
ss_m
* 
db
,

311 
cf_tu¶e
* 
±u¶e
,

312 cÚ¡ 
s_id
, cÚ¡ 
sf_ty³
,

313 cÚ¡ 
¡ime
)

315 
	`as£¹
 (
±u¶e
);

316 
±u¶e
->
	`£t_v®ue
(0, 
s_id
);

317 
±u¶e
->
	`£t_v®ue
(1, 
sf_ty³
);

318 
±u¶e
->
	`£t_v®ue
(2, 
¡ime
);

319  (
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "CF_IDX", 
±u¶e
));

320 
	}
}

322 
w_rc_t
 
	gcf_mª_im¶
::
	$cf_idx_Æ
(
ss_m
* 
db
,

323 
cf_tu¶e
* 
±u¶e
,

324 cÚ¡ 
s_id
, cÚ¡ 
sf_ty³
,

325 cÚ¡ 
¡ime
)

327 
	`as£¹
 (
±u¶e
);

328 
±u¶e
->
	`£t_v®ue
(0, 
s_id
);

329 
±u¶e
->
	`£t_v®ue
(1, 
sf_ty³
);

330 
±u¶e
->
	`£t_v®ue
(2, 
¡ime
);

331  (
	`šdex_´obe_Æ_by_Çme
(
db
, "CF_IDX", 
±u¶e
));

332 
	}
}

337 
w_rc_t
 
	gcf_mª_im¶
::
	$cf_g‘_idx_™”
(
ss_m
* 
db
,

338 
cf_idx_™”
* &
™”
,

339 
cf_tu¶e
* 
±u¶e
,

340 
»p_row_t
 &
»¶ow
,

341 
»p_row_t
 &
»phigh
,

342 cÚ¡ 
sub_id
,

343 cÚ¡ 
sf_ty³
,

344 cÚ¡ 
s_time
,

345 
lock_mode_t
 
®m
,

346 
boŞ
 
Ãed_tu¶e
)

348 
	`as£¹
 (
±u¶e
);

351 
	`as£¹
 (
_±abË
);

352 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("CF_IDX");

353 
	`as£¹
 (
pšdex
);

358 
±u¶e
->
	`£t_v®ue
(0, 
sub_id
);

359 
±u¶e
->
	`£t_v®ue
(1, 
sf_ty³
);

360 
±u¶e
->
	`£t_v®ue
(2, 
s_time
);

362 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

363 
	`as£¹
 (
»¶ow
.
_de¡
);

366 
±u¶e
->
	`£t_v®ue
(2, ()24);

368 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

369 
	`as£¹
 (
»phigh
.
_de¡
);

372 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
,

373 
®m
, 
Ãed_tu¶e
,

374 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

375 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

376  (
RCOK
);

377 
	}
}

380 
w_rc_t
 
	gcf_mª_im¶
::
	$cf_g‘_idx_™”_Æ
(
ss_m
* 
db
,

381 
cf_idx_™”
* &
™”
,

382 
cf_tu¶e
* 
±u¶e
,

383 
»p_row_t
 &
»¶ow
,

384 
»p_row_t
 &
»phigh
,

385 cÚ¡ 
sub_id
,

386 cÚ¡ 
sf_ty³
,

387 cÚ¡ 
s_time
,

388 
boŞ
 
Ãed_tu¶e
)

390  (
	`cf_g‘_idx_™”
(
db
,
™”
,
±u¶e
,
»¶ow
,
»phigh
,
sub_id
,
sf_ty³
,
s_time
,
NL
,
Ãed_tu¶e
));

391 
	}
}

394 
EXIT_NAMESPACE
(
tm1
);

	@src/workload/tm1/shore_tm1_xct.cpp

31 
	~"wÜklßd/tm1/shÜe_tm1_’v.h
"

32 
	~"wÜklßd/tm1/tm1_šput.h
"

34 
	~<veùÜ
>

35 
	~<num”ic
>

36 
	~<®gÜ™hm
>

38 
usšg
 
Çme¥aû
 
	gshÜe
;

41 
ENTER_NAMESPACE
(
tm1
);

52 
__th»ad
 
ShÜeTM1TrxSts
 
	gmy_¡©s
;

54 
	gShÜeTM1Env
::
	$’v_th»ad_š™
()

56 
	`CRITICAL_SECTION
(
¡©_mu‹x_cs
, 
_¡©m­_mu‹x
);

57 
_¡©m­
[
	`±h»ad_£lf
()] = &
my_¡©s
;

58 
	}
}

60 
	gShÜeTM1Env
::
	$’v_th»ad_fši
()

62 
	`CRITICAL_SECTION
(
¡©_mu‹x_cs
, 
_¡©m­_mu‹x
);

63 
_¡©m­
.
	`”a£
(
	`±h»ad_£lf
());

64 
	}
}

76 
ShÜeTM1TrxSts
 
	gShÜeTM1Env
::
	$_g‘_¡©s
()

78 
	`CRITICAL_SECTION
(
cs
, 
_¡©m­_mu‹x
);

79 
ShÜeTM1TrxSts
 
rv®
;

80 
rv®
 -=„val;

81 
¡©m­_t
::
™”©Ü
 
™
=
_¡©m­
.
	`begš
(); iˆ!ğ_¡©m­.
	`’d
(); ++it)

82 
rv®
 +ğ*
™
->
£cÚd
;

83  (
rv®
);

84 
	}
}

95 
	gShÜeTM1Env
::
	$»£t_¡©s
()

97 
	`CRITICAL_SECTION
(
Ï¡_¡©s_cs
, 
_Ï¡_¡©s_mu‹x
);

98 
_Ï¡_¡©s
 = 
	`_g‘_¡©s
();

99 
	}
}

110 
	gShÜeTM1Env
::
	$´št_throughput
(cÚ¡ 
iQu”›dSF
,

111 cÚ¡ 
iS´—d
,

112 cÚ¡ 
iNumOfTh»ads
,

113 cÚ¡ 
d–ay
,

114 cÚ¡ 
ulÚg_t
 
mioch
,

115 cÚ¡ 
avgıuu§ge
)

117 
	`CRITICAL_SECTION
(
Ï¡_¡©s_cs
, 
_Ï¡_¡©s_mu‹x
);

120 
ShÜeTM1TrxSts
 
cu¼’t_¡©s
 = 
	`_g‘_¡©s
();

123 
cu¼’t_¡©s
 -ğ
_Ï¡_¡©s
;

125 
ušt
 
Œxs_©t
 = 
cu¼’t_¡©s
.
©‹m±ed
.
	`tÙ®
();

126 
ušt
 
Œxs_abt
 = 
cu¼’t_¡©s
.
çed
.
	`tÙ®
();

127 
ušt
 
Œxs_dld
 = 
cu¼’t_¡©s
.
d—dlocked
.
	`tÙ®
();

129 
	`TRACE
Ğ
TRACE_ALWAYS
, "*******\n" \

141 
iQu”›dSF
,

142 (
iS´—d
 ? "Yes" : "No"),

143 
iNumOfTh»ads
, 
Œxs_©t
, 
Œxs_abt
, 
Œxs_dld
,

144 (()100*(
Œxs_©t
-
Œxs_abt
-
Œxs_dld
))/()trxs_att,

145 
d–ay
, 
mioch
/d–ay, 
avgıuu§ge
,

146 100*
avgıuu§ge
/
	`g‘_max_ıu_couÁ
(),

147 (
Œxs_©t
-
Œxs_abt
-
Œxs_dld
)/
d–ay
);

148 
	}
}

174 
w_rc_t
 
	gShÜeTM1Env
::
	$run_Úe_xù
(
Reque¡
* 
´eque¡
)

176 
	`as£¹
 (
´eque¡
);

178 if(
_¡¬t_imb®ªû
 > 0 && !
_bAÏrmS‘
) {

179 
	`CRITICAL_SECTION
(
®¬m_cs
, 
_®¬m_lock
);

180 if(!
_bAÏrmS‘
) {

181 
	`®¬m
(
_¡¬t_imb®ªû
);

182 
_bAÏrmS‘
 = 
Œue
;

187 ià(
´eque¡
->
	`ty³
(è=ğ
XCT_TM1_MIX
) {

188 
´eque¡
->
	`£t_ty³
(
	`¿ndom_tm1_xù_ty³
(
smth»ad_t
::
	`¿nd
()%100));

191 
´eque¡
->
	`ty³
()) {

194 
XCT_TM1_GET_SUB_DATA
:

195  (
	`run_g‘_sub_d©a
(
´eque¡
));

196 
XCT_TM1_GET_NEW_DEST
:

197  (
	`run_g‘_Ãw_de¡
(
´eque¡
));

198 
XCT_TM1_GET_ACC_DATA
:

199  (
	`run_g‘_acc_d©a
(
´eque¡
));

200 
XCT_TM1_UPD_SUB_DATA
:

201  (
	`run_upd_sub_d©a
(
´eque¡
));

202 
XCT_TM1_UPD_LOCATION
:

203  (
	`run_upd_loc
(
´eque¡
));

204 
XCT_TM1_INS_CALL_FWD
:

205  (
	`run_šs_ÿÎ_fwd
(
´eque¡
));

206 
XCT_TM1_DEL_CALL_FWD
:

207  (
	`run_d–_ÿÎ_fwd
(
´eque¡
));

208 
XCT_TM1_CALL_FWD_MIX
:

210 ià(
	`URªd
(1,100)>50)

211  (
	`run_šs_ÿÎ_fwd
(
´eque¡
));

213  (
	`run_d–_ÿÎ_fwd
(
´eque¡
));

215 
XCT_TM1_GET_SUB_NBR
:

216  (
	`run_g‘_sub_nbr
(
´eque¡
));

218 
XCT_TM1_INS_CALL_FWD_BENCH
:

219  (
	`run_šs_ÿÎ_fwd_b’ch
(
´eque¡
));

220 
XCT_TM1_DEL_CALL_FWD_BENCH
:

221  (
	`run_d–_ÿÎ_fwd_b’ch
(
´eque¡
));

222 
XCT_TM1_CALL_FWD_MIX_BENCH
:

224 ià(
	`URªd
(1,100)>50)

225  (
	`run_šs_ÿÎ_fwd_b’ch
(
´eque¡
));

227  (
	`run_d–_ÿÎ_fwd_b’ch
(
´eque¡
));

230 
	`as£¹
 (0);

232  (
RCOK
);

233 
	}
}

252 
DEFINE_TRX
(
ShÜeTM1Env
,
g‘_sub_d©a
);

253 
DEFINE_TRX
(
ShÜeTM1Env
,
g‘_Ãw_de¡
);

254 
DEFINE_TRX
(
ShÜeTM1Env
,
g‘_acc_d©a
);

255 
DEFINE_TRX
(
ShÜeTM1Env
,
upd_sub_d©a
);

256 
DEFINE_TRX
(
ShÜeTM1Env
,
upd_loc
);

257 
DEFINE_TRX
(
ShÜeTM1Env
,
šs_ÿÎ_fwd
);

258 
DEFINE_TRX
(
ShÜeTM1Env
,
d–_ÿÎ_fwd
);

260 
DEFINE_TRX
(
ShÜeTM1Env
,
g‘_sub_nbr
);

262 
DEFINE_TRX
(
ShÜeTM1Env
,
šs_ÿÎ_fwd_b’ch
);

263 
DEFINE_TRX
(
ShÜeTM1Env
,
d–_ÿÎ_fwd_b’ch
);

279 
w_rc_t
 
	gShÜeTM1Env
::
	$xù_pİuÏ‹_Úe
(cÚ¡ 
sub_id
)

281 
	`as£¹
 (
sub_id
>=0);

284 
tu¶e_gu¬d
<
sub_mª_im¶
> 
	`´sub
(
_psub_mª
);

285 
tu¶e_gu¬d
<
ai_mª_im¶
> 
	`´ai
(
_·i_mª
);

286 
tu¶e_gu¬d
<
sf_mª_im¶
> 
	`´sf
(
_psf_mª
);

287 
tu¶e_gu¬d
<
cf_mª_im¶
> 
	`´cf
(
_pcf_mª
);

289 
»p_row_t
 
	`¬•row
(
_psub_mª
->
	`ts
());

290 
»p_row_t
 
	`¬•row_key
(
_psub_mª
->
	`ts
());

293 
¬•row
.
	`£t
(
_psub_desc
->
	`maxsize
());

294 
¬•row_key
.
	`£t
(
_psub_desc
->
	`maxsize
());

296 
´sub
->
_»p
 = &
¬•row
;

297 
´ai
->
_»p
 = &
¬•row
;

298 
´sf
->
_»p
 = &
¬•row
;

299 
´cf
->
_»p
 = &
¬•row
;

300 
´sub
->
_»p_key
 = &
¬•row_key
;

301 
´ai
->
_»p_key
 = &
¬•row_key
;

302 
´sf
->
_»p_key
 = &
¬•row_key
;

303 
´cf
->
_»p_key
 = &
¬•row_key
;

305 
i
,
j
=0;

308 
num_ai
 = 
	`URªd
(
TM1_MIN_AI_PER_SUBSCR
,

309 
TM1_MAX_AI_PER_SUBSCR
);

312 
num_sf
 = 
	`URªd
(
TM1_MIN_SF_PER_SUBSCR
,

313 
TM1_MAX_SF_PER_SUBSCR
);

315 
num_cf
 = 0;

319 
´sub
->
	`£t_v®ue
(0, 
sub_id
);

320 
asubnbr
[
	`STRSIZE
(
TM1_SUB_NBR_SZ
)];

321 
	`mem£t
(
asubnbr
,0,
	`STRSIZE
(
TM1_SUB_NBR_SZ
));

322 
	`¥rštf
(
asubnbr
,"%015d",
sub_id
);

323 
´sub
->
	`£t_v®ue
(1, 
asubnbr
);

326 
´sub
->
	`£t_v®ue
(2, 
	`URªdBoŞ
());

327 
´sub
->
	`£t_v®ue
(3, 
	`URªdBoŞ
());

328 
´sub
->
	`£t_v®ue
(4, 
	`URªdBoŞ
());

329 
´sub
->
	`£t_v®ue
(5, 
	`URªdBoŞ
());

330 
´sub
->
	`£t_v®ue
(6, 
	`URªdBoŞ
());

331 
´sub
->
	`£t_v®ue
(7, 
	`URªdBoŞ
());

332 
´sub
->
	`£t_v®ue
(8, 
	`URªdBoŞ
());

333 
´sub
->
	`£t_v®ue
(9, 
	`URªdBoŞ
());

334 
´sub
->
	`£t_v®ue
(10, 
	`URªdBoŞ
());

335 
´sub
->
	`£t_v®ue
(11, 
	`URªdBoŞ
());

338 
´sub
->
	`£t_v®ue
(12, 
	`URªdShÜt
(0,15));

339 
´sub
->
	`£t_v®ue
(13, 
	`URªdShÜt
(0,15));

340 
´sub
->
	`£t_v®ue
(14, 
	`URªdShÜt
(0,15));

341 
´sub
->
	`£t_v®ue
(15, 
	`URªdShÜt
(0,15));

342 
´sub
->
	`£t_v®ue
(16, 
	`URªdShÜt
(0,15));

343 
´sub
->
	`£t_v®ue
(17, 
	`URªdShÜt
(0,15));

344 
´sub
->
	`£t_v®ue
(18, 
	`URªdShÜt
(0,15));

345 
´sub
->
	`£t_v®ue
(19, 
	`URªdShÜt
(0,15));

346 
´sub
->
	`£t_v®ue
(20, 
	`URªdShÜt
(0,15));

347 
´sub
->
	`£t_v®ue
(21, 
	`URªdShÜt
(0,15));

350 
´sub
->
	`£t_v®ue
(22, 
	`URªdShÜt
(0,255));

351 
´sub
->
	`£t_v®ue
(23, 
	`URªdShÜt
(0,255));

352 
´sub
->
	`£t_v®ue
(24, 
	`URªdShÜt
(0,255));

353 
´sub
->
	`£t_v®ue
(25, 
	`URªdShÜt
(0,255));

354 
´sub
->
	`£t_v®ue
(26, 
	`URªdShÜt
(0,255));

355 
´sub
->
	`£t_v®ue
(27, 
	`URªdShÜt
(0,255));

356 
´sub
->
	`£t_v®ue
(28, 
	`URªdShÜt
(0,255));

357 
´sub
->
	`£t_v®ue
(29, 
	`URªdShÜt
(0,255));

358 
´sub
->
	`£t_v®ue
(30, 
	`URªdShÜt
(0,255));

359 
´sub
->
	`£t_v®ue
(31, 
	`URªdShÜt
(0,255));

361 
´sub
->
	`£t_v®ue
(32, 
	`URªd
(0,(2<<16)-1));

362 
´sub
->
	`£t_v®ue
(33, 
	`URªd
(0,(2<<16)-1));

364 #ifdeà
CFG_HACK


365 
´sub
->
	`£t_v®ue
(34, "padding");

368 
	`W_DO
(
_psub_mª
->
	`add_tu¶e
(
_pssm
, 
´sub
));

370 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Added SUB - (%d)\n", 
sub_id
);

372 
ty³
;

376 
i
=0; i<
num_ai
; ++i) {

378 
´ai
->
	`£t_v®ue
(0, 
sub_id
);

381 
ty³
 = 
i
+1;

382 
´ai
->
	`£t_v®ue
(1, 
ty³
);

385 
´ai
->
	`£t_v®ue
(2, 
	`URªdShÜt
(0,255));

386 
´ai
->
	`£t_v®ue
(3, 
	`URªdShÜt
(0,255));

389 
d©a3
[
TM1_AI_DATA3_SZ
];

390 
	`URªdFlSŒC­s
(
d©a3
,
TM1_AI_DATA3_SZ
);

391 
´ai
->
	`£t_v®ue
(4, 
d©a3
);

393 
d©a4
[
TM1_AI_DATA4_SZ
];

394 
	`URªdFlSŒC­s
(
d©a4
,
TM1_AI_DATA4_SZ
);

395 
´ai
->
	`£t_v®ue
(5, 
d©a4
);

397 #ifdeà
CFG_HACK


398 
´ai
->
	`£t_v®ue
(6, "padding");

401 
	`W_DO
(
_·i_mª
->
	`add_tu¶e
(
_pssm
, 
´ai
));

403 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Added AI-%d - (%d|%d|%s|%s)\n",

404 
i
,
sub_id
,i+1,
d©a3
,
d©a4
);

409 
i
=0; i<
num_sf
; ++i) {

411 
´sf
->
	`£t_v®ue
(0, 
sub_id
);

414 
ty³
 = 
i
+1;

415 
´sf
->
	`£t_v®ue
(1, 
ty³
);

417 
´sf
->
	`£t_v®ue
(2, (
	`URªd
(1,100)<85? 
Œue
 : 
çl£
));

418 
´sf
->
	`£t_v®ue
(3, 
	`URªdShÜt
(0,255));

419 
´sf
->
	`£t_v®ue
(4, 
	`URªdShÜt
(0,255));

422 
d©ab
[
TM1_SF_DATA_B_SZ
];

423 
	`URªdFlSŒC­s
(
d©ab
,
TM1_SF_DATA_B_SZ
);

424 
´sf
->
	`£t_v®ue
(5, 
d©ab
);

426 #ifdeà
CFG_HACK


427 
´sf
->
	`£t_v®ue
(6, "padding");

430 
	`W_DO
(
_psf_mª
->
	`add_tu¶e
(
_pssm
, 
´sf
));

432 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Added SF-%d - (%d|%d|%s)\n",

433 
i
,
sub_id
,i+1,
d©ab
);

438 
num_cf
 = 
	`URªd
(
TM1_MIN_CF_PER_SF
,

439 
TM1_MAX_CF_PER_SF
);

441 
©ime
;

443 
j
=0; j<
num_cf
; ++j) {

445 
´cf
->
	`£t_v®ue
(0, 
sub_id
);

447 
ty³
 = 
i
+1;

448 
´cf
->
	`£t_v®ue
(1, 
ty³
);

450 
©ime
 = 
j
*8;

451 
´cf
->
	`£t_v®ue
(2, 
©ime
);

453 
©ime
 = 
j
*8 + 
	`URªdShÜt
(1,8);

454 
´cf
->
	`£t_v®ue
(3, 
©ime
);

456 
numbx
[
TM1_CF_NUMBERX_SZ
];

457 
	`URªdFlSŒNumbx
(
numbx
,
TM1_CF_NUMBERX_SZ
);

458 
´cf
->
	`£t_v®ue
(4, 
numbx
);

459 #ifdeà
CFG_HACK


460 
´cf
->
	`£t_v®ue
(5, "padding");

463 
	`W_DO
(
_pcf_mª
->
	`add_tu¶e
(
_pssm
, 
´cf
));

465 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Added CF-%d - (%d|%d|%d)\n",

466 
i
,
sub_id
,i+1,
j
*8);

470  
RCOK
;

471 
	}
}

482 
w_rc_t
 
	gShÜeTM1Env
::
	$xù_g‘_sub_d©a
(cÚ¡ 
xù_id
,

483 
g‘_sub_d©a_šput_t
& 
gsdš
)

486 
	`as£¹
 (
_pssm
);

487 
	`as£¹
 (
_š™Ÿlized
);

488 
	`as£¹
 (
_lßded
);

492 
tu¶e_gu¬d
<
sub_mª_im¶
> 
	`´sub
(
_psub_mª
);

494 
»p_row_t
 
	`¬•row
(
_psub_mª
->
	`ts
());

497 
¬•row
.
	`£t
(
_psub_desc
->
	`maxsize
());

499 
´sub
->
_»p
 = &
¬•row
;

512 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d GSD:sub-idx-probe (%d)\n",

513 
xù_id
, 
gsdš
.
_s_id
);

514 
	`W_DO
(
_psub_mª
->
	`sub_idx_´obe
(
_pssm
, 
´sub
, 
gsdš
.
_s_id
));

516 
tm1_sub_t
 
asub
;

520 
´sub
->
	`g‘_v®ue
(0, 
asub
.
S_ID
);

521 
´sub
->
	`g‘_v®ue
(1, 
asub
.
SUB_NBR
, 17);

524 
´sub
->
	`g‘_v®ue
(2, 
asub
.
BIT_XX
[0]);

525 
´sub
->
	`g‘_v®ue
(3, 
asub
.
BIT_XX
[1]);

526 
´sub
->
	`g‘_v®ue
(4, 
asub
.
BIT_XX
[2]);

527 
´sub
->
	`g‘_v®ue
(5, 
asub
.
BIT_XX
[3]);

528 
´sub
->
	`g‘_v®ue
(6, 
asub
.
BIT_XX
[4]);

529 
´sub
->
	`g‘_v®ue
(7, 
asub
.
BIT_XX
[5]);

530 
´sub
->
	`g‘_v®ue
(8, 
asub
.
BIT_XX
[6]);

531 
´sub
->
	`g‘_v®ue
(9, 
asub
.
BIT_XX
[7]);

532 
´sub
->
	`g‘_v®ue
(10, 
asub
.
BIT_XX
[8]);

533 
´sub
->
	`g‘_v®ue
(11, 
asub
.
BIT_XX
[9]);

536 
´sub
->
	`g‘_v®ue
(12, 
asub
.
HEX_XX
[0]);

537 
´sub
->
	`g‘_v®ue
(13, 
asub
.
HEX_XX
[1]);

538 
´sub
->
	`g‘_v®ue
(14, 
asub
.
HEX_XX
[2]);

539 
´sub
->
	`g‘_v®ue
(15, 
asub
.
HEX_XX
[3]);

540 
´sub
->
	`g‘_v®ue
(16, 
asub
.
HEX_XX
[4]);

541 
´sub
->
	`g‘_v®ue
(17, 
asub
.
HEX_XX
[5]);

542 
´sub
->
	`g‘_v®ue
(18, 
asub
.
HEX_XX
[6]);

543 
´sub
->
	`g‘_v®ue
(19, 
asub
.
HEX_XX
[7]);

544 
´sub
->
	`g‘_v®ue
(20, 
asub
.
HEX_XX
[8]);

545 
´sub
->
	`g‘_v®ue
(21, 
asub
.
HEX_XX
[9]);

548 
´sub
->
	`g‘_v®ue
(22, 
asub
.
BYTE2_XX
[0]);

549 
´sub
->
	`g‘_v®ue
(23, 
asub
.
BYTE2_XX
[1]);

550 
´sub
->
	`g‘_v®ue
(24, 
asub
.
BYTE2_XX
[2]);

551 
´sub
->
	`g‘_v®ue
(25, 
asub
.
BYTE2_XX
[3]);

552 
´sub
->
	`g‘_v®ue
(26, 
asub
.
BYTE2_XX
[4]);

553 
´sub
->
	`g‘_v®ue
(27, 
asub
.
BYTE2_XX
[5]);

554 
´sub
->
	`g‘_v®ue
(28, 
asub
.
BYTE2_XX
[6]);

555 
´sub
->
	`g‘_v®ue
(29, 
asub
.
BYTE2_XX
[7]);

556 
´sub
->
	`g‘_v®ue
(30, 
asub
.
BYTE2_XX
[8]);

557 
´sub
->
	`g‘_v®ue
(31, 
asub
.
BYTE2_XX
[9]);

559 
´sub
->
	`g‘_v®ue
(32, 
asub
.
MSC_LOCATION
);

560 
´sub
->
	`g‘_v®ue
(33, 
asub
.
VLR_LOCATION
);

562 #ifdeà
PRINT_TRX_RESULTS


565 
´sub
->
	`´št_tu¶e
();

568  
RCOK
;

570 
	}
}

581 
w_rc_t
 
	gShÜeTM1Env
::
	$xù_g‘_Ãw_de¡
(cÚ¡ 
xù_id
,

582 
g‘_Ãw_de¡_šput_t
& 
gndš
)

585 
	`as£¹
 (
_pssm
);

586 
	`as£¹
 (
_š™Ÿlized
);

587 
	`as£¹
 (
_lßded
);

591 
tu¶e_gu¬d
<
sf_mª_im¶
> 
	`´sf
(
_psf_mª
);

592 
tu¶e_gu¬d
<
cf_mª_im¶
> 
	`´cf
(
_pcf_mª
);

595 
»p_row_t
 
	`¬•row
(
_pcf_mª
->
	`ts
());

597 
¬•row
.
	`£t
(
_pcf_desc
->
	`maxsize
());

599 
´sf
->
_»p
 = &
¬•row
;

600 
´cf
->
_»p
 = &
¬•row
;

602 
»p_row_t
 
	`low»p
(
_pcf_mª
->
	`ts
());

603 
»p_row_t
 
	`high»p
(
_pcf_mª
->
	`ts
());

604 
low»p
.
	`£t
(
_pcf_desc
->
	`maxsize
());

605 
high»p
.
	`£t
(
_pcf_desc
->
	`maxsize
());

607 
tm1_sf_t
 
asf
;

608 
tm1_cf_t
 
acf
;

609 
boŞ
 
eof
;

610 
boŞ
 
bFound
 = 
çl£
;

631 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d GND:sf-idx-probe (%d) (%d)\n",

632 
xù_id
, 
gndš
.
_s_id
, gndš.
_sf_ty³
);

633 
	`W_DO
(
_psf_mª
->
	`sf_idx_´obe
(
_pssm
, 
´sf
,

634 
gndš
.
_s_id
, gndš.
_sf_ty³
));

635 
´sf
->
	`g‘_v®ue
(2, 
asf
.
IS_ACTIVE
);

639 ià(
asf
.
IS_ACTIVE
) {

640 
gu¬d
<
šdex_sÿn_™”_im¶
<
ÿÎ_fÜw¬dšg_t
> > 
cf_™”
;

642 
šdex_sÿn_™”_im¶
<
ÿÎ_fÜw¬dšg_t
>* 
tmp_cf_™”
;

643 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d GND:cf-idx-™”\n", 
xù_id
);

644 
	`W_DO
(
_pcf_mª
->
	`cf_g‘_idx_™”
(
_pssm
, 
tmp_cf_™”
, 
´cf
,

645 
low»p
, 
high»p
,

646 
gndš
.
_s_id
, gndš.
_sf_ty³
,

647 
gndš
.
_s_time
));

648 
cf_™”
 = 
tmp_cf_™”
;

650 
	`W_DO
(
cf_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cf
));

651 !
eof
) {

653 
´cf
->
	`g‘_v®ue
(3, 
acf
.
END_TIME
);

654 ià(
acf
.
END_TIME
 > 
gndš
.
_e_time
) {

655 
´cf
->
	`g‘_v®ue
(4, 
acf
.
NUMBERX
, 17);

656 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d GND: found (%d) (%d) (%s)\n",

657 
xù_id
, 
gndš
.
_e_time
, 
acf
.
END_TIME
,‡cf.
NUMBERX
);

658 
bFound
 = 
Œue
;

660 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d GND:cf-idx-™”-Ãxt\n", 
xù_id
);

661 
	`W_DO
(
cf_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cf
));

664 ià(!
bFound
) {

665  
	`RC
(
£_NO_CURRENT_TUPLE
);

668 #ifdeà
PRINT_TRX_RESULTS


671 
´sf
->
	`´št_tu¶e
();

672 
´cf
->
	`´št_tu¶e
();

675  
RCOK
;

677 
	}
}

688 
w_rc_t
 
	gShÜeTM1Env
::
	$xù_g‘_acc_d©a
(cÚ¡ 
xù_id
,

689 
g‘_acc_d©a_šput_t
& 
gadš
)

692 
	`as£¹
 (
_pssm
);

693 
	`as£¹
 (
_š™Ÿlized
);

694 
	`as£¹
 (
_lßded
);

698 
tu¶e_gu¬d
<
ai_mª_im¶
> 
	`´ai
(
_·i_mª
);

700 
»p_row_t
 
	`¬•row
(
_·i_mª
->
	`ts
());

703 
¬•row
.
	`£t
(
_·i_desc
->
	`maxsize
());

705 
´ai
->
_»p
 = &
¬•row
;

717 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d GAD:ai-idx-probe (%d) (%d)\n",

718 
xù_id
, 
gadš
.
_s_id
, gadš.
_ai_ty³
);

719 
	`W_DO
(
_·i_mª
->
	`ai_idx_´obe
(
_pssm
, 
´ai
, 
gadš
.
_s_id
, gadš.
_ai_ty³
));

720 
tm1_ai_t
 
¯i
;

721 
´ai
->
	`g‘_v®ue
(2, 
¯i
.
DATA1
);

722 
´ai
->
	`g‘_v®ue
(3, 
¯i
.
DATA2
);

723 
´ai
->
	`g‘_v®ue
(4, 
¯i
.
DATA3
, 5);

724 
´ai
->
	`g‘_v®ue
(5, 
¯i
.
DATA4
, 9);

726 #ifdeà
PRINT_TRX_RESULTS


729 
´ai
->
	`´št_tu¶e
();

732  
RCOK
;

734 
	}
}

745 
w_rc_t
 
	gShÜeTM1Env
::
	$xù_upd_sub_d©a
(cÚ¡ 
xù_id
,

746 
upd_sub_d©a_šput_t
& 
usdš
)

749 
	`as£¹
 (
_pssm
);

750 
	`as£¹
 (
_š™Ÿlized
);

751 
	`as£¹
 (
_lßded
);

755 
tu¶e_gu¬d
<
sub_mª_im¶
> 
	`´sub
(
_psub_mª
);

756 
tu¶e_gu¬d
<
sf_mª_im¶
> 
	`´sf
(
_psf_mª
);

758 
»p_row_t
 
	`¬•row
(
_psub_mª
->
	`ts
());

761 
¬•row
.
	`£t
(
_psub_desc
->
	`maxsize
());

763 
´sub
->
_»p
 = &
¬•row
;

764 
´sf
->
_»p
 = &
¬•row
;

786 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d USD:sf-idx-upd (%d) (%d)\n",

787 
xù_id
, 
usdš
.
_s_id
, usdš.
_sf_ty³
);

788 
	`W_DO
(
_psf_mª
->
	`sf_idx_upd
(
_pssm
, 
´sf
, 
usdš
.
_s_id
, usdš.
_sf_ty³
));

789 
´sf
->
	`£t_v®ue
(4, 
usdš
.
_a_d©a
);

790 
	`W_DO
(
_psf_mª
->
	`upd©e_tu¶e
(
_pssm
, 
´sf
));

793 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d USD:sub-idx-upd (%d)\n",

794 
xù_id
, 
usdš
.
_s_id
);

795 
	`W_DO
(
_psub_mª
->
	`sub_idx_upd
(
_pssm
, 
´sub
, 
usdš
.
_s_id
));

796 
´sub
->
	`£t_v®ue
(2, 
usdš
.
_a_b™
);

797 
	`W_DO
(
_psub_mª
->
	`upd©e_tu¶e
(
_pssm
, 
´sub
));

799 #ifdeà
PRINT_TRX_RESULTS


802 
´sub
->
	`´št_tu¶e
();

803 
´sf
->
	`´št_tu¶e
();

806  
RCOK
;

808 
	}
}

819 
w_rc_t
 
	gShÜeTM1Env
::
	$xù_upd_loc
(cÚ¡ 
xù_id
,

820 
upd_loc_šput_t
& 
ulš
)

823 
	`as£¹
 (
_pssm
);

824 
	`as£¹
 (
_š™Ÿlized
);

825 
	`as£¹
 (
_lßded
);

829 
tu¶e_gu¬d
<
sub_mª_im¶
> 
	`´sub
(
_psub_mª
);

831 
»p_row_t
 
	`¬•row
(
_psub_mª
->
	`ts
());

834 
¬•row
.
	`£t
(
_psub_desc
->
	`maxsize
());

836 
´sub
->
_»p
 = &
¬•row
;

847 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d UL:sub-nbr-idx-upd (%d)\n",

848 
xù_id
, 
ulš
.
_s_id
);

849 
	`W_DO
(
_psub_mª
->
	`sub_nbr_idx_upd
(
_pssm
, 
´sub
, 
ulš
.
_sub_nbr
));

850 
´sub
->
	`£t_v®ue
(33, 
ulš
.
_vÌ_loc
);

851 
	`W_DO
(
_psub_mª
->
	`upd©e_tu¶e
(
_pssm
, 
´sub
));

853 #ifdeà
PRINT_TRX_RESULTS


856 
´sub
->
	`´št_tu¶e
();

859  
RCOK
;

861 
	}
}

872 
w_rc_t
 
	gShÜeTM1Env
::
	$xù_šs_ÿÎ_fwd
(cÚ¡ 
xù_id
,

873 
šs_ÿÎ_fwd_šput_t
& 
icfš
)

876 
	`as£¹
 (
_pssm
);

877 
	`as£¹
 (
_š™Ÿlized
);

878 
	`as£¹
 (
_lßded
);

882 
tu¶e_gu¬d
<
sub_mª_im¶
> 
	`´sub
(
_psub_mª
);

883 
tu¶e_gu¬d
<
sf_mª_im¶
> 
	`´sf
(
_psf_mª
);

884 
tu¶e_gu¬d
<
cf_mª_im¶
> 
	`´cf
(
_pcf_mª
);

886 
»p_row_t
 
	`¬•row
(
_psub_mª
->
	`ts
());

889 
¬•row
.
	`£t
(
_psub_desc
->
	`maxsize
());

891 
´sub
->
_»p
 = &
¬•row
;

892 
´sf
->
_»p
 = &
¬•row
;

893 
´cf
->
_»p
 = &
¬•row
;

895 
»p_row_t
 
	`low»p
(
_psf_mª
->
	`ts
());

896 
»p_row_t
 
	`high»p
(
_psf_mª
->
	`ts
());

897 
low»p
.
	`£t
(
_psf_desc
->
	`maxsize
());

898 
high»p
.
	`£t
(
_psf_desc
->
	`maxsize
());

900 
tm1_sf_t
 
asf
;

901 
boŞ
 
bFound
 = 
çl£
;

902 
boŞ
 
eof
;

924 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d ICF:sub-nbr-idx (%d)\n",

925 
xù_id
, 
icfš
.
_s_id
);

926 
	`W_DO
(
_psub_mª
->
	`sub_nbr_idx_´obe
(
_pssm
, 
´sub
, 
icfš
.
_sub_nbr
));

927 
´sub
->
	`g‘_v®ue
(0, 
icfš
.
_s_id
);

930 
gu¬d
<
šdex_sÿn_™”_im¶
<
¥ecŸl_çc™y_t
> > 
sf_™”
;

932 
šdex_sÿn_™”_im¶
<
¥ecŸl_çc™y_t
>* 
tmp_sf_™”
;

933 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d ICF:sf-idx-™”\n", 
xù_id
);

934 
	`W_DO
(
_psf_mª
->
	`sf_g‘_idx_™”
(
_pssm
, 
tmp_sf_™”
, 
´sf
,

935 
low»p
, 
high»p
, 
icfš
.
_s_id
));

936 
sf_™”
 = 
tmp_sf_™”
;

938 
	`W_DO
(
sf_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´sf
));

939 !
eof
) {

941 
´sf
->
	`g‘_v®ue
(1, 
asf
.
SF_TYPE
);

942 ià(
asf
.
SF_TYPE
 =ğ
icfš
.
_sf_ty³
) {

943 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d ICF: found (%d) (%d)\n",

944 
xù_id
, 
icfš
.
_s_id
, 
asf
.
SF_TYPE
);

945 
bFound
 = 
Œue
;

948 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d ICF:sf-idx-™”-Ãxt\n", 
xù_id
);

949 
	`W_DO
(
sf_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´sf
));

951 ià(
bFound
 =ğ
çl£
)

952  
	`RC
(
£_NO_CURRENT_TUPLE
);

955 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d ICF:cf-idx-probe (%d) (%d) (%d)\n",

956 
xù_id
, 
icfš
.
_s_id
, icfš.
_sf_ty³
, icfš.
_s_time
);

957 
w_rc_t
 
e
 = 
_pcf_mª
->
	`cf_idx_´obe
(
_pssm
, 
´cf
, 
icfš
.
_s_id
,

958 
icfš
.
_sf_ty³
, icfš.
_s_time
);

961 ià(
e
.
	`”r_num
(è=ğ
£_TUPLE_NOT_FOUND
) {

963 
´cf
->
	`£t_v®ue
(0, 
icfš
.
_s_id
);

964 
´cf
->
	`£t_v®ue
(1, 
icfš
.
_sf_ty³
);

965 
´cf
->
	`£t_v®ue
(2, 
icfš
.
_s_time
);

966 
´cf
->
	`£t_v®ue
(3, 
icfš
.
_e_time
);

967 
´cf
->
	`£t_v®ue
(4, 
icfš
.
_numb”x
);

968 #ifdeà
CFG_HACK


969 
´cf
->
	`£t_v®ue
(5, "padding");

971 
	`TRACE
 (
TRACE_TRX_FLOW
, "Aµ: %d ICF:šs-cf\n", 
xù_id
);

972 
	`W_DO
(
_pcf_mª
->
	`add_tu¶e
(
_pssm
, 
´cf
));

974  
	`RC
(
£_CANNOT_INSERT_TUPLE
);

977 #ifdeà
PRINT_TRX_RESULTS


980 
´sub
->
	`´št_tu¶e
();

981 
´sf
->
	`´št_tu¶e
();

982 
´cf
->
	`´št_tu¶e
();

985  
RCOK
;

987 
	}
}

998 
w_rc_t
 
	gShÜeTM1Env
::
	$xù_d–_ÿÎ_fwd
(cÚ¡ 
xù_id
,

999 
d–_ÿÎ_fwd_šput_t
& 
dcfš
)

1002 
	`as£¹
 (
_pssm
);

1003 
	`as£¹
 (
_š™Ÿlized
);

1004 
	`as£¹
 (
_lßded
);

1008 
tu¶e_gu¬d
<
sub_mª_im¶
> 
	`´sub
(
_psub_mª
);

1009 
tu¶e_gu¬d
<
cf_mª_im¶
> 
	`´cf
(
_pcf_mª
);

1011 
»p_row_t
 
	`¬•row
(
_psub_mª
->
	`ts
());

1014 
¬•row
.
	`£t
(
_psub_desc
->
	`maxsize
());

1016 
´sub
->
_»p
 = &
¬•row
;

1017 
´cf
->
_»p
 = &
¬•row
;

1035 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DCF:sub-nbr-idx (%d)\n",

1036 
xù_id
, 
dcfš
.
_s_id
);

1037 
	`W_DO
(
_psub_mª
->
	`sub_nbr_idx_´obe
(
_pssm
, 
´sub
, 
dcfš
.
_sub_nbr
));

1038 
´sub
->
	`g‘_v®ue
(0, 
dcfš
.
_s_id
);

1041 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DCF:cf-idx-upd (%d) (%d) (%d)\n",

1042 
xù_id
, 
dcfš
.
_s_id
, dcfš.
_sf_ty³
, dcfš.
_s_time
);

1043 
	`W_DO
(
_pcf_mª
->
	`cf_idx_upd
(
_pssm
, 
´cf
,

1044 
dcfš
.
_s_id
, dcfš.
_sf_ty³
, dcfš.
_s_time
));

1045 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d DCF:d–-cf\n", 
xù_id
);

1046 
	`W_DO
(
_pcf_mª
->
	`d–‘e_tu¶e
(
_pssm
, 
´cf
));

1048 #ifdeà
PRINT_TRX_RESULTS


1051 
´sub
->
	`´št_tu¶e
();

1052 
´cf
->
	`´št_tu¶e
();

1055  
RCOK
;

1057 
	}
}

1068 
w_rc_t
 
	gShÜeTM1Env
::
	$xù_g‘_sub_nbr
(cÚ¡ 
xù_id
,

1069 
g‘_sub_nbr_šput_t
& 
g¢š
)

1072 
	`as£¹
 (
_pssm
);

1073 
	`as£¹
 (
_š™Ÿlized
);

1074 
	`as£¹
 (
_lßded
);

1078 
tu¶e_gu¬d
<
sub_mª_im¶
> 
	`´sub
(
_psub_mª
);

1080 
»p_row_t
 
	`¬•row
(
_psub_mª
->
	`ts
());

1083 
¬•row
.
	`£t
(
_psub_desc
->
	`maxsize
());

1085 
´sub
->
_»p
 = &
¬•row
;

1087 
»p_row_t
 
	`low»p
(
_psub_mª
->
	`ts
());

1088 
»p_row_t
 
	`high»p
(
_psub_mª
->
	`ts
());

1089 
low»p
.
	`£t
(
_psub_desc
->
	`maxsize
());

1090 
high»p
.
	`£t
(
_psub_desc
->
	`maxsize
());

1092 
boŞ
 
eof
;

1093 
ušt
 
¿nge
 = 
	`g‘_»c_to_acûss
();

1095 
sid
, 
vÌloc
;

1107 
gu¬d
<
šdex_sÿn_™”_im¶
<
subsüib”_t
> > 
sub_™”
;

1109 
šdex_sÿn_™”_im¶
<
subsüib”_t
>* 
tmp_sub_™”
;

1110 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d GSN:sub-nbr-idx-iter (%d) (%d)\n",

1111 
xù_id
, 
g¢š
.
_s_id
, 
¿nge
);

1112 
	`W_DO
(
_psub_mª
->
	`sub_g‘_idx_™”
(
_pssm
, 
tmp_sub_™”
, 
´sub
,

1113 
low»p
,
high»p
,

1114 
g¢š
.
_s_id
,
¿nge
,

1115 
SH
,

1116 
Œue
));

1117 
sub_™”
 = 
tmp_sub_™”
;

1121 
	`W_DO
(
sub_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´sub
));

1122 !
eof
) {

1123 
´sub
->
	`g‘_v®ue
(0, 
sid
);

1124 
´sub
->
	`g‘_v®ue
(33, 
vÌloc
);

1125 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d GSN:„ead (%d) (%d)\n",

1126 
xù_id
, 
sid
, 
vÌloc
);

1127 
	`W_DO
(
sub_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´sub
));

1130  
RCOK
;

1132 
	}
}

1143 
w_rc_t
 
	gShÜeTM1Env
::
	$xù_šs_ÿÎ_fwd_b’ch
(cÚ¡ 
xù_id
,

1144 
šs_ÿÎ_fwd_b’ch_šput_t
& 
icfbš
)

1147 
	`as£¹
 (
_pssm
);

1148 
	`as£¹
 (
_š™Ÿlized
);

1149 
	`as£¹
 (
_lßded
);

1153 
tu¶e_gu¬d
<
sub_mª_im¶
> 
	`´sub
(
_psub_mª
);

1154 
tu¶e_gu¬d
<
cf_mª_im¶
> 
	`´cf
(
_pcf_mª
);

1156 
»p_row_t
 
	`¬•row
(
_psub_mª
->
	`ts
());

1159 
¬•row
.
	`£t
(
_psub_desc
->
	`maxsize
());

1161 
´sub
->
_»p
 = &
¬•row
;

1162 
´cf
->
_»p
 = &
¬•row
;

1168 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d ICFB:sub-nbr-idx (%d)\n",

1169 
xù_id
, 
icfbš
.
_s_id
);

1170 
	`W_DO
(
_psub_mª
->
	`sub_nbr_idx_´obe
(
_pssm
, 
´sub
, 
icfbš
.
_sub_nbr
));

1171 
´sub
->
	`g‘_v®ue
(0, 
icfbš
.
_s_id
);

1174 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d ICFB:cf-idx-probe (%d) (%d) (%d)\n",

1175 
xù_id
, 
icfbš
.
_s_id
, icfbš.
_sf_ty³
, icfbš.
_s_time
);

1176 
w_rc_t
 
e
 = 
_pcf_mª
->
	`cf_idx_upd
(
_pssm
, 
´cf
, 
icfbš
.
_s_id
,

1177 
icfbš
.
_sf_ty³
, icfbš.
_s_time
);

1180 ià(
e
.
	`is_”rÜ
()) {

1181 ià(
e
.
	`”r_num
(è!ğ
£_TUPLE_NOT_FOUND
) {

1182 
	`W_DO
(
e
);

1185 
´cf
->
	`£t_v®ue
(0, 
icfbš
.
_s_id
);

1186 
´cf
->
	`£t_v®ue
(1, 
icfbš
.
_sf_ty³
);

1187 
´cf
->
	`£t_v®ue
(2, 
icfbš
.
_s_time
);

1188 
´cf
->
	`£t_v®ue
(3, 
icfbš
.
_e_time
);

1189 
´cf
->
	`£t_v®ue
(4, 
icfbš
.
_numb”x
);

1190 #ifdeà
CFG_HACK


1191 
´cf
->
	`£t_v®ue
(5, "padding");

1193 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d ICF:šs-cf\n", 
xù_id
);

1194 
	`W_DO
(
_pcf_mª
->
	`add_tu¶e
(
_pssm
, 
´cf
));

1196 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d DCF:d–-cf\n", 
xù_id
);

1197 
	`W_DO
(
_pcf_mª
->
	`d–‘e_tu¶e
(
_pssm
, 
´cf
));

1200 #ifdeà
PRINT_TRX_RESULTS


1203 
´sub
->
	`´št_tu¶e
();

1204 
´cf
->
	`´št_tu¶e
();

1207  
RCOK
;

1209 
	}
}

1220 
w_rc_t
 
	gShÜeTM1Env
::
	$xù_d–_ÿÎ_fwd_b’ch
(cÚ¡ 
xù_id
,

1221 
d–_ÿÎ_fwd_b’ch_šput_t
& 
dcfbš
)

1224 
	`as£¹
 (
_pssm
);

1225 
	`as£¹
 (
_š™Ÿlized
);

1226 
	`as£¹
 (
_lßded
);

1230 
tu¶e_gu¬d
<
sub_mª_im¶
> 
	`´sub
(
_psub_mª
);

1231 
tu¶e_gu¬d
<
cf_mª_im¶
> 
	`´cf
(
_pcf_mª
);

1233 
»p_row_t
 
	`¬•row
(
_psub_mª
->
	`ts
());

1236 
¬•row
.
	`£t
(
_psub_desc
->
	`maxsize
());

1238 
´sub
->
_»p
 = &
¬•row
;

1239 
´cf
->
_»p
 = &
¬•row
;

1257 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DCFB:sub-nbr-idx (%d)\n",

1258 
xù_id
, 
dcfbš
.
_s_id
);

1259 
	`W_DO
(
_psub_mª
->
	`sub_nbr_idx_´obe
(
_pssm
, 
´sub
, 
dcfbš
.
_sub_nbr
));

1260 
´sub
->
	`g‘_v®ue
(0, 
dcfbš
.
_s_id
);

1263 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DCFB:cf-idx-upd (%d) (%d) (%d)\n",

1264 
xù_id
, 
dcfbš
.
_s_id
, dcfbš.
_sf_ty³
, dcfbš.
_s_time
);

1265 
w_rc_t
 
e
 = 
_pcf_mª
->
	`cf_idx_upd
(
_pssm
, 
´cf
, 
dcfbš
.
_s_id
,

1266 
dcfbš
.
_sf_ty³
, dcfbš.
_s_time
);

1269 ià(
e
.
	`is_”rÜ
()) {

1270 ià(
e
.
	`”r_num
(è!ğ
£_TUPLE_NOT_FOUND
) {

1271 
	`W_DO
(
e
);

1274 
´cf
->
	`£t_v®ue
(0, 
dcfbš
.
_s_id
);

1275 
´cf
->
	`£t_v®ue
(1, 
dcfbš
.
_sf_ty³
);

1276 
´cf
->
	`£t_v®ue
(2, 
dcfbš
.
_s_time
);

1277 
©ime
 = 
	`URªd
(1,24);

1278 
´cf
->
	`£t_v®ue
(3, 
©ime
);

1279 
numbx
[
TM1_CF_NUMBERX_SZ
];

1280 
	`URªdFlSŒNumbx
(
numbx
,
TM1_CF_NUMBERX_SZ
);

1281 
´cf
->
	`£t_v®ue
(4, 
numbx
);

1282 #ifdeà
CFG_HACK


1283 
´cf
->
	`£t_v®ue
(5, "padding");

1285 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d DCFB:šs-cf\n", 
xù_id
);

1286 
	`W_DO
(
_pcf_mª
->
	`add_tu¶e
(
_pssm
, 
´cf
));

1288 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d DCF:d–-cf\n", 
xù_id
);

1289 
	`W_DO
(
_pcf_mª
->
	`d–‘e_tu¶e
(
_pssm
, 
´cf
));

1292 #ifdeà
PRINT_TRX_RESULTS


1295 
´sub
->
	`´št_tu¶e
();

1296 
´cf
->
	`´št_tu¶e
();

1299  
RCOK
;

1301 
	}
}

1304 
EXIT_NAMESPACE
(
tm1
);

	@src/workload/tm1/tm1_input.cpp

29 
	~"k_defšes.h
"

31 
	~"wÜklßd/tm1/tm1_šput.h
"

33 #w¬nšg 
TM1
: 
Usšg
 
UZRªd
 
g’”©šg
 
skewed
 
ZfŸn
 
šputs
. 
SkewÃss
 
ÿn
 
be
 
cÚŒŞËd
 
by
 
the
 'zf' 
sh–l
 
commªd
.

35 
ENTER_NAMESPACE
(
tm1
);

38 
skew”_t
 
	gs_skew”
;

39 
boŞ
 
	g_chªge_lßd
 = 
çl£
;

46 
	gg‘_sub_d©a_šput_t
& g‘_sub_d©a_šput_t::
İ”©Ü
ğ(cÚ¡ 
g‘_sub_d©a_šput_t
& 
rhs
)

48 
_s_id
 = 
rhs
._s_id;

49  (*
	gthis
);

53 
g‘_sub_d©a_šput_t
 
	$ü—‹_g‘_sub_d©a_šput
(
sf
,

54 
¥ecificSub
)

56 
	`as£¹
 (
sf
>0);

58 
g‘_sub_d©a_šput_t
 
gsdš
;

60 if(
_chªge_lßd
) {

61 
gsdš
.
_s_id
 = 
s_skew”
.
	`g‘_šput
();

64 ià(
¥ecificSub
>0)

65 
gsdš
.
_s_id
 = 
¥ecificSub
;

67 
gsdš
.
_s_id
 = 
	`UZRªd
(1,
sf
*
TM1_SUBS_PER_SF
);

70  (
gsdš
);

71 
	}
}

81 
	gg‘_Ãw_de¡_šput_t
& g‘_Ãw_de¡_šput_t::
İ”©Ü
ğ(cÚ¡ 
g‘_Ãw_de¡_šput_t
& 
rhs
)

83 
_s_id
 = 
rhs
._s_id;

84 
	g_sf_ty³
 = 
rhs
.
_sf_ty³
;

85 
	g_s_time
 = 
rhs
.
_s_time
;

86 
	g_e_time
 = 
rhs
.
_e_time
;

87  (*
	gthis
);

91 
g‘_Ãw_de¡_šput_t
 
	$ü—‹_g‘_Ãw_de¡_šput
(
sf
,

92 
¥ecificSub
)

94 
	`as£¹
 (
sf
>0);

96 
g‘_Ãw_de¡_šput_t
 
gndš
;

98 if(
_chªge_lßd
) {

99 
gndš
.
_s_id
 = 
s_skew”
.
	`g‘_šput
();

101 ià(
¥ecificSub
>0)

102 
gndš
.
_s_id
 = 
¥ecificSub
;

104 
gndš
.
_s_id
 = 
	`UZRªd
(1,
sf
*
TM1_SUBS_PER_SF
);

107 
gndš
.
_sf_ty³
 = 
	`URªd
(1,4);

108 
gndš
.
_s_time
 = 
	`URªd
(0,2) * 8;

109 
gndš
.
_e_time
 = 
	`URªd
(1,24);

110  (
gndš
);

111 
	}
}

119 
	gg‘_acc_d©a_šput_t
& g‘_acc_d©a_šput_t::
İ”©Ü
ğ(cÚ¡ 
g‘_acc_d©a_šput_t
& 
rhs
)

121 
_s_id
 = 
rhs
._s_id;

122 
	g_ai_ty³
 = 
rhs
.
_ai_ty³
;

123  (*
	gthis
);

127 
g‘_acc_d©a_šput_t
 
	$ü—‹_g‘_acc_d©a_šput
(
sf
,

128 
¥ecificSub
)

130 
	`as£¹
 (
sf
>0);

132 
g‘_acc_d©a_šput_t
 
gadš
;

134 if(
_chªge_lßd
) {

135 
gadš
.
_s_id
 = 
s_skew”
.
	`g‘_šput
();

137 ià(
¥ecificSub
>0)

138 
gadš
.
_s_id
 = 
¥ecificSub
;

140 
gadš
.
_s_id
 = 
	`UZRªd
(1,
sf
*
TM1_SUBS_PER_SF
);

143 
gadš
.
_ai_ty³
 = 
	`URªd
(1,4);

144  (
gadš
);

145 
	}
}

152 
	gupd_sub_d©a_šput_t
& upd_sub_d©a_šput_t::
İ”©Ü
ğ(cÚ¡ 
upd_sub_d©a_šput_t
& 
rhs
)

154 
_s_id
 = 
rhs
._s_id;

155 
	g_sf_ty³
 = 
rhs
.
_sf_ty³
;

156 
	g_a_b™
 = 
rhs
.
_a_b™
;

157 
	g_a_d©a
 = 
rhs
.
_a_d©a
;

158  (*
	gthis
);

162 
upd_sub_d©a_šput_t
 
	$ü—‹_upd_sub_d©a_šput
(
sf
,

163 
¥ecificSub
)

165 
	`as£¹
 (
sf
>0);

167 
upd_sub_d©a_šput_t
 
usdš
;

169 if(
_chªge_lßd
) {

170 
usdš
.
_s_id
 = 
s_skew”
.
	`g‘_šput
();

172 ià(
¥ecificSub
>0)

173 
usdš
.
_s_id
 = 
¥ecificSub
;

175 
usdš
.
_s_id
 = 
	`UZRªd
(1,
sf
*
TM1_SUBS_PER_SF
);

178 
usdš
.
_sf_ty³
 = 
	`URªd
(1,4);

179 
usdš
.
_a_b™
 = 
	`URªdBoŞ
();

180 
usdš
.
_a_d©a
 = 
	`URªd
(0,255);

181  (
usdš
);

182 
	}
}

190 
	gupd_loc_šput_t
& upd_loc_šput_t::
İ”©Ü
ğ(cÚ¡ 
upd_loc_šput_t
& 
rhs
)

192 
_s_id
 = 
rhs
._s_id;

193 
¡Üe_¡ršg
(
_sub_nbr
, 
rhs
._sub_nbr);

194 
	g_vÌ_loc
 = 
rhs
.
_vÌ_loc
;

195  (*
	gthis
);

199 
upd_loc_šput_t
 
	$ü—‹_upd_loc_šput
(
sf
,

200 
¥ecificSub
)

202 
	`as£¹
 (
sf
>0);

204 
upd_loc_šput_t
 
ulš
;

206 if(
_chªge_lßd
) {

207 
ulš
.
_s_id
 = 
s_skew”
.
	`g‘_šput
();

209 ià(
¥ecificSub
>0)

210 
ulš
.
_s_id
 = 
¥ecificSub
;

212 
ulš
.
_s_id
 = 
	`UZRªd
(1,
sf
*
TM1_SUBS_PER_SF
);

215 
	`¥rštf
(
ulš
.
_sub_nbr
,"%015.15d",ulš.
_s_id
);

216 
ulš
.
_vÌ_loc
 = 
	`URªd
(0,(2<<16)-1);

217  (
ulš
);

218 
	}
}

226 
	gšs_ÿÎ_fwd_šput_t
& ins_ÿÎ_fwd_šput_t::
İ”©Ü
ğ(cÚ¡ 
šs_ÿÎ_fwd_šput_t
& 
rhs
)

228 
_s_id
 = 
rhs
._s_id;

229 
¡Üe_¡ršg
(
_sub_nbr
, 
rhs
._sub_nbr);

230 
	g_sf_ty³
 = 
rhs
.
_sf_ty³
;

231 
	g_s_time
 = 
rhs
.
_s_time
;

232 
	g_e_time
 = 
rhs
.
_e_time
;

233 
¡Üe_¡ršg
(
_numb”x
, 
rhs
._numberx);

234  (*
	gthis
);

238 
šs_ÿÎ_fwd_šput_t
 
	$ü—‹_šs_ÿÎ_fwd_šput
(
sf
,

239 
¥ecificSub
)

241 
	`as£¹
 (
sf
>0);

243 
šs_ÿÎ_fwd_šput_t
 
icfš
;

245 if(
_chªge_lßd
) {

246 
icfš
.
_s_id
 = 
s_skew”
.
	`g‘_šput
();

248 ià(
¥ecificSub
>0)

249 
icfš
.
_s_id
 = 
¥ecificSub
;

251 
icfš
.
_s_id
 = 
	`UZRªd
(1,
sf
*
TM1_SUBS_PER_SF
);

254 
	`¥rštf
(
icfš
.
_sub_nbr
,"%015.15d",icfš.
_s_id
);

255 
icfš
.
_sf_ty³
 = 
	`URªd
(1,4);

256 
icfš
.
_s_time
 = 
	`URªd
(0,2) * 8;

257 
icfš
.
_e_time
 = 
	`URªd
(1,24);

258 
	`¥rštf
(
icfš
.
_numb”x
,"%015.15d",
	`URªd
(1,
sf
*
TM1_SUBS_PER_SF
));

259  (
icfš
);

260 
	}
}

267 
	gd–_ÿÎ_fwd_šput_t
& d–_ÿÎ_fwd_šput_t::
İ”©Ü
ğ(cÚ¡ 
d–_ÿÎ_fwd_šput_t
& 
rhs
)

269 
_s_id
 = 
rhs
._s_id;

270 
¡Üe_¡ršg
(
_sub_nbr
, 
rhs
._sub_nbr);

271 
	g_sf_ty³
 = 
rhs
.
_sf_ty³
;

272 
	g_s_time
 = 
rhs
.
_s_time
;

273  (*
	gthis
);

277 
d–_ÿÎ_fwd_šput_t
 
	$ü—‹_d–_ÿÎ_fwd_šput
(
sf
,

278 
¥ecificSub
)

280 
	`as£¹
 (
sf
>0);

282 
d–_ÿÎ_fwd_šput_t
 
dcfš
;

284 if(
_chªge_lßd
) {

285 
dcfš
.
_s_id
 = 
s_skew”
.
	`g‘_šput
();

287 ià(
¥ecificSub
>0)

288 
dcfš
.
_s_id
 = 
¥ecificSub
;

290 
dcfš
.
_s_id
 = 
	`UZRªd
(1,
sf
*
TM1_SUBS_PER_SF
);

293 
	`¥rštf
(
dcfš
.
_sub_nbr
,"%015.15d",dcfš.
_s_id
);

294 
dcfš
.
_sf_ty³
 = 
	`URªd
(1,4);

295 
dcfš
.
_s_time
 = 
	`URªd
(0,2) * 8;

296  (
dcfš
);

297 
	}
}

306 
	gg‘_sub_nbr_šput_t
& g‘_sub_nbr_šput_t::
İ”©Ü
ğ(cÚ¡ 
g‘_sub_nbr_šput_t
& 
rhs
)

308 
_s_id
 = 
rhs
._s_id;

309 
	g_¿nge
 = 
rhs
.
_¿nge
;

311 #ifdeà
USE_DORA_EXT_IDX


312 
	g_·œs
 = 
rhs
.
_·œs
;

315  (*
	gthis
);

319 
g‘_sub_nbr_šput_t
 
	$ü—‹_g‘_sub_nbr_šput
(
sf
,

320 
¥ecificSub
)

322 
	`as£¹
 (
sf
>0);

324 
g‘_sub_nbr_šput_t
 
g¢š
;

326 if(
_chªge_lßd
) {

327 
g¢š
.
_s_id
 = 
s_skew”
.
	`g‘_šput
();

329 ià(
¥ecificSub
>0)

330 
g¢š
.
_s_id
 = 
¥ecificSub
;

332 
g¢š
.
_s_id
 = 
	`UZRªd
(1,
sf
*
TM1_SUBS_PER_SF
);

335  (
g¢š
);

336 
	}
}

345 
	gšs_ÿÎ_fwd_b’ch_šput_t
& ins_ÿÎ_fwd_b’ch_šput_t::
İ”©Ü
ğ(cÚ¡ 
šs_ÿÎ_fwd_b’ch_šput_t
& 
rhs
)

347 
_s_id
 = 
rhs
._s_id;

348 
¡Üe_¡ršg
(
_sub_nbr
, 
rhs
._sub_nbr);

349 
	g_sf_ty³
 = 
rhs
.
_sf_ty³
;

350 
	g_s_time
 = 
rhs
.
_s_time
;

351 
	g_e_time
 = 
rhs
.
_e_time
;

352 
¡Üe_¡ršg
(
_numb”x
, 
rhs
._numberx);

353  (*
	gthis
);

357 
šs_ÿÎ_fwd_b’ch_šput_t
 
	$ü—‹_šs_ÿÎ_fwd_b’ch_šput
(
sf
,

358 
¥ecificSub
)

360 
	`as£¹
 (
sf
>0);

362 
šs_ÿÎ_fwd_b’ch_šput_t
 
icfbš
;

364 ià(
¥ecificSub
>0)

365 
icfbš
.
_s_id
 = 
¥ecificSub
;

367 
icfbš
.
_s_id
 = 
	`UZRªd
(1,
sf
*
TM1_SUBS_PER_SF
);

369 
	`¥rštf
(
icfbš
.
_sub_nbr
,"%015.15d",icfbš.
_s_id
);

370 
icfbš
.
_sf_ty³
 = 
	`URªd
(1,4);

371 
icfbš
.
_s_time
 = 
	`URªd
(0,2) * 8;

372 
icfbš
.
_e_time
 = 
	`URªd
(1,24);

373 
	`¥rštf
(
icfbš
.
_numb”x
,"%015.15d",
	`URªd
(1,
sf
*
TM1_SUBS_PER_SF
));

374  (
icfbš
);

375 
	}
}

382 
	gd–_ÿÎ_fwd_b’ch_šput_t
& d–_ÿÎ_fwd_b’ch_šput_t::
İ”©Ü
ğ(cÚ¡ 
d–_ÿÎ_fwd_b’ch_šput_t
& 
rhs
)

384 
_s_id
 = 
rhs
._s_id;

385 
¡Üe_¡ršg
(
_sub_nbr
, 
rhs
._sub_nbr);

386 
	g_sf_ty³
 = 
rhs
.
_sf_ty³
;

387 
	g_s_time
 = 
rhs
.
_s_time
;

388  (*
	gthis
);

392 
d–_ÿÎ_fwd_b’ch_šput_t
 
	$ü—‹_d–_ÿÎ_fwd_b’ch_šput
(
sf
,

393 
¥ecificSub
)

395 
	`as£¹
 (
sf
>0);

397 
d–_ÿÎ_fwd_b’ch_šput_t
 
dcfbš
;

399 ià(
¥ecificSub
>0)

400 
dcfbš
.
_s_id
 = 
¥ecificSub
;

402 
dcfbš
.
_s_id
 = 
	`UZRªd
(1,
sf
*
TM1_SUBS_PER_SF
);

404 
	`¥rštf
(
dcfbš
.
_sub_nbr
,"%015.15d",dcfbš.
_s_id
);

405 
dcfbš
.
_sf_ty³
 = 
	`URªd
(1,4);

406 
dcfbš
.
_s_time
 = 
	`URªd
(0,2) * 8;

407  (
dcfbš
);

408 
	}
}

425 
	$¿ndom_tm1_xù_ty³
(cÚ¡ 
£Ëùed
)

427 
¿ndom_ty³
 = 
£Ëùed
;

428 ià(
¿ndom_ty³
 < 0)

429 
¿ndom_ty³
 = 
	`¿nd
()%100;

430 
	`as£¹
 (
¿ndom_ty³
 >= 0);

432 
sum
 = 0;

433 
sum
+=
PROB_TM1_GET_SUB_DATA
;

434 ià(
¿ndom_ty³
 < 
sum
)

435  
XCT_TM1_GET_SUB_DATA
;

437 
sum
+=
PROB_TM1_GET_NEW_DEST
;

438 ià(
¿ndom_ty³
 < 
sum
)

439  
XCT_TM1_GET_NEW_DEST
;

442 
sum
+=
PROB_TM1_GET_ACC_DATA
;

443 ià(
¿ndom_ty³
 < 
sum
)

444  
XCT_TM1_GET_ACC_DATA
;

446 
sum
+=
PROB_TM1_UPD_SUB_DATA
;

447 ià(
¿ndom_ty³
 < 
sum
)

448  
XCT_TM1_UPD_SUB_DATA
;

450 
sum
+=
PROB_TM1_UPD_LOCATION
;

451 ià(
¿ndom_ty³
 < 
sum
)

452  
XCT_TM1_UPD_LOCATION
;

454 
sum
+=
PROB_TM1_INS_CALL_FWD
;

455 ià(
¿ndom_ty³
 < 
sum
)

456  
XCT_TM1_INS_CALL_FWD
;

458 
sum
+=
PROB_TM1_DEL_CALL_FWD
;

459 ià(
¿ndom_ty³
 < 
sum
)

460  
XCT_TM1_DEL_CALL_FWD
;

463 
	`as£¹
 (0);

465 
	}
}

469 
EXIT_NAMESPACE
(
tm1
);

	@src/workload/tpcb/shore_tpcb_client.cpp

31 
	~"wÜklßd/cb/shÜe_cb_ş›Á.h
"

33 
ENTER_NAMESPACE
(
cb
);

43 
	gba£lše_cb_ş›Á_t
::
	$ba£lše_cb_ş›Á_t
(
c_¡r
 
Šame
, cÚ¡ 
id
,

44 
ShÜeTPCBEnv
* 
’v
,

45 cÚ¡ 
M—su»m’tTy³
 
aTy³
,

46 cÚ¡ 
Œxid
,

47 cÚ¡ 
numOfTrxs
,

48 
´oûssÜid_t
 
­rsid
,

49 cÚ¡ 
£lID
, cÚ¡ 
qf
)

50 : 
	`ba£_ş›Á_t
(
Šame
,
id
,
’v
,
aTy³
,
Œxid
,
numOfTrxs
,
­rsid
),

51 
	`_£lid
(
£lID
), 
	$_qf
(
qf
)

53 
	`as£¹
 (
’v
);

54 
	`as£¹
 (
_id
>=0 && 
_qf
>0);

57 
_wÜk”
 = 
_’v
->
	`wÜk”
(
_id
);

58 
	`as£¹
 (
_wÜk”
);

59 
	}
}

62 
	gba£lše_cb_ş›Á_t
::
	$lßd_sup_xù
(
m­SupTrxs
& 
¡m­
)

65 
¡m­
.
	`ş—r
();

68 
¡m­
[
XCT_TPCB_ACCT_UPDATE
] = "TPCB-AccountUpdate";

70 
¡m­
[
XCT_TPCB_MBENCH_INSERT_ONLY
] = "TPCB-MbenchInsertOnly";

71 
¡m­
[
XCT_TPCB_MBENCH_DELETE_ONLY
] = "TPCB-MbenchDeleteOnly";

72 
¡m­
[
XCT_TPCB_MBENCH_PROBE_ONLY
] = "TPCB-MbenchProbeOnly";

73 
¡m­
[
XCT_TPCB_MBENCH_INSERT_DELETE
] = "TPCB-MbenchInsertDelete";

74 
¡m­
[
XCT_TPCB_MBENCH_INSERT_PROBE
] = "TPCB-MbenchInsertProbe";

75 
¡m­
[
XCT_TPCB_MBENCH_DELETE_PROBE
] = "TPCB-MbenchDeleteProbe";

76 
¡m­
[
XCT_TPCB_MBENCH_MIX
] = "TPCB-MbenchMix";

78  (
¡m­
.
	`size
());

79 
	}
}

93 
w_rc_t
 
	gba£lše_cb_ş›Á_t
::
	$subm™_Úe
(
xù_ty³
, 
xùid
)

96 
Œx_»suÉ_tu¶e_t
 
©¹
;

97 
boŞ
 
bWake
 = 
çl£
;

98 ià(
cÚdex
* 
c
 = 
_ı
->
	`ke_Úe
()) {

99 
©¹
.
	`£t_nÙify
(
c
);

100 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Sleeping\n");

101 
bWake
 = 
Œue
;

105 
£lid
 = 
_£lid
;

110 
Œx_»que¡_t
* 
¬eque¡
 = 
	`Ãw
 (
_’v
->
_»que¡_poŞ
)rx_request_t;

111 
tid_t
 
©id
;

112 
¬eque¡
->
	`£t
(
NULL
,
©id
,
xùid
,
©¹
,
xù_ty³
,
£lid
);

115 
	`as£¹
 (
_wÜk”
);

116 
_wÜk”
->
	`’queue
(
¬eque¡
,
bWake
);

117  (
RCOK
);

118 
	}
}

121 
EXIT_NAMESPACE
(
cb
);

	@src/workload/tpcb/shore_tpcb_env.cpp

33 
	~"wÜklßd/cb/shÜe_cb_’v.h
"

34 
	~"sm/shÜe/shÜe_h–³r_lßd”.h
"

36 
	~"k_defšes.h
"

38 
usšg
 
Çme¥aû
 
	gshÜe
;

40 
ENTER_NAMESPACE
(
shÜe
);

41 
DEFINE_ROW_CACHE_TLS
(
cb
, 
b¿nch
);

42 
DEFINE_ROW_CACHE_TLS
(
cb
, 
‹Î”
);

43 
DEFINE_ROW_CACHE_TLS
(
cb
, 
accouÁ
);

44 
DEFINE_ROW_CACHE_TLS
(
cb
, 
hi¡Üy
);

45 
EXIT_NAMESPACE
(
shÜe
);

47 
ENTER_NAMESPACE
(
cb
);

56 
	gShÜeTPCBEnv
::
	$ShÜeTPCBEnv
()

57 : 
	$ShÜeEnv
()

59 
	}
}

61 
ShÜeTPCBEnv
::~
	$ShÜeTPCBEnv
()

63 
	}
}

76 
w_rc_t
 
ShÜeTPCBEnv
::
	$lßd_schema
()

79 
_pb¿nch_desc
 = 
Ãw
 
	`b¿nch_t
(
	`g‘_pd
());

80 
_±–Ër_desc
 = 
Ãw
 
	`‹Î”_t
(
	`g‘_pd
());

81 
_·ccouÁ_desc
 = 
Ãw
 
	`accouÁ_t
(
	`g‘_pd
());

82 
_phi¡Üy_desc
 = 
Ãw
 
	`hi¡Üy_t
(
	`g‘_pd
());

86 
_pb¿nch_mª
 = 
Ãw
 
	`b¿nch_mª_im¶
(
_pb¿nch_desc
.
	`g‘
());

87 
_±–Ër_mª
 = 
Ãw
 
	`‹Î”_mª_im¶
(
_±–Ër_desc
.
	`g‘
());

88 
_·ccouÁ_mª
 = 
Ãw
 
	`accouÁ_mª_im¶
(
_·ccouÁ_desc
.
	`g‘
());

89 
_phi¡Üy_mª
 = 
Ãw
 
	`hi¡Üy_mª_im¶
(
_phi¡Üy_desc
.
	`g‘
());

91  (
RCOK
);

92 
	}
}

105 
w_rc_t
 
	gShÜeTPCBEnv
::
	$lßd_ªd_»gi¡”_fids
()

107 
	`W_DO
(
_pb¿nch_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

108 
	`W_DO
(
_±–Ër_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

109 
	`W_DO
(
_·ccouÁ_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

110 
	`W_DO
(
_phi¡Üy_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

111  (
RCOK
);

112 
	}
}

124 
w_rc_t
 
	gShÜeTPCBEnv
::
	$upd©e_·¹™iÚšg
()

129 
	`cÚf
();

132 
ušt
 
mrb¬ts
 = 
’vV¬
::
	`š¡ªû
()->
	`g‘V¬IÁ
("mrbt-partitions",10);

133 
mšKeyV®
 = 0;

134 
maxKeyV®
 = 
	`g‘_sf
();

136 * 
mšKey
 = (*)
	`m®loc
(());

137 
	`mem£t
(
mšKey
,0,());

138 
	`memıy
(
mšKey
,&
mšKeyV®
,());

140 * 
maxKey
 = (*)
	`m®loc
(());

141 
	`mem£t
(
maxKey
,0,());

142 
	`memıy
(
maxKey
,&
maxKeyV®
,());

145 
_pb¿nch_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
mrb¬ts
);

148 
_phi¡Üy_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
mrb¬ts
);

151 
maxKeyV®
 = (
	`g‘_sf
()*
TPCB_TELLERS_PER_BRANCH
);

152 
	`mem£t
(
maxKey
,0,());

153 
	`memıy
(
maxKey
,&
maxKeyV®
,());

154 
_±–Ër_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
mrb¬ts
);

157 
maxKeyV®
 = (
	`g‘_sf
()*
TPCB_ACCOUNTS_PER_BRANCH
);

158 
	`mem£t
(
maxKey
,0,());

159 
	`memıy
(
maxKey
,&
maxKeyV®
,());

160 
_·ccouÁ_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
mrb¬ts
);

162 
	`ä“
 (
mšKey
);

163 
	`ä“
 (
maxKey
);

165  (
RCOK
);

166 
	}
}

177 
	gShÜeTPCBEnv
::
	$£t_skew
(
¬—
, 
lßd
, 
¡¬t_imb®ªû
)

179 
ShÜeEnv
::
	`£t_skew
(
¬—
, 
lßd
, 
¡¬t_imb®ªû
);

181 
b_skew”
.
	`£t
(
¬—
, 0, 
_sÿlšg_çùÜ
-1, 
lßd
);

183 
t_skew”
.
	`£t
(
¬—
, 0, 
TPCB_TELLERS_PER_BRANCH
-1, 
lßd
);

185 
a_skew”
.
	`£t
(
¬—
, 0, 
TPCB_ACCOUNTS_PER_BRANCH
-1, 
lßd
);

186 
	}
}

197 
	gShÜeTPCBEnv
::
	$¡¬t_lßd_imb®ªû
()

199 if(
b_skew”
.
	`is_u£d
()) {

200 
_chªge_lßd
 = 
çl£
;

202 
b_skew”
.
	`»£t
(
_skew_ty³
);

204 
t_skew”
.
	`»£t
(
_skew_ty³
);

206 
a_skew”
.
	`»£t
(
_skew_ty³
);

208 if(
_skew_ty³
 !ğ
SKEW_CHAOTIC
 || 
	`URªd
(1,100) > 30) {

209 
_chªge_lßd
 = 
Œue
;

211 
ShÜeEnv
::
	`¡¬t_lßd_imb®ªû
();

212 
	}
}

223 
	gShÜeTPCBEnv
::
	$»£t_skew
()

225 
ShÜeEnv
::
	`»£t_skew
();

226 
_chªge_lßd
 = 
çl£
;

227 
b_skew”
.
	`ş—r
();

228 
t_skew”
.
	`ş—r
();

229 
a_skew”
.
	`ş—r
();

230 
	}
}

241 
	gShÜeTPCBEnv
::
	$šfo
() const

243 
	`TRACE
Ğ
TRACE_ALWAYS
, "SF = (%.1f)\n", 
_sÿlšg_çùÜ
);

244 
	`TRACE
Ğ
TRACE_ALWAYS
, "WÜk” ğ(%d)\n", 
_wÜk”_út
);

246 
	}
}

258 
	gShÜeTPCBEnv
::
	$¡©i¡ics
()

261 
	`CRITICAL_SECTION
(
cs
, 
_¡©m­_mu‹x
);

262 
ShÜeTPCBTrxSts
 
rv®
;

263 
rv®
 -=„val;

264 
¡©m­_t
::
™”©Ü
 
™
=
_¡©m­
.
	`begš
(); iˆ!ğ_¡©m­.
	`’d
(); ++it)

265 
rv®
 +ğ*
™
->
£cÚd
;

267 
	`TRACE
Ğ
TRACE_STATISTICS
, "AcctUpd. Att (%d). Abt (%d). Dld (%d)\n",

268 
rv®
.
©‹m±ed
.
acù_upd©e
,

269 
rv®
.
çed
.
acù_upd©e
,

270 
rv®
.
d—dlocked
.
acù_upd©e
);

272 
	`TRACE
Ğ
TRACE_STATISTICS
, "MbenchInsertOnly. Att (%d). Abt (%d). Dld (%d)\n",

273 
rv®
.
©‹m±ed
.
mb’ch_š£¹_Úly
,

274 
rv®
.
çed
.
mb’ch_š£¹_Úly
,

275 
rv®
.
d—dlocked
.
mb’ch_š£¹_Úly
);

277 
	`TRACE
Ğ
TRACE_STATISTICS
, "MbenchDeleteOnly. Att (%d). Abt (%d). Dld (%d)\n",

278 
rv®
.
©‹m±ed
.
mb’ch_d–‘e_Úly
,

279 
rv®
.
çed
.
mb’ch_d–‘e_Úly
,

280 
rv®
.
d—dlocked
.
mb’ch_d–‘e_Úly
);

282 
	`TRACE
Ğ
TRACE_STATISTICS
, "MbenchProbeOnly. Att (%d). Abt (%d). Dld (%d)\n",

283 
rv®
.
©‹m±ed
.
mb’ch_´obe_Úly
,

284 
rv®
.
çed
.
mb’ch_´obe_Úly
,

285 
rv®
.
d—dlocked
.
mb’ch_´obe_Úly
);

287 
	`TRACE
Ğ
TRACE_STATISTICS
, "MbenchInsertDelte. Att (%d). Abt (%d). Dld (%d)\n",

288 
rv®
.
©‹m±ed
.
mb’ch_š£¹_d–‘e
,

289 
rv®
.
çed
.
mb’ch_š£¹_d–‘e
,

290 
rv®
.
d—dlocked
.
mb’ch_š£¹_d–‘e
);

292 
	`TRACE
Ğ
TRACE_STATISTICS
, "MbenchInsertProbe. Att (%d). Abt (%d). Dld (%d)\n",

293 
rv®
.
©‹m±ed
.
mb’ch_š£¹_´obe
,

294 
rv®
.
çed
.
mb’ch_š£¹_´obe
,

295 
rv®
.
d—dlocked
.
mb’ch_š£¹_´obe
);

297 
	`TRACE
Ğ
TRACE_STATISTICS
, "MbenchDeleteProbe. Att (%d). Abt (%d). Dld (%d)\n",

298 
rv®
.
©‹m±ed
.
mb’ch_d–‘e_´obe
,

299 
rv®
.
çed
.
mb’ch_d–‘e_´obe
,

300 
rv®
.
d—dlocked
.
mb’ch_d–‘e_´obe
);

302 
	`TRACE
Ğ
TRACE_STATISTICS
, "MbenchMix. Att (%d). Abt (%d). Dld (%d)\n",

303 
rv®
.
©‹m±ed
.
mb’ch_mix
,

304 
rv®
.
çed
.
mb’ch_mix
,

305 
rv®
.
d—dlocked
.
mb’ch_mix
);

307 
ShÜeEnv
::
	`¡©i¡ics
();

310 
	}
}

321 
	gShÜeTPCBEnv
::
	$¡¬t
()

323  (
ShÜeEnv
::
	`¡¬t
());

324 
	}
}

326 
	gShÜeTPCBEnv
::
	$¡İ
()

328  (
ShÜeEnv
::
	`¡İ
());

329 
	}
}

341 
	gShÜeTPCBEnv
::
checkpoš‹r_t
 : 
public
 
th»ad_t


343 
ShÜeTPCBEnv
* 
_’v
;

344 
checkpoš‹r_t
(
ShÜeTPCBEnv
* 
’v
)

345 : 
th»ad_t
("LDChk±"), 
_’v
(
’v
)

347 
vœtu®
 
wÜk
();

351 
	gShÜeTPCBEnv
::
checkpoš‹r_t
::
	$wÜk
()

353 
boŞ
 vŞ©e* 
lßded
 = &
_’v
->
_lßded
;

354 !*
lßded
) {

355 
_’v
->
	`£t_m—su»
(
MST_MEASURE
);

356 
i
=0; i < 60 && !*
lßded
; i++) {

357 ::
	`¦“p
(1);

360 
	`TRACE
Ğ
TRACE_ALWAYS
, "db checkpoint - start\n");

361 
_’v
->
	`checkpošt
();

362 
	`TRACE
Ğ
TRACE_ALWAYS
, "db checkpoint -ƒnd\n");

364 
_’v
->
	`£t_m—su»
(
MST_PAUSE
);

365 
	}
}

376 şas 
	cShÜeTPCBEnv
::
bË_bud”_t
 : 
public
 
th»ad_t


378 
ShÜeTPCBEnv
* 
_’v
;

379 
	m_sf
;

380 
	m_¡¬t
;

381 
	m_couÁ
;

383 
	mpublic
:

384 
	$bË_bud”_t
(
ShÜeTPCBEnv
* 
’v
, 
id
, 
sf
, 
¡¬t
, 
couÁ
)

385 : 
	`th»ad_t
(
	`c_¡r
("LD-%d",
id
)),

386 
	`_’v
(
’v
), 
	`_sf
(
sf
), 
	`_¡¬t
(
¡¬t
), 
	$_couÁ
(
couÁ
)

389 
vœtu®
 
	`wÜk
();

391 
	}
};

394 cÚ¡ 
ušt
 
	gb¿nchesP”Round
 = 5;

395 
ušt
 vŞ©
	giB¿nchesLßded
 = 0;

396 
	gShÜeTPCBEnv
::
bË_bud”_t
::
	$wÜk
()

398 
w_rc_t
 
e
;

400 
i
=0; i < 
_couÁ
; i +ğ
TPCB_ACCOUNTS_CREATED_PER_POP_XCT
) {

401 
a_id
 = 
_¡¬t
 + 
i
;

402 
pİuÏ‹_db_šput_t
 
	`š
(
_sf
, 
a_id
);

403 
log_¥aû_Ãeded
 = 0;

404 
»Œy
:

405 
	`W_COERCE
(
_’v
->
	`db
()->
	`begš_xù
());

406 #ifdeà
USE_SHORE_6


407 if(
log_¥aû_Ãeded
 > 0) {

408 
	`W_COERCE
(
_’v
->
	`db
()->
	`xù_»£rve_log_¥aû
(
log_¥aû_Ãeded
));

411 
e
 = 
_’v
->
	`xù_pİuÏ‹_db
(
a_id
, 
š
);

412 
	`CHECK_XCT_RETURN
(
e
,
log_¥aû_Ãeded
,
»Œy
,
_’v
);

414 ià((
i
 % (
b¿nchesP”Round
*
TPCB_ACCOUNTS_PER_BRANCH
)) == 0) {

415 
	`©omic_add_št
(&
iB¿nchesLßded
, 
b¿nchesP”Round
);

416 
	`TRACE
(
TRACE_ALWAYS
, "%d branches†oaded so far...\n",

417 
iB¿nchesLßded
);

420 
	`TRACE
Ğ
TRACE_STATISTICS
,

422 
_¡¬t
, _¡¬t+
_couÁ
);

423 
	}
}

437 
	gShÜeTPCBEnv
::
bË_ü—tÜ_t
 : 
public
 
th»ad_t


439 
ShÜeTPCBEnv
* 
_’v
;

440 
	g_sf
;

441 
	g_psize
;

442 
	g_pcouÁ
;

443 
bË_ü—tÜ_t
(
ShÜeTPCBEnv
* 
’v
, 
sf
, 
psize
, 
pcouÁ
)

444 : 
th»ad_t
("CR"), 
_’v
(
’v
), 
_sf
(
sf
), 
_psize
(
psize
), 
_pcouÁ
(
pcouÁ
) { }

445 
vœtu®
 
wÜk
();

450 
	gShÜeTPCBEnv
::
bË_ü—tÜ_t
::
	$wÜk
()

454 
	`W_COERCE
(
_’v
->
	`db
()->
	`begš_xù
());

455 
	`W_COERCE
(
_’v
->
_pb¿nch_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

456 
	`W_COERCE
(
_’v
->
_±–Ër_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

457 
	`W_COERCE
(
_’v
->
_·ccouÁ_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

458 
	`W_COERCE
(
_’v
->
_phi¡Üy_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

459 
	`W_COERCE
(
_’v
->
	`db
()->
	`comm™_xù
());

462 
_’v
->
_pb¿nch_mª
->
	`»gi¡”_bË_mª
();

463 
_’v
->
_±–Ër_mª
->
	`»gi¡”_bË_mª
();

464 
_’v
->
_·ccouÁ_mª
->
	`»gi¡”_bË_mª
();

465 
_’v
->
_phi¡Üy_mª
->
	`»gi¡”_bË_mª
();

469 
i
=-1; i < 
_pcouÁ
; i++) {

470 
a_id
 = 
i
*
_psize
;

471 
pİuÏ‹_db_šput_t
 
	`š
(
_sf
, 
a_id
);

472 
	`TRACE
Ğ
TRACE_STATISTICS
, "Populating %ld‡_ids starting with %ld\n",

473 
TPCB_ACCOUNTS_CREATED_PER_POP_XCT
, 
a_id
);

474 
	`W_COERCE
(
_’v
->
	`db
()->
	`begš_xù
());

475 
	`W_COERCE
(
_’v
->
	`xù_pİuÏ‹_db
(
a_id
, 
š
));

479 
	`W_COERCE
(
_’v
->
	`db
()->
	`begš_xù
());

480 
	`W_COERCE
(
_’v
->
	`_po¡_š™_im¶
());

481 
	`W_COERCE
(
_’v
->
	`db
()->
	`comm™_xù
());

482 
	}
}

501 
w_rc_t
 
	gShÜeTPCBEnv
::
	$lßdd©a
()

504 
	`CRITICAL_SECTION
(
lßd_cs
, 
_lßd_mu‹x
);

505 ià(
_lßded
) {

506 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

508  (
RCOK
);

510 
	`CRITICAL_SECTION
(
sÿË_cs
, 
_sÿlšg_mu‹x
);

513 
gu¬d
<
checkpoš‹r_t
> 
	`chk
(
Ãw
 
	`checkpoš‹r_t
(
this
));

514 
chk
->
	`fÜk
();

524 
lßd”s_to_u£
 = 
’vV¬
::
	`š¡ªû
()->
	`g‘V¬IÁ
("db-loaders",10);

525 
tÙ®_accouÁs
 = 
_sÿlšg_çùÜ
*
TPCB_ACCOUNTS_PER_BRANCH
;

526 
	`w_as£¹1
((
tÙ®_accouÁs
 % 
lßd”s_to_u£
) == 0);

527 
acùs_³r_wÜk”
 = 
tÙ®_accouÁs
/
lßd”s_to_u£
;

531 ià(
_sÿlšg_çùÜ
<
lßd”s_to_u£
)†oaders_to_use = _scaling_factor;

533 
time_t
 
t¡¬t
 = 
	`time
(
NULL
);

537 
gu¬d
<
bË_ü—tÜ_t
> 
tc
;

538 
tc
 = 
Ãw
 
	`bË_ü—tÜ_t
(
this
, 
_sÿlšg_çùÜ
,

539 
acùs_³r_wÜk”
, 
lßd”s_to_u£
);

540 
tc
->
	`fÜk
();

541 
tc
->
	`još
();

552 
¬¿y_gu¬d_t
< 
gu¬d
<
bË_bud”_t
> > 
	`lßd”s
(
Ãw
 gu¬d<bË_bud”_t>[
lßd”s_to_u£
]);

553 
i
=0; i < 
lßd”s_to_u£
; i++) {

555 
¡¬t
 = 
acùs_³r_wÜk”
*
i
+
TPCB_ACCOUNTS_CREATED_PER_POP_XCT
;

556 
couÁ
 = 
acùs_³r_wÜk”
-
TPCB_ACCOUNTS_CREATED_PER_POP_XCT
;

557 
lßd”s
[
i
] = 
Ãw
 
	`bË_bud”_t
(
this
, i, 
_sÿlšg_çùÜ
, 
¡¬t
, 
couÁ
);

558 
lßd”s
[
i
]->
	`fÜk
();

562 
i
=0; i<
lßd”s_to_u£
; i++) {

563 
lßd”s
[
i
]->
	`još
();

566 
time_t
 
t¡İ
 = 
	`time
(
NULL
);

569 
	`TRACE
Ğ
TRACE_STATISTICS
, "Loading finished. %.1f branches†oaded in (%d) secs...\n",

570 
_sÿlšg_çùÜ
, (
t¡İ
 - 
t¡¬t
));

573 
_lßded
 = 
Œue
;

574 
chk
->
	`još
();

576  (
RCOK
);

577 
	}
}

591 
w_rc_t
 
	gShÜeTPCBEnv
::
	$check_cÚsi¡’cy
()

594  
RCOK
;

595 
	}
}

607 
w_rc_t
 
	gShÜeTPCBEnv
::
	$w¬mup
()

609  (
	`check_cÚsi¡’cy
());

610 
	}
}

621 
	gShÜeTPCBEnv
::
	$dump
()

623 
	`as£¹
 (0);

634 
	}
}

637 
	gShÜeTPCBEnv
::
	$cÚf
()

640 
ShÜeEnv
::
	`cÚf
();

641 
	`upd_sf
();

642 
	`upd_wÜk”_út
();

644 
	}
}

653 
	gShÜeTPCBEnv
::
	$po¡_š™
()

655 
	`cÚf
();

658 ià(
	`g‘_pd
(è& 
PD_PADDED
) {

659 
	`TRACE
Ğ
TRACE_ALWAYS
, "Checking for BRANCH/TELLER„ecord…adding...\n");

661 
	`W_COERCE
(
	`db
()->
	`begš_xù
());

662 
w_rc_t
 
rc
 = 
	`_po¡_š™_im¶
();

663 if(
rc
.
	`is_”rÜ
()) {

664 
û¼
 << "-> BRANCH/TELLER…addšg faed w™h: " << 
rc
 << 
’dl
;

665 
rc
 = 
	`db
()->
	`abÜt_xù
();

666  (
rc
.
	`”r_num
());

669 
	`TRACE
Ğ
TRACE_ALWAYS
, "-> Done\n");

670 
rc
 = 
	`db
()->
	`comm™_xù
();

674 
	}
}

687 
w_rc_t
 
	gShÜeTPCBEnv
::
	$_po¡_š™_im¶
()

689 #ifdeà
CFG_HACK


690 
	`TRACE
 (
TRACE_ALWAYS
, "Padding BRANCHES‡nd TELLERS\n");

692 
	`W_DO
(
	`_·d_BRANCHES
());

693 
	`W_DO
(
	`_·d_TELLERS
());

695  (
RCOK
);

696 
	}
}

707 
w_rc_t
 
	gShÜeTPCBEnv
::
	$_·d_BRANCHES
()

709 
ss_m
* 
db
 = 
this
->
	`db
();

712 
b¿nch_t
* 
br
 = 
	`b¿nch_desc
();

713 
šdex_desc_t
* 
br_idx
 = 
br
->
	`šdexes
();

714 
br_idx_couÁ
 = 
br
->
	`šdex_couÁ
();

715 
¡id_t
 
br_fid
 = 
br
->
	`fid
();

718 
	`W_DO
(
db
->
	`lock
(
br_fid
, 
EX
));

719 
i
=0; i < 
br_idx_couÁ
; i++) {

720 
j
=0; j < 
br_idx
[
i
].
	`g‘_·¹™iÚ_couÁ
(); j++) {

721 
	`W_DO
(
db
->
	`lock
(
br_idx
[
i
].
	`fid
(
j
), 
EX
));

725 
gu¬d
<
©s_ch¬_t
> 
±s
 = 
Ãw
 
	`©s_ch¬_t
(
br
->
	`maxsize
());

733 
boŞ
 
eof
;

736 cÚ¡ 
PADDED_SIZE
 = 4096;

738 
¬¿y_gu¬d_t
<> 
·ddšg
 = 
Ãw
 [
PADDED_SIZE
];

739 
¡d
::
veùÜ
<
rid_t
> 
h™_li¡
;

741 
gu¬d
<
b¿nch_mª_im¶
::
bË_™”
> 
™”
;

743 
b¿nch_mª_im¶
::
bË_™”
* 
tmp
;

744 
	`W_DO
(
	`b¿nch_mª
()->
	`g‘_™”_fÜ_fe_sÿn
(
db
, 
tmp
));

745 
™”
 = 
tmp
;

748 
couÁ
 = 0;

749 
b¿nch_mª_im¶
::
bË_tu¶e
 
	`row
(
br
);

750 
»p_row_t
 
	`¬•
(
±s
);

751 
psize
 = 
br
->
	`maxsize
()+1;

753 
	`W_DO
(
™”
->
	`Ãxt
(
db
, 
eof
, 
row
));

755 
pš_i
* 
hªdË
 = 
™”
->
	`cursÜ
();

756 ià(!
hªdË
) {

757 
	`TRACE
(
TRACE_ALWAYS
,

759 
couÁ
);

764 
hsize
 = 
hªdË
->
	`hdr_size
();

765 
bsize
 = 
hªdË
->
	`body_size
();

766 ià(
bsize
 =ğ
psize
) {

767 
	`TRACE
(
TRACE_ALWAYS
,

769 
couÁ
);

772 ià(
bsize
 > 
psize
) {

774 
hªdË
->
	`Œunÿ‹_»c
(
bsize
 - 
psize
);

775 
	`årštf
(
¡d”r
, "+");

779 
rid_t
 
Ãw_rid
;

780 
vec_t
 
	`hvec
(
hªdË
->
	`hdr
(), 
hsize
);

781 
vec_t
 
	`dvec
(
hªdË
->
	`body
(), 
bsize
);

782 
vec_t
 
	`pvec
(
·ddšg
, 
PADDED_SIZE
-
bsize
);

783 
	`W_DO
(
db
->
	`ü—‹_»c
(
br_fid
, 
hvec
, 
PADDED_SIZE
, 
dvec
, 
Ãw_rid
));

784 
	`W_DO
(
db
->
	`­³nd_»c
(
Ãw_rid
, 
pvec
));

787 
h™_li¡
.
	`push_back
(
hªdË
->
	`rid
());

790 
vec_t
 
	`rvec
(&
row
.
_rid
, (
rid_t
));

791 
vec_t
 
	`Ävec
(&
Ãw_rid
, (new_rid));

792 
i
=0; i < 
br_idx_couÁ
; i++) {

793 
key_sz
 = 
	`b¿nch_mª
()->
	`fÜm©_key
(
br_idx
+
i
, &
row
, 
¬•
);

794 
vec_t
 
	`kvec
(
¬•
.
_de¡
, 
key_sz
);

800 
²um
 = 
_pb¿nch_mª
->
	`g‘_²um
(&
br_idx
[
i
], &
row
);

801 
¡id_t
 
fid
 = 
br_idx
[
i
].
	`fid
(
²um
);

803 if(
br_idx
[
i
].
	`is_mr
()) {

804 
	`W_DO
(
db
->
	`de¡roy_mr_assoc
(
fid
, 
kvec
, 
rvec
));

806 
–_fËr
 
ef
;

807 
ef
.
_–
.
	`put
(
Ävec
);

808 
	`W_DO
(
db
->
	`ü—‹_mr_assoc
(
fid
, 
kvec
, 
ef
));

810 
	`W_DO
(
db
->
	`de¡roy_assoc
(
fid
, 
kvec
, 
rvec
));

812 
	`W_DO
(
db
->
	`ü—‹_assoc
(
fid
, 
kvec
, 
Ävec
));

816 
	`årštf
(
¡d”r
, ".");

820 
couÁ
++;

821 
	`W_DO
(
™”
->
	`Ãxt
(
db
, 
eof
, 
row
));

823 
	`TRACE
(
TRACE_ALWAYS
, "padded„ecords‡dded\n");

829 
hlsize
 = 
h™_li¡
.
	`size
();

830 
	`TRACE
(
TRACE_ALWAYS
,

832 
hlsize
);

833 
i
=0; i < 
hlsize
; i++) {

834 
	`W_DO
(
db
->
	`de¡roy_»c
(
h™_li¡
[
i
]));

837  (
RCOK
);

838 
	}
}

850 
w_rc_t
 
	gShÜeTPCBEnv
::
	$_·d_TELLERS
()

852 
ss_m
* 
db
 = 
this
->
	`db
();

855 
‹Î”_t
* 
‹
 = 
	`‹Î”_desc
();

856 
šdex_desc_t
* 
‹_idx
 = 
‹
->
	`šdexes
();

857 
‹_idx_couÁ
 = 
‹
->
	`šdex_couÁ
();

858 
¡id_t
 
‹_fid
 = 
‹
->
	`fid
();

861 
	`W_DO
(
db
->
	`lock
(
‹_fid
, 
EX
));

862 
i
=0; i < 
‹_idx_couÁ
; i++) {

863 
j
=0; j < 
‹_idx
[
i
].
	`g‘_·¹™iÚ_couÁ
(); j++)

864 
	`W_DO
(
db
->
	`lock
(
‹_idx
[
i
].
	`fid
(
j
), 
EX
));

867 
gu¬d
<
©s_ch¬_t
> 
±s
 = 
Ãw
 
	`©s_ch¬_t
(
‹
->
	`maxsize
());

875 
boŞ
 
eof
;

878 cÚ¡ 
PADDED_SIZE
 = 4096;

880 
¬¿y_gu¬d_t
<> 
·ddšg
 = 
Ãw
 [
PADDED_SIZE
];

881 
¡d
::
veùÜ
<
rid_t
> 
h™_li¡
;

883 
gu¬d
<
‹Î”_mª_im¶
::
bË_™”
> 
™”
;

885 
‹Î”_mª_im¶
::
bË_™”
* 
tmp
;

886 
	`W_DO
(
	`‹Î”_mª
()->
	`g‘_™”_fÜ_fe_sÿn
(
db
, 
tmp
));

887 
™”
 = 
tmp
;

890 
couÁ
 = 0;

891 
‹Î”_mª_im¶
::
bË_tu¶e
 
	`row
(
‹
);

892 
»p_row_t
 
	`¬•
(
±s
);

893 
psize
 = 
‹
->
	`maxsize
()+1;

895 
	`W_DO
(
™”
->
	`Ãxt
(
db
, 
eof
, 
row
));

897 
pš_i
* 
hªdË
 = 
™”
->
	`cursÜ
();

898 ià(!
hªdË
) {

899 
	`TRACE
(
TRACE_ALWAYS
,

901 
couÁ
);

906 
hsize
 = 
hªdË
->
	`hdr_size
();

907 
bsize
 = 
hªdË
->
	`body_size
();

908 ià(
bsize
 =ğ
psize
) {

909 
	`TRACE
(
TRACE_ALWAYS
,

911 
couÁ
);

914 ià(
bsize
 > 
psize
) {

916 
hªdË
->
	`Œunÿ‹_»c
(
bsize
 - 
psize
);

917 
	`årštf
(
¡d”r
, "+");

921 
rid_t
 
Ãw_rid
;

922 
vec_t
 
	`hvec
(
hªdË
->
	`hdr
(), 
hsize
);

923 
vec_t
 
	`dvec
(
hªdË
->
	`body
(), 
bsize
);

924 
vec_t
 
	`pvec
(
·ddšg
, 
PADDED_SIZE
-
bsize
);

925 
	`W_DO
(
db
->
	`ü—‹_»c
(
‹_fid
, 
hvec
, 
PADDED_SIZE
, 
dvec
, 
Ãw_rid
));

926 
	`W_DO
(
db
->
	`­³nd_»c
(
Ãw_rid
, 
pvec
));

929 
h™_li¡
.
	`push_back
(
hªdË
->
	`rid
());

932 
vec_t
 
	`rvec
(&
row
.
_rid
, (
rid_t
));

933 
vec_t
 
	`Ävec
(&
Ãw_rid
, (new_rid));

934 
i
=0; i < 
‹_idx_couÁ
; i++) {

935 
key_sz
 = 
	`‹Î”_mª
()->
	`fÜm©_key
(
‹_idx
+
i
, &
row
, 
¬•
);

936 
vec_t
 
	`kvec
(
¬•
.
_de¡
, 
key_sz
);

942 
²um
 = 
_±–Ër_mª
->
	`g‘_²um
(&
‹_idx
[
i
], &
row
);

943 
¡id_t
 
fid
 = 
‹_idx
[
i
].
	`fid
(
²um
);

945 if(
‹_idx
[
i
].
	`is_mr
()) {

946 
	`W_DO
(
db
->
	`de¡roy_mr_assoc
(
fid
, 
kvec
, 
rvec
));

948 
–_fËr
 
ef
;

949 
ef
.
_–
.
	`put
(
Ävec
);

950 
	`W_DO
(
db
->
	`ü—‹_mr_assoc
(
fid
, 
kvec
, 
ef
));

952 
	`W_DO
(
db
->
	`de¡roy_assoc
(
fid
, 
kvec
, 
rvec
));

954 
	`W_DO
(
db
->
	`ü—‹_assoc
(
fid
, 
kvec
, 
Ävec
));

958 
	`årštf
(
¡d”r
, ".");

962 
couÁ
++;

963 
	`W_DO
(
™”
->
	`Ãxt
(
db
, 
eof
, 
row
));

965 
	`TRACE
(
TRACE_ALWAYS
, "padded„ecords‡dded\n");

971 
hlsize
 = 
h™_li¡
.
	`size
();

972 
	`TRACE
(
TRACE_ALWAYS
,

974 
hlsize
);

975 
i
=0; i < 
hlsize
; i++) {

976 
	`W_DO
(
db
->
	`de¡roy_»c
(
h™_li¡
[
i
]));

979  (
RCOK
);

980 
	}
}

991 
w_rc_t
 
	gShÜeTPCBEnv
::
	$db_´št
(
lšes
)

994 
	`as£¹
 (
_pssm
);

995 
	`as£¹
 (
_š™Ÿlized
);

996 
	`as£¹
 (
_lßded
);

999 
	`W_DO
(
_pb¿nch_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

1000 
	`W_DO
(
_±–Ër_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

1001 
	`W_DO
(
_·ccouÁ_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

1002 
	`W_DO
(
_phi¡Üy_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

1004  (
RCOK
);

1005 
	}
}

1016 
w_rc_t
 
	gShÜeTPCBEnv
::
	$db_ãtch
()

1019 
	`as£¹
 (
_pssm
);

1020 
	`as£¹
 (
_š™Ÿlized
);

1021 
	`as£¹
 (
_lßded
);

1024 
	`W_DO
(
_pb¿nch_mª
->
	`ãtch_bË
(
_pssm
));

1025 
	`W_DO
(
_±–Ër_mª
->
	`ãtch_bË
(
_pssm
));

1026 
	`W_DO
(
_·ccouÁ_mª
->
	`ãtch_bË
(
_pssm
));

1027 
	`W_DO
(
_phi¡Üy_mª
->
	`ãtch_bË
(
_pssm
));

1029  (
RCOK
);

1030 
	}
}

1033 
EXIT_NAMESPACE
(
cb
);

	@src/workload/tpcb/shore_tpcb_schema.cpp

32 
	~"wÜklßd/cb/shÜe_cb_schema.h
"

34 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
ENTER_NAMESPACE
(
cb
);

66 
	gb¿nch_t
::
	$b¿nch_t
(cÚ¡ 
ušt4_t
& 
pd
)

67 #ifdeà
CFG_HACK


68 : 
	`bË_desc_t
("BRANCH", 3, 
pd
)

70 : 
	`bË_desc_t
("BRANCH", 2, 
pd
)

74 
_desc
[0].
	`£tup
(
SQL_INT
, "B_ID");

75 
_desc
[1].
	`£tup
(
SQL_FLOAT
, "B_BALANCE");

77 #ifdeà
CFG_HACK


78 #w¬nšg 
Addšg
 
_PADDING
 
f›lds
 
š
 
some
 
of
 
the
 
TM1
 
ªd
 
TPCB
 
bËs


79 
_desc
[2].
	`£tup
(
SQL_FIXCHAR
, "B_PADDING", 100-()-());

83 
ušt
 
keys1
[1] = { 0 };

84 
	`ü—‹_´im¬y_idx_desc
("B_IDX", 0, 
keys1
, 1, 
pd
);

85 
	}
}

89 
	g‹Î”_t
::
	$‹Î”_t
(cÚ¡ 
ušt4_t
& 
pd
)

90 #ifdeà
CFG_HACK


91 : 
	`bË_desc_t
("TELLER", 4, 
pd
)

93 : 
	`bË_desc_t
("TELLER", 3, 
pd
)

97 
_desc
[0].
	`£tup
(
SQL_INT
, "T_ID");

98 
_desc
[1].
	`£tup
(
SQL_INT
, "T_B_ID");

99 
_desc
[2].
	`£tup
(
SQL_FLOAT
, "T_BALANCE");

101 #ifdeà
CFG_HACK


102 
_desc
[3].
	`£tup
(
SQL_FIXCHAR
, "T_PADDING", 100-2*() - ());

106 
ušt
 
keys1
[1] = { 0 };

107 
	`ü—‹_´im¬y_idx_desc
("T_IDX", 0, 
keys1
, 1, 
pd
);

108 
	}
}

112 
	gaccouÁ_t
::
	$accouÁ_t
(cÚ¡ 
ušt4_t
& 
pd
)

113 #ifdeà
CFG_HACK


114 : 
	`bË_desc_t
("ACCOUNT", 4, 
pd
)

116 : 
	`bË_desc_t
("ACCOUNT", 3, 
pd
)

120 
_desc
[0].
	`£tup
(
SQL_INT
, "A_ID");

121 
_desc
[1].
	`£tup
(
SQL_INT
, "A_B_ID");

122 
_desc
[2].
	`£tup
(
SQL_FLOAT
, "A_BALANCE");

124 #ifdeà
CFG_HACK


125 
_desc
[3].
	`£tup
(
SQL_FIXCHAR
, "A_PADDING", 100-2*()-());

128 #ifdeà
PLP_MBENCH


129 #w¬nšg 
PLP
 
MB’ch
 !!!!

130 
ušt
 
keys1
[3] = { 0, 1, 2};

131 
ušt
 
nkeys
 = 3;

133 
ušt
 
keys1
[1] = {0 };

134 
ušt
 
nkeys
 = 1;

138 
	`ü—‹_´im¬y_idx_desc
("A_IDX", 0, 
keys1
, 
nkeys
, 
pd
);

139 
	}
}

142 
	ghi¡Üy_t
::
	$hi¡Üy_t
(cÚ¡ 
ušt4_t
& 
pd
)

143 #ifdeà
CFG_HACK


144 : 
	`bË_desc_t
("HISTORY", 6, 
pd
)

146 : 
	`bË_desc_t
("HISTORY", 5, 
pd
)

150 
_desc
[0].
	`£tup
(
SQL_INT
, "H_B_ID");

151 
_desc
[1].
	`£tup
(
SQL_INT
, "H_T_ID");

152 
_desc
[2].
	`£tup
(
SQL_INT
, "H_A_ID");

153 
_desc
[3].
	`£tup
(
SQL_FLOAT
, "H_DELTA");

154 
_desc
[4].
	`£tup
(
SQL_FLOAT
, "H_TIME");

156 #ifdeà
CFG_HACK


157 
_desc
[5].
	`£tup
(
SQL_FIXCHAR
, "H_PADDING", 50-3*()-2*());

161 
	}
}

164 
EXIT_NAMESPACE
(
cb
);

	@src/workload/tpcb/shore_tpcb_schema_man.cpp

33 
	~"wÜklßd/cb/shÜe_cb_schema_mª.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
ENTER_NAMESPACE
(
cb
);

52 
w_rc_t


53 
	gb¿nch_mª_im¶
::
	$b_šdex_´obe
(
ss_m
* 
db
,

54 
b¿nch_tu¶e
* 
±u¶e
,

55 cÚ¡ 
b_id
)

57 
	`as£¹
 (
±u¶e
);

58 
±u¶e
->
	`£t_v®ue
(0, 
b_id
);

59  (
	`šdex_´obe_by_Çme
(
db
, "B_INDEX", 
±u¶e
));

60 
	}
}

62 
w_rc_t
 
	gb¿nch_mª_im¶
::
	$b_šdex_´obe_fÜupd©e
(
ss_m
* 
db
,

63 
b¿nch_tu¶e
* 
±u¶e
,

64 cÚ¡ 
b_id
)

66 
	`as£¹
 (
±u¶e
);

67 
±u¶e
->
	`£t_v®ue
(0, 
b_id
);

68  (
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "B_IDX", 
±u¶e
));

69 
	}
}

71 
w_rc_t
 
	gb¿nch_mª_im¶
::
	$b_idx_Æ
(
ss_m
* 
db
,

72 
b¿nch_tu¶e
* 
±u¶e
,

73 cÚ¡ 
b_id
)

75 
	`as£¹
 (
±u¶e
);

76 
±u¶e
->
	`£t_v®ue
(0, 
b_id
);

77  (
	`šdex_´obe_Æ_by_Çme
(
db
, "B_IDX", 
±u¶e
));

78 
	}
}

86 
w_rc_t
 
	g‹Î”_mª_im¶
::
	$t_šdex_´obe_fÜupd©e
(
ss_m
* 
db
,

87 
‹Î”_tu¶e
* 
±u¶e
,

88 cÚ¡ 
t_id
)

90 
	`as£¹
 (
±u¶e
);

91 
±u¶e
->
	`£t_v®ue
(0, 
t_id
);

92  (
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "T_IDX", 
±u¶e
));

93 
	}
}

95 
w_rc_t
 
	g‹Î”_mª_im¶
::
	$t_idx_Æ
(
ss_m
* 
db
,

96 
‹Î”_tu¶e
* 
±u¶e
,

97 cÚ¡ 
t_id
)

99 
	`as£¹
 (
±u¶e
);

100 
±u¶e
->
	`£t_v®ue
(0, 
t_id
);

101  (
	`šdex_´obe_Æ_by_Çme
(
db
, "T_IDX", 
±u¶e
));

102 
	}
}

110 
w_rc_t
 
	gaccouÁ_mª_im¶
::
	$a_šdex_´obe
(
ss_m
* 
db
,

111 
accouÁ_tu¶e
* 
±u¶e
,

112 cÚ¡ 
a_id
,

113 cÚ¡ 
b_id
,

114 cÚ¡ 
b®ªû
)

116 
	`as£¹
 (
±u¶e
);

117 
±u¶e
->
	`£t_v®ue
(0, 
a_id
);

118 #ifdeà
PLP_MBENCH


119 
±u¶e
->
	`£t_v®ue
(1, 
b_id
);

120 
±u¶e
->
	`£t_v®ue
(2, 
b®ªû
);

122 ()
b_id
;

123 ()
b®ªû
;

125  (
	`šdex_´obe_by_Çme
(
db
, "A_IDX", 
±u¶e
));

126 
	}
}

128 
w_rc_t
 
	gaccouÁ_mª_im¶
::
	$a_d–‘e_by_šdex
(
ss_m
* 
db
,

129 
accouÁ_tu¶e
* 
±u¶e
,

130 cÚ¡ 
a_id
,

131 cÚ¡ 
b_id
,

132 cÚ¡ 
b®ªû
)

134 
	`as£¹
 (
±u¶e
);

135 
±u¶e
->
	`£t_v®ue
(0, 
a_id
);

136 #ifdeà
PLP_MBENCH


137 
±u¶e
->
	`£t_v®ue
(1, 
b_id
);

138 
±u¶e
->
	`£t_v®ue
(2, 
b®ªû
);

140 ()
b_id
;

141 ()
b®ªû
;

143 
	`W_DO
(
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "A_IDX", 
±u¶e
));

144  (
	`d–‘e_tu¶e
(
db
, 
±u¶e
));

145 
	}
}

147 
w_rc_t
 
	gaccouÁ_mª_im¶
::
	$a_šdex_´obe_fÜupd©e
(
ss_m
* 
db
,

148 
accouÁ_tu¶e
* 
±u¶e
,

149 cÚ¡ 
a_id
,

150 cÚ¡ 
b_id
,

151 cÚ¡ 
b®ªû
)

153 
	`as£¹
 (
±u¶e
);

154 
±u¶e
->
	`£t_v®ue
(0, 
a_id
);

155 #ifdeà
PLP_MBENCH


156 
±u¶e
->
	`£t_v®ue
(1, 
b_id
);

157 
±u¶e
->
	`£t_v®ue
(2, 
b®ªû
);

159 ()
b_id
;

160 ()
b®ªû
;

162  (
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "A_IDX", 
±u¶e
));

163 
	}
}

165 
w_rc_t
 
	gaccouÁ_mª_im¶
::
	$a_idx_Æ
(
ss_m
* 
db
,

166 
accouÁ_tu¶e
* 
±u¶e
,

167 cÚ¡ 
a_id
,

168 cÚ¡ 
b_id
,

169 cÚ¡ 
b®ªû
)

171 
	`as£¹
 (
±u¶e
);

172 
±u¶e
->
	`£t_v®ue
(0, 
a_id
);

173 #ifdeà
PLP_MBENCH


174 
±u¶e
->
	`£t_v®ue
(1, 
b_id
);

175 
±u¶e
->
	`£t_v®ue
(2, 
b®ªû
);

177 ()
b_id
;

178 ()
b®ªû
;

180  (
	`šdex_´obe_Æ_by_Çme
(
db
, "A_IDX", 
±u¶e
));

181 
	}
}

184 
EXIT_NAMESPACE
(
cb
);

	@src/workload/tpcb/shore_tpcb_xct.cpp

33 
	~"wÜklßd/cb/shÜe_cb_’v.h
"

35 
	~<veùÜ
>

36 
	~<num”ic
>

37 
	~<®gÜ™hm
>

39 
usšg
 
Çme¥aû
 
	gshÜe
;

42 
ENTER_NAMESPACE
(
cb
);

52 
__th»ad
 
ShÜeTPCBTrxSts
 
	gmy_¡©s
;

54 
	gShÜeTPCBEnv
::
	$’v_th»ad_š™
()

56 
	`CRITICAL_SECTION
(
¡©_mu‹x_cs
, 
_¡©m­_mu‹x
);

57 
_¡©m­
[
	`±h»ad_£lf
()] = &
my_¡©s
;

58 
	}
}

60 
	gShÜeTPCBEnv
::
	$’v_th»ad_fši
()

62 
	`CRITICAL_SECTION
(
¡©_mu‹x_cs
, 
_¡©m­_mu‹x
);

63 
_¡©m­
.
	`”a£
(
	`±h»ad_£lf
());

64 
	}
}

75 
ShÜeTPCBTrxSts
 
	gShÜeTPCBEnv
::
	$_g‘_¡©s
()

77 
	`CRITICAL_SECTION
(
cs
, 
_¡©m­_mu‹x
);

78 
ShÜeTPCBTrxSts
 
rv®
;

79 
rv®
 -=„val;

80 
¡©m­_t
::
™”©Ü
 
™
=
_¡©m­
.
	`begš
(); iˆ!ğ_¡©m­.
	`’d
(); ++it)

81 
rv®
 +ğ*
™
->
£cÚd
;

82  (
rv®
);

83 
	}
}

94 
	gShÜeTPCBEnv
::
	$»£t_¡©s
()

96 
	`CRITICAL_SECTION
(
Ï¡_¡©s_cs
, 
_Ï¡_¡©s_mu‹x
);

97 
_Ï¡_¡©s
 = 
	`_g‘_¡©s
();

98 
	}
}

109 
	gShÜeTPCBEnv
::
	$´št_throughput
(cÚ¡ 
iQu”›dSF
,

110 cÚ¡ 
iS´—d
,

111 cÚ¡ 
iNumOfTh»ads
,

112 cÚ¡ 
d–ay
,

113 cÚ¡ 
ulÚg_t
 
mioch
,

114 cÚ¡ 
avgıuu§ge
)

116 
	`CRITICAL_SECTION
(
Ï¡_¡©s_cs
, 
_Ï¡_¡©s_mu‹x
);

119 
ShÜeTPCBTrxSts
 
cu¼’t_¡©s
 = 
	`_g‘_¡©s
();

122 
cu¼’t_¡©s
 -ğ
_Ï¡_¡©s
;

124 
ušt
 
Œxs_©t
 = 
cu¼’t_¡©s
.
©‹m±ed
.
	`tÙ®
();

125 
ušt
 
Œxs_abt
 = 
cu¼’t_¡©s
.
çed
.
	`tÙ®
();

126 
ušt
 
Œxs_dld
 = 
cu¼’t_¡©s
.
d—dlocked
.
	`tÙ®
();

128 
	`TRACE
Ğ
TRACE_ALWAYS
, "*******\n" \

139 
iQu”›dSF
,

140 (
iS´—d
 ? "Yes" : "No"),

141 
iNumOfTh»ads
, 
Œxs_©t
, 
Œxs_abt
, 
Œxs_dld
,

142 
d–ay
, 
mioch
/d–ay, 
avgıuu§ge
,

143 100*
avgıuu§ge
/
	`g‘_max_ıu_couÁ
(),

144 (
Œxs_©t
-
Œxs_abt
-
Œxs_dld
)/
d–ay
);

145 
	}
}

173 
w_rc_t
 
	gShÜeTPCBEnv
::
	$run_Úe_xù
(
Reque¡
* 
´eque¡
)

175 
	`as£¹
 (
´eque¡
);

177 if(
_¡¬t_imb®ªû
 > 0 && !
_bAÏrmS‘
) {

178 
	`CRITICAL_SECTION
(
®¬m_cs
, 
_®¬m_lock
);

179 if(!
_bAÏrmS‘
) {

180 
	`®¬m
(
_¡¬t_imb®ªû
);

181 
_bAÏrmS‘
 = 
Œue
;

185 
¿nd
;

187 
´eque¡
->
	`ty³
()) {

190 
XCT_TPCB_ACCT_UPDATE
:

191  (
	`run_acù_upd©e
(
´eque¡
));

194 
XCT_TPCB_MBENCH_INSERT_ONLY
:

195  (
	`run_mb’ch_š£¹_Úly
(
´eque¡
));

196 
XCT_TPCB_MBENCH_DELETE_ONLY
:

197  (
	`run_mb’ch_d–‘e_Úly
(
´eque¡
));

198 
XCT_TPCB_MBENCH_PROBE_ONLY
:

199  (
	`run_mb’ch_´obe_Úly
(
´eque¡
));

200 
XCT_TPCB_MBENCH_INSERT_DELETE
:

201 ià(
	`URªd
(1,100)>
_d–‘e_äeq
)

202  (
	`run_mb’ch_š£¹_Úly
(
´eque¡
));

204  (
	`run_mb’ch_d–‘e_Úly
(
´eque¡
));

206 
XCT_TPCB_MBENCH_INSERT_PROBE
:

207 ià(
	`URªd
(1,100)>
_´obe_äeq
)

208  (
	`run_mb’ch_š£¹_Úly
(
´eque¡
));

210  (
	`run_mb’ch_´obe_Úly
(
´eque¡
));

212 
XCT_TPCB_MBENCH_DELETE_PROBE
:

213 ià(
	`URªd
(1,100)>
_d–‘e_äeq
)

214  (
	`run_mb’ch_´obe_Úly
(
´eque¡
));

216  (
	`run_mb’ch_d–‘e_Úly
(
´eque¡
));

218 
XCT_TPCB_MBENCH_MIX
:

219 
¿nd
 = 
	`URªd
(1,100);

220 ià(
¿nd
<=
_š£¹_äeq
)

221  (
	`run_mb’ch_š£¹_Úly
(
´eque¡
));

222 if(
¿nd
<=
_š£¹_äeq
+
_´obe_äeq
)

223  (
	`run_mb’ch_´obe_Úly
(
´eque¡
));

225  (
	`run_mb’ch_d–‘e_Úly
(
´eque¡
));

229 
	`as£¹
 (0);

231  (
RCOK
);

232 
	}
}

251 
DEFINE_TRX
(
ShÜeTPCBEnv
,
acù_upd©e
);

252 
DEFINE_TRX
(
ShÜeTPCBEnv
,
pİuÏ‹_db
);

255 
DEFINE_TRX
(
ShÜeTPCBEnv
,
mb’ch_š£¹_Úly
);

256 
DEFINE_TRX
(
ShÜeTPCBEnv
,
mb’ch_d–‘e_Úly
);

257 
DEFINE_TRX
(
ShÜeTPCBEnv
,
mb’ch_´obe_Úly
);

258 
DEFINE_TRX
(
ShÜeTPCBEnv
,
mb’ch_š£¹_d–‘e
);

259 
DEFINE_TRX
(
ShÜeTPCBEnv
,
mb’ch_š£¹_´obe
);

260 
DEFINE_TRX
(
ShÜeTPCBEnv
,
mb’ch_d–‘e_´obe
);

261 
DEFINE_TRX
(
ShÜeTPCBEnv
,
mb’ch_mix
);

274 
w_rc_t
 
	gShÜeTPCBEnv
::
	$xù_acù_upd©e
(const ,

275 
acù_upd©e_šput_t
& 
µš
)

278 
	`as£¹
 (
_pssm
);

279 
	`as£¹
 (
_š™Ÿlized
);

280 
	`as£¹
 (
_lßded
);

286 
tu¶e_gu¬d
<
b¿nch_mª_im¶
> 
	`´b
(
_pb¿nch_mª
);

287 
tu¶e_gu¬d
<
‹Î”_mª_im¶
> 
	`´t
(
_±–Ër_mª
);

288 
tu¶e_gu¬d
<
accouÁ_mª_im¶
> 
	`´acù
(
_·ccouÁ_mª
);

289 
tu¶e_gu¬d
<
hi¡Üy_mª_im¶
> 
	`´hi¡
(
_phi¡Üy_mª
);

291 
»p_row_t
 
	`¬•row
(
_·ccouÁ_mª
->
	`ts
());

294 
¬•row
.
	`£t
(
_·ccouÁ_desc
->
	`maxsize
());

296 
´b
->
_»p
 = &
¬•row
;

297 
´t
->
_»p
 = &
¬•row
;

298 
´acù
->
_»p
 = &
¬•row
;

299 
´hi¡
->
_»p
 = &
¬•row
;

301 
tÙ®
;

304 
	`W_DO
(
_·ccouÁ_mª
->
	`a_šdex_´obe_fÜupd©e
(
_pssm
, 
´acù
, 
µš
.
a_id
));

305 
´acù
->
	`g‘_v®ue
(2, 
tÙ®
);

306 
´acù
->
	`£t_v®ue
(2, 
tÙ®
 + 
µš
.
d–
);

307 
	`W_DO
(
_·ccouÁ_mª
->
	`upd©e_tu¶e
(
_pssm
, 
´acù
));

310 
´hi¡
->
	`£t_v®ue
(0, 
µš
.
b_id
);

311 
´hi¡
->
	`£t_v®ue
(1, 
µš
.
t_id
);

312 
´hi¡
->
	`£t_v®ue
(2, 
µš
.
a_id
);

313 
´hi¡
->
	`£t_v®ue
(3, 
µš
.
d–
);

314 
´hi¡
->
	`£t_v®ue
(4, 
	`time
(
NULL
));

315 #ifdeà
CFG_HACK


316 
´hi¡
->
	`£t_v®ue
(5, "padding");

318 
	`W_DO
(
_phi¡Üy_mª
->
	`add_tu¶e
(
_pssm
, 
´hi¡
));

321 
	`W_DO
(
_±–Ër_mª
->
	`t_šdex_´obe_fÜupd©e
(
_pssm
, 
´t
, 
µš
.
t_id
));

322 
´t
->
	`g‘_v®ue
(2, 
tÙ®
);

323 
´t
->
	`£t_v®ue
(2, 
tÙ®
 + 
µš
.
d–
);

324 
	`W_DO
(
_±–Ër_mª
->
	`upd©e_tu¶e
(
_pssm
, 
´t
));

327 
	`W_DO
(
_pb¿nch_mª
->
	`b_šdex_´obe_fÜupd©e
(
_pssm
, 
´b
, 
µš
.
b_id
));

328 
´b
->
	`g‘_v®ue
(1, 
tÙ®
);

329 
´b
->
	`£t_v®ue
(1, 
tÙ®
 + 
µš
.
d–
);

330 
	`W_DO
(
_pb¿nch_mª
->
	`upd©e_tu¶e
(
_pssm
, 
´b
));

332 #ifdeà
PRINT_TRX_RESULTS


335 
´b
->
	`´št_tu¶e
();

336 
´t
->
	`´št_tu¶e
();

337 
´acù
->
	`´št_tu¶e
();

338 
´hi¡
->
	`´št_tu¶e
();

341  
RCOK
;

343 
	}
}

358 
w_rc_t
 
	gShÜeTPCBEnv
::
	$xù_pİuÏ‹_db
(const ,

359 
pİuÏ‹_db_šput_t
& 
µš
)

362 
	`as£¹
 (
_pssm
);

363 
	`as£¹
 (
_š™Ÿlized
);

369 
tu¶e_gu¬d
<
b¿nch_mª_im¶
> 
	`´b
(
_pb¿nch_mª
);

370 
tu¶e_gu¬d
<
‹Î”_mª_im¶
> 
	`´t
(
_±–Ër_mª
);

371 
tu¶e_gu¬d
<
accouÁ_mª_im¶
> 
	`´acù
(
_·ccouÁ_mª
);

372 
tu¶e_gu¬d
<
hi¡Üy_mª_im¶
> 
	`´hi¡
(
_phi¡Üy_mª
);

374 
»p_row_t
 
	`¬•row
(
_·ccouÁ_mª
->
	`ts
());

375 
»p_row_t
 
	`¬•row_key
(
_·ccouÁ_mª
->
	`ts
());

378 
¬•row
.
	`£t
(
_·ccouÁ_desc
->
	`maxsize
());

379 
¬•row_key
.
	`£t
(
_·ccouÁ_desc
->
	`maxsize
());

381 
´b
->
_»p
 = &
¬•row
;

382 
´t
->
_»p
 = &
¬•row
;

383 
´acù
->
_»p
 = &
¬•row
;

384 
´hi¡
->
_»p
 = &
¬•row
;

385 
´b
->
_»p_key
 = &
¬•row_key
;

386 
´t
->
_»p_key
 = &
¬•row_key
;

387 
´acù
->
_»p_key
 = &
¬•row_key
;

388 
´hi¡
->
_»p_key
 = &
¬•row_key
;

390 if(
µš
.
_fœ¡_a_id
 < 0) {

392 
i
=0; i < 
µš
.
_sf
; i++) {

393 
´b
->
	`£t_v®ue
(0, 
i
);

394 
´b
->
	`£t_v®ue
(1, 0.0);

395 #ifdeà
CFG_HACK


396 
´b
->
	`£t_v®ue
(2, "padding");

398 
	`W_DO
(
_pb¿nch_mª
->
	`add_tu¶e
(
_pssm
, 
´b
));

400 
	`TRACE
Ğ
TRACE_STATISTICS
, "Lßded %d b¿nches\n", 
µš
.
_sf
);

402 
i
=0; i < 
µš
.
_sf
*
TPCB_TELLERS_PER_BRANCH
; i++) {

403 
´t
->
	`£t_v®ue
(0, 
i
);

404 
´t
->
	`£t_v®ue
(1, 
i
/
TPCB_TELLERS_PER_BRANCH
);

405 
´t
->
	`£t_v®ue
(2, 0.0);

406 #ifdeà
CFG_HACK


407 
´t
->
	`£t_v®ue
(3, "padding");

409 
	`W_DO
(
_±–Ër_mª
->
	`add_tu¶e
(
_pssm
, 
´t
));

411 
	`TRACE
Ğ
TRACE_STATISTICS
, "Loaded %dellers\n",

412 
µš
.
_sf
*
TPCB_TELLERS_PER_BRANCH
);

415 
i
=0; i < 
TPCB_ACCOUNTS_CREATED_PER_POP_XCT
; i++) {

416 
a_id
 = 
µš
.
_fœ¡_a_id
 +

417 (
TPCB_ACCOUNTS_CREATED_PER_POP_XCT
-
i
-1);

418 
´acù
->
	`£t_v®ue
(0, 
a_id
);

419 
´acù
->
	`£t_v®ue
(1, 
a_id
/
TPCB_ACCOUNTS_PER_BRANCH
);

420 
´acù
->
	`£t_v®ue
(2, 0.0);

421 #ifdeà
CFG_HACK


422 
´acù
->
	`£t_v®ue
(3, "padding");

424 
	`W_DO
(
_·ccouÁ_mª
->
	`add_tu¶e
(
_pssm
, 
´acù
));

429 
	`W_DO
(
_pssm
->
	`comm™_xù
());

431 #ifdeà
PRINT_TRX_RESULTS


434 
´b
->
	`´št_tu¶e
();

435 
´t
->
	`´št_tu¶e
();

436 
´acù
->
	`´št_tu¶e
();

437 
´hi¡
->
	`´št_tu¶e
();

440  
RCOK
;

442 
	}
}

453 
w_rc_t
 
	gShÜeTPCBEnv
::
	$xù_mb’ch_š£¹_Úly
(const ,

454 
mb’ch_š£¹_Úly_šput_t
& 
mioš
)

457 
	`as£¹
 (
_pssm
);

458 
	`as£¹
 (
_š™Ÿlized
);

459 
	`as£¹
 (
_lßded
);

465 
tu¶e_gu¬d
<
accouÁ_mª_im¶
> 
	`´acù
(
_·ccouÁ_mª
);

467 
»p_row_t
 
	`¬•row
(
_·ccouÁ_mª
->
	`ts
());

470 
¬•row
.
	`£t
(
_·ccouÁ_desc
->
	`maxsize
());

472 
´acù
->
_»p
 = &
¬•row
;

475 
´acù
->
	`£t_v®ue
(0, 
mioš
.
a_id
);

476 
´acù
->
	`£t_v®ue
(1, 
mioš
.
b_id
);

477 
´acù
->
	`£t_v®ue
(2, 
mioš
.
b®ªû
);

478 #ifdeà
CFG_HACK


479 
´acù
->
	`£t_v®ue
(3, "padding");

481 
	`W_DO
(
_·ccouÁ_mª
->
	`add_tu¶e
(
_pssm
, 
´acù
));

483 #ifdeà
PRINT_TRX_RESULTS


486 
´acù
->
	`´št_tu¶e
();

489  
RCOK
;

491 
	}
}

502 
w_rc_t
 
	gShÜeTPCBEnv
::
	$xù_mb’ch_d–‘e_Úly
(const ,

503 
mb’ch_d–‘e_Úly_šput_t
& 
mdoš
)

506 
	`as£¹
 (
_pssm
);

507 
	`as£¹
 (
_š™Ÿlized
);

508 
	`as£¹
 (
_lßded
);

514 
tu¶e_gu¬d
<
accouÁ_mª_im¶
> 
	`´acù
(
_·ccouÁ_mª
);

516 
»p_row_t
 
	`¬•row
(
_·ccouÁ_mª
->
	`ts
());

519 
¬•row
.
	`£t
(
_·ccouÁ_desc
->
	`maxsize
());

521 
´acù
->
_»p
 = &
¬•row
;

524 
	`W_DO
(
_·ccouÁ_mª
->
	`a_d–‘e_by_šdex
(
_pssm
, 
´acù
, 
mdoš
.
a_id
,

525 
mdoš
.
b_id
, mdoš.
b®ªû
));

527 #ifdeà
PRINT_TRX_RESULTS


530 
´acù
->
	`´št_tu¶e
();

533  
RCOK
;

535 
	}
}

546 
w_rc_t
 
	gShÜeTPCBEnv
::
	$xù_mb’ch_´obe_Úly
(const ,

547 
mb’ch_´obe_Úly_šput_t
& 
mpoš
)

550 
	`as£¹
 (
_pssm
);

551 
	`as£¹
 (
_š™Ÿlized
);

552 
	`as£¹
 (
_lßded
);

558 
tu¶e_gu¬d
<
accouÁ_mª_im¶
> 
	`´acù
(
_·ccouÁ_mª
);

560 
»p_row_t
 
	`¬•row
(
_·ccouÁ_mª
->
	`ts
());

563 
¬•row
.
	`£t
(
_·ccouÁ_desc
->
	`maxsize
());

565 
´acù
->
_»p
 = &
¬•row
;

568 
w_rc_t
 
e
 = 
_·ccouÁ_mª
->
	`a_šdex_´obe
(
_pssm
, 
´acù
, 
mpoš
.
a_id
,

569 
mpoš
.
b_id
, mpoš.
b®ªû
);

570 ià(
e
.
	`is_”rÜ
(è&& (e.
	`”r_num
(è!ğ
£_TUPLE_NOT_FOUND
)) {

571 
	`W_DO
(
e
);

574  
RCOK
;

576 
	}
}

586 
w_rc_t
 
	gShÜeTPCBEnv
::
	$xù_mb’ch_š£¹_d–‘e
(const ,

587 
mb’ch_š£¹_d–‘e_šput_t
& 
midš
)

589 
w_rc_t
 
e
 = 
RCOK
;

592 
	`as£¹
 (
_pssm
);

593 
	`as£¹
 (
_š™Ÿlized
);

594 
	`as£¹
 (
_lßded
);

600 
bË_row_t
* 
´b
 = 
_pb¿nch_mª
->
	`g‘_tu¶e
();

601 
	`as£¹
 (
´b
);

603 
»p_row_t
 
	`¬•row
(
_·ccouÁ_mª
->
	`ts
());

606 
¬•row
.
	`£t
(
_·ccouÁ_desc
->
	`maxsize
());

607 
´b
->
_»p
 = &
¬•row
;

612 
´b
->
	`£t_v®ue
(0, 
midš
.
b_id
);

613 
´b
->
	`£t_v®ue
(1, 0.0);

614 
´b
->
	`£t_v®ue
(2, "padding");

615 
e
 = 
_pb¿nch_mª
->
	`add_tu¶e
(
_pssm
, 
´b
);

616 ià(
e
.
	`is_”rÜ
()è{ 
dÚe
; }

619 
e
 = 
_pb¿nch_mª
->
	`d–‘e_tu¶e
(
_pssm
, 
´b
);

620 ià(
e
.
	`is_”rÜ
()è{ 
dÚe
; }

624 #ifdeà
PRINT_TRX_RESULTS


627 
´b
->
	`´št_tu¶e
();

630 
dÚe
:

632 
_pb¿nch_mª
->
	`give_tu¶e
(
´b
);

633  (
e
);

635 
	}
}

645 
w_rc_t
 
	gShÜeTPCBEnv
::
	$xù_mb’ch_š£¹_´obe
(const ,

646 
mb’ch_š£¹_´obe_šput_t
& 
mš
)

648 
w_rc_t
 
e
 = 
RCOK
;

651 
	`as£¹
 (
_pssm
);

652 
	`as£¹
 (
_š™Ÿlized
);

653 
	`as£¹
 (
_lßded
);

659 
bË_row_t
* 
´b
 = 
_pb¿nch_mª
->
	`g‘_tu¶e
();

660 
	`as£¹
 (
´b
);

662 
»p_row_t
 
	`¬•row
(
_·ccouÁ_mª
->
	`ts
());

665 
¬•row
.
	`£t
(
_·ccouÁ_desc
->
	`maxsize
());

666 
´b
->
_»p
 = &
¬•row
;

671 
´b
->
	`£t_v®ue
(0, 
mš
.
b_id
);

672 
´b
->
	`£t_v®ue
(1, 0.0);

673 
´b
->
	`£t_v®ue
(2, "padding");

674 
e
 = 
_pb¿nch_mª
->
	`add_tu¶e
(
_pssm
, 
´b
);

675 ià(
e
.
	`is_”rÜ
()è{ 
dÚe
; }

678 
e
 = 
_pb¿nch_mª
->
	`b_šdex_´obe
(
_pssm
, 
´b
, 
mš
.
b_id
);

679 ià(
e
.
	`is_”rÜ
()è{ 
dÚe
; }

683 #ifdeà
PRINT_TRX_RESULTS


686 
´b
->
	`´št_tu¶e
();

689 
dÚe
:

691 
_pb¿nch_mª
->
	`give_tu¶e
(
´b
);

692  (
e
);

694 
	}
}

704 
w_rc_t
 
	gShÜeTPCBEnv
::
	$xù_mb’ch_d–‘e_´obe
(const ,

705 
mb’ch_d–‘e_´obe_šput_t
& 
mdpš
)

707 
w_rc_t
 
e
 = 
RCOK
;

710 
	`as£¹
 (
_pssm
);

711 
	`as£¹
 (
_š™Ÿlized
);

712 
	`as£¹
 (
_lßded
);

718 
bË_row_t
* 
´b
 = 
_pb¿nch_mª
->
	`g‘_tu¶e
();

719 
	`as£¹
 (
´b
);

721 
»p_row_t
 
	`¬•row
(
_·ccouÁ_mª
->
	`ts
());

724 
¬•row
.
	`£t
(
_·ccouÁ_desc
->
	`maxsize
());

725 
´b
->
_»p
 = &
¬•row
;

730 
e
 = 
_pb¿nch_mª
->
	`b_šdex_´obe
(
_pssm
, 
´b
, 
mdpš
.
b_id
);

731 ià(
e
.
	`is_”rÜ
()è{ 
dÚe
; }

734 
e
 = 
_pb¿nch_mª
->
	`d–‘e_tu¶e
(
_pssm
, 
´b
);

735 ià(
e
.
	`is_”rÜ
()è{ 
dÚe
; }

739 #ifdeà
PRINT_TRX_RESULTS


742 
´b
->
	`´št_tu¶e
();

745 
dÚe
:

747 
_pb¿nch_mª
->
	`give_tu¶e
(
´b
);

748  (
e
);

750 
	}
}

760 
w_rc_t
 
	gShÜeTPCBEnv
::
	$xù_mb’ch_mix
(const ,

761 
mb’ch_mix_šput_t
& 
mmš
)

763 
w_rc_t
 
e
 = 
RCOK
;

766 
	`as£¹
 (
_pssm
);

767 
	`as£¹
 (
_š™Ÿlized
);

768 
	`as£¹
 (
_lßded
);

774 
bË_row_t
* 
´b
 = 
_pb¿nch_mª
->
	`g‘_tu¶e
();

775 
	`as£¹
 (
´b
);

777 
»p_row_t
 
	`¬•row
(
_·ccouÁ_mª
->
	`ts
());

780 
¬•row
.
	`£t
(
_·ccouÁ_desc
->
	`maxsize
());

781 
´b
->
_»p
 = &
¬•row
;

786 
´b
->
	`£t_v®ue
(0, 
mmš
.
b_id
);

787 
´b
->
	`£t_v®ue
(1, 0.0);

788 
´b
->
	`£t_v®ue
(2, "padding");

789 
e
 = 
_pb¿nch_mª
->
	`add_tu¶e
(
_pssm
, 
´b
);

790 ià(
e
.
	`is_”rÜ
()è{ 
dÚe
; }

793 
e
 = 
_pb¿nch_mª
->
	`b_šdex_´obe
(
_pssm
, 
´b
, 
mmš
.
b_id
);

794 ià(
e
.
	`is_”rÜ
()è{ 
dÚe
; }

797 
e
 = 
_pb¿nch_mª
->
	`d–‘e_tu¶e
(
_pssm
, 
´b
);

798 ià(
e
.
	`is_”rÜ
()è{ 
dÚe
; }

802 #ifdeà
PRINT_TRX_RESULTS


805 
´b
->
	`´št_tu¶e
();

808 
dÚe
:

810 
_pb¿nch_mª
->
	`give_tu¶e
(
´b
);

811  (
e
);

813 
	}
}

818 
EXIT_NAMESPACE
(
cb
);

	@src/workload/tpcb/tpcb_input.cpp

29 
	~"k_defšes.h
"

31 
	~"wÜklßd/cb/cb_šput.h
"

33 
ENTER_NAMESPACE
(
cb
);

37 #undeà
ONLY_LOCAL_TCPB


38 
	#ONLY_LOCAL_TCPB


	)

40 #ifdeà 
ONLY_LOCAL_TCPB


41 #w¬nšg 
TPCB
 - 
u£s
 
Úly
 
loÿl
 
xùs


42 cÚ¡ 
	gLOCAL_TPCB
 = 100;

46 cÚ¡ 
	gLOCAL_TPCB
 = 85;

49 #w¬nšg 
TPCB
 
u£s
 
UZRªd
 
g’”©šg
 
skewed
 
ZfŸn
 
šputs
. 
SkewÃss
 
ÿn
 
be
 
cÚŒŞËd
 
by
 
the
 'zf' 
sh–l
 
commªd
.

52 
skew”_t
 
	gb_skew”
;

53 
skew”_t
 
	gt_skew”
;

54 
skew”_t
 
	ga_skew”
;

55 
boŞ
 
	g_chªge_lßd
 = 
çl£
;

62 
acù_upd©e_šput_t
 
	$ü—‹_acù_upd©e_šput
(
sf
,

63 
¥ecificBr
)

65 
	`as£¹
 (
sf
>0);

67 
acù_upd©e_šput_t
 
auš
;

69 if(
_chªge_lßd
) {

70 
auš
.
b_id
 = 
b_skew”
.
	`g‘_šput
();

71 
auš
.
t_id
 = (auš.
b_id
 * 
TPCB_TELLERS_PER_BRANCH
è+ 
t_skew”
.
	`g‘_šput
();

72 
accouÁ
 = 
a_skew”
.
	`g‘_šput
();

74 ià(
	`URªd
(0,100)>
LOCAL_TPCB
) {

76 
auš
.
a_id
 = (
	`URªd
(0,
sf
)*
TPCB_ACCOUNTS_PER_BRANCH
è+ 
accouÁ
;

80 
auš
.
a_id
 = (auš.
b_id
*
TPCB_ACCOUNTS_PER_BRANCH
è+ 
accouÁ
;

85 ià(
¥ecificBr
>0) {

86 
auš
.
b_id
 = 
¥ecificBr
-1;

89 
auš
.
b_id
 = 
	`UZRªd
(0,
sf
-1);

92 
auš
.
t_id
 = (auš.
b_id
 * 
TPCB_TELLERS_PER_BRANCH
è+ 
	`UZRªd
(0,TPCB_TELLERS_PER_BRANCH-1);

95 ià(
	`URªd
(0,100)>
LOCAL_TPCB
) {

97 
auš
.
a_id
 = (
	`URªd
(0,
sf
)*
TPCB_ACCOUNTS_PER_BRANCH
è+ 
	`UZRªd
(0,TPCB_ACCOUNTS_PER_BRANCH-1);

101 
auš
.
a_id
 = (auš.
b_id
*
TPCB_ACCOUNTS_PER_BRANCH
è+ 
	`UZRªd
(0,TPCB_ACCOUNTS_PER_BRANCH-1);

105 
auš
.
d–
 = 
	`URªd
(0,2000000) - 1000000;

107  (
auš
);

108 
	}
}

118 
pİuÏ‹_db_šput_t
 
	$ü—‹_pİuÏ‹_db_šput
(
sf
,

119 
¥ecificSub
)

121 
	`as£¹
 (
sf
>0);

122 
pİuÏ‹_db_šput_t
 
	`pdbš
(
sf
,
¥ecificSub
);

123  (
pdbš
);

124 
	}
}

133 vŞ©
	gb®ªû
 = 0;

135 
mb’ch_š£¹_Úly_šput_t
 
	$ü—‹_mb’ch_š£¹_Úly_šput
(
sf
,

136 
¥ecificBr
)

138 
	`as£¹
 (
sf
>0);

140 
mb’ch_š£¹_Úly_šput_t
 
mioš
;

145 ià(
¥ecificBr
>0) {

146 
mioš
.
b_id
 = 
¥ecificBr
-1;

149 
mioš
.
b_id
 = 
	`UZRªd
(0,
sf
-1);

153 
mioš
.
a_id
 = (mioš.
b_id
*
TPCB_ACCOUNTS_PER_BRANCH
è+ 
	`UZRªd
(0,TPCB_ACCOUNTS_PER_BRANCH-1);

155 
mioš
.
b®ªû
 = 
	`URªd
(0,200000000) - 100000000;

157  (
mioš
);

158 
	}
}

160 
	gmb’ch_š£¹_Úly_šput_t
::
	$´št
()

162 
	`TRACE
Ğ
TRACE_ALWAYS
, "%d %d %.2f\n", 
b_id
, 
a_id
, 
b®ªû
);

163 
	}
}

172 
mb’ch_d–‘e_Úly_šput_t
 
	$ü—‹_mb’ch_d–‘e_Úly_šput
(
sf
,

173 
¥ecificBr
)

175 
	`as£¹
 (
sf
>0);

177 
mb’ch_d–‘e_Úly_šput_t
 
mdoš
;

180 ià(
¥ecificBr
>0) {

181 
mdoš
.
b_id
 = 
¥ecificBr
-1;

184 
mdoš
.
b_id
 = 
	`UZRªd
(0,
sf
-1);

188 
mdoš
.
a_id
 = (mdoš.
b_id
*
TPCB_ACCOUNTS_PER_BRANCH
è+ 
	`UZRªd
(0,TPCB_ACCOUNTS_PER_BRANCH-1);

190 
mdoš
.
b®ªû
 = 
	`URªd
(0,2000000) - 1000000;

192  (
mdoš
);

193 
	}
}

195 
	gmb’ch_d–‘e_Úly_šput_t
::
	$´št
()

197 
	`TRACE
Ğ
TRACE_ALWAYS
, "%d %d %.2f\n", 
b_id
, 
a_id
, 
b®ªû
);

198 
	}
}

208 
mb’ch_´obe_Úly_šput_t
 
	$ü—‹_mb’ch_´obe_Úly_šput
(
sf
,

209 
¥ecificBr
)

211 
	`as£¹
 (
sf
>0);

213 
mb’ch_´obe_Úly_šput_t
 
mpoš
;

216 ià(
¥ecificBr
>0) {

217 
mpoš
.
b_id
 = 
¥ecificBr
-1;

220 
mpoš
.
b_id
 = 
	`UZRªd
(0,
sf
-1);

224 
mpoš
.
a_id
 = (mpoš.
b_id
*
TPCB_ACCOUNTS_PER_BRANCH
è+ 
	`UZRªd
(0,TPCB_ACCOUNTS_PER_BRANCH-1);

226 
mpoš
.
b®ªû
 = 
	`URªd
(0,200000000) - 100000000;

228  (
mpoš
);

229 
	}
}

231 
	gmb’ch_´obe_Úly_šput_t
::
	$´št
()

233 
	`TRACE
Ğ
TRACE_ALWAYS
, "%d %d %.2f\n", 
b_id
, 
a_id
, 
b®ªû
);

234 
	}
}

244 
mb’ch_š£¹_d–‘e_šput_t
 
	$ü—‹_mb’ch_š£¹_d–‘e_šput
(
sf
,

245 
¥ecificBr
)

247 
	`as£¹
 (
sf
>0);

249 
mb’ch_š£¹_d–‘e_šput_t
 
midš
;

250 
mb’ch_š£¹_Úly_šput_t
 
mioš
;

251 
mioš
 = 
	`ü—‹_mb’ch_š£¹_Úly_šput
(
sf
, 
¥ecificBr
);

252 
midš
.
b_id
 = 
mioš
.b_id;

253 
midš
.
a_id
 = 
mioš
.a_id;

254 
midš
.
b®ªû
 = 
mioš
.balance;

256  (
midš
);

257 
	}
}

267 
mb’ch_š£¹_´obe_šput_t
 
	$ü—‹_mb’ch_š£¹_´obe_šput
(
sf
,

268 
¥ecificBr
)

270 
	`as£¹
 (
sf
>0);

272 
mb’ch_š£¹_´obe_šput_t
 
mš
;

273 
mb’ch_š£¹_Úly_šput_t
 
mioš
;

274 
mioš
 = 
	`ü—‹_mb’ch_š£¹_Úly_šput
(
sf
, 
¥ecificBr
);

275 
mš
.
b_id
 = 
mioš
.b_id;

276 
mš
.
a_id
 = 
mioš
.a_id;

277 
mš
.
b®ªû
 = 
mioš
.balance;

279  (
mš
);

280 
	}
}

290 
mb’ch_d–‘e_´obe_šput_t
 
	$ü—‹_mb’ch_d–‘e_´obe_šput
(
sf
,

291 
¥ecificBr
)

293 
	`as£¹
 (
sf
>0);

295 
mb’ch_d–‘e_´obe_šput_t
 
mdpš
;

296 
mb’ch_d–‘e_Úly_šput_t
 
mdoš
;

297 
mdoš
 = 
	`ü—‹_mb’ch_d–‘e_Úly_šput
(
sf
, 
¥ecificBr
);

298 
mdpš
.
b_id
 = 
mdoš
.b_id;

299 
mdpš
.
a_id
 = 
mdoš
.a_id;

300 
mdpš
.
b®ªû
 = 
mdoš
.balance;

303  (
mdpš
);

304 
	}
}

314 
mb’ch_mix_šput_t
 
	$ü—‹_mb’ch_mix_šput
(
sf
,

315 
¥ecificBr
)

317 
	`as£¹
 (
sf
>0);

319 
mb’ch_mix_šput_t
 
mmš
;

320 
mb’ch_š£¹_Úly_šput_t
 
mioš
;

321 
mioš
 = 
	`ü—‹_mb’ch_š£¹_Úly_šput
(
sf
, 
¥ecificBr
);

322 
mmš
.
b_id
 = 
mioš
.b_id;

323 
mmš
.
a_id
 = 
mioš
.a_id;

324 
mmš
.
b®ªû
 = 
mioš
.balance;

326  (
mmš
);

327 
	}
}

332 
EXIT_NAMESPACE
(
cb
);

	@src/workload/tpcc/shore_tpcc_client.cpp

31 
	~"wÜklßd/cc/shÜe_cc_ş›Á.h
"

33 
ENTER_NAMESPACE
(
cc
);

43 
	gba£lše_cc_ş›Á_t
::
	$ba£lše_cc_ş›Á_t
(
c_¡r
 
Šame
, cÚ¡ 
id
,

44 
ShÜeTPCCEnv
* 
’v
,

45 cÚ¡ 
M—su»m’tTy³
 
aTy³
,

46 cÚ¡ 
Œxid
,

47 cÚ¡ 
numOfTrxs
,

48 
´oûssÜid_t
 
­rsid
,

49 cÚ¡ 
sWH
, cÚ¡ 
qf
)

50 : 
	`ba£_ş›Á_t
(
Šame
,
id
,
’v
,
aTy³
,
Œxid
,
numOfTrxs
,
­rsid
),

51 
	`_wh
(
sWH
), 
	$_qf
(
qf
)

53 
	`as£¹
 (
’v
);

54 
	`as£¹
 (
_wh
>=0 && 
_qf
>0);

57 
_wÜk”
 = 
_’v
->
	`wÜk”
(
_id
);

58 
	`as£¹
 (
_wÜk”
);

59 
	}
}

62 
	gba£lše_cc_ş›Á_t
::
	$lßd_sup_xù
(
m­SupTrxs
& 
¡m­
)

65 
¡m­
.
	`ş—r
();

68 
¡m­
[
XCT_MIX
] = "TPCC-Mix";

69 
¡m­
[
XCT_NEW_ORDER
] = "TPCC-NewOrder";

70 
¡m­
[
XCT_PAYMENT
] = "TPCC-Payment";

71 
¡m­
[
XCT_ORDER_STATUS
] = "TPCC-OrderStatus";

72 
¡m­
[
XCT_DELIVERY
] = "TPCC-Delivery";

73 
¡m­
[
XCT_STOCK_LEVEL
] = "TPCC-StockLevel";

75 
¡m­
[
XCT_LITTLE_MIX
] = "TPCC-LittleMix";

78 
¡m­
[
XCT_MBENCH_WH
] = "TPCC-MBench-WHs";

79 
¡m­
[
XCT_MBENCH_CUST
] = "TPCC-MBench-CUSTs";

81  (
¡m­
.
	`size
());

82 
	}
}

96 
w_rc_t
 
	gba£lše_cc_ş›Á_t
::
	$subm™_Úe
(
xù_ty³
, 
xùid
)

99 
Œx_»suÉ_tu¶e_t
 
©¹
;

100 
boŞ
 
bWake
 = 
çl£
;

101 ià(
cÚdex
* 
c
 = 
_ı
->
	`ke_Úe
()) {

102 
©¹
.
	`£t_nÙify
(
c
);

103 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Sleeping\n");

104 
bWake
 = 
Œue
;

108 
whid
 = 
_wh
;

109 ià(
_wh
==0)

110 
whid
 = 
	`URªd
(1,
_qf
);

113 
Œx_»que¡_t
* 
¬eque¡
 = 
	`Ãw
 (
_’v
->
_»que¡_poŞ
)rx_request_t;

114 
tid_t
 
©id
;

115 
¬eque¡
->
	`£t
(
NULL
,
©id
,
xùid
,
©¹
,
xù_ty³
,
whid
);

118 
	`as£¹
 (
_wÜk”
);

119 
_wÜk”
->
	`’queue
(
¬eque¡
,
bWake
);

120  (
RCOK
);

121 
	}
}

125 
EXIT_NAMESPACE
(
cc
);

	@src/workload/tpcc/shore_tpcc_env.cpp

31 
	~"wÜklßd/cc/shÜe_cc_’v.h
"

32 
	~"sm/shÜe/shÜe_h–³r_lßd”.h
"

34 
	~"wÜklßd/cc/cc_¿ndom.h
"

36 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
ENTER_NAMESPACE
(
shÜe
);

39 
DEFINE_ROW_CACHE_TLS
(
cc
, 
w¬ehou£
);

40 
DEFINE_ROW_CACHE_TLS
(
cc
, 
di¡riù
);

41 
DEFINE_ROW_CACHE_TLS
(
cc
, 
¡ock
);

42 
DEFINE_ROW_CACHE_TLS
(
cc
, 
Üd”_lše
);

43 
DEFINE_ROW_CACHE_TLS
(
cc
, 
cu¡om”
);

44 
DEFINE_ROW_CACHE_TLS
(
cc
, 
hi¡Üy
);

45 
DEFINE_ROW_CACHE_TLS
(
cc
, 
Üd”
);

46 
DEFINE_ROW_CACHE_TLS
(
cc
, 
Ãw_Üd”
);

47 
DEFINE_ROW_CACHE_TLS
(
cc
, 
™em
);

48 
EXIT_NAMESPACE
(
shÜe
);

50 
ENTER_NAMESPACE
(
cc
);

61 
	gShÜeTPCCEnv
::
checkpoš‹r_t
 : 
public
 
th»ad_t


63 
ShÜeTPCCEnv
* 
_’v
;

64 
checkpoš‹r_t
(
ShÜeTPCCEnv
* 
’v
)

65 : 
th»ad_t
("TPC-C-Chk±"), 
_’v
(
’v
) { }

66 
vœtu®
 
wÜk
();

70 şas 
	cShÜeTPCCEnv
::
bË_bud”_t
 : 
public
 
th»ad_t


72 
ShÜeTPCCEnv
* 
_’v
;

73 
	m_¡¬t
;

74 
	m_couÁ
;

75 * 
	m_cids
;

76 
	mpublic
:

77 
	$bË_bud”_t
(
ShÜeTPCCEnv
* 
’v
, cÚ¡ 
id
, 
¡¬t
, 
couÁ
, * 
cids
)

78 : 
	`th»ad_t
(
	`c_¡r
("LD-%d",
id
)),

79 
	`_’v
(
’v
), 
	`_¡¬t
(
¡¬t
), 
	`_couÁ
(
couÁ
), 
	$_cids
(
cids
) { }

80 
vœtu®
 
	`wÜk
();

81 
	}
};

84 
	gShÜeTPCCEnv
::
bË_ü—tÜ_t
 : 
public
 
th»ad_t


86 
ShÜeTPCCEnv
* 
_’v
;

87 
	g_sf
;

88 
bË_ü—tÜ_t
(
ShÜeTPCCEnv
* 
’v
, 
sf
)

89 : 
th»ad_t
("CR"), 
_’v
(
’v
), 
_sf
(
sf
) { }

90 
vœtu®
 
wÜk
();

95 
	gShÜeTPCCEnv
::
checkpoš‹r_t
::
	$wÜk
()

97 
boŞ
 vŞ©e* 
lßded
 = &
_’v
->
_lßded
;

98 !*
lßded
) {

99 
_’v
->
	`£t_m—su»
(
MST_MEASURE
);

100 
i
=0; i < 60 && ! *
lßded
; i++) {

101 ::
	`¦“p
(1);

104 
	`TRACE
Ğ
TRACE_ALWAYS
, "db checkpoint - start\n");

105 
_’v
->
	`checkpošt
();

106 
	`TRACE
Ğ
TRACE_ALWAYS
, "db checkpoint -ƒnd\n");

108 
_’v
->
	`£t_m—su»
(
MST_PAUSE
);

109 
	}
}

112 
	gShÜeTPCCEnv
::
bË_ü—tÜ_t
::
	$wÜk
()

115 
	`W_COERCE
(
_’v
->
	`db
()->
	`begš_xù
());

116 
	`W_COERCE
(
_’v
->
_pw¬ehou£_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

117 
	`W_COERCE
(
_’v
->
_pdi¡riù_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

118 
	`W_COERCE
(
_’v
->
_pcu¡om”_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

119 
	`W_COERCE
(
_’v
->
_phi¡Üy_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

120 
	`W_COERCE
(
_’v
->
_²ew_Üd”_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

121 
	`W_COERCE
(
_’v
->
_pÜd”_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

122 
	`W_COERCE
(
_’v
->
_pÜd”_lše_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

123 
	`W_COERCE
(
_’v
->
_p™em_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

124 
	`W_COERCE
(
_’v
->
_p¡ock_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

125 
	`W_COERCE
(
_’v
->
	`db
()->
	`comm™_xù
());

129 
_’v
->
_pw¬ehou£_mª
->
	`»gi¡”_bË_mª
();

130 
_’v
->
_pdi¡riù_mª
->
	`»gi¡”_bË_mª
();

131 
_’v
->
_pcu¡om”_mª
->
	`»gi¡”_bË_mª
();

132 
_’v
->
_phi¡Üy_mª
->
	`»gi¡”_bË_mª
();

133 
_’v
->
_²ew_Üd”_mª
->
	`»gi¡”_bË_mª
();

134 
_’v
->
_pÜd”_mª
->
	`»gi¡”_bË_mª
();

135 
_’v
->
_pÜd”_lše_mª
->
	`»gi¡”_bË_mª
();

136 
_’v
->
_p™em_mª
->
	`»gi¡”_bË_mª
();

137 
_’v
->
_p¡ock_mª
->
	`»gi¡”_bË_mª
();

141 
pİuÏ‹_ba£lše_šput_t
 
š
 = {
_sf
};

142 
	`W_COERCE
(
_’v
->
	`db
()->
	`begš_xù
());

143 
	`W_COERCE
(
_’v
->
	`xù_pİuÏ‹_ba£lše
(0, 
š
));

145 
	`W_COERCE
(
_’v
->
	`db
()->
	`begš_xù
());

146 
	`W_COERCE
(
_’v
->
	`_po¡_š™_im¶
());

147 
	`W_COERCE
(
_’v
->
	`db
()->
	`comm™_xù
());

153 
i
=-1; i < 
_pcouÁ
; i++) {

154 
a_id
 = 
i
*
_psize
;

155 
pİuÏ‹_db_šput_t
 
	`š
(
_sf
, 
a_id
);

156 
	`årštf
(
¡d”r
, "PİuÏtšg %d‡_id ¡¬tšg w™h %d\n", 
ACCOUNTS_CREATED_PER_POP_XCT
, 
a_id
);

157 
	`W_COERCE
(
_’v
->
	`db
()->
	`begš_xù
());

158 
	`W_COERCE
(
_’v
->
	`xù_pİuÏ‹_db
(&
š
, 
a_id
));

161 
	}
}

162 
	$g’_cid_¬¿y
(* 
cid_¬¿y
) {

163 
i
=0; i < 
ORDERS_PER_DIST
; i++)

164 
cid_¬¿y
[
i
] = i+1;

165 
i
=0; i < 
ORDERS_PER_DIST
; i++) {

166 
¡d
::
	`sw­
(
cid_¬¿y
[
i
], cid_¬¿y[i+
	`URªd
(0,
ORDERS_PER_DIST
-i-1)]);

169 
	}
}

172 
	gun™s_com¶‘ed
 = 0;

174 
	gShÜeTPCCEnv
::
bË_bud”_t
::
	$wÜk
()

176 
w_rc_t
 
e
 = 
RCOK
;

185 
cid_¬¿y
[
ORDERS_PER_DIST
];

186 
	`g’_cid_¬¿y
(
cid_¬¿y
);

189 
i
=0 ; i < 
_couÁ
; i++) {

190 
_’v
->
	`g‘_m—su»
(è!ğ
MST_MEASURE
)

191 
	`u¦“p
(10000);

193 
tid
 = 
_¡¬t
 + 
i
;

195 
¡¬t_di¡
 = (
tid
 + 
UNIT_PER_DIST
 - 1)/UNIT_PER_DIST;

196 
’d_di¡
 = (
tid
 + 
UNIT_PER_DIST
)/UNIT_PER_DIST;

197 
boŞ
 
ov”Ïp
 = (
¡¬t_di¡
*
UNIT_PER_DIST
 < 
_¡¬t
è|| (
’d_di¡
*UNIT_PER_DIST >ğ_¡¬t+
_couÁ
);

198 *
cids
 = 
ov”Ïp
? 
_cids
 : 
cid_¬¿y
+0;

199 
pİuÏ‹_Úe_un™_šput_t
 
š
 = {
tid
, 
cids
};

200 
log_¥aû_Ãeded
 = 0;

201 
»Œy
:

202 
	`W_COERCE
(
_’v
->
	`db
()->
	`begš_xù
());

204 #ifdeà
USE_SHORE_6


205 if(
log_¥aû_Ãeded
 > 0) {

207 
	`W_COERCE
(
_’v
->
	`db
()->
	`xù_»£rve_log_¥aû
(10*
log_¥aû_Ãeded
/9));

210 
e
 = 
_’v
->
	`xù_pİuÏ‹_Úe_un™
(
tid
, 
š
);

212 
	`CHECK_XCT_RETURN
(
e
,
log_¥aû_Ãeded
,
»Œy
,
_’v
);

214 
nv®
 = 
	`©omic_šc_64_nv
(&
un™s_com¶‘ed
);

215 
soçr
 = 
nv®
 / 
UNIT_PER_WH
;

216 if(
nv®
 % 
UNIT_PER_WH
 == 0) {

217 
	`årštf
(
¡d”r
, "%lu\n", 
soçr
);

220 
	`TRACE
Ğ
TRACE_ALWAYS
,

222 
_¡¬t
, _¡¬t+
_couÁ
);

223 
	}
}

234 
	gShÜeTPCCEnv
::
	$ShÜeTPCCEnv
()

235 : 
	$ShÜeEnv
()

237 
	}
}

239 
ShÜeTPCCEnv
::~
	$ShÜeTPCCEnv
()

241 
	}
}

254 
w_rc_t
 
ShÜeTPCCEnv
::
	$lßd_schema
()

257 
_pw¬ehou£_desc
 = 
Ãw
 
	`w¬ehou£_t
(
	`g‘_pd
());

258 
_pdi¡riù_desc
 = 
Ãw
 
	`di¡riù_t
(
	`g‘_pd
());

259 
_pcu¡om”_desc
 = 
Ãw
 
	`cu¡om”_t
(
	`g‘_pd
());

260 
_phi¡Üy_desc
 = 
Ãw
 
	`hi¡Üy_t
(
	`g‘_pd
());

261 
_²ew_Üd”_desc
 = 
Ãw
 
	`Ãw_Üd”_t
(
	`g‘_pd
());

262 
_pÜd”_desc
 = 
Ãw
 
	`Üd”_t
(
	`g‘_pd
());

263 
_pÜd”_lše_desc
 = 
Ãw
 
	`Üd”_lše_t
(
	`g‘_pd
());

264 
_p™em_desc
 = 
Ãw
 
	`™em_t
(
	`g‘_pd
());

265 
_p¡ock_desc
 = 
Ãw
 
	`¡ock_t
(
	`g‘_pd
());

269 
_pw¬ehou£_mª
 = 
Ãw
 
	`w¬ehou£_mª_im¶
(
_pw¬ehou£_desc
.
	`g‘
());

270 
_pdi¡riù_mª
 = 
Ãw
 
	`di¡riù_mª_im¶
(
_pdi¡riù_desc
.
	`g‘
());

271 
_p¡ock_mª
 = 
Ãw
 
	`¡ock_mª_im¶
(
_p¡ock_desc
.
	`g‘
());

272 
_pÜd”_lše_mª
 = 
Ãw
 
	`Üd”_lše_mª_im¶
(
_pÜd”_lše_desc
.
	`g‘
());

273 
_pcu¡om”_mª
 = 
Ãw
 
	`cu¡om”_mª_im¶
(
_pcu¡om”_desc
.
	`g‘
());

274 
_phi¡Üy_mª
 = 
Ãw
 
	`hi¡Üy_mª_im¶
(
_phi¡Üy_desc
.
	`g‘
());

275 
_pÜd”_mª
 = 
Ãw
 
	`Üd”_mª_im¶
(
_pÜd”_desc
.
	`g‘
());

276 
_²ew_Üd”_mª
 = 
Ãw
 
	`Ãw_Üd”_mª_im¶
(
_²ew_Üd”_desc
.
	`g‘
());

277 
_p™em_mª
 = 
Ãw
 
	`™em_mª_im¶
(
_p™em_desc
.
	`g‘
());

279  (
RCOK
);

280 
	}
}

293 
w_rc_t
 
	gShÜeTPCCEnv
::
	$lßd_ªd_»gi¡”_fids
()

295 
	`W_DO
(
_pw¬ehou£_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

296 
	`W_DO
(
_pdi¡riù_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

297 
	`W_DO
(
_p¡ock_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

298 
	`W_DO
(
_pÜd”_lše_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

299 
	`W_DO
(
_pcu¡om”_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

300 
	`W_DO
(
_phi¡Üy_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

301 
	`W_DO
(
_pÜd”_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

302 
	`W_DO
(
_²ew_Üd”_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

303 
	`W_DO
(
_p™em_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

304  (
RCOK
);

305 
	}
}

317 
w_rc_t
 
	gShÜeTPCCEnv
::
	$upd©e_·¹™iÚšg
()

322 
	`cÚf
();

325 
ušt
 
mrb¬ts
 = 
’vV¬
::
	`š¡ªû
()->
	`g‘V¬IÁ
("mrbt-partitions",10);

326 
mšKeyV®
 = 1;

327 
maxKeyV®
 = 
	`g‘_sf
()+1;

329 * 
mšKey
 = (*)
	`m®loc
(());

330 
	`mem£t
(
mšKey
,0,());

331 
	`memıy
(
mšKey
,&
mšKeyV®
,());

333 * 
maxKey
 = (*)
	`m®loc
(());

334 
	`mem£t
(
maxKey
,0,());

335 
	`memıy
(
maxKey
,&
maxKeyV®
,());

339 
_pw¬ehou£_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
mrb¬ts
);

340 
_pdi¡riù_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
mrb¬ts
);

341 
_pcu¡om”_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
mrb¬ts
);

342 
_²ew_Üd”_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
mrb¬ts
);

343 
_pÜd”_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
mrb¬ts
);

344 
_pÜd”_lše_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
mrb¬ts
);

345 
_phi¡Üy_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
mrb¬ts
);

346 
_p¡ock_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
mrb¬ts
);

350 
maxKeyV®
 = 
ITEMS
 + 1;

351 
	`mem£t
(
maxKey
,0,());

352 
	`memıy
(
maxKey
,&
maxKeyV®
,());

353 
_p™em_desc
->
	`£t_·¹™iÚšg
(
mšKey
,(),
maxKey
,(),
mrb¬ts
);

356 
	`ä“
 (
mšKey
);

357 
	`ä“
 (
maxKey
);

359  (
RCOK
);

360 
	}
}

370 
	gShÜeTPCCEnv
::
	$£t_skew
(
¬—
, 
lßd
, 
¡¬t_imb®ªû
)

372 
ShÜeEnv
::
	`£t_skew
(
¬—
, 
lßd
, 
¡¬t_imb®ªû
);

374 
w_skew”
.
	`£t
(
¬—
, 1, 
_sÿlšg_çùÜ
, 
lßd
);

375 
	}
}

386 
	gShÜeTPCCEnv
::
	$¡¬t_lßd_imb®ªû
()

388 if(
w_skew”
.
	`is_u£d
()) {

389 
_chªge_lßd
 = 
çl£
;

391 
w_skew”
.
	`»£t
(
_skew_ty³
);

393 if(
_skew_ty³
 !ğ
SKEW_CHAOTIC
 || 
	`URªd
(1,100) > 30) {

394 
_chªge_lßd
 = 
Œue
;

396 
ShÜeEnv
::
	`¡¬t_lßd_imb®ªû
();

397 
	}
}

408 
	gShÜeTPCCEnv
::
	$»£t_skew
()

410 
ShÜeEnv
::
	`»£t_skew
();

411 
_chªge_lßd
 = 
çl£
;

412 
w_skew”
.
	`ş—r
();

413 
	}
}

424 
	gShÜeTPCCEnv
::
	$šfo
() const

426 
	`TRACE
Ğ
TRACE_ALWAYS
, "SF = (%.1f)\n", 
_sÿlšg_çùÜ
);

427 
	`TRACE
Ğ
TRACE_ALWAYS
, "WÜk” ğ(%d)\n", 
_wÜk”_út
);

429 
	}
}

441 
	gShÜeTPCCEnv
::
	$¡©i¡ics
()

444 
	`CRITICAL_SECTION
(
cs
, 
_¡©m­_mu‹x
);

445 
ShÜeTPCCTrxSts
 
rv®
;

446 
rv®
 -=„val;

447 
¡©m­_t
::
™”©Ü
 
™
=
_¡©m­
.
	`begš
(); iˆ!ğ_¡©m­.
	`’d
(); ++it)

448 
rv®
 +ğ*
™
->
£cÚd
;

450 
	`TRACE
Ğ
TRACE_STATISTICS
, "NewOrder. Att (%d). Abt (%d). Dld (%d)\n",

451 
rv®
.
©‹m±ed
.
Ãw_Üd”
,

452 
rv®
.
çed
.
Ãw_Üd”
,

453 
rv®
.
d—dlocked
.
Ãw_Üd”
);

455 
	`TRACE
Ğ
TRACE_STATISTICS
, "Payment. Att (%d). Abt (%d). Dld (%d)\n",

456 
rv®
.
©‹m±ed
.
·ym’t
,

457 
rv®
.
çed
.
·ym’t
,

458 
rv®
.
d—dlocked
.
·ym’t
);

460 
	`TRACE
Ğ
TRACE_STATISTICS
, "OrderStatus. Att (%d). Abt (%d). Dld (%d)\n",

461 
rv®
.
©‹m±ed
.
Üd”_¡©us
,

462 
rv®
.
çed
.
Üd”_¡©us
,

463 
rv®
.
d—dlocked
.
Üd”_¡©us
);

465 
	`TRACE
Ğ
TRACE_STATISTICS
, "Delivery. Att (%d). Abt (%d). Dld (%d)\n",

466 
rv®
.
©‹m±ed
.
d–iv”y
,

467 
rv®
.
çed
.
d–iv”y
,

468 
rv®
.
d—dlocked
.
d–iv”y
);

470 
	`TRACE
Ğ
TRACE_STATISTICS
, "StockLevel. Att (%d). Abt (%d). Dld (%d)\n",

471 
rv®
.
©‹m±ed
.
¡ock_Ëv–
,

472 
rv®
.
çed
.
¡ock_Ëv–
,

473 
rv®
.
d—dlocked
.
¡ock_Ëv–
);

475 
	`TRACE
Ğ
TRACE_STATISTICS
, "MBenchWh. Att (%d). Abt (%d). Dld (%d)\n",

476 
rv®
.
©‹m±ed
.
mb’ch_wh
,

477 
rv®
.
çed
.
mb’ch_wh
,

478 
rv®
.
d—dlocked
.
mb’ch_wh
);

480 
	`TRACE
Ğ
TRACE_STATISTICS
, "MBenchCust. Att (%d). Abt (%d). Dld (%d)\n",

481 
rv®
.
©‹m±ed
.
mb’ch_cu¡
,

482 
rv®
.
çed
.
mb’ch_cu¡
,

483 
rv®
.
d—dlocked
.
mb’ch_cu¡
);

485 
ShÜeEnv
::
	`¡©i¡ics
();

488 
	}
}

500 
	gShÜeTPCCEnv
::
	$¡¬t
()

502  (
ShÜeEnv
::
	`¡¬t
());

503 
	}
}

505 
	gShÜeTPCCEnv
::
	$¡İ
()

507  (
ShÜeEnv
::
	`¡İ
());

508 
	}
}

529 
w_rc_t
 
	gShÜeTPCCEnv
::
	$lßdd©a
()

532 
	`CRITICAL_SECTION
(
lßd_cs
, 
_lßd_mu‹x
);

533 ià(
_lßded
) {

534 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

536  (
RCOK
);

538 
	`CRITICAL_SECTION
(
sÿË_cs
, 
_sÿlšg_mu‹x
);

539 
time_t
 
t¡¬t
 = 
	`time
(
NULL
);

541 
cid_¬¿y
[
ORDERS_PER_DIST
];

542 
	`g’_cid_¬¿y
(
cid_¬¿y
);

546 
gu¬d
<
bË_ü—tÜ_t
> 
tc
;

547 
tc
 = 
Ãw
 
	`bË_ü—tÜ_t
(
this
, 
_sÿlšg_çùÜ
);

548 
tc
->
	`fÜk
();

549 
tc
->
	`još
();

553 
gu¬d
<
checkpoš‹r_t
> 
	`chk
(
Ãw
 
	`checkpoš‹r_t
(
this
));

554 
chk
->
	`fÜk
();

557 
lßd”s_to_u£
 = 
’vV¬
::
	`š¡ªû
()->
	`g‘V¬IÁ
("db-loaders",10);

558 
¬¿y_gu¬d_t
< 
gu¬d
<
bË_bud”_t
> > 
	`lßd”s
(
Ãw
 gu¬d<bË_bud”_t>[
lßd”s_to_u£
]);

559 
tÙ®_un™s
 = 
_sÿlšg_çùÜ
*
UNIT_PER_WH
;

562 
un™s_³r_th»ad
 = (
tÙ®_un™s
 + 
lßd”s_to_u£
-1)/loaders_to_use;

563 
divisÜ
 = 
ORDERS_PER_DIST
/
ORDERS_PER_UNIT
;

564 
un™s_³r_th»ad
 = ((un™s_³r_th»ad + 
divisÜ
-1)/divisor)*divisor;

566 
i
=0; i < 
lßd”s_to_u£
; i++) {

567 
¡¬t
 = 
i
*
un™s_³r_th»ad
;

568 
couÁ
 = (
¡¬t
+
un™s_³r_th»ad
 > 
tÙ®_un™s
)?otal_units-start : units_per_thread;

569 
lßd”s
[
i
] = 
Ãw
 
	`bË_bud”_t
(
this
, i, 
¡¬t
, 
couÁ
, 
cid_¬¿y
);

570 
lßd”s
[
i
]->
	`fÜk
();

573 
i
=0; i < 
lßd”s_to_u£
; i++) {

574 
lßd”s
[
i
]->
	`još
();

577 
time_t
 
t¡İ
 = 
	`time
(
NULL
);

580 
	`TRACE
Ğ
TRACE_STATISTICS
, "Loading finished. %dable†oaded in (%d) secs...\n",

581 
SHORE_TPCC_TABLES
, (
t¡İ
 - 
t¡¬t
));

584 
_lßded
 = 
Œue
;

585 
chk
->
	`još
();

587  (
RCOK
);

588 
	}
}

602 
w_rc_t
 
	gShÜeTPCCEnv
::
	$check_cÚsi¡’cy
()

604 
	`as£¹
 (0);

605  (
RCOK
);

606 
	}
}

618 
w_rc_t
 
	gShÜeTPCCEnv
::
	$w¬mup
()

620  (
	`check_cÚsi¡’cy
());

621 
	}
}

632 
	gShÜeTPCCEnv
::
	$dump
()

634 
	`as£¹
 (0);

644 
	}
}

647 
	gShÜeTPCCEnv
::
	$cÚf
()

650 
ShÜeEnv
::
	`cÚf
();

651 
	`upd_sf
();

652 
	`upd_wÜk”_út
();

654 
	}
}

671 
	gShÜeTPCCEnv
::
	$po¡_š™
()

673 
	`cÚf
();

676 ià(
	`g‘_pd
(è=ğ
PD_PADDED
) {

677 
	`TRACE
Ğ
TRACE_ALWAYS
, "Checking for WH„ecord…adding...\n");

679 
	`W_COERCE
(
	`db
()->
	`begš_xù
());

680 
w_rc_t
 
rc
 = 
	`_po¡_š™_im¶
();

681 if(
rc
.
	`is_”rÜ
()) {

682 
û¼
 << "-> WH…addšg faed w™h: " << 
rc
 << 
’dl
;

683 
rc
 = 
	`db
()->
	`abÜt_xù
();

684  (
rc
.
	`”r_num
());

687 
	`TRACE
Ğ
TRACE_ALWAYS
, "-> Done\n");

688 
rc
 = 
	`db
()->
	`comm™_xù
();

694 
	}
}

705 
w_rc_t
 
	gShÜeTPCCEnv
::
	$_po¡_š™_im¶
()

707 #iâdeà
CFG_HACK


708  (
RCOK
);

711 
	`TRACE
 (
TRACE_ALWAYS
, "Padding WAREHOUSES");

712 
ss_m
* 
db
 = 
this
->
	`db
();

715 
w¬ehou£_t
* 
wh
 = 
	`w¬ehou£_desc
();

716 
šdex_desc_t
* 
idx
 = 
wh
->
	`šdexes
();

717 
icouÁ
 = 
wh
->
	`šdex_couÁ
();

718 
¡id_t
 
wh_fid
 = 
wh
->
	`fid
();

721 
	`W_DO
(
db
->
	`lock
(
wh_fid
, 
EX
));

722 
i
=0; i < 
icouÁ
; i++) {

723 
j
=0; j < 
idx
[
i
].
	`g‘_·¹™iÚ_couÁ
(); j++)

724 
	`W_DO
(
db
->
	`lock
(
idx
[
i
].
	`fid
(
j
), 
EX
));

727 
gu¬d
<
©s_ch¬_t
> 
±s
 = 
Ãw
 
	`©s_ch¬_t
(
wh
->
	`maxsize
());

735 
boŞ
 
eof
;

736 cÚ¡ 
PADDED_SIZE
 = 4096;

737 
¬¿y_gu¬d_t
<> 
·ddšg
 = 
Ãw
 [
PADDED_SIZE
];

738 
¡d
::
veùÜ
<
rid_t
> 
h™_li¡
;

740 
gu¬d
<
w¬ehou£_mª_im¶
::
bË_™”
> 
™”
;

742 
w¬ehou£_mª_im¶
::
bË_™”
* 
tmp
;

743 
	`W_DO
(
	`w¬ehou£_mª
()->
	`g‘_™”_fÜ_fe_sÿn
(
db
, 
tmp
));

744 
™”
 = 
tmp
;

747 
couÁ
 = 0;

748 
w¬ehou£_mª_im¶
::
bË_tu¶e
 
	`row
(
wh
);

749 
»p_row_t
 
	`¬•
(
±s
);

750 
psize
 = 
wh
->
	`maxsize
()+1;

752 
	`W_DO
(
™”
->
	`Ãxt
(
db
, 
eof
, 
row
));

754 
pš_i
* 
hªdË
 = 
™”
->
	`cursÜ
();

755 ià(!
hªdË
) {

756 
	`TRACE
(
TRACE_ALWAYS
, " -> R—ched EOF. S—rch com¶‘(%d)\n", 
couÁ
);

761 
hsize
 = 
hªdË
->
	`hdr_size
();

762 
bsize
 = 
hªdË
->
	`body_size
();

763 ià(
bsize
 =ğ
psize
) {

764 
	`TRACE
(
TRACE_ALWAYS
, " -> Found…added WH„ecÜd. Stİpšg s—rch (%d)\n", 
couÁ
);

767 ià(
bsize
 > 
psize
) {

769 
hªdË
->
	`Œunÿ‹_»c
(
bsize
 - 
psize
);

770 
	`årštf
(
¡d”r
, "+");

774 
rid_t
 
Ãw_rid
;

775 
vec_t
 
	`hvec
(
hªdË
->
	`hdr
(), 
hsize
);

776 
vec_t
 
	`dvec
(
hªdË
->
	`body
(), 
bsize
);

777 
vec_t
 
	`pvec
(
·ddšg
, 
PADDED_SIZE
-
bsize
);

778 
	`W_DO
(
db
->
	`ü—‹_»c
(
wh_fid
, 
hvec
, 
PADDED_SIZE
, 
dvec
, 
Ãw_rid
));

779 
	`W_DO
(
db
->
	`­³nd_»c
(
Ãw_rid
, 
pvec
));

781 ià(
nÙ
 
hªdË
->
	`up_to_d©e
())

782 
hªdË
->
	`»pš
();

785 
h™_li¡
.
	`push_back
(
hªdË
->
	`rid
());

788 
vec_t
 
	`rvec
(&
row
.
_rid
, (
rid_t
));

789 
vec_t
 
	`Ävec
(&
Ãw_rid
, (new_rid));

790 
i
=0; i < 
icouÁ
; i++) {

791 
key_sz
 = 
	`w¬ehou£_mª
()->
	`fÜm©_key
(
idx
+
i
, &
row
, 
¬•
);

792 
vec_t
 
	`kvec
(
¬•
.
_de¡
, 
key_sz
);

799 
²um
 = 
_pw¬ehou£_mª
->
	`g‘_²um
(&
idx
[
i
], &
row
);

800 
¡id_t
 
fid
 = 
idx
[
i
].
	`fid
(
²um
);

802 if(
idx
[
i
].
	`is_mr
()) {

803 
	`W_DO
(
db
->
	`de¡roy_mr_assoc
(
fid
, 
kvec
, 
rvec
));

805 
–_fËr
 
ef
;

806 
ef
.
_–
.
	`put
(
Ävec
);

807 
	`W_DO
(
db
->
	`ü—‹_mr_assoc
(
fid
, 
kvec
, 
ef
));

809 
	`W_DO
(
db
->
	`de¡roy_assoc
(
fid
, 
kvec
, 
rvec
));

811 
	`W_DO
(
db
->
	`ü—‹_assoc
(
fid
, 
kvec
, 
Ävec
));

815 
	`årštf
(
¡d”r
, ".");

819 
couÁ
++;

820 
	`W_DO
(
™”
->
	`Ãxt
(
db
, 
eof
, 
row
));

822 
	`årštf
(
¡d”r
, "\n");

828 
hlsize
 = 
h™_li¡
.
	`size
();

829 
	`TRACE
(
TRACE_ALWAYS
, "-> D–‘šg (%dèŞd uÅadded„ecÜds\n", 
hlsize
);

830 
i
=0; i < 
hlsize
; i++) {

831 
	`W_DO
(
db
->
	`de¡roy_»c
(
h™_li¡
[
i
]));

834  (
RCOK
);

835 
	}
}

846 
w_rc_t
 
	gShÜeTPCCEnv
::
	$db_´št
(
lšes
)

849 
	`as£¹
 (
_pssm
);

850 
	`as£¹
 (
_š™Ÿlized
);

851 
	`as£¹
 (
_lßded
);

854 
	`W_DO
(
_pw¬ehou£_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

855 
	`W_DO
(
_pdi¡riù_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

856 
	`W_DO
(
_p¡ock_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

857 
	`W_DO
(
_pÜd”_lše_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

858 
	`W_DO
(
_pcu¡om”_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

859 
	`W_DO
(
_phi¡Üy_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

860 
	`W_DO
(
_pÜd”_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

861 
	`W_DO
(
_²ew_Üd”_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

862 
	`W_DO
(
_p™em_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

864  (
RCOK
);

865 
	}
}

876 
w_rc_t
 
	gShÜeTPCCEnv
::
	$db_ãtch
()

879 
	`as£¹
 (
_pssm
);

880 
	`as£¹
 (
_š™Ÿlized
);

881 
	`as£¹
 (
_lßded
);

884 
	`W_DO
(
_pw¬ehou£_mª
->
	`ãtch_bË
(
_pssm
));

885 
	`W_DO
(
_pdi¡riù_mª
->
	`ãtch_bË
(
_pssm
));

886 
	`W_DO
(
_p¡ock_mª
->
	`ãtch_bË
(
_pssm
));

887 
	`W_DO
(
_pÜd”_lše_mª
->
	`ãtch_bË
(
_pssm
));

888 
	`W_DO
(
_pcu¡om”_mª
->
	`ãtch_bË
(
_pssm
));

889 
	`W_DO
(
_phi¡Üy_mª
->
	`ãtch_bË
(
_pssm
));

890 
	`W_DO
(
_pÜd”_mª
->
	`ãtch_bË
(
_pssm
));

891 
	`W_DO
(
_²ew_Üd”_mª
->
	`ãtch_bË
(
_pssm
));

892 
	`W_DO
(
_p™em_mª
->
	`ãtch_bË
(
_pssm
));

894  (
RCOK
);

895 
	}
}

898 
EXIT_NAMESPACE
(
cc
);

	@src/workload/tpcc/shore_tpcc_schema.cpp

32 
	~"wÜklßd/cc/shÜe_cc_schema.h
"

34 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
ENTER_NAMESPACE
(
cc
);

83 
	gw¬ehou£_t
::
	$w¬ehou£_t
(cÚ¡ 
ušt4_t
& 
pd
) :

84 
	`bË_desc_t
("WAREHOUSE", 
TPCC_WAREHOUSE_FCOUNT
, 
pd
)

87 
_desc
[0].
	`£tup
(
SQL_INT
, "W_ID");

88 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "W_NAME", 10);

89 
_desc
[2].
	`£tup
(
SQL_FIXCHAR
, "W_STREET1", 20);

90 
_desc
[3].
	`£tup
(
SQL_FIXCHAR
, "W_STREET2", 20);

91 
_desc
[4].
	`£tup
(
SQL_FIXCHAR
, "W_CITY", 20);

92 
_desc
[5].
	`£tup
(
SQL_FIXCHAR
, "W_STATE", 2);

93 
_desc
[6].
	`£tup
(
SQL_FIXCHAR
, "W_ZIP", 9);

94 
_desc
[7].
	`£tup
(
SQL_FLOAT
, "W_TAX");

95 
_desc
[8].
	`£tup
(
SQL_FLOAT
, "W_YTD");

98 
ušt
 
keys
[1] = { 0 };

99 
	`ü—‹_´im¬y_idx_desc
("W_IDX", 0, 
keys
, 1, 
pd
);

100 
	}
}

104 
	gdi¡riù_t
::
	$di¡riù_t
(cÚ¡ 
ušt4_t
& 
pd
) :

105 
	`bË_desc_t
("DISTRICT", 
TPCC_DISTRICT_FCOUNT
, 
pd
)

108 
_desc
[0].
	`£tup
(
SQL_INT
, "D_ID");

109 
_desc
[1].
	`£tup
(
SQL_INT
, "D_W_ID");

110 
_desc
[2].
	`£tup
(
SQL_FIXCHAR
, "D_NAME", 10);

111 
_desc
[3].
	`£tup
(
SQL_FIXCHAR
, "D_STREET1", 20);

112 
_desc
[4].
	`£tup
(
SQL_FIXCHAR
, "D_STREET2", 20);

113 
_desc
[5].
	`£tup
(
SQL_FIXCHAR
, "D_CITY", 20);

114 
_desc
[6].
	`£tup
(
SQL_FIXCHAR
, "D_STATE", 2);

115 
_desc
[7].
	`£tup
(
SQL_FIXCHAR
, "D_ZIP", 9);

116 
_desc
[8].
	`£tup
(
SQL_FLOAT
, "D_TAX");

117 
_desc
[9].
	`£tup
(
SQL_FLOAT
, "D_YTD");

118 
_desc
[10].
	`£tup
(
SQL_INT
, "D_NEXT_O_ID");

124 
ušt
 
keys
[2] = { 1, 0 };

126 
	`ü—‹_´im¬y_idx_desc
("D_IDX", 0, 
keys
, 2, 
pd
);

127 
	}
}

131 
	gcu¡om”_t
::
	$cu¡om”_t
(cÚ¡ 
ušt4_t
& 
pd
) :

132 
	`bË_desc_t
("CUSTOMER", 
TPCC_CUSTOMER_FCOUNT
, 
pd
)

135 
_desc
[0].
	`£tup
(
SQL_INT
, "C_ID");

136 
_desc
[1].
	`£tup
(
SQL_INT
, "C_D_ID");

137 
_desc
[2].
	`£tup
(
SQL_INT
, "C_W_ID");

139 
_desc
[3].
	`£tup
(
SQL_FIXCHAR
, "C_FIRST", 16);

140 
_desc
[4].
	`£tup
(
SQL_FIXCHAR
, "C_MIDDLE", 2);

141 
_desc
[5].
	`£tup
(
SQL_FIXCHAR
, "C_LAST", 16);

143 
_desc
[6].
	`£tup
(
SQL_FIXCHAR
, "C_STREET1", 20);

144 
_desc
[7].
	`£tup
(
SQL_FIXCHAR
, "C_STREET2", 20);

145 
_desc
[8].
	`£tup
(
SQL_FIXCHAR
, "C_CITY", 20);

146 
_desc
[9].
	`£tup
(
SQL_FIXCHAR
, "C_STATE", 2);

147 
_desc
[10].
	`£tup
(
SQL_FIXCHAR
, "C_ZIP", 9);

148 
_desc
[11].
	`£tup
(
SQL_FIXCHAR
, "C_PHONE", 16);

149 
_desc
[12].
	`£tup
(
SQL_FLOAT
, "C_SINCE");

150 
_desc
[13].
	`£tup
(
SQL_FIXCHAR
, "C_CREDIT", 2);

151 
_desc
[14].
	`£tup
(
SQL_FLOAT
, "C_CREDIT_LIM");

152 
_desc
[15].
	`£tup
(
SQL_FLOAT
, "C_DISCOUNT");

153 
_desc
[16].
	`£tup
(
SQL_FLOAT
, "C_BALANCE");

154 
_desc
[17].
	`£tup
(
SQL_FLOAT
, "C_YTD_PAYMENT");

155 
_desc
[18].
	`£tup
(
SQL_FLOAT
, "C_LAST_PAYMENT");

156 
_desc
[19].
	`£tup
(
SQL_INT
, "C_PAYMENT_CNT");

157 
_desc
[20].
	`£tup
(
SQL_FIXCHAR
, "C_DATA_1", 250);

158 
_desc
[21].
	`£tup
(
SQL_FIXCHAR
, "C_DATA_2", 250);

162 
ušt
 
keys1
[3] = {2, 1, 0 };

163 
	`ü—‹_´im¬y_idx_desc
("C_IDX", 0, 
keys1
, 3, 
pd
);

167 
ušt
 
keys2
[5] = {2, 1, 5, 3, 0};

168 
	`ü—‹_šdex_desc
("C_NAME_IDX", 0, 
keys2
, 5, 
çl£
, f®£, 
pd
);

169 
	}
}

173 
	ghi¡Üy_t
::
	$hi¡Üy_t
(cÚ¡ 
ušt4_t
& 
pd
) :

174 
	`bË_desc_t
("HISTORY", 
TPCC_HISTORY_FCOUNT
, 
pd
)

177 
_desc
[0].
	`£tup
(
SQL_INT
, "H_C_ID");

178 
_desc
[1].
	`£tup
(
SQL_INT
, "H_C_D_ID");

179 
_desc
[2].
	`£tup
(
SQL_INT
, "H_C_W_ID");

180 
_desc
[3].
	`£tup
(
SQL_INT
, "H_D_ID");

181 
_desc
[4].
	`£tup
(
SQL_INT
, "H_W_ID");

182 
_desc
[5].
	`£tup
(
SQL_FLOAT
, "H_DATE");

183 
_desc
[6].
	`£tup
(
SQL_FLOAT
, "H_AMOUNT");

184 
_desc
[7].
	`£tup
(
SQL_FIXCHAR
, "H_DATA", 25);

187 
	}
}

191 
	gÃw_Üd”_t
::
	$Ãw_Üd”_t
(cÚ¡ 
ušt4_t
& 
pd
) :

192 
	`bË_desc_t
("NEW_ORDER", 
TPCC_NEW_ORDER_FCOUNT
, 
pd
)

195 
_desc
[0].
	`£tup
(
SQL_INT
, "NO_O_ID");

196 
_desc
[1].
	`£tup
(
SQL_INT
, "NO_D_ID");

197 
_desc
[2].
	`£tup
(
SQL_INT
, "NO_W_ID");

200 
ušt
 
keys
[3] = {2, 1, 0};

201 
	`ü—‹_´im¬y_idx_desc
("NO_IDX", 0, 
keys
, 3, 
pd
);

202 
	}
}

206 
	gÜd”_t
::
	$Üd”_t
(cÚ¡ 
ušt4_t
& 
pd
) :

207 
	`bË_desc_t
("ORDER", 
TPCC_ORDER_FCOUNT
, 
pd
)

210 
_desc
[0].
	`£tup
(
SQL_INT
, "O_ID");

211 
_desc
[1].
	`£tup
(
SQL_INT
, "O_C_ID");

212 
_desc
[2].
	`£tup
(
SQL_INT
, "O_D_ID");

213 
_desc
[3].
	`£tup
(
SQL_INT
, "O_W_ID");

214 
_desc
[4].
	`£tup
(
SQL_FLOAT
, "O_ENTRY_D");

215 
_desc
[5].
	`£tup
(
SQL_INT
, "O_CARRIER_ID");

216 
_desc
[6].
	`£tup
(
SQL_INT
, "O_OL_CNT");

217 
_desc
[7].
	`£tup
(
SQL_INT
, "O_ALL_LOCAL");

221 
ušt
 
keys1
[3] = {3, 2, 0};

222 
	`ü—‹_´im¬y_idx_desc
("O_IDX", 0, 
keys1
, 3, 
pd
);

225 
ušt
 
keys2
[4] = {3, 2, 1, 0};

226 
	`ü—‹_šdex_desc
("O_CUST_IDX", 0, 
keys2
, 4, 
Œue
, 
çl£
, 
pd
);

227 
	}
}

231 
	gÜd”_lše_t
::
	$Üd”_lše_t
(cÚ¡ 
ušt4_t
& 
pd
) :

232 
	`bË_desc_t
("ORDERLINE", 
TPCC_ORDER_LINE_FCOUNT
, 
pd
)

235 
_desc
[0].
	`£tup
(
SQL_INT
, "OL_O_ID");

236 
_desc
[1].
	`£tup
(
SQL_INT
, "OL_D_ID");

237 
_desc
[2].
	`£tup
(
SQL_INT
, "OL_W_ID");

238 
_desc
[3].
	`£tup
(
SQL_INT
, "OL_NUMBER");

239 
_desc
[4].
	`£tup
(
SQL_INT
, "OL_I_ID");

240 
_desc
[5].
	`£tup
(
SQL_INT
, "OL_SUPPLY_W_ID");

241 
_desc
[6].
	`£tup
(
SQL_FLOAT
, "OL_DELIVERY_D");

242 
_desc
[7].
	`£tup
(
SQL_INT
, "OL_QUANTITY");

243 
_desc
[8].
	`£tup
(
SQL_INT
, "OL_AMOUNT");

244 
_desc
[9].
	`£tup
(
SQL_FIXCHAR
, "OL_DIST_INFO", 25);

247 
ušt
 
keys
[4] = {2, 1, 0, 3};

248 
numIdxP¬t™iÚs
 = 0;

249 #ifdeà
CFG_HACK


251 
numIdxP¬t™iÚs
 = 10;

253 
	`ü—‹_´im¬y_idx_desc
("OL_IDX", 
numIdxP¬t™iÚs
, 
keys
, 4, 
pd
);

254 
	}
}

258 
	g™em_t
::
	$™em_t
(cÚ¡ 
ušt4_t
& 
pd
) :

259 
	`bË_desc_t
("ITEM", 
TPCC_ITEM_FCOUNT
, 
pd
)

262 
_desc
[0].
	`£tup
(
SQL_INT
, "I_ID");

263 
_desc
[1].
	`£tup
(
SQL_INT
, "I_IM_ID");

264 
_desc
[2].
	`£tup
(
SQL_FIXCHAR
, "I_NAME", 24);

265 
_desc
[3].
	`£tup
(
SQL_INT
, "I_PRICE");

266 
_desc
[4].
	`£tup
(
SQL_FIXCHAR
, "I_DATA", 50);

269 
ušt
 
keys
[1] = {0};

270 
	`ü—‹_´im¬y_idx_desc
("I_IDX", 0, 
keys
, 1, 
pd
);

271 
	}
}

275 
	g¡ock_t
::
	$¡ock_t
(cÚ¡ 
ušt4_t
& 
pd
) :

276 
	`bË_desc_t
("STOCK", 
TPCC_STOCK_FCOUNT
, 
pd
)

279 
_desc
[0].
	`£tup
(
SQL_INT
, "S_I_ID");

280 
_desc
[1].
	`£tup
(
SQL_INT
, "S_W_ID");

281 
_desc
[2].
	`£tup
(
SQL_INT
, "S_REMOTE_CNT");

282 
_desc
[3].
	`£tup
(
SQL_INT
, "S_QUANTITY");

283 
_desc
[4].
	`£tup
(
SQL_INT
, "S_ORDER_CNT");

284 
_desc
[5].
	`£tup
(
SQL_INT
, "S_YTD");

285 
_desc
[6].
	`£tup
(
SQL_FIXCHAR
, "S_DIST0", 24);

286 
_desc
[7].
	`£tup
(
SQL_FIXCHAR
, "S_DIST1", 24);

287 
_desc
[8].
	`£tup
(
SQL_FIXCHAR
, "S_DIST2", 24);

288 
_desc
[9].
	`£tup
(
SQL_FIXCHAR
, "S_DIST3", 24);

289 
_desc
[10].
	`£tup
(
SQL_FIXCHAR
, "S_DIST4", 24);

290 
_desc
[11].
	`£tup
(
SQL_FIXCHAR
, "S_DIST5", 24);

291 
_desc
[12].
	`£tup
(
SQL_FIXCHAR
, "S_DIST6", 24);

292 
_desc
[13].
	`£tup
(
SQL_FIXCHAR
, "S_DIST7", 24);

293 
_desc
[14].
	`£tup
(
SQL_FIXCHAR
, "S_DIST8", 24);

294 
_desc
[15].
	`£tup
(
SQL_FIXCHAR
, "S_DIST9", 24);

295 
_desc
[16].
	`£tup
(
SQL_FIXCHAR
, "S_DATA", 50);

298 
ušt
 
keys
[2] = { 1, 0 };

299 
	`ü—‹_´im¬y_idx_desc
("S_IDX", 0, 
keys
, 2, 
pd
);

300 
	}
}

303 
EXIT_NAMESPACE
(
cc
);

	@src/workload/tpcc/shore_tpcc_schema_man.cpp

33 
	~"wÜklßd/cc/shÜe_cc_schema_mª.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
ENTER_NAMESPACE
(
cc
);

54 
w_rc_t


55 
	gw¬ehou£_mª_im¶
::
	$wh_šdex_´obe
(
ss_m
* 
db
,

56 
w¬ehou£_tu¶e
* 
±u¶e
,

57 cÚ¡ 
w_id
)

59 
	`as£¹
 (
±u¶e
);

60 
±u¶e
->
	`£t_v®ue
(0, 
w_id
);

61  (
	`šdex_´obe_by_Çme
(
db
, "W_IDX", 
±u¶e
));

62 
	}
}

65 
w_rc_t


66 
	gw¬ehou£_mª_im¶
::
	$wh_šdex_´obe_fÜupd©e
(
ss_m
* 
db
,

67 
w¬ehou£_tu¶e
* 
±u¶e
,

68 cÚ¡ 
w_id
)

70 
	`as£¹
 (
±u¶e
);

71 
±u¶e
->
	`£t_v®ue
(0, 
w_id
);

72  (
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "W_IDX", 
±u¶e
));

73 
	}
}

76 
w_rc_t


77 
	gw¬ehou£_mª_im¶
::
	$wh_šdex_´obe_Æ
(
ss_m
* 
db
,

78 
w¬ehou£_tu¶e
* 
±u¶e
,

79 cÚ¡ 
w_id
)

81 
	`as£¹
 (
±u¶e
);

82 
±u¶e
->
	`£t_v®ue
(0, 
w_id
);

83  (
	`šdex_´obe_Æ_by_Çme
(
db
, "W_IDX", 
±u¶e
));

84 
	}
}

87 
w_rc_t


88 
	gw¬ehou£_mª_im¶
::
	$wh_upd©e_ytd
(
ss_m
* 
db
,

89 
w¬ehou£_tu¶e
* 
±u¶e
,

90 cÚ¡ 
amouÁ
,

91 
lock_mode_t
 
lm
)

95 
	`as£¹
 (
±u¶e
);

96 
	`as£¹
 (
±u¶e
->
	`is_rid_v®id
());

98 
ytd
;

99 
±u¶e
->
	`g‘_v®ue
(8, 
ytd
);

100 
ytd
 +ğ
amouÁ
;

101 
±u¶e
->
	`£t_v®ue
(8, 
ytd
);

102 
	`W_DO
(
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

103  (
RCOK
);

104 
	}
}

107 
w_rc_t


108 
	gw¬ehou£_mª_im¶
::
	$wh_upd©e_ytd_Æ
(
ss_m
* 
db
,

109 
w¬ehou£_tu¶e
* 
±u¶e
,

110 cÚ¡ 
amouÁ
)

112  (
	`wh_upd©e_ytd
(
db
,
±u¶e
,
amouÁ
,
NL
));

113 
	}
}

122 
w_rc_t
 
	gdi¡riù_mª_im¶
::
	$di¡_šdex_´obe
(
ss_m
* 
db
,

123 
di¡riù_tu¶e
* 
±u¶e
,

124 cÚ¡ 
w_id
,

125 cÚ¡ 
d_id
)

127 
	`as£¹
 (
±u¶e
);

128 
±u¶e
->
	`£t_v®ue
(0, 
d_id
);

129 
±u¶e
->
	`£t_v®ue
(1, 
w_id
);

130  (
	`šdex_´obe_by_Çme
(
db
, "D_IDX", 
±u¶e
));

131 
	}
}

133 
w_rc_t
 
	gdi¡riù_mª_im¶
::
	$di¡_šdex_´obe_fÜupd©e
(
ss_m
* 
db
,

134 
di¡riù_tu¶e
* 
±u¶e
,

135 cÚ¡ 
w_id
,

136 cÚ¡ 
d_id
)

138 
	`as£¹
 (
±u¶e
);

139 
±u¶e
->
	`£t_v®ue
(0, 
d_id
);

140 
±u¶e
->
	`£t_v®ue
(1, 
w_id
);

141  (
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "D_IDX", 
±u¶e
));

142 
	}
}

144 
w_rc_t
 
	gdi¡riù_mª_im¶
::
	$di¡_šdex_´obe_Æ
(
ss_m
* 
db
,

145 
di¡riù_tu¶e
* 
±u¶e
,

146 cÚ¡ 
w_id
,

147 cÚ¡ 
d_id
)

149 
	`as£¹
 (
±u¶e
);

150 
±u¶e
->
	`£t_v®ue
(0, 
d_id
);

151 
±u¶e
->
	`£t_v®ue
(1, 
w_id
);

152  (
	`šdex_´obe_Æ_by_Çme
(
db
, "D_IDX", 
±u¶e
));

153 
	}
}

155 
w_rc_t
 
	gdi¡riù_mª_im¶
::
	$di¡_upd©e_ytd
(
ss_m
* 
db
,

156 
di¡riù_tu¶e
* 
±u¶e
,

157 cÚ¡ 
amouÁ
,

158 
lock_mode_t
 
lm
)

162 
	`as£¹
 (
±u¶e
);

163 
	`as£¹
 (
±u¶e
->
	`is_rid_v®id
());

165 
d_ytd
;

166 
±u¶e
->
	`g‘_v®ue
(9, 
d_ytd
);

167 
d_ytd
 +ğ
amouÁ
;

168 
±u¶e
->
	`£t_v®ue
(9, 
d_ytd
);

169 
	`W_DO
(
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

170  (
RCOK
);

171 
	}
}

173 
w_rc_t
 
	gdi¡riù_mª_im¶
::
	$di¡_upd©e_ytd_Æ
(
ss_m
* 
db
,

174 
di¡riù_tu¶e
* 
±u¶e
,

175 cÚ¡ 
amouÁ
)

177  (
	`di¡_upd©e_ytd
(
db
,
±u¶e
,
amouÁ
,
NL
));

178 
	}
}

180 
w_rc_t
 
	gdi¡riù_mª_im¶
::
	$di¡_upd©e_Ãxt_o_id
(
ss_m
* 
db
,

181 
di¡riù_tu¶e
* 
±u¶e
,

182 cÚ¡ 
Ãxt_o_id
,

183 
lock_mode_t
 
lm
)

187 
	`as£¹
 (
±u¶e
);

188 
	`as£¹
 (
±u¶e
->
	`is_rid_v®id
());

190 
±u¶e
->
	`£t_v®ue
(10, 
Ãxt_o_id
);

191  (
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

192 
	}
}

194 
w_rc_t
 
	gdi¡riù_mª_im¶
::
	$di¡_upd©e_Ãxt_o_id_Æ
(
ss_m
* 
db
,

195 
di¡riù_tu¶e
* 
±u¶e
,

196 cÚ¡ 
Ãxt_o_id
)

198  (
	`di¡_upd©e_Ãxt_o_id
(
db
,
±u¶e
,
Ãxt_o_id
,
NL
));

199 
	}
}

208 
w_rc_t
 
	gcu¡om”_mª_im¶
::
	$cu¡_g‘_™”_by_šdex
(
ss_m
* 
db
,

209 
cu¡om”_šdex_™”
* &
™”
,

210 
cu¡om”_tu¶e
* 
±u¶e
,

211 
»p_row_t
 &
»¶ow
,

212 
»p_row_t
 &
»phigh
,

213 cÚ¡ 
w_id
,

214 cÚ¡ 
d_id
,

215 cÚ¡ * 
c_Ï¡
,

216 
lock_mode_t
 
®m
,

217 
boŞ
 
Ãed_tu¶e
)

219 
	`as£¹
 (
±u¶e
);

222 
	`as£¹
 (
_±abË
);

223 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("C_NAME_IDX");

224 
	`as£¹
 (
pšdex
);

229 
±u¶e
->
	`£t_v®ue
(0, 0);

230 
±u¶e
->
	`£t_v®ue
(1, 
d_id
);

231 
±u¶e
->
	`£t_v®ue
(2, 
w_id
);

232 
±u¶e
->
	`£t_v®ue
(3, "");

233 
±u¶e
->
	`£t_v®ue
(5, 
c_Ï¡
);

235 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

236 
	`as£¹
 (
»¶ow
.
_de¡
);

238 
‹mp
[2];

239 
‹mp
[0] = 
	`MAX
('z', 'Z')+1;

240 
‹mp
[1] = '\0';

241 
±u¶e
->
	`£t_v®ue
(3, 
‹mp
);

243 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

244 
	`as£¹
 (
»phigh
.
_de¡
);

247 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
,

248 
®m
, 
Ãed_tu¶e
,

249 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

250 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

251  (
RCOK
);

252 
	}
}

255 
w_rc_t
 
	gcu¡om”_mª_im¶
::
	$cu¡_g‘_™”_by_šdex_Æ
(
ss_m
* 
db
,

256 
cu¡om”_šdex_™”
* &
™”
,

257 
cu¡om”_tu¶e
* 
±u¶e
,

258 
»p_row_t
 &
»¶ow
,

259 
»p_row_t
 &
»phigh
,

260 cÚ¡ 
w_id
,

261 cÚ¡ 
d_id
,

262 cÚ¡ * 
c_Ï¡
,

263 
boŞ
 
Ãed_tu¶e
)

265  (
	`cu¡_g‘_™”_by_šdex
(
db
,
™”
,
±u¶e
,
»¶ow
,
»phigh
,
w_id
,
d_id
,
c_Ï¡
,
NL
,
Ãed_tu¶e
));

266 
	}
}

269 
w_rc_t
 
	gcu¡om”_mª_im¶
::
	$cu¡_šdex_´obe
(
ss_m
* 
db
,

270 
cu¡om”_tu¶e
* 
±u¶e
,

271 cÚ¡ 
w_id
,

272 cÚ¡ 
d_id
,

273 cÚ¡ 
c_id
)

275 
	`as£¹
 (
±u¶e
);

276  (
	`cu¡_šdex_´obe_by_Çme
(
db
, "C_IDX", 
±u¶e
, 
w_id
, 
d_id
, 
c_id
));

277 
	}
}

279 
w_rc_t
 
	gcu¡om”_mª_im¶
::
	$cu¡_šdex_´obe_by_Çme
(
ss_m
* 
db
,

280 cÚ¡ * 
idx_Çme
,

281 
cu¡om”_tu¶e
* 
±u¶e
,

282 cÚ¡ 
w_id
,

283 cÚ¡ 
d_id
,

284 cÚ¡ 
c_id
)

286 
	`as£¹
 (
idx_Çme
);

287 
±u¶e
->
	`£t_v®ue
(0, 
c_id
);

288 
±u¶e
->
	`£t_v®ue
(1, 
d_id
);

289 
±u¶e
->
	`£t_v®ue
(2, 
w_id
);

290  (
	`šdex_´obe_by_Çme
(
db
, 
idx_Çme
, 
±u¶e
));

291 
	}
}

293 
w_rc_t
 
	gcu¡om”_mª_im¶
::
	$cu¡_šdex_´obe_fÜupd©e
(
ss_m
 * 
db
,

294 
cu¡om”_tu¶e
* 
±u¶e
,

295 cÚ¡ 
w_id
,

296 cÚ¡ 
d_id
,

297 cÚ¡ 
c_id
)

299 
	`as£¹
 (
±u¶e
);

300 
±u¶e
->
	`£t_v®ue
(0, 
c_id
);

301 
±u¶e
->
	`£t_v®ue
(1, 
d_id
);

302 
±u¶e
->
	`£t_v®ue
(2, 
w_id
);

303  (
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "C_IDX", 
±u¶e
));

304 
	}
}

306 
w_rc_t
 
	gcu¡om”_mª_im¶
::
	$cu¡_šdex_´obe_Æ
(
ss_m
 * 
db
,

307 
cu¡om”_tu¶e
* 
±u¶e
,

308 cÚ¡ 
w_id
,

309 cÚ¡ 
d_id
,

310 cÚ¡ 
c_id
)

312 
	`as£¹
 (
±u¶e
);

313 
±u¶e
->
	`£t_v®ue
(0, 
c_id
);

314 
±u¶e
->
	`£t_v®ue
(1, 
d_id
);

315 
±u¶e
->
	`£t_v®ue
(2, 
w_id
);

316  (
	`šdex_´obe_Æ_by_Çme
(
db
, "C_IDX", 
±u¶e
));

317 
	}
}

319 
w_rc_t
 
	gcu¡om”_mª_im¶
::
	$cu¡_upd©e_tu¶e
(
ss_m
* 
db
,

320 
cu¡om”_tu¶e
* 
±u¶e
,

321 cÚ¡ 
cc_cu¡om”_tu¶e
& 
acu¡om”
,

322 cÚ¡ * 
ad©a1
,

323 cÚ¡ * 
ad©a2
,

324 
lock_mode_t
 
lm
)

326 
	`as£¹
 (
±u¶e
);

327 
±u¶e
->
	`£t_v®ue
(16, 
acu¡om”
.
C_BALANCE
);

328 
±u¶e
->
	`£t_v®ue
(17, 
acu¡om”
.
C_YTD_PAYMENT
);

329 
±u¶e
->
	`£t_v®ue
(19, 
acu¡om”
.
C_PAYMENT_CNT
);

331 ià(
ad©a1
)

332 
±u¶e
->
	`£t_v®ue
(20, 
ad©a1
);

334 ià(
ad©a2
)

335 
±u¶e
->
	`£t_v®ue
(21, 
ad©a2
);

337  (
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

338 
	}
}

341 
w_rc_t
 
	gcu¡om”_mª_im¶
::
	$cu¡_upd©e_tu¶e_Æ
(
ss_m
* 
db
,

342 
cu¡om”_tu¶e
* 
±u¶e
,

343 cÚ¡ 
cc_cu¡om”_tu¶e
& 
acu¡om”
,

344 cÚ¡ * 
ad©a1
,

345 cÚ¡ * 
ad©a2
)

347  (
	`cu¡_upd©e_tu¶e
(
db
,
±u¶e
,
acu¡om”
,
ad©a1
,
ad©a2
,
NL
));

348 
	}
}

351 
w_rc_t
 
	gcu¡om”_mª_im¶
::
	$cu¡_upd©e_discouÁ_b®ªû
(
ss_m
* 
db
,

352 
cu¡om”_tu¶e
* 
±u¶e
,

353 cÚ¡ 
decim®
 
discouÁ
,

354 cÚ¡ 
decim®
 
b®ªû
,

355 
lock_mode_t
 
lm
)

357 
	`as£¹
 (
±u¶e
);

358 
	`as£¹
 (
discouÁ
>=0);

359 
±u¶e
->
	`£t_v®ue
(15, 
discouÁ
);

360 
±u¶e
->
	`£t_v®ue
(16, 
b®ªû
);

361  (
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

362 
	}
}

364 
w_rc_t
 
	gcu¡om”_mª_im¶
::
	$cu¡_upd©e_discouÁ_b®ªû_Æ
(
ss_m
* 
db
,

365 
cu¡om”_tu¶e
* 
±u¶e
,

366 cÚ¡ 
decim®
 
discouÁ
,

367 cÚ¡ 
decim®
 
b®ªû
)

369  (
	`cu¡_upd©e_discouÁ_b®ªû
(
db
,
±u¶e
,
discouÁ
,
b®ªû
,
NL
));

370 
	}
}

379 
w_rc_t
 
	gÃw_Üd”_mª_im¶
::
	$no_g‘_™”_by_šdex
(
ss_m
* 
db
,

380 
Ãw_Üd”_šdex_™”
* &
™”
,

381 
Ãw_Üd”_tu¶e
* 
±u¶e
,

382 
»p_row_t
 &
»¶ow
,

383 
»p_row_t
 &
»phigh
,

384 cÚ¡ 
w_id
,

385 cÚ¡ 
d_id
,

386 
lock_mode_t
 
®m
,

387 
boŞ
 
Ãed_tu¶e
)

389 
	`as£¹
 (
±u¶e
);

392 
	`as£¹
 (
_±abË
);

393 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("NO_IDX");

394 
	`as£¹
 (
pšdex
);

397 
±u¶e
->
	`£t_v®ue
(0, 0);

398 
±u¶e
->
	`£t_v®ue
(1, 
d_id
);

399 
±u¶e
->
	`£t_v®ue
(2, 
w_id
);

401 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

402 
	`as£¹
 (
»¶ow
.
_de¡
);

405 
±u¶e
->
	`£t_v®ue
(1, 
d_id
+1);

407 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

408 
	`as£¹
 (
»phigh
.
_de¡
);

411 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
,

412 
®m
, 
Ãed_tu¶e
,

413 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

414 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

415  (
RCOK
);

416 
	}
}

419 
w_rc_t
 
	gÃw_Üd”_mª_im¶
::
	$no_g‘_™”_by_šdex_Æ
(
ss_m
* 
db
,

420 
Ãw_Üd”_šdex_™”
* &
™”
,

421 
Ãw_Üd”_tu¶e
* 
±u¶e
,

422 
»p_row_t
 &
»¶ow
,

423 
»p_row_t
 &
»phigh
,

424 cÚ¡ 
w_id
,

425 cÚ¡ 
d_id
,

426 
boŞ
 
Ãed_tu¶e
)

428  (
	`no_g‘_™”_by_šdex
(
db
,
™”
,
±u¶e
,
»¶ow
,
»phigh
,
w_id
,
d_id
,
NL
,
Ãed_tu¶e
));

429 
	}
}

432 
w_rc_t
 
	gÃw_Üd”_mª_im¶
::
	$no_d–‘e_by_šdex
(
ss_m
* 
db
,

433 
Ãw_Üd”_tu¶e
* 
±u¶e
,

434 cÚ¡ 
w_id
,

435 cÚ¡ 
d_id
,

436 cÚ¡ 
o_id
)

438 
	`as£¹
 (
±u¶e
);

443 
±u¶e
->
	`£t_v®ue
(0, 
o_id
);

444 
±u¶e
->
	`£t_v®ue
(1, 
d_id
);

445 
±u¶e
->
	`£t_v®ue
(2, 
w_id
);

447 
	`W_DO
(
	`d–‘e_tu¶e
(
db
, 
±u¶e
));

449  (
RCOK
);

450 
	}
}

452 
w_rc_t
 
	gÃw_Üd”_mª_im¶
::
	$no_d–‘e_by_šdex_Æ
(
ss_m
* 
db
,

453 
Ãw_Üd”_tu¶e
* 
±u¶e
,

454 cÚ¡ 
w_id
,

455 cÚ¡ 
d_id
,

456 cÚ¡ 
o_id
)

460 
	`as£¹
 (
±u¶e
);

465 
±u¶e
->
	`£t_v®ue
(0, 
o_id
);

466 
±u¶e
->
	`£t_v®ue
(1, 
d_id
);

467 
±u¶e
->
	`£t_v®ue
(2, 
w_id
);

469 
	`W_DO
(
	`d–‘e_tu¶e
(
db
, 
±u¶e
, 
NL
));

471  (
RCOK
);

472 
	}
}

481 
w_rc_t
 
	gÜd”_mª_im¶
::
	$Üd_g‘_™”_by_šdex
(
ss_m
* 
db
,

482 
Üd”_šdex_™”
* &
™”
,

483 
Üd”_tu¶e
* 
±u¶e
,

484 
»p_row_t
 &
»¶ow
,

485 
»p_row_t
 &
»phigh
,

486 cÚ¡ 
w_id
,

487 cÚ¡ 
d_id
,

488 cÚ¡ 
c_id
,

489 
lock_mode_t
 
®m
,

490 
boŞ
 
Ãed_tu¶e
)

492 
	`as£¹
 (
±u¶e
);

495 
	`as£¹
 (
_±abË
);

496 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("O_CUST_IDX");

497 
	`as£¹
 (
pšdex
);

500 
±u¶e
->
	`£t_v®ue
(0, 0);

501 
±u¶e
->
	`£t_v®ue
(1, 
c_id
);

502 
±u¶e
->
	`£t_v®ue
(2, 
d_id
);

503 
±u¶e
->
	`£t_v®ue
(3, 
w_id
);

505 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

506 
	`as£¹
 (
»¶ow
.
_de¡
);

509 
±u¶e
->
	`£t_v®ue
(1, 
c_id
+1);

511 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

512 
	`as£¹
 (
»phigh
.
_de¡
);

514 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
,

515 
®m
, 
Ãed_tu¶e
,

516 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

517 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

518  (
RCOK
);

519 
	}
}

522 
w_rc_t
 
	gÜd”_mª_im¶
::
	$Üd_g‘_™”_by_šdex_Æ
(
ss_m
* 
db
,

523 
Üd”_šdex_™”
* &
™”
,

524 
Üd”_tu¶e
* 
±u¶e
,

525 
»p_row_t
 &
»¶ow
,

526 
»p_row_t
 &
»phigh
,

527 cÚ¡ 
w_id
,

528 cÚ¡ 
d_id
,

529 cÚ¡ 
c_id
,

530 
boŞ
 
Ãed_tu¶e
)

532  (
	`Üd_g‘_™”_by_šdex
(
db
,
™”
,
±u¶e
,
»¶ow
,
»phigh
,
w_id
,
d_id
,
c_id
,
NL
,
Ãed_tu¶e
));

533 
	}
}

536 
w_rc_t
 
	gÜd”_mª_im¶
::
	$Üd_upd©e_ÿ¼›r_by_šdex
(
ss_m
* 
db
,

537 
Üd”_tu¶e
* 
±u¶e
,

538 cÚ¡ 
ÿ¼›r_id
)

540 
	`as£¹
 (
±u¶e
);

545 
	`W_DO
(
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "O_IDX", 
±u¶e
));

547 
±u¶e
->
	`£t_v®ue
(5, 
ÿ¼›r_id
);

548 
	`W_DO
(
	`upd©e_tu¶e
(
db
, 
±u¶e
));

550  (
RCOK
);

551 
	}
}

553 
w_rc_t
 
	gÜd”_mª_im¶
::
	$Üd_upd©e_ÿ¼›r_by_šdex_Æ
(
ss_m
* 
db
,

554 
Üd”_tu¶e
* 
±u¶e
,

555 cÚ¡ 
ÿ¼›r_id
)

559 
	`as£¹
 (
±u¶e
);

564 
	`W_DO
(
	`šdex_´obe_Æ_by_Çme
(
db
, "O_IDX", 
±u¶e
));

566 
±u¶e
->
	`£t_v®ue
(5, 
ÿ¼›r_id
);

567 
	`W_DO
(
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
NL
));

569  (
RCOK
);

570 
	}
}

579 
w_rc_t
 
	gÜd”_lše_mª_im¶
::
	$Ş_g‘_¿nge_™”_by_šdex
(
ss_m
* 
db
,

580 
Üd”_lše_šdex_™”
* &
™”
,

581 
Üd”_lše_tu¶e
* 
±u¶e
,

582 
»p_row_t
 &
»¶ow
,

583 
»p_row_t
 &
»phigh
,

584 cÚ¡ 
w_id
,

585 cÚ¡ 
d_id
,

586 cÚ¡ 
low_o_id
,

587 cÚ¡ 
high_o_id
,

588 
lock_mode_t
 
®m
,

589 
boŞ
 
Ãed_tu¶e
)

591 
	`as£¹
 (
±u¶e
);

596 
	`as£¹
 (
_±abË
);

597 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("OL_IDX");

598 
	`as£¹
 (
pšdex
);

601 
±u¶e
->
	`£t_v®ue
(0, 
low_o_id
);

602 
±u¶e
->
	`£t_v®ue
(1, 
d_id
);

603 
±u¶e
->
	`£t_v®ue
(2, 
w_id
);

604 
±u¶e
->
	`£t_v®ue
(3, ()0);

606 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

607 
	`as£¹
 (
»¶ow
.
_de¡
);

610 
±u¶e
->
	`£t_v®ue
(0, 
high_o_id
+1);

612 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

613 
	`as£¹
 (
»phigh
.
_de¡
);

616 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
,

617 
®m
, 
Ãed_tu¶e
,

618 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

619 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

620  (
RCOK
);

621 
	}
}

624 
w_rc_t
 
	gÜd”_lše_mª_im¶
::
	$Ş_g‘_¿nge_™”_by_šdex_Æ
(
ss_m
* 
db
,

625 
Üd”_lše_šdex_™”
* &
™”
,

626 
Üd”_lše_tu¶e
* 
±u¶e
,

627 
»p_row_t
 &
»¶ow
,

628 
»p_row_t
 &
»phigh
,

629 cÚ¡ 
w_id
,

630 cÚ¡ 
d_id
,

631 cÚ¡ 
low_o_id
,

632 cÚ¡ 
high_o_id
,

633 
boŞ
 
Ãed_tu¶e
)

635  (
	`Ş_g‘_¿nge_™”_by_šdex
(
db
,
™”
,
±u¶e
,
»¶ow
,
»phigh
,

636 
w_id
,
d_id
,
low_o_id
,
high_o_id
,
NL
,
Ãed_tu¶e
));

637 
	}
}

641 
w_rc_t
 
	gÜd”_lše_mª_im¶
::
	$Ş_g‘_´obe_™”_by_šdex
(
ss_m
* 
db
,

642 
Üd”_lše_šdex_™”
* &
™”
,

643 
Üd”_lše_tu¶e
* 
±u¶e
,

644 
»p_row_t
 &
»¶ow
,

645 
»p_row_t
 &
»phigh
,

646 cÚ¡ 
w_id
,

647 cÚ¡ 
d_id
,

648 cÚ¡ 
o_id
,

649 
lock_mode_t
 
®m
,

650 
boŞ
 
Ãed_tu¶e
)

652 
	`as£¹
 (
±u¶e
);

657 
	`as£¹
 (
_±abË
);

658 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("OL_IDX");

659 
	`as£¹
 (
pšdex
);

661 
±u¶e
->
	`£t_v®ue
(0, 
o_id
);

662 
±u¶e
->
	`£t_v®ue
(1, 
d_id
);

663 
±u¶e
->
	`£t_v®ue
(2, 
w_id
);

664 
±u¶e
->
	`£t_v®ue
(3, ()0);

666 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

667 
	`as£¹
 (
»¶ow
.
_de¡
);

670 
±u¶e
->
	`£t_v®ue
(0, 
o_id
+1);

672 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

673 
	`as£¹
 (
»phigh
.
_de¡
);

675 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
,

676 
®m
, 
Ãed_tu¶e
,

677 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

678 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

679  (
RCOK
);

680 
	}
}

682 
w_rc_t
 
	gÜd”_lše_mª_im¶
::
	$Ş_g‘_´obe_™”_by_šdex_Æ
(
ss_m
* 
db
,

683 
Üd”_lše_šdex_™”
* &
™”
,

684 
Üd”_lše_tu¶e
* 
±u¶e
,

685 
»p_row_t
 &
»¶ow
,

686 
»p_row_t
 &
»phigh
,

687 cÚ¡ 
w_id
,

688 cÚ¡ 
d_id
,

689 cÚ¡ 
o_id
,

690 
boŞ
 
Ãed_tu¶e
)

692  (
	`Ş_g‘_´obe_™”_by_šdex
(
db
,
™”
,
±u¶e
,
»¶ow
,
»phigh
,

693 
w_id
,
d_id
,
o_id
,
NL
,
Ãed_tu¶e
));

694 
	}
}

703 
w_rc_t
 
	g™em_mª_im¶
::
	$™_šdex_´obe
(
ss_m
* 
db
,

704 
™em_tu¶e
* 
±u¶e
,

705 cÚ¡ 
i_id
)

707 
	`as£¹
 (
±u¶e
);

708 
±u¶e
->
	`£t_v®ue
(0, 
i_id
);

709  (
	`šdex_´obe_by_Çme
(
db
, "I_IDX", 
±u¶e
));

710 
	}
}

712 
w_rc_t
 
	g™em_mª_im¶
::
	$™_šdex_´obe_fÜupd©e
(
ss_m
* 
db
,

713 
™em_tu¶e
* 
±u¶e
,

714 cÚ¡ 
i_id
)

716 
	`as£¹
 (
±u¶e
);

717 
±u¶e
->
	`£t_v®ue
(0, 
i_id
);

718  (
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "I_IDX", 
±u¶e
));

719 
	}
}

721 
w_rc_t
 
	g™em_mª_im¶
::
	$™_šdex_´obe_Æ
(
ss_m
* 
db
,

722 
™em_tu¶e
* 
±u¶e
,

723 cÚ¡ 
i_id
)

725 
	`as£¹
 (
±u¶e
);

726 
±u¶e
->
	`£t_v®ue
(0, 
i_id
);

727  (
	`šdex_´obe_Æ_by_Çme
(
db
, "I_IDX", 
±u¶e
));

728 
	}
}

737 
w_rc_t
 
	g¡ock_mª_im¶
::
	$¡_šdex_´obe
(
ss_m
* 
db
,

738 
¡ock_tu¶e
* 
±u¶e
,

739 cÚ¡ 
w_id
,

740 cÚ¡ 
i_id
)

742 
	`as£¹
 (
±u¶e
);

743 
±u¶e
->
	`£t_v®ue
(0, 
i_id
);

744 
±u¶e
->
	`£t_v®ue
(1, 
w_id
);

745  (
	`šdex_´obe_by_Çme
(
db
, "S_IDX", 
±u¶e
));

746 
	}
}

748 
w_rc_t
 
	g¡ock_mª_im¶
::
	$¡_šdex_´obe_fÜupd©e
(
ss_m
* 
db
,

749 
¡ock_tu¶e
* 
±u¶e
,

750 cÚ¡ 
w_id
,

751 cÚ¡ 
i_id
)

753 
	`as£¹
 (
±u¶e
);

754 
±u¶e
->
	`£t_v®ue
(0, 
i_id
);

755 
±u¶e
->
	`£t_v®ue
(1, 
w_id
);

756  (
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "S_IDX", 
±u¶e
));

757 
	}
}

759 
w_rc_t
 
	g¡ock_mª_im¶
::
	$¡_šdex_´obe_Æ
(
ss_m
* 
db
,

760 
¡ock_tu¶e
* 
±u¶e
,

761 cÚ¡ 
w_id
,

762 cÚ¡ 
i_id
)

764 
	`as£¹
 (
±u¶e
);

765 
±u¶e
->
	`£t_v®ue
(0, 
i_id
);

766 
±u¶e
->
	`£t_v®ue
(1, 
w_id
);

767  (
	`šdex_´obe_Æ_by_Çme
(
db
, "S_IDX", 
±u¶e
));

768 
	}
}

770 
w_rc_t
 
	g¡ock_mª_im¶
::
	$¡_upd©e_tu¶e
(
ss_m
* 
db
,

771 
¡ock_tu¶e
* 
±u¶e
,

772 cÚ¡ 
cc_¡ock_tu¶e
* 
p¡ock
,

773 
lock_mode_t
 
lm
)

777 
	`as£¹
 (
±u¶e
);

778 
	`as£¹
 (
±u¶e
->
	`is_rid_v®id
());

780 
±u¶e
->
	`£t_v®ue
(2, 
p¡ock
->
S_REMOTE_CNT
);

781 
±u¶e
->
	`£t_v®ue
(3, 
p¡ock
->
S_QUANTITY
);

782 
±u¶e
->
	`£t_v®ue
(4, 
p¡ock
->
S_ORDER_CNT
);

783 
±u¶e
->
	`£t_v®ue
(5, 
p¡ock
->
S_YTD
);

785  (
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

786 
	}
}

788 
w_rc_t
 
	g¡ock_mª_im¶
::
	$¡_upd©e_tu¶e_Æ
(
ss_m
* 
db
,

789 
¡ock_tu¶e
* 
±u¶e
,

790 cÚ¡ 
cc_¡ock_tu¶e
* 
p¡ock
)

792  (
	`¡_upd©e_tu¶e
(
db
,
±u¶e
,
p¡ock
,
NL
));

793 
	}
}

796 
EXIT_NAMESPACE
(
cc
);

	@src/workload/tpcc/shore_tpcc_xct.cpp

31 
	~"wÜklßd/cc/shÜe_cc_’v.h
"

32 
	~"wÜklßd/cc/cc_¿ndom.h
"

34 
	~<veùÜ
>

35 
	~<num”ic
>

36 
	~<®gÜ™hm
>

38 
usšg
 
Çme¥aû
 
	gshÜe
;

41 
ENTER_NAMESPACE
(
cc
);

52 
__th»ad
 
ShÜeTPCCTrxSts
 
	gmy_¡©s
;

54 
	gShÜeTPCCEnv
::
	$’v_th»ad_š™
()

56 
	`CRITICAL_SECTION
(
¡©_mu‹x_cs
, 
_¡©m­_mu‹x
);

57 
_¡©m­
[
	`±h»ad_£lf
()] = &
my_¡©s
;

58 
	}
}

60 
	gShÜeTPCCEnv
::
	$’v_th»ad_fši
()

62 
	`CRITICAL_SECTION
(
¡©_mu‹x_cs
, 
_¡©m­_mu‹x
);

63 
_¡©m­
.
	`”a£
(
	`±h»ad_£lf
());

64 
	}
}

75 
ShÜeTPCCTrxSts
 
	gShÜeTPCCEnv
::
	$_g‘_¡©s
()

77 
	`CRITICAL_SECTION
(
cs
, 
_¡©m­_mu‹x
);

78 
ShÜeTPCCTrxSts
 
rv®
;

79 
rv®
 -=„val;

80 
¡©m­_t
::
™”©Ü
 
™
=
_¡©m­
.
	`begš
(); iˆ!ğ_¡©m­.
	`’d
(); ++it)

81 
rv®
 +ğ*
™
->
£cÚd
;

82  (
rv®
);

83 
	}
}

94 
	gShÜeTPCCEnv
::
	$»£t_¡©s
()

96 
	`CRITICAL_SECTION
(
Ï¡_¡©s_cs
, 
_Ï¡_¡©s_mu‹x
);

97 
_Ï¡_¡©s
 = 
	`_g‘_¡©s
();

98 
	}
}

109 
	gShÜeTPCCEnv
::
	$´št_throughput
(cÚ¡ 
iQu”›dSF
,

110 cÚ¡ 
iS´—d
,

111 cÚ¡ 
iNumOfTh»ads
,

112 cÚ¡ 
d–ay
,

113 cÚ¡ 
ulÚg_t
 
mioch
,

114 cÚ¡ 
avgıuu§ge
)

116 
	`CRITICAL_SECTION
(
Ï¡_¡©s_cs
, 
_Ï¡_¡©s_mu‹x
);

119 
ShÜeTPCCTrxSts
 
cu¼’t_¡©s
 = 
	`_g‘_¡©s
();

122 
cu¼’t_¡©s
 -ğ
_Ï¡_¡©s
;

124 
ušt
 
Œxs_©t
 = 
cu¼’t_¡©s
.
©‹m±ed
.
	`tÙ®
();

125 
ušt
 
Œxs_abt
 = 
cu¼’t_¡©s
.
çed
.
	`tÙ®
();

126 
ušt
 
Œxs_dld
 = 
cu¼’t_¡©s
.
d—dlocked
.
	`tÙ®
();

127 
nÜds_com
 = 
cu¼’t_¡©s
.
©‹m±ed
.
Ãw_Üd”
 - cu¼’t_¡©s.
çed
.Ãw_Üd” - cu¼’t_¡©s.
d—dlocked
.new_order;

129 
	`TRACE
Ğ
TRACE_ALWAYS
, "*******\n" \

142 
iQu”›dSF
,

143 (
iS´—d
 ? "Yes" : "No"),

144 
iNumOfTh»ads
, 
Œxs_©t
, 
Œxs_abt
, 
Œxs_dld
, 
nÜds_com
,

145 
d–ay
, 
mioch
/d–ay, 
avgıuu§ge
,

146 100*
avgıuu§ge
/
	`g‘_max_ıu_couÁ
(),

147 (
Œxs_©t
-
Œxs_abt
-
Œxs_dld
)/
d–ay
,

148 60*
nÜds_com
/
d–ay
);

149 
	}
}

178 
	#A_C_ID
 1023

	)

179 
	#C_C_ID
 127

	)

180 
	#C_C_LAST
 173

	)

181 
	#C_OL_I_ID
 1723

	)

182 
	#A_C_LAST
 255

	)

183 
	#A_OL_I_ID
 8191

	)

185 
	g®num
[] =

188 cÚ¡ *
	gÏ¡_Çme_·¹s
[] =

202 
	$¿nd_š‹g”
(
lo
, 
hi
) {

203  (
	`URªd
(
lo
,
hi
));

205 
	}
}

220 
	$ü—‹_¿ndom_a_¡ršg
Ğ*
out_bufãr
, 
Ëngth_lo
, 
Ëngth_hi
 ) {

221 
i
, 
aùu®_Ëngth
 ;

223 
aùu®_Ëngth
 = 
	`¿nd_š‹g”
Ğ
Ëngth_lo
, 
Ëngth_hi
 ) ;

225 
i
 = 0; i < 
aùu®_Ëngth
; i++ ) {

226 
out_bufãr
[
i
] = 
®num
[
	`¿nd_š‹g”
( 0, 61 )] ;

228 
out_bufãr
[
aùu®_Ëngth
] = '\0' ;

230  (
aùu®_Ëngth
);

231 
	}
}

246 
	$ü—‹_¿ndom_n_¡ršg
Ğ*
out_bufãr
, 
Ëngth_lo
, 
Ëngth_hi
 ) {

247 
i
, 
aùu®_Ëngth
 ;

249 
aùu®_Ëngth
 = 
	`¿nd_š‹g”
Ğ
Ëngth_lo
, 
Ëngth_hi
 ) ;

251 
i
 = 0; i < 
aùu®_Ëngth
; i++ )

253 
out_bufãr
[
i
] = ()
	`¿nd_š‹g”
( 48,57 ) ;

255 
out_bufãr
[
aùu®_Ëngth
] = '\0' ;

257  (
aùu®_Ëngth
);

258 
	}
}

262 
	$NU¿nd_v®
 ( 
A
, 
x
, 
y
, 
C
 ) {

263 ((((
	`¿nd_š‹g”
(0,
A
)|¿nd_š‹g”(
x
,
y
))+
C
)%(y-x+1))+x);

264 
	}
}

277 
	$ü—‹_a_¡ršg_w™h_Üigš®
Ğ*
out_bufãr
, 
Ëngth_lo
,

278 
Ëngth_hi
, 
³rûÁ_to_£t
 )

280 
aùu®_Ëngth
, 
¡¬t_pos
 ;

282 
aùu®_Ëngth
 = 
	`ü—‹_¿ndom_a_¡ršg
Ğ
out_bufãr
, 
Ëngth_lo
, 
Ëngth_hi
 ) ;

284 iàĞ
	`¿nd_š‹g”
Ğ1, 100 ) <ğ
³rûÁ_to_£t
 )

286 
¡¬t_pos
 = 
	`¿nd_š‹g”
Ğ0, 
aùu®_Ëngth
-8 ) ;

287 
	`¡ºıy
(
out_bufãr
+
¡¬t_pos
,"ORIGINAL",8) ;

290  (
aùu®_Ëngth
);

291 
	}
}

302 
	$ü—‹_¿ndom_Ï¡_Çme
(*
out_bufãr
, 
cu¡_num
)

304 
¿ndom_num
;

306 ià(
cu¡_num
 == 0)

307 
¿ndom_num
 = 
	`NU¿nd_v®
Ğ
A_C_LAST
, 0, 999, 
C_C_LAST
 );

309 
¿ndom_num
 = 
cu¡_num
 - 1;

311 
	`¡rıy
(
out_bufãr
, 
Ï¡_Çme_·¹s
[
¿ndom_num
 / 100]);

312 
¿ndom_num
 %= 100;

313 
	`¡rÿt
(
out_bufãr
, 
Ï¡_Çme_·¹s
[
¿ndom_num
 / 10]);

314 
¿ndom_num
 %= 10;

315 
	`¡rÿt
(
out_bufãr
, 
Ï¡_Çme_·¹s
[
¿ndom_num
]);

317 (
	`¡¾’
(
out_bufãr
));

318 
	}
}

321 
w_rc_t
 
	gShÜeTPCCEnv
::
	$xù_pİuÏ‹_ba£lše
(const ,

322 
pİuÏ‹_ba£lše_šput_t
& 
pbš
)

325 
	`as£¹
 (
_pssm
);

326 
	`as£¹
 (
_š™Ÿlized
);

328 
tu¶e_gu¬d
<
w¬ehou£_mª_im¶
> 
	`´wh
(
_pw¬ehou£_mª
);

329 
tu¶e_gu¬d
<
di¡riù_mª_im¶
> 
	`´di¡
(
_pdi¡riù_mª
);

333 
»p_row_t
 
	`¬•row
(
_pcu¡om”_mª
->
	`ts
());

334 
»p_row_t
 
	`¬•row_key
(
_pcu¡om”_mª
->
	`ts
());

336 
¬•row
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

337 
¬•row_key
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

339 
´wh
->
_»p
 = &
¬•row
;

340 
´di¡
->
_»p
 = &
¬•row
;

341 
´wh
->
_»p_key
 = &
¬•row_key
;

342 
´di¡
->
_»p_key
 = &
¬•row_key
;

345 
wh
 = 
pbš
.
_wh
;

346 
i
=1; i <ğ
wh
; i++) {

347 
j
=0; j <ğ
DISTRICTS_PER_WAREHOUSE
; j++) {

348 
Çme
[11];

349 
¡»‘_1
[21];

350 
¡»‘_2
[21];

351 
c™y
[21];

352 
¡©e
[3];

353 
z
[10];

354 
x
 = 
	`¿nd_š‹g”
(0, 2000)/10000.0;

356 
	`ü—‹_¿ndom_a_¡ršg
Ğ
Çme
, 6,10) ;

357 
	`ü—‹_¿ndom_a_¡ršg
Ğ
¡»‘_1
, 10,20) ;

358 
	`ü—‹_¿ndom_a_¡ršg
Ğ
¡»‘_2
, 10,20) ;

359 
	`ü—‹_¿ndom_a_¡ršg
Ğ
c™y
, 10,20) ;

360 
	`ü—‹_¿ndom_a_¡ršg
Ğ
¡©e
, 2,2) ;

361 
	`ü—‹_¿ndom_n_¡ršg
Ğ
z
, 4,4) ;

362 
	`¡rÿt
(
z
, "11111");

364 if(
j
 == 0) {

366 
´wh
->
	`£t_v®ue
(0, 
i
);

367 
´wh
->
	`£t_v®ue
(1, 
Çme
);

368 
´wh
->
	`£t_v®ue
(2, 
¡»‘_1
);

369 
´wh
->
	`£t_v®ue
(3, 
¡»‘_2
);

370 
´wh
->
	`£t_v®ue
(4, 
c™y
);

371 
´wh
->
	`£t_v®ue
(5, 
¡©e
);

372 
´wh
->
	`£t_v®ue
(6, 
z
);

373 
´wh
->
	`£t_v®ue
(7, 
x
);

374 
´wh
->
	`£t_v®ue
(8, 300000.0);

375 
	`W_DO
(
_pw¬ehou£_mª
->
	`add_tu¶e
(
_pssm
, 
´wh
));

378 
´di¡
->
	`£t_v®ue
(0, 
j
);

379 
´di¡
->
	`£t_v®ue
(1, 
i
);

380 
´di¡
->
	`£t_v®ue
(2, 
Çme
);

381 
´di¡
->
	`£t_v®ue
(3, 
¡»‘_1
);

382 
´di¡
->
	`£t_v®ue
(4, 
¡»‘_2
);

383 
´di¡
->
	`£t_v®ue
(5, 
c™y
);

384 
´di¡
->
	`£t_v®ue
(6, 
¡©e
);

385 
´di¡
->
	`£t_v®ue
(7, 
z
);

386 
´di¡
->
	`£t_v®ue
(8, 
x
);

387 
´di¡
->
	`£t_v®ue
(9, 300000.0);

388 
´di¡
->
	`£t_v®ue
(10, 
CUSTOMERS_PER_DISTRICT
+1);

389 
	`W_DO
(
_pdi¡riù_mª
->
	`add_tu¶e
(
_pssm
, 
´di¡
));

395 
	`W_DO
(
_pssm
->
	`comm™_xù
());

397  
RCOK
;

398 
	}
}

401 
w_rc_t
 
	gShÜeTPCCEnv
::
	$xù_pİuÏ‹_Úe_un™
(const ,

402 
pİuÏ‹_Úe_un™_šput_t
& 
pbuš
)

405 
	`as£¹
 (
_pssm
);

406 
	`as£¹
 (
_š™Ÿlized
);

408 
tu¶e_gu¬d
<
cu¡om”_mª_im¶
> 
	`´cu¡
(
_pcu¡om”_mª
);

409 
tu¶e_gu¬d
<
Ãw_Üd”_mª_im¶
> 
	`´no
(
_²ew_Üd”_mª
);

410 
tu¶e_gu¬d
<
Üd”_mª_im¶
> 
	`´Üd
(
_pÜd”_mª
);

411 
tu¶e_gu¬d
<
™em_mª_im¶
> 
	`´™em
(
_p™em_mª
);

412 
tu¶e_gu¬d
<
hi¡Üy_mª_im¶
> 
	`´hi¡
(
_phi¡Üy_mª
);

413 
tu¶e_gu¬d
<
¡ock_mª_im¶
> 
	`´¡
(
_p¡ock_mª
);

414 
tu¶e_gu¬d
<
Üd”_lše_mª_im¶
> 
	`´Ş
(
_pÜd”_lše_mª
);

416 
»p_row_t
 
	`¬•row
(
_pcu¡om”_mª
->
	`ts
());

417 
»p_row_t
 
	`¬•row_key
(
_pcu¡om”_mª
->
	`ts
());

420 
¬•row
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

421 
¬•row_key
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

423 
´cu¡
->
_»p
 = &
¬•row
;

424 
´no
->
_»p
 = &
¬•row
;

425 
´Üd
->
_»p
 = &
¬•row
;

426 
´hi¡
->
_»p
 = &
¬•row
;

427 
´¡
->
_»p
 = &
¬•row
;

428 
´Ş
->
_»p
 = &
¬•row
;

429 
´™em
->
_»p
 = &
¬•row
;

430 
´cu¡
->
_»p_key
 = &
¬•row_key
;

431 
´no
->
_»p_key
 = &
¬•row_key
;

432 
´Üd
->
_»p_key
 = &
¬•row_key
;

433 
´hi¡
->
_»p_key
 = &
¬•row_key
;

434 
´¡
->
_»p_key
 = &
¬•row_key
;

435 
´Ş
->
_»p_key
 = &
¬•row_key
;

436 
´™em
->
_»p_key
 = &
¬•row_key
;

438 
un™
 = 
pbuš
.
_un™
;

441 
cu¼tm¡mp
 = 
	`time
(0);

442 
wid
 = 
un™
/
UNIT_PER_WH
 + 1;

443 
did
 = ((
un™
/
UNIT_PER_DIST
è% 
DISTRICTS_PER_WAREHOUSE
) + 1;

444 
ba£_oid
 = ((
un™
*
ORDERS_PER_UNIT
è% 
ORDERS_PER_DIST
) + 1;

445 
i
=0; i < 
ORDERS_PER_UNIT
; i++) {

446 
oid
 = 
ba£_oid
 + 
i
;

447 
o_cid
 = 
pbuš
.
_cids
[
oid
-1];

449 
boŞ
 
is_Ãw
 = (
oid
 > 2100);

450 
ÿ¼›r
 = 
is_Ãw
? 0 : 
	`¿nd_š‹g”
(1, 10);

451 
Şšes
 = 
	`¿nd_š‹g”
(
MIN_OL_PER_ORDER
, 
MAX_OL_PER_ORDER
);

452 
®l_loÿl
 = 
Œue
;

454 
j
=1; j <ğ
Şšes
; j++) {

455 
di¡_šfo
[25];

456 
™em_num
 = 
	`¿nd_š‹g”
(1, 
ITEMS
);

457 
	`ü—‹_¿ndom_a_¡ršg
(
di¡_šfo
, 24, 24);

458 
amouÁ
 = 
	`¿nd_š‹g”
(0, 999999);

460 
´Ş
->
	`£t_v®ue
(0, 
oid
);

461 
´Ş
->
	`£t_v®ue
(1, 
did
);

462 
´Ş
->
	`£t_v®ue
(2, 
wid
);

463 
´Ş
->
	`£t_v®ue
(3, 
j
);

464 
´Ş
->
	`£t_v®ue
(4, 
™em_num
);

465 
´Ş
->
	`£t_v®ue
(5, 
wid
);

466 
´Ş
->
	`£t_v®ue
(6, 
is_Ãw
? 0.0 : 
cu¼tm¡mp
);

467 
´Ş
->
	`£t_v®ue
(7, 5);

468 
´Ş
->
	`£t_v®ue
(8, 
amouÁ
);

469 
´Ş
->
	`£t_v®ue
(9, 
di¡_šfo
);

470 
	`W_DO
(
_pÜd”_lše_mª
->
	`add_tu¶e
(
_pssm
, 
´Ş
));

473 
´Üd
->
	`£t_v®ue
(0, 
oid
);

474 
´Üd
->
	`£t_v®ue
(1, 
o_cid
);

475 
´Üd
->
	`£t_v®ue
(2, 
did
);

476 
´Üd
->
	`£t_v®ue
(3, 
wid
);

477 
´Üd
->
	`£t_v®ue
(4, 
cu¼tm¡mp
);

478 
´Üd
->
	`£t_v®ue
(5, 
ÿ¼›r
);

479 
´Üd
->
	`£t_v®ue
(6, 
Şšes
);

480 
´Üd
->
	`£t_v®ue
(7, 
®l_loÿl
);

481 
	`W_DO
(
_pÜd”_mª
->
	`add_tu¶e
(
_pssm
, 
´Üd
));

483 if(
is_Ãw
) {

484 
´no
->
	`£t_v®ue
(0, 
oid
);

485 
´no
->
	`£t_v®ue
(1, 
did
);

486 
´no
->
	`£t_v®ue
(2, 
wid
);

487 
	`W_DO
(
_²ew_Üd”_mª
->
	`add_tu¶e
(
_pssm
, 
´no
));

492 
¡ock_ba£
 = ((
un™
*
STOCK_PER_UNIT
è% 
STOCK_PER_WAREHOUSE
) + 1;

493 
i
=0; i < 
STOCK_PER_UNIT
; i++) {

494 
¡ock_di¡
[10][25];

495 
¡ock_d©a
[51];

496 
¡ock_num
 = 
¡ock_ba£
 + 
i
;

497 
qty
 = 
	`¿nd_š‹g”
(10, 100);

498 
	`ü—‹_a_¡ršg_w™h_Üigš®
(
¡ock_d©a
, 26, 50, 10);

499 
ušt_t
 
j
=0; j < (
¡ock_di¡
)/(stock_dist[0]); j++) {

500 
	`ü—‹_¿ndom_a_¡ršg
(
¡ock_di¡
[
j
], 24, 24);

503 
´¡
->
	`£t_v®ue
(0, 
¡ock_num
);

504 
´¡
->
	`£t_v®ue
(1, 
wid
);

505 
´¡
->
	`£t_v®ue
(2, ()0);

506 
´¡
->
	`£t_v®ue
(3, 
qty
);

507 
´¡
->
	`£t_v®ue
(4, ()0);

508 
´¡
->
	`£t_v®ue
(5, ()0);

509 
k
=0; k < 10; k++) {

510 
´¡
->
	`£t_v®ue
(6+
k
, 
¡ock_di¡
[k]);

512 
´¡
->
	`£t_v®ue
(16, 
¡ock_d©a
);

513 
	`W_DO
(
_p¡ock_mª
->
	`add_tu¶e
(
_pssm
, 
´¡
));

516 if(
wid
 == 1) {

517 
™em_Çme
[25];

518 
™em_d©a
[51];

519 
im_id
 = 
	`¿nd_š‹g”
(1, 10000);

520 
™em_´iû
 = 
	`¿nd_š‹g”
(100, 10000);

521 
	`ü—‹_¿ndom_a_¡ršg
Ğ
™em_Çme
, 14, 24);

522 
	`ü—‹_a_¡ršg_w™h_Üigš®
Ğ
™em_d©a
, 26, 50, 10) ;

524 
´™em
->
	`£t_v®ue
(0, 
¡ock_num
);

525 
´™em
->
	`£t_v®ue
(1, 
im_id
);

526 
´™em
->
	`£t_v®ue
(2, 
™em_Çme
);

527 
´™em
->
	`£t_v®ue
(3, 
™em_´iû
);

528 
´™em
->
	`£t_v®ue
(4, 
™em_d©a
);

529 
	`W_DO
(
_p™em_mª
->
	`add_tu¶e
(
_pssm
, 
´™em
));

534 
cid_ba£
 = ((
un™
*
CUST_PER_UNIT
è% 
CUSTOMERS_PER_DISTRICT
) + 1;

535 
i
=0; i < 
CUST_PER_UNIT
; i++) {

536 
hi¡_d©a
[25] ;

537 
cid
 = 
cid_ba£
+
i
;

538 
amouÁ
 = 1000;

539 
	`ü—‹_¿ndom_a_¡ršg
(
hi¡_d©a
, 12, 24);

541 
´hi¡
->
	`£t_v®ue
(0, 
cid
);

542 
´hi¡
->
	`£t_v®ue
(1, 
did
);

543 
´hi¡
->
	`£t_v®ue
(2, 
wid
);

544 
´hi¡
->
	`£t_v®ue
(3, 
did
);

545 
´hi¡
->
	`£t_v®ue
(4, 
did
);

546 
´hi¡
->
	`£t_v®ue
(5, 
cu¼tm¡mp
);

547 
´hi¡
->
	`£t_v®ue
(6, 
amouÁ
);

548 
´hi¡
->
	`£t_v®ue
(7, 
hi¡_d©a
);

549 
	`W_DO
(
_phi¡Üy_mª
->
	`add_tu¶e
(
_pssm
, 
´hi¡
));

553 
i
=0; i < 
CUST_PER_UNIT
; i++) {

554 
cu¡_Ï¡
[17];

556 
cu¡_fœ¡
[17];

557 
cu¡_¡»‘_1
[21];

558 
cu¡_¡»‘_2
[21];

559 
cu¡_c™y
[21];

560 
cu¡_¡©e
[3];

561 
cu¡_z
[10];

562 
cu¡_phÚe
[17];

563 
cu¡_üed™
[3];

564 
cu¡_d©a1
[251];

565 
cu¡_d©a2
[251];

566 
cu¡_discouÁ
 = 
	`¿nd_š‹g”
(0, 5000)/10000.0;

567 
cid
 = 
cid_ba£
 + 
i
;

569 
	`ü—‹_¿ndom_Ï¡_Çme
(
cu¡_Ï¡
, (
cid
 <= 1000)? cid : 0);

570 
	`ü—‹_¿ndom_a_¡ršg
Ğ
cu¡_fœ¡
, 8,16) ;

571 
	`ü—‹_¿ndom_a_¡ršg
Ğ
cu¡_¡»‘_1
, 10,20) ;

572 
	`ü—‹_¿ndom_a_¡ršg
Ğ
cu¡_¡»‘_2
, 10,20) ;

573 
	`ü—‹_¿ndom_a_¡ršg
Ğ
cu¡_c™y
, 10,20) ;

574 
	`ü—‹_¿ndom_a_¡ršg
Ğ
cu¡_¡©e
, 2,2) ;

575 
	`ü—‹_¿ndom_n_¡ršg
Ğ
cu¡_z
, 4,4) ;

576 
	`¡rÿt
(
cu¡_z
, "11111");

577 
	`ü—‹_¿ndom_n_¡ršg
Ğ
cu¡_phÚe
, 16,16) ;

578 
	`¡rıy
Ğ
cu¡_üed™
, (
	`¿nd_š‹g”
( 1, 100 ) <= 10)? "BC" : "GC");

579 
	`ü—‹_¿ndom_a_¡ršg
Ğ
cu¡_d©a1
, 250, 250);

580 
	`ü—‹_¿ndom_a_¡ršg
Ğ
cu¡_d©a2
, 50, 250);

582 
´cu¡
->
	`£t_v®ue
(0, 
cid
);

583 
´cu¡
->
	`£t_v®ue
(1, 
did
);

584 
´cu¡
->
	`£t_v®ue
(2, 
wid
);

585 
´cu¡
->
	`£t_v®ue
(3, 
cu¡_fœ¡
);

586 
´cu¡
->
	`£t_v®ue
(4, "OE");

587 
´cu¡
->
	`£t_v®ue
(5, 
cu¡_Ï¡
);

588 
´cu¡
->
	`£t_v®ue
(6, 
cu¡_¡»‘_1
);

589 
´cu¡
->
	`£t_v®ue
(7, 
cu¡_¡»‘_2
);

590 
´cu¡
->
	`£t_v®ue
(8, 
cu¡_c™y
);

591 
´cu¡
->
	`£t_v®ue
(9, 
cu¡_¡©e
);

592 
´cu¡
->
	`£t_v®ue
(10, 
cu¡_z
);

593 
´cu¡
->
	`£t_v®ue
(11, 
cu¡_phÚe
);

594 
´cu¡
->
	`£t_v®ue
(12, 
cu¼tm¡mp
);

595 
´cu¡
->
	`£t_v®ue
(13, 
cu¡_üed™
);

596 
´cu¡
->
	`£t_v®ue
(14, 50000.0);

597 
´cu¡
->
	`£t_v®ue
(15, 
cu¡_discouÁ
);

598 
´cu¡
->
	`£t_v®ue
(16, 0.0);

599 
´cu¡
->
	`£t_v®ue
(17, -10.0);

600 
´cu¡
->
	`£t_v®ue
(18, 10.0);

601 
´cu¡
->
	`£t_v®ue
(19, 1);

602 
´cu¡
->
	`£t_v®ue
(20, 
cu¡_d©a1
);

603 
´cu¡
->
	`£t_v®ue
(21, 
cu¡_d©a2
);

604 
	`W_DO
(
_pcu¡om”_mª
->
	`add_tu¶e
(
_pssm
, 
´cu¡
));

608 
	`W_DO
(
_pssm
->
	`comm™_xù
());

610  
RCOK
;

611 
	}
}

636 
w_rc_t
 
	gShÜeTPCCEnv
::
	$run_Úe_xù
(
Reque¡
* 
´eque¡
)

638 if(
_¡¬t_imb®ªû
 > 0 && !
_bAÏrmS‘
) {

639 
	`CRITICAL_SECTION
(
®¬m_cs
, 
_®¬m_lock
);

640 if(!
_bAÏrmS‘
) {

641 
	`®¬m
(
_¡¬t_imb®ªû
);

642 
_bAÏrmS‘
 = 
Œue
;

647 ià(
´eque¡
->
	`ty³
(è=ğ
XCT_MIX
) {

648 
´eque¡
->
	`£t_ty³
(
	`¿ndom_xù_ty³
(
smth»ad_t
::
	`¿nd
()%100));

651 
´eque¡
->
	`ty³
()) {

654 
XCT_NEW_ORDER
:

655  (
	`run_Ãw_Üd”
(
´eque¡
));

656 
XCT_PAYMENT
:

657  (
	`run_·ym’t
(
´eque¡
));;

658 
XCT_ORDER_STATUS
:

659  (
	`run_Üd”_¡©us
(
´eque¡
));

660 
XCT_DELIVERY
:

661  (
	`run_d–iv”y
(
´eque¡
));

662 
XCT_STOCK_LEVEL
:

663  (
	`run_¡ock_Ëv–
(
´eque¡
));

666 
XCT_LITTLE_MIX
:

667 ià(
	`URªd
(1,100)>50)

668  (
	`run_Ãw_Üd”
(
´eque¡
));

670  (
	`run_·ym’t
(
´eque¡
));

674 
XCT_MBENCH_WH
:

675  (
	`run_mb’ch_wh
(
´eque¡
));

676 
XCT_MBENCH_CUST
:

677  (
	`run_mb’ch_cu¡
(
´eque¡
));

679 
	`as£¹
 (0);

681  (
RCOK
);

682 
	}
}

704 
DEFINE_TRX
(
ShÜeTPCCEnv
,
Ãw_Üd”
);

705 
DEFINE_TRX
(
ShÜeTPCCEnv
,
·ym’t
);

706 
DEFINE_TRX
(
ShÜeTPCCEnv
,
Üd”_¡©us
);

707 
DEFINE_TRX
(
ShÜeTPCCEnv
,
d–iv”y
);

708 
DEFINE_TRX
(
ShÜeTPCCEnv
,
¡ock_Ëv–
);

709 
DEFINE_TRX
(
ShÜeTPCCEnv
,
mb’ch_wh
);

710 
DEFINE_TRX
(
ShÜeTPCCEnv
,
mb’ch_cu¡
);

723 
w_rc_t
 
	gShÜeTPCCEnv
::
	$xù_Ãw_Üd”
(cÚ¡ 
xù_id
,

724 
Ãw_Üd”_šput_t
& 
²oš
)

727 
	`as£¹
 (
_pssm
);

728 
	`as£¹
 (
_š™Ÿlized
);

729 
	`as£¹
 (
_lßded
);

733 
tu¶e_gu¬d
<
w¬ehou£_mª_im¶
> 
	`´wh
(
_pw¬ehou£_mª
);

734 
tu¶e_gu¬d
<
di¡riù_mª_im¶
> 
	`´di¡
(
_pdi¡riù_mª
);

735 
tu¶e_gu¬d
<
cu¡om”_mª_im¶
> 
	`´cu¡
(
_pcu¡om”_mª
);

736 
tu¶e_gu¬d
<
Ãw_Üd”_mª_im¶
> 
	`´no
(
_²ew_Üd”_mª
);

737 
tu¶e_gu¬d
<
Üd”_mª_im¶
> 
	`´Üd
(
_pÜd”_mª
);

738 
tu¶e_gu¬d
<
™em_mª_im¶
> 
	`´™em
(
_p™em_mª
);

739 
tu¶e_gu¬d
<
¡ock_mª_im¶
> 
	`´¡
(
_p¡ock_mª
);

740 
tu¶e_gu¬d
<
Üd”_lše_mª_im¶
> 
	`´Ş
(
_pÜd”_lše_mª
);

742 
»p_row_t
 
	`¬•row
(
_pcu¡om”_mª
->
	`ts
());

745 
¬•row
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

747 
´wh
->
_»p
 = &
¬•row
;

748 
´di¡
->
_»p
 = &
¬•row
;

749 
´cu¡
->
_»p
 = &
¬•row
;

750 
´no
->
_»p
 = &
¬•row
;

751 
´Üd
->
_»p
 = &
¬•row
;

752 
´™em
->
_»p
 = &
¬•row
;

753 
´¡
->
_»p
 = &
¬•row
;

754 
´Ş
->
_»p
 = &
¬•row
;

765 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d NO:wh-idx-probe (%d)\n",

766 
xù_id
, 
²oš
.
_wh_id
);

767 
	`W_DO
(
_pw¬ehou£_mª
->
	`wh_šdex_´obe
(
_pssm
, 
´wh
, 
²oš
.
_wh_id
));

769 
cc_w¬ehou£_tu¶e
 
awh
;

770 
´wh
->
	`g‘_v®ue
(7, 
awh
.
W_TAX
);

781 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d NO:dist-idx-upd (%d) (%d)\n",

782 
xù_id
, 
²oš
.
_wh_id
,…noš.
_d_id
);

783 
	`W_DO
(
_pdi¡riù_mª
->
	`di¡_šdex_´obe_fÜupd©e
(
_pssm
, 
´di¡
,

784 
²oš
.
_wh_id
,…noš.
_d_id
));

786 
cc_di¡riù_tu¶e
 
adi¡
;

787 
´di¡
->
	`g‘_v®ue
(8, 
adi¡
.
D_TAX
);

788 
´di¡
->
	`g‘_v®ue
(10, 
adi¡
.
D_NEXT_O_ID
);

789 
adi¡
.
D_NEXT_O_ID
++;

792 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d NO:cust-idx-probe (%d) (%d) (%d)\n",

793 
xù_id
, 
²oš
.
_wh_id
,…noš.
_d_id
,…noš.
_c_id
);

794 
	`W_DO
(
_pcu¡om”_mª
->
	`cu¡_šdex_´obe
(
_pssm
, 
´cu¡
, 
²oš
.
_wh_id
,

795 
²oš
.
_d_id
,…noš.
_c_id
));

797 
cc_cu¡om”_tu¶e
 
acu¡
;

798 
´cu¡
->
	`g‘_v®ue
(15, 
acu¡
.
C_DISCOUNT
);

799 
´cu¡
->
	`g‘_v®ue
(13, 
acu¡
.
C_CREDIT
, 3);

800 
´cu¡
->
	`g‘_v®ue
(5, 
acu¡
.
C_LAST
, 17);

808 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d NO:dist-upd-next-o-id (%d)\n",

809 
xù_id
, 
adi¡
.
D_NEXT_O_ID
);

810 
	`W_DO
(
_pdi¡riù_mª
->
	`di¡_upd©e_Ãxt_o_id
(
_pssm
, 
´di¡
,

811 
adi¡
.
D_NEXT_O_ID
));

813 
tÙ®_amouÁ
 = 0;

815 
™em_út
=0; i‹m_út<
²oš
.
_Ş_út
; item_cnt++) {

818 
Ş_i_id
 = 
²oš
.
™ems
[
™em_út
].
_Ş_i_id
;

819 
Ş_suµly_w_id
 = 
²oš
.
™ems
[
™em_út
].
_Ş_suµly_wh_id
;

829 
cc_™em_tu¶e
 
a™em
;

830 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d NO:item-idx-probe (%d)\n",

831 
xù_id
, 
Ş_i_id
);

832 
	`W_DO
(
_p™em_mª
->
	`™_šdex_´obe
(
_pssm
, 
´™em
, 
Ş_i_id
));

834 
´™em
->
	`g‘_v®ue
(4, 
a™em
.
I_DATA
, 51);

835 
´™em
->
	`g‘_v®ue
(3, 
a™em
.
I_PRICE
);

836 
´™em
->
	`g‘_v®ue
(2, 
a™em
.
I_NAME
, 25);

838 
™em_amouÁ
 = 
a™em
.
I_PRICE
 * 
²oš
.
™ems
[
™em_út
].
_Ş_quªt™y
;

839 
tÙ®_amouÁ
 +ğ
™em_amouÁ
;

851 
cc_¡ock_tu¶e
 
a¡ock
;

852 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d NO:stock-idx-upd (%d) (%d)\n",

853 
xù_id
, 
Ş_suµly_w_id
, 
Ş_i_id
);

854 
	`W_DO
(
_p¡ock_mª
->
	`¡_šdex_´obe_fÜupd©e
(
_pssm
, 
´¡
,

855 
Ş_suµly_w_id
, 
Ş_i_id
));

856 
´¡
->
	`g‘_v®ue
(0, 
a¡ock
.
S_I_ID
);

857 
´¡
->
	`g‘_v®ue
(1, 
a¡ock
.
S_W_ID
);

858 
´¡
->
	`g‘_v®ue
(5, 
a¡ock
.
S_YTD
);

859 
a¡ock
.
S_YTD
 +ğ
²oš
.
™ems
[
™em_út
].
_Ş_quªt™y
;

860 
´¡
->
	`g‘_v®ue
(2, 
a¡ock
.
S_REMOTE_CNT
);

861 
´¡
->
	`g‘_v®ue
(3, 
a¡ock
.
S_QUANTITY
);

862 
a¡ock
.
S_QUANTITY
 -ğ
²oš
.
™ems
[
™em_út
].
_Ş_quªt™y
;

863 ià(
a¡ock
.
S_QUANTITY
 < 10)‡stock.S_QUANTITY += 91;

865 
´¡
->
	`g‘_v®ue
(6+
²oš
.
_d_id
, 
a¡ock
.
S_DIST
[pnoin._d_id], 25);

866 
´¡
->
	`g‘_v®ue
(16, 
a¡ock
.
S_DATA
, 51);

868 
c_s_b¿nd_g’”ic
;

869 ià(
	`¡r¡r
(
a™em
.
I_DATA
, "ORIGINAL"è!ğ
NULL
 &&

870 
	`¡r¡r
(
a¡ock
.
S_DATA
, "ORIGINAL"è!ğ
NULL
)

871 
c_s_b¿nd_g’”ic
 = 'B';

872 
c_s_b¿nd_g’”ic
 = 'G';

874 
´¡
->
	`g‘_v®ue
(4, 
a¡ock
.
S_ORDER_CNT
);

875 
a¡ock
.
S_ORDER_CNT
++;

877 ià(
²oš
.
_wh_id
 !ğ
Ş_suµly_w_id
) {

878 
a¡ock
.
S_REMOTE_CNT
++;

887 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d NO:stock-upd-tuple (%d) (%d)\n",

888 
xù_id
, 
a¡ock
.
S_W_ID
,‡¡ock.
S_I_ID
);

889 
	`W_DO
(
_p¡ock_mª
->
	`¡_upd©e_tu¶e
(
_pssm
, 
´¡
, &
a¡ock
));

897 
´Ş
->
	`£t_v®ue
(0, 
adi¡
.
D_NEXT_O_ID
);

898 
´Ş
->
	`£t_v®ue
(1, 
²oš
.
_d_id
);

899 
´Ş
->
	`£t_v®ue
(2, 
²oš
.
_wh_id
);

900 
´Ş
->
	`£t_v®ue
(3, 
™em_út
+1);

901 
´Ş
->
	`£t_v®ue
(4, 
Ş_i_id
);

902 
´Ş
->
	`£t_v®ue
(5, 
Ş_suµly_w_id
);

903 
´Ş
->
	`£t_v®ue
(6, 
²oš
.
_t¡amp
);

904 
´Ş
->
	`£t_v®ue
(7, 
²oš
.
™ems
[
™em_út
].
_Ş_quªt™y
);

905 
´Ş
->
	`£t_v®ue
(8, 
™em_amouÁ
);

907 
´Ş
->
	`£t_v®ue
(9, 
a¡ock
.
S_DIST
[
²oš
.
_d_id
]);

908 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d NO:ol-add-tuple (%d) (%d) (%d) (%d)\n",

909 
xù_id
, 
²oš
.
_wh_id
,…noš.
_d_id
,

910 
adi¡
.
D_NEXT_O_ID
, 
™em_út
+1);

911 
	`W_DO
(
_pÜd”_lše_mª
->
	`add_tu¶e
(
_pssm
, 
´Ş
));

920 
´Üd
->
	`£t_v®ue
(0, 
adi¡
.
D_NEXT_O_ID
);

921 
´Üd
->
	`£t_v®ue
(1, 
²oš
.
_c_id
);

922 
´Üd
->
	`£t_v®ue
(2, 
²oš
.
_d_id
);

923 
´Üd
->
	`£t_v®ue
(3, 
²oš
.
_wh_id
);

924 
´Üd
->
	`£t_v®ue
(4, 
²oš
.
_t¡amp
);

925 
´Üd
->
	`£t_v®ue
(5, 0);

926 
´Üd
->
	`£t_v®ue
(6, 
²oš
.
_Ş_út
);

927 
´Üd
->
	`£t_v®ue
(7, 
²oš
.
_®l_loÿl
);

928 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d NO:ord-add-tuple (%d)\n",

929 
xù_id
, 
adi¡
.
D_NEXT_O_ID
);

930 
	`W_DO
(
_pÜd”_mª
->
	`add_tu¶e
(
_pssm
, 
´Üd
));

935 
´no
->
	`£t_v®ue
(0, 
adi¡
.
D_NEXT_O_ID
);

936 
´no
->
	`£t_v®ue
(1, 
²oš
.
_d_id
);

937 
´no
->
	`£t_v®ue
(2, 
²oš
.
_wh_id
);

938 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d NO:nord-add-tuple (%d) (%d) (%d)\n",

939 
xù_id
, 
²oš
.
_wh_id
,…noš.
_d_id
, 
adi¡
.
D_NEXT_O_ID
);

940 
	`W_DO
(
_²ew_Üd”_mª
->
	`add_tu¶e
(
_pssm
, 
´no
));

942 #ifdeà
PRINT_TRX_RESULTS


945 
´wh
->
	`´št_tu¶e
();

946 
´di¡
->
	`´št_tu¶e
();

947 
´cu¡
->
	`´št_tu¶e
();

948 
´no
->
	`´št_tu¶e
();

949 
´Üd
->
	`´št_tu¶e
();

950 
´™em
->
	`´št_tu¶e
();

951 
´¡
->
	`´št_tu¶e
();

952 
´Ş
->
	`´št_tu¶e
();

955  
RCOK
;

957 
	}
}

968 
w_rc_t
 
	gShÜeTPCCEnv
::
	$xù_·ym’t
(cÚ¡ 
xù_id
,

969 
·ym’t_šput_t
& 
µš
)

972 
	`as£¹
 (
_pssm
);

973 
	`as£¹
 (
_š™Ÿlized
);

974 
	`as£¹
 (
_lßded
);

980 
tu¶e_gu¬d
<
w¬ehou£_mª_im¶
> 
	`´wh
(
_pw¬ehou£_mª
);

981 
tu¶e_gu¬d
<
di¡riù_mª_im¶
> 
	`´di¡
(
_pdi¡riù_mª
);

982 
tu¶e_gu¬d
<
cu¡om”_mª_im¶
> 
	`´cu¡
(
_pcu¡om”_mª
);

983 
tu¶e_gu¬d
<
hi¡Üy_mª_im¶
> 
	`´hi¡
(
_phi¡Üy_mª
);

985 
»p_row_t
 
	`¬•row
(
_pcu¡om”_mª
->
	`ts
());

988 
¬•row
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

990 
´wh
->
_»p
 = &
¬•row
;

991 
´di¡
->
_»p
 = &
¬•row
;

992 
´cu¡
->
_»p
 = &
¬•row
;

993 
´hi¡
->
_»p
 = &
¬•row
;

996 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d PAY:wh-idx-upd (%d)\n",

997 
xù_id
, 
µš
.
_home_wh_id
);

998 
	`W_DO
(
_pw¬ehou£_mª
->
	`wh_šdex_´obe_fÜupd©e
(
_pssm
, 
´wh
,

999 
µš
.
_home_wh_id
));

1002 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d PAY:dist-idx-upd (%d) (%d)\n",

1003 
xù_id
, 
µš
.
_home_wh_id
,…pš.
_home_d_id
);

1004 
	`W_DO
(
_pdi¡riù_mª
->
	`di¡_šdex_´obe_fÜupd©e
(
_pssm
, 
´di¡
,

1005 
µš
.
_home_wh_id
,

1006 
µš
.
_home_d_id
));

1011 
c_w
 = (
µš
.
_v_cu¡_wh_£ËùiÚ
 > 85 ?…pš.
_home_wh_id
 :…pš.
_»mÙe_wh_id
);

1012 
c_d
 = (
µš
.
_v_cu¡_wh_£ËùiÚ
 > 85 ?…pš.
_home_d_id
 :…pš.
_»mÙe_d_id
);

1014 ià(
µš
.
_v_cu¡_id’t_£ËùiÚ
 <= 60) {

1028 
»p_row_t
 
	`low»p
(
_pcu¡om”_mª
->
	`ts
());

1029 
»p_row_t
 
	`high»p
(
_pcu¡om”_mª
->
	`ts
());

1031 
gu¬d
< 
šdex_sÿn_™”_im¶
<
cu¡om”_t
> > 
c_™”
;

1033 
šdex_sÿn_™”_im¶
<
cu¡om”_t
>* 
tmp_c_™”
;

1034 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d PAY:cust-iter-by-name-idx (%s)\n",

1035 
xù_id
, 
µš
.
_c_Ï¡
);

1036 
	`W_DO
(
_pcu¡om”_mª
->
	`cu¡_g‘_™”_by_šdex
(
_pssm
, 
tmp_c_™”
,

1037 
´cu¡
, 
low»p
, 
high»p
,

1038 
c_w
, 
c_d
,

1039 
µš
.
_c_Ï¡
));

1040 
c_™”
 = 
tmp_c_™”
;

1043 
veùÜ
<> 
v_c_id
;

1044 
a_c_id
 = 0;

1045 
couÁ
 = 0;

1046 
boŞ
 
eof
;

1048 
	`W_DO
(
c_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cu¡
));

1049 !
eof
) {

1051 ++
couÁ
;

1052 
´cu¡
->
	`g‘_v®ue
(0, 
a_c_id
);

1053 
v_c_id
.
	`push_back
(
a_c_id
);

1054 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d PAY:cust-iter-next (%d)\n",

1055 
xù_id
, 
a_c_id
);

1056 
	`W_DO
(
c_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cu¡
));

1058 
	`as£¹
 (
couÁ
);

1061 
µš
.
_c_id
 = 
v_c_id
[(
couÁ
+1)/2-1];

1063 
	`as£¹
 (
µš
.
_c_id
>0);

1076 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d PAY:cust-idx-upd (%d) (%d) (%d)\n",

1077 
xù_id
, 
c_w
, 
c_d
, 
µš
.
_c_id
);

1078 
	`W_DO
(
_pcu¡om”_mª
->
	`cu¡_šdex_´obe_fÜupd©e
(
_pssm
, 
´cu¡
,

1079 
c_w
, 
c_d
, 
µš
.
_c_id
));

1083 
cc_cu¡om”_tu¶e
 
acu¡
;

1086 
´cu¡
->
	`g‘_v®ue
(3, 
acu¡
.
C_FIRST
, 17);

1087 
´cu¡
->
	`g‘_v®ue
(4, 
acu¡
.
C_MIDDLE
, 3);

1088 
´cu¡
->
	`g‘_v®ue
(5, 
acu¡
.
C_LAST
, 17);

1089 
´cu¡
->
	`g‘_v®ue
(6, 
acu¡
.
C_STREET_1
, 21);

1090 
´cu¡
->
	`g‘_v®ue
(7, 
acu¡
.
C_STREET_2
, 21);

1091 
´cu¡
->
	`g‘_v®ue
(8, 
acu¡
.
C_CITY
, 21);

1092 
´cu¡
->
	`g‘_v®ue
(9, 
acu¡
.
C_STATE
, 3);

1093 
´cu¡
->
	`g‘_v®ue
(10, 
acu¡
.
C_ZIP
, 10);

1094 
´cu¡
->
	`g‘_v®ue
(11, 
acu¡
.
C_PHONE
, 17);

1095 
´cu¡
->
	`g‘_v®ue
(12, 
acu¡
.
C_SINCE
);

1096 
´cu¡
->
	`g‘_v®ue
(13, 
acu¡
.
C_CREDIT
, 3);

1097 
´cu¡
->
	`g‘_v®ue
(14, 
acu¡
.
C_CREDIT_LIM
);

1098 
´cu¡
->
	`g‘_v®ue
(15, 
acu¡
.
C_DISCOUNT
);

1099 
´cu¡
->
	`g‘_v®ue
(16, 
acu¡
.
C_BALANCE
);

1100 
´cu¡
->
	`g‘_v®ue
(17, 
acu¡
.
C_YTD_PAYMENT
);

1101 
´cu¡
->
	`g‘_v®ue
(18, 
acu¡
.
C_LAST_PAYMENT
);

1102 
´cu¡
->
	`g‘_v®ue
(19, 
acu¡
.
C_PAYMENT_CNT
);

1103 
´cu¡
->
	`g‘_v®ue
(20, 
acu¡
.
C_DATA_1
, 251);

1104 
´cu¡
->
	`g‘_v®ue
(21, 
acu¡
.
C_DATA_2
, 251);

1107 
acu¡
.
C_BALANCE
 -ğ
µš
.
_h_amouÁ
;

1108 
acu¡
.
C_YTD_PAYMENT
 +ğ
µš
.
_h_amouÁ
;

1109 
acu¡
.
C_PAYMENT_CNT
++;

1112 ià(
acu¡
.
C_CREDIT
[0] == 'B' &&‡cust.C_CREDIT[1] == 'C') {

1124 
c_Ãw_d©a_1
[251];

1125 
c_Ãw_d©a_2
[251];

1126 
	`¥rštf
(
c_Ãw_d©a_1
, "%d,%d,%d,%d,%d,%1.2f",

1127 
µš
.
_c_id
, 
c_d
, 
c_w
,…pš.
_home_d_id
,

1128 
µš
.
_home_wh_id
,…pš.
_h_amouÁ
);

1130 
Ën
 = 
	`¡¾’
(
c_Ãw_d©a_1
);

1131 
	`¡ºÿt
(
c_Ãw_d©a_1
, 
acu¡
.
C_DATA_1
, 250-
Ën
);

1132 
	`¡ºıy
(
c_Ãw_d©a_2
, &
acu¡
.
C_DATA_1
[250-
Ën
],†en);

1133 
	`¡ºıy
(
c_Ãw_d©a_2
, 
acu¡
.
C_DATA_2
, 250-
Ën
);

1135 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d PAY:cu¡-upd-tu¶e\n", 
xù_id
);

1136 
	`W_DO
(
_pcu¡om”_mª
->
	`cu¡_upd©e_tu¶e
(
_pssm
, 
´cu¡
, 
acu¡
,

1137 
c_Ãw_d©a_1
, 
c_Ãw_d©a_2
));

1139 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d PAY:cu¡-upd-tu¶e\n", 
xù_id
);

1140 
	`W_DO
(
_pcu¡om”_mª
->
	`cu¡_upd©e_tu¶e
(
_pssm
, 
´cu¡
, 
acu¡
,

1141 
NULL
, NULL));

1155 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d PAY:dist-upd-ytd (%d) (%d)\n",

1156 
xù_id
, 
µš
.
_home_wh_id
,…pš.
_home_d_id
);

1157 
	`W_DO
(
_pdi¡riù_mª
->
	`di¡_upd©e_ytd
(
_pssm
, 
´di¡
, 
µš
.
_h_amouÁ
));

1159 
cc_di¡riù_tu¶e
 
adi¡r
;

1160 
´di¡
->
	`g‘_v®ue
(2, 
adi¡r
.
D_NAME
, 11);

1161 
´di¡
->
	`g‘_v®ue
(3, 
adi¡r
.
D_STREET_1
, 21);

1162 
´di¡
->
	`g‘_v®ue
(4, 
adi¡r
.
D_STREET_2
, 21);

1163 
´di¡
->
	`g‘_v®ue
(5, 
adi¡r
.
D_CITY
, 21);

1164 
´di¡
->
	`g‘_v®ue
(6, 
adi¡r
.
D_STATE
, 3);

1165 
´di¡
->
	`g‘_v®ue
(7, 
adi¡r
.
D_ZIP
, 10);

1178 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d PAY:wh-update-ytd (%d)\n",

1179 
xù_id
, 
µš
.
_home_wh_id
);

1180 
	`W_DO
(
_pw¬ehou£_mª
->
	`wh_upd©e_ytd
(
_pssm
, 
´wh
, 
µš
.
_h_amouÁ
));

1182 
cc_w¬ehou£_tu¶e
 
awh
;

1183 
´wh
->
	`g‘_v®ue
(1, 
awh
.
W_NAME
, 11);

1184 
´wh
->
	`g‘_v®ue
(2, 
awh
.
W_STREET_1
, 21);

1185 
´wh
->
	`g‘_v®ue
(3, 
awh
.
W_STREET_2
, 21);

1186 
´wh
->
	`g‘_v®ue
(4, 
awh
.
W_CITY
, 21);

1187 
´wh
->
	`g‘_v®ue
(5, 
awh
.
W_STATE
, 3);

1188 
´wh
->
	`g‘_v®ue
(6, 
awh
.
W_ZIP
, 10);

1196 
cc_hi¡Üy_tu¶e
 
ahi¡
;

1197 
	`¥rštf
(
ahi¡
.
H_DATA
, "%  %s", 
awh
.
W_NAME
, 
adi¡r
.
D_NAME
);

1198 
ahi¡
.
H_DATE
 = 
	`time
(
NULL
);

1200 
´hi¡
->
	`£t_v®ue
(0, 
µš
.
_c_id
);

1201 
´hi¡
->
	`£t_v®ue
(1, 
c_d
);

1202 
´hi¡
->
	`£t_v®ue
(2, 
c_w
);

1203 
´hi¡
->
	`£t_v®ue
(3, 
µš
.
_home_d_id
);

1204 
´hi¡
->
	`£t_v®ue
(4, 
µš
.
_home_wh_id
);

1205 
´hi¡
->
	`£t_v®ue
(5, 
ahi¡
.
H_DATE
);

1206 
´hi¡
->
	`£t_v®ue
(6, 
µš
.
_h_amouÁ
 * 100.0);

1207 
´hi¡
->
	`£t_v®ue
(7, 
ahi¡
.
H_DATA
);

1209 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d PAY:hi¡-add-tu¶e\n", 
xù_id
);

1210 
	`W_DO
(
_phi¡Üy_mª
->
	`add_tu¶e
(
_pssm
, 
´hi¡
));

1212 #ifdeà
PRINT_TRX_RESULTS


1215 
´wh
->
	`´št_tu¶e
();

1216 
´di¡
->
	`´št_tu¶e
();

1217 
´cu¡
->
	`´št_tu¶e
();

1218 
´hi¡
->
	`´št_tu¶e
();

1221  
RCOK
;

1223 
	}
}

1238 
w_rc_t
 
	gShÜeTPCCEnv
::
	$xù_Üd”_¡©us
(cÚ¡ 
xù_id
,

1239 
Üd”_¡©us_šput_t
& 
p¡š
)

1242 
	`as£¹
 (
_pssm
);

1243 
	`as£¹
 (
_š™Ÿlized
);

1244 
	`as£¹
 (
_lßded
);

1246 
w_id
 = 
p¡š
.
_wh_id
;

1247 
d_id
 = 
p¡š
.
_d_id
;

1252 
tu¶e_gu¬d
<
cu¡om”_mª_im¶
> 
	`´cu¡
(
_pcu¡om”_mª
);

1253 
tu¶e_gu¬d
<
Üd”_mª_im¶
> 
	`´Üd
(
_pÜd”_mª
);

1254 
tu¶e_gu¬d
<
Üd”_lše_mª_im¶
> 
	`´Ş
(
_pÜd”_lše_mª
);

1256 
»p_row_t
 
	`¬•row
(
_pcu¡om”_mª
->
	`ts
());

1259 
¬•row
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

1261 
´cu¡
->
_»p
 = &
¬•row
;

1262 
´Üd
->
_»p
 = &
¬•row
;

1263 
´Ş
->
_»p
 = &
¬•row
;

1265 
»p_row_t
 
	`low»p
(
_pcu¡om”_mª
->
	`ts
());

1266 
»p_row_t
 
	`high»p
(
_pcu¡om”_mª
->
	`ts
());

1268 
cc_Üd”lše_tu¶e
* 
pÜd”lšes
 = 
NULL
;

1272 
low»p
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

1273 
high»p
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

1276 ià(
p¡š
.
_c_id
 == 0) {

1286 
	`as£¹
 (
p¡š
.
_c_£Ëù
 <= 60);

1287 
	`as£¹
 (
p¡š
.
_c_Ï¡
);

1289 
gu¬d
<
šdex_sÿn_™”_im¶
<
cu¡om”_t
> > 
c_™”
;

1291 
šdex_sÿn_™”_im¶
<
cu¡om”_t
>* 
tmp_c_™”
;

1292 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d ORDST:cust-iter-by-name-idx\n",

1293 
xù_id
);

1294 
	`W_DO
(
_pcu¡om”_mª
->
	`cu¡_g‘_™”_by_šdex
(
_pssm
, 
tmp_c_™”
,

1295 
´cu¡
, 
low»p
, 
high»p
,

1296 
w_id
, 
d_id
,

1297 
p¡š
.
_c_Ï¡
));

1298 
c_™”
 = 
tmp_c_™”
;

1301 
veùÜ
<> 
c_id_li¡
;

1302 
id
 = 0;

1303 
couÁ
 = 0;

1304 
boŞ
 
eof
;

1306 
	`W_DO
(
c_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cu¡
));

1307 !
eof
) {

1309 ++
couÁ
;

1310 
´cu¡
->
	`g‘_v®ue
(0, 
id
);

1311 
c_id_li¡
.
	`push_back
(
id
);

1312 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d ORDST:cu¡-™”-Ãxt\n", 
xù_id
);

1313 
	`W_DO
(
c_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cu¡
));

1315 
	`as£¹
 (
couÁ
);

1318 
p¡š
.
_c_id
 = 
c_id_li¡
[(
couÁ
+1)/2-1];

1320 
	`as£¹
 (
p¡š
.
_c_id
>0);

1331 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d ORDST:cust-idx-probe (%d) (%d) (%d)\n",

1332 
xù_id
, 
w_id
, 
d_id
, 
p¡š
.
_c_id
);

1333 
	`W_DO
(
_pcu¡om”_mª
->
	`cu¡_šdex_´obe
(
_pssm
, 
´cu¡
,

1334 
w_id
, 
d_id
, 
p¡š
.
_c_id
));

1336 
cc_cu¡om”_tu¶e
 
acu¡
;

1337 
´cu¡
->
	`g‘_v®ue
(3, 
acu¡
.
C_FIRST
, 17);

1338 
´cu¡
->
	`g‘_v®ue
(4, 
acu¡
.
C_MIDDLE
, 3);

1339 
´cu¡
->
	`g‘_v®ue
(5, 
acu¡
.
C_LAST
, 17);

1340 
´cu¡
->
	`g‘_v®ue
(16, 
acu¡
.
C_BALANCE
);

1352 
gu¬d
<
šdex_sÿn_™”_im¶
<
Üd”_t
> > 
o_™”
;

1354 
šdex_sÿn_™”_im¶
<
Üd”_t
>* 
tmp_o_™”
;

1355 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d ORDST:Üd-™”-by-idx\n", 
xù_id
);

1356 
	`W_DO
(
_pÜd”_mª
->
	`Üd_g‘_™”_by_šdex
(
_pssm
, 
tmp_o_™”
, 
´Üd
,

1357 
low»p
, 
high»p
,

1358 
w_id
, 
d_id
, 
p¡š
.
_c_id
));

1359 
o_™”
 = 
tmp_o_™”
;

1362 
cc_Üd”_tu¶e
 
aÜd”
;

1363 
boŞ
 
eof
;

1365 
	`W_DO
(
o_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Üd
));

1366 !
eof
) {

1367 
´Üd
->
	`g‘_v®ue
(0, 
aÜd”
.
O_ID
);

1368 
´Üd
->
	`g‘_v®ue
(4, 
aÜd”
.
O_ENTRY_D
);

1369 
´Üd
->
	`g‘_v®ue
(5, 
aÜd”
.
O_CARRIER_ID
);

1370 
´Üd
->
	`g‘_v®ue
(6, 
aÜd”
.
O_OL_CNT
);

1371 
	`W_DO
(
o_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Üd
));

1375 
	`as£¹
 (
aÜd”
.
O_ID
);

1376 
	`as£¹
 (
aÜd”
.
O_OL_CNT
);

1387 
gu¬d
<
šdex_sÿn_™”_im¶
<
Üd”_lše_t
> > 
Ş_™”
;

1389 
šdex_sÿn_™”_im¶
<
Üd”_lše_t
>* 
tmp_Ş_™”
;

1390 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d ORDST:Ş-™”-by-idx\n", 
xù_id
);

1391 
	`W_DO
(
_pÜd”_lše_mª
->
	`Ş_g‘_´obe_™”_by_šdex
(
_pssm
, 
tmp_Ş_™”
,

1392 
´Ş
, 
low»p
, 
high»p
,

1393 
w_id
, 
d_id
,

1394 
aÜd”
.
O_ID
));

1395 
Ş_™”
 = 
tmp_Ş_™”
;

1398 
pÜd”lšes
 = 
Ãw
 
cc_Üd”lše_tu¶e
[
aÜd”
.
O_OL_CNT
];

1399 
i
=0;

1401 
	`W_DO
(
Ş_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Ş
));

1402 !
eof
) {

1403 
´Ş
->
	`g‘_v®ue
(4, 
pÜd”lšes
[
i
].
OL_I_ID
);

1404 
´Ş
->
	`g‘_v®ue
(5, 
pÜd”lšes
[
i
].
OL_SUPPLY_W_ID
);

1405 
´Ş
->
	`g‘_v®ue
(6, 
pÜd”lšes
[
i
].
OL_DELIVERY_D
);

1406 
´Ş
->
	`g‘_v®ue
(7, 
pÜd”lšes
[
i
].
OL_QUANTITY
);

1407 
´Ş
->
	`g‘_v®ue
(8, 
pÜd”lšes
[
i
].
OL_AMOUNT
);

1408 
i
++;

1409 
	`W_DO
(
Ş_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Ş
));

1412 #ifdeà
PRINT_TRX_RESULTS


1415 
rcu¡
.
	`´št_tu¶e
();

1416 
rÜd
.
	`´št_tu¶e
();

1417 
rÜdlše
.
	`´št_tu¶e
();

1420 ià(
pÜd”lšes
è
d–‘e
 []…orderlines;

1422  
RCOK
;

1424 
	}
};

1438 
	gd–iv”y_abÜt_ùr
 = 0;

1440 
w_rc_t
 
	gShÜeTPCCEnv
::
	$xù_d–iv”y
(cÚ¡ 
xù_id
,

1441 
d–iv”y_šput_t
& 
pdš
)

1443 
boŞ
 cÚ¡ 
SPLIT_TRX
 = 
çl£
;

1444 
¡d
::
veùÜ
<> 
	`dli¡
(
DISTRICTS_PER_WAREHOUSE
);

1445 
d_id
;

1446 
w_rc_t
 
e
 = 
	`_xù_d–iv”y_h–³r
(
xù_id
, 
pdš
, 
dli¡
, 
d_id
, 
SPLIT_TRX
);

1447 
SPLIT_TRX
 && 
e
.
	`is_”rÜ
(è&&ƒ.
	`”r_num
(è=ğ
smËv–_0
::
eDEADLOCK
) {

1448 
	`W_COERCE
(
_pssm
->
	`abÜt_xù
());

1449 
	`W_DO
(
_pssm
->
	`begš_xù
());

1450 
	`©omic_šc_32
(&
d–iv”y_abÜt_ùr
);

1451 
dli¡
.
	`push_back
(
d_id
);

1452 
e
 = 
	`_xù_d–iv”y_h–³r
(
xù_id
, 
pdš
, 
dli¡
, 
d_id
, 
SPLIT_TRX
);

1454  
e
;

1455 
	}
};

1457 
w_rc_t
 
	gShÜeTPCCEnv
::
_xù_d–iv”y_h–³r
(cÚ¡ 
xù_id
,

1458 
d–iv”y_šput_t
& 
pdš
,

1459 
¡d
::
veùÜ
<>& 
dli¡
,

1460 & 
d_id
,

1461 cÚ¡ 
boŞ
 
SPLIT_TRX
) {

1463 
as£¹
 (
_pssm
);

1464 
as£¹
 (
_š™Ÿlized
);

1465 
as£¹
 (
_lßded
);

1467 
	gw_id
 = 
pdš
.
_wh_id
;

1468 
	gÿ¼›r_id
 = 
pdš
.
_ÿ¼›r_id
;

1469 
time_t
 
	gts_¡¬t
 = 
time
(
NULL
);

1474 
	gtu¶e_gu¬d
<
	gÃw_Üd”_mª_im¶
> 
´no
(
_²ew_Üd”_mª
);

1475 
	gtu¶e_gu¬d
<
	gÜd”_mª_im¶
> 
´Üd
(
_pÜd”_mª
);

1476 
	gtu¶e_gu¬d
<
	gÜd”_lše_mª_im¶
> 
´Ş
(
_pÜd”_lše_mª
);

1477 
	gtu¶e_gu¬d
<
	gcu¡om”_mª_im¶
> 
´cu¡
(
_pcu¡om”_mª
);

1479 
»p_row_t
 
¬•row
(
_pcu¡om”_mª
->
ts
());

1482 
	g¬•row
.
£t
(
_pcu¡om”_desc
->
maxsize
());

1484 
	g´no
->
	g_»p
 = &
¬•row
;

1485 
	g´Üd
->
	g_»p
 = &
¬•row
;

1486 
	g´Ş
->
	g_»p
 = &
¬•row
;

1487 
	g´cu¡
->
	g_»p
 = &
¬•row
;

1489 
»p_row_t
 
low»p
(
_pÜd”_lše_mª
->
ts
());

1490 
»p_row_t
 
high»p
(
_pÜd”_lše_mª
->
ts
());

1494 
	glow»p
.
£t
(
_pÜd”_lše_desc
->
maxsize
());

1495 
	ghigh»p
.
£t
(
_pÜd”_lše_desc
->
maxsize
());

1497 
ušt_t
 
	gi
=0; i < 
	gdli¡
.
size
(); i++) {

1498 
	gdli¡
[
i
] = i+1;

1500 if(
	gSPLIT_TRX
) {

1501 
	g¡d
::
¿ndom_shufæe
(
dli¡
.
begš
(), dli¡.
’d
());

1505 
	gdli¡
.
size
()) {

1506 
	gd_id
 = 
dli¡
.
back
();

1507 
	gdli¡
.
pİ_back
();

1518 
TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DEL:nord-iter-by-idx (%d) (%d)\n",

1519 
xù_id
, 
w_id
, 
d_id
);

1520 
	ggu¬d
<
	gšdex_sÿn_™”_im¶
<
	gÃw_Üd”_t
> > 
	gno_™”
;

1522 
	gšdex_sÿn_™”_im¶
<
	gÃw_Üd”_t
>* 
	gtmp_no_™”
;

1523 
W_DO
(
_²ew_Üd”_mª
->
no_g‘_™”_by_šdex
(
_pssm
, 
tmp_no_™”
,

1524 
´no
, 
low»p
, 
high»p
,

1525 
w_id
, 
d_id
,

1526 
EX
, 
çl£
));

1527 
	gno_™”
 = 
tmp_no_™”
;

1530 
boŞ
 
	geof
;

1533 
W_DO
(
no_™”
->
Ãxt
(
_pssm
, 
eof
, *
´no
));

1535 ià(
	geof
) ;

1537 
	gno_o_id
;

1538 
	g´no
->
g‘_v®ue
(0, 
no_o_id
);

1539 
as£¹
 (
no_o_id
);

1549 
TRACE
Ğ
TRACE_TRX_FLOW
,

1551 
xù_id
, 
w_id
, 
d_id
, 
no_o_id
);

1552 
W_DO
(
_²ew_Üd”_mª
->
no_d–‘e_by_šdex
(
_pssm
, 
´no
,

1553 
w_id
, 
d_id
, 
no_o_id
));

1565 
TRACE
Ğ
TRACE_TRX_FLOW
,

1567 
xù_id
, 
w_id
, 
d_id
, 
no_o_id
);

1568 
	g´Üd
->
£t_v®ue
(0, 
no_o_id
);

1569 
	g´Üd
->
£t_v®ue
(2, 
d_id
);

1570 
	g´Üd
->
£t_v®ue
(3, 
w_id
);

1571 
W_DO
(
_pÜd”_mª
->
Üd_upd©e_ÿ¼›r_by_šdex
(
_pssm
, 
´Üd
,

1572 
ÿ¼›r_id
));

1574 
	gc_id
;

1575 
	g´Üd
->
g‘_v®ue
(1, 
c_id
);

1587 
TRACE
Ğ
TRACE_TRX_FLOW
,

1589 
xù_id
, 
w_id
, 
d_id
, 
no_o_id
);

1591 
	gtÙ®_amouÁ
 = 0;

1592 
	ggu¬d
<
	gšdex_sÿn_™”_im¶
<
	gÜd”_lše_t
> > 
	gŞ_™”
;

1594 
	gšdex_sÿn_™”_im¶
<
	gÜd”_lše_t
>* 
	gtmp_Ş_™”
;

1595 
W_DO
(
_pÜd”_lše_mª
->
Ş_g‘_´obe_™”_by_šdex
(
_pssm
,

1596 
tmp_Ş_™”
,

1597 
´Ş
,

1598 
low»p
, 
high»p
,

1599 
w_id
, 
d_id
,

1600 
no_o_id
));

1601 
	gŞ_™”
 = 
tmp_Ş_™”
;

1605 
W_DO
(
Ş_™”
->
Ãxt
(
_pssm
, 
eof
, *
´Ş
));

1606 !
	geof
) {

1608 
	gcu¼’t_amouÁ
;

1609 
	g´Ş
->
g‘_v®ue
(8, 
cu¼’t_amouÁ
);

1610 
	gtÙ®_amouÁ
 +ğ
cu¼’t_amouÁ
;

1612 
	g´Ş
->
£t_v®ue
(6, 
ts_¡¬t
);

1613 
W_DO
(
_pÜd”_lše_mª
->
upd©e_tu¶e
(
_pssm
, 
´Ş
));

1615 
W_DO
(
Ş_™”
->
Ãxt
(
_pssm
, 
eof
, *
´Ş
));

1627 
TRACE
Ğ
TRACE_TRX_FLOW
,

1629 
xù_id
, 
w_id
, 
d_id
, 
c_id
);

1630 
W_DO
(
_pcu¡om”_mª
->
cu¡_šdex_´obe_fÜupd©e
(
_pssm
, 
´cu¡
,

1631 
w_id
, 
d_id
, 
c_id
));

1633 
	gb®ªû
;

1634 
	g´cu¡
->
g‘_v®ue
(16, 
b®ªû
);

1635 
	g´cu¡
->
£t_v®ue
(16, 
b®ªû
+
tÙ®_amouÁ
);

1636 
W_DO
(
_pcu¡om”_mª
->
upd©e_tu¶e
(
_pssm
, 
´cu¡
));

1638 if(
	gSPLIT_TRX
 && 
	gdli¡
.
size
()) {

1639 #ifdeà
CFG_FLUSHER


1640 #w¬nšg 
TPCC
-
D–iv”y
 
dÛs
 
nÙ
 dØ
the
 
š‹rmedŸ‹
 
comm™s
 
Ïzy


1642 
W_DO
(
_pssm
->
comm™_xù
());

1643 
W_DO
(
_pssm
->
begš_xù
());

1647 #ifdeà
PRINT_TRX_RESULTS


1650 
	g´no
->
´št_tu¶e
();

1651 
	g´Üd
->
´št_tu¶e
();

1652 
	g´Üdlše
->
´št_tu¶e
();

1653 
	g´cu¡
->
´št_tu¶e
();

1670 
w_rc_t
 
	gShÜeTPCCEnv
::
	$xù_¡ock_Ëv–
(cÚ¡ 
xù_id
,

1671 
¡ock_Ëv–_šput_t
& 
p¦š
)

1674 
	`as£¹
 (
_pssm
);

1675 
	`as£¹
 (
_š™Ÿlized
);

1676 
	`as£¹
 (
_lßded
);

1681 
tu¶e_gu¬d
<
di¡riù_mª_im¶
> 
	`´di¡
(
_pdi¡riù_mª
);

1682 
tu¶e_gu¬d
<
Üd”_lše_mª_im¶
> 
	`´Ş
(
_pÜd”_lše_mª
);

1683 
tu¶e_gu¬d
<
¡ock_mª_im¶
> 
	`´¡
(
_p¡ock_mª
);

1685 
»p_row_t
 
	`¬•row
(
_pdi¡riù_mª
->
	`ts
());

1688 
¬•row
.
	`£t
(
_pdi¡riù_desc
->
	`maxsize
());

1690 
´di¡
->
_»p
 = &
¬•row
;

1691 
´Ş
->
_»p
 = &
¬•row
;

1692 
´¡
->
_»p
 = &
¬•row
;

1703 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d STO:dist-idx-probe (%d) (%d)\n",

1704 
xù_id
, 
p¦š
.
_wh_id
,…¦š.
_d_id
);

1705 
	`W_DO
(
_pdi¡riù_mª
->
	`di¡_šdex_´obe
(
_pssm
, 
´di¡
,

1706 
p¦š
.
_wh_id
,…¦š.
_d_id
));

1708 
Ãxt_o_id
 = 0;

1709 
´di¡
->
	`g‘_v®ue
(10, 
Ãxt_o_id
);

1731 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d STO:ol-iter-by-idx (%d) (%d) (%d) (%d)\n",

1732 
xù_id
, 
p¦š
.
_wh_id
,…¦š.
_d_id
, 
Ãxt_o_id
-20,‚ext_o_id);

1734 
»p_row_t
 
	`low»p
(
_pÜd”_lše_mª
->
	`ts
());

1735 
»p_row_t
 
	`high»p
(
_pÜd”_lše_mª
->
	`ts
());

1736 
»p_row_t
 
	`sÜŒ•
(
_pÜd”_lše_mª
->
	`ts
());

1739 
low»p
.
	`£t
(
_pÜd”_lše_desc
->
	`maxsize
());

1740 
high»p
.
	`£t
(
_pÜd”_lše_desc
->
	`maxsize
());

1741 
sÜŒ•
.
	`£t
(
_pÜd”_lše_desc
->
	`maxsize
());

1743 
gu¬d
<
šdex_sÿn_™”_im¶
<
Üd”_lše_t
> > 
Ş_™”
;

1745 
šdex_sÿn_™”_im¶
<
Üd”_lše_t
>* 
tmp_Ş_™”
;

1746 
	`W_DO
(
_pÜd”_lše_mª
->
	`Ş_g‘_¿nge_™”_by_šdex
(
_pssm
, 
tmp_Ş_™”
,

1747 
´Ş
, 
low»p
, 
high»p
,

1748 
p¦š
.
_wh_id
,

1749 
p¦š
.
_d_id
,

1750 
Ãxt_o_id
-20,

1751 
Ãxt_o_id
));

1752 
Ş_™”
 = 
tmp_Ş_™”
;

1755 
asc_sÜt_bufãr_t
 
	`Ş_li¡
(4);

1756 
Ş_li¡
.
	`£tup
(0, 
SQL_INT
);

1757 
Ş_li¡
.
	`£tup
(1, 
SQL_INT
);

1758 
Ş_li¡
.
	`£tup
(2, 
SQL_INT
);

1759 
Ş_li¡
.
	`£tup
(3, 
SQL_INT
);

1760 
asc_sÜt_mª_im¶
 
	`Ş_sÜ‹r
(&
Ş_li¡
, &
sÜŒ•
);

1761 
bË_row_t
 
	`rsb
(&
Ş_li¡
);

1764 
boŞ
 
eof
;

1765 
	`W_DO
(
Ş_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Ş
));

1766 !
eof
) {

1767 
‹mp_oid
, 
‹mp_iid
;

1768 
‹mp_wid
, 
‹mp_did
;

1769 
´Ş
->
	`g‘_v®ue
(4, 
‹mp_iid
);

1770 
´Ş
->
	`g‘_v®ue
(0, 
‹mp_oid
);

1771 
´Ş
->
	`g‘_v®ue
(2, 
‹mp_wid
);

1772 
´Ş
->
	`g‘_v®ue
(1, 
‹mp_did
);

1773 
rsb
.
	`£t_v®ue
(0, 
‹mp_iid
);

1774 
rsb
.
	`£t_v®ue
(1, 
‹mp_wid
);

1775 
rsb
.
	`£t_v®ue
(2, 
‹mp_did
);

1776 
rsb
.
	`£t_v®ue
(3, 
‹mp_oid
);

1777 
Ş_sÜ‹r
.
	`add_tu¶e
(
rsb
);

1778 
	`W_DO
(
Ş_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Ş
));

1780 
	`as£¹
 (
Ş_sÜ‹r
.
	`couÁ
());

1783 
asc_sÜt_™”_im¶
 
	`Ş_li¡_sÜt_™”
(
_pssm
, &
Ş_li¡
, &
Ş_sÜ‹r
);

1784 
Ï¡_i_id
 = -1;

1785 
couÁ
 = 0;

1788 
	`W_DO
(
Ş_li¡_sÜt_™”
.
	`Ãxt
(
_pssm
, 
eof
, 
rsb
));

1789 !
eof
) {

1791 
i_id
;

1792 
w_id
;

1793 
rsb
.
	`g‘_v®ue
(0, 
i_id
);

1794 
rsb
.
	`g‘_v®ue
(1, 
w_id
);

1797 
	`W_DO
(
_p¡ock_mª
->
	`¡_šdex_´obe
(
_pssm
, 
´¡
, 
w_id
, 
i_id
));

1800 
quªt™y
;

1801 
´¡
->
	`g‘_v®ue
(3, 
quªt™y
);

1802 ià(
quªt™y
 < 
p¦š
.
_th»shŞd
) {

1809 ià(
Ï¡_i_id
 !ğ
i_id
) {

1810 
Ï¡_i_id
 = 
i_id
;

1811 
couÁ
++;

1813 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d STO:found-one (%d) (%d) (%d)\n",

1814 
xù_id
, 
couÁ
, 
i_id
, 
quªt™y
);

1817 
	`W_DO
(
Ş_li¡_sÜt_™”
.
	`Ãxt
(
_pssm
, 
eof
, 
rsb
));

1820 #ifdeà
PRINT_TRX_RESULTS


1823 
rdi¡
.
	`´št_tu¶e
();

1824 
rÜdlše
.
	`´št_tu¶e
();

1825 
r¡ock
.
	`´št_tu¶e
();

1828  
RCOK
;

1829 
	}
}

1847 
w_rc_t
 
	gShÜeTPCCEnv
::
	$xù_mb’ch_wh
(cÚ¡ 
xù_id
,

1848 
mb’ch_wh_šput_t
& 
mbš
)

1851 
	`as£¹
 (
_pssm
);

1852 
	`as£¹
 (
_š™Ÿlized
);

1853 
	`as£¹
 (
_lßded
);

1859 
tu¶e_gu¬d
<
w¬ehou£_mª_im¶
> 
	`´wh
(
_pw¬ehou£_mª
);

1861 
»p_row_t
 
	`¬•row
(
_pw¬ehou£_mª
->
	`ts
());

1864 
¬•row
.
	`£t
(
_pw¬ehou£_desc
->
	`maxsize
());

1866 
´wh
->
_»p
 = &
¬•row
;

1869 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d MBWH:wh-idx-upd (%d)\n",

1870 
xù_id
, 
mbš
.
_wh_id
);

1871 
	`W_DO
(
_pw¬ehou£_mª
->
	`wh_šdex_´obe_fÜupd©e
(
_pssm
, 
´wh
, 
mbš
.
_wh_id
));

1884 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d MBWH:wh-update-ytd (%d)\n",

1885 
xù_id
, 
mbš
.
_wh_id
);

1886 
	`W_DO
(
_pw¬ehou£_mª
->
	`wh_upd©e_ytd
(
_pssm
, 
´wh
, 
mbš
.
_amouÁ
));

1888 
cc_w¬ehou£_tu¶e
 
awh
;

1889 
´wh
->
	`g‘_v®ue
(1, 
awh
.
W_NAME
, 11);

1890 
´wh
->
	`g‘_v®ue
(2, 
awh
.
W_STREET_1
, 21);

1891 
´wh
->
	`g‘_v®ue
(3, 
awh
.
W_STREET_2
, 21);

1892 
´wh
->
	`g‘_v®ue
(4, 
awh
.
W_CITY
, 21);

1893 
´wh
->
	`g‘_v®ue
(5, 
awh
.
W_STATE
, 3);

1894 
´wh
->
	`g‘_v®ue
(6, 
awh
.
W_ZIP
, 10);

1896 #ifdeà
PRINT_TRX_RESULTS


1899 
´wh
->
	`´št_tu¶e
();

1902  
RCOK
;

1904 
	}
}

1915 
w_rc_t
 
	gShÜeTPCCEnv
::
	$xù_mb’ch_cu¡
(cÚ¡ 
xù_id
,

1916 
mb’ch_cu¡_šput_t
& 
mcš
)

1919 
	`as£¹
 (
_pssm
);

1920 
	`as£¹
 (
_š™Ÿlized
);

1921 
	`as£¹
 (
_lßded
);

1926 
tu¶e_gu¬d
<
cu¡om”_mª_im¶
> 
	`´cu¡
(
_pcu¡om”_mª
);

1928 
»p_row_t
 
	`¬•row
(
_pcu¡om”_mª
->
	`ts
());

1931 
¬•row
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

1933 
´cu¡
->
_»p
 = &
¬•row
;

1947 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d MBC:cust-idx-upd (%d) (%d) (%d)\n",

1948 
xù_id
, 
mcš
.
_wh_id
, mcš.
_d_id
, mcš.
_c_id
);

1949 
	`W_DO
(
_pcu¡om”_mª
->
	`cu¡_šdex_´obe_fÜupd©e
(
_pssm
, 
´cu¡
,

1950 
mcš
.
_wh_id
,

1951 
mcš
.
_d_id
,

1952 
mcš
.
_c_id
));

1954 
cc_cu¡om”_tu¶e
 
acu¡
;

1957 
´cu¡
->
	`g‘_v®ue
(3, 
acu¡
.
C_FIRST
, 17);

1958 
´cu¡
->
	`g‘_v®ue
(4, 
acu¡
.
C_MIDDLE
, 3);

1959 
´cu¡
->
	`g‘_v®ue
(5, 
acu¡
.
C_LAST
, 17);

1960 
´cu¡
->
	`g‘_v®ue
(6, 
acu¡
.
C_STREET_1
, 21);

1961 
´cu¡
->
	`g‘_v®ue
(7, 
acu¡
.
C_STREET_2
, 21);

1962 
´cu¡
->
	`g‘_v®ue
(8, 
acu¡
.
C_CITY
, 21);

1963 
´cu¡
->
	`g‘_v®ue
(9, 
acu¡
.
C_STATE
, 3);

1964 
´cu¡
->
	`g‘_v®ue
(10, 
acu¡
.
C_ZIP
, 10);

1965 
´cu¡
->
	`g‘_v®ue
(11, 
acu¡
.
C_PHONE
, 17);

1966 
´cu¡
->
	`g‘_v®ue
(12, 
acu¡
.
C_SINCE
);

1967 
´cu¡
->
	`g‘_v®ue
(13, 
acu¡
.
C_CREDIT
, 3);

1968 
´cu¡
->
	`g‘_v®ue
(14, 
acu¡
.
C_CREDIT_LIM
);

1969 
´cu¡
->
	`g‘_v®ue
(15, 
acu¡
.
C_DISCOUNT
);

1970 
´cu¡
->
	`g‘_v®ue
(16, 
acu¡
.
C_BALANCE
);

1971 
´cu¡
->
	`g‘_v®ue
(17, 
acu¡
.
C_YTD_PAYMENT
);

1972 
´cu¡
->
	`g‘_v®ue
(18, 
acu¡
.
C_LAST_PAYMENT
);

1973 
´cu¡
->
	`g‘_v®ue
(19, 
acu¡
.
C_PAYMENT_CNT
);

1974 
´cu¡
->
	`g‘_v®ue
(20, 
acu¡
.
C_DATA_1
, 251);

1975 
´cu¡
->
	`g‘_v®ue
(21, 
acu¡
.
C_DATA_2
, 251);

1978 
acu¡
.
C_BALANCE
 -ğ
mcš
.
_amouÁ
;

1979 
acu¡
.
C_YTD_PAYMENT
 +ğ
mcš
.
_amouÁ
;

1980 
acu¡
.
C_PAYMENT_CNT
++;

1983 ià(
acu¡
.
C_CREDIT
[0] == 'B' &&‡cust.C_CREDIT[1] == 'C') {

1995 
c_Ãw_d©a_1
[251];

1996 
c_Ãw_d©a_2
[251];

1997 
	`¥rštf
(
c_Ãw_d©a_1
, "%d,%d,%d,%d,%d,%1.2f",

1998 
mcš
.
_c_id
, mcš.
_d_id
, mcš.
_wh_id
,

1999 
mcš
.
_d_id
, mcš.
_wh_id
, mcš.
_amouÁ
);

2001 
Ën
 = 
	`¡¾’
(
c_Ãw_d©a_1
);

2002 
	`¡ºÿt
(
c_Ãw_d©a_1
, 
acu¡
.
C_DATA_1
, 250-
Ën
);

2003 
	`¡ºıy
(
c_Ãw_d©a_2
, &
acu¡
.
C_DATA_1
[250-
Ën
],†en);

2004 
	`¡ºıy
(
c_Ãw_d©a_2
, 
acu¡
.
C_DATA_2
, 250-
Ën
);

2006 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d PAY:bad-cu¡-upd-tu¶e\n", 
xù_id
);

2007 
	`W_DO
(
_pcu¡om”_mª
->
	`cu¡_upd©e_tu¶e
(
_pssm
, 
´cu¡
, 
acu¡
,

2008 
c_Ãw_d©a_1
, 
c_Ãw_d©a_2
));

2010 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d PAY:good-cu¡-upd-tu¶e\n", 
xù_id
);

2011 
	`W_DO
(
_pcu¡om”_mª
->
	`cu¡_upd©e_tu¶e
(
_pssm
, 
´cu¡
, 
acu¡
,

2012 
NULL
, NULL));

2015 #ifdeà
PRINT_TRX_RESULTS


2018 
´cu¡
->
	`´št_tu¶e
();

2021  
RCOK
;

2023 
	}
}

2026 
EXIT_NAMESPACE
(
cc
);

	@src/workload/tpcc/tpcc_input.cpp

33 
	~"ut.h
"

34 
	~"wÜklßd/cc/cc_¿ndom.h
"

35 
	~"wÜklßd/cc/cc_šput.h
"

39 
ENTER_NAMESPACE
(
cc
);

47 #undeà
USE_SAFE_PATHS


51 #undeà
USE_NO_NORD_INPUTS_FOR_ROLLBACK


55 #undeà
USE_ONLY_LOCAL_WHS


56 
	#USE_ONLY_LOCAL_WHS


	)

60 #ifdeà
USE_SAME_INPUT


61 #w¬nšg 
TPCC
 - 
U£s
 
xùs
 
w™h
 
§me
 
šput


64 #ifdeà
USE_SAFE_PATHS


65 #w¬nšg 
TPCC
 - 
DÛs
 
nÙ
 
g’”©e
 
xùs
 
th©
 
´obe
 
C_NAME_IDX


68 #ifdeà
USE_NO_NORD_INPUTS_FOR_ROLLBACK


69 #w¬nšg 
TPCC
 - 
DÛs
 
nÙ
 
g’”©e
 
abÜtšg
 
NewOrd”
 
xùs


72 #ifdeà
USE_ONLY_LOCAL_WHS


73 #w¬nšg 
TPCC
 - 
U£s
 
Úly
 
loÿl
 
W¬ehou£s


77 
skew”_t
 
	gw_skew”
;

78 
boŞ
 
	g_chªge_lßd
 = 
çl£
;

84 
	gŞ_™em_šfo
&

85 
	gŞ_™em_šfo
::
İ”©Ü
ğ(cÚ¡ 
Ş_™em_šfo
& 
rhs
)

87 
_Ş_i_id
 = 
rhs
._ol_i_id;

88 
	g_Ş_suµly_wh_£Ëù
 = 
rhs
.
_Ş_suµly_wh_£Ëù
;

89 
	g_Ş_suµly_wh_id
 = 
rhs
.
_Ş_suµly_wh_id
;

90 
	g_Ş_quªt™y
 = 
rhs
.
_Ş_quªt™y
;

92 
	g_™em_amouÁ
 = 
rhs
.
_™em_amouÁ
;

94 
	g_a¡ock
 = 
rhs
.
_a¡ock
;

95 
	g_a™em
 = 
rhs
.
_a™em
;

97  (*
	gthis
);

100 
	gÃw_Üd”_šput_t
&

101 
	gÃw_Üd”_šput_t
::
İ”©Ü
ğ(cÚ¡ 
Ãw_Üd”_šput_t
& 
rhs
)

104 
_wh_id
 = 
rhs
._wh_id;

105 
	g_d_id
 = 
rhs
.
_d_id
;

106 
	g_c_id
 = 
rhs
.
_c_id
;

107 
	g_Ş_út
 = 
rhs
.
_Ş_út
;

108 
	g_rbk
 = 
rhs
.
_rbk
;

110 
	g_t¡amp
 = 
rhs
.
_t¡amp
;

111 
	g_®l_loÿl
 = 
rhs
.
_®l_loÿl
;

112 
	g_d_Ãxt_o_id
 = 
rhs
.
_d_Ãxt_o_id
;

114 
	g_awh
 = 
rhs
.
_awh
;

115 
	g_acu¡
 = 
rhs
.
_acu¡
;

116 
	g_adi¡
 = 
rhs
.
_adi¡
;

118 
	gi
=0; i<
	grhs
.
	g_Ş_út
; i++) {

119 
	g™ems
[
i
] = 
rhs
.
™ems
[i];

122  (*
	gthis
);

127 
	gÃw_Üd”_šput_t
::
	$g‘_no_™em_šput
(
no_™em_nÜd_šput_t
& 
ªoš
)

129 
ªoš
.
_wh_id
 = _wh_id;

130 
ªoš
.
_d_id
 = _d_id;

131 
ªoš
.
_c_id
 = _c_id;

132 
ªoš
.
_Ş_út
 = _ol_cnt;

133 
ªoš
.
_rbk
 = _rbk;

135 
ªoš
.
_t¡amp
 = _tstamp;

136 
ªoš
.
_®l_loÿl
 = _all_local;

137 
ªoš
.
_d_Ãxt_o_id
 = _d_next_o_id;

138 
	}
}

141 
	gÃw_Üd”_šput_t
::
	$g‘_w™h_™em_šput
(
w™h_™em_nÜd_šput_t
& 
awš
,

142 cÚ¡ 
idx
)

144 
awš
.
_wh_id
 = _wh_id;

145 
awš
.
_d_id
 = _d_id;

146 
awš
.
_c_id
 = _c_id;

147 
awš
.
_Ş_út
 = _ol_cnt;

148 
awš
.
_rbk
 = _rbk;

150 
awš
.
_t¡amp
 = _tstamp;

151 
awš
.
_®l_loÿl
 = _all_local;

152 
awš
.
_d_Ãxt_o_id
 = _d_next_o_id;

154 
awš
.
_Ş_idx
 = 
idx
;

156 
awš
.
™em
 = 
™ems
[
idx
];

157 
	}
}

159 
	gno_™em_nÜd_šput_t
&

160 
	gno_™em_nÜd_šput_t
::
İ”©Ü
ğ(cÚ¡ 
no_™em_nÜd_šput_t
& 
rhs
)

163 
_wh_id
 = 
rhs
._wh_id;

164 
	g_d_id
 = 
rhs
.
_d_id
;

165 
	g_c_id
 = 
rhs
.
_c_id
;

166 
	g_Ş_út
 = 
rhs
.
_Ş_út
;

167 
	g_rbk
 = 
rhs
.
_rbk
;

169 
	g_t¡amp
 = 
rhs
.
_t¡amp
;

170 
	g_®l_loÿl
 = 
rhs
.
_®l_loÿl
;

171 
	g_d_Ãxt_o_id
 = 
rhs
.
_d_Ãxt_o_id
;

173  (*
	gthis
);

176 
	gw™h_™em_nÜd_šput_t
&

177 
	gw™h_™em_nÜd_šput_t
::
İ”©Ü
ğ(cÚ¡ 
w™h_™em_nÜd_šput_t
& 
rhs
)

180 
_wh_id
 = 
rhs
._wh_id;

181 
	g_d_id
 = 
rhs
.
_d_id
;

182 
	g_c_id
 = 
rhs
.
_c_id
;

183 
	g_Ş_út
 = 
rhs
.
_Ş_út
;

184 
	g_rbk
 = 
rhs
.
_rbk
;

186 
	g_t¡amp
 = 
rhs
.
_t¡amp
;

187 
	g_®l_loÿl
 = 
rhs
.
_®l_loÿl
;

188 
	g_d_Ãxt_o_id
 = 
rhs
.
_d_Ãxt_o_id
;

190 
	g_Ş_idx
 = 
rhs
.
_Ş_idx
;

192 
	g™em
 = 
rhs
.
™em
;

194  (*
	gthis
);

207 
Ãw_Üd”_šput_t
 
	$ü—‹_Ãw_Üd”_šput
(
sf
, 
¥ecificWH
)

210 
	`as£¹
 (
sf
>0);

213 
Ãw_Üd”_šput_t
 
noš
;

215 #iâdeà
USE_SAME_INPUT


217 if(
_chªge_lßd
) {

218 
noš
.
_wh_id
 = 
w_skew”
.
	`g‘_šput
();

220 ià(
¥ecificWH
>0)

221 
noš
.
_wh_id
 = 
¥ecificWH
;

223 
noš
.
_wh_id
 = 
	`URªd
(1, 
sf
);

226 
noš
.
_d_id
 = 
	`URªd
(1, 10);

227 
noš
.
_c_id
 = 
	`NURªd
(1023, 1, 3000);

228 
noš
.
_Ş_út
 = 
	`URªd
(5, 15);

229 
noš
.
_rbk
 = 
	`URªd
(1, 100);

231 
noš
.
_t¡amp
 = 
	`time
(
NULL
);

234 
i
=0; i<
noš
.
_Ş_út
; i++) {

235 
noš
.
™ems
[
i
].
_Ş_i_id
 = 
	`NURªd
(8191, 1, 100000);

236 
noš
.
™ems
[
i
].
_Ş_suµly_wh_£Ëù
 = 
	`URªd
(1, 100);

237 
noš
.
™ems
[
i
].
_Ş_quªt™y
 = 
	`URªd
(1, 10);

239 #iâdeà
USE_ONLY_LOCAL_WHS


240 ià(
noš
.
™ems
[
i
].
_Ş_suµly_wh_£Ëù
 == 1) {

242 
noš
.
™ems
[
i
].
_Ş_suµly_wh_id
 = 
	`URªd
(1, 
sf
);

243 ià(
noš
.
™ems
[
i
].
_Ş_suµly_wh_id
 !ğnoš.
_wh_id
)

244 
noš
.
_®l_loÿl
 = 0;

248 
noš
.
™ems
[
i
].
_Ş_suµly_wh_id
 =‚oš.
_wh_id
;

251 
noš
.
™ems
[
i
].
_Ş_suµly_wh_id
 =‚oš.
_wh_id
;

255 #iâdeà
USE_NO_NORD_INPUTS_FOR_ROLLBACK


256 ià(
noš
.
_rbk
 == 1) {

258 
noš
.
™ems
[noš.
_Ş_út
-1].
_Ş_i_id
 = -1;

259 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Bad input...\n");

266 
noš
.
_wh_id
 = 1;

267 
noš
.
_d_id
 = 2;

268 
noš
.
_c_id
 = 3;

269 
noš
.
_Ş_út
 = 10;

270 
noš
.
_rbk
 = 50;

273 
i
=0; i<
noš
.
_Ş_út
; i++) {

274 
noš
.
™ems
[
i
].
_Ş_i_id
 = 1;

275 
noš
.
™ems
[
i
].
_Ş_suµly_wh_£Ëù
 = 50;

276 
noš
.
™ems
[
i
].
_Ş_suµly_wh_id
 =‚oš.
_wh_id
;

277 
noš
.
™ems
[
i
].
_Ş_quªt™y
 = 5;

281  (
noš
);

283 
	}
};

292 
	g·ym’t_šput_t
&

293 
	g·ym’t_šput_t
::
İ”©Ü
ğ(cÚ¡ 
·ym’t_šput_t
& 
rhs
)

296 
_home_wh_id
 = 
rhs
._home_wh_id;

297 
	g_home_d_id
 = 
rhs
.
_home_d_id
;

298 
	g_v_cu¡_wh_£ËùiÚ
 = 
rhs
.
_v_cu¡_wh_£ËùiÚ
;

299 
	g_»mÙe_wh_id
 = 
rhs
.
_»mÙe_wh_id
;

300 
	g_»mÙe_d_id
 = 
rhs
.
_»mÙe_d_id
;

301 
	g_v_cu¡_id’t_£ËùiÚ
 = 
rhs
.
_v_cu¡_id’t_£ËùiÚ
;

302 
	g_c_id
 = 
rhs
.
_c_id
;

303 
	g_h_amouÁ
 = 
rhs
.
_h_amouÁ
;

305 ià(
	grhs
.
	g_c_Ï¡
) {

306 
¡Üe_¡ršg
(
_c_Ï¡
, 
rhs
._c_last);

309  (*
	gthis
);

323 
·ym’t_šput_t
 
	$ü—‹_·ym’t_šput
(
sf
, 
¥ecificWH
)

326 
	`as£¹
 (
sf
>0);

329 
·ym’t_šput_t
 
pš
;

331 #iâdeà
USE_SAME_INPUT


333 if(
_chªge_lßd
) {

334 
pš
.
_home_wh_id
 = 
w_skew”
.
	`g‘_šput
();

336 ià(
¥ecificWH
>0)

337 
pš
.
_home_wh_id
 = 
¥ecificWH
;

339 
pš
.
_home_wh_id
 = 
	`URªd
(1, 
sf
);

342 
pš
.
_home_d_id
 = 
	`URªd
(1, 10);

343 
pš
.
_h_amouÁ
 = ()
	`URªd
(100, 500000)/()100.00;

344 
pš
.
_h_d©e
 = 
	`time
(
NULL
);

346 #iâdeà
USE_ONLY_LOCAL_WHS


347 
pš
.
_v_cu¡_wh_£ËùiÚ
 = 
	`URªd
(1, 100);

348 ià(
pš
.
_v_cu¡_wh_£ËùiÚ
 <= 85) {

350 
pš
.
_»mÙe_wh_id
 =…š.
_home_wh_id
;

351 
pš
.
_»mÙe_d_id
 =…š.
_home_d_id
;

355 ià(
sf
 == 1) {

356 
pš
.
_»mÙe_wh_id
 = 1;

361 
pš
.
_»mÙe_wh_id
 = 
	`URªd
(1, 
sf
);

362 } 
pš
.
_home_wh_id
 =ğpš.
_»mÙe_wh_id
);

364 
pš
.
_»mÙe_d_id
 = 
	`URªd
(1, 10);

367 
pš
.
_v_cu¡_wh_£ËùiÚ
 = 50;

368 
pš
.
_»mÙe_wh_id
 =…š.
_home_wh_id
;

369 
pš
.
_»mÙe_d_id
 =…š.
_home_d_id
;

373 #ifdeà
USE_SAFE_PATHS


374 
pš
.
_v_cu¡_id’t_£ËùiÚ
 = 
	`URªd
(61, 100);

376 
pš
.
_v_cu¡_id’t_£ËùiÚ
 = 
	`URªd
(1, 100);

379 ià(
pš
.
_v_cu¡_id’t_£ËùiÚ
 <= 60) {

381 
	`g’”©e_cu¡_Ï¡
(
	`NURªd
(255,0,999), 
pš
.
_c_Ï¡
);

384 
pš
.
_c_id
 = 
	`NURªd
(1023, 1, 3000);

389 
pš
.
_home_wh_id
 = 1;

390 
pš
.
_home_d_id
 = 2;

391 
pš
.
_v_cu¡_wh_£ËùiÚ
 = 80;

392 
pš
.
_»mÙe_wh_id
 = 1;

393 
pš
.
_»mÙe_d_id
 = 3;

394 
pš
.
_v_cu¡_id’t_£ËùiÚ
 = 50;

395 
pš
.
_c_id
 = 1500;

397 
pš
.
_h_amouÁ
 = 1000.00;

398 
pš
.
_h_d©e
 = 
	`time
(
NULL
);

401  (
pš
);

403 
	}
};

411 
	gÜd”_¡©us_šput_t
&

412 
	gÜd”_¡©us_šput_t
::
İ”©Ü
ğ(cÚ¡ 
Üd”_¡©us_šput_t
& 
rhs
)

414 
_wh_id
 = 
rhs
._wh_id;

415 
	g_d_id
 = 
rhs
.
_d_id
;

416 
	g_c_£Ëù
 = 
rhs
.
_c_£Ëù
;

417 
	g_c_id
 = 
rhs
.
_c_id
;

419 
	g_o_id
 = 
rhs
.
_o_id
;

420 
	g_o_Ş_út
 = 
rhs
.
_o_Ş_út
;

422 ià(
	grhs
.
	g_c_Ï¡
) {

423 
¡Üe_¡ršg
(
_c_Ï¡
, 
rhs
._c_last);

426  (*
	gthis
);

440 
Üd”_¡©us_šput_t
 
	$ü—‹_Üd”_¡©us_šput
(
sf
, 
¥ecificWH
)

443 
	`as£¹
 (
sf
 > 0);

446 
Üd”_¡©us_šput_t
 
osš
;

448 #iâdeà
USE_SAME_INPUT


450 if(
_chªge_lßd
) {

451 
osš
.
_wh_id
 = 
w_skew”
.
	`g‘_šput
();

453 ià(
¥ecificWH
>0)

454 
osš
.
_wh_id
 = 
¥ecificWH
;

456 
osš
.
_wh_id
 = 
	`URªd
(1, 
sf
);

459 
osš
.
_d_id
 = 
	`URªd
(1, 10);

461 #ifdeà
USE_SAFE_PATHS


462 
osš
.
_c_£Ëù
 = 
	`URªd
(61, 100);

464 
osš
.
_c_£Ëù
 = 
	`URªd
(1, 100);

467 ià(
osš
.
_c_£Ëù
 <= 60) {

469 
	`g’”©e_cu¡_Ï¡
(
	`NURªd
(255,0,999), 
osš
.
_c_Ï¡
);

472 
osš
.
_c_id
 = 
	`NURªd
(1023, 1, 3000);

477 
osš
.
_wh_id
 = 1;

478 
osš
.
_d_id
 = 2;

479 
osš
.
_c_£Ëù
 = 80;

480 
osš
.
_c_id
 = 3;

484  (
osš
);

486 
	}
};

494 
	gd–iv”y_šput_t
&

495 
	gd–iv”y_šput_t
::
İ”©Ü
ğ(cÚ¡ 
d–iv”y_šput_t
& 
rhs
)

497 
_wh_id
 = 
rhs
._wh_id;

498 
	g_ÿ¼›r_id
 = 
rhs
.
_ÿ¼›r_id
;

500  (*
	gthis
);

514 
d–iv”y_šput_t
 
	$ü—‹_d–iv”y_šput
(
sf
, 
¥ecificWH
)

517 
	`as£¹
 (
sf
 > 0);

520 
d–iv”y_šput_t
 
dš
;

522 #iâdeà
USE_SAME_INPUT


524 if(
_chªge_lßd
) {

525 
dš
.
_wh_id
 = 
w_skew”
.
	`g‘_šput
();

527 ià(
¥ecificWH
>0)

528 
dš
.
_wh_id
 = 
¥ecificWH
;

530 
dš
.
_wh_id
 = 
	`URªd
(1, 
sf
);

533 
dš
.
_ÿ¼›r_id
 = 
	`URªd
(1, 10);

537 
dš
.
_wh_id
 = 1;

538 
dš
.
_ÿ¼›r_id
 = 1;

541  (
dš
);

543 
	}
};

551 
	g¡ock_Ëv–_šput_t
&

552 
	g¡ock_Ëv–_šput_t
::
İ”©Ü
ğ(cÚ¡ 
¡ock_Ëv–_šput_t
& 
rhs
)

554 
_wh_id
 = 
rhs
._wh_id;

555 
	g_d_id
 = 
rhs
.
_d_id
;

556 
	g_th»shŞd
 = 
rhs
.
_th»shŞd
;

558 
	g_Ãxt_o_id
 = 
rhs
.
_Ãxt_o_id
;

559 
	g_o_Ş_út
 = 
rhs
.
_o_Ş_út
;

560 
	g_pvwi
 = 
rhs
.
_pvwi
;

562  (*
	gthis
);

575 
¡ock_Ëv–_šput_t
 
	$ü—‹_¡ock_Ëv–_šput
(
sf
, 
¥ecificWH
)

578 
	`as£¹
 (
sf
 > 0);

581 
¡ock_Ëv–_šput_t
 
¦š
;

583 #iâdeà
USE_SAME_INPUT


585 if(
_chªge_lßd
) {

586 
¦š
.
_wh_id
 = 
w_skew”
.
	`g‘_šput
();

588 ià(
¥ecificWH
>0)

589 
¦š
.
_wh_id
 = 
¥ecificWH
;

591 
¦š
.
_wh_id
 = 
	`URªd
(1, 
sf
);

594 
¦š
.
_d_id
 = 
	`URªd
(1, 10);

595 
¦š
.
_th»shŞd
 = 
	`URªd
(10, 20);

599 
¦š
.
_wh_id
 = 1;

600 
¦š
.
_d_id
 = 2;

601 
¦š
.
_th»shŞd
 = 15;

604  (
¦š
);

606 
	}
};

614 
	gmb’ch_wh_šput_t
&

615 
	gmb’ch_wh_šput_t
::
İ”©Ü
ğ(cÚ¡ 
mb’ch_wh_šput_t
& 
rhs
)

617 
_wh_id
 = 
rhs
._wh_id;

618 
	g_amouÁ
 = 
rhs
.
_amouÁ
;

619  (*
	gthis
);

633 
mb’ch_wh_šput_t
 
	$ü—‹_mb’ch_wh_šput
(
sf
, 
¥ecificWH
)

636 
	`as£¹
 (
sf
 > 0);

638 
mb’ch_wh_šput_t
 
mwš
;

640 #iâdeà
USE_SAME_INPUT


642 ià(
¥ecificWH
>0)

643 
mwš
.
_wh_id
 = 
¥ecificWH
;

645 
mwš
.
_wh_id
 = 
	`URªd
(1, 
sf
);

647 
mwš
.
_amouÁ
 = ()
	`URªd
(1,1000);

651 
mwš
.
_wh_id
 = 1;

652 
mwš
.
_amouÁ
 = 150;

655  (
mwš
);

657 
	}
};

665 
	gmb’ch_cu¡_šput_t
&

666 
	gmb’ch_cu¡_šput_t
::
İ”©Ü
ğ(cÚ¡ 
mb’ch_cu¡_šput_t
& 
rhs
)

668 
_wh_id
 = 
rhs
._wh_id;

669 
	g_d_id
 = 
rhs
.
_d_id
;

670 
	g_c_id
 = 
rhs
.
_c_id
;

671 
	g_amouÁ
 = 
rhs
.
_amouÁ
;

672  (*
	gthis
);

688 
mb’ch_cu¡_šput_t
 
	$ü—‹_mb’ch_cu¡_šput
(
sf
, 
¥ecificWH
)

691 
	`as£¹
 (
sf
 > 0);

693 
mb’ch_cu¡_šput_t
 
mcš
;

695 #iâdeà
USE_SAME_INPUT


697 ià(
¥ecificWH
>0)

698 
mcš
.
_wh_id
 = 
¥ecificWH
;

700 
mcš
.
_wh_id
 = 
	`URªd
(1, 
sf
);

702 
mcš
.
_d_id
 = 
	`URªd
(1,10);

703 
mcš
.
_c_id
 = 
	`NURªd
(1023,1,3000);

704 
mcš
.
_amouÁ
 = ()
	`URªd
(1,1000);

708 
mcš
.
_wh_id
 = 1;

709 
mcš
.
_d_id
 = 2;

710 
mcš
.
_c_id
 = 3;

711 
mcš
.
_amouÁ
 = 15;

714  (
mcš
);

716 
	}
};

720 
EXIT_NAMESPACE
(
cc
);

	@src/workload/tpcc/tpcc_random.cpp

33 
	~"wÜklßd/cc/cc_¿ndom.h
"

34 
	~"wÜklßd/cc/cc_cÚ¡.h
"

37 
ENTER_NAMESPACE
(
cc
);

62 
	$¿ndom
(
low
, 
high
, 
¿ndg’_t
* 
½
) {

64  (
low
 + 
½
->
	`¿nd
(
high
 -†ow + 1));

65 
	}
}

73 
	$URªd
(
low
, 
high
)

75 
th»ad_t
* 
£lf
 = 
	`th»ad_g‘_£lf
();

76 
	`as£¹
 (
£lf
);

77 
¿ndg’_t
* 
¿ndg’p
 = 
£lf
->
	`¿ndg’
();

78 
	`as£¹
 (
¿ndg’p
);

80 
d
 = 
high
 - 
low
 + 1;

90  (
low
 + 
¿ndg’p
->
	`¿nd
(
d
));

91 
	}
}

99 
	$NURªd
(
A
, 
low
, 
high
)

101 
th»ad_t
* 
£lf
 = 
	`th»ad_g‘_£lf
();

102 
	`as£¹
 (
£lf
);

103 
¿ndg’_t
* 
¿ndg’p
 = 
£lf
->
	`¿ndg’
();

104 
	`as£¹
 (
¿ndg’p
);

106  ( (((
	`¿ndom
(0, 
A
, 
¿ndg’p
è|„ªdom(
low
, 
high
,„andgenp))

107 + 
	`¿ndom
(0, 
A
, 
¿ndg’p
))

108 % (
high
 - 
low
 + 1)) +†ow );

109 
	}
}

137 cÚ¡ * 
	gCUST_LAST
[10] = { "BAR", "OUGHT", "ABLE", "PRI", "PRES", "ESE",

141 
	$g’”©e_cu¡_Ï¡
(
£Ëù
, * 
de¡
)

143 
	`as£¹
 ((
£Ëù
>=0) && (select<1000));

144 
	`as£¹
 (
de¡
);

146 
i1
, 
i2
, 
i3
;

148 
i3
 = 
£Ëù
 % 10;

149 
i2
 = ((
£Ëù
 % 100è- 
i3
) / 10;

150 
i1
 = (
£Ëù
 - (select % 100)) / 100;

152 
iL’
 = ()(
	`¡¾’
(
CUST_LAST
[
i1
]è+ sŒËn(CUST_LAST[
i2
]è+ sŒËn(CUST_LAST[
i3
]) + 1);

154 
	`as£¹
 (
iL’
 < 17);

156 
	`¢´štf
(
de¡
, 
iL’
, "%s%s%s",

157 
CUST_LAST
[
i1
],

158 
CUST_LAST
[
i2
],

159 
CUST_LAST
[
i3
]);

160 
de¡
[
iL’
] = '\0';

162  (
iL’
);

163 
	}
}

177 
	$¿ndom_xù_ty³
(
£Ëùed
)

179 
¿ndom_ty³
 = 
£Ëùed
;

180 ià(
¿ndom_ty³
 < 0)

181 
¿ndom_ty³
 = 
	`¿nd
()%100;

182 
	`as£¹
 (
¿ndom_ty³
 >= 0);

184 
sum
 = 0;

185 
sum
+=
PROB_NEWORDER
;

186 ià(
¿ndom_ty³
 < 
sum
)

187  
XCT_NEW_ORDER
;

189 
sum
+=
PROB_PAYMENT
;

190 ià(
¿ndom_ty³
 < 
sum
)

191  
XCT_PAYMENT
;

193 
sum
+=
PROB_ORDER_STATUS
;

194 ià(
¿ndom_ty³
 < 
sum
)

195  
XCT_ORDER_STATUS
;

197 
sum
+=
PROB_DELIVERY
;

198 ià(
¿ndom_ty³
 < 
sum
) {

199 #w¬nšg 
Di§blšg
 
D–iv”y
 
äom
 
the
 
TPC
-
C
 
Mix
. 
RuÂšg
 
Paym’t
 
š¡—d


200  
XCT_PAYMENT
;

204 
sum
+=
PROB_STOCK_LEVEL
;

205 ià(
¿ndom_ty³
 < 
sum
)

206  
XCT_STOCK_LEVEL
;

207 
	}
}

210 
EXIT_NAMESPACE
(
cc
);

	@src/workload/tpce/egen/AddressTable.cpp

37 
	~"wÜklßd/û/eg’/EG’TabËs_¡dafx.h
"

39 
usšg
 
Çme¥aû
 
	gTPCE
;

41 cÚ¡ 
UINT
 
	giUSACŒyCode
 = 1;

42 cÚ¡ 
UINT
 
	giCªadaCŒyCode
 = 2;

45 cÚ¡ 
	giSŒ“tNumb”Mš
 = 100;

46 cÚ¡ 
	giSŒ“tNumb”Max
 = 25000;

49 cÚ¡ 
	giPùCu¡om”sW™hNuÎAD_LINE_2
 = 60;

53 cÚ¡ 
	giPùCu¡om”sW™hA±AD_LINE_2
 = 75;

56 cÚ¡ 
	giA·¹m’tNumb”Mš
 = 1;

57 cÚ¡ 
	giA·¹m’tNumb”Max
 = 1000;

60 cÚ¡ 
	giSu™eNumb”Mš
 = 1;

61 cÚ¡ 
	giSu™eNumb”Max
 = 500;

65 cÚ¡ 
	giRNGSkOÃRowAdd»ss
 = 10;

80 
	gCAdd»ssTabË
::
	$CAdd»ssTabË
(
CIÅutFes
 
šputFes
,

81 
TId’t
 
iCu¡om”CouÁ
,

82 
TId’t
 
iS¹FromCu¡om”
,

83 
boŞ
 
bCu¡om”Add»s£sOÆy
,

84 
boŞ
 
bCacheEÇbËd


86 : 
TabËTem¶©e
<
ADDRESS_ROW
>()

87 , 
	`m_com·n›s
(
šputFes
.
Com·ny
)

88 , 
	`m_SŒ“t
(
šputFes
.
SŒ“t
)

89 , 
	`m_SŒ“tSuffix
(
šputFes
.
SŒ“tSuffix
)

90 , 
	`m_ZCode
(
šputFes
.
ZCode
)

91 , 
	`m_iS¹FromCu¡om”
(
iS¹FromCu¡om”
)

92 , 
	`m_iCu¡om”CouÁ
(
iCu¡om”CouÁ
)

93 , 
	`m_bCu¡om”Add»s£sOÆy
(
bCu¡om”Add»s£sOÆy
)

94 , 
	`m_bCu¡om”Add»ss
(
bCu¡om”Add»s£sOÆy
)

95 , 
	$m_bCacheEÇbËd
(
bCacheEÇbËd
)

97 
m_iExchªgeCouÁ
 = 
šputFes
.
Exchªge
->
	`G‘Size
();

98 
m_iCom·nyCouÁ
 = 
m_com·n›s
->
	`G‘CÚfigu»dCom·nyCouÁ
();

101 ià(
bCu¡om”Add»s£sOÆy
)

104 
m_iLa¡RowNumb”
 = 
m_iExchªgeCouÁ
 + 
m_iCom·nyCouÁ
 + 
iS¹FromCu¡om”
 - 1;

108 
m_iTÙ®Add»ssCouÁ
 = 
m_iLa¡RowNumb”
 + 
m_iCu¡om”CouÁ
;

112 
m_iLa¡RowNumb”
 = 
iS¹FromCu¡om”
 - 1;

116 
m_iTÙ®Add»ssCouÁ
 = 
m_iLa¡RowNumb”
 + 
m_iCu¡om”CouÁ
 + 
m_iExchªgeCouÁ
 + 
m_iCom·nyCouÁ
;

119 
m_row
.
AD_ID
 = 
m_iLa¡RowNumb”
 + 
iTId’tShiá
;

121 ià(
m_bCacheEÇbËd
)

123 
m_iCacheSize
 = ()
iDeçuÉLßdUn™Size
;

124 
m_iCacheOff£t
 = 
iTId’tShiá
 + 
m_iExchªgeCouÁ
 + 
m_iCom·nyCouÁ
 + 
m_iS¹FromCu¡om”
;

125 
m_CacheZCode
 = 
Ãw
 cÚ¡ 
TZCodeIÅutRow
* [
m_iCacheSize
];

126 
i
=0; i<
m_iCacheSize
; i++)

128 
m_CacheZCode
[
i
] = 
NULL
;

131 
	}
}

133 
	gCAdd»ssTabË
::~
	$CAdd»ssTabË
()

135 ià(
m_bCacheEÇbËd
)

137 
d–‘e
[] 
m_CacheZCode
;

139 
	}
}

150 
	gCAdd»ssTabË
::
	$In™NextLßdUn™
()

152 
m_ºd
.
	`S‘S“d
(m_ºd.
	`RndNthEËm’t
(
RNGS“dTabËDeçuÉ
,

153 (
RNGSEED
)
m_iLa¡RowNumb”
 *

154 
iRNGSkOÃRowAdd»ss
));

156 
	`CË¬RecÜd
();

158 ià(
m_bCacheEÇbËd
)

160 
m_iCacheOff£t
 +ğ
iDeçuÉLßdUn™Size
;

161 
i
=0; i<
m_iCacheSize
; i++)

163 
m_CacheZCode
[
i
] = 
NULL
;

166 
	}
}

180 
TId’t
 
	gCAdd»ssTabË
::
	$G’”©eNextAD_ID
()

184 iàĞ
m_iLa¡RowNumb”
 > (
m_iExchªgeCouÁ
 + 
m_iCom·nyCouÁ
)

185 && ( (
m_iLa¡RowNumb”
 - (
m_iExchªgeCouÁ
 + 
m_iCom·nyCouÁ
èè% 
iDeçuÉLßdUn™Size
 == 0))

187 
	`In™NextLßdUn™
();

190 ++
m_iLa¡RowNumb”
;

194 
m_bCu¡om”Add»ss
 = 
m_iLa¡RowNumb”
 >ğ
m_iExchªgeCouÁ
 + 
m_iCom·nyCouÁ
;

197 
m_bMÜeRecÜds
 = 
m_iLa¡RowNumb”
 < 
m_iTÙ®Add»ssCouÁ
;

199 
m_row
.
AD_ID
 = 
m_iLa¡RowNumb”
 + 
iTId’tShiá
;

201  
m_row
.
AD_ID
;

202 
	}
}

213 
TId’t
 
	gCAdd»ssTabË
::
	$G‘AD_IDFÜCu¡om”
(
TId’t
 
C_ID
)

215  
m_iExchªgeCouÁ
 + 
m_iCom·nyCouÁ
 + 
C_ID
;

216 
	}
}

228 
	gCAdd»ssTabË
::
	$G’”©eAD_LINE_1
()

230 
iSŒ“tNum
 = 
m_ºd
.
	`RndIÁRªge
(
iSŒ“tNumb”Mš
, 
iSŒ“tNumb”Max
);

231 
iSŒ“tTh»shŞd
 = 
m_ºd
.
	`RndIÁRªge
(0, 
m_SŒ“t
->
	`G‘G»©e¡Key
()-2);

232 
iSŒ“tSuffixTh»shŞd
 = 
m_ºd
.
	`RndIÁRªge
(0, 
m_SŒ“tSuffix
->
	`G‘G»©e¡Key
()-1);

234 
	`¢´štf
(
m_row
.
AD_LINE1
, (m_row.AD_LINE1), "%d %s %s",

235 
iSŒ“tNum
,

236 (
m_SŒ“t
->
	`G‘RecÜd
(
iSŒ“tTh»shŞd
))->
STREET
,

237 (
m_SŒ“tSuffix
->
	`G‘RecÜd
(
iSŒ“tSuffixTh»shŞd
))->
SUFFIX
);

238 
	}
}

250 
	gCAdd»ssTabË
::
	$G’”©eAD_LINE_2
()

252 ià(!
m_bCu¡om”Add»ss
 || 
m_ºd
.
	`RndP”ûÁ
(
iPùCu¡om”sW™hNuÎAD_LINE_2
))

254 
m_row
.
AD_LINE2
[0] = '\0';

258 ià(
m_ºd
.
	`RndP”ûÁ
(
iPùCu¡om”sW™hA±AD_LINE_2
))

260 
	`¢´štf
(
m_row
.
AD_LINE2
, (m_row.AD_LINE2),

261 "A±. %d", 
m_ºd
.
	`RndIÁRªge
(
iA·¹m’tNumb”Mš
, 
iA·¹m’tNumb”Max
));

265 
	`¢´štf
(
m_row
.
AD_LINE2
, (m_row.AD_LINE2),

266 "Su™%d", 
m_ºd
.
	`RndIÁRªge
(
iSu™eNumb”Mš
, 
iSu™eNumb”Max
));

269 
	}
}

282 
	gCAdd»ssTabË
::
	$G‘TownDivisiÚZCodeTh»shŞd
(
TId’t
 
ADID
)

284 
RNGSEED
 
OldS“d
;

285 
iTh»shŞd
;

287 
OldS“d
 = 
m_ºd
.
	`G‘S“d
();

288 
m_ºd
.
	`S‘S“d
Ğm_ºd.
	`RndNthEËm’t
Ğ
RNGS“dBa£TownDivZ
, (
RNGSEED
)
ADID
 ));

289 
iTh»shŞd
 = 
m_ºd
.
	`RndIÁRªge
(0, 
m_ZCode
->
	`G‘G»©e¡Key
()-1);

290 
m_ºd
.
	`S‘S“d
Ğ
OldS“d
 );

291 Ğ
iTh»shŞd
 );

292 
	}
}

303 
UINT
 
	gCAdd»ssTabË
::
	$G‘CouÁryCode
ĞcÚ¡ *
szZCode
 )

305 if(Ğ'0' <ğ
szZCode
[0] )&&( szZipCode[0] <= '9' ))

308 Ğ
iUSACŒyCode
 );

313 Ğ
iCªadaCŒyCode
 );

315 
	}
}

329 
	gCAdd»ssTabË
::
	$G‘DivisiÚAndCouÁryCodesFÜAdd»ss
(
TId’t
 
AD_ID
, 
UINT
 &
iDivCode
, UINT &
iCŒyCode
)

331 cÚ¡ 
TZCodeIÅutRow
* 
pZCodeIÅutRow
 = 
NULL
;

336 
TId’t
 
šdex
 = 
AD_ID
 - 
m_iCacheOff£t
;

337 
boŞ
 
bCheckCache
 = (
šdex
 >ğ0 && index <ğ
m_iCacheSize
);

338 ià(
m_bCacheEÇbËd
 && 
bCheckCache
)

340 
pZCodeIÅutRow
 = 
m_CacheZCode
[
šdex
];

343 ià(
pZCodeIÅutRow
 =ğ
NULL
)

345 
iTh»shŞd
 = 
	`G‘TownDivisiÚZCodeTh»shŞd
(
AD_ID
);

347 
pZCodeIÅutRow
 = 
m_ZCode
->
	`G‘RecÜd
(
iTh»shŞd
);

348 ià(
m_bCacheEÇbËd
 && 
bCheckCache
)

350 
m_CacheZCode
[
šdex
] = 
pZCodeIÅutRow
;

355 
iDivCode
 = 
pZCodeIÅutRow
->
iDivisiÚTaxKey
;

356 
iCŒyCode
 = 
	`G‘CouÁryCode
Ğ
pZCodeIÅutRow
->
ZC_CODE
 );

357 
	}
}

370 
	gCAdd»ssTabË
::
	$G’”©eAD_ZC_CODE_CTRY
()

372 
iTh»shŞd
;

373 cÚ¡ 
TZCodeIÅutRow
* 
pZCodeIÅutRow
;

375 
iTh»shŞd
 = 
	`G‘TownDivisiÚZCodeTh»shŞd
(
m_row
.
AD_ID
);

377 
pZCodeIÅutRow
 = 
m_ZCode
->
	`G‘RecÜd
(
iTh»shŞd
);

379 
	`¡ºıy
Ğ
m_row
.
AD_ZC_CODE
, 
pZCodeIÅutRow
->
ZC_CODE
, ( m_row.AD_ZC_CODE ) );

381 ifĞ
iUSACŒyCode
 =ğ
	`G‘CouÁryCode
Ğ
pZCodeIÅutRow
->
ZC_CODE
 ))

383 
	`¡ºıy
(
m_row
.
AD_CTRY
, "USA", (m_row.AD_CTRY));

387 
	`¡ºıy
(
m_row
.
AD_CTRY
, "CANADA", (m_row.AD_CTRY));

389 
	}
}

402 
boŞ
 
	gCAdd»ssTabË
::
	$G’”©eNextRecÜd
()

404 
	`G’”©eNextAD_ID
();

405 
	`G’”©eAD_LINE_1
();

406 
	`G’”©eAD_LINE_2
();

407 
	`G’”©eAD_ZC_CODE_CTRY
();

410  (
	`MÜeRecÜds
());

411 
	}
}

	@src/workload/tpce/egen/BaseLogger.cpp

41 
	~<io¡»am
>

42 
	~<s¡»am
>

44 
	~"wÜklßd/û/eg’/EG’Snd¬dTy³s.h
"

45 
	~"wÜklßd/û/eg’/Driv”Ty³s.h
"

46 
	~"wÜklßd/û/eg’/Driv”P¬amS‘tšgs.h
"

47 
	~"wÜklßd/û/eg’/Ba£Logg”.h
"

48 
	~"wÜklßd/û/eg’/Ba£LogFÜm©‹r.h
"

50 
usšg
 
Çme¥aû
 
	gTPCE
;

52 
	gTPCE
::
szDriv”Ty³Names
[
eDriv”Max
][14] =

62 
	gCBa£Logg”
::
	$CBa£Logg”
(
eDriv”Ty³
 
drvTy³
, 
INT32
 
UniqueId
, 
CBa£LogFÜm©‹r
* 
pFÜm©‹r
)

63 : 
	$m_pLogFÜm©‹r
Ğ
pFÜm©‹r
 )

65 
m_V”siÚ
[32];

68 
	`G‘EG’V”siÚSŒšg
(
m_V”siÚ
, (m_Version));

71 
	`¢´štf
(&
m_P»fix
[0], (m_Prefix), "%s (%s) %d",

72 
szDriv”Ty³Names
[
drvTy³
], 
m_V”siÚ
, 
UniqueId
);

73 
	}
}

76 
boŞ
 
	gCBa£Logg”
::
	$S’dToLogg”
(cÚ¡ *
szP»fix
, cÚ¡ *
szMsg
)

78 
CD©eTime
 
curTime
;

79  
	`S’dToLogg”Im¶
(
szP»fix
, 
curTime
.
	`ToSŒ
(12), 
szMsg
);

80 
	}
}

83 
boŞ
 
	gCBa£Logg”
::
	$S’dToLogg”
(cÚ¡ *
¡r
)

85  
	`S’dToLogg”
(
m_P»fix
, 
¡r
);

86 
	}
}

87 
boŞ
 
	gCBa£Logg”
::
	$S’dToLogg”
(
¡ršg
 
¡r
)

89  
	`S’dToLogg”
(
¡r
.
	`c_¡r
());

90 
	}
}

93 
boŞ
 
	gCBa£Logg”
::
	$S’dToLogg”
(
CLßd”S‘tšgs
& 
·rms
)

95  
	`S’dToLogg”
(
m_pLogFÜm©‹r
->
	`G‘LogOuut
(
·rms
));

96 
	}
}

97 
boŞ
 
	gCBa£Logg”
::
	$S’dToLogg”
(
CDriv”Glob®S‘tšgs
& 
·rms
)

99  
	`S’dToLogg”
(
m_pLogFÜm©‹r
->
	`G‘LogOuut
(
·rms
));

100 
	}
}

102 
boŞ
 
	gCBa£Logg”
::
	$S’dToLogg”
(
CDriv”CES‘tšgs
& 
·rms
)

104  
	`S’dToLogg”
(
m_pLogFÜm©‹r
->
	`G‘LogOuut
(
·rms
));

105 
	}
}

107 
boŞ
 
	gCBa£Logg”
::
	$S’dToLogg”
(
CDriv”CEP¬t™iÚS‘tšgs
& 
·rms
)

109  
	`S’dToLogg”
(
m_pLogFÜm©‹r
->
	`G‘LogOuut
(
·rms
));

110 
	}
}

112 
boŞ
 
	gCBa£Logg”
::
	$S’dToLogg”
(
CDriv”MEES‘tšgs
& 
·rms
)

114  
	`S’dToLogg”
(
m_pLogFÜm©‹r
->
	`G‘LogOuut
(
·rms
));

115 
	}
}

117 
boŞ
 
	gCBa£Logg”
::
	$S’dToLogg”
(
CDriv”DMS‘tšgs
& 
·rms
)

119  
	`S’dToLogg”
(
m_pLogFÜm©‹r
->
	`G‘LogOuut
(
·rms
));

120 
	}
}

122 
boŞ
 
	gCBa£Logg”
::
	$S’dToLogg”
(
CBrok”VŞumeS‘tšgs
& 
·rms
)

124  
	`S’dToLogg”
(
m_pLogFÜm©‹r
->
	`G‘LogOuut
(
·rms
));

125 
	}
}

127 
boŞ
 
	gCBa£Logg”
::
	$S’dToLogg”
(
CCu¡om”Pos™iÚS‘tšgs
& 
·rms
)

129  
	`S’dToLogg”
(
m_pLogFÜm©‹r
->
	`G‘LogOuut
(
·rms
));

130 
	}
}

132 
boŞ
 
	gCBa£Logg”
::
	$S’dToLogg”
(
CM¬k‘W©chS‘tšgs
& 
·rms
)

134  
	`S’dToLogg”
(
m_pLogFÜm©‹r
->
	`G‘LogOuut
(
·rms
));

135 
	}
}

137 
boŞ
 
	gCBa£Logg”
::
	$S’dToLogg”
(
CSecur™yD‘aS‘tšgs
& 
·rms
)

139  
	`S’dToLogg”
(
m_pLogFÜm©‹r
->
	`G‘LogOuut
(
·rms
));

140 
	}
}

142 
boŞ
 
	gCBa£Logg”
::
	$S’dToLogg”
(
CT¿deLookupS‘tšgs
& 
·rms
)

144  
	`S’dToLogg”
(
m_pLogFÜm©‹r
->
	`G‘LogOuut
(
·rms
));

145 
	}
}

147 
boŞ
 
	gCBa£Logg”
::
	$S’dToLogg”
(
CT¿deOrd”S‘tšgs
& 
·rms
)

149  
	`S’dToLogg”
(
m_pLogFÜm©‹r
->
	`G‘LogOuut
(
·rms
));

150 
	}
}

152 
boŞ
 
	gCBa£Logg”
::
	$S’dToLogg”
(
CT¿deUpd©eS‘tšgs
& 
·rms
)

154  
	`S’dToLogg”
(
m_pLogFÜm©‹r
->
	`G‘LogOuut
(
·rms
));

155 
	}
}

157 
boŞ
 
	gCBa£Logg”
::
	$S’dToLogg”
(
CTxnMixG’”©ÜS‘tšgs
& 
·rms
)

159  
	`S’dToLogg”
(
m_pLogFÜm©‹r
->
	`G‘LogOuut
(
·rms
));

160 
	}
}

162 
boŞ
 
	gCBa£Logg”
::
	$S’dToLogg”
(
TDriv”CETxnS‘tšgs
& 
·rms
)

164 
boŞ
 
»suÉ
 = 
çl£
;

166 
»suÉ
 |ğ
	`S’dToLogg”
(
m_pLogFÜm©‹r
->
	`G‘LogOuut
(
·rms
.
BV_£‰šgs
));

167 
»suÉ
 |ğ
	`S’dToLogg”
(
m_pLogFÜm©‹r
->
	`G‘LogOuut
(
·rms
.
CP_£‰šgs
));

168 
»suÉ
 |ğ
	`S’dToLogg”
(
m_pLogFÜm©‹r
->
	`G‘LogOuut
(
·rms
.
MW_£‰šgs
));

169 
»suÉ
 |ğ
	`S’dToLogg”
(
m_pLogFÜm©‹r
->
	`G‘LogOuut
(
·rms
.
SD_£‰šgs
));

170 
»suÉ
 |ğ
	`S’dToLogg”
(
m_pLogFÜm©‹r
->
	`G‘LogOuut
(
·rms
.
TL_£‰šgs
));

171 
»suÉ
 |ğ
	`S’dToLogg”
(
m_pLogFÜm©‹r
->
	`G‘LogOuut
(
·rms
.
TO_£‰šgs
));

172 
»suÉ
 |ğ
	`S’dToLogg”
(
m_pLogFÜm©‹r
->
	`G‘LogOuut
(
·rms
.
TU_£‰šgs
));

173 
»suÉ
 |ğ
	`S’dToLogg”
(
m_pLogFÜm©‹r
->
	`G‘LogOuut
(
·rms
.
TxnMixG’”©Ü_£‰šgs
));

175  
»suÉ
;

176 
	}
}

	@src/workload/tpce/egen/CE.cpp

42 
	~"wÜklßd/û/eg’/CE.h
"

44 
usšg
 
Çme¥aû
 
	gTPCE
;

47 
	gCCE
::
	$In™Ÿlize
Ğ
PDriv”CETxnS‘tšgs
 
pTxnP¬amS‘tšgs
 )

49 
m_pLogg”
->
	`S’dToLogg”
(
m_Driv”Glob®S‘tšgs
);

53 ifĞ
pTxnP¬amS‘tšgs
 )

55 
	`S‘TxnTuÇbËs
Ğ
pTxnP¬amS‘tšgs
 );

59 
	`S‘TxnTuÇbËs
Ğ&
m_Driv”CETxnS‘tšgs
 );

61 
	}
}

78 
	gCCE
::
	$AutoS‘RNGS“ds
Ğ
UINT32
 
UniqueId
 )

80 
CD©eTime
 
Now
;

81 
INT32
 
Ba£Y—r
;

82 
INT32
 
Tmp1
, 
Tmp2
;

84 
Now
.
	`G‘YMD
Ğ&
Ba£Y—r
, &
Tmp1
, &
Tmp2
 );

87 
Ba£Y—r
 -= ( BaseYear % 5 );

88 
CD©eTime
 
	`Ba£
Ğ
Ba£Y—r
, 1, 1 );

92 
RNGSEED
 
S“d
;

93 
S“d
 = 
Now
.
	`MSec
() / 100;

98 
S“d
 <<= 11;

99 
S“d
 +ğ(
RNGSEED
)((
INT64
)
Now
.
	`DayNo
(è- (INT64)
Ba£
.DayNo());

105 
S“d
 <<= 33;

109 
S“d
 +ğ
UniqueId
;

112 
m_TxnMixG’”©Ü
.
	`S‘RNGS“d
Ğ
S“d
 );

113 
m_Driv”CES‘tšgs
.
cur
.
TxnMixRNGS“d
 = 
S“d
;

116 
S“d
 |ğ
	`UINT64_CONST
(0x0000000100000000);

117 
m_TxnIÅutG’”©Ü
.
	`S‘RNGS“d
Ğ
S“d
 );

118 
m_Driv”CES‘tšgs
.
cur
.
TxnIÅutRNGS“d
 = 
S“d
;

119 
	}
}

127 
	gCCE
::
	$CCE
Ğ
CCESUTIÁ”çû
 *
pSUT
, 
CBa£Logg”
 *
pLogg”
, cÚ¡ 
CIÅutFes
 &
šputFes
,

128 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
,

129 
INT32
 
iSÿËFaùÜ
, INT32 
iDaysOfIn™ŸlT¿des
,

130 
UINT32
 
UniqueId
,

131 cÚ¡ 
PDriv”CETxnS‘tšgs
 
pDriv”CETxnS‘tšgs
 )

132 : 
	`m_Driv”Glob®S‘tšgs
Ğ
iCÚfigu»dCu¡om”CouÁ
, 
iAùiveCu¡om”CouÁ
, 
iSÿËFaùÜ
, 
iDaysOfIn™ŸlT¿des
 )

133 , 
	`m_Driv”CES‘tšgs
Ğ
UniqueId
, 0, 0 )

134 , 
	`m_pSUT
Ğ
pSUT
 )

135 , 
	`m_pLogg”
 ( 
pLogg”
 )

136 , 
	`m_TxnMixG’”©Ü
Ğ&
m_Driv”CETxnS‘tšgs
, 
m_pLogg”
 )

137 , 
	`m_TxnIÅutG’”©Ü
Ğ
šputFes
, 
iCÚfigu»dCu¡om”CouÁ
, 
iAùiveCu¡om”CouÁ
, 
iSÿËFaùÜ
, 
iDaysOfIn™ŸlT¿des
 * 
HoursP”WÜkDay
, 
m_pLogg”
, &
m_Driv”CETxnS‘tšgs
 )

138 , 
	$m_bCË¬BufãrBefÜeG’”©iÚ
(
çl£
)

140 
m_pLogg”
->
	`S’dToLogg”
("CE object constructed using constructor 1 (valid for…ublication: YES).");

142 
	`In™Ÿlize
Ğ
pDriv”CETxnS‘tšgs
 );

143 
	`AutoS‘RNGS“ds
Ğ
UniqueId
 );

145 
m_pLogg”
->
	`S’dToLogg”
(
m_Driv”CES‘tšgs
);

146 
	}
}

151 
	gCCE
::
	$CCE
Ğ
CCESUTIÁ”çû
 *
pSUT
, 
CBa£Logg”
 *
pLogg”
, cÚ¡ 
CIÅutFes
 &
šputFes
,

152 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
,

153 
INT32
 
iSÿËFaùÜ
, INT32 
iDaysOfIn™ŸlT¿des
,

154 
UINT32
 
UniqueId
,

155 
RNGSEED
 
TxnMixRNGS“d
,

156 
RNGSEED
 
TxnIÅutRNGS“d
,

157 cÚ¡ 
PDriv”CETxnS‘tšgs
 
pDriv”CETxnS‘tšgs
 )

158 : 
	`m_Driv”Glob®S‘tšgs
Ğ
iCÚfigu»dCu¡om”CouÁ
, 
iAùiveCu¡om”CouÁ
, 
iSÿËFaùÜ
, 
iDaysOfIn™ŸlT¿des
 )

159 , 
	`m_Driv”CES‘tšgs
Ğ
UniqueId
, 
TxnMixRNGS“d
, 
TxnIÅutRNGS“d
 )

160 , 
	`m_pSUT
Ğ
pSUT
 )

161 , 
	`m_pLogg”
 ( 
pLogg”
 )

162 , 
	`m_TxnMixG’”©Ü
Ğ&
m_Driv”CETxnS‘tšgs
, 
TxnMixRNGS“d
, 
m_pLogg”
 )

163 , 
	`m_TxnIÅutG’”©Ü
Ğ
šputFes
, 
iCÚfigu»dCu¡om”CouÁ
, 
iAùiveCu¡om”CouÁ
, 
iSÿËFaùÜ
, 
iDaysOfIn™ŸlT¿des
 * 
HoursP”WÜkDay
, 
TxnIÅutRNGS“d
, 
m_pLogg”
, &
m_Driv”CETxnS‘tšgs
 )

164 , 
	$m_bCË¬BufãrBefÜeG’”©iÚ
(
çl£
)

166 
m_pLogg”
->
	`S’dToLogg”
("CE object constructed using constructor 2 (valid for…ublication: NO).");

168 
	`In™Ÿlize
Ğ
pDriv”CETxnS‘tšgs
 );

170 
m_pLogg”
->
	`S’dToLogg”
(
m_Driv”CES‘tšgs
);

171 
	}
}

176 
	gCCE
::
	$CCE
Ğ
CCESUTIÁ”çû
 *
pSUT
, 
CBa£Logg”
 *
pLogg”
, cÚ¡ 
CIÅutFes
 &
šputFes
,

177 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
,

178 
TId’t
 
iMyS¹šgCu¡om”Id
, TId’ˆ
iMyCu¡om”CouÁ
, 
INT32
 
iP¬t™iÚP”ûÁ
,

179 
INT32
 
iSÿËFaùÜ
, INT32 
iDaysOfIn™ŸlT¿des
,

180 
UINT32
 
UniqueId
,

181 cÚ¡ 
PDriv”CETxnS‘tšgs
 
pDriv”CETxnS‘tšgs
 )

182 : 
	`m_Driv”Glob®S‘tšgs
Ğ
iCÚfigu»dCu¡om”CouÁ
, 
iAùiveCu¡om”CouÁ
, 
iSÿËFaùÜ
, 
iDaysOfIn™ŸlT¿des
 )

183 , 
	`m_Driv”CES‘tšgs
Ğ
UniqueId
, 0, 0 )

184 , 
	`m_Driv”CEP¬t™iÚS‘tšgs
Ğ
iMyS¹šgCu¡om”Id
, 
iMyCu¡om”CouÁ
, 
iP¬t™iÚP”ûÁ
 )

185 , 
	`m_pSUT
Ğ
pSUT
 )

186 , 
	`m_pLogg”
 ( 
pLogg”
 )

187 , 
	`m_TxnMixG’”©Ü
Ğ&
m_Driv”CETxnS‘tšgs
, 
m_pLogg”
 )

188 , 
	`m_TxnIÅutG’”©Ü
Ğ
šputFes
, 
iCÚfigu»dCu¡om”CouÁ
, 
iAùiveCu¡om”CouÁ
, 
iSÿËFaùÜ
, 
iDaysOfIn™ŸlT¿des
 * 
HoursP”WÜkDay
,

189 
iMyS¹šgCu¡om”Id
, 
iMyCu¡om”CouÁ
, 
iP¬t™iÚP”ûÁ
, 
m_pLogg”
, &
m_Driv”CETxnS‘tšgs
 )

190 , 
	$m_bCË¬BufãrBefÜeG’”©iÚ
(
çl£
)

192 
m_pLogg”
->
	`S’dToLogg”
("CE object constructed using constructor 3 (valid for…ublication: YES).");

194 
	`In™Ÿlize
Ğ
pDriv”CETxnS‘tšgs
 );

195 
	`AutoS‘RNGS“ds
Ğ
UniqueId
 );

197 
m_pLogg”
->
	`S’dToLogg”
(
m_Driv”CEP¬t™iÚS‘tšgs
);

198 
m_pLogg”
->
	`S’dToLogg”
(
m_Driv”CES‘tšgs
);

199 
	}
}

204 
	gCCE
::
	$CCE
Ğ
CCESUTIÁ”çû
 *
pSUT
, 
CBa£Logg”
 *
pLogg”
, cÚ¡ 
CIÅutFes
 &
šputFes
,

205 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
,

206 
TId’t
 
iMyS¹šgCu¡om”Id
, TId’ˆ
iMyCu¡om”CouÁ
, 
INT32
 
iP¬t™iÚP”ûÁ
,

207 
INT32
 
iSÿËFaùÜ
, INT32 
iDaysOfIn™ŸlT¿des
,

208 
UINT32
 
UniqueId
,

209 
RNGSEED
 
TxnMixRNGS“d
,

210 
RNGSEED
 
TxnIÅutRNGS“d
,

211 cÚ¡ 
PDriv”CETxnS‘tšgs
 
pDriv”CETxnS‘tšgs
 )

212 : 
	`m_Driv”Glob®S‘tšgs
Ğ
iCÚfigu»dCu¡om”CouÁ
, 
iAùiveCu¡om”CouÁ
, 
iSÿËFaùÜ
, 
iDaysOfIn™ŸlT¿des
 )

213 , 
	`m_Driv”CES‘tšgs
Ğ
UniqueId
, 
TxnMixRNGS“d
, 
TxnIÅutRNGS“d
 )

214 , 
	`m_Driv”CEP¬t™iÚS‘tšgs
Ğ
iMyS¹šgCu¡om”Id
, 
iMyCu¡om”CouÁ
, 
iP¬t™iÚP”ûÁ
 )

215 , 
	`m_pSUT
Ğ
pSUT
 )

216 , 
	`m_pLogg”
 ( 
pLogg”
 )

217 , 
	`m_TxnMixG’”©Ü
Ğ&
m_Driv”CETxnS‘tšgs
, 
TxnMixRNGS“d
, 
m_pLogg”
 )

218 , 
	`m_TxnIÅutG’”©Ü
Ğ
šputFes
, 
iCÚfigu»dCu¡om”CouÁ
, 
iAùiveCu¡om”CouÁ
, 
iSÿËFaùÜ
, 
iDaysOfIn™ŸlT¿des
 * 
HoursP”WÜkDay
,

219 
iMyS¹šgCu¡om”Id
, 
iMyCu¡om”CouÁ
, 
iP¬t™iÚP”ûÁ
, 
TxnIÅutRNGS“d
, 
m_pLogg”
, &
m_Driv”CETxnS‘tšgs
 )

220 , 
	$m_bCË¬BufãrBefÜeG’”©iÚ
(
çl£
)

222 
m_pLogg”
->
	`S’dToLogg”
("CE object constructed using constructor 4 (valid for…ublication: NO).");

224 
	`In™Ÿlize
Ğ
pDriv”CETxnS‘tšgs
 );

226 
m_pLogg”
->
	`S’dToLogg”
(
m_Driv”CEP¬t™iÚS‘tšgs
);

227 
m_pLogg”
->
	`S’dToLogg”
(
m_Driv”CES‘tšgs
);

228 
	}
}

230 
	gCCE
::~
	$CCE
( )

232 
m_pLogg”
->
	`S’dToLogg”
("CE object destroyed.");

233 
	}
}

235 
RNGSEED
 
	gCCE
::
	$G‘TxnIÅutG’”©ÜRNGS“d
( )

237 Ğ
m_TxnIÅutG’”©Ü
.
	`G‘RNGS“d
() );

238 
	}
}

240 
RNGSEED
 
	gCCE
::
	$G‘TxnMixG’”©ÜRNGS“d
( )

242 Ğ
m_TxnMixG’”©Ü
.
	`G‘RNGS“d
() );

243 
	}
}

245 
boŞ
 
	gCCE
::
	$S‘TxnTuÇbËs
(cÚ¡ 
PDriv”CETxnS‘tšgs
 
pTxnP¬amS‘tšgs
)

247 ifĞ
pTxnP¬amS‘tšgs
->
	`IsV®id
() )

250 ià(
pTxnP¬amS‘tšgs
 !ğ&
m_Driv”CETxnS‘tšgs
)

252 
m_Driv”CETxnS‘tšgs
 = *
pTxnP¬amS‘tšgs
;

256 
m_TxnMixG’”©Ü
.
	`Upd©eTuÇbËs
();

257 
m_TxnIÅutG’”©Ü
.
	`Upd©eTuÇbËs
();

258  
Œue
;

262  
çl£
;

264 
	}
}

266 
	gCCE
::
	$DoTxn
( )

268 
iTxnTy³
 = 
m_TxnMixG’”©Ü
.
	`G’”©eNextTxnTy³
( );

270 ià(
m_bCË¬BufãrBefÜeG’”©iÚ
)

272 
	`Z”oIÅutBufãr
(
iTxnTy³
);

275  
iTxnTy³
 )

277 
CCETxnMixG’”©Ü
::
BROKER_VOLUME
:

278 
m_TxnIÅutG’”©Ü
.
	`G’”©eBrok”VŞumeIÅut
Ğ
m_Brok”VŞumeTxnIÅut
 );

279 
m_pSUT
->
	`Brok”VŞume
Ğ&
m_Brok”VŞumeTxnIÅut
 );

281 
CCETxnMixG’”©Ü
::
CUSTOMER_POSITION
:

282 
m_TxnIÅutG’”©Ü
.
	`G’”©eCu¡om”Pos™iÚIÅut
Ğ
m_Cu¡om”Pos™iÚTxnIÅut
 );

283 
m_pSUT
->
	`Cu¡om”Pos™iÚ
Ğ&
m_Cu¡om”Pos™iÚTxnIÅut
 );

285 
CCETxnMixG’”©Ü
::
MARKET_WATCH
:

286 
m_TxnIÅutG’”©Ü
.
	`G’”©eM¬k‘W©chIÅut
Ğ
m_M¬k‘W©chTxnIÅut
 );

287 
m_pSUT
->
	`M¬k‘W©ch
Ğ&
m_M¬k‘W©chTxnIÅut
 );

289 
CCETxnMixG’”©Ü
::
SECURITY_DETAIL
:

290 
m_TxnIÅutG’”©Ü
.
	`G’”©eSecur™yD‘aIÅut
Ğ
m_Secur™yD‘aTxnIÅut
 );

291 
m_pSUT
->
	`Secur™yD‘a
Ğ&
m_Secur™yD‘aTxnIÅut
 );

293 
CCETxnMixG’”©Ü
::
TRADE_LOOKUP
:

294 
m_TxnIÅutG’”©Ü
.
	`G’”©eT¿deLookupIÅut
Ğ
m_T¿deLookupTxnIÅut
 );

295 
m_pSUT
->
	`T¿deLookup
Ğ&
m_T¿deLookupTxnIÅut
 );

297 
CCETxnMixG’”©Ü
::
TRADE_ORDER
:

298 
boŞ
 
bExecutÜIsAccouÁOwÃr
;

299 
INT32
 
iT¿deTy³
;

300 
m_TxnIÅutG’”©Ü
.
	`G’”©eT¿deOrd”IÅut
Ğ
m_T¿deOrd”TxnIÅut
, 
iT¿deTy³
, 
bExecutÜIsAccouÁOwÃr
 );

301 
m_pSUT
->
	`T¿deOrd”
Ğ&
m_T¿deOrd”TxnIÅut
, 
iT¿deTy³
, 
bExecutÜIsAccouÁOwÃr
 );

303 
CCETxnMixG’”©Ü
::
TRADE_STATUS
:

304 
m_TxnIÅutG’”©Ü
.
	`G’”©eT¿deStusIÅut
Ğ
m_T¿deStusTxnIÅut
 );

305 
m_pSUT
->
	`T¿deStus
Ğ&
m_T¿deStusTxnIÅut
 );

307 
CCETxnMixG’”©Ü
::
TRADE_UPDATE
:

308 
m_TxnIÅutG’”©Ü
.
	`G’”©eT¿deUpd©eIÅut
Ğ
m_T¿deUpd©eTxnIÅut
 );

309 
m_pSUT
->
	`T¿deUpd©e
Ğ&
m_T¿deUpd©eTxnIÅut
 );

312 
û¼
 << "CE: G’”©ed iÎeg®¿n§ùiÚ" << 
’dl
;

313 
	`ex™
(1);

315 
	}
}

326 
	gCCE
::
	$Z”oIÅutBufãr
(
iTxnTy³
)

328  
iTxnTy³
 )

330 
CCETxnMixG’”©Ü
::
BROKER_VOLUME
:

331 
	`mem£t
Ğ&
m_Brok”VŞumeTxnIÅut
, 0, (m_BrokerVolumeTxnInput) );

333 
CCETxnMixG’”©Ü
::
CUSTOMER_POSITION
:

334 
	`mem£t
Ğ&
m_Cu¡om”Pos™iÚTxnIÅut
, 0, (m_CustomerPositionTxnInput) );

336 
CCETxnMixG’”©Ü
::
MARKET_WATCH
:

337 
	`mem£t
Ğ&
m_M¬k‘W©chTxnIÅut
, 0, (m_MarketWatchTxnInput) );

339 
CCETxnMixG’”©Ü
::
SECURITY_DETAIL
:

340 
	`mem£t
Ğ&
m_Secur™yD‘aTxnIÅut
, 0, (m_SecurityDetailTxnInput) );

342 
CCETxnMixG’”©Ü
::
TRADE_LOOKUP
:

343 
	`mem£t
Ğ&
m_T¿deLookupTxnIÅut
, 0, (m_TradeLookupTxnInput) );

345 
CCETxnMixG’”©Ü
::
TRADE_ORDER
:

346 
	`mem£t
Ğ&
m_T¿deOrd”TxnIÅut
, 0, (m_TradeOrderTxnInput) );

348 
CCETxnMixG’”©Ü
::
TRADE_STATUS
:

349 
	`mem£t
Ğ&
m_T¿deStusTxnIÅut
, 0, (m_TradeStatusTxnInput) );

351 
CCETxnMixG’”©Ü
::
TRADE_UPDATE
:

352 
	`mem£t
Ğ&
m_T¿deUpd©eTxnIÅut
, 0, (m_TradeUpdateTxnInput) );

355 
	}
}

369 
	gCCE
::
	$S‘CË¬BufãrO±iÚ
(
boŞ
 
bCË¬BufãrBefÜeG’”©iÚ
)

371 
m_bCË¬BufãrBefÜeG’”©iÚ
 = 
bCË¬BufãrBefÜeG’”©iÚ
;

372 
	}
}

	@src/workload/tpce/egen/CETxnInputGenerator.cpp

37 
	~"wÜklßd/û/eg’/CETxnIÅutG’”©Ü.h
"

39 
usšg
 
Çme¥aû
 
	gTPCE
;

56 
	gCCETxnIÅutG’”©Ü
::
	$CCETxnIÅutG’”©Ü
ĞcÚ¡ 
CIÅutFes
 &
šputFes
,

57 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
,

58 
INT32
 
iSÿËFaùÜ
, INT32 
iHoursOfIn™ŸlT¿des
,

59 
CBa£Logg”
 *
pLogg”
,

60 cÚ¡ 
PDriv”CETxnS‘tšgs
 
pDriv”CETxnS‘tšgs
 )

61 : 
	`m_ºd
(
RNGS“dBa£TxnIÅutG’”©Ü
)

62 , 
	`m_P”sÚ
(
šputFes
, 0, 
çl£
)

63 , 
	`m_Cu¡om”S–eùiÚ
(&
m_ºd
, 
iDeçuÉS¹FromCu¡om”
, 
iAùiveCu¡om”CouÁ
)

64 , 
	`m_AccsAndP”ms
(
šputFes
, 
iDeçuÉLßdUn™Size
, 
iAùiveCu¡om”CouÁ
, 
iDeçuÉS¹FromCu¡om”
)

65 , 
	`m_HŞdšgs
(
šputFes
, 
iDeçuÉLßdUn™Size
, 
iAùiveCu¡om”CouÁ
, 
iDeçuÉS¹FromCu¡om”
)

66 , 
	`m_Brok”s
(
šputFes
, 
iAùiveCu¡om”CouÁ
, 
iDeçuÉS¹FromCu¡om”
)

67 , 
	`m_pCom·n›s
(
šputFes
.
Com·ny
)

68 , 
	`m_pSecur™›s
(
šputFes
.
Secur™›s
)

69 , 
	`m_pIndu¡r›s
(
šputFes
.
Indu¡ry
)

70 , 
	`m_pSeùÜs
(
šputFes
.
SeùÜs
)

71 , 
	`m_pStusTy³
(
šputFes
.
StusTy³
)

72 , 
	`m_pT¿deTy³
(
šputFes
.
T¿deTy³
)

73 , 
	`m_pDriv”CETxnS‘tšgs
Ğ
pDriv”CETxnS‘tšgs
 )

74 , 
	`m_pLogg”
Ğ
pLogg”
 )

75 , 
	`m_iCÚfigu»dCu¡om”CouÁ
(
iCÚfigu»dCu¡om”CouÁ
)

76 , 
	`m_iAùiveCu¡om”CouÁ
(
iAùiveCu¡om”CouÁ
)

77 , 
	`m_iMyS¹šgCu¡om”Id
(
iDeçuÉS¹FromCu¡om”
)

78 , 
	`m_iMyCu¡om”CouÁ
(
iAùiveCu¡om”CouÁ
)

79 , 
	`m_iP¬t™iÚP”ûÁ
(100)

80 , 
	`m_iSÿËFaùÜ
(
iSÿËFaùÜ
)

81 , 
	$m_iHoursOfIn™ŸlT¿des
(
iHoursOfIn™ŸlT¿des
)

83 
	`In™Ÿlize
();

84 
	}
}

105 
	gCCETxnIÅutG’”©Ü
::
	$CCETxnIÅutG’”©Ü
ĞcÚ¡ 
CIÅutFes
 &
šputFes
,

106 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
,

107 
INT32
 
iSÿËFaùÜ
, INT32 
iHoursOfIn™ŸlT¿des
,

108 
RNGSEED
 
RNGS“d
,

109 
CBa£Logg”
 *
pLogg”
,

110 cÚ¡ 
PDriv”CETxnS‘tšgs
 
pDriv”CETxnS‘tšgs
 )

111 : 
	`m_ºd
(
RNGS“d
)

112 , 
	`m_P”sÚ
(
šputFes
, 0, 
çl£
)

113 , 
	`m_Cu¡om”S–eùiÚ
(&
m_ºd
, 
iDeçuÉS¹FromCu¡om”
, 
iAùiveCu¡om”CouÁ
)

114 , 
	`m_AccsAndP”ms
(
šputFes
, 
iDeçuÉLßdUn™Size
, 
iAùiveCu¡om”CouÁ
, 
iDeçuÉS¹FromCu¡om”
)

115 , 
	`m_HŞdšgs
(
šputFes
, 
iDeçuÉLßdUn™Size
, 
iAùiveCu¡om”CouÁ
, 
iDeçuÉS¹FromCu¡om”
)

116 , 
	`m_Brok”s
(
šputFes
, 
iAùiveCu¡om”CouÁ
, 
iDeçuÉS¹FromCu¡om”
)

117 , 
	`m_pCom·n›s
(
šputFes
.
Com·ny
)

118 , 
	`m_pSecur™›s
(
šputFes
.
Secur™›s
)

119 , 
	`m_pIndu¡r›s
(
šputFes
.
Indu¡ry
)

120 , 
	`m_pSeùÜs
(
šputFes
.
SeùÜs
)

121 , 
	`m_pStusTy³
(
šputFes
.
StusTy³
)

122 , 
	`m_pT¿deTy³
(
šputFes
.
T¿deTy³
)

123 , 
	`m_pDriv”CETxnS‘tšgs
Ğ
pDriv”CETxnS‘tšgs
 )

124 , 
	`m_pLogg”
Ğ
pLogg”
 )

125 , 
	`m_iCÚfigu»dCu¡om”CouÁ
(
iCÚfigu»dCu¡om”CouÁ
)

126 , 
	`m_iAùiveCu¡om”CouÁ
(
iAùiveCu¡om”CouÁ
)

127 , 
	`m_iMyS¹šgCu¡om”Id
(
iDeçuÉS¹FromCu¡om”
)

128 , 
	`m_iMyCu¡om”CouÁ
(
iAùiveCu¡om”CouÁ
)

129 , 
	`m_iP¬t™iÚP”ûÁ
(100)

130 , 
	`m_iSÿËFaùÜ
(
iSÿËFaùÜ
)

131 , 
	$m_iHoursOfIn™ŸlT¿des
(
iHoursOfIn™ŸlT¿des
)

133 
	`In™Ÿlize
();

134 
	}
}

154 
	gCCETxnIÅutG’”©Ü
::
	$CCETxnIÅutG’”©Ü
ĞcÚ¡ 
CIÅutFes
 &
šputFes
,

155 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
,

156 
INT32
 
iSÿËFaùÜ
, INT32 
iHoursOfIn™ŸlT¿des
,

157 
TId’t
 
iMyS¹šgCu¡om”Id
, TId’ˆ
iMyCu¡om”CouÁ
, 
INT32
 
iP¬t™iÚP”ûÁ
,

158 
CBa£Logg”
 *
pLogg”
,

159 cÚ¡ 
PDriv”CETxnS‘tšgs
 
pDriv”CETxnS‘tšgs
 )

160 : 
	`m_ºd
(
RNGS“dBa£TxnIÅutG’”©Ü
)

161 , 
	`m_P”sÚ
(
šputFes
, 0, 
çl£
)

162 , 
	`m_Cu¡om”S–eùiÚ
(&
m_ºd
, 
iDeçuÉS¹FromCu¡om”
, 
iAùiveCu¡om”CouÁ
, 
iP¬t™iÚP”ûÁ
, 
iMyS¹šgCu¡om”Id
, 
iMyCu¡om”CouÁ
)

163 , 
	`m_AccsAndP”ms
(
šputFes
, 
iDeçuÉLßdUn™Size
, 
iAùiveCu¡om”CouÁ
, 
iDeçuÉS¹FromCu¡om”
)

164 , 
	`m_HŞdšgs
(
šputFes
, 
iDeçuÉLßdUn™Size
, 
iAùiveCu¡om”CouÁ
, 
iDeçuÉS¹FromCu¡om”
)

165 , 
	`m_Brok”s
(
šputFes
, 
iAùiveCu¡om”CouÁ
, 
iDeçuÉS¹FromCu¡om”
)

166 , 
	`m_pCom·n›s
(
šputFes
.
Com·ny
)

167 , 
	`m_pSecur™›s
(
šputFes
.
Secur™›s
)

168 , 
	`m_pIndu¡r›s
(
šputFes
.
Indu¡ry
)

169 , 
	`m_pSeùÜs
(
šputFes
.
SeùÜs
)

170 , 
	`m_pStusTy³
(
šputFes
.
StusTy³
)

171 , 
	`m_pT¿deTy³
(
šputFes
.
T¿deTy³
)

172 , 
	`m_pDriv”CETxnS‘tšgs
Ğ
pDriv”CETxnS‘tšgs
 )

173 , 
	`m_pLogg”
Ğ
pLogg”
 )

174 , 
	`m_iCÚfigu»dCu¡om”CouÁ
(
iCÚfigu»dCu¡om”CouÁ
)

175 , 
	`m_iAùiveCu¡om”CouÁ
(
iAùiveCu¡om”CouÁ
)

176 , 
	`m_iMyS¹šgCu¡om”Id
(
iMyS¹šgCu¡om”Id
)

177 , 
	`m_iMyCu¡om”CouÁ
(
iMyCu¡om”CouÁ
)

178 , 
	`m_iP¬t™iÚP”ûÁ
(
iP¬t™iÚP”ûÁ
)

179 , 
	`m_iSÿËFaùÜ
(
iSÿËFaùÜ
)

180 , 
	$m_iHoursOfIn™ŸlT¿des
(
iHoursOfIn™ŸlT¿des
)

182 
	`In™Ÿlize
();

183 
	}
}

206 
	gCCETxnIÅutG’”©Ü
::
	$CCETxnIÅutG’”©Ü
ĞcÚ¡ 
CIÅutFes
 &
šputFes
,

207 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
,

208 
INT32
 
iSÿËFaùÜ
, INT32 
iHoursOfIn™ŸlT¿des
,

209 
TId’t
 
iMyS¹šgCu¡om”Id
, TId’ˆ
iMyCu¡om”CouÁ
, 
INT32
 
iP¬t™iÚP”ûÁ
,

210 
RNGSEED
 
RNGS“d
,

211 
CBa£Logg”
 *
pLogg”
,

212 cÚ¡ 
PDriv”CETxnS‘tšgs
 
pDriv”CETxnS‘tšgs
 )

213 : 
	`m_ºd
(
RNGS“d
)

214 , 
	`m_P”sÚ
(
šputFes
, 0, 
çl£
)

215 , 
	`m_Cu¡om”S–eùiÚ
(&
m_ºd
, 
iDeçuÉS¹FromCu¡om”
, 
iAùiveCu¡om”CouÁ
, 
iP¬t™iÚP”ûÁ
, 
iMyS¹šgCu¡om”Id
, 
iMyCu¡om”CouÁ
)

216 , 
	`m_AccsAndP”ms
(
šputFes
, 
iDeçuÉLßdUn™Size
, 
iAùiveCu¡om”CouÁ
, 
iDeçuÉS¹FromCu¡om”
)

217 , 
	`m_HŞdšgs
(
šputFes
, 
iDeçuÉLßdUn™Size
, 
iAùiveCu¡om”CouÁ
, 
iDeçuÉS¹FromCu¡om”
)

218 , 
	`m_Brok”s
(
šputFes
, 
iAùiveCu¡om”CouÁ
, 
iDeçuÉS¹FromCu¡om”
)

219 , 
	`m_pCom·n›s
(
šputFes
.
Com·ny
)

220 , 
	`m_pSecur™›s
(
šputFes
.
Secur™›s
)

221 , 
	`m_pIndu¡r›s
(
šputFes
.
Indu¡ry
)

222 , 
	`m_pSeùÜs
(
šputFes
.
SeùÜs
)

223 , 
	`m_pStusTy³
(
šputFes
.
StusTy³
)

224 , 
	`m_pT¿deTy³
(
šputFes
.
T¿deTy³
)

225 , 
	`m_pDriv”CETxnS‘tšgs
Ğ
pDriv”CETxnS‘tšgs
 )

226 , 
	`m_pLogg”
Ğ
pLogg”
 )

227 , 
	`m_iCÚfigu»dCu¡om”CouÁ
(
iCÚfigu»dCu¡om”CouÁ
)

228 , 
	`m_iAùiveCu¡om”CouÁ
(
iAùiveCu¡om”CouÁ
)

229 , 
	`m_iMyS¹šgCu¡om”Id
(
iMyS¹šgCu¡om”Id
)

230 , 
	`m_iMyCu¡om”CouÁ
(
iMyCu¡om”CouÁ
)

231 , 
	`m_iP¬t™iÚP”ûÁ
(
iP¬t™iÚP”ûÁ
)

232 , 
	`m_iSÿËFaùÜ
(
iSÿËFaùÜ
)

233 , 
	$m_iHoursOfIn™ŸlT¿des
(
iHoursOfIn™ŸlT¿des
)

235 
	`In™Ÿlize
();

236 
	}
}

247 
	gCCETxnIÅutG’”©Ü
::
	$In™Ÿlize
()

249 
m_iAùiveCom·nyCouÁ
 = 
m_pCom·n›s
->
	`G‘AùiveCom·nyCouÁ
();

250 
m_iAùiveSecur™yCouÁ
 = 
m_pSecur™›s
->
	`G‘AùiveSecur™yCouÁ
();

251 
m_iIndu¡ryCouÁ
 = 
m_pIndu¡r›s
->
	`G‘Size
();

252 
m_iSeùÜCouÁ
 = 
m_pSeùÜs
->
	`G‘Size
();

253 
m_iS¹FromCom·ny
 = 
m_pCom·n›s
->
	`G‘Com·nyId
(0);

255 
m_iMaxAùiveP»PİuÏ‹dT¿deID
 =

256 (
INT64
)(Ğ(INT64)
m_iHoursOfIn™ŸlT¿des
 * 
SecÚdsP”Hour
 * ( 
m_iAùiveCu¡om”CouÁ
 / 
m_iSÿËFaùÜ
 )è* 
iAbÜtT¿de
 / 
	`INT64_CONST
(100) );

259 
m_S¹Time
.
	`S‘
(

260 
In™ŸlT¿dePİuÏtiÚBa£Y—r
,

261 
In™ŸlT¿dePİuÏtiÚBa£MÚth
,

262 
In™ŸlT¿dePİuÏtiÚBa£Day
,

263 
In™ŸlT¿dePİuÏtiÚBa£Hour
,

264 
In™ŸlT¿dePİuÏtiÚBa£Mšu‹
,

265 
In™ŸlT¿dePİuÏtiÚBa£SecÚd
,

266 
In™ŸlT¿dePİuÏtiÚBa£F¿ùiÚ
 );

268 
	`Upd©eTuÇbËs
();

270 
	}
}

281 
RNGSEED
 
	gCCETxnIÅutG’”©Ü
::
	$G‘RNGS“d
( )

283 Ğ
m_ºd
.
	`G‘S“d
() );

284 
	}
}

295 
	gCCETxnIÅutG’”©Ü
::
	$S‘RNGS“d
Ğ
RNGSEED
 
RNGS“d
 )

297 
m_ºd
.
	`S‘S“d
Ğ
RNGS“d
 );

298 
	}
}

311 
	gCCETxnIÅutG’”©Ü
::
	$Upd©eTuÇbËs
( )

313 
INT64
 
£cÚdsOfIn™ŸlT¿des
 = (INT64)
m_iHoursOfIn™ŸlT¿des
 * 
SecÚdsP”Hour
;

315 
m_iT¿deLookupF¿me2MaxTimeInMliSecÚds
 =

316 (
INT64
)(
£cÚdsOfIn™ŸlT¿des
 -

317 ((
INT64
)
m_pDriv”CETxnS‘tšgs
->
TL_£‰šgs
.
cur
.
BackOffFromEndTimeF¿me2
 )è* 
MsP”SecÚd
;

320 
m_iT¿deLookupF¿me3MaxTimeInMliSecÚds
 =

321 (
INT64
)(
£cÚdsOfIn™ŸlT¿des
 -

322 ((
INT64
)
m_pDriv”CETxnS‘tšgs
->
TL_£‰šgs
.
cur
.
BackOffFromEndTimeF¿me3
 )è* 
MsP”SecÚd
;

324 
m_iT¿deLookupF¿me4MaxTimeInMliSecÚds
 =

325 (
INT64
)(
£cÚdsOfIn™ŸlT¿des
 -

326 ((
INT64
)
m_pDriv”CETxnS‘tšgs
->
TL_£‰šgs
.
cur
.
BackOffFromEndTimeF¿me4
 )è* 
MsP”SecÚd
;

328 
m_iT¿deUpd©eF¿me2MaxTimeInMliSecÚds
 =

329 (
INT64
)(
£cÚdsOfIn™ŸlT¿des
 -

330 ((
INT64
)
m_pDriv”CETxnS‘tšgs
->
TU_£‰šgs
.
cur
.
BackOffFromEndTimeF¿me2
 )è* 
MsP”SecÚd
;

332 
m_iT¿deUpd©eF¿me3MaxTimeInMliSecÚds
 =

333 (
INT64
)(
£cÚdsOfIn™ŸlT¿des
 -

334 ((
INT64
)
m_pDriv”CETxnS‘tšgs
->
TU_£‰šgs
.
cur
.
BackOffFromEndTimeF¿me3
 )è* 
MsP”SecÚd
;

338 
m_EndTime
 = 
m_S¹Time
;

339 
m_EndTime
.
	`AddWÜkMs
Ğ(
INT64
)(
£cÚdsOfIn™ŸlT¿des
 +

340 15 * 
SecÚdsP”Mšu‹
è* 
MsP”SecÚd
 );

344 
m_iT¿deOrd”RŞlbackLim™
 = 
m_pDriv”CETxnS‘tšgs
->
TxnMixG’”©Ü_£‰šgs
.
cur
.
T¿deOrd”MixLev–
;

345 
m_iT¿deOrd”RŞlbackLev–
 = 
m_pDriv”CETxnS‘tšgs
->
TO_£‰šgs
.
cur
.
rŞlback
;

348 
m_pLogg”
->
	`S’dToLogg”
(
m_pDriv”CETxnS‘tšgs
->
BV_£‰šgs
);

349 
m_pLogg”
->
	`S’dToLogg”
(
m_pDriv”CETxnS‘tšgs
->
CP_£‰šgs
);

350 
m_pLogg”
->
	`S’dToLogg”
(
m_pDriv”CETxnS‘tšgs
->
MW_£‰šgs
);

351 
m_pLogg”
->
	`S’dToLogg”
(
m_pDriv”CETxnS‘tšgs
->
SD_£‰šgs
);

352 
m_pLogg”
->
	`S’dToLogg”
(
m_pDriv”CETxnS‘tšgs
->
TL_£‰šgs
);

353 
m_pLogg”
->
	`S’dToLogg”
(
m_pDriv”CETxnS‘tšgs
->
TO_£‰šgs
);

354 
m_pLogg”
->
	`S’dToLogg”
(
m_pDriv”CETxnS‘tšgs
->
TU_£‰šgs
);

356 
	}
}

368 
šlše
 
	gCCETxnIÅutG’”©Ü
::
	$G’”©eNÚUnifÜmRªdomCu¡om”Id
(
TId’t
 &
iCu¡om”Id
, 
eCu¡om”T›r
 &
iCu¡om”T›r
)

370 
m_Cu¡om”S–eùiÚ
.
	`G’”©eRªdomCu¡om”
(
iCu¡om”Id
, 
iCu¡om”T›r
);

371 
	}
}

382 
TId’t
 
	gCCETxnIÅutG’”©Ü
::
	$G’”©eRªdomCu¡om”AccouÁId
()

384 
TId’t
 
iCu¡om”Id
;

385 
TId’t
 
iCu¡om”AccouÁId
;

386 
eCu¡om”T›r
 
iCu¡om”T›r
;

388 
m_Cu¡om”S–eùiÚ
.
	`G’”©eRªdomCu¡om”
(
iCu¡om”Id
, 
iCu¡om”T›r
);

389 
iCu¡om”AccouÁId
 = 
m_AccsAndP”ms
.
	`G’”©eRªdomAccouÁId
Ğ
m_ºd
, 
iCu¡om”Id
, 
iCu¡om”T›r
);

391 (
iCu¡om”AccouÁId
);

392 
	}
}

404 
TT¿de
 
	gCCETxnIÅutG’”©Ü
::
	$G’”©eNÚUnifÜmT¿deID
Ğ
INT32
 
AV®ue
, INT32 
SV®ue
 )

406 
TT¿de
 
T¿deId
;

408 
T¿deId
 = 
m_ºd
.
	`NURnd
Ğ1, 
m_iMaxAùiveP»PİuÏ‹dT¿deID
, 
AV®ue
, 
SV®ue
 );

411 iàĞ
m_HŞdšgs
.
	`IsAbÜ‹dT¿de
(
T¿deId
) )

413 
T¿deId
++;

416 
T¿deId
 +ğ
iTT¿deShiá
;

418 Ğ
T¿deId
 );

419 
	}
}

433 
	gCCETxnIÅutG’”©Ü
::
	$G’”©eNÚUnifÜmT¿deDTS
Ğ
TPCE
::
TIMESTAMP_STRUCT
 &
dts
, 
INT64
 
MaxTimeInMliSecÚds
, 
INT32
 
AV®ue
, INT32 
SV®ue
 )

435 
CD©eTime
 
	`T¿deTime
Ğ
In™ŸlT¿dePİuÏtiÚBa£Y—r
,

436 
In™ŸlT¿dePİuÏtiÚBa£MÚth
,

437 
In™ŸlT¿dePİuÏtiÚBa£Day
,

438 
In™ŸlT¿dePİuÏtiÚBa£Hour
,

439 
In™ŸlT¿dePİuÏtiÚBa£Mšu‹
,

440 
In™ŸlT¿dePİuÏtiÚBa£SecÚd
,

441 
In™ŸlT¿dePİuÏtiÚBa£F¿ùiÚ
 );

443 
INT64
 
T¿deTimeOff£t
;

447 
T¿deTimeOff£t
 = 
m_ºd
.
	`NURnd
Ğ1, 
MaxTimeInMliSecÚds
, 
AV®ue
, 
SV®ue
 );

454 
T¿deTime
.
	`AddWÜkMs
Ğ
T¿deTimeOff£t
 );

455 
T¿deTime
.
	`G‘TimeSmp
Ğ&
dts
 );

456 
	}
}

467 
	gCCETxnIÅutG’”©Ü
::
	$G’”©eBrok”VŞumeIÅut
(
TBrok”VŞumeTxnIÅut
 &
TxnReq
)

469 
INT32
 
iNumBrok”s
;

470 
INT32
 
iCouÁ
, 
i
;

471 
TId’t
 
B_ID
[
max_brok”_li¡_Ën
];

472 
INT32
 
iSeùÜIndex
;

475 
i
 = 0; i < 
max_brok”_li¡_Ën
; ++i)

477 
TxnReq
.
brok”_li¡
[
i
][0] = '\0';

483 
iNumBrok”s
 = 
m_ºd
.
	`RndIÁRªge
(
mš_brok”_li¡_Ën
, 
max_brok”_li¡_Ën
);

487 ià(
iNumBrok”s
 > 
m_Brok”s
.
	`G‘Brok”CouÁ
())

489 
iNumBrok”s
 = (
INT32
)
m_Brok”s
.
	`G‘Brok”CouÁ
();

492 
iCouÁ
 = 0;

496 
B_ID
[
iCouÁ
] = 
m_Brok”s
.
	`G’”©eRªdomBrok”Id
(&
m_ºd
);

498 
i
 = 0; (˜< 
iCouÁ
è&& (
B_ID
[i] != B_ID[iCount]); ++i) { };

500 ià(
i
 =ğ
iCouÁ
)

503 
m_Brok”s
.
	`G’”©eBrok”Name
(
B_ID
[
iCouÁ
], 
TxnReq
.
brok”_li¡
[iCouÁ], 
¡©ic_ÿ¡
<>((TxnReq.broker_list[iCount])));

504 ++
iCouÁ
;

507 } 
iCouÁ
 < 
iNumBrok”s
);

510 
iSeùÜIndex
 = 
m_ºd
.
	`RndIÁRªge
(0, 
m_iSeùÜCouÁ
-1);

512 
	`¡ºıy
(
TxnReq
.
£ùÜ_Çme
,

513 
m_pSeùÜs
->
	`G‘RecÜd
(
iSeùÜIndex
)->
SC_NAME
,

514 (
TxnReq
.
£ùÜ_Çme
));

515 
	}
}

526 
	gCCETxnIÅutG’”©Ü
::
	$G’”©eCu¡om”Pos™iÚIÅut
(
TCu¡om”Pos™iÚTxnIÅut
 &
TxnReq
)

528 
TId’t
 
iCu¡om”Id
;

529 
eCu¡om”T›r
 
iCu¡om”T›r
;

531 
	`G’”©eNÚUnifÜmRªdomCu¡om”Id
(
iCu¡om”Id
, 
iCu¡om”T›r
);

533 ià(
m_ºd
.
	`RndP”ûÁ
(
m_pDriv”CETxnS‘tšgs
->
CP_£‰šgs
.
cur
.
by_x_id
))

536 
m_P”sÚ
.
	`G‘TaxID
(
iCu¡om”Id
, 
TxnReq
.
x_id
);

538 
TxnReq
.
cu¡_id
 = 0;

543 
TxnReq
.
cu¡_id
 = 
iCu¡om”Id
;

545 
TxnReq
.
x_id
[0] = '\0';

548 
TxnReq
.
g‘_hi¡Üy
 = 
m_ºd
.
	`RndP”ûÁ
(
m_pDriv”CETxnS‘tšgs
->
CP_£‰šgs
.
cur
.get_history);

549 ifĞ
TxnReq
.
g‘_hi¡Üy
 )

551 
TxnReq
.
acù_id_idx
 = 
m_ºd
.
	`RndIÁRªge
Ğ0, 
m_AccsAndP”ms
.
	`G‘Numb”OfAccouÁs
Ğ
iCu¡om”Id
, 
iCu¡om”T›r
 ) - 1 );

555 
TxnReq
.
acù_id_idx
 = -1;

557 
	}
}

568 
	gCCETxnIÅutG’”©Ü
::
	$G’”©eM¬k‘W©chIÅut
(
TM¬k‘W©chTxnIÅut
 &
TxnReq
)

570 
TId’t
 
iCu¡om”Id
;

571 
eCu¡om”T›r
 
iCu¡om”T›r
;

572 
INT32
 
iTh»shŞd
;

573 
INT32
 
iW“k
;

574 
INT32
 
iDayM¬k‘Day
;

575 
CD©eTime
 
	`S¹D©e
(
iDayM¬k‘Ba£Y—r
, 
iDayM¬k‘Ba£MÚth
,

576 
iDayM¬k‘Ba£Day
, 
iDayM¬k‘Ba£Hour
,

577 
iDayM¬k‘Ba£Mšu‹
, 
iDayM¬k‘Ba£SecÚd
, 
iDayM¬k‘Ba£M£c
);

579 
iTh»shŞd
 = 
m_ºd
.
	`RndG’”©eIÁeg”P”ûÁage
();

582 ià(
iTh»shŞd
 <ğ
m_pDriv”CETxnS‘tšgs
->
MW_£‰šgs
.
cur
.
by_šdu¡ry
)

585 
	`¡ºıy
(
TxnReq
.
šdu¡ry_Çme
,

586 
m_pIndu¡r›s
->
	`G‘RecÜd
(
m_ºd
.
	`RndIÁRªge
(0, 
m_iIndu¡ryCouÁ
-1))->
IN_NAME
,

587 (
TxnReq
.
šdu¡ry_Çme
));

589 
TxnReq
.
c_id
 = TxnReq.
acù_id
 = 0;

591 ifĞ
iBa£Com·nyCouÁ
 < 
m_iAùiveCom·nyCouÁ
 )

593 
TxnReq
.
¡¬tšg_co_id
 = 
m_ºd
.
	`RndIÁ64Rªge
Ğ
m_iS¹FromCom·ny
,

594 
m_iS¹FromCom·ny
 +

595 
m_iAùiveCom·nyCouÁ
 - ( 
iBa£Com·nyCouÁ
 - 1 ));

596 
TxnReq
.
’dšg_co_id
 = TxnReq.
¡¬tšg_co_id
 + ( 
iBa£Com·nyCouÁ
 - 1 );

600 
TxnReq
.
¡¬tšg_co_id
 = 
m_iS¹FromCom·ny
;

601 
TxnReq
.
’dšg_co_id
 = 
m_iS¹FromCom·ny
 + 
m_iAùiveCom·nyCouÁ
 - 1;

606 
TxnReq
.
šdu¡ry_Çme
[0] = '\0';

607 
TxnReq
.
¡¬tšg_co_id
 = 0;

608 
TxnReq
.
’dšg_co_id
 = 0;

610 ià(
iTh»shŞd
 <ğ(
m_pDriv”CETxnS‘tšgs
->
MW_£‰šgs
.
cur
.
by_šdu¡ry
 + m_pDriv”CETxnS‘tšgs->MW_£‰šgs.cur.
by_w©ch_li¡
))

613 
	`G’”©eNÚUnifÜmRªdomCu¡om”Id
(
TxnReq
.
c_id
, 
iCu¡om”T›r
);

615 
TxnReq
.
acù_id
 = 0;

620 
	`G’”©eNÚUnifÜmRªdomCu¡om”Id
(
iCu¡om”Id
, 
iCu¡om”T›r
);

621 
m_AccsAndP”ms
.
	`G’”©eRªdomAccouÁId
(
m_ºd
, 
iCu¡om”Id
, 
iCu¡om”T›r
, &
TxnReq
.
acù_id
, 
NULL
);

623 
TxnReq
.
c_id
 = 0;

629 
iW“k
 = (
INT32
)
m_ºd
.
	`NURnd
(0, 255, 255, 0) + 5;

633 
iTh»shŞd
 = 
m_ºd
.
	`RndG’”©eIÁeg”P”ûÁage
();

634 ià(
iTh»shŞd
 > 40)

636 
iDayM¬k‘Day
 = 
iW“k
 * 
DaysP”W“k
 + 4;

640 ià(
iTh»shŞd
 <= 20)

642 
iDayM¬k‘Day
 = 
iW“k
 * 
DaysP”W“k
;

646 ià(
iTh»shŞd
 <= 27)

648 
iDayM¬k‘Day
 = 
iW“k
 * 
DaysP”W“k
 + 1;

652 ià(
iTh»shŞd
 <= 33)

654 
iDayM¬k‘Day
 = 
iW“k
 * 
DaysP”W“k
 + 2;

658 
iDayM¬k‘Day
 = 
iW“k
 * 
DaysP”W“k
 + 3;

666 
S¹D©e
.
	`Add
(
iDayM¬k‘Day
, 0);

668 
S¹D©e
.
	`G‘TimeSmp
(&
TxnReq
.
¡¬t_day
);

669 
	}
}

680 
	gCCETxnIÅutG’”©Ü
::
	$G’”©eSecur™yD‘aIÅut
(
TSecur™yD‘aTxnIÅut
 &
TxnReq
)

682 
CD©eTime
 
	`S¹D©e
(
iDayM¬k‘Ba£Y—r
, 
iDayM¬k‘Ba£MÚth
,

683 
iDayM¬k‘Ba£Day
, 
iDayM¬k‘Ba£Hour
,

684 
iDayM¬k‘Ba£Mšu‹
, 
iDayM¬k‘Ba£SecÚd
, 
iDayM¬k‘Ba£M£c
);

685 
INT32
 
iS¹Day
;

688 
m_pSecur™›s
->
	`C»©eSymbŞ
Ğ
m_ºd
.
	`RndIÁ64Rªge
(0, 
m_iAùiveSecur™yCouÁ
-1), 
TxnReq
.
symbŞ
, 
¡©ic_ÿ¡
<>(( TxnReq.symbol )));

691 
TxnReq
.
acûss_lob_æag
 = 
m_ºd
.
	`RndP”ûÁ
Ğ
m_pDriv”CETxnS‘tšgs
->
SD_£‰šgs
.
cur
.
LOBAcûssP”ûÁage
 );

694 
TxnReq
.
max_rows_to_»tuº
 = 
m_ºd
.
	`RndIÁRªge
(
iSecur™yD‘aMšRows
, 
iSecur™yD‘aMaxRows
);

696 
iS¹Day
 = 
m_ºd
.
	`RndIÁRªge
(0, 
iDayM¬k‘TÙ®Rows
 - 
TxnReq
.
max_rows_to_»tuº
);

699 
S¹D©e
.
	`Add
(
iS¹Day
, 0);

701 
S¹D©e
.
	`G‘TimeSmp
(&
TxnReq
.
¡¬t_day
);

702 
	}
}

713 
	gCCETxnIÅutG’”©Ü
::
	$G’”©eT¿deLookupIÅut
(
TT¿deLookupTxnIÅut
 &
TxnReq
)

715 
INT32
 
iTh»shŞd
;

717 
iTh»shŞd
 = 
m_ºd
.
	`RndG’”©eIÁeg”P”ûÁage
();

719 ifĞ
iTh»shŞd
 <ğ
m_pDriv”CETxnS‘tšgs
->
TL_£‰šgs
.
cur
.
do_äame1
 )

722 
TxnReq
.
äame_to_execu‹
 = 1;

723 
TxnReq
.
max_Œades
 = 
m_pDriv”CETxnS‘tšgs
->
TL_£‰šgs
.
cur
.
MaxRowsF¿me1
;

726 
ii
, 
jj
;

727 
boŞ
 
Acû±ed
;

728 
TT¿de
 
TID
;

730  
ii
 = 0; i˜< 
TxnReq
.
max_Œades
; ii++ )

732 
Acû±ed
 = 
çl£
;

733  ! 
Acû±ed
 )

735 
TID
 = 
	`G’”©eNÚUnifÜmT¿deID
(
T¿deLookupAV®ueFÜT¿deIDG’F¿me1
,

736 
T¿deLookupSV®ueFÜT¿deIDG’F¿me1
);

737 
jj
 = 0;

738  
jj
 < 
ii
 && 
TxnReq
.
Œade_id
[jj] !ğ
TID
 )

740 
jj
++;

742 ifĞ
jj
 =ğ
ii
 )

745 
TxnReq
.
Œade_id
[
ii
] = 
TID
;

746 
Acû±ed
 = 
Œue
;

752 
TxnReq
.
acù_id
 = 0;

753 
TxnReq
.
max_acù_id
 = 0;

754 
	`mem£t
Ğ
TxnReq
.
symbŞ
, 0, ( TxnReq.symbol ));

755 
	`mem£t
Ğ&
TxnReq
.
¡¬t_Œade_dts
, 0, ( TxnReq.start_trade_dts ));

756 
	`mem£t
Ğ&
TxnReq
.
’d_Œade_dts
, 0, ( TxnReq.end_trade_dts ));

759 ifĞ
iTh»shŞd
 <ğ
m_pDriv”CETxnS‘tšgs
->
TL_£‰šgs
.
cur
.
do_äame1
 +

760 
m_pDriv”CETxnS‘tšgs
->
TL_£‰šgs
.
cur
.
do_äame2
 )

763 
TxnReq
.
äame_to_execu‹
 = 2;

764 
TxnReq
.
acù_id
 = 
	`G’”©eRªdomCu¡om”AccouÁId
();

765 
TxnReq
.
max_Œades
 = 
m_pDriv”CETxnS‘tšgs
->
TL_£‰šgs
.
cur
.
MaxRowsF¿me2
;

767 
	`G’”©eNÚUnifÜmT¿deDTS
Ğ
TxnReq
.
¡¬t_Œade_dts
,

768 
m_iT¿deLookupF¿me2MaxTimeInMliSecÚds
,

769 
T¿deLookupAV®ueFÜTimeG’F¿me2
,

770 
T¿deLookupSV®ueFÜTimeG’F¿me2
 );

773 
m_EndTime
.
	`G‘TimeSmp
(&
TxnReq
.
’d_Œade_dts
);

776 
TxnReq
.
max_acù_id
 = 0;

777 
	`mem£t
Ğ
TxnReq
.
symbŞ
, 0, ( TxnReq.symbol ));

778 
	`mem£t
Ğ
TxnReq
.
Œade_id
, 0, ( TxnReq.trade_id ));

781 ifĞ
iTh»shŞd
 <ğ
m_pDriv”CETxnS‘tšgs
->
TL_£‰šgs
.
cur
.
do_äame1
 +

782 
m_pDriv”CETxnS‘tšgs
->
TL_£‰šgs
.
cur
.
do_äame2
 +

783 
m_pDriv”CETxnS‘tšgs
->
TL_£‰šgs
.
cur
.
do_äame3
 )

786 
TxnReq
.
äame_to_execu‹
 = 3;

787 
TxnReq
.
max_Œades
 = 
m_pDriv”CETxnS‘tšgs
->
TL_£‰šgs
.
cur
.
MaxRowsF¿me3
;

789 
m_pSecur™›s
->
	`C»©eSymbŞ
Ğ
m_ºd
.
	`NURnd
Ğ0, 
m_iAùiveSecur™yCouÁ
-1,

790 
T¿deLookupAV®ueFÜSymbŞF¿me3
,

791 
T¿deLookupSV®ueFÜSymbŞF¿me3
 ),

792 
TxnReq
.
symbŞ
,

793 
¡©ic_ÿ¡
<>(Ğ
TxnReq
.
symbŞ
 )));

795 
	`G’”©eNÚUnifÜmT¿deDTS
Ğ
TxnReq
.
¡¬t_Œade_dts
,

796 
m_iT¿deLookupF¿me3MaxTimeInMliSecÚds
,

797 
T¿deLookupAV®ueFÜTimeG’F¿me3
,

798 
T¿deLookupSV®ueFÜTimeG’F¿me3
 );

801 
m_EndTime
.
	`G‘TimeSmp
(&
TxnReq
.
’d_Œade_dts
);

803 
TxnReq
.
max_acù_id
 = 
m_AccsAndP”ms
.
	`G‘EndšgCA_ID
Ğ
m_iAùiveCu¡om”CouÁ
 );

805 
TxnReq
.
acù_id
 = 0;

806 
	`mem£t
Ğ
TxnReq
.
Œade_id
, 0, ( TxnReq.trade_id ));

812 
TxnReq
.
äame_to_execu‹
 = 4;

813 
TxnReq
.
acù_id
 = 
	`G’”©eRªdomCu¡om”AccouÁId
();

814 
	`G’”©eNÚUnifÜmT¿deDTS
Ğ
TxnReq
.
¡¬t_Œade_dts
,

815 
m_iT¿deLookupF¿me4MaxTimeInMliSecÚds
,

816 
T¿deLookupAV®ueFÜTimeG’F¿me4
,

817 
T¿deLookupSV®ueFÜTimeG’F¿me4
 );

820 
TxnReq
.
max_Œades
 = 0;

821 
TxnReq
.
max_acù_id
 = 0;

822 
	`mem£t
Ğ
TxnReq
.
symbŞ
, 0, ( TxnReq.symbol ));

823 
	`mem£t
Ğ
TxnReq
.
Œade_id
, 0, ( TxnReq.trade_id ));

826 
	}
}

839 
	gCCETxnIÅutG’”©Ü
::
	$G’”©eT¿deOrd”IÅut
(
TT¿deOrd”TxnIÅut
 &
TxnReq
, 
INT32
 &
iT¿deTy³
, 
boŞ
 &
bExecutÜIsAccouÁOwÃr
)

841 
TId’t
 
iCu¡om”Id
;

842 
eCu¡om”T›r
 
iCu¡om”T›r
;

843 
TId’t
 
CID_1
, 
CID_2
;

844 
boŞ
 
bM¬k‘
;

845 
INT32
 
iAdd™iÚ®P”ms
;

846 
UINT
 
iSymbIndex
;

847 
TId’t
 
iFÏtFeSymbIndex
;

848 
eT¿deTy³ID
 
eT¿deTy³
;

852 
	`G’”©eNÚUnifÜmRªdomCu¡om”Id
(
iCu¡om”Id
, 
iCu¡om”T›r
);

856 
m_HŞdšgs
.
	`G’”©eRªdomAccouÁSecur™y
(
iCu¡om”Id
,

857 
iCu¡om”T›r
,

858 &
TxnReq
.
acù_id
,

859 &
iFÏtFeSymbIndex
,

860 &
iSymbIndex
);

863 
iAdd™iÚ®P”ms
 = 
m_AccsAndP”ms
.
	`G‘NumP”msFÜCA
(
TxnReq
.
acù_id
);

865 ià(
iAdd™iÚ®P”ms
 == 0)

867 
m_P”sÚ
.
	`G‘Fœ¡La¡AndTaxID
(
iCu¡om”Id
, 
TxnReq
.
exec_f_Çme
,

868 
TxnReq
.
exec_l_Çme
, TxnReq.
exec_x_id
);

870 
bExecutÜIsAccouÁOwÃr
 = 
Œue
;

883 
exec_is_owÃr
 = (
m_pDriv”CETxnS‘tšgs
->
TO_£‰šgs
.
cur
.exec_is_owÃ¸- 
iP”ûÁAccouÁAdd™iÚ®P”missiÚs_0
) * 100 / (100 - iPercentAccountAdditionalPermissions_0);

885 iàĞ
m_ºd
.
	`RndP”ûÁ
(
exec_is_owÃr
) )

887 
m_P”sÚ
.
	`G‘Fœ¡La¡AndTaxID
(
iCu¡om”Id
, 
TxnReq
.
exec_f_Çme
,

888 
TxnReq
.
exec_l_Çme
, TxnReq.
exec_x_id
);

890 
bExecutÜIsAccouÁOwÃr
 = 
Œue
;

894 ià(
iAdd™iÚ®P”ms
 == 1)

897 
m_AccsAndP”ms
.
	`G‘CIDsFÜP”missiÚs
(
TxnReq
.
acù_id
, 
iCu¡om”Id
, &
CID_1
, 
NULL
);

899 
m_P”sÚ
.
	`G‘Fœ¡La¡AndTaxID
(
CID_1
, 
TxnReq
.
exec_f_Çme
,

900 
TxnReq
.
exec_l_Çme
, TxnReq.
exec_x_id
);

905 
m_AccsAndP”ms
.
	`G‘CIDsFÜP”missiÚs
(
TxnReq
.
acù_id
, 
iCu¡om”Id
, &
CID_1
, &
CID_2
);

907 
m_P”sÚ
.
	`G‘Fœ¡La¡AndTaxID
(
CID_2
, 
TxnReq
.
exec_f_Çme
,

908 
TxnReq
.
exec_l_Çme
, TxnReq.
exec_x_id
);

911 
bExecutÜIsAccouÁOwÃr
 = 
çl£
;

919 ià(
m_ºd
.
	`RndP”ûÁ
(
m_pDriv”CETxnS‘tšgs
->
TO_£‰šgs
.
cur
.
£cur™y_by_symbŞ
))

922 
m_pSecur™›s
->
	`C»©eSymbŞ
Ğ
iFÏtFeSymbIndex
, 
TxnReq
.
symbŞ
, 
¡©ic_ÿ¡
<>(( TxnReq.symbol )));

924 
TxnReq
.
co_Çme
[0] = '\0';

925 
TxnReq
.
issue
[0] = '\0';

930 
m_pCom·n›s
->
	`C»©eName
Ğ
m_pSecur™›s
->
	`G‘Com·nyIndex
Ğ
iFÏtFeSymbIndex
 ), 
TxnReq
.
co_Çme
, 
¡©ic_ÿ¡
<>(( TxnReq.co_name )));

932 
	`¡ºıy
(
TxnReq
.
issue
, 
m_pSecur™›s
->
	`G‘RecÜd
(
iFÏtFeSymbIndex
)->
S_ISSUE
,

933 (
TxnReq
.
issue
));

935 
TxnReq
.
symbŞ
[0] = '\0';

938 
TxnReq
.
Œade_qty
 = 
cTRADE_QTY_SIZES
[
m_ºd
.
	`RndIÁRªge
(0, 
cNUM_TRADE_QTY_SIZES
 - 1)];

939 
TxnReq
.
»que¡ed_´iû
 = 
m_ºd
.
	`RndDoubËInüRªge
(
fMšSecPriû
, 
fMaxSecPriû
, 0.01);

942 
bM¬k‘
 = 
m_ºd
.
	`RndP”ûÁ
(
m_pDriv”CETxnS‘tšgs
->
TO_£‰šgs
.
cur
.
m¬k‘
);

945 ià(
m_ºd
.
	`RndP”ûÁ
(
m_pDriv”CETxnS‘tšgs
->
TO_£‰šgs
.
cur
.
buy_Üd”s
))

947 ià(
bM¬k‘
)

950 
eT¿deTy³
 = 
eM¬k‘Buy
;

955 
eT¿deTy³
 = 
eLim™Buy
;

959 
TxnReq
.
ty³_is_m¬gš
 = 
m_ºd
.
	`RndP”ûÁ
(

961 
m_pDriv”CETxnS‘tšgs
->
TO_£‰šgs
.
cur
.
ty³_is_m¬gš
 *

963 
m_pDriv”CETxnS‘tšgs
->
TO_£‰šgs
.
cur
.
buy_Üd”s
);

967 ià(
bM¬k‘
)

970 
eT¿deTy³
 = 
eM¬k‘S–l
;

975 ià(
m_ºd
.
	`RndP”ûÁ
(
m_pDriv”CETxnS‘tšgs
->
TO_£‰šgs
.
cur
.
¡İ_loss
))

978 
eT¿deTy³
 = 
eStİLoss
;

983 
eT¿deTy³
 = 
eLim™S–l
;

987 
TxnReq
.
ty³_is_m¬gš
 = 
çl£
;

989 
iT¿deTy³
 = 
eT¿deTy³
;

992 
TxnReq
.
is_lifo
 = 
m_ºd
.
	`RndP”ûÁ
(
m_pDriv”CETxnS‘tšgs
->
TO_£‰šgs
.
cur
.
lifo
);

995 
	`¡ºıy
(
TxnReq
.
Œade_ty³_id
,

996 (
m_pT¿deTy³
->
	`G‘RecÜd
(
eT¿deTy³
))->
TT_ID
,

997 (
TxnReq
.
Œade_ty³_id
));

1000 
	`¡ºıy
(
TxnReq
.
¡_³ndšg_id
,

1001 (
m_pStusTy³
->
	`G‘RecÜd
(
eP’dšg
))->
ST_ID
,

1002 (
TxnReq
.
¡_³ndšg_id
));

1003 
	`¡ºıy
(
TxnReq
.
¡_subm™‹d_id
,

1004 (
m_pStusTy³
->
	`G‘RecÜd
(
eSubm™‹d
))->
ST_ID
,

1005 (
TxnReq
.
¡_subm™‹d_id
));

1007 
TxnReq
.
rŞl_™_back
 = ( 
m_iT¿deOrd”RŞlbackLev–
 >ğ
m_ºd
.
	`RndIÁRªge
Ğ1, 
m_iT¿deOrd”RŞlbackLim™
 ));

1011 
	}
}

1022 
	gCCETxnIÅutG’”©Ü
::
	$G’”©eT¿deStusIÅut
(
TT¿deStusTxnIÅut
 &
TxnReq
)

1024 
TId’t
 
iCu¡om”Id
;

1025 
eCu¡om”T›r
 
iCu¡om”T›r
;

1028 
	`G’”©eNÚUnifÜmRªdomCu¡om”Id
(
iCu¡om”Id
, 
iCu¡om”T›r
);

1031 
m_AccsAndP”ms
.
	`G’”©eRªdomAccouÁId
(
m_ºd
, 
iCu¡om”Id
, 
iCu¡om”T›r
, &
TxnReq
.
acù_id
, 
NULL
);

1032 
	}
}

1043 
	gCCETxnIÅutG’”©Ü
::
	$G’”©eT¿deUpd©eIÅut
(
TT¿deUpd©eTxnIÅut
 &
TxnReq
)

1045 
INT32
 
iTh»shŞd
;

1047 
iTh»shŞd
 = 
m_ºd
.
	`RndG’”©eIÁeg”P”ûÁage
();

1049 
	`mem£t
(&
TxnReq
,8 , (TxnReq));

1051 ifĞ
iTh»shŞd
 <ğ
m_pDriv”CETxnS‘tšgs
->
TU_£‰šgs
.
cur
.
do_äame1
 )

1054 
TxnReq
.
äame_to_execu‹
 = 1;

1055 
TxnReq
.
max_Œades
 = 
m_pDriv”CETxnS‘tšgs
->
TU_£‰šgs
.
cur
.
MaxRowsF¿me1
;

1056 
TxnReq
.
max_upd©es
 = 
m_pDriv”CETxnS‘tšgs
->
TU_£‰šgs
.
cur
.
MaxRowsToUpd©eF¿me1
;

1059 
ii
, 
jj
;

1060 
boŞ
 
Acû±ed
;

1061 
TT¿de
 
TID
;

1063  
ii
 = 0; i˜< 
TxnReq
.
max_Œades
; ii++ )

1065 
Acû±ed
 = 
çl£
;

1066  ! 
Acû±ed
 )

1068 
TID
 = 
	`G’”©eNÚUnifÜmT¿deID
(
T¿deUpd©eAV®ueFÜT¿deIDG’F¿me1
,

1069 
T¿deUpd©eSV®ueFÜT¿deIDG’F¿me1
);

1070 
jj
 = 0;

1071  
jj
 < 
ii
 && 
TxnReq
.
Œade_id
[jj] !ğ
TID
 )

1073 
jj
++;

1075 ifĞ
jj
 =ğ
ii
 )

1078 
TxnReq
.
Œade_id
[
ii
] = 
TID
;

1079 
Acû±ed
 = 
Œue
;

1085 
TxnReq
.
acù_id
 = 0;

1086 
TxnReq
.
max_acù_id
 = 0;

1087 
	`mem£t
Ğ
TxnReq
.
symbŞ
, 0, ( TxnReq.symbol ));

1088 
	`mem£t
Ğ&
TxnReq
.
¡¬t_Œade_dts
, 0, ( TxnReq.start_trade_dts ));

1089 
	`mem£t
Ğ&
TxnReq
.
’d_Œade_dts
, 0, ( TxnReq.end_trade_dts ));

1092 ifĞ
iTh»shŞd
 <ğ
m_pDriv”CETxnS‘tšgs
->
TU_£‰šgs
.
cur
.
do_äame1
 +

1093 
m_pDriv”CETxnS‘tšgs
->
TU_£‰šgs
.
cur
.
do_äame2
 )

1096 
TxnReq
.
äame_to_execu‹
 = 2;

1097 
TxnReq
.
max_Œades
 = 
m_pDriv”CETxnS‘tšgs
->
TU_£‰šgs
.
cur
.
MaxRowsF¿me2
;

1098 
TxnReq
.
max_upd©es
 = 
m_pDriv”CETxnS‘tšgs
->
TU_£‰šgs
.
cur
.
MaxRowsToUpd©eF¿me2
;

1099 
TxnReq
.
acù_id
 = 
	`G’”©eRªdomCu¡om”AccouÁId
();

1101 
	`G’”©eNÚUnifÜmT¿deDTS
Ğ
TxnReq
.
¡¬t_Œade_dts
,

1102 
m_iT¿deUpd©eF¿me2MaxTimeInMliSecÚds
,

1103 
T¿deUpd©eAV®ueFÜTimeG’F¿me2
,

1104 
T¿deUpd©eSV®ueFÜTimeG’F¿me2
 );

1107 
m_EndTime
.
	`G‘TimeSmp
(&
TxnReq
.
’d_Œade_dts
);

1110 
TxnReq
.
max_acù_id
 = 0;

1111 
	`mem£t
Ğ
TxnReq
.
symbŞ
, 0, ( TxnReq.symbol ));

1112 
	`mem£t
Ğ
TxnReq
.
Œade_id
, 0, ( TxnReq.trade_id ));

1118 
TxnReq
.
äame_to_execu‹
 = 3;

1119 
TxnReq
.
max_Œades
 = 
m_pDriv”CETxnS‘tšgs
->
TU_£‰šgs
.
cur
.
MaxRowsF¿me3
;

1120 
TxnReq
.
max_upd©es
 = 
m_pDriv”CETxnS‘tšgs
->
TU_£‰šgs
.
cur
.
MaxRowsToUpd©eF¿me3
;

1122 
m_pSecur™›s
->
	`C»©eSymbŞ
Ğ
m_ºd
.
	`NURnd
Ğ0, 
m_iAùiveSecur™yCouÁ
-1,

1123 
T¿deUpd©eAV®ueFÜSymbŞF¿me3
,

1124 
T¿deUpd©eSV®ueFÜSymbŞF¿me3
 ),

1125 
TxnReq
.
symbŞ
,

1126 
¡©ic_ÿ¡
<>(Ğ
TxnReq
.
symbŞ
 )));

1128 
	`G’”©eNÚUnifÜmT¿deDTS
Ğ
TxnReq
.
¡¬t_Œade_dts
,

1129 
m_iT¿deUpd©eF¿me3MaxTimeInMliSecÚds
,

1130 
T¿deUpd©eAV®ueFÜTimeG’F¿me3
,

1131 
T¿deUpd©eSV®ueFÜTimeG’F¿me3
 );

1134 
m_EndTime
.
	`G‘TimeSmp
(&
TxnReq
.
’d_Œade_dts
);

1136 
TxnReq
.
max_acù_id
 = 
m_AccsAndP”ms
.
	`G‘EndšgCA_ID
Ğ
m_iAùiveCu¡om”CouÁ
 ) ;

1139 
TxnReq
.
acù_id
 = 0;

1140 
	`mem£t
Ğ
TxnReq
.
Œade_id
, 0, ( TxnReq.trade_id ));

1143 
	}
}

	@src/workload/tpce/egen/CETxnMixGenerator.cpp

42 
	~"wÜklßd/û/eg’/CETxnMixG’”©Ü.h
"

44 
usšg
 
Çme¥aû
 
	gTPCE
;

46 
	gCCETxnMixG’”©Ü
::
	$CCETxnMixG’”©Ü
ĞcÚ¡ 
PDriv”CETxnS‘tšgs
 
pDriv”CETxnS‘tšgs
, 
CBa£Logg”
* 
pLogg”
 )

47 : 
	`m_pDriv”CETxnS‘tšgs
Ğ
pDriv”CETxnS‘tšgs
 )

48 , 
	`m_ºd
Ğ
RNGS“dBa£TxnMixG’”©Ü
 )

49 , 
	`m_pLogg”
Ğ
pLogg”
 )

50 , 
	`m_iTxnA¼ayCu¼’tIndex
( 0 )

51 , 
	$m_pTxnA¼ay
Ğ
NULL
 )

54 
	}
}

56 
	gCCETxnMixG’”©Ü
::
	$CCETxnMixG’”©Ü
ĞcÚ¡ 
PDriv”CETxnS‘tšgs
 
pDriv”CETxnS‘tšgs
, 
RNGSEED
 
RNGS“d
, 
CBa£Logg”
* 
pLogg”
 )

57 : 
	`m_pDriv”CETxnS‘tšgs
Ğ
pDriv”CETxnS‘tšgs
 )

58 , 
	`m_ºd
Ğ
RNGS“d
 )

59 , 
	`m_pLogg”
Ğ
pLogg”
 )

60 , 
	`m_iTxnA¼ayCu¼’tIndex
( 0 )

61 , 
	$m_pTxnA¼ay
Ğ
NULL
 )

64 
	}
}

66 
RNGSEED
 
	gCCETxnMixG’”©Ü
::
	$G‘RNGS“d
( )

68 Ğ
m_ºd
.
	`G‘S“d
() );

69 
	}
}

71 
	gCCETxnMixG’”©Ü
::
	$S‘RNGS“d
Ğ
RNGSEED
 
RNGS“d
 )

73 
m_ºd
.
	`S‘S“d
Ğ
RNGS“d
 );

74 
	}
}

76 
	gCCETxnMixG’”©Ü
::~
	$CCETxnMixG’”©Ü
()

78 ià(
m_pTxnA¼ay
 !ğ
NULL
)

80 
d–‘e
[] 
m_pTxnA¼ay
;

81 
m_pTxnA¼ay
 = 
NULL
;

83 
	}
}

85 
	gCCETxnMixG’”©Ü
::
	$Upd©eTuÇbËs
( )

87 
INT32
 
i
;

88 
INT32
 
Brok”VŞumeMixLim™
;

89 
INT32
 
Cu¡om”Pos™iÚMixLim™
;

90 
INT32
 
M¬k‘W©chMixLim™
;

91 
INT32
 
Secur™yD‘aMixLim™
;

92 
INT32
 
T¿deLookupMixLim™
;

93 
INT32
 
T¿deOrd”MixLim™
;

94 
INT32
 
T¿deStusMixLim™
;

95 
INT32
 
T¿deUpd©eMixLim™
;

98 
m_CET¿n§ùiÚMixTÙ®
 =

99 
m_pDriv”CETxnS‘tšgs
->
TxnMixG’”©Ü_£‰šgs
.
cur
.
Brok”VŞumeMixLev–
 +

100 
m_pDriv”CETxnS‘tšgs
->
TxnMixG’”©Ü_£‰šgs
.
cur
.
Cu¡om”Pos™iÚMixLev–
 +

101 
m_pDriv”CETxnS‘tšgs
->
TxnMixG’”©Ü_£‰šgs
.
cur
.
M¬k‘W©chMixLev–
 +

102 
m_pDriv”CETxnS‘tšgs
->
TxnMixG’”©Ü_£‰šgs
.
cur
.
Secur™yD‘aMixLev–
 +

103 
m_pDriv”CETxnS‘tšgs
->
TxnMixG’”©Ü_£‰šgs
.
cur
.
T¿deLookupMixLev–
 +

104 
m_pDriv”CETxnS‘tšgs
->
TxnMixG’”©Ü_£‰šgs
.
cur
.
T¿deOrd”MixLev–
 +

105 
m_pDriv”CETxnS‘tšgs
->
TxnMixG’”©Ü_£‰šgs
.
cur
.
T¿deStusMixLev–
 +

106 
m_pDriv”CETxnS‘tšgs
->
TxnMixG’”©Ü_£‰šgs
.
cur
.
T¿deUpd©eMixLev–
;

108 
T¿deStusMixLim™
 = 
m_pDriv”CETxnS‘tšgs
->
TxnMixG’”©Ü_£‰šgs
.
cur
.
T¿deStusMixLev–
;

109 
M¬k‘W©chMixLim™
 = 
m_pDriv”CETxnS‘tšgs
->
TxnMixG’”©Ü_£‰šgs
.
cur
.
M¬k‘W©chMixLev–
 + 
T¿deStusMixLim™
;

110 
Secur™yD‘aMixLim™
 = 
m_pDriv”CETxnS‘tšgs
->
TxnMixG’”©Ü_£‰šgs
.
cur
.
Secur™yD‘aMixLev–
 + 
M¬k‘W©chMixLim™
;

111 
Cu¡om”Pos™iÚMixLim™
 = 
m_pDriv”CETxnS‘tšgs
->
TxnMixG’”©Ü_£‰šgs
.
cur
.
Cu¡om”Pos™iÚMixLev–
 + 
Secur™yD‘aMixLim™
;

112 
T¿deOrd”MixLim™
 = 
m_pDriv”CETxnS‘tšgs
->
TxnMixG’”©Ü_£‰šgs
.
cur
.
T¿deOrd”MixLev–
 + 
Cu¡om”Pos™iÚMixLim™
;

113 
T¿deLookupMixLim™
 = 
m_pDriv”CETxnS‘tšgs
->
TxnMixG’”©Ü_£‰šgs
.
cur
.
T¿deLookupMixLev–
 + 
T¿deOrd”MixLim™
;

114 
T¿deUpd©eMixLim™
 = 
m_pDriv”CETxnS‘tšgs
->
TxnMixG’”©Ü_£‰šgs
.
cur
.
T¿deUpd©eMixLev–
 + 
T¿deLookupMixLim™
;

115 
Brok”VŞumeMixLim™
 = 
m_pDriv”CETxnS‘tšgs
->
TxnMixG’”©Ü_£‰šgs
.
cur
.
Brok”VŞumeMixLev–
 + 
T¿deUpd©eMixLim™
;

119 ià(
m_pTxnA¼ay
 !ğ
NULL
)

121 
d–‘e
[] 
m_pTxnA¼ay
;

122 
m_pTxnA¼ay
 = 
NULL
;

125 
m_pTxnA¼ay
 = 
Ãw
 [
m_CET¿n§ùiÚMixTÙ®
];

129 
i
 = 0; i < 
T¿deStusMixLim™
; ++i)

131 
m_pTxnA¼ay
[
i
] = 
TRADE_STATUS
;

133 ; 
i
 < 
M¬k‘W©chMixLim™
; ++i)

135 
m_pTxnA¼ay
[
i
] = 
MARKET_WATCH
;

137 ; 
i
 < 
Secur™yD‘aMixLim™
; ++i)

139 
m_pTxnA¼ay
[
i
] = 
SECURITY_DETAIL
;

141 ; 
i
 < 
Cu¡om”Pos™iÚMixLim™
; ++i)

143 
m_pTxnA¼ay
[
i
] = 
CUSTOMER_POSITION
;

145 ; 
i
 < 
T¿deOrd”MixLim™
; ++i)

147 
m_pTxnA¼ay
[
i
] = 
TRADE_ORDER
;

149 ; 
i
 < 
T¿deLookupMixLim™
; ++i)

151 
m_pTxnA¼ay
[
i
] = 
TRADE_LOOKUP
;

153 ; 
i
 < 
T¿deUpd©eMixLim™
; ++i)

155 
m_pTxnA¼ay
[
i
] = 
TRADE_UPDATE
;

157 ; 
i
 < 
Brok”VŞumeMixLim™
; ++i)

159 
m_pTxnA¼ay
[
i
] = 
BROKER_VOLUME
;

162 
m_iTxnA¼ayCu¼’tIndex
 = 0;

165 
m_pLogg”
->
	`S’dToLogg”
(
m_pDriv”CETxnS‘tšgs
->
TxnMixG’”©Ü_£‰šgs
);

166 
	}
}

168 
	gCCETxnMixG’”©Ü
::
	$G’”©eNextTxnTy³
()

182 
INT32
 
ºd
 = 
m_ºd
.
	`RndIÁRªge
Ğ
m_iTxnA¼ayCu¼’tIndex
, 
m_CET¿n§ùiÚMixTÙ®
 - 1);

184 
iTxnTy³
 = 
m_pTxnA¼ay
[
ºd
];

188 
m_pTxnA¼ay
[
ºd
] = m_pTxnA¼ay[
m_iTxnA¼ayCu¼’tIndex
];

189 
m_pTxnA¼ay
[
m_iTxnA¼ayCu¼’tIndex
] = 
iTxnTy³
;

191 
m_iTxnA¼ayCu¼’tIndex
 = (m_iTxnA¼ayCu¼’tIndex + 1è% 
m_CET¿n§ùiÚMixTÙ®
;

193  
iTxnTy³
;

194 
	}
}

	@src/workload/tpce/egen/CustomerSelection.cpp

42 
	~"wÜklßd/û/eg’/EG’TabËs_¡dafx.h
"

44 
usšg
 
Çme¥aû
 
	gTPCE
;

49 
	gCCu¡om”S–eùiÚ
::
	$CCu¡om”S–eùiÚ
()

50 : 
	`m_pRND
Ğ
NULL
 )

51 , 
	`m_iS¹FromCu¡om”
Ğ0 + 
iTId’tShiá
)

52 , 
	`m_iCu¡om”CouÁ
( 0 )

53 , 
	`m_bP¬t™iÚByCID
Ğ
çl£
 )

54 , 
	`m_iP¬t™iÚP”ûÁ
( 0 )

55 , 
	`m_iMyS¹FromCu¡om”
Ğ0 + 
iTId’tShiá
)

56 , 
	$m_iMyCu¡om”CouÁ
( 0 )

58 
	}
}

63 
	gCCu¡om”S–eùiÚ
::
	$CCu¡om”S–eùiÚ
Ğ
CRªdom
* 
pRND
,

64 
TId’t
 
iS¹FromCu¡om”
,

65 
TId’t
 
iCu¡om”CouÁ
)

66 : 
	`m_pRND
Ğ
pRND
 )

67 , 
	`m_iS¹FromCu¡om”
Ğ
iS¹FromCu¡om”
 + 
iTId’tShiá
)

68 , 
	`m_iCu¡om”CouÁ
Ğ
iCu¡om”CouÁ
 )

69 , 
	`m_bP¬t™iÚByCID
Ğ
çl£
 )

70 , 
	`m_iP¬t™iÚP”ûÁ
( 0 )

71 , 
	`m_iMyS¹FromCu¡om”
Ğ0 + 
iTId’tShiá
)

72 , 
	$m_iMyCu¡om”CouÁ
( 0 )

74 
	}
}

79 
	gCCu¡om”S–eùiÚ
::
	$CCu¡om”S–eùiÚ
Ğ
CRªdom
* 
pRND
,

80 
TId’t
 
iS¹FromCu¡om”
,

81 
TId’t
 
iCu¡om”CouÁ
,

82 
iP¬t™iÚP”ûÁ
,

83 
TId’t
 
iMyS¹FromCu¡om”
,

84 
TId’t
 
iMyCu¡om”CouÁ
)

85 : 
	`m_pRND
Ğ
pRND
 )

86 , 
	`m_iS¹FromCu¡om”
Ğ
iS¹FromCu¡om”
 + 
iTId’tShiá
)

87 , 
	`m_iCu¡om”CouÁ
Ğ
iCu¡om”CouÁ
 )

89 , 
	`m_bP¬t™iÚByCID
Ğ
Œue
 )

90 , 
	`m_iP¬t™iÚP”ûÁ
Ğ
iP¬t™iÚP”ûÁ
 )

91 , 
	`m_iMyS¹FromCu¡om”
Ğ
iMyS¹FromCu¡om”
 + 
iTId’tShiá
)

92 , 
	$m_iMyCu¡om”CouÁ
Ğ
iMyCu¡om”CouÁ
 )

94 if(Ğ
iS¹FromCu¡om”
 =ğ
iMyS¹FromCu¡om”
 )&&Ğ
iCu¡om”CouÁ
 =ğ
iMyCu¡om”CouÁ
 ))

98 
m_bP¬t™iÚByCID
 = 
çl£
;

100 
	}
}

105 
	gCCu¡om”S–eùiÚ
::
	$S‘P¬t™iÚRªge
(
TId’t
 
iS¹FromCu¡om”
, TId’ˆ
iCu¡om”CouÁ
)

107 ifĞ
m_bP¬t™iÚByCID
 )

109 
m_iMyS¹FromCu¡om”
 = 
iS¹FromCu¡om”
;

110 
m_iMyCu¡om”CouÁ
 = 
iCu¡om”CouÁ
;

112 
	}
}

117 
TId’t
 
	gCCu¡om”S–eùiÚ
::
	$P”mu‹
(
TId’t
 
iLow
, TId’ˆ
iHigh
)

119  ((677 * 
iLow
 + 33 * (
iHigh
+1)) % 1000);

120 
	}
}

125 
TId’t
 
	gCCu¡om”S–eùiÚ
::
	$Inv”£P”mu‹
(
TId’t
 
iLow
, TId’ˆ
iHigh
)

129  (((((613 * (
iLow
 - 33 * (
iHigh
+1))) % 1000) + 1000) % 1000));

130 
	}
}

135 
UINT
 
	gCCu¡om”S–eùiÚ
::
	$G‘Inv”£CID
(
TId’t
 
C_ID
)

137 
UINT
 
iCHigh
 = (UINT)
	`CHigh
(
C_ID
);

138 
UINT
 
iInv”£CID
 = (UINT)
	`Inv”£P”mu‹
(
	`CLow
(
C_ID
), 
iCHigh
);

140 ià(
iInv”£CID
 < 200)

142  ((3 * 
iInv”£CID
 + (
iCHigh
 + 1)) % 200);

146 ià(
iInv”£CID
 < 800)

148  (((59 * 
iInv”£CID
 + 47 * (
iCHigh
 + 1)) % 600) + 200);

152  (((23 * 
iInv”£CID
 + 17 * (
iCHigh
 + 1)) % 200) + 800);

155 
	}
}

160 
eCu¡om”T›r
 
	gCCu¡om”S–eùiÚ
::
	$G‘T›r
(
TId’t
 
C_ID
)

162 
TId’t
 
iRevC_ID
 = 
	`Inv”£P”mu‹
(
	`CLow
(
C_ID
), 
	`CHigh
(C_ID));

164 ià(
iRevC_ID
 < 200)

166  
eCu¡om”T›rOÃ
;

170 ià(
iRevC_ID
 < 800)

172  
eCu¡om”T›rTwo
;

176  
eCu¡om”T›rTh»e
;

179 
	}
}

184 
	gCCu¡om”S–eùiÚ
::
	$G’”©eRªdomCu¡om”
(
TId’t
 &
C_ID
, 
eCu¡om”T›r
 &
C_TIER
)

188 ià(
m_pRND
 =ğ
NULL
)

193 
fCW
 = 
m_pRND
->
	`RndDoubËInüRªge
(0.0001, 2000, 0.000000001);

197 
TId’t
 
iCHigh
;

198 ifĞ
m_bP¬t™iÚByCID
 && 
m_pRND
->
	`RndP”ûÁ
Ğ
m_iP¬t™iÚP”ûÁ
 ))

201 
iCHigh
 = ( 
m_pRND
->
	`RndIÁ64Rªge
Ğ
m_iMyS¹FromCu¡om”
,

202 
m_iMyS¹FromCu¡om”
 + 
m_iMyCu¡om”CouÁ
 - 1 ) - 1 )

208 
iCHigh
 = ( 
m_pRND
->
	`RndIÁ64Rªge
Ğ
m_iS¹FromCu¡om”
,

209 
m_iS¹FromCu¡om”
 + 
m_iCu¡om”CouÁ
 - 1 ) - 1 )

215 
iCLow
;

217 ià(
fCW
 <= 200)

221 
iCLow
 = (è
	`û
Ğ
	`sq¹
(22500 + 500 * 
fCW
) - 151 );

223 
C_TIER
 = 
eCu¡om”T›rOÃ
;

227 ià(
fCW
 <=1400)

231 
iCLow
 = (è
	`û
Ğ
	`sq¹
(290000 + 1000 * 
fCW
) - 501 );

233 
C_TIER
 = 
eCu¡om”T›rTwo
;

239 
iCLow
 = (è
	`û
Ğ149 + 
	`sq¹
(500 * 
fCW
 - 277500) );

241 
C_TIER
 = 
eCu¡om”T›rTh»e
;

245 
C_ID
 = 
iCHigh
 * 1000 + 
	`P”mu‹
(
iCLow
, iCHigh) + 1;

246 
	}
}

	@src/workload/tpce/egen/CustomerTable.cpp

37 
	~"wÜklßd/û/eg’/EG’TabËs_¡dafx.h
"

39 
usšg
 
Çme¥aû
 
	gTPCE
;

41 
Çme¥aû
 
	gTPCE


43 cÚ¡ *
	gszUSA»aCode
="011";

44 
	gEMAIL_DOMAINs
[
iNumEMAIL_DOMAINs
][15] = {"@msn.com","@hotmail.com","@rr.com","@netzero.com","@earthlink.com","@attbi.com"};

48 cÚ¡ 
	giP”ûÁCu¡om”sInC_TIER_1
 = 20;

49 cÚ¡ 
	giP”ûÁCu¡om”sInC_TIER_2
 = 60;

50 cÚ¡ 
	giP”ûÁCu¡om”sInC_TIER_3
 = 100 - 
iP”ûÁCu¡om”sInC_TIER_1
 - 
iP”ûÁCu¡om”sInC_TIER_2
;

53 cÚ¡ 
	giP”ûÁUnd”18
 = 5;

54 cÚ¡ 
	giP”ûÁB‘w“n19And24
 = 16;

55 cÚ¡ 
	giP”ûÁB‘w“n25And34
 = 17;

56 cÚ¡ 
	giP”ûÁB‘w“n35And44
 = 19;

57 cÚ¡ 
	giP”ûÁB‘w“n45And54
 = 16;

58 cÚ¡ 
	giP”ûÁB‘w“n55And64
 = 11;

59 cÚ¡ 
	giP”ûÁB‘w“n65And74
 = 8;

60 cÚ¡ 
	giP”ûÁB‘w“n75And84
 = 7;

61 cÚ¡ 
	giP”ûÁOv”85
 = 1;

65 cÚ¡ 
	giRNGSkOÃRowCu¡om”
 = 35;

70 
	gCCu¡om”TabË
::
	$CCu¡om”TabË
(
CIÅutFes
 
šputFes
,

71 
TId’t
 
iCu¡om”CouÁ
,

72 
TId’t
 
iS¹FromCu¡om”
)

73 : 
TabËTem¶©e
<
CUSTOMER_ROW
>()

74 , 
	`m_iRowsToG’”©e
(
iCu¡om”CouÁ
)

75 , 
	`m_³rsÚ
(
šputFes
, 
iS¹FromCu¡om”
, 
Œue
)

76 , 
	`m_PhÚes
(
šputFes
.
A»aCodes
)

77 , 
	`m_StusTy³Fe
(
šputFes
.
StusTy³
)

78 , 
	`m_iS¹FromCu¡om”
(
iS¹FromCu¡om”
)

79 , 
	$m_iCu¡om”CouÁ
(
iCu¡om”CouÁ
)

81 
m_iCom·nyCouÁ
 = 
šputFes
.
Com·ny
->
	`G‘Size
();

82 
m_iExchªgeCouÁ
 = 
šputFes
.
Exchªge
->
	`G‘Size
();

83 
	}
}

88 
	gCCu¡om”TabË
::
	$In™NextLßdUn™
()

90 
m_ºd
.
	`S‘S“d
(m_ºd.
	`RndNthEËm’t
(
RNGS“dTabËDeçuÉ
,

91 ((
RNGSEED
)
m_iLa¡RowNumb”
 + 
m_iS¹FromCu¡om”
 - 1) *

92 
iRNGSkOÃRowCu¡om”
));

94 
	`CË¬RecÜd
();

96 
m_³rsÚ
.
	`In™NextLßdUn™
();

97 
	}
}

102 
TId’t
 
	gCCu¡om”TabË
::
	$G’”©eNextC_ID
()

104 ià(
m_iLa¡RowNumb”
 % 
iDeçuÉLßdUn™Size
 == 0)

106 
	`In™NextLßdUn™
();

109 ++
m_iLa¡RowNumb”
;

110 
m_bMÜeRecÜds
 = 
m_iLa¡RowNumb”
 < 
m_iRowsToG’”©e
;

112 
m_row
.
C_ID
 = 
m_iLa¡RowNumb”
 + 
m_iS¹FromCu¡om”
 - 1 + 
iTId’tShiá
;

114  
m_row
.
C_ID
;

115 
	}
}

119 
TId’t
 
	gCCu¡om”TabË
::
	$G‘Cu¼’tC_ID
()

121  
m_iLa¡RowNumb”
 + 
m_iS¹FromCu¡om”
 - 1 + 
iTId’tShiá
;

122 
	}
}

127 
	gCCu¡om”TabË
::
	$G‘C_TAX_ID
(
TId’t
 
C_ID
, *
szOuut
)

129 
m_³rsÚ
.
	`G‘TaxID
(
C_ID
, 
szOuut
);

130 
	}
}

135 
	gCCu¡om”TabË
::
	$G’”©eC_ST_ID
()

137 
	`¡ºıy
(
m_row
.
C_ST_ID
, 
m_StusTy³Fe
->
	`G‘RecÜd
(
eAùive
)->
ST_ID
, (m_row.C_ST_ID));

138 
	}
}

143 
	gCCu¡om”TabË
::
	$G’”©eP”sÚInfo
()

146 
m_³rsÚ
.
	`G‘Fœ¡La¡AndTaxID
(
m_row
.
C_ID
, m_row.
C_F_NAME
, m_row.
C_L_NAME
, m_row.
C_TAX_ID
);

148 
m_row
.
C_GNDR
 = 
m_³rsÚ
.
	`G‘G’d”
(m_row.
C_ID
);

150 
m_row
.
C_M_NAME
[0] = 
m_³rsÚ
.
	`G‘MiddËName
(m_row.
C_ID
);

151 
m_row
.
C_M_NAME
[1] = '\0';

152 
	}
}

157 
eCu¡om”T›r
 
	gCCu¡om”TabË
::
	$G‘C_TIER
(
TId’t
 
C_ID
)

159  
m_Cu¡om”S–eùiÚ
.
	`G‘T›r
(
C_ID
);

160 
	}
}

165 
	gCCu¡om”TabË
::
	$G’”©eC_DOB
()

168 
age_b¿ck‘s
[]={10, 19, 25, 35, 45, 55, 65, 75, 85, 100};

169 
age_b¿ck‘
;

170 
dob_day¢o_mš
, 
dob_day¢o_max
;

171 
dob_š_days
;

173 
iTh»shŞd
 = 
m_ºd
.
	`RndG’”©eIÁeg”P”ûÁage
();

176 ià(
iTh»shŞd
 <ğ
iP”ûÁUnd”18
)

177 
age_b¿ck‘
 = 0;

179 ià(
iTh»shŞd
 <ğ
iP”ûÁUnd”18
+
iP”ûÁB‘w“n19And24
)

180 
age_b¿ck‘
 = 1;

182 ià(
iTh»shŞd
 <ğ
iP”ûÁUnd”18
+
iP”ûÁB‘w“n19And24
+
iP”ûÁB‘w“n25And34
)

183 
age_b¿ck‘
 = 2;

185 ià(
iTh»shŞd
 <ğ
iP”ûÁUnd”18
+
iP”ûÁB‘w“n19And24
+
iP”ûÁB‘w“n25And34
+

186 
iP”ûÁB‘w“n35And44
)

187 
age_b¿ck‘
 = 3;

189 ià(
iTh»shŞd
 <ğ
iP”ûÁUnd”18
+
iP”ûÁB‘w“n19And24
+
iP”ûÁB‘w“n25And34
+

190 
iP”ûÁB‘w“n35And44
+
iP”ûÁB‘w“n45And54
)

191 
age_b¿ck‘
 = 4;

193 ià(
iTh»shŞd
 <ğ
iP”ûÁUnd”18
+
iP”ûÁB‘w“n19And24
+
iP”ûÁB‘w“n25And34
+

194 
iP”ûÁB‘w“n35And44
+
iP”ûÁB‘w“n45And54
+
iP”ûÁB‘w“n55And64
)

195 
age_b¿ck‘
 = 5;

197 ià(
iTh»shŞd
 <ğ
iP”ûÁUnd”18
+
iP”ûÁB‘w“n19And24
+
iP”ûÁB‘w“n25And34
+

198 
iP”ûÁB‘w“n35And44
+
iP”ûÁB‘w“n45And54
+
iP”ûÁB‘w“n55And64
+
iP”ûÁB‘w“n65And74
)

199 
age_b¿ck‘
 = 6;

201 ià(
iTh»shŞd
 <ğ
iP”ûÁUnd”18
+
iP”ûÁB‘w“n19And24
+
iP”ûÁB‘w“n25And34
+

202 
iP”ûÁB‘w“n35And44
+
iP”ûÁB‘w“n45And54
+
iP”ûÁB‘w“n55And64
+
iP”ûÁB‘w“n65And74
+
iP”ûÁB‘w“n75And84
)

203 
age_b¿ck‘
 = 7;

205 
age_b¿ck‘
 = 8;

206 
	`as£¹
(
age_b¿ck‘
 < 
¡©ic_ÿ¡
<>((
age_b¿ck‘s
)/(age_brackets[0])));

209 
dob_day¢o_mš
 = 
CD©eTime
::
	`YMDtoDayno
(
In™ŸlT¿dePİuÏtiÚBa£Y—r
 - 
age_b¿ck‘s
[
age_b¿ck‘
+1],

210 
In™ŸlT¿dePİuÏtiÚBa£MÚth
,

211 
In™ŸlT¿dePİuÏtiÚBa£Day
) + 1;

212 
dob_day¢o_max
 = 
CD©eTime
::
	`YMDtoDayno
(
In™ŸlT¿dePİuÏtiÚBa£Y—r
 - 
age_b¿ck‘s
[
age_b¿ck‘
],

213 
In™ŸlT¿dePİuÏtiÚBa£MÚth
,

214 
In™ŸlT¿dePİuÏtiÚBa£Day
);

217 
dob_š_days
 = 
m_ºd
.
	`RndIÁRªge
(
dob_day¢o_mš
, 
dob_day¢o_max
);

219 
m_row
.
C_DOB
.
	`S‘
(
dob_š_days
);

220 
	}
}

225 
	gCCu¡om”TabË
::
	$G’”©eC_AD_ID
()

229 
m_row
.
C_AD_ID
 = 
m_iExchªgeCouÁ
 + 
m_iCom·nyCouÁ
 + 
	`G‘Cu¼’tC_ID
();

230 
	}
}

235 
	gCCu¡om”TabË
::
	$G’”©eC_CTRY_1
()

237 
	`¡ºıy
(
m_row
.
C_CTRY_1
, 
szUSA»aCode
, (m_row.C_CTRY_1));

238 
	}
}

243 
	gCCu¡om”TabË
::
	$G’”©eC_CTRY_2
()

245 
	`¡ºıy
(
m_row
.
C_CTRY_2
, 
szUSA»aCode
, (m_row.C_CTRY_2));

246 
	}
}

251 
	gCCu¡om”TabË
::
	$G’”©eC_CTRY_3
()

253 
	`¡ºıy
(
m_row
.
C_CTRY_3
, 
szUSA»aCode
, (m_row.C_CTRY_3));

254 
	}
}

260 
	gCCu¡om”TabË
::
	$G’”©eC_AREA_1
()

262 
RNGSEED
 
OldS“d
;

263 
iTh»shŞd
;

265 
OldS“d
 = 
m_ºd
.
	`G‘S“d
();

267 
m_ºd
.
	`S‘S“d
Ğm_ºd.
	`RndNthEËm’t
Ğ
RNGS“dBa£C_AREA_1
,

268 (
RNGSEED
è
m_row
.
C_ID
 ));

271 
iTh»shŞd
 = 
m_ºd
.
	`RndIÁRªge
(0, 
m_PhÚes
->
	`G‘G»©e¡Key
() - 1);

274 
	`¡ºıy
(
m_row
.
C_AREA_1
, (
m_PhÚes
->
	`G‘RecÜd
(
iTh»shŞd
))->
AREA_CODE
, (m_row.C_AREA_1));

276 
m_ºd
.
	`S‘S“d
Ğ
OldS“d
 );

277 
	}
}

282 
	gCCu¡om”TabË
::
	$G’”©eC_AREA_2
()

284 
RNGSEED
 
OldS“d
;

285 
iTh»shŞd
;

287 
OldS“d
 = 
m_ºd
.
	`G‘S“d
();

289 
m_ºd
.
	`S‘S“d
Ğm_ºd.
	`RndNthEËm’t
Ğ
RNGS“dBa£C_AREA_2
,

290 (
RNGSEED
è
m_row
.
C_ID
 ));

293 
iTh»shŞd
 = 
m_ºd
.
	`RndIÁRªge
(0, 
m_PhÚes
->
	`G‘G»©e¡Key
() - 1);

296 
	`¡ºıy
(
m_row
.
C_AREA_2
, (
m_PhÚes
->
	`G‘RecÜd
(
iTh»shŞd
))->
AREA_CODE
, (m_row.C_AREA_2));

298 
m_ºd
.
	`S‘S“d
Ğ
OldS“d
 );

299 
	}
}

304 
	gCCu¡om”TabË
::
	$G’”©eC_AREA_3
()

306 
RNGSEED
 
OldS“d
;

307 
iTh»shŞd
;

309 
OldS“d
 = 
m_ºd
.
	`G‘S“d
();

311 
m_ºd
.
	`S‘S“d
Ğm_ºd.
	`RndNthEËm’t
Ğ
RNGS“dBa£C_AREA_3
,

312 (
RNGSEED
è
m_row
.
C_ID
 ));

315 
iTh»shŞd
 = 
m_ºd
.
	`RndIÁRªge
(0, 
m_PhÚes
->
	`G‘G»©e¡Key
() - 1);

318 
	`¡ºıy
(
m_row
.
C_AREA_3
, (
m_PhÚes
->
	`G‘RecÜd
(
iTh»shŞd
))->
AREA_CODE
, (m_row.C_AREA_3));

320 
m_ºd
.
	`S‘S“d
Ğ
OldS“d
 );

321 
	}
}

327 
	gCCu¡om”TabË
::
	$G’”©eC_LOCAL_1
()

329 
m_ºd
.
	`RndAÍhaNumFÜm©‹d
(
m_row
.
C_LOCAL_1
, "nnnnnnn");

330 
	}
}

336 
	gCCu¡om”TabË
::
	$G’”©eC_LOCAL_2
()

338 
m_ºd
.
	`RndAÍhaNumFÜm©‹d
(
m_row
.
C_LOCAL_2
, "nnnnnnn");

339 
	}
}

344 
	gCCu¡om”TabË
::
	$G’”©eC_LOCAL_3
()

346 
m_ºd
.
	`RndAÍhaNumFÜm©‹d
(
m_row
.
C_LOCAL_3
, "nnnnnnn");

347 
	}
}

353 
	gCCu¡om”TabË
::
	$G’”©eC_EXT_1
()

355 
iTh»shŞd
 = 
m_ºd
.
	`RndG’”©eIÁeg”P”ûÁage
();

357 ià(
iTh»shŞd
 <= 25)

359 
m_ºd
.
	`RndAÍhaNumFÜm©‹d
(
m_row
.
C_EXT_1
, "nnn");

363 *
m_row
.
C_EXT_1
 = '\0';

365 
	}
}

370 
	gCCu¡om”TabË
::
	$G’”©eC_EXT_2
()

372 
iTh»shŞd
 = 
m_ºd
.
	`RndG’”©eIÁeg”P”ûÁage
();

374 ià(
iTh»shŞd
 <= 15)

376 
m_ºd
.
	`RndAÍhaNumFÜm©‹d
(
m_row
.
C_EXT_2
, "nnn");

380 *
m_row
.
C_EXT_2
 = '\0';

382 
	}
}

387 
	gCCu¡om”TabË
::
	$G’”©eC_EXT_3
()

389 
iTh»shŞd
 = 
m_ºd
.
	`RndG’”©eIÁeg”P”ûÁage
();

391 ià(
iTh»shŞd
 <= 5)

393 
m_ºd
.
	`RndAÍhaNumFÜm©‹d
(
m_row
.
C_EXT_3
, "nnn");

397 *
m_row
.
C_EXT_3
 = '\0';

399 
	}
}

405 
	gCCu¡om”TabË
::
	$G’”©eC_EMAIL_1_ªd_C_EMAIL_2
()

407 
size_t
 
iL’
;

408 
iEma1Index
;

410 
iEma1Index
 = 
m_ºd
.
	`RndIÁRªge
(0, 
iNumEMAIL_DOMAINs
 - 1);

413 
iL’
 = 
	`¡¾’
(
m_row
.
C_L_NAME
);

414 
m_row
.
C_EMAIL_1
[0] = m_row.
C_F_NAME
[0];

415 
	`¡ºıy
(&
m_row
.
C_EMAIL_1
[1], m_row.
C_L_NAME
,

416 (
m_row
.
C_EMAIL_1
) - 1);

417 
	`¡ºıy
(&
m_row
.
C_EMAIL_1
[1+
iL’
],

418 
EMAIL_DOMAINs
[
iEma1Index
],

419 (
m_row
.
C_EMAIL_1
è- 
iL’
 - 1);

422 
m_row
.
C_EMAIL_2
[0] = m_row.
C_F_NAME
[0];

423 
	`¡ºıy
(&
m_row
.
C_EMAIL_2
[1], m_row.
C_L_NAME
,

424 (
m_row
.
C_EMAIL_2
) - 1);

425 
	`¡ºıy
(&
m_row
.
C_EMAIL_2
[1+
iL’
],

426 
EMAIL_DOMAINs
[
m_ºd
.
	`RndIÁRªgeExşude
(0, 
iNumEMAIL_DOMAINs
 - 1, 
iEma1Index
)],

427 (
m_row
.
C_EMAIL_2
è- 
iL’
 - 1);

428 
	}
}

433 
boŞ
 
	gCCu¡om”TabË
::
	$G’”©eNextRecÜd
()

435 
	`G’”©eNextC_ID
();

436 
	`G’”©eC_ST_ID
();

437 
	`G’”©eP”sÚInfo
();

438 
m_row
.
C_TIER
 = (è
	`G‘C_TIER
(m_row.
C_ID
);

439 
	`G’”©eC_DOB
();

440 
	`G’”©eC_AD_ID
();

441 
	`G’”©eC_CTRY_1
();

442 
	`G’”©eC_AREA_1
();

443 
	`G’”©eC_LOCAL_1
();

444 
	`G’”©eC_EXT_1
();

445 
	`G’”©eC_CTRY_2
();

446 
	`G’”©eC_AREA_2
();

447 
	`G’”©eC_LOCAL_2
();

448 
	`G’”©eC_EXT_2
();

449 
	`G’”©eC_CTRY_3
();

450 
	`G’”©eC_AREA_3
();

451 
	`G’”©eC_LOCAL_3
();

452 
	`G’”©eC_EXT_3
();

453 
	`G’”©eC_EMAIL_1_ªd_C_EMAIL_2
();

456  
	`MÜeRecÜds
();

457 
	}
}

	@src/workload/tpce/egen/DM.cpp

42 
	~"wÜklßd/û/eg’/DM.h
"

44 
usšg
 
Çme¥aû
 
	gTPCE
;

46 cÚ¡ 
INT32
 
	giD©aMaš‹ÇnûTabËCouÁ
 = 12;

47 cÚ¡ * 
	gD©aMaš‹ÇnûTabËName
[
iD©aMaš‹ÇnûTabËCouÁ
] =

76 
	gCDM
::
	$AutoS‘RNGS“ds
Ğ
UINT32
 
UniqueId
 )

78 
CD©eTime
 
Now
;

79 
INT32
 
Ba£Y—r
;

80 
INT32
 
Tmp1
, 
Tmp2
;

82 
Now
.
	`G‘YMD
Ğ&
Ba£Y—r
, &
Tmp1
, &
Tmp2
 );

85 
Ba£Y—r
 -= ( BaseYear % 5 );

86 
CD©eTime
 
	`Ba£
Ğ
Ba£Y—r
, 1, 1 );

90 
RNGSEED
 
S“d
;

91 
S“d
 = 
Now
.
	`MSec
() / 100;

96 
S“d
 <<= 11;

97 
S“d
 +ğ(
RNGSEED
è((
INT64
)
Now
.
	`DayNo
(è- (INT64)
Ba£
.DayNo());

105 
S“d
 <<= 33;

109 
S“d
 +ğ
UniqueId
;

112 
m_ºd
.
	`S‘S“d
Ğ
S“d
 );

113 
m_Driv”DMS‘tšgs
.
cur
.
RNGS“d
 = 
S“d
;

114 
	}
}

116 
	gCDM
::
	$In™Ÿlize
( )

118 
m_pLogg”
->
	`S’dToLogg”
(
m_Driv”Glob®S‘tšgs
);

120 
m_iSecur™yCouÁ
 = 
m_pSecur™›s
->
	`G‘AùiveSecur™yCouÁ
();

121 
m_iCom·nyCouÁ
 = 
m_pCom·n›s
->
	`G‘AùiveCom·nyCouÁ
();

122 
m_iS¹FromCom·ny
 = 
m_pCom·n›s
->
	`G‘Com·nyId
(0);

123 
m_iDivisiÚTaxCouÁ
 = 
m_pTaxR©esDivisiÚ
->
	`G‘Size
();

124 
m_iS¹FromCu¡om”
 = 
iDeçuÉS¹FromCu¡om”
 + 
iTId’tShiá
;

125 
	}
}

127 
	gCDM
::
	$CDM
Ğ
CDMSUTIÁ”çû
 *
pSUT
, 
CBa£Logg”
 *
pLogg”
, 
CIÅutFes
 &
šputFes
, 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
, 
INT32
 
iSÿËFaùÜ
, INT32 
iDaysOfIn™ŸlT¿des
, 
UINT32
 
UniqueId
 )

128 : 
	`m_Driv”Glob®S‘tšgs
 ( 
iCÚfigu»dCu¡om”CouÁ
, 
iAùiveCu¡om”CouÁ
, 
iSÿËFaùÜ
, 
iDaysOfIn™ŸlT¿des
 )

129 , 
	`m_Driv”DMS‘tšgs
Ğ
UniqueId
, 0 )

130 , 
	`m_Cu¡om”S–eùiÚ
(&
m_ºd
, 
iDeçuÉS¹FromCu¡om”
, 
iAùiveCu¡om”CouÁ
)

131 , 
	`m_AccsAndP”ms
(
šputFes
, 
iDeçuÉLßdUn™Size
, 
iAùiveCu¡om”CouÁ
, 
iDeçuÉS¹FromCu¡om”
)

132 , 
	`m_pSecur™›s
(
šputFes
.
Secur™›s
)

133 , 
	`m_pCom·n›s
(
šputFes
.
Com·ny
)

134 , 
	`m_pTaxR©esDivisiÚ
(
šputFes
.
TaxR©esDivisiÚ
)

135 , 
	`m_pStusTy³
(
šputFes
.
StusTy³
)

136 , 
	`m_iDivisiÚTaxCouÁ
(0)

137 , 
	`m_D©aMaš‹ÇnûTabËNum
(0)

138 , 
	`m_pSUT
Ğ
pSUT
 )

139 , 
	$m_pLogg”
 ( 
pLogg”
 )

141 
m_pLogg”
->
	`S’dToLogg”
("DM object constructed using constructor 1 (valid for…ublication: YES).");

143 
	`In™Ÿlize
();

144 
	`AutoS‘RNGS“ds
Ğ
UniqueId
 );

146 
m_pLogg”
->
	`S’dToLogg”
(
m_Driv”DMS‘tšgs
);

147 
	}
}

149 
	gCDM
::
	$CDM
Ğ
CDMSUTIÁ”çû
 *
pSUT
, 
CBa£Logg”
 *
pLogg”
, 
CIÅutFes
 &
šputFes
, 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
, 
INT32
 
iSÿËFaùÜ
, INT32 
iDaysOfIn™ŸlT¿des
, 
UINT32
 
UniqueId
, 
RNGSEED
 
RNGS“d
 )

150 : 
	`m_Driv”Glob®S‘tšgs
 ( 
iCÚfigu»dCu¡om”CouÁ
, 
iAùiveCu¡om”CouÁ
, 
iSÿËFaùÜ
, 
iDaysOfIn™ŸlT¿des
 )

151 , 
	`m_Driv”DMS‘tšgs
Ğ
UniqueId
, 
RNGS“d
 )

152 , 
	`m_ºd
Ğ
RNGS“d
 )

153 , 
	`m_Cu¡om”S–eùiÚ
(&
m_ºd
, 
iDeçuÉS¹FromCu¡om”
, 
iAùiveCu¡om”CouÁ
)

154 , 
	`m_AccsAndP”ms
(
šputFes
, 
iDeçuÉLßdUn™Size
, 
iAùiveCu¡om”CouÁ
, 
iDeçuÉS¹FromCu¡om”
)

155 , 
	`m_pSecur™›s
(
šputFes
.
Secur™›s
)

156 , 
	`m_pCom·n›s
(
šputFes
.
Com·ny
)

157 , 
	`m_pTaxR©esDivisiÚ
(
šputFes
.
TaxR©esDivisiÚ
)

158 , 
	`m_pStusTy³
(
šputFes
.
StusTy³
)

159 , 
	`m_iDivisiÚTaxCouÁ
(0)

160 , 
	`m_D©aMaš‹ÇnûTabËNum
(0)

161 , 
	`m_pSUT
Ğ
pSUT
 )

162 , 
	$m_pLogg”
Ğ
pLogg”
 )

164 
m_pLogg”
->
	`S’dToLogg”
("DM object constructed using constructor 2 (valid for…ublication: NO).");

166 
	`In™Ÿlize
();

168 
m_pLogg”
->
	`S’dToLogg”
(
m_Driv”DMS‘tšgs
);

169 
	}
}

171 
	gCDM
::~
	$CDM
()

173 
m_pLogg”
->
	`S’dToLogg”
("DM object destroyed.");

174 
	}
}

176 
TId’t
 
	gCDM
::
	$G’”©eRªdomCu¡om”Id
()

178  
m_ºd
.
	`RndIÁ64Rªge
(
m_iS¹FromCu¡om”
,

179 
m_iS¹FromCu¡om”
 + 
m_Driv”Glob®S‘tšgs
.
cur
.
iAùiveCu¡om”CouÁ
 - 1);

180 
	}
}

182 
TId’t
 
	gCDM
::
	$G’”©eRªdomCu¡om”AccouÁId
()

184 
TId’t
 
iCu¡om”Id
;

186 
eCu¡om”T›r
 
iCu¡om”T›r
;

188 
m_Cu¡om”S–eùiÚ
.
	`G’”©eRªdomCu¡om”
(
iCu¡om”Id
, 
iCu¡om”T›r
);

190 Ğ
m_AccsAndP”ms
.
	`G’”©eRªdomAccouÁId
Ğ
m_ºd
, 
iCu¡om”Id
, 
iCu¡om”T›r
));

192 
	}
}

194 
TId’t
 
	gCDM
::
	$G’”©eRªdomCom·nyId
()

196  
m_ºd
.
	`RndIÁ64Rªge
(
m_iS¹FromCom·ny
, m_iS¹FromCom·ny + 
m_iCom·nyCouÁ
 - 1);

197 
	}
}

199 
TId’t
 
	gCDM
::
	$G’”©eRªdomSecur™yId
()

201  
m_ºd
.
	`RndIÁ64Rªge
(0, 
m_iSecur™yCouÁ
-1);

202 
	}
}

204 
RNGSEED
 
	gCDM
::
	$G‘RNGS“d
( )

206 Ğ
m_ºd
.
	`G‘S“d
() );

207 
	}
}

209 
	gCDM
::
	$DoTxn
( )

211 
	`mem£t
Ğ&
m_TxnIÅut
, 0, ( m_TxnInput ));

212 
	`¡ºıy
Ğ
m_TxnIÅut
.
bË_Çme
,

213 
D©aMaš‹ÇnûTabËName
[
m_D©aMaš‹ÇnûTabËNum
],

214 (
m_TxnIÅut
.
bË_Çme
 ));

216  
m_D©aMaš‹ÇnûTabËNum
 )

219 
m_TxnIÅut
.
acù_id
 = 
	`G’”©eRªdomCu¡om”AccouÁId
();

222 ià(
m_ºd
.
	`RndP”ûÁ
(67))

224 
m_TxnIÅut
.
c_id
 = 
	`G’”©eRªdomCu¡om”Id
();

228 
m_TxnIÅut
.
co_id
 = 
	`G’”©eRªdomCom·nyId
();

232 
m_TxnIÅut
.
co_id
 = 
	`G’”©eRªdomCom·nyId
();

235 
m_TxnIÅut
.
c_id
 = 
	`G’”©eRªdomCu¡om”Id
();

238 
m_TxnIÅut
.
c_id
 = 
	`G’”©eRªdomCu¡om”Id
();

241 
m_pSecur™›s
->
	`C»©eSymbŞ
Ğ
	`G’”©eRªdomSecur™yId
(), 
m_TxnIÅut
.
symbŞ
, 
¡©ic_ÿ¡
<>(( m_TxnInput.symbol )));

242 
m_TxnIÅut
.
day_of_mÚth
 = 
m_ºd
.
	`RndIÁRªge
(1, 31);

243 
m_TxnIÅut
.
vŞ_šü
 = 
m_ºd
.
	`RndIÁRªge
(-2, 3);

244 ià(
m_TxnIÅut
.
vŞ_šü
 == 0)

246 
m_TxnIÅut
.
vŞ_šü
 = -3;

252 
m_TxnIÅut
.
co_id
 = 
	`G’”©eRªdomCom·nyId
();

255 
m_TxnIÅut
.
co_id
 = 
	`G’”©eRªdomCom·nyId
();

258 
m_pSecur™›s
->
	`C»©eSymbŞ
Ğ
	`G’”©eRªdomSecur™yId
(), 
m_TxnIÅut
.
symbŞ
, 
¡©ic_ÿ¡
<>(( m_TxnInput.symbol )));

261 cÚ¡ 
veùÜ
<
TTaxR©eIÅutRow
> *
pR©es
;

262 
UINT
 
iTh»shŞd
;

264 
pR©es
 = 
m_pTaxR©esDivisiÚ
->
	`G‘RecÜd
((
UINT
)
m_ºd
.
	`RndIÁRªge
(0,

265 
m_iDivisiÚTaxCouÁ
 - 1));

266 
iTh»shŞd
 = (
UINT
è
m_ºd
.
	`RndIÁRªge
(0, (UINT)
pR©es
->
	`size
()-1);

268 
	`¡ºıy
(
m_TxnIÅut
.
tx_id
,

269 (*
pR©es
)[
iTh»shŞd
].
TAX_ID
,

270 (
m_TxnIÅut
.
tx_id
));

273 
m_TxnIÅut
.
c_id
 = 
	`G’”©eRªdomCu¡om”Id
();

277 
	`as£¹
(
çl£
);

280 
m_pSUT
->
	`D©aMaš‹Çnû
Ğ&
m_TxnIÅut
 );

282 
m_D©aMaš‹ÇnûTabËNum
 = (m_D©aMaš‹ÇnûTabËNum + 1è% 
iD©aMaš‹ÇnûTabËCouÁ
;

283 
	}
}

286 
TD©aMaš‹ÇnûTxnIÅut
* 
	gCDM
::
	$ü—‹DMIÅut
()

288 
TD©aMaš‹ÇnûTxnIÅut
* 
šput
 = 
Ãw
 
	`TD©aMaš‹ÇnûTxnIÅut
();

290 
	`mem£t
Ğ
šput
, 0, Ğ
m_TxnIÅut
 ));

291 
	`¡ºıy
Ğ
šput
->
bË_Çme
,

292 
D©aMaš‹ÇnûTabËName
[
m_D©aMaš‹ÇnûTabËNum
],

293 (
m_TxnIÅut
.
bË_Çme
 ));

295  
m_D©aMaš‹ÇnûTabËNum
 )

298 
šput
->
acù_id
 = 
	`G’”©eRªdomCu¡om”AccouÁId
();

301 ià(
m_ºd
.
	`RndP”ûÁ
(67))

303 
šput
->
c_id
 = 
	`G’”©eRªdomCu¡om”Id
();

307 
šput
->
co_id
 = 
	`G’”©eRªdomCom·nyId
();

311 
šput
->
co_id
 = 
	`G’”©eRªdomCom·nyId
();

314 
šput
->
c_id
 = 
	`G’”©eRªdomCu¡om”Id
();

317 
šput
->
c_id
 = 
	`G’”©eRªdomCu¡om”Id
();

320 
m_pSecur™›s
->
	`C»©eSymbŞ
Ğ
	`G’”©eRªdomSecur™yId
(), 
šput
->
symbŞ
, 
¡©ic_ÿ¡
<>(Ğ
m_TxnIÅut
.symbol )));

321 
šput
->
day_of_mÚth
 = 
m_ºd
.
	`RndIÁRªge
(1, 31);

322 
šput
->
vŞ_šü
 = 
m_ºd
.
	`RndIÁRªge
(-2, 3);

323 ià(
šput
->
vŞ_šü
 == 0)

325 
šput
->
vŞ_šü
 = -3;

331 
šput
->
co_id
 = 
	`G’”©eRªdomCom·nyId
();

334 
šput
->
co_id
 = 
	`G’”©eRªdomCom·nyId
();

337 
m_pSecur™›s
->
	`C»©eSymbŞ
Ğ
	`G’”©eRªdomSecur™yId
(), 
šput
->
symbŞ
, 
¡©ic_ÿ¡
<>(Ğ
m_TxnIÅut
.symbol )));

340 cÚ¡ 
veùÜ
<
TTaxR©eIÅutRow
> *
pR©es
;

341 
UINT
 
iTh»shŞd
;

343 
pR©es
 = 
m_pTaxR©esDivisiÚ
->
	`G‘RecÜd
((
UINT
)
m_ºd
.
	`RndIÁRªge
(0,

344 
m_iDivisiÚTaxCouÁ
 - 1));

345 
iTh»shŞd
 = (
UINT
è
m_ºd
.
	`RndIÁRªge
(0, (UINT)
pR©es
->
	`size
()-1);

347 
	`¡ºıy
(
šput
->
tx_id
,

348 (*
pR©es
)[
iTh»shŞd
].
TAX_ID
,

349 (
m_TxnIÅut
.
tx_id
));

352 
šput
->
c_id
 = 
	`G’”©eRªdomCu¡om”Id
();

356 
	`as£¹
(
çl£
);

359 
m_D©aMaš‹ÇnûTabËNum
 = (m_D©aMaš‹ÇnûTabËNum + 1è% 
iD©aMaš‹ÇnûTabËCouÁ
;

360  
šput
;

361 
	}
}

363 
	gCDM
::
	$DoCËªupTxn
( )

365 
	`mem£t
Ğ&
m_CËªupTxnIÅut
, 0, ( m_CleanupTxnInput ));

368 
m_CËªupTxnIÅut
.
¡¬t_Œade_id
 = (
TT¿de
)(Ğ
m_Driv”Glob®S‘tšgs
.
cur
.
iDaysOfIn™ŸlT¿des
 * (TT¿de)
HoursP”WÜkDay
 * (TT¿de)
SecÚdsP”Hour
 * ( m_Driv”Glob®S‘tšgs.cur.
iAùiveCu¡om”CouÁ
 / m_Driv”Glob®S‘tšgs.cur.
iSÿËFaùÜ
 )è* 
iAbÜtT¿de
 / 100 ) + 1 + 
iTT¿deShiá
;

371 
	`¡ºıy
(
m_CËªupTxnIÅut
.
¡_³ndšg_id
,

372 (
m_pStusTy³
->
	`G‘RecÜd
(
eP’dšg
))->
ST_ID
,

373 (
m_CËªupTxnIÅut
.
¡_³ndšg_id
));

374 
	`¡ºıy
(
m_CËªupTxnIÅut
.
¡_subm™‹d_id
,

375 (
m_pStusTy³
->
	`G‘RecÜd
(
eSubm™‹d
))->
ST_ID
,

376 (
m_CËªupTxnIÅut
.
¡_subm™‹d_id
));

377 
	`¡ºıy
(
m_CËªupTxnIÅut
.
¡_ÿnûËd_id
,

378 (
m_pStusTy³
->
	`G‘RecÜd
(
eCªûËd
))->
ST_ID
,

379 (
m_CËªupTxnIÅut
.
¡_ÿnûËd_id
));

382 
m_pSUT
->
	`T¿deCËªup
Ğ&
m_CËªupTxnIÅut
 );

383 
	}
}

387 
TT¿deCËªupTxnIÅut
* 
	gCDM
::
	$ü—‹TCIÅut
()

389 
TT¿deCËªupTxnIÅut
* 
šput
 = 
Ãw
 
	`TT¿deCËªupTxnIÅut
();

391 
	`mem£t
(
šput
, 0,  (
m_CËªupTxnIÅut
));

394 
šput
->
¡¬t_Œade_id
 = (
TT¿de
)(Ğ
m_Driv”Glob®S‘tšgs
.
cur
.
iDaysOfIn™ŸlT¿des
 * (TT¿de)
HoursP”WÜkDay
 * (TT¿de)
SecÚdsP”Hour
 * ( m_Driv”Glob®S‘tšgs.cur.
iAùiveCu¡om”CouÁ
 / m_Driv”Glob®S‘tšgs.cur.
iSÿËFaùÜ
 )è* 
iAbÜtT¿de
 / 100 ) + 1 + 
iTT¿deShiá
;

397 
	`¡ºıy
(
šput
->
¡_³ndšg_id
,

398 (
m_pStusTy³
->
	`G‘RecÜd
(
eP’dšg
))->
ST_ID
,

399 (
m_CËªupTxnIÅut
.
¡_³ndšg_id
));

400 
	`¡ºıy
(
šput
->
¡_subm™‹d_id
,

401 (
m_pStusTy³
->
	`G‘RecÜd
(
eSubm™‹d
))->
ST_ID
,

402 (
m_CËªupTxnIÅut
.
¡_subm™‹d_id
));

403 
	`¡ºıy
(
šput
->
¡_ÿnûËd_id
,

404 (
m_pStusTy³
->
	`G‘RecÜd
(
eCªûËd
))->
ST_ID
,

405 (
m_CËªupTxnIÅut
.
¡_ÿnûËd_id
));

407  
šput
;

408 
	}
}

	@src/workload/tpce/egen/DateTime.cpp

37 
	~"wÜklßd/û/eg’/EG’Ut™›s_¡dafx.h
"

39 
usšg
 
Çme¥aû
 
	gTPCE
;

42 cÚ¡ 
INT32
 
	gmÚthA¼ay
[12] = { 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 };

45 cÚ¡ 
INT32
 
	gmÚthA¼ayLY
[12] = { 31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 };

48 
boŞ
 
	gCD©eTime
::
	$IsV®id
Ğ
INT32
 
y—r
, INT32 
mÚth
, INT32 
day
, INT32 
hour
, INT32 
mšu‹
, INT32 
£cÚd
, INT32 
m£c
 )

50 ià(
hour
 < 0 || hou¸> 23 || 
mšu‹
 < 0 || minute > 59 ||

51 
£cÚd
 < 0 || secÚd > 59 || 
m£c
 < 0 || msec > 999)

52  
çl£
;

54 ià(
y—r
 < 1 || y—¸> 9999 || 
mÚth
 < 1 || mÚth > 12 || 
day
 < 1 || day > 31)

55  
çl£
;

57 ià(
mÚth
 != 2)

59  (
day
 <ğ
mÚthA¼ay
[
mÚth
-1] );

63 
INT32
 
FebDays
 = 
mÚthA¼ay
[1];

65 ià((
y—r
 % 4) == 0)

67 ià((
y—r
 % 400) == 0)

69 
FebDays
++;

73 ià((
y—r
 % 100) != 0)

75 
FebDays
++;

79  (
day
 <ğ
FebDays
);

81 
	}
}

85 
INT32
 
	gCD©eTime
::
	$YMDtoDayno
Ğ
INT32
 
yr
, INT32 
mm
, INT32 
dd
 )

87 
	`as£¹
Ğ
mm
 >= 1 && mm <= 12 );

88 
	`as£¹
Ğ
dd
 >= 1 && dd <= 31 );

89 
	`as£¹
Ğ
yr
 > 0 );

92 cÚ¡ 
INT32
 
MÚthA¼ay
[] = { 0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334 };

95 cÚ¡ 
INT32
 
dy1
 = 365;

97 cÚ¡ 
INT32
 
dy4
 = 4 * 
dy1
 + 1;

99 cÚ¡ 
INT32
 
dy100
 = 25 * 
dy4
 - 1;

101 cÚ¡ 
INT32
 
dy400
 = 4 * 
dy100
 + 1;

104 
INT32
 
jd
 = 
MÚthA¼ay
[
mm
-1] + 
dd
 - 1;

107 ià((
mm
 > 2è&& (
yr
 % 4)==0)

109 ià((
yr
 % 400)==0)

110 
jd
++;

111 ià((
yr
 % 100)!=0)

112 
jd
++;

116 
yr
--;

117 
jd
 +ğ
yr
 / 400 * 
dy400
;

118 
yr
 %= 400;

119 
jd
 +ğ
yr
 / 100 * 
dy100
;

120 
yr
 %= 100;

121 
jd
 +ğ
yr
 / 4 * 
dy4
;

122 
yr
 %= 4;

123 
jd
 +ğ
yr
 * 
dy1
;

125  
jd
;

126 
	}
}

146 * 
	gCD©eTime
::
	$ToSŒ
Ğ
INT32
 
¡yË
 = 11 )

148 cÚ¡ *
szMÚthsShÜt
[] =

150 cÚ¡ *
szMÚthsFuÎ
[] =

153 cÚ¡ *
szAmPm
[] = { "AM", "PM" };

155 cÚ¡ 
INT32
 
iHr12
[] = { 12, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11 };

157 
INT32
 
y—r
, 
mÚth
, 
day
, 
hour
, 
mšu‹
, 
£cÚd
, 
m£c
;

158 
INT32
 
p
 = 0;

159 cÚ¡ 
INT32
 
iMaxSŒL’
 = 40;

161 ià(
m_szText
 =ğ
NULL
)

162 
m_szText
 = 
Ãw
 [
iMaxSŒL’
];

163 
m_szText
[0] = '\0';

165 
	`G‘YMDHMS
(&
y—r
, &
mÚth
, &
day
, &
hour
, &
mšu‹
, &
£cÚd
, &
m£c
);

167 
size_t
 
ËngthTÙ®
 = 
iMaxSŒL’
;

168 *
pszText
 = 
m_szText
;

171 
¡yË
/10)

175 
p
 = 
	`¢´štf
Ğ
pszText
, 
ËngthTÙ®
, "%04d-%02d-%02d ", 
y—r
, 
mÚth
, 
day
 );

179 
p
 = 
	`¢´štf
Ğ
pszText
, 
ËngthTÙ®
, "%02d/%02d/%02d ", 
mÚth
, 
day
, 
y—r
%100 );

183 
p
 = 
	`¢´štf
Ğ
pszText
, 
ËngthTÙ®
, "%02d/%02d/%04d ", 
mÚth
, 
day
, 
y—r
 );

187 
p
 = 
	`¢´štf
Ğ
pszText
, 
ËngthTÙ®
, "%02d-%s-%04d ", 
day
, 
szMÚthsShÜt
[
mÚth
-1], 
y—r
 );

191 
p
 = 
	`¢´štf
Ğ
pszText
, 
ËngthTÙ®
, "%02d-%s-%02d ", 
day
, 
szMÚthsShÜt
[
mÚth
-1], 
y—r
%100 );

195 
p
 = 
	`¢´štf
Ğ
pszText
, 
ËngthTÙ®
, "%02d-%02d-%02d ", 
mÚth
, 
day
, 
y—r
%100 );

199 
p
 = 
	`¢´štf
Ğ
pszText
, 
ËngthTÙ®
, "% %02d %04d ", 
szMÚthsShÜt
[
mÚth
-1], 
day
, 
y—r
 );

203 
p
 = 
	`¢´štf
Ğ
pszText
, 
ËngthTÙ®
, "% %02d, %04d ", 
szMÚthsFuÎ
[
mÚth
-1], 
day
, 
y—r
 );

207 
size_t
 
ËngthRemaššg
 = 
ËngthTÙ®
 - 
p
;

208 
pszText
 = 
m_szText
 + ()
p
;

211 
¡yË
%10)

215 
p
 +ğ
	`¢´štf
Ğ
pszText
, 
ËngthRemaššg
, "%02d:%02d:%02d", 
hour
, 
mšu‹
, 
£cÚd
 );

219 
p
 +ğ
	`¢´štf
Ğ
pszText
, 
ËngthRemaššg
, "%02d:%02d:%02d.%03d", 
hour
, 
mšu‹
, 
£cÚd
, 
m£c
 );

223 
p
 +ğ
	`¢´štf
Ğ
pszText
, 
ËngthRemaššg
, "%02d:%02d", 
hour
, 
mšu‹
 );

227 
p
 +ğ
	`¢´štf
Ğ
pszText
, 
ËngthRemaššg
, "%02d:%02d:%02d %s", 
iHr12
[
hour
], 
mšu‹
, 
£cÚd
, 
szAmPm
[hour/12] );

231 
p
 +ğ
	`¢´štf
Ğ
pszText
, 
ËngthRemaššg
, "%02d:%02d:%02d.%03d %s", 
iHr12
[
hour
], 
mšu‹
, 
£cÚd
, 
m£c
, 
szAmPm
[hour/12] );

235 
p
 +ğ
	`¢´štf
Ğ
pszText
, 
ËngthRemaššg
, "%02d:%02d %s", 
iHr12
[
hour
], 
mšu‹
, 
szAmPm
[hour/12] );

240 ià(
p
>0 && 
m_szText
[p-1] == ' ')

241 
m_szText
[
p
-1] = '\0';

243  
m_szText
;

244 
	}
}

247 
	gCD©eTime
::
	$CD©eTime
()

249 
m_szText
 = 
NULL
;

250 
	`S‘ToCu¼’t
();

251 
	}
}

253 
	gCD©eTime
::
	$CD©eTime
(
INT32
 
dayno
)

255 
m_szText
 = 
NULL
;

256 
m_dayno
 = 
dayno
;

257 
m_m£c
 = 0;

258 
	}
}

260 
	gCD©eTime
::
	$CD©eTime
(
INT32
 
y—r
, INT32 
mÚth
, INT32 
day
)

262 
	`as£¹
Ğ
	`IsV®id
Ğ
y—r
, 
mÚth
, 
day
, 0, 0, 0, 0 ) );

264 
m_szText
 = 
NULL
;

265 
m_dayno
 = 
	`YMDtoDayno
(
y—r
, 
mÚth
, 
day
);

266 
m_m£c
 = 0;

267 
	}
}

270 
	gCD©eTime
::
	$CD©eTime
(cÚ¡ 
CD©eTime
& 
dt
)

272 
m_dayno
 = 
dt
.m_dayno;

273 
m_m£c
 = 
dt
.m_msec;

274 
m_szText
 = 
NULL
;

275 
	}
}

277 
	gCD©eTime
::~
	$CD©eTime
()

279 ià(
m_szText
)

280 
d–‘e
 [] 
m_szText
;

281 
	}
}

283 
	gCD©eTime
::
	$CD©eTime
(
INT32
 
y—r
, INT32 
mÚth
, INT32 
day
, INT32 
hour
, INT32 
mšu‹
, INT32 
£cÚd
, INT32 
m£c
)

285 
	`as£¹
Ğ
	`IsV®id
Ğ
y—r
, 
mÚth
, 
day
, 
hour
, 
mšu‹
, 
£cÚd
, 
m£c
 ) );

287 
m_szText
 = 
NULL
;

288 
m_dayno
 = 
	`YMDtoDayno
(
y—r
, 
mÚth
, 
day
);

289 
m_m£c
 = ((
hour
 * 
Mšu‹sP”Hour
 + 
mšu‹
è* 
SecÚdsP”Mšu‹
 + 
£cÚd
è* 
MsP”SecÚd
 + 
m£c
;

290 
	}
}

292 
	gCD©eTime
::
	$CD©eTime
(
TPCE
::
TIMESTAMP_STRUCT
 *
ts
)

294 
	`as£¹
Ğ
	`IsV®id
Ğ
ts
->
y—r
,s->
mÚth
,s->
day
,s->
hour
,s->
mšu‹
,s->
£cÚd
,s->
äaùiÚ
 / 1000000 ) );

296 
m_szText
 = 
NULL
;

297 
m_dayno
 = 
	`YMDtoDayno
(
ts
->
y—r
,s->
mÚth
,s->
day
);

298 
m_m£c
 = ((
ts
->
hour
 * 
Mšu‹sP”Hour
 +s->
mšu‹
è* 
SecÚdsP”Mšu‹
 +s->
£cÚd
è* 
MsP”SecÚd
 +s->
äaùiÚ
 / 1000000;

299 
	}
}

302 
	gCD©eTime
::
	$S‘ToCu¼’t
()

304 #ifdeà
WIN32


306 
SYSTEMTIME
 
time
;

308 
	`G‘LoÿlTime
(&
time
);

309 
m_dayno
 = 
	`YMDtoDayno
((
INT32
)
time
.
wY—r
, (INT32éime.
wMÚth
, (INT32éime.
wDay
);

310 
m_m£c
 = ((
time
.
wHour
 * 
Mšu‹sP”Hour
 +ime.
wMšu‹
è* 
SecÚdsP”Mšu‹
 +ime.
wSecÚd
è* 
MsP”SecÚd
 +ime.
wMli£cÚds
;

311 #–ià(
__unix
è|| (
_AIX
)

313 
timev®
 
tv
;

314 
tm
 
Ér
;

315 
£cs
;

316 
	`g‘timeofday
(&
tv
, 
NULL
);

317 
tm
* 
É
 = 
	`loÿÉime_r
(&
tv
.
tv_£c
, &
Ér
);

320 
m_dayno
 = 
	`YMDtoDayno
(
É
->
tm_y—r
+1900,†t->
tm_mÚ
+1,†t->
tm_mday
);

322 
£cs
 = (
É
->
tm_hour
 * 
Mšu‹sP”Hour
 +†t->
tm_mš
)*
SecÚdsP”Mšu‹
 +

323 
É
->
tm_£c
;

324 
m_m£c
 = 
¡©ic_ÿ¡
<
INT32
>(()
£cs
 * 
MsP”SecÚd
 + 
tv
.
tv_u£c
 / 1000);

326 #”rÜ 
No
 
sy¡em
 
routše
 
to
 
g‘
 
time
.

328 
	}
}

330 
	gCD©eTime
::
	$S‘
(
INT32
 
dayno
)

332 
m_dayno
 = 
dayno
;

333 
m_m£c
 = 0;

334 
	}
}

336 
	gCD©eTime
::
	$S‘
(
INT32
 
y—r
, INT32 
mÚth
, INT32 
day
)

338 
	`as£¹
Ğ
	`IsV®id
Ğ
y—r
, 
mÚth
, 
day
, 0, 0, 0, 0 ) );

340 
m_dayno
 = 
	`YMDtoDayno
(
y—r
, 
mÚth
, 
day
);

341 
m_m£c
 = 0;

342 
	}
}

344 
	gCD©eTime
::
	$S‘
(
INT32
 
y—r
, INT32 
mÚth
, INT32 
day
, INT32 
hour
, INT32 
mšu‹
, INT32 
£cÚd
, INT32 
m£c
)

346 
	`as£¹
Ğ
	`IsV®id
Ğ
y—r
, 
mÚth
, 
day
, 
hour
, 
mšu‹
, 
£cÚd
, 
m£c
 ) );

348 
m_dayno
 = 
	`YMDtoDayno
(
y—r
, 
mÚth
, 
day
);

349 
m_m£c
 = ((
hour
 * 
Mšu‹sP”Hour
 + 
mšu‹
è* 
SecÚdsP”Mšu‹
 + 
£cÚd
è* 
MsP”SecÚd
 + 
m£c
;

350 
	}
}

352 
	gCD©eTime
::
	$S‘HMS
(
INT32
 
hour
, INT32 
mšu‹
, INT32 
£cÚd
, INT32 
m£c
)

354 
	`as£¹
Ğ
	`IsV®id
Ğ1, 1, 1, 
hour
, 
mšu‹
, 
£cÚd
, 
m£c
 ) );

356 
m_m£c
 = ((
hour
 * 
Mšu‹sP”Hour
 + 
mšu‹
è* 
SecÚdsP”Mšu‹
 + 
£cÚd
è* 
MsP”SecÚd
 + 
m£c
;

357 
	}
}

362 
	gCD©eTime
::
	$G‘YMD
Ğ
INT32
* 
y—r
, INT32* 
mÚth
, INT32* 
day
 )

364 
INT32
 
dayno
 = 
m_dayno
;

367 
INT32
 
y
, 
m
;

370 cÚ¡ 
INT32
 
dy1
 = 365;

372 cÚ¡ 
INT32
 
dy4
 = 4 * 
dy1
 + 1;

374 cÚ¡ 
INT32
 
dy100
 = 25 * 
dy4
 - 1;

376 cÚ¡ 
INT32
 
dy400
 = 4 * 
dy100
 + 1;

378 
y
 = 1;

379 
y
 +ğ(
dayno
/
dy400
) * 400;

380 
dayno
 %ğ
dy400
;

381 ià(
dayno
 =ğ
dy400
-1)

383 
y
 += 399;

384 
dayno
 -ğ3 * 
dy100
 + 24 * 
dy4
 + 3 * 
dy1
;

388 
y
 +ğ(
dayno
 / 
dy100
) * 100;

389 
dayno
 %ğ
dy100
;

390 
y
 +ğ(
dayno
 / 
dy4
) * 4;

391 
dayno
 %ğ
dy4
;

392 ià(
dayno
 =ğ
dy4
 - 1)

394 
y
 += 3;

395 
dayno
 -ğ3 * 
dy1
;

399 
y
 +ğ
dayno
 / 
dy1
;

400 
dayno
 %ğ
dy1
;

405 
boŞ
 
bL—pY—r
 = 
çl£
;

406 ià((
y
 % 4) == 0)

408 ià((
y
 % 400) == 0)

410 
bL—pY—r
 = 
Œue
;

414 ià((
y
 % 100) != 0)

416 
bL—pY—r
 = 
Œue
;

421 
m
 = 1;

422 
dayno
++;

423 ià(
bL—pY—r
)

425 
dayno
 > 
mÚthA¼ayLY
[
m
-1])

427 
dayno
 -ğ
mÚthA¼ayLY
[
m
-1];

428 
m
++;

433 
dayno
 > 
mÚthA¼ay
[
m
-1])

435 
dayno
 -ğ
mÚthA¼ay
[
m
-1];

436 
m
++;

440 *
y—r
 = 
y
;

441 *
mÚth
 = 
m
;

442 *
day
 = 
dayno
;

443 
	}
}

445 
	gCD©eTime
::
	$G‘YMDHMS
(
INT32
* 
y—r
, INT32* 
mÚth
, INT32* 
day
, INT32* 
hour
, INT32* 
mšu‹
, INT32* 
£cÚd
, INT32* 
m£c
)

447 
INT32
 
ms
 = 
m_m£c
;

449 
	`G‘YMD
Ğ
y—r
, 
mÚth
, 
day
 );

451 *
m£c
 = 
ms
 % 
MsP”SecÚd
;

452 
ms
 /ğ
MsP”SecÚd
;

453 *
£cÚd
 = 
ms
 % 
SecÚdsP”Mšu‹
;

454 
ms
 /ğ
SecÚdsP”Mšu‹
;

455 *
mšu‹
 = 
ms
 % 
Mšu‹sP”Hour
;

456 *
hour
 = 
ms
 / 
Mšu‹sP”Hour
;

457 
	}
}

459 
	gCD©eTime
::
	$G‘HMS
(
INT32
* 
hour
, INT32* 
mšu‹
, INT32* 
£cÚd
, INT32* 
m£c
)

461 
INT32
 
ms
 = 
m_m£c
;

463 *
m£c
 = 
ms
 % 
MsP”SecÚd
;

464 
ms
 /ğ
MsP”SecÚd
;

465 *
£cÚd
 = 
ms
 % 
SecÚdsP”Mšu‹
;

466 
ms
 /ğ
SecÚdsP”Mšu‹
;

467 *
mšu‹
 = 
ms
 % 
Mšu‹sP”Hour
;

468 *
hour
 = 
ms
 / 
Mšu‹sP”Hour
;

469 
	}
}

471 
	gCD©eTime
::
	$G‘TimeSmp
(
TPCE
::
TIMESTAMP_STRUCT
* 
ts
)

473 
INT32
 
y—r
, 
mÚth
, 
day
, 
hour
, 
mšu‹
, 
£cÚd
, 
m£c
;

475 
	`G‘YMDHMS
Ğ&
y—r
, &
mÚth
, &
day
, &
hour
, &
mšu‹
, &
£cÚd
, &
m£c
 );

476 
ts
->
y—r
 = (
INT16
)year;

477 
ts
->
mÚth
 = (
UINT16
)month;

478 
ts
->
day
 = (
UINT16
)day;

479 
ts
->
hour
 = (
UINT16
)hour;

480 
ts
->
mšu‹
 = (
UINT16
)minute;

481 
ts
->
£cÚd
 = (
UINT16
)second;

482 
ts
->
äaùiÚ
 = (
UINT32
)
m£c
*1000000;

483 
	}
}

485 #ifdeà
COMPILE_ODBC_LOAD


486 cÚ¡ 
INT32
 
	gdayno_1Jª1900
 = 
CD©eTime
::
YMDtoDayno
( 1900, 1, 1 );

488 
	gCD©eTime
::
	$G‘DBDATETIME
(
DBDATETIME
* 
dt
)

490 
dt
->
dtdays
 = 
m_dayno
 - 
dayno_1Jª1900
;

491 
dt
->
d‰ime
 = 
m_m£c
 * 3 / 10;

492 
	}
}

495 
	gCD©eTime
::
	$Add
(
INT32
 
days
, INT32 
m£c
, 
boŞ
 
adju¡_w“k’d
 )

497 ià(
adju¡_w“k’d
)

499 
days
 = ((day / 
DaysP”WÜkW“k
è* 
DaysP”W“k
) + (days % DaysPerWorkWeek);

502 
m_dayno
 +ğ
days
;

504 
m_m£c
 +ğ
m£c
;

505 
m_dayno
 +ğ
m_m£c
 / 
MsP”Day
;

506 
m_m£c
 %ğ
MsP”Day
;

507 ià(
m_m£c
 < 0)

509 
m_dayno
--;

510 
m_m£c
 +ğ
MsP”Day
;

512 
	}
}

513 
	gCD©eTime
::
	$AddMšu‹s
(
INT32
 
Mšu‹s
)

515 
	`Add
Ğ0, 
Mšu‹s
 * 
SecÚdsP”Mšu‹
 * 
MsP”SecÚd
);

516 
	}
}

517 
	gCD©eTime
::
	$AddWÜkMs
(
INT64
 
WÜkMs
)

519 
INT32
 
WÜkDays
 = (INT32)(
WÜkMs
 / (
INT64
)
MsP”WÜkDay
);

520 
	`Add
Ğ
WÜkDays
, (
INT32
)(
WÜkMs
 % 
MsP”WÜkDay
), 
Œue
 );

521 
	}
}

522 
boŞ
 
	gCD©eTime
::
İ”©Ü
 <(cÚ¡ 
CD©eTime
& 
dt
)

524  (
m_dayno
 =ğ
dt
.m_daynoè? (
m_m£c
 < dt.m_msec) : (m_dayno < dt.m_dayno);

527 
boŞ
 
	gCD©eTime
::
İ”©Ü
 <=(cÚ¡ 
CD©eTime
& 
dt
)

529  (
m_dayno
 =ğ
dt
.m_daynoè? (
m_m£c
 <= dt.m_msec) : (m_dayno <= dt.m_dayno);

532 
Çme¥aû
 
	gTPCE


536 
boŞ
 
	gİ”©Ü
 >(cÚ¡ 
	gCD©eTime
& 
	gl_dt
, cÚ¡ CD©eTime& 
	gr_dt
)

538  (
	gl_dt
.
	gm_dayno
 =ğ
r_dt
.
m_dayno
è? (
l_dt
.
m_m£c
 >„_dt.m_msec) : (l_dt.m_dayno >„_dt.m_dayno);

543 
boŞ
 
	gCD©eTime
::
İ”©Ü
 >=(cÚ¡ 
CD©eTime
& 
dt
)

545  (
m_dayno
 =ğ
dt
.m_daynoè? (
m_m£c
 >= dt.m_msec) : (m_dayno >= dt.m_dayno);

548 
boŞ
 
	gCD©eTime
::
İ”©Ü
 ==(cÚ¡ 
CD©eTime
& 
dt
)

550  
m_dayno
 =ğ
dt
.m_daynØ? 
m_m£c
 =ğdt.m_m£ø: 
çl£
;

555 
	gCD©eTime
::
İ”©Ü
 -(cÚ¡ 
CD©eTime
& 
dt
)

557 
dSecs
;

558 
	gdSecs
 = ()((
m_dayno
 - 
dt
.m_daynoè* 
SecÚdsP”Mšu‹
 * 
Mšu‹sP”Hour
 * 
HoursP”Day
);

559 
	gdSecs
 +ğ()(
m_m£c
 - 
dt
.m_m£cè/ 
MsP”SecÚdDivisÜ
;

560  
	gdSecs
;

563 
INT32
 
	gCD©eTime
::
	$DiffInMliSecÚds
ĞcÚ¡ 
CD©eTime
& 
Ba£Time
 )

565 
INT32
 
mSecs
;

566 
mSecs
 = (
m_dayno
 - 
Ba£Time
.m_daynØè* 
MsP”SecÚd
 * 
SecÚdsP”Mšu‹
 * 
Mšu‹sP”Hour
 * 
HoursP”Day
;

567 
mSecs
 +ğ(
m_m£c
 - 
Ba£Time
.m_msec);

568  
mSecs
;

569 
	}
}

571 
INT32
 
	gCD©eTime
::
	$DiffInMliSecÚds
Ğ
CD©eTime
* 
pBa£Time
 )

573 
INT32
 
mSecs
;

574 
mSecs
 = (
m_dayno
 - 
pBa£Time
->m_daynØè* 
MsP”SecÚd
 * 
SecÚdsP”Mšu‹
 * 
Mšu‹sP”Hour
 * 
HoursP”Day
;

575 
mSecs
 +ğ(
m_m£c
 - 
pBa£Time
->m_msec);

576  
mSecs
;

577 
	}
}

579 
	gCD©eTime
& CD©eTime::
İ”©Ü
 = (cÚ¡ 
CD©eTime
& 
dt
)

581 
m_dayno
 = 
dt
.m_dayno;

582 
	gm_m£c
 = 
dt
.
m_m£c
;

584  *
	gthis
;

587 
	gCD©eTime
& CD©eTime::
İ”©Ü
 +ğ(cÚ¡ 
CD©eTime
& 
dt
)

589 
Add
(
dt
.
m_dayno
, dt.
m_m£c
);

591  *
	gthis
;

	@src/workload/tpce/egen/EGenGenerateAndLoad.cpp

43 
	~"wÜklßd/û/eg’/EG’G’”©eAndLßd_¡dafx.h
"

44 
	~"wÜklßd/û/eg’/Driv”P¬amS‘tšgs.h
"

45 
	~"¡dio.h
"

47 #ifdeà
COMPILE_FLAT_FILE_LOAD


48 
FILE
 *
	gf£c
, *
	gfhs
;

50 
usšg
 
Çme¥aû
 
	gTPCE
;

71 
	gCG’”©eAndLßd
::
	$CG’”©eAndLßd
(
CIÅutFes
 
šputFes
,

72 
TId’t
 
iCu¡om”CouÁ
,

73 
TId’t
 
iS¹FromCu¡om”
,

74 
TId’t
 
iTÙ®Cu¡om”s
,

75 
UINT
 
iLßdUn™Size
,

76 
UINT
 
iSÿËFaùÜ
,

77 
UINT
 
iDaysOfIn™ŸlT¿des
,

78 
CBa£Lßd”FaùÜy
* 
pLßd”FaùÜy
,

79 
CBa£Logg”
* 
pLogg”
,

80 
CG’”©eAndLßdBa£Ouut
* 
pOuut
,

81 * 
szInDœ
,

82 
boŞ
 
bCacheEÇbËd


84 : 
	`m_šputFes
(
šputFes
)

85 , 
	`m_iS¹FromCu¡om”
(
iS¹FromCu¡om”
)

86 , 
	`m_iCu¡om”CouÁ
(
iCu¡om”CouÁ
)

87 , 
	`m_iTÙ®Cu¡om”s
(
iTÙ®Cu¡om”s
)

88 , 
	`m_iLßdUn™Size
(
iLßdUn™Size
)

89 , 
	`m_iSÿËFaùÜ
(
iSÿËFaùÜ
)

90 , 
	`m_iHoursOfIn™ŸlT¿des
(
iDaysOfIn™ŸlT¿des
*
HoursP”WÜkDay
)

91 , 
	`m_pLßd”FaùÜy
(
pLßd”FaùÜy
)

92 , 
	`m_pOuut
(
pOuut
)

93 , 
	`m_pLogg”
(
pLogg”
)

94 , 
	`m_Lßd”S‘tšgs
(
iTÙ®Cu¡om”s
, iTÙ®Cu¡om”s, 
iS¹FromCu¡om”
, 
iCu¡om”CouÁ
, 
iSÿËFaùÜ
, 
iDaysOfIn™ŸlT¿des
 )

95 , 
	$m_bCacheEÇbËd
(
bCacheEÇbËd
)

98 
	`¡ºıy
Ğ
m_szInDœ
, 
szInDœ
, (m_szInDir));

101 
m_pLogg”
->
	`S’dToLogg”
(
m_Lßd”S‘tšgs
);

102 
	}
}

113 
	gCG’”©eAndLßd
::
	$G’”©eAndLßdAdd»ss
()

115 
boŞ
 
bR‘
;

116 
CAdd»ssTabË
 
	`TabË
(
m_šputFes
, 
m_iCu¡om”CouÁ
, 
m_iS¹FromCu¡om”
,

119 
m_iS¹FromCu¡om”
 !ğ
iDeçuÉS¹FromCu¡om”
);

120 
CBa£Lßd”
<
ADDRESS_ROW
>* 
pLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eAdd»ssLßd”
();

121 
INT64
 
iCÁ
=0;

123 
m_pOuut
->
	`OuutS¹
("Generating ADDRESSable...");

125 
pLßd
->
	`In™
();

129 
bR‘
 = 
TabË
.
	`G’”©eNextRecÜd
();

131 
pLßd
->
	`Wr™eNextRecÜd
(
TabË
.
	`G‘Row
());

133 ià(++
iCÁ
 % 20000 == 0)

135 
m_pOuut
->
	`OuutProg»ss
(".");

138 } 
bR‘
);

140 
pLßd
->
	`FšishLßd
();

141 
d–‘e
 
pLßd
;

143 
m_pOuut
->
	`OuutCom¶‘e
("loaded.");

144 
m_pOuut
->
	`OuutNewlše
();

145 
m_pOuut
->
	`OuutNewlše
();

146 
	}
}

157 
	gCG’”©eAndLßd
::
	$G’”©eAndLßdCh¬ge
()

159 
boŞ
 
bEndOfFe
;

160 
CCh¬geTabË
 
	`TabË
Ğ
m_szInDœ
 );

161 
CBa£Lßd”
<
CHARGE_ROW
>* 
pLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eCh¬geLßd”
();

163 
m_pOuut
->
	`OuutS¹
("Generating CHARGEable...");

165 
pLßd
->
	`In™
();

167 
bEndOfFe
 = 
TabË
.
	`G’”©eNextRecÜd
();

168  !
bEndOfFe
 )

170 
pLßd
->
	`Wr™eNextRecÜd
(
TabË
.
	`G‘Row
());

171 
bEndOfFe
 = 
TabË
.
	`G’”©eNextRecÜd
();

173 
pLßd
->
	`FšishLßd
();

174 
d–‘e
 
pLßd
;

176 
m_pOuut
->
	`OuutCom¶‘e
("loaded.");

177 
m_pOuut
->
	`OuutNewlše
();

178 
m_pOuut
->
	`OuutNewlše
();

179 
	}
}

190 
	gCG’”©eAndLßd
::
	$G’”©eAndLßdCommissiÚR©e
()

192 
boŞ
 
bEndOfFe
;

193 
CCommissiÚR©eTabË
 
	`TabË
Ğ
m_szInDœ
 );

194 
CBa£Lßd”
<
COMMISSION_RATE_ROW
>* 
pLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eCommissiÚR©eLßd”
();

196 
m_pOuut
->
	`OuutS¹
("Generating COMMISSION_RATEable...");

198 
pLßd
->
	`In™
();

200 
bEndOfFe
 = 
TabË
.
	`G’”©eNextRecÜd
();

201  !
bEndOfFe
 )

203 
pLßd
->
	`Wr™eNextRecÜd
(
TabË
.
	`G‘Row
());

204 
bEndOfFe
 = 
TabË
.
	`G’”©eNextRecÜd
();

206 
pLßd
->
	`FšishLßd
();

207 
d–‘e
 
pLßd
;

209 
m_pOuut
->
	`OuutCom¶‘e
("loaded.");

210 
m_pOuut
->
	`OuutNewlše
();

211 
m_pOuut
->
	`OuutNewlše
();

212 
	}
}

223 
	gCG’”©eAndLßd
::
	$G’”©eAndLßdCom·ny
()

225 
boŞ
 
bR‘
;

226 
CCom·nyTabË
 
	`TabË
(
m_šputFes
, 
m_iCu¡om”CouÁ
, 
m_iS¹FromCu¡om”
);

227 
CBa£Lßd”
<
COMPANY_ROW
>* 
pLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eCom·nyLßd”
();

229 
m_pOuut
->
	`OuutS¹
("Generating COMPANYable...");

231 
pLßd
->
	`In™
();

235 
bR‘
 = 
TabË
.
	`G’”©eNextRecÜd
();

237 
pLßd
->
	`Wr™eNextRecÜd
(
TabË
.
	`G‘Row
());

239 } 
bR‘
);

241 
pLßd
->
	`FšishLßd
();

243 
d–‘e
 
pLßd
;

245 
m_pOuut
->
	`OuutCom¶‘e
("loaded.");

246 
m_pOuut
->
	`OuutNewlše
();

247 
m_pOuut
->
	`OuutNewlše
();

248 
	}
}

259 
	gCG’”©eAndLßd
::
	$G’”©eAndLßdCom·nyCom³t™Ü
()

261 
boŞ
 
bR‘
;

262 
CCom·nyCom³t™ÜTabË
 
	`TabË
(
m_šputFes
, 
m_iCu¡om”CouÁ
, 
m_iS¹FromCu¡om”
);

263 
CBa£Lßd”
<
COMPANY_COMPETITOR_ROW
>* 
pLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eCom·nyCom³t™ÜLßd”
();

265 
m_pOuut
->
	`OuutS¹
("Generating COMPANY_COMPETITORable...");

267 
pLßd
->
	`In™
();

271 
bR‘
 = 
TabË
.
	`G’”©eNextRecÜd
();

273 
pLßd
->
	`Wr™eNextRecÜd
(
TabË
.
	`G‘Row
());

275 } 
bR‘
);

277 
pLßd
->
	`FšishLßd
();

279 
d–‘e
 
pLßd
;

281 
m_pOuut
->
	`OuutCom¶‘e
("loaded.");

282 
m_pOuut
->
	`OuutNewlše
();

283 
m_pOuut
->
	`OuutNewlše
();

284 
	}
}

295 
	gCG’”©eAndLßd
::
	$G’”©eAndLßdCu¡om”
()

297 
boŞ
 
bR‘
;

298 
CCu¡om”TabË
 
	`TabË
(
m_šputFes
, 
m_iCu¡om”CouÁ
, 
m_iS¹FromCu¡om”
);

299 
CBa£Lßd”
<
CUSTOMER_ROW
>* 
pLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eCu¡om”Lßd”
();

300 
INT64
 
iCÁ
=0;

302 
m_pOuut
->
	`OuutS¹
("Generating CUSTOMERable...");

304 
pLßd
->
	`In™
();

308 
bR‘
 = 
TabË
.
	`G’”©eNextRecÜd
();

310 
pLßd
->
	`Wr™eNextRecÜd
(
TabË
.
	`G‘Row
());

312 ià(++
iCÁ
 % 20000 == 0)

314 
m_pOuut
->
	`OuutProg»ss
(".");

317 } 
bR‘
);

319 
pLßd
->
	`FšishLßd
();

321 
d–‘e
 
pLßd
;

323 
m_pOuut
->
	`OuutCom¶‘e
("loaded.");

324 
m_pOuut
->
	`OuutNewlše
();

325 
m_pOuut
->
	`OuutNewlše
();

326 
	}
}

337 
	gCG’”©eAndLßd
::
	$G’”©eAndLßdCu¡om”AccouÁAndAccouÁP”missiÚ
()

339 
boŞ
 
bR‘
;

340 
CCu¡om”AccouÁsAndP”missiÚsTabË
 
	`TabË
(
m_šputFes
, 
m_iLßdUn™Size
, 
m_iCu¡om”CouÁ
, 
m_iS¹FromCu¡om”
);

341 
CBa£Lßd”
<
CUSTOMER_ACCOUNT_ROW
>* 
pCALßd
 = 
m_pLßd”FaùÜy
->
	`C»©eCu¡om”AccouÁLßd”
();

342 
CBa£Lßd”
<
ACCOUNT_PERMISSION_ROW
>* 
pAPLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eAccouÁP”missiÚLßd”
();

343 
INT64
 
iCÁ
=0;

344 
UINT
 
i
;

346 
m_pOuut
->
	`OuutS¹
("Generating CUSTOMER_ACCOUNTable‡nd ACCOUNT_PERMISSIONable...");

348 
pCALßd
->
	`In™
();

349 
pAPLßd
->
	`In™
();

353 
bR‘
 = 
TabË
.
	`G’”©eNextRecÜd
();

355 
pCALßd
->
	`Wr™eNextRecÜd
(
TabË
.
	`G‘CARow
());

357 
i
=0; i<
TabË
.
	`G‘CAP”msCouÁ
(); ++i)

360 
pAPLßd
->
	`Wr™eNextRecÜd
(
TabË
.
	`G‘APRow
(
i
));

364 ià(++
iCÁ
 % 10000 == 0)

366 
m_pOuut
->
	`OuutProg»ss
(".");

370 ià(
iCÁ
 % 10000 == 0)

372 
pCALßd
->
	`Comm™
();

373 
pAPLßd
->
	`Comm™
();

376 } 
bR‘
);

377 
pCALßd
->
	`FšishLßd
();

378 
pAPLßd
->
	`FšishLßd
();

379 
d–‘e
 
pCALßd
;

380 
d–‘e
 
pAPLßd
;

382 
m_pOuut
->
	`OuutCom¶‘e
("loaded.");

383 
m_pOuut
->
	`OuutNewlše
();

384 
m_pOuut
->
	`OuutNewlše
();

385 
	}
}

396 
	gCG’”©eAndLßd
::
	$G’”©eAndLßdCu¡om”Tax¿‹
()

398 
boŞ
 
bR‘
;

399 
CCu¡om”Tax¿‹sTabË
 
	`TabË
(
m_šputFes
, 
m_iCu¡om”CouÁ
, 
m_iS¹FromCu¡om”
);

400 
CBa£Lßd”
<
CUSTOMER_TAXRATE_ROW
>* 
pLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eCu¡om”Tax¿‹Lßd”
();

401 
INT64
 
iCÁ
=0;

402 
UINT
 
i
;

404 
m_pOuut
->
	`OuutS¹
("Generating CUSTOMER_TAX_RATEable...");

406 
pLßd
->
	`In™
();

410 
bR‘
 = 
TabË
.
	`G’”©eNextRecÜd
();

412 
i
=0; i<
TabË
.
	`G‘TaxR©esCouÁ
(); ++i)

414 
pLßd
->
	`Wr™eNextRecÜd
(
TabË
.
	`G‘RowByIndex
(
i
));

416 ià(++
iCÁ
 % 20000 == 0)

418 
m_pOuut
->
	`OuutProg»ss
(".");

421 } 
bR‘
);

423 
pLßd
->
	`FšishLßd
();

425 
d–‘e
 
pLßd
;

427 
m_pOuut
->
	`OuutCom¶‘e
("loaded.");

428 
m_pOuut
->
	`OuutNewlše
();

429 
m_pOuut
->
	`OuutNewlše
();

430 
	}
}

441 
	gCG’”©eAndLßd
::
	$G’”©eAndLßdDayM¬k‘
()

443 
boŞ
 
bR‘
;

444 
CDayM¬k‘TabË
 
	`TabË
(
m_šputFes
, 
m_iCu¡om”CouÁ
, 
m_iS¹FromCu¡om”
);

445 
CBa£Lßd”
<
DAILY_MARKET_ROW
>* 
pLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eDayM¬k‘Lßd”
();

446 
INT64
 
iCÁ
=0;

448 
m_pOuut
->
	`OuutS¹
("Generating DAILY_MARKETable...");

450 
pLßd
->
	`In™
();

454 
bR‘
 = 
TabË
.
	`G’”©eNextRecÜd
();

456 
pLßd
->
	`Wr™eNextRecÜd
(
TabË
.
	`G‘Row
());

458 ià(++
iCÁ
 % 20000 == 0)

460 
m_pOuut
->
	`OuutProg»ss
(".");

463 ià(
iCÁ
 % 6525 == 0)

465 
pLßd
->
	`Comm™
();

468 } 
bR‘
);

470 
pLßd
->
	`FšishLßd
();

472 
d–‘e
 
pLßd
;

474 
m_pOuut
->
	`OuutCom¶‘e
("loaded.");

475 
m_pOuut
->
	`OuutNewlše
();

476 
m_pOuut
->
	`OuutNewlše
();

477 
	}
}

488 
	gCG’”©eAndLßd
::
	$G’”©eAndLßdExchªge
()

490 
boŞ
 
bEndOfFe
;

491 
CExchªgeTabË
 
	`TabË
Ğ
m_szInDœ
, 
m_iTÙ®Cu¡om”s
 );

492 
CBa£Lßd”
<
EXCHANGE_ROW
>* 
pLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eExchªgeLßd”
();

494 
m_pOuut
->
	`OuutS¹
("Generating EXCHANGEable...");

496 
pLßd
->
	`In™
();

498 
bEndOfFe
 = 
TabË
.
	`G’”©eNextRecÜd
();

499  !
bEndOfFe
 )

501 
pLßd
->
	`Wr™eNextRecÜd
(
TabË
.
	`G‘Row
());

502 
bEndOfFe
 = 
TabË
.
	`G’”©eNextRecÜd
();

504 
pLßd
->
	`FšishLßd
();

505 
d–‘e
 
pLßd
;

507 
m_pOuut
->
	`OuutCom¶‘e
("loaded.");

508 
m_pOuut
->
	`OuutNewlše
();

509 
m_pOuut
->
	`OuutNewlše
();

510 
	}
}

521 
	gCG’”©eAndLßd
::
	$G’”©eAndLßdFšªcŸl
()

523 
boŞ
 
bR‘
;

524 
CFšªcŸlTabË
 
	`TabË
(
m_šputFes
, 
m_iCu¡om”CouÁ
, 
m_iS¹FromCu¡om”
);

525 
CBa£Lßd”
<
FINANCIAL_ROW
>* 
pLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eFšªcŸlLßd”
();

526 
INT64
 
iCÁ
=0;

528 
m_pOuut
->
	`OuutS¹
("Generating FINANCIALable...");

530 
pLßd
->
	`In™
();

534 
bR‘
 = 
TabË
.
	`G’”©eNextRecÜd
();

536 
pLßd
->
	`Wr™eNextRecÜd
(
TabË
.
	`G‘Row
());

538 ià(++
iCÁ
 % 20000 == 0)

540 
m_pOuut
->
	`OuutProg»ss
(".");

543 ià(
iCÁ
 % 5000 == 0)

545 
pLßd
->
	`Comm™
();

548 } 
bR‘
);

550 
pLßd
->
	`FšishLßd
();

552 
d–‘e
 
pLßd
;

554 
m_pOuut
->
	`OuutCom¶‘e
("loaded.");

555 
m_pOuut
->
	`OuutNewlše
();

556 
m_pOuut
->
	`OuutNewlše
();

557 
	}
}

568 
	gCG’”©eAndLßd
::
	$G’”©eAndLßdHŞdšgAndT¿de
()

570 
boŞ
 
bR‘
;

571 
CT¿deG’
* 
pT¿deG’
;

573 
CBa£Lßd”
<
HOLDING_ROW
>* 
pHŞdšgsLßd
;

574 
CBa£Lßd”
<
HOLDING_HISTORY_ROW
>* 
pHŞdšgHi¡ÜyLßd
;

575 
CBa£Lßd”
<
HOLDING_SUMMARY_ROW
>* 
pHŞdšgSumm¬yLßd
;

576 
CBa£Lßd”
<
TRADE_ROW
>* 
pT¿desLßd
;

579 
CBa£Lßd”
<
SETTLEMENT_ROW
>* 
pS‘em’tLßd
;

580 
CBa£Lßd”
<
TRADE_HISTORY_ROW
>* 
pHi¡ÜyLßd
;

581 
CBa£Lßd”
<
CASH_TRANSACTION_ROW
>* 
pCashLßd
;

582 
CBa£Lßd”
<
BROKER_ROW
>* 
pBrok”Lßd
;

583 
iCÁ
=0;

584 
i
;

585 
iCu¼’tLßdUn™
 = 1;

586 
szCu¼’tLßdUn™
[11];

588 
pHŞdšgsLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eHŞdšgLßd”
();

589 
pHŞdšgHi¡ÜyLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eHŞdšgHi¡ÜyLßd”
();

590 
pHŞdšgSumm¬yLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eHŞdšgSumm¬yLßd”
();

591 
pT¿desLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eT¿deLßd”
();

594 
pS‘em’tLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eS‘em’tLßd”
();

595 
pHi¡ÜyLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eT¿deHi¡ÜyLßd”
();

596 
pCashLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eCashT¿n§ùiÚLßd”
();

597 
pBrok”Lßd
 = 
m_pLßd”FaùÜy
->
	`C»©eBrok”Lßd”
();

599 
m_pOuut
->
	`OuutS¹
("Generating TRADE, SETTLEMENT, TRADE HISTORY, CASH TRANSACTION, "

602 
pT¿deG’
 = 
Ãw
 
	`CT¿deG’
(
m_šputFes
, 
m_iCu¡om”CouÁ
, 
m_iS¹FromCu¡om”
,

603 
m_iTÙ®Cu¡om”s
, 
m_iLßdUn™Size
,

604 
m_iSÿËFaùÜ
, 
m_iHoursOfIn™ŸlT¿des
,

605 
m_bCacheEÇbËd


612 
pT¿desLßd
->
	`In™
();

613 
pS‘em’tLßd
->
	`In™
();

614 
pHi¡ÜyLßd
->
	`In™
();

615 
pCashLßd
->
	`In™
();

616 
pBrok”Lßd
->
	`In™
();

617 
pHŞdšgHi¡ÜyLßd
->
	`In™
();

618 
pHŞdšgsLßd
->
	`In™
();

619 
pHŞdšgSumm¬yLßd
->
	`In™
();

627 
bR‘
 = 
pT¿deG’
->
	`G’”©eNextT¿de
();

629 
pT¿desLßd
->
	`Wr™eNextRecÜd
(
pT¿deG’
->
	`G‘T¿deRow
());

631  
i
=0; i<
pT¿deG’
->
	`G‘T¿deHi¡ÜyRowCouÁ
(); ++i)

633 
pHi¡ÜyLßd
->
	`Wr™eNextRecÜd
(
pT¿deG’
->
	`G‘T¿deHi¡ÜyRow
(
i
));

636 iàĞ
pT¿deG’
->
	`G‘S‘em’tRowCouÁ
() )

638 
pS‘em’tLßd
->
	`Wr™eNextRecÜd
(
pT¿deG’
->
	`G‘S‘em’tRow
());

641 iàĞ
pT¿deG’
->
	`G‘CashT¿n§ùiÚRowCouÁ
() )

643 
pCashLßd
->
	`Wr™eNextRecÜd
(
pT¿deG’
->
	`G‘CashT¿n§ùiÚRow
());

646  
i
=0; i<
pT¿deG’
->
	`G‘HŞdšgHi¡ÜyRowCouÁ
(); ++i)

648 
pHŞdšgHi¡ÜyLßd
->
	`Wr™eNextRecÜd
(
pT¿deG’
->
	`G‘HŞdšgHi¡ÜyRow
(
i
));

656 ià(++
iCÁ
 % 10000 == 0)

658 
m_pOuut
->
	`OuutProg»ss
(".");

662 ià(
iCÁ
 % 10000 == 0)

664 
pT¿desLßd
->
	`Comm™
();

665 
pS‘em’tLßd
->
	`Comm™
();

666 
pHi¡ÜyLßd
->
	`Comm™
();

667 
pCashLßd
->
	`Comm™
();

668 
pHŞdšgHi¡ÜyLßd
->
	`Comm™
();

673 } 
bR‘
);

679 
bR‘
 = 
pT¿deG’
->
	`G’”©eNextBrok”RecÜd
();

681 
pBrok”Lßd
->
	`Wr™eNextRecÜd
(
pT¿deG’
->
	`G‘Brok”Row
());

684 ià(++
iCÁ
 % 10000 == 0)

686 
pBrok”Lßd
->
	`Comm™
();

688 } 
bR‘
);

690 
m_pOuut
->
	`OuutProg»ss
("t");

696 
bR‘
 = 
pT¿deG’
->
	`G’”©eNextHŞdšgSumm¬yRow
();

698 
pHŞdšgSumm¬yLßd
->
	`Wr™eNextRecÜd
(
pT¿deG’
->
	`G‘HŞdšgSumm¬yRow
());

700 ià(++
iCÁ
 % 10000 == 0)

702 
m_pOuut
->
	`OuutProg»ss
(".");

706 ià(
iCÁ
 % 10000 == 0)

708 
pHŞdšgSumm¬yLßd
->
	`Comm™
();

710 } 
bR‘
);

716 
bR‘
 = 
pT¿deG’
->
	`G’”©eNextHŞdšg
();

718 
pHŞdšgsLßd
->
	`Wr™eNextRecÜd
(
pT¿deG’
->
	`G‘HŞdšgRow
());

720 ià(++
iCÁ
 % 10000 == 0)

722 
m_pOuut
->
	`OuutProg»ss
(".");

726 ià(
iCÁ
 % 10000 == 0)

728 
pHŞdšgsLßd
->
	`Comm™
();

730 } 
bR‘
);

732 
pT¿desLßd
->
	`FšishLßd
();

733 
pS‘em’tLßd
->
	`FšishLßd
();

734 
pHi¡ÜyLßd
->
	`FšishLßd
();

735 
pCashLßd
->
	`FšishLßd
();

736 
pBrok”Lßd
->
	`FšishLßd
();

737 
pHŞdšgHi¡ÜyLßd
->
	`FšishLßd
();

738 
pHŞdšgsLßd
->
	`FšishLßd
();

739 
pHŞdšgSumm¬yLßd
->
	`FšishLßd
();

744 
	`¢´štf
(
szCu¼’tLßdUn™
, (szCu¼’tLßdUn™), "%d", 
iCu¼’tLßdUn™
++);

746 
m_pOuut
->
	`OuutProg»ss
(
szCu¼’tLßdUn™
);

748 } 
pT¿deG’
->
	`In™NextLßdUn™
());

750 
d–‘e
 
pHŞdšgsLßd
;

751 
d–‘e
 
pHŞdšgHi¡ÜyLßd
;

752 
d–‘e
 
pHŞdšgSumm¬yLßd
;

753 
d–‘e
 
pT¿desLßd
;

756 
d–‘e
 
pS‘em’tLßd
;

757 
d–‘e
 
pHi¡ÜyLßd
;

758 
d–‘e
 
pCashLßd
;

759 
d–‘e
 
pBrok”Lßd
;

761 
d–‘e
 
pT¿deG’
;

763 
m_pOuut
->
	`OuutCom¶‘e
(".loaded.");

764 
m_pOuut
->
	`OuutNewlše
();

765 
m_pOuut
->
	`OuutNewlše
();

766 
	}
}

777 
	gCG’”©eAndLßd
::
	$G’”©eAndLßdIndu¡ry
()

779 
boŞ
 
bEndOfFe
;

780 
CIndu¡ryTabË
 
	`TabË
Ğ
m_szInDœ
 );

781 
CBa£Lßd”
<
INDUSTRY_ROW
>* 
pLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eIndu¡ryLßd”
();

783 
m_pOuut
->
	`OuutS¹
("Generating INDUSTRYable...");

785 
pLßd
->
	`In™
();

787 
bEndOfFe
 = 
TabË
.
	`G’”©eNextRecÜd
();

788  !
bEndOfFe
 )

790 
pLßd
->
	`Wr™eNextRecÜd
(
TabË
.
	`G‘Row
());

791 
bEndOfFe
 = 
TabË
.
	`G’”©eNextRecÜd
();

793 
pLßd
->
	`FšishLßd
();

794 
d–‘e
 
pLßd
;

796 
m_pOuut
->
	`OuutCom¶‘e
("loaded.");

797 
m_pOuut
->
	`OuutNewlše
();

798 
m_pOuut
->
	`OuutNewlše
();

799 
	}
}

810 
	gCG’”©eAndLßd
::
	$G’”©eAndLßdLa¡T¿de
()

812 
boŞ
 
bR‘
;

813 
CLa¡T¿deTabË
 
	`TabË
(
m_šputFes
, 
m_iCu¡om”CouÁ
, 
m_iS¹FromCu¡om”


814 , 
m_iHoursOfIn™ŸlT¿des
);

815 
CBa£Lßd”
<
LAST_TRADE_ROW
>* 
pLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eLa¡T¿deLßd”
();

817 
m_pOuut
->
	`OuutS¹
("Generating LAST TRADEable...");

819 
pLßd
->
	`In™
();

823 
bR‘
 = 
TabË
.
	`G’”©eNextRecÜd
();

825 
pLßd
->
	`Wr™eNextRecÜd
(
TabË
.
	`G‘Row
());

827 } 
bR‘
);

829 
pLßd
->
	`FšishLßd
();

831 
d–‘e
 
pLßd
;

833 
m_pOuut
->
	`OuutCom¶‘e
("loaded.");

834 
m_pOuut
->
	`OuutNewlše
();

835 
m_pOuut
->
	`OuutNewlše
();

836 
	}
}

847 
	gCG’”©eAndLßd
::
	$G’”©eAndLßdNewsI‹mAndNewsXRef
()

849 
boŞ
 
bR‘
;

851 
CNewsI‹mAndXRefTabË
* 
pTabË
 = 
Ãw
 
	`CNewsI‹mAndXRefTabË
Ğ
m_šputFes
,

852 
m_iCu¡om”CouÁ
,

853 
m_iS¹FromCu¡om”
,

854 
m_iHoursOfIn™ŸlT¿des
);

855 
CBa£Lßd”
<
NEWS_ITEM_ROW
>* 
pNewsI‹mLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eNewsI‹mLßd”
();

856 
CBa£Lßd”
<
NEWS_XREF_ROW
>* 
pNewsXRefLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eNewsXRefLßd”
();

857 
INT64
 
iCÁ
=0;

859 
m_pOuut
->
	`OuutS¹
("Generating NEWS_ITEM‡nd NEWS_XREFable...");

861 
pNewsI‹mLßd
->
	`In™
();

862 
pNewsXRefLßd
->
	`In™
();

866 
bR‘
 = 
pTabË
->
	`G’”©eNextRecÜd
();

868 
pNewsI‹mLßd
->
	`Wr™eNextRecÜd
(
pTabË
->
	`G‘NewsI‹mRow
());

870 
pNewsXRefLßd
->
	`Wr™eNextRecÜd
(
pTabË
->
	`G‘NewsXRefRow
());

872 ià(++
iCÁ
 % 1000 == 0)

874 
m_pOuut
->
	`OuutProg»ss
(".");

876 
pNewsI‹mLßd
->
	`Comm™
();

877 
pNewsXRefLßd
->
	`Comm™
();

880 } 
bR‘
);

881 
pNewsI‹mLßd
->
	`FšishLßd
();

882 
pNewsXRefLßd
->
	`FšishLßd
();

883 
d–‘e
 
pNewsI‹mLßd
;

884 
d–‘e
 
pNewsXRefLßd
;

885 
d–‘e
 
pTabË
;

887 
m_pOuut
->
	`OuutCom¶‘e
("loaded.");

888 
m_pOuut
->
	`OuutNewlše
();

889 
m_pOuut
->
	`OuutNewlše
();

890 
	}
}

901 
	gCG’”©eAndLßd
::
	$G’”©eAndLßdSeùÜ
()

903 
boŞ
 
bEndOfFe
;

904 
CSeùÜTabË
 
	`TabË
Ğ
m_szInDœ
 );

905 
CBa£Lßd”
<
SECTOR_ROW
>* 
pLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eSeùÜLßd”
();

907 
m_pOuut
->
	`OuutS¹
("Generating SECTORable...");

909 
pLßd
->
	`In™
();

911 
bEndOfFe
 = 
TabË
.
	`G’”©eNextRecÜd
();

912  !
bEndOfFe
 )

914 
pLßd
->
	`Wr™eNextRecÜd
(
TabË
.
	`G‘Row
());

915 
bEndOfFe
 = 
TabË
.
	`G’”©eNextRecÜd
();

917 
pLßd
->
	`FšishLßd
();

918 
d–‘e
 
pLßd
;

920 
m_pOuut
->
	`OuutCom¶‘e
("loaded.");

921 
m_pOuut
->
	`OuutNewlše
();

922 
m_pOuut
->
	`OuutNewlše
();

923 
	}
}

934 
	gCG’”©eAndLßd
::
	$G’”©eAndLßdSecur™y
()

936 
boŞ
 
bR‘
;

937 
CSecur™yTabË
 
	`TabË
(
m_šputFes
, 
m_iCu¡om”CouÁ
, 
m_iS¹FromCu¡om”
);

938 
CBa£Lßd”
<
SECURITY_ROW
>* 
pLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eSecur™yLßd”
();

939 
INT64
 
iCÁ
=0;

941 
m_pOuut
->
	`OuutS¹
("Generating SECURITYable...");

943 
pLßd
->
	`In™
();

947 
bR‘
 = 
TabË
.
	`G’”©eNextRecÜd
();

949 
pLßd
->
	`Wr™eNextRecÜd
(
TabË
.
	`G‘Row
());

951 ià(++
iCÁ
 % 20000 == 0)

953 
m_pOuut
->
	`OuutProg»ss
(".");

956 } 
bR‘
);

958 
pLßd
->
	`FšishLßd
();

960 
d–‘e
 
pLßd
;

962 
m_pOuut
->
	`OuutCom¶‘e
("loaded.");

963 
m_pOuut
->
	`OuutNewlše
();

964 
m_pOuut
->
	`OuutNewlše
();

965 
	}
}

976 
	gCG’”©eAndLßd
::
	$G’”©eAndLßdStusTy³
()

978 
boŞ
 
bEndOfFe
;

979 
CStusTy³TabË
 
	`TabË
Ğ
m_szInDœ
 );

980 
CBa£Lßd”
<
STATUS_TYPE_ROW
>* 
pLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eStusTy³Lßd”
();

982 
m_pOuut
->
	`OuutS¹
("Generating STATUS_TYPEable...");

984 
pLßd
->
	`In™
();

986 
bEndOfFe
 = 
TabË
.
	`G’”©eNextRecÜd
();

987  !
bEndOfFe
 )

989 
pLßd
->
	`Wr™eNextRecÜd
(
TabË
.
	`G‘Row
());

990 
bEndOfFe
 = 
TabË
.
	`G’”©eNextRecÜd
();

992 
pLßd
->
	`FšishLßd
();

993 
d–‘e
 
pLßd
;

995 
m_pOuut
->
	`OuutCom¶‘e
("loaded.");

996 
m_pOuut
->
	`OuutNewlše
();

997 
m_pOuut
->
	`OuutNewlše
();

998 
	}
}

1009 
	gCG’”©eAndLßd
::
	$G’”©eAndLßdTax¿‹
()

1011 
boŞ
 
bMÜeRecÜds
;

1012 
CTax¿‹TabË
 
	`TabË
Ğ
m_šputFes
 );

1013 
CBa£Lßd”
<
TAXRATE_ROW
>* 
pLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eTax¿‹Lßd”
();

1015 
m_pOuut
->
	`OuutS¹
("Generating TAXRATEable...");

1017 
pLßd
->
	`In™
();

1021 
bMÜeRecÜds
 = 
TabË
.
	`G’”©eNextRecÜd
();

1023 
pLßd
->
	`Wr™eNextRecÜd
(
TabË
.
	`G‘Row
());

1025 }  
bMÜeRecÜds
 );

1027 
pLßd
->
	`FšishLßd
();

1028 
d–‘e
 
pLßd
;

1030 
m_pOuut
->
	`OuutCom¶‘e
("loaded.");

1031 
m_pOuut
->
	`OuutNewlše
();

1032 
m_pOuut
->
	`OuutNewlše
();

1033 
	}
}

1044 
	gCG’”©eAndLßd
::
	$G’”©eAndLßdT¿deTy³
()

1046 
boŞ
 
bEndOfFe
;

1047 
CT¿deTy³TabË
 
	`TabË
Ğ
m_szInDœ
 );

1048 
CBa£Lßd”
<
TRADE_TYPE_ROW
>* 
pLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eT¿deTy³Lßd”
();

1050 
m_pOuut
->
	`OuutS¹
("Generating TRADE_TYPEable...");

1052 
pLßd
->
	`In™
();

1054 
bEndOfFe
 = 
TabË
.
	`G’”©eNextRecÜd
();

1055  !
bEndOfFe
 )

1057 
pLßd
->
	`Wr™eNextRecÜd
(
TabË
.
	`G‘Row
());

1058 
bEndOfFe
 = 
TabË
.
	`G’”©eNextRecÜd
();

1060 
pLßd
->
	`FšishLßd
();

1061 
d–‘e
 
pLßd
;

1063 
m_pOuut
->
	`OuutCom¶‘e
("loaded.");

1064 
m_pOuut
->
	`OuutNewlše
();

1065 
m_pOuut
->
	`OuutNewlše
();

1066 
	}
}

1077 
	gCG’”©eAndLßd
::
	$G’”©eAndLßdW©chLi¡AndW©chI‹m
()

1079 
boŞ
 
bR‘
;

1080 
CW©chLi¡sAndI‹msTabË
 
	`TabË
(
m_šputFes
, 
m_iCu¡om”CouÁ
, 
m_iS¹FromCu¡om”
);

1081 
CBa£Lßd”
<
WATCH_LIST_ROW
>* 
pW©chLi¡sLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eW©chLi¡Lßd”
();

1082 
CBa£Lßd”
<
WATCH_ITEM_ROW
>* 
pW©chI‹msLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eW©chI‹mLßd”
();

1083 
INT64
 
iCÁ
=0;

1084 
UINT
 
i
;

1086 
m_pOuut
->
	`OuutS¹
("Generating WATCH_LISTable‡nd WATCH_ITEMable...");

1088 
pW©chLi¡sLßd
->
	`In™
();

1089 
pW©chI‹msLßd
->
	`In™
();

1093 
bR‘
 = 
TabË
.
	`G’”©eNextRecÜd
();

1095 
pW©chLi¡sLßd
->
	`Wr™eNextRecÜd
(
TabË
.
	`G‘WLRow
());

1097 
i
=0; i<
TabË
.
	`G‘WICouÁ
(); ++i)

1099 
pW©chI‹msLßd
->
	`Wr™eNextRecÜd
(
TabË
.
	`G‘WIRow
(
i
));

1101 ià(++
iCÁ
 % 20000 == 0)

1103 
m_pOuut
->
	`OuutProg»ss
(".");

1105 
pW©chLi¡sLßd
->
	`Comm™
();

1106 
pW©chI‹msLßd
->
	`Comm™
();

1109 } 
bR‘
);

1111 
pW©chLi¡sLßd
->
	`FšishLßd
();

1112 
pW©chI‹msLßd
->
	`FšishLßd
();

1114 
d–‘e
 
pW©chLi¡sLßd
;

1115 
d–‘e
 
pW©chI‹msLßd
;

1117 
m_pOuut
->
	`OuutCom¶‘e
("loaded.");

1118 
m_pOuut
->
	`OuutNewlše
();

1119 
m_pOuut
->
	`OuutNewlše
();

1120 
	}
}

1131 
	gCG’”©eAndLßd
::
	$G’”©eAndLßdZCode
()

1133 
CZCodeTabË
 
	`TabË
Ğ
m_šputFes
 );

1134 
CBa£Lßd”
<
ZIP_CODE_ROW
>* 
pLßd
 = 
m_pLßd”FaùÜy
->
	`C»©eZCodeLßd”
();

1136 
m_pOuut
->
	`OuutS¹
("Generating ZIP_CODEable...");

1138 
pLßd
->
	`In™
();

1140  
TabË
.
	`G’”©eNextRecÜd
() )

1142 
pLßd
->
	`Wr™eNextRecÜd
(
TabË
.
	`G‘Row
());

1144 
pLßd
->
	`FšishLßd
();

1145 
d–‘e
 
pLßd
;

1147 
m_pOuut
->
	`OuutCom¶‘e
("loaded.");

1148 
m_pOuut
->
	`OuutNewlše
();

1149 
m_pOuut
->
	`OuutNewlše
();

1150 
	}
}

1163 
	gCG’”©eAndLßd
::
	$G’”©eAndLßdFixedTabËs
()

1166 
	`G’”©eAndLßdCh¬ge
();

1167 
	`G’”©eAndLßdCommissiÚR©e
();

1168 
	`G’”©eAndLßdExchªge
();

1169 
	`G’”©eAndLßdIndu¡ry
();

1170 
	`G’”©eAndLßdSeùÜ
();

1171 
	`G’”©eAndLßdStusTy³
();

1172 
	`G’”©eAndLßdTax¿‹
();

1173 
	`G’”©eAndLßdT¿deTy³
();

1174 
	`G’”©eAndLßdZCode
();

1175 
	}
}

1189 
	gCG’”©eAndLßd
::
	$G’”©eAndLßdSÿlšgTabËs
()

1193 
	`G’”©eAndLßdAdd»ss
();

1194 
	`G’”©eAndLßdCu¡om”
();

1195 
	`G’”©eAndLßdCu¡om”AccouÁAndAccouÁP”missiÚ
();

1196 
	`G’”©eAndLßdCu¡om”Tax¿‹
();

1197 
	`G’”©eAndLßdW©chLi¡AndW©chI‹m
();

1201 
	`G’”©eAndLßdCom·ny
();

1202 
	`G’”©eAndLßdCom·nyCom³t™Ü
();

1203 
	`G’”©eAndLßdDayM¬k‘
();

1204 
	`G’”©eAndLßdFšªcŸl
();

1205 
	`G’”©eAndLßdLa¡T¿de
();

1206 
	`G’”©eAndLßdNewsI‹mAndNewsXRef
();

1207 
	`G’”©eAndLßdSecur™y
();

1208 
	}
}

1222 
	gCG’”©eAndLßd
::
	$G’”©eAndLßdGrowšgTabËs
()

1224 
	`G’”©eAndLßdHŞdšgAndT¿de
();

1225 
	}
}

1234 
	gCG’”©eAndLßd
::
	$In™Add»ss
(){

1236 
add»ssTabË
ğ
Ãw
 
	`CAdd»ssTabË
(
m_šputFes
, 
m_iCu¡om”CouÁ
, 
m_iS¹FromCu¡om”
, m_iS¹FromCu¡om” !ğ
iDeçuÉS¹FromCu¡om”
);

1239 
	}
}

1241 
	gCG’”©eAndLßd
::
	$R–—£Add»ss
(){

1242 
d–‘e
 
add»ssTabË
;

1243 
	}
}

1245 
PADDRESS_ROW
 
	gCG’”©eAndLßd
::
	$g‘Add»ssRow
()

1247  (
PADDRESS_ROW
)
add»ssTabË
->
	`G‘Row
();

1248 
	}
}

1251 
boŞ
 
	gCG’”©eAndLßd
::
	$hasNextAdd»ss
()

1253  
add»ssTabË
->
	`G’”©eNextRecÜd
();

1254 
	}
}

1258 
	gCG’”©eAndLßd
::
	$In™Ch¬ge
()

1260 
ch¬geTabË
 = 
Ãw
 
	`CCh¬geTabË
Ğ
m_szInDœ
 );

1261 
	}
}

1263 
	gCG’”©eAndLßd
::
	$R–—£Ch¬ge
(){

1264 
d–‘e
 
ch¬geTabË
;

1265 
	}
}

1268 
PCHARGE_ROW
 
	gCG’”©eAndLßd
::
	$g‘Ch¬geRow
()

1270  (
PCHARGE_ROW
)
ch¬geTabË
->
	`G‘Row
();

1271 
	}
}

1273 
boŞ
 
	gCG’”©eAndLßd
::
	$isLa¡Ch¬ge
()

1275  
ch¬geTabË
->
	`G’”©eNextRecÜd
();

1276 
	}
}

1280 
	gCG’”©eAndLßd
::
	$In™CommissiÚR©e
()

1282 
commissiÚR©eTabË
 = 
Ãw
 
	`CCommissiÚR©eTabË
Ğ
m_szInDœ
 );

1284 
	}
}

1285 
	gCG’”©eAndLßd
::
	$R–—£CommissiÚR©e
(){

1286 
d–‘e
 
commissiÚR©eTabË
;

1287 
	}
}

1288 
PCOMMISSION_RATE_ROW
 
	gCG’”©eAndLßd
::
	$g‘CommissiÚR©eRow
()

1290  (
PCOMMISSION_RATE_ROW
)
commissiÚR©eTabË
->
	`G‘Row
();

1291 
	}
}

1293 
boŞ
 
	gCG’”©eAndLßd
::
	$isLa¡CommissiÚR©e
()

1295  
commissiÚR©eTabË
->
	`G’”©eNextRecÜd
();

1296 
	}
}

1300 
	gCG’”©eAndLßd
::
	$In™Com·ny
()

1302 
com·nyTabË
 = 
Ãw
 
	`CCom·nyTabË
(
m_šputFes
, 
m_iCu¡om”CouÁ
, 
m_iS¹FromCu¡om”
);

1303 
	}
}

1304 
	gCG’”©eAndLßd
::
	$R–—£Com·ny
(){

1305 
d–‘e
 
com·nyTabË
;

1306 
	}
}

1308 
PCOMPANY_ROW
 
	gCG’”©eAndLßd
::
	$g‘Com·nyRow
()

1310  (
PCOMPANY_ROW
)
com·nyTabË
->
	`G‘Row
();

1311 
	}
}

1313 
boŞ
 
	gCG’”©eAndLßd
::
	$hasNextCom·ny
()

1315  
com·nyTabË
->
	`G’”©eNextRecÜd
();

1316 
	}
}

1320 
	gCG’”©eAndLßd
::
	$In™Com·nyCom³t™Ü
()

1322 
com·nyCom³t™ÜTabË
=
Ãw
 
	`CCom·nyCom³t™ÜTabË
(
m_šputFes
, 
m_iCu¡om”CouÁ
, 
m_iS¹FromCu¡om”
);

1324 
	}
}

1325 
	gCG’”©eAndLßd
::
	$R–—£Com·nyCom³t™Ü
(){

1326 
d–‘e
 
com·nyCom³t™ÜTabË
;

1327 
	}
}

1329 
PCOMPANY_COMPETITOR_ROW
 
	gCG’”©eAndLßd
::
	$g‘Com·nyCom³t™ÜRow
()

1331  (
PCOMPANY_COMPETITOR_ROW
)
com·nyCom³t™ÜTabË
->
	`G‘Row
();

1332 
	}
}

1334 
boŞ
 
	gCG’”©eAndLßd
::
	$hasNextCom·nyCom³t™Ü
()

1336  
com·nyCom³t™ÜTabË
->
	`G’”©eNextRecÜd
();

1337 
	}
}

1341 
	gCG’”©eAndLßd
::
	$In™Cu¡om”
()

1343 
cu¡om”TabË
 = 
Ãw
 
	`CCu¡om”TabË
(
m_šputFes
, 
m_iCu¡om”CouÁ
, 
m_iS¹FromCu¡om”
);

1344 
	}
}

1346 
	gCG’”©eAndLßd
::
	$R–—£Cu¡om”
(){

1347 
d–‘e
 
cu¡om”TabË
;

1348 
	}
}

1350 
PCUSTOMER_ROW
 
	gCG’”©eAndLßd
::
	$g‘Cu¡om”Row
()

1352  (
PCUSTOMER_ROW
)
cu¡om”TabË
->
	`G‘Row
();

1353 
	}
}

1355 
boŞ
 
	gCG’”©eAndLßd
::
	$hasNextCu¡om”
()

1357  
cu¡om”TabË
->
	`G’”©eNextRecÜd
();

1358 
	}
}

1364 
	gCG’”©eAndLßd
::
	$In™Cu¡om”AccouÁAndAccouÁP”missiÚ
(){

1365 
cu¡om”AccouÁsAndP”missiÚsTabË
 =
Ãw
 
	`CCu¡om”AccouÁsAndP”missiÚsTabË
(
m_šputFes
, 
m_iLßdUn™Size
, 
m_iCu¡om”CouÁ
, 
m_iS¹FromCu¡om”
);

1366 
	}
}

1368 
	gCG’”©eAndLßd
::
	$R–—£Cu¡om”AccouÁAndAccouÁP”missiÚ
(){

1369 
d–‘e
 
cu¡om”AccouÁsAndP”missiÚsTabË
;

1370 
	}
}

1372 
PCUSTOMER_ACCOUNT_ROW
 
	gCG’”©eAndLßd
::
	$g‘Cu¡om”AccouÁRow
()

1374  (
PCUSTOMER_ACCOUNT_ROW
)
cu¡om”AccouÁsAndP”missiÚsTabË
->
	`G‘CARow
();

1375 
	}
}

1377 
boŞ
 
	gCG’”©eAndLßd
::
	$hasNextCu¡om”AccouÁ
()

1379  
cu¡om”AccouÁsAndP”missiÚsTabË
->
	`G’”©eNextRecÜd
();

1380 
	}
}

1384 
PACCOUNT_PERMISSION_ROW
 
	gCG’”©eAndLßd
::
	$g‘AccouÁP”missiÚRow
(
i
)

1386  (
PACCOUNT_PERMISSION_ROW
)
cu¡om”AccouÁsAndP”missiÚsTabË
->
	`G‘APRow
(
i
);

1387 
	}
}

1389 
	gCG’”©eAndLßd
::
	$P”missiÚsP”Cu¡om”
()

1391  
cu¡om”AccouÁsAndP”missiÚsTabË
->
	`G‘CAP”msCouÁ
();

1392 
	}
}

1425 
	gCG’”©eAndLßd
::
	$In™Cu¡om”Tax¿‹
()

1427 
cu¡om”Tax¿‹sTabË
 = 
Ãw
 
	`CCu¡om”Tax¿‹sTabË
(
m_šputFes
, 
m_iCu¡om”CouÁ
, 
m_iS¹FromCu¡om”
);

1445 
	}
}

1446 
	gCG’”©eAndLßd
::
	$R–—£Cu¡om”Tax¿‹
(){

1447 
d–‘e
 
cu¡om”Tax¿‹sTabË
;

1448 
	}
}

1450 
boŞ
 
	gCG’”©eAndLßd
::
	$hasNextCu¡om”Tax¿‹
()

1452  
cu¡om”Tax¿‹sTabË
->
	`G’”©eNextRecÜd
();

1453 
	}
}

1454 
	gCG’”©eAndLßd
::
	$g‘Tax¿‹sCouÁ
()

1456  
cu¡om”Tax¿‹sTabË
->
	`G‘TaxR©esCouÁ
();

1457 
	}
}

1459 
PCUSTOMER_TAXRATE_ROW
 
	gCG’”©eAndLßd
::
	$g‘Cu¡om”Tax¿‹Row
(
i
)

1461  (
PCUSTOMER_TAXRATE_ROW
)
cu¡om”Tax¿‹sTabË
->
	`G‘RowByIndex
(
i
);

1462 
	}
}

1467 
	gCG’”©eAndLßd
::
	$In™DayM¬k‘
()

1469 
dayM¬k‘TabË
 = 
Ãw
 
	`CDayM¬k‘TabË
(
m_šputFes
, 
m_iCu¡om”CouÁ
, 
m_iS¹FromCu¡om”
);

1470 
	}
}

1471 
	gCG’”©eAndLßd
::
	$R–—£DayM¬k‘
(){

1472 
d–‘e
 
dayM¬k‘TabË
;

1473 
	}
}

1475 
PDAILY_MARKET_ROW
 
	gCG’”©eAndLßd
::
	$g‘DayM¬k‘Row
()

1477  (
PDAILY_MARKET_ROW
)
dayM¬k‘TabË
->
	`G‘Row
();

1478 
	}
}

1480 
boŞ
 
	gCG’”©eAndLßd
::
	$hasNextDayM¬k‘
()

1482  
dayM¬k‘TabË
->
	`G’”©eNextRecÜd
();

1483 
	}
}

1486 
	gCG’”©eAndLßd
::
	$In™Exchªge
()

1488 
exchªgeTabË
 = 
Ãw
 
	`CExchªgeTabË
Ğ
m_szInDœ
, 
m_iTÙ®Cu¡om”s
 );

1489 
	}
}

1490 
	gCG’”©eAndLßd
::
	$R–—£Exchªge
(){

1491 
d–‘e
 
exchªgeTabË
;

1492 
	}
}

1494 
PEXCHANGE_ROW
 
	gCG’”©eAndLßd
::
	$g‘ExchªgeRow
()

1496  (
PEXCHANGE_ROW
)
exchªgeTabË
->
	`G‘Row
();

1497 
	}
}

1499 
boŞ
 
	gCG’”©eAndLßd
::
	$isLa¡Exchªge
()

1501  
exchªgeTabË
->
	`G’”©eNextRecÜd
();

1502 
	}
}

1506 
	gCG’”©eAndLßd
::
	$In™FšªcŸl
()

1508 
fšªcŸlTabË
 = 
Ãw
 
	`CFšªcŸlTabË
(
m_šputFes
, 
m_iCu¡om”CouÁ
, 
m_iS¹FromCu¡om”
);

1510 
	}
}

1512 
	gCG’”©eAndLßd
::
	$R–—£FšªcŸl
(){

1513 
d–‘e
 
fšªcŸlTabË
;

1514 
	}
}

1516 
PFINANCIAL_ROW
 
	gCG’”©eAndLßd
::
	$g‘FšªcŸlRow
()

1518  (
PFINANCIAL_ROW
)
fšªcŸlTabË
->
	`G‘Row
();

1519 
	}
}

1521 
boŞ
 
	gCG’”©eAndLßd
::
	$hasNextFšªcŸl
()

1523  
fšªcŸlTabË
->
	`G’”©eNextRecÜd
();

1524 
	}
}

1528 
	gCG’”©eAndLßd
::
	$In™HŞdšgAndT¿de
()

1531 
	`´štf
("\n\Àcu¡om”sğ%d,†ßdun™ğ%d\n\n", 
m_iTÙ®Cu¡om”s
, 
m_iLßdUn™Size
);

1533 
pT¿deG’
 = 
Ãw
 
	`CT¿deG’
(
m_šputFes
, 
m_iCu¡om”CouÁ
, 
m_iS¹FromCu¡om”
,

1534 
m_iTÙ®Cu¡om”s
, 
m_iLßdUn™Size
,

1535 
m_iSÿËFaùÜ
, 
m_iHoursOfIn™ŸlT¿des
);

1536 #ifdeà
COMPILE_FLAT_FILE_LOAD


1537 
fhs
=
	`fİ’
("hsummary.txt","wt");

1539 
	}
}

1541 
	gCG’”©eAndLßd
::
	$R–—£HŞdšgAndT¿de
(){

1542 
d–‘e
 
pT¿deG’
;

1543 #ifdeà
COMPILE_FLAT_FILE_LOAD


1544 
	`fşo£
(
fhs
);

1546 
	}
}

1548 
boŞ
 
	gCG’”©eAndLßd
::
	$hasNextLßdUn™
()

1550 
boŞ
 
x
=
çl£
;

1551 
	`´štf
("\n\n BEFORE \n\n");

1553 
x
 =
pT¿deG’
->
	`In™NextLßdUn™
();

1554 if(
x
è
	`´štf
("\n\nhasnext AFTER TRUE\n\n");

1555 
	`´štf
("\n\nhasnext AFTER FALSE\n\n");

1556  
x
;

1557 
	}
}

1560 
boŞ
 
	gCG’”©eAndLßd
::
	$hasNextT¿de
()

1562  
pT¿deG’
->
	`G’”©eNextT¿de
();

1563 
	}
}

1565 
PTRADE_ROW
 
	gCG’”©eAndLßd
::
	$g‘T¿deRow
()

1567  (
PTRADE_ROW
)
pT¿deG’
->
	`G‘T¿deRow
();

1568 
	}
}

1571 
boŞ
 
	gCG’”©eAndLßd
::
	$shouldProûssT¿deReque¡Row
()

1574  
çl£
;

1575 
	}
}

1577 
PTRADE_REQUEST_ROW
 
	gCG’”©eAndLßd
::
	$g‘T¿deReque¡Row
()

1581 
	}
}

1584 
PTRADE_HISTORY_ROW
 
	gCG’”©eAndLßd
::
	$g‘T¿deHi¡ÜyRow
(
i
)

1586  (
PTRADE_HISTORY_ROW
)
pT¿deG’
->
	`G‘T¿deHi¡ÜyRow
(
i
);

1587 
	}
}

1589 
	gCG’”©eAndLßd
::
	$g‘T¿deHi¡ÜyRowCouÁ
()

1591  
pT¿deG’
->
	`G‘T¿deHi¡ÜyRowCouÁ
();

1592 
	}
}

1595 
boŞ
 
	gCG’”©eAndLßd
::
	$shouldProûssCashT¿n§ùiÚRow
()

1597  (
pT¿deG’
->
	`G‘CashT¿n§ùiÚRowCouÁ
() != 0);

1598 
	}
}

1600 
PCASH_TRANSACTION_ROW
 
	gCG’”©eAndLßd
::
	$g‘CashT¿n§ùiÚRow
()

1602  (
PCASH_TRANSACTION_ROW
)
pT¿deG’
->
	`G‘CashT¿n§ùiÚRow
();

1603 
	}
}

1606 
boŞ
 
	gCG’”©eAndLßd
::
	$shouldProûssS‘em’tRow
()

1608  (
pT¿deG’
->
	`G‘S‘em’tRowCouÁ
() != 0);

1610 
	}
}

1611 
PSETTLEMENT_ROW
 
	gCG’”©eAndLßd
::
CG’”©eAndLßd
::
	$g‘S‘em’tRow
 ()

1613  (
PSETTLEMENT_ROW
)
pT¿deG’
->
	`G‘S‘em’tRow
();

1614 
	}
}

1618 
boŞ
 
	gCG’”©eAndLßd
::
	$hasNextHŞdšg
()

1620  
pT¿deG’
->
	`G’”©eNextHŞdšg
();

1621 
	}
}

1623 
PHOLDING_ROW
 
	gCG’”©eAndLßd
::
	$g‘HŞdšgRow
()

1625  (
PHOLDING_ROW
)
pT¿deG’
->
	`G‘HŞdšgRow
();

1626 
	}
}

1629 
PHOLDING_HISTORY_ROW
 
	gCG’”©eAndLßd
::
	$g‘HŞdšgHi¡ÜyRow
(
i
)

1631  (
PHOLDING_HISTORY_ROW
)
pT¿deG’
->
	`G‘HŞdšgHi¡ÜyRow
(
i
);

1632 
	}
}

1634 
	gCG’”©eAndLßd
::
	$g‘HŞdšgHi¡ÜyRowCouÁ
()

1636  
pT¿deG’
->
	`G‘HŞdšgHi¡ÜyRowCouÁ
();

1637 
	}
}

1640 
boŞ
 
	gCG’”©eAndLßd
::
	$hasNextHŞdšgSumm¬y
()

1643  
pT¿deG’
->
	`G’”©eNextHŞdšgSumm¬yRow
();

1645 
	}
}

1647 
PHOLDING_SUMMARY_ROW
 
	gCG’”©eAndLßd
::
	$g‘HŞdšgSumm¬yRow
()

1649 
PHOLDING_SUMMARY_ROW
 
xx
ğ(PHOLDING_SUMMARY_ROW)
pT¿deG’
->
	`G‘HŞdšgSumm¬yRow
();

1650 #ifdeà
COMPILE_FLAT_FILE_LOAD


1651 
	`årštf
(
fhs
,"%Îd|%s|%d\n",
xx
->
HS_CA_ID
, xx->
HS_S_SYMB
, xx->
HS_QTY
);

1653  
xx
;

1654 
	}
}

1657 
boŞ
 
	gCG’”©eAndLßd
::
	$hasNextBrok”
()

1659  
pT¿deG’
->
	`G’”©eNextBrok”RecÜd
();

1660 
	}
}

1662 
PBROKER_ROW
 
	gCG’”©eAndLßd
::
	$g‘Brok”Row
()

1664  (
PBROKER_ROW
 )
pT¿deG’
->
	`G‘Brok”Row
();

1665 
	}
}

1807 
	gCG’”©eAndLßd
::
	$In™Indu¡ry
()

1809 
šdu¡ryTabË
 = 
Ãw
 
	`CIndu¡ryTabË
Ğ
m_szInDœ
 );

1810 
	}
}

1811 
	gCG’”©eAndLßd
::
	$R–—£Indu¡ry
(){

1812 
d–‘e
 
šdu¡ryTabË
;

1813 
	}
}

1815 
PINDUSTRY_ROW
 
	gCG’”©eAndLßd
::
	$g‘Indu¡ryRow
()

1817  (
PINDUSTRY_ROW
)
šdu¡ryTabË
->
	`G‘Row
();

1818 
	}
}

1820 
boŞ
 
	gCG’”©eAndLßd
::
	$isLa¡Indu¡ry
()

1822  
šdu¡ryTabË
->
	`G’”©eNextRecÜd
();

1823 
	}
}

1827 
	gCG’”©eAndLßd
::
	$In™La¡T¿de
()

1829 
Ï¡T¿deTabË
 = 
Ãw
 
	`CLa¡T¿deTabË
(
m_šputFes
, 
m_iCu¡om”CouÁ
, 
m_iS¹FromCu¡om”
 , 
m_iHoursOfIn™ŸlT¿des
);

1830 
	}
}

1831 
	gCG’”©eAndLßd
::
	$R–—£La¡T¿de
(){

1832 
d–‘e
 
Ï¡T¿deTabË
;

1833 
	}
}

1835 
PLAST_TRADE_ROW
 
	gCG’”©eAndLßd
::
	$g‘La¡T¿deRow
()

1837  (
PLAST_TRADE_ROW
)
Ï¡T¿deTabË
->
	`G‘Row
();

1838 
	}
}

1840 
boŞ
 
	gCG’”©eAndLßd
::
	$hasNextLa¡T¿de
()

1842  
Ï¡T¿deTabË
->
	`G’”©eNextRecÜd
();

1843 
	}
}

1848 
	gCG’”©eAndLßd
::
	$In™NewsI‹mAndNewsXRef
()

1850 
ÃwsI‹mAndXRefTabË
 = 
Ãw
 
	`CNewsI‹mAndXRefTabË
(
m_šputFes
, 
m_iCu¡om”CouÁ
, 
m_iS¹FromCu¡om”
, 
m_iHoursOfIn™ŸlT¿des
);

1851 
	}
}

1853 
	gCG’”©eAndLßd
::
	$R–—£NewsI‹mAndNewsXRef
(){

1854 
d–‘e
 
ÃwsI‹mAndXRefTabË
;

1855 
	}
}

1857 
PNEWS_ITEM_ROW
 
	gCG’”©eAndLßd
::
	$g‘NewsI‹mRow
()

1859  (
PNEWS_ITEM_ROW
)
ÃwsI‹mAndXRefTabË
->
	`G‘NewsI‹mRow
();

1860 
	}
}

1862 
PNEWS_XREF_ROW
 
	gCG’”©eAndLßd
::
	$g‘NewsXRefRow
()

1864  (
PNEWS_XREF_ROW
)
ÃwsI‹mAndXRefTabË
->
	`G‘NewsXRefRow
();

1865 
	}
}

1867 
boŞ
 
	gCG’”©eAndLßd
::
	$hasNextNewsI‹mAndNewsXRef
()

1869  
ÃwsI‹mAndXRefTabË
->
	`G’”©eNextRecÜd
();

1870 
	}
}

1874 
	gCG’”©eAndLßd
::
	$In™SeùÜ
()

1876 
£ùÜTabË
 = 
Ãw
 
	`CSeùÜTabË
Ğ
m_szInDœ
 );

1877 
	}
}

1879 
	gCG’”©eAndLßd
::
	$R–—£SeùÜ
(){

1880 
d–‘e
 
£ùÜTabË
;

1881 
	}
}

1883 
PSECTOR_ROW
 
	gCG’”©eAndLßd
::
	$g‘SeùÜRow
()

1885  (
PSECTOR_ROW
)
£ùÜTabË
->
	`G‘Row
();

1886 
	}
}

1888 
boŞ
 
	gCG’”©eAndLßd
::
	$isLa¡SeùÜ
()

1890  
£ùÜTabË
->
	`G’”©eNextRecÜd
();

1891 
	}
}

1895 
	gCG’”©eAndLßd
::
	$In™Secur™y
()

1897 
£cur™yTabË
 = 
Ãw
 
	`CSecur™yTabË
(
m_šputFes
, 
m_iCu¡om”CouÁ
, 
m_iS¹FromCu¡om”
);

1898 #ifdeà
COMPILE_FLAT_FILE_LOAD


1899 
f£c
 = 
	`fİ’
 ("security.txt", "wt");

1901 
	}
}

1902 
	gCG’”©eAndLßd
::
	$R–—£Secur™y
(){

1903 
d–‘e
 
£cur™yTabË
;

1904 #ifdeà
COMPILE_FLAT_FILE_LOAD


1905 
	`fşo£
(
f£c
);

1907 
	}
}

1909 
PSECURITY_ROW
 
	gCG’”©eAndLßd
::
	$g‘Secur™yRow
()

1911 
PSECURITY_ROW
 
x
 = (PSECURITY_ROW)
£cur™yTabË
->
	`G‘Row
();

1912 #ifdeà
COMPILE_FLAT_FILE_LOAD


1913 
	`årštf
(
f£c
,"%s|%s|%s|%s\n",
x
->
S_SYMB
, x->
S_ISSUE
, x->
S_ST_ID
, x->
S_NAME
);

1915  
x
;

1916 
	}
}

1918 
boŞ
 
	gCG’”©eAndLßd
::
	$hasNextSecur™y
()

1920  
£cur™yTabË
->
	`G’”©eNextRecÜd
();

1921 
	}
}

1924 
	gCG’”©eAndLßd
::
	$In™StusTy³
()

1926 
¡©usTy³TabË
 = 
Ãw
 
	`CStusTy³TabË
Ğ
m_szInDœ
 );

1927 
	}
}

1928 
	gCG’”©eAndLßd
::
	$R–—£StusTy³
(){

1929 
d–‘e
 
¡©usTy³TabË
;

1930 
	}
}

1932 
PSTATUS_TYPE_ROW
 
	gCG’”©eAndLßd
::
	$g‘StusTy³Row
()

1934  (
PSTATUS_TYPE_ROW
)
¡©usTy³TabË
->
	`G‘Row
();

1935 
	}
}

1937 
boŞ
 
	gCG’”©eAndLßd
::
	$isLa¡StusTy³
()

1939  
¡©usTy³TabË
->
	`G’”©eNextRecÜd
();

1940 
	}
}

1944 
	gCG’”©eAndLßd
::
	$In™Tax¿‹
(){

1945 
x¿‹TabË
 = 
Ãw
 
	`CTax¿‹TabË
Ğ
m_šputFes
 );

1946 
	}
}

1948 
	gCG’”©eAndLßd
::
	$R–—£Tax¿‹
(){

1949 
d–‘e
 
x¿‹TabË
;

1950 
	}
}

1952 
PTAXRATE_ROW
 
	gCG’”©eAndLßd
::
	$g‘Tax¿‹Row
()

1954  (
PTAXRATE_ROW
)
x¿‹TabË
->
	`G‘Row
();

1955 
	}
}

1957 
boŞ
 
	gCG’”©eAndLßd
::
	$hasNextTax¿‹
()

1959  
x¿‹TabË
->
	`G’”©eNextRecÜd
();

1960 
	}
}

1965 
	gCG’”©eAndLßd
::
	$In™T¿deTy³
()

1967 
ŒadeTy³TabË
 = 
Ãw
 
	`CT¿deTy³TabË
Ğ
m_szInDœ
 );

1968 
	}
}

1970 
	gCG’”©eAndLßd
::
	$R–—£T¿deTy³
(){

1971 
d–‘e
 
ŒadeTy³TabË
;

1972 
	}
}

1974 
PTRADE_TYPE_ROW
 
	gCG’”©eAndLßd
::
	$g‘T¿deTy³Row
()

1976  (
PTRADE_TYPE_ROW
)
ŒadeTy³TabË
->
	`G‘Row
();

1977 
	}
}

1979 
boŞ
 
	gCG’”©eAndLßd
::
	$isLa¡T¿deTy³
()

1981  
ŒadeTy³TabË
->
	`G’”©eNextRecÜd
();

1982 
	}
}

1987 
	gCG’”©eAndLßd
::
	$In™W©chLi¡AndW©chI‹m
()

1989 
w©chLi¡sAndI‹msTabË
 = 
Ãw
 
	`CW©chLi¡sAndI‹msTabË
(
m_šputFes
, 
m_iCu¡om”CouÁ
, 
m_iS¹FromCu¡om”
);

1990 
	}
}

1992 
	gCG’”©eAndLßd
::
	$R–—£W©chLi¡AndW©chI‹m
(){

1993 
d–‘e
 
w©chLi¡sAndI‹msTabË
;

1994 
	}
}

1996 
boŞ
 
	gCG’”©eAndLßd
::
	$hasNextW©chLi¡
()

1998  
w©chLi¡sAndI‹msTabË
->
	`G’”©eNextRecÜd
();

1999 
	}
}

2002 
PWATCH_LIST_ROW
 
	gCG’”©eAndLßd
::
	$g‘W©chLi¡Row
()

2004  (
PWATCH_LIST_ROW
)
w©chLi¡sAndI‹msTabË
->
	`G‘WLRow
();

2005 
	}
}

2007 
	gCG’”©eAndLßd
::
	$I‹msP”W©chLi¡
(){

2008  
w©chLi¡sAndI‹msTabË
->
	`G‘WICouÁ
();

2009 
	}
}

2012 
PWATCH_ITEM_ROW
 
	gCG’”©eAndLßd
::
	$g‘W©chI‹mRow
(
i
)

2014  (
PWATCH_ITEM_ROW
)
w©chLi¡sAndI‹msTabË
->
	`G‘WIRow
(
i
);

2015 
	}
}

2041 
	gCG’”©eAndLßd
::
	$In™ZCode
()

2043 
zCodeTabË
 = 
Ãw
 
	`CZCodeTabË
Ğ
m_šputFes
 );

2044 
	}
}

2046 
	gCG’”©eAndLßd
::
	$R–—£ZCode
(){

2047 
d–‘e
 
zCodeTabË
;

2048 
	}
}

2050 
PZIP_CODE_ROW
 
	gCG’”©eAndLßd
::
	$g‘ZCodeRow
()

2052  (
PZIP_CODE_ROW
)
zCodeTabË
->
	`G‘Row
();

2053 
	}
}

2055 
boŞ
 
	gCG’”©eAndLßd
::
	$hasNextZCode
()

2057  
zCodeTabË
->
	`G’”©eNextRecÜd
();

2058 
	}
}

2066 
	gCG’”©eAndLßd
::
	$In™FixedTabËs
()

2069 
	`In™Ch¬ge
();

2070 
	`In™CommissiÚR©e
();

2071 
	`In™Exchªge
();

2072 
	`In™Indu¡ry
();

2073 
	`In™SeùÜ
();

2074 
	`In™StusTy³
();

2075 
	`In™Tax¿‹
();

2076 
	`In™T¿deTy³
();

2077 
	`In™ZCode
();

2078 
	}
}

2085 
	gCG’”©eAndLßd
::
	$In™SÿlšgTabËs
()

2089 
	`In™Add»ss
();

2090 
	`In™Cu¡om”
();

2091 
	`In™Cu¡om”AccouÁAndAccouÁP”missiÚ
();

2092 
	`In™Cu¡om”Tax¿‹
();

2093 
	`In™W©chLi¡AndW©chI‹m
();

2097 
	`In™Com·ny
();

2098 
	`In™Com·nyCom³t™Ü
();

2099 
	`In™DayM¬k‘
();

2100 
	`In™FšªcŸl
();

2101 
	`In™La¡T¿de
();

2102 
	`In™NewsI‹mAndNewsXRef
();

2103 
	`In™Secur™y
();

2104 
	}
}

2111 
	gCG’”©eAndLßd
::
	$In™GrowšgTabËs
()

2113 
	`In™HŞdšgAndT¿de
();

2114 
	}
}

	@src/workload/tpce/egen/EGenLoader.cpp

41 
	~"wÜklßd/û/eg’/EG’Lßd”_¡dafx.h
"

42 
	~"wÜklßd/û/eg’/CETxnIÅutG’”©Ü.h
"

43 
	~"wÜklßd/û/eg’/DM.h
"

44 
	~"wÜklßd/û/MEESUT.h
"

45 
	~"wÜklßd/û/eg’/MEE.h
"

46 
usšg
 
Çme¥aû
 
	gTPCE
;

49 
TId’t
 
	giS¹FromCu¡om”
 = 
iDeçuÉS¹FromCu¡om”
;

50 
TId’t
 
	giCu¡om”CouÁ
 = 
iDeçuÉCu¡om”CouÁ
;

51 
TId’t
 
	giTÙ®Cu¡om”CouÁ
 = 
iDeçuÉCu¡om”CouÁ
;

52 
UINT
 
	giLßdUn™Size
 = 
iDeçuÉLßdUn™Size
;

53 
UINT
 
	giSÿËFaùÜ
 = 500;

54 
UINT
 
	giDaysOfIn™ŸlT¿des
 = 300;

57 
boŞ
 
	gbTabËG’”©iÚFÏgNÙS³cif›d
 = 
Œue
;

58 
boŞ
 
	gbG’”©eFixedTabËs
 = 
çl£
;

59 
boŞ
 
	gbG’”©eGrowšgTabËs
 = 
çl£
;

60 
boŞ
 
	gbG’”©eSÿlšgTabËs
 = 
çl£
;

61 
boŞ
 
	gbG’”©eUsšgCache
 = 
Œue
;

64 
CIÅutFes
* 
	gšputFes
 = 
NULL
;

65 
CBa£Lßd”FaùÜy
* 
	gpLßd”FaùÜy
;

66 
CG’”©eAndLßdSnd¬dOuut
* 
	gOuut
;

68 
CG’”©eAndLßd
* 
	gpG’”©eAndLßd
;

72 
	gszInDœ
[
iMaxP©h
];

73 #ifdeà
COMPILE_FLAT_FILE_LOAD


74 
	gszOutDœ
[
iMaxP©h
];

75 
FÏtFeOuutModes
 
	gFÏtFeOuutMode
;

77 #ifdeà
COMPILE_ODBC_LOAD


78 
	gszS”v”
[
iMaxHo¡Çme
];

79 
	gszDB
[
iMaxDBName
];

81 #ià
defšed
(
COMPILE_ODBC_LOAD
è|| defšed(
COMPILE_CUSTOM_LOAD
)

82 
	gszLßd”P¬ms
[1024];

85 #iâdeà
FLAT_IN_PATH


86 
	#FLAT_IN_PATH
 "æ©_š/"

	)

89 #iâdeà
FLAT_OUT_PATH


90 
	#FLAT_OUT_PATH
 "æ©_out/"

	)

93 
	eeLßdIm¶em’tiÚ
 {

94 
	mNULL_LOAD
 = 0,

95 
	mFLAT_FILE_LOAD
,

96 
	mODBC_LOAD
,

97 
	mCUSTOM_LOAD


99 #ià
defšed
(
DEFAULT_LOAD_TYPE
)

100 
eLßdIm¶em’tiÚ
 
	gLßdTy³
 = 
DEFAULT_LOAD_TYPE
;

101 #–ià
defšed
(
COMPILE_FLAT_FILE_LOAD
)

102 
eLßdIm¶em’tiÚ
 
	gLßdTy³
 = 
FLAT_FILE_LOAD
;

103 #–ià
defšed
(
COMPILE_ODBC_LOAD
)

104 
eLßdIm¶em’tiÚ
 
	gLßdTy³
 = 
ODBC_LOAD
;

105 #–ià
defšed
(
COMPILE_CUSTOM_LOAD
)

106 
eLßdIm¶em’tiÚ
 
	gLßdTy³
 = 
CUSTOM_LOAD
;

108 
eLßdIm¶em’tiÚ
 
	gLßdTy³
 = 
NULL_LOAD
;

114 
	$U§ge
()

116 
	`årštf
Ğ
¡d”r
, "Usage:\n" );

117 
	`årštf
Ğ
¡d”r
, "EGenLoader [options] \n\n" );

118 
	`årštf
Ğ
¡d”r
, " Where\n" );

119 
	`årštf
Ğ
¡d”r
, " Option Default Description\n" );

120 
	`årštf
Ğ
¡d”r
, " -b‚umb” %Îd Begšnšg cu¡om” ordš®…os™iÚ\n", 
iS¹FromCu¡om”
);

121 
	`årštf
Ğ
¡d”r
, " -ønumb” %Îd Numb” oàcu¡om” (fÜhi š¡ªû)\n", 
iCu¡om”CouÁ
 );

122 
	`årštf
Ğ
¡d”r
, " -ˆnumb” %Îd Numb” oàcu¡om” ÑÙ® iÀthd©aba£)\n", 
iTÙ®Cu¡om”CouÁ
 );

123 
	`årštf
Ğ
¡d”r
, " -ànumb” %d SÿË faùÜ (cu¡om” ³¸1psE)\n", 
iSÿËFaùÜ
 );

124 
	`årštf
Ğ
¡d”r
, " -w‚umb” %d Numb” oàWÜkday (8-hou¸daysèoà\n", 
iDaysOfIn™ŸlT¿des
 );

125 
	`årštf
Ğ
¡d”r
, " initialradeso…opulate\n" );

126 
	`årštf
Ğ
¡d”r
, " -˜dœ %-11 DœeùÜy fÜ iÅuˆfes\n", 
FLAT_IN_PATH
 );

127 
	`årštf
Ğ
¡d”r
, " -l [FLAT|ODBC|CUSTOM|NULL] FLAT Type of†oad\n" );

128 #ifdeà
COMPILE_FLAT_FILE_LOAD


129 
	`årštf
Ğ
¡d”r
, " -m [APPEND|OVERWRITE] OVERWRITE Flat File output mode\n" );

130 
	`årštf
Ğ
¡d”r
, " -Ødœ %-11 DœeùÜy fÜ ouuˆfes\n", 
FLAT_OUT_PATH
 );

132 #ifdeà
COMPILE_ODBC_LOAD


133 
	`årštf
Ğ
¡d”r
, " -s string†ocalhost Database server\n" );

134 
	`årštf
Ğ
¡d”r
, " -d stringpce Database‚ame\n" );

136 #ià
	`defšed
(
COMPILE_ODBC_LOAD
è|| defšed(
COMPILE_CUSTOM_LOAD
)

137 
	`årštf
Ğ
¡d”r
, " -p string Additional…arameterso†oader\n" );

139 
	`årštf
Ğ
¡d”r
, "\n" );

140 
	`årštf
Ğ
¡d”r
, " -x -x Generate‡llables\n");

141 
	`årštf
Ğ
¡d”r
, " -xf Generate‡ll fixed-sizeables\n");

142 
	`årštf
Ğ
¡d”r
, " -xd Generate‡ll scaling‡nd growingables\n");

143 
	`årštf
Ğ
¡d”r
, " (equivalento -xs -xg)\n");

144 
	`årštf
Ğ
¡d”r
, " -xs Generate scalingables\n");

145 
	`årštf
Ğ
¡d”r
, " (except BROKER)\n");

146 
	`årštf
Ğ
¡d”r
, " -xg Generate growingables‡nd BROKER\n");

147 
	`årštf
Ğ
¡d”r
, " -g Disable caching when generating growingables\n" );

148 
	}
}

150 
	$P¬£CommªdLše
Ğ
¬gc
, *
¬gs
[] )

152 
¬g
;

153 *
¥
;

154 *
vp
;

156 
¬gv
[20][100];

158  
¬g
 = 1;‡rg < 
¬gc
; ++arg ){

159 
	`mem£t
(
¬gv
[
¬g
], '\0',100);

160 
	`¡rıy
(
¬gv
[
¬g
],
¬gs
[arg]);

166  
¬g
 = 1;‡rg < 
¬gc
; ++arg ) {

171 
¥
 = 
¬gv
[
¬g
];

172 iàĞ*
¥
 == '-' ) {

173 ++
¥
;

175 *
¥
 = ()
	`tŞow”
( *sp );

181 
vp
 = 
¥
 + 1;

186 iàĞ(*
vp
 =ğ0è&& ((
¬g
 + 1è< 
¬gc
è&& (
¬gv
[arg + 1][0] != '-') )

188 
vp
 = 
¬gv
[++
¬g
];

194  *
¥
 ) {

196 
	`ssÿnf
(
vp
, "%Îd ", &
iS¹FromCu¡om”
);

197 ià(
iS¹FromCu¡om”
 <= 0)

201 
iS¹FromCu¡om”
 = 
iDeçuÉS¹FromCu¡om”
;

205 
	`ssÿnf
(
vp
, "%Îd ", &
iCu¡om”CouÁ
);

208 
	`ssÿnf
(
vp
, "%Îd ", &
iTÙ®Cu¡om”CouÁ
);

211 
iSÿËFaùÜ
 = (
UINT
è
	`©oi
Ğ
vp
 );

214 
iDaysOfIn™ŸlT¿des
 = (
UINT
è
	`©oi
Ğ
vp
 );

218 
	`¡ºıy
(
szInDœ
, 
vp
, (szInDir));

219 if(Ğ'/' !ğ
szInDœ
[ 
	`¡¾’
(szInDir) - 1 ] ) && ( '\\' != szInDir[ strlen(szInDir) - 1 ] ))

221 
	`¡ºÿt
Ğ
szInDœ
, "/", (szInDir) );

226 #ifdeà
COMPILE_FLAT_FILE_LOAD


227 ifĞ0 =ğ
	`¡rcmp
Ğ
vp
, "FLAT" ))

229 
LßdTy³
 = 
FLAT_FILE_LOAD
;

233 #ifdeà
COMPILE_ODBC_LOAD


234 ifĞ0 =ğ
	`¡rcmp
Ğ
vp
, "ODBC" ))

236 
LßdTy³
 = 
ODBC_LOAD
;

240 iàĞ0 =ğ
	`¡rcmp
Ğ
vp
, "NULL" ))

242 
LßdTy³
 = 
NULL_LOAD
;

245 #ifdeà
COMPILE_CUSTOM_LOAD


246 iàĞ0 =ğ
	`¡rcmp
Ğ
vp
, "CUSTOM" ))

248 
LßdTy³
 = 
CUSTOM_LOAD
;

252 
	`U§ge
();

253 
	`ex™
Ğ
ERROR_BAD_OPTION
 );

256 #ifdeà
COMPILE_FLAT_FILE_LOAD


258 ifĞ0 =ğ
	`¡rcmp
Ğ
vp
, "APPEND" ))

260 
FÏtFeOuutMode
 = 
FLAT_FILE_OUTPUT_APPEND
;

262 ifĞ0 =ğ
	`¡rcmp
Ğ
vp
, "OVERWRITE" ))

264 
FÏtFeOuutMode
 = 
FLAT_FILE_OUTPUT_OVERWRITE
;

268 
	`U§ge
();

269 
	`ex™
Ğ
ERROR_BAD_OPTION
 );

274 
	`¡ºıy
(
szOutDœ
, 
vp
, (szOutDir));

275 if(Ğ'/' !ğ
szOutDœ
[ 
	`¡¾’
(szOutDir) - 1 ] ) && ( '\\' != szOutDir[ strlen(szOutDir) - 1 ] ))

277 
	`¡ºÿt
Ğ
szOutDœ
, "/", (szOutDir) );

281 #ifdeà
COMPILE_ODBC_LOAD


283 
	`¡ºıy
(
szS”v”
, 
vp
, (szServer));

287 
	`¡ºıy
(
szDB
, 
vp
, (szDB));

290 #ià
	`defšed
(
COMPILE_ODBC_LOAD
è|| defšed(
COMPILE_CUSTOM_LOAD
)

292 
	`¡ºıy
(
szLßd”P¬ms
, 
vp
, (szLoaderParms));

296 
bG’”©eUsšgCache
 = 
çl£
;

299 
bTabËG’”©iÚFÏgNÙS³cif›d
 = 
çl£
;

301 ifĞ
NULL
 =ğ
vp
 || *vp == '\0')

303 
bG’”©eFixedTabËs
 = 
Œue
;

304 
bG’”©eGrowšgTabËs
 = 
Œue
;

305 
bG’”©eSÿlšgTabËs
 = 
Œue
;

307 ifĞ0 =ğ
	`¡rcmp
Ğ
vp
, "f" ))

309 
bG’”©eFixedTabËs
 = 
Œue
;

311 ifĞ0 =ğ
	`¡rcmp
Ğ
vp
, "g" ))

313 
bG’”©eGrowšgTabËs
 = 
Œue
;

315 ifĞ0 =ğ
	`¡rcmp
Ğ
vp
, "s" ))

317 
bG’”©eSÿlšgTabËs
 = 
Œue
;

319 ifĞ0 =ğ
	`¡rcmp
Ğ
vp
, "d" ))

321 
bG’”©eGrowšgTabËs
 = 
Œue
;

322 
bG’”©eSÿlšgTabËs
 = 
Œue
;

326 
	`U§ge
();

327 
	`ex™
Ğ
ERROR_BAD_OPTION
 );

332 
	`U§ge
();

333 
	`årštf
Ğ
¡d”r
, "E¼Ü: UÄecognized o±iÚ: %s\n",
¥
);

334 
	`ex™
Ğ
ERROR_BAD_OPTION
 );

338 
	}
}

354 
boŞ
 
	$V®id©eP¬am‘”s
()

356 
boŞ
 
bR‘
 = 
Œue
;

360 ià((
iS¹FromCu¡om”
 % 
iLßdUn™Size
) != 1)

362 
cout
 << "Th¥ecif›d s¹šg cu¡om” (-b " << 
iS¹FromCu¡om”


364 << 
iLßdUn™Size
 << "è+ 1." << 
’dl
;

366 
bR‘
 = 
çl£
;

372 ià(
iTÙ®Cu¡om”CouÁ
 < 
iS¹FromCu¡om”
 + 
iCu¡om”CouÁ
 - 1)

374 
iTÙ®Cu¡om”CouÁ
 = 
iS¹FromCu¡om”
 + 
iCu¡om”CouÁ
 - 1;

379 ià((
iLßdUn™Size
 > 
iCu¡om”CouÁ
) || (0 != iCustomerCount % iLoadUnitSize))

381 
cout
 << "Th¥ecif›d cu¡om” couÁ (-ø" << 
iCu¡om”CouÁ


383 << 
iLßdUn™Size
 << ")." << 
’dl
;

385 
bR‘
 = 
çl£
;

390 ià((
iLßdUn™Size
 > 
iTÙ®Cu¡om”CouÁ
) || (0 != iTotalCustomerCount % iLoadUnitSize))

392 
cout
 << "ThtÙ® cu¡om” couÁ (-ˆ" << 
iTÙ®Cu¡om”CouÁ


394 << 
iLßdUn™Size
 << ")." << 
’dl
;

396 
bR‘
 = 
çl£
;

402 ià((
INT64
)(
HoursP”WÜkDay
 * 
SecÚdsP”Hour
 * 
iLßdUn™Size
 / 
iSÿËFaùÜ
) % 100 != 0)

404 
cout
 << "Incom·tibË v®ufÜ SÿË FaùÜ (-fè¥ecif›d." << 
’dl
;

405 
cout
 << 
HoursP”WÜkDay
 << " * " << 
SecÚdsP”Hour
 << " * Lßd Un™ Siz(" << 
iLßdUn™Size


406 << "è/ SÿË FaùÜ (" << 
iSÿËFaùÜ


407 << "èmu¡ bš‹g¿ÈmuÉË oà100." << 
’dl
;

409 
bR‘
 = 
çl£
;

412 ià(
iDaysOfIn™ŸlT¿des
 == 0)

414 
cout
 << "The specified‚umber of 8-Hour Workdays (-w "

415 << (
iDaysOfIn™ŸlT¿des
è<< "èmu¡ bnÚ-z”o." << 
’dl
;

417 
bR‘
 = 
çl£
;

420  
bR‘
;

421 
	}
}

427 
CBa£Lßd”FaùÜy
* 
	$C»©eLßd”FaùÜy
(
eLßdIm¶em’tiÚ
 
eLßdTy³
)

429 
eLßdTy³
)

431 
NULL_LOAD
:

432  
Ãw
 
	`CNuÎLßd”FaùÜy
();

434 #ifdeà
COMPILE_ODBC_LOAD


435 
ODBC_LOAD
:

436  
Ãw
 
	`CODBCLßd”FaùÜy
(
szS”v”
, 
szDB
, 
szLßd”P¬ms
);

439 #ifdeà
COMPILE_FLAT_FILE_LOAD


440 
FLAT_FILE_LOAD
:

441  
Ãw
 
	`CFÏtLßd”FaùÜy
(
szOutDœ
, 
FÏtFeOuutMode
);

444 #ifdeà
COMPILE_CUSTOM_LOAD


445 
CUSTOM_LOAD
:

446  
Ãw
 
	`CCu¡omLßd”FaùÜy
(
szLßd”P¬ms
);

450 
	`as£¹
(
çl£
);

453  
NULL
;

454 
	}
}

456 
	$eg’_š™
(
¬gc
, * 
¬gv
[])

458 
šputFes
 = 
Ãw
 
	`CIÅutFes
();

459 
Ouut
 = 
Ãw
 
	`CG’”©eAndLßdSnd¬dOuut
();

465 #ifdeà
COMPILE_ODBC_LOAD


466 
	`¡ºıy
(
szS”v”
, "localhost", (szServer));

467 
	`¡ºıy
(
szDB
, "tpce", (szDB));

469 
	`¡ºıy
(
szInDœ
, 
FLAT_IN_PATH
, (szInDir));

470 #ifdeà
COMPILE_FLAT_FILE_LOAD


471 
	`¡ºıy
(
szOutDœ
, 
FLAT_OUT_PATH
, (szOutDir));

472 
FÏtFeOuutMode
 = 
FLAT_FILE_OUTPUT_OVERWRITE
;

477 
	`P¬£CommªdLše
(
¬gc
, 
¬gv
);

482 ià(!
	`V®id©eP¬am‘”s
())

484  
ERROR_INVALID_OPTION_VALUE
;

488 
cout
<<
’dl
<<endl<<"Usinghe following settings."<<endl<<endl;

489  
LßdTy³
 ) {

490 #ifdeà
COMPILE_ODBC_LOAD


491 
ODBC_LOAD
:

492 
cout
<<"\tLßd Ty³:\t\tODBC"<<
’dl
;

493 
cout
<<"\tS”v” Name:\t\t"<<
szS”v”
<<
’dl
;

494 
cout
<<"\tD©aba£:\t\t"<<
szDB
<<
’dl
;

497 #ifdeà
COMPILE_FLAT_FILE_LOAD


498 
FLAT_FILE_LOAD
:

499 
cout
<<"\tLßd Ty³:\t\tFÏˆFe"<<
’dl
;

500  
FÏtFeOuutMode
 ) {

501 
FLAT_FILE_OUTPUT_APPEND
:

502 
cout
<<"\tOuuˆMode:\t\tAPPEND"<<
’dl
;

504 
FLAT_FILE_OUTPUT_OVERWRITE
:

505 
cout
<<"\tOuuˆMode:\t\tOVERWRITE"<<
’dl
;

508 
cout
<<"\tOuˆDœeùÜy:\t\t"<<
szOutDœ
<<
’dl
;

511 #ifdeà
COMPILE_CUSTOM_LOAD


512 
CUSTOM_LOAD
:

513 
cout
<<"\tLßd Ty³:\t\tCu¡om"<<
’dl
;

514 
cout
<<"\tLßd” P¬ms:\t\t"<<
szLßd”P¬ms
<<
’dl
;

517 
NULL_LOAD
:

521 
cout
<<"\tIÀDœeùÜy:\t\t"<<
szInDœ
<<
’dl
;

522 
cout
<<"\tS¹ From Cu¡om”:\t"<<
iS¹FromCu¡om”
<<
’dl
;

523 
cout
<<"\tCu¡om” CouÁ:\t\t"<<
iCu¡om”CouÁ
<<
’dl
;

524 
cout
<<"\tTÙ® cu¡om”s:\t"<<
iTÙ®Cu¡om”CouÁ
<<
’dl
;

525 
cout
<<"\tLßd Un™:\t\t"<<
iLßdUn™Size
<<
’dl
;

526 
cout
<<"\tSÿË FaùÜ:\t\t"<<
iSÿËFaùÜ
<<
’dl
;

527 
cout
<<"\tIn™ŸÈT¿dDays:\t"<<
iDaysOfIn™ŸlT¿des
<<
’dl
;

528 
cout
<<"\tCachšg EÇbËd:\t"<<(
bG’”©eUsšgCache
?"Œue":"çl£")<<
’dl
;

529 
cout
<<
’dl
<<endl;

533 
pLßd”FaùÜy
 = 
	`C»©eLßd”FaùÜy
(
LßdTy³
);

535 
Œy
 {

541 
szLogFeName
[64];

543 
	`¢´štf
(&
szLogFeName
[0], (szLogFileName),

545 
iS¹FromCu¡om”
, (iS¹FromCu¡om” + 
iCu¡om”CouÁ
)-1);

549 
CLogFÜm©Tab
 
fmt
;

550 
CEG’Logg”
 
	`logg”
(
eDriv”EG’Lßd”
, 0, 
szLogFeName
, &
fmt
);

553 
šputFes
->
	`In™Ÿlize
(
eDriv”EG’Lßd”
, 
iTÙ®Cu¡om”CouÁ
, iTÙ®Cu¡om”CouÁ, 
szInDœ
);

556 
pG’”©eAndLßd
 = 
Ãw
 
	`CG’”©eAndLßd
(*
šputFes
, 
iCu¡om”CouÁ
, 
iS¹FromCu¡om”
,

557 
iTÙ®Cu¡om”CouÁ
, 
iLßdUn™Size
,

558 
iSÿËFaùÜ
, 
iDaysOfIn™ŸlT¿des
,

559 
pLßd”FaùÜy
, &
logg”
, 
Ouut
, 
szInDœ
,

560 
bG’”©eUsšgCache
);

563 #ifdeà
COMPILE_FLAT_FILE_LOAD


565 if(Ğ
bTabËG’”©iÚFÏgNÙS³cif›d
 && ( 
iS¹FromCu¡om”
 =ğ
iDeçuÉS¹FromCu¡om”
 )è|| 
bG’”©eFixedTabËs
 )

567 
pG’”©eAndLßd
->
	`G’”©eAndLßdFixedTabËs
();

571 ifĞ
bTabËG’”©iÚFÏgNÙS³cif›d
 || 
bG’”©eSÿlšgTabËs
 )

573 
pG’”©eAndLßd
->
	`G’”©eAndLßdSÿlšgTabËs
();

576 ifĞ
bTabËG’”©iÚFÏgNÙS³cif›d
 || 
bG’”©eGrowšgTabËs
 )

578 
pG’”©eAndLßd
->
	`G’”©eAndLßdGrowšgTabËs
();

585 
	`ÿtch
 (
CBa£E¼
& 
”r
)

587 
cout
<<
’dl
<<"E¼Ü "<<
”r
.
	`E¼ÜNum
()<<": "<<”r.
	`E¼ÜText
();

588 ià(
”r
.
	`E¼ÜLoc
()) {

589 
cout
<<"‡ˆ"<<
”r
.
	`E¼ÜLoc
()<<
’dl
;

591 
cout
<<
’dl
;

597 
	`ÿtch
 (
¡d
::
bad_®loc
&)

599 
cout
<<
’dl
<<endl<<"*** Out of memory ***"<<endl;

602 
	`ÿtch
 (
¡d
::
exû±iÚ
& 
”r
)

604 
cout
 << 
’dl
 <<ƒndÈ<<"CaughˆExû±iÚ: " << 
”r
.
	`wh©
() <<ƒndl;

606 
	`ÿtch
 (...)

608 
cout
 << 
’dl
 <<ƒndl <<"Caught Unknown Exception" <<ƒndl;

612 
	}
}

614 
CCETxnIÅutG’”©Ü
* 
	$Œª§ùiÚs_šput_š™
(
cu¡om”s
, 
sf
, 
wdays
)

619 
CLogFÜm©Tab
 * 
fmt
ğ
Ãw
 
	`CLogFÜm©Tab
();

620 
CEG’Logg”
* 
log
 = 
Ãw
 
	`CEG’Logg”
(
eDriv”CE
, 0, "EG’TrxIÅut.log", 
fmt
);

622 
PDriv”CETxnS‘tšgs
 
mDriv”CETxnS‘tšgs
 = 
Ãw
 
	`TDriv”CETxnS‘tšgs
();

623 
INT32
 
sf1
 = 
sf
;

624 
INT32
 
wdays1
 = 
wdays
;

625 
	`as£¹
(
šputFes
!=
NULL
);

626 
CCETxnIÅutG’”©Ü
* 
m_TxnIÅutG’”©Ü
 = 
Ãw
 
	`CCETxnIÅutG’”©Ü
(*
šputFes
,

627 (
TId’t
)
cu¡om”s
, (TId’t)cu¡om”s, 
sf1
,

628 
wdays1
 * 
HoursP”WÜkDay
, 
log
, 
mDriv”CETxnS‘tšgs
);

629  
m_TxnIÅutG’”©Ü
;

630 
	}
}

632 
CDM
* 
	$d©a_maš‹Çnû_š™
(
cu¡om”s
, 
sf
, 
wdays
)

636 
CLogFÜm©Tab
 * 
fmt
ğ
Ãw
 
	`CLogFÜm©Tab
();

637 
CEG’Logg”
* 
log
 = 
Ãw
 
	`CEG’Logg”
(
eDriv”CE
, 0, "EG’DMIÅut.log", 
fmt
);

639 
INT32
 
sf1
 = 
sf
;

640 
INT32
 
wdays1
 = 
wdays
;

642 
CDM
* 
m_CDM
 = 
Ãw
 
	`CDM
 (
NULL
, 
log
, *
šputFes
, (
TId’t
)
cu¡om”s
, (TId’t)cu¡om”s, 
wdays1
, 
sf1
, 1 );

643  
m_CDM
;

644 
	}
}

646 
CMEE
* 
	$m¬k‘_š™
(
INT32
 
T¿dšgTimeSoF¬
, 
CMEESUTIÁ”çû
 *
pSUT
, 
UINT32
 
UniqueId
){

649 
CLogFÜm©Tab
 * 
fmt
ğ
Ãw
 
	`CLogFÜm©Tab
();

650 
CEG’Logg”
* 
log
 = 
Ãw
 
	`CEG’Logg”
(
eDriv”CE
, 0, "M¬k‘IÅut.log", 
fmt
);

652 
CMEE
* 
m“
ğ
Ãw
 
	`CMEE
(
T¿dšgTimeSoF¬
, 
pSUT
, 
log
, *
šputFes
, 
UniqueId
);

653  
m“
;

654 
	}
}

656 
	$eg’_»Ëa£
()

658 
d–‘e
 
pG’”©eAndLßd
;

659 
d–‘e
 
pLßd”FaùÜy
;

660 
d–‘e
 
šputFes
;

661 
d–‘e
 
Ouut
;

662 
	}
}

	@src/workload/tpce/egen/EGenLogFormatterTab.cpp

42 
	~"wÜklßd/û/eg’/EG’LogFÜm©‹rTab.h
"

43 
	~"wÜklßd/û/eg’/Driv”Ty³s.h
"

45 
usšg
 
Çme¥aû
 
	gTPCE
;

47 
¡ršg
 
em±ySŒšg
("");

53 
¡ršg
 
	gCLogFÜm©Tab
::
	$G‘LogOuut
(
CBrok”VŞumeS‘tšgs
& 
·rms
)

57 
·rms
.
	`CheckDeçuÉs
();

60 
logmsg
.
	`¡r
(
em±ySŒšg
);

61 
logmsg
 << "Brok” VŞumP¬am‘”s: NONE" << 
’dl
;

64  (
logmsg
.
	`¡r
());

65 
	}
}

67 
¡ršg
 
	gCLogFÜm©Tab
::
	$G‘LogOuut
(
CCu¡om”Pos™iÚS‘tšgs
& 
·rms
)

70 
·rms
.
	`CheckDeçuÉs
();

73 
logmsg
.
	`¡r
(
em±ySŒšg
);

74 
logmsg
 << "Cu¡om” Pos™iÚ P¬am‘”s:" << 
’dl
;

75 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "P¬am‘”" << "DeçuÉ" << "\t" << "Cu¼’t" << "\t" << "DeçuÉ?" << 
’dl
;

76 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "By Cu¡ ID: " << 
·rms
.
dá
.
by_cu¡_id
 << "\t" <<…¬ms.
cur
.by_cu¡_id << "\t" << (·rms.
¡©e
.by_cu¡_id ? "YES" : "NO"è<< 
’dl
;

77 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "By Tax ID: " << 
·rms
.
dá
.
by_x_id
 << "\t" <<…¬ms.
cur
.by_x_id << "\t" << (·rms.
¡©e
.by_x_id ? "YES" : "NO"è<< 
’dl
;

78 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "G‘ Hi¡Üy: " << 
·rms
.
dá
.
g‘_hi¡Üy
 << "\t" <<…¬ms.
cur
.g‘_hi¡Üy << "\t" << (·rms.
¡©e
.g‘_hi¡Üy ? "YES" : "NO"è<< 
’dl
;

81  (
logmsg
.
	`¡r
());

82 
	}
}

84 
¡ršg
 
	gCLogFÜm©Tab
::
	$G‘LogOuut
(
CM¬k‘W©chS‘tšgs
& 
·rms
)

87 
·rms
.
	`CheckDeçuÉs
();

90 
logmsg
.
	`¡r
(
em±ySŒšg
);

91 
logmsg
 << "M¬k‘ W©ch P¬am‘”s:" << 
’dl
;

92 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "P¬am‘”" << "DeçuÉ" << "\t" << "Cu¼’t" << "\t" << "DeçuÉ?" << 
’dl
;

93 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "By AccouÁ ID: " << 
·rms
.
dá
.
by_acù_id
 << "\t" <<…¬ms.
cur
.by_acù_id << "\t" << (·rms.
¡©e
.by_acù_id ? "YES" : "NO"è<< 
’dl
;

94 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "By Indu¡ry: " << 
·rms
.
dá
.
by_šdu¡ry
 << "\t" <<…¬ms.
cur
.by_šdu¡ry << "\t" << (·rms.
¡©e
.by_šdu¡ry ? "YES" : "NO"è<< 
’dl
;

95 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "By W©ch Li¡: " << 
·rms
.
dá
.
by_w©ch_li¡
 << "\t" <<…¬ms.
cur
.by_w©ch_li¡ << "\t" << (·rms.
¡©e
.by_w©ch_li¡ ? "YES" : "NO"è<< 
’dl
;

98  (
logmsg
.
	`¡r
());

99 
	}
}

101 
¡ršg
 
	gCLogFÜm©Tab
::
	$G‘LogOuut
(
CSecur™yD‘aS‘tšgs
& 
·rms
)

104 
·rms
.
	`CheckDeçuÉs
();

107 
logmsg
.
	`¡r
(
em±ySŒšg
);

108 
logmsg
 << "Secur™y D‘a P¬am‘”s:" << 
’dl
;

109 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "P¬am‘”" << "DeçuÉ" << "\t" << "Cu¼’t" << "\t" << "DeçuÉ?" << 
’dl
;

110 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "LOB Acûs Pù: " << 
·rms
.
dá
.
LOBAcûssP”ûÁage
 << "\t" <<…¬ms.
cur
.LOBAcûssP”ûÁag<< "\t" << (·rms.
¡©e
.LOBAcûssP”ûÁag? "YES" : "NO"è<< 
’dl
;

113  (
logmsg
.
	`¡r
());

114 
	}
}

116 
¡ršg
 
	gCLogFÜm©Tab
::
	$G‘LogOuut
(
CT¿deLookupS‘tšgs
& 
·rms
)

119 
·rms
.
	`CheckDeçuÉs
();

122 
logmsg
.
	`¡r
(
em±ySŒšg
);

123 
logmsg
 << "T¿dLooku°P¬am‘”s:" << 
’dl
;

124 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "P¬am‘”" << "DeçuÉ" << "\t" << "Cu¼’t" << "\t" << "DeçuÉ?" << 
’dl
;

125 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "F¿m1 Pù:" << 
·rms
.
dá
.
do_äame1
 << "\t" <<…¬ms.
cur
.do_äame1 << "\t" << (·rms.
¡©e
.do_äame1 ? "YES" : "NO"è<< 
’dl
;

126 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "F¿m2 Pù:" << 
·rms
.
dá
.
do_äame2
 << "\t" <<…¬ms.
cur
.do_äame2 << "\t" << (·rms.
¡©e
.do_äame2 ? "YES" : "NO"è<< 
’dl
;

127 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "F¿m3 Pù:" << 
·rms
.
dá
.
do_äame3
 << "\t" <<…¬ms.
cur
.do_äame3 << "\t" << (·rms.
¡©e
.do_äame3 ? "YES" : "NO"è<< 
’dl
;

128 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "F¿m4 Pù:" << 
·rms
.
dá
.
do_äame4
 << "\t" <<…¬ms.
cur
.do_äame4 << "\t" << (·rms.
¡©e
.do_äame4 ? "YES" : "NO"è<< 
’dl
;

129 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "F¿m1 MaxRows:" << 
·rms
.
dá
.
MaxRowsF¿me1
 << "\t" <<…¬ms.
cur
.MaxRowsF¿me1 << "\t" << (·rms.
¡©e
.MaxRowsF¿me1 ? "YES" : "NO"è<< 
’dl
;

130 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "F¿m2 MaxRows:" << 
·rms
.
dá
.
MaxRowsF¿me2
 << "\t" <<…¬ms.
cur
.MaxRowsF¿me2 << "\t" << (·rms.
¡©e
.MaxRowsF¿me2 ? "YES" : "NO"è<< 
’dl
;

131 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "F¿m3 MaxRows:" << 
·rms
.
dá
.
MaxRowsF¿me3
 << "\t" <<…¬ms.
cur
.MaxRowsF¿me3 << "\t" << (·rms.
¡©e
.MaxRowsF¿me3 ? "YES" : "NO"è<< 
’dl
;

132 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "F¿m4 MaxRows:" << 
·rms
.
dá
.
MaxRowsF¿me4
 << "\t" <<…¬ms.
cur
.MaxRowsF¿me4 << "\t" << (·rms.
¡©e
.MaxRowsF¿me4 ? "YES" : "NO"è<< 
’dl
;

133 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "BackOffFromEndTimeF¿me2:" << 
·rms
.
dá
.
BackOffFromEndTimeF¿me2
 << "\t" <<…¬ms.
cur
.BackOffFromEndTimeF¿me2 << "\t" << (·rms.
¡©e
.BackOffFromEndTimeF¿me2 ? "YES" : "NO"è<< 
’dl
;

134 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "BackOffFromEndTimeF¿me3:" << 
·rms
.
dá
.
BackOffFromEndTimeF¿me3
 << "\t" <<…¬ms.
cur
.BackOffFromEndTimeF¿me3 << "\t" << (·rms.
¡©e
.BackOffFromEndTimeF¿me3 ? "YES" : "NO"è<< 
’dl
;

135 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "BackOffFromEndTimeF¿me4:" << 
·rms
.
dá
.
BackOffFromEndTimeF¿me4
 << "\t" <<…¬ms.
cur
.BackOffFromEndTimeF¿me4 << "\t" << (·rms.
¡©e
.BackOffFromEndTimeF¿me4 ? "YES" : "NO"è<< 
’dl
;

138  (
logmsg
.
	`¡r
());

139 
	}
}

141 
¡ršg
 
	gCLogFÜm©Tab
::
	$G‘LogOuut
(
CT¿deOrd”S‘tšgs
& 
·rms
)

144 
·rms
.
	`CheckDeçuÉs
();

147 
logmsg
.
	`¡r
(
em±ySŒšg
);

148 
logmsg
 << "T¿dOrd” P¬am‘”s:" << 
’dl
;

149 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "P¬am‘”" << "DeçuÉ" << "\t" << "Cu¼’t" << "\t" << "DeçuÉ?" << 
’dl
;

150 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "M¬k‘ T¿dPù:" << 
·rms
.
dá
.
m¬k‘
 << "\t" <<…¬ms.
cur
.m¬k‘ << "\t" << (·rms.
¡©e
.m¬k‘ ? "YES" : "NO"è<< 
’dl
;

151 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "Lim™ T¿dPù:" << 
·rms
.
dá
.
lim™
 << "\t" <<…¬ms.
cur
.lim™ << "\t" << (·rms.
¡©e
.lim™ ? "YES" : "NO"è<< 
’dl
;

152 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "Stİ Los Pù:" << 
·rms
.
dá
.
¡İ_loss
 << "\t" <<…¬ms.
cur
.¡İ_los << "\t" << (·rms.
¡©e
.¡İ_los ? "YES" : "NO"è<< 
’dl
;

153 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "Secur™y by NamPù:" << 
·rms
.
dá
.
£cur™y_by_Çme
 << "\t" <<…¬ms.
cur
.£cur™y_by_Çm<< "\t" << (·rms.
¡©e
.£cur™y_by_Çm? "YES" : "NO"è<< 
’dl
;

154 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "Secur™y by SymbŞ Pù:" << 
·rms
.
dá
.
£cur™y_by_symbŞ
 << "\t" <<…¬ms.
cur
.£cur™y_by_symbŞ << "\t" << (·rms.
¡©e
.£cur™y_by_symbŞ ? "YES" : "NO"è<< 
’dl
;

155 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "Buy Ord” Pù:" << 
·rms
.
dá
.
buy_Üd”s
 << "\t" <<…¬ms.
cur
.buy_Üd” << "\t" << (·rms.
¡©e
.buy_Üd” ? "YES" : "NO"è<< 
’dl
;

156 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "S–ÈOrd” Pù:" << 
·rms
.
dá
.
£Î_Üd”s
 << "\t" <<…¬ms.
cur
.£Î_Üd” << "\t" << (·rms.
¡©e
.£Î_Üd” ? "YES" : "NO"è<< 
’dl
;

157 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "LIFO Pù:" << 
·rms
.
dá
.
lifo
 << "\t" <<…¬ms.
cur
.lifØ<< "\t" << (·rms.
¡©e
.lifØ? "YES" : "NO"è<< 
’dl
;

158 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "M¬gš T¿dPù:" << 
·rms
.
dá
.
ty³_is_m¬gš
 << "\t" <<…¬ms.
cur
.ty³_is_m¬gš << "\t" << (·rms.
¡©e
.ty³_is_m¬gš ? "YES" : "NO"è<< 
’dl
;

159 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "ExecutÜ‡ OwÃ¸Pù:" << 
·rms
.
dá
.
exec_is_owÃr
 << "\t" <<…¬ms.
cur
.exec_is_owÃ¸<< "\t" << (·rms.
¡©e
.exec_is_owÃ¸? "YES" : "NO"è<< 
’dl
;

160 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "RŞlback Pù:" << 
·rms
.
dá
.
rŞlback
 << "\t" <<…¬ms.
cur
.rŞlback << "\t" << (·rms.
¡©e
.rŞlback ? "YES" : "NO"è<< 
’dl
;

163  (
logmsg
.
	`¡r
());

164 
	}
}

166 
¡ršg
 
	gCLogFÜm©Tab
::
	$G‘LogOuut
(
CT¿deUpd©eS‘tšgs
& 
·rms
)

169 
·rms
.
	`CheckDeçuÉs
();

172 
logmsg
.
	`¡r
(
em±ySŒšg
);

173 
logmsg
 << "T¿dUpd©P¬am‘”s:" << 
’dl
;

174 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "P¬am‘”" << "DeçuÉ" << "\t" << "Cu¼’t" << "\t" << "DeçuÉ?" << 
’dl
;

175 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "F¿m1 Pù:" << 
·rms
.
dá
.
do_äame1
 << "\t" <<…¬ms.
cur
.do_äame1 << "\t" << (·rms.
¡©e
.do_äame1 ? "YES" : "NO"è<< 
’dl
;

176 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "F¿m2 Pù:" << 
·rms
.
dá
.
do_äame2
 << "\t" <<…¬ms.
cur
.do_äame2 << "\t" << (·rms.
¡©e
.do_äame2 ? "YES" : "NO"è<< 
’dl
;

177 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "F¿m3 Pù:" << 
·rms
.
dá
.
do_äame3
 << "\t" <<…¬ms.
cur
.do_äame3 << "\t" << (·rms.
¡©e
.do_äame3 ? "YES" : "NO"è<< 
’dl
;

178 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "F¿m1 MaxRows:" << 
·rms
.
dá
.
MaxRowsF¿me1
 << "\t" <<…¬ms.
cur
.MaxRowsF¿me1 << "\t" << (·rms.
¡©e
.MaxRowsF¿me1 ? "YES" : "NO"è<< 
’dl
;

179 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "F¿m2 MaxRows:" << 
·rms
.
dá
.
MaxRowsF¿me2
 << "\t" <<…¬ms.
cur
.MaxRowsF¿me2 << "\t" << (·rms.
¡©e
.MaxRowsF¿me2 ? "YES" : "NO"è<< 
’dl
;

180 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "F¿m3 MaxRows:" << 
·rms
.
dá
.
MaxRowsF¿me3
 << "\t" <<…¬ms.
cur
.MaxRowsF¿me3 << "\t" << (·rms.
¡©e
.MaxRowsF¿me3 ? "YES" : "NO"è<< 
’dl
;

181 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "F¿m1 MaxRowsToUpd©e:" << 
·rms
.
dá
.
MaxRowsToUpd©eF¿me1
 << "\t" <<…¬ms.
cur
.MaxRowsToUpd©eF¿me1 << "\t" << (·rms.
¡©e
.MaxRowsToUpd©eF¿me1 ? "YES" : "NO"è<< 
’dl
;

182 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "F¿m2 MaxRowsToUpd©e:" << 
·rms
.
dá
.
MaxRowsToUpd©eF¿me2
 << "\t" <<…¬ms.
cur
.MaxRowsToUpd©eF¿me2 << "\t" << (·rms.
¡©e
.MaxRowsToUpd©eF¿me2 ? "YES" : "NO"è<< 
’dl
;

183 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "F¿m3 MaxRowsToUpd©e:" << 
·rms
.
dá
.
MaxRowsToUpd©eF¿me3
 << "\t" <<…¬ms.
cur
.MaxRowsToUpd©eF¿me3 << "\t" << (·rms.
¡©e
.MaxRowsToUpd©eF¿me3 ? "YES" : "NO"è<< 
’dl
;

184 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "BackOffFromEndTimeF¿me2:" << 
·rms
.
dá
.
BackOffFromEndTimeF¿me2
 << "\t" <<…¬ms.
cur
.BackOffFromEndTimeF¿me2 << "\t" << (·rms.
¡©e
.BackOffFromEndTimeF¿me2 ? "YES" : "NO"è<< 
’dl
;

185 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "BackOffFromEndTimeF¿me3:" << 
·rms
.
dá
.
BackOffFromEndTimeF¿me3
 << "\t" <<…¬ms.
cur
.BackOffFromEndTimeF¿me3 << "\t" << (·rms.
¡©e
.BackOffFromEndTimeF¿me3 ? "YES" : "NO"è<< 
’dl
;

188  (
logmsg
.
	`¡r
());

189 
	}
}

195 
¡ršg
 
	gCLogFÜm©Tab
::
	$G‘LogOuut
(
CTxnMixG’”©ÜS‘tšgs
& 
·rms
)

198 
·rms
.
	`CheckDeçuÉs
();

201 
logmsg
.
	`¡r
(
em±ySŒšg
);

202 
logmsg
 << "T¿n§ùiÚ Mixes:" << 
’dl
;

203 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "P¬am‘”" << "DeçuÉ" << "\t" << "Cu¼’t" << "\t" << "DeçuÉ?" << 
’dl
;

204 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "Brok” VŞume: " << 
·rms
.
dá
.
Brok”VŞumeMixLev–
 << "\t" <<…¬ms.
cur
.Brok”VŞumeMixLev– << "\t" << (·rms.
¡©e
.Brok”VŞumeMixLev– ? "YES" : "NO"è<< 
’dl
;

205 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "Cu¡om” Pos™iÚ: " << 
·rms
.
dá
.
Cu¡om”Pos™iÚMixLev–
 << "\t" <<…¬ms.
cur
.Cu¡om”Pos™iÚMixLev– << "\t" << (·rms.
¡©e
.Cu¡om”Pos™iÚMixLev– ? "YES" : "NO"è<< 
’dl
;

206 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "M¬k‘ W©ch: " << 
·rms
.
dá
.
M¬k‘W©chMixLev–
 << "\t" <<…¬ms.
cur
.M¬k‘W©chMixLev– << "\t" << (·rms.
¡©e
.M¬k‘W©chMixLev– ? "YES" : "NO"è<< 
’dl
;

207 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "Secur™y D‘a: " << 
·rms
.
dá
.
Secur™yD‘aMixLev–
 << "\t" <<…¬ms.
cur
.Secur™yD‘aMixLev– << "\t" << (·rms.
¡©e
.Secur™yD‘aMixLev– ? "YES" : "NO"è<< 
’dl
;

208 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "T¿dLookup: " << 
·rms
.
dá
.
T¿deLookupMixLev–
 << "\t" <<…¬ms.
cur
.T¿deLookupMixLev– << "\t" << (·rms.
¡©e
.T¿deLookupMixLev– ? "YES" : "NO"è<< 
’dl
;

209 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "T¿dOrd”: " << 
·rms
.
dá
.
T¿deOrd”MixLev–
 << "\t" <<…¬ms.
cur
.T¿deOrd”MixLev– << "\t" << (·rms.
¡©e
.T¿deOrd”MixLev– ? "YES" : "NO"è<< 
’dl
;

210 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "T¿dStus: " << 
·rms
.
dá
.
T¿deStusMixLev–
 << "\t" <<…¬ms.
cur
.T¿deStusMixLev– << "\t" << (·rms.
¡©e
.T¿deStusMixLev– ? "YES" : "NO"è<< 
’dl
;

211 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "T¿dUpd©e: " << 
·rms
.
dá
.
T¿deUpd©eMixLev–
 << "\t" <<…¬ms.
cur
.T¿deUpd©eMixLev– << "\t" << (·rms.
¡©e
.T¿deUpd©eMixLev– ? "YES" : "NO"è<< 
’dl
;

214  (
logmsg
.
	`¡r
());

215 
	}
}

221 
¡ršg
 
	gCLogFÜm©Tab
::
	$G‘LogOuut
(
CLßd”S‘tšgs
& 
·rms
)

224 
·rms
.
	`CheckDeçuÉs
();

227 
logmsg
.
	`¡r
(
em±ySŒšg
);

228 
logmsg
 << "Lßd” S‘tšgs:" << 
’dl
;

229 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "P¬am‘”" << "DeçuÉ" << "\t" << "Cu¼’t" << "\t" << "DeçuÉ?" << 
’dl
;

230 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "CÚfigu»d Cu¡om”s:" << 
·rms
.
dá
.
iCÚfigu»dCu¡om”CouÁ
 << "\t" <<…¬ms.
cur
.iCÚfigu»dCu¡om”CouÁ << 
’dl
;

231 ià(
·rms
.
cur
.
iCÚfigu»dCu¡om”CouÁ
 !ğ·rms.cur.
iAùiveCu¡om”CouÁ
)

233 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "AùivCu¡om”s:" << 
·rms
.
dá
.
iAùiveCu¡om”CouÁ
 << "\t" <<…¬ms.
cur
.iAùiveCu¡om”CouÁ << 
’dl
;

235 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "S¹šg Cu¡om”:" << 
·rms
.
dá
.
iS¹šgCu¡om”
 << "\t" <<…¬ms.
cur
.iS¹šgCu¡om” << 
’dl
;

236 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "Cu¡om” CouÁ:" << 
·rms
.
dá
.
iCu¡om”CouÁ
 << "\t" <<…¬ms.
cur
.iCu¡om”CouÁ << 
’dl
;

237 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "SÿË FaùÜ:" << 
·rms
.
dá
.
iSÿËFaùÜ
 << "\t" <<…¬ms.
cur
.iSÿËFaùÜ << "\t" << (·rms.
¡©e
.iSÿËFaùÜ ? "YES" : "NO"è<< 
’dl
;

238 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "Day oàIn™ŸÈT¿des:" << 
·rms
.
dá
.
iDaysOfIn™ŸlT¿des
 << "\t" <<…¬ms.
cur
.iDaysOfIn™ŸlT¿de << "\t" << (·rms.
¡©e
.iDaysOfIn™ŸlT¿de ? "YES" : "NO"è<< 
’dl
;

240  (
logmsg
.
	`¡r
());

241 
	}
}

247 
¡ršg
 
	gCLogFÜm©Tab
::
	$G‘LogOuut
(
CDriv”Glob®S‘tšgs
& 
·rms
)

250 
·rms
.
	`CheckDeçuÉs
();

253 
logmsg
.
	`¡r
(
em±ySŒšg
);

254 
logmsg
 << "Driv” Glob® S‘tšgs:" << 
’dl
;

255 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "P¬am‘”" << "DeçuÉ" << "\t" << "Cu¼’t" << "\t" << "DeçuÉ?" << 
’dl
;

256 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "CÚfigu»d Cu¡om”s:" << 
·rms
.
dá
.
iCÚfigu»dCu¡om”CouÁ
 << "\t" <<…¬ms.
cur
.iCÚfigu»dCu¡om”CouÁ << 
’dl
;

257 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "AùivCu¡om”s:" << 
·rms
.
dá
.
iAùiveCu¡om”CouÁ
 << "\t" <<…¬ms.
cur
.iAùiveCu¡om”CouÁ << 
’dl
;

258 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "SÿË FaùÜ:" << 
·rms
.
dá
.
iSÿËFaùÜ
 << "\t" <<…¬ms.
cur
.iSÿËFaùÜ << "\t" << (·rms.
¡©e
.iSÿËFaùÜ ? "YES" : "NO"è<< 
’dl
;

259 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "Day oàIn™ŸÈT¿des:" << 
·rms
.
dá
.
iDaysOfIn™ŸlT¿des
 << "\t" <<…¬ms.
cur
.iDaysOfIn™ŸlT¿de << "\t" << (·rms.
¡©e
.iDaysOfIn™ŸlT¿de ? "YES" : "NO"è<< 
’dl
;

261  (
logmsg
.
	`¡r
());

262 
	}
}

264 
¡ršg
 
	gCLogFÜm©Tab
::
	$G‘LogOuut
(
CDriv”CES‘tšgs
& 
·rms
)

267 
logmsg
.
	`¡r
(
em±ySŒšg
);

268 
logmsg
 << "Driv” CE S‘tšgs:" << 
’dl
;

269 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "P¬am‘”" << "V®ue" << 
’dl
;

270 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "UniquID:" << 
·rms
.
cur
.
UniqueId
 << 
’dl
;

271 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "TxÀMix RNGS“d:" << 
·rms
.
cur
.
TxnMixRNGS“d
 << 
’dl
;

272 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "TxÀIÅuˆRNGS“d:" << 
·rms
.
cur
.
TxnIÅutRNGS“d
 << 
’dl
;

275  (
logmsg
.
	`¡r
());

276 
	}
}

278 
¡ršg
 
	gCLogFÜm©Tab
::
	$G‘LogOuut
(
CDriv”CEP¬t™iÚS‘tšgs
& 
·rms
)

281 
·rms
.
	`CheckDeçuÉs
();

284 
logmsg
.
	`¡r
(
em±ySŒšg
);

285 
logmsg
 << "Driv” CE P¬t™iÚ S‘tšgs:" << 
’dl
;

286 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "P¬am‘”" << "DeçuÉ" << "\t" << "Cu¼’t" << "\t" << "DeçuÉ?" << 
’dl
;

287 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "P¬t™iÚ S¹šg Cu¡om” ID:" << 
·rms
.
dá
.
iMyS¹šgCu¡om”Id
 << "\t" <<…¬ms.
cur
.iMyS¹šgCu¡om”Id << 
’dl
;

288 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "P¬t™iÚ Cu¡om” CouÁ:" << 
·rms
.
dá
.
iMyCu¡om”CouÁ
 << "\t" <<…¬ms.
cur
.iMyCu¡om”CouÁ << 
’dl
;

289 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "P¬t™iÚ P”ûÁ:" << 
·rms
.
dá
.
iP¬t™iÚP”ûÁ
 << "\t" <<…¬ms.
cur
.iP¬t™iÚP”ûÁ << "\t" << (·rms.
¡©e
.iP¬t™iÚP”ûÁ ? "YES" : "NO"è<< 
’dl
;

292  (
logmsg
.
	`¡r
());

293 
	}
}

295 
¡ršg
 
	gCLogFÜm©Tab
::
	$G‘LogOuut
(
CDriv”MEES‘tšgs
& 
·rms
)

298 
logmsg
.
	`¡r
(
em±ySŒšg
);

299 
logmsg
 << "Driv” MEE S‘tšgs:" << 
’dl
;

300 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "P¬am‘”" << "V®ue" << 
’dl
;

301 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "UniquID:" << 
·rms
.
cur
.
UniqueId
 << 
’dl
;

302 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "Tick” T­RNGS“d:" << 
·rms
.
cur
.
Tick”T­eRNGS“d
 << 
’dl
;

303 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "T¿dšg FloÜ RNGS“d:" << 
·rms
.
cur
.
T¿dšgFloÜRNGS“d
 << 
’dl
;

306  (
logmsg
.
	`¡r
());

307 
	}
}

309 
¡ršg
 
	gCLogFÜm©Tab
::
	$G‘LogOuut
(
CDriv”DMS‘tšgs
& 
·rms
)

312 
logmsg
.
	`¡r
(
em±ySŒšg
);

313 
logmsg
 << "Driv” DM S‘tšgs:" << 
’dl
;

314 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "P¬am‘”" << "V®ue" << 
’dl
;

315 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "UniquID:" << 
·rms
.
cur
.
UniqueId
 << 
’dl
;

316 
logmsg
 << 
Ëá
 << 
	`£tw
(40è<< "RNGS“d:" << 
·rms
.
cur
.
RNGS“d
 << 
’dl
;

319  (
logmsg
.
	`¡r
());

320 
	}
}

	@src/workload/tpce/egen/EGenValidate.cpp

52 
	~"wÜklßd/û/eg’/th»adšg.h
"

53 
	~<io¡»am
>

54 
	~<¡dexû±
>

55 
	~<s¡»am
>

56 
	~<cm©h
>

57 
	~<c¡dlib
>

60 
	~"wÜklßd/û/eg’/EG’Lßd”_¡dafx.h
"

61 
	~"wÜklßd/û/eg’/D©eTime.h
"

62 
	~"wÜklßd/û/eg’/´og»ssm‘”.h
"

63 
	~"wÜklßd/û/eg’/buck‘simuÏtÜ.h
"

64 
	~"wÜklßd/û/eg’/¡rut.h
"

66 
usšg
 
	gTPCE
::
¡¹ošt64
;

67 
usšg
 
	gTPCE
::
¡¹odbl
;

68 
usšg
 
	gTPCE
::
time¡¹ošt64
;

69 
usšg
 
	gTPCE
::
št64tÙime¡r
;

71 
usšg
 
	gTPCE
::
CCu¡om”S–eùiÚ
;

72 
usšg
 
	gTPCE
::
CRªdom
;

73 
usšg
 
	gTPCE
::
RNGSEED
;

74 
usšg
 
	gTPCE
::
iDeçuÉLßdUn™Size
;

75 
usšg
 
	gTPCE
::
eCu¡om”T›r
;

77 
usšg
 
	g¡d
::
cout
;

78 
usšg
 
	g¡d
::
’dl
;

81 şas 
	cBuck‘SimO±iÚs
 {

82 
	mpublic
:

83 
v”bo£
;

84 
	mh–¶ev–
;

85 
RNGSEED
 
	mba£_£ed
;

86 
TId’t
 
	mcu¡_couÁ
;

87 
	m£
;

88 
boŞ
 
	mu£_¡ddev
;

89 
	m¡ddev
;

90 
INT64
 
	mrun_Ëngth
;

91 
UINT
 
	msim_couÁ
;

92 
UINT
 
	msim_fœ¡
;

93 
UINT
 
	mnum_th»ads
;

94 
UINT
 
	mš‹rv®_time
;

97 
INT64
 
	$ÿlc_simÜd”s
() {

98  
¡©ic_ÿ¡
<
INT64
>(
£
 * stic_ÿ¡<>(
run_Ëngth
));

101 
	$Buck‘SimO±iÚs
()

102 : 
	`v”bo£
 ( 0 )

103 , 
	`h–¶ev–
 ( 0 )

104 , 
	`ba£_£ed
 ( 
TPCE
::
RNGS“dBa£TxnIÅutG’”©Ü
 )

105 , 
	`cu¡_couÁ
 ( 0 )

106 , 
	`£
 ( 10 )

107 , 
	`u£_¡ddev
 ( 
çl£
 )

108 , 
	`¡ddev
 ( 0 )

109 , 
	`run_Ëngth
 ( 7200 )

110 , 
	`sim_couÁ
 ( 10000 )

111 , 
	`sim_fœ¡
 ( 0 )

112 , 
	`num_th»ads
 ( 1 )

113 , 
	$š‹rv®_time
 ( 10 )

115 
	}
}

119 
	$u§ge
(cÚ¡ *
´ogÇme
, 
Buck‘SimO±iÚs
& 
İtiÚs
,

120 
boŞ
 
u§ge_”rÜ
=
Œue
) {

121 
cout
 << "U§ge: " << 
´ogÇme
 << " [İtiÚs] stddev cu¡couÁ [TPS-E] [ruÁime]" << 
’dl


122 << " -h Thi h–°mes§g(-hh fÜ mÜİtiÚs)" << 
’dl


123 << " -v Inü—£ v”bos™y" << 
’dl


124 << " -ønum Numb” oàcu¡om” tØsimuÏ‹ (" << 
İtiÚs
.
cu¡_couÁ
 << ")" << 
’dl


125 << " -¸ruÁim RuÁimtØsimuÏ‹ (" << 
İtiÚs
.
run_Ëngth
 << ")" << 
’dl


126 << " -sEpsEØsimuÏ‹ (" << 
İtiÚs
.
£
 << ")" << 
’dl


127 << " - ¡ddev Snd¬d DevŸtiÚØcheck‡gaš¡ (nÚe)" << 
’dl


128 << " -ˆth»ad  Numb” oàth»ad tØu£ (" << 
İtiÚs
.
num_th»ads
 << ")" << 
’dl


130 ià(
İtiÚs
.
h–¶ev–
 > 1) {

131 
cout
 << " -S s“d Ba£ S“d fÜ„ªdom‚umb” g’”©iÚ (" << 
İtiÚs
.
ba£_£ed
 << ")" << 
’dl


132 << " -Ànum Numb” oàsimuÏtiÚ tØ³rfÜm (" << 
İtiÚs
.
sim_couÁ
 << ")" << 
’dl


133 << " -˜num In™ŸÈsimuÏtiÚ‚umb”Ø¡¬ˆw™h (" << 
İtiÚs
.
sim_fœ¡
 << ")" << 
’dl


134 << " -u‚um Prog»s »pÜˆš‹rv® (" << 
İtiÚs
.
š‹rv®_time
 << ")" << 
’dl


137 
	`ex™
 (
u§ge_”rÜ
?
ERROR_BAD_OPTION
:0);

138 
	}
}

141 
	$·r£CommªdLše
(
¬gc
, cÚ¡ *
¬gv
[], 
Buck‘SimO±iÚs
& 
İtiÚs
) {

142 
æag
 = '-';

143 
Œy
 {

144 
boŞ
 
£_£t
 = 
çl£
;

145 
İtiÚs
.
£
 = 0;

146 
¬gnum
;

147 
¬gnum
 = 1;‡rgnum < 
¬gc
; ++argnum) {

148 cÚ¡ *
±r
 = 
¬gv
[
¬gnum
];

149 ià(*
±r
++ != '-') {

152 *
±r
) {

153 
æag
 = *
±r
++;

156 
boŞ
 
u£_¬g
 = 
Œue
;

157 
¬g_advªû
 = 0;

158 cÚ¡ *
¬g
 = 
±r
;

161 ià(*
±r
 == '\0') {

162 
¬g_advªû
 = 1;

163 
¬g
 = 
¬gv
[
¬gnum
+1];

164 ià(
¬g
 =ğ
NULL
) {

166 
¬g
 = "";

170 
æag
) {

172 
u£_¬g
 = 
çl£
;

173 
İtiÚs
.
v”bo£
 += 1;

177 
u£_¬g
 = 
çl£
;

178 
İtiÚs
.
h–¶ev–
 += 1;

181 
İtiÚs
.
ba£_£ed
 = (
RNGSEED
)
	`¡¹ošt64
(
¬g
);

184 
İtiÚs
.
cu¡_couÁ
 = 
	`¡¹ošt64
(
¬g
);

187 
İtiÚs
.
sim_couÁ
 = 
¡©ic_ÿ¡
<
UINT
>(
	`¡¹ošt64
(
¬g
));

190 
İtiÚs
.
sim_fœ¡
 = 
¡©ic_ÿ¡
<
UINT
>(
	`¡¹ošt64
(
¬g
));

193 
İtiÚs
.
run_Ëngth
 = 
	`time¡¹ošt64
(
¬g
);

196 
£_£t
 = 
Œue
;

197 
İtiÚs
.
£
 = 
	`¡¹odbl
(
¬g
);

200 
İtiÚs
.
num_th»ads
 = 
¡©ic_ÿ¡
<
UINT
>(
	`¡¹ošt64
(
¬g
));

203 
İtiÚs
.
u£_¡ddev
 = 
Œue
;

204 
İtiÚs
.
¡ddev
 = 
	`¡¹odbl
(
¬g
);

207 
İtiÚs
.
š‹rv®_time
 = 
¡©ic_ÿ¡
<
UINT
>(
	`time¡¹ošt64
(
¬g
));

208 
İtiÚs
.
v”bo£
 += 1;

211 
¡d
::
o¡ršg¡»am
 
¡rm
;

212 
throw
 
¡d
::
	`ruÁime_”rÜ
(¡d::
	`¡ršg
("Unknown option"));

216 ià(
u£_¬g
) {

217 
¬gnum
 +ğ
¬g_advªû
;

225 ià(
¬gnum
 < 
¬gc
) {

226 
İtiÚs
.
u£_¡ddev
 = 
Œue
;

227 
İtiÚs
.
¡ddev
 = 
	`¡¹odbl
(
¬gv
[
¬gnum
++]);

229 ià(
¬gnum
 < 
¬gc
) {

230 
æag
 = 'c';

231 
İtiÚs
.
cu¡_couÁ
 = 
	`¡¹ošt64
(
¬gv
[
¬gnum
++]);

233 ià(
¬gnum
 < 
¬gc
) {

234 
æag
 = 't';

235 
£_£t
 = 
Œue
;

236 
İtiÚs
.
£
 = 
	`¡¹odbl
(
¬gv
[
¬gnum
++]);

238 ià(
¬gnum
 < 
¬gc
) {

239 
æag
 = 'r';

240 
İtiÚs
.
run_Ëngth
 = 
¡©ic_ÿ¡
<
UINT
>(
	`time¡¹ošt64
(
¬gv
[
¬gnum
++]));

242 ià(
¬gnum
 < 
¬gc
) {

243 
cout
 << "ToØmªy commªd†š¬gum’ts!" << 
’dl
;

244 
	`u§ge
(
¬gv
[0], 
İtiÚs
);

247 ià(!
£_£t
) {

248 
İtiÚs
.
£
 = o±iÚs.
cu¡_couÁ
 / 500.0;

253 ià(
İtiÚs
.
h–¶ev–
 || o±iÚs.
cu¡_couÁ
 =ğ0 || !İtiÚs.
u£_¡ddev
) {

254 
	`u§ge
(
¬gv
[0], 
İtiÚs
, 
çl£
);

256 } 
	`ÿtch
 (
¡d
::
exû±iÚ
& 
e
) {

257 
cout
 << "E¼Ü…¬sšg commªd†šİtiÚ '" << 
æag
 << "': " << 
e
.
	`wh©
(è<< 
’dl
;

258 
	`u§ge
(
¬gv
[0], 
İtiÚs
);

259 
	`ex™
 (
ERROR_BAD_OPTION
);

261 
	}
}

264 
	$maš
(
¬gc
, cÚ¡ *
¬gv
[]) {

265 
Œy
 {

266 
TPCE
::
CD©eTime
 
¡¬t_time
;

267 
Buck‘SimO±iÚs
 
İtiÚs
;

268 
¡d
::
veùÜ
<
TPCE
::
Th»ad
<TPCE::
Buck‘SimuÏtÜ
>*> 
th»ads
;

270 
	`·r£CommªdLše
(
¬gc
, 
¬gv
, 
İtiÚs
);

272 
TPCE
::
Buck‘Prog»ss
 
	`´og»ss
(
İtiÚs
.
¡ddev
, o±iÚs.
sim_couÁ
, o±iÚs.
v”bo£
);

273 
´og»ss
.
	`£t_di¥Ïy_š‹rv®
(
İtiÚs
.
š‹rv®_time
);

276 
sim_idx
 = 0;

277 
sims_³r_th»ad
 = 
İtiÚs
.
sim_couÁ
/İtiÚs.
num_th»ads
+1;

279 
sim_idx
 < 
İtiÚs
.
sim_couÁ
) {

281 ià(
sims_³r_th»ad
 > 
İtiÚs
.
sim_couÁ
 - 
sim_idx
) {

282 
sims_³r_th»ad
 = 
İtiÚs
.
sim_couÁ
 - 
sim_idx
;

284 
TPCE
::
Th»ad
<TPCE::
Buck‘SimuÏtÜ
>* 
thr
 =

285 
Ãw
 
TPCE
::
Th»ad
<TPCE::
Buck‘SimuÏtÜ
>(
¡d
::
auto_±r
<TPCE::Buck‘SimuÏtÜ>Òew TPCE::
	`Buck‘SimuÏtÜ
(

286 
İtiÚs
.
sim_fœ¡
+
sim_idx
,

287 
sims_³r_th»ad
,

288 
İtiÚs
.
cu¡_couÁ
,

289 
İtiÚs
.
	`ÿlc_simÜd”s
(),

290 
İtiÚs
.
ba£_£ed
,

291 
´og»ss
)));

293 
thr
->
	`¡¬t
();

294 
th»ads
.
	`push_back
(
thr
);

295 
sim_idx
 +ğ
sims_³r_th»ad
;

299 !
th»ads
.
	`em±y
()) {

300 
TPCE
::
Th»ad
<TPCE::
Buck‘SimuÏtÜ
>* 
thr
 = 
th»ads
.
	`back
();

301 
th»ads
.
	`pİ_back
();

302 
thr
->
	`¡İ
();

303 
d–‘e
 
thr
;

306 
TPCE
::
CD©eTime
 
now
;

307 
cout
 << "Maximum Snd¬d DevŸtiÚ = " << 
´og»ss
.
	`max_¡ddev
(è<< 
’dl
;

308 
cout
 << "Reque¡ed Snd¬d DevŸtiÚ = " << 
İtiÚs
.
¡ddev
 << 
’dl
;

309 
cout
 << "Cu¡om” CouÁ = " << 
İtiÚs
.
cu¡_couÁ
 << 
’dl
;

310 
cout
 << "I‹¿tiÚ CouÁ = " << 
İtiÚs
.
sim_couÁ
 << 
’dl
;

311 
cout
 << "I‹¿tiÚ S¹ = " << 
İtiÚs
.
sim_fœ¡
 << 
’dl
;

312 
cout
 << "I‹¿tiÚ Com¶‘ed = " << 
´og»ss
.
	`cu¼’t
(è<< 
’dl
;

313 
cout
 << "Ba£ S“d = " << 
İtiÚs
.
ba£_£ed
 << 
’dl
;

314 
cout
 << "SimuÏtiÚ Du¿tiÚ = " << 
İtiÚs
.
run_Ëngth
 << 
’dl
;

315 
cout
 << "sE = " << 
İtiÚs
.
£
 << 
’dl
;

316 
cout
 << "Simulation Duration = "

317 << 
	`št64tÙime¡r
(
now
.
	`DiffInMliSecÚds
(
¡¬t_time
)/1000è<< 
’dl
;

318 
cout
 << "SimuÏtiÚ com¶‘ed‡ˆ = " << 
now
.
	`ToSŒ
(11è<< 
’dl
;

319 
cout
 << 
’dl
;

322 ià(
´og»ss
.
	`max_¡ddev
(è< 
İtiÚs
.
¡ddev
) {

323 
cout
 << "Faed!" << 
’dl
;

324 
	`ex™
(4);

326 
cout
 << "Pas£d!" << 
’dl
;

331 } 
	`ÿtch
 (
¡d
::
exû±iÚ
& 
e
) {

332 
cout
 << "Caughˆexû±iÚ: " << 
e
.
	`wh©
(è<< 
’dl
;

333 } 
	`ÿtch
 (...) {

334 
cout
 << "CaughˆunknowÀexû±iÚ" << 
’dl
;

337 
	`ex™
(1);

338 
	}
}

	@src/workload/tpce/egen/EGenVersion.cpp

42 
	~"wÜklßd/û/eg’/EG’Ut™›s_¡dafx.h
"

44 
Çme¥aû
 
	gTPCE


49 
INT32
 
	giEG’MajÜV”siÚ
 = 1;

50 
INT32
 
	giEG’MšÜV”siÚ
 = 11;

51 
INT32
 
	giEG’RevisiÚNumb”
 = 0;

52 
INT32
 
	giEG’B‘aLev–
 = 0;

56 
G‘EG’V”siÚ_C
(
INT32
 &
iMajÜV”siÚ
, INT32 &
iMšÜV”siÚ
, INT32 &
iRevisiÚNumb”
, INT32 &
iB‘aLev–
)

58 
G‘EG’V”siÚ
(
iMajÜV”siÚ
, 
iMšÜV”siÚ
, 
iRevisiÚNumb”
, 
iB‘aLev–
);

61 
G‘EG’V”siÚSŒšg_C
(* 
szOuut
, 
size_t
 
iOuutBufãrL’
)

63 
G‘EG’V”siÚSŒšg
(
szOuut
, 
iOuutBufãrL’
);

66 
PrštEG’V”siÚ_C
()

68 
PrštEG’V”siÚ
();

71 
G‘EG’V”siÚUpd©eTime¡amp_C
(* 
szOuut
, 
size_t
 
iOuutBufãrL’
)

73 
G‘EG’V”siÚUpd©eTime¡amp
(
szOuut
, 
iOuutBufãrL’
);

81 
G‘EG’V”siÚ
(
INT32
 &
iMajÜV”siÚ
, INT32 &
iMšÜV”siÚ
, INT32 &
iRevisiÚNumb”
, INT32 &
iB‘aLev–
)

83 
iMajÜV”siÚ
 = 
iEG’MajÜV”siÚ
;

84 
iMšÜV”siÚ
 = 
iEG’MšÜV”siÚ
;

85 
iRevisiÚNumb”
 = 
iEG’RevisiÚNumb”
;

86 
iB‘aLev–
 = 
iEG’B‘aLev–
;

91 
G‘EG’V”siÚSŒšg
(* 
szOuut
, 
size_t
 
iOuutBufãrL’
)

93 ià(
iEG’B‘aLev–
 == 0)

95 
¢´štf
(
szOuut
, 
iOuutBufãrL’
, "EG’ v%d.%d.%d", 
iEG’MajÜV”siÚ
, 
iEG’MšÜV”siÚ
, 
iEG’RevisiÚNumb”
);

97 
¢´štf
(
szOuut
, 
iOuutBufãrL’
, "EG’ v%d.%d.%d b‘¨%d", 
iEG’MajÜV”siÚ
, 
iEG’MšÜV”siÚ
, 
iEG’RevisiÚNumb”
, 
iEG’B‘aLev–
);

103 
PrštEG’V”siÚ
()

105 
szV”siÚ
[33];

107 
G‘EG’V”siÚSŒšg
(
szV”siÚ
, (szVersion));

109 
´štf
("%s\n", 
szV”siÚ
);

114 
G‘EG’V”siÚUpd©eTime¡amp
(* 
szOuut
, 
size_t
 
iOuutBufãrL’
)

116 
¡ºıy
(
szOuut
, 
__DATE__
" "
__TIME__
, 
iOuutBufãrL’
);

	@src/workload/tpce/egen/FlatFileLoader.cpp

37 
	~"wÜklßd/û/eg’/FÏtFeLßd_¡dafx.h
"

39 
usšg
 
Çme¥aû
 
	gTPCE
;

41 
Çme¥aû
 
	gTPCE


44 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gACCOUNT_PERMISSION_ROW
>;

45 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gADDRESS_ROW
>;

46 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gBROKER_ROW
>;

47 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gCASH_TRANSACTION_ROW
>;

48 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gCHARGE_ROW
>;

49 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gCOMMISSION_RATE_ROW
>;

50 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gCOMPANY_ROW
>;

51 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gCOMPANY_COMPETITOR_ROW
>;

52 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gCUSTOMER_ROW
>;

53 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gCUSTOMER_ACCOUNT_ROW
>;

54 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gCUSTOMER_TAXRATE_ROW
>;

55 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gDAILY_MARKET_ROW
>;

56 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gEXCHANGE_ROW
>;

57 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gFINANCIAL_ROW
>;

58 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gHOLDING_ROW
>;

59 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gHOLDING_HISTORY_ROW
>;

60 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gHOLDING_SUMMARY_ROW
>;

61 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gINDUSTRY_ROW
>;

62 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gLAST_TRADE_ROW
>;

63 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gNEWS_ITEM_ROW
>;

64 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gNEWS_XREF_ROW
>;

65 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gSECTOR_ROW
>;

66 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gSECURITY_ROW
>;

67 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gSETTLEMENT_ROW
>;

68 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gSTATUS_TYPE_ROW
>;

69 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gTAXRATE_ROW
>;

70 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gTRADE_ROW
>;

71 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gTRADE_HISTORY_ROW
>;

72 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gTRADE_REQUEST_ROW
>;

73 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gTRADE_TYPE_ROW
>;

74 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gWATCH_ITEM_ROW
>;

75 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gWATCH_LIST_ROW
>;

76 
‹m¶©e
 
şass
 
	gCFÏtFeLßd”
<
	gZIP_CODE_ROW
>;

	@src/workload/tpce/egen/InputFlatFilesStructure.cpp

42 
	~"wÜklßd/û/eg’/EG’TabËs_¡dafx.h
"

44 
Çme¥aû
 
	gTPCE


50 
boŞ
 
	gCIÅutFes
::
In™Ÿlize
(
eDriv”Ty³
 
eTy³
, 
TId’t
 
iCÚfigu»dCu¡om”CouÁ
, TId’ˆ
iAùiveCu¡om”CouÁ
, cÚ¡ *
szP©hName
)

52 
eOuutV”bos™y
 
	geOuut
 = (
eTy³
 =ğ
eDriv”EG’Lßd”
è? 
eOuutV”bo£
 : 
eOuutQu›t
;

53 
	gszFeName
[
iMaxP©h
];

54 *
	gpS¹InFeName
;

55 
size_t
 
	giDœL’
;

56 
size_t
 
	giFeNameMaxL’
;

65 
¡ºıy
(
szFeName
, 
szP©hName
, 
iMaxP©h
);

66 
	giDœL’
 = 
¡¾’
Ğ
szFeName
 );

67 
	gpS¹InFeName
 = (*)&
szFeName
[
iDœL’
];

68 ià(*
	gpS¹InFeName
 !ğ'/' && *
pS¹InFeName
 != '\\') {

69 
¡ºÿt
(
szFeName
, "/", (szFileName));

70 
	gpS¹InFeName
++;

71 
	giDœL’
++;

73 
	giFeNameMaxL’
 = 
iMaxP©h
 - 
iDœL’
 - 1;

75 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"Lßdšg iÅuˆfes:"<<
’dl
<<’dl<<
æush
; }

76 
CD©eTime
 
	gt1
;

82 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"\tSecurity..."; }

83 
¡ºıy
(
pS¹InFeName
, "Secur™y.txt", 
iFeNameMaxL’
);

84 
	gSecur™›s
 = 
Ãw
 
CSecur™yFe
(
szFeName
, 
iCÚfigu»dCu¡om”CouÁ
, 
iAùiveCu¡om”CouÁ
);

85 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<".............lßded."<<
’dl
<<
æush
; }

87 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"\tStatusType..."; }

88 
¡ºıy
(
pS¹InFeName
, "StusTy³.txt", 
iFeNameMaxL’
);

89 
	gStusTy³
 = 
Ãw
 
TStusTy³Fe
(
szFeName
);

90 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"...........lßded."<<
’dl
<<
æush
; }

96 ià(
	geTy³
 !ğ
eDriv”DM
)

98 ià(
eOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"\tTradeType..."; }

99 
¡ºıy
(
pS¹InFeName
, "T¿deTy³.txt", 
iFeNameMaxL’
);

100 
	gT¿deTy³
 = 
Ãw
 
TT¿deTy³Fe
(
szFeName
);

101 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"............lßded."<<
’dl
<<
æush
; }

108 ià(
	geTy³
 !ğ
eDriv”MEE
)

110 ià(
eOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"\tCompany..."; }

111 
¡ºıy
(
pS¹InFeName
, "Com·ny.txt", 
iFeNameMaxL’
);

112 
	gCom·ny
 = 
Ãw
 
CCom·nyFe
(
szFeName
, 
iCÚfigu»dCu¡om”CouÁ
, 
iAùiveCu¡om”CouÁ
);

113 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"..............lßded."<<
’dl
<<
æush
; }

115 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"\tExchange..."; }

116 
¡ºıy
(
pS¹InFeName
, "Exchªge.txt", 
iFeNameMaxL’
);

117 
	gExchªge
 = 
Ãw
 
TExchªgeFe
(
szFeName
);

118 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<".............lßded."<<
’dl
<<
æush
; }

120 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"\tTaxRatesDivision..."; }

121 
¡ºıy
(
pS¹InFeName
, "TaxR©esDivisiÚ.txt", 
iFeNameMaxL’
);

122 
	gTaxR©esDivisiÚ
 = 
Ãw
 
CIÅutFeNoWeight
<
TTaxR©eIÅutRow
>(
szFeName
);

123 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<".....lßded."<<
’dl
<<
æush
; }

130 ià(
	geTy³
 !ğ
eDriv”MEE
 && 
eTy³
 !ğ
eDriv”DM
)

132 ià(
eOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"\tFemaleFirstName..."; }

133 
¡ºıy
(
pS¹InFeName
, "Fem®eFœ¡Name.txt", 
iFeNameMaxL’
);

134 
	gFem®eFœ¡Names
 = 
Ãw
 
TFem®eFœ¡NamesFe
(
szFeName
);

135 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"......lßded."<<
’dl
<<
æush
; }

137 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"\tIndustry..."; }

138 
¡ºıy
(
pS¹InFeName
, "Indu¡ry.txt", 
iFeNameMaxL’
);

139 
	gIndu¡ry
 = 
Ãw
 
TIndu¡ryFe
(
szFeName
);

140 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<".............lßded."<<
’dl
<<
æush
; }

142 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"\tLastName..."; }

143 
¡ºıy
(
pS¹InFeName
, "La¡Name.txt", 
iFeNameMaxL’
);

144 
	gLa¡Names
 = 
Ãw
 
TLa¡NamesFe
(
szFeName
);

145 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<".............lßded."<<
’dl
<<
æush
; }

147 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"\tMaleFirstName..."; }

148 
¡ºıy
(
pS¹InFeName
, "M®eFœ¡Name.txt", 
iFeNameMaxL’
);

149 
	gM®eFœ¡Names
 = 
Ãw
 
TM®eFœ¡NamesFe
(
szFeName
);

150 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"........lßded."<<
’dl
<<
æush
; }

152 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"\tSector..."; }

153 
¡ºıy
(
pS¹InFeName
, "SeùÜ.txt", 
iFeNameMaxL’
);

154 
	gSeùÜs
 = 
Ãw
 
TSeùÜFe
(
szFeName
);

155 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"...............lßded."<<
’dl
<<
æush
; }

162 ià(
	geTy³
 !ğ
eDriv”MEE
 && 
eTy³
 !ğ
eDriv”DM
 &&ƒTy³ !ğ
eDriv”CE
 &&ƒTy³ !ğ
eDriv”AÎ
)

164 ià(
eOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"\tAreaCode..."; }

165 
¡ºıy
(
pS¹InFeName
, "A»aCode.txt", 
iFeNameMaxL’
);

166 
	gA»aCodes
 = 
Ãw
 
TA»aCodeFe
(
szFeName
);

167 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<".............lßded."<<
’dl
<<
æush
; }

169 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"\tCharge..."; }

170 
¡ºıy
(
pS¹InFeName
, "Ch¬ge.txt", 
iFeNameMaxL’
);

171 
	gCh¬ge
 = 
Ãw
 
TCh¬geFe
(
szFeName
);

172 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"...............lßded."<<
’dl
<<
æush
; }

174 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"\tCommissionRate..."; }

175 
¡ºıy
(
pS¹InFeName
, "CommissiÚR©e.txt", 
iFeNameMaxL’
);

176 
	gCommissiÚR©e
 = 
Ãw
 
TCommissiÚR©eFe
(
szFeName
);

177 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<".......lßded."<<
’dl
<<
æush
; }

179 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"\tCompanyCompetitor.."; }

180 
¡ºıy
(
pS¹InFeName
, "Com·nyCom³t™Ü.txt", 
iFeNameMaxL’
);

181 
	gCom·nyCom³t™Ü
 = 
Ãw
 
CCom·nyCom³t™ÜFe
(
szFeName
, 
iCÚfigu»dCu¡om”CouÁ
, 
iAùiveCu¡om”CouÁ
);

182 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<".....lßded."<<
’dl
<<
æush
; }

184 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"\tCompanySPRate..."; }

185 
¡ºıy
(
pS¹InFeName
, "Com·nySPR©e.txt", 
iFeNameMaxL’
);

186 
	gCom·nySPR©e
 = 
Ãw
 
TCom·nySPR©eFe
(
szFeName
);

187 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"........lßded."<<
’dl
<<
æush
; }

189 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"\tLastName..."; }

190 
¡ºıy
(
pS¹InFeName
, "La¡Name.txt", 
iFeNameMaxL’
);

191 
	gNews
 = 
Ãw
 
TNewsFe
(
szFeName
);

192 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<".............lßded."<<
’dl
<<
æush
; }

194 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"\tStreetName..."; }

195 
¡ºıy
(
pS¹InFeName
, "SŒ“tName.txt", 
iFeNameMaxL’
);

196 
	gSŒ“t
 = 
Ãw
 
TSŒ“tNamesFe
(
szFeName
);

197 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"...........lßded."<<
’dl
<<
æush
; }

199 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"\tStreetSuffix..."; }

200 
¡ºıy
(
pS¹InFeName
, "SŒ“tSuffix.txt", 
iFeNameMaxL’
);

201 
	gSŒ“tSuffix
 = 
Ãw
 
TSŒ“tSuffixFe
(
szFeName
);

202 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<".........lßded."<<
’dl
<<
æush
; }

204 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"\tTaxableAccountName..."; }

205 
¡ºıy
(
pS¹InFeName
, "TaxabËAccouÁName.txt", 
iFeNameMaxL’
);

206 
	gTaxabËAccouÁName
 = 
Ãw
 
TTaxabËAccouÁNameFe
(
szFeName
);

207 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"...lßded."<<
’dl
<<
æush
; }

209 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"\tNonTaxableAccountName..."; }

210 
¡ºıy
(
pS¹InFeName
, "NÚTaxabËAccouÁName.txt", 
iFeNameMaxL’
);

211 
	gNÚTaxabËAccouÁName
 = 
Ãw
 
TNÚTaxabËAccouÁNameFe
(
szFeName
);

212 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"lßded."<<
’dl
<<
æush
; }

214 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"\tTaxRatesCountry..."; }

215 
¡ºıy
(
pS¹InFeName
, "TaxR©esCouÁry.txt", 
iFeNameMaxL’
);

216 
	gTaxR©esCouÁry
 = 
Ãw
 
CIÅutFeNoWeight
<
TTaxR©eIÅutRow
>(
szFeName
);

217 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"......lßded."<<
’dl
<<
æush
; }

219 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"\tZipCode..."; }

220 
¡ºıy
(
pS¹InFeName
, "ZCode.txt", 
iFeNameMaxL’
);

221 
	gZCode
 = 
Ãw
 
TZCodeFe
(
szFeName
);

222 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<"..............lßded."<<
’dl
<<
æush
; }

225 
CD©eTime
 
	gt2
;

226 ià(
	geOuut
 =ğ
eOuutV”bo£
è{ 
cout
<<
’dl
<<"Lßdšg com¶‘("<<
t2
-
t1
<<"sec)."<<endl<<endl; }

228 
	gszFeName
[
iDœL’
] = '\0';

230  
	gŒue
;

	@src/workload/tpce/egen/MEE.cpp

42 
	~"wÜklßd/û/eg’/MEE.h
"

44 
usšg
 
Çme¥aû
 
	gTPCE
;

61 
	gCMEE
::
	$AutoS‘RNGS“ds
Ğ
UINT32
 
UniqueId
 )

63 
CD©eTime
 
Now
;

64 
INT32
 
Ba£Y—r
;

65 
INT32
 
Tmp1
, 
Tmp2
;

67 
Now
.
	`G‘YMD
Ğ&
Ba£Y—r
, &
Tmp1
, &
Tmp2
 );

70 
Ba£Y—r
 -= ( BaseYear % 5 );

71 
CD©eTime
 
	`Ba£
Ğ
Ba£Y—r
, 1, 1 );

75 
RNGSEED
 
S“d
;

76 
S“d
 = 
Now
.
	`MSec
() / 100;

81 
S“d
 <<= 11;

82 
S“d
 +ğ(
RNGSEED
)((
INT64
)
Now
.
	`DayNo
(è- (INT64)
Ba£
.DayNo());

88 
S“d
 <<= 33;

92 
S“d
 +ğ
UniqueId
;

95 
m_Tick”T­e
.
	`S‘RNGS“d
Ğ
S“d
 );

96 
m_Driv”MEES‘tšgs
.
cur
.
Tick”T­eRNGS“d
 = 
S“d
;

99 
S“d
 |ğ
	`UINT64_CONST
(0x0000000100000000);

100 
m_T¿dšgFloÜ
.
	`S‘RNGS“d
Ğ
S“d
 );

101 
m_Driv”MEES‘tšgs
.
cur
.
T¿dšgFloÜRNGS“d
 = 
S“d
;

102 
	}
}

105 
	gCMEE
::
	$CMEE
Ğ
INT32
 
T¿dšgTimeSoF¬
, 
CMEESUTIÁ”çû
 *
pSUT
, 
CBa£Logg”
 *
pLogg”
, cÚ¡ 
CIÅutFes
& 
šputFes
, 
UINT32
 
UniqueId
 )

106 : 
	`m_Driv”MEES‘tšgs
 ( 
UniqueId
, 0, 0, 0 )

107 , 
	`m_pSUT
Ğ
pSUT
 )

108 , 
	`m_pLogg”
Ğ
pLogg”
 )

109 , 
	`m_PriûBßrd
Ğ
T¿dšgTimeSoF¬
, &
m_Ba£Time
, &
m_Cu¼’tTime
, 
šputFes
 )

110 , 
	`m_Tick”T­e
Ğ
pSUT
, &
m_PriûBßrd
, &
m_Ba£Time
, &
m_Cu¼’tTime
, 
šputFes
 )

111 , 
	`m_T¿dšgFloÜ
Ğ
pSUT
, &
m_PriûBßrd
, &
m_Tick”T­e
, &
m_Ba£Time
, &
m_Cu¼’tTime
 )

112 , 
	$m_MEELock
()

114 
m_pLogg”
->
	`S’dToLogg”
("MEE object constructed using c'tor 1 (valid for…ublication: YES).");

116 
	`AutoS‘RNGS“ds
Ğ
UniqueId
 );

118 
m_pLogg”
->
	`S’dToLogg”
(
m_Driv”MEES‘tšgs
);

119 
	}
}

122 
	gCMEE
::
	$CMEE
Ğ
INT32
 
T¿dšgTimeSoF¬
, 
CMEESUTIÁ”çû
 *
pSUT
, 
CBa£Logg”
 *
pLogg”
, cÚ¡ 
CIÅutFes
& 
šputFes
, 
UINT32
 
UniqueId
, 
RNGSEED
 
Tick”T­eRNGS“d
, RNGSEED 
T¿dšgFloÜRNGS“d
 )

123 : 
	`m_Driv”MEES‘tšgs
 ( 
UniqueId
, 0, 
Tick”T­eRNGS“d
, 
T¿dšgFloÜRNGS“d
 )

124 , 
	`m_pSUT
Ğ
pSUT
 )

125 , 
	`m_pLogg”
Ğ
pLogg”
 )

126 , 
	`m_PriûBßrd
Ğ
T¿dšgTimeSoF¬
, &
m_Ba£Time
, &
m_Cu¼’tTime
, 
šputFes
 )

127 , 
	`m_Tick”T­e
Ğ
pSUT
, &
m_PriûBßrd
, &
m_Ba£Time
, &
m_Cu¼’tTime
, 
Tick”T­eRNGS“d
, 
šputFes
 )

128 , 
	`m_T¿dšgFloÜ
Ğ
pSUT
, &
m_PriûBßrd
, &
m_Tick”T­e
, &
m_Ba£Time
, &
m_Cu¼’tTime
, 
T¿dšgFloÜRNGS“d
 )

129 , 
	$m_MEELock
()

131 
m_pLogg”
->
	`S’dToLogg”
("MEE object constructed using c'tor 2 (valid for…ublication: NO).");

132 
m_pLogg”
->
	`S’dToLogg”
(
m_Driv”MEES‘tšgs
);

133 
	}
}

135 
	gCMEE
::~
	$CMEE
( )

137 
m_pLogg”
->
	`S’dToLogg”
("MEE object destroyed.");

138 
	}
}

140 
RNGSEED
 
	gCMEE
::
	$G‘Tick”T­eRNGS“d
( )

142 Ğ
m_Tick”T­e
.
	`G‘RNGS“d
() );

143 
	}
}

145 
RNGSEED
 
	gCMEE
::
	$G‘T¿dšgFloÜRNGS“d
( )

147 Ğ
m_T¿dšgFloÜ
.
	`G‘RNGS“d
() );

148 
	}
}

150 
	gCMEE
::
	$S‘Ba£Time
( )

152 
m_MEELock
.
	`lock
();

153 
m_Ba£Time
.
	`S‘ToCu¼’t
( );

154 
m_MEELock
.
	`uÆock
();

155 
	}
}

157 
boŞ
 
	gCMEE
::
	$Di§bËTick”T­e
( )

159 
boŞ
 
ResuÉ
;

160 
m_MEELock
.
	`lock
();

161 
ResuÉ
 = 
m_Tick”T­e
.
	`Di§bËTick”
();

162 
m_MEELock
.
	`uÆock
();

163 Ğ
ResuÉ
 );

164 
	}
}

166 
boŞ
 
	gCMEE
::
	$EÇbËTick”T­e
( )

168 
boŞ
 
ResuÉ
;

169 
m_MEELock
.
	`lock
();

170 
ResuÉ
 = 
m_Tick”T­e
.
	`EÇbËTick”
();

171 
m_MEELock
.
	`uÆock
();

172 Ğ
ResuÉ
 );

173 
	}
}

175 
INT32
 
	gCMEE
::
	$G’”©eT¿deResuÉ
( )

177 
INT32
 
NextTime
;

179 
m_MEELock
.
	`lock
();

180 
m_Cu¼’tTime
.
	`S‘ToCu¼’t
( );

181 
NextTime
 = 
m_T¿dšgFloÜ
.
	`G’”©eT¿deResuÉ
( );

182 
m_MEELock
.
	`uÆock
();

183 Ğ
NextTime
 );

184 
	}
}

186 
INT32
 
	gCMEE
::
	$Subm™T¿deReque¡
Ğ
PT¿deReque¡
 
pT¿deReque¡
 )

188 
INT32
 
NextTime
;

190 
m_MEELock
.
	`lock
();

191 
m_Cu¼’tTime
.
	`S‘ToCu¼’t
( );

192 
NextTime
 = 
m_T¿dšgFloÜ
.
	`Subm™T¿deReque¡
Ğ
pT¿deReque¡
 );

193 
m_MEELock
.
	`uÆock
();

194 Ğ
NextTime
 );

195 
	}
}

	@src/workload/tpce/egen/MEEPriceBoard.cpp

42 
	~"wÜklßd/û/eg’/MEEPriûBßrd.h
"

44 
usšg
 
Çme¥aû
 
	gTPCE
;

46 
	gCMEEPriûBßrd
::
	$CMEEPriûBßrd
Ğ
INT32
 
T¿dšgTimeSoF¬
,

47 
CD©eTime
* 
pBa£Time
,

48 
CD©eTime
* 
pCu¼’tTime
,

49 cÚ¡ 
CIÅutFes
& 
šputFes


51 : 
	`m_fM—nInTheMÚeySubmissiÚD–ay
( 1.0 )

52 , 
	`m_Secur™y
()

53 , 
	`m_pSecur™yFe
Ğ
šputFes
.
Secur™›s
 )

54 , 
	$m_iNumb”OfSecur™›s
( 0 )

68 
m_iNumb”OfSecur™›s
 = 
m_pSecur™yFe
->
	`G‘AùiveSecur™yCouÁ
();

69 
m_Secur™y
.
	`In™
Ğ
T¿dšgTimeSoF¬
, 
pBa£Time
, 
pCu¼’tTime
, 
m_fM—nInTheMÚeySubmissiÚD–ay
 );

70 
m_pSecur™yFe
->
	`LßdSymbŞToIdM­
();

71 
	}
}

73 
	gCMEEPriûBßrd
::~
	$CMEEPriûBßrd
()

75 
	}
}

77 
CMEEPriûBßrd
::
	$G‘SymbŞ
Ğ
TId’t
 
Secur™yIndex
,

78 * 
szOuut
,

79 
size_t
 
iOuutL’
)

81 Ğ
m_pSecur™yFe
->
	`C»©eSymbŞ
Ğ
Secur™yIndex
, 
szOuut
, 
iOuutL’
 ) );

82 
	}
}

84 
CMÚey
 
	gCMEEPriûBßrd
::
	$G‘MšPriû
()

86 Ğ
m_Secur™y
.
	`G‘MšPriû
( ));

87 
	}
}

89 
CMÚey
 
	gCMEEPriûBßrd
::
	$G‘MaxPriû
()

91 Ğ
m_Secur™y
.
	`G‘MaxPriû
( ));

92 
	}
}

94 
CMÚey
 
	gCMEEPriûBßrd
::
	$G‘Cu¼’tPriû
Ğ
TId’t
 
Secur™yIndex
 )

96 Ğ
m_Secur™y
.
	`G‘Cu¼’tPriû
Ğ
Secur™yIndex
 ));

97 
	}
}

99 
CMÚey
 
	gCMEEPriûBßrd
::
	$G‘Cu¼’tPriû
Ğ* 
pSecur™ySymbŞ
 )

101 Ğ
m_Secur™y
.
	`G‘Cu¼’tPriû
Ğ
m_pSecur™yFe
->
	`G‘Index
Ğ
pSecur™ySymbŞ
 )));

102 
	}
}

104 
CMÚey
 
	gCMEEPriûBßrd
::
	$C®cuÏ‹Priû
Ğ* 
pSecur™ySymbŞ
, 
fTime
 )

106 Ğ
m_Secur™y
.
	`C®cuÏ‹Priû
Ğ
m_pSecur™yFe
->
	`G‘Index
Ğ
pSecur™ySymbŞ
 ), 
fTime
 ));

107 
	}
}

109 
	gCMEEPriûBßrd
::
	$G‘SubmissiÚTime
(

110 * 
pSecur™ySymbŞ
,

111 
fP’dšgTime
,

112 
CMÚey
 
fLim™Priû
,

113 
eT¿deTy³ID
 
T¿deTy³


116 Ğ
m_Secur™y
.
	`G‘SubmissiÚTime
Ğ
m_pSecur™yFe
->
	`G‘Index
Ğ
pSecur™ySymbŞ
 ), 
fP’dšgTime
,

117 
fLim™Priû
, 
T¿deTy³
 ));

118 
	}
}

120 
	gCMEEPriûBßrd
::
	$G‘SubmissiÚTime
(

121 
TId’t
 
Secur™yIndex
,

122 
fP’dšgTime
,

123 
CMÚey
 
fLim™Priû
,

124 
eT¿deTy³ID
 
T¿deTy³


127 Ğ
m_Secur™y
.
	`G‘SubmissiÚTime
Ğ
Secur™yIndex
, 
fP’dšgTime
,

128 
fLim™Priû
, 
T¿deTy³
 ));

129 
	}
}

131 
	gCMEEPriûBßrd
::
	$G‘Com¶‘iÚTime
(

132 
TId’t
 
Secur™yIndex
,

133 
fSubmissiÚTime
,

134 
CMÚey
* 
pCom¶‘iÚPriû


137 Ğ
m_Secur™y
.
	`G‘Com¶‘iÚTime
Ğ
Secur™yIndex
, 
fSubmissiÚTime
,

138 
pCom¶‘iÚPriû
 ));

139 
	}
}

	@src/workload/tpce/egen/MEESecurity.cpp

42 
	~<cm©h
>

43 
	~"wÜklßd/û/eg’/MEESecur™y.h
"

45 
usšg
 
Çme¥aû
 
	gTPCE
;

50 cÚ¡ 
	giSecPriûP”iod
 = 900;

54 cÚ¡ 
	gfM—nCom¶‘iÚTimeD–ay
 = 1.0;

59 cÚ¡ 
	gfCom¶‘iÚSUTD–ay
 = 1.0;

71 
	gCMEESecur™y
::
	$CMEESecur™y
()

72 : 
	`m_ºd
(
RNGS“dBa£MEESecur™y
)

73 , 
	`m_fRªgeLow
(
fMšSecPriû
)

74 , 
	`m_fRªgeHigh
(
fMaxSecPriû
)

75 , 
	`m_fRªge
(
fMaxSecPriû
 - 
fMšSecPriû
)

76 , 
	`m_iP”iod
(
iSecPriûP”iod
)

77 , 
	`m_T¿dšgTimeSoF¬
( 0 )

78 , 
	`m_pBa£Time
Ğ
NULL
 )

79 , 
	$m_pCu¼’tTime
Ğ
NULL
 )

81 
	}
}

98 
	gCMEESecur™y
::
	$In™
(

99 
INT32
 
T¿dšgTimeSoF¬
,

100 
CD©eTime
 *
pBa£Time
,

101 
CD©eTime
 *
pCu¼’tTime
,

110 
fM—nInTheMÚeySubmissiÚD–ay


113 
m_T¿dšgTimeSoF¬
 = 
T¿dšgTimeSoF¬
;

114 
m_pBa£Time
 = 
pBa£Time
;

115 
m_pCu¼’tTime
 = 
pCu¼’tTime
;

117 
m_fM—nInTheMÚeySubmissiÚD–ay
 = 
fM—nInTheMÚeySubmissiÚD–ay
;

122 
m_ºd
.
	`S‘S“d
(
RNGS“dBa£MEESecur™y
);

123 
	}
}

138 
šlše
 
	gCMEESecur™y
::
	$In™ŸlTime
Ğ
TId’t
 
Secur™yIndex
 )

140 
INT32
 
MsP”P”iod
 = 
iSecPriûP”iod
 * 
MsP”SecÚd
;

141 
TId’t
 
Secur™yFaùÜ
 = 
Secur™yIndex
 * 556237 + 253791;

142 
TId’t
 
T¿dšgFaùÜ
 = (TId’t)
m_T¿dšgTimeSoF¬
 * 
MsP”SecÚd
;

144  ( ((
T¿dšgFaùÜ
 + 
Secur™yFaùÜ
è% 
MsP”P”iod
è/ 
MsP”SecÚdDivisÜ
 );

145 
	}
}

157 
šlše
 
	gCMEESecur™y
::
	$NegExp
(
fM—n
)

159  
	`RoundToN—»¡N£c
(
m_ºd
.
	`RndDoubËNegExp
(
fM—n
));

160 
	}
}

171 
CMÚey
 
	gCMEESecur™y
::
	$G‘Cu¼’tPriû
Ğ
TId’t
 
Secur™yIndex
 )

173 Ğ
	`C®cuÏ‹Priû
Ğ
Secur™yIndex
, *
m_pCu¼’tTime
 - *
m_pBa£Time
 ));

174 
	}
}

185 
CMÚey
 
	gCMEESecur™y
::
	$G‘MšPriû
( )

187 Ğ
m_fRªgeLow
 );

188 
	}
}

199 
CMÚey
 
	gCMEESecur™y
::
	$G‘MaxPriû
( )

201 Ğ
m_fRªgeHigh
 );

202 
	}
}

215 
CMÚey
 
	gCMEESecur™y
::
	$C®cuÏ‹Priû
Ğ
TId’t
 
Secur™yIndex
,

216 
fTime


219 
fP”iodTime
 = (
fTime
 + 
	`In™ŸlTime
Ğ
Secur™yIndex
 )è/ ()
m_iP”iod
;

220 
fTimeW™hšP”iod
 = (
fP”iodTime
 - ()fP”iodTimeè* ()
m_iP”iod
;

222 
fPriûPos™iÚ
;

223 
CMÚey
 
PriûC’ts
;

225 ià(
fTimeW™hšP”iod
 < 
m_iP”iod
 / 2)

227 
fPriûPos™iÚ
 = 
fTimeW™hšP”iod
 / (
m_iP”iod
 / 2);

231 
fPriûPos™iÚ
 = (
m_iP”iod
 - 
fTimeW™hšP”iod
) / (m_iPeriod / 2);

234 
PriûC’ts
 = 
m_fRªgeLow
 + 
m_fRªge
 * 
fPriûPos™iÚ
;

236  
PriûC’ts
;

237 
	}
}

251 
	gCMEESecur™y
::
	$C®cuÏ‹Time
(

252 
CMÚey
 
fS¹Priû
,

253 
CMÚey
 
fEndPriû
,

254 
iS¹DœeùiÚ
)

256 
iH®fP”iod
 = 
m_iP”iod
 / 2;

260 
CMÚey
 
fDi¡ªû
;

265 
fS³ed
 = 
iH®fP”iod
 / 
m_fRªge
.
	`DŞÏrAmouÁ
();

267 ià(
fEndPriû
 > 
fS¹Priû
)

269 ià(
iS¹DœeùiÚ
 > 0)

271 
fDi¡ªû
 = 
fEndPriû
 - 
fS¹Priû
;

275 
fDi¡ªû
 = (
fS¹Priû
 - 
m_fRªgeLow
è+ (
fEndPriû
 - m_fRangeLow);

280 ià(
iS¹DœeùiÚ
 > 0)

282 
fDi¡ªû
 = (
m_fRªgeHigh
 - 
fS¹Priû
è+ (m_fRªgeHigh - 
fEndPriû
);

286 
fDi¡ªû
 = 
fS¹Priû
 - 
fEndPriû
;

290  
fDi¡ªû
.
	`DŞÏrAmouÁ
(è* 
fS³ed
;

291 
	}
}

305 
	gCMEESecur™y
::
	$G‘SubmissiÚTime
Ğ
TId’t
 
Secur™yIndex
,

306 
fP’dšgTime
,

307 
CMÚey
 
fLim™Priû
,

308 
eT¿deTy³ID
 
T¿deTy³


311 
CMÚey
 
fPriûAtP’dšgTime
 = 
	`C®cuÏ‹Priû
Ğ
Secur™yIndex
, 
fP’dšgTime
 );

313 
iDœeùiÚAtP’dšgTime
;

315 
fSubmissiÚTimeFromP’dšg
;

321 iàĞ((
T¿deTy³
 =ğ
eLim™Buy
 || T¿deTy³ =ğ
eStİLoss
) &&

322 
fPriûAtP’dšgTime
 <ğ
fLim™Priû
)

324 ((
T¿deTy³
 =ğ
eLim™S–l
 ) &&

325 
fPriûAtP’dšgTime
 >ğ
fLim™Priû
))

329 
fSubmissiÚTimeFromP’dšg
 = 
m_ºd
.
	`RndDoubËInüRªge
(0.5 * 
m_fM—nInTheMÚeySubmissiÚD–ay
,

330 1.5 * 
m_fM—nInTheMÚeySubmissiÚD–ay
,

335 ià(()(
fP’dšgTime
 + 
	`In™ŸlTime
Ğ
Secur™yIndex
 )è% 
m_iP”iod
 < m_iPeriod / 2)

339 
iDœeùiÚAtP’dšgTime
 = 1;

345 
iDœeùiÚAtP’dšgTime
 = -1;

348 
fSubmissiÚTimeFromP’dšg
 = 
	`C®cuÏ‹Time
Ğ
fPriûAtP’dšgTime
,

349 
fLim™Priû
,

350 
iDœeùiÚAtP’dšgTime
);

353  
fP’dšgTime
 + 
fSubmissiÚTimeFromP’dšg
;

354 
	}
}

377 
	gCMEESecur™y
::
	$G‘Com¶‘iÚTime
Ğ
TId’t
 
Secur™yIndex
,

378 
fSubmissiÚTime
,

379 
CMÚey
* 
pCom¶‘iÚPriû


382 
fCom¶‘iÚD–ay
 = 
	`NegExp
(
fM—nCom¶‘iÚTimeD–ay
);

386 ià(
fCom¶‘iÚD–ay
 > 5.0)

388 
fCom¶‘iÚD–ay
 = 5.0;

391 ià(
pCom¶‘iÚPriû
 !ğ
NULL
)

393 *
pCom¶‘iÚPriû
 = 
	`C®cuÏ‹Priû
Ğ
Secur™yIndex
, 
fSubmissiÚTime
 + 
fCom¶‘iÚD–ay
 );

396  
fSubmissiÚTime
 + 
fCom¶‘iÚD–ay
 + 
fCom¶‘iÚSUTD–ay
;

397 
	}
}

	@src/workload/tpce/egen/MEETickerTape.cpp

42 
	~"wÜklßd/û/eg’/MEETick”T­e.h
"

44 
usšg
 
Çme¥aû
 
	gTPCE
;

46 cÚ¡ 
	gCMEETick”T­e
::
LIMIT_TRIGGER_TRADE_QTY
 = 375;

47 cÚ¡ 
	gCMEETick”T­e
::
RANDOM_TRADE_QTY_1
 = 325;

48 cÚ¡ 
	gCMEETick”T­e
::
RANDOM_TRADE_QTY_2
 = 425;

50 
RNGSEED
 
	gCMEETick”T­e
::
	$G‘RNGS“d
( )

52 Ğ
m_ºd
.
	`G‘S“d
() );

53 
	}
}

55 
	gCMEETick”T­e
::
	$S‘RNGS“d
Ğ
RNGSEED
 
RNGS“d
 )

57 
m_ºd
.
	`S‘S“d
Ğ
RNGS“d
 );

58 
	}
}

60 
	gCMEETick”T­e
::
	$In™Ÿlize
( )

65 
	`¡ºıy
(
m_TxnIÅut
.
StusAndT¿deTy³
.
¡©us_subm™‹d
,

66 (
m_pStusTy³
->
	`G‘RecÜd
(
eSubm™‹d
))->
ST_ID
,

67 (
m_TxnIÅut
.
StusAndT¿deTy³
.
¡©us_subm™‹d
));

69 
	`¡ºıy
(
m_TxnIÅut
.
StusAndT¿deTy³
.
ty³_lim™_buy
,

70 (
m_pT¿deTy³
->
	`G‘RecÜd
(
eLim™Buy
))->
TT_ID
,

71 (
m_TxnIÅut
.
StusAndT¿deTy³
.
ty³_lim™_buy
));

73 
	`¡ºıy
(
m_TxnIÅut
.
StusAndT¿deTy³
.
ty³_lim™_£Î
,

74 (
m_pT¿deTy³
->
	`G‘RecÜd
(
eLim™S–l
))->
TT_ID
,

75 (
m_TxnIÅut
.
StusAndT¿deTy³
.
ty³_lim™_£Î
));

77 
	`¡ºıy
(
m_TxnIÅut
.
StusAndT¿deTy³
.
ty³_¡İ_loss
,

78 (
m_pT¿deTy³
->
	`G‘RecÜd
(
eStİLoss
))->
TT_ID
,

79 (
m_TxnIÅut
.
StusAndT¿deTy³
.
ty³_¡İ_loss
));

80 
	}
}

83 
	gCMEETick”T­e
::
	$CMEETick”T­e
Ğ
CMEESUTIÁ”çû
* 
pSUT
, 
CMEEPriûBßrd
* 
pPriûBßrd
, 
CD©eTime
* 
pBa£Time
, CD©eTime* 
pCu¼’tTime
, cÚ¡ 
CIÅutFes
 &
šputFes
 )

84 : 
	`m_pSUT
Ğ
pSUT
 )

85 , 
	`m_pPriûBßrd
Ğ
pPriûBßrd
 )

86 , 
	`m_B©chIndex
( 0 )

87 , 
	`m_B©chDu¶iÿ‹s
( 0 )

88 , 
	`m_ºd
Ğ
RNGS“dBa£MEETick”T­e
 )

89 , 
	`m_EÇbËd
Ğ
Œue
 )

90 , 
	`m_pBa£Time
Ğ
pBa£Time
 )

91 , 
	`m_pCu¼’tTime
Ğ
pCu¼’tTime
 )

92 , 
	`m_pStusTy³
Ğ
šputFes
.
StusTy³
 )

93 , 
	$m_pT¿deTy³
Ğ
šputFes
.
T¿deTy³
 )

95 
	`In™Ÿlize
();

96 
	}
}

99 
	gCMEETick”T­e
::
	$CMEETick”T­e
Ğ
CMEESUTIÁ”çû
* 
pSUT
, 
CMEEPriûBßrd
* 
pPriûBßrd
, 
CD©eTime
* 
pBa£Time
, CD©eTime* 
pCu¼’tTime
, 
RNGSEED
 
RNGS“d
, cÚ¡ 
CIÅutFes
 &
šputFes
 )

100 : 
	`m_pSUT
Ğ
pSUT
 )

101 , 
	`m_pPriûBßrd
Ğ
pPriûBßrd
 )

102 , 
	`m_B©chIndex
( 0 )

103 , 
	`m_B©chDu¶iÿ‹s
( 0 )

104 , 
	`m_ºd
Ğ
RNGS“d
 )

105 , 
	`m_EÇbËd
Ğ
Œue
 )

106 , 
	`m_pBa£Time
Ğ
pBa£Time
 )

107 , 
	`m_pCu¼’tTime
Ğ
pCu¼’tTime
 )

108 , 
	`m_pStusTy³
Ğ
šputFes
.
StusTy³
 )

109 , 
	$m_pT¿deTy³
Ğ
šputFes
.
T¿deTy³
 )

111 
	`In™Ÿlize
();

112 
	}
}

114 
	gCMEETick”T­e
::~
	$CMEETick”T­e
( )

116 
	}
}

118 
boŞ
 
CMEETick”T­e
::
	$Di§bËTick”
( )

120 
m_EÇbËd
 = 
çl£
;

121 Ğ! 
m_EÇbËd
 );

122 
	}
}

124 
boŞ
 
	gCMEETick”T­e
::
	$EÇbËTick”
( )

126 
m_EÇbËd
 = 
Œue
;

127 Ğ
m_EÇbËd
 );

128 
	}
}

130 
	gCMEETick”T­e
::
	$AddEÁry
Ğ
PTick”EÁry
 
pTick”EÁry
 )

132 ifĞ
m_EÇbËd
 )

134 
	`AddToB©ch
Ğ
pTick”EÁry
 );

135 
	`AddA¹ificŸlEÁr›s
( );

137 
	}
}

139 
	gCMEETick”T­e
::
	$Po¡Lim™Ord”
Ğ
PT¿deReque¡
 
pT¿deReque¡
 )

141 
eT¿deTy³ID
 
eT¿deTy³
;

142 
Cu¼’tPriû
 = -1.0;

143 
PTick”EÁry
 
pNewEÁry
 = 
Ãw
 
TTick”EÁry
;

145 
eT¿deTy³
 = 
	`CÚv”tT¿deTy³IdToEnum
Ğ
pT¿deReque¡
->
Œade_ty³_id
 );

147 
pNewEÁry
->
´iû_quÙe
 = 
pT¿deReque¡
->price_quote;

148 
	`¡ºıy
Ğ
pNewEÁry
->
symbŞ
, 
pT¿deReque¡
->symbol, (…NewEntry->symbol ));

149 
pNewEÁry
->
Œade_qty
 = 
LIMIT_TRIGGER_TRADE_QTY
;

151 
Cu¼’tPriû
 = 
m_pPriûBßrd
->
	`G‘Cu¼’tPriû
Ğ
pT¿deReque¡
->
symbŞ
 ).
	`DŞÏrAmouÁ
();

153 if((Ğ
eT¿deTy³
 =ğ
eLim™Buy
 ||ƒT¿deTy³ =ğ
eStİLoss
 ) &&

154 
Cu¼’tPriû
 <ğ
pT¿deReque¡
->
´iû_quÙe
 )

156 (Ğ
eT¿deTy³
 =ğ
eLim™S–l
 ) &&

157 
Cu¼’tPriû
 >ğ
pT¿deReque¡
->
´iû_quÙe
 ))

160 
pNewEÁry
->
´iû_quÙe
 = 
Cu¼’tPriû
;

162 
m_Lim™Ord”Tim”s
.
	`ProûssExpœedTim”s
();

164 
m_InTheMÚeyLim™Ord”Q
.
	`push
Ğ
pNewEÁry
 );

169 
pNewEÁry
->
´iû_quÙe
 = 
pT¿deReque¡
->price_quote;

170 
Trigg”TimeD–ay
;

171 
fCu¼’tTime
 = *
m_pCu¼’tTime
 - *
m_pBa£Time
;

176 
Trigg”TimeD–ay
 = 
m_pPriûBßrd
->
	`G‘SubmissiÚTime
(
pNewEÁry
->
symbŞ
,

177 
fCu¼’tTime
,

178 
pNewEÁry
->
´iû_quÙe
,

179 
eT¿deTy³
)

180 - 
fCu¼’tTime
;

181 
m_Lim™Ord”Tim”s
.
	`S¹Tim”
Ğ
Trigg”TimeD–ay
,

182 
this
, &
CMEETick”T­e
::
AddLim™Trigg”
, 
pNewEÁry
 );

184 
	}
}

186 
	gCMEETick”T­e
::
	$AddLim™Trigg”
Ğ
PTick”EÁry
 
pTick”EÁry
 )

188 
m_InTheMÚeyLim™Ord”Q
.
	`push
Ğ
pTick”EÁry
 );

189 
	}
}

191 
	gCMEETick”T­e
::
	$AddA¹ificŸlEÁr›s
( )

193 
TId’t
 
Secur™yIndex
;

194 
TTick”EÁry
 
Tick”EÁry
;

195 
TÙ®EÁryCouÁ
 = 0;

196 cÚ¡ 
PaddšgLim™
 = (
max_ãed_Ën
 / 10) - 1;

197 cÚ¡ 
PaddšgLim™FÜAÎ
 = 
PaddšgLim™
;

198 cÚ¡ 
PaddšgLim™FÜTrigg”s
 = 
PaddšgLim™
;

200  
TÙ®EÁryCouÁ
 < 
PaddšgLim™FÜTrigg”s
 && !
m_InTheMÚeyLim™Ord”Q
.
	`em±y
() )

202 
PTick”EÁry
 
pEÁry
 = 
m_InTheMÚeyLim™Ord”Q
.
	`äÚt
();

203 
	`AddToB©ch
Ğ
pEÁry
 );

204 
d–‘e
 
pEÁry
;

205 
m_InTheMÚeyLim™Ord”Q
.
	`pİ
();

206 
TÙ®EÁryCouÁ
++;

209  
TÙ®EÁryCouÁ
 < 
PaddšgLim™FÜAÎ
 )

211 
Tick”EÁry
.
Œade_qty
 = ( 
m_ºd
.
	`RndP”ûÁ
Ğ50 )è? 
RANDOM_TRADE_QTY_1
 : 
RANDOM_TRADE_QTY_2
;

213 
Secur™yIndex
 = 
m_ºd
.
	`RndIÁ64Rªge
Ğ0, 
m_pPriûBßrd
->
m_iNumb”OfSecur™›s
 - 1 );

214 
Tick”EÁry
.
´iû_quÙe
 = (
m_pPriûBßrd
->
	`G‘Cu¼’tPriû
Ğ
Secur™yIndex
 )).
	`DŞÏrAmouÁ
();

215 
m_pPriûBßrd
->
	`G‘SymbŞ
Ğ
Secur™yIndex
, 
Tick”EÁry
.
symbŞ
, 
¡©ic_ÿ¡
<
INT32
>((TickerEntry.symbol)) );

217 
	`AddToB©ch
Ğ&
Tick”EÁry
 );

218 
TÙ®EÁryCouÁ
++;

220 
	}
}

222 
	gCMEETick”T­e
::
	$AddToB©ch
Ğ
PTick”EÁry
 
pTick”EÁry
 )

225 
i
=0; i<
m_B©chIndex
; i++)

227 ià(
	`¡ºcmp
(
pTick”EÁry
->
symbŞ
, 
m_TxnIÅut
.
EÁr›s
[
i
].symbŞ, 
cSYMBOL_Ën
) == 0)

229 
m_B©chDu¶iÿ‹s
++;

235 
m_TxnIÅut
.
EÁr›s
[
m_B©chIndex
++] = *
pTick”EÁry
;

238 ifĞ
max_ãed_Ën
 =ğ
m_B©chIndex
 )

240 
m_TxnIÅut
.
unique_symbŞs
 = (
max_ãed_Ën
 - 
m_B©chDu¶iÿ‹s
);

241 
m_pSUT
->
	`M¬k‘F“d
Ğ&
m_TxnIÅut
 );

242 
m_B©chIndex
 = 0;

243 
m_B©chDu¶iÿ‹s
 = 0;

245 
	}
}

247 
eT¿deTy³ID
 
	gCMEETick”T­e
::
	$CÚv”tT¿deTy³IdToEnum
Ğ* 
pT¿deTy³
 )

250  
pT¿deTy³
[0] )

253  
pT¿deTy³
[1] )

256  
pT¿deTy³
[2] )

259 Ğ
eLim™Buy
 );

261 Ğ
eLim™S–l
 );

267  
pT¿deTy³
[2] )

270 Ğ
eM¬k‘Buy
 );

272 Ğ
eM¬k‘S–l
 );

278  
pT¿deTy³
[2] )

281 Ğ
eStİLoss
 );

295 
	`as£¹
(
çl£
);

297  
eM¬k‘Buy
;

298 
	}
}

	@src/workload/tpce/egen/MEETradingFloor.cpp

42 
	~"wÜklßd/û/eg’/MEET¿dšgFloÜ.h
"

44 
usšg
 
Çme¥aû
 
	gTPCE
;

46 
RNGSEED
 
	gCMEET¿dšgFloÜ
::
	$G‘RNGS“d
( )

48 Ğ
m_ºd
.
	`G‘S“d
() );

49 
	}
}

51 
	gCMEET¿dšgFloÜ
::
	$S‘RNGS“d
Ğ
RNGSEED
 
RNGS“d
 )

53 
m_ºd
.
	`S‘S“d
Ğ
RNGS“d
 );

54 
	}
}

57 
	gCMEET¿dšgFloÜ
::
	$CMEET¿dšgFloÜ
Ğ
CMEESUTIÁ”çû
* 
pSUT
, 
CMEEPriûBßrd
* 
pPriûBßrd
, 
CMEETick”T­e
* 
pTick”T­e
, 
CD©eTime
* 
pBa£Time
, CD©eTime* 
pCu¼’tTime
 )

58 : 
	`m_pSUT
Ğ
pSUT
 )

59 , 
	`m_pPriûBßrd
Ğ
pPriûBßrd
 )

60 , 
	`m_pTick”T­e
Ğ
pTick”T­e
 )

61 , 
	`m_pBa£Time
Ğ
pBa£Time
 )

62 , 
	`m_pCu¼’tTime
Ğ
pCu¼’tTime
 )

63 , 
	`m_ºd
Ğ
RNGS“dBa£MEET¿dšgFloÜ
 )

64 , 
	$m_Ord”ProûssšgD–ayM—n
( 1.0 )

66 
	}
}

69 
	gCMEET¿dšgFloÜ
::
	$CMEET¿dšgFloÜ
Ğ
CMEESUTIÁ”çû
* 
pSUT
, 
CMEEPriûBßrd
* 
pPriûBßrd
, 
CMEETick”T­e
* 
pTick”T­e
, 
CD©eTime
* 
pBa£Time
, CD©eTime* 
pCu¼’tTime
, 
RNGSEED
 
RNGS“d
 )

70 : 
	`m_pSUT
Ğ
pSUT
 )

71 , 
	`m_pPriûBßrd
Ğ
pPriûBßrd
 )

72 , 
	`m_pTick”T­e
Ğ
pTick”T­e
 )

73 , 
	`m_pBa£Time
Ğ
pBa£Time
 )

74 , 
	`m_pCu¼’tTime
Ğ
pCu¼’tTime
 )

75 , 
	`m_ºd
Ğ
RNGS“d
 )

76 , 
	$m_Ord”ProûssšgD–ayM—n
( 1.0 )

78 
	}
}

80 
	gCMEET¿dšgFloÜ
::~
	$CMEET¿dšgFloÜ
( )

82 
	}
}

84 
šlše
 
CMEET¿dšgFloÜ
::
	$G’ProûssšgD–ay
Ğ
M—n
 )

86 
ResuÉ
 = 
	`RoundToN—»¡N£c
(
m_ºd
.
	`RndDoubËNegExp
(
M—n
));

88 ifĞ
ResuÉ
 > 
m_MaxOrd”ProûssšgD–ay
 )

90 Ğ
m_MaxOrd”ProûssšgD–ay
 );

94 Ğ
ResuÉ
 );

96 
	}
}

98 
INT32
 
	gCMEET¿dšgFloÜ
::
	$Subm™T¿deReque¡
Ğ
PT¿deReque¡
 
pT¿deReque¡
 )

100  
pT¿deReque¡
->
eAùiÚ
 )

102 
eMEEProûssOrd”
:

106 
PT¿deReque¡
 
pNewOrd”
 = 
Ãw
 
TT¿deReque¡
;

107 *
pNewOrd”
 = *
pT¿deReque¡
;

108 Ğ
m_Ord”Tim”s
.
	`S¹Tim”
Ğ
	`G’ProûssšgD–ay
Ğ
m_Ord”ProûssšgD–ayM—n
 ), 
this
, &
CMEET¿dšgFloÜ
::
S’dT¿deResuÉ
, 
pNewOrd”
 ));

110 
eMEES‘Lim™Ord”Trigg”
:

112 
m_pTick”T­e
->
	`Po¡Lim™Ord”
Ğ
pT¿deReque¡
 );

113 Ğ
m_Ord”Tim”s
.
	`ProûssExpœedTim”s
() );

116 Ğ
m_Ord”Tim”s
.
	`ProûssExpœedTim”s
() );

118 
	}
}

120 
INT32
 
	gCMEET¿dšgFloÜ
::
	$G’”©eT¿deResuÉ
( )

122 Ğ
m_Ord”Tim”s
.
	`ProûssExpœedTim”s
() );

123 
	}
}

126 
	gCMEET¿dšgFloÜ
::
	$S’dT¿deResuÉ
Ğ
PT¿deReque¡
 
pT¿deReque¡
 )

128 
eT¿deTy³ID
 
eT¿deTy³
;

129 
TT¿deResuÉTxnIÅut
 
TxnIÅut
;

130 
TTick”EÁry
 
Tick”EÁry
;

131 
Cu¼’tPriû
 = -1.0;

133 
eT¿deTy³
 = 
m_pTick”T­e
->
	`CÚv”tT¿deTy³IdToEnum
Ğ
pT¿deReque¡
->
Œade_ty³_id
 );

134 
Cu¼’tPriû
 = 
m_pPriûBßrd
->
	`G‘Cu¼’tPriû
Ğ
pT¿deReque¡
->
symbŞ
 ).
	`DŞÏrAmouÁ
();

137 
TxnIÅut
.
Œade_id
 = 
pT¿deReque¡
->trade_id;

140 if(Ğ
eT¿deTy³
 =ğ
eLim™Buy
 && 
pT¿deReque¡
->
´iû_quÙe
 < 
Cu¼’tPriû
 )||ĞeT¿deTy³ =ğ
eLim™S–l
 &&…TradeRequest->price_quote > CurrentPrice ))

142 
TxnIÅut
.
Œade_´iû
 = 
pT¿deReque¡
->
´iû_quÙe
;

146 
TxnIÅut
.
Œade_´iû
 = 
Cu¼’tPriû
;

149 
m_pSUT
->
	`T¿deResuÉ
Ğ&
TxnIÅut
 );

152 
	`¡ºıy
Ğ
Tick”EÁry
.
symbŞ
, 
pT¿deReque¡
->symbol, ( TickerEntry.symbol ));

153 
Tick”EÁry
.
Œade_qty
 = 
pT¿deReque¡
->trade_qty;

168 
Tick”EÁry
.
´iû_quÙe
 = 
Cu¼’tPriû
;

171 
m_pTick”T­e
->
	`AddEÁry
Ğ& 
Tick”EÁry
 );

173 
d–‘e
 
pT¿deReque¡
;

174 
	}
}

	@src/workload/tpce/egen/Money.cpp

43 
	~"wÜklßd/û/eg’/EG’Ut™›s_¡dafx.h
"

45 
Çme¥aû
 
	gTPCE


50 
CMÚey
 
	gİ”©Ü
 *(
	gl_i
, CMÚey 
	gr_m
)

52 
CMÚey
 
	g»t
;

54 
	g»t
 = 
r_m
 * 
l_i
;

56  
	g»t
;

61 
CMÚey
 
	gİ”©Ü
 *(
	gl_f
, CMÚey 
	gr_m
)

63 
CMÚey
 
	g»t
;

65 
	g»t
 = 
r_m
 * 
l_f
;

67  
	g»t
;

72 
	gİ”©Ü
 /(
	gl_f
, 
CMÚey
 
	gr_m
)

74  
	gl_f
 / 
	gr_m
.
DŞÏrAmouÁ
();

	@src/workload/tpce/egen/Person.cpp

37 
	~"wÜklßd/û/eg’/EG’TabËs_¡dafx.h
"

39 
usšg
 
Çme¥aû
 
	gTPCE
;

42 cÚ¡ 
	giP”ûÁG’d”IsM®e
 = 49;

47 
	gCP”sÚ
::
	$CP”sÚ
(
CIÅutFes
 
šputFes


48 ,
TId’t
 
iS¹FromCu¡om”


49 ,
boŞ
 
bCacheEÇbËd


51 : 
	`m_La¡Names
(
šputFes
.
La¡Names
)

52 , 
	`m_M®eFœ¡Names
(
šputFes
.
M®eFœ¡Names
)

53 , 
	`m_Fem®eFœ¡Names
(
šputFes
.
Fem®eFœ¡Names
)

54 , 
	$m_bCacheEÇbËd
(
bCacheEÇbËd
)

56 ià(
m_bCacheEÇbËd
)

58 
m_iCacheSize
 = 
iDeçuÉLßdUn™Size
;

59 
m_iCacheOff£t
 = 
iTId’tShiá
 + 
iS¹FromCu¡om”
;

60 
m_CacheLa¡Name
 = 
Ãw
 * [
m_iCacheSize
];

61 
m_CacheFœ¡Name
 = 
Ãw
 * [
m_iCacheSize
];

62 
i
=0; i<
m_iCacheSize
; i++)

64 
m_CacheLa¡Name
[
i
] = 
NULL
;

65 
m_CacheFœ¡Name
[
i
] = 
NULL
;

68 
	}
}

73 
	gCP”sÚ
::~
	$CP”sÚ
()

75 ià(
m_bCacheEÇbËd
)

77 
d–‘e
[] 
m_CacheLa¡Name
;

78 
d–‘e
[] 
m_CacheFœ¡Name
;

80 
	}
}

85 
	gCP”sÚ
::
	$In™NextLßdUn™
(
TId’t
 
iCacheOff£tInüem’t
)

87 ià(
m_bCacheEÇbËd
)

89 
m_iCacheOff£t
 +ğ
iCacheOff£tInüem’t
;

90 
i
=0; i<
m_iCacheSize
; i++)

92 
m_CacheLa¡Name
[
i
] = 
NULL
;

93 
m_CacheFœ¡Name
[
i
] = 
NULL
;

96 
	}
}

102 * 
	gCP”sÚ
::
	$G‘La¡Name
(
TId’t
 
CID
)

104 *
La¡Name
 = 
NULL
;

114 
TId’t
 
šdex
 = 
CID
 - 
m_iCacheOff£t
;

115 
boŞ
 
bCheckCache
 = (
šdex
 >ğ0 && index < 
m_iCacheSize
);

116 ià(
m_bCacheEÇbËd
 && 
bCheckCache
)

118 
La¡Name
 = 
m_CacheLa¡Name
[
šdex
];

121 ià(
La¡Name
 =ğ
NULL
)

123 
RNGSEED
 
OldS“d
;

124 
iTh»shŞd
;

126 
OldS“d
 = 
m_ºd
.
	`G‘S“d
();

128 
m_ºd
.
	`S‘S“d
Ğm_ºd.
	`RndNthEËm’t
Ğ
RNGS“dBa£La¡Name
, (
RNGSEED
è
CID
 ));

131 
iTh»shŞd
 = 
m_ºd
.
	`RndIÁRªge
(0, 
m_La¡Names
->
	`G‘G»©e¡Key
() - 1);

132 
La¡Name
 = (
m_La¡Names
->
	`G‘RecÜd
(
iTh»shŞd
))->
LAST_NAME
;

134 
m_ºd
.
	`S‘S“d
Ğ
OldS“d
 );

136 ià(
m_bCacheEÇbËd
 && 
bCheckCache
)

138 
m_CacheLa¡Name
[
šdex
] = 
La¡Name
;

142  
La¡Name
;

143 
	}
}

149 * 
	gCP”sÚ
::
	$G‘Fœ¡Name
(
TId’t
 
CID
)

151 *
Fœ¡Name
 = 
NULL
;

159 
TId’t
 
šdex
 = 
CID
 - 
m_iCacheOff£t
;

160 
boŞ
 
bCheckCache
 = (
šdex
 >ğ0 && index < 
m_iCacheSize
);

161 ià(
m_bCacheEÇbËd
 && 
bCheckCache
)

163 
Fœ¡Name
 = 
m_CacheFœ¡Name
[
šdex
];

166 ià(
Fœ¡Name
 =ğ
NULL
)

168 
RNGSEED
 
OldS“d
;

169 
iTh»shŞd
;

171 
OldS“d
 = 
m_ºd
.
	`G‘S“d
();

173 
m_ºd
.
	`S‘S“d
Ğm_ºd.
	`RndNthEËm’t
Ğ
RNGS“dBa£Fœ¡Name
, (
RNGSEED
è
CID
 ));

176 ià(
	`IsM®eG’d”
(
CID
))

178 
iTh»shŞd
 = 
m_ºd
.
	`RndIÁRªge
(0, 
m_M®eFœ¡Names
->
	`G‘G»©e¡Key
() - 1);

179 
Fœ¡Name
 = (
m_M®eFœ¡Names
->
	`G‘RecÜd
(
iTh»shŞd
))->
FIRST_NAME
;

183 
iTh»shŞd
 = 
m_ºd
.
	`RndIÁRªge
(0, 
m_Fem®eFœ¡Names
->
	`G‘G»©e¡Key
() - 1);

184 
Fœ¡Name
 = (
m_Fem®eFœ¡Names
->
	`G‘RecÜd
(
iTh»shŞd
))->
FIRST_NAME
;

186 
m_ºd
.
	`S‘S“d
Ğ
OldS“d
 );

188 ià(
m_bCacheEÇbËd
 && 
bCheckCache
)

190 
m_CacheFœ¡Name
[
šdex
] = 
Fœ¡Name
;

193  
Fœ¡Name
;

194 
	}
}

198 
	gCP”sÚ
::
	$G‘MiddËName
(
TId’t
 
CID
)

200 
RNGSEED
 
OldS“d
;

201 
cMiddËIn™Ÿl
[2];

203 
OldS“d
 = 
m_ºd
.
	`G‘S“d
();

204 
m_ºd
.
	`S‘S“d
Ğm_ºd.
	`RndNthEËm’t
Ğ
RNGS“dBa£MiddËIn™Ÿl
,

205 (
RNGSEED
è
CID
 ));

206 
cMiddËIn™Ÿl
[1] = '\0';

207 
m_ºd
.
	`RndAÍhaNumFÜm©‹d
Ğ
cMiddËIn™Ÿl
, "a" );

208 
m_ºd
.
	`S‘S“d
Ğ
OldS“d
 );

209 Ğ
cMiddËIn™Ÿl
[0] );

210 
	}
}

215 
	gCP”sÚ
::
	$G‘G’d”
(
TId’t
 
CID
)

217 
RNGSEED
 
OldS“d
;

218 
cG’d”
;

220 
OldS“d
 = 
m_ºd
.
	`G‘S“d
();

221 
m_ºd
.
	`S‘S“d
Ğm_ºd.
	`RndNthEËm’t
Ğ
RNGS“dBa£G’d”
, (
RNGSEED
è
CID
 ));

224 ià(
m_ºd
.
	`RndP”ûÁ
Ğ
iP”ûÁG’d”IsM®e
 ))

226 
cG’d”
 = 'M';

230 
cG’d”
 = 'F';

233 
m_ºd
.
	`S‘S“d
Ğ
OldS“d
 );

234 Ğ
cG’d”
 );

235 
	}
}

240 
boŞ
 
	gCP”sÚ
::
	$IsM®eG’d”
(
TId’t
 
CID
)

242  
	`G‘G’d”
(
CID
)=='M';

243 
	}
}

248 
	gCP”sÚ
::
	$G‘TaxID
(
TId’t
 
CID
, *
buf
)

250 
RNGSEED
 
OldS“d
;

252 
OldS“d
 = 
m_ºd
.
	`G‘S“d
();

258 
m_ºd
.
	`S‘S“d
Ğm_ºd.
	`RndNthEËm’t
Ğ
RNGS“dBa£TaxID
,

259 Ğ(
RNGSEED
)
CID
 * 
TaxIDFmt_Ën
 )));

260 
m_ºd
.
	`RndAÍhaNumFÜm©‹d
(
buf
, 
TaxIDFmt
);

261 
m_ºd
.
	`S‘S“d
Ğ
OldS“d
 );

262 
	}
}

267 
	gCP”sÚ
::
	$G‘Fœ¡La¡AndTaxID
(
TId’t
 
C_ID
, *
szFœ¡Name
, *
szLa¡Name
, *
szTaxID
)

270 
	`¡ºıy
(
szLa¡Name
, 
	`G‘La¡Name
(
C_ID
), 
cL_NAME_Ën
);

272 
	`¡ºıy
(
szFœ¡Name
, 
	`G‘Fœ¡Name
(
C_ID
), 
cF_NAME_Ën
);

274 
	`G‘TaxID
(
C_ID
, 
szTaxID
);

275 
	}
}

	@src/workload/tpce/egen/Random.cpp

37 
	~"wÜklßd/û/eg’/EG’Ut™›s_¡dafx.h
"

39 
usšg
 
Çme¥aû
 
	gTPCE
;

41 
šlše
 
RNGSEED
 
	gCRªdom
::
	$UIÁ64Rªd
(){

43 
UINT64
 
a
 = (UINT64è
UIÁ64Rªd_A_MULTIPLIER
;

44 
UINT64
 
c
 = (UINT64è
UIÁ64Rªd_C_INCREMENT
;

45 
m_£ed
 = (m_£ed * 
a
 + 
c
);

47  (
m_£ed
);

48 
	}
}

50 
RNGSEED
 
	gCRªdom
::
	$RndNthEËm’t
Ğ
RNGSEED
 
nS“d
, RNGSEED 
nCouÁ
) {

51 
UINT64
 
a
 = 
UIÁ64Rªd_A_MULTIPLIER
;

52 
UINT64
 
c
 = 
UIÁ64Rªd_C_INCREMENT
;

53 
nB™
;

54 
UINT64
 
Apow
 = 
a
;

55 
UINT64
 
Dsum
 = 
UIÁ64Rªd_ONE
;

58 ifĞ
nCouÁ
 == 0 ) {

59  
nS“d
;

76  
nB™
 = 0; (
nCouÁ
 >>‚B™è!ğ
UIÁ64Rªd_ONE
 ;‚Bit ++){}

79  --
nB™
 >= 0 ) {

80 
Dsum
 *ğ(
Apow
 + 1);

81 
Apow
 = Apow * Apow;

82 ifĞ((
nCouÁ
 >> 
nB™
) % 2) == 1 ) {

83 
Dsum
 +ğ
Apow
;

84 
Apow
 *ğ
a
;

87 
nS“d
 =‚S“d * 
Apow
 + 
Dsum
 * 
c
;

88  
nS“d
;

89 
	}
}

91 
	gCRªdom
::
	$CRªdom
()

95 
m_£ed
 = (
RNGSEED
è
	`time
(
NULL
);

96 } 
m_£ed
 == 0);

97 
	}
}

99 
	gCRªdom
::
	$CRªdom
(
RNGSEED
 
£ed
)

101 
	`S‘S“d
(
£ed
);

102 
	}
}

104 
	gCRªdom
::
	$S‘S“d
(
RNGSEED
 
£ed
)

106 
m_£ed
 = 
£ed
;

107 
	}
}

109 #ifdeà
EGEN_USE_DEPRECATED_CODE


114 
	gCRªdom
::
	$RndDoubË
()

116  (()
	`UIÁ64Rªd
()è* (è
UIÁ64Rªd_RECIPROCAL_2_POWER_64
;

117 
	}
}

121 
	gCRªdom
::
	$RndIÁRªge
(
mš
, 
max
)

123 iàĞ
max
 <ğ
mš
 )

124  
mš
;

126 
UINT
 
¿nge
 = (
max
 - 
mš
 + 1);

128 iàĞ
¿nge
 <= 1 )

129  
mš
;

131 
	`UIÁ64Rªd
();

133  (
mš
 + ()
	`Mul6432W™hShiáRight64
(
m_£ed
,
¿nge
));

134 
	}
}

136 
INT64
 
	gCRªdom
::
	$RndIÁ64Rªge
(
INT64
 
mš
, INT64 
max
)

138 iàĞ
max
 <ğ
mš
 )

139  
mš
;

141 
UINT64
 
¿nge
 = (
max
 - 
mš
 + 1);

143 iàĞ
¿nge
 <= 1 )

144  
mš
;

146 
	`UIÁ64Rªd
();

148  (
mš
 + (
INT64
)
	`Mul6464W™hShiáRight64
(
m_£ed
,
¿nge
));

149 
	}
}

151 
	gCRªdom
::
	$RndNthIÁRªge
(
RNGSEED
 
S“d
, RNGSEED 
N
, 
mš
, 
max
)

153 iàĞ
max
 <ğ
mš
 )

154  
mš
;

156 
UINT
 
¿nge
 = (
max
 - 
mš
 + 1);

158 iàĞ
¿nge
 <= 1 )

159  
mš
;

161 
RNGSEED
 
n£ed
 = 
	`RndNthEËm’t
(
S“d
, 
N
);

163  (
mš
 + ()
	`Mul6432W™hShiáRight64
(
n£ed
, 
¿nge
));

164 
	}
}

167 
INT64
 
	gCRªdom
::
	$RndNthIÁ64Rªge
(
RNGSEED
 
S“d
, RNGSEED 
N
, 
INT64
 
mš
, INT64 
max
)

169 iàĞ
max
 <ğ
mš
 )

170  
mš
;

172 
UINT64
 
¿nge
 = (
max
 - 
mš
 + 1);

174 iàĞ
¿nge
 <= 1 )

175  
mš
;

177 
RNGSEED
 
n£ed
 = 
	`RndNthEËm’t
(
S“d
, 
N
);

179  (
mš
 + (
INT64
)
	`Mul6464W™hShiáRight64
(
n£ed
,
¿nge
));

180 
	}
}

182 
	gCRªdom
::
	$RndIÁRªgeExşude
(
low
, 
high
, 
exşude
)

184 
‹mp
;

186 
‹mp
 = 
	`RndIÁRªge
Ğ
low
, 
high
-1 );

187 ià(
‹mp
 >ğ
exşude
)

188 
‹mp
 += 1;

190  
‹mp
;

191 
	}
}

193 
INT64
 
	gCRªdom
::
	$RndIÁ64RªgeExşude
(
INT64
 
low
, INT64 
high
, INT64 
exşude
)

195 
INT64
 
‹mp
;

197 
‹mp
 = 
	`RndIÁ64Rªge
Ğ
low
, 
high
-1 );

198 ià(
‹mp
 >ğ
exşude
)

199 
‹mp
 += 1;

201  
‹mp
;

202 
	}
}

204 #ifdeà
EGEN_USE_DEPRECATED_CODE


206 
	gCRªdom
::
	$RndDoubËRªge
(
mš
, 
max
)

208  
mš
 + 
	`RndDoubË
(è* (
max
 - min);

209 
	}
}

213 
	gCRªdom
::
	$RndDoubËInüRªge
(
mš
, 
max
, 
šü
)

215 
INT64
 
width
 = (INT64)((
max
 - 
mš
è/ 
šü
);

216  
mš
 + (()
	`RndIÁ64Rªge
(0, 
width
è* 
šü
);

217 
	}
}

220 
	gCRªdom
::
	$RndDoubËNegExp
(
m—n
)

222  ((-1.0 * 
	`log
(
	`RndDoubËInüRªge
(0.0, 1.0, 0.000000000001))è* 
m—n
);

223 
	}
}

246 
INT64
 
	gCRªdom
::
	$NURnd
Ğ
INT64
 
P
, INT64 
Q
, 
INT32
 
A
, INT32 
s
 )

249  ((Ğ
	`RndIÁ64Rªge
Ğ
P
, 
Q
 ) | (RndIÁ64RªgeĞ0, 
A
 ) << 
s
 )) % (Q - P + 1) ) + P );

250 
	}
}

257 
	gCRªdom
::
	$RndAÍhaNumFÜm©‹d
(*
szR‘uºSŒšg
, cÚ¡ *
szFÜm©
)

259 
szFÜm©
 && *szFormat)

261 *
szFÜm©
)

263 'a': *
szR‘uºSŒšg
 = 
Uµ”Ca£L‘‹rs
[ 
	`RndIÁRªge
( 0, 25 ) ];

265 'n': *
szR‘uºSŒšg
 = 
Num”®s
[ 
	`RndIÁRªge
( 0, 9 ) ];

268 *
szR‘uºSŒšg
 = *
szFÜm©
;

271 ++
szFÜm©
;

272 ++
szR‘uºSŒšg
;

274 *
szR‘uºSŒšg
 = '\0';

275 
	}
}

	@src/workload/tpce/egen/ReadRowFunctions.cpp

42 #ifdeà
READROW_SSCANF


43 
	~"R—dRowFunùiÚs_ssÿnf.ıp
"

45 
	~"R—dRowFunùiÚs_i¡»am.ıp
"

	@src/workload/tpce/egen/ReadRowFunctions_istream.cpp

41 
	~"wÜklßd/û/eg’/EG’TabËs_¡dafx.h
"

43 
usšg
 
Çme¥aû
 
	gTPCE
;

48 
	gTAccouÁNameIÅutRow
::
	$Lßd
(
i¡»am
 &
fe
)

51 
fe
>>
ws
;

52 
fe
.
	`g‘
(
NAME
, (NAME), '\n');

53 
	}
}

59 
	gTA»aCodeIÅutRow
::
	$Lßd
(
i¡»am
 &
fe
)

61 
fe
>>
AREA_CODE
;

62 
	}
}

64 
	gTCom·nyIÅutRow
::
	$Lßd
(
i¡»am
 &
fe
)

66 
fe
>>
CO_ID
;

67 
fe
>>
CO_ST_ID
>>
ws
;

68 
fe
.
	`g‘
(
CO_NAME
, (CO_NAME), '\t');

69 
fe
>>
CO_IN_ID
>>
ws
;

70 
fe
.
	`g‘
(
CO_DESC
, (CO_DESC), '\n');

71 
	}
}

76 
	gTCom·nyCom³t™ÜIÅutRow
::
	$Lßd
(
i¡»am
 &
fe
)

78 
fe
>>
ws
;

79 
fe
>>
CP_CO_ID
;

80 
fe
>>
ws
;

81 
fe
>>
CP_COMP_CO_ID
;

82 
fe
>>
ws
;

83 
fe
.
	`g‘
(
CP_IN_ID
, (CP_IN_ID), '\n');

84 
	}
}

89 
	gTCom·nySPR©eIÅutRow
::
	$Lßd
(
i¡»am
 &
fe
)

91 
fe
>>
ws
;

92 
fe
.
	`g‘
Ğ
CO_SP_RATE
, ( CO_SP_RATE ), '\n' );

93 
	}
}

99 
	gTFœ¡NameIÅutRow
::
	$Lßd
(
i¡»am
 &
fe
)

101 
fe
>>
FIRST_NAME
;

102 
	}
}

104 
	gTLa¡NameIÅutRow
::
	$Lßd
(
i¡»am
 &
fe
)

106 
fe
>>
LAST_NAME
;

107 
	}
}

109 
	gTNewsIÅutRow
::
	$Lßd
(
i¡»am
 &
fe
)

111 
fe
>>
WORD
;

112 
	}
}

114 
	gTSecur™yIÅutRow
::
	$Lßd
(
i¡»am
 &
fe
)

116 
fe
>>
S_ID
;

117 
fe
>>
S_ST_ID
>>
ws
;

118 
fe
>>
S_SYMB
;

119 
fe
>>
S_ISSUE
;

120 
fe
>>
S_EX_ID
;

121 
fe
>>
S_CO_ID
;

122 
	}
}

127 
	gTSŒ“tNameIÅutRow
::
	$Lßd
(
i¡»am
 &
fe
)

129 
fe
>>
ws
;

130 
fe
.
	`g‘
(
STREET
, (STREET), '\n');

131 
	}
}

136 
	gTSŒ“tSuffixIÅutRow
::
	$Lßd
(
i¡»am
 &
fe
)

138 
fe
>>
ws
;

139 
fe
.
	`g‘
(
SUFFIX
, (SUFFIX), '\n');

140 
	}
}

145 
	gTTaxR©eIÅutRow
::
	$Lßd
(
i¡»am
 &
fe
)

147 
fe
>>
TAX_ID
;

148 
fe
>>
ws
;

149 
fe
.
	`g‘
(
TAX_NAME
, (TAX_NAME), '\t');

151 
fe
>>
TAX_RATE
;

152 
	}
}

157 
	gTZCodeIÅutRow
::
	$Lßd
(
i¡»am
 &
fe
)

159 
fe
>>
ws
;

160 
fe
>>
iDivisiÚTaxKey
;

161 
fe
>>
ws
;

162 
fe
.
	`g‘
Ğ
ZC_CODE
, ( ZC_CODE ), '\t' );

163 
fe
>>
ws
;

164 
fe
.
	`g‘
Ğ
ZC_TOWN
, ( ZC_TOWN ), '\t' );

165 
fe
>>
ws
;

166 
fe
.
	`g‘
Ğ
ZC_DIV
, ( ZC_DIV ), '\n' );

167 
	}
}

178 
	gCHARGE_ROW
::
	$Lßd
(
i¡»am
 &
fe
)

180 
fe
>>
CH_TT_ID
;

181 
fe
>>
CH_C_TIER
;

182 
fe
>>
CH_CHRG
;

183 
	}
}

188 
	gCOMMISSION_RATE_ROW
::
	$Lßd
(
i¡»am
 &
fe
)

190 
fe
>>
CR_C_TIER
;

191 
fe
>>
CR_TT_ID
;

192 
fe
>>
CR_EX_ID
;

193 
fe
>>
CR_FROM_QTY
;

194 
fe
>>
CR_TO_QTY
;

195 
fe
>>
CR_RATE
;

196 
	}
}

201 
	gEXCHANGE_ROW
::
	$Lßd
(
i¡»am
 &
fe
)

203 
fe
>>
ws
;

204 
fe
.
	`g‘
(
EX_ID
, (EX_ID), '\t');

205 
fe
>>
ws
;

206 
fe
.
	`g‘
(
EX_NAME
, (EX_NAME), '\t');

207 
fe
>>
ws
;

208 
fe
>>
EX_OPEN
;

209 
fe
>>
ws
;

210 
fe
>>
EX_CLOSE
;

211 
fe
>>
ws
;

212 
fe
.
	`g‘
(
EX_DESC
, (EX_DESC), '\t');

213 
fe
>>
ws
;

214 
fe
>>
EX_AD_ID
;

215 
	}
}

220 
	gINDUSTRY_ROW
::
	$Lßd
(
i¡»am
 &
fe
)

222 
fe
>>
IN_ID
>>
ws
;

223 
fe
.
	`g‘
(
IN_NAME
, (IN_NAME), '\t');

224 
fe
>>
ws
;

225 
fe
>>
IN_SC_ID
;

226 
	}
}

231 
	gSECTOR_ROW
::
	$Lßd
(
i¡»am
 &
fe
)

233 
fe
>>
SC_ID
>>
ws
;

234 
fe
.
	`g‘
(
SC_NAME
, (SC_NAME), '\n');

235 
	}
}

240 
	gSTATUS_TYPE_ROW
::
	$Lßd
(
i¡»am
 &
fe
)

242 
fe
>>
ws
;

243 
fe
>>
ST_ID
;

244 
fe
>>
ws
;

245 
fe
.
	`g‘
(
ST_NAME
, (ST_NAME), '\n');

246 
	}
}

251 
	gTRADE_TYPE_ROW
::
	$Lßd
(
i¡»am
 &
fe
)

253 
fe
>>
TT_ID
>>
ws
;

254 
fe
.
	`g‘
(
TT_NAME
, (TT_NAME), '\t');

255 
fe
>>
ws
;

256 
fe
>>
TT_IS_SELL
;

257 
fe
>>
TT_IS_MRKT
;

258 
	}
}

263 
	gZIP_CODE_ROW
::
	$Lßd
(
i¡»am
 &
fe
)

265 
fe
.
	`g‘
(
ZC_TOWN
, (ZC_TOWN), '\t');

266 
fe
>>
ZC_DIV
;

267 
fe
>>
ZC_CODE
;

268 
fe
>>
ws
;

269 
	}
}

	@src/workload/tpce/egen/ReadRowFunctions_sscanf.cpp

50 
	~<¡dexû±
>

51 
	~<s¡»am
>

52 
	~"wÜklßd/û/eg’/EG’TabËs_¡dafx.h
"

53 
	~"wÜklßd/û/eg’/IÅutFÏtFesDeş¬©iÚs.h
"

55 
usšg
 
Çme¥aû
 
	gTPCE
;

60 
	gTAccouÁNameIÅutRow
::
	$Lßd
(
i¡»am
 &
fe
)

62 
buf
[1024];

63 
fe
.
	`g‘lše
(
buf
, (buf));

64 ià(
fe
.
	`eof
()) {

67 
rc
 = 
	`ssÿnf
(
buf
, "\t%[^\n]",

68 
NAME
);

69 ià(
rc
 != 1) {

70 
¡d
::
o¡ršg¡»am
 
¡rm
;

71 
¡rm
 << "TAccouÁNameIÅutRow::Lßd oÆy†ßded " << 
rc
 << " values from†ine";

72 
throw
 
¡d
::
	`ruÁime_”rÜ
(
¡rm
.
	`¡r
());

76 
fe
>>
ws
;

77 
fe
.
	`g‘
(
NAME
, (NAME), '\n');

79 
	}
}

85 
	gTA»aCodeIÅutRow
::
	$Lßd
(
i¡»am
 &
fe
)

87 
buf
[1024];

88 
fe
.
	`g‘lše
(
buf
, (buf));

89 ià(
fe
.
	`eof
()) {

92 
rc
 = 
	`ssÿnf
(
buf
, "\t%[^\n]",

93 
AREA_CODE
);

94 ià(
rc
 != 1) {

95 
¡d
::
o¡ršg¡»am
 
¡rm
;

96 
¡rm
 << "TA»aCodeIÅutRow::Lßd oÆy†ßded " << 
rc
 << " values from†ine";

97 
throw
 
¡d
::
	`ruÁime_”rÜ
(
¡rm
.
	`¡r
());

100 
fe
>>
AREA_CODE
;

102 
	}
}

104 
	gTCom·nyIÅutRow
::
	$Lßd
(
i¡»am
 &
fe
)

106 
buf
[1024];

107 
fe
.
	`g‘lše
(
buf
, (buf));

108 ià(
fe
.
	`eof
()) {

111 
rc
 = 
	`ssÿnf
(
buf
, "%"
PRId64
"\t%s\t%[^\t]\t%s\t%[^\n]",

112 &
CO_ID
, 
CO_ST_ID
, 
CO_NAME
, 
CO_IN_ID
, 
CO_DESC
);

113 ià(
rc
 != 5) {

114 
¡d
::
o¡ršg¡»am
 
¡rm
;

115 
¡rm
 << "TCom·nyIÅutRow::Lßd oÆy†ßded " << 
rc
 << " values from†ine";

116 
throw
 
¡d
::
	`ruÁime_”rÜ
(
¡rm
.
	`¡r
());

119 
fe
>>
CO_ID
;

120 
fe
>>
CO_ST_ID
>>
ws
;

121 
fe
.
	`g‘
(
CO_NAME
, (CO_NAME), '\t');

122 
fe
>>
CO_IN_ID
>>
ws
;

123 
fe
.
	`g‘
(
CO_DESC
, (CO_DESC), '\n');

125 
	}
}

130 
	gTCom·nyCom³t™ÜIÅutRow
::
	$Lßd
(
i¡»am
 &
fe
)

132 
buf
[1024];

133 
fe
.
	`g‘lše
(
buf
, (buf));

134 ià(
fe
.
	`eof
()) {

137 
rc
 = 
	`ssÿnf
(
buf
, "%"
PRId64
"\t%"PRId64"\t%[^\n]",

138 &
CP_CO_ID
, &
CP_COMP_CO_ID
, 
CP_IN_ID
);

139 ià(
rc
 != 3) {

140 
¡d
::
o¡ršg¡»am
 
¡rm
;

141 
¡rm
 << "TCom·nyCom³t™ÜIÅutRow::Lßd oÆy†ßded " << 
rc
 << " values from†ine";

142 
throw
 
¡d
::
	`ruÁime_”rÜ
(
¡rm
.
	`¡r
());

145 
fe
>>
ws
;

146 
fe
>>
CP_CO_ID
;

147 
fe
>>
ws
;

148 
fe
>>
CP_COMP_CO_ID
;

149 
fe
>>
ws
;

150 
fe
.
	`g‘
(
CP_IN_ID
, (CP_IN_ID), '\n');

152 
	}
}

157 
	gTCom·nySPR©eIÅutRow
::
	$Lßd
(
i¡»am
 &
fe
)

159 
buf
[1024];

160 
fe
.
	`g‘lše
(
buf
, (buf));

161 ià(
fe
.
	`eof
()) {

164 
rc
 = 
	`ssÿnf
(
buf
, "\t%[^\n]",

165 
CO_SP_RATE
);

166 ià(
rc
 != 1) {

167 
¡d
::
o¡ršg¡»am
 
¡rm
;

168 
¡rm
 << "TCom·nySPR©eIÅutRow::Lßd oÆy†ßded " << 
rc
 << " values from†ine";

169 
throw
 
¡d
::
	`ruÁime_”rÜ
(
¡rm
.
	`¡r
());

172 
fe
>>
ws
;

173 
fe
.
	`g‘
Ğ
CO_SP_RATE
, ( CO_SP_RATE ), '\n' );

175 
	}
}

181 
	gTFœ¡NameIÅutRow
::
	$Lßd
(
i¡»am
 &
fe
)

183 
buf
[1024];

184 
fe
.
	`g‘lše
(
buf
, (buf));

185 ià(
fe
.
	`eof
()) {

188 
rc
 = 
	`ssÿnf
(
buf
, "\t%[^\n]",

189 
FIRST_NAME
);

190 ià(
rc
 != 1) {

191 
¡d
::
o¡ršg¡»am
 
¡rm
;

192 
¡rm
 << "TFœ¡NameIÅutRow::Lßd oÆy†ßded " << 
rc
 << " values from†ine";

193 
throw
 
¡d
::
	`ruÁime_”rÜ
(
¡rm
.
	`¡r
());

196 
fe
>>
FIRST_NAME
;

198 
	}
}

200 
	gTLa¡NameIÅutRow
::
	$Lßd
(
i¡»am
 &
fe
)

202 
buf
[1024];

203 
fe
.
	`g‘lše
(
buf
, (buf));

204 ià(
fe
.
	`eof
()) {

207 
rc
 = 
	`ssÿnf
(
buf
, "\t%[^\n]",

208 
LAST_NAME
);

209 ià(
rc
 != 1) {

210 
¡d
::
o¡ršg¡»am
 
¡rm
;

211 
¡rm
 << "TLa¡NameIÅutRow::Lßd oÆy†ßded " << 
rc
 << " values from†ine";

212 
throw
 
¡d
::
	`ruÁime_”rÜ
(
¡rm
.
	`¡r
());

215 
fe
>>
LAST_NAME
;

217 
	}
}

219 
	gTNewsIÅutRow
::
	$Lßd
(
i¡»am
 &
fe
)

221 
buf
[1024];

222 
fe
.
	`g‘lše
(
buf
, (buf));

223 ià(
fe
.
	`eof
()) {

226 
rc
 = 
	`ssÿnf
(
buf
, "\t%[^\n]",

227 
WORD
);

228 ià(
rc
 != 1) {

229 
¡d
::
o¡ršg¡»am
 
¡rm
;

230 
¡rm
 << "TNewsIÅutRow::Lßd oÆy†ßded " << 
rc
 << " values from†ine";

231 
throw
 
¡d
::
	`ruÁime_”rÜ
(
¡rm
.
	`¡r
());

234 
fe
>>
WORD
;

236 
	}
}

238 
	gTSecur™yIÅutRow
::
	$Lßd
(
i¡»am
 &
fe
)

240 
buf
[1024];

241 
fe
.
	`g‘lše
(
buf
, (buf));

242 ià(
fe
.
	`eof
()) {

245 
rc
 = 
	`ssÿnf
(
buf
, "%"
PRId64
"\t%s\t%s\t%s\t%s\t%"PRId64,

246 &
S_ID
, 
S_ST_ID
, 
S_SYMB
, 
S_ISSUE
, 
S_EX_ID
, &
S_CO_ID
);

247 ià(
rc
 != 6) {

248 
¡d
::
o¡ršg¡»am
 
¡rm
;

249 
¡rm
 << "TSecur™yIÅutRow::Lßd oÆy†ßded " << 
rc
 << " values from†ine";

250 
throw
 
¡d
::
	`ruÁime_”rÜ
(
¡rm
.
	`¡r
());

253 
fe
>>
S_ID
;

254 
fe
>>
S_ST_ID
>>
ws
;

255 
fe
>>
S_SYMB
;

256 
fe
>>
S_ISSUE
;

257 
fe
>>
S_EX_ID
;

258 
fe
>>
S_CO_ID
;

260 
	}
}

265 
	gTSŒ“tNameIÅutRow
::
	$Lßd
(
i¡»am
 &
fe
)

267 
buf
[1024];

268 
fe
.
	`g‘lše
(
buf
, (buf));

269 ià(
fe
.
	`eof
()) {

272 
rc
 = 
	`ssÿnf
(
buf
, "\t%[^\n]",

273 
STREET
);

274 ià(
rc
 != 1) {

275 
¡d
::
o¡ršg¡»am
 
¡rm
;

276 
¡rm
 << "TSŒ“tNameIÅutRow::Lßd oÆy†ßded " << 
rc
 << " values from†ine";

277 
throw
 
¡d
::
	`ruÁime_”rÜ
(
¡rm
.
	`¡r
());

280 
fe
>>
ws
;

281 
fe
.
	`g‘
(
STREET
, (STREET), '\n');

283 
	}
}

288 
	gTSŒ“tSuffixIÅutRow
::
	$Lßd
(
i¡»am
 &
fe
)

290 
buf
[1024];

291 
fe
.
	`g‘lše
(
buf
, (buf));

292 ià(
fe
.
	`eof
()) {

295 
rc
 = 
	`ssÿnf
(
buf
, "\t%[^\n]",

296 
SUFFIX
);

297 ià(
rc
 != 1) {

298 
¡d
::
o¡ršg¡»am
 
¡rm
;

299 
¡rm
 << "TSŒ“tSuffixIÅutRow::Lßd oÆy†ßded " << 
rc
 << " values from†ine";

300 
throw
 
¡d
::
	`ruÁime_”rÜ
(
¡rm
.
	`¡r
());

303 
fe
>>
ws
;

304 
fe
.
	`g‘
(
SUFFIX
, (SUFFIX), '\n');

306 
	}
}

311 
	gTTaxR©eIÅutRow
::
	$Lßd
(
i¡»am
 &
fe
)

313 
buf
[1024];

314 
fe
.
	`g‘lše
(
buf
, (buf));

315 ià(
fe
.
	`eof
()) {

318 
rc
 = 
	`ssÿnf
(
buf
, "\t%[^\t]\t%[^\t]\t%lf",

319 
TAX_ID
, 
TAX_NAME
, &
TAX_RATE
);

320 ià(
rc
 != 3) {

321 
¡d
::
o¡ršg¡»am
 
¡rm
;

322 
¡rm
 << "TTaxR©eIÅutRow::Lßd oÆy†ßded " << 
rc
 << " values from†ine";

323 
throw
 
¡d
::
	`ruÁime_”rÜ
(
¡rm
.
	`¡r
());

326 
fe
>>
TAX_ID
;

327 
fe
>>
ws
;

328 
fe
.
	`g‘
(
TAX_NAME
, (TAX_NAME), '\t');

330 
fe
>>
TAX_RATE
;

332 
	}
}

337 
	gTZCodeIÅutRow
::
	$Lßd
(
i¡»am
 &
fe
)

339 
buf
[1024];

340 
fe
.
	`g‘lše
(
buf
, (buf));

341 ià(
fe
.
	`eof
()) {

344 
rc
 = 
	`ssÿnf
(
buf
, "%d\t%[^\t]\t%[^\t]\t%[^\n]",

345 &
iDivisiÚTaxKey
, 
ZC_CODE
, 
ZC_TOWN
, 
ZC_DIV
);

346 ià(
rc
 != 4) {

347 
¡d
::
o¡ršg¡»am
 
¡rm
;

348 
¡rm
 << "TZCodeIÅutRow::Lßd oÆy†ßded " << 
rc
 << " values from†ine";

349 
throw
 
¡d
::
	`ruÁime_”rÜ
(
¡rm
.
	`¡r
());

352 
fe
>>
ws
;

353 
fe
>>
iDivisiÚTaxKey
;

354 
fe
>>
ws
;

355 
fe
.
	`g‘
Ğ
ZC_CODE
, ( ZC_CODE ), '\t' );

356 
fe
>>
ws
;

357 
fe
.
	`g‘
Ğ
ZC_TOWN
, ( ZC_TOWN ), '\t' );

358 
fe
>>
ws
;

359 
fe
.
	`g‘
Ğ
ZC_DIV
, ( ZC_DIV ), '\n' );

361 
	}
}

372 
	gCHARGE_ROW
::
	$Lßd
(
i¡»am
 &
fe
)

374 
buf
[1024];

375 
fe
.
	`g‘lše
(
buf
, (buf));

376 ià(
fe
.
	`eof
()) {

379 
rc
 = 
	`ssÿnf
(
buf
, "\t%[^\t]\t%d\t%lf",

380 
CH_TT_ID
, &
CH_C_TIER
, &
CH_CHRG
);

381 ià(
rc
 != 3) {

382 
¡d
::
o¡ršg¡»am
 
¡rm
;

383 
¡rm
 << "CHARGE_ROW::Lßd oÆy†ßded " << 
rc
 << " values from†ine";

384 
throw
 
¡d
::
	`ruÁime_”rÜ
(
¡rm
.
	`¡r
());

387 
fe
>>
CH_TT_ID
;

388 
fe
>>
CH_C_TIER
;

389 
fe
>>
CH_CHRG
;

391 
	}
}

396 
	gCOMMISSION_RATE_ROW
::
	$Lßd
(
i¡»am
 &
fe
)

398 
buf
[1024];

399 
fe
.
	`g‘lše
(
buf
, (buf));

400 ià(
fe
.
	`eof
()) {

403 
rc
 = 
	`ssÿnf
(
buf
, "%d\t%[^\t]\t%[^\t]\t%lf\t%lf\t%lf",

404 &
CR_C_TIER
, 
CR_TT_ID
, 
CR_EX_ID
, &
CR_FROM_QTY
, &
CR_TO_QTY
, &
CR_RATE
);

405 ià(
rc
 != 6) {

406 
¡d
::
o¡ršg¡»am
 
¡rm
;

407 
¡rm
 << "COMMISSION_RATE_ROW::Lßd oÆy†ßded " << 
rc
 << " values from†ine";

408 
throw
 
¡d
::
	`ruÁime_”rÜ
(
¡rm
.
	`¡r
());

411 
fe
>>
CR_C_TIER
;

412 
fe
>>
CR_TT_ID
;

413 
fe
>>
CR_EX_ID
;

414 
fe
>>
CR_FROM_QTY
;

415 
fe
>>
CR_TO_QTY
;

416 
fe
>>
CR_RATE
;

418 
	}
}

423 
	gEXCHANGE_ROW
::
	$Lßd
(
i¡»am
 &
fe
)

425 
buf
[1024];

426 
fe
.
	`g‘lše
(
buf
, (buf));

427 ià(
fe
.
	`eof
()) {

430 
rc
 = 
	`ssÿnf
(
buf
, "%[^\t]\t%[^\t]\t%d\t%d\t%[^\t]%"
PRId64
,

431 
EX_ID
, 
EX_NAME
, &
EX_OPEN
, &
EX_CLOSE
, 
EX_DESC
, &
EX_AD_ID
);

432 ià(
rc
 != 6) {

433 
¡d
::
o¡ršg¡»am
 
¡rm
;

434 
¡rm
 << "EXCHANGE_ROW::Lßd oÆy†ßded " << 
rc
 << " values from†ine";

435 
throw
 
¡d
::
	`ruÁime_”rÜ
(
¡rm
.
	`¡r
());

438 
fe
>>
ws
;

439 
fe
.
	`g‘
(
EX_ID
, (EX_ID), '\t');

440 
fe
>>
ws
;

441 
fe
.
	`g‘
(
EX_NAME
, (EX_NAME), '\t');

442 
fe
>>
ws
;

443 
fe
>>
EX_OPEN
;

444 
fe
>>
ws
;

445 
fe
>>
EX_CLOSE
;

446 
fe
>>
ws
;

447 
fe
.
	`g‘
(
EX_DESC
, (EX_DESC), '\t');

448 
fe
>>
ws
;

449 
fe
>>
EX_AD_ID
;

451 
	}
}

456 
	gINDUSTRY_ROW
::
	$Lßd
(
i¡»am
 &
fe
)

458 
buf
[1024];

459 
fe
.
	`g‘lše
(
buf
, (buf));

460 ià(
fe
.
	`eof
()) {

463 
rc
 = 
	`ssÿnf
(
buf
, "%[^\t]\t%[^\t]\t%[^\n]",

464 
IN_ID
, 
IN_NAME
, 
IN_SC_ID
);

465 ià(
rc
 != 3) {

466 
¡d
::
o¡ršg¡»am
 
¡rm
;

467 
¡rm
 << "INDUSTRY_ROW::Lßd oÆy†ßded " << 
rc
 << " values from†ine";

468 
throw
 
¡d
::
	`ruÁime_”rÜ
(
¡rm
.
	`¡r
());

471 
fe
>>
IN_ID
>>
ws
;

472 
fe
.
	`g‘
(
IN_NAME
, (IN_NAME), '\t');

473 
fe
>>
ws
;

474 
fe
>>
IN_SC_ID
;

476 
	}
}

481 
	gSECTOR_ROW
::
	$Lßd
(
i¡»am
 &
fe
)

483 
buf
[1024];

484 
fe
.
	`g‘lše
(
buf
, (buf));

485 ià(
fe
.
	`eof
()) {

488 
rc
 = 
	`ssÿnf
(
buf
, "%[^\t]\t%[^\n]",

489 
SC_ID
, 
SC_NAME
);

490 ià(
rc
 != 2) {

491 
¡d
::
o¡ršg¡»am
 
¡rm
;

492 
¡rm
 << "SECTOR_ROW::Lßd oÆy†ßded " << 
rc
 << " values from†ine";

493 
throw
 
¡d
::
	`ruÁime_”rÜ
(
¡rm
.
	`¡r
());

496 
fe
>>
SC_ID
>>
ws
;

497 
fe
.
	`g‘
(
SC_NAME
, (SC_NAME), '\n');

499 
	}
}

504 
	gSTATUS_TYPE_ROW
::
	$Lßd
(
i¡»am
 &
fe
)

506 
buf
[1024];

507 
fe
.
	`g‘lše
(
buf
, (buf));

508 ià(
fe
.
	`eof
()) {

511 
rc
 = 
	`ssÿnf
(
buf
, "%[^\t]\t%[^\n]",

512 
ST_ID
, 
ST_NAME
);

513 ià(
rc
 != 2) {

514 
¡d
::
o¡ršg¡»am
 
¡rm
;

515 
¡rm
 << "STATUS_TYPE_ROW::Lßd oÆy†ßded " << 
rc
 << " values from†ine";

516 
throw
 
¡d
::
	`ruÁime_”rÜ
(
¡rm
.
	`¡r
());

519 
fe
>>
ws
;

520 
fe
>>
ST_ID
;

521 
fe
>>
ws
;

522 
fe
.
	`g‘
(
ST_NAME
, (ST_NAME), '\n');

524 
	}
}

529 
	gTRADE_TYPE_ROW
::
	$Lßd
(
i¡»am
 &
fe
)

531 
buf
[1024];

532 
UINT
 
is_m¬k‘
;

533 
UINT
 
is_£Î
;

534 
fe
.
	`g‘lše
(
buf
, (buf));

535 ià(
fe
.
	`eof
()) {

538 
rc
 = 
	`ssÿnf
(
buf
, "%[^\t]\t%[^\t]\t%d\t%d",

539 
TT_ID
, 
TT_NAME
, &
is_£Î
, &
is_m¬k‘
);

543 
TT_IS_SELL
 = (
is_£Î
 =ğ1 ? 
Œue
 : 
çl£
);

544 
TT_IS_MRKT
 = (
is_m¬k‘
 =ğ1 ? 
Œue
 : 
çl£
);

545 ià(
rc
 != 4) {

546 
¡d
::
o¡ršg¡»am
 
¡rm
;

547 
¡rm
 << "TRADE_TYPE_ROW::Lßd oÆy†ßded " << 
rc
 << " values from†ine";

548 
throw
 
¡d
::
	`ruÁime_”rÜ
(
¡rm
.
	`¡r
());

551 
fe
>>
TT_ID
>>
ws
;

552 
fe
.
	`g‘
(
TT_NAME
, (TT_NAME), '\t');

553 
fe
>>
ws
;

554 
fe
>>
TT_IS_SELL
;

555 
fe
>>
TT_IS_MRKT
;

557 
	}
}

562 
	gZIP_CODE_ROW
::
	$Lßd
(
i¡»am
 &
fe
)

564 
buf
[1024];

565 
fe
.
	`g‘lše
(
buf
, (buf));

566 ià(
fe
.
	`eof
()) {

569 
rc
 = 
	`ssÿnf
(
buf
, "\t%[^\t]\t%[^\t]\t%[^\n]",

570 
ZC_TOWN
, 
ZC_DIV
, 
ZC_CODE
);

571 ià(
rc
 != 3) {

572 
¡d
::
o¡ršg¡»am
 
¡rm
;

573 
¡rm
 << "ZIP_CODE_ROW::Lßd oÆy†ßded " << 
rc
 << " values from†ine";

574 
throw
 
¡d
::
	`ruÁime_”rÜ
(
¡rm
.
	`¡r
());

577 
fe
.
	`g‘
(
ZC_TOWN
, (ZC_TOWN), '\t');

578 
fe
>>
ZC_DIV
;

579 
fe
>>
ZC_CODE
;

580 
fe
>>
ws
;

582 
	}
}

	@src/workload/tpce/egen/TradeGen.cpp

37 
	~"wÜklßd/û/eg’/EG’TabËs_¡dafx.h
"

39 
usšg
 
Çme¥aû
 
	gTPCE
;

43 cÚ¡ 
	giSecPriûP”iod
 = 15 * 
SecÚdsP”Mšu‹
;

46 cÚ¡ 
	giRNGSkOÃT¿de
 = 11;

50 
Çme¥aû
 
	gTPCE


54 
boŞ
 
	gİ”©Ü
 >(cÚ¡ 
	gTT¿deInfo
& 
	gl
, cÚ¡ TT¿deInfo& 
	gr
)

56  
	gl
.
	gCom¶‘iÚTime
 > 
	gr
.CompletionTime;

66 
	gCT¿deG’
::
	$CT¿deG’
(
CIÅutFes
 
šputFes
,

67 
TId’t
 
iCu¡om”CouÁ
,

68 
TId’t
 
iS¹FromCu¡om”
,

69 
TId’t
 
iTÙ®Cu¡om”s
,

70 
UINT
 
iLßdUn™Size
,

71 
UINT
 
iSÿËFaùÜ
,

72 
UINT
 
iHoursOfIn™ŸlT¿des
,

73 
boŞ
 
bCacheEÇbËd


75 : 
	`m_ºd
(
RNGS“dT¿deG’
)

76 , 
	`m_Add»ssTabË
(
šputFes
, 
iCu¡om”CouÁ
, 
iS¹FromCu¡om”
, 
Œue
, 
bCacheEÇbËd
)

77 , 
	`m_Cu¡om”S–eùiÚ
(&
m_ºd
, 0, 0, 100, 
iS¹FromCu¡om”
, 
iLßdUn™Size
)

78 , 
	`m_Cu¡om”TabË
(
šputFes
, 
iCu¡om”CouÁ
, 
iS¹FromCu¡om”
)

79 , 
	`m_Cu¡Tax¿‹TabË
(
šputFes
, 
iCu¡om”CouÁ
, 
iS¹FromCu¡om”
, 
bCacheEÇbËd
)

80 , 
	`m_Cu¡om”AccouÁTabË
(
šputFes
, 
iLßdUn™Size
, 
iCu¡om”CouÁ
, 
iS¹FromCu¡om”
, 
bCacheEÇbËd
)

81 , 
	`m_HŞdšgTabË
(
šputFes
, 
iLßdUn™Size
, 
iCu¡om”CouÁ
, 
iS¹FromCu¡om”
, 
bCacheEÇbËd
)

82 , 
	`m_Brok”TabË
(
šputFes
, 
iCu¡om”CouÁ
, 
iS¹FromCu¡om”
)

83 , 
	`m_Secur™yTabË
(
šputFes
, 
iCu¡om”CouÁ
, 
iS¹FromCu¡om”
)

84 , 
	`m_P”sÚ
(
šputFes
, 
iS¹FromCu¡om”
, 
bCacheEÇbËd
)

85 , 
	`m_Com·nyFe
(
šputFes
.
Com·ny
)

86 , 
	`m_Secur™yFe
(
šputFes
.
Secur™›s
)

87 , 
	`m_Ch¬geFe
(
šputFes
.
Ch¬ge
)

88 , 
	`m_CommissiÚR©eFe
(
šputFes
.
CommissiÚR©e
)

89 , 
	`m_StusTy³Fe
(
šputFes
.
StusTy³
)

90 , 
	`m_T¿deTy³Fe
(
šputFes
.
T¿deTy³
)

91 , 
	`m_ExchªgeFe
(
šputFes
.
Exchªge
)

92 , 
	`m_iS¹FromCu¡om”
(
iS¹FromCu¡om”
 + 
iTId’tShiá
)

93 , 
	`m_iCu¡om”CouÁ
(
iCu¡om”CouÁ
)

94 , 
	`m_iTÙ®Cu¡om”s
(
iTÙ®Cu¡om”s
)

95 , 
	`m_iLßdUn™Size
(
iLßdUn™Size
)

96 , 
	`m_iLßdUn™AccouÁCouÁ
(
iLßdUn™Size
 * 
iMaxAccouÁsP”Cu¡
)

97 , 
	`m_iSÿËFaùÜ
(
iSÿËFaùÜ
)

98 , 
	`m_iHoursOfIn™ŸlT¿des
(
iHoursOfIn™ŸlT¿des
)

99 , 
	`m_fM—nTimeB‘w“nT¿des
(100.0 / 
iAbÜtT¿de
 * ()
iSÿËFaùÜ
 / 
iLßdUn™Size
)

100 , 
	`m_fM—nInTheMÚeySubmissiÚD–ay
( 1.0 )

101 , 
	`m_Cu¼’tSimuÏ‹dTime
(0)

102 , 
	`m_iCu¼’tCom¶‘edT¿des
(0)

103 , 
	`m_iTÙ®T¿des
((
TT¿de
)
iHoursOfIn™ŸlT¿des
 * 
SecÚdsP”Hour
 * 
iLßdUn™Size
 / 
iSÿËFaùÜ
)

104 , 
	`m_iCu¼’tIn™Ÿ‹dT¿des
(0)

105 , 
	`m_iT¿desP”WÜkDay
(
HoursP”WÜkDay
 * 
SecÚdsP”Hour
 * 
iLßdUn™Size
 / 
iSÿËFaùÜ
 * 
iAbÜtT¿de
 / 100)

106 , 
	`m_MEESecur™y
()

107 , 
	`m_iCu¼’tAccouÁFÜHŞdšg
(0)

108 , 
	`m_iCu¼’tSecur™yFÜHŞdšg
(0)

109 , 
	`m_pCu¼’tSecur™yHŞdšg
()

110 , 
	`m_iCu¼’tAccouÁFÜHŞdšgSumm¬y
(0)

111 , 
	`m_iCu¼’tSecur™yFÜHŞdšgSumm¬y
(-1)

112 , 
	$m_iCu¼’tLßdUn™
(0)

114 
RNGSEED
 
RNGSkCouÁ
;

117 
m_S¹Time
.
	`S‘
(

118 
In™ŸlT¿dePİuÏtiÚBa£Y—r
,

119 
In™ŸlT¿dePİuÏtiÚBa£MÚth
,

120 
In™ŸlT¿dePİuÏtiÚBa£Day
,

121 
In™ŸlT¿dePİuÏtiÚBa£Hour
,

122 
In™ŸlT¿dePİuÏtiÚBa£Mšu‹
,

123 
In™ŸlT¿dePİuÏtiÚBa£SecÚd
,

124 
In™ŸlT¿dePİuÏtiÚBa£F¿ùiÚ
 );

128 
m_iS¹FromAccouÁ
 = 
m_Cu¡om”AccouÁTabË
.
	`G‘S¹šgCA_ID
(
m_iS¹FromCu¡om”
);

132 
m_pCu¡om”HŞdšgs
 = 
Ãw
 
THŞdšgLi¡
[ 
m_iLßdUn™AccouÁCouÁ
 ]

133 [ 
iMaxSecur™›sP”AccouÁ
 ];

137 
	`mem£t
(&
m_NewT¿de
, 0, (m_NewTrade));

138 
	`mem£t
(&
m_T¿deRow
, 0, (m_TradeRow));

139 
	`mem£t
(&
m_HŞdšgRow
, 0, (m_HoldingRow));

140 
	`mem£t
(&
m_HŞdšgSumm¬yRow
, 0, (m_HoldingSummaryRow));

144 
m_iCu¼’tT¿deId
 = (
TT¿de
)
m_iHoursOfIn™ŸlT¿des
 * 
SecÚdsP”Hour


145 * (
iS¹FromCu¡om”
 - 
iDeçuÉS¹FromCu¡om”
)

146 / 
m_iSÿËFaùÜ


147 * 
iAbÜtT¿de


148 / 100 + 
iTT¿deShiá
;

152 
m_Brok”TabË
.
	`In™FÜG’
(
iLßdUn™Size
, 
m_iS¹FromCu¡om”
 - 
iTId’tShiá
);

154 
RNGSkCouÁ
 =

155 (
RNGSEED
)(
m_iS¹FromCu¡om”
 / 
m_iLßdUn™Size
 * 
m_iTÙ®T¿des
);

157 
m_ºd
.
	`S‘S“d
(m_ºd.
	`RndNthEËm’t
(
RNGS“dT¿deG’
,

158 
RNGSkCouÁ
 * 
iRNGSkOÃT¿de
));

160 
m_HŞdšgTabË
.
	`In™NextLßdUn™
(
RNGSkCouÁ
, 
m_iS¹FromAccouÁ
);

163 
m_MEESecur™y
.
	`In™
Ğ0, 
NULL
, NULL, 
m_fM—nInTheMÚeySubmissiÚD–ay
 );

164 
	}
}

170 
	gCT¿deG’
::~
	$CT¿deG’
()

172 ià(
m_pCu¡om”HŞdšgs
 !ğ
NULL
)

174 
d–‘e
[] 
m_pCu¡om”HŞdšgs
;

176 
	}
}

188 
boŞ
 
	gCT¿deG’
::
	$In™NextLßdUn™
()

190 
RNGSEED
 
RNGSkCouÁ
;

192 ++
m_iCu¼’tLßdUn™
;

194 
m_iCu¼’tCom¶‘edT¿des
 = 0;

199 
d–‘e
[] 
m_pCu¡om”HŞdšgs
;

202 
m_pCu¡om”HŞdšgs
 = 
Ãw
 
THŞdšgLi¡
[ 
m_iLßdUn™AccouÁCouÁ
 ]

203 [ 
iMaxSecur™›sP”AccouÁ
 ];

204 
m_iCu¼’tAccouÁFÜHŞdšg
 = 0;

205 
m_iCu¼’tSecur™yFÜHŞdšg
 = 0;

207 
m_iCu¼’tAccouÁFÜHŞdšgSumm¬y
 = 0;

208 
m_iCu¼’tSecur™yFÜHŞdšgSumm¬y
 = -1;

210 
m_iS¹FromCu¡om”
 +ğ
m_iLßdUn™Size
;

212 
m_iS¹FromAccouÁ
 = 
m_Cu¡om”AccouÁTabË
.
	`G‘S¹šgCA_ID
(
m_iS¹FromCu¡om”
);

214 
m_Cu¼’tSimuÏ‹dTime
 = 0;

216 
m_iCu¼’tIn™Ÿ‹dT¿des
 = 0;

218 
m_Brok”TabË
.
	`In™FÜG’
(
m_iLßdUn™Size
, 
m_iS¹FromCu¡om”
 - 
iTId’tShiá
);

220 
RNGSkCouÁ
 =

221 (
RNGSEED
)(
m_iS¹FromCu¡om”
 / 
m_iLßdUn™Size
 * 
m_iTÙ®T¿des
);

223 
m_ºd
.
	`S‘S“d
(m_ºd.
	`RndNthEËm’t
(
RNGS“dT¿deG’
,

224 
RNGSkCouÁ
 * 
iRNGSkOÃT¿de
));

228 
m_Cu¡om”S–eùiÚ
.
	`S‘P¬t™iÚRªge
(
m_iS¹FromCu¡om”
, 
m_iLßdUn™Size
);

230 
m_HŞdšgTabË
.
	`In™NextLßdUn™
(
RNGSkCouÁ
, 
m_iS¹FromAccouÁ
);

232 
m_P”sÚ
.
	`In™NextLßdUn™
();

234 
m_Add»ssTabË
.
	`In™NextLßdUn™
();

236 
m_Cu¡om”AccouÁTabË
.
	`In™NextLßdUn™
();

238 
m_MEESecur™y
.
	`In™
Ğ0, 
NULL
, NULL, 
m_fM—nInTheMÚeySubmissiÚD–ay
 );

242 
	`mem£t
(&
m_T¿deRow
, 0, (m_TradeRow));

243 
	`mem£t
(&
m_HŞdšgRow
, 0, (m_HoldingRow));

244 
	`mem£t
(&
m_HŞdšgSumm¬yRow
, 0, (m_HoldingSummaryRow));

246  
m_iCu¼’tLßdUn™
 < (
m_iCu¡om”CouÁ
 / 
m_iLßdUn™Size
);

247 
	}
}

260 
boŞ
 
	gCT¿deG’
::
	$G’”©eNextT¿de
()

262 
boŞ
 
bMÜeT¿des
;

264 ià(
m_iCu¼’tCom¶‘edT¿des
 < 
m_iTÙ®T¿des
)

271  (
m_iCu¼’tCom¶‘edT¿des
 + ()
m_Cu¼’tT¿des
.
	`size
(è< 
m_iTÙ®T¿des
) &&

272 (
m_Cu¼’tT¿des
.
	`em±y
() ||

273 (
m_Cu¼’tSimuÏ‹dTime
 <

274 
m_Cu¼’tT¿des
.
	`tİ
().
Com¶‘iÚTime
)))

276 
m_Cu¼’tSimuÏ‹dTime
 = (
m_iCu¼’tIn™Ÿ‹dT¿des
 / 
m_iT¿desP”WÜkDay
)

277 * 
SecÚdsP”Day


279 + (
m_iCu¼’tIn™Ÿ‹dT¿des
 % 
m_iT¿desP”WÜkDay
)

280 * 
m_fM—nTimeB‘w“nT¿des


281 + 
	`G’”©eD–ayB‘w“nT¿des
();

286 
	`G’”©eNewT¿de
();

288 iàĞ
m_HŞdšgTabË
.
	`IsAbÜ‹dT¿de
(
m_iCu¼’tIn™Ÿ‹dT¿des
) )

296 
m_Cu¼’tT¿des
.
	`push
(
m_NewT¿de
);

303 
m_NewT¿de
 = 
m_Cu¼’tT¿des
.
	`tİ
();

307 
m_Cu¼’tT¿des
.
	`pİ
();

314 
	`Upd©eHŞdšgs
();

318 
	`G’”©eCom¶‘eT¿de
();

320 
bMÜeT¿des
 = 
m_iCu¼’tCom¶‘edT¿des
 < 
m_iTÙ®T¿des
;

325 
bMÜeT¿des
 = 
çl£
;

328 ià(
bMÜeT¿des
)

330  
Œue
;

337 
m_pCu¼’tSecur™yHŞdšg
 = 
m_pCu¡om”HŞdšgs
[
m_iCu¼’tAccouÁFÜHŞdšg
]

338 [
m_iCu¼’tSecur™yFÜHŞdšg
].
	`begš
();

339 
	`FšdNextHŞdšg
();

342 
	`FšdNextHŞdšgLi¡
();

344 
size_t
 
iSize
 = 
m_Cu¼’tT¿des
.
	`size
();

346 
	`as£¹
(
iSize
 == 0);

348  
çl£
;

350 
	}
}

363 
šlše
 
	gCT¿deG’
::
	$G’”©eD–ayB‘w“nT¿des
()

367  
m_ºd
.
	`RndDoubËInüRªge
(0.0, 
m_fM—nTimeB‘w“nT¿des
 - 0.001, 0.001);

368 
	}
}

377 
šlše
 
THŞdšgLi¡
* 
	gCT¿deG’
::
	$G‘HŞdšgLi¡FÜCu¼’tT¿de
()

379  &
m_pCu¡om”HŞdšgs
[
	`G‘Cu¼’tAccID
(è- 
m_iS¹FromAccouÁ
]

380 [
	`G‘Cu¼’tSecur™yAccouÁIndex
() - 1];

381 
	}
}

390 
	gli¡
<
	gTHŞdšgInfo
>::
™”©Ü
 
CT¿deG’
::
	$Pos™iÚAtHŞdšgLi¡
(

391 
THŞdšgLi¡
* 
pHŞdšgLi¡
,

392 
IsLifo
)

394 ià(
pHŞdšgLi¡
->
	`em±y
())

396  
pHŞdšgLi¡
->
	`’d
();

401 ià(
IsLifo
)

403  --(
pHŞdšgLi¡
->
	`’d
());

407  
pHŞdšgLi¡
->
	`begš
();

410 
	}
}

425 
	gCT¿deG’
::
	$Upd©eHŞdšgs
()

427 
THŞdšgLi¡
* 
pHŞdšgLi¡
;

428 
li¡
<
THŞdšgInfo
>::
™”©Ü
 
pHŞdšg
;

429 
iN“dedQty
 = 
	`G‘Cu¼’tT¿deQty
();

430 
iHŞdQty
;

432 
m_Com¶‘edT¿deInfo
.
fBuyV®ue
 = 0;

433 
m_Com¶‘edT¿deInfo
.
fS–lV®ue
 = 0;

437 
m_iHŞdšgHi¡ÜyRowCouÁ
 = 0;

439 
pHŞdšgLi¡
 = 
	`G‘HŞdšgLi¡FÜCu¼’tT¿de
();

441 
pHŞdšg
 = 
	`Pos™iÚAtHŞdšgLi¡
(
pHŞdšgLi¡
, 
	`G‘Cu¼’tT¿deIsLifo
());

443 iàĞ
	`G‘Cu¼’tT¿deTy³
(è=ğ
eM¬k‘Buy


444 || 
	`G‘Cu¼’tT¿deTy³
(è=ğ
eLim™Buy
)

450 !
pHŞdšgLi¡
->
	`em±y
(è&& 
pHŞdšg
->
iT¿deQty
 < 0 && 
iN“dedQty
 > 0)

452 
iHŞdQty
 = 
pHŞdšg
->
iT¿deQty
;

454 
pHŞdšg
->
iT¿deQty
 +ğ
iN“dedQty
;

456 ià(
pHŞdšg
->
iT¿deQty
 > 0)

460 
pHŞdšg
->
iT¿deQty
 = 0;

462 
m_Com¶‘edT¿deInfo
.
fS–lV®ue
 +ğ-
iHŞdQty
 * 
pHŞdšg
->
fT¿dePriû
;

463 
m_Com¶‘edT¿deInfo
.
fBuyV®ue
 +ğ-
iHŞdQty
 * 
	`G‘Cu¼’tT¿dePriû
();

467 
m_Com¶‘edT¿deInfo
.
fS–lV®ue
 +ğ
iN“dedQty
 * 
pHŞdšg
->
fT¿dePriû
;

468 
m_Com¶‘edT¿deInfo
.
fBuyV®ue
 +ğ
iN“dedQty
 * 
	`G‘Cu¼’tT¿dePriû
();

471 
	`G’”©eHŞdšgHi¡ÜyRow
(
pHŞdšg
->
iT¿deId
, 
	`G‘Cu¼’tT¿deID
(),

472 
iHŞdQty
, 
pHŞdšg
->
iT¿deQty
);

474 ià(
pHŞdšg
->
iT¿deQty
 == 0)

478 
pHŞdšg
 = 
pHŞdšgLi¡
->
	`”a£
(pHolding);

483 
pHŞdšg
 = 
	`Pos™iÚAtHŞdšgLi¡
(
pHŞdšgLi¡
, 
	`G‘Cu¼’tT¿deIsLifo
());

485 
iN“dedQty
 +ğ
iHŞdQty
;

488 ià(
iN“dedQty
 > 0)

492 
THŞdšgInfo
 
NewHŞdšg
 = { 
	`G‘Cu¼’tT¿deID
(),

493 
iN“dedQty
,

494 
	`G‘Cu¼’tT¿dePriû
(),

495 
	`G‘Cu¼’tT¿deCom¶‘iÚTime
(),

496 
	`G‘Cu¼’tSecur™yIndex
()

506 
pHŞdšgLi¡
->
	`push_back
(
NewHŞdšg
);

508 
	`G’”©eHŞdšgHi¡ÜyRow
(
	`G‘Cu¼’tT¿deID
(), GetCurrentTradeID(),

509 0, 
iN“dedQty
);

520 !
pHŞdšgLi¡
->
	`em±y
(è&& 
pHŞdšg
->
iT¿deQty
 > 0 && 
iN“dedQty
 > 0)

522 
iHŞdQty
 = 
pHŞdšg
->
iT¿deQty
;

524 
pHŞdšg
->
iT¿deQty
 -ğ
iN“dedQty
;

526 ià(
pHŞdšg
->
iT¿deQty
 < 0)

530 
pHŞdšg
->
iT¿deQty
 = 0;

532 
m_Com¶‘edT¿deInfo
.
fS–lV®ue
 +ğ
iHŞdQty
 * 
	`G‘Cu¼’tT¿dePriû
();

533 
m_Com¶‘edT¿deInfo
.
fBuyV®ue
 +ğ
iHŞdQty
 * 
pHŞdšg
->
fT¿dePriû
;

537 
m_Com¶‘edT¿deInfo
.
fS–lV®ue
 +ğ
iN“dedQty
 * 
	`G‘Cu¼’tT¿dePriû
();

538 
m_Com¶‘edT¿deInfo
.
fBuyV®ue
 +ğ
iN“dedQty
 * 
pHŞdšg
->
fT¿dePriû
;

541 
	`G’”©eHŞdšgHi¡ÜyRow
(
pHŞdšg
->
iT¿deId
, 
	`G‘Cu¼’tT¿deID
(),

542 
iHŞdQty
, 
pHŞdšg
->
iT¿deQty
);

544 ià(
pHŞdšg
->
iT¿deQty
 == 0)

548 
pHŞdšg
 = 
pHŞdšgLi¡
->
	`”a£
(pHolding);

553 
pHŞdšg
 = 
	`Pos™iÚAtHŞdšgLi¡
(
pHŞdšgLi¡
, 
	`G‘Cu¼’tT¿deIsLifo
());

555 
iN“dedQty
 -ğ
iHŞdQty
;

558 ià(
iN“dedQty
 > 0)

562 
THŞdšgInfo
 
NewHŞdšg
 = { 
	`G‘Cu¼’tT¿deID
(),

563 -
iN“dedQty
,

564 
	`G‘Cu¼’tT¿dePriû
(),

565 
	`G‘Cu¼’tT¿deCom¶‘iÚTime
(),

566 
	`G‘Cu¼’tSecur™yIndex
()

576 
pHŞdšgLi¡
->
	`push_back
(
NewHŞdšg
);

578 
	`G’”©eHŞdšgHi¡ÜyRow
(
	`G‘Cu¼’tT¿deID
(), GetCurrentTradeID(),

579 0, -
iN“dedQty
);

583 
	}
}

591 
boŞ
 
	gCT¿deG’
::
	$FšdNextHŞdšgLi¡
()

593 
THŞdšgLi¡
* 
pHŞdšgLi¡
;

599 
m_iCu¼’tSecur™yFÜHŞdšgSumm¬y
++;

600 ià(
m_iCu¼’tSecur™yFÜHŞdšgSumm¬y
 =ğ
iMaxSecur™›sP”AccouÁ
)

605 
m_iCu¼’tAccouÁFÜHŞdšgSumm¬y
++;

606 
m_iCu¼’tSecur™yFÜHŞdšgSumm¬y
 = 0;

608 ià(
m_iCu¼’tAccouÁFÜHŞdšgSumm¬y
 =ğ
m_iLßdUn™AccouÁCouÁ
)

612  
çl£
;

618 
pHŞdšgLi¡
 = &
m_pCu¡om”HŞdšgs
[
m_iCu¼’tAccouÁFÜHŞdšgSumm¬y
]

619 [
m_iCu¼’tSecur™yFÜHŞdšgSumm¬y
];

620 } 
pHŞdšgLi¡
->
	`em±y
());

622  
Œue
;

623 
	}
}

632 
boŞ
 
	gCT¿deG’
::
	$FšdNextHŞdšg
()

634 
THŞdšgLi¡
* 
pHŞdšgLi¡
;

636 
pHŞdšgLi¡
 = &
m_pCu¡om”HŞdšgs
[
m_iCu¼’tAccouÁFÜHŞdšg
]

637 [
m_iCu¼’tSecur™yFÜHŞdšg
];

643 ià(
m_pCu¼’tSecur™yHŞdšg
 =ğ
pHŞdšgLi¡
->
	`’d
())

647 ++
m_iCu¼’tSecur™yFÜHŞdšg
;

649 ià(
m_iCu¼’tSecur™yFÜHŞdšg
 =ğ
iMaxSecur™›sP”AccouÁ
)

654 ++
m_iCu¼’tAccouÁFÜHŞdšg
;

656 
m_iCu¼’tSecur™yFÜHŞdšg
 = 0;

658 ià(
m_iCu¼’tAccouÁFÜHŞdšg
 =ğ
m_iLßdUn™AccouÁCouÁ
)

662  
çl£
;

668 
pHŞdšgLi¡
 = &
m_pCu¡om”HŞdšgs
[
m_iCu¼’tAccouÁFÜHŞdšg
]

669 [
m_iCu¼’tSecur™yFÜHŞdšg
];

672 
m_pCu¼’tSecur™yHŞdšg
 = 
pHŞdšgLi¡
->
	`begš
();

674 } 
m_pCu¼’tSecur™yHŞdšg
 =ğ
pHŞdšgLi¡
->
	`’d
());

676  
Œue
;

677 
	}
}

691 
boŞ
 
	gCT¿deG’
::
	$G’”©eNextHŞdšgSumm¬yRow
()

693 
TId’t
 
iSecur™yFÏtFeIndex
;

695 ià(
m_iCu¼’tAccouÁFÜHŞdšgSumm¬y
 < 
m_iLßdUn™AccouÁCouÁ
)

702 
m_HŞdšgSumm¬yRow
.
HS_CA_ID
 = 
m_iCu¼’tAccouÁFÜHŞdšgSumm¬y
 + 
m_iS¹FromAccouÁ
;

703 
iSecur™yFÏtFeIndex
 = 
m_HŞdšgTabË
.
	`G‘Secur™yFÏtFeIndex
(

704 
m_iCu¼’tAccouÁFÜHŞdšgSumm¬y
 + 
m_iS¹FromAccouÁ
,

705 (
UINT
)(
m_iCu¼’tSecur™yFÜHŞdšgSumm¬y
 + 1));

707 
m_Secur™yFe
->
	`C»©eSymbŞ
(
iSecur™yFÏtFeIndex
,

708 
m_HŞdšgSumm¬yRow
.
HS_S_SYMB
,

709 
¡©ic_ÿ¡
<>((
m_HŞdšgSumm¬yRow
.
HS_S_SYMB
)));

712 
THŞdšgLi¡
* 
pHŞdšgLi¡
;

713 
li¡
<
THŞdšgInfo
>::
™”©Ü
 
pHŞdšg
;

715 
pHŞdšgLi¡
 = &
m_pCu¡om”HŞdšgs
[
m_iCu¼’tAccouÁFÜHŞdšgSumm¬y
]

716 [
m_iCu¼’tSecur™yFÜHŞdšgSumm¬y
];

717 
pHŞdšg
 = 
pHŞdšgLi¡
->
	`begš
();

718 
m_HŞdšgSumm¬yRow
.
HS_QTY
 = 0;

720  
pHŞdšg
 !ğ
pHŞdšgLi¡
->
	`’d
() )

722 
m_HŞdšgSumm¬yRow
.
HS_QTY
 +ğ
pHŞdšg
->
iT¿deQty
;

723 
pHŞdšg
++;

726  
	`FšdNextHŞdšgLi¡
();

730  
çl£
;

732 
	}
}

740 
	gCT¿deG’
::
	$G’”©eHŞdšgHi¡ÜyRow
(

741 
TT¿de
 
iHŞdšgT¿deID
,

742 
TT¿de
 
iT¿deT¿deID
,

743 
iBefÜeQty
,

744 
iAá”Qty
)

746 ià(
m_iHŞdšgHi¡ÜyRowCouÁ
 < 
iMaxHŞdšgHi¡ÜyRowsP”T¿de
)

748 
m_T¿deRow
.
m_HŞdšgHi¡Üy
[
m_iHŞdšgHi¡ÜyRowCouÁ
].
HH_H_T_ID
 = 
iHŞdšgT¿deID
;

749 
m_T¿deRow
.
m_HŞdšgHi¡Üy
[
m_iHŞdšgHi¡ÜyRowCouÁ
].
HH_T_ID
 = 
iT¿deT¿deID
;

750 
m_T¿deRow
.
m_HŞdšgHi¡Üy
[
m_iHŞdšgHi¡ÜyRowCouÁ
].
HH_BEFORE_QTY
 = 
iBefÜeQty
;

751 
m_T¿deRow
.
m_HŞdšgHi¡Üy
[
m_iHŞdšgHi¡ÜyRowCouÁ
].
HH_AFTER_QTY
 = 
iAá”Qty
;

753 ++
m_iHŞdšgHi¡ÜyRowCouÁ
;

755 
	}
}

774 
boŞ
 
	gCT¿deG’
::
	$G’”©eNextHŞdšg
()

776 
TId’t
 
iSecur™yFÏtFeIndex
;

778 ià(
m_iCu¼’tAccouÁFÜHŞdšg
 < 
m_iLßdUn™AccouÁCouÁ
)

784 
m_HŞdšgRow
.
H_CA_ID
 = 
m_iCu¼’tAccouÁFÜHŞdšg
 + 
m_iS¹FromAccouÁ
;

789 
iSecur™yFÏtFeIndex
 = 
m_pCu¼’tSecur™yHŞdšg
->
iSymbŞIndex
;

791 
m_Secur™yFe
->
	`C»©eSymbŞ
(
iSecur™yFÏtFeIndex
,

792 
m_HŞdšgRow
.
H_S_SYMB
,

793 
¡©ic_ÿ¡
<>((
m_HŞdšgRow
.
H_S_SYMB
)));

795 
m_HŞdšgRow
.
H_T_ID
 = 
m_pCu¼’tSecur™yHŞdšg
->
iT¿deId
;

796 
m_HŞdšgRow
.
H_QTY
 = 
m_pCu¼’tSecur™yHŞdšg
->
iT¿deQty
;

797 
m_HŞdšgRow
.
H_PRICE
 = 
m_pCu¼’tSecur™yHŞdšg
->
fT¿dePriû
.
	`DŞÏrAmouÁ
();

798 
m_HŞdšgRow
.
H_DTS
 = 
m_pCu¼’tSecur™yHŞdšg
->
BuyDTS
;

805 ++
m_pCu¼’tSecur™yHŞdšg
;

809  
	`FšdNextHŞdšg
();

813  
çl£
;

815 
	}
}

825 
TT¿de
 
	gCT¿deG’
::
	$G’”©eNextT¿deId
()

827  ++
m_iCu¼’tT¿deId
;

828 
	}
}

838 
eT¿deTy³ID
 
	gCT¿deG’
::
	$G’”©eT¿deTy³
()

840 
eT¿deTy³ID
 
eT¿deTy³
;

846 
iLßdT¿deTy³Pù
 = 
m_ºd
.
	`RndG’”©eIÁeg”P”ûÁage
();

848 ifĞ
iLßdT¿deTy³Pù
 <ğ
cM¬k‘BuyLßdTh»shŞd
 )

850 
eT¿deTy³
 = 
eM¬k‘Buy
;

852 ifĞ
iLßdT¿deTy³Pù
 <ğ
cM¬k‘S–lLßdTh»shŞd
 )

854 
eT¿deTy³
 = 
eM¬k‘S–l
;

856 ifĞ
iLßdT¿deTy³Pù
 <ğ
cLim™BuyLßdTh»shŞd
 )

858 
eT¿deTy³
 = 
eLim™Buy
;

860 ifĞ
iLßdT¿deTy³Pù
 <ğ
cLim™S–lLßdTh»shŞd
 )

862 
eT¿deTy³
 = 
eLim™S–l
;

864 ifĞ
iLßdT¿deTy³Pù
 <ğ
cStİLossLßdTh»shŞd
 )

866 
eT¿deTy³
 = 
eStİLoss
;

870 
	`as£¹
(
çl£
);

873  
eT¿deTy³
;

874 
	}
}

886 
	gCT¿deG’
::
	$G’”©eNewT¿de
()

888 
m_NewT¿de
.
iT¿deId
 = 
	`G’”©eNextT¿deId
();

892 
m_Cu¡om”S–eùiÚ
.
	`G’”©eRªdomCu¡om”
(
m_NewT¿de
.
iCu¡om”
, m_NewT¿de.
iCu¡om”T›r
);

896 
m_HŞdšgTabË
.
	`G’”©eRªdomAccouÁSecur™y
(

897 
m_NewT¿de
.
iCu¡om”
,

898 
m_NewT¿de
.
iCu¡om”T›r
,

899 &
m_NewT¿de
.
iCu¡om”AccouÁ
,

900 &
m_NewT¿de
.
iSymbŞIndex
,

901 &
m_NewT¿de
.
iSymbŞIndexInAccouÁ
);

903 
m_NewT¿de
.
eT¿deTy³
 = 
	`G’”©eT¿deTy³
();

907 
m_NewT¿de
.
eT¿deStus
 = 
eCom¶‘ed
;

909 
m_NewT¿de
.
fBidPriû
 = 
m_ºd
.
	`RndDoubËInüRªge
(
fMšSecPriû
, 
fMaxSecPriû
, 0.01);

911 
m_NewT¿de
.
iT¿deQty
 = 
cTRADE_QTY_SIZES
[
m_ºd
.
	`RndIÁRªge
Ğ0, 
cNUM_TRADE_QTY_SIZES
-1 )];

913 ià(
m_NewT¿de
.
eT¿deTy³
 =ğ
eM¬k‘Buy
 ||

914 
m_NewT¿de
.
eT¿deTy³
 =ğ
eM¬k‘S–l
)

917 
m_NewT¿de
.
SubmissiÚTime
 = 
m_Cu¼’tSimuÏ‹dTime
;

921 
m_NewT¿de
.
fBidPriû
 = 
m_MEESecur™y
.
	`C®cuÏ‹Priû
Ğm_NewT¿de.
iSymbŞIndex
, 
m_Cu¼’tSimuÏ‹dTime
 );

926 
m_NewT¿de
.
P’dšgTime
 = 
m_Cu¼’tSimuÏ‹dTime
;

928 
m_NewT¿de
.
SubmissiÚTime
 = 
m_MEESecur™y
.

929 
	`G‘SubmissiÚTime
Ğ
m_NewT¿de
.
iSymbŞIndex
,

930 
m_NewT¿de
.
P’dšgTime
,

931 
m_NewT¿de
.
fBidPriû
,

932 
m_NewT¿de
.
eT¿deTy³
);

941 ià((((
INT32
)(
m_NewT¿de
.
SubmissiÚTime
 / 
SecÚdsP”Hour
)è% 
HoursP”Day
 =ğ
HoursP”WÜkDay
) &&

943 (
m_NewT¿de
.
SubmissiÚTime
 / 
SecÚdsP”Hour
) -

944 ((
INT32
)(
m_NewT¿de
.
SubmissiÚTime
 / 
SecÚdsP”Hour
)) > 0

948 
m_NewT¿de
.
SubmissiÚTime
 +ğ16 * 
SecÚdsP”Hour
;

954 
m_NewT¿de
.
Com¶‘iÚTime
 = 
m_MEESecur™y
.

955 
	`G‘Com¶‘iÚTime
Ğ
m_NewT¿de
.
iSymbŞIndex
,

956 
m_NewT¿de
.
SubmissiÚTime
,

957 &
m_NewT¿de
.
fT¿dePriû
);

960 if(Ğ
m_NewT¿de
.
eT¿deTy³
 =ğ
eLim™Buy
 && m_NewT¿de.
fBidPriû
 < m_NewT¿de.
fT¿dePriû
 ) ||

961 Ğ
m_NewT¿de
.
eT¿deTy³
 =ğ
eLim™S–l
 && m_NewT¿de.
fBidPriû
 > m_NewT¿de.
fT¿dePriû
 ))

963 
m_NewT¿de
.
fT¿dePriû
 = m_NewT¿de.
fBidPriû
;

966 ià(
m_ºd
.
	`RndP”ûÁ
Ğ
iP”ûÁT¿deIsLIFO
 ))

968 
m_NewT¿de
.
bIsLifo
 = 
Œue
;

972 
m_NewT¿de
.
bIsLifo
 = 
çl£
;

975 ++
m_iCu¼’tIn™Ÿ‹dT¿des
;

976 
	}
}

991 
	gCT¿deG’
::
	$G’”©eCom¶‘eT¿de
()

993 
	`G’”©eCom¶‘edT¿deInfo
();

995 
	`G’”©eT¿deRow
();

996 
	`G’”©eT¿deHi¡ÜyRow
();

997 
	`G’”©eCashT¿n§ùiÚRow
();

998 
	`G’”©eS‘em’tRow
();

1000 
m_Brok”TabË
.
	`Upd©eT¿deAndCommissiÚYTD
(
	`G‘Cu¼’tBrok”Id
(), 1, 
m_T¿deRow
.
m_T¿de
.
T_COMM
);

1002 ++
m_iCu¼’tCom¶‘edT¿des
;

1003 
	}
}

1019 
	gCT¿deG’
::
	$G’”©eCom¶‘edT¿deInfo
()

1021 
m_Com¶‘edT¿deInfo
.
eAccouÁTaxStus
 =

1022 
m_Cu¡om”AccouÁTabË
.
	`G‘AccouÁTaxStus
(
	`G‘Cu¼’tAccID
());

1024 
m_Com¶‘edT¿deInfo
.
iCu¼’tBrok”Id
 =

1025 
m_Cu¡om”AccouÁTabË
.
	`G’”©eBrok”IdFÜAccouÁ
(
	`G‘Cu¼’tAccID
());

1027 
	`G’”©eT¿deCh¬ge
();

1029 
	`G’”©eT¿deCommissiÚ
();

1031 
	`G’”©eT¿deTax
();

1033 
	`G’”©eS‘em’tAmouÁ
();

1034 
	}
}

1046 
	gCT¿deG’
::
	$G’”©eT¿deRow
()

1048 
m_T¿deRow
.
m_T¿de
.
T_ID
 = 
	`G‘Cu¼’tT¿deID
();

1050 
m_T¿deRow
.
m_T¿de
.
T_CA_ID
 = 
	`G‘Cu¼’tAccID
();

1052 
	`¡ºıy
(
m_T¿deRow
.
m_T¿de
.
T_TT_ID
,

1053 
m_T¿deTy³Fe
->
	`G‘RecÜd
(
	`G‘Cu¼’tT¿deTy³
())->
TT_ID
,

1054 (
m_T¿deRow
.
m_T¿de
.
T_TT_ID
));

1056 
	`¡ºıy
(
m_T¿deRow
.
m_T¿de
.
T_ST_ID
,

1057 
m_StusTy³Fe
->
	`G‘RecÜd
(
	`G‘Cu¼’tT¿deStus
())->
ST_ID
,

1058 (
m_T¿deRow
.
m_T¿de
.
T_ST_ID
));

1062 
m_T¿deRow
.
m_T¿de
.
T_IS_CASH
 = 1;

1064 if((Ğ
	`G‘Cu¼’tT¿deTy³
(è=ğ
eM¬k‘Buy
 ) || ( G‘Cu¼’tT¿deTy³(è=ğ
eLim™Buy
 )) &&

1065 
m_ºd
.
	`RndP”ûÁ
Ğ
iP”ûÁBuysOnM¬gš
 ))

1067 
m_T¿deRow
.
m_T¿de
.
T_IS_CASH
 = 0;

1070 
	`¢´štf
(
m_T¿deRow
.
m_T¿de
.
T_EXEC_NAME
,

1071 (
m_T¿deRow
.
m_T¿de
.
T_EXEC_NAME
),

1073 
m_P”sÚ
.
	`G‘Fœ¡Name
(
	`G‘Cu¼’tCu¡ID
()),

1074 
m_P”sÚ
.
	`G‘La¡Name
(
	`G‘Cu¼’tCu¡ID
()));

1076 
m_Secur™yFe
->
	`C»©eSymbŞ
(
	`G‘Cu¼’tSecur™yIndex
(),

1077 
m_T¿deRow
.
m_T¿de
.
T_S_SYMB
,

1078 
¡©ic_ÿ¡
<>((
m_T¿deRow
.
m_T¿de
.
T_S_SYMB
)));

1080 
m_T¿deRow
.
m_T¿de
.
T_BID_PRICE
 = 
	`G‘Cu¼’tBidPriû
().
	`DŞÏrAmouÁ
();

1082 
m_T¿deRow
.
m_T¿de
.
T_TRADE_PRICE
 = 
	`G‘Cu¼’tT¿dePriû
().
	`DŞÏrAmouÁ
();

1084 
m_T¿deRow
.
m_T¿de
.
T_QTY
 = 
	`G‘Cu¼’tT¿deQty
();

1086 
m_T¿deRow
.
m_T¿de
.
T_CHRG
 = 
m_Com¶‘edT¿deInfo
.
Ch¬ge
.
	`DŞÏrAmouÁ
();

1088 
m_T¿deRow
.
m_T¿de
.
T_COMM
 = 
m_Com¶‘edT¿deInfo
.
CommissiÚ
.
	`DŞÏrAmouÁ
();

1094  
	`G‘Cu¼’tTaxStus
() )

1096 
eNÚTaxabË
:

1097 
m_T¿deRow
.
m_T¿de
.
T_TAX
 = 0;

1099 
eTaxabËAndW™hhŞd
:

1100 
m_T¿deRow
.
m_T¿de
.
T_TAX
 = 
	`G‘Cu¼’tT¿deTax
().
	`DŞÏrAmouÁ
();

1102 
eTaxabËAndDÚtW™hhŞd
:

1103 
m_T¿deRow
.
m_T¿de
.
T_TAX
 = 
	`G‘Cu¼’tT¿deTax
().
	`DŞÏrAmouÁ
();

1106 
	`as£¹
(
çl£
);

1111 
m_T¿deRow
.
m_T¿de
.
T_DTS
 = 
	`G‘Cu¼’tT¿deCom¶‘iÚTime
();

1113 
m_T¿deRow
.
m_T¿de
.
T_LIFO
 = 
	`G‘Cu¼’tT¿deIsLifo
();

1114 
	}
}

1126 
	gCT¿deG’
::
	$G’”©eT¿deCh¬ge
()

1128 
i
;

1129 
PCHARGE_ROW
 
pCh¬geRow
;

1130 
PTRADE_TYPE_ROW
 
pT¿deTy³Row
;

1133 
i
=0; i<
m_Ch¬geFe
->
	`G‘Size
(); ++i)

1135 
pCh¬geRow
 = 
m_Ch¬geFe
->
	`G‘RecÜd
(
i
);

1137 iàĞ
	`G‘Cu¼’tCu¡T›r
(è=ğ
pCh¬geRow
->
CH_C_TIER
 )

1139 
pT¿deTy³Row
 = 
m_T¿deTy³Fe
->
	`G‘RecÜd
(
	`G‘Cu¼’tT¿deTy³
());

1141 ià(!
	`¡rcmp
(
pT¿deTy³Row
->
TT_ID
, 
pCh¬geRow
->
CH_TT_ID
))

1144 
m_Com¶‘edT¿deInfo
.
Ch¬ge
 = 
pCh¬geRow
->
CH_CHRG
;

1151 
	`as£¹
(
çl£
);

1152 
	}
}

1164 
	gCT¿deG’
::
	$G’”©eT¿deCommissiÚ
()

1166 
iCu¡T›r
 = 
	`G‘Cu¼’tCu¡T›r
();

1167 
fT¿deQty
 = 
	`G‘Cu¼’tT¿deQty
();

1168 
eT¿deTy³ID
 
eT¿deTy³
 = 
	`G‘Cu¼’tT¿deTy³
();

1169 
eExchªgeID
 
eExchªge
 = 
m_Secur™yFe
->
	`G‘ExchªgeIndex
(
	`G‘Cu¼’tSecur™yIndex
());

1170 
PTRADE_TYPE_ROW
 
pT¿deTy³Row
 = 
m_T¿deTy³Fe
->
	`G‘RecÜd
(
eT¿deTy³
);

1171 
TSecur™yIÅutRow
* 
pSecur™yRow
 = 
m_Secur™yFe
->
	`G‘RecÜd
(
	`G‘Cu¼’tSecur™yIndex
());

1179 
UINT
 
iCu¡om”T›rRecÜds
 = 
m_CommissiÚR©eFe
->
	`G‘Size
() / 3;

1184 
UINT
 
iT¿deTy³RecÜds
 = 
iCu¡om”T›rRecÜds
 / 
m_T¿deTy³Fe
->
	`G‘Size
();

1189 
UINT
 
iExchªgeRecÜds
 = 
iT¿deTy³RecÜds
 / 
m_ExchªgeFe
->
	`G‘Size
();

1192 
UINT
 
iS¹Index
 = ((
iCu¡T›r
 - 1è* 
iCu¡om”T›rRecÜds
) +

1193 (()
eT¿deTy³
 * 
iT¿deTy³RecÜds
) +

1194 (()
eExchªge
 * 
iExchªgeRecÜds
);

1195 
UINT
 
iEndIndex
 = 
iS¹Index
 + 
iExchªgeRecÜds
;

1198 
UINT
 
i
 = 
iS¹Index
; i < 
iEndIndex
; i++)

1200 
PCOMMISSION_RATE_ROW
 
pCommRow
 = 
m_CommissiÚR©eFe
->
	`G‘RecÜd
(
i
);

1204 iàĞ(
iCu¡T›r
 !ğ
pCommRow
->
CR_C_TIER
)

1205 || (
	`¡rcmp
(
pT¿deTy³Row
->
TT_ID
, 
pCommRow
->
CR_TT_ID
))

1206 || (
	`¡rcmp
(
pSecur™yRow
->
S_EX_ID
, 
pCommRow
->
CR_EX_ID
))

1213 iàĞ
fT¿deQty
 >ğ
pCommRow
->
CR_FROM_QTY
 && fT¿deQty <ğpCommRow->
CR_TO_QTY
 )

1216 
m_Com¶‘edT¿deInfo
.
CommissiÚ
 = (
fT¿deQty
 * 
	`G‘Cu¼’tT¿dePriû
()) *

1217 
pCommRow
->
CR_RATE
 / 100.0;

1223 
	`as£¹
(
çl£
);

1224 
	}
}

1238 
	gCT¿deG’
::
	$G’”©eT¿deTax
()

1240 
TId’t
 
Cu¡om”AD_ID
;

1241 
UINT
 
iDivCode
, 
iCŒyCode
;

1242 
CMÚey
 
fProûeds
;

1243 
fCŒyR©e
, 
fDivR©e
;

1247 ià(
	`G‘Cu¼’tT¿deS–lV®ue
(è<ğ
	`G‘Cu¼’tT¿deBuyV®ue
())

1249 
m_Com¶‘edT¿deInfo
.
Tax
 = 0;

1253 
Cu¡om”AD_ID
 = 
m_Add»ssTabË
.
	`G‘AD_IDFÜCu¡om”
(
	`G‘Cu¼’tCu¡ID
());

1255 
m_Add»ssTabË
.
	`G‘DivisiÚAndCouÁryCodesFÜAdd»ss
(
Cu¡om”AD_ID
, 
iDivCode
, 
iCŒyCode
);

1257 
fProûeds
 = 
	`G‘Cu¼’tT¿deS–lV®ue
(è- 
	`G‘Cu¼’tT¿deBuyV®ue
();

1259 
fCŒyR©e
 = 
m_Cu¡Tax¿‹TabË
.
	`G‘CouÁryTaxRow
(
	`G‘Cu¼’tCu¡ID
(), 
iCŒyCode
).
TAX_RATE
;

1260 
fDivR©e
 = 
m_Cu¡Tax¿‹TabË
.
	`G‘DivisiÚTaxRow
(
	`G‘Cu¼’tCu¡ID
(), 
iDivCode
).
TAX_RATE
;

1271 
m_Com¶‘edT¿deInfo
.
Tax
 = 
fProûeds
 *

1272 (()(()(10000.0 * (
fCŒyR©e
 + 
fDivR©e
) + 0.5) ) / 10000.0);

1273 
	}
}

1285 
	gCT¿deG’
::
	$G’”©eT¿deHi¡ÜyRow
()

1287 iàĞ
	`G‘Cu¼’tT¿deTy³
(è=ğ
eStİLoss


1288 || 
	`G‘Cu¼’tT¿deTy³
(è=ğ
eLim™S–l


1289 || 
	`G‘Cu¼’tT¿deTy³
(è=ğ
eLim™Buy
)

1291 
m_iT¿deHi¡ÜyRowCouÁ
 = 3;

1294 
m_T¿deRow
.
m_T¿deHi¡Üy
[0].
TH_T_ID
 = 
	`G‘Cu¼’tT¿deID
();

1295 
	`¡ºıy
(
m_T¿deRow
.
m_T¿deHi¡Üy
[0].
TH_ST_ID
,

1296 
m_StusTy³Fe
->
	`G‘RecÜd
(
eP’dšg
)->
ST_ID
,

1297 (
m_T¿deRow
.
m_T¿deHi¡Üy
[0].
TH_ST_ID
));

1298 
m_T¿deRow
.
m_T¿deHi¡Üy
[0].
TH_DTS
 = 
	`G‘Cu¼’tT¿deP’dšgTime
();

1301 
m_T¿deRow
.
m_T¿deHi¡Üy
[1].
TH_T_ID
 = 
	`G‘Cu¼’tT¿deID
();

1302 
	`¡ºıy
(
m_T¿deRow
.
m_T¿deHi¡Üy
[1].
TH_ST_ID
,

1303 
m_StusTy³Fe
->
	`G‘RecÜd
(
eSubm™‹d
)->
ST_ID
,

1304 (
m_T¿deRow
.
m_T¿deHi¡Üy
[1].
TH_ST_ID
));

1305 
m_T¿deRow
.
m_T¿deHi¡Üy
[1].
TH_DTS
 = 
	`G‘Cu¼’tT¿deSubmissiÚTime
();

1308 
m_T¿deRow
.
m_T¿deHi¡Üy
[2].
TH_T_ID
 = 
	`G‘Cu¼’tT¿deID
();

1309 
	`¡ºıy
(
m_T¿deRow
.
m_T¿deHi¡Üy
[2].
TH_ST_ID
,

1310 
m_StusTy³Fe
->
	`G‘RecÜd
(
eCom¶‘ed
)->
ST_ID
,

1311 (
m_T¿deRow
.
m_T¿deHi¡Üy
[2].
TH_ST_ID
));

1312 
m_T¿deRow
.
m_T¿deHi¡Üy
[2].
TH_DTS
 = 
	`G‘Cu¼’tT¿deCom¶‘iÚTime
();

1316 
m_iT¿deHi¡ÜyRowCouÁ
 = 2;

1319 
m_T¿deRow
.
m_T¿deHi¡Üy
[0].
TH_T_ID
 = 
	`G‘Cu¼’tT¿deID
();

1320 
	`¡ºıy
(
m_T¿deRow
.
m_T¿deHi¡Üy
[0].
TH_ST_ID
,

1321 
m_StusTy³Fe
->
	`G‘RecÜd
(
eSubm™‹d
)->
ST_ID
,

1322 (
m_T¿deRow
.
m_T¿deHi¡Üy
[0].
TH_ST_ID
));

1323 
m_T¿deRow
.
m_T¿deHi¡Üy
[0].
TH_DTS
 = 
	`G‘Cu¼’tT¿deSubmissiÚTime
();

1326 
m_T¿deRow
.
m_T¿deHi¡Üy
[1].
TH_T_ID
 = 
	`G‘Cu¼’tT¿deID
();

1327 
	`¡ºıy
(
m_T¿deRow
.
m_T¿deHi¡Üy
[1].
TH_ST_ID
,

1328 
m_StusTy³Fe
->
	`G‘RecÜd
(
eCom¶‘ed
)->
ST_ID
,

1329 (
m_T¿deRow
.
m_T¿deHi¡Üy
[1].
TH_ST_ID
));

1330 
m_T¿deRow
.
m_T¿deHi¡Üy
[1].
TH_DTS
 = 
	`G‘Cu¼’tT¿deCom¶‘iÚTime
();

1332 
	}
}

1344 
	gCT¿deG’
::
	$G’”©eS‘em’tAmouÁ
()

1348 ià(
m_T¿deTy³Fe
->
	`G‘RecÜd
(
	`G‘Cu¼’tT¿deTy³
())->
TT_IS_SELL
)

1350 
m_Com¶‘edT¿deInfo
.
S‘em’tAmouÁ
 =

1351 
	`G‘Cu¼’tT¿deQty
(è* 
	`G‘Cu¼’tT¿dePriû
() -

1352 
m_Com¶‘edT¿deInfo
.
Ch¬ge
 -

1353 
m_Com¶‘edT¿deInfo
.
CommissiÚ
;

1357 
m_Com¶‘edT¿deInfo
.
S‘em’tAmouÁ
 =

1358 -1 * (
	`G‘Cu¼’tT¿deQty
(è* 
	`G‘Cu¼’tT¿dePriû
() +

1359 
m_Com¶‘edT¿deInfo
.
Ch¬ge
 +

1360 
m_Com¶‘edT¿deInfo
.
CommissiÚ
);

1363  
	`G‘Cu¼’tTaxStus
() )

1365 
eNÚTaxabË
:

1367 
eTaxabËAndW™hhŞd
:

1368 
m_Com¶‘edT¿deInfo
.
S‘em’tAmouÁ
 -ğm_Com¶‘edT¿deInfo.
Tax
;

1370 
eTaxabËAndDÚtW™hhŞd
:

1373 
	`as£¹
(
çl£
);

1375 
	}
}

1387 
	gCT¿deG’
::
	$G’”©eCashT¿n§ùiÚRow
()

1389 
S_NAME
[
cS_NAME_Ën
 + 1];

1391 iàĞ
	`G‘Cu¼’tT¿deIsCash
() )

1393 
m_iCashT¿n§ùiÚRowCouÁ
 = 1;

1395 
m_T¿deRow
.
m_CashT¿n§ùiÚ
.
CT_DTS
 = 
	`G‘Cu¼’tT¿deCom¶‘iÚTime
();

1396 
m_T¿deRow
.
m_CashT¿n§ùiÚ
.
CT_T_ID
 = 
	`G‘Cu¼’tT¿deID
();

1397 
m_T¿deRow
.
m_CashT¿n§ùiÚ
.
CT_AMT
 = 
	`G‘Cu¼’tS‘em’tAmouÁ
().
	`DŞÏrAmouÁ
();

1399 
m_Secur™yTabË
.
	`C»©eName
(
	`G‘Cu¼’tSecur™yIndex
(), 
S_NAME
, 
¡©ic_ÿ¡
<>((S_NAME)));

1401 
	`¢´štf
(
m_T¿deRow
.
m_CashT¿n§ùiÚ
.
CT_NAME
,

1402 (
m_T¿deRow
.
m_CashT¿n§ùiÚ
.
CT_NAME
),

1404 (
m_T¿deTy³Fe
->
	`G‘RecÜd
(
	`G‘Cu¼’tT¿deTy³
()))->
TT_NAME
,

1405 
	`G‘Cu¼’tT¿deQty
(),

1406 
S_NAME
);

1410 
m_iCashT¿n§ùiÚRowCouÁ
 = 0;

1412 
	}
}

1424 
	gCT¿deG’
::
	$G’”©eS‘em’tRow
()

1426 
m_iS‘em’tRowCouÁ
 = 1;

1428 
m_T¿deRow
.
m_S‘em’t
.
SE_T_ID
 = 
	`G‘Cu¼’tT¿deID
();

1430 ià(
	`G‘Cu¼’tT¿deIsCash
())

1432 
	`¡ºıy
(
m_T¿deRow
.
m_S‘em’t
.
SE_CASH_TYPE
,

1434 (
m_T¿deRow
.
m_S‘em’t
.
SE_CASH_TYPE
));

1438 
	`¡ºıy
(
m_T¿deRow
.
m_S‘em’t
.
SE_CASH_TYPE
,

1440 (
m_T¿deRow
.
m_S‘em’t
.
SE_CASH_TYPE
));

1443 
m_T¿deRow
.
m_S‘em’t
.
SE_CASH_DUE_DATE
 = 
	`G‘Cu¼’tT¿deCom¶‘iÚTime
();

1444 
m_T¿deRow
.
m_S‘em’t
.
SE_CASH_DUE_DATE
.
	`Add
(2, 0);

1445 
m_T¿deRow
.
m_S‘em’t
.
SE_CASH_DUE_DATE
.
	`S‘HMS
(0,0,0,0);

1446 
m_T¿deRow
.
m_S‘em’t
.
SE_AMT
 = 
	`G‘Cu¼’tS‘em’tAmouÁ
().
	`DŞÏrAmouÁ
();

1447 
	}
}

	@src/workload/tpce/egen/WheelTime.cpp

42 
	~"wÜklßd/û/eg’/Wh“lTime.h
"

44 
usšg
 
Çme¥aû
 
	gTPCE
;

46 
	gCWh“lTime
::
	$CWh“lTime
Ğ
PWh“lCÚfig
 
pWh“lCÚfig
 )

47 : 
	`m_pWh“lCÚfig
Ğ
pWh“lCÚfig
 )

48 , 
	`m_Cyşes
( 0 )

49 , 
	$m_Index
( 0 )

51 
	}
}

53 
	gCWh“lTime
::
	$CWh“lTime
Ğ
PWh“lCÚfig
 
pWh“lCÚfig
, 
INT32
 
cyşes
, INT32 
šdex
 )

54 : 
	`m_pWh“lCÚfig
Ğ
pWh“lCÚfig
 )

55 , 
	`m_Cyşes
Ğ
cyşes
 )

56 , 
	$m_Index
Ğ
šdex
 )

58 
	}
}

60 
	gCWh“lTime
::
	$CWh“lTime
Ğ
PWh“lCÚfig
 
pWh“lCÚfig
, 
CD©eTime
& 
Ba£
, CD©eTime& 
Now
, 
INT32
 
off£t
 )

61 : 
	$m_pWh“lCÚfig
Ğ
pWh“lCÚfig
 )

63 
	`S‘
Ğ
Ba£
 , 
Now
 );

64 
	`Add
Ğ
off£t
 );

65 
	}
}

67 
	gCWh“lTime
::~
	$CWh“lTime
( )

69 
	}
}

71 
CWh“lTime
::
	$Add
Ğ
INT32
 
IÁ”v®
 )

74 
m_Cyşes
 +ğ
IÁ”v®
 / 
m_pWh“lCÚfig
->
Wh“lSize
;

75 
m_Index
 +ğ
IÁ”v®
 % 
m_pWh“lCÚfig
->
Wh“lSize
;

76 ifĞ
m_Index
 >ğ
m_pWh“lCÚfig
->
Wh“lSize
 )

79 
m_Cyşes
++;

80 
m_Index
 -ğ
m_pWh“lCÚfig
->
Wh“lSize
;

82 
	}
}

84 
INT32
 
	gCWh“lTime
::
	$Off£t
ĞcÚ¡ 
CWh“lTime
& 
Time
 )

86 
INT32
 
IÁ”v®
;

88 
IÁ”v®
 = ( 
m_Cyşes
 - 
Time
.m_Cyşe è* 
m_pWh“lCÚfig
->
Wh“lSize
;

89 
IÁ”v®
 +ğĞ
m_Index
 - 
Time
.m_Index );

90 Ğ
IÁ”v®
 );

91 
	}
}

93 
	gCWh“lTime
::
	$S‘
Ğ
INT32
 
cyşes
, INT32 
šdex
 )

95 
m_Cyşes
 = 
cyşes
;

96 
m_Index
 = 
šdex
;

97 
	}
}

100 
	gCWh“lTime
::
	$S‘
Ğ
CD©eTime
& 
Ba£
, CD©eTime& 
Now
 )

102 
INT32
 
off£t
;

106 
off£t
 = 
Now
.
	`DiffInMliSecÚds
Ğ
Ba£
 ) / 
m_pWh“lCÚfig
->
Wh“lResŞutiÚ
;

107 
m_Cyşes
 = 
off£t
 / 
m_pWh“lCÚfig
->
Wh“lSize
;

108 
m_Index
 = 
off£t
 % 
m_pWh“lCÚfig
->
Wh“lSize
;

109 
	}
}

112 
	gCWh“lTime
::
	$S‘
Ğ
CD©eTime
* 
pBa£
, CD©eTime* 
pNow
 )

114 
INT32
 
off£t
;

118 
off£t
 = 
pNow
->
	`DiffInMliSecÚds
Ğ
pBa£
 ) / 
m_pWh“lCÚfig
->
Wh“lResŞutiÚ
;

119 
m_Cyşes
 = 
off£t
 / 
m_pWh“lCÚfig
->
Wh“lSize
;

120 
m_Index
 = 
off£t
 % 
m_pWh“lCÚfig
->
Wh“lSize
;

121 
	}
}

123 
boŞ
 
	gCWh“lTime
::
İ”©Ü
 <(cÚ¡ 
CWh“lTime
& 
Time
)

125  ( 
m_Cyşes
 =ğ
Time
.m_Cyşe è? ( 
m_Index
 < Time.m_Index ) : ( m_Cycles < Time.m_Cycles );

128 
	gCWh“lTime
& CWh“lTime::
İ”©Ü
 = (cÚ¡ 
CWh“lTime
& 
Time
)

130 
m_pWh“lCÚfig
 = 
Time
.m_pWheelConfig;

131 
	gm_Cyşes
 = 
Time
.
m_Cyşes
;

132 
	gm_Index
 = 
Time
.
m_Index
;

134  *
	gthis
;

137 
	gCWh“lTime
& CWh“lTime::
İ”©Ü
 +ğĞcÚ¡ 
INT32
& 
IÁ”v®
 )

139 
Add
Ğ
IÁ”v®
 );

140  *
	gthis
;

143 
CWh“lTime
 
	gCWh“lTime
::
İ”©Ü
 ++ ( 
INT32
 )

145 
Add
( 1 );

146  *
	gthis
;

	@src/workload/tpce/egen/bucketsimulator.cpp

38 
	~"wÜklßd/û/eg’/th»adšg.h
"

39 
	~"wÜklßd/û/eg’/unu£dæag.h
"

41 
	~<¡dexû±
>

42 
	~<iomª
>

44 
	~"wÜklßd/û/eg’/buck‘simuÏtÜ.h
"

47 
Çme¥aû
 
	gTPCE


50 
	gBuck‘SimuÏtÜ
::
Buck‘SimuÏtÜ
(

51 
™”¡¬t
,

52 
™”couÁ
,

53 
TId’t
 
iCu¡om”CouÁ
,

54 
TId’t
 
simÜd”s
,

55 
TPCE
::
RNGSEED
 
ba£_£ed
,

56 
Buck‘Prog»ss
& 
´og»ss
)

57 : 
m_ºd
()

58 , 
m_buck‘s
(
NULL
)

59 , 
m_cu¡couÁ
(
iCu¡om”CouÁ
)

60 , 
m_™”¡¬t
(
™”¡¬t
)

61 , 
m_™”couÁ
(
™”couÁ
)

62 , 
m_ba££ed
(
ba£_£ed
)

63 , 
m_simÜd”s
(
simÜd”s
)

64 , 
m_maxbuck‘
(
¡©ic_ÿ¡
<>(
iCu¡om”CouÁ
/
iDeçuÉLßdUn™Size
))

65 , 
m_´og»ss
(
´og»ss
)

67 ià(
	giCu¡om”CouÁ
 % 
	giDeçuÉLßdUn™Size
 != 0) {

68 
throw
 
¡d
::
¿nge_”rÜ
("The customer count must be‡n integral multiple ofhe†oad unit size!");

70 ià(
	gm_maxbuck‘
 < 2) {

71 
throw
 
	g¡d
::
¿nge_”rÜ
("Bucket simulator must have‡t†east 2 buckets!");

73 
	gm_buck‘s
 = 
Ãw
 
INT64
[
m_maxbuck‘
];

76 
	gBuck‘SimuÏtÜ
::~
Buck‘SimuÏtÜ
() {

77 
d–‘e
[] 
m_buck‘s
;

82 
	gBuck‘SimuÏtÜ
::
ÿlc_¡ddev
() {

83 
sum
 = 0;

84 
	gi
 = 0; i < 
	gm_maxbuck‘
; ++i) {

85 
	gsum
 +ğ
m_buck‘s
[
i
];

87 
	gm—n
 = 
sum
/()
m_maxbuck‘
;

89 
	gsumdev2
 = 0;

90 
	gi
 = 0; i < 
	gm_maxbuck‘
; ++i) {

91 
	gsumdev2
 +ğ(
m_buck‘s
[
i
] - 
m—n
) * (m_buckets[i] - mean);

93 
	g¡ddev
 = 
sq¹
Ğ
sumdev2
/()(
m_maxbuck‘
-1) );

95  
	g¡ddev
;

101 
	gBuck‘SimuÏtÜ
::
simuÏ‹_Ú”un
(
INT64
 
iÜd”s
) {

102 
buck‘
;

104 
mem£t
(
m_buck‘s
, 0, (m_buck‘s[0])*
m_maxbuck‘
);

106 
INT64
 
	gi
 = 0; i < 
	giÜd”s
; ++i) {

107 
	gbuck‘
 = 
m_ºd
.
RndIÁRªge
Ğ0, 
¡©ic_ÿ¡
<>((
m_cu¡couÁ
 - 1è/ stic_ÿ¡<
TId’t
>(
iDeçuÉLßdUn™Size
)) );

108 
	gm_buck‘s
[
buck‘
] += 1;

111  
ÿlc_¡ddev
();

116 
	gBuck‘SimuÏtÜ
::
simuÏ‹
() {

117 
max_¡ddev
 = 0;

118 
	gTPCE
::
RNGSEED
 
£ed
 = 
m_ºd
.
RndNthEËm’t
(
m_ba££ed
,

119 (
RNGSEED
)(
m_™”¡¬t
*
m_simÜd”s
*
RND_STEP_PER_ORDER
));

120 
	gm_ºd
.
S‘S“d
(
£ed
);

121 
	gi
 = 0; i < 
	gm_™”couÁ
; ++i) {

122 
	gTPCE
::
RNGSEED
 
cu¼’t_£ed
 = 
m_ºd
.
G‘S“d
();

123 
	g¡ddev
 = 
simuÏ‹_Ú”un
(
m_simÜd”s
);

125 
	g¡d
::
o¡ršg¡»am
 
¡rm
;

126 
	g¡rm
 << "StdDev fÜ„uÀ" << 
	gi
+
	gm_™”¡¬t
 << " is "

127 << 
	g¡d
::
£»cisiÚ
(3è<< 
¡d
::
fixed


128 << 
¡ddev
 << ", s“d wa " << 
cu¼’t_£ed
;

129 
	gm_´og»ss
.
mes§ge
(
¡rm
.
¡r
(), 1);

131 ià(
	gmax_¡ddev
 < 
	g¡ddev
) {

132 
	gmax_¡ddev
 = 
¡ddev
;

134 ià(!
	gm_´og»ss
.
»pÜt
(
¡ddev
)){

138  
	gmax_¡ddev
;

142 
	gBuck‘SimuÏtÜ
::
run
(* 
th»ad
 
UNUSED
) {

143 
simuÏ‹
();

148 
	gBuck‘Prog»ss
::
Buck‘Prog»ss
(
acû±abË_¡ddev
, 
tÙ®_š
, 
v”bos™y
, 
¡d
::
o¡»am
* 
ouut
)

149 : 
Prog»ssM‘”
(
tÙ®_š
, 
v”bos™y
, 
ouut
)

150 , 
acû±abË_¡ddev_
(
acû±abË_¡ddev
)

151 , 
max_¡ddev_
(0)

155 
	gBuck‘Prog»ss
::
di¥Ïy_mes§ge
(
¡d
::
o¡»am
& 
out
) const

157 
Prog»ssM‘”
::
di¥Ïy_mes§ge
(
out
);

158 
	gout
 << " stddev=" << 
	gmax_¡ddev_
;

161 
boŞ
 
	gBuck‘Prog»ss
::
»pÜt
(
¡ddev
) {

162 
šc
();

163 
	gTPCE
::
Lock”
<
Prog»ssM‘”
> 
lock”
(*
this
);

164 ià(
	gmax_¡ddev_
 < 
	g¡ddev
) {

165 
	gmax_¡ddev_
 = 
¡ddev
;

167  (
	gmax_¡ddev_
 < 
	gacû±abË_¡ddev_
);

170 
	gBuck‘Prog»ss
::
max_¡ddev
() {

171 
TPCE
::
Lock”
<
Prog»ssM‘”
> 
lock”
(*
this
);

172  
	gmax_¡ddev_
;

	@src/workload/tpce/egen/error.cpp

37 
	~"wÜklßd/û/eg’/EG’Ut™›s_¡dafx.h
"

39 
usšg
 
Çme¥aû
 
	gTPCE
;

41 
	gCSy¡emE¼
::
	$CSy¡emE¼
(
AùiÚ
 
eAùiÚ
, cÚ¡ * 
szLoÿtiÚ
)

42 : 
	`CBa£E¼
(
szLoÿtiÚ
)

43 , 
	$m_eAùiÚ
(
eAùiÚ
)

45 #ifdeà
WIN32


46 
m_idMsg
 = 
	`G‘La¡E¼Ü
();

47 #–ià(
__unix
è|| (
_AIX
)

48 
m_idMsg
 = 
”ºo
;

50 #”rÜ 
No
 
sy¡em
 
”rÜ
 
routše
 
defšed
.

52 
	}
}

54 
	gCSy¡emE¼
::
	$CSy¡emE¼
(
iE¼Ü
, 
AùiÚ
 
eAùiÚ
, cÚ¡ * 
szLoÿtiÚ
)

55 : 
	`CBa£E¼
(
szLoÿtiÚ
)

56 , 
	$m_eAùiÚ
(
eAùiÚ
)

60 
m_idMsg
 = 
iE¼Ü
;

61 
	}
}

63 cÚ¡ * 
	gCSy¡emE¼
::
	$E¼ÜText
() const

65  
	`¡»¼Ü
(
m_idMsg
);

66 
	}
}

	@src/workload/tpce/egen/locking.cpp

37 
	~"wÜklßd/û/eg’/lockšg.h
"

39 #iâdeà
WIN32


40 
	~<io¡»am
>

41 
	~<s¡»am
>

42 
	~<¡dexû±
>

43 
	~<û¼no
>

44 
	~<c¡dlib
>

45 
	~<sys/time.h
>

47 
usšg
 
	g¡d
::
¡»¼Ü
;

48 
usšg
 
	g¡d
::
ex™
;

51 
	~"wÜklßd/û/eg’/”rÜ.h
"

53 
Çme¥aû
 
	gTPCE


56 #ifdeà
WIN32


62 
	gCMu‹x
::
CMu‹x
()

63 : 
mu‹x_
()

65 
In™ŸlizeCr™iÿlSeùiÚ
(&
mu‹x_
);

68 
	gCMu‹x
::~
CMu‹x
()

70 
D–‘eCr™iÿlSeùiÚ
(&
mu‹x_
);

73 
LPCRITICAL_SECTION
 
	gCMu‹x
::
mu‹x
()

75  &
mu‹x_
;

78 
	gCMu‹x
::
lock
()

80 
EÁ”Cr™iÿlSeùiÚ
(&
mu‹x_
);

83 
	gCMu‹x
::
uÆock
()

85 
L—veCr™iÿlSeùiÚ
(&
mu‹x_
);

94 
	gCMu‹x
::
CMu‹x
()

95 : 
mu‹x_
()

97 
rc
 = 
±h»ad_mu‹x_š™
(&
mu‹x_
, 
NULL
);

98 ià(
	grc
 != 0) {

99 
¡d
::
o¡ršg¡»am
 
¡rm
;

100 
	g¡rm
 << "±h»ad_mu‹x_š™ƒ¼Ü: " << 
¡»¼Ü
(
rc
è<< "(" << 
	grc
 << ")";

101 
throw
 
	g¡d
::
ruÁime_”rÜ
(
¡rm
.
¡r
());

105 
	gCMu‹x
::~
CMu‹x
()

107 
rc
 = 
±h»ad_mu‹x_de¡roy
(&
mu‹x_
);

108 ià(
	grc
 != 0) {

109 
¡d
::
o¡ršg¡»am
 
¡rm
;

110 
	g¡rm
 << "±h»ad_mu‹x_de¡royƒ¼Ü: " << 
¡»¼Ü
(
rc
è<< "(" << 
	grc
 << ")";

111 
throw
 
	g¡d
::
ruÁime_”rÜ
(
¡rm
.
¡r
());

115 
±h»ad_mu‹x_t
* 
	gCMu‹x
::
mu‹x
()

117  &
mu‹x_
;

120 
	gCMu‹x
::
lock
()

122 
rc
 = 
±h»ad_mu‹x_lock
(&
mu‹x_
);

123 ià(
	grc
 != 0) {

124 
¡d
::
o¡ršg¡»am
 
¡rm
;

125 
	g¡rm
 << "±h»ad_cÚd_wa™ƒ¼Ü: " << 
¡»¼Ü
(
rc
è<< "(" << 
	grc
 << ")";

126 
throw
 
	g¡d
::
ruÁime_”rÜ
(
¡rm
.
¡r
());

130 
	gCMu‹x
::
uÆock
()

132 
rc
 = 
±h»ad_mu‹x_uÆock
(&
mu‹x_
);

133 ià(
	grc
 != 0) {

134 
¡d
::
o¡ršg¡»am
 
¡rm
;

135 
	g¡rm
 << "±h»ad_cÚd_wa™ƒ¼Ü: " << 
¡»¼Ü
(
rc
è<< "(" << 
	grc
 << ")";

136 
throw
 
	g¡d
::
ruÁime_”rÜ
(
¡rm
.
¡r
());

	@src/workload/tpce/egen/progressmeter.cpp

37 
	~"wÜklßd/û/eg’/th»adšg.h
"

39 
	~<io¡»am
>

41 
	~"wÜklßd/û/eg’/´og»ssm‘”.h
"

42 
	~"wÜklßd/û/eg’/¡rut.h
"

44 
Çme¥aû
 
	gTPCE


48 
	gProg»ssM‘”
::
Prog»ssM‘”
(
tÙ®_š
, 
v”bos™y
, 
¡d
::
o¡»am
* 
ouut
)

49 : 
m_tÙ®
(
tÙ®_š
)

50 , 
m_cu¼’t
(0)

51 , 
m_di¥Ïy_š‹rv®
(10)

52 , 
m_¡¬t_time
()

53 , 
m_Ï¡_time
(
m_¡¬t_time
)

54 , 
m_ouut
(
ouut
)

55 , 
m_v”bos™y
(
v”bos™y
)

56 , 
m_mu‹x
()

62 
	gProg»ssM‘”
::
£t_di¥Ïy_š‹rv®
(
v®
) {

63 
TPCE
::
Lock”
<
Prog»ssM‘”
> 
lock”
(*
this
);

64 
	gm_di¥Ïy_š‹rv®
 = 
v®
;

67 
	gProg»ssM‘”
::
di¥Ïy_š‹rv®
() const {

68 
TPCE
::
Lock”
<cÚ¡ 
Prog»ssM‘”
> 
lock”
(*
this
);

69  
	gm_di¥Ïy_š‹rv®
;

73 
	gProg»ssM‘”
::
di¥Ïy
() const {

74 
TPCE
::
Lock”
<cÚ¡ 
Prog»ssM‘”
> 
lock”
(*
this
);

75 
di¥Ïy_mes§ge
(*
m_ouut
);

76 (*
	gm_ouut
è<< 
	g¡d
::
’dl
;

83 
	gProg»ssM‘”
::
di¥Ïy_mes§ge
(
¡d
::
o¡»am
& 
out
) const {

84 
CD©eTime
 
now
;

85 
INT32
 
	g–­£d_š_ms
 = 
now
.
DiffInMliSecÚds
(
m_¡¬t_time
);

86 
	g¿‹
 = 
¡©ic_ÿ¡
<>(
–­£d_š_ms
)/¡©ic_ÿ¡<>(
m_cu¼’t
)/1000.0;

87 
	gout
 << 
	gm_cu¼’t
 << "/" << 
	gm_tÙ®


88 << " (" << 
	gm_cu¼’t
*100/
	gm_tÙ®
 << "%)"

89 << " [Remaš: " << 
št64tÙime¡r
(()(
¿‹
*()(
m_tÙ®
-
m_cu¼’t
))) << ", "

90 << "EÏp£d: " << 
št64tÙime¡r
(
–­£d_š_ms
/1000) << "]"

100 
	gProg»ssM‘”
::
šc
(
couÁ
) {

101 
CD©eTime
 
now
;

103 
	gTPCE
::
Lock”
<
Prog»ssM‘”
> 
lock”
(*
this
);

104 
	gm_cu¼’t
 +ğ
couÁ
;

105 ià(
	gm_v”bos™y
 <ğ0 || 
m_di¥Ïy_š‹rv®
 < 0 || 
now
.
DiffInMliSecÚds
(
m_Ï¡_time
) <= m_display_interval*1000) {

108 
	gm_Ï¡_time
.
S‘ToCu¼’t
();

110 
di¥Ïy
();

114 
	gProg»ssM‘”
::
cu¼’t
() const

116 
TPCE
::
Lock”
<cÚ¡ 
Prog»ssM‘”
> 
lock”
(*
this
);

117  
	gm_cu¼’t
;

121 
	gProg»ssM‘”
::
tÙ®
() const

123 
TPCE
::
Lock”
<cÚ¡ 
Prog»ssM‘”
> 
lock”
(*
this
);

124  
	gm_tÙ®
;

131 
	gProg»ssM‘”
::
mes§ge
(cÚ¡ 
¡d
::
¡ršg
& 
mesg
, 
Ëv–
) {

132 
	gTPCE
::
Lock”
<
Prog»ssM‘”
> 
lock”
(*
this
);

133 ià(
	gËv–
 >ğ
m_v”bos™y
) {

136 (*
	gm_ouut
è<< 
	gmesg
 << 
	g¡d
::
’dl
;

139 
	gProg»ssM‘”
::
lock
() const

141 
m_mu‹x
.
lock
();

144 
	gProg»ssM‘”
::
uÆock
() const

146 
m_mu‹x
.
uÆock
();

	@src/workload/tpce/egen/progressmeterinterface.cpp

37 
	~"wÜklßd/û/eg’/´og»ssm‘”š‹rçû.h
"

38 
	~"wÜklßd/û/eg’/unu£dæag.h
"

40 
Çme¥aû
 
	gTPCE


44 
	gProg»ssM‘”IÁ”çû
::~
Prog»ssM‘”IÁ”çû
()

48 
Prog»ssM‘”IÁ”çû
::
di¥Ïy
() const

52 
Prog»ssM‘”IÁ”çû
::
šc
(
couÁ
 
UNUSED
)

56 
Prog»ssM‘”IÁ”çû
::
mes§ge
(cÚ¡ 
¡d
::
¡ršg
& 
mesg
 
UNUSED
, 
Ëv–
 UNUSED)

	@src/workload/tpce/egen/strutil.cpp

37 
	~<iomª
>

38 
	~<s¡»am
>

39 
	~<¡dexû±
>

41 
	~<c¡dlib
>

42 
	~<û¼no
>

43 
	~<¡dlib.h
>

45 
	~"wÜklßd/û/eg’/EG’Snd¬dTy³s.h
"

47 #ifdeà
WIN32


48 
	#¡¹ouÎ
 
_¡¹oui64


	)

51 
usšg
 
	g¡d
::
¡¹oul
;

52 
usšg
 
	g¡d
::
¡¹od
;

54 
Çme¥aû
 
	gTPCE
 {

60 
INT64
 
¡¹ošt64
(cÚ¡ *
±r
) {

61 
INT64
 
	gv®
;

62 *
	g’dp
;

63 
	g”ºo
 = 0;

64 
	gv®
 = 
¡¹ouÎ
(
±r
, &
’dp
, 0);

65 ià(
	g”ºo
 != 0) {

66 
¡d
::
o¡ršg¡»am
 
¡rm
;

67 
	g¡rm
 << "UÇbËØ·r£ iÁeg” '" << 
	g±r
 << "'" << 
	g¡d
::
’dl
;

68 
throw
 
	g¡d
::
ruÁime_”rÜ
(
¡rm
.
¡r
());

70 *
	g’dp
) {

71 'G': 
v®
 *= 1000*1000*1000; ;

72 'M': 
v®
 *= 1000*1000; ;

73 'K': 
v®
 *= 1000; ;

74 '\0': 
’dp
--; ;

76 
¡d
::
o¡ršg¡»am
 
¡rm
;

77 
	g¡rm
 << "UÇbËØ·r£ inv®id sÿË faùÜ oÀš‹g” '" << 
	g±r
 << "'" << 
	g¡d
::
’dl
;

78 
throw
 
	g¡d
::
ruÁime_”rÜ
(
¡rm
.
¡r
());

80 ià(*++
	g’dp
 != '\0') {

81 
¡d
::
o¡ršg¡»am
 
¡rm
;

82 
	g¡rm
 << "UÇbËØ·r£¿šg ch¬aù” Ú iÁeg” '" << 
	g±r
 << "'" << 
	g¡d
::
’dl
;

83 
throw
 
	g¡d
::
ruÁime_”rÜ
(
¡rm
.
¡r
());

85  
	gv®
;

92 
¡¹odbl
(cÚ¡ *
±r
) {

93 
	gv®
;

94 *
	g’dp
;

95 
	g”ºo
 = 0;

96 
	gv®
 = 
¡¹od
(
±r
, &
’dp
);

97 ià(
	g”ºo
 != 0) {

98 
¡d
::
o¡ršg¡»am
 
¡rm
;

99 
	g¡rm
 << "UÇbËØ·r£ flßtšg…ošˆnumb” '" << 
	g±r
 << "'" << 
	g¡d
::
’dl
;

100 
throw
 
	g¡d
::
ruÁime_”rÜ
(
¡rm
.
¡r
());

102 *
	g’dp
) {

103 'G': 
v®
 *= 1000.0*1000.0*1000.0; ;

104 'M': 
v®
 *= 1000.0*1000.0; ;

105 'K': 
v®
 *= 1000.0; ;

106 '\0': 
’dp
--; ;

108 
¡d
::
o¡ršg¡»am
 
¡rm
;

109 
	g¡rm
 << "UÇbËØ·r£ inv®id sÿË faùÜ oÀæßtšg…ošˆnumb” '" << 
	g±r
 << "'" << 
	g¡d
::
’dl
;

110 
throw
 
	g¡d
::
ruÁime_”rÜ
(
¡rm
.
¡r
());

112 ià(*++
	g’dp
 != '\0') {

113 
¡d
::
o¡ršg¡»am
 
¡rm
;

114 
	g¡rm
 << "UÇbËØ·r£¿šg ch¬aù” Ú flßtšg…ošˆnumb” '" << 
	g±r
 << "'" << 
	g¡d
::
’dl
;

115 
throw
 
	g¡d
::
ruÁime_”rÜ
(
¡rm
.
¡r
());

117  
	gv®
;

124 
INT64
 
time¡¹ošt64
(cÚ¡ *
±r
) {

125 
INT64
 
	gv®
;

126 *
	g’dp
;

127 
	g”ºo
 = 0;

128 
	gv®
 = 
¡¹oul
(
±r
, &
’dp
, 0);

129 ià(*
	g’dp
 == ':') {

130 
v®
 = v®*60 + 
¡¹oul
(
’dp
+1, &endp, 0);

131 ià(*
	g’dp
 == ':') {

132 
v®
 = v®*60 + 
¡¹oul
(
’dp
+1, &endp, 0);

135 ià(
	g”ºo
 !ğ0 || *
’dp
 != '\0') {

136 
¡d
::
o¡ršg¡»am
 
¡rm
;

137 
	g¡rm
 << "UÇbËØ·r£im'" << 
	g±r
 << "'" << 
	g¡d
::
’dl
;

138 
throw
 
	g¡d
::
ruÁime_”rÜ
(
¡rm
.
¡r
());

140  
	gv®
;

146 
	g¡d
::
¡ršg
 
št64tÙime¡r
(
INT64
 
v®
) {

147 
¡d
::
o¡ršg¡»am
 
¡rm
;

148 
	g£c
 = 
¡©ic_ÿ¡
<>(
v®
 % 60);

149 
	gv®
 /= 60;

150 
	gmš
 = 
¡©ic_ÿ¡
<>(
v®
 % 60);

151 
	ghrs
 = 
¡©ic_ÿ¡
<>(
v®
 / 60);

153 
	g¡rm
 << 
	g¡d
::
£tfl
('0');

154 ià(
	ghrs
) {

155 
	g¡rm
 << 
	g¡d
::
£tw
(2è<< 
hrs
 << ":";

157 
	g¡rm
 << 
	g¡d
::
£tw
(2è<< 
mš
 << ":" << 
¡d
::£tw(2è<< 
£c
;

159  
	g¡rm
.
¡r
();

	@src/workload/tpce/egen/threading.cpp

37 
	~"wÜklßd/û/eg’/th»adšg.h
"

39 
	~<io¡»am
>

40 
	~<s¡»am
>

41 
	~<¡dexû±
>

42 
	~<û¼no
>

43 
	~<c¡dlib
>

45 
	~"wÜklßd/û/eg’/”rÜ.h
"

47 
usšg
 
	g¡d
::
¡»¼Ü
;

48 
usšg
 
	g¡d
::
ex™
;

50 
Çme¥aû
 
	gTPCE


53 
	gTh»adBa£
::~
Th»adBa£
()

57 #ifdeà
WIN32


58 
DWORD
 
WINAPI
 
¡¬t_th»ad
(
LPVOID
 
¬g
)

61 * 
¡¬t_th»ad
(*
¬g
)

64 
Th»adBa£
* 
thrd
 = 
»š‹½»t_ÿ¡
<Th»adBa£*>(
¬g
);

68 
Œy
 {

69 
thrd
->
švoke
();

70  
NULL
;

71 } 
ÿtch
 (
¡d
::
exû±iÚ
& 
e
) {

72 
¡d
::
û¼
 << "CaughˆExû±iÚ: " << 
e
.
wh©
(è<< std::
’dl
;

73 } 
ÿtch
 (...) {

74 
¡d
::
û¼
 << "CaughˆExû±iÚ: Unknown" << std::
’dl
;

76 
ex™
 (1);

77  
NULL
;

	@src/workload/tpce/shore_tpce_client.cpp

31 
	~"wÜklßd/û/shÜe_û_ş›Á.h
"

34 
ENTER_NAMESPACE
(
û
);

45 
	gba£lše_û_ş›Á_t
::
	$ba£lše_û_ş›Á_t
(
c_¡r
 
Šame
, cÚ¡ 
id
,

46 
ShÜeTPCEEnv
* 
’v
,

47 cÚ¡ 
M—su»m’tTy³
 
aTy³
,

48 cÚ¡ 
Œxid
,

49 cÚ¡ 
numOfTrxs
,

50 
´oûssÜid_t
 
­rsid
,

51 cÚ¡ 
£lID
, cÚ¡ 
qf
)

52 : 
	`ba£_ş›Á_t
(
Šame
,
id
,
’v
,
aTy³
,
Œxid
,
numOfTrxs
,
­rsid
),

53 
	`_£lid
(
£lID
), 
	$_qf
(
qf
)

55 
	`as£¹
 (
’v
);

56 
	`as£¹
 (
_id
>=0 && 
_qf
>0);

59 
_wÜk”
 = 
_’v
->
	`wÜk”
(
_id
);

60 
	`as£¹
 (
_wÜk”
);

61 
	}
}

64 cÚ¡ 
	gba£lše_û_ş›Á_t
::
	$lßd_sup_xù
(
m­SupTrxs
& 
¡m­
)

67 
¡m­
.
	`ş—r
();

69 
¡m­
[
XCT_TPCE_MIX
] = "TPC-E MIX";

70 
¡m­
[
XCT_TPCE_BROKER_VOLUME
] = "TPC-E BROKER_VOLUME";

71 
¡m­
[
XCT_TPCE_CUSTOMER_POSITION
]= "TPC-E CUSTOMER_POSITION";

72 
¡m­
[
XCT_TPCE_MARKET_FEED
] = "TPC-E MARKET_FEED";

73 
¡m­
[
XCT_TPCE_MARKET_WATCH
] = "TPC-E MARKET_WATCH";

74 
¡m­
[
XCT_TPCE_SECURITY_DETAIL
] = "TPC-E SECURITY_DETAIL";

75 
¡m­
[
XCT_TPCE_TRADE_LOOKUP
] = "TPC-E TRADE_LOOKUP";

76 
¡m­
[
XCT_TPCE_TRADE_ORDER
] = "TPC-E TRADE_ORDER";

77 
¡m­
[
XCT_TPCE_TRADE_RESULT
] = "TPC-E TRADE_RESULT";

78 
¡m­
[
XCT_TPCE_TRADE_STATUS
] = "TPC-E TRADE_STATUS";

79 
¡m­
[
XCT_TPCE_TRADE_UPDATE
] = "TPC-E TRADE_UPDATE";

80 
¡m­
[
XCT_TPCE_DATA_MAINTENANCE
] = "TPC-E DATA_MAINTENANCE";

81 
¡m­
[
XCT_TPCE_TRADE_CLEANUP
] = "TPC-E TRADE_CLEANUP";

83  (
¡m­
.
	`size
());

84 
	}
}

98 
w_rc_t
 
	gba£lše_û_ş›Á_t
::
	$subm™_Úe
(
xù_ty³
, 
xùid
)

101 
Œx_»suÉ_tu¶e_t
 
©¹
;

102 
boŞ
 
bWake
 = 
çl£
;

103 ià(
cÚdex
* 
c
 = 
_ı
->
	`ke_Úe
()) {

104 
©¹
.
	`£t_nÙify
(
c
);

105 
bWake
 = 
Œue
;

109 
£lid
 = 
_£lid
;

114 
Œx_»que¡_t
* 
¬eque¡
 = 
	`Ãw
 (
_’v
->
_»que¡_poŞ
)rx_request_t;

115 
tid_t
 
©id
;

116 
¬eque¡
->
	`£t
(
NULL
,
©id
,
xùid
,
©¹
,
xù_ty³
,
£lid
);

119 
	`as£¹
 (
_wÜk”
);

120 
_wÜk”
->
	`’queue
(
¬eque¡
,
bWake
);

121  (
RCOK
);

122 
	}
}

125 
EXIT_NAMESPACE
(
û
);

	@src/workload/tpce/shore_tpce_env.cpp

32 
	~"wÜklßd/û/shÜe_û_’v.h
"

33 
	~"sm/shÜe/shÜe_h–³r_lßd”.h
"

35 
	~<w_defšes.h
>

36 
	~"wÜklßd/û/eg’/CE.h
"

37 
	~<¡dio.h
>

39 
usšg
 
Çme¥aû
 
	gshÜe
;

40 
usšg
 
Çme¥aû
 
	gTPCE
;

46 
ENTER_NAMESPACE
(
shÜe
);

47 
DEFINE_ROW_CACHE_TLS
(
û
, 
£ùÜ
);

48 
DEFINE_ROW_CACHE_TLS
(
û
, 
ch¬ge
);

49 
DEFINE_ROW_CACHE_TLS
(
û
, 
commissiÚ_¿‹
);

50 
DEFINE_ROW_CACHE_TLS
(
û
, 
exchªge
);

51 
DEFINE_ROW_CACHE_TLS
(
û
, 
šdu¡ry
);

52 
DEFINE_ROW_CACHE_TLS
(
û
, 
¡©us_ty³
);

53 
DEFINE_ROW_CACHE_TLS
(
û
, 
x¿‹
);

54 
DEFINE_ROW_CACHE_TLS
(
û
, 
Œade_ty³
);

55 
DEFINE_ROW_CACHE_TLS
(
û
, 
z_code
);

56 
DEFINE_ROW_CACHE_TLS
(
û
, 
ÿsh_Œª§ùiÚ
);

57 
DEFINE_ROW_CACHE_TLS
(
û
, 
£‰Ëm’t
);

58 
DEFINE_ROW_CACHE_TLS
(
û
, 
Œade
);

59 
DEFINE_ROW_CACHE_TLS
(
û
, 
Œade_hi¡Üy
);

60 
DEFINE_ROW_CACHE_TLS
(
û
, 
Œade_»que¡
);

61 
DEFINE_ROW_CACHE_TLS
(
û
, 
accouÁ_³rmissiÚ
);

62 
DEFINE_ROW_CACHE_TLS
(
û
, 
brok”
);

63 
DEFINE_ROW_CACHE_TLS
(
û
, 
com·ny
);

64 
DEFINE_ROW_CACHE_TLS
(
û
, 
cu¡om”
);

65 
DEFINE_ROW_CACHE_TLS
(
û
, 
com·ny_com³t™Ü
);

66 
DEFINE_ROW_CACHE_TLS
(
û
, 
£cur™y
);

67 
DEFINE_ROW_CACHE_TLS
(
û
, 
cu¡om”_accouÁ
);

68 
DEFINE_ROW_CACHE_TLS
(
û
, 
day_m¬k‘
);

69 
DEFINE_ROW_CACHE_TLS
(
û
, 
cu¡om”_x¿‹
);

70 
DEFINE_ROW_CACHE_TLS
(
û
, 
hŞdšg
);

71 
DEFINE_ROW_CACHE_TLS
(
û
, 
fšªcŸl
);

72 
DEFINE_ROW_CACHE_TLS
(
û
, 
hŞdšg_hi¡Üy
);

73 
DEFINE_ROW_CACHE_TLS
(
û
, 
add»ss
);

74 
DEFINE_ROW_CACHE_TLS
(
û
, 
hŞdšg_summ¬y
);

75 
DEFINE_ROW_CACHE_TLS
(
û
, 
Ï¡_Œade
);

76 
DEFINE_ROW_CACHE_TLS
(
û
, 
w©ch_™em
);

77 
DEFINE_ROW_CACHE_TLS
(
û
, 
Ãws_™em
);

78 
DEFINE_ROW_CACHE_TLS
(
û
, 
w©ch_li¡
);

79 
DEFINE_ROW_CACHE_TLS
(
û
, 
Ãws_x»f
);

80 
EXIT_NAMESPACE
(
shÜe
);

84 
ENTER_NAMESPACE
(
û
);

86 
CCETxnIÅutG’”©Ü
* 
	gm_TxnIÅutG’”©Ü
;

87 
CDM
* 
	gm_CDM
;

88 
CMEESUT
* 
	gm“sut
;

89 
CMEE
* 
	gm“
;

90 
MFBufãr
* 
	gM¬k‘F“dIÅutBufãr
;

91 
TRBufãr
* 
	gT¿deResuÉIÅutBufãr
;

93 #ifdeà
COMPILE_FLAT_FILE_LOAD


94 
FILE
 *
	gfs£c
, *
	gfshs
;

100 
	$AutoRªd
()

102 
timev®
 
tv
;

103 
tm
 
Ér
;

104 
	`g‘timeofday
(&
tv
, 
NULL
);

105 
tm
* 
É
 = 
	`loÿÉime_r
(&
tv
.
tv_£c
, &
Ér
);

106  (((
É
->
tm_hour
 * 
Mšu‹sP”Hour
 +†t->
tm_mš
è* 
SecÚdsP”Mšu‹
 +

107 
É
->
tm_£c
è* 
MsP”SecÚd
 + 
tv
.
tv_u£c
 / 1000);

108 
	}
}

110 
	$£tRNGS“ds
(
CCETxnIÅutG’”©Ü
* 
g’
, 
UniqueId
 )

112 
CD©eTime
 
Now
;

113 
INT32
 
Ba£Y—r
;

114 
INT32
 
Tmp1
, 
Tmp2
;

116 
Now
.
	`G‘YMD
Ğ&
Ba£Y—r
, &
Tmp1
, &
Tmp2
 );

119 
Ba£Y—r
 -= ( BaseYear % 5 );

120 
CD©eTime
 
	`Ba£
Ğ
Ba£Y—r
, 1, 1 );

124 
RNGSEED
 
S“d
;

125 
S“d
 = 
Now
.
	`MSec
() / 100;

130 
S“d
 <<= 11;

131 
S“d
 +ğ(
RNGSEED
)((
INT64
)
Now
.
	`DayNo
(è- (INT64)
Ba£
.DayNo());

137 
S“d
 <<= 33;

142 
S“d
 +ğ
UniqueId
;

145 
g’
->
	`S‘RNGS“d
Ğ
S“d
 );

149 
S“d
 |ğ
	`UINT64_CONST
(0x0000000100000000);

150 
g’
->
	`S‘RNGS“d
Ğ
S“d
 );

152 
	}
}

156 
	$´štC¬dš®™y
()

158 
	`´štf
("accouÁP”missiÚBufãr.g‘CÁ(è %d\n",
accouÁP”missiÚBufãr
.
	`g‘CÁ
() );

159 
	`´štf
("cu¡om”AccouÁBufãr.g‘CÁ(è %d\n",
cu¡om”AccouÁBufãr
.
	`g‘CÁ
() );

160 
	`´štf
("cu¡om”Tax¿‹Bufãr.g‘CÁ(è %d\n",
cu¡om”Tax¿‹Bufãr
.
	`g‘CÁ
() );

161 
	`´štf
("cu¡om”Bufãr.g‘CÁ(è %d\n",
cu¡om”Bufãr
.
	`g‘CÁ
() );

162 
	`´štf
("hŞdšgBufãr.g‘CÁ(è %d\n",
hŞdšgBufãr
.
	`g‘CÁ
() );

163 
	`´štf
("w©chI‹mBufãr.g‘CÁ(è %d\n",
w©chI‹mBufãr
.
	`g‘CÁ
() );

164 
	`´štf
("w©chLi¡Bufãr.g‘CÁ(è %d\n",
w©chLi¡Bufãr
.
	`g‘CÁ
() );

165 
	`´štf
("brok”Bufãr.g‘CÁ(è %d\n",
brok”Bufãr
.
	`g‘CÁ
() );

166 
	`´štf
("ÿshT¿n§ùiÚBufãr.g‘CÁ(è %d\n",
ÿshT¿n§ùiÚBufãr
.
	`g‘CÁ
() );

167 
	`´štf
("ch¬geBufãr.g‘CÁ(è %d\n",
ch¬geBufãr
.
	`g‘CÁ
() );

168 
	`´štf
("hŞdšgHi¡ÜyBufãr.g‘CÁ(è %d\n",
hŞdšgHi¡ÜyBufãr
.
	`g‘CÁ
() );

169 
	`´štf
("hŞdšgSumm¬yBufãr.g‘CÁ(è %d\n",
hŞdšgSumm¬yBufãr
.
	`g‘CÁ
() );

170 
	`´štf
("commissiÚR©eBufãr.g‘CÁ(è %d\n",
commissiÚR©eBufãr
.
	`g‘CÁ
() );

171 
	`´štf
("com·nyBufãr.g‘CÁ(è %d\n",
com·nyBufãr
.
	`g‘CÁ
() );

172 
	`´štf
("com·nyCom³t™ÜBufãr.g‘CÁ(è %d\n",
com·nyCom³t™ÜBufãr
.
	`g‘CÁ
() );

173 
	`´štf
("dayM¬k‘Bufãr.g‘CÁ(è %d\n",
dayM¬k‘Bufãr
.
	`g‘CÁ
() );

176 
	`´štf
("£‰Ëm’tBufãr.g‘CÁ(è %d\n",
£‰Ëm’tBufãr
.
	`g‘CÁ
() );

177 
	`´štf
("ŒadeBufãr.g‘CÁ(è %d\n",
ŒadeBufãr
.
	`g‘CÁ
() );

178 
	`´štf
("ŒadeHi¡ÜyBufãr.g‘CÁ(è %d\n",
ŒadeHi¡ÜyBufãr
.
	`g‘CÁ
() );

179 
	`´štf
("ŒadeTy³Bufãr.g‘CÁ(è %d\n",
ŒadeTy³Bufãr
.
	`g‘CÁ
() );

182 
	`´štf
("exchªgeBufãr.g‘CÁ(è %d\n",
exchªgeBufãr
.
	`g‘CÁ
() );

183 
	`´štf
("fšªcŸlBufãr.g‘CÁ(è %d\n",
fšªcŸlBufãr
.
	`g‘CÁ
() );

184 
	`´štf
("šdu¡ryBufãr.g‘CÁ(è %d\n",
šdu¡ryBufãr
.
	`g‘CÁ
() );

185 
	`´štf
("ÃwsI‹mBufãr.g‘CÁ(è %d\n",
ÃwsI‹mBufãr
.
	`g‘CÁ
() );

186 
	`´štf
("Ï¡T¿deBufãr.g‘CÁ(è %d\n",
Ï¡T¿deBufãr
.
	`g‘CÁ
() );

187 
	`´štf
("ÃwsXRefBufãr.g‘CÁ(è %d\n",
ÃwsXRefBufãr
.
	`g‘CÁ
() );

188 
	`´štf
("£ùÜBufãr.g‘CÁ(è %d\n",
£ùÜBufãr
.
	`g‘CÁ
() );

189 
	`´štf
("£cur™yBufãr.g‘CÁ(è %d\n",
£cur™yBufãr
.
	`g‘CÁ
() );

190 
	`´štf
("add»ssBufãr.g‘CÁ(è %d\n",
add»ssBufãr
.
	`g‘CÁ
() );

191 
	`´štf
("¡©usTy³Bufãr.g‘CÁ(è %d\n",
¡©usTy³Bufãr
.
	`g‘CÁ
() );

192 
	`´štf
("x¿‹Bufãr.g‘CÁ(è %d\n",
x¿‹Bufãr
.
	`g‘CÁ
() );

193 
	`´štf
("zCodeBufãr.g‘CÁ(è %d\n",
zCodeBufãr
.
	`g‘CÁ
() );

194 
	}
}

197 
	$‹¡IÅuts
()

199 
i
=0; i<5; i++) {

200 
Œade_lookup_šput_t
 
š4
 = 
	`ü—‹_Œade_lookup_šput
(0,0);

201 
š4
.
	`´št
();

203 
i
=0; i<2; i++è{ 
Œade_lookup_šput_t
 
š41
 = 
	`ü—‹_Œade_lookup_šput
(0,0);

204 
š41
.
	`´št
();

206 
i
=0; i<2; i++è{ 
m¬k‘_w©ch_šput_t
 
š5
 = 
	`ü—‹_m¬k‘_w©ch_šput
(0,0);

207 
š5
.
	`´št
();

209 
i
=0; i<2; i++è{ 
£cur™y_d‘a_šput_t
 
š6
 = 
	`ü—‹_£cur™y_d‘a_šput
(0,0);

210 
š6
.
	`´št
();

212 
Œade_¡©us_šput_t
 
š7
 = 
	`ü—‹_Œade_¡©us_šput
(0,0);

213 
š7
.
	`´št
();

214 
i
=0; i<2; i++è{ 
Œade_upd©e_šput_t
 
š8
 = 
	`ü—‹_Œade_upd©e_šput
(0,0);

215 
š8
.
	`´št
();

217 
i
=0; i<2; i++) {

218 
d©a_maš‹Çnû_šput_t
 
š9
 = 
	`ü—‹_d©a_maš‹Çnû_šput
(0,0);

219 
š9
.
	`´št
();

221 
i
=0; i<2; i++) {

222 
Œade_ş—nup_šput_t
 
š10
 = 
	`ü—‹_Œade_ş—nup_šput
(0,0);

223 
š10
.
	`´št
();

226 
i
=0; i<2; i++) {

227 
Œade_»suÉ_šput_t
 
š10
 = 
	`ü—‹_Œade_»suÉ_šput
(0,0);

228 
š10
.
	`´št
();

231 
i
=0; i<2; i++) {

232 
m¬k‘_ãed_šput_t
 
š10
 = 
	`ü—‹_m¬k‘_ãed_šput
(0,0);

233 
š10
.
	`´št
();

235 
	}
}

246 
	gShÜeTPCEEnv
::
	$ShÜeTPCEEnv
():

247 
	`ShÜeEnv
(), 
	$_num_šv®id_šput
(0)

254 
_cu¡om”s
 = 
	`upd_sf
(è* 
TPCE_CUSTS_PER_LU
;

255 
_wÜkšg_days
 = 
’vV¬
::
	`š¡ªû
()->
	`g‘SysV¬IÁ
("wd");

256 
_sÿlšg_çùÜ_û
 = 
’vV¬
::
	`š¡ªû
()->
	`g‘SysV¬IÁ
("sfe");

258 
sã_¡r
[8], 
wd_¡r
[8], 
cu¡_¡r
[8];

259 
	`mem£t
(
sã_¡r
,0,8);

260 
	`mem£t
(
wd_¡r
,0,8);

261 
	`mem£t
(
cu¡_¡r
,0,8);

262 
	`¥rštf
(
sã_¡r
, "%d",
_sÿlšg_çùÜ_û
);

263 
	`¥rštf
(
wd_¡r
, "%d",
_wÜkšg_days
);

264 
	`¥rštf
(
cu¡_¡r
, "%d",
_cu¡om”s
);

268 #ifdeà
COMPILE_FLAT_FILE_LOAD


269 
fs£c
 = 
	`fİ’
("shoresecurity.txt","wt");

270 
fshs
 = 
	`fİ’
("shorehsummary.txt","wt");

271 cÚ¡ * 
·¿ms
[] = {"to_sk", "-i", "./¤c/wÜklßd/û/eg’/æ©/eg’_æ©_š/","-o", "./¤c/wÜklßd/û/eg’/æ©/eg’_æ©_out/", "-l", "FLAT", "-f", 
sã_¡r
, "-w", 
wd_¡r
, "-c", 
cu¡_¡r
, "-t", cust_str };

272 
	`eg’_š™
(15, (**)
·¿ms
);

274 cÚ¡ * 
·¿ms
[] = {"to_sk", "-i", "./¤c/wÜklßd/û/eg’/æ©/eg’_æ©_š/", "-l", "NULL", "-f", 
sã_¡r
, "-w", 
wd_¡r
, "-c", 
cu¡_¡r
, "-t", cust_str };

275 
	`eg’_š™
(13, (**)
·¿ms
);

279 
m_TxnIÅutG’”©Ü
 = 
	`Œª§ùiÚs_šput_š™
(
_cu¡om”s
, 
_sÿlšg_çùÜ_û
 , 
_wÜkšg_days
);

281 
£ed
 = 
	`AutoRªd
();

282 
	`£tRNGS“ds
(
m_TxnIÅutG’”©Ü
, 
£ed
);

284 
m_CDM
 = 
	`d©a_maš‹Çnû_š™
(
_cu¡om”s
, 
_sÿlšg_çùÜ_û
, 
_wÜkšg_days
);

287 
M¬k‘F“dIÅutBufãr
 = 
Ãw
 
	`MFBufãr
();

288 
T¿deResuÉIÅutBufãr
 = 
Ãw
 
	`TRBufãr
();

290 
m“sut
 = 
Ãw
 
	`CMEESUT
();

291 
m“sut
->
	`£tMFQueue
(
M¬k‘F“dIÅutBufãr
);

292 
m“sut
->
	`£tTRQueue
(
T¿deResuÉIÅutBufãr
);

293 
m“
 = 
	`m¬k‘_š™
Ğ
_wÜkšg_days
*8, 
m“sut
, 
	`AutoRªd
());

295 #ifdeà
TESTING_TPCE


296 
i
=0; i<10; i++è
Œxs_út_execu‹d
[i]ğ
Œxs_út_çed
[i]=0;

298 
T¿deOrd”CÁ
 = 0;

300 
	}
}

302 
	gShÜeTPCEEnv
::~
	$ShÜeTPCEEnv
()

304 
	`eg’_»Ëa£
();

305 ià(
m_TxnIÅutG’”©Ü
è
d–‘e
 m_TxnInputGenerator;

306 ià(
M¬k‘F“dIÅutBufãr
è
d–‘e
 MarketFeedInputBuffer;

307 ià(
T¿deResuÉIÅutBufãr
è
d–‘e
 TradeResultInputBuffer;

308 ià(
m“sut
è
d–‘e
 meesut;

309 
	}
}

313 
w_rc_t
 
	gShÜeTPCEEnv
::
	$lßd_schema
()

316 
_·ccouÁ_³rmissiÚ_desc
 = 
Ãw
 
	`accouÁ_³rmissiÚ_t
(
	`g‘_pd
());

317 
_pcu¡om”_desc
 = 
Ãw
 
	`cu¡om”_t
(
	`g‘_pd
());

318 
_pcu¡om”_accouÁ_desc
 = 
Ãw
 
	`cu¡om”_accouÁ_t
(
	`g‘_pd
());

319 
_pcu¡om”_x¿‹_desc
 = 
Ãw
 
	`cu¡om”_x¿‹_t
(
	`g‘_pd
());

320 
_phŞdšg_desc
 = 
Ãw
 
	`hŞdšg_t
(
	`g‘_pd
());

321 
_phŞdšg_hi¡Üy_desc
 = 
Ãw
 
	`hŞdšg_hi¡Üy_t
(
	`g‘_pd
());

322 
_phŞdšg_summ¬y_desc
 = 
Ãw
 
	`hŞdšg_summ¬y_t
(
	`g‘_pd
());

323 
_pw©ch_™em_desc
 = 
Ãw
 
	`w©ch_™em_t
(
	`g‘_pd
());

324 
_pw©ch_li¡_desc
 = 
Ãw
 
	`w©ch_li¡_t
(
	`g‘_pd
());

325 
_pbrok”_desc
 = 
Ãw
 
	`brok”_t
(
	`g‘_pd
());

326 
_pÿsh_Œª§ùiÚ_desc
 = 
Ãw
 
	`ÿsh_Œª§ùiÚ_t
(
	`g‘_pd
());

327 
_pch¬ge_desc
 = 
Ãw
 
	`ch¬ge_t
(
	`g‘_pd
());

328 
_pcommissiÚ_¿‹_desc
 = 
Ãw
 
	`commissiÚ_¿‹_t
(
	`g‘_pd
());

329 
_p£‰Ëm’t_desc
 = 
Ãw
 
	`£‰Ëm’t_t
(
	`g‘_pd
());

330 
_±¿de_desc
 = 
Ãw
 
	`Œade_t
(
	`g‘_pd
());

331 
_±¿de_hi¡Üy_desc
 = 
Ãw
 
	`Œade_hi¡Üy_t
(
	`g‘_pd
());

332 
_±¿de_»que¡_desc
 = 
Ãw
 
	`Œade_»que¡_t
(
	`g‘_pd
());

333 
_±¿de_ty³_desc
 = 
Ãw
 
	`Œade_ty³_t
(
	`g‘_pd
());

334 
_pcom·ny_desc
 = 
Ãw
 
	`com·ny_t
(
	`g‘_pd
());

335 
_pcom·ny_com³t™Ü_desc
 = 
Ãw
 
	`com·ny_com³t™Ü_t
(
	`g‘_pd
());

336 
_pday_m¬k‘_desc
 = 
Ãw
 
	`day_m¬k‘_t
(
	`g‘_pd
());

337 
_³xchªge_desc
 = 
Ãw
 
	`exchªge_t
(
	`g‘_pd
());

338 
_pfšªcŸl_desc
 = 
Ãw
 
	`fšªcŸl_t
(
	`g‘_pd
());

339 
_pšdu¡ry_desc
 = 
Ãw
 
	`šdu¡ry_t
(
	`g‘_pd
());

340 
_¶a¡_Œade_desc
 = 
Ãw
 
	`Ï¡_Œade_t
(
	`g‘_pd
());

341 
_²ews_™em_desc
 = 
Ãw
 
	`Ãws_™em_t
(
	`g‘_pd
());

342 
_²ews_x»f_desc
 = 
Ãw
 
	`Ãws_x»f_t
(
	`g‘_pd
());

343 
_p£ùÜ_desc
 = 
Ãw
 
	`£ùÜ_t
(
	`g‘_pd
());

344 
_p£cur™y_desc
 = 
Ãw
 
	`£cur™y_t
(
	`g‘_pd
());

345 
_·dd»ss_desc
 = 
Ãw
 
	`add»ss_t
(
	`g‘_pd
());

346 
_p¡©us_ty³_desc
 = 
Ãw
 
	`¡©us_ty³_t
(
	`g‘_pd
());

347 
_±ax¿‹_desc
 = 
Ãw
 
	`x¿‹_t
(
	`g‘_pd
());

348 
_pz_code_desc
 = 
Ãw
 
	`z_code_t
(
	`g‘_pd
());

352 
_·ccouÁ_³rmissiÚ_mª
 = 
Ãw
 
	`accouÁ_³rmissiÚ_mª_im¶
(
_·ccouÁ_³rmissiÚ_desc
.
	`g‘
());

353 
_pcu¡om”_mª
 = 
Ãw
 
	`cu¡om”_mª_im¶
(
_pcu¡om”_desc
.
	`g‘
());

354 
_pcu¡om”_accouÁ_mª
 = 
Ãw
 
	`cu¡om”_accouÁ_mª_im¶
(
_pcu¡om”_accouÁ_desc
.
	`g‘
());

355 
_pcu¡om”_x¿‹_mª
 = 
Ãw
 
	`cu¡om”_x¿‹_mª_im¶
(
_pcu¡om”_x¿‹_desc
.
	`g‘
());

356 
_phŞdšg_mª
 = 
Ãw
 
	`hŞdšg_mª_im¶
(
_phŞdšg_desc
.
	`g‘
());

357 
_phŞdšg_hi¡Üy_mª
 = 
Ãw
 
	`hŞdšg_hi¡Üy_mª_im¶
(
_phŞdšg_hi¡Üy_desc
.
	`g‘
());

358 
_phŞdšg_summ¬y_mª
 = 
Ãw
 
	`hŞdšg_summ¬y_mª_im¶
(
_phŞdšg_summ¬y_desc
.
	`g‘
());

359 
_pw©ch_™em_mª
 = 
Ãw
 
	`w©ch_™em_mª_im¶
(
_pw©ch_™em_desc
.
	`g‘
());

360 
_pw©ch_li¡_mª
 = 
Ãw
 
	`w©ch_li¡_mª_im¶
(
_pw©ch_li¡_desc
.
	`g‘
());

361 
_pbrok”_mª
 = 
Ãw
 
	`brok”_mª_im¶
(
_pbrok”_desc
.
	`g‘
());

362 
_pÿsh_Œª§ùiÚ_mª
 = 
Ãw
 
	`ÿsh_Œª§ùiÚ_mª_im¶
(
_pÿsh_Œª§ùiÚ_desc
.
	`g‘
());

363 
_pch¬ge_mª
 = 
Ãw
 
	`ch¬ge_mª_im¶
(
_pch¬ge_desc
.
	`g‘
());

364 
_pcommissiÚ_¿‹_mª
 = 
Ãw
 
	`commissiÚ_¿‹_mª_im¶
(
_pcommissiÚ_¿‹_desc
.
	`g‘
());

365 
_p£‰Ëm’t_mª
 = 
Ãw
 
	`£‰Ëm’t_mª_im¶
(
_p£‰Ëm’t_desc
.
	`g‘
());

366 
_±¿de_mª
 = 
Ãw
 
	`Œade_mª_im¶
(
_±¿de_desc
.
	`g‘
());

367 
_±¿de_hi¡Üy_mª
 = 
Ãw
 
	`Œade_hi¡Üy_mª_im¶
(
_±¿de_hi¡Üy_desc
.
	`g‘
());

368 
_±¿de_»que¡_mª
 = 
Ãw
 
	`Œade_»que¡_mª_im¶
(
_±¿de_»que¡_desc
.
	`g‘
());

369 
_±¿de_ty³_mª
 = 
Ãw
 
	`Œade_ty³_mª_im¶
(
_±¿de_ty³_desc
.
	`g‘
());

370 
_pcom·ny_mª
 = 
Ãw
 
	`com·ny_mª_im¶
(
_pcom·ny_desc
.
	`g‘
());

371 
_pcom·ny_com³t™Ü_mª
 = 
Ãw
 
	`com·ny_com³t™Ü_mª_im¶
(
_pcom·ny_com³t™Ü_desc
.
	`g‘
());

372 
_pday_m¬k‘_mª
 = 
Ãw
 
	`day_m¬k‘_mª_im¶
(
_pday_m¬k‘_desc
.
	`g‘
());

373 
_³xchªge_mª
 = 
Ãw
 
	`exchªge_mª_im¶
(
_³xchªge_desc
.
	`g‘
());

374 
_pfšªcŸl_mª
 = 
Ãw
 
	`fšªcŸl_mª_im¶
(
_pfšªcŸl_desc
.
	`g‘
());

375 
_pšdu¡ry_mª
 = 
Ãw
 
	`šdu¡ry_mª_im¶
(
_pšdu¡ry_desc
.
	`g‘
());

376 
_¶a¡_Œade_mª
 = 
Ãw
 
	`Ï¡_Œade_mª_im¶
(
_¶a¡_Œade_desc
.
	`g‘
());

377 #w¬nšg 
we
 
mu¡
 
£t
 
this
 
to
 10000 
š¡ed
 
of
 100.000

378 
_²ews_™em_mª
 = 
Ãw
 
	`Ãws_™em_mª_im¶
(
_²ews_™em_desc
.
	`g‘
());

379 
_²ews_x»f_mª
 = 
Ãw
 
	`Ãws_x»f_mª_im¶
(
_²ews_x»f_desc
.
	`g‘
());

380 
_p£ùÜ_mª
 = 
Ãw
 
	`£ùÜ_mª_im¶
(
_p£ùÜ_desc
.
	`g‘
());

381 
_p£cur™y_mª
 = 
Ãw
 
	`£cur™y_mª_im¶
(
_p£cur™y_desc
.
	`g‘
());

382 
_·dd»ss_mª
 = 
Ãw
 
	`add»ss_mª_im¶
(
_·dd»ss_desc
.
	`g‘
());

383 
_p¡©us_ty³_mª
 = 
Ãw
 
	`¡©us_ty³_mª_im¶
(
_p¡©us_ty³_desc
.
	`g‘
());

384 
_±ax¿‹_mª
 = 
Ãw
 
	`x¿‹_mª_im¶
(
_±ax¿‹_desc
.
	`g‘
());

385 
_pz_code_mª
 = 
Ãw
 
	`z_code_mª_im¶
(
_pz_code_desc
.
	`g‘
());

387  (
RCOK
);

388 
	}
}

392 
w_rc_t
 
	gShÜeTPCEEnv
::
	$lßd_ªd_»gi¡”_fids
()

394 
	`W_DO
(
_·ccouÁ_³rmissiÚ_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

395 
	`W_DO
(
_pcu¡om”_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

396 
	`W_DO
(
_pcu¡om”_accouÁ_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

397 
	`W_DO
(
_pcu¡om”_x¿‹_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

398 
	`W_DO
(
_phŞdšg_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

399 
	`W_DO
(
_phŞdšg_hi¡Üy_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

400 
	`W_DO
(
_phŞdšg_summ¬y_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

401 
	`W_DO
(
_pw©ch_™em_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

402 
	`W_DO
(
_pw©ch_li¡_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

403 
	`W_DO
(
_pbrok”_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

404 
	`W_DO
(
_pÿsh_Œª§ùiÚ_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

405 
	`W_DO
(
_pch¬ge_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

406 
	`W_DO
(
_pcommissiÚ_¿‹_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

407 
	`W_DO
(
_p£‰Ëm’t_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

408 
	`W_DO
(
_±¿de_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

409 
	`W_DO
(
_±¿de_hi¡Üy_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

410 
	`W_DO
(
_±¿de_»que¡_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

411 
	`W_DO
(
_±¿de_ty³_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

412 
	`W_DO
(
_pcom·ny_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

413 
	`W_DO
(
_pcom·ny_com³t™Ü_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

414 
	`W_DO
(
_pday_m¬k‘_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

415 
	`W_DO
(
_³xchªge_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

416 
	`W_DO
(
_pfšªcŸl_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

417 
	`W_DO
(
_pšdu¡ry_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

418 
	`W_DO
(
_¶a¡_Œade_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

419 
	`W_DO
(
_²ews_™em_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

420 
	`W_DO
(
_²ews_x»f_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

421 
	`W_DO
(
_p£ùÜ_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

422 
	`W_DO
(
_p£cur™y_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

423 
	`W_DO
(
_·dd»ss_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

424 
	`W_DO
(
_p¡©us_ty³_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

425 
	`W_DO
(
_±ax¿‹_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

426 
	`W_DO
(
_pz_code_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

427  (
RCOK
);

428 
	}
}

440 
	gShÜeTPCEEnv
::
	$šfo
() const

442 
	`TRACE
Ğ
TRACE_ALWAYS
, "SF = (%d)\n", 
_sÿlšg_çùÜ
);

444 
	}
}

455 
	gShÜeTPCEEnv
::
	$¡©i¡ics
()

458 
	`CRITICAL_SECTION
(
cs
, 
_¡©m­_mu‹x
);

459 
ShÜeTPCETrxSts
 
rv®
;

460 
rv®
 -=„val;

461 
¡©m­_t
::
™”©Ü
 
™
=
_¡©m­
.
	`begš
(); iˆ!ğ_¡©m­.
	`’d
(); ++it)

462 
rv®
 +ğ*
™
->
£cÚd
;

464 
	`TRACE
Ğ
TRACE_STATISTICS
, "BrokerVolume. Att (%d). Abt (%d). Dld (%d)\n",

465 
rv®
.
©‹m±ed
.
brok”_vŞume
,

466 
rv®
.
çed
.
brok”_vŞume
,

467 
rv®
.
d—dlocked
.
brok”_vŞume
);

469 
	`TRACE
Ğ
TRACE_STATISTICS
, "CustomerPosition. Att (%d). Abt (%d). Dld (%d)\n",

470 
rv®
.
©‹m±ed
.
cu¡om”_pos™iÚ
,

471 
rv®
.
çed
.
cu¡om”_pos™iÚ
,

472 
rv®
.
d—dlocked
.
cu¡om”_pos™iÚ
);

474 
	`TRACE
Ğ
TRACE_STATISTICS
, "MarketFeed. Att (%d). Abt (%d). Dld (%d)\n",

475 
rv®
.
©‹m±ed
.
m¬k‘_ãed
,

476 
rv®
.
çed
.
m¬k‘_ãed
,

477 
rv®
.
d—dlocked
.
m¬k‘_ãed
);

479 
	`TRACE
Ğ
TRACE_STATISTICS
, "MarketWatch. Att (%d). Abt (%d). Dld (%d)\n",

480 
rv®
.
©‹m±ed
.
m¬k‘_w©ch
,

481 
rv®
.
çed
.
m¬k‘_w©ch
,

482 
rv®
.
d—dlocked
.
m¬k‘_w©ch
);

484 
	`TRACE
Ğ
TRACE_STATISTICS
, "SecurityDetail. Att (%d). Abt (%d). Dld (%d)\n",

485 
rv®
.
©‹m±ed
.
£cur™y_d‘a
,

486 
rv®
.
çed
.
£cur™y_d‘a
,

487 
rv®
.
d—dlocked
.
£cur™y_d‘a
);

489 
	`TRACE
Ğ
TRACE_STATISTICS
, "TradeLookup. Att (%d). Abt (%d). Dld (%d)\n",

490 
rv®
.
©‹m±ed
.
Œade_lookup
,

491 
rv®
.
çed
.
Œade_lookup
,

492 
rv®
.
d—dlocked
.
Œade_lookup
);

494 
	`TRACE
Ğ
TRACE_STATISTICS
, "TradeOrder. Att (%d). Abt (%d). Dld (%d)\n",

495 
rv®
.
©‹m±ed
.
Œade_Üd”
,

496 
rv®
.
çed
.
Œade_Üd”
,

497 
rv®
.
d—dlocked
.
Œade_Üd”
);

499 
	`TRACE
Ğ
TRACE_STATISTICS
, "TradeResult. Att (%d). Abt (%d). Dld (%d)\n",

500 
rv®
.
©‹m±ed
.
Œade_»suÉ
,

501 
rv®
.
çed
.
Œade_»suÉ
,

502 
rv®
.
d—dlocked
.
Œade_»suÉ
);

504 
	`TRACE
Ğ
TRACE_STATISTICS
, "TradeStatus. Att (%d). Abt (%d). Dld (%d)\n",

505 
rv®
.
©‹m±ed
.
Œade_¡©us
,

506 
rv®
.
çed
.
Œade_¡©us
,

507 
rv®
.
d—dlocked
.
Œade_¡©us
);

509 
	`TRACE
Ğ
TRACE_STATISTICS
, "TradeUpdate. Att (%d). Abt (%d). Dld (%d)\n",

510 
rv®
.
©‹m±ed
.
Œade_upd©e
,

511 
rv®
.
çed
.
Œade_upd©e
,

512 
rv®
.
d—dlocked
.
Œade_upd©e
);

514 
	`TRACE
Ğ
TRACE_STATISTICS
, "DataMaintenance. Att (%d). Abt (%d). Dld (%d)\n",

515 
rv®
.
©‹m±ed
.
d©a_maš‹Çnû
,

516 
rv®
.
çed
.
d©a_maš‹Çnû
,

517 
rv®
.
d—dlocked
.
d©a_maš‹Çnû
);

519 
	`TRACE
Ğ
TRACE_STATISTICS
, "TradeCleanup. Att (%d). Abt (%d). Dld (%d)\n",

520 
rv®
.
©‹m±ed
.
Œade_ş—nup
,

521 
rv®
.
çed
.
Œade_ş—nup
,

522 
rv®
.
d—dlocked
.
Œade_ş—nup
);

524 
ShÜeEnv
::
	`¡©i¡ics
();

527 
	}
}

538 
	gShÜeTPCEEnv
::
	$¡¬t
()

540  (
ShÜeEnv
::
	`¡¬t
());

541 
	}
}

543 
	gShÜeTPCEEnv
::
	$¡İ
()

545  (
ShÜeEnv
::
	`¡İ
());

546 
	}
}

559 
	gShÜeTPCEEnv
::
	$£t_cu¡
(cÚ¡ 
aSF
)

561 ià((
aSF
 > 0) && ((aSF % 1000) == 0)) {

562 
	`TRACE
Ğ
TRACE_ALWAYS
, "New #cu¡om”s: %d\n", 
aSF
);

563 
_cu¡om”s
 = 
aSF
;

566 
	`TRACE
Ğ
TRACE_ALWAYS
, "Inv®id #cu¡om” šput: %d\n", 
aSF
);

568 
	}
}

570 
	gShÜeTPCEEnv
::
	$£t_wd
(cÚ¡ 
aSF
)

572 ià(
aSF
 > 0) {

573 
	`TRACE
Ğ
TRACE_ALWAYS
, "New wÜkšg_day çùÜ: %d\n", 
aSF
);

574 
_wÜkšg_days
 = 
aSF
;

577 
	`TRACE
Ğ
TRACE_ALWAYS
, "Inv®id wÜkšg_day šput: %d\n", 
aSF
);

579 
	}
}

581 
	gShÜeTPCEEnv
::
	$£t_sã
(cÚ¡ 
aSF
)

583 ià(
aSF
 > 0) {

584 
	`TRACE
Ğ
TRACE_ALWAYS
, "New sÿlšg_çùÜ_û: %d\n", 
aSF
);

585 
_sÿlšg_çùÜ_û
 = 
aSF
;

588 
	`TRACE
Ğ
TRACE_ALWAYS
, "Inv®id sÿlšg_çùÜ_û iÅut: %d\n", 
aSF
);

590 
	}
}

594 
	gShÜeTPCEEnv
::
checkpoš‹r_t
 : 
public
 
th»ad_t
 {

595 
ShÜeTPCEEnv
* 
_’v
;

596 
checkpoš‹r_t
(
ShÜeTPCEEnv
* 
’v
è: 
th»ad_t
("TPC-E Lßd Checkpoš‹r"), 
_’v
(env) { }

597 
vœtu®
 
wÜk
();

612 şas 
	cShÜeTPCEEnv
::
bË_bud”_t
 : 
public
 
th»ad_t
 {

613 
ShÜeTPCEEnv
* 
_’v
;

614 
	mmy_lßd_un™
;

615 
	mpublic
:

616 
	$bË_bud”_t
(
ShÜeTPCEEnv
* 
’v
)

617 : 
	`th»ad_t
("TPC-E†ßd”"), 
	$_’v
(
’v
) { }

618 
vœtu®
 
	`wÜk
();

619 
	}
};

621 
	gShÜeTPCEEnv
::
bË_bud”_t
::
	$wÜk
()

623 
w_rc_t
 
e
 = 
RCOK
;

626 
pİuÏ‹_sm®l_šput_t
 
š
;

627 
log_¥aû_Ãeded
 = 0;

628 
_’v
->
	`»ad_sm®l
();

629 
»Œy
:

630 
	`W_COERCE
(
_’v
->
	`db
()->
	`begš_xù
());

632 if(
log_¥aû_Ãeded
 > 0) {

633 
	`W_COERCE
(
_’v
->
	`db
()->
	`xù_»£rve_log_¥aû
(
log_¥aû_Ãeded
));

636 
e
 = 
_’v
->
	`xù_pİuÏ‹_sm®l
(1, 
š
);

637 
	`CHECK_XCT_RETURN
(
e
,
log_¥aû_Ãeded
,
»Œy
,
_’v
);

638 
_’v
->
	`»Ëa£_sm®l
();

641 
_’v
->
	`pİuÏ‹_add»ss
();

642 
_’v
->
	`pİuÏ‹_cu¡om”
();

643 
_’v
->
	`pİuÏ‹_ÿ_ªd_­
();

644 
_’v
->
	`pİuÏ‹_cu¡om”_x¿‹
();

645 
_’v
->
	`pİuÏ‹_wl_ªd_wi
();

647 
_’v
->
	`pİuÏ‹_com·ny
();

648 
_’v
->
	`pİuÏ‹_com·ny_com³t™Ü
();

649 
_’v
->
	`pİuÏ‹_day_m¬k‘
();

650 
_’v
->
	`pİuÏ‹_fšªcŸl
();

651 
_’v
->
	`pİuÏ‹_Ï¡_Œade
();

652 
_’v
-> 
	`pİuÏ‹_ni_ªd_nx
();

653 
_’v
->
	`pİuÏ‹_£cur™y
();

656 
_’v
-> 
	`pİuÏ‹_growšg
();

657 
	`´štC¬dš®™y
();

658 #ifdeà
COMPILE_FLAT_FILE_LOAD


659 
	`fşo£
(
fshs
);

660 
	`fşo£
(
fs£c
);

663 
_’v
->
	`fšd_maxŒade_id
();

665 
	}
}

678 
	gShÜeTPCEEnv
::
bË_ü—tÜ_t
 : 
public
 
th»ad_t
 {

679 
ShÜeTPCEEnv
* 
_’v
;

680 
bË_ü—tÜ_t
(
ShÜeTPCEEnv
* 
’v
)

681 : 
th»ad_t
("TPC-E TabË C»©Ü"), 
_’v
(
’v
) { }

682 
vœtu®
 
wÜk
();

685 
	gShÜeTPCEEnv
::
checkpoš‹r_t
::
	$wÜk
()

687 
boŞ
 vŞ©e* 
lßded
 = &
_’v
->
_lßded
;

688 !*
lßded
) {

689 
_’v
->
	`£t_m—su»
(
MST_MEASURE
);

690 
i
=0; i < 60 && !*
lßded
; i++)

691 ::
	`¦“p
(1);

693 
	`TRACE
Ğ
TRACE_ALWAYS
, "db checkpoint - start\n");

694 
_’v
->
	`checkpošt
();

695 
	`TRACE
Ğ
TRACE_ALWAYS
, "db checkpoint -ƒnd\n");

697 
_’v
->
	`£t_m—su»
(
MST_PAUSE
);

698 
	}
}

702 
	gShÜeTPCEEnv
::
bË_ü—tÜ_t
::
	$wÜk
()

705 
	`W_COERCE
(
_’v
->
	`db
()->
	`begš_xù
());

706 
	`W_COERCE
(
_’v
->
_·ccouÁ_³rmissiÚ_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

707 
	`W_COERCE
(
_’v
->
_pcu¡om”_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

708 
	`W_COERCE
(
_’v
->
_pcu¡om”_accouÁ_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

709 
	`W_COERCE
(
_’v
->
_pcu¡om”_x¿‹_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

710 
	`W_COERCE
(
_’v
->
_phŞdšg_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

711 
	`W_COERCE
(
_’v
->
_phŞdšg_hi¡Üy_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

712 
	`W_COERCE
(
_’v
->
_phŞdšg_summ¬y_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

713 
	`W_COERCE
(
_’v
->
_pw©ch_li¡_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

714 
	`W_COERCE
(
_’v
->
_pw©ch_™em_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

715 
	`W_COERCE
(
_’v
->
_pbrok”_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

716 
	`W_COERCE
(
_’v
->
_pÿsh_Œª§ùiÚ_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

717 
	`W_COERCE
(
_’v
->
_pch¬ge_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

718 
	`W_COERCE
(
_’v
->
_pcommissiÚ_¿‹_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

719 
	`W_COERCE
(
_’v
->
_p£‰Ëm’t_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

720 
	`W_COERCE
(
_’v
->
_±¿de_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

721 
	`W_COERCE
(
_’v
->
_±¿de_hi¡Üy_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

722 
	`W_COERCE
(
_’v
->
_±¿de_»que¡_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

723 
	`W_COERCE
(
_’v
->
_±¿de_ty³_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

724 
	`W_COERCE
(
_’v
->
_pcom·ny_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

725 
	`W_COERCE
(
_’v
->
_pcom·ny_com³t™Ü_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

726 
	`W_COERCE
(
_’v
->
_pday_m¬k‘_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

727 
	`W_COERCE
(
_’v
->
_³xchªge_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

728 
	`W_COERCE
(
_’v
->
_pfšªcŸl_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

729 
	`W_COERCE
(
_’v
->
_pšdu¡ry_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

730 
	`W_COERCE
(
_’v
->
_¶a¡_Œade_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

731 
	`W_COERCE
(
_’v
->
_²ews_™em_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

732 
	`W_COERCE
(
_’v
->
_²ews_x»f_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

733 
	`W_COERCE
(
_’v
->
_p£ùÜ_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

734 
	`W_COERCE
(
_’v
->
_p£cur™y_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

735 
	`W_COERCE
(
_’v
->
_·dd»ss_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

736 
	`W_COERCE
(
_’v
->
_p¡©us_ty³_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

737 
	`W_COERCE
(
_’v
->
_±ax¿‹_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

738 
	`W_COERCE
(
_’v
->
_pz_code_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

739 
	`W_COERCE
(
_’v
->
	`db
()->
	`comm™_xù
());

756 
	}
}

775 
w_rc_t
 
	gShÜeTPCEEnv
::
	$lßdd©a
()

777 
w_rc_t
 
e
;

779 
	`CRITICAL_SECTION
(
lßd_cs
, 
_lßd_mu‹x
);

780 ià(
_lßded
) {

781 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

783  (
RCOK
);

785 
	`CRITICAL_SECTION
(
sÿË_cs
, 
_sÿlšg_mu‹x
);

786 
time_t
 
t¡¬t
 = 
	`time
(
NULL
);

790 
gu¬d
<
bË_ü—tÜ_t
> 
tc
;

791 
tc
 = 
Ãw
 
	`bË_ü—tÜ_t
(
this
);

792 
tc
->
	`fÜk
();

793 
tc
->
	`još
();

796 
gu¬d
<
checkpoš‹r_t
> 
	`chk
(
Ãw
 
	`checkpoš‹r_t
(
this
));

797 
chk
->
	`fÜk
();

801 
	`TRACE
Ğ
TRACE_ALWAYS
, "Firing up %d†oaders ..\n", 1);

803 
gu¬d
<
bË_bud”_t
>
lßd”
 = 
Ãw
 
	`bË_bud”_t
(
this
);

805 
lßd”
->
	`fÜk
();

806 
lßd”
->
	`još
();

810 
time_t
 
t¡İ
 = 
	`time
(
NULL
);

811 
	`TRACE
Ğ
TRACE_ALWAYS
, "Lßdšg fšished iÀ(%dè£cs...\n", (
t¡İ
 - 
t¡¬t
));

814 
_lßded
 = 
Œue
;

815 
chk
->
	`još
();

816  (
RCOK
);

817 
	}
}

832 
w_rc_t
 
	gShÜeTPCEEnv
::
	$check_cÚsi¡’cy
()

835  
RCOK
;

836 
	}
}

848 
w_rc_t
 
	gShÜeTPCEEnv
::
	$w¬mup
()

850  (
	`check_cÚsi¡’cy
());

851 
	}
}

862 
	gShÜeTPCEEnv
::
	$dump
()

864 
	`as£¹
 (0);

866 
	}
}

869 
	gShÜeTPCEEnv
::
	$cÚf
()

872 
ShÜeEnv
::
	`cÚf
();

873 
	`upd_sf
();

874 
	`upd_wÜk”_út
();

876 
	}
}

879 
	gShÜeTPCEEnv
::
	$po¡_š™
()

881 
	`cÚf
();

882 ià(
	`g‘_pd
(è& 
PD_PADDED
) {

884 
	`W_COERCE
(
	`db
()->
	`begš_xù
());

885 
w_rc_t
 
rc
 = 
	`_po¡_š™_im¶
();

886 if(
rc
.
	`is_”rÜ
()) {

887 
	`db
()->
	`abÜt_xù
();

888  (
rc
.
	`”r_num
());

891 
	`TRACE
Ğ
TRACE_ALWAYS
, "-> Done\n");

892 
	`db
()->
	`comm™_xù
();

896 
this
->
	`fšd_maxŒade_id
();

898 
	}
}

909 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_po¡_š™_im¶
()

912  (
RCOK
);

913 
	}
}

924 
w_rc_t
 
	gShÜeTPCEEnv
::
	$db_´št
(
lšes
)

927 
	`as£¹
 (
_pssm
);

928 
	`as£¹
 (
_š™Ÿlized
);

929 
	`as£¹
 (
_lßded
);

932 
	`W_DO
(
_·ccouÁ_³rmissiÚ_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

933 
	`W_DO
(
_pcu¡om”_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

934 
	`W_DO
(
_pcu¡om”_accouÁ_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

935 
	`W_DO
(
_pcu¡om”_x¿‹_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

936 
	`W_DO
(
_phŞdšg_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

937 
	`W_DO
(
_phŞdšg_hi¡Üy_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

938 
	`W_DO
(
_phŞdšg_summ¬y_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

939 
	`W_DO
(
_pw©ch_™em_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

940 
	`W_DO
(
_pw©ch_li¡_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

941 
	`W_DO
(
_pbrok”_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

942 
	`W_DO
(
_pÿsh_Œª§ùiÚ_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

943 
	`W_DO
(
_pch¬ge_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

944 
	`W_DO
(
_pcommissiÚ_¿‹_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

945 
	`W_DO
(
_p£‰Ëm’t_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

946 
	`W_DO
(
_±¿de_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

947 
	`W_DO
(
_±¿de_hi¡Üy_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

948 
	`W_DO
(
_±¿de_»que¡_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

949 
	`W_DO
(
_±¿de_ty³_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

950 
	`W_DO
(
_pcom·ny_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

951 
	`W_DO
(
_pcom·ny_com³t™Ü_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

952 
	`W_DO
(
_pday_m¬k‘_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

953 
	`W_DO
(
_³xchªge_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

954 
	`W_DO
(
_pfšªcŸl_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

955 
	`W_DO
(
_pšdu¡ry_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

956 
	`W_DO
(
_¶a¡_Œade_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

957 
	`W_DO
(
_²ews_™em_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

958 
	`W_DO
(
_²ews_x»f_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

959 
	`W_DO
(
_p£ùÜ_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

960 
	`W_DO
(
_p£cur™y_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

961 
	`W_DO
(
_·dd»ss_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

962 
	`W_DO
(
_p¡©us_ty³_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

963 
	`W_DO
(
_±ax¿‹_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

964 
	`W_DO
(
_pz_code_mª
->
	`´št_bË
(
_pssm
, 
lšes
));

966  (
RCOK
);

967 
	}
}

978 
w_rc_t
 
	gShÜeTPCEEnv
::
	$db_ãtch
()

981 
	`as£¹
 (
_pssm
);

982 
	`as£¹
 (
_š™Ÿlized
);

983 
	`as£¹
 (
_lßded
);

986 
	`W_DO
(
_·ccouÁ_³rmissiÚ_mª
->
	`ãtch_bË
(
_pssm
));

987 
	`W_DO
(
_pcu¡om”_mª
->
	`ãtch_bË
(
_pssm
));

988 
	`W_DO
(
_pcu¡om”_accouÁ_mª
->
	`ãtch_bË
(
_pssm
));

989 
	`W_DO
(
_pcu¡om”_x¿‹_mª
->
	`ãtch_bË
(
_pssm
));

990 
	`W_DO
(
_phŞdšg_mª
->
	`ãtch_bË
(
_pssm
));

991 
	`W_DO
(
_phŞdšg_hi¡Üy_mª
->
	`ãtch_bË
(
_pssm
));

992 
	`W_DO
(
_phŞdšg_summ¬y_mª
->
	`ãtch_bË
(
_pssm
));

993 
	`W_DO
(
_pw©ch_™em_mª
->
	`ãtch_bË
(
_pssm
));

994 
	`W_DO
(
_pw©ch_li¡_mª
->
	`ãtch_bË
(
_pssm
));

995 
	`W_DO
(
_pbrok”_mª
->
	`ãtch_bË
(
_pssm
));

996 
	`W_DO
(
_pÿsh_Œª§ùiÚ_mª
->
	`ãtch_bË
(
_pssm
));

997 
	`W_DO
(
_pch¬ge_mª
->
	`ãtch_bË
(
_pssm
));

998 
	`W_DO
(
_pcommissiÚ_¿‹_mª
->
	`ãtch_bË
(
_pssm
));

999 
	`W_DO
(
_p£‰Ëm’t_mª
->
	`ãtch_bË
(
_pssm
));

1000 
	`W_DO
(
_±¿de_mª
->
	`ãtch_bË
(
_pssm
));

1001 
	`W_DO
(
_±¿de_hi¡Üy_mª
->
	`ãtch_bË
(
_pssm
));

1002 
	`W_DO
(
_±¿de_»que¡_mª
->
	`ãtch_bË
(
_pssm
));

1003 
	`W_DO
(
_±¿de_ty³_mª
->
	`ãtch_bË
(
_pssm
));

1004 
	`W_DO
(
_pcom·ny_mª
->
	`ãtch_bË
(
_pssm
));

1005 
	`W_DO
(
_pcom·ny_com³t™Ü_mª
->
	`ãtch_bË
(
_pssm
));

1006 
	`W_DO
(
_pday_m¬k‘_mª
->
	`ãtch_bË
(
_pssm
));

1007 
	`W_DO
(
_³xchªge_mª
->
	`ãtch_bË
(
_pssm
));

1008 
	`W_DO
(
_pfšªcŸl_mª
->
	`ãtch_bË
(
_pssm
));

1009 
	`W_DO
(
_pšdu¡ry_mª
->
	`ãtch_bË
(
_pssm
));

1010 
	`W_DO
(
_¶a¡_Œade_mª
->
	`ãtch_bË
(
_pssm
));

1011 
	`W_DO
(
_²ews_™em_mª
->
	`ãtch_bË
(
_pssm
));

1012 
	`W_DO
(
_²ews_x»f_mª
->
	`ãtch_bË
(
_pssm
));

1013 
	`W_DO
(
_p£ùÜ_mª
->
	`ãtch_bË
(
_pssm
));

1014 
	`W_DO
(
_p£cur™y_mª
->
	`ãtch_bË
(
_pssm
));

1015 
	`W_DO
(
_·dd»ss_mª
->
	`ãtch_bË
(
_pssm
));

1016 
	`W_DO
(
_p¡©us_ty³_mª
->
	`ãtch_bË
(
_pssm
));

1017 
	`W_DO
(
_±ax¿‹_mª
->
	`ãtch_bË
(
_pssm
));

1018 
	`W_DO
(
_pz_code_mª
->
	`ãtch_bË
(
_pssm
));

1020  (
RCOK
);

1021 
	}
}

1024 
EXIT_NAMESPACE
(
û
);

	@src/workload/tpce/shore_tpce_schema.cpp

32 
	~"wÜklßd/û/shÜe_û_schema.h
"

34 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
ENTER_NAMESPACE
(
û
);

58 
	gaccouÁ_³rmissiÚ_t
::
	$accouÁ_³rmissiÚ_t
(cÚ¡ 
ušt4_t
& 
pd
)

59 : 
	`bË_desc_t
("ACCOUNT_PERMISSION", 
TPCE_ACCOUNT_PERMISSION_FCOUNT
, 
pd
)

61 
_desc
[0].
	`£tup
(
SQL_LONG
, "AP_CA_ID");

62 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "AP_ACL",4);

63 
_desc
[2].
	`£tup
(
SQL_FIXCHAR
, "AP_TAX_ID",20);

64 
_desc
[3].
	`£tup
(
SQL_FIXCHAR
, "AP_L_NAME",25);

65 
_desc
[4].
	`£tup
(
SQL_FIXCHAR
, "AP_F_NAME",20);

67 
ušt
 
keys
[2] = { 0, 2 };

69 
	`ü—‹_´im¬y_idx_desc
("AP_INDEX", 0, 
keys
, 2, 
pd
);

70 
	}
}

73 
	gcu¡om”_t
::
	$cu¡om”_t
(cÚ¡ 
ušt4_t
& 
pd
)

74 : 
	`bË_desc_t
("CUSTOMER", 
TPCE_CUSTOMER_FCOUNT
, 
pd
)

76 
_desc
[0].
	`£tup
(
SQL_LONG
, "C_ID");

77 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "C_TAX_ID",20);

78 
_desc
[2].
	`£tup
(
SQL_FIXCHAR
, "C_ST_ID",4);

79 
_desc
[3].
	`£tup
(
SQL_FIXCHAR
, "C_L_NAME",25);

80 
_desc
[4].
	`£tup
(
SQL_FIXCHAR
, "C_F_NAME",20);

81 
_desc
[5].
	`£tup
(
SQL_FIXCHAR
, "C_M_NAME",1);

82 
_desc
[6].
	`£tup
(
SQL_FIXCHAR
, "C_GNDR", 1);

83 
_desc
[7].
	`£tup
(
SQL_SMALLINT
, "C_TIER");

84 
_desc
[8].
	`£tup
(
SQL_LONG
, "C_DOB");

85 
_desc
[9].
	`£tup
(
SQL_LONG
, "C_AD_ID");

86 
_desc
[10].
	`£tup
(
SQL_FIXCHAR
, "C_CTRY_1", 3);

87 
_desc
[11].
	`£tup
(
SQL_FIXCHAR
, "C_AREA_1", 3);

88 
_desc
[12].
	`£tup
(
SQL_FIXCHAR
, "C_LOCAL_1", 10);

89 
_desc
[13].
	`£tup
(
SQL_FIXCHAR
, "C_EXT_1", 5);

90 
_desc
[14].
	`£tup
(
SQL_FIXCHAR
, "C_CTRY_2", 3);

91 
_desc
[15].
	`£tup
(
SQL_FIXCHAR
, "C_AREA_2", 3);

92 
_desc
[16].
	`£tup
(
SQL_FIXCHAR
, "C_LOCAL_2", 10);

93 
_desc
[17].
	`£tup
(
SQL_FIXCHAR
, "C_EXT_2", 5);

94 
_desc
[18].
	`£tup
(
SQL_FIXCHAR
, "C_CTRY_3", 3);

95 
_desc
[19].
	`£tup
(
SQL_FIXCHAR
, "C_AREA_3", 3);

96 
_desc
[20].
	`£tup
(
SQL_FIXCHAR
, "C_LOCAL_3", 10);

97 
_desc
[21].
	`£tup
(
SQL_FIXCHAR
, "C_EXT_3", 5);

98 
_desc
[22].
	`£tup
(
SQL_FIXCHAR
, "C_EMAIL_1", 50);

99 
_desc
[23].
	`£tup
(
SQL_FIXCHAR
, "C_EMAIL_2", 50);

101 
ušt
 
keys
[1] = { 0 };

102 
ušt
 
keys2
[2] = { 1, 0 };

103 
ušt
 
keys3
[2] = { 0, 7 };

105 
	`ü—‹_´im¬y_idx_desc
("C_INDEX", 0, 
keys
, 1, 
pd
);

106 
	`ü—‹_šdex_desc
("C_INDEX_2", 0, 
keys2
, 2);

107 
	`ü—‹_šdex_desc
("C_INDEX_3", 0, 
keys3
, 2);

108 
	}
}

111 
	gcu¡om”_accouÁ_t
::
	$cu¡om”_accouÁ_t
(cÚ¡ 
ušt4_t
& 
pd
)

112 : 
	`bË_desc_t
("CUSTOMER_ACCOUNT", 
TPCE_CUSTOMER_ACCOUNT_FCOUNT
, 
pd
)

114 
_desc
[0].
	`£tup
(
SQL_LONG
, "CA_ID");

115 
_desc
[1].
	`£tup
(
SQL_LONG
, "CA_B_ID");

116 
_desc
[2].
	`£tup
(
SQL_LONG
, "CA_C_ID");

117 
_desc
[3].
	`£tup
(
SQL_FIXCHAR
, "CA_NAME", 50);

118 
_desc
[4].
	`£tup
(
SQL_SMALLINT
, "CA_TAX_ST");

119 
_desc
[5].
	`£tup
(
SQL_FLOAT
, "CA_BAL");

121 
ušt
 
keys
[1] = { 0 };

129 
ušt
 
keys2
[2] = { 2 };

141 
	`ü—‹_´im¬y_idx_desc
("CA_INDEX", 0, 
keys
, 1, 
pd
);

142 
	`ü—‹_šdex_desc
("CA_INDEX_2", 0, 
keys2
, 1, 
çl£
, f®£, 
pd
);

145 
	}
}

148 
	gcu¡om”_x¿‹_t
::
	$cu¡om”_x¿‹_t
(cÚ¡ 
ušt4_t
& 
pd
)

149 : 
	`bË_desc_t
("CUSTOMER_TAXRATE", 
TPCE_CUSTOMER_TAXRATE_FCOUNT
, 
pd
)

151 
_desc
[0].
	`£tup
(
SQL_FIXCHAR
, "CX_TX_ID", 4);

152 
_desc
[1].
	`£tup
(
SQL_LONG
, "CX_C_ID");

154 
ušt
 
keys
[2] = { 1 , 0 };

156 
	`ü—‹_´im¬y_idx_desc
("CX_INDEX", 0, 
keys
, 2, 
pd
);

157 
	}
}

160 
	ghŞdšg_t
::
	$hŞdšg_t
(cÚ¡ 
ušt4_t
& 
pd
)

161 : 
	`bË_desc_t
("HOLDING", 
TPCE_HOLDING_FCOUNT
, 
pd
)

163 
_desc
[0].
	`£tup
(
SQL_LONG
, "H_T_ID");

164 
_desc
[1].
	`£tup
(
SQL_LONG
, "H_CA_ID");

165 
_desc
[2].
	`£tup
(
SQL_FIXCHAR
, "H_S_SYMB", 16);

166 
_desc
[3].
	`£tup
(
SQL_LONG
, "H_DTS");

167 
_desc
[4].
	`£tup
(
SQL_FLOAT
, "H_PRICE");

168 
_desc
[5].
	`£tup
(
SQL_INT
, "H_QTY");

180 
ušt
 
keys2
[3] = { 1, 2, 3 };

184 
	`ü—‹_šdex_desc
("H_INDEX_2", 0, 
keys2
, 3, 
çl£
, f®£, 
pd
);

185 
	}
}

188 
	ghŞdšg_hi¡Üy_t
::
	$hŞdšg_hi¡Üy_t
(cÚ¡ 
ušt4_t
& 
pd
)

189 : 
	`bË_desc_t
("HOLDING_HISTORY", 
TPCE_HOLDING_HISTORY_FCOUNT
, 
pd
)

191 
_desc
[0].
	`£tup
(
SQL_LONG
, "HH_H_T_ID");

192 
_desc
[1].
	`£tup
(
SQL_LONG
, "HH_T_ID");

193 
_desc
[2].
	`£tup
(
SQL_INT
, "HH_BEFORE_QTY");

194 
_desc
[3].
	`£tup
(
SQL_INT
, "HH_AFTER_QTY");

204 
ušt
 
keys2
[1] = { 1 };

208 
	`ü—‹_šdex_desc
("HH_INDEX_2", 0, 
keys2
, 1, 
çl£
, f®£, 
pd
);

209 
	}
}

212 
	ghŞdšg_summ¬y_t
::
	$hŞdšg_summ¬y_t
(cÚ¡ 
ušt4_t
& 
pd
)

213 : 
	`bË_desc_t
("HOLDING_SUMMARY", 
TPCE_HOLDING_SUMMARY_FCOUNT
, 
pd
)

215 
_desc
[0].
	`£tup
(
SQL_LONG
, "HS_CA_ID");

216 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "HS_S_SYMB", 16);

217 
_desc
[2].
	`£tup
(
SQL_INT
, "HS_QTY");

219 
ušt
 
keys
[2] = { 0, 1 };

221 
	`ü—‹_´im¬y_idx_desc
("HS_INDEX", 0, 
keys
, 2, 
pd
);

222 
	}
}

225 
	gw©ch_™em_t
::
	$w©ch_™em_t
(cÚ¡ 
ušt4_t
& 
pd
)

226 : 
	`bË_desc_t
("WATCH_ITEM", 
TPCE_WATCH_ITEM_FCOUNT
, 
pd
)

228 
_desc
[0].
	`£tup
(
SQL_LONG
, "WI_WL_ID");

229 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "WI_S_SYMB", 15);

231 
ušt
 
keys
[2] = { 0, 1 };

233 
	`ü—‹_´im¬y_idx_desc
("WI_INDEX", 0, 
keys
, 2, 
pd
);

234 
	}
}

237 
	gw©ch_li¡_t
::
	$w©ch_li¡_t
(cÚ¡ 
ušt4_t
& 
pd
)

238 : 
	`bË_desc_t
("WATCH_LIST", 
TPCE_WATCH_LIST_FCOUNT
, 
pd
)

240 
_desc
[0].
	`£tup
(
SQL_LONG
, "WL_ID");

241 
_desc
[1].
	`£tup
(
SQL_LONG
, "WL_C_ID");

245 
ušt
 
keys2
[2] = { 1, 0 };

248 
	`ü—‹_´im¬y_idx_desc
("WL_INDEX_2", 0, 
keys2
, 2, 
pd
);

250 
	}
}

259 
	gbrok”_t
::
	$brok”_t
(cÚ¡ 
ušt4_t
& 
pd
)

260 : 
	`bË_desc_t
("BROKER", 
TPCE_BROKER_FCOUNT
, 
pd
)

262 
_desc
[0].
	`£tup
(
SQL_LONG
, "B_ID");

263 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "B_ST_ID", 4);

264 
_desc
[2].
	`£tup
(
SQL_FIXCHAR
, "B_NAME", 52);

265 
_desc
[3].
	`£tup
(
SQL_INT
, "B_NUM_TRADES");

266 
_desc
[4].
	`£tup
(
SQL_FLOAT
, "B_COMM_TOTAL");

268 
ušt
 
keys
[1] = { 0 };

269 
ušt
 
keys2
[2] = { 0, 2 };

270 
ušt
 
keys3
[2] = { 2, 0 };

272 
	`ü—‹_´im¬y_idx_desc
("B_INDEX", 0, 
keys
, 1, 
pd
);

273 
	`ü—‹_šdex_desc
("B_INDEX_2", 0, 
keys2
, 2, 
Œue
, 
çl£
, 
pd
);

274 
	`ü—‹_šdex_desc
("B_INDEX_3", 0, 
keys3
, 2, 
Œue
, 
çl£
, 
pd
);

275 
	}
}

278 
	gÿsh_Œª§ùiÚ_t
::
	$ÿsh_Œª§ùiÚ_t
(cÚ¡ 
ušt4_t
& 
pd
)

279 : 
	`bË_desc_t
("CASH_TRANSACTION", 
TPCE_CASH_TRANSACTION_FCOUNT
, 
pd
)

281 
_desc
[0].
	`£tup
(
SQL_LONG
, "CT_T_ID");

282 
_desc
[1].
	`£tup
(
SQL_LONG
, "CT_DTS");

283 
_desc
[2].
	`£tup
(
SQL_FLOAT
, "CT_AMT");

284 
_desc
[3].
	`£tup
(
SQL_FIXCHAR
, "CT_NAME", 100);

286 
ušt
 
keys
[1] = { 0 };

288 
	`ü—‹_´im¬y_idx_desc
("CT_INDEX", 0, 
keys
, 1, 
pd
);

289 
	}
}

292 
	gch¬ge_t
::
	$ch¬ge_t
(cÚ¡ 
ušt4_t
& 
pd
)

293 : 
	`bË_desc_t
("CHARGE", 
TPCE_CHARGE_FCOUNT
, 
pd
)

295 
_desc
[0].
	`£tup
(
SQL_FIXCHAR
, "CH_TT_ID", 4);

296 
_desc
[1].
	`£tup
(
SQL_SMALLINT
, "CH_C_TIER");

297 
_desc
[2].
	`£tup
(
SQL_FLOAT
, "CH_CHRG");

299 
ušt
 
keys
[2] = { 0 , 1 };

301 
	`ü—‹_´im¬y_idx_desc
("CH_INDEX", 0, 
keys
, 2, 
pd
);

302 
	}
}

305 
	gcommissiÚ_¿‹_t
::
	$commissiÚ_¿‹_t
(cÚ¡ 
ušt4_t
& 
pd
)

306 : 
	`bË_desc_t
("COMMISSION_RATE", 
TPCE_COMMISSION_RATE_FCOUNT
, 
pd
)

308 
_desc
[0].
	`£tup
(
SQL_SMALLINT
, "CR_C_TIER");

309 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "CR_TT_ID", 6);

310 
_desc
[2].
	`£tup
(
SQL_FIXCHAR
, "CR_EX_ID", 8);

311 
_desc
[3].
	`£tup
(
SQL_INT
, "CR_FROM_QTY");

312 
_desc
[4].
	`£tup
(
SQL_INT
, "CR_TO_QTY");

313 
_desc
[5].
	`£tup
(
SQL_FLOAT
, "CR_RATE");

315 
ušt
 
keys
[4] = { 0, 1, 2, 3 };

317 
	`ü—‹_´im¬y_idx_desc
("CR_INDEX", 0, 
keys
, 4, 
pd
);

318 
	}
}

321 
	g£‰Ëm’t_t
::
	$£‰Ëm’t_t
(cÚ¡ 
ušt4_t
& 
pd
)

322 : 
	`bË_desc_t
("SETTLEMENT", 
TPCE_SETTLEMENT_FCOUNT
, 
pd
)

324 
_desc
[0].
	`£tup
(
SQL_LONG
, "SE_T_ID");

325 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "SE_CASH_TYPE", 40);

326 
_desc
[2].
	`£tup
(
SQL_LONG
, "SE_CASH_DUE_DATE");

327 
_desc
[3].
	`£tup
(
SQL_FLOAT
, "SE_AMT");

329 
ušt
 
keys
[1] = { 0 };

331 
	`ü—‹_´im¬y_idx_desc
("SE_INDEX", 0, 
keys
, 1, 
pd
);

332 
	}
}

335 
	gŒade_t
::
	$Œade_t
(cÚ¡ 
ušt4_t
& 
pd
)

336 : 
	`bË_desc_t
("TRADE", 
TPCE_TRADE_FCOUNT
, 
pd
)

338 
_desc
[0].
	`£tup
(
SQL_LONG
, "T_ID");

339 
_desc
[1].
	`£tup
(
SQL_LONG
, "T_DTS");

340 
_desc
[2].
	`£tup
(
SQL_FIXCHAR
, "T_ST_ID",4);

341 
_desc
[3].
	`£tup
(
SQL_FIXCHAR
, "T_TT_ID",3);

342 
_desc
[4].
	`£tup
(
SQL_BIT
, "T_IS_CASH");

343 
_desc
[5].
	`£tup
(
SQL_FIXCHAR
, "T_S_SYMB",16);

344 
_desc
[6].
	`£tup
(
SQL_INT
, "T_QTY");

345 
_desc
[7].
	`£tup
(
SQL_FLOAT
, "T_BID_PRICE");

346 
_desc
[8].
	`£tup
(
SQL_LONG
, "T_CA_ID");

347 
_desc
[9].
	`£tup
(
SQL_FIXCHAR
, "T_EXEC_NAME",49);

348 
_desc
[10].
	`£tup
(
SQL_FLOAT
, "T_TRADE_PRICE");

349 
_desc
[11].
	`£tup
(
SQL_FLOAT
, "T_CHRG");

350 
_desc
[12].
	`£tup
(
SQL_FLOAT
, "T_COMM");

351 
_desc
[13].
	`£tup
(
SQL_FLOAT
, "T_TAX");

352 
_desc
[14].
	`£tup
(
SQL_BIT
, "T_LIFO");

354 
ušt
 
keys
[1] = { 0 };

355 
ušt
 
keys2
[3] = { 8, 1, 0 };

358 
ušt
 
keys3
[2] = { 5, 1 };

360 
	`ü—‹_´im¬y_idx_desc
("T_INDEX", 0, 
keys
, 1, 
pd
);

361 
	`ü—‹_šdex_desc
("T_INDEX_2", 0, 
keys2
, 3, 
Œue
, 
çl£
, 
pd
);

362 
	`ü—‹_šdex_desc
("T_INDEX_3", 0, 
keys3
, 2, 
çl£
, f®£, 
pd
);

363 
	}
}

366 
	gŒade_hi¡Üy_t
::
	$Œade_hi¡Üy_t
(cÚ¡ 
ušt4_t
& 
pd
)

367 : 
	`bË_desc_t
("TRADE_HISTORY", 
TPCE_TRADE_HISTORY_FCOUNT
, 
pd
)

369 
_desc
[0].
	`£tup
(
SQL_LONG
, "TH_T_ID");

370 
_desc
[1].
	`£tup
(
SQL_LONG
, "TH_DTS");

371 
_desc
[2].
	`£tup
(
SQL_FIXCHAR
, "TH_ST_ID", 4);

381 
ušt
 
keys3
[2] = { 0, 1 };

385 
	`ü—‹_šdex_desc
("TH_INDEX_3", 0, 
keys3
, 2, 
çl£
, f®£, 
pd
);

386 
	}
}

389 
	gŒade_»que¡_t
::
	$Œade_»que¡_t
(cÚ¡ 
ušt4_t
& 
pd
)

390 : 
	`bË_desc_t
("TRADE_REQUEST", 
TPCE_TRADE_REQUEST_FCOUNT
, 
pd
)

392 
_desc
[0].
	`£tup
(
SQL_LONG
, "TR_T_ID");

393 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "TR_TT_ID", 3);

394 
_desc
[2].
	`£tup
(
SQL_FIXCHAR
, "TR_S_SYMB", 16);

395 
_desc
[3].
	`£tup
(
SQL_INT
, "TR_QTY");

396 
_desc
[4].
	`£tup
(
SQL_FLOAT
, "TR_BID_PRICE");

397 
_desc
[5].
	`£tup
(
SQL_LONG
, "TR_B_ID");

404 
ušt
 
keys4
[2] = { 2, 5 };

409 
	`ü—‹_šdex_desc
("TR_INDEX_4", 0, 
keys4
, 2, 
çl£
, f®£, 
pd
);

410 
	}
}

413 
	gŒade_ty³_t
::
	$Œade_ty³_t
(cÚ¡ 
ušt4_t
& 
pd
)

414 : 
	`bË_desc_t
("TRADE_TYPE", 
TPCE_TRADE_TYPE_FCOUNT
, 
pd
)

416 
_desc
[0].
	`£tup
(
SQL_FIXCHAR
, "TT_ID", 4);

417 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "TT_NAME", 12);

418 
_desc
[2].
	`£tup
(
SQL_BIT
, "TT_IS_SELL");

419 
_desc
[3].
	`£tup
(
SQL_BIT
, "TT_IS_MRKT");

423 
ušt
 
keys
[1] = { 0 };

425 
	`ü—‹_´im¬y_idx_desc
("TT_INDEX", 0, 
keys
, 1, 
pd
);

427 
	}
}

434 
	gcom·ny_t
::
	$com·ny_t
(cÚ¡ 
ušt4_t
& 
pd
)

435 : 
	`bË_desc_t
("COMPANY", 
TPCE_COMPANY_FCOUNT
, 
pd
)

437 
_desc
[0].
	`£tup
(
SQL_LONG
, "CO_ID");

438 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "CO_ST_ID", 4);

439 
_desc
[2].
	`£tup
(
SQL_FIXCHAR
, "CO_NAME", 60);

440 
_desc
[3].
	`£tup
(
SQL_FIXCHAR
, "CO_IN_ID", 4);

441 
_desc
[4].
	`£tup
(
SQL_FIXCHAR
, "CO_SP_RATE", 4);

442 
_desc
[5].
	`£tup
(
SQL_FIXCHAR
, "CO_CEO", 46);

443 
_desc
[6].
	`£tup
(
SQL_LONG
, "CO_AD_ID");

444 
_desc
[7].
	`£tup
(
SQL_FIXCHAR
, "CO_DESC", 150);

445 
_desc
[8].
	`£tup
(
SQL_LONG
, "CO_OPEN_DATE");

447 
ušt
 
keys1
[1] = { 0 };

448 
ušt
 
keys2
[2] = { 2, 0 };

449 
ušt
 
keys3
[2] = { 3, 0 };

451 
	`ü—‹_´im¬y_idx_desc
("CO_INDEX", 0, 
keys1
, 1, 
pd
);

452 
	`ü—‹_šdex_desc
("CO_INDEX_2", 0, 
keys2
, 2, 
Œue
, 
çl£
, 
pd
);

453 
	`ü—‹_šdex_desc
("CO_INDEX_3", 0, 
keys3
, 2, 
Œue
, 
çl£
, 
pd
);

454 
	}
}

456 
	gcom·ny_com³t™Ü_t
::
	$com·ny_com³t™Ü_t
(cÚ¡ 
ušt4_t
& 
pd
)

457 : 
	`bË_desc_t
("COMPANY_COMPETITOR", 
TPCE_COMPANY_COMPETITOR_FCOUNT
, 
pd
)

459 
_desc
[0].
	`£tup
(
SQL_LONG
, "CP_CO_ID");

460 
_desc
[1].
	`£tup
(
SQL_LONG
, "CP_COMP_CO_ID");

461 
_desc
[2].
	`£tup
(
SQL_FIXCHAR
, "CP_IN_ID", 4);

463 
ušt
 
keys1
[3] = { 0, 1, 2 };

467 
	`ü—‹_´im¬y_idx_desc
("CP_INDEX", 0, 
keys1
, 3, 
pd
);

469 
	}
}

472 
	gday_m¬k‘_t
::
	$day_m¬k‘_t
(cÚ¡ 
ušt4_t
& 
pd
)

473 : 
	`bË_desc_t
("DAILY_MARKET", 
TPCE_DAILY_MARKET_FCOUNT
, 
pd
)

475 
_desc
[0].
	`£tup
(
SQL_LONG
, "DM_DATE");

476 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "DM_S_SYMB", 16);

477 
_desc
[2].
	`£tup
(
SQL_FLOAT
, "DM_CLOSE");

478 
_desc
[3].
	`£tup
(
SQL_FLOAT
, "DM_HIGH");

479 
_desc
[4].
	`£tup
(
SQL_FLOAT
, "DM_LOW");

480 
_desc
[5].
	`£tup
(
SQL_INT
, "DM_VOL");

482 
ušt
 
keys1
[2] = { 1, 0 };

483 
ušt
 
keys2
[2] = { 0, 1 };

485 
	`ü—‹_´im¬y_idx_desc
("DM_INDEX", 0, 
keys1
, 2, 
pd
);

486 
	`ü—‹_šdex_desc
("DM_INDEX_2", 0, 
keys2
, 2, 
Œue
, 
çl£
, 
pd
);

487 
	}
}

490 
	gexchªge_t
::
	$exchªge_t
(cÚ¡ 
ušt4_t
& 
pd
)

491 : 
	`bË_desc_t
("EXCHANGE", 
TPCE_EXCHANGE_FCOUNT
, 
pd
)

493 
_desc
[0].
	`£tup
(
SQL_FIXCHAR
, "EX_ID", 6);

494 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "EX_NAME", 100);

495 
_desc
[2].
	`£tup
(
SQL_INT
, "EX_NUM_SYMB");

496 
_desc
[3].
	`£tup
(
SQL_INT
, "EX_OPEN");

497 
_desc
[4].
	`£tup
(
SQL_INT
, "EX_CLOSE");

498 
_desc
[5].
	`£tup
(
SQL_FIXCHAR
, "EX_DESC", 150);

499 
_desc
[6].
	`£tup
(
SQL_LONG
, "EX_AD_ID");

501 
ušt
 
keys
[1] = { 0 };

503 
	`ü—‹_´im¬y_idx_desc
("EX_INDEX", 0, 
keys
, 1, 
pd
);

504 
	}
}

507 
	gfšªcŸl_t
::
	$fšªcŸl_t
(cÚ¡ 
ušt4_t
& 
pd
)

508 : 
	`bË_desc_t
("FINANCIAL", 
TPCE_FINANCIAL_FCOUNT
, 
pd
)

510 
_desc
[0].
	`£tup
(
SQL_LONG
, "FI_CO_ID");

511 
_desc
[1].
	`£tup
(
SQL_INT
, "FI_YEAR");

512 
_desc
[2].
	`£tup
(
SQL_SMALLINT
, "FI_QTR");

513 
_desc
[3].
	`£tup
(
SQL_LONG
, "FI_QTR_START_DATE");

514 
_desc
[4].
	`£tup
(
SQL_FLOAT
, "FI_REVENUE");

515 
_desc
[5].
	`£tup
(
SQL_FLOAT
, "FI_NET_EARN");

516 
_desc
[6].
	`£tup
(
SQL_FLOAT
, "FI_BASIC_EPS");

517 
_desc
[7].
	`£tup
(
SQL_FLOAT
, "FI_DILUT_EPS");

518 
_desc
[8].
	`£tup
(
SQL_FLOAT
, "FI_MARGIN");

519 
_desc
[9].
	`£tup
(
SQL_FLOAT
, "FI_INVENTORY");

520 
_desc
[10].
	`£tup
(
SQL_FLOAT
, "FI_ASSETS");

521 
_desc
[11].
	`£tup
(
SQL_FLOAT
, "FI_LIABILITY");

522 
_desc
[12].
	`£tup
(
SQL_FLOAT
, "FI_OUT_BASIC");

523 
_desc
[13].
	`£tup
(
SQL_FLOAT
, "FI_OUT_DILUT");

525 
ušt
 
keys
[3] = { 0, 1, 2 };

527 
	`ü—‹_´im¬y_idx_desc
("FI_INDEX", 0, 
keys
, 3, 
pd
);

528 
	}
}

531 
	gšdu¡ry_t
::
	$šdu¡ry_t
(cÚ¡ 
ušt4_t
& 
pd
)

532 : 
	`bË_desc_t
("INDUSTRY", 
TPCE_INDUSTRY_FCOUNT
, 
pd
)

534 
_desc
[0].
	`£tup
(
SQL_FIXCHAR
, "IN_ID", 2);

535 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "IN_NAME", 50);

536 
_desc
[2].
	`£tup
(
SQL_FIXCHAR
, "IN_SC_ID", 2);

538 
ušt
 
keys1
[1] = { 0 };

539 
ušt
 
keys2
[2] = { 1, 0 };

540 
ušt
 
keys3
[2] = { 2, 0 };

542 
	`ü—‹_´im¬y_idx_desc
("IN_INDEX", 0, 
keys1
, 1, 
pd
);

543 
	`ü—‹_šdex_desc
("IN_INDEX_2", 0, 
keys2
, 2, 
Œue
, 
çl£
, 
pd
);

544 
	`ü—‹_šdex_desc
("IN_INDEX_3", 0, 
keys3
, 2, 
Œue
, 
çl£
, 
pd
);

545 
	}
}

548 
	gÏ¡_Œade_t
::
	$Ï¡_Œade_t
(cÚ¡ 
ušt4_t
& 
pd
)

549 : 
	`bË_desc_t
("LAST_TRADE", 
TPCE_LAST_TRADE_FCOUNT
, 
pd
)

551 
_desc
[0].
	`£tup
(
SQL_FIXCHAR
, "LT_S_SYMB", 16);

552 
_desc
[1].
	`£tup
(
SQL_LONG
, "LT_DTS");

553 
_desc
[2].
	`£tup
(
SQL_FLOAT
, "LT_PRICE");

554 
_desc
[3].
	`£tup
(
SQL_FLOAT
, "LT_OPEN_PRICE");

555 
_desc
[4].
	`£tup
(
SQL_FLOAT
, "LT_VOL");

557 
ušt
 
keys
[1] = { 0 };

559 
	`ü—‹_´im¬y_idx_desc
("LT_INDEX", 0, 
keys
, 1, 
pd
);

560 
	}
}

563 
	gÃws_™em_t
::
	$Ãws_™em_t
(cÚ¡ 
ušt4_t
& 
pd
)

564 : 
	`bË_desc_t
("NEWS_ITEM", 
TPCE_NEWS_ITEM_FCOUNT
, 
pd
)

566 
_desc
[0].
	`£tup
(
SQL_LONG
, "NI_ID");

567 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "NI_HEADLINE", 80);

568 
_desc
[2].
	`£tup
(
SQL_FIXCHAR
, "NI_SUMMARY", 255);

570 #w¬nšg 
should
 
be
 100000, 
but
 
™
 
çs
 
š
 
_²ews_™em_mª
 = 
Ãw
 
	`Ãws_™em_mª_im¶
(
_²ews_™em_desc
.
	`g‘
());

572 
_desc
[3].
	`£tup
(
SQL_FIXCHAR
, "NI_ITEM", 
max_Ãws_™em_size
);

573 
_desc
[4].
	`£tup
(
SQL_LONG
, "NI_DTS");

574 
_desc
[5].
	`£tup
(
SQL_FIXCHAR
, "NI_SOURCE", 30);

575 
_desc
[6].
	`£tup
(
SQL_FIXCHAR
, "NI_AUTHOR", 30);

577 
ušt
 
keys
[1] = { 0 };

579 
	`ü—‹_´im¬y_idx_desc
("NI_INDEX", 0, 
keys
, 1, 
pd
);

580 
	}
}

583 
	gÃws_x»f_t
::
	$Ãws_x»f_t
(cÚ¡ 
ušt4_t
& 
pd
)

584 : 
	`bË_desc_t
("NEWS_XREF", 
TPCE_NEWS_XREF_FCOUNT
, 
pd
)

586 
_desc
[0].
	`£tup
(
SQL_LONG
, "NX_NI_ID");

587 
_desc
[1].
	`£tup
(
SQL_LONG
, "NX_CO_ID");

589 
ušt
 
keys
[2] = { 1, 0 };

591 
	`ü—‹_´im¬y_idx_desc
("NX_INDEX", 0, 
keys
, 2, 
pd
);

592 
	}
}

595 
	g£ùÜ_t
::
	$£ùÜ_t
(cÚ¡ 
ušt4_t
& 
pd
)

596 : 
	`bË_desc_t
("SECTOR", 
TPCE_SECTOR_FCOUNT
, 
pd
)

598 
_desc
[0].
	`£tup
(
SQL_FIXCHAR
, "SC_ID", 4);

599 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "SC_NAME", 32);

603 
ušt
 
keys2
[2] = { 1, 0 };

606 
	`ü—‹_šdex_desc
("SC_INDEX_2", 0, 
keys2
, 2, 
Œue
, 
çl£
, 
pd
);

607 
	}
}

610 
	g£cur™y_t
::
	$£cur™y_t
(cÚ¡ 
ušt4_t
& 
pd
)

611 : 
	`bË_desc_t
("SECURITY", 
TPCE_SECURITY_FCOUNT
, 
pd
)

613 
_desc
[0].
	`£tup
(
SQL_FIXCHAR
, "S_SYMB", 16);

614 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "S_ISSUE", 8);

615 
_desc
[2].
	`£tup
(
SQL_FIXCHAR
, "S_ST_ID", 4);

616 
_desc
[3].
	`£tup
(
SQL_FIXCHAR
, "S_NAME", 70);

617 
_desc
[4].
	`£tup
(
SQL_FIXCHAR
, "S_EX_ID", 6);

618 
_desc
[5].
	`£tup
(
SQL_LONG
, "S_CO_ID");

619 
_desc
[6].
	`£tup
(
SQL_FLOAT
, "S_NUM_OUT");

620 
_desc
[7].
	`£tup
(
SQL_LONG
, "S_START_DATE");

621 
_desc
[8].
	`£tup
(
SQL_LONG
, "S_EXCH_DATE");

622 
_desc
[9].
	`£tup
(
SQL_FLOAT
, "S_PE");

623 
_desc
[10].
	`£tup
(
SQL_FLOAT
, "S_52WK_HIGH");

624 
_desc
[11].
	`£tup
(
SQL_LONG
, "S_52WK_HIGH_DATE");

625 
_desc
[12].
	`£tup
(
SQL_FLOAT
, "S_52WK_LOW");

626 
_desc
[13].
	`£tup
(
SQL_LONG
, "S_52WK_LOW_DATE");

627 
_desc
[14].
	`£tup
(
SQL_FLOAT
, "S_DIVIDEND");

628 
_desc
[15].
	`£tup
(
SQL_FLOAT
, "S_YIELD");

630 
ušt
 
keys1
[1] = { 0 };

639 
ušt
 
keys4
[3] = { 5, 1, 0 };

641 
	`ü—‹_´im¬y_idx_desc
("S_INDEX", 0, 
keys1
, 1, 
pd
);

644 
	`ü—‹_šdex_desc
("S_INDEX_4", 0, 
keys4
, 3, 
Œue
, 
çl£
, 
pd
);

645 
	}
}

654 
	gadd»ss_t
::
	$add»ss_t
(cÚ¡ 
ušt4_t
& 
pd
)

655 : 
	`bË_desc_t
("ADDRESS", 
TPCE_ADDRESS_FCOUNT
, 
pd
)

657 
_desc
[0].
	`£tup
(
SQL_LONG
, "AD_ID");

658 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "AD_LINE1", 80);

659 
_desc
[2].
	`£tup
(
SQL_FIXCHAR
, "AD_LINE2", 80);

660 
_desc
[3].
	`£tup
(
SQL_FIXCHAR
, "AD_ZC_CODE", 12);

661 
_desc
[4].
	`£tup
(
SQL_FIXCHAR
, "AD_CTRY", 80);

663 
ušt
 
keys
[1] = { 0 };

665 
	`ü—‹_´im¬y_idx_desc
("AD_INDEX", 0, 
keys
, 1, 
pd
);

666 
	}
}

669 
	g¡©us_ty³_t
::
	$¡©us_ty³_t
(cÚ¡ 
ušt4_t
& 
pd
)

670 : 
	`bË_desc_t
("STATUS_TYPE", 
TPCE_STATUS_TYPE_FCOUNT
, 
pd
)

672 
_desc
[0].
	`£tup
(
SQL_FIXCHAR
, "ST_ID", 4);

673 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "ST_NAME", 10);

675 
ušt
 
keys
[1] = { 0 };

677 
	`ü—‹_´im¬y_idx_desc
("ST_INDEX", 0, 
keys
, 1, 
pd
);

678 
	}
}

681 
	gx¿‹_t
::
	$x¿‹_t
(cÚ¡ 
ušt4_t
& 
pd
)

682 : 
	`bË_desc_t
("TAXRATE", 
TPCE_TAXRATE_FCOUNT
, 
pd
)

684 
_desc
[0].
	`£tup
(
SQL_FIXCHAR
, "TX_ID", 4);

685 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "TX_NAME", 50);

686 
_desc
[2].
	`£tup
(
SQL_FLOAT
, "TX_RATE");

688 
ušt
 
keys
[1] = { 0 };

690 
	`ü—‹_´im¬y_idx_desc
("TX_INDEX", 0, 
keys
, 1, 
pd
);

691 
	}
}

694 
	gz_code_t
::
	$z_code_t
(cÚ¡ 
ušt4_t
& 
pd
)

695 : 
	`bË_desc_t
("ZIP_CODE", 
TPCE_ZIP_CODE_FCOUNT
, 
pd
)

697 
_desc
[0].
	`£tup
(
SQL_FIXCHAR
, "ZC_CODE", 12);

698 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "ZC_TOWN", 80);

699 
_desc
[2].
	`£tup
(
SQL_FIXCHAR
, "ZC_DIV", 80);

701 
ušt
 
keys
[1] = { 0 };

703 
	`ü—‹_´im¬y_idx_desc
("ZC_INDEX", 0, 
keys
, 1, 
pd
);

704 
	}
}

713 
EXIT_NAMESPACE
(
û
);

	@src/workload/tpce/shore_tpce_schema_man.cpp

34 
	~"wÜklßd/û/shÜe_û_schema_mª.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

39 
ENTER_NAMESPACE
(
û
);

46 
w_rc_t
 
	gaccouÁ_³rmissiÚ_mª_im¶
::
	$­_šdex_´obe
(
ss_m
* 
db
, 
accouÁ_³rmissiÚ_tu¶e
* 
±u¶e
,

47 cÚ¡ 
TId’t
 
acù_id
,

48 cÚ¡ * 
exec_x_id
)

50 
	`as£¹
 (
±u¶e
);

51 
±u¶e
->
	`£t_v®ue
(0, 
acù_id
);

52 
±u¶e
->
	`£t_v®ue
(2, 
exec_x_id
);

53  (
	`šdex_´obe_by_Çme
(
db
, "AP_INDEX", 
±u¶e
));

54 
	}
}

56 
w_rc_t
 
	gaccouÁ_³rmissiÚ_mª_im¶
::
	$­_g‘_™”_by_šdex
(
ss_m
* 
db
,

57 
accouÁ_³rmissiÚ_šdex_™”
* &
™”
,

58 
accouÁ_³rmissiÚ_tu¶e
* 
±u¶e
,

59 
»p_row_t
 &
»¶ow
,

60 
»p_row_t
 &
»phigh
,

61 cÚ¡ 
TId’t
 
acù_id
,

62 
lock_mode_t
 
®m
,

63 
boŞ
 
Ãed_tu¶e
)

65 
	`as£¹
 (
±u¶e
);

68 
	`as£¹
 (
_±abË
);

69 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("AP_INDEX");

70 
	`as£¹
 (
pšdex
);

75 
±u¶e
->
	`£t_v®ue
(0, 
acù_id
);

76 
±u¶e
->
	`£t_v®ue
(2, "");

78 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

79 
	`as£¹
 (
»¶ow
.
_de¡
);

81 
‹mp
[2];

82 
‹mp
[0] = 
	`MAX
('z', 'Z')+1;

83 
‹mp
[1] = '\0';

84 
±u¶e
->
	`£t_v®ue
(2, 
‹mp
);

85 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

86 
	`as£¹
 (
»phigh
.
_de¡
);

89 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
,

90 
®m
, 
Ãed_tu¶e
,

91 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

92 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

93  (
RCOK
);

94 
	}
}

96 
w_rc_t
 
	gaccouÁ_³rmissiÚ_mª_im¶
::
	$­_upd©e_aş
(
ss_m
* 
db
,

97 
accouÁ_³rmissiÚ_tu¶e
* 
±u¶e
,

98 cÚ¡ * 
aş
,

99 
lock_mode_t
 
lm
)

101 
	`as£¹
 (
±u¶e
);

102 
±u¶e
->
	`£t_v®ue
(1, 
aş
);

103  (
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

104 
	}
}

111 
w_rc_t
 
	gadd»ss_mª_im¶
::
	$ad_g‘_bË_™”
(
ss_m
* 
db
, 
bË_™”
* &
™”
)

114 
	`W_DO
(
	`g‘_™”_fÜ_fe_sÿn
(
db
, 
™”
));

115  (
RCOK
);

116 
	}
}

118 
w_rc_t
 
	gadd»ss_mª_im¶
::
	$ad_šdex_´obe
(
ss_m
* 
db
, 
add»ss_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
ad_id
)

120 
	`as£¹
 (
±u¶e
);

121 
±u¶e
->
	`£t_v®ue
(0, 
ad_id
);

122  (
	`šdex_´obe_by_Çme
(
db
, "AD_INDEX", 
±u¶e
));

123 
	}
}

125 
w_rc_t
 
	gadd»ss_mª_im¶
::
	$ad_šdex_´obe_fÜupd©e
(
ss_m
* 
db
, 
add»ss_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
ad_id
)

127 
	`as£¹
 (
±u¶e
);

128 
±u¶e
->
	`£t_v®ue
(0, 
ad_id
);

129  (
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "AD_INDEX", 
±u¶e
));

130 
	}
}

132 
w_rc_t
 
	gadd»ss_mª_im¶
::
	$ad_upd©e_lše2
(
ss_m
* 
db
,

133 
add»ss_tu¶e
* 
±u¶e
,

134 cÚ¡ * 
lše2
,

135 
lock_mode_t
 
lm
)

137 
	`as£¹
 (
±u¶e
);

138 
±u¶e
->
	`£t_v®ue
(2, 
lše2
);

139  (
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

140 
	}
}

147 
w_rc_t
 
	gbrok”_mª_im¶
::
	$brok”_upd©e_ÿ_Á_by_šdex
(
ss_m
* 
db
, 
brok”_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
brok”_id
,

148 cÚ¡ 
comm_amouÁ
, 
lock_mode_t
 
lm
)

150 
	`as£¹
 (
±u¶e
);

154 
±u¶e
->
	`£t_v®ue
(0, 
brok”_id
);

155 
	`W_DO
(
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "B_INDEX", 
±u¶e
));

157 
b_comm_tÙ®
;

158 
±u¶e
->
	`g‘_v®ue
(4, 
b_comm_tÙ®
);

159 
b_num_Œades
;

160 
±u¶e
->
	`g‘_v®ue
(3, 
b_num_Œades
);

162 
±u¶e
->
	`£t_v®ue
(4, 
b_comm_tÙ®
 + 
comm_amouÁ
);

163 
±u¶e
->
	`£t_v®ue
(3, 
b_num_Œades
 + 1);

164  (
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

165 
	}
}

167 
w_rc_t
 
	gbrok”_mª_im¶
::
	$b_g‘_™”_by_šdex2
(
ss_m
* 
db
,

168 
brok”_šdex_™”
* &
™”
,

169 
brok”_tu¶e
* 
±u¶e
,

170 
»p_row_t
 &
»¶ow
,

171 
»p_row_t
 &
»phigh
,

172 cÚ¡ 
TId’t
 
b_id
,

173 
lock_mode_t
 
®m
,

174 
boŞ
 
Ãed_tu¶e
)

176 
	`as£¹
 (
±u¶e
);

177 
	`as£¹
 (
_±abË
);

179 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("B_INDEX_2");

180 
	`as£¹
 (
pšdex
);

185 
±u¶e
->
	`£t_v®ue
(0, 
b_id
);

186 
±u¶e
->
	`£t_v®ue
(2, "");

188 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

189 
	`as£¹
 (
»¶ow
.
_de¡
);

191 
‹mp
[2];

192 
‹mp
[0] = 
	`MAX
('z', 'Z')+1;

193 
‹mp
[1] = '\0';

194 
±u¶e
->
	`£t_v®ue
(2, 
‹mp
);

195 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

196 
	`as£¹
 (
»phigh
.
_de¡
);

199 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
, 
®m
, 
Ãed_tu¶e
,

200 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

201 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

202  (
RCOK
);

203 
	}
}

205 
w_rc_t
 
	gbrok”_mª_im¶
::
	$b_g‘_™”_by_šdex3
(
ss_m
* 
db
,

206 
brok”_šdex_™”
* &
™”
,

207 
brok”_tu¶e
* 
±u¶e
,

208 
»p_row_t
 &
»¶ow
,

209 
»p_row_t
 &
»phigh
,

210 cÚ¡ * 
b_Çme
,

211 
lock_mode_t
 
®m
,

212 
boŞ
 
Ãed_tu¶e
)

214 
	`as£¹
 (
±u¶e
);

215 
	`as£¹
 (
_±abË
);

217 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("B_INDEX_3");

218 
	`as£¹
 (
pšdex
);

223 
±u¶e
->
	`£t_v®ue
(2, 
b_Çme
);

224 
±u¶e
->
	`£t_v®ue
(0, () 0);

226 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

227 
	`as£¹
 (
»¶ow
.
_de¡
);

229 
±u¶e
->
	`£t_v®ue
(0, 
MAX_ID
);

230 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

231 
	`as£¹
 (
»phigh
.
_de¡
);

234 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
, 
®m
, 
Ãed_tu¶e
,

235 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

236 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

237  (
RCOK
);

238 
	}
}

245 
w_rc_t
 
	gÿsh_Œª§ùiÚ_mª_im¶
::
	$ù_šdex_´obe
(
ss_m
* 
db
, 
ÿsh_Œª§ùiÚ_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
Œ_id
)

247 
	`as£¹
 (
±u¶e
);

248 
±u¶e
->
	`£t_v®ue
(0, 
Œ_id
);

249  (
	`šdex_´obe_by_Çme
(
db
, "CT_INDEX", 
±u¶e
));

250 
	}
}

252 
w_rc_t
 
	gÿsh_Œª§ùiÚ_mª_im¶
::
	$ù_šdex_´obe_fÜupd©e
(
ss_m
* 
db
, 
ÿsh_Œª§ùiÚ_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
t_id
)

254 
	`as£¹
 (
±u¶e
);

255 
±u¶e
->
	`£t_v®ue
(0, 
t_id
);

256  (
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "CT_INDEX", 
±u¶e
));

257 
	}
}

259 
w_rc_t
 
	gÿsh_Œª§ùiÚ_mª_im¶
::
	$ù_upd©e_Çme
(
ss_m
* 
db
, 
ÿsh_Œª§ùiÚ_tu¶e
* 
±u¶e
, cÚ¡ * 
ù_Çme
, 
lock_mode_t
 
lm
)

261 
	`as£¹
 (
±u¶e
);

262 
±u¶e
->
	`£t_v®ue
(3, 
ù_Çme
);

263  (
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

264 
	}
}

271 
w_rc_t
 
	gch¬ge_mª_im¶
::
	$ch_šdex_´obe
(
ss_m
* 
db
, 
ch¬ge_tu¶e
* 
±u¶e
, cÚ¡ 
cu¡_t›r
, cÚ¡ * 
Œade_ty³_id
)

273 
	`as£¹
 (
±u¶e
);

274 
±u¶e
->
	`£t_v®ue
(0, 
Œade_ty³_id
);

275 
±u¶e
->
	`£t_v®ue
(1, 
cu¡_t›r
);

276  (
	`šdex_´obe_by_Çme
(
db
, "CH_INDEX", 
±u¶e
));

277 
	}
}

284 
w_rc_t
 
	gcommissiÚ_¿‹_mª_im¶
::
	$ü_g‘_™”_by_šdex
(
ss_m
* 
db
,

285 
commissiÚ_¿‹_šdex_™”
* &
™”
,

286 
commissiÚ_¿‹_tu¶e
* 
±u¶e
,

287 
»p_row_t
 &
»¶ow
,

288 
»p_row_t
 &
»phigh
,

289 cÚ¡ 
c_t›r
,

290 cÚ¡ * 
ty³_id
,

291 cÚ¡ * 
s_ex_id
,

292 cÚ¡ 
Œade_qty
,

293 
lock_mode_t
 
®m
,

294 
boŞ
 
Ãed_tu¶e
)

296 
	`as£¹
 (
±u¶e
);

297 
	`as£¹
 (
_±abË
);

299 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("CR_INDEX");

300 
	`as£¹
 (
pšdex
);

305 
±u¶e
->
	`£t_v®ue
(0, 
c_t›r
);

306 
±u¶e
->
	`£t_v®ue
(1, 
ty³_id
);

307 
±u¶e
->
	`£t_v®ue
(2, 
s_ex_id
);

308 
±u¶e
->
	`£t_v®ue
(3, ()0);

310 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

311 
	`as£¹
 (
»¶ow
.
_de¡
);

313 
±u¶e
->
	`£t_v®ue
(3, 
Œade_qty
);

314 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

315 
	`as£¹
 (
»phigh
.
_de¡
);

318 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
, 
®m
, 
Ãed_tu¶e
,

319 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

320 
sÿn_šdex_i
::
Ë
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

321  (
RCOK
);

322 
	}
}

329 
w_rc_t
 
	gcom·ny_mª_im¶
::
	$co_g‘_™”_by_šdex2
(
ss_m
* 
db
,

330 
com·ny_šdex_™”
* &
™”
,

331 
com·ny_tu¶e
* 
±u¶e
,

332 
»p_row_t
 &
»¶ow
,

333 
»p_row_t
 &
»phigh
,

334 cÚ¡ * 
co_Çme
,

335 
lock_mode_t
 
®m
,

336 
boŞ
 
Ãed_tu¶e
)

338 
	`as£¹
 (
±u¶e
);

341 
	`as£¹
 (
_±abË
);

342 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("CO_INDEX_2");

343 
	`as£¹
 (
pšdex
);

346 
±u¶e
->
	`£t_v®ue
(2, 
co_Çme
);

347 
±u¶e
->
	`£t_v®ue
(0, ()0);

349 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

350 
	`as£¹
 (
»¶ow
.
_de¡
);

353 
±u¶e
->
	`£t_v®ue
(0, 
MAX_ID
);

355 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

356 
	`as£¹
 (
»phigh
.
_de¡
);

359 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
, 
®m
, 
Ãed_tu¶e
,

360 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

361 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

362  (
RCOK
);

363 
	}
}

366 
w_rc_t
 
	gcom·ny_mª_im¶
::
	$co_šdex_´obe
(
ss_m
* 
db
, 
com·ny_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
co_id
)

368 
	`as£¹
 (
±u¶e
);

369 
±u¶e
->
	`£t_v®ue
(0, 
co_id
);

370  (
	`šdex_´obe_by_Çme
(
db
, "CO_INDEX", 
±u¶e
));

371 
	}
}

373 
w_rc_t
 
	gcom·ny_mª_im¶
::
	$co_šdex_´obe_fÜupd©e
(
ss_m
* 
db
, 
com·ny_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
co_id
)

375 
	`as£¹
 (
±u¶e
);

376 
±u¶e
->
	`£t_v®ue
(0, 
co_id
);

377  (
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "CO_INDEX", 
±u¶e
));

378 
	}
}

380 
w_rc_t
 
	gcom·ny_mª_im¶
::
	$co_upd©e_¥¿‹
(
ss_m
* 
db
, 
com·ny_tu¶e
* 
±u¶e
, cÚ¡ * 
¥¿‹
, 
lock_mode_t
 
lm
)

382 
	`as£¹
 (
±u¶e
);

383 
±u¶e
->
	`£t_v®ue
(4, 
¥¿‹
);

384  (
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

385 
	}
}

387 
w_rc_t
 
	gcom·ny_mª_im¶
::
	$co_g‘_™”_by_šdex3
(
ss_m
* 
db
,

388 
com·ny_šdex_™”
* &
™”
,

389 
com·ny_tu¶e
* 
±u¶e
,

390 
»p_row_t
 &
»¶ow
,

391 
»p_row_t
 &
»phigh
,

392 cÚ¡ * 
š_id
,

393 
lock_mode_t
 
®m
,

394 
boŞ
 
Ãed_tu¶e
)

396 
	`as£¹
 (
±u¶e
);

399 
	`as£¹
 (
_±abË
);

400 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("CO_INDEX_3");

401 
	`as£¹
 (
pšdex
);

404 
±u¶e
->
	`£t_v®ue
(3, 
š_id
);

405 
±u¶e
->
	`£t_v®ue
(0, ()0);

407 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

408 
	`as£¹
 (
»¶ow
.
_de¡
);

411 
±u¶e
->
	`£t_v®ue
(0, 
MAX_ID
);

413 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

414 
	`as£¹
 (
»phigh
.
_de¡
);

416 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
, 
®m
, 
Ãed_tu¶e
,

417 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

418 
sÿn_šdex_i
::
Ë
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

419  (
RCOK
);

420 
	}
}

427 
w_rc_t
 
	gcom·ny_com³t™Ü_mª_im¶
::
	$cc_g‘_™”_by_šdex
(
ss_m
* 
db
,

428 
com·ny_com³t™Ü_šdex_™”
* &
™”
,

429 
com·ny_com³t™Ü_tu¶e
* 
±u¶e
,

430 
»p_row_t
 &
»¶ow
,

431 
»p_row_t
 &
»phigh
,

432 cÚ¡ 
TId’t
 
co_id
,

433 
boŞ
 
Ãed_tu¶e
,

434 
lock_mode_t
 
®m
)

436 
	`as£¹
 (
±u¶e
);

439 
	`as£¹
 (
_±abË
);

440 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("CP_INDEX");

441 
	`as£¹
 (
pšdex
);

446 
±u¶e
->
	`£t_v®ue
(0, 
co_id
);

447 
±u¶e
->
	`£t_v®ue
(1, ()0);

448 
±u¶e
->
	`£t_v®ue
(2, "");

450 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

451 
	`as£¹
 (
»¶ow
.
_de¡
);

453 
±u¶e
->
	`£t_v®ue
(0, 
co_id
 + 1);

454 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

455 
	`as£¹
 (
»phigh
.
_de¡
);

458 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
, 
®m
, 
Ãed_tu¶e
,

459 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

460 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

461  (
RCOK
);

462 
	}
}

469 
w_rc_t
 
	gcu¡om”_mª_im¶
::
	$c_šdex_´obe
(
ss_m
* 
db
, 
cu¡om”_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
cu¡_id
)

471 
	`as£¹
 (
±u¶e
);

472 
±u¶e
->
	`£t_v®ue
(0, 
cu¡_id
);

473  (
	`šdex_´obe_by_Çme
(
db
, "C_INDEX", 
±u¶e
));

474 
	}
}

476 
w_rc_t
 
	gcu¡om”_mª_im¶
::
	$c_šdex_´obe_fÜupd©e
(
ss_m
* 
db
, 
cu¡om”_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
cu¡_id
)

478 
	`as£¹
 (
±u¶e
);

479 
±u¶e
->
	`£t_v®ue
(0, 
cu¡_id
);

480  (
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "C_INDEX", 
±u¶e
));

481 
	}
}

483 
w_rc_t
 
	gcu¡om”_mª_im¶
::
	$c_upd©e_ema2
(
ss_m
* 
db
, 
cu¡om”_tu¶e
* 
±u¶e
, cÚ¡ * 
ema2
, 
lock_mode_t
 
lm
)

485 
	`as£¹
 (
±u¶e
);

486 
±u¶e
->
	`£t_v®ue
(23, 
ema2
);

487  (
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

488 
	}
}

490 
w_rc_t
 
	gcu¡om”_mª_im¶
::
	$c_g‘_™”_by_šdex2
(
ss_m
* 
db
,

491 
cu¡om”_šdex_™”
* &
™”
,

492 
cu¡om”_tu¶e
* 
±u¶e
,

493 
»p_row_t
 &
»¶ow
,

494 
»p_row_t
 &
»phigh
,

495 cÚ¡ * 
x_id
,

496 
lock_mode_t
 
®m
,

497 
boŞ
 
Ãed_tu¶e
)

499 
	`as£¹
 (
±u¶e
);

502 
	`as£¹
 (
_±abË
);

503 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("C_INDEX_2");

504 
	`as£¹
 (
pšdex
);

509 
±u¶e
->
	`£t_v®ue
(1, 
x_id
);

510 
±u¶e
->
	`£t_v®ue
(0, () 0);

512 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

513 
	`as£¹
 (
»¶ow
.
_de¡
);

515 
±u¶e
->
	`£t_v®ue
(1, 
x_id
);

516 
±u¶e
->
	`£t_v®ue
(0, 
MAX_ID
);

518 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

519 
	`as£¹
 (
»phigh
.
_de¡
);

522 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
, 
®m
, 
Ãed_tu¶e
,

523 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

524 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

525  (
RCOK
);

526 
	}
}

528 
w_rc_t
 
	gcu¡om”_mª_im¶
::
	$c_g‘_™”_by_šdex3
(
ss_m
* 
db
,

529 
cu¡om”_šdex_™”
* &
™”
,

530 
cu¡om”_tu¶e
* 
±u¶e
,

531 
»p_row_t
 &
»¶ow
,

532 
»p_row_t
 &
»phigh
,

533 cÚ¡ 
TId’t
 
cu¡_id
,

534 
lock_mode_t
 
®m
,

535 
boŞ
 
Ãed_tu¶e
)

537 
	`as£¹
 (
±u¶e
);

540 
	`as£¹
 (
_±abË
);

541 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("C_INDEX_3");

542 
	`as£¹
 (
pšdex
);

547 
±u¶e
->
	`£t_v®ue
(0, 
cu¡_id
);

548 
±u¶e
->
	`£t_v®ue
(7, () 0);

550 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

551 
	`as£¹
 (
»¶ow
.
_de¡
);

553 
±u¶e
->
	`£t_v®ue
(0, 
cu¡_id
);

554 
±u¶e
->
	`£t_v®ue
(7, (è
MAX_SHORT
);

556 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

557 
	`as£¹
 (
»phigh
.
_de¡
);

560 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
, 
®m
, 
Ãed_tu¶e
,

561 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

562 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

563  (
RCOK
);

564 
	}
}

571 
w_rc_t
 
	gcu¡om”_accouÁ_mª_im¶
::
	$ÿ_šdex_´obe
(
ss_m
* 
db
, 
cu¡om”_accouÁ_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
acù_id
)

573 
	`as£¹
 (
±u¶e
);

574 
±u¶e
->
	`£t_v®ue
(0, 
acù_id
);

575  (
	`šdex_´obe_by_Çme
(
db
, "CA_INDEX", 
±u¶e
));

576 
	}
}

578 
w_rc_t
 
	gcu¡om”_accouÁ_mª_im¶
::
	$ÿ_upd©e_b®
(
ss_m
* 
db
, 
cu¡om”_accouÁ_tu¶e
* 
±u¶e
,

579 cÚ¡ 
TId’t
 
acù_id
, cÚ¡ 
£_amouÁ
,

580 
lock_mode_t
 
lm
)

582 
	`as£¹
 (
±u¶e
);

584 
±u¶e
->
	`£t_v®ue
(0, 
acù_id
);

585 
	`W_DO
(
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "CA_INDEX", 
±u¶e
));

587 
ÿ_b®
;

588 
±u¶e
->
	`g‘_v®ue
(5, 
ÿ_b®
);

589 
±u¶e
->
	`£t_v®ue
(5, 
ÿ_b®
 + 
£_amouÁ
);

590  (
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

591 
	}
}

593 
w_rc_t
 
	gcu¡om”_accouÁ_mª_im¶
::
	$ÿ_g‘_™”_by_šdex2
(
ss_m
* 
db
,

594 
cu¡om”_accouÁ_šdex_™”
* &
™”
,

595 
cu¡om”_accouÁ_tu¶e
* 
±u¶e
,

596 
»p_row_t
 &
»¶ow
,

597 
»p_row_t
 &
»phigh
,

598 cÚ¡ 
TId’t
 
cu¡_id
,

599 
lock_mode_t
 
®m
,

600 
boŞ
 
Ãed_tu¶e
)

602 
	`as£¹
 (
±u¶e
);

605 
	`as£¹
 (
_±abË
);

606 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("CA_INDEX_2");

607 
	`as£¹
 (
pšdex
);

612 
±u¶e
->
	`£t_v®ue
(2, 
cu¡_id
);

614 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

615 
	`as£¹
 (
»¶ow
.
_de¡
);

617 
±u¶e
->
	`£t_v®ue
(2, 
cu¡_id
 + 1);

619 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

620 
	`as£¹
 (
»phigh
.
_de¡
);

623 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
, 
®m
, 
Ãed_tu¶e
,

624 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

625 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

626  (
RCOK
);

627 
	}
}

634 
w_rc_t
 
	gcu¡om”_x¿‹_mª_im¶
::
	$cx_g‘_™”_by_šdex
(
ss_m
* 
db
,

635 
cu¡om”_x¿‹_šdex_™”
* &
™”
,

636 
cu¡om”_x¿‹_tu¶e
* 
±u¶e
,

637 
»p_row_t
 &
»¶ow
,

638 
»p_row_t
 &
»phigh
,

639 cÚ¡ 
TId’t
 
cu¡_id
,

640 
lock_mode_t
 
®m
,

641 
boŞ
 
Ãed_tu¶e
)

643 
	`as£¹
 (
±u¶e
);

646 
	`as£¹
 (
_±abË
);

647 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("CX_INDEX");

648 
	`as£¹
 (
pšdex
);

653 
±u¶e
->
	`£t_v®ue
(1, 
cu¡_id
);

654 
±u¶e
->
	`£t_v®ue
(0, "");

656 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

657 
	`as£¹
 (
»¶ow
.
_de¡
);

659 
‹mp
[2];

660 
‹mp
[0] = 
	`MAX
('z', 'Z')+1;

661 
‹mp
[1] = '\0';

662 
±u¶e
->
	`£t_v®ue
(0, 
‹mp
);

664 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

665 
	`as£¹
 (
»phigh
.
_de¡
);

668 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
, 
®m
, 
Ãed_tu¶e
,

669 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

670 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

671  (
RCOK
);

672 
	}
}

674 
w_rc_t
 
	gcu¡om”_x¿‹_mª_im¶
::
	$cx_upd©e_txid
(
ss_m
* 
db
,

675 
cu¡om”_x¿‹_tu¶e
* 
±u¶e
,

676 cÚ¡ * 
Ãw_x_¿‹
,

677 
lock_mode_t
 
lm
)

679 
	`as£¹
 (
±u¶e
);

682 
	`W_DO
(
	`»ad_tu¶e
(
±u¶e
));

685 
	`W_DO
(
	`d–‘e_šdex_’Œy
(
db
, "CX_INDEX", 
±u¶e
));

688 
±u¶e
->
	`£t_v®ue
(0, 
Ãw_x_¿‹
);

689 
	`W_DO
(
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

692 
	`W_DO
(
	`add_šdex_’Œy
(
db
, "CX_INDEX", 
±u¶e
));

694  (
RCOK
);

695 
	}
}

702 
w_rc_t
 
	gday_m¬k‘_mª_im¶
::
	$dm_šdex_´obe
(
ss_m
* 
db
, 
day_m¬k‘_tu¶e
* 
±u¶e
,

703 cÚ¡ * 
symbŞ
, cÚ¡ 
myTime
 
¡¬t_d©e
)

705 
	`as£¹
 (
±u¶e
);

706 
±u¶e
->
	`£t_v®ue
(0, 
¡¬t_d©e
);

707 
±u¶e
->
	`£t_v®ue
(1, 
symbŞ
);

708  (
	`šdex_´obe_by_Çme
(
db
, "DM_INDEX_2", 
±u¶e
));

709 
	}
}

711 
w_rc_t
 
	gday_m¬k‘_mª_im¶
::
	$dm_upd©e_vŞ
(
ss_m
* 
db
,

712 
day_m¬k‘_tu¶e
* 
±u¶e
,

713 cÚ¡ 
vŞ_šü
,

714 
lock_mode_t
 
lm
)

716 
	`as£¹
 (
±u¶e
);

719 
	`W_DO
(
	`»ad_tu¶e
(
±u¶e
));

722 
ex_vŞ
;

723 
±u¶e
->
	`g‘_v®ue
(5, 
ex_vŞ
);

724 
±u¶e
->
	`£t_v®ue
(5, (
ex_vŞ
 + 
vŞ_šü
));

725  (
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

726 
	}
}

728 
w_rc_t
 
	gday_m¬k‘_mª_im¶
::
	$dm_g‘_™”_by_šdex
(
ss_m
* 
db
,

729 
day_m¬k‘_šdex_™”
* &
™”
,

730 
day_m¬k‘_tu¶e
* 
±u¶e
,

731 
»p_row_t
 &
»¶ow
,

732 
»p_row_t
 &
»phigh
,

733 cÚ¡ * 
symbŞ
,

734 cÚ¡ 
myTime
 
¡¬t_day
,

735 
lock_mode_t
 
®m
,

736 
boŞ
 
Ãed_tu¶e
)

738 
	`as£¹
 (
±u¶e
);

744 
	`as£¹
 (
_±abË
);

745 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("DM_INDEX");

746 
	`as£¹
 (
pšdex
);

749 
±u¶e
->
	`£t_v®ue
(1, 
symbŞ
);

750 
±u¶e
->
	`£t_v®ue
(0, 
¡¬t_day
);

751 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

752 
	`as£¹
 (
»¶ow
.
_de¡
);

755 
±u¶e
->
	`£t_v®ue
(0, 
MAX_DTS
);

756 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

757 
	`as£¹
 (
»phigh
.
_de¡
);

759 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
, 
®m
, 
Ãed_tu¶e
,

760 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

761 
sÿn_šdex_i
::
Ë
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

762  (
RCOK
);

763 
	}
}

770 
w_rc_t
 
	gexchªge_mª_im¶
::
	$ex_upd©e_desc
(
ss_m
* 
db
,

771 
exchªge_tu¶e
* 
±u¶e
,

772 cÚ¡ * 
Ãw_desc
,

773 
lock_mode_t
 
lm
)

775 
	`as£¹
 (
±u¶e
);

776 
±u¶e
->
	`£t_v®ue
(5, 
Ãw_desc
);

777  (
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

778 
	}
}

780 
w_rc_t
 
	gexchªge_mª_im¶
::
	$ex_šdex_´obe
(
ss_m
* 
db
,

781 
exchªge_tu¶e
* 
±u¶e
,

782 cÚ¡ * 
id
)

784 
	`as£¹
 (
±u¶e
);

785 
±u¶e
->
	`£t_v®ue
(0, 
id
);

786  (
	`šdex_´obe_by_Çme
(
db
, "EX_INDEX", 
±u¶e
));

787 
	}
}

794 
w_rc_t
 
	gfšªcŸl_mª_im¶
::
	$fi_upd©e_desc
(
ss_m
* 
db
, 
fšªcŸl_tu¶e
* 
±u¶e
,

795 cÚ¡ 
myTime
 
Ãw_qŒ_¡¬t_d©e
, 
lock_mode_t
 
lm
)

797 
	`as£¹
 (
±u¶e
);

798 
±u¶e
->
	`£t_v®ue
(3, 
Ãw_qŒ_¡¬t_d©e
);

799  (
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

800 
	}
}

802 
w_rc_t
 
	gfšªcŸl_mª_im¶
::
	$fi_g‘_™”_by_šdex
(
ss_m
* 
db
,

803 
fšªcŸl_šdex_™”
* &
™”
,

804 
fšªcŸl_tu¶e
* 
±u¶e
,

805 
»p_row_t
 &
»¶ow
,

806 
»p_row_t
 &
»phigh
,

807 cÚ¡ 
TId’t
 
co_id
,

808 
lock_mode_t
 
®m
,

809 
boŞ
 
Ãed_tu¶e
)

811 
	`as£¹
 (
±u¶e
);

816 
	`as£¹
 (
_±abË
);

817 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("FI_INDEX");

818 
	`as£¹
 (
pšdex
);

821 
±u¶e
->
	`£t_v®ue
(0, 
co_id
);

822 
±u¶e
->
	`£t_v®ue
(1, ()0);

823 
±u¶e
->
	`£t_v®ue
(2, ()0);

825 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

826 
	`as£¹
 (
»¶ow
.
_de¡
);

829 
±u¶e
->
	`£t_v®ue
(0, 
co_id
 + 1);

830 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

831 
	`as£¹
 (
»phigh
.
_de¡
);

834 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
, 
®m
, 
Ãed_tu¶e
,

835 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

836 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

837  (
RCOK
);

838 
	}
}

845 
w_rc_t
 
	ghŞdšg_mª_im¶
::
	$h_g‘_™”_by_šdex2
(
ss_m
* 
db
,

846 
hŞdšg_šdex_™”
* &
™”
,

847 
hŞdšg_tu¶e
* 
±u¶e
,

848 
»p_row_t
 &
»¶ow
,

849 
»p_row_t
 &
»phigh
,

850 cÚ¡ 
TId’t
 
acù_id
,

851 cÚ¡ * 
symbŞ
,

852 
boŞ
 
is_backw¬d
,

853 
lock_mode_t
 
®m
,

854 
boŞ
 
Ãed_tu¶e
)

856 
	`as£¹
 (
±u¶e
);

862 
	`as£¹
 (
_±abË
);

863 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("H_INDEX_2");

864 
	`as£¹
 (
pšdex
);

867 
±u¶e
->
	`£t_v®ue
(1, 
acù_id
);

868 
±u¶e
->
	`£t_v®ue
(2, 
symbŞ
);

869 
±u¶e
->
	`£t_v®ue
(3, (
myTime
)0);

871 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

872 
	`as£¹
 (
»¶ow
.
_de¡
);

875 
±u¶e
->
	`£t_v®ue
(3, 
MAX_DTS
);

877 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

878 
	`as£¹
 (
»phigh
.
_de¡
);

880 if(
is_backw¬d
) {

881 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
, 
®m
, 
Ãed_tu¶e
,

882 
sÿn_šdex_i
::
Ë
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
),

883 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
)));

885 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
, 
®m
, 
Ãed_tu¶e
,

886 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

887 
sÿn_šdex_i
::
Ë
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

890  (
RCOK
);

891 
	}
}

893 
w_rc_t
 
	ghŞdšg_mª_im¶
::
	$h_upd©e_qty
(
ss_m
* 
db
,

894 
hŞdšg_tu¶e
* 
±u¶e
,

895 cÚ¡ 
qty
,

896 
lock_mode_t
 
lm
)

899 
	`as£¹
 (
±u¶e
);

900 
±u¶e
->
	`£t_v®ue
(5, 
qty
);

901  (
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

902 
	}
}

904 
w_rc_t
 
	ghŞdšg_mª_im¶
::
	$h_d–‘e_tu¶e
(
ss_m
* 
db
, 
hŞdšg_tu¶e
* 
±u¶e
, 
rid_t
 
rid
)

906 
	`as£¹
 (
±u¶e
);

909 
±u¶e
->
	`£t_rid
(
rid
);

910 
	`W_DO
(
	`»ad_tu¶e
(
±u¶e
, 
EX
));

913 
	`W_DO
(
	`d–‘e_tu¶e
(
db
, 
±u¶e
));

915  (
RCOK
);

916 
	}
}

923 
w_rc_t
 
	ghŞdšg_hi¡Üy_mª_im¶
::
	$hh_g‘_™”_by_šdex2
(
ss_m
* 
db
,

924 
hŞdšg_hi¡Üy_šdex_™”
* &
™”
,

925 
hŞdšg_hi¡Üy_tu¶e
* 
±u¶e
,

926 
»p_row_t
 &
»¶ow
,

927 
»p_row_t
 &
»phigh
,

928 
TId’t
 
Œade_id
,

929 
lock_mode_t
 
®m
,

930 
boŞ
 
Ãed_tu¶e
)

932 
	`as£¹
 (
±u¶e
);

935 
	`as£¹
 (
_±abË
);

936 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("HH_INDEX_2");

937 
	`as£¹
 (
pšdex
);

942 
±u¶e
->
	`£t_v®ue
(1, 
Œade_id
);

944 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

945 
	`as£¹
 (
»¶ow
.
_de¡
);

947 
±u¶e
->
	`£t_v®ue
(1, 
Œade_id
+1);

949 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

950 
	`as£¹
 (
»phigh
.
_de¡
);

953 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
, 
®m
, 
Ãed_tu¶e
,

954 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

955 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

956  (
RCOK
);

957 
	}
}

964 
w_rc_t
 
	ghŞdšg_summ¬y_mª_im¶
::
	$hs_šdex_´obe
(
ss_m
* 
db
,

965 
hŞdšg_summ¬y_tu¶e
* 
±u¶e
,

966 cÚ¡ 
TId’t
 
acù_id
,

967 cÚ¡ * 
symbŞ
)

969 
	`as£¹
 (
±u¶e
);

970 
±u¶e
->
	`£t_v®ue
(0, 
acù_id
);

971 
±u¶e
->
	`£t_v®ue
(1, 
symbŞ
);

972  (
	`šdex_´obe_by_Çme
(
db
, "HS_INDEX", 
±u¶e
));

973 
	}
}

975 
w_rc_t
 
	ghŞdšg_summ¬y_mª_im¶
::
	$hs_upd©e_qty
(
ss_m
* 
db
,

976 
hŞdšg_summ¬y_tu¶e
* 
±u¶e
,

977 cÚ¡ 
TId’t
 
acù_id
,

978 cÚ¡ * 
symbŞ
,

979 cÚ¡ 
qty
,

980 
lock_mode_t
 
lm
)

982 
	`as£¹
 (
±u¶e
);

984 
±u¶e
->
	`£t_v®ue
(0, 
acù_id
);

985 
±u¶e
->
	`£t_v®ue
(1, 
symbŞ
);

986 
	`W_DO
(
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "HS_INDEX", 
±u¶e
));

988 
±u¶e
->
	`£t_v®ue
(2, 
qty
);

989  (
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

990 
	}
}

992 
w_rc_t
 
	ghŞdšg_summ¬y_mª_im¶
::
	$hs_g‘_™”_by_šdex
(
ss_m
* 
db
,

993 
hŞdšg_summ¬y_šdex_™”
* &
™”
,

994 
hŞdšg_summ¬y_tu¶e
* 
±u¶e
,

995 
»p_row_t
 &
»¶ow
,

996 
»p_row_t
 &
»phigh
,

997 cÚ¡ 
TId’t
 
acù_id
,

998 
boŞ
 
Ãed_tu¶e
,

999 
lock_mode_t
 
®m
)

1001 
	`as£¹
 (
±u¶e
);

1004 
	`as£¹
 (
_±abË
);

1005 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("HS_INDEX");

1006 
	`as£¹
 (
pšdex
);

1011 
±u¶e
->
	`£t_v®ue
(0, 
acù_id
);

1012 
±u¶e
->
	`£t_v®ue
(1, "");

1014 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

1015 
	`as£¹
 (
»¶ow
.
_de¡
);

1017 
‹mp
[2];

1018 
‹mp
[0] = 
	`MAX
('z', 'Z')+1;

1019 
‹mp
[1] = '\0';

1020 
±u¶e
->
	`£t_v®ue
(1, 
‹mp
);

1022 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

1023 
	`as£¹
 (
»phigh
.
_de¡
);

1026 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
, 
®m
, 
Ãed_tu¶e
,

1027 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

1028 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

1029  (
RCOK
);

1030 
	}
}

1037 
w_rc_t
 
	gšdu¡ry_mª_im¶
::
	$š_šdex_´obe
(
ss_m
* 
db
, 
šdu¡ry_tu¶e
* 
±u¶e
, cÚ¡ * 
id
)

1039 
	`as£¹
 (
±u¶e
);

1040 
±u¶e
->
	`£t_v®ue
(0, 
id
);

1041  (
	`šdex_´obe_by_Çme
(
db
, "IN_INDEX", 
±u¶e
));

1042 
	}
}

1044 
w_rc_t
 
	gšdu¡ry_mª_im¶
::
	$š_g‘_™”_by_šdex2
(
ss_m
* 
db
,

1045 
šdu¡ry_šdex_™”
* &
™”
,

1046 
šdu¡ry_tu¶e
* 
±u¶e
,

1047 
»p_row_t
 &
»¶ow
,

1048 
»p_row_t
 &
»phigh
,

1049 cÚ¡ * 
š_Çme
,

1050 
lock_mode_t
 
®m
,

1051 
boŞ
 
Ãed_tu¶e
)

1053 
	`as£¹
 (
±u¶e
);

1056 
	`as£¹
 (
_±abË
);

1057 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("IN_INDEX_2");

1058 
	`as£¹
 (
pšdex
);

1061 
±u¶e
->
	`£t_v®ue
(1, 
š_Çme
);

1062 
±u¶e
->
	`£t_v®ue
(0, "");

1064 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

1065 
	`as£¹
 (
»¶ow
.
_de¡
);

1068 
‹mp
[2];

1069 
‹mp
[0] = 
	`MAX
('z', 'Z')+1;

1070 
‹mp
[1] = '\0';

1071 
±u¶e
->
	`£t_v®ue
(0, 
‹mp
);

1073 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

1074 
	`as£¹
 (
»phigh
.
_de¡
);

1077 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
,

1078 
®m
, 
Ãed_tu¶e
,

1079 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

1080 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

1081  (
RCOK
);

1082 
	}
}

1084 
w_rc_t
 
	gšdu¡ry_mª_im¶
::
	$š_g‘_™”_by_šdex3
(
ss_m
* 
db
,

1085 
šdu¡ry_šdex_™”
* &
™”
,

1086 
šdu¡ry_tu¶e
* 
±u¶e
,

1087 
»p_row_t
 &
»¶ow
,

1088 
»p_row_t
 &
»phigh
,

1089 cÚ¡ * 
sc_id
,

1090 
lock_mode_t
 
®m
,

1091 
boŞ
 
Ãed_tu¶e
)

1093 
	`as£¹
 (
±u¶e
);

1096 
	`as£¹
 (
_±abË
);

1097 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("IN_INDEX_3");

1098 
	`as£¹
 (
pšdex
);

1101 
±u¶e
->
	`£t_v®ue
(2, 
sc_id
);

1102 
±u¶e
->
	`£t_v®ue
(0, "");

1104 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

1105 
	`as£¹
 (
»¶ow
.
_de¡
);

1108 
‹mp
[2];

1109 
‹mp
[0] = 
	`MAX
('z', 'Z')+1;

1110 
‹mp
[1] = '\0';

1111 
±u¶e
->
	`£t_v®ue
(0, 
‹mp
);

1113 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

1114 
	`as£¹
 (
»phigh
.
_de¡
);

1117 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
,

1118 
®m
, 
Ãed_tu¶e
,

1119 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

1120 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

1121  (
RCOK
);

1122 
	}
}

1129 
w_rc_t
 
	gÏ¡_Œade_mª_im¶
::
	$É_šdex_´obe
(
ss_m
* 
db
, 
Ï¡_Œade_tu¶e
* 
±u¶e
, cÚ¡ * 
symbŞ
)

1131 
	`as£¹
 (
±u¶e
);

1132 
±u¶e
->
	`£t_v®ue
(0, 
symbŞ
);

1133  (
	`šdex_´obe_by_Çme
(
db
, "LT_INDEX", 
±u¶e
));

1134 
	}
}

1136 
w_rc_t
 
	gÏ¡_Œade_mª_im¶
::
	$É_upd©e_by_šdex
(
ss_m
* 
db
, 
Ï¡_Œade_tu¶e
* 
±u¶e
,

1137 cÚ¡ * 
symbŞ
,

1138 cÚ¡ 
´iû_quÙe
,

1139 cÚ¡ 
Œade_qty
,

1140 cÚ¡ 
myTime
 
now_dts
,

1141 
lock_mode_t
 
lm
)

1143 
	`as£¹
 (
±u¶e
);

1148 
±u¶e
->
	`£t_v®ue
(0, 
symbŞ
);

1149 
	`W_DO
(
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "LT_INDEX", 
±u¶e
));

1151 
É_vŞ
;

1152 
±u¶e
->
	`g‘_v®ue
(4, 
É_vŞ
);

1154 
±u¶e
->
	`£t_v®ue
(4, 
É_vŞ
 + ()
Œade_qty
);

1155 
±u¶e
->
	`£t_v®ue
(2, 
´iû_quÙe
);

1156 
±u¶e
->
	`£t_v®ue
(1, 
now_dts
);

1157  (
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

1158 
	}
}

1165 
w_rc_t
 
	g£cur™y_mª_im¶
::
	$s_šdex_´obe
(
ss_m
* 
db
, 
£cur™y_tu¶e
* 
±u¶e
, cÚ¡ * 
symbŞ
)

1167 
	`as£¹
 (
±u¶e
);

1168 
±u¶e
->
	`£t_v®ue
(0, 
symbŞ
);

1169  (
	`šdex_´obe_by_Çme
(
db
, "S_INDEX", 
±u¶e
));

1170 
	}
}

1172 
w_rc_t
 
	g£cur™y_mª_im¶
::
	$s_g‘_™”_by_šdex4
(
ss_m
* 
db
,

1173 
£cur™y_šdex_™”
* &
™”
,

1174 
£cur™y_tu¶e
* 
±u¶e
,

1175 
»p_row_t
 &
»¶ow
,

1176 
»p_row_t
 &
»phigh
,

1177 cÚ¡ 
TId’t
 
co_id
,

1178 
lock_mode_t
 
®m
,

1179 
boŞ
 
Ãed_tu¶e
)

1181 
	`as£¹
 (
±u¶e
);

1184 
	`as£¹
 (
_±abË
);

1186 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("S_INDEX_4");

1187 
	`as£¹
 (
pšdex
);

1192 
±u¶e
->
	`£t_v®ue
(5, 
co_id
);

1193 
±u¶e
->
	`£t_v®ue
(1, "");

1194 
±u¶e
->
	`£t_v®ue
(0, "");

1196 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

1197 
	`as£¹
 (
»¶ow
.
_de¡
);

1199 
‹mp
[2];

1200 
‹mp
[0] = 
	`MAX
('z', 'Z')+1;

1201 
‹mp
[1] = '\0';

1202 
±u¶e
->
	`£t_v®ue
(1, 
‹mp
);

1203 
±u¶e
->
	`£t_v®ue
(0, 
‹mp
);

1204 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

1205 
	`as£¹
 (
»phigh
.
_de¡
);

1208 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
, 
®m
, 
Ãed_tu¶e
,

1209 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

1210 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

1211  (
RCOK
);

1212 
	}
}

1214 
w_rc_t
 
	g£cur™y_mª_im¶
::
	$s_g‘_™”_by_šdex4
(
ss_m
* 
db
,

1215 
£cur™y_šdex_™”
* &
™”
,

1216 
£cur™y_tu¶e
* 
±u¶e
,

1217 
»p_row_t
 &
»¶ow
,

1218 
»p_row_t
 &
»phigh
,

1219 cÚ¡ 
TId’t
 
co_id
,

1220 cÚ¡ * 
issue
,

1221 
lock_mode_t
 
®m
,

1222 
boŞ
 
Ãed_tu¶e
)

1224 
	`as£¹
 (
±u¶e
);

1227 
	`as£¹
 (
_±abË
);

1229 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("S_INDEX_4");

1230 
	`as£¹
 (
pšdex
);

1235 
±u¶e
->
	`£t_v®ue
(5, 
co_id
);

1236 
±u¶e
->
	`£t_v®ue
(1, 
issue
);

1237 
±u¶e
->
	`£t_v®ue
(0, "");

1239 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

1240 
	`as£¹
 (
»¶ow
.
_de¡
);

1242 
‹mp
[2];

1243 
‹mp
[0] = 
	`MAX
('z', 'Z')+1;

1244 
‹mp
[1] = '\0';

1245 
±u¶e
->
	`£t_v®ue
(0, 
‹mp
);

1246 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

1247 
	`as£¹
 (
»phigh
.
_de¡
);

1250 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
, 
®m
, 
Ãed_tu¶e
,

1251 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

1252 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

1253  (
RCOK
);

1254 
	}
}

1256 
w_rc_t
 
	g£cur™y_mª_im¶
::
	$s_g‘_™”_by_šdex
(
ss_m
* 
db
,

1257 
£cur™y_šdex_™”
* &
™”
,

1258 
£cur™y_tu¶e
* 
±u¶e
,

1259 
»p_row_t
 &
»¶ow
,

1260 
»p_row_t
 &
»phigh
,

1261 cÚ¡ * 
symbŞ
,

1262 
lock_mode_t
 
®m
,

1263 
boŞ
 
Ãed_tu¶e
)

1265 
	`as£¹
 (
±u¶e
);

1268 
	`as£¹
 (
_±abË
);

1269 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("S_INDEX");

1270 
	`as£¹
 (
pšdex
);

1275 
±u¶e
->
	`£t_v®ue
(0, 
symbŞ
);

1277 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

1278 
	`as£¹
 (
»¶ow
.
_de¡
);

1280 
‹mp
[2];

1281 
‹mp
[0] = 
	`MAX
('z', 'Z')+1;

1282 
‹mp
[1] = '\0';

1283 
±u¶e
->
	`£t_v®ue
(0, 
‹mp
);

1285 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

1286 
	`as£¹
 (
»phigh
.
_de¡
);

1289 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
, 
®m
, 
Ãed_tu¶e
,

1290 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

1291 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

1292  (
RCOK
);

1293 
	}
}

1295 
w_rc_t
 
	g£cur™y_mª_im¶
::
	$s_šdex_´obe_fÜupd©e
(
ss_m
* 
db
,

1296 
£cur™y_tu¶e
* 
±u¶e
,

1297 cÚ¡ * 
symbŞ
)

1299 
	`as£¹
 (
±u¶e
);

1300 
±u¶e
->
	`£t_v®ue
(0, 
symbŞ
);

1301  (
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "S_INDEX", 
±u¶e
));

1302 
	}
}

1304 
w_rc_t
 
	g£cur™y_mª_im¶
::
	$s_upd©e_ed
(
ss_m
* 
db
, 
£cur™y_tu¶e
* 
±u¶e
, cÚ¡ 
myTime
 
exch_d©e
, 
lock_mode_t
 
lm
)

1306 
	`as£¹
 (
±u¶e
);

1307 
±u¶e
->
	`£t_v®ue
(8, 
exch_d©e
);

1308  (
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

1309 
	}
}

1316 
w_rc_t
 
	gÃws_™em_mª_im¶
::
	$ni_šdex_´obe
(
ss_m
* 
db
, 
Ãws_™em_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
ni_id
)

1318 
	`as£¹
 (
±u¶e
);

1319 
±u¶e
->
	`£t_v®ue
(0, 
ni_id
);

1320  (
	`šdex_´obe_by_Çme
(
db
, "NI_INDEX", 
±u¶e
));

1321 
	}
}

1323 
w_rc_t
 
	gÃws_™em_mª_im¶
::
	$ni_šdex_´obe_fÜupd©e
(
ss_m
* 
db
,

1324 
Ãws_™em_tu¶e
* 
±u¶e
,

1325 cÚ¡ 
TId’t
 
ni_id
)

1327 
	`as£¹
 (
±u¶e
);

1328 
±u¶e
->
	`£t_v®ue
(0, 
ni_id
);

1329  (
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "NI_INDEX", 
±u¶e
));

1330 
	}
}

1332 
w_rc_t
 
	gÃws_™em_mª_im¶
::
	$ni_upd©e_dts_by_šdex
(
ss_m
* 
db
,

1333 
Ãws_™em_tu¶e
* 
±u¶e
,

1334 cÚ¡ 
myTime
 
ni_dts
,

1335 
lock_mode_t
 
lm
)

1337 
	`as£¹
 (
±u¶e
);

1338 
±u¶e
->
	`£t_v®ue
(4, 
ni_dts
);

1339  (
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

1340 
	}
}

1347 
w_rc_t
 
	gÃws_x»f_mª_im¶
::
	$nx_g‘_bË_™”
(
ss_m
* 
db
, 
bË_™”
* &
™”
)

1350 
	`W_DO
(
	`g‘_™”_fÜ_fe_sÿn
(
db
, 
™”
));

1351  (
RCOK
);

1352 
	}
}

1354 
w_rc_t
 
	gÃws_x»f_mª_im¶
::
	$nx_g‘_™”_by_šdex
(
ss_m
* 
db
,

1355 
Ãws_x»f_šdex_™”
* &
™”
,

1356 
Ãws_x»f_tu¶e
* 
±u¶e
,

1357 
»p_row_t
 &
»¶ow
,

1358 
»p_row_t
 &
»phigh
,

1359 cÚ¡ 
TId’t
 
co_id
,

1360 
lock_mode_t
 
®m
,

1361 
boŞ
 
Ãed_tu¶e
)

1363 
	`as£¹
 (
±u¶e
);

1366 
	`as£¹
 (
_±abË
);

1367 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("NX_INDEX");

1368 
	`as£¹
 (
pšdex
);

1371 
±u¶e
->
	`£t_v®ue
(1, 
co_id
);

1372 
±u¶e
->
	`£t_v®ue
(0, ()0);

1374 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

1375 
	`as£¹
 (
»¶ow
.
_de¡
);

1378 
±u¶e
->
	`£t_v®ue
(0, 
MAX_ID
);

1380 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

1381 
	`as£¹
 (
»phigh
.
_de¡
);

1384 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
, 
®m
, 
Ãed_tu¶e
,

1385 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

1386 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

1387  (
RCOK
);

1388 
	}
}

1395 
w_rc_t
 
	g¡©us_ty³_mª_im¶
::
	$¡_šdex_´obe
(
ss_m
* 
db
, 
¡©us_ty³_tu¶e
* 
±u¶e
, cÚ¡ * 
¡_id
)

1397 
	`as£¹
 (
±u¶e
);

1398 
±u¶e
->
	`£t_v®ue
(0, 
¡_id
);

1399  (
	`šdex_´obe_by_Çme
(
db
, "ST_INDEX", 
±u¶e
));

1400 
	}
}

1407 
w_rc_t
 
	g£ùÜ_mª_im¶
::
	$sc_g‘_™”_by_šdex2
(
ss_m
* 
db
,

1408 
£ùÜ_šdex_™”
* &
™”
,

1409 
£ùÜ_tu¶e
* 
±u¶e
,

1410 
»p_row_t
 &
»¶ow
,

1411 
»p_row_t
 &
»phigh
,

1412 cÚ¡ * 
sc_Çme
,

1413 
lock_mode_t
 
®m
,

1414 
boŞ
 
Ãed_tu¶e
)

1416 
	`as£¹
 (
±u¶e
);

1419 
	`as£¹
 (
_±abË
);

1420 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("SC_INDEX_2");

1421 
	`as£¹
 (
pšdex
);

1424 
±u¶e
->
	`£t_v®ue
(1, 
sc_Çme
);

1425 
±u¶e
->
	`£t_v®ue
(0, "");

1427 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

1428 
	`as£¹
 (
»¶ow
.
_de¡
);

1431 
‹mp
[2];

1432 
‹mp
[0] = 
	`MAX
('z', 'Z')+1;

1433 
‹mp
[1] = '\0';

1434 
±u¶e
->
	`£t_v®ue
(0, 
‹mp
);

1436 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

1437 
	`as£¹
 (
»phigh
.
_de¡
);

1440 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
,

1441 
®m
, 
Ãed_tu¶e
,

1442 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

1443 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

1444  (
RCOK
);

1445 
	}
}

1452 
w_rc_t
 
	g£‰Ëm’t_mª_im¶
::
	$£_šdex_´obe
(
ss_m
* 
db
, 
£‰Ëm’t_tu¶e
* 
±u¶e
,cÚ¡ 
TId’t
 
Œ_id
)

1454 
	`as£¹
 (
±u¶e
);

1455 
±u¶e
->
	`£t_v®ue
(0, 
Œ_id
);

1456  (
	`šdex_´obe_by_Çme
(
db
, "SE_INDEX", 
±u¶e
));

1457 
	}
}

1459 
w_rc_t
 
	g£‰Ëm’t_mª_im¶
::
	$£_šdex_´obe_fÜupd©e
(
ss_m
* 
db
, 
£‰Ëm’t_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
Œ_id
)

1461 
	`as£¹
 (
±u¶e
);

1462 
±u¶e
->
	`£t_v®ue
(0, 
Œ_id
);

1463  (
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "SE_INDEX", 
±u¶e
));

1464 
	}
}

1466 
w_rc_t
 
	g£‰Ëm’t_mª_im¶
::
	$£_upd©e_Çme
(
ss_m
* 
db
, 
£‰Ëm’t_tu¶e
* 
±u¶e
, cÚ¡ * 
ÿsh_ty³
, 
lock_mode_t
 
lm
)

1468 
	`as£¹
 (
±u¶e
);

1469 
±u¶e
->
	`£t_v®ue
(1, 
ÿsh_ty³
);

1470  (
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

1471 
	}
}

1478 
w_rc_t
 
	gx¿‹_mª_im¶
::
	$tx_šdex_´obe
(
ss_m
* 
db
, 
x¿‹_tu¶e
* 
±u¶e
, cÚ¡ * 
tx_id
)

1480 
	`as£¹
 (
±u¶e
);

1481 
±u¶e
->
	`£t_v®ue
(0, 
tx_id
);

1482  (
	`šdex_´obe_by_Çme
(
db
, "TX_INDEX", 
±u¶e
));

1483 
	}
}

1485 
w_rc_t
 
	gx¿‹_mª_im¶
::
	$tx_šdex_´obe_fÜupd©e
(
ss_m
* 
db
, 
x¿‹_tu¶e
* 
±u¶e
, cÚ¡ * 
tx_id
)

1487 
	`as£¹
 (
±u¶e
);

1488 
±u¶e
->
	`£t_v®ue
(0, 
tx_id
);

1489  (
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "TX_INDEX", 
±u¶e
));

1490 
	}
}

1492 
w_rc_t
 
	gx¿‹_mª_im¶
::
	$tx_upd©e_Çme
(
ss_m
* 
db
, 
x¿‹_tu¶e
* 
±u¶e
, cÚ¡ * 
tx_Çme
, 
lock_mode_t
 
lm
)

1494 
	`as£¹
 (
±u¶e
);

1495 
±u¶e
->
	`£t_v®ue
(1, 
tx_Çme
);

1496  (
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

1497 
	}
}

1504 
w_rc_t
 
	gŒade_mª_im¶
::
	$t_šdex_´obe
(
ss_m
* 
db
, 
Œade_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
Œade_id
)

1506 
	`as£¹
 (
±u¶e
);

1507 
±u¶e
->
	`£t_v®ue
(0, 
Œade_id
);

1508  (
	`šdex_´obe_by_Çme
(
db
, "T_INDEX", 
±u¶e
));

1509 
	}
}

1511 
w_rc_t
 
	gŒade_mª_im¶
::
	$t_upd©e_x_by_šdex
(
ss_m
* 
db
,

1512 
Œade_tu¶e
* 
±u¶e
,

1513 cÚ¡ 
TId’t
 
t_id
,

1514 cÚ¡ 
x_amouÁ
,

1515 
lock_mode_t
 
lm
)

1517 
	`as£¹
 (
±u¶e
);

1521 
±u¶e
->
	`£t_v®ue
(0, 
t_id
);

1522 
	`W_DO
(
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "T_INDEX", 
±u¶e
));

1524 
±u¶e
->
	`£t_v®ue
(13, 
x_amouÁ
);

1525  (
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

1526 
	}
}

1528 
w_rc_t
 
	gŒade_mª_im¶
::
	$t_upd©e_dts_¡did_by_šdex
(
ss_m
* 
db
,

1529 
Œade_tu¶e
* 
±u¶e
,

1530 cÚ¡ 
TId’t
 
»q_Œade_id
,

1531 cÚ¡ 
myTime
 
now_dts
,

1532 cÚ¡ * 
¡©us_subm™‹d
,

1533 
lock_mode_t
 
lm
)

1535 
	`as£¹
 (
±u¶e
);

1546 
±u¶e
->
	`£t_v®ue
(0, 
»q_Œade_id
);

1547 
	`W_DO
(
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "T_INDEX", 
±u¶e
));

1550 
	`W_DO
(
	`d–‘e_šdex_’Œy
(
db
, "T_INDEX_2", 
±u¶e
));

1551 
	`W_DO
(
	`d–‘e_šdex_’Œy
(
db
, "T_INDEX_3", 
±u¶e
));

1554 
±u¶e
->
	`£t_v®ue
(1, 
now_dts
);

1555 
±u¶e
->
	`£t_v®ue
(2, 
¡©us_subm™‹d
);

1556 
	`W_DO
(
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

1559 
	`W_DO
(
	`add_šdex_’Œy
(
db
, "T_INDEX_2", 
±u¶e
));

1560 
	`W_DO
(
	`add_šdex_’Œy
(
db
, "T_INDEX_3", 
±u¶e
));

1562  (
RCOK
);

1563 
	}
}

1565 
w_rc_t
 
	gŒade_mª_im¶
::
	$t_upd©e_ÿ_td_sci__by_šdex
(
ss_m
* 
db
,

1566 
Œade_tu¶e
* 
±u¶e
,

1567 cÚ¡ 
TId’t
 
Œade_id
,

1568 cÚ¡ 
comm_amouÁ
,

1569 cÚ¡ 
myTime
 
Œade_dts
,

1570 cÚ¡ * 
¡_com¶‘ed_id
,

1571 cÚ¡ 
Œade_´iû
,

1572 
lock_mode_t
 
lm
)

1574 
	`as£¹
 (
±u¶e
);

1577 
±u¶e
->
	`£t_v®ue
(0, 
Œade_id
);

1578 
	`W_DO
(
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "T_INDEX", 
±u¶e
));

1581 
	`W_DO
(
	`d–‘e_šdex_’Œy
(
db
, "T_INDEX_2", 
±u¶e
));

1582 
	`W_DO
(
	`d–‘e_šdex_’Œy
(
db
, "T_INDEX_3", 
±u¶e
));

1585 
±u¶e
->
	`£t_v®ue
(1, 
Œade_dts
);

1586 
±u¶e
->
	`£t_v®ue
(2, 
¡_com¶‘ed_id
);

1587 
±u¶e
->
	`£t_v®ue
(10, 
Œade_´iû
);

1588 
±u¶e
->
	`£t_v®ue
(12, 
comm_amouÁ
);

1589 
	`W_DO
(
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

1592 
	`W_DO
(
	`add_šdex_’Œy
(
db
, "T_INDEX_2", 
±u¶e
));

1593 
	`W_DO
(
	`add_šdex_’Œy
(
db
, "T_INDEX_3", 
±u¶e
));

1595  (
RCOK
);

1596 
	}
}

1598 
w_rc_t
 
	gŒade_mª_im¶
::
	$t_g‘_™”_by_šdex2
(
ss_m
* 
db
,

1599 
Œade_šdex_™”
* &
™”
,

1600 
Œade_tu¶e
* 
±u¶e
,

1601 
»p_row_t
 &
»¶ow
,

1602 
»p_row_t
 &
»phigh
,

1603 cÚ¡ 
TId’t
 
acù_id
,

1604 cÚ¡ 
myTime
 
¡¬t_dts
,

1605 cÚ¡ 
myTime
 
’d_dts
,

1606 
boŞ
 
is_backw¬d
,

1607 
boŞ
 
Ãed_tu¶e
,

1608 
lock_mode_t
 
®m
)

1610 
	`as£¹
 (
±u¶e
);

1615 
	`as£¹
 (
_±abË
);

1616 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("T_INDEX_2");

1617 
	`as£¹
 (
pšdex
);

1620 
±u¶e
->
	`£t_v®ue
(8, 
acù_id
);

1621 
±u¶e
->
	`£t_v®ue
(1, 
¡¬t_dts
);

1622 
±u¶e
->
	`£t_v®ue
(0, () 0);

1624 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

1625 
	`as£¹
 (
»¶ow
.
_de¡
);

1629 
±u¶e
->
	`£t_v®ue
(1, 
MAX_DTS
);

1630 
±u¶e
->
	`£t_v®ue
(0, 
MAX_ID
);

1632 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

1633 
	`as£¹
 (
»phigh
.
_de¡
);

1636 if(
is_backw¬d
) {

1637 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
, 
®m
, 
Ãed_tu¶e
,

1638 
sÿn_šdex_i
::
Ë
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
),

1639 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
)));

1641 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
, 
®m
, 
Ãed_tu¶e
,

1642 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

1643 
sÿn_šdex_i
::
Ë
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

1646  (
RCOK
);

1647 
	}
}

1649 
w_rc_t
 
	gŒade_mª_im¶
::
	$t_g‘_™”_by_šdex3
(
ss_m
* 
db
,

1650 
Œade_šdex_™”
* &
™”
,

1651 
Œade_tu¶e
* 
±u¶e
,

1652 
»p_row_t
 &
»¶ow
,

1653 
»p_row_t
 &
»phigh
,

1654 cÚ¡ * 
symbŞ
,

1655 cÚ¡ 
myTime
 
¡¬t_dts
,

1656 cÚ¡ 
myTime
 
’d_dts
,

1657 
lock_mode_t
 
®m
,

1658 
boŞ
 
Ãed_tu¶e
)

1660 
	`as£¹
 (
±u¶e
);

1667 
	`as£¹
 (
_±abË
);

1668 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("T_INDEX_3");

1669 
	`as£¹
 (
pšdex
);

1672 
±u¶e
->
	`£t_v®ue
(5, 
symbŞ
);

1673 
±u¶e
->
	`£t_v®ue
(1, 
¡¬t_dts
);

1675 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

1676 
	`as£¹
 (
»¶ow
.
_de¡
);

1679 
±u¶e
->
	`£t_v®ue
(5, 
symbŞ
);

1680 
±u¶e
->
	`£t_v®ue
(1, 
’d_dts
);

1682 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

1683 
	`as£¹
 (
»phigh
.
_de¡
);

1687 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
, 
®m
, 
Ãed_tu¶e
,

1688 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

1689 
sÿn_šdex_i
::
Ë
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

1690  (
RCOK
);

1691 
	}
}

1693 
w_rc_t
 
	gŒade_mª_im¶
::
	$t_šdex_´obe_fÜupd©e
(
ss_m
* 
db
, 
Œade_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
t_id
)

1695 
	`as£¹
 (
±u¶e
);

1696 
±u¶e
->
	`£t_v®ue
(0, 
t_id
);

1697  (
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "T_INDEX", 
±u¶e
));

1698 
	}
}

1700 
w_rc_t
 
	gŒade_mª_im¶
::
	$t_upd©e_Çme
(
ss_m
* 
db
, 
Œade_tu¶e
* 
±u¶e
, cÚ¡ * 
exec_Çme
, 
lock_mode_t
 
lm
)

1702 
	`as£¹
 (
±u¶e
);

1703 
±u¶e
->
	`£t_v®ue
(9, 
exec_Çme
);

1704  (
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

1705 
	}
}

1707 
w_rc_t
 
	gŒade_mª_im¶
::
	$t_g‘_™”_by_šdex
(
ss_m
* 
db
,

1708 
Œade_šdex_™”
* &
™”
,

1709 
Œade_tu¶e
* 
±u¶e
,

1710 
»p_row_t
 &
»¶ow
,

1711 
»p_row_t
 &
»phigh
,

1712 cÚ¡ 
TId’t
 
t_id
,

1713 
lock_mode_t
 
®m
,

1714 
boŞ
 
Ãed_tu¶e
)

1716 
	`as£¹
 (
±u¶e
);

1721 
	`as£¹
 (
_±abË
);

1722 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("T_INDEX");

1723 
	`as£¹
 (
pšdex
);

1726 
±u¶e
->
	`£t_v®ue
(0, 
t_id
);

1728 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

1729 
	`as£¹
 (
»¶ow
.
_de¡
);

1732 
±u¶e
->
	`£t_v®ue
(0, 
MAX_ID
);

1734 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

1735 
	`as£¹
 (
»phigh
.
_de¡
);

1738 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
, 
®m
, 
Ãed_tu¶e
,

1739 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

1740 
sÿn_šdex_i
::
Ë
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

1741  (
RCOK
);

1742 
	}
}

1749 
w_rc_t
 
	gŒade_hi¡Üy_mª_im¶
::
	$th_g‘_™”_by_šdex
(
ss_m
* 
db
,

1750 
Œade_hi¡Üy_šdex_™”
* &
™”
,

1751 
Œade_hi¡Üy_tu¶e
* 
±u¶e
,

1752 
»p_row_t
 &
»¶ow
,

1753 
»p_row_t
 &
»phigh
,

1754 cÚ¡ 
TId’t
 
t_id
,

1755 
lock_mode_t
 
®m
,

1756 
boŞ
 
Ãed_tu¶e
)

1758 
	`as£¹
 (
±u¶e
);

1761 
	`as£¹
 (
_±abË
);

1762 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("TH_INDEX_3");

1763 
	`as£¹
 (
pšdex
);

1766 
±u¶e
->
	`£t_v®ue
(0, 
t_id
);

1767 
±u¶e
->
	`£t_v®ue
(1, () 0);

1769 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

1770 
	`as£¹
 (
»¶ow
.
_de¡
);

1773 
±u¶e
->
	`£t_v®ue
(0, 
t_id
+1);

1775 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

1776 
	`as£¹
 (
»phigh
.
_de¡
);

1779 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
,

1780 
®m
, 
Ãed_tu¶e
,

1781 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

1782 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

1783  (
RCOK
);

1784 
	}
}

1791 
w_rc_t
 
	gŒade_»que¡_mª_im¶
::
	$Œ_d–‘e_tu¶e
(
ss_m
* 
db
, 
Œade_»que¡_tu¶e
* 
±u¶e
, 
rid_t
 
rid
)

1793 
	`as£¹
 (
±u¶e
);

1796 
±u¶e
->
	`£t_rid
(
rid
);

1797 
	`W_DO
(
	`»ad_tu¶e
(
±u¶e
, 
EX
));

1800 
	`W_DO
(
	`d–‘e_tu¶e
(
db
, 
±u¶e
));

1802  (
RCOK
);

1803 
	}
}

1805 
w_rc_t
 
	gŒade_»que¡_mª_im¶
::
	$Œ_g‘_™”_by_šdex4
(
ss_m
* 
db
,

1806 
Œade_»que¡_šdex_™”
* &
™”
,

1807 
Œade_»que¡_tu¶e
* 
±u¶e
,

1808 
»p_row_t
 &
»¶ow
,

1809 
»p_row_t
 &
»phigh
,

1810 cÚ¡ * 
Œ_s_symb
,

1811 cÚ¡ 
TId’t
 
Œ_b_id
,

1812 
lock_mode_t
 
®m
,

1813 
boŞ
 
Ãed_tu¶e
)

1815 
	`as£¹
 (
±u¶e
);

1818 
	`as£¹
 (
_±abË
);

1819 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("TR_INDEX_4");

1820 
	`as£¹
 (
pšdex
);

1825 
±u¶e
->
	`£t_v®ue
(2, 
Œ_s_symb
);

1826 
±u¶e
->
	`£t_v®ue
(5, 
Œ_b_id
);

1828 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

1829 
	`as£¹
 (
»¶ow
.
_de¡
);

1831 
±u¶e
->
	`£t_v®ue
(5, 
Œ_b_id
+1);

1833 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

1834 
	`as£¹
 (
»phigh
.
_de¡
);

1837 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
, 
®m
, 
Ãed_tu¶e
,

1838 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

1839 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

1840  (
RCOK
);

1841 
	}
}

1843 
w_rc_t
 
	gŒade_»que¡_mª_im¶
::
	$Œ_g‘_™”_by_šdex4
(
ss_m
* 
db
,

1844 
Œade_»que¡_šdex_™”
* &
™”
,

1845 
Œade_»que¡_tu¶e
* 
±u¶e
,

1846 
»p_row_t
 &
»¶ow
,

1847 
»p_row_t
 &
»phigh
,

1848 cÚ¡ * 
Œ_s_symb
,

1849 
lock_mode_t
 
®m
,

1850 
boŞ
 
Ãed_tu¶e
)

1852 
	`as£¹
 (
±u¶e
);

1855 
	`as£¹
 (
_±abË
);

1856 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("TR_INDEX_4");

1857 
	`as£¹
 (
pšdex
);

1862 
±u¶e
->
	`£t_v®ue
(2, 
Œ_s_symb
);

1863 
±u¶e
->
	`£t_v®ue
(5, () 0);

1865 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

1866 
	`as£¹
 (
»¶ow
.
_de¡
);

1868 
±u¶e
->
	`£t_v®ue
(5, 
MAX_ID
);

1870 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

1871 
	`as£¹
 (
»phigh
.
_de¡
);

1874 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
, 
®m
, 
Ãed_tu¶e
,

1875 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

1876 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

1877  (
RCOK
);

1878 
	}
}

1885 
w_rc_t
 
	gŒade_ty³_mª_im¶
::
	$‰_šdex_´obe
(
ss_m
* 
db
,

1886 
Œade_ty³_tu¶e
* 
±u¶e
,

1887 cÚ¡ * 
Œade_ty³_id
)

1889 
	`as£¹
 (
±u¶e
);

1890 
±u¶e
->
	`£t_v®ue
(0, 
Œade_ty³_id
);

1891  (
	`šdex_´obe_by_Çme
(
db
, "TT_INDEX", 
±u¶e
));

1892 
	}
}

1899 
w_rc_t
 
	gw©ch_™em_mª_im¶
::
	$wi_upd©e_symb
(
ss_m
* 
db
, 
w©ch_™em_tu¶e
* 
±u¶e
, cÚ¡ 
TId’t
 
wl_id
,

1900 cÚ¡ * 
Şd_symbŞ
, cÚ¡ * 
Ãw_symbŞ
, 
lock_mode_t
 
lm
)

1903 
	`as£¹
 (
±u¶e
);

1904 
±u¶e
->
	`£t_v®ue
(0, 
wl_id
);

1905 
±u¶e
->
	`£t_v®ue
(1, 
Şd_symbŞ
);

1906 
	`W_DO
(
	`šdex_´obe_fÜupd©e_by_Çme
(
db
, "WI_INDEX", 
±u¶e
));

1909 
	`W_DO
(
	`d–‘e_šdex_’Œy
(
db
, "WI_INDEX", 
±u¶e
));

1912 
±u¶e
->
	`£t_v®ue
(1, 
Ãw_symbŞ
);

1913 
	`W_DO
(
	`upd©e_tu¶e
(
db
, 
±u¶e
, 
lm
));

1916 
	`W_DO
(
	`add_šdex_’Œy
(
db
, "WI_INDEX", 
±u¶e
));

1917 
	}
}

1919 
w_rc_t
 
	gw©ch_™em_mª_im¶
::
	$wi_g‘_™”_by_šdex
(
ss_m
* 
db
,

1920 
w©ch_™em_šdex_™”
* &
™”
,

1921 
w©ch_™em_tu¶e
* 
±u¶e
,

1922 
»p_row_t
 &
»¶ow
,

1923 
»p_row_t
 &
»phigh
,

1924 cÚ¡ 
TId’t
 
wl_id
,

1925 
lock_mode_t
 
®m
,

1926 
boŞ
 
Ãed_tu¶e
)

1928 
	`as£¹
 (
±u¶e
);

1931 
	`as£¹
 (
_±abË
);

1932 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("WI_INDEX");

1933 
	`as£¹
 (
pšdex
);

1936 
±u¶e
->
	`£t_v®ue
(0, 
wl_id
);

1937 
±u¶e
->
	`£t_v®ue
(1, "");

1939 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

1940 
	`as£¹
 (
»¶ow
.
_de¡
);

1943 
‹mp
[2];

1944 
‹mp
[0] = 
	`MAX
('z', 'Z')+1;

1945 
‹mp
[1] = '\0';

1946 
±u¶e
->
	`£t_v®ue
(1, 
‹mp
);

1948 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

1949 
	`as£¹
 (
»phigh
.
_de¡
);

1952 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
,

1953 
®m
, 
Ãed_tu¶e
,

1954 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

1955 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

1956  (
RCOK
);

1957 
	}
}

1964 
w_rc_t
 
	gw©ch_li¡_mª_im¶
::
	$wl_g‘_™”_by_šdex2
(
ss_m
* 
db
,

1965 
w©ch_li¡_šdex_™”
* &
™”
,

1966 
w©ch_li¡_tu¶e
* 
±u¶e
,

1967 
»p_row_t
 &
»¶ow
,

1968 
»p_row_t
 &
»phigh
,

1969 cÚ¡ 
TId’t
 
c_id
,

1970 
lock_mode_t
 
®m
,

1971 
boŞ
 
Ãed_tu¶e
)

1973 
	`as£¹
 (
±u¶e
);

1976 
	`as£¹
 (
_±abË
);

1977 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("WL_INDEX_2");

1978 
	`as£¹
 (
pšdex
);

1981 
±u¶e
->
	`£t_v®ue
(1, 
c_id
);

1982 
±u¶e
->
	`£t_v®ue
(0, ()0);

1984 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

1985 
	`as£¹
 (
»¶ow
.
_de¡
);

1988 
±u¶e
->
	`£t_v®ue
(0, 
MAX_ID
);

1990 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

1991 
	`as£¹
 (
»phigh
.
_de¡
);

1994 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
,

1995 
®m
, 
Ãed_tu¶e
,

1996 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

1997 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

1998  (
RCOK
);

1999 
	}
}

2006 
w_rc_t
 
	gz_code_mª_im¶
::
	$zc_šdex_´obe
(
ss_m
* 
db
,

2007 
z_code_tu¶e
* 
±u¶e
,

2008 cÚ¡ * 
zc_code
)

2010 
	`as£¹
 (
±u¶e
);

2011 
±u¶e
->
	`£t_v®ue
(0, 
zc_code
);

2012  (
	`šdex_´obe_by_Çme
(
db
, "ZC_INDEX", 
±u¶e
));

2013 
	}
}

2016 
EXIT_NAMESPACE
(
û
);

	@src/workload/tpce/shore_tpce_xct_broker_volume.cpp

32 
	~"wÜklßd/û/shÜe_û_’v.h
"

33 
	~"wÜklßd/û/û_cÚ¡.h
"

34 
	~"wÜklßd/û/û_šput.h
"

36 
	~<veùÜ
>

37 
	~<num”ic
>

38 
	~<®gÜ™hm
>

39 
	~<¡dio.h
>

40 
	~<¡dlib.h
>

41 
	~"wÜklßd/û/eg’/CE.h
"

42 
	~"wÜklßd/û/eg’/TxnH¬ÃssSŒuùs.h
"

43 
	~"wÜklßd/û/shÜe_û_eg’.h
"

45 
usšg
 
Çme¥aû
 
	gshÜe
;

46 
usšg
 
Çme¥aû
 
	gTPCE
;

48 
ENTER_NAMESPACE
(
û
);

56 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_brok”_vŞume
(cÚ¡ 
xù_id
,

57 
brok”_vŞume_šput_t
& 
pbvš
)

60 
	`as£¹
 (
_pssm
);

61 
	`as£¹
 (
_š™Ÿlized
);

62 
	`as£¹
 (
_lßded
);

64 
tu¶e_gu¬d
<
brok”_mª_im¶
> 
	`´brok”
(
_pbrok”_mª
);

65 
tu¶e_gu¬d
<
com·ny_mª_im¶
> 
	`´com·ny
(
_pcom·ny_mª
);

66 
tu¶e_gu¬d
<
šdu¡ry_mª_im¶
> 
	`´šdu¡ry
(
_pšdu¡ry_mª
);

67 
tu¶e_gu¬d
<
£ùÜ_mª_im¶
> 
	`´£ùÜ
(
_p£ùÜ_mª
);

68 
tu¶e_gu¬d
<
£cur™y_mª_im¶
> 
	`´£cur™y
(
_p£cur™y_mª
);

69 
tu¶e_gu¬d
<
Œade_»que¡_mª_im¶
> 
	`´Œad”eq
(
_±¿de_»que¡_mª
);

71 
»p_row_t
 
	`¬•row
(
_pcom·ny_mª
->
	`ts
());

73 
¬•row
.
	`£t
(
_pcom·ny_desc
->
	`maxsize
());

75 
´brok”
->
_»p
 = &
¬•row
;

76 
´com·ny
->
_»p
 = &
¬•row
;

77 
´šdu¡ry
->
_»p
 = &
¬•row
;

78 
´£ùÜ
->
_»p
 = &
¬•row
;

79 
´£cur™y
->
_»p
 = &
¬•row
;

80 
´Œad”eq
->
_»p
 = &
¬•row
;

82 
»p_row_t
 
	`low»p
Ğ
_pcom·ny_mª
->
	`ts
());

83 
»p_row_t
 
	`high»p
Ğ
_pcom·ny_mª
->
	`ts
());

86 
low»p
.
	`£t
(
_pcom·ny_desc
->
	`maxsize
());

87 
high»p
.
	`£t
(
_pcom·ny_desc
->
	`maxsize
());

115 
»p_row_t
 
	`sÜŒ•
(
_pcom·ny_mª
->
	`ts
());

116 
sÜŒ•
.
	`£t
(
_pcom·ny_desc
->
	`maxsize
());

118 
desc_sÜt_bufãr_t
 
	`Œ_li¡
(2);

119 
Œ_li¡
.
	`£tup
(0, 
SQL_FLOAT
);

120 
Œ_li¡
.
	`£tup
(1, 
SQL_FIXCHAR
, 50);

122 
bË_row_t
 
	`rsb
(&
Œ_li¡
);

123 
desc_sÜt_mª_im¶
 
	`Œ_sÜ‹r
(&
Œ_li¡
, &
sÜŒ•
);

125 
gu¬d
< 
šdex_sÿn_™”_im¶
<
£ùÜ_t
> > 
sc_™”
;

127 
šdex_sÿn_™”_im¶
<
£ùÜ_t
>* 
tmp_sc_™”
;

128 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d BV:sc-get-iter-by-idx2 (%s) \n",

129 
xù_id
, 
pbvš
.
_£ùÜ_Çme
);

130 
	`W_DO
(
_p£ùÜ_mª
->
	`sc_g‘_™”_by_šdex2
(
_pssm
, 
tmp_sc_™”
, 
´£ùÜ
,

131 
low»p
, 
high»p
,

132 
pbvš
.
_£ùÜ_Çme
));

133 
sc_™”
 = 
tmp_sc_™”
;

136 
boŞ
 
eof
;

137 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d BV:sc-™”-Ãxˆ\n", 
xù_id
);

138 
	`W_DO
(
sc_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´£ùÜ
));

140 
sc_id
[3];

141 
´£ùÜ
->
	`g‘_v®ue
(0, 
sc_id
, 3);

143 
ušt
 
i
 = 0;

144 
i
 < 
max_brok”_li¡_Ën
 && 
	`¡rcmp
(
pbvš
.
_brok”_li¡
[i], "\0") != 0;

145 
i
++){

146 
gu¬d
< 
šdex_sÿn_™”_im¶
<
brok”_t
> > 
br_™”
;

148 
šdex_sÿn_™”_im¶
<
brok”_t
>* 
tmp_br_™”
;

149 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d BV:b-get-iter-by-idx3 (%s) \n",

150 
xù_id
, 
pbvš
.
_brok”_li¡
[
i
]);

151 
	`W_DO
(
_pbrok”_mª
->
	`b_g‘_™”_by_šdex3
(
_pssm
, 
tmp_br_™”
, 
´brok”
,

152 
low»p
, 
high»p
,

153 
pbvš
.
_brok”_li¡
[
i
]));

154 
br_™”
 = 
tmp_br_™”
;

156 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d BV:br-™”-Ãxˆ\n", 
xù_id
);

157 
	`W_DO
(
br_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´brok”
));

159 
TId’t
 
b_id
;

160 
´brok”
->
	`g‘_v®ue
(0, 
b_id
);

162 
vŞume
 = 0;

164 
gu¬d
< 
šdex_sÿn_™”_im¶
<
šdu¡ry_t
> > 
š_™”
;

166 
šdex_sÿn_™”_im¶
<
šdu¡ry_t
>* 
tmp_š_™”
;

167 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d BV:in-get-iter-by-idx3 (%s) \n",

168 
xù_id
, 
sc_id
);

169 
	`W_DO
(
_pšdu¡ry_mª
->
	`š_g‘_™”_by_šdex3
(
_pssm
, 
tmp_š_™”
,

170 
´šdu¡ry
,

171 
low»p
, 
high»p
, 
sc_id
));

172 
š_™”
 = 
tmp_š_™”
;

175 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d BV:š-™”-Ãxˆ\n", 
xù_id
);

176 
	`W_DO
(
š_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´šdu¡ry
));

178 !
eof
){

179 
š_id
[2];

180 
´šdu¡ry
->
	`g‘_v®ue
(0, 
š_id
, 2);

182 
gu¬d
< 
šdex_sÿn_™”_im¶
<
com·ny_t
> > 
co_™”
;

184 
šdex_sÿn_™”_im¶
<
com·ny_t
>* 
tmp_co_™”
;

185 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d BV:co-get-iter-by-idx3 (%s) \n",

186 
xù_id
, 
š_id
);

187 
	`W_DO
(
_pcom·ny_mª
->
	`co_g‘_™”_by_šdex3
(
_pssm
, 
tmp_co_™”
,

188 
´com·ny
, 
low»p
,

189 
high»p
, 
š_id
));

190 
co_™”
 = 
tmp_co_™”
;

193 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d BV:co-™”-Ãxˆ\n", 
xù_id
);

194 
	`W_DO
(
co_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´com·ny
));

196 
TId’t
 
co_id
;

197 !
eof
){

198 
´com·ny
->
	`g‘_v®ue
(0, 
co_id
);

200 
gu¬d
< 
šdex_sÿn_™”_im¶
<
£cur™y_t
> > 
s_™”
;

202 
šdex_sÿn_™”_im¶
<
£cur™y_t
>* 
tmp_s_™”
;

203 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

205 
xù_id
, 
co_id
);

206 
	`W_DO
(
_p£cur™y_mª
->
	`s_g‘_™”_by_šdex4
(
_pssm
, 
tmp_s_™”
,

207 
´£cur™y
, 
low»p
,

208 
high»p
, 
co_id
));

209 
s_™”
 = 
tmp_s_™”
;

212 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d BV:s-™”-Ãxˆ\n", 
xù_id
);

213 
	`W_DO
(
s_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´£cur™y
));

215 !
eof
){

216 
s_symb
[16];

217 
´£cur™y
->
	`g‘_v®ue
(0, 
s_symb
, 16);

219 
gu¬d
< 
šdex_sÿn_™”_im¶
<
Œade_»que¡_t
> > 
Œ_™”
;

221 
šdex_sÿn_™”_im¶
<
Œade_»que¡_t
>* 
tmp_Œ_™”
;

222 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

224 
xù_id
, 
s_symb
, 
b_id
);

225 
	`W_DO
(
_±¿de_»que¡_mª
->

226 
	`Œ_g‘_™”_by_šdex4
(
_pssm
, 
tmp_Œ_™”
, 
´Œad”eq
,

227 
low»p
, 
high»p
,

228 
s_symb
, 
b_id
));

229 
Œ_™”
 = 
tmp_Œ_™”
;

232 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d BV:Œ-™”-Ãxˆ\n", 
xù_id
);

233 
	`W_DO
(
Œ_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œad”eq
));

235 !
eof
){

236 
Œ_qty
;

237 
Œ_bid_´iû
;

238 
´Œad”eq
->
	`g‘_v®ue
(3, 
Œ_qty
);

239 
´Œad”eq
->
	`g‘_v®ue
(4, 
Œ_bid_´iû
);

240 
vŞume
 +ğ(
Œ_qty
 * 
Œ_bid_´iû
);

241 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ:%d BV:Œ-™”-Ãxt\n",
xù_id
);

242 
	`W_DO
(
Œ_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œad”eq
));

244 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TO:s-™”-Ãxˆ\n", 
xù_id
);

245 
	`W_DO
(
s_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´£cur™y
));

247 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d BV:co-™”-Ãxˆ\n", 
xù_id
);

248 
	`W_DO
(
co_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´com·ny
));

250 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d BV:š-™”-Ãxˆ\n", 
xù_id
);

251 
	`W_DO
(
š_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´šdu¡ry
));

253 if(
vŞume
 != 0){

254 
rsb
.
	`£t_v®ue
(0, 
vŞume
);

255 
rsb
.
	`£t_v®ue
(1, 
pbvš
.
_brok”_li¡
[
i
]);

256 
Œ_sÜ‹r
.
	`add_tu¶e
(
rsb
);

269 
li¡_Ën
 = 
Œ_sÜ‹r
.
	`couÁ
();

271 
	`as£¹
 (
li¡_Ën
 <ğ
max_brok”_li¡_Ën
);

273 if(
li¡_Ën
 > 0) {

274 
¬¿y_gu¬d_t
< [50] > 
brok”_Çme
 = 
Ãw
 [
li¡_Ën
][50];

275 
¬¿y_gu¬d_t
<> 
vŞume
 = 
Ãw
 [
li¡_Ën
];

277 
desc_sÜt_™”_im¶
 
	`Œ_li¡_sÜt_™”
(
_pssm
, &
Œ_li¡
, &
Œ_sÜ‹r
);

278 
boŞ
 
eof
;

279 
	`W_DO
(
Œ_li¡_sÜt_™”
.
	`Ãxt
(
_pssm
, 
eof
, 
rsb
));

280 
j
 = 0; j < 
max_brok”_li¡_Ën
 && !
eof
; j++){

281 
rsb
.
	`g‘_v®ue
(0, 
vŞume
[
j
]);

282 
rsb
.
	`g‘_v®ue
(1, 
brok”_Çme
[
j
], 50);

283 
	`W_DO
(
Œ_li¡_sÜt_™”
.
	`Ãxt
(
_pssm
, 
eof
, 
rsb
));

287 #ifdeà
PRINT_TRX_RESULTS


290 
rbrok”
.
	`´št_tu¶e
();

291 
rcom·ny
.
	`´št_tu¶e
();

292 
ršdu¡ry
.
	`´št_tu¶e
();

293 
r£ùÜ
.
	`´št_tu¶e
();

294 
r£cur™y
.
	`´št_tu¶e
();

295 
¹¿d”eq
.
	`´št_tu¶e
();

298  
RCOK
;

300 
	}
}

303 
EXIT_NAMESPACE
(
û
);

	@src/workload/tpce/shore_tpce_xct_customer_position.cpp

32 
	~"wÜklßd/û/shÜe_û_’v.h
"

33 
	~"wÜklßd/û/û_cÚ¡.h
"

34 
	~"wÜklßd/û/û_šput.h
"

36 
	~<veùÜ
>

37 
	~<num”ic
>

38 
	~<®gÜ™hm
>

39 
	~<¡dio.h
>

40 
	~<¡dlib.h
>

41 
	~"wÜklßd/û/eg’/CE.h
"

42 
	~"wÜklßd/û/eg’/TxnH¬ÃssSŒuùs.h
"

43 
	~"wÜklßd/û/shÜe_û_eg’.h
"

45 
usšg
 
Çme¥aû
 
	gshÜe
;

46 
usšg
 
Çme¥aû
 
	gTPCE
;

48 
ENTER_NAMESPACE
(
û
);

56 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_cu¡om”_pos™iÚ
(cÚ¡ 
xù_id
,

57 
cu¡om”_pos™iÚ_šput_t
& 
pıš
)

60 
	`as£¹
 (
_pssm
);

61 
	`as£¹
 (
_š™Ÿlized
);

62 
	`as£¹
 (
_lßded
);

64 
tu¶e_gu¬d
<
cu¡om”_mª_im¶
> 
	`´cu¡
(
_pcu¡om”_mª
);

65 
tu¶e_gu¬d
<
cu¡om”_accouÁ_mª_im¶
> 
	`´cu¡acù
(
_pcu¡om”_accouÁ_mª
);

66 
tu¶e_gu¬d
<
hŞdšg_summ¬y_mª_im¶
> 
	`´hŞdsum
(
_phŞdšg_summ¬y_mª
);

67 
tu¶e_gu¬d
<
Ï¡_Œade_mª_im¶
> 
	`´Ï¡Œade
(
_¶a¡_Œade_mª
);

68 
tu¶e_gu¬d
<
Œade_hi¡Üy_mª_im¶
> 
	`´Œadehi¡
(
_±¿de_hi¡Üy_mª
);

69 
tu¶e_gu¬d
<
¡©us_ty³_mª_im¶
> 
	`´¡©u¡y³
(
_p¡©us_ty³_mª
);

70 
tu¶e_gu¬d
<
Œade_mª_im¶
> 
	`´Œade
(
_±¿de_mª
);

72 
»p_row_t
 
	`¬•row
(
_pcu¡om”_mª
->
	`ts
());

74 
¬•row
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

76 
´cu¡
->
_»p
 = &
¬•row
;

77 
´cu¡acù
->
_»p
 = &
¬•row
;

78 
´hŞdsum
->
_»p
 = &
¬•row
;

79 
´Ï¡Œade
->
_»p
 = &
¬•row
;

80 
´Œadehi¡
->
_»p
 = &
¬•row
;

81 
´¡©u¡y³
->
_»p
 = &
¬•row
;

82 
´Œade
->
_»p
 = &
¬•row
;

84 
»p_row_t
 
	`low»p
Ğ
_pcu¡om”_mª
->
	`ts
());

85 
»p_row_t
 
	`high»p
Ğ
_pcu¡om”_mª
->
	`ts
());

88 
low»p
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

89 
high»p
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

92 
TId’t
 
acù_id
[10];

93 
acù_Ën
;

94 
TId’t
 
cu¡_id
 = 
pıš
.
_cu¡_id
;

95 if(
cu¡_id
 == 0) {

104 
gu¬d
< 
šdex_sÿn_™”_im¶
<
cu¡om”_t
> > 
c_™”
;

106 
šdex_sÿn_™”_im¶
<
cu¡om”_t
>* 
tmp_c_™”
;

107 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d CP:c-get-iter-by-idx2 (%s) \n",

108 
xù_id
, 
pıš
.
_x_id
);

109 
	`W_DO
(
_pcu¡om”_mª
->
	`c_g‘_™”_by_šdex2
(
_pssm
, 
tmp_c_™”
,

110 
´cu¡
, 
low»p
, 
high»p
,

111 
pıš
.
_x_id
));

112 
c_™”
 = 
tmp_c_™”
;

114 
boŞ
 
eof
;

115 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d CP:c-™”-Ãxˆ\n", 
xù_id
);

116 
	`W_DO
(
c_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cu¡
));

117 if(
eof
è{ 
	`W_DO
(
	`RC
(
£_NOT_FOUND
)); }

118 
´cu¡
->
	`g‘_v®ue
(0, 
cu¡_id
);

120 
	`TRACE
(
TRACE_TRX_FLOW
,"Aµ: %d CP:c-idx-´ob(%ld)\n",
xù_id
,
cu¡_id
);

121 
	`W_DO
(
_pcu¡om”_mª
->
	`c_šdex_´obe
(
_pssm
, 
´cu¡
, 
cu¡_id
));

153 
c_¡_id
[5];

154 
´cu¡
->
	`g‘_v®ue
(2, 
c_¡_id
, 5);

155 
c_l_Çme
[26];

156 
´cu¡
->
	`g‘_v®ue
(3, 
c_l_Çme
, 26);

157 
c_f_Çme
[21];

158 
´cu¡
->
	`g‘_v®ue
(4, 
c_f_Çme
, 21);

159 
c_m_Çme
[2];

160 
´cu¡
->
	`g‘_v®ue
(5, 
c_m_Çme
, 2);

161 
c_gndr
[2];

162 
´cu¡
->
	`g‘_v®ue
(6, 
c_gndr
, 2);

163 
c_t›r
;

164 
´cu¡
->
	`g‘_v®ue
(7, 
c_t›r
);

165 
myTime
 
c_dob
;

166 
´cu¡
->
	`g‘_v®ue
(8, 
c_dob
);

167 
TId’t
 
c_ad_id
;

168 
´cu¡
->
	`g‘_v®ue
(9, 
c_ad_id
);

169 
c_ùry_1
[4];

170 
´cu¡
->
	`g‘_v®ue
(10, 
c_ùry_1
, 4);

171 
c_¬—_1
[4];

172 
´cu¡
->
	`g‘_v®ue
(11, 
c_¬—_1
, 4);

173 
c_loÿl_1
[11];

174 
´cu¡
->
	`g‘_v®ue
(12, 
c_loÿl_1
, 11);

175 
c_ext_1
[6];

176 
´cu¡
->
	`g‘_v®ue
(13, 
c_ext_1
, 6);

177 
c_ùry_2
[4];

178 
´cu¡
->
	`g‘_v®ue
(14, 
c_ùry_2
, 4);

179 
c_¬—_2
[4];

180 
´cu¡
->
	`g‘_v®ue
(15, 
c_¬—_2
, 4);

181 
c_loÿl_2
[11];

182 
´cu¡
->
	`g‘_v®ue
(16, 
c_loÿl_2
, 11);

183 
c_ext_2
[6];

184 
´cu¡
->
	`g‘_v®ue
(17, 
c_ext_2
, 6);

185 
c_ùry_3
[4];

186 
´cu¡
->
	`g‘_v®ue
(18, 
c_ùry_3
, 4);

187 
c_¬—_3
[4];

188 
´cu¡
->
	`g‘_v®ue
(19, 
c_¬—_3
, 4);

189 
c_loÿl_3
[11];

190 
´cu¡
->
	`g‘_v®ue
(20, 
c_loÿl_3
, 11);

191 
c_ext_3
[6];

192 
´cu¡
->
	`g‘_v®ue
(21, 
c_ext_3
, 6);

193 
c_ema_1
[51];

194 
´cu¡
->
	`g‘_v®ue
(22, 
c_ema_1
, 51);

195 
c_ema_2
[51];

196 
´cu¡
->
	`g‘_v®ue
(23, 
c_ema_2
, 51);

215 
gu¬d
< 
šdex_sÿn_™”_im¶
<
cu¡om”_accouÁ_t
> > 
ÿ_™”
;

217 
šdex_sÿn_™”_im¶
<
cu¡om”_accouÁ_t
>* 
tmp_ÿ_™”
;

218 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d CP:ca-get-iter-by-idx2 (%ld) \n",

219 
xù_id
, 
cu¡_id
);

220 
	`W_DO
(
_pcu¡om”_accouÁ_mª
->
	`ÿ_g‘_™”_by_šdex2
(
_pssm
, 
tmp_ÿ_™”
,

221 
´cu¡acù
, 
low»p
,

222 
high»p
, 
cu¡_id
));

223 
ÿ_™”
 = 
tmp_ÿ_™”
;

227 
»p_row_t
 
	`sÜŒ•
(
_pcu¡om”_mª
->
	`ts
());

228 
sÜŒ•
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

229 
asc_sÜt_bufãr_t
 
	`ÿ_li¡
(3);

231 
ÿ_li¡
.
	`£tup
(0, 
SQL_FLOAT
);

232 
ÿ_li¡
.
	`£tup
(1, 
SQL_FLOAT
);

233 
ÿ_li¡
.
	`£tup
(2, 
SQL_LONG
);

235 
bË_row_t
 
	`rsb
(&
ÿ_li¡
);

236 
asc_sÜt_mª_im¶
 
	`ÿ_sÜ‹r
(&
ÿ_li¡
, &
sÜŒ•
);

238 
acù_Ën
 = 0;

239 
boŞ
 
eof
;

240 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d CP:ÿ-™”-Ãxˆ\n", 
xù_id
);

241 
	`W_DO
(
ÿ_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cu¡acù
));

242 !
eof
){

243 
TId’t
 
‹mp_id
;

244 
‹mp_b®ªû
 = 0, 
‹mp_as£ts
 = 0;

246 
´cu¡acù
->
	`g‘_v®ue
(0, 
‹mp_id
);

247 
´cu¡acù
->
	`g‘_v®ue
(5, 
‹mp_b®ªû
);

249 
gu¬d
< 
šdex_sÿn_™”_im¶
<
hŞdšg_summ¬y_t
> > 
hs_™”
;

251 
šdex_sÿn_™”_im¶
<
hŞdšg_summ¬y_t
>* 
tmp_hs_™”
;

252 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d CP:hs-get-iter-by-idx (%ld) \n",

253 
xù_id
, 
‹mp_id
);

254 
	`W_DO
(
_phŞdšg_summ¬y_mª
->
	`hs_g‘_™”_by_šdex
(
_pssm
,

255 
tmp_hs_™”
,

256 
´hŞdsum
,

257 
low»p
, 
high»p
,

258 
‹mp_id
));

259 
hs_™”
 = 
tmp_hs_™”
;

262 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d CP:hs-™”-Ãxˆ \n", 
xù_id
);

263 
	`W_DO
(
hs_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´hŞdsum
));

264 !
eof
){

265 
symbŞ
[16];

266 
´hŞdsum
->
	`g‘_v®ue
(1, 
symbŞ
, 16);

267 
qty
;

268 
´hŞdsum
->
	`g‘_v®ue
(2, 
qty
);

270 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d CP:lt-idx-probe (%s) \n",

271 
xù_id
, 
symbŞ
);

272 
	`W_DO
(
_¶a¡_Œade_mª
->
	`É_šdex_´obe
(
_pssm
,
´Ï¡Œade
,
symbŞ
));

274 
É_´iû
 = 0;

275 
´Ï¡Œade
->
	`g‘_v®ue
(2, 
É_´iû
);

276 
‹mp_as£ts
 +ğ(
É_´iû
 * 
qty
);

278 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d CP:hs-™”-Ãxˆ \n", 
xù_id
);

279 
	`W_DO
(
hs_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´hŞdsum
));

282 
rsb
.
	`£t_v®ue
(0, 
‹mp_as£ts
);

283 
rsb
.
	`£t_v®ue
(1, 
‹mp_b®ªû
);

284 
rsb
.
	`£t_v®ue
(2, 
‹mp_id
);

286 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d CP:rsb‡ddu¶ \n", 
xù_id
);

287 
ÿ_sÜ‹r
.
	`add_tu¶e
(
rsb
);

289 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d CP:ÿ-™”-Ãxˆ\n", 
xù_id
);

290 
	`W_DO
(
ÿ_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cu¡acù
));

291 
acù_Ën
++;

294 
ÿsh_b®
[10];

295 
as£ts_tÙ®
[10];

297 
asc_sÜt_™”_im¶
 
	`ÿ_li¡_sÜt_™”
(
_pssm
, &
ÿ_li¡
, &
ÿ_sÜ‹r
);

298 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d CP:ÿ-sÜ‹r-™”-Ãxˆ\n", 
xù_id
);

299 
	`W_DO
(
ÿ_li¡_sÜt_™”
.
	`Ãxt
(
_pssm
, 
eof
, 
rsb
));

300 
j
 = 0; j < 
max_acù_Ën
 && !
eof
; j++) {

301 
rsb
.
	`g‘_v®ue
(2, 
acù_id
[
j
]);

302 
rsb
.
	`g‘_v®ue
(1, 
ÿsh_b®
[
j
]);

303 
rsb
.
	`g‘_v®ue
(0, 
as£ts_tÙ®
[
j
]);

304 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d CP:ÿ-sÜ‹r-™”-Ãxˆ\n", 
xù_id
);

305 
	`W_DO
(
ÿ_li¡_sÜt_™”
.
	`Ãxt
(
_pssm
, 
eof
, 
rsb
));

307 
	`as£¹
(
acù_Ën
 >ğ1 &&‡cù_ËÀ<ğ
max_acù_Ën
);

309 
TId’t
 
acùId
 = 
acù_id
[
pıš
.
_acù_id_idx
];

310 
hi¡_Ën
;

312 if(
pıš
.
_g‘_hi¡Üy
){

340 
TId’t
 
Œade_id
[30];

341 
symbŞ
[30][16];

342 
qty
[30];

343 
Œade_¡©us
[30][11];

344 
myTime
 
hi¡_dts
[30];

346 
TId’t
 
id_li¡
[10];

348 
gu¬d
<
šdex_sÿn_™”_im¶
<
Œade_t
> > 
t_™”
;

350 
šdex_sÿn_™”_im¶
<
Œade_t
>* 
tmp_t_™”
;

351 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d CP:t-iter-by-idx2 %ld \n",

352 
xù_id
, 
acùId
);

353 
	`W_DO
(
_±¿de_mª
->
	`t_g‘_™”_by_šdex2
(
_pssm
, 
tmp_t_™”
, 
´Œade
,

354 
low»p
, 
high»p
, 
acùId
, 0,

355 
MAX_DTS
, 
Œue
, 
çl£
));

356 
t_™”
 = 
tmp_t_™”
;

358 
boŞ
 
eof
;

359 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d CP:t-™”-Ãxˆ\n", 
xù_id
);

360 
	`W_DO
(
t_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œade
));

361 
i
 = 0;

362 
i
 < 10 && !
eof
){

363 
´Œade
->
	`g‘_v®ue
(0, 
id_li¡
[
i
]);

364 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d CP:t-™”-Ãxˆ\n", 
xù_id
);

365 
	`W_DO
(
t_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œade
));

366 
i
++;

370 
»p_row_t
 
	`sÜŒ•
(
_pcu¡om”_mª
->
	`ts
());

371 
sÜŒ•
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

373 
desc_sÜt_bufãr_t
 
	`t_li¡
(5);

374 
t_li¡
.
	`£tup
(0, 
SQL_LONG
);

375 
t_li¡
.
	`£tup
(1, 
SQL_LONG
);

376 
t_li¡
.
	`£tup
(2, 
SQL_FIXCHAR
, 16);

377 
t_li¡
.
	`£tup
(3, 
SQL_INT
);

378 
t_li¡
.
	`£tup
(4, 
SQL_FIXCHAR
, 10);

380 
desc_sÜt_mª_im¶
 
	`t_sÜ‹r
(&
t_li¡
, &
sÜŒ•
);

381 
bË_row_t
 
	`rsb
(&
t_li¡
);

383 
i
 = 0; i < 10; i++) {

384 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d CP:t-idx-probe (%ld) \n",

385 
xù_id
, 
id_li¡
[
i
]);

386 
	`W_DO
(
_±¿de_mª
->
	`t_šdex_´obe
(
_pssm
, 
´Œade
, 
id_li¡
[
i
]));

388 
gu¬d
<
šdex_sÿn_™”_im¶
<
Œade_hi¡Üy_t
> > 
th_™”
;

390 
šdex_sÿn_™”_im¶
<
Œade_hi¡Üy_t
>* 
tmp_th_™”
;

391 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d CP:th-iter-by-idx %ld \n",

392 
xù_id
, 
id_li¡
[
i
]);

393 
	`W_DO
(
_±¿de_hi¡Üy_mª
->
	`th_g‘_™”_by_šdex
(
_pssm
, 
tmp_th_™”
,

394 
´Œadehi¡
,

395 
low»p
, 
high»p
,

396 
id_li¡
[
i
]));

397 
th_™”
 = 
tmp_th_™”
;

399 
boŞ
 
eof
;

400 
	`W_DO
(
th_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œadehi¡
));

401 !
eof
){

402 
myTime
 
th_dts
;

403 
´Œadehi¡
->
	`g‘_v®ue
(1, 
th_dts
);

404 
rsb
.
	`£t_v®ue
(0, 
th_dts
);

406 
th_¡_id
[5];

407 
´Œadehi¡
->
	`g‘_v®ue
(2, 
th_¡_id
, 5);

409 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d CP:st-idx-probe (%s) \n",

410 
xù_id
, 
th_¡_id
);

411 
	`W_DO
(
_p¡©us_ty³_mª
->
	`¡_šdex_´obe
(
_pssm
, 
´¡©u¡y³
,

412 
th_¡_id
));

414 
¡_Çme
[11];

415 
´¡©u¡y³
->
	`g‘_v®ue
(1, 
¡_Çme
, 11);

416 
rsb
.
	`£t_v®ue
(4, 
¡_Çme
);

418 
rsb
.
	`£t_v®ue
(1, 
id_li¡
[
i
]);

420 
t_s_symb
[16];

421 
´Œade
->
	`g‘_v®ue
(5, 
t_s_symb
, 16);

422 
rsb
.
	`£t_v®ue
(2, 
t_s_symb
);

424 
t_qty
;

425 
´Œade
->
	`g‘_v®ue
(6, 
t_qty
);

426 
rsb
.
	`£t_v®ue
(3, 
t_qty
);

428 
t_sÜ‹r
.
	`add_tu¶e
(
rsb
);

430 
	`W_DO
(
th_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œadehi¡
));

433 
desc_sÜt_™”_im¶
 
	`t_li¡_sÜt_™”
(
_pssm
, &
t_li¡
, &
t_sÜ‹r
);

435 
boŞ
 
eof
;

436 
	`W_DO
(
t_li¡_sÜt_™”
.
	`Ãxt
(
_pssm
, 
eof
, 
rsb
));

437 
hi¡_Ën
 = 0; hi¡_ËÀ< 
max_hi¡_Ën
 && !
eof
; hist_len++) {

438 
rsb
.
	`g‘_v®ue
(0, 
hi¡_dts
[
hi¡_Ën
]);

439 
rsb
.
	`g‘_v®ue
(1, 
Œade_id
[
hi¡_Ën
]);

440 
rsb
.
	`g‘_v®ue
(2, 
symbŞ
[
hi¡_Ën
], 16);

441 
rsb
.
	`g‘_v®ue
(3, 
qty
[
hi¡_Ën
]);

442 
rsb
.
	`g‘_v®ue
(4, 
Œade_¡©us
[
hi¡_Ën
], 11);

443 
	`W_DO
(
t_li¡_sÜt_™”
.
	`Ãxt
(
_pssm
, 
eof
, 
rsb
));

445 
	`as£¹
(
hi¡_Ën
 >ğ10 && hi¡_ËÀ<ğ
max_hi¡_Ën
);

448 #ifdeà
PRINT_TRX_RESULTS


451 
rcu¡
.
	`´št_tu¶e
();

452 
rcu¡acù
.
	`´št_tu¶e
();

453 
rhŞdsum
.
	`´št_tu¶e
();

454 
¾a¡Œade
.
	`´št_tu¶e
();

455 
¹¿dehi¡
.
	`´št_tu¶e
();

456 
r¡©u¡y³
.
	`´št_tu¶e
();

457 
¹¿de
.
	`´št_tu¶e
();

460  
RCOK
;

462 
	}
}

465 
EXIT_NAMESPACE
(
û
);

	@src/workload/tpce/shore_tpce_xct_data_maintenance.cpp

32 
	~"wÜklßd/û/shÜe_û_’v.h
"

33 
	~"wÜklßd/û/û_cÚ¡.h
"

34 
	~"wÜklßd/û/û_šput.h
"

36 
	~<veùÜ
>

37 
	~<num”ic
>

38 
	~<®gÜ™hm
>

39 
	~<¡dio.h
>

40 
	~<¡dlib.h
>

41 
	~"wÜklßd/û/eg’/CE.h
"

42 
	~"wÜklßd/û/eg’/TxnH¬ÃssSŒuùs.h
"

43 
	~"wÜklßd/û/shÜe_û_eg’.h
"

45 
usšg
 
Çme¥aû
 
	gshÜe
;

46 
usšg
 
Çme¥aû
 
	gTPCE
;

48 
ENTER_NAMESPACE
(
û
);

56 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_d©a_maš‹Çnû
(cÚ¡ 
xù_id
,

57 
d©a_maš‹Çnû_šput_t
& 
pdmš
)

60 
	`as£¹
 (
_pssm
);

61 
	`as£¹
 (
_š™Ÿlized
);

62 
	`as£¹
 (
_lßded
);

64 
tu¶e_gu¬d
<
accouÁ_³rmissiÚ_mª_im¶
> 
	`´acù³rm
(
_·ccouÁ_³rmissiÚ_mª
);

65 
tu¶e_gu¬d
<
add»ss_mª_im¶
> 
	`´add»ss
(
_·dd»ss_mª
);

66 
tu¶e_gu¬d
<
com·ny_mª_im¶
> 
	`´com·ny
(
_pcom·ny_mª
);

67 
tu¶e_gu¬d
<
cu¡om”_mª_im¶
> 
	`´cu¡
(
_pcu¡om”_mª
);

68 
tu¶e_gu¬d
<
cu¡om”_x¿‹_mª_im¶
> 
	`´cu¡x¿‹
(
_pcu¡om”_x¿‹_mª
);

69 
tu¶e_gu¬d
<
day_m¬k‘_mª_im¶
> 
	`´daym¬k‘
(
_pday_m¬k‘_mª
);

70 
tu¶e_gu¬d
<
exchªge_mª_im¶
> 
	`´exchªge
(
_³xchªge_mª
);

71 
tu¶e_gu¬d
<
fšªcŸl_mª_im¶
> 
	`´fšªcŸl
(
_pfšªcŸl_mª
);

72 
tu¶e_gu¬d
<
£cur™y_mª_im¶
> 
	`´£cur™y
(
_p£cur™y_mª
);

73 
tu¶e_gu¬d
<
Ãws_™em_mª_im¶
> 
	`´Ãws™em
(
_²ews_™em_mª
);

74 
tu¶e_gu¬d
<
Ãws_x»f_mª_im¶
> 
	`´Ãwsx»f
(
_²ews_x»f_mª
);

75 
tu¶e_gu¬d
<
x¿‹_mª_im¶
> 
	`´x¿‹
(
_±ax¿‹_mª
);

76 
tu¶e_gu¬d
<
w©ch_™em_mª_im¶
> 
	`´w©ch™em
(
_pw©ch_™em_mª
);

77 
tu¶e_gu¬d
<
w©ch_li¡_mª_im¶
> 
	`´w©chli¡
(
_pw©ch_li¡_mª
);

79 
»p_row_t
 
	`¬•row
(
_²ews_™em_mª
->
	`ts
());

81 
¬•row
.
	`£t
(
_²ews_™em_desc
->
	`maxsize
());

83 
´acù³rm
->
_»p
 = &
¬•row
;

84 
´add»ss
->
_»p
 = &
¬•row
;

85 
´com·ny
->
_»p
 = &
¬•row
;

86 
´cu¡
->
_»p
 = &
¬•row
;

87 
´cu¡x¿‹
->
_»p
 = &
¬•row
;

88 
´daym¬k‘
->
_»p
 = &
¬•row
;

89 
´exchªge
->
_»p
 = &
¬•row
;

90 
´fšªcŸl
->
_»p
 = &
¬•row
;

91 
´£cur™y
->
_»p
 = &
¬•row
;

92 
´Ãws™em
->
_»p
 = &
¬•row
;

93 
´Ãwsx»f
->
_»p
 = &
¬•row
;

94 
´x¿‹
->
_»p
 = &
¬•row
;

95 
´w©ch™em
->
_»p
 = &
¬•row
;

96 
´w©chli¡
->
_»p
 = &
¬•row
;

98 
»p_row_t
 
	`low»p
Ğ
_²ews_™em_mª
->
	`ts
());

99 
»p_row_t
 
	`high»p
Ğ
_²ews_™em_mª
->
	`ts
());

102 
low»p
.
	`£t
(
_²ews_™em_desc
->
	`maxsize
());

103 
high»p
.
	`£t
(
_²ews_™em_desc
->
	`maxsize
());

105 if(
	`¡rcmp
(
pdmš
.
_bË_Çme
, "ACCOUNT_PERMISSION") == 0){

116 
gu¬d
<
šdex_sÿn_™”_im¶
<
accouÁ_³rmissiÚ_t
> > 
­_™”
;

118 
šdex_sÿn_™”_im¶
<
accouÁ_³rmissiÚ_t
>* 
tmp_­_™”
;

119 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:ap-get-iter-by-idx %ld \n",

120 
xù_id
, 
pdmš
.
_acù_id
);

121 
	`W_DO
(
_·ccouÁ_³rmissiÚ_mª
->
	`­_g‘_™”_by_šdex
(
_pssm
,

122 
tmp_­_™”
,

123 
´acù³rm
,

124 
low»p
, 
high»p
,

125 
pdmš
.
_acù_id
));

126 
­_™”
 = 
tmp_­_™”
;

129 
»p_row_t
 
	`sÜŒ•
(
_²ews_™em_mª
->
	`ts
());

130 
sÜŒ•
.
	`£t
(
_²ews_™em_desc
->
	`maxsize
());

132 
desc_sÜt_bufãr_t
 
	`­_li¡
(1);

134 
­_li¡
.
	`£tup
(0, 
SQL_FIXCHAR
, 4);

136 
bË_row_t
 
	`rsb
(&
­_li¡
);

137 
desc_sÜt_mª_im¶
 
	`­_sÜ‹r
(&
­_li¡
, &
sÜŒ•
);

139 
boŞ
 
eof
;

140 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d DM:­-™”-Ãxˆ\n", 
xù_id
);

141 
	`W_DO
(
­_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´acù³rm
));

143 if(
eof
) {

144 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

146 
xù_id
, 
pdmš
.
_acù_id
);

147 
	`W_DO
(
	`RC
(
£_NOT_FOUND
));

150 !
eof
){

151 
aş
[5];

152 
´acù³rm
->
	`g‘_v®ue
(1, 
aş
, 5);

154 
rsb
.
	`£t_v®ue
(0, 
aş
);

155 
­_sÜ‹r
.
	`add_tu¶e
(
rsb
);

157 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d DM:­-™”-Ãxˆ\n", 
xù_id
);

158 
	`W_DO
(
­_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´acù³rm
));

161 
desc_sÜt_™”_im¶
 
	`­_li¡_sÜt_™”
(
_pssm
, &
­_li¡
, &
­_sÜ‹r
);

163 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d DM:­-sÜt-™”-Ãxˆ\n", 
xù_id
);

164 
	`W_DO
(
­_li¡_sÜt_™”
.
	`Ãxt
(
_pssm
, 
eof
, 
rsb
));

166 
aş
[5];

167 
rsb
.
	`g‘_v®ue
(0, 
aş
, 5);

169 
Ãw_aş
[5];

170 if(
	`¡rcmp
(
aş
, "1111") != 0){

180 
	`¡rcmp
(
Ãw_aş
, "1111");

191 
	`¡rcmp
(
Ãw_aş
, "0011");

194 
šdex_sÿn_™”_im¶
<
accouÁ_³rmissiÚ_t
>* 
tmp_­_™”
;

195 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:ap-get-iter-by-idx %ld \n",

196 
xù_id
, 
pdmš
.
_acù_id
);

197 
	`W_DO
(
_·ccouÁ_³rmissiÚ_mª
->
	`­_g‘_™”_by_šdex
(
_pssm
,

198 
tmp_­_™”
,

199 
´acù³rm
,

200 
low»p
, 
high»p
,

201 
pdmš
.
_acù_id
));

202 
­_™”
 = 
tmp_­_™”
;

205 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d DM:­-™”-Ãxˆ\n", 
xù_id
);

206 
	`W_DO
(
­_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´acù³rm
));

207 !
eof
){

208 
­_aş
[5];

209 
´acù³rm
->
	`g‘_v®ue
(1, 
­_aş
, 5);

211 if(
	`¡rcmp
(
­_aş
, 
aş
) == 0){

212 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:ap-update (%s) \n",

213 
xù_id
, 
Ãw_aş
);

214 
	`W_DO
(
_·ccouÁ_³rmissiÚ_mª
->
	`­_upd©e_aş
(
_pssm
, 
´acù³rm
,

215 
Ãw_aş
));

218 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d DM:­-™”-Ãxˆ\n", 
xù_id
);

219 
	`W_DO
(
­_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´acù³rm
));

222 } if(
	`¡rcmp
(
pdmš
.
_bË_Çme
, "ADDRESS") == 0) {

223 
lše2
[81] = "\0";

224 
TId’t
 
ad_id
 = 0;

226 if(
pdmš
.
_c_id
 != 0){

237 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:c-idx-probe (%ld) \n",

238 
xù_id
, 
pdmš
.
_c_id
);

239 
	`W_DO
(
_pcu¡om”_mª
->
	`c_šdex_´obe
(
_pssm
, 
´cu¡
, 
pdmš
.
_c_id
));

240 
´cu¡
->
	`g‘_v®ue
(9, 
ad_id
);

252 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:co-idx-probe (%ld) \n",

253 
xù_id
, 
pdmš
.
_co_id
);

254 
	`W_DO
(
_pcom·ny_mª
->
	`co_šdex_´obe
(
_pssm
, 
´com·ny
, 
pdmš
.
_co_id
));

255 
´com·ny
->
	`g‘_v®ue
(6, 
ad_id
);

257 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:ad-idx-probe-for-update (%ld) \n",

258 
xù_id
, 
ad_id
);

259 
	`W_DO
(
_·dd»ss_mª
->
	`ad_šdex_´obe_fÜupd©e
(
_pssm
, 
´add»ss
, 
ad_id
));

260 
´add»ss
->
	`g‘_v®ue
(2, 
lše2
, 81);

262 
Ãw_lše2
[81];

263 if(
	`¡rcmp
(
lše2
, "Apt. 10C") != 0) {

272 
	`¡rıy
(
Ãw_lše2
, "Apt. 10C");

282 
	`¡rıy
(
Ãw_lše2
, "Apt. 22");

284 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:ad-update (%ld) (%s) \n",

285 
xù_id
, 
ad_id
, 
Ãw_lše2
);

286 
	`W_DO
(
_·dd»ss_mª
->
	`ad_upd©e_lše2
(
_pssm
, 
´add»ss
, 
Ãw_lše2
));

288 } if(
	`¡rcmp
(
pdmš
.
_bË_Çme
, "COMPANY") == 0) {

289 
¥¿‹
[5] = "\0";

291 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:co-idx-probe (%ld) \n",

292 
xù_id
, 
pdmš
.
_co_id
);

293 
	`W_DO
(
_pcom·ny_mª
->
	`co_šdex_´obe_fÜupd©e
(
_pssm
, 
´com·ny
,

294 
pdmš
.
_co_id
));

295 
´com·ny
->
	`g‘_v®ue
(4, 
¥¿‹
, 5);

297 
Ãw_¥¿‹
[5];

298 if(
	`¡rcmp
(
¥¿‹
, "ABA") != 0){

307 
	`¡rıy
(
Ãw_¥¿‹
, "ABA");

317 
	`¡rıy
(
Ãw_¥¿‹
, "AAA");

319 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d DM:co-upd©(% \n", 
xù_id
, 
Ãw_¥¿‹
);

320 
	`W_DO
(
_pcom·ny_mª
->
	`co_upd©e_¥¿‹
(
_pssm
, 
´com·ny
, 
Ãw_¥¿‹
));

322 } if(
	`¡rcmp
(
pdmš
.
_bË_Çme
, "CUSTOMER") == 0){

323 
ema2
[51] = "\0";

324 
Ën
 = 0;

325 
ËnMšd¥ršg
 = 
	`¡¾’
("@mindspring.com");

335 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:c-idx-probe (%d) \n",

336 
xù_id
, 
pdmš
.
_c_id
);

337 
	`W_DO
(
_pcu¡om”_mª
->
	`c_šdex_´obe_fÜupd©e
(
_pssm
, 
´cu¡
, 
pdmš
.
_c_id
));

338 
´cu¡
->
	`g‘_v®ue
(23, 
ema2
, 51);

340 
Ën
 = 
	`¡¾’
(
ema2
);

341 
¡ršg
 
	`‹mp_ema2
(
ema2
);

342 
Ãw_ema2
[51];

343 if(((
Ën
 - 
ËnMšd¥ršg
) > 0 &&

344 (
‹mp_ema2
.
	`sub¡r
(
Ën
-
ËnMšd¥ršg
,

345 
ËnMšd¥ršg
).
	`com·»
("@mindspring.com")==0))) {

355 
¡ršg
 
‹mp_Ãw_ema2
 = 
‹mp_ema2
.
	`sub¡r
(1,emp_ema2.
	`fšd_fœ¡_of
('@')) + "earthlink.com";

356 
	`¡rıy
(
Ãw_ema2
, 
‹mp_Ãw_ema2
.
	`c_¡r
());

367 
¡ršg
 
‹mp_Ãw_ema2
 = 
‹mp_ema2
.
	`sub¡r
(1,emp_ema2.
	`fšd_fœ¡_of
('@')) + "mindspring.com";

368 
	`¡rıy
(
Ãw_ema2
, 
‹mp_Ãw_ema2
.
	`c_¡r
());

370 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d DM:c-upd©(%sè\n", 
xù_id
, 
Ãw_ema2
);

371 
	`W_DO
(
_pcu¡om”_mª
->
	`c_upd©e_ema2
(
_pssm
, 
´cu¡
, 
Ãw_ema2
));

373 } if(
	`¡rcmp
(
pdmš
.
_bË_Çme
, "CUSTOMER_TAXRATE") == 0){

374 
Şd_x_¿‹
[5];

375 
Ãw_x_¿‹
[5];

376 
x_num
;

386 
gu¬d
< 
šdex_sÿn_™”_im¶
<
cu¡om”_x¿‹_t
> > 
cx_™”
;

388 
šdex_sÿn_™”_im¶
<
cu¡om”_x¿‹_t
>* 
tmp_cx_™”
;

389 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:cx-get-iter-by-idx (%ld) \n",

390 
xù_id
, 
pdmš
.
_c_id
);

391 
	`W_DO
(
_pcu¡om”_x¿‹_mª
->
	`cx_g‘_™”_by_šdex
(
_pssm
, 
tmp_cx_™”
,

392 
´cu¡x¿‹
,

393 
low»p
, 
high»p
,

394 
pdmš
.
_c_id
));

395 
cx_™”
 = 
tmp_cx_™”
;

398 
boŞ
 
eof
;

399 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d DM:cx-™”-Ãxˆ\n", 
xù_id
);

400 
	`W_DO
(
cx_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cu¡x¿‹
));

401 !
eof
){

402 
´cu¡x¿‹
->
	`g‘_v®ue
(0, 
Şd_x_¿‹
, 5);

404 
¡ršg
 
	`‹mp_Şd_x_¿‹
(
Şd_x_¿‹
);

405 if(
‹mp_Şd_x_¿‹
.
	`sub¡r
(0,2).
	`com·»
("US") == 0 ||

406 
‹mp_Şd_x_¿‹
.
	`sub¡r
(0,2).
	`com·»
("CN") == 0 ) {

408 if(
‹mp_Şd_x_¿‹
.
	`sub¡r
(0,2).
	`com·»
("US") == 0){

409 if(
‹mp_Şd_x_¿‹
.
	`com·»
("US5") == 0){

410 
	`¡rıy
(
Ãw_x_¿‹
, "US1");

412 
x_num
 = 
	`©oi
(
‹mp_Şd_x_¿‹
.
	`sub¡r
(2,1).
	`c_¡r
()) + 1;

413 
¡ršg¡»am
 
‹mp_Ãw_x_¿‹
;

414 
‹mp_Ãw_x_¿‹
 << "US" << 
x_num
;

415 
	`¡rıy
(
Ãw_x_¿‹
, 
‹mp_Ãw_x_¿‹
.
	`¡r
().
	`c_¡r
());

418 if(
‹mp_Şd_x_¿‹
.
	`com·»
("CN4") == 0){

419 
	`¡rıy
(
Ãw_x_¿‹
, "CN1");

421 
x_num
 = 
	`©oi
(
‹mp_Şd_x_¿‹
.
	`sub¡r
(2,1).
	`c_¡r
()) + 1;

422 
¡ršg¡»am
 
‹mp_Ãw_x_¿‹
;

423 
‹mp_Ãw_x_¿‹
 << "CN" << 
x_num
;

424 
	`¡rıy
(
Ãw_x_¿‹
, 
‹mp_Ãw_x_¿‹
.
	`¡r
().
	`c_¡r
());

437 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:cx-update (%s) \n",

438 
xù_id
, 
Ãw_x_¿‹
);

439 
	`W_DO
(
_pcu¡om”_x¿‹_mª
->
	`cx_upd©e_txid
(
_pssm
, 
´cu¡x¿‹
,

440 
Ãw_x_¿‹
));

442 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d DM:cx-™”-Ãxˆ\n", 
xù_id
);

443 
	`W_DO
(
cx_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cu¡x¿‹
));

446 } if(
	`¡rcmp
(
pdmš
.
_bË_Çme
, "DAILY_MARKET") == 0){

456 
gu¬d
< 
šdex_sÿn_™”_im¶
<
day_m¬k‘_t
> > 
dm_™”
;

458 
šdex_sÿn_™”_im¶
<
day_m¬k‘_t
>* 
tmp_dm_™”
;

459 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:dm-get-iter-by-idx4 (%s) \n",

460 
xù_id
, 
pdmš
.
_symbŞ
);

461 
	`W_DO
(
_pday_m¬k‘_mª
->
	`dm_g‘_™”_by_šdex
(
_pssm
, 
tmp_dm_™”
,

462 
´daym¬k‘
, 
low»p
,

463 
high»p
, 
pdmš
.
_symbŞ
,

464 0, 
SH
, 
çl£
));

465 
dm_™”
 = 
tmp_dm_™”
;

468 
boŞ
 
eof
;

469 
	`W_DO
(
dm_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´daym¬k‘
));

470 !
eof
){

471 
myTime
 
dm_d©e
;

472 
´daym¬k‘
->
	`g‘_v®ue
(0, 
dm_d©e
);

474 if(
	`dayOfMÚth
(
dm_d©e
è=ğ
pdmš
.
_day_of_mÚth
){

475 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d MD:dm-update (%d) \n",

476 
xù_id
, 
pdmš
.
_vŞ_šü
);

477 
	`W_DO
(
_pday_m¬k‘_mª
->
	`dm_upd©e_vŞ
(
_pssm
, 
´daym¬k‘
,

478 
pdmš
.
_vŞ_šü
));

480 
	`W_DO
(
dm_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´daym¬k‘
));

483 } if(
	`¡rcmp
(
pdmš
.
_bË_Çme
, "EXCHANGE") == 0){

484 
rowcouÁ
 = 0;

493 
gu¬d
<
bË_sÿn_™”_im¶
<
exchªge_t
> > 
ex_™”
;

495 
bË_sÿn_™”_im¶
<
exchªge_t
>* 
tmp_ex_™”
;

496 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d DM:ex-g‘-bË-™” \n", 
xù_id
);

497 
	`W_DO
(
_³xchªge_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_ex_™”
));

498 
ex_™”
 = 
tmp_ex_™”
;

501 
boŞ
 
eof
;

502 
	`W_DO
(
ex_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´exchªge
));

503 !
eof
){

504 
ex_desc
[151];

505 
´exchªge
->
	`g‘_v®ue
(5, 
ex_desc
, 151);

507 
¡ršg
 
	`‹mp_ex_desc
(
ex_desc
);

508 if(
‹mp_ex_desc
.
	`fšd
("LAST UPDATED") != -1){

509 
rowcouÁ
++;

512 
	`W_DO
(
ex_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´exchªge
));

515 if(
rowcouÁ
 == 0) {

523 
bË_sÿn_™”_im¶
<
exchªge_t
>* 
tmp_ex_™”
;

524 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d DM:ex-g‘-bË-™” \n", 
xù_id
);

525 
	`W_DO
(
_³xchªge_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_ex_™”
));

526 
ex_™”
 = 
tmp_ex_™”
;

528 
	`W_DO
(
ex_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´exchªge
));

529 !
eof
){

530 
ex_desc
[151];

531 
´exchªge
->
	`g‘_v®ue
(5, 
ex_desc
, 151);

533 
¡ršg
 
	`Ãw_desc
(
ex_desc
);

534 
¡ršg¡»am
 
ss
;

535 
ss
 << "" << 
Ãw_desc
 << " LAST UPDATED " << 
	`time
(
NULL
) << "";

537 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d MD:ex-update (%s) \n",

538 
xù_id
, 
ss
.
	`¡r
().
	`c_¡r
());

539 
	`W_DO
(
_³xchªge_mª
->
	`ex_upd©e_desc
(
_pssm
, 
´exchªge
,

540 
ss
.
	`¡r
().
	`c_¡r
()));

542 
	`W_DO
(
ex_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´exchªge
));

552 
bË_sÿn_™”_im¶
<
exchªge_t
>* 
tmp_ex_™”
;

553 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d DM:ex-g‘-bË-™” \n", 
xù_id
);

554 
	`W_DO
(
_³xchªge_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_ex_™”
));

555 
ex_™”
 = 
tmp_ex_™”
;

557 
	`W_DO
(
ex_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´exchªge
));

558 !
eof
){

559 
ex_™”
 = 
tmp_ex_™”
;

560 
ex_desc
[151];

561 
´exchªge
->
	`g‘_v®ue
(5, 
ex_desc
, 151);

563 
¡ršg
 
	`‹mp
(
ex_desc
), 
Ãw_desc
;

564 
Ãw_desc
 = 
‹mp
.
	`sub¡r
(0,emp.
	`fšd_Ï¡_of
(" ") + 1);

565 
¡ršg¡»am
 
ss
;

566 
ss
 << "" << 
Ãw_desc
 << 
	`time
(
NULL
);

568 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d MD:ex-update (%s) \n",

569 
xù_id
, 
ss
.
	`¡r
().
	`c_¡r
());

570 
	`W_DO
(
_³xchªge_mª
->
	`ex_upd©e_desc
(
_pssm
, 
´exchªge
,

571 
ss
.
	`¡r
().
	`c_¡r
()));

573 
	`W_DO
(
ex_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´exchªge
));

577 } if(
	`¡rcmp
(
pdmš
.
_bË_Çme
, "FINANCIAL") == 0){

578 
rowcouÁ
 = 0;

590 
gu¬d
< 
šdex_sÿn_™”_im¶
<
fšªcŸl_t
> > 
fi_™”
;

592 
šdex_sÿn_™”_im¶
<
fšªcŸl_t
>* 
tmp_fi_™”
;

593 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:fi-get-iter-by-idx (%ld) \n",

594 
xù_id
, 
pdmš
.
_co_id
);

595 
	`W_DO
(
_pfšªcŸl_mª
->
	`fi_g‘_™”_by_šdex
(
_pssm
, 
tmp_fi_™”
,

596 
´fšªcŸl
, 
low»p
,

597 
high»p
, 
pdmš
.
_co_id
));

598 
fi_™”
 = 
tmp_fi_™”
;

601 
boŞ
 
eof
;

602 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d DM:fi-™”-Ãxˆ\n", 
xù_id
);

603 
	`W_DO
(
fi_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´fšªcŸl
));

604 !
eof
){

605 
myTime
 
fi_qŒ_¡¬t_d©e
;

606 
´fšªcŸl
->
	`g‘_v®ue
(3, 
fi_qŒ_¡¬t_d©e
);

608 if(
	`dayOfMÚth
(
fi_qŒ_¡¬t_d©e
) == 1){

609 
rowcouÁ
++;

612 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d DM:fi-™”-Ãxˆ\n", 
xù_id
);

613 
	`W_DO
(
fi_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´fšªcŸl
));

616 if(
rowcouÁ
 > 0){

626 
šdex_sÿn_™”_im¶
<
fšªcŸl_t
>* 
tmp_fi_™”
;

627 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:fi-get-iter-by-idx (%ld) \n",

628 
xù_id
, 
pdmš
.
_co_id
);

629 
	`W_DO
(
_pfšªcŸl_mª
->
	`fi_g‘_™”_by_šdex
(
_pssm
, 
tmp_fi_™”
,

630 
´fšªcŸl
,

631 
low»p
, 
high»p
,

632 
pdmš
.
_co_id
));

633 
fi_™”
 = 
tmp_fi_™”
;

635 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d DM:fi-™”-Ãxˆ\n", 
xù_id
);

636 
	`W_DO
(
fi_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´fšªcŸl
));

637 !
eof
){

638 
myTime
 
fi_qŒ_¡¬t_d©e
;

639 
´fšªcŸl
->
	`g‘_v®ue
(3, 
fi_qŒ_¡¬t_d©e
);

641 
fi_qŒ_¡¬t_d©e
 += (60*60*24);

643 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d MD:fi-update (%ld) \n",

644 
xù_id
, 
fi_qŒ_¡¬t_d©e
);

645 
	`W_DO
(
_pfšªcŸl_mª
->
	`fi_upd©e_desc
(
_pssm
, 
´fšªcŸl
,

646 
fi_qŒ_¡¬t_d©e
));

648 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d DM:fi-™”-Ãxˆ\n", 
xù_id
);

649 
	`W_DO
(
fi_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´fšªcŸl
));

661 
šdex_sÿn_™”_im¶
<
fšªcŸl_t
>* 
tmp_fi_™”
;

662 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:fi-get-iter-by-idx (%ld) \n",

663 
xù_id
, 
pdmš
.
_co_id
);

664 
	`W_DO
(
_pfšªcŸl_mª
->
	`fi_g‘_™”_by_šdex
(
_pssm
, 
tmp_fi_™”
,

665 
´fšªcŸl
,

666 
low»p
, 
high»p
,

667 
pdmš
.
_co_id
));

668 
fi_™”
 = 
tmp_fi_™”
;

670 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d DM:fi-™”-Ãxˆ\n", 
xù_id
);

671 
	`W_DO
(
fi_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´fšªcŸl
));

672 !
eof
){

673 
myTime
 
fi_qŒ_¡¬t_d©e
;

674 
´fšªcŸl
->
	`g‘_v®ue
(3, 
fi_qŒ_¡¬t_d©e
);

676 
fi_qŒ_¡¬t_d©e
 -= (60*60*24);

678 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d MD:fi-update-desc (%ld) \n",

679 
xù_id
, 
fi_qŒ_¡¬t_d©e
);

680 
	`W_DO
(
_pfšªcŸl_mª
->
	`fi_upd©e_desc
(
_pssm
, 
´fšªcŸl
,

681 
fi_qŒ_¡¬t_d©e
));

683 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d DM:fi-™”-Ãxˆ\n", 
xù_id
);

684 
	`W_DO
(
fi_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´fšªcŸl
));

688 } if(
	`¡rcmp
(
pdmš
.
_bË_Çme
, "NEWS_ITEM") == 0){

703 
gu¬d
< 
šdex_sÿn_™”_im¶
<
Ãws_x»f_t
> > 
nx_™”
;

705 
šdex_sÿn_™”_im¶
<
Ãws_x»f_t
>* 
tmp_nx_™”
;

706 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:nx-get-iter-by-idx (%ld) \n",

707 
xù_id
, 
pdmš
.
_co_id
);

708 
	`W_DO
(
_²ews_x»f_mª
->
	`nx_g‘_™”_by_šdex
(
_pssm
, 
tmp_nx_™”
,

709 
´Ãwsx»f
, 
low»p
,

710 
high»p
, 
pdmš
.
_co_id
));

711 
nx_™”
 = 
tmp_nx_™”
;

714 
boŞ
 
eof
;

715 
	`W_DO
(
nx_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Ãwsx»f
));

716 !
eof
){

717 
TId’t
 
nx_ni_id
;

718 
´Ãwsx»f
->
	`g‘_v®ue
(0, 
nx_ni_id
);

720 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:nx-idx-probe (%d) \n",

721 
xù_id
, 
nx_ni_id
);

722 
	`W_DO
(
_²ews_™em_mª
->
	`ni_šdex_´obe_fÜupd©e
(
_pssm
, 
´Ãws™em
,

723 
nx_ni_id
));

725 
myTime
 
ni_dts
;

726 
´Ãws™em
->
	`g‘_v®ue
(4, 
ni_dts
);

728 
ni_dts
 += (60 * 60 * 24);

730 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:nx-update-nidts (%d) \n",

731 
xù_id
, 
ni_dts
);

732 
	`W_DO
(
_²ews_™em_mª
->
	`ni_upd©e_dts_by_šdex
(
_pssm
, 
´Ãws™em
,

733 
ni_dts
));

735 
	`W_DO
(
nx_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Ãwsx»f
));

738 } if(
	`¡rcmp
(
pdmš
.
_bË_Çme
, "SECURITY") == 0){

748 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:s-idx-probe (%s) \n",

749 
xù_id
, 
pdmš
.
_symbŞ
);

750 
	`W_DO
(
_p£cur™y_mª
->
	`s_šdex_´obe_fÜupd©e
(
_pssm
, 
´£cur™y
,

751 
pdmš
.
_symbŞ
));

753 
myTime
 
s_exch_d©e
;

754 
´£cur™y
->
	`g‘_v®ue
(8, 
s_exch_d©e
);

756 
s_exch_d©e
 += (60 * 60 * 24);

758 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:s-update-ed (%d) \n",

759 
xù_id
, 
s_exch_d©e
);

760 
	`W_DO
(
_p£cur™y_mª
->
	`s_upd©e_ed
(
_pssm
, 
´£cur™y
, 
s_exch_d©e
));

762 } if(
	`¡rcmp
(
pdmš
.
_bË_Çme
, "TAXRATE") == 0){

772 
tx_Çme
[51];

774 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:tx-idx-probe (%d) \n",

775 
xù_id
, 
pdmš
.
_tx_id
);

776 
	`W_DO
(
_±ax¿‹_mª
->
	`tx_šdex_´obe_fÜupd©e
(
_pssm
, 
´x¿‹
,

777 
pdmš
.
_tx_id
));

779 
´x¿‹
->
	`g‘_v®ue
(1, 
tx_Çme
, 51);

781 
¡ršg
 
	`‹mp
(
tx_Çme
);

782 
size_t
 
šdex
 = 
‹mp
.
	`fšd
("Tax");

783 if(
šdex
 !ğ
¡ršg
::
Åos
){

784 
‹mp
.
	`»¶aû
(
šdex
, 3, "tax");

786 
šdex
 = 
‹mp
.
	`fšd
("tax");

787 
‹mp
.
	`»¶aû
(
šdex
, 3, "Tax");

798 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:tx-update-name (%s) \n",

799 
xù_id
, 
tx_Çme
);

800 
	`W_DO
(
_±ax¿‹_mª
->
	`tx_upd©e_Çme
(
_pssm
, 
´x¿‹
, 
‹mp
.
	`c_¡r
()));

802 } if(
	`¡rcmp
(
pdmš
.
_bË_Çme
, "WATCH_ITEM") == 0){

816 
út
 = 0;

817 
Şd_symbŞ
[16], 
Ãw_symbŞ
[16] = "\0";

819 
gu¬d
< 
šdex_sÿn_™”_im¶
<
w©ch_li¡_t
> > 
wl_™”
;

821 
šdex_sÿn_™”_im¶
<
w©ch_li¡_t
>* 
tmp_wl_™”
;

822 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:wl-get-iter-by-idx2 (%ld) \n",

823 
xù_id
, 
pdmš
.
_c_id
);

824 
	`W_DO
(
_pw©ch_li¡_mª
->
	`wl_g‘_™”_by_šdex2
(
_pssm
, 
tmp_wl_™”
,

825 
´w©chli¡
, 
low»p
,

826 
high»p
, 
pdmš
.
_c_id
));

827 
wl_™”
 = 
tmp_wl_™”
;

830 
boŞ
 
eof
;

831 
	`W_DO
(
wl_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´w©chli¡
));

832 !
eof
){

833 
TId’t
 
wl_id
;

834 
´w©chli¡
->
	`g‘_v®ue
(0, 
wl_id
);

836 
gu¬d
< 
šdex_sÿn_™”_im¶
<
w©ch_™em_t
> > 
wi_™”
;

838 
šdex_sÿn_™”_im¶
<
w©ch_™em_t
>* 
tmp_wi_™”
;

839 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:wi-get-iter-by-idx (%ld) \n",

840 
xù_id
, 
wl_id
);

841 
	`W_DO
(
_pw©ch_™em_mª
->
	`wi_g‘_™”_by_šdex
(
_pssm
, 
tmp_wi_™”
,

842 
´w©ch™em
, 
low»p
,

843 
high»p
, 
wl_id
));

844 
wi_™”
 = 
tmp_wi_™”
;

846 
	`W_DO
(
wi_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´w©ch™em
));

847 !
eof
){

848 
út
++;

849 
wi_s_symbŞ
[16];

850 
´w©ch™em
->
	`g‘_v®ue
(1, 
wi_s_symbŞ
, 16);

851 
	`W_DO
(
wi_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´w©ch™em
));

853 
	`W_DO
(
wl_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´w©chli¡
));

855 
út
 = (cnt+1)/2;

877 
šdex_sÿn_™”_im¶
<
w©ch_li¡_t
>* 
tmp_wl_™”
;

878 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:wl-get-iter-by-idx2 (%ld) \n",

879 
xù_id
, 
pdmš
.
_c_id
);

880 
	`W_DO
(
_pw©ch_li¡_mª
->
	`wl_g‘_™”_by_šdex2
(
_pssm
, 
tmp_wl_™”
,

881 
´w©chli¡
, 
low»p
,

882 
high»p
, 
pdmš
.
_c_id
));

883 
wl_™”
 = 
tmp_wl_™”
;

885 
	`W_DO
(
wl_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´w©chli¡
));

886 !
eof
 && 
út
 > 0){

887 
TId’t
 
wl_id
;

888 
´w©chli¡
->
	`g‘_v®ue
(0, 
wl_id
);

890 
gu¬d
< 
šdex_sÿn_™”_im¶
<
w©ch_™em_t
> > 
wi_™”
;

892 
šdex_sÿn_™”_im¶
<
w©ch_™em_t
>* 
tmp_wi_™”
;

893 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:wi-get-iter-by-idx (%ld) \n",

894 
xù_id
, 
wl_id
);

895 
	`W_DO
(
_pw©ch_™em_mª
->
	`wi_g‘_™”_by_šdex
(
_pssm
, 
tmp_wi_™”
,

896 
´w©ch™em
, 
low»p
,

897 
high»p
, 
wl_id
));

898 
wi_™”
 = 
tmp_wi_™”
;

900 
	`W_DO
(
wi_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´w©ch™em
));

901 !
eof
){

902 
út
--;

903 if(
út
 == 0){

904 
´w©ch™em
->
	`g‘_v®ue
(1, 
Şd_symbŞ
, 16);

907 
	`W_DO
(
wi_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´w©ch™em
));

909 
	`W_DO
(
wl_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´w©chli¡
));

933 
gu¬d
< 
šdex_sÿn_™”_im¶
<
£cur™y_t
> > 
s_™”
;

935 
šdex_sÿn_™”_im¶
<
£cur™y_t
>* 
tmp_s_™”
;

936 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:s-get-iter-by-idx (%s) \n",

937 
xù_id
, 
Şd_symbŞ
);

938 
	`W_DO
(
_p£cur™y_mª
->
	`s_g‘_™”_by_šdex
(
_pssm
, 
tmp_s_™”
,

939 
´£cur™y
, 
low»p
, 
high»p
,

940 
Şd_symbŞ
));

941 
s_™”
 = 
tmp_s_™”
;

944 
	`W_DO
(
s_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´£cur™y
));

945 !
eof
){

946 
s_symb
[16];

947 
´£cur™y
->
	`g‘_v®ue
(0, 
s_symb
, 16);

949 
šdex_sÿn_™”_im¶
<
w©ch_li¡_t
>* 
tmp_wl_™”
;

950 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:wl-get-iter-by-idx2 (%ld) \n",

951 
xù_id
, 
pdmš
.
_c_id
);

952 
	`W_DO
(
_pw©ch_li¡_mª
->
	`wl_g‘_™”_by_šdex2
(
_pssm
, 
tmp_wl_™”
,

953 
´w©chli¡
, 
low»p
,

954 
high»p
, 
pdmš
.
_c_id
));

955 
wl_™”
 = 
tmp_wl_™”
;

956 
	`W_DO
(
wl_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´w©chli¡
));

957 !
eof
){

958 
TId’t
 
wl_id
;

959 
´w©chli¡
->
	`g‘_v®ue
(0, 
wl_id
);

961 
gu¬d
< 
šdex_sÿn_™”_im¶
<
w©ch_™em_t
> > 
wi_™”
;

963 
šdex_sÿn_™”_im¶
<
w©ch_™em_t
>* 
tmp_wi_™”
;

964 
	`TRACE
(
TRACE_TRX_FLOW
,

965 "Aµ: %d DM:wi-g‘-™”-by-idx (%ld)\n", 
xù_id
, 
wl_id
);

966 
	`W_DO
(
_pw©ch_™em_mª
->
	`wi_g‘_™”_by_šdex
(
_pssm
,

967 
tmp_wi_™”
,

968 
´w©ch™em
,

969 
low»p
, 
high»p
,

970 
wl_id
));

971 
wi_™”
 = 
tmp_wi_™”
;

973 
	`W_DO
(
wi_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´w©ch™em
));

974 !
eof
){

975 
wi_s_symb
[16];

976 
´w©ch™em
->
	`g‘_v®ue
(1, 
wi_s_symb
, 16);

977 if(
	`¡rcmp
(
s_symb
, 
wi_s_symb
) != 0){

978 
	`¡rıy
(
Ãw_symbŞ
, 
s_symb
);

981 
	`W_DO
(
wi_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´w©ch™em
));

983 if(
	`¡rcmp
(
Ãw_symbŞ
, "\0") != 0) {

986 
	`W_DO
(
wl_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´w©chli¡
));

988 if(
	`¡rcmp
(
Ãw_symbŞ
, "\0") != 0) {

991 
	`W_DO
(
s_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´£cur™y
));

1006 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:wl-get-iter-by-idx2 (%ld) \n",

1007 
xù_id
, 
pdmš
.
_c_id
);

1008 
	`W_DO
(
_pw©ch_li¡_mª
->
	`wl_g‘_™”_by_šdex2
(
_pssm
, 
tmp_wl_™”
,

1009 
´w©chli¡
, 
low»p
,

1010 
high»p
, 
pdmš
.
_c_id
));

1011 
wl_™”
 = 
tmp_wl_™”
;

1013 
	`W_DO
(
wl_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´w©chli¡
));

1014 !
eof
 && 
út
 > 0){

1015 
TId’t
 
wl_id
;

1016 
´w©chli¡
->
	`g‘_v®ue
(0, 
wl_id
);

1018 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d DM:wi-update-symb (%ld) (%s) (%s) \n",

1019 
xù_id
, 
wl_id
, 
Şd_symbŞ
, 
Ãw_symbŞ
);

1020 
	`W_DO
(
_pw©ch_™em_mª
->
	`wi_upd©e_symb
(
_pssm
, 
´w©ch™em
, 
wl_id
,

1021 
Şd_symbŞ
, 
Ãw_symbŞ
));

1022 
	`W_DO
(
wl_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´w©chli¡
));

1026 #ifdeà
PRINT_TRX_RESULTS


1029 
¿cù³rm
.
	`´št_tu¶e
();

1030 
¿dd»ss
.
	`´št_tu¶e
();

1031 
rcom·ny
.
	`´št_tu¶e
();

1032 
rcu¡om”
.
	`´št_tu¶e
();

1033 
rcu¡om”x¿‹
.
	`´št_tu¶e
();

1034 
rdaym¬k‘
.
	`´št_tu¶e
();

1035 
»xchªge
.
	`´št_tu¶e
();

1036 
rfšªcŸl
.
	`´št_tu¶e
();

1037 
r£cur™y
.
	`´št_tu¶e
();

1038 
ºews™em
.
	`´št_tu¶e
();

1039 
ºewsx»f
.
	`´št_tu¶e
();

1040 
¹ax¿‹
.
	`´št_tu¶e
();

1041 
rw©ch™em
.
	`´št_tu¶e
();

1042 
rw©chli¡
.
	`´št_tu¶e
();

1045  
RCOK
;

1047 
	}
}

1050 
EXIT_NAMESPACE
(
û
);

	@src/workload/tpce/shore_tpce_xct_market_feed.cpp

32 
	~"wÜklßd/û/shÜe_û_’v.h
"

33 
	~"wÜklßd/û/û_cÚ¡.h
"

34 
	~"wÜklßd/û/û_šput.h
"

36 
	~<veùÜ
>

37 
	~<num”ic
>

38 
	~<®gÜ™hm
>

39 
	~<¡dio.h
>

40 
	~<¡dlib.h
>

41 
	~"wÜklßd/û/eg’/CE.h
"

42 
	~"wÜklßd/û/eg’/TxnH¬ÃssSŒuùs.h
"

43 
	~"wÜklßd/û/shÜe_û_eg’.h
"

45 
usšg
 
Çme¥aû
 
	gshÜe
;

46 
usšg
 
Çme¥aû
 
	gTPCE
;

50 
ENTER_NAMESPACE
(
û
);

59 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_m¬k‘_ãed
(cÚ¡ 
xù_id
,

60 
m¬k‘_ãed_šput_t
& 
pmfš
)

63 if(
pmfš
.
_ty³_lim™_buy
[0] == '\0') {

64 
	`©omic_šc_ušt_nv
(&
_num_šv®id_šput
);

65  
RCOK
;

69 
	`as£¹
 (
_pssm
);

70 
	`as£¹
 (
_š™Ÿlized
);

71 
	`as£¹
 (
_lßded
);

73 
tu¶e_gu¬d
<
Ï¡_Œade_mª_im¶
> 
	`´Ï¡Œade
(
_¶a¡_Œade_mª
);

74 
tu¶e_gu¬d
<
Œade_»que¡_mª_im¶
> 
	`´Œad”eq
(
_±¿de_»que¡_mª
);

75 
tu¶e_gu¬d
<
Œade_mª_im¶
> 
	`´Œade
(
_±¿de_mª
);

76 
tu¶e_gu¬d
<
Œade_hi¡Üy_mª_im¶
> 
	`´Œadehi¡
(
_±¿de_hi¡Üy_mª
);

78 
»p_row_t
 
	`¬•row
(
_±¿de_mª
->
	`ts
());

80 
¬•row
.
	`£t
(
_±¿de_desc
->
	`maxsize
());

82 
´Ï¡Œade
->
_»p
 = &
¬•row
;

83 
´Œad”eq
->
_»p
 = &
¬•row
;

84 
´Œade
->
_»p
 = &
¬•row
;

85 
´Œadehi¡
->
_»p
 = &
¬•row
;

87 
»p_row_t
 
	`low»p
Ğ
_±¿de_mª
->
	`ts
());

88 
»p_row_t
 
	`high»p
Ğ
_±¿de_mª
->
	`ts
());

91 
low»p
.
	`£t
(
_±¿de_desc
->
	`maxsize
());

92 
high»p
.
	`£t
(
_±¿de_desc
->
	`maxsize
());

94 
myTime
 
now_dts
;

95 
»q_´iû_quÙe
;

96 
TId’t
 
»q_Œade_id
;

97 
»q_Œade_qty
;

98 
»q_Œade_ty³
[4];

99 
rows_upd©ed
;

100 
ušt
 
num_d–‘ed
;

102 
now_dts
 = 
	`time
(
NULL
);

105 
rows_upd©ed
 = 0;„ows_upd©ed < 
max_ãed_Ën
;„ows_updated++) {

106 
num_d–‘ed
 = 0;

118 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d MF:lt-update (%s) (%d) (%d) (%ld) \n",

119 
xù_id
, 
pmfš
.
_symbŞ
[
rows_upd©ed
],

120 
pmfš
.
_´iû_quÙe
[
rows_upd©ed
],

121 
pmfš
.
_Œade_qty
[
rows_upd©ed
], 
now_dts
);

122 
	`W_DO
(
_¶a¡_Œade_mª
->

123 
	`É_upd©e_by_šdex
(
_pssm
, 
´Ï¡Œade
, 
pmfš
.
_symbŞ
[
rows_upd©ed
],

124 
pmfš
.
_´iû_quÙe
[
rows_upd©ed
],

125 
pmfš
.
_Œade_qty
[
rows_upd©ed
], 
now_dts
));

145 
gu¬d
< 
šdex_sÿn_™”_im¶
<
Œade_»que¡_t
> > 
Œ_™”
;

147 
šdex_sÿn_™”_im¶
<
Œade_»que¡_t
>* 
tmp_Œ_™”
;

148 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d MF:tr-get-iter-by-idx4 (%s) \n",

149 
xù_id
, 
pmfš
.
_symbŞ
[
rows_upd©ed
]);

150 
	`W_DO
(
_±¿de_»que¡_mª
->

151 
	`Œ_g‘_™”_by_šdex4
(
_pssm
, 
tmp_Œ_™”
, 
´Œad”eq
, 
low»p
,

152 
high»p
, 
pmfš
.
_symbŞ
[
rows_upd©ed
]));

153 
Œ_™”
 = 
tmp_Œ_™”
;

156 
boŞ
 
eof
;

157 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d MF:Œ-™”-Ãxˆ\n", 
xù_id
);

158 
w_rc_t
 
e
 = 
Œ_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œad”eq
);

159 ià(
e
.
	`is_”rÜ
()) {

160 if(
e
.
	`”r_num
(è=ğ
smËv–_0
::
eBADSLOTNUMBER
) {

161 
eof
 = 
Œue
;

163 
	`W_DO
(
e
);

166 !
eof
) {

167 
´Œad”eq
->
	`g‘_v®ue
(1, 
»q_Œade_ty³
, 4);

168 
´Œad”eq
->
	`g‘_v®ue
(4, 
»q_´iû_quÙe
);

170 if((
	`¡rcmp
(
»q_Œade_ty³
, 
pmfš
.
_ty³_¡İ_loss
) == 0 &&

171 (
»q_´iû_quÙe
 >ğ
pmfš
.
_´iû_quÙe
[
rows_upd©ed
])) ||

172 (
	`¡rcmp
(
»q_Œade_ty³
, 
pmfš
.
_ty³_lim™_£Î
) == 0 &&

173 (
»q_´iû_quÙe
 <ğ
pmfš
.
_´iû_quÙe
[
rows_upd©ed
])) ||

174 (
	`¡rcmp
(
»q_Œade_ty³
, 
pmfš
.
_ty³_lim™_buy
)== 0 &&

175 (
»q_´iû_quÙe
 >ğ
pmfš
.
_´iû_quÙe
[
rows_upd©ed
]))

177 
´Œad”eq
->
	`g‘_v®ue
(0, 
»q_Œade_id
);

178 
´Œad”eq
->
	`g‘_v®ue
(3, 
»q_Œade_qty
);

192 
pmfš
.
_Œade_rid
[
num_d–‘ed
] = 
´Œad”eq
->
	`rid
();

193 
num_d–‘ed
++;

204 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d MF:t-update (%ld) (%ld) (%s) \n",

205 
xù_id
, 
»q_Œade_id
, 
now_dts
, 
pmfš
.
_¡©us_subm™‹d
);

206 
	`W_DO
(
_±¿de_mª
->

207 
	`t_upd©e_dts_¡did_by_šdex
(
_pssm
, 
´Œade
,

208 
»q_Œade_id
, 
now_dts
,

209 
pmfš
.
_¡©us_subm™‹d
));

219 
´Œadehi¡
->
	`£t_v®ue
(0, 
»q_Œade_id
);

220 
´Œadehi¡
->
	`£t_v®ue
(1, 
now_dts
);

221 
´Œadehi¡
->
	`£t_v®ue
(2, 
pmfš
.
_¡©us_subm™‹d
);

223 
	`TRACE
(
TRACE_TRX_FLOW
,"App: %d MF:th-add-tuple (%ld) (%ld) (%s)\n",

224 
xù_id
, 
»q_Œade_id
, 
now_dts
, 
pmfš
.
_¡©us_subm™‹d
);

225 
	`W_DO
(
_±¿de_hi¡Üy_mª
->
	`add_tu¶e
(
_pssm
, 
´Œadehi¡
));

227 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d MF:Œ-™”-Ãxˆ\n", 
xù_id
);

228 
e
 = 
Œ_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œad”eq
);

229 ià(
e
.
	`is_”rÜ
()) {

230 if(
e
.
	`”r_num
(è=ğ
smËv–_0
::
eBADSLOTNUMBER
) {

231 
eof
 = 
Œue
;

233 
	`W_DO
(
e
);

236 
ušt
 
i
=0; i<
num_d–‘ed
; i++) {

237 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

238 "%d - MF:Œ-d–‘e-tu¶- (%d).(%d).(%d).(%d)\n", 
xù_id
,

239 (
pmfš
.
_Œade_rid
[
i
]).
pid
.
	`vŞ
().
vŞ
,

240 (
pmfš
.
_Œade_rid
[
i
]).
pid
.
	`¡Üe
(),

241 (
pmfš
.
_Œade_rid
[
i
]).
pid
.
·ge
,

242 (
pmfš
.
_Œade_rid
[
i
]).
¦Ù
);

243 
e
 = 
_±¿de_»que¡_mª
->
	`Œ_d–‘e_tu¶e
(
_pssm
, 
´Œad”eq
,

244 
pmfš
.
_Œade_rid
[
i
]);

245 ià(
e
.
	`is_”rÜ
(è&&ƒ.
	`”r_num
(è!ğ
smËv–_0
::
eBADSLOTNUMBER
) {

246 
	`W_DO
(
e
);

251 
	`as£¹
(
rows_upd©ed
 =ğ
max_ãed_Ën
);

268 #ifdeà
PRINT_TRX_RESULTS


271 
¾a¡Œade
.
	`´št_tu¶e
();

272 
¹¿d”eq
.
	`´št_tu¶e
();

273 
¹¿de
.
	`´št_tu¶e
();

274 
¹¿dehi¡
.
	`´št_tu¶e
();

277  
RCOK
;

279 
	}
}

282 
EXIT_NAMESPACE
(
û
);

	@src/workload/tpce/shore_tpce_xct_market_watch.cpp

32 
	~"wÜklßd/û/shÜe_û_’v.h
"

33 
	~"wÜklßd/û/û_cÚ¡.h
"

34 
	~"wÜklßd/û/û_šput.h
"

36 
	~<veùÜ
>

37 
	~<num”ic
>

38 
	~<®gÜ™hm
>

39 
	~<¡dio.h
>

40 
	~<¡dlib.h
>

41 
	~"wÜklßd/û/eg’/CE.h
"

42 
	~"wÜklßd/û/eg’/TxnH¬ÃssSŒuùs.h
"

43 
	~"wÜklßd/û/shÜe_û_eg’.h
"

45 
usšg
 
Çme¥aû
 
	gshÜe
;

46 
usšg
 
Çme¥aû
 
	gTPCE
;

48 
ENTER_NAMESPACE
(
û
);

56 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_m¬k‘_w©ch
(cÚ¡ 
xù_id
,

57 
m¬k‘_w©ch_šput_t
& 
pmwš
)

60 
	`as£¹
 (
_pssm
);

61 
	`as£¹
 (
_š™Ÿlized
);

62 
	`as£¹
 (
_lßded
);

64 
tu¶e_gu¬d
<
com·ny_mª_im¶
> 
	`´com·ny
(
_pcom·ny_mª
);

65 
tu¶e_gu¬d
<
day_m¬k‘_mª_im¶
> 
	`´daym¬k‘
(
_pday_m¬k‘_mª
);

66 
tu¶e_gu¬d
<
hŞdšg_summ¬y_mª_im¶
> 
	`´hŞdsumm
(
_phŞdšg_summ¬y_mª
);

67 
tu¶e_gu¬d
<
šdu¡ry_mª_im¶
> 
	`´šdu¡ry
(
_pšdu¡ry_mª
);

68 
tu¶e_gu¬d
<
Ï¡_Œade_mª_im¶
> 
	`´Ï¡Œade
(
_¶a¡_Œade_mª
);

69 
tu¶e_gu¬d
<
£cur™y_mª_im¶
> 
	`´£cur™y
(
_p£cur™y_mª
);

70 
tu¶e_gu¬d
<
w©ch_™em_mª_im¶
> 
	`´w©ch™em
(
_pw©ch_™em_mª
);

71 
tu¶e_gu¬d
<
w©ch_li¡_mª_im¶
> 
	`´w©chli¡
(
_pw©ch_li¡_mª
);

73 
»p_row_t
 
	`¬•row
(
_pcom·ny_mª
->
	`ts
());

75 
¬•row
.
	`£t
(
_pcom·ny_desc
->
	`maxsize
());

77 
´com·ny
->
_»p
 = &
¬•row
;

78 
´daym¬k‘
->
_»p
 = &
¬•row
;

79 
´hŞdsumm
->
_»p
 = &
¬•row
;

80 
´šdu¡ry
->
_»p
 = &
¬•row
;

81 
´Ï¡Œade
->
_»p
 = &
¬•row
;

82 
´£cur™y
->
_»p
 = &
¬•row
;

83 
´w©ch™em
->
_»p
 = &
¬•row
;

84 
´w©chli¡
->
_»p
 = &
¬•row
;

86 
»p_row_t
 
	`low»p
Ğ
_pcom·ny_mª
->
	`ts
());

87 
»p_row_t
 
	`high»p
Ğ
_pcom·ny_mª
->
	`ts
());

90 
low»p
.
	`£t
(
_pcom·ny_desc
->
	`maxsize
());

91 
high»p
.
	`£t
(
_pcom·ny_desc
->
	`maxsize
());

93 if(! ((
pmwš
.
_acù_id
 !ğ0è|| (pmwš.
_cu¡_id
 != 0) ||

94 
	`¡rcmp
(
pmwš
.
_šdu¡ry_Çme
, "") != 0)) {

95 
	`as£¹
(
çl£
);

98 
veùÜ
<
¡ršg
> 
¡ock_li¡
;

99 if(
pmwš
.
_cu¡_id
 != 0){

110 
boŞ
 
eof
;

111 
gu¬d
< 
šdex_sÿn_™”_im¶
<
w©ch_li¡_t
> > 
wl_™”
;

113 
šdex_sÿn_™”_im¶
<
w©ch_li¡_t
>* 
tmp_wl_™”
;

114 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d MW:wl-get-iter-by-idx2 (%ld) \n",

115 
xù_id
, 
pmwš
.
_cu¡_id
);

116 
	`W_DO
(
_pw©ch_li¡_mª
->
	`wl_g‘_™”_by_šdex2
(
_pssm
, 
tmp_wl_™”
,

117 
´w©chli¡
,

118 
low»p
, 
high»p
,

119 
pmwš
.
_cu¡_id
));

120 
wl_™”
 = 
tmp_wl_™”
;

123 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d MW:wl-™”-Ãxˆ\n", 
xù_id
);

124 
	`W_DO
(
wl_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´w©chli¡
));

125 if(
eof
è{ 
	`W_DO
(
	`RC
(
£_NOT_FOUND
)); }

127 
TId’t
 
wl_id
;

128 
´w©chli¡
->
	`g‘_v®ue
(0, 
wl_id
);

130 
gu¬d
< 
šdex_sÿn_™”_im¶
<
w©ch_™em_t
> > 
wi_™”
;

132 
šdex_sÿn_™”_im¶
<
w©ch_™em_t
>* 
tmp_wi_™”
;

133 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d MW:wi-get-iter-by-idx (%ld) \n",

134 
xù_id
, 
wl_id
);

135 
	`W_DO
(
_pw©ch_™em_mª
->
	`wi_g‘_™”_by_šdex
(
_pssm
, 
tmp_wi_™”
,

136 
´w©ch™em
, 
low»p
,

137 
high»p
, 
wl_id
));

138 
wi_™”
 = 
tmp_wi_™”
;

141 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d MW:wi-™”-Ãxˆ\n", 
xù_id
);

142 
	`W_DO
(
wi_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´w©ch™em
));

143 !
eof
){

144 
wi_s_symb
[16];

145 
´w©ch™em
->
	`g‘_v®ue
(1, 
wi_s_symb
, 16);

147 
¡ršg
 
	`symb
(
wi_s_symb
);

148 
¡ock_li¡
.
	`push_back
(
symb
);

150 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d MW:wi-iter-next %s \n",

151 
xù_id
, 
wi_s_symb
);

152 
	`W_DO
(
wi_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´w©ch™em
));

154 } if(
pmwš
.
_šdu¡ry_Çme
[0] != 0) {

166 
gu¬d
< 
šdex_sÿn_™”_im¶
<
šdu¡ry_t
> > 
š_™”
;

168 
šdex_sÿn_™”_im¶
<
šdu¡ry_t
>* 
tmp_š_™”
;

169 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d MW:in-get-iter-by-idx2 (%s) \n",

170 
xù_id
, 
pmwš
.
_šdu¡ry_Çme
);

171 
	`W_DO
(
_pšdu¡ry_mª
->
	`š_g‘_™”_by_šdex2
(
_pssm
, 
tmp_š_™”
,

172 
´šdu¡ry
,

173 
low»p
, 
high»p
,

174 
pmwš
.
_šdu¡ry_Çme
));

175 
š_™”
 = 
tmp_š_™”
;

177 
boŞ
 
eof
;

178 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d MW:š-™”-Ãxˆ\n", 
xù_id
);

179 
	`W_DO
(
š_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´šdu¡ry
));

180 if(
eof
è{ 
	`W_DO
(
	`RC
(
£_NOT_FOUND
)); }

182 
š_id
[3];

183 
´šdu¡ry
->
	`g‘_v®ue
(0, 
š_id
, 3);

185 
gu¬d
< 
šdex_sÿn_™”_im¶
<
com·ny_t
> > 
co_™”
;

187 
šdex_sÿn_™”_im¶
<
com·ny_t
>* 
tmp_co_™”
;

188 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d MW:co-get-iter-by-idx3 (%s) \n",

189 
xù_id
, 
š_id
);

190 
	`W_DO
(
_pcom·ny_mª
->
	`co_g‘_™”_by_šdex3
(
_pssm
, 
tmp_co_™”
,

191 
´com·ny
,

192 
low»p
, 
high»p
, 
š_id
));

193 
co_™”
 = 
tmp_co_™”
;

196 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d MW:co-™”-Ãxˆ\n", 
xù_id
);

197 
	`W_DO
(
co_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´com·ny
));

199 
TId’t
 
co_id
;

200 !
eof
){

201 
´com·ny
->
	`g‘_v®ue
(0, 
co_id
);

203 if(
pmwš
.
_¡¬tšg_co_id
 <ğ
co_id
 && co_id <ğpmwš.
_’dšg_co_id
) {

204 
gu¬d
< 
šdex_sÿn_™”_im¶
<
£cur™y_t
> > 
s_™”
;

206 
šdex_sÿn_™”_im¶
<
£cur™y_t
>* 
tmp_s_™”
;

207 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App:%d MW:s-get-iter-by-idx4 (%ld)\n",

208 
xù_id
, 
co_id
);

209 
	`W_DO
(
_p£cur™y_mª
->
	`s_g‘_™”_by_šdex4
(
_pssm
, 
tmp_s_™”
,

210 
´£cur™y
, 
low»p
,

211 
high»p
, 
co_id
));

212 
s_™”
 = 
tmp_s_™”
;

215 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d MW:s-™”-Ãxˆ\n", 
xù_id
);

216 
	`W_DO
(
s_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´£cur™y
));

218 !
eof
){

219 
s_symb
[16];

220 
´£cur™y
->
	`g‘_v®ue
(0, 
s_symb
, 16);

222 
¡ršg
 
	`symb
(
s_symb
);

223 
¡ock_li¡
.
	`push_back
(
symb
);

225 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TO:s-™”-Ãxˆ\n", 
xù_id
);

226 
	`W_DO
(
s_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´£cur™y
));

229 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d MW:co-™”-Ãxˆ\n", 
xù_id
);

230 
	`W_DO
(
co_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´com·ny
));

232 } if(
pmwš
.
_acù_id
 != 0) {

241 
gu¬d
< 
šdex_sÿn_™”_im¶
<
hŞdšg_summ¬y_t
> > 
hs_™”
;

243 
šdex_sÿn_™”_im¶
<
hŞdšg_summ¬y_t
>* 
tmp_hs_™”
;

244 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d MW:hs-iter-by-idx (%ld) \n",

245 
xù_id
, 
pmwš
.
_acù_id
);

246 
	`W_DO
(
_phŞdšg_summ¬y_mª
->
	`hs_g‘_™”_by_šdex
(
_pssm
, 
tmp_hs_™”
,

247 
´hŞdsumm
,

248 
low»p
, 
high»p
,

249 
pmwš
.
_acù_id
,

250 
çl£
));

251 
hs_™”
 = 
tmp_hs_™”
;

254 
boŞ
 
eof
;

255 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d MW:hs-™”-Ãxˆ\n", 
xù_id
);

256 
	`W_DO
(
hs_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´hŞdsumm
));

257 !
eof
){

258 
hs_s_symb
[16];

259 
´hŞdsumm
->
	`g‘_v®ue
(1, 
hs_s_symb
, 16);

261 
¡ršg
 
	`symb
(
hs_s_symb
);

262 
¡ock_li¡
.
	`push_back
(
symb
);

264 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d MW:hs-™”-Ãxˆ\n", 
xù_id
);

265 
	`W_DO
(
hs_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´hŞdsumm
));

269 
Şd_mkt_ÿp
 = 0;

270 
Ãw_mkt_ÿp
 = 0;

271 
pù_chªge
;

273 
veùÜ
<
¡ršg
>::
™”©Ü
 
¡ock_li¡_™”
 = 
¡ock_li¡
.
	`begš
();

274 
¡ock_li¡_™”
 !ğ
¡ock_li¡
.
	`’d
();

275 
¡ock_li¡_™”
++) {

277 
symbŞ
[16];

278 
	`¡rıy
(
symbŞ
, (*
¡ock_li¡_™”
).
	`c_¡r
());

288 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d MW:É-idx-´ob(%sè\n", 
xù_id
, 
symbŞ
);

289 
	`W_DO
(
_¶a¡_Œade_mª
->
	`É_šdex_´obe
(
_pssm
, 
´Ï¡Œade
, 
symbŞ
));

290 
Ãw_´iû
;

291 
´Ï¡Œade
->
	`g‘_v®ue
(2, 
Ãw_´iû
);

301 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d MW:s-idx-´ob(%sè\n", 
xù_id
, 
symbŞ
);

302 
	`W_DO
(
_p£cur™y_mª
->
	`s_šdex_´obe
(
_pssm
, 
´£cur™y
, 
symbŞ
));

303 
s_num_out
;

304 
´£cur™y
->
	`g‘_v®ue
(6, 
s_num_out
);

315 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d MW:dm-idx1-probe (%s) (%d) \n",

316 
xù_id
, 
symbŞ
, 
pmwš
.
_¡¬t_d©e
);

317 
	`W_DO
(
_pday_m¬k‘_mª
->
	`dm_šdex_´obe
(
_pssm
, 
´daym¬k‘
, 
symbŞ
,

318 
pmwš
.
_¡¬t_d©e
));

319 
Şd_´iû
;

320 
´daym¬k‘
->
	`g‘_v®ue
(2, 
Şd_´iû
);

322 
Şd_mkt_ÿp
 +ğ(
s_num_out
 * 
Şd_´iû
);

323 
Ãw_mkt_ÿp
 +ğ(
s_num_out
 * 
Ãw_´iû
);

326 if(
Şd_mkt_ÿp
 != 0){

327 
pù_chªge
 = 100 * (
Ãw_mkt_ÿp
 / 
Şd_mkt_ÿp
 - 1);

329 
pù_chªge
 = 0;

332 #ifdeà
PRINT_TRX_RESULTS


335 
rcom·ny
.
	`´št_tu¶e
();

336 
rdaym¬k‘
.
	`´št_tu¶e
();

337 
rhŞdsumm
.
	`´št_tu¶e
();

338 
ršdu¡ry
.
	`´št_tu¶e
();

339 
¾a¡Œade
.
	`´št_tu¶e
();

340 
r£cur™y
.
	`´št_tu¶e
();

341 
rw©ch™em
.
	`´št_tu¶e
();

342 
rw©chli¡
.
	`´št_tu¶e
();

345  
RCOK
;

347 
	}
}

350 
EXIT_NAMESPACE
(
û
);

	@src/workload/tpce/shore_tpce_xct_populate.cpp

33 
	~"wÜklßd/û/shÜe_û_’v.h
"

34 
	~"wÜklßd/û/û_cÚ¡.h
"

35 
	~"wÜklßd/û/û_šput.h
"

37 
	~<veùÜ
>

38 
	~<num”ic
>

39 
	~<®gÜ™hm
>

40 
	~<¡dio.h
>

41 
	~<¡dlib.h
>

42 
	~"wÜklßd/û/eg’/CE.h
"

43 
	~"wÜklßd/û/eg’/TxnH¬ÃssSŒuùs.h
"

44 
	~"wÜklßd/û/shÜe_û_eg’.h
"

46 
usšg
 
Çme¥aû
 
	gshÜe
;

47 
usšg
 
Çme¥aû
 
	gTPCE
;

52 
ENTER_NAMESPACE
(
û
);

54 #ifdeà
COMPILE_FLAT_FILE_LOAD


55 
FILE
 * 
fs£c
;

56 
FILE
* 
fshs
;

59 cÚ¡ 
	glßdUn™
 = 10000;

61 
	g‹¡CÁ
 = 0;

63 #ifdeà
TESTING_TPCE


65 
	gŒxs_út_execu‹d
[10];

66 
	gŒxs_út_çed
[10];

70 
	gT¿deOrd”CÁ
;

72 
	gÏ¡T¿deId
 = 0;

75 
AccouÁP”missiÚBufãr
 
accouÁP”missiÚBufãr
 (3015);

76 
Cu¡om”Bufãr
 
cu¡om”Bufãr
 (1005);

77 
Cu¡om”AccouÁBufãr
 
cu¡om”AccouÁBufãr
 (1005);

78 
Cu¡om”Tax¿‹Bufãr
 
cu¡om”Tax¿‹Bufãr
 (2010);

79 
HŞdšgBufãr
 
hŞdšgBufãr
(10000);

80 
HŞdšgHi¡ÜyBufãr
 
hŞdšgHi¡ÜyBufãr
(2*
lßdUn™
);

81 
HŞdšgSumm¬yBufãr
 
hŞdšgSumm¬yBufãr
(6000);

82 
W©chI‹mBufãr
 
w©chI‹mBufãr
 (
iMaxI‹msInWL
*1020+5000);

83 
W©chLi¡Bufãr
 
w©chLi¡Bufãr
 (1020);

85 
Brok”Bufãr
 
brok”Bufãr
(100);

86 
CashT¿n§ùiÚBufãr
 
ÿshT¿n§ùiÚBufãr
(
lßdUn™
);

87 
Ch¬geBufãr
 
ch¬geBufãr
(20);

88 
CommissiÚR©eBufãr
 
commissiÚR©eBufãr
 (245);

89 
S‘em’tBufãr
 
£‰Ëm’tBufãr
(
lßdUn™
);

90 
T¿deBufãr
 
ŒadeBufãr
(
lßdUn™
);

91 
T¿deHi¡ÜyBufãr
 
ŒadeHi¡ÜyBufãr
(3*
lßdUn™
);

92 
T¿deTy³Bufãr
 
ŒadeTy³Bufãr
 (10);

95 
Com·nyBufãr
 
com·nyBufãr
 (1000);

96 
Com·nyCom³t™ÜBufãr
 
com·nyCom³t™ÜBufãr
(3000);

97 
DayM¬k‘Bufãr
 
dayM¬k‘Bufãr
(3000);

98 
ExchªgeBufãr
 
exchªgeBufãr
(9);

99 
FšªcŸlBufãr
 
fšªcŸlBufãr
 (1500);

100 
Indu¡ryBufãr
 
šdu¡ryBufãr
(107);

101 
La¡T¿deBufãr
 
Ï¡T¿deBufãr
 (1005);

102 
NewsI‹mBufãr
 
ÃwsI‹mBufãr
(200);

103 
NewsXRefBufãr
 
ÃwsXRefBufãr
(200);

104 
SeùÜBufãr
 
£ùÜBufãr
(17);

105 
Secur™yBufãr
 
£cur™yBufãr
(1005);

108 
Add»ssBufãr
 
add»ssBufãr
(1005);

109 
StusTy³Bufãr
 
¡©usTy³Bufãr
 (10);

110 
Tax¿‹Bufãr
 
x¿‹Bufãr
 (325);

111 
ZCodeBufãr
 
zCodeBufãr
 (14850);

119 
__th»ad
 
ShÜeTPCETrxSts
 
	gmy_¡©s
;

121 
	gShÜeTPCEEnv
::
	$’v_th»ad_š™
()

123 
	`CRITICAL_SECTION
(
¡©_mu‹x_cs
, 
_¡©m­_mu‹x
);

124 
_¡©m­
[
	`±h»ad_£lf
()] = &
my_¡©s
;

125 
	}
}

127 
	gShÜeTPCEEnv
::
	$’v_th»ad_fši
()

129 
	`CRITICAL_SECTION
(
¡©_mu‹x_cs
, 
_¡©m­_mu‹x
);

130 
_¡©m­
.
	`”a£
(
	`±h»ad_£lf
());

131 
	}
}

142 
ShÜeTPCETrxSts
 
	gShÜeTPCEEnv
::
	$_g‘_¡©s
()

144 
	`CRITICAL_SECTION
(
cs
, 
_¡©m­_mu‹x
);

145 
ShÜeTPCETrxSts
 
rv®
;

146 
rv®
 -=„val;

147 
¡©m­_t
::
™”©Ü
 
™
=
_¡©m­
.
	`begš
(); iˆ!ğ_¡©m­.
	`’d
(); ++it)

148 
rv®
 +ğ*
™
->
£cÚd
;

149  (
rv®
);

150 
	}
}

161 
	gShÜeTPCEEnv
::
	$»£t_¡©s
()

163 
	`CRITICAL_SECTION
(
Ï¡_¡©s_cs
, 
_Ï¡_¡©s_mu‹x
);

164 
_Ï¡_¡©s
 = 
	`_g‘_¡©s
();

165 
_num_šv®id_šput
 = 0;

166 
	}
}

177 
	gShÜeTPCEEnv
::
	$´št_throughput
(cÚ¡ 
iQu”›dSF
,

178 cÚ¡ 
iS´—d
,

179 cÚ¡ 
iNumOfTh»ads
,

180 cÚ¡ 
d–ay
,

181 cÚ¡ 
ulÚg_t
 
mioch
,

182 cÚ¡ 
avgıuu§ge
)

184 
	`CRITICAL_SECTION
(
Ï¡_¡©s_cs
, 
_Ï¡_¡©s_mu‹x
);

187 
ShÜeTPCETrxSts
 
cu¼’t_¡©s
 = 
	`_g‘_¡©s
();

190 
cu¼’t_¡©s
 -ğ
_Ï¡_¡©s
;

192 
Œxs_©t
 = 
cu¼’t_¡©s
.
©‹m±ed
.
	`tÙ®
();

193 
Œxs_abt
 = 
cu¼’t_¡©s
.
çed
.
	`tÙ®
();

194 
Œxs_dld
 = 
cu¼’t_¡©s
.
d—dlocked
.
	`tÙ®
();

196 
	`TRACE
Ğ
TRACE_ALWAYS
, "*******\n" \

207 (
iS´—d
 ? "Yes" : "No"),

208 
iNumOfTh»ads
, 
Œxs_©t
, 
Œxs_abt
, 
Œxs_dld
,

209 
d–ay
, 
mioch
/d–ay, 
avgıuu§ge
, 100*avgcpuusage/64,

210 (
Œxs_©t
-
Œxs_abt
-
Œxs_dld
)/
d–ay
,

211 
_num_šv®id_šput
);

212 
	}
}

235 
w_rc_t
 
	gShÜeTPCEEnv
::
	$run_Úe_xù
(
Reque¡
* 
´eque¡
)

238 if(
´eque¡
->
	`ty³
()==
XCT_TPCE_MIX
) {

239 
¿nd
 = (1.0*(
smth»ad_t
::
	`me
()->
	`¿nd
()%10000))/100.0;

240 ià(
¿nd
<0)„and*=-1.0;

241 
´eque¡
->
	`£t_ty³
(
	`¿ndom_xù_ty³
(
¿nd
));

244 
´eque¡
->
	`ty³
()) {

246 
XCT_TPCE_BROKER_VOLUME
:

247  
	`run_brok”_vŞume
(
´eque¡
);

249 
XCT_TPCE_CUSTOMER_POSITION
:

250  
	`run_cu¡om”_pos™iÚ
(
´eque¡
);

252 
XCT_TPCE_MARKET_FEED
:

253  
	`run_m¬k‘_ãed
(
´eque¡
);

255 
XCT_TPCE_MARKET_WATCH
:

256  
	`run_m¬k‘_w©ch
(
´eque¡
);

258 
XCT_TPCE_SECURITY_DETAIL
:

259  
	`run_£cur™y_d‘a
(
´eque¡
);

261 
XCT_TPCE_TRADE_LOOKUP
:

262  
	`run_Œade_lookup
(
´eque¡
);

264 
XCT_TPCE_TRADE_ORDER
:

265  
	`run_Œade_Üd”
(
´eque¡
);

267 
XCT_TPCE_TRADE_RESULT
:

268  
	`run_Œade_»suÉ
(
´eque¡
);

270 
XCT_TPCE_TRADE_STATUS
:

271  
	`run_Œade_¡©us
(
´eque¡
);

273 
XCT_TPCE_TRADE_UPDATE
:

274  
	`run_Œade_upd©e
(
´eque¡
);

276 
XCT_TPCE_DATA_MAINTENANCE
:

277  
	`run_d©a_maš‹Çnû
(
´eque¡
);

279 
XCT_TPCE_TRADE_CLEANUP
:

280  
	`run_Œade_ş—nup
(
´eque¡
);

283 
	`´štf
("************ty³ %d**********\À", 
´eque¡
->
	`ty³
());

284 
	`as£¹
 (0);

286  (
RCOK
);

287 
	}
}

353 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_£ùÜ
(
»p_row_t
& 
¬•row
, 
PSECTOR_ROW
 
»cÜd
)

355 
tu¶e_gu¬d
<
£ùÜ_mª_im¶
> 
	`´
(
_p£ùÜ_mª
);

356 
´
->
_»p
 = &
¬•row
;

358 
´
->
	`£t_v®ue
(0, 
»cÜd
->
SC_ID
);

359 
´
->
	`£t_v®ue
(1, 
»cÜd
->
SC_NAME
);

360 
	`W_DO
(
_p£ùÜ_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

362  
RCOK
;

363 
	}
}

365 
	gShÜeTPCEEnv
::
	$_»ad_£ùÜ
()

367 
boŞ
 
isLa¡
 = 
pG’”©eAndLßd
->
	`isLa¡SeùÜ
();

368 !
isLa¡
) {

369 
PSECTOR_ROW
 
»cÜd
 = 
pG’”©eAndLßd
->
	`g‘SeùÜRow
();

370 
£ùÜBufãr
.
	`­³nd
(
»cÜd
);

371 
isLa¡
ğ
pG’”©eAndLßd
->
	`isLa¡SeùÜ
();

373 
£ùÜBufãr
.
	`£tMÜeToR—d
(
çl£
);

374 
	}
}

377 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_ch¬ge
(
»p_row_t
& 
¬•row
, 
PCHARGE_ROW
 
»cÜd
)

379 
tu¶e_gu¬d
<
ch¬ge_mª_im¶
> 
	`´
(
_pch¬ge_mª
);

380 
´
->
_»p
 = &
¬•row
;

382 
´
->
	`£t_v®ue
(0, 
»cÜd
->
CH_TT_ID
);

383 
´
->
	`£t_v®ue
(1, ()
»cÜd
->
CH_C_TIER
);

384 
´
->
	`£t_v®ue
(2, 
»cÜd
->
CH_CHRG
);

385 
	`W_DO
(
_pch¬ge_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

387  
RCOK
;

388 
	}
}

390 
	gShÜeTPCEEnv
::
	$_»ad_ch¬ge
()

392 
boŞ
 
isLa¡
 = 
pG’”©eAndLßd
->
	`isLa¡Ch¬ge
();

393 !
isLa¡
) {

394 
PCHARGE_ROW
 
»cÜd
 = 
pG’”©eAndLßd
->
	`g‘Ch¬geRow
();

395 
ch¬geBufãr
.
	`­³nd
(
»cÜd
);

396 
isLa¡
ğ
pG’”©eAndLßd
->
	`isLa¡Ch¬ge
();

398 
ch¬geBufãr
.
	`£tMÜeToR—d
(
çl£
);

399 
	}
}

402 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_commissiÚ_¿‹
(
»p_row_t
& 
¬•row
,

403 
PCOMMISSION_RATE_ROW
 
»cÜd
)

405 
tu¶e_gu¬d
<
commissiÚ_¿‹_mª_im¶
> 
	`´
(
_pcommissiÚ_¿‹_mª
);

406 
´
->
_»p
 = &
¬•row
;

408 
´
->
	`£t_v®ue
(0, ()(
»cÜd
->
CR_C_TIER
));

409 
´
->
	`£t_v®ue
(1, 
»cÜd
->
CR_TT_ID
);

410 
´
->
	`£t_v®ue
(2, 
»cÜd
->
CR_EX_ID
);

411 
´
->
	`£t_v®ue
(3, ()(
»cÜd
->
CR_FROM_QTY
));

412 
´
->
	`£t_v®ue
(4, ()(
»cÜd
->
CR_TO_QTY
));

413 
´
->
	`£t_v®ue
(5, 
»cÜd
->
CR_RATE
);

414 
	`W_DO
(
_pcommissiÚ_¿‹_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

416  
RCOK
;

417 
	}
}

419 
	gShÜeTPCEEnv
::
	$_»ad_commissiÚ_¿‹
()

421 
boŞ
 
isLa¡
 = 
pG’”©eAndLßd
->
	`isLa¡CommissiÚR©e
();

422 !
isLa¡
) {

423 
PCOMMISSION_RATE_ROW
 
»cÜd
 = 
pG’”©eAndLßd
->
	`g‘CommissiÚR©eRow
();

424 
commissiÚR©eBufãr
.
	`­³nd
(
»cÜd
);

425 
isLa¡
ğ
pG’”©eAndLßd
->
	`isLa¡CommissiÚR©e
();

427 
commissiÚR©eBufãr
.
	`£tMÜeToR—d
(
çl£
);

428 
	}
}

431 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_exchªge
(
»p_row_t
& 
¬•row
, 
PEXCHANGE_ROW
 
»cÜd
)

433 
tu¶e_gu¬d
<
exchªge_mª_im¶
> 
	`´
(
_³xchªge_mª
);

434 
´
->
_»p
 = &
¬•row
;

436 
´
->
	`£t_v®ue
(0, 
»cÜd
->
EX_ID
);

437 
´
->
	`£t_v®ue
(1, 
»cÜd
->
EX_NAME
);

438 
´
->
	`£t_v®ue
(2, 
»cÜd
->
EX_NUM_SYMB
);

439 
´
->
	`£t_v®ue
(3, 
»cÜd
->
EX_OPEN
);

440 
´
->
	`£t_v®ue
(4, 
»cÜd
->
EX_CLOSE
);

441 
´
->
	`£t_v®ue
(5, 
»cÜd
->
EX_DESC
);

442 
´
->
	`£t_v®ue
(6, 
»cÜd
->
EX_AD_ID
 );

443 
	`W_DO
(
_³xchªge_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

445  
RCOK
;

446 
	}
}

448 
	gShÜeTPCEEnv
::
	$_»ad_exchªge
()

450 
boŞ
 
isLa¡
 = 
pG’”©eAndLßd
->
	`isLa¡Exchªge
();

451 !
isLa¡
) {

452 
	`as£¹
(
‹¡CÁ
<10);

453 
PEXCHANGE_ROW
 
»cÜd
 = 
pG’”©eAndLßd
->
	`g‘ExchªgeRow
();

454 
exchªgeBufãr
.
	`­³nd
(
»cÜd
);

455 
isLa¡
ğ
pG’”©eAndLßd
->
	`isLa¡Exchªge
();

457 
exchªgeBufãr
.
	`£tMÜeToR—d
(
çl£
);

458 
	}
}

461 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_šdu¡ry
(
»p_row_t
& 
¬•row
, 
PINDUSTRY_ROW
 
»cÜd
)

463 
tu¶e_gu¬d
<
šdu¡ry_mª_im¶
> 
	`´
(
_pšdu¡ry_mª
);

464 
´
->
_»p
 = &
¬•row
;

466 
´
->
	`£t_v®ue
(0, 
»cÜd
->
IN_ID
);

467 
´
->
	`£t_v®ue
(1, 
»cÜd
->
IN_NAME
);

468 
´
->
	`£t_v®ue
(2, 
»cÜd
->
IN_SC_ID
);

469 
	`W_DO
(
_pšdu¡ry_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

471  
RCOK
;

472 
	}
}

474 
	gShÜeTPCEEnv
::
	$_»ad_šdu¡ry
()

476 
boŞ
 
isLa¡
 = 
pG’”©eAndLßd
->
	`isLa¡Indu¡ry
();

477 !
isLa¡
) {

478 
PINDUSTRY_ROW
 
»cÜd
 = 
pG’”©eAndLßd
->
	`g‘Indu¡ryRow
();

479 
šdu¡ryBufãr
.
	`­³nd
(
»cÜd
);

480 
isLa¡
ğ
pG’”©eAndLßd
->
	`isLa¡Indu¡ry
();

482 
šdu¡ryBufãr
.
	`£tMÜeToR—d
(
çl£
);

483 
	}
}

486 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_¡©us_ty³
(
»p_row_t
& 
¬•row
,

487 
PSTATUS_TYPE_ROW
 
»cÜd
)

489 
tu¶e_gu¬d
<
¡©us_ty³_mª_im¶
> 
	`´
(
_p¡©us_ty³_mª
);

490 
´
->
_»p
 = &
¬•row
;

492 
´
->
	`£t_v®ue
(0, 
»cÜd
->
ST_ID
);

493 
´
->
	`£t_v®ue
(1, 
»cÜd
->
ST_NAME
);

494 
	`W_DO
(
_p¡©us_ty³_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

496  
RCOK
;

497 
	}
}

499 
	gShÜeTPCEEnv
::
	$_»ad_¡©us_ty³
()

501 
boŞ
 
isLa¡
 = 
pG’”©eAndLßd
->
	`isLa¡StusTy³
();

502 !
isLa¡
){

503 
PSTATUS_TYPE_ROW
 
»cÜd
 = 
pG’”©eAndLßd
->
	`g‘StusTy³Row
();

504 
¡©usTy³Bufãr
.
	`­³nd
(
»cÜd
);

505 
isLa¡
ğ
pG’”©eAndLßd
->
	`isLa¡StusTy³
();

507 
¡©usTy³Bufãr
.
	`£tMÜeToR—d
(
çl£
);

508 
	}
}

511 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_x¿‹
(
»p_row_t
& 
¬•row
, 
PTAXRATE_ROW
 
»cÜd
)

513 
tu¶e_gu¬d
<
x¿‹_mª_im¶
> 
	`´
(
_±ax¿‹_mª
);

514 
´
->
_»p
 = &
¬•row
;

516 
´
->
	`£t_v®ue
(0, 
»cÜd
->
TX_ID
);

517 
´
->
	`£t_v®ue
(1, 
»cÜd
->
TX_NAME
);

518 
´
->
	`£t_v®ue
(2, (
»cÜd
->
TX_RATE
));

519 
	`W_DO
(
_±ax¿‹_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

521  
RCOK
;

522 
	}
}

524 
	gShÜeTPCEEnv
::
	$_»ad_x¿‹
()

526 
boŞ
 
hasNext
;

528 
PTAXRATE_ROW
 
»cÜd
 = 
pG’”©eAndLßd
->
	`g‘Tax¿‹Row
();

529 
x¿‹Bufãr
.
	`­³nd
(
»cÜd
);

530 
hasNext
ğ
pG’”©eAndLßd
->
	`hasNextTax¿‹
();

531 } 
hasNext
);

532 
x¿‹Bufãr
.
	`£tMÜeToR—d
(
çl£
);

533 
	}
}

536 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_Œade_ty³
(
»p_row_t
& 
¬•row
,

537 
PTRADE_TYPE_ROW
 
»cÜd
)

539 
tu¶e_gu¬d
<
Œade_ty³_mª_im¶
> 
	`´
(
_±¿de_ty³_mª
);

540 
´
->
_»p
 = &
¬•row
;

542 
´
->
	`£t_v®ue
(0, 
»cÜd
->
TT_ID
);

543 
´
->
	`£t_v®ue
(1, 
»cÜd
->
TT_NAME
);

544 
´
->
	`£t_v®ue
(2, (
boŞ
)
»cÜd
->
TT_IS_SELL
);

545 
´
->
	`£t_v®ue
(3, (
boŞ
)
»cÜd
->
TT_IS_MRKT
);

546 
	`W_DO
(
_±¿de_ty³_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

548  
RCOK
;

549 
	}
}

551 
	gShÜeTPCEEnv
::
	$_»ad_Œade_ty³
()

553 
boŞ
 
isLa¡
 = 
pG’”©eAndLßd
->
	`isLa¡T¿deTy³
();

554 !
isLa¡
) {

555 
PTRADE_TYPE_ROW
 
»cÜd
 = 
pG’”©eAndLßd
->
	`g‘T¿deTy³Row
();

556 
ŒadeTy³Bufãr
.
	`­³nd
(
»cÜd
);

557 
isLa¡
ğ
pG’”©eAndLßd
->
	`isLa¡T¿deTy³
();

559 
ŒadeTy³Bufãr
.
	`£tMÜeToR—d
(
çl£
);

560 
	}
}

563 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_z_code
(
»p_row_t
& 
¬•row
, 
PZIP_CODE_ROW
 
»cÜd
)

565 
tu¶e_gu¬d
<
z_code_mª_im¶
> 
	`´
(
_pz_code_mª
);

566 
´
->
_»p
 = &
¬•row
;

568 
´
->
	`£t_v®ue
(0, 
»cÜd
->
ZC_CODE
);

569 
´
->
	`£t_v®ue
(1, 
»cÜd
->
ZC_TOWN
);

570 
´
->
	`£t_v®ue
(2, 
»cÜd
->
ZC_DIV
);

571 
	`W_DO
(
_pz_code_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

573  
RCOK
;

574 
	}
}

576 
	gShÜeTPCEEnv
::
	$_»ad_z_code
()

578 
boŞ
 
hasNext
 = 
pG’”©eAndLßd
->
	`hasNextZCode
();

579 
hasNext
) {

580 
PZIP_CODE_ROW
 
»cÜd
 = 
pG’”©eAndLßd
->
	`g‘ZCodeRow
();

581 
zCodeBufãr
.
	`­³nd
(
»cÜd
);

582 
hasNext
ğ
pG’”©eAndLßd
->
	`hasNextZCode
();

584 
zCodeBufãr
.
	`£tMÜeToR—d
(
çl£
);

585 
	}
}

588 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_cu¡om”
(
»p_row_t
& 
¬•row
, 
PCUSTOMER_ROW
 
»cÜd
)

590 
tu¶e_gu¬d
<
cu¡om”_mª_im¶
> 
	`´
(
_pcu¡om”_mª
);

591 
´
->
_»p
 = &
¬•row
;

593 
´
->
	`£t_v®ue
(0, 
»cÜd
->
C_ID
);

594 
´
->
	`£t_v®ue
(1, 
»cÜd
->
C_TAX_ID
);

595 
´
->
	`£t_v®ue
(2, 
»cÜd
->
C_ST_ID
);

596 
´
->
	`£t_v®ue
(3, 
»cÜd
->
C_L_NAME
);

597 
´
->
	`£t_v®ue
(4, 
»cÜd
->
C_F_NAME
);

598 
´
->
	`£t_v®ue
(5, 
»cÜd
->
C_M_NAME
);

599 
xxz
[2];

600 
xxz
[0]=
»cÜd
->
C_GNDR
;

601 
xxz
[1]='\0';

602 
´
->
	`£t_v®ue
(6, 
xxz
);

603 
´
->
	`£t_v®ue
(7, ()
»cÜd
->
C_TIER
);

604 
´
->
	`£t_v®ue
(8, (è
	`Eg’TimeToTimeT
(
»cÜd
->
C_DOB
));

605 
´
->
	`£t_v®ue
(9, 
»cÜd
->
C_AD_ID
);

606 
´
->
	`£t_v®ue
(10, 
»cÜd
->
C_CTRY_1
);

607 
´
->
	`£t_v®ue
(11, 
»cÜd
->
C_AREA_1
);

608 
´
->
	`£t_v®ue
(12, 
»cÜd
->
C_LOCAL_1
);

609 
´
->
	`£t_v®ue
(13, 
»cÜd
->
C_EXT_1
);

610 
´
->
	`£t_v®ue
(14, 
»cÜd
->
C_CTRY_2
);

611 
´
->
	`£t_v®ue
(15, 
»cÜd
->
C_AREA_2
);

612 
´
->
	`£t_v®ue
(16, 
»cÜd
->
C_LOCAL_2
);

613 
´
->
	`£t_v®ue
(17, 
»cÜd
->
C_EXT_2
);

614 
´
->
	`£t_v®ue
(18, 
»cÜd
->
C_CTRY_3
);

615 
´
->
	`£t_v®ue
(19, 
»cÜd
->
C_AREA_3
);

616 
´
->
	`£t_v®ue
(20, 
»cÜd
->
C_LOCAL_3
);

617 
´
->
	`£t_v®ue
(21, 
»cÜd
->
C_EXT_3
);

618 
´
->
	`£t_v®ue
(22, 
»cÜd
->
C_EMAIL_1
);

619 
´
->
	`£t_v®ue
(23, 
»cÜd
->
C_EMAIL_2
);

620 
	`W_DO
(
_pcu¡om”_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

622  
RCOK
;

623 
	}
}

625 
	gShÜeTPCEEnv
::
	$_»ad_cu¡om”
()

627 
boŞ
 
hasNext
;

629 
hasNext
ğ
pG’”©eAndLßd
->
	`hasNextCu¡om”
();

630 
PCUSTOMER_ROW
 
»cÜd
 = 
pG’”©eAndLßd
->
	`g‘Cu¡om”Row
();

631 
cu¡om”Bufãr
.
	`­³nd
(
»cÜd
);

632 } (
hasNext
 && 
cu¡om”Bufãr
.
	`hasS·û
()));

633 
cu¡om”Bufãr
.
	`£tMÜeToR—d
(
hasNext
);

634 
	}
}

637 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_cu¡om”_x¿‹
(
»p_row_t
& 
¬•row
,

638 
PCUSTOMER_TAXRATE_ROW
 
»cÜd
)

640 
tu¶e_gu¬d
<
cu¡om”_x¿‹_mª_im¶
> 
	`´
(
_pcu¡om”_x¿‹_mª
);

641 
´
->
_»p
 = &
¬•row
;

643 
´
->
	`£t_v®ue
(0, 
»cÜd
->
CX_TX_ID
);

644 
´
->
	`£t_v®ue
(1, 
»cÜd
->
CX_C_ID
);

645 
	`W_DO
(
_pcu¡om”_x¿‹_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

647  
RCOK
;

648 
	}
}

650 
	gShÜeTPCEEnv
::
	$_»ad_cu¡om”_x¿‹
()

652 
boŞ
 
hasNext
;

653 
x¿‹s
=
pG’”©eAndLßd
->
	`g‘Tax¿‹sCouÁ
();

655 
hasNext
ğ
pG’”©eAndLßd
->
	`hasNextCu¡om”Tax¿‹
();

656 
i
=0; i<
x¿‹s
; i++) {

657 
PCUSTOMER_TAXRATE_ROW
 
»cÜd
 =

658 
pG’”©eAndLßd
->
	`g‘Cu¡om”Tax¿‹Row
(
i
);

659 
cu¡om”Tax¿‹Bufãr
.
	`­³nd
(
»cÜd
);

661 } (
hasNext
 && 
cu¡om”Tax¿‹Bufãr
.
	`hasS·û
()));

662 
cu¡om”Tax¿‹Bufãr
.
	`£tMÜeToR—d
(
hasNext
);

663 
	}
}

666 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_cu¡om”_accouÁ
(
»p_row_t
& 
¬•row
,

667 
PCUSTOMER_ACCOUNT_ROW
 
»cÜd
)

669 
tu¶e_gu¬d
<
cu¡om”_accouÁ_mª_im¶
> 
	`´
(
_pcu¡om”_accouÁ_mª
);

670 
´
->
_»p
 = &
¬•row
;

672 
´
->
	`£t_v®ue
(0, 
»cÜd
->
CA_ID
);

673 
´
->
	`£t_v®ue
(1, 
»cÜd
->
CA_B_ID
);

674 
´
->
	`£t_v®ue
(2, 
»cÜd
->
CA_C_ID
);

675 
´
->
	`£t_v®ue
(3, 
»cÜd
->
CA_NAME
);

676 
´
->
	`£t_v®ue
(4, ()(
»cÜd
->
CA_TAX_ST
));

677 
´
->
	`£t_v®ue
(5, 
»cÜd
->
CA_BAL
);

678 
	`W_DO
(
_pcu¡om”_accouÁ_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

680  
RCOK
;

681 
	}
}

684 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_accouÁ_³rmissiÚ
(
»p_row_t
& 
¬•row
,

685 
PACCOUNT_PERMISSION_ROW
 
»cÜd
)

687 
tu¶e_gu¬d
<
accouÁ_³rmissiÚ_mª_im¶
> 
	`´
(
_·ccouÁ_³rmissiÚ_mª
);

688 
´
->
_»p
 = &
¬•row
;

690 
´
->
	`£t_v®ue
(0, 
»cÜd
->
AP_CA_ID
);

691 
´
->
	`£t_v®ue
(1, 
»cÜd
->
AP_ACL
);

692 
´
->
	`£t_v®ue
(2, 
»cÜd
->
AP_TAX_ID
);

693 
´
->
	`£t_v®ue
(3, 
»cÜd
->
AP_L_NAME
);

694 
´
->
	`£t_v®ue
(4, 
»cÜd
->
AP_F_NAME
);

695 
	`W_DO
(
_·ccouÁ_³rmissiÚ_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

697  
RCOK
;

698 
	}
}

700 
	gShÜeTPCEEnv
::
	$_»ad_ÿ_ªd_­
()

702 
boŞ
 
hasNext
;

704 
hasNext
ğ
pG’”©eAndLßd
->
	`hasNextCu¡om”AccouÁ
();

705 
PCUSTOMER_ACCOUNT_ROW
 
»cÜd
 = 
pG’”©eAndLßd
->
	`g‘Cu¡om”AccouÁRow
();

706 
cu¡om”AccouÁBufãr
.
	`­³nd
(
»cÜd
);

707 
³rms
 = 
pG’”©eAndLßd
->
	`P”missiÚsP”Cu¡om”
();

708 
i
=0; i<
³rms
; i++) {

709 
PACCOUNT_PERMISSION_ROW
 
row
 =

710 
pG’”©eAndLßd
->
	`g‘AccouÁP”missiÚRow
(
i
);

711 
accouÁP”missiÚBufãr
.
	`­³nd
(
row
);

713 } (
hasNext
 && 
cu¡om”AccouÁBufãr
.
	`hasS·û
()));

714 
cu¡om”AccouÁBufãr
.
	`£tMÜeToR—d
(
hasNext
);

715 
	}
}

718 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_add»ss
(
»p_row_t
& 
¬•row
, 
PADDRESS_ROW
 
»cÜd
)

720 
tu¶e_gu¬d
<
add»ss_mª_im¶
> 
	`´
(
_·dd»ss_mª
);

721 
´
->
_»p
 = &
¬•row
;

723 
´
->
	`£t_v®ue
(0, 
»cÜd
->
AD_ID
);

724 
´
->
	`£t_v®ue
(1, 
»cÜd
->
AD_LINE1
);

725 
´
->
	`£t_v®ue
(2, 
»cÜd
->
AD_LINE2
);

726 
´
->
	`£t_v®ue
(3, 
»cÜd
->
AD_ZC_CODE
);

727 
´
->
	`£t_v®ue
(4, 
»cÜd
->
AD_CTRY
);

728 
	`W_DO
(
_·dd»ss_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

730  
RCOK
;

731 
	}
}

733 
	gShÜeTPCEEnv
::
	$_»ad_add»ss
()

735 
boŞ
 
hasNext
;

737 
hasNext
ğ
pG’”©eAndLßd
->
	`hasNextAdd»ss
();

738 
PADDRESS_ROW
 
»cÜd
 = 
pG’”©eAndLßd
->
	`g‘Add»ssRow
();

739 
add»ssBufãr
.
	`­³nd
(
»cÜd
);

740 } (
hasNext
 && 
add»ssBufãr
.
	`hasS·û
()));

741 
add»ssBufãr
.
	`£tMÜeToR—d
(
hasNext
);

742 
	}
}

745 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_w©ch_li¡
(
»p_row_t
& 
¬•row
,

746 
PWATCH_LIST_ROW
 
»cÜd
)

748 
tu¶e_gu¬d
<
w©ch_li¡_mª_im¶
> 
	`´
(
_pw©ch_li¡_mª
);

749 
´
->
_»p
 = &
¬•row
;

751 
´
->
	`£t_v®ue
(0, 
»cÜd
->
WL_ID
);

752 
´
->
	`£t_v®ue
(1, 
»cÜd
->
WL_C_ID
);

753 
	`W_DO
(
_pw©ch_li¡_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

755  
RCOK
;

756 
	}
}

759 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_w©ch_™em
(
»p_row_t
& 
¬•row
,

760 
PWATCH_ITEM_ROW
 
»cÜd
)

762 
tu¶e_gu¬d
<
w©ch_™em_mª_im¶
> 
	`´
(
_pw©ch_™em_mª
);

763 
´
->
_»p
 = &
¬•row
;

765 
´
->
	`£t_v®ue
(0, 
»cÜd
->
WI_WL_ID
);

766 
´
->
	`£t_v®ue
(1, 
»cÜd
->
WI_S_SYMB
);

767 
	`W_DO
(
_pw©ch_™em_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

769  
RCOK
;

770 
	}
}

772 
	gShÜeTPCEEnv
::
	$_»ad_wl_ªd_wi
()

774 
boŞ
 
hasNext
;

776 
hasNext
ğ
pG’”©eAndLßd
->
	`hasNextW©chLi¡
();

777 
PWATCH_LIST_ROW
 
»cÜd
 = 
pG’”©eAndLßd
->
	`g‘W©chLi¡Row
();

778 
w©chLi¡Bufãr
.
	`­³nd
(
»cÜd
);

779 
™ems
 = 
pG’”©eAndLßd
->
	`I‹msP”W©chLi¡
();

780 
i
=0; i<
™ems
; ++i) {

781 
PWATCH_ITEM_ROW
 
row
 = 
pG’”©eAndLßd
->
	`g‘W©chI‹mRow
(
i
);

782 
w©chI‹mBufãr
.
	`­³nd
(
row
);

784 } 
hasNext
 && 
w©chLi¡Bufãr
.
	`hasS·û
());

785 
w©chLi¡Bufãr
.
	`£tMÜeToR—d
(
hasNext
);

786 
	}
}

789 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_com·ny
(
»p_row_t
& 
¬•row
, 
PCOMPANY_ROW
 
»cÜd
)

791 
tu¶e_gu¬d
<
com·ny_mª_im¶
> 
	`´
(
_pcom·ny_mª
);

792 
´
->
_»p
 = &
¬•row
;

794 
´
->
	`£t_v®ue
(0, 
»cÜd
->
CO_ID
);

795 
´
->
	`£t_v®ue
(1, 
»cÜd
->
CO_ST_ID
);

796 
´
->
	`£t_v®ue
(2, 
»cÜd
->
CO_NAME
);

797 
´
->
	`£t_v®ue
(3, 
»cÜd
->
CO_IN_ID
);

798 
´
->
	`£t_v®ue
(4, 
»cÜd
->
CO_SP_RATE
);

799 
´
->
	`£t_v®ue
(5, 
»cÜd
->
CO_CEO
);

800 
´
->
	`£t_v®ue
(6, 
»cÜd
->
CO_AD_ID
);

801 
´
->
	`£t_v®ue
(7, 
»cÜd
->
CO_DESC
);

802 
´
->
	`£t_v®ue
(8, 
	`Eg’TimeToTimeT
(
»cÜd
->
CO_OPEN_DATE
));

803 
	`W_DO
(
_pcom·ny_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

805  
RCOK
;

806 
	}
}

808 
	gShÜeTPCEEnv
::
	$_»ad_com·ny
()

810 
boŞ
 
hasNext
;

812 
hasNext
ğ
pG’”©eAndLßd
->
	`hasNextCom·ny
();

813 
PCOMPANY_ROW
 
»cÜd
 = 
pG’”©eAndLßd
->
	`g‘Com·nyRow
();

814 
com·nyBufãr
.
	`­³nd
(
»cÜd
);

815 } (
hasNext
 && 
com·nyBufãr
.
	`hasS·û
()));

816 
com·nyBufãr
.
	`£tMÜeToR—d
(
hasNext
);

817 
	}
}

820 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_com·ny_com³t™Ü
(
»p_row_t
& 
¬•row
,

821 
PCOMPANY_COMPETITOR_ROW
 
»cÜd
)

823 
tu¶e_gu¬d
<
com·ny_com³t™Ü_mª_im¶
> 
	`´
(
_pcom·ny_com³t™Ü_mª
);

824 
´
->
_»p
 = &
¬•row
;

826 
´
->
	`£t_v®ue
(0, (
»cÜd
->
CP_CO_ID
));

827 
´
->
	`£t_v®ue
(1, 
»cÜd
->
CP_COMP_CO_ID
);

828 
´
->
	`£t_v®ue
(2, 
»cÜd
->
CP_IN_ID
);

829 
	`W_DO
(
_pcom·ny_com³t™Ü_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

831  
RCOK
;

832 
	}
}

834 
	gShÜeTPCEEnv
::
	$_»ad_com·ny_com³t™Ü
()

836 
boŞ
 
hasNext
;

838 
hasNext
ğ
pG’”©eAndLßd
->
	`hasNextCom·nyCom³t™Ü
();

839 
PCOMPANY_COMPETITOR_ROW
 
»cÜd
 =

840 
pG’”©eAndLßd
->
	`g‘Com·nyCom³t™ÜRow
();

841 
com·nyCom³t™ÜBufãr
.
	`­³nd
(
»cÜd
);

842 } (
hasNext
 && 
com·nyCom³t™ÜBufãr
.
	`hasS·û
()));

843 
com·nyCom³t™ÜBufãr
.
	`£tMÜeToR—d
(
hasNext
);

844 
	}
}

847 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_day_m¬k‘
(
»p_row_t
& 
¬•row
,

848 
PDAILY_MARKET_ROW
 
»cÜd
)

850 
tu¶e_gu¬d
<
day_m¬k‘_mª_im¶
> 
	`´
(
_pday_m¬k‘_mª
);

851 
´
->
_»p
 = &
¬•row
;

853 
´
->
	`£t_v®ue
(0, 
	`Eg’TimeToTimeT
(
»cÜd
->
DM_DATE
));

854 
´
->
	`£t_v®ue
(1, 
»cÜd
->
DM_S_SYMB
);

855 
´
->
	`£t_v®ue
(2, 
»cÜd
->
DM_CLOSE
);

856 
´
->
	`£t_v®ue
(3, 
»cÜd
->
DM_HIGH
);

857 
´
->
	`£t_v®ue
(4, 
»cÜd
->
DM_LOW
);

858 
´
->
	`£t_v®ue
(5, ()
»cÜd
->
DM_VOL
);

859 
	`W_DO
(
_pday_m¬k‘_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

861  
RCOK
;

862 
	}
}

864 
	gShÜeTPCEEnv
::
	$_»ad_day_m¬k‘
()

866 
boŞ
 
hasNext
;

868 
hasNext
ğ
pG’”©eAndLßd
->
	`hasNextDayM¬k‘
();

869 
PDAILY_MARKET_ROW
 
»cÜd
 = 
pG’”©eAndLßd
->
	`g‘DayM¬k‘Row
();

870 
dayM¬k‘Bufãr
.
	`­³nd
(
»cÜd
);

871 } (
hasNext
 && 
dayM¬k‘Bufãr
.
	`hasS·û
()));

872 
dayM¬k‘Bufãr
.
	`£tMÜeToR—d
(
hasNext
);

873 
	}
}

876 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_fšªcŸl
(
»p_row_t
& 
¬•row
, 
PFINANCIAL_ROW
 
»cÜd
)

878 
tu¶e_gu¬d
<
fšªcŸl_mª_im¶
> 
	`´
(
_pfšªcŸl_mª
);

879 
´
->
_»p
 = &
¬•row
;

881 
´
->
	`£t_v®ue
(0, 
»cÜd
->
FI_CO_ID
);

882 
´
->
	`£t_v®ue
(1, 
»cÜd
->
FI_YEAR
);

883 
´
->
	`£t_v®ue
(2, ()
»cÜd
->
FI_QTR
);

884 
´
->
	`£t_v®ue
(3, 
	`Eg’TimeToTimeT
(
»cÜd
->
FI_QTR_START_DATE
));

885 
´
->
	`£t_v®ue
(4, 
»cÜd
->
FI_REVENUE
);

886 
´
->
	`£t_v®ue
(5, 
»cÜd
->
FI_NET_EARN
);

887 
´
->
	`£t_v®ue
(6, 
»cÜd
->
FI_BASIC_EPS
);

888 
´
->
	`£t_v®ue
(7, 
»cÜd
->
FI_DILUT_EPS
);

889 
´
->
	`£t_v®ue
(8, 
»cÜd
->
FI_MARGIN
);

890 
´
->
	`£t_v®ue
(9, 
»cÜd
->
FI_INVENTORY
);

891 
´
->
	`£t_v®ue
(10, 
»cÜd
->
FI_ASSETS
);

892 
´
->
	`£t_v®ue
(11, 
»cÜd
->
FI_LIABILITY
);

893 
´
->
	`£t_v®ue
(12, 
»cÜd
->
FI_OUT_BASIC
);

894 
´
->
	`£t_v®ue
(13, 
»cÜd
->
FI_OUT_DILUT
);

895 
	`W_DO
(
_pfšªcŸl_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

897  
RCOK
;

898 
	}
}

900 
	gShÜeTPCEEnv
::
	$_»ad_fšªcŸl
()

902 
boŞ
 
hasNext
;

904 
hasNext
ğ
pG’”©eAndLßd
->
	`hasNextFšªcŸl
();

905 
PFINANCIAL_ROW
 
»cÜd
 = 
pG’”©eAndLßd
->
	`g‘FšªcŸlRow
();

906 
fšªcŸlBufãr
.
	`­³nd
(
»cÜd
);

907 } (
hasNext
 && 
fšªcŸlBufãr
.
	`hasS·û
()));

908 
fšªcŸlBufãr
.
	`£tMÜeToR—d
(
hasNext
);

909 
	}
}

912 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_Ï¡_Œade
(
»p_row_t
& 
¬•row
,

913 
PLAST_TRADE_ROW
 
»cÜd
)

915 
tu¶e_gu¬d
<
Ï¡_Œade_mª_im¶
> 
	`´
(
_¶a¡_Œade_mª
);

916 
´
->
_»p
 = &
¬•row
;

918 
´
->
	`£t_v®ue
(0, 
»cÜd
->
LT_S_SYMB
);

919 
´
->
	`£t_v®ue
(1, 
	`Eg’TimeToTimeT
(
»cÜd
->
LT_DTS
));

920 
´
->
	`£t_v®ue
(2, 
»cÜd
->
LT_PRICE
);

921 
´
->
	`£t_v®ue
(3, 
»cÜd
->
LT_OPEN_PRICE
);

922 
´
->
	`£t_v®ue
(4, (è
»cÜd
->
LT_VOL
);

923 
	`W_DO
(
_¶a¡_Œade_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

925  
RCOK
;

926 
	}
}

928 
	gShÜeTPCEEnv
::
	$_»ad_Ï¡_Œade
()

930 
boŞ
 
hasNext
;

932 
hasNext
ğ
pG’”©eAndLßd
->
	`hasNextLa¡T¿de
();

933 
PLAST_TRADE_ROW
 
»cÜd
 = 
pG’”©eAndLßd
->
	`g‘La¡T¿deRow
();

934 
Ï¡T¿deBufãr
.
	`­³nd
(
»cÜd
);

935 } (
hasNext
 && 
Ï¡T¿deBufãr
.
	`hasS·û
()));

936 
Ï¡T¿deBufãr
.
	`£tMÜeToR—d
(
hasNext
);

937 
	}
}

940 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_Ãws_™em
(
»p_row_t
& 
¬•row
, 
PNEWS_ITEM_ROW
 
»cÜd
)

942 
tu¶e_gu¬d
<
Ãws_™em_mª_im¶
> 
	`´
(
_²ews_™em_mª
);

943 
´
->
_»p
 = &
¬•row
;

945 
´
->
	`£t_v®ue
(0, 
»cÜd
->
NI_ID
);

946 
´
->
	`£t_v®ue
(1, 
»cÜd
->
NI_HEADLINE
);

947 
´
->
	`£t_v®ue
(2, 
»cÜd
->
NI_SUMMARY
);

948 
ni
[
max_Ãws_™em_size
+1];‚i[max_news_item_size] = '\0';

949 
	`memıy
(
ni
,
»cÜd
->
NI_ITEM
,
max_Ãws_™em_size
);

950 
´
->
	`£t_v®ue
(3, 
ni
);

951 
´
->
	`£t_v®ue
(4, 
	`Eg’TimeToTimeT
(
»cÜd
->
NI_DTS
));

952 
´
->
	`£t_v®ue
(5, 
»cÜd
->
NI_SOURCE
);

953 
´
->
	`£t_v®ue
(6, 
»cÜd
->
NI_AUTHOR
);

954 
	`W_DO
(
_²ews_™em_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

956  
RCOK
;

957 
	}
}

960 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_Ãws_x»f
(
»p_row_t
& 
¬•row
, 
PNEWS_XREF_ROW
 
»cÜd
)

962 
tu¶e_gu¬d
<
Ãws_x»f_mª_im¶
> 
	`´
(
_²ews_x»f_mª
);

963 
´
->
_»p
 = &
¬•row
;

965 
´
->
	`£t_v®ue
(0, 
»cÜd
->
NX_NI_ID
);

966 
´
->
	`£t_v®ue
(1, 
»cÜd
->
NX_CO_ID
);

967 
	`W_DO
(
_²ews_x»f_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

969  
RCOK
;

970 
	}
}

972 
	gShÜeTPCEEnv
::
	$_»ad_ni_ªd_nx
()

974 
boŞ
 
hasNext
;

976 
hasNext
ğ
pG’”©eAndLßd
->
	`hasNextNewsI‹mAndNewsXRef
();

977 
PNEWS_ITEM_ROW
 
»cÜd1
 = 
pG’”©eAndLßd
->
	`g‘NewsI‹mRow
();

978 
PNEWS_XREF_ROW
 
»cÜd2
 = 
pG’”©eAndLßd
->
	`g‘NewsXRefRow
();

979 
ÃwsI‹mBufãr
.
	`­³nd
(
»cÜd1
);

980 
ÃwsXRefBufãr
.
	`­³nd
(
»cÜd2
);

981 } (
hasNext
 && 
ÃwsI‹mBufãr
.
	`hasS·û
()));

982 
ÃwsI‹mBufãr
.
	`£tMÜeToR—d
(
hasNext
);

983 
ÃwsXRefBufãr
.
	`£tMÜeToR—d
(
hasNext
);

984 
	}
}

987 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_£cur™y
(
»p_row_t
& 
¬•row
, 
PSECURITY_ROW
 
»cÜd
)

989 
tu¶e_gu¬d
<
£cur™y_mª_im¶
> 
	`´
(
_p£cur™y_mª
);

990 
´
->
_»p
 = &
¬•row
;

992 
´
->
	`£t_v®ue
(0, 
»cÜd
->
S_SYMB
);

993 
´
->
	`£t_v®ue
(1, 
»cÜd
->
S_ISSUE
);

994 
´
->
	`£t_v®ue
(2, 
»cÜd
->
S_ST_ID
);

995 
´
->
	`£t_v®ue
(3, 
»cÜd
->
S_NAME
);

996 
´
->
	`£t_v®ue
(4, 
»cÜd
->
S_EX_ID
);

997 
´
->
	`£t_v®ue
(5, 
»cÜd
->
S_CO_ID
);

998 
´
->
	`£t_v®ue
(6, 
»cÜd
->
S_NUM_OUT
);

999 
´
->
	`£t_v®ue
(7, 
	`Eg’TimeToTimeT
(
»cÜd
->
S_START_DATE
));

1000 
´
->
	`£t_v®ue
(8, 
	`Eg’TimeToTimeT
(
»cÜd
->
S_EXCH_DATE
));

1001 
´
->
	`£t_v®ue
(9, 
»cÜd
->
S_PE
);

1002 
´
->
	`£t_v®ue
(10, (
»cÜd
->
S_52WK_HIGH
));

1003 
´
->
	`£t_v®ue
(11, 
	`Eg’TimeToTimeT
(
»cÜd
->
S_52WK_HIGH_DATE
));

1004 
´
->
	`£t_v®ue
(12, (
»cÜd
->
S_52WK_LOW
));

1005 
´
->
	`£t_v®ue
(13, 
	`Eg’TimeToTimeT
(
»cÜd
->
S_52WK_LOW_DATE
));

1006 
´
->
	`£t_v®ue
(14, (
»cÜd
->
S_DIVIDEND
));

1007 
´
->
	`£t_v®ue
(15, (
»cÜd
->
S_YIELD
));

1008 #ifdeà
COMPILE_FLAT_FILE_LOAD


1009 
	`årštf
(
fs£c
, "%s|%s|%s|%s\n",

1010 
»cÜd
->
S_SYMB
,„ecÜd->
S_ISSUE
,„ecÜd->
S_ST_ID
,„ecÜd->
S_NAME
);

1012 
	`W_DO
(
_p£cur™y_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

1014  
RCOK
;

1015 
	}
}

1017 
	gShÜeTPCEEnv
::
	$_»ad_£cur™y
()

1019 
boŞ
 
hasNext
;

1021 
hasNext
ğ
pG’”©eAndLßd
->
	`hasNextSecur™y
();

1022 
PSECURITY_ROW
 
»cÜd
 = 
pG’”©eAndLßd
->
	`g‘Secur™yRow
();

1023 
£cur™yBufãr
.
	`­³nd
(
»cÜd
);

1024 } (
hasNext
 && 
£cur™yBufãr
.
	`hasS·û
()));

1025 
£cur™yBufãr
.
	`£tMÜeToR—d
(
hasNext
);

1026 
	}
}

1029 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_Œade
(
»p_row_t
& 
¬•row
, 
PTRADE_ROW
 
»cÜd
)

1031 
tu¶e_gu¬d
<
Œade_mª_im¶
> 
	`´
(
_±¿de_mª
);

1032 
´
->
_»p
 = &
¬•row
;

1034 
´
->
	`£t_v®ue
(0, 
»cÜd
->
T_ID
);

1035 
´
->
	`£t_v®ue
(1, 
	`Eg’TimeToTimeT
(
»cÜd
->
T_DTS
));

1036 
´
->
	`£t_v®ue
(2, 
»cÜd
->
T_ST_ID
);

1037 
´
->
	`£t_v®ue
(3, 
»cÜd
->
T_TT_ID
);

1038 
´
->
	`£t_v®ue
(4, (
boŞ
)
»cÜd
->
T_IS_CASH
);

1039 
´
->
	`£t_v®ue
(5, 
»cÜd
->
T_S_SYMB
);

1040 
´
->
	`£t_v®ue
(6, 
»cÜd
->
T_QTY
);

1041 
´
->
	`£t_v®ue
(7, (
»cÜd
->
T_BID_PRICE
));

1042 
´
->
	`£t_v®ue
(8, 
»cÜd
->
T_CA_ID
);

1043 
´
->
	`£t_v®ue
(9, 
»cÜd
->
T_EXEC_NAME
);

1044 
´
->
	`£t_v®ue
(10, (
»cÜd
->
T_TRADE_PRICE
));

1045 
´
->
	`£t_v®ue
(11, (
»cÜd
->
T_CHRG
));

1046 
´
->
	`£t_v®ue
(12, (
»cÜd
->
T_COMM
));

1047 
´
->
	`£t_v®ue
(13, (
»cÜd
->
T_TAX
));

1048 
´
->
	`£t_v®ue
(14, (
boŞ
)
»cÜd
->
T_LIFO
);

1049 
	`W_DO
(
_±¿de_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

1051  
RCOK
;

1052 
	}
}

1055 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_Œade_hi¡Üy
(
»p_row_t
& 
¬•row
,

1056 
PTRADE_HISTORY_ROW
 
»cÜd
)

1058 
tu¶e_gu¬d
<
Œade_hi¡Üy_mª_im¶
> 
	`´
(
_±¿de_hi¡Üy_mª
);

1059 
´
->
_»p
 = &
¬•row
;

1061 
´
->
	`£t_v®ue
(0, 
»cÜd
->
TH_T_ID
);

1062 
´
->
	`£t_v®ue
(1, 
	`Eg’TimeToTimeT
(
»cÜd
->
TH_DTS
));

1063 
´
->
	`£t_v®ue
(2, 
»cÜd
->
TH_ST_ID
);

1064 
	`W_DO
(
_±¿de_hi¡Üy_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

1066  
RCOK
;

1067 
	}
}

1070 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_£‰Ëm’t
(
»p_row_t
& 
¬•row
,

1071 
PSETTLEMENT_ROW
 
»cÜd
)

1073 
tu¶e_gu¬d
<
£‰Ëm’t_mª_im¶
> 
	`´
(
_p£‰Ëm’t_mª
);

1074 
´
->
_»p
 = &
¬•row
;

1076 
´
->
	`£t_v®ue
(0, 
»cÜd
->
SE_T_ID
);

1077 
´
->
	`£t_v®ue
(1, 
»cÜd
->
SE_CASH_TYPE
);

1078 
´
->
	`£t_v®ue
(2, 
	`Eg’TimeToTimeT
(
»cÜd
->
SE_CASH_DUE_DATE
));

1079 
´
->
	`£t_v®ue
(3, 
»cÜd
->
SE_AMT
);

1080 
	`W_DO
(
_p£‰Ëm’t_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

1082  
RCOK
;

1083 
	}
}

1086 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_ÿsh_Œª§ùiÚ
(
»p_row_t
& 
¬•row
,

1087 
PCASH_TRANSACTION_ROW
 
»cÜd
)

1089 
tu¶e_gu¬d
<
ÿsh_Œª§ùiÚ_mª_im¶
> 
	`´
(
_pÿsh_Œª§ùiÚ_mª
);

1090 
´
->
_»p
 = &
¬•row
;

1092 
´
->
	`£t_v®ue
(0, 
»cÜd
->
CT_T_ID
);

1093 
´
->
	`£t_v®ue
(1, 
	`Eg’TimeToTimeT
(
»cÜd
->
CT_DTS
));

1094 
´
->
	`£t_v®ue
(2, 
»cÜd
->
CT_AMT
);

1095 
´
->
	`£t_v®ue
(3, 
»cÜd
->
CT_NAME
);

1096 
	`W_DO
(
_pÿsh_Œª§ùiÚ_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

1098  
RCOK
;

1099 
	}
}

1102 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_hŞdšg_hi¡Üy
(
»p_row_t
& 
¬•row
,

1103 
PHOLDING_HISTORY_ROW
 
»cÜd
)

1105 
tu¶e_gu¬d
<
hŞdšg_hi¡Üy_mª_im¶
> 
	`´
(
_phŞdšg_hi¡Üy_mª
);

1106 
´
->
_»p
 = &
¬•row
;

1108 
´
->
	`£t_v®ue
(0, 
»cÜd
->
HH_H_T_ID
);

1109 
´
->
	`£t_v®ue
(1, 
»cÜd
->
HH_T_ID
);

1110 
´
->
	`£t_v®ue
(2, 
»cÜd
->
HH_BEFORE_QTY
);

1111 
´
->
	`£t_v®ue
(3, 
»cÜd
->
HH_AFTER_QTY
);

1112 
	`W_DO
(
_phŞdšg_hi¡Üy_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

1114  
RCOK
;

1115 
	}
}

1117 
	gShÜeTPCEEnv
::
	$_»ad_Œade_un™
()

1119 
boŞ
 
hasNext
;

1121 
hasNext
ğ
pG’”©eAndLßd
->
	`hasNextT¿de
();

1122 
PTRADE_ROW
 
row
 = 
pG’”©eAndLßd
->
	`g‘T¿deRow
();

1123 
ŒadeBufãr
.
	`­³nd
(
row
);

1124 
hi¡
 = 
pG’”©eAndLßd
->
	`g‘T¿deHi¡ÜyRowCouÁ
();

1125 
i
=0; i<
hi¡
; i++) {

1126 
PTRADE_HISTORY_ROW
 
»cÜd
 = 
pG’”©eAndLßd
->
	`g‘T¿deHi¡ÜyRow
(
i
);

1127 
ŒadeHi¡ÜyBufãr
.
	`­³nd
(
»cÜd
);

1129 if(
pG’”©eAndLßd
->
	`shouldProûssS‘em’tRow
()) {

1130 
PSETTLEMENT_ROW
 
»cÜd
 = 
pG’”©eAndLßd
->
	`g‘S‘em’tRow
();

1131 
£‰Ëm’tBufãr
.
	`­³nd
(
»cÜd
);

1133 if(
pG’”©eAndLßd
->
	`shouldProûssCashT¿n§ùiÚRow
()) {

1134 
PCASH_TRANSACTION_ROW
 
»cÜd
=
pG’”©eAndLßd
->
	`g‘CashT¿n§ùiÚRow
();

1135 
ÿshT¿n§ùiÚBufãr
.
	`­³nd
(
»cÜd
);

1137 
hi¡
 = 
pG’”©eAndLßd
->
	`g‘HŞdšgHi¡ÜyRowCouÁ
();

1138 
i
=0; i<
hi¡
; i++) {

1139 
PHOLDING_HISTORY_ROW
 
»cÜd
=
pG’”©eAndLßd
->
	`g‘HŞdšgHi¡ÜyRow
(
i
);

1140 
hŞdšgHi¡ÜyBufãr
.
	`­³nd
(
»cÜd
);

1142 } (
hasNext
 && 
ŒadeBufãr
.
	`hasS·û
()));

1143 
ŒadeBufãr
.
	`£tMÜeToR—d
(
hasNext
);

1144 
	}
}

1147 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_brok”
(
»p_row_t
& 
¬•row
, 
PBROKER_ROW
 
»cÜd
)

1149 
tu¶e_gu¬d
<
brok”_mª_im¶
> 
	`´
(
_pbrok”_mª
);

1150 
´
->
_»p
 = &
¬•row
;

1152 
´
->
	`£t_v®ue
(0, 
»cÜd
->
B_ID
);

1153 
´
->
	`£t_v®ue
(1, 
»cÜd
->
B_ST_ID
);

1154 
´
->
	`£t_v®ue
(2, 
»cÜd
->
B_NAME
);

1155 
´
->
	`£t_v®ue
(3, 
»cÜd
->
B_NUM_TRADES
);

1156 
´
->
	`£t_v®ue
(4, (
»cÜd
->
B_COMM_TOTAL
));

1157 
	`W_DO
(
_pbrok”_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

1159  
RCOK
;

1160 
	}
}

1162 
	gShÜeTPCEEnv
::
	$_»ad_brok”
()

1164 
boŞ
 
hasNext
;

1166 
hasNext
ğ
pG’”©eAndLßd
->
	`hasNextBrok”
();

1167 
PBROKER_ROW
 
»cÜd
 = 
pG’”©eAndLßd
->
	`g‘Brok”Row
();

1168 
brok”Bufãr
.
	`­³nd
(
»cÜd
);

1169 } (
hasNext
 && 
brok”Bufãr
.
	`hasS·û
()));

1170 
brok”Bufãr
.
	`£tMÜeToR—d
(
hasNext
);

1171 
	}
}

1174 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_hŞdšg
(
»p_row_t
& 
¬•row
, 
PHOLDING_ROW
 
»cÜd
)

1176 
tu¶e_gu¬d
<
hŞdšg_mª_im¶
> 
	`´
(
_phŞdšg_mª
);

1177 
´
->
_»p
 = &
¬•row
;

1179 
´
->
	`£t_v®ue
(0, 
»cÜd
->
H_T_ID
);

1180 
´
->
	`£t_v®ue
(1, 
»cÜd
->
H_CA_ID
);

1181 
´
->
	`£t_v®ue
(2, 
»cÜd
->
H_S_SYMB
);

1182 
´
->
	`£t_v®ue
(3, 
	`Eg’TimeToTimeT
(
»cÜd
->
H_DTS
));

1183 
´
->
	`£t_v®ue
(4, 
»cÜd
->
H_PRICE
);

1184 
´
->
	`£t_v®ue
(5, 
»cÜd
->
H_QTY
);

1185 
	`W_DO
(
_phŞdšg_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

1187  
RCOK
;

1188 
	}
}

1190 
	gShÜeTPCEEnv
::
	$_»ad_hŞdšg
()

1192 
boŞ
 
hasNext
;

1194 
hasNext
ğ
pG’”©eAndLßd
->
	`hasNextHŞdšg
();

1195 
PHOLDING_ROW
 
»cÜd
 = 
pG’”©eAndLßd
->
	`g‘HŞdšgRow
();

1196 
hŞdšgBufãr
.
	`­³nd
(
»cÜd
);

1197 } (
hasNext
 && 
hŞdšgBufãr
.
	`hasS·û
()));

1198 
hŞdšgBufãr
.
	`£tMÜeToR—d
(
hasNext
);

1199 
	}
}

1202 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_hŞdšg_summ¬y
(
»p_row_t
& 
¬•row
,

1203 
PHOLDING_SUMMARY_ROW
 
»cÜd
)

1205 
tu¶e_gu¬d
<
hŞdšg_summ¬y_mª_im¶
> 
	`´
(
_phŞdšg_summ¬y_mª
);

1206 
´
->
_»p
 = &
¬•row
;

1208 
´
->
	`£t_v®ue
(0, 
»cÜd
->
HS_CA_ID
);

1209 
´
->
	`£t_v®ue
(1, 
»cÜd
->
HS_S_SYMB
);

1210 
´
->
	`£t_v®ue
(2, 
»cÜd
->
HS_QTY
);

1211 #ifdeà
COMPILE_FLAT_FILE_LOAD


1212 
	`årštf
(
fshs
, "%lld|%s|%d\n",

1213 
»cÜd
->
HS_CA_ID
,„ecÜd->
HS_S_SYMB
,„ecÜd->
HS_QTY
);

1215 
	`W_DO
(
_phŞdšg_summ¬y_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

1217  
RCOK
;

1218 
	}
}

1220 
	gShÜeTPCEEnv
::
	$_»ad_hŞdšg_summ¬y
()

1222 
boŞ
 
hasNext
;

1224 
hasNext
ğ
pG’”©eAndLßd
->
	`hasNextHŞdšgSumm¬y
();

1225 
PHOLDING_SUMMARY_ROW
 
»cÜd
 = 
pG’”©eAndLßd
->
	`g‘HŞdšgSumm¬yRow
();

1226 
hŞdšgSumm¬yBufãr
.
	`­³nd
(
»cÜd
);

1227 } (
hasNext
 && 
hŞdšgSumm¬yBufãr
.
	`hasS·û
()));

1228 
hŞdšgSumm¬yBufãr
.
	`£tMÜeToR—d
(
hasNext
);

1229 
	}
}

1232 
w_rc_t
 
	gShÜeTPCEEnv
::
	$_lßd_Úe_Œade_»que¡
(
»p_row_t
& 
¬•row
,

1233 
PTRADE_REQUEST_ROW
 
»cÜd
)

1235 
tu¶e_gu¬d
<
Œade_»que¡_mª_im¶
> 
	`´
(
_±¿de_»que¡_mª
);

1236 
´
->
_»p
 = &
¬•row
;

1238 
´
->
	`£t_v®ue
(0, 
»cÜd
->
TR_T_ID
);

1239 
´
->
	`£t_v®ue
(1, 
»cÜd
->
TR_TT_ID
);

1240 
´
->
	`£t_v®ue
(2, 
»cÜd
->
TR_S_SYMB
);

1241 
´
->
	`£t_v®ue
(3, 
»cÜd
->
TR_QTY
);

1242 
´
->
	`£t_v®ue
(4, (
»cÜd
->
TR_BID_PRICE
));

1243 
´
->
	`£t_v®ue
(5, 
»cÜd
->
TR_B_ID
);

1244 
	`W_DO
(
_±¿de_»que¡_mª
->
	`add_tu¶e
(
_pssm
, 
´
));

1246  
RCOK
;

1247 
	}
}

1250 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_pİuÏ‹_sm®l
(cÚ¡ 
xù_id
,

1251 
pİuÏ‹_sm®l_šput_t
& 
±oš
)

1254 
	`as£¹
 (
_pssm
);

1255 
	`as£¹
 (
_š™Ÿlized
);

1258 
»p_row_t
 
	`¬•row
(
_³xchªge_mª
->
	`ts
());

1259 
¬•row
.
	`£t
(
_³xchªge_desc
->
	`maxsize
());

1262 
	`TRACE
Ğ
TRACE_ALWAYS
, "Building CHARGE !!!\n");

1263 
rows
=
ch¬geBufãr
.
	`g‘Size
();

1264 
i
=0; i<
rows
; i++){

1265 
PCHARGE_ROW
 
»cÜd
 = 
ch¬geBufãr
.
	`g‘
(
i
);

1266 
	`W_DO
(
	`_lßd_Úe_ch¬ge
(
¬•row
, 
»cÜd
));

1268 
pG’”©eAndLßd
->
	`R–—£Ch¬ge
();

1269 
	`TRACE
Ğ
TRACE_ALWAYS
, "Building COMMISSION_RATE !!!\n");

1270 
rows
=
commissiÚR©eBufãr
.
	`g‘Size
();

1271 
i
=0; i<
rows
; i++){

1272 
PCOMMISSION_RATE_ROW
 
»cÜd
 = 
commissiÚR©eBufãr
.
	`g‘
(
i
);

1273 
	`W_DO
(
	`_lßd_Úe_commissiÚ_¿‹
(
¬•row
, 
»cÜd
));

1275 
pG’”©eAndLßd
->
	`R–—£CommissiÚR©e
();

1276 
	`TRACE
Ğ
TRACE_ALWAYS
, "Building EXCHANGE !!!\n");

1277 
rows
=
exchªgeBufãr
.
	`g‘Size
();

1278 
i
=0; i<
rows
; i++){

1279 
PEXCHANGE_ROW
 
»cÜd
 = 
exchªgeBufãr
.
	`g‘
(
i
);

1280 
	`W_DO
(
	`_lßd_Úe_exchªge
(
¬•row
, 
»cÜd
));

1282 
pG’”©eAndLßd
->
	`R–—£Exchªge
();

1283 
	`TRACE
Ğ
TRACE_ALWAYS
, "Building INDUSTRY !!!\n");

1284 
rows
=
šdu¡ryBufãr
.
	`g‘Size
();

1285 
i
=0; i<
rows
; i++){

1286 
PINDUSTRY_ROW
 
»cÜd
 = 
šdu¡ryBufãr
.
	`g‘
(
i
);

1287 
	`W_DO
(
	`_lßd_Úe_šdu¡ry
(
¬•row
, 
»cÜd
));

1289 
pG’”©eAndLßd
->
	`R–—£Indu¡ry
();

1290 
	`TRACE
Ğ
TRACE_ALWAYS
, "Building SECTOR !!!\n");

1291 
rows
=
£ùÜBufãr
.
	`g‘Size
();

1292 
i
=0; i<
rows
; i++){

1293 
PSECTOR_ROW
 
»cÜd
 = 
£ùÜBufãr
.
	`g‘
(
i
);

1294 
	`W_DO
(
	`_lßd_Úe_£ùÜ
(
¬•row
, 
»cÜd
));

1296 
pG’”©eAndLßd
->
	`R–—£SeùÜ
();

1297 
	`TRACE
Ğ
TRACE_ALWAYS
, "Building STATUS_TYPE !!!\n");

1298 
rows
=
¡©usTy³Bufãr
.
	`g‘Size
();

1299 
i
=0; i<
rows
; i++){

1300 
PSTATUS_TYPE_ROW
 
»cÜd
 = 
¡©usTy³Bufãr
.
	`g‘
(
i
);

1301 
	`W_DO
(
	`_lßd_Úe_¡©us_ty³
(
¬•row
, 
»cÜd
));

1303 
pG’”©eAndLßd
->
	`R–—£StusTy³
();

1304 
	`TRACE
Ğ
TRACE_ALWAYS
, "Building TAXRATE !!!\n");

1305 
rows
=
x¿‹Bufãr
.
	`g‘Size
();

1306 
i
=0; i<
rows
; i++){

1307 
PTAXRATE_ROW
 
»cÜd
 = 
x¿‹Bufãr
.
	`g‘
(
i
);

1308 
	`W_DO
(
	`_lßd_Úe_x¿‹
(
¬•row
, 
»cÜd
));

1310 
pG’”©eAndLßd
->
	`R–—£Tax¿‹
();

1311 
	`TRACE
Ğ
TRACE_ALWAYS
, "Building TRADE_TYPE !!!\n");

1312 
rows
=
ŒadeTy³Bufãr
.
	`g‘Size
();

1313 
i
=0; i<
rows
; i++){

1314 
PTRADE_TYPE_ROW
 
»cÜd
 = 
ŒadeTy³Bufãr
.
	`g‘
(
i
);

1315 
	`W_DO
(
	`_lßd_Úe_Œade_ty³
(
¬•row
, 
»cÜd
));

1317 
pG’”©eAndLßd
->
	`R–—£T¿deTy³
();

1318 
	`TRACE
Ğ
TRACE_ALWAYS
, "Building ZIP CODE !!!\n");

1319 
rows
=
zCodeBufãr
.
	`g‘Size
();

1320 
i
=0; i<
rows
; i++){

1321 
PZIP_CODE_ROW
 
»cÜd
 = 
zCodeBufãr
.
	`g‘
(
i
);

1322 
	`W_DO
(
	`_lßd_Úe_z_code
(
¬•row
, 
»cÜd
));

1324 
pG’”©eAndLßd
->
	`R–—£ZCode
();

1326  (
_pssm
->
	`comm™_xù
());

1327 
	}
}

1330 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_pİuÏ‹_cu¡om”
(cÚ¡ 
xù_id
,

1331 
pİuÏ‹_cu¡om”_šput_t
& 
±oš
)

1333 
	`as£¹
 (
_pssm
);

1334 
	`as£¹
 (
_š™Ÿlized
);

1336 
»p_row_t
 
	`¬•row
(
_pcu¡om”_mª
->
	`ts
());

1337 
¬•row
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

1339 
rows
=
cu¡om”Bufãr
.
	`g‘Size
();

1340 
i
=0; i<
rows
; i++) {

1341 
PCUSTOMER_ROW
 
»cÜd
 = 
cu¡om”Bufãr
.
	`g‘
(
i
);

1342 
	`W_DO
(
	`_lßd_Úe_cu¡om”
(
¬•row
, 
»cÜd
));

1345  (
_pssm
->
	`comm™_xù
());

1346 
	}
}

1348 
	gShÜeTPCEEnv
::
	$pİuÏ‹_cu¡om”
()

1350 
pG’”©eAndLßd
->
	`In™Cu¡om”
();

1351 
	`TRACE
Ğ
TRACE_ALWAYS
, "Building CUSTOMER !!!\n");

1352 
cu¡om”Bufãr
.
	`hasMÜeToR—d
()){

1353 
log_¥aû_Ãeded
 = 0;

1354 
cu¡om”Bufãr
.
	`»£t
();

1355 
	`_»ad_cu¡om”
();

1356 
pİuÏ‹_cu¡om”_šput_t
 
š
;

1357 
»Œy
:

1358 
	`W_COERCE
(
this
->
	`db
()->
	`begš_xù
());

1359 
	`CHECK_XCT_RETURN
(
this
->
	`xù_pİuÏ‹_cu¡om”
(1, 
š
),

1360 
log_¥aû_Ãeded
, 
»Œy
, 
this
);

1362 
pG’”©eAndLßd
->
	`R–—£Cu¡om”
();

1363 
cu¡om”Bufãr
.
	`»Ëa£
();

1364 
	}
}

1367 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_pİuÏ‹_add»ss
(cÚ¡ 
xù_id
,

1368 
pİuÏ‹_add»ss_šput_t
& 
±oš
)

1370 
	`as£¹
 (
_pssm
);

1371 
	`as£¹
 (
_š™Ÿlized
);

1373 
»p_row_t
 
	`¬•row
(
_·dd»ss_mª
->
	`ts
());

1374 
¬•row
.
	`£t
(
_·dd»ss_desc
->
	`maxsize
());

1376 
rows
=
add»ssBufãr
.
	`g‘Size
();

1377 
i
=0; i<
rows
; i++){

1378 
PADDRESS_ROW
 
»cÜd
 = 
add»ssBufãr
.
	`g‘
(
i
);

1379 
	`W_DO
(
	`_lßd_Úe_add»ss
(
¬•row
, 
»cÜd
));

1382  (
_pssm
->
	`comm™_xù
());

1383 
	}
}

1385 
	gShÜeTPCEEnv
::
	$pİuÏ‹_add»ss
()

1387 
pG’”©eAndLßd
->
	`In™Add»ss
();

1388 
	`TRACE
Ğ
TRACE_ALWAYS
, "Building ADDRESS !!!\n");

1389 
add»ssBufãr
.
	`hasMÜeToR—d
()){

1390 
log_¥aû_Ãeded
 = 0;

1391 
add»ssBufãr
.
	`»£t
();

1392 
	`_»ad_add»ss
();

1393 
pİuÏ‹_add»ss_šput_t
 
š
;

1394 
»Œy
:

1395 
	`W_COERCE
(
this
->
	`db
()->
	`begš_xù
());

1396 
	`CHECK_XCT_RETURN
(
this
->
	`xù_pİuÏ‹_add»ss
(1, 
š
),

1397 
log_¥aû_Ãeded
, 
»Œy
, 
this
);

1399 
pG’”©eAndLßd
->
	`R–—£Add»ss
();

1400 
add»ssBufãr
.
	`»Ëa£
();

1401 
	}
}

1404 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_pİuÏ‹_ÿ_ªd_­
(cÚ¡ 
xù_id
,

1405 
pİuÏ‹_ÿ_ªd_­_šput_t
& 
±oš
)

1407 
	`as£¹
 (
_pssm
);

1408 
	`as£¹
 (
_š™Ÿlized
);

1410 
»p_row_t
 
	`¬•row
(
_pcu¡om”_accouÁ_mª
->
	`ts
());

1411 
¬•row
.
	`£t
(
_pcu¡om”_accouÁ_desc
->
	`maxsize
());

1413 
rows
=
cu¡om”AccouÁBufãr
.
	`g‘Size
();

1414 
i
=0; i<
rows
; i++){

1415 
PCUSTOMER_ACCOUNT_ROW
 
»cÜd
 = 
cu¡om”AccouÁBufãr
.
	`g‘
(
i
);

1416 
	`W_DO
(
	`_lßd_Úe_cu¡om”_accouÁ
(
¬•row
, 
»cÜd
));

1418 
rows
=
accouÁP”missiÚBufãr
.
	`g‘Size
();

1419 
i
=0; i<
rows
; i++){

1420 
PACCOUNT_PERMISSION_ROW
 
»cÜd
 = 
accouÁP”missiÚBufãr
.
	`g‘
(
i
);

1421 
	`W_DO
(
	`_lßd_Úe_accouÁ_³rmissiÚ
(
¬•row
, 
»cÜd
));

1424  (
_pssm
->
	`comm™_xù
());

1425 
	}
}

1427 
	gShÜeTPCEEnv
::
	$pİuÏ‹_ÿ_ªd_­
()

1429 
pG’”©eAndLßd
->
	`In™Cu¡om”AccouÁAndAccouÁP”missiÚ
();

1430 
	`TRACE
Ğ
TRACE_ALWAYS
, "Building CustomerAccount‡nd AccountPermission !!!\n");

1431 
cu¡om”AccouÁBufãr
.
	`hasMÜeToR—d
()){

1432 
log_¥aû_Ãeded
 = 0;

1433 
cu¡om”AccouÁBufãr
.
	`»£t
();

1434 
accouÁP”missiÚBufãr
.
	`»£t
();

1435 
	`_»ad_ÿ_ªd_­
();

1436 
pİuÏ‹_ÿ_ªd_­_šput_t
 
š
;

1437 
»Œy
:

1438 
	`W_COERCE
(
this
->
	`db
()->
	`begš_xù
());

1439 
	`CHECK_XCT_RETURN
(
this
->
	`xù_pİuÏ‹_ÿ_ªd_­
(1, 
š
),

1440 
log_¥aû_Ãeded
, 
»Œy
, 
this
);

1442 
pG’”©eAndLßd
->
	`R–—£Cu¡om”AccouÁAndAccouÁP”missiÚ
();

1443 
cu¡om”AccouÁBufãr
.
	`»Ëa£
();

1444 
accouÁP”missiÚBufãr
.
	`»Ëa£
();

1445 
	}
}

1448 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_pİuÏ‹_wl_ªd_wi
(cÚ¡ 
xù_id
,

1449 
pİuÏ‹_wl_ªd_wi_šput_t
& 
±oš
)

1451 
	`as£¹
 (
_pssm
);

1452 
	`as£¹
 (
_š™Ÿlized
);

1454 
»p_row_t
 
	`¬•row
(
_pw©ch_™em_mª
->
	`ts
());

1455 
¬•row
.
	`£t
(
_pw©ch_™em_desc
->
	`maxsize
());

1457 
rows
=
w©chLi¡Bufãr
.
	`g‘Size
();

1458 
i
=0; i<
rows
; i++){

1459 
PWATCH_LIST_ROW
 
»cÜd
 = 
w©chLi¡Bufãr
.
	`g‘
(
i
);

1460 
	`W_DO
(
	`_lßd_Úe_w©ch_li¡
(
¬•row
, 
»cÜd
));

1462 
rows
=
w©chI‹mBufãr
.
	`g‘Size
();

1463 
i
=0; i<
rows
; i++){

1464 
PWATCH_ITEM_ROW
 
»cÜd
 = 
w©chI‹mBufãr
.
	`g‘
(
i
);

1465 
	`W_DO
(
	`_lßd_Úe_w©ch_™em
(
¬•row
, 
»cÜd
));

1468  (
_pssm
->
	`comm™_xù
());

1469 
	}
}

1471 
	gShÜeTPCEEnv
::
	$pİuÏ‹_wl_ªd_wi
()

1473 
pG’”©eAndLßd
->
	`In™W©chLi¡AndW©chI‹m
();

1474 
	`TRACE
Ğ
TRACE_ALWAYS
, "Building WATCH_LISTable‡nd WATCH_ITEM !!!\n");

1475 
w©chLi¡Bufãr
.
	`hasMÜeToR—d
()){

1476 
log_¥aû_Ãeded
 = 0;

1477 
w©chI‹mBufãr
.
	`»£t
();

1478 
w©chLi¡Bufãr
.
	`»£t
();

1479 
	`_»ad_wl_ªd_wi
();

1480 
pİuÏ‹_wl_ªd_wi_šput_t
 
š
;

1481 
»Œy
:

1482 
	`W_COERCE
(
this
->
	`db
()->
	`begš_xù
());

1483 
	`CHECK_XCT_RETURN
(
this
->
	`xù_pİuÏ‹_wl_ªd_wi
(1, 
š
),

1484 
log_¥aû_Ãeded
, 
»Œy
, 
this
);

1486 
pG’”©eAndLßd
->
	`R–—£W©chLi¡AndW©chI‹m
();

1487 
w©chI‹mBufãr
.
	`»Ëa£
();

1488 
w©chLi¡Bufãr
.
	`»Ëa£
();

1489 
	}
}

1492 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_pİuÏ‹_cu¡om”_x¿‹
(cÚ¡ 
xù_id
,

1493 
pİuÏ‹_cu¡om”_x¿‹_šput_t
& 
±oš
)

1495 
	`as£¹
 (
_pssm
);

1496 
	`as£¹
 (
_š™Ÿlized
);

1498 
»p_row_t
 
	`¬•row
(
_pcu¡om”_x¿‹_mª
->
	`ts
());

1499 
¬•row
.
	`£t
(
_pcu¡om”_x¿‹_desc
->
	`maxsize
());

1501 
rows
=
cu¡om”Tax¿‹Bufãr
.
	`g‘Size
();

1502 
i
=0; i<
rows
; i++){

1503 
PCUSTOMER_TAXRATE_ROW
 
»cÜd
 = 
cu¡om”Tax¿‹Bufãr
.
	`g‘
(
i
);

1504 
	`W_DO
(
	`_lßd_Úe_cu¡om”_x¿‹
(
¬•row
, 
»cÜd
));

1507  (
_pssm
->
	`comm™_xù
());

1508 
	}
}

1510 
	gShÜeTPCEEnv
::
	$pİuÏ‹_cu¡om”_x¿‹
()

1512 
pG’”©eAndLßd
->
	`In™Cu¡om”Tax¿‹
();

1513 
	`TRACE
Ğ
TRACE_ALWAYS
, "Building CUSTOMER_TAXRATE !!!\n");

1514 
cu¡om”Tax¿‹Bufãr
.
	`hasMÜeToR—d
()){

1515 
log_¥aû_Ãeded
 = 0;

1516 
cu¡om”Tax¿‹Bufãr
.
	`»£t
();

1517 
	`_»ad_cu¡om”_x¿‹
();

1518 
pİuÏ‹_cu¡om”_x¿‹_šput_t
 
š
;

1519 
»Œy
:

1520 
	`W_COERCE
(
this
->
	`db
()->
	`begš_xù
());

1521 
	`CHECK_XCT_RETURN
(
this
->
	`xù_pİuÏ‹_cu¡om”_x¿‹
(1, 
š
),

1522 
log_¥aû_Ãeded
, 
»Œy
, 
this
);

1524 
pG’”©eAndLßd
->
	`R–—£Cu¡om”Tax¿‹
();

1525 
cu¡om”Tax¿‹Bufãr
.
	`»Ëa£
();

1526 
	}
}

1529 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_pİuÏ‹_com·ny
(cÚ¡ 
xù_id
,

1530 
pİuÏ‹_com·ny_šput_t
& 
±oš
)

1532 
	`as£¹
 (
_pssm
);

1533 
	`as£¹
 (
_š™Ÿlized
);

1535 
»p_row_t
 
	`¬•row
(
_pcom·ny_mª
->
	`ts
());

1536 
¬•row
.
	`£t
(
_pcom·ny_desc
->
	`maxsize
());

1538 
rows
=
com·nyBufãr
.
	`g‘Size
();

1539 
i
=0; i<
rows
; i++){

1540 
PCOMPANY_ROW
 
»cÜd
 = 
com·nyBufãr
.
	`g‘
(
i
);

1541 
	`W_DO
(
	`_lßd_Úe_com·ny
(
¬•row
, 
»cÜd
));

1544  (
_pssm
->
	`comm™_xù
());

1545 
	}
}

1547 
	gShÜeTPCEEnv
::
	$pİuÏ‹_com·ny
()

1549 
pG’”©eAndLßd
->
	`In™Com·ny
();

1550 
	`TRACE
Ğ
TRACE_ALWAYS
, "Building COMPANY !!!\n");

1551 
com·nyBufãr
.
	`hasMÜeToR—d
()){

1552 
log_¥aû_Ãeded
 = 0;

1553 
com·nyBufãr
.
	`»£t
();

1554 
	`_»ad_com·ny
();

1555 
pİuÏ‹_com·ny_šput_t
 
š
;

1556 
»Œy
:

1557 
	`W_COERCE
(
this
->
	`db
()->
	`begš_xù
());

1558 
	`CHECK_XCT_RETURN
(
this
->
	`xù_pİuÏ‹_com·ny
(1, 
š
),

1559 
log_¥aû_Ãeded
, 
»Œy
, 
this
);

1561 
pG’”©eAndLßd
->
	`R–—£Com·ny
();

1562 
com·nyBufãr
.
	`»Ëa£
();

1563 
	}
}

1566 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_pİuÏ‹_com·ny_com³t™Ü
(cÚ¡ 
xù_id
,

1567 
pİuÏ‹_com·ny_com³t™Ü_šput_t
& 
±oš
)

1569 
	`as£¹
 (
_pssm
);

1570 
	`as£¹
 (
_š™Ÿlized
);

1572 
»p_row_t
 
	`¬•row
(
_pcom·ny_com³t™Ü_mª
->
	`ts
());

1573 
¬•row
.
	`£t
(
_pcom·ny_com³t™Ü_desc
->
	`maxsize
());

1575 
rows
=
com·nyCom³t™ÜBufãr
.
	`g‘Size
();

1576 
i
=0; i<
rows
; i++){

1577 
PCOMPANY_COMPETITOR_ROW
 
»cÜd
 = 
com·nyCom³t™ÜBufãr
.
	`g‘
(
i
);

1578 
	`W_DO
(
	`_lßd_Úe_com·ny_com³t™Ü
(
¬•row
, 
»cÜd
));

1581  (
_pssm
->
	`comm™_xù
());

1582 
	}
}

1584 
	gShÜeTPCEEnv
::
	$pİuÏ‹_com·ny_com³t™Ü
()

1586 
pG’”©eAndLßd
->
	`In™Com·nyCom³t™Ü
();

1587 
	`TRACE
Ğ
TRACE_ALWAYS
, "Building COMPANY COMPETITOR !!!\n");

1588 
com·nyCom³t™ÜBufãr
.
	`hasMÜeToR—d
()){

1589 
log_¥aû_Ãeded
 = 0;

1590 
com·nyCom³t™ÜBufãr
.
	`»£t
();

1591 
	`_»ad_com·ny_com³t™Ü
();

1592 
pİuÏ‹_com·ny_com³t™Ü_šput_t
 
š
;

1593 
»Œy
:

1594 
	`W_COERCE
(
this
->
	`db
()->
	`begš_xù
());

1595 
	`CHECK_XCT_RETURN
(
this
->
	`xù_pİuÏ‹_com·ny_com³t™Ü
(1, 
š
),

1596 
log_¥aû_Ãeded
, 
»Œy
, 
this
);

1598 
pG’”©eAndLßd
->
	`R–—£Com·nyCom³t™Ü
();

1599 
com·nyCom³t™ÜBufãr
.
	`»Ëa£
();

1600 
	}
}

1603 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_pİuÏ‹_day_m¬k‘
(cÚ¡ 
xù_id
,

1604 
pİuÏ‹_day_m¬k‘_šput_t
& 
±oš
)

1606 
	`as£¹
 (
_pssm
);

1607 
	`as£¹
 (
_š™Ÿlized
);

1609 
»p_row_t
 
	`¬•row
(
_pday_m¬k‘_mª
->
	`ts
());

1610 
¬•row
.
	`£t
(
_pday_m¬k‘_desc
->
	`maxsize
());

1612 
rows
=
dayM¬k‘Bufãr
.
	`g‘Size
();

1613 
i
=0; i<
rows
; i++){

1614 
PDAILY_MARKET_ROW
 
»cÜd
 = 
dayM¬k‘Bufãr
.
	`g‘
(
i
);

1615 
	`W_DO
(
	`_lßd_Úe_day_m¬k‘
(
¬•row
, 
»cÜd
));

1618  (
_pssm
->
	`comm™_xù
());

1619 
	}
}

1621 
	gShÜeTPCEEnv
::
	$pİuÏ‹_day_m¬k‘
()

1623 
pG’”©eAndLßd
->
	`In™DayM¬k‘
();

1624 
	`TRACE
Ğ
TRACE_ALWAYS
, "DAILY_MARKET !!!\n");

1625 
dayM¬k‘Bufãr
.
	`hasMÜeToR—d
()){

1626 
log_¥aû_Ãeded
 = 0;

1627 
dayM¬k‘Bufãr
.
	`»£t
();

1628 
	`_»ad_day_m¬k‘
();

1629 
pİuÏ‹_day_m¬k‘_šput_t
 
š
;

1630 
»Œy
:

1631 
	`W_COERCE
(
this
->
	`db
()->
	`begš_xù
());

1632 
	`CHECK_XCT_RETURN
(
this
->
	`xù_pİuÏ‹_day_m¬k‘
(1, 
š
),

1633 
log_¥aû_Ãeded
, 
»Œy
, 
this
);

1635 
pG’”©eAndLßd
->
	`R–—£DayM¬k‘
();

1636 
dayM¬k‘Bufãr
.
	`»Ëa£
();

1637 
	}
}

1640 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_pİuÏ‹_fšªcŸl
(cÚ¡ 
xù_id
,

1641 
pİuÏ‹_fšªcŸl_šput_t
& 
±oš
)

1643 
	`as£¹
 (
_pssm
);

1644 
	`as£¹
 (
_š™Ÿlized
);

1646 
»p_row_t
 
	`¬•row
(
_pfšªcŸl_mª
->
	`ts
());

1647 
¬•row
.
	`£t
(
_pfšªcŸl_desc
->
	`maxsize
());

1649 
rows
=
fšªcŸlBufãr
.
	`g‘Size
();

1650 
i
=0; i<
rows
; i++){

1651 
PFINANCIAL_ROW
 
»cÜd
 = 
fšªcŸlBufãr
.
	`g‘
(
i
);

1652 
	`W_DO
(
	`_lßd_Úe_fšªcŸl
(
¬•row
, 
»cÜd
));

1655  (
_pssm
->
	`comm™_xù
());

1656 
	}
}

1658 
	gShÜeTPCEEnv
::
	$pİuÏ‹_fšªcŸl
()

1660 
pG’”©eAndLßd
->
	`In™FšªcŸl
();

1661 
	`TRACE
Ğ
TRACE_ALWAYS
, "Building FINANCIAL !!!\n");

1662 
fšªcŸlBufãr
.
	`hasMÜeToR—d
()){

1663 
log_¥aû_Ãeded
 = 0;

1664 
fšªcŸlBufãr
.
	`»£t
();

1665 
	`_»ad_fšªcŸl
();

1666 
pİuÏ‹_fšªcŸl_šput_t
 
š
;

1667 
»Œy
:

1668 
	`W_COERCE
(
this
->
	`db
()->
	`begš_xù
());

1669 
	`CHECK_XCT_RETURN
(
this
->
	`xù_pİuÏ‹_fšªcŸl
(1, 
š
),

1670 
log_¥aû_Ãeded
, 
»Œy
, 
this
);

1672 
pG’”©eAndLßd
->
	`R–—£FšªcŸl
();

1673 
fšªcŸlBufãr
.
	`»Ëa£
();

1674 
	}
}

1677 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_pİuÏ‹_£cur™y
(cÚ¡ 
xù_id
,

1678 
pİuÏ‹_£cur™y_šput_t
& 
±oš
)

1680 
	`as£¹
 (
_pssm
);

1681 
	`as£¹
 (
_š™Ÿlized
);

1683 
»p_row_t
 
	`¬•row
(
_p£cur™y_mª
->
	`ts
());

1684 
¬•row
.
	`£t
(
_p£cur™y_desc
->
	`maxsize
());

1686 
rows
=
£cur™yBufãr
.
	`g‘Size
();

1687 
i
=0; i<
rows
; i++){

1688 
PSECURITY_ROW
 
»cÜd
 = 
£cur™yBufãr
.
	`g‘
(
i
);

1689 
	`W_DO
(
	`_lßd_Úe_£cur™y
(
¬•row
, 
»cÜd
));

1692  (
_pssm
->
	`comm™_xù
());

1693 
	}
}

1695 
	gShÜeTPCEEnv
::
	$pİuÏ‹_£cur™y
()

1697 
pG’”©eAndLßd
->
	`In™Secur™y
();

1698 
	`TRACE
Ğ
TRACE_ALWAYS
, "Building SECURITY !!!\n");

1699 
£cur™yBufãr
.
	`hasMÜeToR—d
()){

1700 
log_¥aû_Ãeded
 = 0;

1701 
£cur™yBufãr
.
	`»£t
();

1702 
	`_»ad_£cur™y
();

1703 
pİuÏ‹_£cur™y_šput_t
 
š
;

1704 
»Œy
:

1705 
	`W_COERCE
(
this
->
	`db
()->
	`begš_xù
());

1706 
	`CHECK_XCT_RETURN
(
this
->
	`xù_pİuÏ‹_£cur™y
(1, 
š
),

1707 
log_¥aû_Ãeded
, 
»Œy
, 
this
);

1709 
pG’”©eAndLßd
->
	`R–—£Secur™y
();

1710 
£cur™yBufãr
.
	`»Ëa£
();

1711 
	}
}

1714 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_pİuÏ‹_Ï¡_Œade
(cÚ¡ 
xù_id
,

1715 
pİuÏ‹_Ï¡_Œade_šput_t
& 
±oš
)

1717 
	`as£¹
 (
_pssm
);

1718 
	`as£¹
 (
_š™Ÿlized
);

1720 
»p_row_t
 
	`¬•row
(
_¶a¡_Œade_mª
->
	`ts
());

1721 
¬•row
.
	`£t
(
_¶a¡_Œade_desc
->
	`maxsize
());

1723 
rows
=
Ï¡T¿deBufãr
.
	`g‘Size
();

1724 
i
=0; i<
rows
; i++){

1725 
PLAST_TRADE_ROW
 
»cÜd
 = 
Ï¡T¿deBufãr
.
	`g‘
(
i
);

1726 
	`W_DO
(
	`_lßd_Úe_Ï¡_Œade
(
¬•row
, 
»cÜd
));

1729  (
_pssm
->
	`comm™_xù
());

1730 
	}
}

1732 
	gShÜeTPCEEnv
::
	$pİuÏ‹_Ï¡_Œade
()

1734 
pG’”©eAndLßd
->
	`In™La¡T¿de
();

1735 
	`TRACE
Ğ
TRACE_ALWAYS
, "Building LAST_TRADE !!!\n");

1736 
Ï¡T¿deBufãr
.
	`hasMÜeToR—d
()){

1737 
log_¥aû_Ãeded
 = 0;

1738 
Ï¡T¿deBufãr
.
	`»£t
();

1739 
	`_»ad_Ï¡_Œade
();

1740 
pİuÏ‹_Ï¡_Œade_šput_t
 
š
;

1741 
»Œy
:

1742 
	`W_COERCE
(
this
->
	`db
()->
	`begš_xù
());

1743 
	`CHECK_XCT_RETURN
(
this
->
	`xù_pİuÏ‹_Ï¡_Œade
(1, 
š
),

1744 
log_¥aû_Ãeded
, 
»Œy
, 
this
);

1746 
pG’”©eAndLßd
->
	`R–—£La¡T¿de
();

1747 
Ï¡T¿deBufãr
.
	`»Ëa£
();

1748 
	}
}

1751 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_pİuÏ‹_ni_ªd_nx
(cÚ¡ 
xù_id
,

1752 
pİuÏ‹_ni_ªd_nx_šput_t
& 
±oš
)

1754 
	`as£¹
 (
_pssm
);

1755 
	`as£¹
 (
_š™Ÿlized
);

1757 
»p_row_t
 
	`¬•row
(
_²ews_™em_mª
->
	`ts
());

1758 
¬•row
.
	`£t
(
_²ews_™em_desc
->
	`maxsize
());

1760 
rows
=
ÃwsXRefBufãr
.
	`g‘Size
();

1761 
i
=0; i<
rows
; i++){

1762 
PNEWS_XREF_ROW
 
»cÜd
 = 
ÃwsXRefBufãr
.
	`g‘
(
i
);

1763 
	`W_DO
(
	`_lßd_Úe_Ãws_x»f
(
¬•row
, 
»cÜd
));

1765 
rows
=
ÃwsI‹mBufãr
.
	`g‘Size
();

1766 
i
=0; i<
rows
; i++){

1767 
PNEWS_ITEM_ROW
 
»cÜd
 = 
ÃwsI‹mBufãr
.
	`g‘
(
i
);

1768 
	`W_DO
(
	`_lßd_Úe_Ãws_™em
(
¬•row
, 
»cÜd
));

1771  (
_pssm
->
	`comm™_xù
());

1772 
	}
}

1774 
	gShÜeTPCEEnv
::
	$pİuÏ‹_ni_ªd_nx
()

1776 
pG’”©eAndLßd
->
	`In™NewsI‹mAndNewsXRef
();

1777 
	`TRACE
Ğ
TRACE_ALWAYS
, "Building NEWS_ITEM‡nd NEWS_XREF !!!\n");

1778 
ÃwsI‹mBufãr
.
	`hasMÜeToR—d
()){

1779 
log_¥aû_Ãeded
 = 0;

1780 
ÃwsI‹mBufãr
.
	`»£t
();

1781 
ÃwsXRefBufãr
.
	`»£t
();

1782 
	`_»ad_ni_ªd_nx
();

1783 
pİuÏ‹_ni_ªd_nx_šput_t
 
š
;

1784 
»Œy
:

1785 
	`W_COERCE
(
this
->
	`db
()->
	`begš_xù
());

1786 
	`CHECK_XCT_RETURN
(
this
->
	`xù_pİuÏ‹_ni_ªd_nx
(1, 
š
),

1787 
log_¥aû_Ãeded
, 
»Œy
, 
this
);

1789 
pG’”©eAndLßd
->
	`R–—£NewsI‹mAndNewsXRef
();

1790 
ÃwsI‹mBufãr
.
	`»Ëa£
();

1791 
ÃwsXRefBufãr
.
	`»Ëa£
();

1792 
	}
}

1795 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_pİuÏ‹_un™_Œade
(cÚ¡ 
xù_id
,

1796 
pİuÏ‹_un™_Œade_šput_t
& 
±oš
)

1798 
	`as£¹
 (
_pssm
);

1799 
	`as£¹
 (
_š™Ÿlized
);

1801 
»p_row_t
 
	`¬•row
(
_²ews_™em_mª
->
	`ts
());

1802 
¬•row
.
	`£t
(
_²ews_™em_desc
->
	`maxsize
());

1804 
rows
=
ŒadeBufãr
.
	`g‘Size
();

1805 
i
=0; i<
rows
; i++){

1806 
PTRADE_ROW
 
»cÜd
 = 
ŒadeBufãr
.
	`g‘
(
i
);

1807 
	`W_DO
(
	`_lßd_Úe_Œade
(
¬•row
, 
»cÜd
));

1809 
rows
=
ŒadeHi¡ÜyBufãr
.
	`g‘Size
();

1810 
i
=0; i<
rows
; i++){

1811 
PTRADE_HISTORY_ROW
 
»cÜd
 = 
ŒadeHi¡ÜyBufãr
.
	`g‘
(
i
);

1812 
	`W_DO
(
	`_lßd_Úe_Œade_hi¡Üy
(
¬•row
, 
»cÜd
));

1814 
rows
=
£‰Ëm’tBufãr
.
	`g‘Size
();

1815 
i
=0; i<
rows
; i++){

1816 
PSETTLEMENT_ROW
 
»cÜd
 = 
£‰Ëm’tBufãr
.
	`g‘
(
i
);

1817 
	`W_DO
(
	`_lßd_Úe_£‰Ëm’t
(
¬•row
, 
»cÜd
));

1819 
rows
=
ÿshT¿n§ùiÚBufãr
.
	`g‘Size
();

1820 
i
=0; i<
rows
; i++){

1821 
PCASH_TRANSACTION_ROW
 
»cÜd
 = 
ÿshT¿n§ùiÚBufãr
.
	`g‘
(
i
);

1822 
	`W_DO
(
	`_lßd_Úe_ÿsh_Œª§ùiÚ
(
¬•row
, 
»cÜd
));

1824 
rows
=
hŞdšgHi¡ÜyBufãr
.
	`g‘Size
();

1825 
i
=0; i<
rows
; i++){

1826 
PHOLDING_HISTORY_ROW
 
»cÜd
 = 
hŞdšgHi¡ÜyBufãr
.
	`g‘
(
i
);

1827 
	`W_DO
(
	`_lßd_Úe_hŞdšg_hi¡Üy
(
¬•row
, 
»cÜd
));

1830  (
_pssm
->
	`comm™_xù
());

1831 
	}
}

1834 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_pİuÏ‹_brok”
(cÚ¡ 
xù_id
,

1835 
pİuÏ‹_brok”_šput_t
& 
±oš
)

1837 
	`as£¹
 (
_pssm
);

1838 
	`as£¹
 (
_š™Ÿlized
);

1840 
»p_row_t
 
	`¬•row
(
_pbrok”_mª
->
	`ts
());

1841 
¬•row
.
	`£t
(
_pbrok”_desc
->
	`maxsize
());

1843 
rows
=
brok”Bufãr
.
	`g‘Size
();

1844 
i
=0; i<
rows
; i++){

1845 
PBROKER_ROW
 
»cÜd
 = 
brok”Bufãr
.
	`g‘
(
i
);

1846 
	`W_DO
(
	`_lßd_Úe_brok”
(
¬•row
, 
»cÜd
));

1849  (
_pssm
->
	`comm™_xù
());

1850 
	}
}

1852 
	gShÜeTPCEEnv
::
	$pİuÏ‹_brok”
()

1854 
brok”Bufãr
.
	`hasMÜeToR—d
()) {

1855 
log_¥aû_Ãeded
 = 0;

1856 
brok”Bufãr
.
	`»£t
();

1857 
	`_»ad_brok”
();

1858 
pİuÏ‹_brok”_šput_t
 
š
;

1859 
»Œy
:

1860 
	`W_COERCE
(
this
->
	`db
()->
	`begš_xù
());

1861 
	`CHECK_XCT_RETURN
(
this
->
	`xù_pİuÏ‹_brok”
(1, 
š
),

1862 
log_¥aû_Ãeded
, 
»Œy
, 
this
);

1864 
	}
}

1867 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_pİuÏ‹_hŞdšg_summ¬y
(cÚ¡ 
xù_id
,

1868 
pİuÏ‹_hŞdšg_summ¬y_šput_t
& 
±oš
)

1870 
	`as£¹
 (
_pssm
);

1871 
	`as£¹
 (
_š™Ÿlized
);

1873 
»p_row_t
 
	`¬•row
(
_phŞdšg_summ¬y_mª
->
	`ts
());

1874 
¬•row
.
	`£t
(
_phŞdšg_summ¬y_desc
->
	`maxsize
());

1876 
rows
=
hŞdšgSumm¬yBufãr
.
	`g‘Size
();

1877 
i
=0; i<
rows
; i++){

1878 
PHOLDING_SUMMARY_ROW
 
»cÜd
 = 
hŞdšgSumm¬yBufãr
.
	`g‘
(
i
);

1879 
	`W_DO
(
	`_lßd_Úe_hŞdšg_summ¬y
(
¬•row
, 
»cÜd
));

1882  (
_pssm
->
	`comm™_xù
());

1883 
	}
}

1885 
	gShÜeTPCEEnv
::
	$pİuÏ‹_hŞdšg_summ¬y
()

1887 
hŞdšgSumm¬yBufãr
.
	`hasMÜeToR—d
()){

1888 
log_¥aû_Ãeded
 = 0;

1889 
hŞdšgSumm¬yBufãr
.
	`»£t
();

1890 
	`_»ad_hŞdšg_summ¬y
();

1891 
pİuÏ‹_hŞdšg_summ¬y_šput_t
 
š
;

1892 
»Œy
:

1893 
	`W_COERCE
(
this
->
	`db
()->
	`begš_xù
());

1894 
	`CHECK_XCT_RETURN
(
this
->
	`xù_pİuÏ‹_hŞdšg_summ¬y
(1, 
š
),

1895 
log_¥aû_Ãeded
, 
»Œy
, 
this
);

1897 
	}
}

1900 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_pİuÏ‹_hŞdšg
(cÚ¡ 
xù_id
,

1901 
pİuÏ‹_hŞdšg_šput_t
& 
±oš
)

1903 
	`as£¹
 (
_pssm
);

1904 
	`as£¹
 (
_š™Ÿlized
);

1906 
»p_row_t
 
	`¬•row
(
_phŞdšg_mª
->
	`ts
());

1907 
¬•row
.
	`£t
(
_phŞdšg_desc
->
	`maxsize
());

1909 
rows
=
hŞdšgBufãr
.
	`g‘Size
();

1910 
i
=0; i<
rows
; i++){

1911 
PHOLDING_ROW
 
»cÜd
 = 
hŞdšgBufãr
.
	`g‘
(
i
);

1912 
	`W_DO
(
	`_lßd_Úe_hŞdšg
(
¬•row
, 
»cÜd
));

1915  (
_pssm
->
	`comm™_xù
());

1916 
	}
}

1918 
	gShÜeTPCEEnv
::
	$pİuÏ‹_hŞdšg
()

1920 
hŞdšgBufãr
.
	`hasMÜeToR—d
()){

1921 
log_¥aû_Ãeded
 = 0;

1922 
hŞdšgBufãr
.
	`»£t
();

1923 
	`_»ad_hŞdšg
();

1924 
pİuÏ‹_hŞdšg_šput_t
 
š
;

1925 
»Œy
:

1926 
	`W_COERCE
(
this
->
	`db
()->
	`begš_xù
());

1927 
	`CHECK_XCT_RETURN
(
this
->
	`xù_pİuÏ‹_hŞdšg
(1, 
š
),

1928 
log_¥aû_Ãeded
, 
»Œy
, 
this
);

1930 
	}
}

1932 
	gShÜeTPCEEnv
::
	$pİuÏ‹_un™_Œade
()

1934 
ŒadeBufãr
.
	`hasMÜeToR—d
()){

1935 
log_¥aû_Ãeded
 = 0;

1936 
ŒadeBufãr
.
	`»£t
();

1937 
ŒadeHi¡ÜyBufãr
.
	`»£t
();

1938 
£‰Ëm’tBufãr
.
	`»£t
();

1939 
ÿshT¿n§ùiÚBufãr
.
	`»£t
();

1940 
hŞdšgHi¡ÜyBufãr
.
	`»£t
();

1941 
	`_»ad_Œade_un™
();

1942 
	`´štf
("\n\n Populatingrade unit\n\n" );

1943 
pİuÏ‹_un™_Œade_šput_t
 
š
;

1944 
»Œy
:

1945 
	`W_COERCE
(
this
->
	`db
()->
	`begš_xù
());

1946 
	`CHECK_XCT_RETURN
(
this
->
	`xù_pİuÏ‹_un™_Œade
(1, 
š
),

1947 
log_¥aû_Ãeded
, 
»Œy
, 
this
);

1949 
	}
}

1951 
	gShÜeTPCEEnv
::
	$pİuÏ‹_growšg
()

1953 
pG’”©eAndLßd
->
	`In™HŞdšgAndT¿de
();

1954 
	`TRACE
Ğ
TRACE_ALWAYS
, "Building growingables !!!\n");

1955 
út
 =0;

1957 
	`pİuÏ‹_un™_Œade
();

1958 
	`pİuÏ‹_brok”
();

1959 
	`pİuÏ‹_hŞdšg_summ¬y
();

1960 
	`pİuÏ‹_hŞdšg
();

1961 
	`´štf
("\Æßd un™ %d\n",++
út
);

1962 
ŒadeBufãr
.
	`ÃwLßdUn™
();

1963 
ŒadeHi¡ÜyBufãr
.
	`ÃwLßdUn™
();

1964 
£‰Ëm’tBufãr
.
	`ÃwLßdUn™
();

1965 
ÿshT¿n§ùiÚBufãr
.
	`ÃwLßdUn™
();

1966 
hŞdšgHi¡ÜyBufãr
.
	`ÃwLßdUn™
();

1967 
brok”Bufãr
.
	`ÃwLßdUn™
();

1968 
hŞdšgSumm¬yBufãr
.
	`ÃwLßdUn™
();

1969 
hŞdšgBufãr
.
	`ÃwLßdUn™
();

1970 } 
pG’”©eAndLßd
->
	`hasNextLßdUn™
());

1971 
pG’”©eAndLßd
->
	`R–—£HŞdšgAndT¿de
();

1972 
ŒadeBufãr
.
	`»Ëa£
();

1973 
ŒadeHi¡ÜyBufãr
.
	`»Ëa£
();

1974 
£‰Ëm’tBufãr
.
	`»Ëa£
();

1975 
ÿshT¿n§ùiÚBufãr
.
	`»Ëa£
();

1976 
hŞdšgHi¡ÜyBufãr
.
	`»Ëa£
();

1977 
brok”Bufãr
.
	`»Ëa£
();

1978 
hŞdšgSumm¬yBufãr
.
	`»Ëa£
();

1979 
hŞdšgBufãr
.
	`»Ëa£
();

1980 
	}
}

1982 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_fšd_maxŒade_id
(cÚ¡ 
xù_id
,

1983 
fšd_maxŒade_id_šput_t
& 
±oš
)

1985 
	`as£¹
 (
_pssm
);

1987 
tu¶e_gu¬d
<
Œade_mª_im¶
> 
	`´Œade
(
_±¿de_mª
);

1989 
»p_row_t
 
	`low»p
(
_±¿de_mª
->
	`ts
());

1990 
»p_row_t
 
	`high»p
(
_±¿de_mª
->
	`ts
());

1992 
low»p
.
	`£t
(
_±¿de_desc
->
	`maxsize
());

1993 
high»p
.
	`£t
(
_±¿de_desc
->
	`maxsize
());

1995 
»p_row_t
 
	`¬•row
(
_±¿de_mª
->
	`ts
());

1996 
¬•row
.
	`£t
(
_±¿de_desc
->
	`maxsize
());

1998 
´Œade
->
_»p
 = &
¬•row
;

2000 
TId’t
 
Œade_id
;

2001 
gu¬d
<
šdex_sÿn_™”_im¶
<
Œade_t
> > 
t_™”
;

2003 
šdex_sÿn_™”_im¶
<
Œade_t
>* 
tmp_t_™”
;

2004 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TO:t-™”-by-ÿid-idx \n", 
xù_id
);

2005 
	`W_DO
(
_±¿de_mª
->
	`t_g‘_™”_by_šdex
(
_pssm
, 
tmp_t_™”
, 
´Œade
, 
low»p
,

2006 
high»p
, 0));

2007 
t_™”
 = 
tmp_t_™”
;

2009 
boŞ
 
eof
;

2010 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TO:t-™”-Ãxˆ\n", 
xù_id
);

2011 
	`W_DO
(
t_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œade
));

2012 !
eof
){

2013 
´Œade
->
	`g‘_v®ue
(0, 
Œade_id
);

2014 
	`W_DO
(
t_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œade
));

2016 
Ï¡T¿deId
 = ++
Œade_id
;

2018  (
_pssm
->
	`comm™_xù
());

2019 
	}
}

2021 
	gShÜeTPCEEnv
::
	$fšd_maxŒade_id
()

2023 
fšd_maxŒade_id_šput_t
 
š
;

2024 
log_¥aû_Ãeded
 = 0;

2025 
»Œy
:

2026 
	`W_COERCE
(
this
->
	`db
()->
	`begš_xù
());

2027 
	`CHECK_XCT_RETURN
(
this
->
	`xù_fšd_maxŒade_id
(1, 
š
),

2028 
log_¥aû_Ãeded
, 
»Œy
, 
this
);

2029 
	`´štf
("Ï¡¿did: %Îd\n", 
Ï¡T¿deId
);

2030 
	}
}

2049 
DEFINE_TRX
(
ShÜeTPCEEnv
,
brok”_vŞume
);

2050 
DEFINE_TRX
(
ShÜeTPCEEnv
,
cu¡om”_pos™iÚ
);

2051 
DEFINE_TRX
(
ShÜeTPCEEnv
,
m¬k‘_ãed
);

2052 
DEFINE_TRX
(
ShÜeTPCEEnv
,
m¬k‘_w©ch
);

2053 
DEFINE_TRX
(
ShÜeTPCEEnv
,
£cur™y_d‘a
);

2054 
DEFINE_TRX
(
ShÜeTPCEEnv
,
Œade_lookup
);

2055 
DEFINE_TRX
(
ShÜeTPCEEnv
,
Œade_Üd”
);

2056 
DEFINE_TRX
(
ShÜeTPCEEnv
,
Œade_»suÉ
);

2057 
DEFINE_TRX
(
ShÜeTPCEEnv
,
Œade_¡©us
);

2058 
DEFINE_TRX
(
ShÜeTPCEEnv
,
Œade_upd©e
);

2059 
DEFINE_TRX
(
ShÜeTPCEEnv
,
d©a_maš‹Çnû
);

2060 
DEFINE_TRX
(
ShÜeTPCEEnv
,
Œade_ş—nup
);

2062 
EXIT_NAMESPACE
(
û
);

	@src/workload/tpce/shore_tpce_xct_security_detail.cpp

32 
	~"wÜklßd/û/shÜe_û_’v.h
"

33 
	~"wÜklßd/û/û_cÚ¡.h
"

34 
	~"wÜklßd/û/û_šput.h
"

36 
	~<veùÜ
>

37 
	~<num”ic
>

38 
	~<®gÜ™hm
>

39 
	~<¡dio.h
>

40 
	~<¡dlib.h
>

41 
	~"wÜklßd/û/eg’/CE.h
"

42 
	~"wÜklßd/û/eg’/TxnH¬ÃssSŒuùs.h
"

43 
	~"wÜklßd/û/shÜe_û_eg’.h
"

45 
usšg
 
Çme¥aû
 
	gshÜe
;

46 
usšg
 
Çme¥aû
 
	gTPCE
;

48 
ENTER_NAMESPACE
(
û
);

56 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_£cur™y_d‘a
(cÚ¡ 
xù_id
,

57 
£cur™y_d‘a_šput_t
& 
psdš
)

60 
	`as£¹
 (
_pssm
);

61 
	`as£¹
 (
_š™Ÿlized
);

62 
	`as£¹
 (
_lßded
);

64 
tu¶e_gu¬d
<
add»ss_mª_im¶
> 
	`´add»ss
(
_·dd»ss_mª
);

65 
tu¶e_gu¬d
<
com·ny_mª_im¶
> 
	`´com·ny
(
_pcom·ny_mª
);

66 
tu¶e_gu¬d
<
com·ny_com³t™Ü_mª_im¶
> 
	`´com·nycomp
(
_pcom·ny_com³t™Ü_mª
);

67 
tu¶e_gu¬d
<
day_m¬k‘_mª_im¶
> 
	`´daym¬k‘
(
_pday_m¬k‘_mª
);

68 
tu¶e_gu¬d
<
exchªge_mª_im¶
> 
	`´exchªge
(
_³xchªge_mª
);

69 
tu¶e_gu¬d
<
fšªcŸl_mª_im¶
> 
	`´fšªcŸl
(
_pfšªcŸl_mª
);

70 
tu¶e_gu¬d
<
šdu¡ry_mª_im¶
> 
	`´šdu¡ry
(
_pšdu¡ry_mª
);

71 
tu¶e_gu¬d
<
Ï¡_Œade_mª_im¶
> 
	`´Ï¡Œade
(
_¶a¡_Œade_mª
);

72 
tu¶e_gu¬d
<
Ãws_™em_mª_im¶
> 
	`´Ãws™em
(
_²ews_™em_mª
);

73 
tu¶e_gu¬d
<
Ãws_x»f_mª_im¶
> 
	`´Ãwsx»f
(
_²ews_x»f_mª
);

74 
tu¶e_gu¬d
<
£cur™y_mª_im¶
> 
	`´£cur™y
(
_p£cur™y_mª
);

75 
tu¶e_gu¬d
<
z_code_mª_im¶
> 
	`´zcode
(
_pz_code_mª
);

77 
»p_row_t
 
	`¬•row
(
_²ews_™em_mª
->
	`ts
());

78 
¬•row
.
	`£t
(
_²ews_™em_desc
->
	`maxsize
());

80 
´add»ss
->
_»p
 = &
¬•row
;

81 
´com·ny
->
_»p
 = &
¬•row
;

82 
´com·nycomp
->
_»p
 = &
¬•row
;

83 
´daym¬k‘
->
_»p
 = &
¬•row
;

84 
´exchªge
->
_»p
 = &
¬•row
;

85 
´fšªcŸl
->
_»p
 = &
¬•row
;

86 
´šdu¡ry
->
_»p
 = &
¬•row
;

87 
´Ï¡Œade
->
_»p
 = &
¬•row
;

88 
´Ãws™em
->
_»p
 = &
¬•row
;

89 
´Ãwsx»f
->
_»p
 = &
¬•row
;

90 
´£cur™y
->
_»p
 = &
¬•row
;

91 
´zcode
->
_»p
 = &
¬•row
;

93 
»p_row_t
 
	`low»p
Ğ
_²ews_™em_mª
->
	`ts
());

94 
»p_row_t
 
	`high»p
Ğ
_²ews_™em_mª
->
	`ts
());

97 
low»p
.
	`£t
(
_²ews_™em_desc
->
	`maxsize
());

98 
high»p
.
	`£t
(
_²ews_™em_desc
->
	`maxsize
());

155 
s_Çme
[71];

156 
TId’t
 
co_id
;

157 
co_Çme
[61];

158 
¥_¿‹
[5];

159 
ûo_Çme
[47];

160 
co_desc
[151];

161 
myTime
 
İ’_d©e
;

162 
co_¡_id
[5];

163 
co_ad_lše1
[81];

164 
co_ad_lše2
[81];

165 
co_ad_town
[81];

166 
co_ad_div
[81];

167 
co_ad_z
[13];

168 
co_ad_ùry
[81];

169 
num_out
;

170 
myTime
 
¡¬t_d©e
;

171 
myTime
 
exch_d©e
;

172 
³_¿tio
;

173 
S52_wk_high
;

174 
myTime
 
S52_wk_high_d©e
;

175 
S52_wk_low
;

176 
myTime
 
S52_wk_low_d©e
;

177 
divid
;

178 
y›ld
;

179 
ex_ad_div
[81];

180 
ex_ad_ùry
[81];

181 
ex_ad_lše1
[81];

182 
ex_ad_lše2
[81];

183 
ex_ad_town
[81];

184 
ex_ad_z
[13];

185 
ex_şo£
;

186 
ex_desc
[151];

187 
ex_Çme
[101];

188 
ex_num_symb
;

189 
ex_İ’
;

190 
TId’t
 
s_co_id
;

191 
s_ex_id
[7];

193 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ:%d SD:s-idx-´ob(%s)\n", 
xù_id
, 
psdš
.
_symbŞ
);

194 
	`W_DO
(
_p£cur™y_mª
->
	`s_šdex_´obe
(
_pssm
, 
´£cur™y
, 
psdš
.
_symbŞ
));

196 
´£cur™y
->
	`g‘_v®ue
(3, 
s_Çme
, 71);

197 
´£cur™y
->
	`g‘_v®ue
(4, 
s_ex_id
, 7);

198 
´£cur™y
->
	`g‘_v®ue
(5, 
s_co_id
);

199 
´£cur™y
->
	`g‘_v®ue
(6, 
num_out
);

200 
´£cur™y
->
	`g‘_v®ue
(7, 
¡¬t_d©e
);

201 
´£cur™y
->
	`g‘_v®ue
(8, 
exch_d©e
);

202 
´£cur™y
->
	`g‘_v®ue
(9, 
³_¿tio
);

203 
´£cur™y
->
	`g‘_v®ue
(10, 
S52_wk_high
);

204 
´£cur™y
->
	`g‘_v®ue
(11, 
S52_wk_high_d©e
);

205 
´£cur™y
->
	`g‘_v®ue
(12, 
S52_wk_low
);

206 
´£cur™y
->
	`g‘_v®ue
(13, 
S52_wk_low_d©e
);

207 
´£cur™y
->
	`g‘_v®ue
(14, 
divid
);

208 
´£cur™y
->
	`g‘_v®ue
(15, 
y›ld
);

210 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d SD:co-idx-´ob(%ldè\n", 
xù_id
, 
s_co_id
);

211 
	`W_DO
(
_pcom·ny_mª
->
	`co_šdex_´obe
(
_pssm
, 
´com·ny
, 
s_co_id
));

213 
´com·ny
->
	`g‘_v®ue
(0, 
co_id
);

214 
´com·ny
->
	`g‘_v®ue
(1, 
co_¡_id
, 5);

215 
´com·ny
->
	`g‘_v®ue
(2, 
co_Çme
, 61);

216 
´com·ny
->
	`g‘_v®ue
(4, 
¥_¿‹
, 5);

217 
´com·ny
->
	`g‘_v®ue
(5, 
ûo_Çme
, 47);

218 
TId’t
 
co_ad_id
;

219 
´com·ny
->
	`g‘_v®ue
(6, 
co_ad_id
);

220 
´com·ny
->
	`g‘_v®ue
(7, 
co_desc
, 151);

221 
´com·ny
->
	`g‘_v®ue
(8, 
İ’_d©e
);

224 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d SD:ad-idx-´ob(%ldè\n", 
xù_id
, 
co_ad_id
);

225 
	`W_DO
(
_·dd»ss_mª
->
	`ad_šdex_´obe
(
_pssm
, 
´add»ss
, 
co_ad_id
));

227 
´add»ss
->
	`g‘_v®ue
(1, 
co_ad_lše1
, 81);

228 
´add»ss
->
	`g‘_v®ue
(2, 
co_ad_lše2
, 81);

229 
ÿ_ad_zc_code
[13];

230 
´add»ss
->
	`g‘_v®ue
(3, 
ÿ_ad_zc_code
, 13);

232 
	`TRACE
(
TRACE_TRX_FLOW
, "Aµ:%d SD:zc-idx-´ob(%s)\n", 
xù_id
, 
ÿ_ad_zc_code
);

233 
	`W_DO
(
_pz_code_mª
->
	`zc_šdex_´obe
(
_pssm
, 
´zcode
, 
ÿ_ad_zc_code
));

235 
´zcode
->
	`g‘_v®ue
(1, 
co_ad_town
, 81);

236 
´zcode
->
	`g‘_v®ue
(2, 
co_ad_div
, 81);

238 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d SD:ex-idx-´ob(%sè\n", 
xù_id
, 
s_ex_id
);

239 
	`W_DO
(
_³xchªge_mª
->
	`ex_šdex_´obe
(
_pssm
, 
´exchªge
, 
s_ex_id
));

241 
´exchªge
->
	`g‘_v®ue
(1, 
ex_Çme
, 101);

242 
´exchªge
->
	`g‘_v®ue
(2, 
ex_num_symb
);

243 
´exchªge
->
	`g‘_v®ue
(3, 
ex_İ’
);

244 
´exchªge
->
	`g‘_v®ue
(4, 
ex_şo£
);

245 
´exchªge
->
	`g‘_v®ue
(5, 
ex_desc
, 151);

246 
TId’t
 
ex_ad_id
;

247 
´exchªge
->
	`g‘_v®ue
(6, 
ex_ad_id
);

250 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d SD:ad-idx-´ob(%ldè\n", 
xù_id
, 
ex_ad_id
);

251 
	`W_DO
(
_·dd»ss_mª
->
	`ad_šdex_´obe
(
_pssm
, 
´add»ss
, 
ex_ad_id
));

253 
´add»ss
->
	`g‘_v®ue
(1, 
ex_ad_lše1
, 81);

254 
´add»ss
->
	`g‘_v®ue
(2, 
ex_ad_lše2
, 81);

255 
´add»ss
->
	`g‘_v®ue
(3, 
ex_ad_z
, 13);

256 
´add»ss
->
	`g‘_v®ue
(4, 
ex_ad_ùry
, 81);

258 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d SD:zc-idx-´ob(%sè\n", 
xù_id
, 
ex_ad_z
);

259 
	`W_DO
(
_pz_code_mª
->
	`zc_šdex_´obe
(
_pssm
, 
´zcode
, 
ex_ad_z
));

261 
´zcode
->
	`g‘_v®ue
(1, 
ex_ad_town
, 81);

262 
´zcode
->
	`g‘_v®ue
(2, 
ex_ad_div
, 81);

275 
ı_co_Çme
[3][61];

276 
š_Çme
[3][51];

278 
gu¬d
< 
šdex_sÿn_™”_im¶
<
com·ny_com³t™Ü_t
> > 
cc_™”
;

280 
šdex_sÿn_™”_im¶
<
com·ny_com³t™Ü_t
>* 
tmp_cc_™”
;

281 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d SD:cc-get-iter-by-index (%ld) \n",

282 
xù_id
, 
co_id
);

283 
	`W_DO
(
_pcom·ny_com³t™Ü_mª
->
	`cc_g‘_™”_by_šdex
(
_pssm
, 
tmp_cc_™”
,

284 
´com·nycomp
, 
low»p
,

285 
high»p
, 
co_id
));

286 
cc_™”
 = 
tmp_cc_™”
;

288 
boŞ
 
eof
;

289 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d SD:cc-™”-Ãxˆ\n", 
xù_id
);

290 
	`W_DO
(
cc_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´com·nycomp
));

291 
i
 = 0; i < 3 && !
eof
; i++){

292 
TId’t
 
ı_comp_co_id
;

293 
ı_š_id
[3];

295 
´com·nycomp
->
	`g‘_v®ue
(1, 
ı_comp_co_id
);

296 
´com·nycomp
->
	`g‘_v®ue
(2, 
ı_š_id
, 3);

298 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ:%d SD:š-idx-´ob(%s)\n", 
xù_id
, 
ı_š_id
);

299 
	`W_DO
(
_pšdu¡ry_mª
->
	`š_šdex_´obe
(
_pssm
, 
´šdu¡ry
, 
ı_š_id
));

301 
´šdu¡ry
->
	`g‘_v®ue
(1, 
š_Çme
[
i
], 51);

303 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d SD:co-idx-probe (%ld) \n",

304 
xù_id
, 
ı_comp_co_id
);

305 
	`W_DO
(
_pcom·ny_mª
->
	`co_šdex_´obe
(
_pssm
, 
´com·ny
, 
ı_comp_co_id
));

307 
´com·ny
->
	`g‘_v®ue
(2, 
ı_co_Çme
[
i
], 61);

309 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d SD:cc-™”-Ãxˆ\n", 
xù_id
);

310 
	`W_DO
(
cc_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´com·nycomp
));

336 
fš_y—r
[20];

337 
fš_qŒ
[20];

338 
myTime
 
fš_¡¬t_d©e
[20];

339 
fš_»v
[20];

340 
fš_Ãt_—º
[20];

341 
fš_basic_•s
[20];

342 
fš_dut_•s
[20];

343 
fš_m¬gš
[20];

344 
fš_šv’t
[20];

345 
fš_as£ts
[20];

346 
fš_lŸb
[20];

347 
fš_out_basic
[20];

348 
fš_out_dut
[20];

350 
gu¬d
< 
šdex_sÿn_™”_im¶
<
fšªcŸl_t
> > 
fi_™”
;

352 
šdex_sÿn_™”_im¶
<
fšªcŸl_t
>* 
tmp_fi_™”
;

353 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d SD:fi-get-iter-by-idx (%ld) \n",

354 
xù_id
, 
co_id
);

355 
	`W_DO
(
_pfšªcŸl_mª
->
	`fi_g‘_™”_by_šdex
(
_pssm
, 
tmp_fi_™”
,

356 
´fšªcŸl
, 
low»p
, 
high»p
,

357 
co_id
));

358 
fi_™”
 = 
tmp_fi_™”
;

362 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d SD:fi-™”-Ãxˆ\n", 
xù_id
);

363 
	`W_DO
(
fi_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´fšªcŸl
));

364 
fš_Ën
;

365 
fš_Ën
 = 0; fš_ËÀ< 20 && !
eof
; fin_len++){

366 
fi_y—r
;

367 
´fšªcŸl
->
	`g‘_v®ue
(1, 
fi_y—r
);

368 
fš_y—r
[
fš_Ën
] = 
fi_y—r
;

370 
fi_qŒ
;

371 
´fšªcŸl
->
	`g‘_v®ue
(2, 
fi_qŒ
);

372 
fš_qŒ
[
fš_Ën
] = 
fi_qŒ
;

374 
myTime
 
fi_qŒ_¡¬t_d©e
;

375 
´fšªcŸl
->
	`g‘_v®ue
(3, 
fi_qŒ_¡¬t_d©e
);

376 
fš_¡¬t_d©e
[
fš_Ën
] = 
fi_qŒ_¡¬t_d©e
;

378 
fi_»v’ue
;

379 
´fšªcŸl
->
	`g‘_v®ue
(4, 
fi_»v’ue
);

380 
fš_»v
[
fš_Ën
] = 
fi_»v’ue
;

382 
fi_Ãt_—º
;

383 
´fšªcŸl
->
	`g‘_v®ue
(5, 
fi_Ãt_—º
);

384 
fš_Ãt_—º
[
fš_Ën
] = 
fi_Ãt_—º
;

386 
fi_basic_•s
;

387 
´fšªcŸl
->
	`g‘_v®ue
(6, 
fi_basic_•s
);

388 
fš_basic_•s
[
fš_Ën
] = 
fi_basic_•s
;

390 
fi_dut_•s
;

391 
´fšªcŸl
->
	`g‘_v®ue
(7, 
fi_dut_•s
);

392 
fš_dut_•s
[
fš_Ën
] = 
fi_dut_•s
;

394 
fi_m¬gš
;

395 
´fšªcŸl
->
	`g‘_v®ue
(8, 
fi_m¬gš
);

396 
fš_m¬gš
[
fš_Ën
] = 
fi_m¬gš
;

398 
fi_šv’tÜy
;

399 
´fšªcŸl
->
	`g‘_v®ue
(9, 
fi_šv’tÜy
);

400 
fš_šv’t
[
fš_Ën
] = 
fi_šv’tÜy
;

402 
fi_as£ts
;

403 
´fšªcŸl
->
	`g‘_v®ue
(10, 
fi_as£ts
);

404 
fš_as£ts
[
fš_Ën
] = 
fi_as£ts
;

406 
fi_lŸb™y
;

407 
´fšªcŸl
->
	`g‘_v®ue
(11, 
fi_lŸb™y
);

408 
fš_lŸb
[
fš_Ën
] = 
fi_lŸb™y
;

410 
fi_out_basics
;

411 
´fšªcŸl
->
	`g‘_v®ue
(12, 
fi_out_basics
);

412 
fš_out_basic
[
fš_Ën
] = 
fi_out_basics
;

414 
fi_out_dut
;

415 
´fšªcŸl
->
	`g‘_v®ue
(13, 
fi_out_dut
);

416 
fš_out_dut
[
fš_Ën
] = 
fi_out_dut
;

418 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d SD:fi-™”-Ãxˆ\n", 
xù_id
);

419 
	`W_DO
(
fi_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´fšªcŸl
));

421 
	`as£¹
(
fš_Ën
 =ğ
max_fš_Ën
);

439 
¬¿y_gu¬d_t
<
myTime
> 
day_d©e
 = 
Ãw
 myTime[
psdš
.
_max_rows_to_»tuº
];

440 
¬¿y_gu¬d_t
<> 
day_şo£
 = 
Ãw
 [
psdš
.
_max_rows_to_»tuº
];

441 
¬¿y_gu¬d_t
<> 
day_high
 = 
Ãw
 [
psdš
.
_max_rows_to_»tuº
];

442 
¬¿y_gu¬d_t
<> 
day_low
 = 
Ãw
 [
psdš
.
_max_rows_to_»tuº
];

443 
¬¿y_gu¬d_t
<> 
day_vŞ
 = 
Ãw
 [
psdš
.
_max_rows_to_»tuº
];

445 
gu¬d
< 
šdex_sÿn_™”_im¶
<
day_m¬k‘_t
> > 
dm_™”
;

447 
šdex_sÿn_™”_im¶
<
day_m¬k‘_t
>* 
tmp_dm_™”
;

448 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d SD:dm-get-iter-by-idx (%s) (%ld) \n",

449 
xù_id
, 
psdš
.
_symbŞ
,…sdš.
_¡¬t_day
);

450 
	`W_DO
(
_pday_m¬k‘_mª
->
	`dm_g‘_™”_by_šdex
(
_pssm
, 
tmp_dm_™”
,

451 
´daym¬k‘
, 
low»p
,

452 
high»p
, 
psdš
.
_symbŞ
,

453 
psdš
.
_¡¬t_day
));

454 
dm_™”
 = 
tmp_dm_™”
;

458 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d SD:dm-™”-Ãxˆ\n", 
xù_id
);

459 
	`W_DO
(
dm_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´daym¬k‘
));

460 
day_Ën
;

461 
day_Ën
 = 0; day_ËÀ< 
psdš
.
_max_rows_to_»tuº
 && !
eof
; day_len++){

462 
´daym¬k‘
->
	`g‘_v®ue
(0, 
day_d©e
[
day_Ën
]);

463 
´daym¬k‘
->
	`g‘_v®ue
(2, 
day_şo£
[
day_Ën
]);

464 
´daym¬k‘
->
	`g‘_v®ue
(3, 
day_high
[
day_Ën
]);

465 
´daym¬k‘
->
	`g‘_v®ue
(4, 
day_low
[
day_Ën
]);

466 
´daym¬k‘
->
	`g‘_v®ue
(5, 
day_vŞ
[
day_Ën
]);

468 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d SD:dm-iter-next %ld \n",

469 
xù_id
, 
day_d©e
[
day_Ën
]);

470 
	`W_DO
(
dm_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´daym¬k‘
));

472 
	`as£¹
(
day_Ën
 >ğ
mš_day_Ën
 && day_ËÀ<ğ
max_day_Ën
);

484 
	`TRACE
(
TRACE_TRX_FLOW
, "Aµ:%d SD:É-idx-´ob(%s)\n", 
xù_id
, 
psdš
.
_symbŞ
);

485 
	`W_DO
(
_¶a¡_Œade_mª
->
	`É_šdex_´obe
(
_pssm
, 
´Ï¡Œade
, 
psdš
.
_symbŞ
));

487 
Ï¡_´iû
, 
Ï¡_İ’
, 
Ï¡_vŞ
;

488 
´Ï¡Œade
->
	`g‘_v®ue
(2, 
Ï¡_´iû
);

489 
´Ï¡Œade
->
	`g‘_v®ue
(3, 
Ï¡_İ’
);

490 
´Ï¡Œade
->
	`g‘_v®ue
(4, 
Ï¡_vŞ
);

492 
Ãws_™em
[2][
max_Ãws_™em_size
+1];

493 
myTime
 
Ãws_dts
[2];

494 
Ãws_¤c
[2][31];

495 
Ãws_auth
[2][31];

496 
Ãws_h—dlše
[2][81];

497 
Ãws_summ¬y
[2][256];

499 
Ãws_Ën
;

500 if(
psdš
.
_acûss_lob_æag
) {

516 
gu¬d
< 
šdex_sÿn_™”_im¶
<
Ãws_x»f_t
> > 
nx_™”
;

518 
šdex_sÿn_™”_im¶
<
Ãws_x»f_t
>* 
tmp_nx_™”
;

519 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d SD:nx-get-iter-by-idx (%ld) \n",

520 
xù_id
, 
co_id
);

521 
	`W_DO
(
_²ews_x»f_mª
->
	`nx_g‘_™”_by_šdex
(
_pssm
, 
tmp_nx_™”
,

522 
´Ãwsx»f
, 
low»p
,

523 
high»p
, 
co_id
));

524 
nx_™”
 = 
tmp_nx_™”
;

527 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d SD:nx-™”-Ãxˆ\n", 
xù_id
);

528 
	`W_DO
(
nx_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Ãwsx»f
));

529 
Ãws_Ën
 = 0;‚ews_ËÀ< 2 && !
eof
;‚ews_len++){

530 
TId’t
 
nx_ni_id
;

531 
´Ãwsx»f
->
	`g‘_v®ue
(0, 
nx_ni_id
);

533 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d SD:nx-idx-probe (%ld) \n",

534 
xù_id
, 
nx_ni_id
);

535 
	`W_DO
(
_²ews_™em_mª
->
	`ni_šdex_´obe
(
_pssm
, 
´Ãws™em
, 
nx_ni_id
));

537 
´Ãws™em
->
	`g‘_v®ue
(3, 
Ãws_™em
[
Ãws_Ën
], 
max_Ãws_™em_size
+1);

538 
´Ãws™em
->
	`g‘_v®ue
(4, 
Ãws_dts
[
Ãws_Ën
]);

539 
´Ãws™em
->
	`g‘_v®ue
(5, 
Ãws_¤c
[
Ãws_Ën
], 31);

540 
´Ãws™em
->
	`g‘_v®ue
(6, 
Ãws_auth
[
Ãws_Ën
], 31);

541 
	`¡rıy
(
Ãws_h—dlše
[
Ãws_Ën
], "");

542 
	`¡rıy
(
Ãws_summ¬y
[
Ãws_Ën
], "");

544 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d SD:nx-iter-next %ld \n",

545 
xù_id
, 
nx_ni_id
);

546 
	`W_DO
(
nx_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Ãwsx»f
));

564 
gu¬d
< 
šdex_sÿn_™”_im¶
<
Ãws_x»f_t
> > 
nx_™”
;

566 
šdex_sÿn_™”_im¶
<
Ãws_x»f_t
>* 
tmp_nx_™”
;

567 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d SD:nx-get-iter-by-idx (%ld) \n",

568 
xù_id
, 
co_id
);

569 
	`W_DO
(
_²ews_x»f_mª
->
	`nx_g‘_™”_by_šdex
(
_pssm
, 
tmp_nx_™”
,

570 
´Ãwsx»f
,

571 
low»p
, 
high»p
, 
co_id
));

572 
nx_™”
 = 
tmp_nx_™”
;

575 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d SD:nx-™”-Ãxˆ\n", 
xù_id
);

576 
	`W_DO
(
nx_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Ãwsx»f
));

577 
Ãws_Ën
 = 0;‚ews_ËÀ< 2 && !
eof
;‚ews_len++){

578 
TId’t
 
nx_ni_id
;

579 
´Ãwsx»f
->
	`g‘_v®ue
(0, 
nx_ni_id
);

581 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d SD:nx-idx-probe (%ld) \n",

582 
xù_id
, 
nx_ni_id
);

583 
	`W_DO
(
_²ews_™em_mª
->
	`ni_šdex_´obe
(
_pssm
, 
´Ãws™em
, 
nx_ni_id
));

585 
	`¡rıy
(
Ãws_™em
[
Ãws_Ën
], "");

586 
´Ãws™em
->
	`g‘_v®ue
(1, 
Ãws_h—dlše
[
Ãws_Ën
], 81);

587 
´Ãws™em
->
	`g‘_v®ue
(2, 
Ãws_summ¬y
[
Ãws_Ën
], 256);

588 
´Ãws™em
->
	`g‘_v®ue
(4, 
Ãws_dts
[
Ãws_Ën
]);

589 
´Ãws™em
->
	`g‘_v®ue
(5, 
Ãws_¤c
[
Ãws_Ën
], 31);

590 
´Ãws™em
->
	`g‘_v®ue
(6, 
Ãws_auth
[
Ãws_Ën
], 31);

592 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d SD:nx-iter-next %ld \n",

593 
xù_id
, 
nx_ni_id
);

594 
	`W_DO
(
nx_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Ãwsx»f
));

597 
	`as£¹
(
Ãws_Ën
 =ğ
max_Ãws_Ën
);

599 #ifdeà
PRINT_TRX_RESULTS


602 
¿dd»ss
.
	`´št_tu¶e
();

603 
rcom·ny
.
	`´št_tu¶e
();

604 
rcom·nycomp
.
	`´št_tu¶e
();

605 
rdaym¬k‘
.
	`´št_tu¶e
();

606 
»xchªge
.
	`´št_tu¶e
();

607 
rfšªcŸl
.
	`´št_tu¶e
();

608 
ršdu¡ry
.
	`´št_tu¶e
();

609 
¾a¡Œade
.
	`´št_tu¶e
();

610 
ºews™em
.
	`´št_tu¶e
();

611 
ºewsx»f
.
	`´št_tu¶e
();

612 
r£cur™y
.
	`´št_tu¶e
();

613 
rzcode
.
	`´št_tu¶e
();

616  
RCOK
;

618 
	}
}

621 
EXIT_NAMESPACE
(
û
);

	@src/workload/tpce/shore_tpce_xct_trade_cleanup.cpp

32 
	~"wÜklßd/û/shÜe_û_’v.h
"

33 
	~"wÜklßd/û/û_cÚ¡.h
"

34 
	~"wÜklßd/û/û_šput.h
"

36 
	~<veùÜ
>

37 
	~<num”ic
>

38 
	~<®gÜ™hm
>

39 
	~<¡dio.h
>

40 
	~<¡dlib.h
>

41 
	~"wÜklßd/û/eg’/CE.h
"

42 
	~"wÜklßd/û/eg’/TxnH¬ÃssSŒuùs.h
"

43 
	~"wÜklßd/û/shÜe_û_eg’.h
"

45 
usšg
 
Çme¥aû
 
	gshÜe
;

46 
usšg
 
Çme¥aû
 
	gTPCE
;

48 
ENTER_NAMESPACE
(
û
);

56 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_Œade_ş—nup
(cÚ¡ 
xù_id
,

57 
Œade_ş—nup_šput_t
& 
±cš
)

60 
	`as£¹
 (
_pssm
);

61 
	`as£¹
 (
_š™Ÿlized
);

62 
	`as£¹
 (
_lßded
);

64 
tu¶e_gu¬d
<
Œade_mª_im¶
> 
	`´Œade
(
_±¿de_mª
);

65 
tu¶e_gu¬d
<
Œade_hi¡Üy_mª_im¶
> 
	`´Œadehi¡
(
_±¿de_hi¡Üy_mª
);

66 
tu¶e_gu¬d
<
Œade_»que¡_mª_im¶
> 
	`´Œad”eq
(
_±¿de_»que¡_mª
);

68 
»p_row_t
 
	`¬•row
(
_±¿de_mª
->
	`ts
());

69 
¬•row
.
	`£t
(
_±¿de_desc
->
	`maxsize
());

71 
´Œad”eq
->
_»p
 = &
¬•row
;

72 
´Œade
->
_»p
 = &
¬•row
;

73 
´Œadehi¡
->
_»p
 = &
¬•row
;

75 
»p_row_t
 
	`low»p
Ğ
_±¿de_mª
->
	`ts
());

76 
»p_row_t
 
	`high»p
Ğ
_±¿de_mª
->
	`ts
());

79 
low»p
.
	`£t
(
_±¿de_desc
->
	`maxsize
());

80 
high»p
.
	`£t
(
_±¿de_desc
->
	`maxsize
());

82 
TId’t
 
t_id
;

83 
TId’t
 
Œ_t_id
;

84 
myTime
 
now_dts
;

102 
gu¬d
<
bË_sÿn_™”_im¶
<
Œade_»que¡_t
> > 
Œ_™”
;

104 
bË_sÿn_™”_im¶
<
Œade_»que¡_t
>* 
tmp_Œ_™”
;

105 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TC:Œ-g‘-bË-™” \n", 
xù_id
);

106 
	`W_DO
(
_±¿de_»que¡_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_Œ_™”
));

107 
Œ_™”
 = 
tmp_Œ_™”
;

111 
»p_row_t
 
	`sÜŒ•
(
_±¿de_mª
->
	`ts
());

112 
sÜŒ•
.
	`£t
(
_±¿de_desc
->
	`maxsize
());

114 
asc_sÜt_bufãr_t
 
	`Œ_li¡
(1);

116 
Œ_li¡
.
	`£tup
(0, 
SQL_LONG
);

118 
bË_row_t
 
	`rsb
(&
Œ_li¡
);

119 
asc_sÜt_mª_im¶
 
	`Œ_sÜ‹r
(&
Œ_li¡
, &
sÜŒ•
);

121 
boŞ
 
eof
;

122 
	`W_DO
(
Œ_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œad”eq
));

123 !
eof
){

124 
´Œad”eq
->
	`g‘_v®ue
(0, 
Œ_t_id
);

126 
rsb
.
	`£t_v®ue
(0, 
Œ_t_id
);

127 
Œ_sÜ‹r
.
	`add_tu¶e
(
rsb
);

129 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TC:Œ-d–‘e- \n", 
xù_id
);

130 
	`W_DO
(
_±¿de_»que¡_mª
->
	`d–‘e_tu¶e
(
_pssm
, 
´Œad”eq
));

132 
	`W_DO
(
Œ_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œad”eq
));

135 
asc_sÜt_™”_im¶
 
	`Œ_li¡_sÜt_™”
(
_pssm
, &
Œ_li¡
, &
Œ_sÜ‹r
);

137 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TC:Œ-sÜt-™”-Ãxˆ\n", 
xù_id
);

138 
	`W_DO
(
Œ_li¡_sÜt_™”
.
	`Ãxt
(
_pssm
, 
eof
, 
rsb
));

139 !
eof
){

140 
rsb
.
	`g‘_v®ue
(0, 
Œ_t_id
);

142 
now_dts
 = 
	`time
(
NULL
);

155 
´Œadehi¡
->
	`£t_v®ue
(0, 
Œ_t_id
);

156 
´Œadehi¡
->
	`£t_v®ue
(1, 
now_dts
);

157 
´Œadehi¡
->
	`£t_v®ue
(2, 
±cš
.
_¡_subm™‹d_id
);

159 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TC:th-add-tuple (%ld) (%ld) (%s) \n",

160 
xù_id
, 
Œ_t_id
, 
now_dts
, 
±cš
.
_¡_subm™‹d_id
);

161 
	`W_DO
(
_±¿de_hi¡Üy_mª
->
	`add_tu¶e
(
_pssm
, 
´Œadehi¡
));

172 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TC:t-update (%ld) (%ld) (%s) \n",

173 
xù_id
, 
Œ_t_id
, 
now_dts
, 
±cš
.
_¡_ÿnûËd_id
);

174 
	`W_DO
(
_±¿de_mª
->
	`t_upd©e_dts_¡did_by_šdex
(
_pssm
, 
´Œade
, 
Œ_t_id
,

175 
now_dts
,

176 
±cš
.
_¡_ÿnûËd_id
));

189 
´Œadehi¡
->
	`£t_v®ue
(0, 
Œ_t_id
);

190 
´Œadehi¡
->
	`£t_v®ue
(1, 
now_dts
);

191 
´Œadehi¡
->
	`£t_v®ue
(2, 
±cš
.
_¡_ÿnûËd_id
);

193 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TC:th-add-tuple (%ld) (%ld) (%s) \n",

194 
xù_id
, 
Œ_t_id
, 
now_dts
, 
±cš
.
_¡_ÿnûËd_id
);

195 
	`W_DO
(
_±¿de_hi¡Üy_mª
->
	`add_tu¶e
(
_pssm
, 
´Œadehi¡
));

197 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TC:Œ-sÜt-™”-Ãxˆ\n", 
xù_id
);

198 
	`W_DO
(
Œ_li¡_sÜt_™”
.
	`Ãxt
(
_pssm
, 
eof
, 
rsb
));

216 
gu¬d
<
šdex_sÿn_™”_im¶
<
Œade_t
> > 
t_™”
;

218 
šdex_sÿn_™”_im¶
<
Œade_t
>* 
tmp_t_™”
;

219 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TC:t-™”-by-idx \n", 
xù_id
);

220 
	`W_DO
(
_±¿de_mª
->
	`t_g‘_™”_by_šdex
(
_pssm
, 
tmp_t_™”
, 
´Œade
, 
low»p
,

221 
high»p
, 
±cš
.
_Œade_id
));

222 
t_™”
 = 
tmp_t_™”
;

225 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TC:t-™”-Ãxˆ\n", 
xù_id
);

226 
	`W_DO
(
t_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œade
));

227 !
eof
){

228 
t_¡_id
[5];

229 
´Œade
->
	`g‘_v®ue
(2, 
t_¡_id
, 5);

231 if(
	`¡rcmp
(
t_¡_id
, 
±cš
.
_¡_subm™‹d_id
) == 0){

232 
now_dts
 = 
	`time
(
NULL
);

242 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TC:t-update (%ld) (%ld) (%s) \n",

243 
xù_id
, 
t_id
, 
now_dts
, 
±cš
.
_¡_ÿnûËd_id
);

244 
	`W_DO
(
_±¿de_mª
->
	`t_upd©e_dts_¡did_by_šdex
(
_pssm
, 
´Œade
, 
t_id
,

245 
now_dts
,

246 
±cš
.
_¡_ÿnûËd_id
));

259 
´Œadehi¡
->
	`£t_v®ue
(0, 
t_id
);

260 
´Œadehi¡
->
	`£t_v®ue
(1, 
now_dts
);

261 
´Œadehi¡
->
	`£t_v®ue
(2, 
±cš
.
_¡_ÿnûËd_id
);

263 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TC:th-add-tuple (%ld) (%ld) (%s) \n",

264 
xù_id
, 
t_id
, 
now_dts
, 
±cš
.
_¡_ÿnûËd_id
);

265 
	`W_DO
(
_±¿de_hi¡Üy_mª
->
	`add_tu¶e
(
_pssm
, 
´Œadehi¡
));

267 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TC:t-™”-Ãxˆ\n", 
xù_id
);

268 
	`W_DO
(
t_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œade
));

271 #ifdeà
PRINT_TRX_RESULTS


274 
¹¿d”eq
.
	`´št_tu¶e
();

275 
¹¿de
.
	`´št_tu¶e
();

276 
¹¿dehi¡
.
	`´št_tu¶e
();

279  
RCOK
;

281 
	}
}

284 
EXIT_NAMESPACE
(
û
);

	@src/workload/tpce/shore_tpce_xct_trade_lookup.cpp

32 
	~"wÜklßd/û/shÜe_û_’v.h
"

33 
	~"wÜklßd/û/û_cÚ¡.h
"

34 
	~"wÜklßd/û/û_šput.h
"

36 
	~<veùÜ
>

37 
	~<num”ic
>

38 
	~<®gÜ™hm
>

39 
	~<¡dio.h
>

40 
	~<¡dlib.h
>

41 
	~"wÜklßd/û/eg’/CE.h
"

42 
	~"wÜklßd/û/eg’/TxnH¬ÃssSŒuùs.h
"

43 
	~"wÜklßd/û/shÜe_û_eg’.h
"

45 
usšg
 
Çme¥aû
 
	gshÜe
;

46 
usšg
 
Çme¥aû
 
	gTPCE
;

48 
ENTER_NAMESPACE
(
û
);

56 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_Œade_lookup
(cÚ¡ 
xù_id
,

57 
Œade_lookup_šput_t
& 
±lš
)

60 
	`as£¹
 (
_pssm
);

61 
	`as£¹
 (
_š™Ÿlized
);

62 
	`as£¹
 (
_lßded
);

64 
tu¶e_gu¬d
<
Œade_mª_im¶
> 
	`´Œade
(
_±¿de_mª
);

65 
tu¶e_gu¬d
<
Œade_ty³_mª_im¶
> 
	`´Œad‘y³
(
_±¿de_ty³_mª
);

66 
tu¶e_gu¬d
<
£‰Ëm’t_mª_im¶
> 
	`´£‰Ëm’t
(
_p£‰Ëm’t_mª
);

67 
tu¶e_gu¬d
<
ÿsh_Œª§ùiÚ_mª_im¶
> 
	`´ÿshŒªs
(
_pÿsh_Œª§ùiÚ_mª
);

68 
tu¶e_gu¬d
<
Œade_hi¡Üy_mª_im¶
> 
	`´Œadehi¡
(
_±¿de_hi¡Üy_mª
);

69 
tu¶e_gu¬d
<
hŞdšg_hi¡Üy_mª_im¶
> 
	`´hŞdšghi¡Üy
(
_phŞdšg_hi¡Üy_mª
);

71 
»p_row_t
 
	`¬•row
(
_±¿de_mª
->
	`ts
());

73 
¬•row
.
	`£t
(
_±¿de_desc
->
	`maxsize
());

75 
´Œade
->
_»p
 = &
¬•row
;

76 
´Œad‘y³
->
_»p
 = &
¬•row
;

77 
´£‰Ëm’t
->
_»p
 = &
¬•row
;

78 
´ÿshŒªs
->
_»p
 = &
¬•row
;

79 
´Œadehi¡
->
_»p
 = &
¬•row
;

80 
´hŞdšghi¡Üy
->
_»p
 = &
¬•row
;

82 
»p_row_t
 
	`low»p
(
_±¿de_mª
->
	`ts
());

83 
»p_row_t
 
	`high»p
(
_±¿de_mª
->
	`ts
());

86 
low»p
.
	`£t
(
_±¿de_desc
->
	`maxsize
());

87 
high»p
.
	`£t
(
_±¿de_desc
->
	`maxsize
());

89 
max_Œades
 = 
±lš
.
_max_Œades
;

91 
¬¿y_gu¬d_t
<> 
bid_´iû
 = 
Ãw
 [
max_Œades
];

92 
¬¿y_gu¬d_t
< [50] > 
exec_Çme
 = 
Ãw
 [
max_Œades
][50];

93 
¬¿y_gu¬d_t
<
boŞ
> 
is_ÿsh
 = 
Ãw
 boŞ[
max_Œades
];

94 
¬¿y_gu¬d_t
<
boŞ
> 
is_m¬k‘
 = 
Ãw
 boŞ[
max_Œades
];

95 
¬¿y_gu¬d_t
<> 
Œade_´iû
 = 
Ãw
 [
max_Œades
];

96 
¬¿y_gu¬d_t
<
TId’t
> 
Œade_li¡
 = 
Ãw
 TId’t[
max_Œades
];

97 
¬¿y_gu¬d_t
<> 
£‰Ëm’t_amouÁ
 = 
Ãw
 [
max_Œades
];

98 
¬¿y_gu¬d_t
<
myTime
> 
£‰Ëm’t_ÿsh_due_d©e
 = 
Ãw
 myTime[
max_Œades
];

99 
¬¿y_gu¬d_t
< [41] > 
£‰Ëm’t_ÿsh_ty³
 = 
Ãw
 [
max_Œades
][41];

100 
¬¿y_gu¬d_t
<> 
ÿsh_Œª§ùiÚ_amouÁ
 = 
Ãw
 [
max_Œades
];

101 
¬¿y_gu¬d_t
<
myTime
> 
ÿsh_Œª§ùiÚ_dts
 = 
Ãw
 myTime[
max_Œades
];

102 
¬¿y_gu¬d_t
< [101] > 
ÿsh_Œª§ùiÚ_Çme
 = 
Ãw
 [
max_Œades
][101];

103 
¬¿y_gu¬d_t
< 
myTime
[3] > 
Œade_hi¡Üy_dts
 = 
Ãw
 myTime[
max_Œades
][3];

104 
¬¿y_gu¬d_t
< [3][5] > 
Œade_hi¡Üy_¡©us_id
 = 
Ãw
 [
max_Œades
][3][5];

105 
¬¿y_gu¬d_t
<
TId’t
> 
acù_id
 = 
Ãw
 TId’t[
max_Œades
];

106 
¬¿y_gu¬d_t
<> 
quªt™y
 = 
Ãw
 [
max_Œades
];

107 
¬¿y_gu¬d_t
< [4] > 
Œade_ty³
 = 
Ãw
 [
max_Œades
][4];

108 
¬¿y_gu¬d_t
<
myTime
> 
Œade_dts
 = 
Ãw
 myTime[
max_Œades
];

111 
num_found
 = 0;

112 if(
±lš
.
_äame_to_execu‹
 == 1) {

113 
num_found
 = 0;‚um_found < 
max_Œades
;‚um_found++){

128 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TL:t-idx-probe (%ld) \n",

129 
xù_id
, 
±lš
.
_Œade_id
[
num_found
]);

130 
	`W_DO
(
_±¿de_mª
->
	`t_šdex_´obe
(
_pssm
, 
´Œade
,

131 
±lš
.
_Œade_id
[
num_found
]));

133 
´Œade
->
	`g‘_v®ue
(4, 
is_ÿsh
[
num_found
]);

134 
´Œade
->
	`g‘_v®ue
(7, 
bid_´iû
[
num_found
]);

135 
´Œade
->
	`g‘_v®ue
(9, 
exec_Çme
[
num_found
], 50);

136 
´Œade
->
	`g‘_v®ue
(10, 
Œade_´iû
[
num_found
]);

137 
‰_id
[4];

138 
´Œade
->
	`g‘_v®ue
(3, 
‰_id
, 4);

140 
	`TRACE
Ğ
TRACE_TRX_FLOW
,"Aµ:%d TL:‰-idx-´ob(%s)\n", 
xù_id
, 
‰_id
);

141 
	`W_DO
(
_±¿de_ty³_mª
->
	`‰_šdex_´obe
(
_pssm
, 
´Œad‘y³
, 
‰_id
));

143 
´Œad‘y³
->
	`g‘_v®ue
(3, 
is_m¬k‘
[
num_found
]);

155 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TL:se-idx-probe (%ld) \n",

156 
xù_id
, 
±lš
.
_Œade_id
[
num_found
]);

157 
	`W_DO
(
_p£‰Ëm’t_mª
->
	`£_šdex_´obe
(
_pssm
, 
´£‰Ëm’t
,

158 
±lš
.
_Œade_id
[
num_found
]));

160 
´£‰Ëm’t
->
	`g‘_v®ue
(3, 
£‰Ëm’t_amouÁ
[
num_found
]);

161 
´£‰Ëm’t
->
	`g‘_v®ue
(2, 
£‰Ëm’t_ÿsh_due_d©e
[
num_found
]);

162 
´£‰Ëm’t
->
	`g‘_v®ue
(1, 
£‰Ëm’t_ÿsh_ty³
[
num_found
], 41);

166 if(
is_ÿsh
[
num_found
]) {

179 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TL:ct-idx-probe (%ld) \n",

180 
xù_id
, 
±lš
.
_Œade_id
[
num_found
]);

181 
	`W_DO
(
_pÿsh_Œª§ùiÚ_mª
->
	`ù_šdex_´obe
(
_pssm
, 
´ÿshŒªs
,

182 
±lš
.
_Œade_id
[
num_found
]));

184 
´ÿshŒªs
->
	`g‘_v®ue
(1, 
ÿsh_Œª§ùiÚ_dts
[
num_found
]);

185 
´ÿshŒªs
->
	`g‘_v®ue
(2, 
ÿsh_Œª§ùiÚ_amouÁ
[
num_found
]);

186 
´ÿshŒªs
->
	`g‘_v®ue
(3, 
ÿsh_Œª§ùiÚ_Çme
[
num_found
], 101);

200 
gu¬d
<
šdex_sÿn_™”_im¶
<
Œade_hi¡Üy_t
> > 
th_™”
;

202 
šdex_sÿn_™”_im¶
<
Œade_hi¡Üy_t
>* 
tmp_th_™”
;

203 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TL:th-iter-by-trade-idx (%ld) \n",

204 
xù_id
, 
±lš
.
_Œade_id
[
num_found
]);

205 
	`W_DO
(
_±¿de_hi¡Üy_mª
->
	`th_g‘_™”_by_šdex
(
_pssm
, 
tmp_th_™”
,

206 
´Œadehi¡
,

207 
low»p
, 
high»p
,

208 
±lš
.
_Œade_id
[
num_found
]));

209 
th_™”
 = 
tmp_th_™”
;

213 
j
=0;

214 
boŞ
 
eof
;

215 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TL:th-™”-Ãxˆ\n", 
xù_id
);

216 
	`W_DO
(
th_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œadehi¡
));

217 !
eof
 && 
j
<3) {

218 
´Œadehi¡
->
	`g‘_v®ue
(1, 
Œade_hi¡Üy_dts
[
num_found
][
j
]);

219 
´Œadehi¡
->
	`g‘_v®ue
(2, 
Œade_hi¡Üy_¡©us_id
[
num_found
][
j
],

221 
j
++;

222 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TL:th-™”-Ãxˆ\n", 
xù_id
);

223 
	`W_DO
(
th_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œadehi¡
));

226 
	`as£¹
(
num_found
 =ğ
max_Œades
);

229 if(
±lš
.
_äame_to_execu‹
 == 2) {

249 
gu¬d
<
šdex_sÿn_™”_im¶
<
Œade_t
> > 
t_™”
;

251 
šdex_sÿn_™”_im¶
<
Œade_t
>* 
tmp_t_™”
;

252 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TL:t-iter-by-idx2 %ld %ld %ld \n",

253 
xù_id
, 
±lš
.
_acù_id
,…š.
_¡¬t_Œade_dts
,

254 
±lš
.
_’d_Œade_dts
);

255 
	`W_DO
(
_±¿de_mª
->
	`t_g‘_™”_by_šdex2
(
_pssm
, 
tmp_t_™”
, 
´Œade
,

256 
low»p
, 
high»p
,

257 
±lš
.
_acù_id
,

258 
±lš
.
_¡¬t_Œade_dts
,

259 
±lš
.
_’d_Œade_dts
));

260 
t_™”
 = 
tmp_t_™”
;

264 
boŞ
 
eof
;

265 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TL:t-™”-Ãxˆ\n", 
xù_id
);

266 
	`W_DO
(
t_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œade
));

267 
num_found
 = 0 ;‚um_found < 
max_Œades
 && !
eof
 ;‚um_found++) {

268 
´Œade
->
	`g‘_v®ue
(0, 
Œade_li¡
[
num_found
]);

269 
´Œade
->
	`g‘_v®ue
(4, 
is_ÿsh
[
num_found
]);

270 
´Œade
->
	`g‘_v®ue
(7, 
bid_´iû
[
num_found
]);

271 
´Œade
->
	`g‘_v®ue
(9, 
exec_Çme
[
num_found
], 50);

272 
´Œade
->
	`g‘_v®ue
(10, 
Œade_´iû
[
num_found
]);

273 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TL:t-™”-Ãxˆ\n", 
xù_id
);

274 
	`W_DO
(
t_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œade
));

277 
i
 = 0; i < 
num_found
; i++) {

288 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TL:se-idx-probe (%ld) \n",

289 
xù_id
, 
Œade_li¡
[
i
]);

290 
	`W_DO
(
_p£‰Ëm’t_mª
->
	`£_šdex_´obe
(
_pssm
, 
´£‰Ëm’t
,

291 
Œade_li¡
[
i
]));

293 
´£‰Ëm’t
->
	`g‘_v®ue
(3, 
£‰Ëm’t_amouÁ
[
i
]);

294 
´£‰Ëm’t
->
	`g‘_v®ue
(2, 
£‰Ëm’t_ÿsh_due_d©e
[
i
]);

295 
´£‰Ëm’t
->
	`g‘_v®ue
(1, 
£‰Ëm’t_ÿsh_ty³
[
i
], 41);

297 if(
is_ÿsh
[
i
]) {

309 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TL:ct-idx-probe (%ld) \n",

310 
xù_id
, 
Œade_li¡
[
i
]);

311 
	`W_DO
(
_pÿsh_Œª§ùiÚ_mª
->
	`ù_šdex_´obe
(
_pssm
, 
´ÿshŒªs
,

312 
Œade_li¡
[
i
]));

314 
´ÿshŒªs
->
	`g‘_v®ue
(1, 
ÿsh_Œª§ùiÚ_dts
[
i
]);

315 
´ÿshŒªs
->
	`g‘_v®ue
(2, 
ÿsh_Œª§ùiÚ_amouÁ
[
i
]);

316 
´ÿshŒªs
->
	`g‘_v®ue
(3, 
ÿsh_Œª§ùiÚ_Çme
[
i
], 101);

331 
gu¬d
<
šdex_sÿn_™”_im¶
<
Œade_hi¡Üy_t
> > 
th_™”
;

333 
šdex_sÿn_™”_im¶
<
Œade_hi¡Üy_t
>* 
tmp_th_™”
;

334 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TL:th-get-iter-by-idx %ld \n",

335 
xù_id
, 
Œade_li¡
[
i
]);

336 
	`W_DO
(
_±¿de_hi¡Üy_mª
->
	`th_g‘_™”_by_šdex
(
_pssm
, 
tmp_th_™”
,

337 
´Œadehi¡
,

338 
low»p
, 
high»p
,

339 
Œade_li¡
[
i
]));

340 
th_™”
 = 
tmp_th_™”
;

344 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TL:th-™”-Ãxˆ\n", 
xù_id
);

345 
	`W_DO
(
th_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œadehi¡
));

346 
j
 = 0;

347 !
eof
 && 
j
<3) {

348 
´Œadehi¡
->
	`g‘_v®ue
(1, 
Œade_hi¡Üy_dts
[
i
][
j
]);

349 
´Œadehi¡
->
	`g‘_v®ue
(2, 
Œade_hi¡Üy_¡©us_id
[
i
][
j
], 5);

350 
j
++;

351 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TL:th-™”-Ãxˆ\n", 
xù_id
);

352 
	`W_DO
(
th_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œadehi¡
));

355 
	`as£¹
(
num_found
 >ğ0 &&‚um_found <ğ
max_Œades
);

358 if(
±lš
.
_äame_to_execu‹
 == 3) {

381 
gu¬d
<
šdex_sÿn_™”_im¶
<
Œade_t
> > 
t_™”
;

383 
šdex_sÿn_™”_im¶
<
Œade_t
>* 
tmp_t_™”
;

384 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TL:t-get-iter-by-idx3 %s %ld %ld \n",

385 
xù_id
, 
±lš
.
_symbŞ
,…š.
_¡¬t_Œade_dts
,

386 
±lš
.
_’d_Œade_dts
);

387 
	`W_DO
(
_±¿de_mª
->
	`t_g‘_™”_by_šdex3
(
_pssm
, 
tmp_t_™”
, 
´Œade
,

388 
low»p
, 
high»p
, 
±lš
.
_symbŞ
,

389 
±lš
.
_¡¬t_Œade_dts
,

390 
±lš
.
_’d_Œade_dts
));

391 
t_™”
 = 
tmp_t_™”
;

395 
boŞ
 
eof
;

396 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TL:t-™”-Ãxˆ\n", 
xù_id
);

397 
	`W_DO
(
t_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œade
));

398 
num_found
 = 0;‚um_found < 
max_Œades
 && !
eof
;‚um_found++) {

399 
´Œade
->
	`g‘_v®ue
(0, 
Œade_li¡
[
num_found
]);

400 
´Œade
->
	`g‘_v®ue
(1, 
Œade_dts
[
num_found
]);

401 
´Œade
->
	`g‘_v®ue
(3, 
Œade_ty³
[
num_found
], 4);

402 
´Œade
->
	`g‘_v®ue
(4, 
is_ÿsh
[
num_found
]);

403 
´Œade
->
	`g‘_v®ue
(6, 
quªt™y
[
num_found
]);

404 
´Œade
->
	`g‘_v®ue
(8, 
acù_id
[
num_found
]);

405 
´Œade
->
	`g‘_v®ue
(9, 
exec_Çme
[
num_found
], 50);

406 
´Œade
->
	`g‘_v®ue
(10, 
Œade_´iû
[
num_found
]);

407 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TL:t-™”-Ãxˆ\n", 
xù_id
);

408 
	`W_DO
(
t_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œade
));

411 
i
 = 0; i < 
num_found
; i++){

422 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "TL: %d SE:se-idx-probe (%ld) \n",

423 
xù_id
, 
Œade_li¡
[
i
]);

424 
	`W_DO
(
_p£‰Ëm’t_mª
->
	`£_šdex_´obe
(
_pssm
, 
´£‰Ëm’t
,

425 
Œade_li¡
[
i
]));

427 
´£‰Ëm’t
->
	`g‘_v®ue
(1, 
£‰Ëm’t_ÿsh_ty³
[
i
], 41);

428 
´£‰Ëm’t
->
	`g‘_v®ue
(3, 
£‰Ëm’t_amouÁ
[
i
]);

429 
´£‰Ëm’t
->
	`g‘_v®ue
(2, 
£‰Ëm’t_ÿsh_due_d©e
[
i
]);

431 if(
is_ÿsh
[
i
]){

442 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TL:ct-idx-probe (%ld) \n",

443 
xù_id
, 
Œade_li¡
[
i
]);

444 
	`W_DO
(
_pÿsh_Œª§ùiÚ_mª
->
	`ù_šdex_´obe
(
_pssm
, 
´ÿshŒªs
,

445 
Œade_li¡
[
i
]));

447 
´ÿshŒªs
->
	`g‘_v®ue
(1, 
ÿsh_Œª§ùiÚ_dts
[
i
]);

448 
´ÿshŒªs
->
	`g‘_v®ue
(2, 
ÿsh_Œª§ùiÚ_amouÁ
[
i
]);

449 
´ÿshŒªs
->
	`g‘_v®ue
(3, 
ÿsh_Œª§ùiÚ_Çme
[
i
], 101);

463 
gu¬d
<
šdex_sÿn_™”_im¶
<
Œade_hi¡Üy_t
> > 
th_™”
;

465 
šdex_sÿn_™”_im¶
<
Œade_hi¡Üy_t
>* 
tmp_th_™”
;

466 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TL:th-get-iter-by-idx %ld \n",

467 
xù_id
, 
Œade_li¡
[
i
]);

468 
	`W_DO
(
_±¿de_hi¡Üy_mª
->
	`th_g‘_™”_by_šdex
(
_pssm
, 
tmp_th_™”
,

469 
´Œadehi¡
,

470 
low»p
, 
high»p
,

471 
Œade_li¡
[
i
]));

472 
th_™”
 = 
tmp_th_™”
;

476 
j
=0;

477 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TL:th-™”-Ãxˆ\n", 
xù_id
);

478 
	`W_DO
(
th_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œadehi¡
));

479 !
eof
 && 
j
<3) {

480 
´Œadehi¡
->
	`g‘_v®ue
(1, 
Œade_hi¡Üy_dts
[
i
][
j
]);

481 
´Œadehi¡
->
	`g‘_v®ue
(2, 
Œade_hi¡Üy_¡©us_id
[
i
][
j
], 5);

482 
j
++;

483 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TL:th-™”-Ãxˆ\n", 
xù_id
);

484 
	`W_DO
(
th_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œadehi¡
));

487 
	`as£¹
(
num_found
 >ğ0 &&‚um_found <ğ
max_Œades
);

490 if(
±lš
.
_äame_to_execu‹
 == 4) {

492 
TId’t
 
hŞdšg_hi¡Üy_id
[20];

493 
TId’t
 
hŞdšg_hi¡Üy_Œade_id
[20];

494 
quªt™y_befÜe
[20];

495 
quªt™y_aá”
[20];

508 
gu¬d
<
šdex_sÿn_™”_im¶
<
Œade_t
> > 
t_™”
;

510 
šdex_sÿn_™”_im¶
<
Œade_t
>* 
tmp_t_™”
;

511 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

513 
xù_id
, 
±lš
.
_acù_id
,…š.
_¡¬t_Œade_dts
, 
MAX_DTS
);

514 
	`W_DO
(
_±¿de_mª
->
	`t_g‘_™”_by_šdex2
(
_pssm
, 
tmp_t_™”
, 
´Œade
,

515 
low»p
, 
high»p
,

516 
±lš
.
_acù_id
,

517 
±lš
.
_¡¬t_Œade_dts
,

518 
MAX_DTS
, 
çl£
, false));

519 
t_™”
 = 
tmp_t_™”
;

523 
boŞ
 
eof
;

524 
	`W_DO
(
t_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œade
));

526 
TId’t
 
Œade_id
;

527 
´Œade
->
	`g‘_v®ue
(0, 
Œade_id
);

547 
gu¬d
< 
šdex_sÿn_™”_im¶
<
hŞdšg_hi¡Üy_t
> > 
hh_™”
;

549 
šdex_sÿn_™”_im¶
<
hŞdšg_hi¡Üy_t
>* 
tmp_hh_™”
;

550 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TL:hh-iter-by-idx (%ld)\n",

551 
xù_id
, 
Œade_id
);

552 
	`W_DO
(
_phŞdšg_hi¡Üy_mª
->
	`hh_g‘_™”_by_šdex2
(
_pssm
, 
tmp_hh_™”
,

553 
´hŞdšghi¡Üy
,

554 
low»p
, 
high»p
,

555 
Œade_id
));

556 
hh_™”
 = 
tmp_hh_™”
;

559 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TL:hh-™”-Ãxˆ\n", 
xù_id
);

560 
	`W_DO
(
hh_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´hŞdšghi¡Üy
));

561 
num_found
;

562 
num_found
 = 0;‚um_found < 20 && !
eof
;‚um_found++) {

563 
´hŞdšghi¡Üy
->
	`g‘_v®ue
(0, 
hŞdšg_hi¡Üy_id
[
num_found
]);

564 
´hŞdšghi¡Üy
->
	`g‘_v®ue
(1, 
hŞdšg_hi¡Üy_Œade_id
[
num_found
]);

565 
´hŞdšghi¡Üy
->
	`g‘_v®ue
(2, 
quªt™y_befÜe
[
num_found
]);

566 
´hŞdšghi¡Üy
->
	`g‘_v®ue
(3, 
quªt™y_aá”
[
num_found
]);

567 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TL:hh-™”-Ãxˆ\n", 
xù_id
);

568 
	`W_DO
(
hh_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´hŞdšghi¡Üy
));

570 
	`as£¹
(
num_found
 >= 0 &&‚um_found <= 20);

573 #ifdeà
PRINT_TRX_RESULTS


576 
¹¿de
.
	`´št_tu¶e
();

577 
¹¿d‘y³
.
	`´št_tu¶e
();

578 
r£‰Ëm’t
.
	`´št_tu¶e
();

579 
rÿshŒªs
.
	`´št_tu¶e
();

580 
¹¿dehi¡
.
	`´št_tu¶e
();

581 
rhŞdšghi¡Üy
.
	`´št_tu¶e
();

584  
RCOK
;

586 
	}
}

589 
EXIT_NAMESPACE
(
û
);

	@src/workload/tpce/shore_tpce_xct_trade_order.cpp

32 
	~"wÜklßd/û/shÜe_û_’v.h
"

33 
	~"wÜklßd/û/û_cÚ¡.h
"

34 
	~"wÜklßd/û/û_šput.h
"

36 
	~<veùÜ
>

37 
	~<num”ic
>

38 
	~<®gÜ™hm
>

39 
	~<¡dio.h
>

40 
	~<¡dlib.h
>

41 
	~"wÜklßd/û/eg’/CE.h
"

42 
	~"wÜklßd/û/eg’/TxnH¬ÃssSŒuùs.h
"

43 
	~"wÜklßd/û/shÜe_û_eg’.h
"

45 
usšg
 
Çme¥aû
 
	gshÜe
;

46 
usšg
 
Çme¥aû
 
	gTPCE
;

48 
ENTER_NAMESPACE
(
û
);

50 
Ï¡T¿deId
;

58 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_Œade_Üd”
(cÚ¡ 
xù_id
, 
Œade_Üd”_šput_t
& 
±oš
)

61 
	`as£¹
 (
_pssm
);

62 
	`as£¹
 (
_š™Ÿlized
);

63 
	`as£¹
 (
_lßded
);

65 
tu¶e_gu¬d
<
cu¡om”_accouÁ_mª_im¶
> 
	`´cu¡acù
(
_pcu¡om”_accouÁ_mª
);

66 
tu¶e_gu¬d
<
cu¡om”_mª_im¶
> 
	`´cu¡
(
_pcu¡om”_mª
);

67 
tu¶e_gu¬d
<
brok”_mª_im¶
> 
	`´brok”
(
_pbrok”_mª
);

68 
tu¶e_gu¬d
<
accouÁ_³rmissiÚ_mª_im¶
> 
	`´acù³rm
(
_·ccouÁ_³rmissiÚ_mª
);

69 
tu¶e_gu¬d
<
com·ny_mª_im¶
> 
	`´com·ny
(
_pcom·ny_mª
);

70 
tu¶e_gu¬d
<
£cur™y_mª_im¶
> 
	`´£cur™y
(
_p£cur™y_mª
);

71 
tu¶e_gu¬d
<
Ï¡_Œade_mª_im¶
> 
	`´Ï¡Œade
(
_¶a¡_Œade_mª
);

72 
tu¶e_gu¬d
<
hŞdšg_summ¬y_mª_im¶
> 
	`´hŞdšgsumm¬y
(
_phŞdšg_summ¬y_mª
);

73 
tu¶e_gu¬d
<
hŞdšg_mª_im¶
> 
	`´hŞdšg
(
_phŞdšg_mª
);

74 
tu¶e_gu¬d
<
ch¬ge_mª_im¶
> 
	`´ch¬ge
(
_pch¬ge_mª
);

75 
tu¶e_gu¬d
<
Œade_mª_im¶
> 
	`´Œade
(
_±¿de_mª
);

76 
tu¶e_gu¬d
<
Œade_ty³_mª_im¶
> 
	`´Œad‘y³
(
_±¿de_ty³_mª
);

77 
tu¶e_gu¬d
<
Œade_hi¡Üy_mª_im¶
> 
	`´Œadehi¡
(
_±¿de_hi¡Üy_mª
);

78 
tu¶e_gu¬d
<
Œade_»que¡_mª_im¶
> 
	`´Œad”eq
(
_±¿de_»que¡_mª
);

79 
tu¶e_gu¬d
<
cu¡om”_x¿‹_mª_im¶
> 
	`´cu¡x¿‹
(
_pcu¡om”_x¿‹_mª
);

80 
tu¶e_gu¬d
<
x¿‹_mª_im¶
> 
	`´x¿‹
(
_±ax¿‹_mª
);

81 
tu¶e_gu¬d
<
commissiÚ_¿‹_mª_im¶
> 
	`´comm¿‹
(
_pcommissiÚ_¿‹_mª
);

83 
»p_row_t
 
	`¬•row
(
_pcom·ny_mª
->
	`ts
());

85 
¬•row
.
	`£t
(
_pcom·ny_desc
->
	`maxsize
());

87 
´cu¡acù
->
_»p
 = &
¬•row
;

88 
´cu¡
->
_»p
 = &
¬•row
;

89 
´brok”
->
_»p
 = &
¬•row
;

90 
´acù³rm
->
_»p
 = &
¬•row
;

91 
´Œade
->
_»p
 = &
¬•row
;

92 
´Œad”eq
->
_»p
 = &
¬•row
;

93 
´Œadehi¡
->
_»p
 = &
¬•row
;

94 
´com·ny
->
_»p
 = &
¬•row
;

95 
´£cur™y
->
_»p
 = &
¬•row
;

96 
´Ï¡Œade
->
_»p
 = &
¬•row
;

97 
´Œad‘y³
->
_»p
 = &
¬•row
;

98 
´hŞdšgsumm¬y
->
_»p
 = &
¬•row
;

99 
´hŞdšg
->
_»p
 = &
¬•row
;

100 
´ch¬ge
->
_»p
 = &
¬•row
;

101 
´cu¡x¿‹
->
_»p
 = &
¬•row
;

102 
´x¿‹
->
_»p
 = &
¬•row
;

103 
´comm¿‹
->
_»p
 = &
¬•row
;

105 
»p_row_t
 
	`low»p
(
_pcom·ny_mª
->
	`ts
());

106 
»p_row_t
 
	`high»p
(
_pcom·ny_mª
->
	`ts
());

108 
low»p
.
	`£t
(
_pcom·ny_desc
->
	`maxsize
());

109 
high»p
.
	`£t
(
_pcom·ny_desc
->
	`maxsize
());

111 
»que¡ed_´iû
 = 
±oš
.
_»que¡ed_´iû
;

114 
cu¡_f_Çme
[21];

115 
cu¡_l_Çme
[26];

116 
acù_b®
;

117 
x_id
[21];

118 
x_¡©us
;

119 
TId’t
 
cu¡_id
;

120 
cu¡_t›r
;

121 
TId’t
 
brok”_id
;

129 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TO:ca-idx-probe (%ld) \n",

130 
xù_id
, 
±oš
.
_acù_id
);

131 
	`W_DO
(
_pcu¡om”_accouÁ_mª
->
	`ÿ_šdex_´obe
(
_pssm
,
´cu¡acù
,
±oš
.
_acù_id
));

133 
acù_Çme
[51] = "\0";

134 
´cu¡acù
->
	`g‘_v®ue
(1, 
brok”_id
);

135 
´cu¡acù
->
	`g‘_v®ue
(2, 
cu¡_id
);

136 
´cu¡acù
->
	`g‘_v®ue
(3, 
acù_Çme
, 51);

137 
´cu¡acù
->
	`g‘_v®ue
(4, 
x_¡©us
);

140 
´cu¡acù
->
	`g‘_v®ue
(5, 
acù_b®
);

142 
	`as£¹
(
acù_Çme
[0] != 0);

150 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TO:c-idx-´ob(%ldè\n", 
xù_id
, 
cu¡_id
);

151 
	`W_DO
(
_pcu¡om”_mª
->
	`c_šdex_´obe
(
_pssm
, 
´cu¡
, 
cu¡_id
));

153 
´cu¡
->
	`g‘_v®ue
(1, 
x_id
, 21);

154 
´cu¡
->
	`g‘_v®ue
(3, 
cu¡_l_Çme
, 26);

155 
´cu¡
->
	`g‘_v®ue
(4, 
cu¡_f_Çme
, 21);

156 
´cu¡
->
	`g‘_v®ue
(7, 
cu¡_t›r
);

163 
gu¬d
< 
šdex_sÿn_™”_im¶
<
brok”_t
> > 
br_™”
;

165 
šdex_sÿn_™”_im¶
<
brok”_t
>* 
tmp_br_™”
;

166 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d BV:b-get-iter-by-idx3 (%s) \n",

167 
xù_id
, 
brok”_id
);

168 
	`W_DO
(
_pbrok”_mª
->
	`b_g‘_™”_by_šdex2
(
_pssm
, 
tmp_br_™”
, 
´brok”
,

169 
low»p
, 
high»p
, 
brok”_id
));

170 
br_™”
 = 
tmp_br_™”
;

172 
boŞ
 
eof
;

173 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TO:br-™”-Ãxˆ\n", 
xù_id
);

174 
	`W_DO
(
br_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´brok”
));

175 if(
eof
è{ 
	`W_DO
(
	`RC
(
£_NOT_FOUND
)); }

177 
brok”_Çme
[50];

178 
´brok”
->
	`g‘_v®ue
(2, 
brok”_Çme
, 50);

202 if(
	`¡rcmp
(
±oš
.
_exec_l_Çme
, 
cu¡_l_Çme
) != 0 ||

203 
	`¡rcmp
(
±oš
.
_exec_f_Çme
, 
cu¡_f_Çme
) != 0 ||

204 
	`¡rcmp
(
±oš
.
_exec_x_id
, 
x_id
) != 0 ) {

206 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TO:ap-idx-probe (%ld) (%s) \n",

207 
xù_id
, 
±oš
.
_acù_id
,…toš.
_exec_x_id
);

208 
	`W_DO
(
_·ccouÁ_³rmissiÚ_mª
->
	`­_šdex_´obe
(
_pssm
, 
´acù³rm
,

209 
±oš
.
_acù_id
,

210 
±oš
.
_exec_x_id
));

212 
f_Çme
[21], 
l_Çme
[26];

213 
´acù³rm
->
	`g‘_v®ue
(3, 
l_Çme
, 26);

214 
´acù³rm
->
	`g‘_v®ue
(4, 
f_Çme
, 21);

216 
­_aş
[5] = "";

217 if(
	`¡rcmp
(
±oš
.
_exec_l_Çme
, 
l_Çme
) == 0 &&

218 
	`¡rcmp
(
±oš
.
_exec_f_Çme
, 
f_Çme
) == 0) {

219 
´acù³rm
->
	`g‘_v®ue
(1, 
­_aş
, 5);

221 
	`W_DO
(
	`RC
(
£_NOT_FOUND
));

224 
	`as£¹
(
	`¡rcmp
(
­_aş
, "") != 0);

229 
comm_¿‹
;

230 
¡©us_id
[5];

231 
ch¬ge_amouÁ
;

232 
boŞ
 
ty³_is_m¬k‘
;

233 
buy_v®ue
;

234 
£Î_v®ue
;

235 
x_amouÁ
;

236 
symbŞ
[16];

237 
	`¡rıy
(
symbŞ
, 
±oš
.
_symbŞ
);

238 
TId’t
 
co_id
;

239 
co_Çme
[61];

240 
exch_id
[7];

241 
cu¡_as£ts
;

242 
m¬k‘_´iû
;

243 
s_Çme
[71];

244 
boŞ
 
ty³_is_£Î
;

246 if(
symbŞ
[0] == '\0'){

255 
gu¬d
< 
šdex_sÿn_™”_im¶
<
com·ny_t
> > 
co_™”
;

257 
šdex_sÿn_™”_im¶
<
com·ny_t
>* 
tmp_co_™”
;

258 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TO:co-get-iter-by-idx2 (%s) \n",

259 
xù_id
, 
±oš
.
_co_Çme
);

260 
	`W_DO
(
_pcom·ny_mª
->
	`co_g‘_™”_by_šdex2
(
_pssm
, 
tmp_co_™”
,

261 
´com·ny
, 
low»p
, 
high»p
,

262 
±oš
.
_co_Çme
));

263 
co_™”
 = 
tmp_co_™”
;

265 
boŞ
 
eof
;

266 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TO:co-™”-Ãxˆ\n", 
xù_id
);

267 
	`W_DO
(
co_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´com·ny
));

268 
´com·ny
->
	`g‘_v®ue
(0, 
co_id
);

282 
gu¬d
< 
šdex_sÿn_™”_im¶
<
£cur™y_t
> > 
s_™”
;

284 
šdex_sÿn_™”_im¶
<
£cur™y_t
>* 
tmp_s_™”
;

285 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TO:s-get-iter-by-idx2 (%ld) (%s) \n",

286 
xù_id
, 
co_id
, 
±oš
.
_issue
);

287 
	`W_DO
(
_p£cur™y_mª
->
	`s_g‘_™”_by_šdex4
(
_pssm
, 
tmp_s_™”
,

288 
´£cur™y
, 
low»p
, 
high»p
,

289 
co_id
, 
±oš
.
_issue
));

290 
s_™”
 = 
tmp_s_™”
;

292 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TO:s-™”-Ãxˆ\n", 
xù_id
);

293 
	`W_DO
(
s_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´£cur™y
));

294 !
eof
){

295 
´£cur™y
->
	`g‘_v®ue
(0, 
symbŞ
, 16);

296 
´£cur™y
->
	`g‘_v®ue
(3, 
s_Çme
, 71);

297 
´£cur™y
->
	`g‘_v®ue
(4, 
exch_id
, 7);

298 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TO:s-™”-Ãxˆ\n", 
xù_id
);

299 
	`W_DO
(
s_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´£cur™y
));

312 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TO:s-idx-´ob(%sè\n", 
xù_id
, 
symbŞ
);

313 
	`W_DO
(
_p£cur™y_mª
->
	`s_šdex_´obe
(
_pssm
, 
´£cur™y
, 
symbŞ
));

314 
´£cur™y
->
	`g‘_v®ue
(3, 
s_Çme
, 71);

315 
´£cur™y
->
	`g‘_v®ue
(4, 
exch_id
, 7);

316 
´£cur™y
->
	`g‘_v®ue
(5, 
co_id
);

326 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TO:co-idx-´ob(%ldè\n", 
xù_id
, 
co_id
);

327 
	`W_DO
(
_pcom·ny_mª
->
	`co_šdex_´obe
(
_pssm
, 
´com·ny
, 
co_id
));

328 
´com·ny
->
	`g‘_v®ue
(2, 
co_Çme
, 61);

339 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TO:É-idx-´ob(%sè\n", 
xù_id
, 
symbŞ
);

340 
	`W_DO
(
_¶a¡_Œade_mª
->
	`É_šdex_´obe
(
_pssm
, 
´Ï¡Œade
, 
symbŞ
));

341 
´Ï¡Œade
->
	`g‘_v®ue
(2, 
m¬k‘_´iû
);

353 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TO:tt-idx-probe (%s) \n",

354 
xù_id
, 
±oš
.
_Œade_ty³_id
);

355 
	`W_DO
(
_±¿de_ty³_mª
->
	`‰_šdex_´obe
(
_pssm
, 
´Œad‘y³
,

356 
±oš
.
_Œade_ty³_id
));

357 
´Œad‘y³
->
	`g‘_v®ue
(2, 
ty³_is_£Î
);

358 
´Œad‘y³
->
	`g‘_v®ue
(3, 
ty³_is_m¬k‘
);

360 if(
ty³_is_m¬k‘
){

361 
»que¡ed_´iû
 = 
m¬k‘_´iû
;

364 
hŞd_´iû
;

365 
hŞd_qty
;

366 
Ãeded_qty
 = 
±oš
.
_Œade_qty
;

367 
hs_qty
 = -1;

369 
buy_v®ue
 = 0;

370 
£Î_v®ue
 = 0;

381 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TO:hs-idx-probe (%ld) (%s) \n",

382 
xù_id
, 
±oš
.
_acù_id
, 
symbŞ
);

383 if((
_phŞdšg_summ¬y_mª
->
	`hs_šdex_´obe
(
_pssm
,

384 
´hŞdšgsumm¬y
,

385 
±oš
.
_acù_id
,

386 
symbŞ
)).
	`is_”rÜ
()) {

387 
hs_qty
 = 0;

389 
´hŞdšgsumm¬y
->
	`g‘_v®ue
(2, 
hs_qty
);

403 if((
ty³_is_£Î
 && 
hs_qty
 > 0) || (!type_is_sell && hs_qty < 0)) {

404 
gu¬d
<
šdex_sÿn_™”_im¶
<
hŞdšg_t
> > 
h_™”
;

405 if(
±oš
.
_is_lifo
){

413 
šdex_sÿn_™”_im¶
<
hŞdšg_t
>* 
tmp_h_™”
;

414 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TO:h-iter-by-idx2 (%ld) (%s) \n",

415 
xù_id
, 
±oš
.
_acù_id
, 
symbŞ
);

416 
	`W_DO
(
_phŞdšg_mª
->
	`h_g‘_™”_by_šdex2
(
_pssm
, 
tmp_h_™”
,

417 
´hŞdšg
, 
low»p
,

418 
high»p
, 
±oš
.
_acù_id
,

419 
symbŞ
, 
Œue
));

420 
h_™”
 = 
tmp_h_™”
;

430 
šdex_sÿn_™”_im¶
<
hŞdšg_t
>* 
tmp_h_™”
;

431 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TO:h-™”-by-idx2 \n", 
xù_id
);

432 
	`W_DO
(
_phŞdšg_mª
->
	`h_g‘_™”_by_šdex2
(
_pssm
, 
tmp_h_™”
,

433 
´hŞdšg
, 
low»p
,

434 
high»p
, 
±oš
.
_acù_id
,

435 
symbŞ
));

436 
h_™”
 = 
tmp_h_™”
;

440 
boŞ
 
eof
;

441 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TO:h-™”-Ãxˆ\n", 
xù_id
);

442 
	`W_DO
(
h_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´hŞdšg
));

443 
Ãeded_qty
 !ğ0 && !
eof
) {

444 
hŞd_qty
;

445 
hŞd_´iû
;

447 
´hŞdšg
->
	`g‘_v®ue
(4, 
hŞd_´iû
);

448 
´hŞdšg
->
	`g‘_v®ue
(5, 
hŞd_qty
);

450 if(
ty³_is_£Î
) {

451 if(
hŞd_qty
 > 
Ãeded_qty
) {

452 
buy_v®ue
 +ğ
Ãeded_qty
 * 
hŞd_´iû
;

453 
£Î_v®ue
 +ğ
Ãeded_qty
 * 
»que¡ed_´iû
;

454 
Ãeded_qty
 = 0;

456 
buy_v®ue
 +ğ
hŞd_qty
 * 
hŞd_´iû
;

457 
£Î_v®ue
 +ğ
hŞd_qty
 * 
»que¡ed_´iû
;

458 
Ãeded_qty
 =‚“ded_qty - 
hŞd_qty
;

461 if(
hŞd_qty
 + 
Ãeded_qty
 < 0){

462 
£Î_v®ue
 +ğ
Ãeded_qty
 * 
hŞd_´iû
;

463 
buy_v®ue
 +ğ
Ãeded_qty
 * 
»que¡ed_´iû
;

464 
Ãeded_qty
 = 0;

466 
hŞd_qty
 = -hold_qty;

467 
£Î_v®ue
 +ğ
hŞd_qty
 * 
hŞd_´iû
;

468 
buy_v®ue
 +ğ
hŞd_qty
 * 
»que¡ed_´iû
;

469 
Ãeded_qty
 =‚“ded_qty - 
hŞd_qty
;

472 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TO:h-™”-Ãxˆ\n", 
xù_id
);

473 
	`W_DO
(
h_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´hŞdšg
));

477 if((
£Î_v®ue
 > 
buy_v®ue
è&& ((
x_¡©us
 == 1 ||ax_status == 2))) {

478 
x_¿‹s
;

494 
gu¬d
< 
šdex_sÿn_™”_im¶
<
cu¡om”_x¿‹_t
> > 
cx_™”
;

496 
šdex_sÿn_™”_im¶
<
cu¡om”_x¿‹_t
>* 
tmp_cx_™”
;

497 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TO:cx-get-iter-by-idx (%ld) \n",

498 
xù_id
, 
cu¡_id
);

499 
	`W_DO
(
_pcu¡om”_x¿‹_mª
->
	`cx_g‘_™”_by_šdex
(
_pssm
, 
tmp_cx_™”
,

500 
´cu¡x¿‹
,

501 
low»p
, 
high»p
,

502 
cu¡_id
));

503 
cx_™”
 = 
tmp_cx_™”
;

506 
boŞ
 
eof
;

507 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TO:cx-™”-Ãxˆ\n", 
xù_id
);

508 
	`W_DO
(
cx_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cu¡x¿‹
));

509 !
eof
) {

510 
x_id
[5];

511 
´cu¡x¿‹
->
	`g‘_v®ue
(0, 
x_id
, 5);

513 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TO:tx-idx-probe (%s) \n",

514 
xù_id
, 
x_id
);

515 
	`W_DO
(
_±ax¿‹_mª
->
	`tx_šdex_´obe
(
_pssm
, 
´x¿‹
, 
x_id
));

517 
¿‹
;

518 
´x¿‹
->
	`g‘_v®ue
(2, 
¿‹
);

519 
x_¿‹s
 +ğ
¿‹
;

521 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TO:cx-™”-Ãxˆ\n", 
xù_id
);

522 
	`W_DO
(
cx_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cu¡x¿‹
));

524 
x_amouÁ
 = (
£Î_v®ue
 - 
buy_v®ue
è* 
x_¿‹s
;

540 
gu¬d
< 
šdex_sÿn_™”_im¶
<
commissiÚ_¿‹_t
> > 
ü_™”
;

542 
šdex_sÿn_™”_im¶
<
commissiÚ_¿‹_t
>* 
tmp_ü_™”
;

543 
	`TRACE
(
TRACE_TRX_FLOW
, "App: %d TR:cr-iter-by-idx (%d) (%s) (%s) (%d)\n",

544 
xù_id
, 
cu¡_t›r
, 
±oš
.
_Œade_ty³_id
, 
exch_id
,…toš.
_Œade_qty
);

545 
	`W_DO
(
_pcommissiÚ_¿‹_mª
->
	`ü_g‘_™”_by_šdex
(
_pssm
, 
tmp_ü_™”
,

546 
´comm¿‹
, 
low»p
,

547 
high»p
, 
cu¡_t›r
,

548 
±oš
.
_Œade_ty³_id
,

549 
exch_id
,

550 
±oš
.
_Œade_qty
));

551 
ü_™”
 = 
tmp_ü_™”
;

554 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TO:ü-™”-Ãxˆ\n", 
xù_id
);

555 
	`W_DO
(
ü_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´comm¿‹
));

556 !
eof
) {

557 
to_qty
;

558 
´comm¿‹
->
	`g‘_v®ue
(4, 
to_qty
);

560 if(
to_qty
 >ğ
±oš
.
_Œade_qty
){

561 
´comm¿‹
->
	`g‘_v®ue
(5, 
comm_¿‹
);

565 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TO:ü-™”-Ãxˆ\n", 
xù_id
);

566 
	`W_DO
(
ü_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´comm¿‹
));

579 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TO:ch-idx-probe (%d) (%s) \n",

580 
xù_id
, 
cu¡_t›r
, 
±oš
.
_Œade_ty³_id
);

581 
	`W_DO
(
_pch¬ge_mª
->
	`ch_šdex_´obe
(
_pssm
, 
´ch¬ge
, 
cu¡_t›r
,

582 
±oš
.
_Œade_ty³_id
));

583 
´ch¬ge
->
	`g‘_v®ue
(2, 
ch¬ge_amouÁ
);

585 
hŞd_as£ts
 = 0;

586 
cu¡_as£ts
 = 0;

588 if(
±oš
.
_ty³_is_m¬gš
) {

619 
gu¬d
< 
šdex_sÿn_™”_im¶
<
hŞdšg_summ¬y_t
> > 
hs_™”
;

621 
šdex_sÿn_™”_im¶
<
hŞdšg_summ¬y_t
>* 
tmp_hs_™”
;

622 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TO:hs-iter-by-idx (%ld) \n",

623 
xù_id
, 
±oš
.
_acù_id
);

624 
	`W_DO
(
_phŞdšg_summ¬y_mª
->
	`hs_g‘_™”_by_šdex
(
_pssm
, 
tmp_hs_™”
,

625 
´hŞdšgsumm¬y
,

626 
low»p
, 
high»p
,

627 
±oš
.
_acù_id
));

628 
hs_™”
 = 
tmp_hs_™”
;

631 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TO:hs-™”-Ãxˆ\n", 
xù_id
);

632 
	`W_DO
(
hs_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´hŞdšgsumm¬y
));

633 !
eof
) {

634 
symb
[16];

635 
´hŞdšgsumm¬y
->
	`g‘_v®ue
(1, 
symb
, 16);

636 
hs_qty
;

637 
´hŞdšgsumm¬y
->
	`g‘_v®ue
(2, 
hs_qty
);

639 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ:%d TO:É-idx-´ob(%s)\n", 
xù_id
, 
symb
);

640 
	`W_DO
(
_¶a¡_Œade_mª
->
	`É_šdex_´obe
(
_pssm
, 
´Ï¡Œade
, 
symb
));

642 
É_´iû
;

643 
´Ï¡Œade
->
	`g‘_v®ue
(3, 
É_´iû
);

644 
hŞd_as£ts
 +ğ(
É_´iû
 * 
hs_qty
);

646 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TO:hs-™”-Ãxˆ\n", 
xù_id
);

647 
	`W_DO
(
hs_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´hŞdšgsumm¬y
));

649 
cu¡_as£ts
 = 
hŞd_as£ts
 + 
acù_b®
;

653 ià(
ty³_is_m¬k‘
) {

654 
	`¡rıy
(
¡©us_id
, 
±oš
.
_¡_subm™‹d_id
);

656 
	`¡rıy
(
¡©us_id
, 
±oš
.
_¡_³ndšg_id
);

660 if((
£Î_v®ue
 > 
buy_v®ue
) &&

661 ((
x_¡©us
 =ğ1è|| (x_¡©u =ğ2)è&& (
x_amouÁ
 == 0)) {

662 
	`as£¹
(
çl£
);

663 } if(
comm_¿‹
 == 0.0000) {

664 
	`as£¹
(
çl£
);

665 } if(
ch¬ge_amouÁ
 == 0) {

666 
	`as£¹
(
çl£
);

669 
comm_amouÁ
 = (
comm_¿‹
/100è* 
±oš
.
_Œade_qty
 * 
»que¡ed_´iû
;

670 
exec_Çme
[50];

671 
	`¡rıy
(
exec_Çme
, 
±oš
.
_exec_f_Çme
);

672 
	`¡rÿt
(
exec_Çme
, " ");

673 
	`¡rÿt
(
exec_Çme
, 
±oš
.
_exec_l_Çme
);

674 
boŞ
 
is_ÿsh
 = !
±oš
.
_ty³_is_m¬gš
;

675 
TId’t
 
Œade_id
;

678 
myTime
 
now_dts
 = 
	`time
(
NULL
);

680 
Œade_id
 = (è
	`©omic_šc_64_nv
(&
Ï¡T¿deId
);

703 
´Œade
->
	`£t_v®ue
(0, 
Œade_id
);

704 
´Œade
->
	`£t_v®ue
(1, 
now_dts
);

705 
´Œade
->
	`£t_v®ue
(2, 
¡©us_id
);

706 
´Œade
->
	`£t_v®ue
(3, 
±oš
.
_Œade_ty³_id
);

707 
´Œade
->
	`£t_v®ue
(4, 
is_ÿsh
);

708 
´Œade
->
	`£t_v®ue
(5, 
symbŞ
);

709 
´Œade
->
	`£t_v®ue
(6, 
±oš
.
_Œade_qty
);

710 
´Œade
->
	`£t_v®ue
(7, 
»que¡ed_´iû
);

711 
´Œade
->
	`£t_v®ue
(8, 
±oš
.
_acù_id
);

712 
´Œade
->
	`£t_v®ue
(9, 
exec_Çme
);

713 
´Œade
->
	`£t_v®ue
(10, ()-1);

714 
´Œade
->
	`£t_v®ue
(11, 
ch¬ge_amouÁ
);

715 
´Œade
->
	`£t_v®ue
(12, 
comm_amouÁ
);

716 
´Œade
->
	`£t_v®ue
(13, ()0);

717 
´Œade
->
	`£t_v®ue
(14, 
±oš
.
_is_lifo
);

719 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TO:t-add-tu¶(%ldè\n", 
xù_id
, 
Œade_id
);

720 
	`W_DO
(
_±¿de_mª
->
	`add_tu¶e
(
_pssm
, 
´Œade
));

722 if(!
ty³_is_m¬k‘
) {

734 
´Œad”eq
->
	`£t_v®ue
(0, 
Œade_id
);

735 
´Œad”eq
->
	`£t_v®ue
(1, 
±oš
.
_Œade_ty³_id
);

736 
´Œad”eq
->
	`£t_v®ue
(2, 
symbŞ
);

737 
´Œad”eq
->
	`£t_v®ue
(3, 
±oš
.
_Œade_qty
);

738 
´Œad”eq
->
	`£t_v®ue
(4, 
»que¡ed_´iû
);

739 
´Œad”eq
->
	`£t_v®ue
(5, 
brok”_id
);

741 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TO:tr-add-tuple (%ld) \n",

742 
xù_id
, 
Œade_id
);

743 
	`W_DO
(
_±¿de_»que¡_mª
->
	`add_tu¶e
(
_pssm
, 
´Œad”eq
));

753 
´Œadehi¡
->
	`£t_v®ue
(0, 
Œade_id
);

754 
´Œadehi¡
->
	`£t_v®ue
(1, 
now_dts
);

755 
´Œadehi¡
->
	`£t_v®ue
(2, 
¡©us_id
);

757 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TO:th-add-tu¶(%ldè\n", 
xù_id
, 
Œade_id
);

758 
	`W_DO
(
_±¿de_hi¡Üy_mª
->
	`add_tu¶e
(
_pssm
, 
´Œadehi¡
));

762 if(
±oš
.
_rŞl_™_back
) {

763 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TO:ROLLBACK \n", 
xù_id
);

764 
	`W_DO
(
	`RC
(
£_NOT_FOUND
));

770 
PT¿deReque¡
 
»q
 = 
Ãw
 
	`TT¿deReque¡
();

771 
»q
->
Œade_id
 =rade_id;

772 
»q
->
Œade_qty
 = 
±oš
.
_Œade_qty
;

773 
	`¡rıy
(
»q
->
symbŞ
, symbol);

774 
	`¡rıy
(
»q
->
Œade_ty³_id
, 
±oš
.
_Œade_ty³_id
);

775 
»q
->
´iû_quÙe
 = 
»que¡ed_´iû
;

776 if(
ty³_is_m¬k‘
) {

777 
»q
->
eAùiÚ
=
eMEEProûssOrd”
;

779 
»q
->
eAùiÚ
=
eMEES‘Lim™Ord”Trigg”
;

781 
m“
->
	`Subm™T¿deReque¡
(
»q
);

782 
d–‘e
 
»q
;

785 #ifdeà
PRINT_TRX_RESULTS


788 
rcu¡acù
.
	`´št_tu¶e
();

789 
rcu¡
.
	`´št_tu¶e
();

790 
rbrok
.
	`´št_tu¶e
();

791 
¿cù³rm
.
	`´št_tu¶e
();

792 
¹¿de
.
	`´št_tu¶e
();

793 
¹¿d”eq
.
	`´št_tu¶e
();

794 
¹¿dehi¡
.
	`´št_tu¶e
();

795 
rcom·ny
.
	`´št_tu¶e
();

796 
r£cur™y
.
	`´št_tu¶e
();

797 
¾a¡Œade
.
	`´št_tu¶e
();

798 
¹¿d‘y³
.
	`´št_tu¶e
();

799 
rhŞdšgsumm¬y
.
	`´št_tu¶e
();

800 
rhŞdšg
.
	`´št_tu¶e
();

801 
rch¬ge
.
	`´št_tu¶e
();

802 
rcu¡x¿‹
.
	`´št_tu¶e
();

803 
¹ax¿‹
.
	`´št_tu¶e
();

804 
rcomm¿‹
.
	`´št_tu¶e
();

807  
RCOK
;

809 
	}
}

812 
EXIT_NAMESPACE
(
û
);

	@src/workload/tpce/shore_tpce_xct_trade_result.cpp

32 
	~"wÜklßd/û/shÜe_û_’v.h
"

33 
	~"wÜklßd/û/û_cÚ¡.h
"

34 
	~"wÜklßd/û/û_šput.h
"

36 
	~<veùÜ
>

37 
	~<num”ic
>

38 
	~<®gÜ™hm
>

39 
	~<¡dio.h
>

40 
	~<¡dlib.h
>

41 
	~"wÜklßd/û/eg’/CE.h
"

42 
	~"wÜklßd/û/eg’/TxnH¬ÃssSŒuùs.h
"

43 
	~"wÜklßd/û/shÜe_û_eg’.h
"

45 
usšg
 
Çme¥aû
 
	gshÜe
;

46 
usšg
 
Çme¥aû
 
	gTPCE
;

50 
ENTER_NAMESPACE
(
û
);

58 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_Œade_»suÉ
(cÚ¡ 
xù_id
,

59 
Œade_»suÉ_šput_t
& 
±rš
)

62 if(
±rš
.
_Œade_´iû
 == -1) {

63 
	`©omic_šc_ušt_nv
(&
_num_šv®id_šput
);

64  (
RCOK
);

68 
	`as£¹
 (
_pssm
);

69 
	`as£¹
 (
_š™Ÿlized
);

70 
	`as£¹
 (
_lßded
);

72 
tu¶e_gu¬d
<
Œade_mª_im¶
> 
	`´Œade
(
_±¿de_mª
);

73 
tu¶e_gu¬d
<
Œade_ty³_mª_im¶
> 
	`´Œad‘y³
(
_±¿de_ty³_mª
);

74 
tu¶e_gu¬d
<
hŞdšg_summ¬y_mª_im¶
> 
	`´hŞdšgsumm¬y
(
_phŞdšg_summ¬y_mª
);

75 
tu¶e_gu¬d
<
cu¡om”_accouÁ_mª_im¶
> 
	`´cu¡accouÁ
(
_pcu¡om”_accouÁ_mª
);

76 
tu¶e_gu¬d
<
hŞdšg_mª_im¶
> 
	`´hŞdšg
(
_phŞdšg_mª
);

77 
tu¶e_gu¬d
<
hŞdšg_hi¡Üy_mª_im¶
> 
	`´hŞdšghi¡Üy
(
_phŞdšg_hi¡Üy_mª
);

78 
tu¶e_gu¬d
<
£cur™y_mª_im¶
> 
	`´£cur™y
(
_p£cur™y_mª
);

79 
tu¶e_gu¬d
<
brok”_mª_im¶
> 
	`´brok”
(
_pbrok”_mª
);

80 
tu¶e_gu¬d
<
£‰Ëm’t_mª_im¶
> 
	`´£‰Ëm’t
(
_p£‰Ëm’t_mª
);

81 
tu¶e_gu¬d
<
ÿsh_Œª§ùiÚ_mª_im¶
> 
	`´ÿshŒªs
(
_pÿsh_Œª§ùiÚ_mª
);

82 
tu¶e_gu¬d
<
commissiÚ_¿‹_mª_im¶
> 
	`´commissiÚ¿‹
(
_pcommissiÚ_¿‹_mª
);

83 
tu¶e_gu¬d
<
cu¡om”_x¿‹_mª_im¶
> 
	`´cu¡x¿‹
(
_pcu¡om”_x¿‹_mª
);

84 
tu¶e_gu¬d
<
x¿‹_mª_im¶
> 
	`´x¿‹
(
_±ax¿‹_mª
);

85 
tu¶e_gu¬d
<
cu¡om”_mª_im¶
> 
	`´cu¡om”
(
_pcu¡om”_mª
);

86 
tu¶e_gu¬d
<
Œade_hi¡Üy_mª_im¶
> 
	`´Œadehi¡
(
_±¿de_hi¡Üy_mª
);

88 
»p_row_t
 
	`¬•row
(
_pcu¡om”_mª
->
	`ts
());

90 
¬•row
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

92 
´Œade
->
_»p
 = &
¬•row
;

93 
´Œad‘y³
->
_»p
 = &
¬•row
;

94 
´hŞdšgsumm¬y
->
_»p
 = &
¬•row
;

95 
´cu¡accouÁ
->
_»p
 = &
¬•row
;

96 
´hŞdšg
->
_»p
 = &
¬•row
;

97 
´hŞdšghi¡Üy
->
_»p
 = &
¬•row
;

98 
´£cur™y
->
_»p
 = &
¬•row
;

99 
´brok”
->
_»p
 = &
¬•row
;

100 
´£‰Ëm’t
->
_»p
 = &
¬•row
;

101 
´ÿshŒªs
->
_»p
 = &
¬•row
;

102 
´commissiÚ¿‹
->
_»p
 = &
¬•row
;

103 
´cu¡x¿‹
->
_»p
 = &
¬•row
;

104 
´x¿‹
->
_»p
 = &
¬•row
;

105 
´cu¡om”
->
_»p
 = &
¬•row
;

106 
´Œadehi¡
->
_»p
 = &
¬•row
;

108 
»p_row_t
 
	`low»p
(
_pcu¡om”_mª
->
	`ts
());

109 
»p_row_t
 
	`high»p
(
_pcu¡om”_mª
->
	`ts
());

111 
low»p
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

112 
high»p
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

114 
Œade_qty
;

115 
TId’t
 
acù_id
 = -1;

116 
boŞ
 
ty³_is_£Î
;

117 
hs_qty
 = -1;

118 
symbŞ
[16];

119 
boŞ
 
is_lifo
;

120 
ty³_id
[4];

121 
boŞ
 
Œade_is_ÿsh
;

122 
ty³_Çme
[13];

123 
ch¬ge
;

134 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TR:t-idx-probe (%ld) \n",

135 
xù_id
, 
±rš
.
_Œade_id
);

136 
w_rc_t
 
e
 = 
_±¿de_mª
->
	`t_šdex_´obe
(
_pssm
, 
´Œade
, 
±rš
.
_Œade_id
);

137 if(
e
.
	`is_”rÜ
()) {

138 
	`as£¹
(
e
.
	`”r_num
(è!ğ
£_TUPLE_NOT_FOUND
);

139 
	`W_DO
(
e
);

141 
´Œade
->
	`g‘_v®ue
(3, 
ty³_id
, 4);

142 
´Œade
->
	`g‘_v®ue
(4, 
Œade_is_ÿsh
);

143 
´Œade
->
	`g‘_v®ue
(5, 
symbŞ
, 16);

144 
´Œade
->
	`g‘_v®ue
(6, 
Œade_qty
);

145 
´Œade
->
	`g‘_v®ue
(8, 
acù_id
);

146 
´Œade
->
	`g‘_v®ue
(11, 
ch¬ge
);

147 
´Œade
->
	`g‘_v®ue
(14, 
is_lifo
);

155 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TR:‰-idx-´ob(%sè\n", 
xù_id
, 
ty³_id
);

156 
	`W_DO
(
_±¿de_ty³_mª
->
	`‰_šdex_´obe
(
_pssm
, 
´Œad‘y³
, 
ty³_id
));

158 
´Œad‘y³
->
	`g‘_v®ue
(1, 
ty³_Çme
, 13);

159 
´Œad‘y³
->
	`g‘_v®ue
(2, 
ty³_is_£Î
);

160 
boŞ
 
ty³_is_m¬k‘
;

161 
´Œad‘y³
->
	`g‘_v®ue
(3, 
ty³_is_m¬k‘
);

168 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TR:hs-idx-probe (%ld) (%s) \n",

169 
xù_id
, 
acù_id
, 
symbŞ
);

170 
e
 = 
_phŞdšg_summ¬y_mª
->
	`hs_šdex_´obe
(
_pssm
, 
´hŞdšgsumm¬y
,

171 
acù_id
, 
symbŞ
);

172 ià(
e
.
	`is_”rÜ
()) {

173 
hs_qty
=0;

175 
´hŞdšgsumm¬y
->
	`g‘_v®ue
(2, 
hs_qty
);

177 if(
hs_qty
 == -1){

178 
hs_qty
 = 0;

182 
TId’t
 
cu¡_id
;

183 
buy_v®ue
 = 0;

184 
£Î_v®ue
 = 0;

185 
myTime
 
Œade_dts
 = 
	`time
(
NULL
);

186 
TId’t
 
brok”_id
;

187 
x_¡©us
;

190 
TId’t
 
hŞd_id
;

191 
hŞd_´iû
;

192 
hŞd_qty
;

193 
Ãeded_qty
 = 
Œade_qty
;

194 
ušt
 
num_d–‘ed
 = 0;

202 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TR:ÿ-idx-´ob(%ldè\n", 
xù_id
, 
acù_id
);

203 
	`W_DO
(
_pcu¡om”_accouÁ_mª
->
	`ÿ_šdex_´obe
(
_pssm
, 
´cu¡accouÁ
, 
acù_id
));

205 
´cu¡accouÁ
->
	`g‘_v®ue
(1, 
brok”_id
);

206 
´cu¡accouÁ
->
	`g‘_v®ue
(2, 
cu¡_id
);

207 
´cu¡accouÁ
->
	`g‘_v®ue
(4, 
x_¡©us
);

209 if(
ty³_is_£Î
){

210 if(
hs_qty
 == 0){

215 
´hŞdšgsumm¬y
->
	`£t_v®ue
(0, 
acù_id
);

216 
´hŞdšgsumm¬y
->
	`£t_v®ue
(1, 
symbŞ
);

217 
´hŞdšgsumm¬y
->
	`£t_v®ue
(2, -1*
Œade_qty
);

219 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TR:hs-add-tuple (%ld) \n",

220 
xù_id
, 
acù_id
);

221 
	`W_DO
(
_phŞdšg_summ¬y_mª
->
	`add_tu¶e
(
_pssm
, 
´hŞdšgsumm¬y
));

222 } if(
hs_qty
 !ğ
Œade_qty
) {

228 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TR:hs-update (%ld) (%s) (%d) \n",

229 
xù_id
, 
acù_id
, 
symbŞ
, (
hs_qty
 - 
Œade_qty
));

230 
	`W_DO
(
_phŞdšg_summ¬y_mª
->
	`hs_upd©e_qty
(
_pssm
, 
´hŞdšgsumm¬y
,

231 
acù_id
, 
symbŞ
,

232 (
hs_qty
 - 
Œade_qty
)));

238 ià(
hs_qty
 > 0) {

239 
gu¬d
<
šdex_sÿn_™”_im¶
<
hŞdšg_t
> > 
h_™”
;

240 
asc_sÜt_sÿn_t
* 
h_li¡_sÜt_™”
;

242 ià(
is_lifo
) {

251 
šdex_sÿn_™”_im¶
<
hŞdšg_t
>* 
tmp_h_™”
;

252 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

254 
xù_id
, 
acù_id
, 
symbŞ
);

255 
	`W_DO
(
_phŞdšg_mª
->
	`h_g‘_™”_by_šdex2
(
_pssm
, 
tmp_h_™”
,

256 
´hŞdšg
, 
low»p
,

257 
high»p
, 
acù_id
,

258 
symbŞ
, 
Œue
));

259 
h_™”
 = 
tmp_h_™”
;

269 
šdex_sÿn_™”_im¶
<
hŞdšg_t
>* 
tmp_h_™”
;

270 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

272 
xù_id
, 
acù_id
, 
symbŞ
);

273 
	`W_DO
(
_phŞdšg_mª
->
	`h_g‘_™”_by_šdex2
(
_pssm
, 
tmp_h_™”
,

274 
´hŞdšg
, 
low»p
,

275 
high»p
, 
acù_id
,

276 
symbŞ
));

277 
h_™”
 = 
tmp_h_™”
;

286 
boŞ
 
eof
;

287 
	`W_DO
(
h_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´hŞdšg
));

288 
Ãeded_qty
 !=0 && !
eof
) {

289 
TId’t
 
hŞd_id
;

290 
hŞd_qty
;

291 
hŞd_´iû
;

293 
´hŞdšg
->
	`g‘_v®ue
(0, 
hŞd_id
);

294 
´hŞdšg
->
	`g‘_v®ue
(4, 
hŞd_´iû
);

295 
´hŞdšg
->
	`g‘_v®ue
(5, 
hŞd_qty
);

373 if(
hŞd_qty
 > 
Ãeded_qty
){

374 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

376 
xù_id
, 
acù_id
, 
symbŞ
, (
hs_qty
 - 
Œade_qty
));

377 
	`W_DO
(
_phŞdšg_mª
->
	`h_upd©e_qty
(
_pssm
, 
´hŞdšg
,

378 (
hŞd_qty
 - 
Ãeded_qty
)));

380 
±rš
.
_hŞdšg_rid
[
num_d–‘ed
] = 
´hŞdšg
->
	`rid
();

381 
num_d–‘ed
++;

384 
´hŞdšghi¡Üy
->
	`£t_v®ue
(0, 
hŞd_id
);

385 
´hŞdšghi¡Üy
->
	`£t_v®ue
(1, 
±rš
.
_Œade_id
);

386 
´hŞdšghi¡Üy
->
	`£t_v®ue
(2, 
hŞd_qty
);

387 
´hŞdšghi¡Üy
->
	`£t_v®ue
(3,

388 (
hŞd_qty
 > 
Ãeded_qty
) ? (hold_qty -‚eeded_qty) : 0);

390 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

392 
xù_id
, 
hŞd_id
, 
±rš
.
_Œade_id
, 
hŞd_´iû
,

393 ((
hŞd_qty
 > 
Ãeded_qty
) ? (hold_qty -‚eeded_qty) : 0));

394 
	`W_DO
(
_phŞdšg_hi¡Üy_mª
->
	`add_tu¶e
(
_pssm
, 
´hŞdšghi¡Üy
));

396 if(
hŞd_qty
 > 
Ãeded_qty
) {

397 
buy_v®ue
 +ğ
Ãeded_qty
 * 
hŞd_´iû
;

398 
£Î_v®ue
 +ğ
Ãeded_qty
 * 
±rš
.
_Œade_´iû
;

399 
Ãeded_qty
 = 0;

401 
buy_v®ue
 +ğ
hŞd_qty
 * 
hŞd_´iû
;

402 
£Î_v®ue
 +ğ
hŞd_qty
 * 
±rš
.
_Œade_´iû
;

403 
Ãeded_qty
 =‚“ded_qty - 
hŞd_qty
;

406 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TR:hold-list (%ld)\n",

407 
xù_id
, 
hŞd_id
);

408 
	`W_DO
(
h_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´hŞdšg
));

411 
ušt
 
i
=0; i<
num_d–‘ed
; i++) {

412 
	`TRACE
(
TRACE_TRX_FLOW
,

413 "%d - TR:h-d–‘e-tu¶- (%d).(%d).(%d).(%d)\n", 
xù_id
,

414 (
±rš
.
_hŞdšg_rid
[
i
]).
pid
.
	`vŞ
().
vŞ
,

415 (
±rš
.
_hŞdšg_rid
[
i
]).
pid
.
	`¡Üe
(),

416 (
±rš
.
_hŞdšg_rid
[
i
]).
pid
.
·ge
,

417 (
±rš
.
_hŞdšg_rid
[
i
]).
¦Ù
);

418 
	`W_DO
(
_phŞdšg_mª
->
	`h_d–‘e_tu¶e
(
_pssm
, 
´hŞdšg
,

419 
±rš
.
_hŞdšg_rid
[
i
]));

429 if(
Ãeded_qty
 > 0) {

445 
´hŞdšghi¡Üy
->
	`£t_v®ue
(0, 
±rš
.
_Œade_id
);

446 
´hŞdšghi¡Üy
->
	`£t_v®ue
(1, 
±rš
.
_Œade_id
);

447 
´hŞdšghi¡Üy
->
	`£t_v®ue
(2, 0);

448 
´hŞdšghi¡Üy
->
	`£t_v®ue
(3, (-1è* 
Ãeded_qty
);

450 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TR:hh-add-tuple (%ld)(%ld)(%d)(%d)\n",

451 
xù_id
, 
±rš
.
_Œade_id
,…Œš._Œade_id, 0, (-1è* 
Ãeded_qty
);

452 
	`W_DO
(
_phŞdšg_hi¡Üy_mª
->
	`add_tu¶e
(
_pssm
, 
´hŞdšghi¡Üy
));

473 
´hŞdšg
->
	`£t_v®ue
(0, 
±rš
.
_Œade_id
);

474 
´hŞdšg
->
	`£t_v®ue
(1, 
acù_id
);

475 
´hŞdšg
->
	`£t_v®ue
(2, 
symbŞ
);

476 
´hŞdšg
->
	`£t_v®ue
(3, 
Œade_dts
);

477 
´hŞdšg
->
	`£t_v®ue
(4, 
±rš
.
_Œade_´iû
);

478 
´hŞdšg
->
	`£t_v®ue
(5, (-1è* 
Ãeded_qty
);

480 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

482 
xù_id
, 
±rš
.
_Œade_id
, 
acù_id
, 
symbŞ
, 
Œade_dts
,

483 
±rš
.
_Œade_´iû
, (-1è* 
Ãeded_qty
);

484 
	`W_DO
(
_phŞdšg_mª
->
	`add_tu¶e
(
_pssm
, 
´hŞdšg
));

485 } ià(
hs_qty
 =ğ
Œade_qty
) {

490 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TR:hs-delete-tuple (%ld) (%s) \n",

491 
xù_id
, 
acù_id
, 
symbŞ
);

492 
	`W_DO
(
_phŞdšg_summ¬y_mª
->
	`d–‘e_tu¶e
(
_pssm
, 
´hŞdšgsumm¬y
));

495 ià(
hs_qty
 == 0) {

508 
´hŞdšgsumm¬y
->
	`£t_v®ue
(0, 
acù_id
);

509 
´hŞdšgsumm¬y
->
	`£t_v®ue
(1, 
symbŞ
);

510 
´hŞdšgsumm¬y
->
	`£t_v®ue
(2, 
Œade_qty
);

512 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TR:hs-add-tuple (%ld) \n",

513 
xù_id
, 
acù_id
);

514 
	`W_DO
(
_phŞdšg_summ¬y_mª
->
	`add_tu¶e
(
_pssm
, 
´hŞdšgsumm¬y
));

515 } ià(-
hs_qty
 !ğ
Œade_qty
) {

521 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TR:holdsumm-update (%ld) (%s) (%d) \n",

522 
xù_id
, 
acù_id
, 
symbŞ
, (
hs_qty
 + 
Œade_qty
));

523 
	`W_DO
(
_phŞdšg_summ¬y_mª
->
	`hs_upd©e_qty
(
_pssm
, 
´hŞdšgsumm¬y
,

524 
acù_id
, 
symbŞ
,

525 (
hs_qty
 + 
Œade_qty
)));

533 if(
hs_qty
 < 0) {

534 
gu¬d
<
šdex_sÿn_™”_im¶
<
hŞdšg_t
> > 
h_™”
;

535 
asc_sÜt_sÿn_t
* 
h_li¡_sÜt_™”
;

537 if(
is_lifo
) {

545 
šdex_sÿn_™”_im¶
<
hŞdšg_t
>* 
tmp_h_™”
;

546 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

548 
xù_id
, 
acù_id
, 
symbŞ
);

549 
	`W_DO
(
_phŞdšg_mª
->
	`h_g‘_™”_by_šdex2
(
_pssm
, 
tmp_h_™”
,

550 
´hŞdšg
, 
low»p
,

551 
high»p
, 
acù_id
,

552 
symbŞ
, 
Œue
));

553 
h_™”
 = 
tmp_h_™”
;

563 
šdex_sÿn_™”_im¶
<
hŞdšg_t
>* 
tmp_h_™”
;

564 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

566 
xù_id
, 
acù_id
, 
symbŞ
);

567 
	`W_DO
(
_phŞdšg_mª
->
	`h_g‘_™”_by_šdex2
(
_pssm
, 
tmp_h_™”
,

568 
´hŞdšg
, 
low»p
,

569 
high»p
, 
acù_id
,

570 
symbŞ
));

571 
h_™”
 = 
tmp_h_™”
;

575 
boŞ
 
eof
;

576 
	`W_DO
(
h_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´hŞdšg
));

577 
Ãeded_qty
!=0 && !
eof
) {

578 
TId’t
 
hŞd_id
;

579 
hŞd_qty
;

580 
hŞd_´iû
;

582 
´hŞdšg
->
	`g‘_v®ue
(0, 
hŞd_id
);

583 
´hŞdšg
->
	`g‘_v®ue
(4, 
hŞd_´iû
);

584 
´hŞdšg
->
	`g‘_v®ue
(5, 
hŞd_qty
);

634 if(
hŞd_qty
 + 
Ãeded_qty
 < 0) {

635 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TR:h-update (%ld) (%s) (%d)\n",

636 
xù_id
, 
acù_id
, 
symbŞ
, (
hs_qty
 + 
Œade_qty
));

637 
	`W_DO
(
_phŞdšg_mª
->
	`h_upd©e_qty
(
_pssm
, 
´hŞdšg
,

638 (
hŞd_qty
 + 
Ãeded_qty
)));

640 
±rš
.
_hŞdšg_rid
[
num_d–‘ed
] = 
´hŞdšg
->
	`rid
();

641 
num_d–‘ed
++;

644 
´hŞdšghi¡Üy
->
	`£t_v®ue
(0, 
hŞd_id
);

645 
´hŞdšghi¡Üy
->
	`£t_v®ue
(1, 
±rš
.
_Œade_id
);

646 
´hŞdšghi¡Üy
->
	`£t_v®ue
(2, 
hŞd_qty
);

647 
´hŞdšghi¡Üy
->
	`£t_v®ue
(3,

648 (
hŞd_qty
 + 
Ãeded_qty
 < 0) ? (hold_qty +‚eeded_qty) : 0);

650 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

652 
xù_id
, 
hŞd_id
, 
±rš
.
_Œade_id
, 
hŞd_´iû
,

653 (
hŞd_qty
 + 
Ãeded_qty
));

654 
	`W_DO
(
_phŞdšg_hi¡Üy_mª
->
	`add_tu¶e
(
_pssm
, 
´hŞdšghi¡Üy
));

656 if(
hŞd_qty
 + 
Ãeded_qty
 < 0) {

657 
£Î_v®ue
 +ğ
Ãeded_qty
 * 
hŞd_´iû
;

658 
buy_v®ue
 +ğ
Ãeded_qty
 * 
±rš
.
_Œade_´iû
;

659 
Ãeded_qty
 = 0;

661 
hŞd_qty
 = -hold_qty;

662 
£Î_v®ue
 +ğ
hŞd_qty
 * 
hŞd_´iû
;

663 
buy_v®ue
 +ğ
hŞd_qty
 * 
±rš
.
_Œade_´iû
;

664 
Ãeded_qty
 =‚“ded_qty - 
hŞd_qty
;

667 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TR:hold-list (%ld) \n",

668 
xù_id
, 
hŞd_id
);

669 
	`W_DO
(
h_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´hŞdšg
));

672 
ušt
 
i
=0; i<
num_d–‘ed
; i++) {

673 
	`TRACE
(
TRACE_TRX_FLOW
,

674 "%d - TR:h-d–‘e-tu¶- (%d).(%d).(%d).(%d)\n", 
xù_id
,

675 (
±rš
.
_hŞdšg_rid
[
i
]).
pid
.
	`vŞ
().
vŞ
,

676 (
±rš
.
_hŞdšg_rid
[
i
]).
pid
.
	`¡Üe
(),

677 (
±rš
.
_hŞdšg_rid
[
i
]).
pid
.
·ge
,

678 (
±rš
.
_hŞdšg_rid
[
i
]).
¦Ù
);

679 
	`W_DO
(
_phŞdšg_mª
->
	`h_d–‘e_tu¶e
(
_pssm
, 
´hŞdšg
,

680 
±rš
.
_hŞdšg_rid
[
i
]));

690 ià(
Ãeded_qty
 > 0){

706 
´hŞdšghi¡Üy
->
	`£t_v®ue
(0, 
±rš
.
_Œade_id
);

707 
´hŞdšghi¡Üy
->
	`£t_v®ue
(1, 
±rš
.
_Œade_id
);

708 
´hŞdšghi¡Üy
->
	`£t_v®ue
(2, 0);

709 
´hŞdšghi¡Üy
->
	`£t_v®ue
(3, 
Ãeded_qty
);

711 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

713 
xù_id
, 
±rš
.
_Œade_id
,…Œš._Œade_id, 0, 
Ãeded_qty
);

714 
	`W_DO
(
_phŞdšg_hi¡Üy_mª
->
	`add_tu¶e
(
_pssm
, 
´hŞdšghi¡Üy
));

736 
´hŞdšg
->
	`£t_v®ue
(0, 
±rš
.
_Œade_id
);

737 
´hŞdšg
->
	`£t_v®ue
(1, 
acù_id
);

738 
´hŞdšg
->
	`£t_v®ue
(2, 
symbŞ
);

739 
´hŞdšg
->
	`£t_v®ue
(3, 
Œade_dts
);

740 
´hŞdšg
->
	`£t_v®ue
(4, 
±rš
.
_Œade_´iû
);

741 
´hŞdšg
->
	`£t_v®ue
(5, 
Ãeded_qty
);

743 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

745 
xù_id
, 
±rš
.
_Œade_id
, 
acù_id
, 
symbŞ
, 
Œade_dts
,

746 
±rš
.
_Œade_´iû
, 
Ãeded_qty
);

747 
	`W_DO
(
_phŞdšg_mª
->
	`add_tu¶e
(
_pssm
, 
´hŞdšg
));

748 } ià((-
hs_qty
è=ğ
Œade_qty
) {

753 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TR:hs-delete-tuple (%ld) (%s) \n",

754 
xù_id
, 
acù_id
, 
symbŞ
);

755 
	`W_DO
(
_phŞdšg_summ¬y_mª
->
	`d–‘e_tu¶e
(
_pssm
, 
´hŞdšgsumm¬y
));

761 
x_amouÁ
 = 0;

762 if((
x_¡©us
 =ğ1 ||ax_¡©u =ğ2è&& (
£Î_v®ue
 > 
buy_v®ue
)) {

763 
x_¿‹s
 = 0;

771 
gu¬d
< 
šdex_sÿn_™”_im¶
<
cu¡om”_x¿‹_t
> > 
cx_™”
;

773 
šdex_sÿn_™”_im¶
<
cu¡om”_x¿‹_t
>* 
tmp_cx_™”
;

774 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TR:ct-iter-by-idx (%ld) \n",

775 
xù_id
, 
cu¡_id
);

776 
	`W_DO
(
_pcu¡om”_x¿‹_mª
->
	`cx_g‘_™”_by_šdex
(
_pssm
, 
tmp_cx_™”
,

777 
´cu¡x¿‹
,

778 
low»p
, 
high»p
,

779 
cu¡_id
));

780 
cx_™”
 = 
tmp_cx_™”
;

782 
boŞ
 
eof
;

783 
	`W_DO
(
cx_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cu¡x¿‹
));

784 !
eof
) {

785 
x_id
[5];

786 
´cu¡x¿‹
->
	`g‘_v®ue
(0, 
x_id
, 5);

788 
	`TRACE
(
TRACE_TRX_FLOW
,"Aµ: %d TR:tx-idx-´ob(%s)\n", 
xù_id
, 
x_id
);

789 
	`W_DO
(
_±ax¿‹_mª
->
	`tx_šdex_´obe
(
_pssm
, 
´x¿‹
, 
x_id
));

791 
¿‹
;

792 
´x¿‹
->
	`g‘_v®ue
(2, 
¿‹
);

794 
x_¿‹s
 +ğ
¿‹
;

796 
	`W_DO
(
cx_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cu¡x¿‹
));

798 
x_amouÁ
 = (
£Î_v®ue
 - 
buy_v®ue
è* 
x_¿‹s
;

805 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TR:t-upd-tax-by-ind (%ld) (%d)\n",

806 
xù_id
, 
±rš
.
_Œade_id
, 
x_amouÁ
);

807 
	`W_DO
(
_±¿de_mª
->
	`t_upd©e_x_by_šdex
(
_pssm
, 
´Œade
, 
±rš
.
_Œade_id
,

808 
x_amouÁ
));

809 
	`as£¹
(
x_amouÁ
 > 0);

812 
comm_¿‹
 = 0;

813 
s_Çme
[51];

822 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TR:£cur™y-idx-´ob(%s)\n", 
xù_id
, 
symbŞ
);

823 
	`W_DO
(
_p£cur™y_mª
->
	`s_šdex_´obe
(
_pssm
, 
´£cur™y
, 
symbŞ
));

825 
s_ex_id
[7];

826 
´£cur™y
->
	`g‘_v®ue
(3, 
s_Çme
, 51);

827 
´£cur™y
->
	`g‘_v®ue
(4, 
s_ex_id
, 7);

834 
gu¬d
< 
šdex_sÿn_™”_im¶
<
cu¡om”_t
> > 
c_™”
;

836 
šdex_sÿn_™”_im¶
<
cu¡om”_t
>* 
tmp_c_™”
;

837 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TR:c-get-iter-by-idx3 (%ld) \n",

838 
xù_id
, 
cu¡_id
);

839 
	`W_DO
(
_pcu¡om”_mª
->
	`c_g‘_™”_by_šdex3
(
_pssm
, 
tmp_c_™”
, 
´cu¡om”
,

840 
low»p
, 
high»p
, 
cu¡_id
));

841 
c_™”
 = 
tmp_c_™”
;

843 
boŞ
 
eof
;

844 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TR:c-™”-Ãxˆ\n", 
xù_id
);

845 
	`W_DO
(
c_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cu¡om”
));

847 
c_t›r
;

848 
´cu¡om”
->
	`g‘_v®ue
(7, 
c_t›r
);

856 
gu¬d
< 
šdex_sÿn_™”_im¶
<
commissiÚ_¿‹_t
> > 
ü_™”
;

858 
šdex_sÿn_™”_im¶
<
commissiÚ_¿‹_t
>* 
tmp_ü_™”
;

859 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TR:cr-iter-by-idx (%d) (%s) (%ld) (%d) \n",

860 
xù_id
, 
c_t›r
, 
ty³_id
, 
s_ex_id
, 
Œade_qty
);

861 
	`W_DO
(
_pcommissiÚ_¿‹_mª
->
	`ü_g‘_™”_by_šdex
(
_pssm
, 
tmp_ü_™”
,

862 
´commissiÚ¿‹
, 
low»p
,

863 
high»p
, 
c_t›r
, 
ty³_id
,

864 
s_ex_id
, 
Œade_qty
));

865 
ü_™”
 = 
tmp_ü_™”
;

867 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TR:ü-™”-Ãxˆ\n", 
xù_id
);

868 
	`W_DO
(
ü_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´commissiÚ¿‹
));

869 !
eof
) {

870 
to_qty
;

871 
´commissiÚ¿‹
->
	`g‘_v®ue
(4, 
to_qty
);

872 if(
to_qty
 >ğ
Œade_qty
){

873 
´commissiÚ¿‹
->
	`g‘_v®ue
(5, 
comm_¿‹
);

876 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TR:ü-™”-Ãxˆ\n", 
xù_id
);

877 
	`W_DO
(
ü_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´commissiÚ¿‹
));

880 
	`as£¹
(
comm_¿‹
 > 0.00);

882 
comm_amouÁ
 = (
comm_¿‹
 / 100è* (
Œade_qty
 * 
±rš
.
_Œade_´iû
);

883 
¡_com¶‘ed_id
[5] = "CMPT";

893 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

895 
xù_id
, 
±rš
.
_Œade_id
, 
comm_amouÁ
, 
Œade_dts
, 
¡_com¶‘ed_id
,

896 
±rš
.
_Œade_´iû
);

897 
	`W_DO
(
_±¿de_mª
->
	`t_upd©e_ÿ_td_sci__by_šdex
(
_pssm
, 
´Œade
,

898 
±rš
.
_Œade_id
, 
comm_amouÁ
,

899 
Œade_dts
, 
¡_com¶‘ed_id
,

900 
±rš
.
_Œade_´iû
));

909 
myTime
 
now_dts
 = 
	`time
(
NULL
);

911 
´Œadehi¡
->
	`£t_v®ue
(0, 
±rš
.
_Œade_id
);

912 
´Œadehi¡
->
	`£t_v®ue
(1, 
now_dts
);

913 
´Œadehi¡
->
	`£t_v®ue
(2, 
¡_com¶‘ed_id
);

915 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TR:th-add-tuple (%ld) \n",

916 
xù_id
, 
±rš
.
_Œade_id
);

917 
	`W_DO
(
_±¿de_hi¡Üy_mª
->
	`add_tu¶e
(
_pssm
, 
´Œadehi¡
));

924 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TR:broker-upd-ca_td_sci_tp-by-ind (%ld)(%d)\n",

925 
xù_id
, 
brok”_id
, 
comm_amouÁ
);

926 
	`W_DO
(
_pbrok”_mª
->
	`brok”_upd©e_ÿ_Á_by_šdex
(
_pssm
, 
´brok”
, 
brok”_id
,

927 
comm_amouÁ
));

930 
myTime
 
due_d©e
 = 
Œade_dts
 + 48*60*60;

931 
£_amouÁ
;

932 if(
ty³_is_£Î
) {

933 
£_amouÁ
 = (
Œade_qty
 * 
±rš
.
_Œade_´iû
è- 
ch¬ge
 - 
comm_amouÁ
;

935 
£_amouÁ
 = -((
Œade_qty
 * 
±rš
.
_Œade_´iû
è+ 
ch¬ge
 + 
comm_amouÁ
);

937 ià(
x_¡©us
 == 1){

938 
£_amouÁ
 = se_amouÁ - 
x_amouÁ
;

942 
ÿsh_ty³
[41] = "\0";

943 if(
Œade_is_ÿsh
) {

944 
	`¡rıy
 (
ÿsh_ty³
, "Cash Account");

946 
	`¡rıy
(
ÿsh_ty³
,"Margin");

963 
´£‰Ëm’t
->
	`£t_v®ue
(0, 
±rš
.
_Œade_id
);

964 
´£‰Ëm’t
->
	`£t_v®ue
(1, 
ÿsh_ty³
);

965 
´£‰Ëm’t
->
	`£t_v®ue
(2, 
due_d©e
);

966 
´£‰Ëm’t
->
	`£t_v®ue
(3, 
£_amouÁ
);

968 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TR:se-add-tuple (%ld)\n",

969 
xù_id
, 
±rš
.
_Œade_id
);

970 
	`W_DO
(
_p£‰Ëm’t_mª
->
	`add_tu¶e
(
_pssm
, 
´£‰Ëm’t
));

972 if(
Œade_is_ÿsh
) {

978 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TR:ÿ-upd-tu¶(%ld)\n", 
xù_id
, 
acù_id
);

979 
	`W_DO
(
_pcu¡om”_accouÁ_mª
->
	`ÿ_upd©e_b®
(
_pssm
, 
´cu¡accouÁ
,

980 
acù_id
, 
£_amouÁ
));

982 
acù_b®
;

983 
´cu¡accouÁ
->
	`g‘_v®ue
(5, 
acù_b®
);

990 
´ÿshŒªs
->
	`£t_v®ue
(0, 
±rš
.
_Œade_id
);

991 
´ÿshŒªs
->
	`£t_v®ue
(1, 
Œade_dts
);

992 
´ÿshŒªs
->
	`£t_v®ue
(2, 
£_amouÁ
);

993 
¡ršg¡»am
 
ss
;

994 
ss
 << 
ty³_Çme
 << " " << 
Œade_qty
 << " sh¬e oà" << 
s_Çme
;

995 
´ÿshŒªs
->
	`£t_v®ue
(3, 
ss
.
	`¡r
().
	`c_¡r
());

997 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TR:ct-add-tuple (%ld) (%ld) (%lf) (%s)\n",

998 
xù_id
, 
Œade_dts
, 
±rš
.
_Œade_id
, 
£_amouÁ
, 
ss
.
	`¡r
().
	`c_¡r
());

999 
	`W_DO
(
_pÿsh_Œª§ùiÚ_mª
->
	`add_tu¶e
(
_pssm
, 
´ÿshŒªs
));

1012 
	`TRACE
(
TRACE_TRX_FLOW
,"Aµ: %d TR:ÿ-šdex-´ob(%ld)\n", 
xù_id
, 
acù_id
);

1013 
	`W_DO
(
_pcu¡om”_accouÁ_mª
->
	`ÿ_šdex_´obe
(
_pssm
,
´cu¡accouÁ
,
acù_id
));

1014 
acù_b®
;

1015 
´cu¡accouÁ
->
	`g‘_v®ue
(5, 
acù_b®
);

1018 #ifdeà
PRINT_TRX_RESULTS


1021 
¹¿de
.
	`´št_tu¶e
();

1022 
¹¿d‘y³
.
	`´št_tu¶e
();

1023 
rhŞdšgsumm¬y
.
	`´št_tu¶e
();

1024 
rcu¡accouÁ
.
	`´št_tu¶e
();

1025 
rhŞdšg
.
	`´št_tu¶e
();

1026 
r£cur™y
.
	`´št_tu¶e
();

1027 
rbrok”
.
	`´št_tu¶e
();

1028 
r£‰Ëm’t
.
	`´št_tu¶e
();

1029 
rÿshŒªs
.
	`´št_tu¶e
();

1030 
rcommussiÚ¿‹
.
	`´št_tu¶e
();

1031 
rcu¡x¿‹
.
	`´št_tu¶e
();

1032 
¹ax¿‹
.
	`´št_tu¶e
();

1033 
rcu¡om”
.
	`´št_tu¶e
();

1034 
¹¿dehi¡
.
	`´št_tu¶e
();

1037  
RCOK
;

1039 
	}
}

1042 
EXIT_NAMESPACE
(
û
);

	@src/workload/tpce/shore_tpce_xct_trade_status.cpp

32 
	~"wÜklßd/û/shÜe_û_’v.h
"

33 
	~"wÜklßd/û/û_cÚ¡.h
"

34 
	~"wÜklßd/û/û_šput.h
"

36 
	~<veùÜ
>

37 
	~<num”ic
>

38 
	~<®gÜ™hm
>

39 
	~<¡dio.h
>

40 
	~<¡dlib.h
>

41 
	~"wÜklßd/û/eg’/CE.h
"

42 
	~"wÜklßd/û/eg’/TxnH¬ÃssSŒuùs.h
"

43 
	~"wÜklßd/û/shÜe_û_eg’.h
"

45 
usšg
 
Çme¥aû
 
	gshÜe
;

46 
usšg
 
Çme¥aû
 
	gTPCE
;

48 
ENTER_NAMESPACE
(
û
);

56 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_Œade_¡©us
(cÚ¡ 
xù_id
,

57 
Œade_¡©us_šput_t
& 
±sš
)

60 
	`as£¹
 (
_pssm
);

61 
	`as£¹
 (
_š™Ÿlized
);

62 
	`as£¹
 (
_lßded
);

64 
tu¶e_gu¬d
<
brok”_mª_im¶
> 
	`´brok”
(
_pbrok”_mª
);

65 
tu¶e_gu¬d
<
cu¡om”_mª_im¶
> 
	`´cu¡om”
(
_pcu¡om”_mª
);

66 
tu¶e_gu¬d
<
cu¡om”_accouÁ_mª_im¶
> 
	`´cu¡acù
(
_pcu¡om”_accouÁ_mª
);

67 
tu¶e_gu¬d
<
exchªge_mª_im¶
> 
	`´exchªge
(
_³xchªge_mª
);

68 
tu¶e_gu¬d
<
£cur™y_mª_im¶
> 
	`´£cur™y
(
_p£cur™y_mª
);

69 
tu¶e_gu¬d
<
¡©us_ty³_mª_im¶
> 
	`´¡©u¡y³
(
_p¡©us_ty³_mª
);

70 
tu¶e_gu¬d
<
Œade_mª_im¶
> 
	`´Œade
(
_±¿de_mª
);

71 
tu¶e_gu¬d
<
Œade_ty³_mª_im¶
> 
	`´Œad‘y³
(
_±¿de_ty³_mª
);

73 
»p_row_t
 
	`¬•row
(
_±¿de_mª
->
	`ts
());

75 
¬•row
.
	`£t
(
_±¿de_desc
->
	`maxsize
());

77 
´brok”
->
_»p
 = &
¬•row
;

78 
´cu¡om”
->
_»p
 = &
¬•row
;

79 
´cu¡acù
->
_»p
 = &
¬•row
;

80 
´exchªge
->
_»p
 = &
¬•row
;

81 
´£cur™y
->
_»p
 = &
¬•row
;

82 
´¡©u¡y³
->
_»p
 = &
¬•row
;

83 
´Œade
->
_»p
 = &
¬•row
;

84 
´Œad‘y³
->
_»p
 = &
¬•row
;

86 
»p_row_t
 
	`low»p
Ğ
_³xchªge_mª
->
	`ts
());

87 
»p_row_t
 
	`high»p
Ğ
_³xchªge_mª
->
	`ts
());

90 
low»p
.
	`£t
(
_³xchªge_desc
->
	`maxsize
());

91 
high»p
.
	`£t
(
_³xchªge_desc
->
	`maxsize
());

93 
TId’t
 
Œade_id
[50];

94 
myTime
 
Œade_dts
[50];

95 
¡©us_Çme
[50][11];

96 
ty³_Çme
[50][13];

97 
symbŞ
[50][16];

98 
Œade_qty
[50];

99 
exec_Çme
[50][50];

100 
ch¬ge
[50];

101 
s_Çme
[50][71];

102 
ex_Çme
[50][101];

131 
gu¬d
< 
šdex_sÿn_™”_im¶
<
Œade_t
> > 
t_™”
;

132 
i
 = 0;

133 
boŞ
 
eof
;

134 
i
 !=
max_Œade_¡©us_Ën
) {

135 
i
 = 0;

137 
šdex_sÿn_™”_im¶
<
Œade_t
>* 
tmp_t_™”
;

138 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TS:t-iter-by-idx2 (%ld) \n",

139 
xù_id
, 
±sš
.
_acù_id
);

140 
	`W_DO
(
_±¿de_mª
->
	`t_g‘_™”_by_šdex2
(
_pssm
, 
tmp_t_™”
, 
´Œade
,

141 
low»p
, 
high»p
,

142 
±sš
.
_acù_id
, 0, 
MAX_DTS
,

143 
Œue
));

144 
t_™”
 = 
tmp_t_™”
;

146 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TS:t-™”-Ãxˆ\n", 
xù_id
);

147 
	`W_DO
(
t_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œade
));

148 !
eof
 && 
i
 < 
max_Œade_¡©us_Ën
) {

149 
´Œade
->
	`g‘_v®ue
(0, 
Œade_id
[
i
]);

150 
´Œade
->
	`g‘_v®ue
(1, 
Œade_dts
[
i
]);

151 
´Œade
->
	`g‘_v®ue
(5, 
symbŞ
[
i
], 16);

152 
´Œade
->
	`g‘_v®ue
(6, 
Œade_qty
[
i
]);

153 
´Œade
->
	`g‘_v®ue
(9, 
exec_Çme
[
i
], 50);

154 
´Œade
->
	`g‘_v®ue
(11, 
ch¬ge
[
i
]);

155 
t_¡_id
[5], 
t_‰_id
[4];

156 
´Œade
->
	`g‘_v®ue
(2, 
t_¡_id
, 5);

157 
´Œade
->
	`g‘_v®ue
(3, 
t_‰_id
, 4);

159 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TS:st-idx-probe (%s) \n",

160 
xù_id
, 
t_¡_id
);

161 
	`W_DO
(
_p¡©us_ty³_mª
->
	`¡_šdex_´obe
(
_pssm
, 
´¡©u¡y³
, 
t_¡_id
));

162 
´¡©u¡y³
->
	`g‘_v®ue
(1, 
¡©us_Çme
[
i
], 11);

164 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TS:tt-idx-probe (%s) \n",

165 
xù_id
, 
t_‰_id
);

166 
	`W_DO
(
_±¿de_ty³_mª
->
	`‰_šdex_´obe
(
_pssm
, 
´Œad‘y³
, 
t_‰_id
));

167 
´Œad‘y³
->
	`g‘_v®ue
(1, 
ty³_Çme
[
i
], 13);

169 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TS:s-idx-probe (%s) \n",

170 
xù_id
, 
symbŞ
[
i
]);

171 
	`W_DO
(
_p£cur™y_mª
->
	`s_šdex_´obe
(
_pssm
, 
´£cur™y
, 
symbŞ
[
i
]));

172 
´£cur™y
->
	`g‘_v®ue
(3, 
s_Çme
[
i
], 71);

173 
s_ex_id
[7];

174 
´£cur™y
->
	`g‘_v®ue
(4, 
s_ex_id
, 7);

176 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TS:ex-idx-probe (%s) \n",

177 
xù_id
, 
s_ex_id
);

178 
	`W_DO
(
_³xchªge_mª
->
	`ex_šdex_´obe
(
_pssm
, 
´exchªge
, 
s_ex_id
));

179 
´exchªge
->
	`g‘_v®ue
(1, 
ex_Çme
[
i
], 101);

181 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TS:t-™”-Ãxˆ\n", 
xù_id
);

182 
	`W_DO
(
t_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œade
));

183 
i
++;

186 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TS:couÁ-aá”-sÜˆ%d\n", 
xù_id
, 
i
);

187 
	`as£¹
(
i
 =ğ
max_Œade_¡©us_Ën
);

203 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TS:ca-idx-probe (%ld) \n",

204 
xù_id
, 
±sš
.
_acù_id
);

205 
	`W_DO
(
_pcu¡om”_accouÁ_mª
->
	`ÿ_šdex_´obe
(
_pssm
,
´cu¡acù
,
±sš
.
_acù_id
));

206 
TId’t
 
ÿ_c_id
, 
ÿ_b_id
;

207 
´cu¡acù
->
	`g‘_v®ue
(1, 
ÿ_b_id
);

208 
´cu¡acù
->
	`g‘_v®ue
(2, 
ÿ_c_id
);

210 
gu¬d
< 
šdex_sÿn_™”_im¶
<
brok”_t
> > 
br_™”
;

212 
šdex_sÿn_™”_im¶
<
brok”_t
>* 
tmp_br_™”
;

213 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d BV:b-get-iter-by-idx3 (%s) \n",

214 
xù_id
, 
ÿ_b_id
);

215 
	`W_DO
(
_pbrok”_mª
->
	`b_g‘_™”_by_šdex2
(
_pssm
, 
tmp_br_™”
, 
´brok”
,

216 
low»p
, 
high»p
, 
ÿ_b_id
));

217 
br_™”
 = 
tmp_br_™”
;

220 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TO:br-™”-Ãxˆ\n", 
xù_id
);

221 
	`W_DO
(
br_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´brok”
));

222 if(
eof
è{ 
	`W_DO
(
	`RC
(
£_NOT_FOUND
)); }

223 
brok”_Çme
[50];

224 
´brok”
->
	`g‘_v®ue
(2, 
brok”_Çme
, 50);

226 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TS:c-idx-´ob(%ldè\n", 
xù_id
, 
ÿ_c_id
);

227 
	`W_DO
(
_pcu¡om”_mª
->
	`c_šdex_´obe
(
_pssm
, 
´cu¡om”
, 
ÿ_c_id
));

228 
cu¡_l_Çme
[26];

229 
cu¡_f_Çme
[21];

230 
´cu¡om”
->
	`g‘_v®ue
(3, 
cu¡_l_Çme
, 26);

231 
´cu¡om”
->
	`g‘_v®ue
(4, 
cu¡_f_Çme
, 21);

233 #ifdeà
PRINT_TRX_RESULTS


236 
rbrok”
.
	`´št_tu¶e
();

237 
rcu¡acù
.
	`´št_tu¶e
();

238 
rcu¡om”
.
	`´št_tu¶e
();

239 
»xchªge
.
	`´št_tu¶e
();

240 
r£cur™y
.
	`´št_tu¶e
();

241 
r¡©u¡y³
.
	`´št_tu¶e
();

242 
¹¿de
.
	`´št_tu¶e
();

243 
¹¿d‘y³
.
	`´št_tu¶e
();

246  
RCOK
;

248 
	}
}

251 
EXIT_NAMESPACE
(
û
);

	@src/workload/tpce/shore_tpce_xct_trade_update.cpp

32 
	~"wÜklßd/û/shÜe_û_’v.h
"

33 
	~"wÜklßd/û/û_cÚ¡.h
"

34 
	~"wÜklßd/û/û_šput.h
"

36 
	~<veùÜ
>

37 
	~<num”ic
>

38 
	~<®gÜ™hm
>

39 
	~<¡dio.h
>

40 
	~<¡dlib.h
>

41 
	~"wÜklßd/û/eg’/CE.h
"

42 
	~"wÜklßd/û/eg’/TxnH¬ÃssSŒuùs.h
"

43 
	~"wÜklßd/û/shÜe_û_eg’.h
"

45 
usšg
 
Çme¥aû
 
	gshÜe
;

46 
usšg
 
Çme¥aû
 
	gTPCE
;

48 
ENTER_NAMESPACE
(
û
);

56 
w_rc_t
 
	gShÜeTPCEEnv
::
	$xù_Œade_upd©e
(cÚ¡ 
xù_id
, 
Œade_upd©e_šput_t
& 
±uš
)

59 
	`as£¹
 (
_pssm
);

60 
	`as£¹
 (
_š™Ÿlized
);

61 
	`as£¹
 (
_lßded
);

63 
tu¶e_gu¬d
<
ÿsh_Œª§ùiÚ_mª_im¶
> 
	`´ÿshŒªs
(
_pÿsh_Œª§ùiÚ_mª
);

64 
tu¶e_gu¬d
<
£cur™y_mª_im¶
> 
	`´£cur™y
(
_p£cur™y_mª
);

65 
tu¶e_gu¬d
<
£‰Ëm’t_mª_im¶
> 
	`´£‰Ëm’t
(
_p£‰Ëm’t_mª
);

66 
tu¶e_gu¬d
<
Œade_mª_im¶
> 
	`´Œade
(
_±¿de_mª
);

67 
tu¶e_gu¬d
<
Œade_ty³_mª_im¶
> 
	`´Œad‘y³
(
_±¿de_ty³_mª
);

68 
tu¶e_gu¬d
<
Œade_hi¡Üy_mª_im¶
> 
	`´Œadehi¡
(
_±¿de_hi¡Üy_mª
);

70 
»p_row_t
 
	`¬•row
(
_p£cur™y_mª
->
	`ts
());

72 
¬•row
.
	`£t
(
_p£cur™y_desc
->
	`maxsize
());

74 
´ÿshŒªs
->
_»p
 = &
¬•row
;

75 
´£cur™y
->
_»p
 = &
¬•row
;

76 
´£‰Ëm’t
->
_»p
 = &
¬•row
;

77 
´Œade
->
_»p
 = &
¬•row
;

78 
´Œad‘y³
->
_»p
 = &
¬•row
;

79 
´Œadehi¡
->
_»p
 = &
¬•row
;

81 
»p_row_t
 
	`low»p
Ğ
_p£cur™y_mª
->
	`ts
());

82 
»p_row_t
 
	`high»p
Ğ
_p£cur™y_mª
->
	`ts
());

85 
low»p
.
	`£t
(
_p£cur™y_desc
->
	`maxsize
());

86 
high»p
.
	`£t
(
_p£cur™y_desc
->
	`maxsize
());

88 
max_Œades
 = 
±uš
.
_max_Œades
;

89 
num_found
 = 0;

90 
num_upd©ed
 = 0;

92 if(
±uš
.
_äame_to_execu‹
 == 1) {

93 
i
;

95 
¬¿y_gu¬d_t
<> 
bid_´iû
 = 
Ãw
 [
max_Œades
];

96 
¬¿y_gu¬d_t
< [50] > 
exec_Çme
 = 
Ãw
 [
max_Œades
][50];

97 
¬¿y_gu¬d_t
<
boŞ
> 
is_ÿsh
 = 
Ãw
 boŞ[
max_Œades
];

98 
¬¿y_gu¬d_t
<
boŞ
> 
is_m¬k‘
 = 
Ãw
 boŞ[
max_Œades
];

99 
¬¿y_gu¬d_t
<> 
Œade_´iû
 = 
Ãw
 [
max_Œades
];

100 
¬¿y_gu¬d_t
<> 
£‰Ëm’t_amouÁ
 = 
Ãw
 [
max_Œades
];

101 
¬¿y_gu¬d_t
<
myTime
> 
£‰Ëm’t_ÿsh_due_d©e
 = 
Ãw
 myTime[
max_Œades
];

102 
¬¿y_gu¬d_t
< [41] > 
£‰Ëm’t_ÿsh_ty³
 = 
Ãw
 [
max_Œades
][41];

103 
¬¿y_gu¬d_t
<> 
ÿsh_Œª§ùiÚ_amouÁ
 = 
Ãw
 [
max_Œades
];

104 
¬¿y_gu¬d_t
<
myTime
> 
ÿsh_Œª§ùiÚ_dts
 = 
Ãw
 myTime[
max_Œades
];

105 
¬¿y_gu¬d_t
< [101] > 
ÿsh_Œª§ùiÚ_Çme
=
Ãw
 [
max_Œades
][101];

106 
¬¿y_gu¬d_t
< 
myTime
[3] > 
Œade_hi¡Üy_dts
 = 
Ãw
 myTime[
max_Œades
][3];

107 
¬¿y_gu¬d_t
< [3][5] > 
Œade_hi¡Üy_¡©us_id
 = 
Ãw
 [
max_Œades
][3][5];

109 
i
 = 0; i < 
max_Œades
; i++){

110 if(
num_upd©ed
 < 
±uš
.
_max_upd©es
){

120 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TU:t-idx-probe-for-update (%ld)\n",

121 
xù_id
, 
±uš
.
_Œade_id
[
i
]);

122 
	`W_DO
(
_±¿de_mª
->
	`t_šdex_´obe_fÜupd©e
(
_pssm
, 
´Œade
,

123 
±uš
.
_Œade_id
[
i
]));

125 
ex_Çme
[50];

126 
´Œade
->
	`g‘_v®ue
(9, 
ex_Çme
, 50);

128 
num_found
++;

130 
¡ršg
 
	`‹mp_exec_Çme
(
ex_Çme
);

131 
size_t
 
šdex
 = 
‹mp_exec_Çme
.
	`fšd
(" X ");

132 if(
šdex
 !ğ
¡ršg
::
Åos
){

133 
‹mp_exec_Çme
.
	`»¶aû
(
šdex
, 3, " ");

135 
šdex
 = 
‹mp_exec_Çme
.
	`fšd
(" ");

136 
‹mp_exec_Çme
.
	`»¶aû
(
šdex
, 1, " X ");

138 
	`¡rıy
(
ex_Çme
, 
‹mp_exec_Çme
.
	`c_¡r
());

148 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TU:t-update-exec-name (%s) \n",

149 
xù_id
, 
ex_Çme
);

150 
	`W_DO
(
_±¿de_mª
->
	`t_upd©e_Çme
(
_pssm
, 
´Œade
, 
ex_Çme
));

152 
num_upd©ed
++;

174 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "TL: %d TU:t-idx-probe (%ld) \n",

175 
xù_id
, 
±uš
.
_Œade_id
[
i
]);

176 
	`W_DO
(
_±¿de_mª
->
	`t_šdex_´obe
(
_pssm
,
´Œade
,
±uš
.
_Œade_id
[
i
]));

179 
´Œade
->
	`g‘_v®ue
(4, 
is_ÿsh
[
i
]);

180 
´Œade
->
	`g‘_v®ue
(7, 
bid_´iû
[
i
]);

181 
´Œade
->
	`g‘_v®ue
(9, 
exec_Çme
[
i
], 50);

182 
´Œade
->
	`g‘_v®ue
(10, 
Œade_´iû
[
i
]);

183 
‰_id
[4];

184 
´Œade
->
	`g‘_v®ue
(3, 
‰_id
, 4);

186 
	`TRACE
(
TRACE_TRX_FLOW
, "Aµ: %d TU:‰-idx-´ob(%s)\n", 
xù_id
, 
‰_id
);

187 
	`W_DO
(
_±¿de_ty³_mª
->
	`‰_šdex_´obe
(
_pssm
, 
´Œad‘y³
, 
‰_id
));

188 
´Œad‘y³
->
	`g‘_v®ue
(3, 
is_m¬k‘
[
i
]);

200 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TU:settlement-idx-probe (%ld) \n",

201 
xù_id
, 
±uš
.
_Œade_id
[
i
]);

202 
	`W_DO
(
_p£‰Ëm’t_mª
->
	`£_šdex_´obe
(
_pssm
, 
´£‰Ëm’t
,

203 
±uš
.
_Œade_id
[
i
]));

204 
´£‰Ëm’t
->
	`g‘_v®ue
(3, 
£‰Ëm’t_amouÁ
[
i
]);

205 
´£‰Ëm’t
->
	`g‘_v®ue
(2, 
£‰Ëm’t_ÿsh_due_d©e
[
i
]);

206 
´£‰Ëm’t
->
	`g‘_v®ue
(1, 
£‰Ëm’t_ÿsh_ty³
[
i
], 41);

208 if(
is_ÿsh
[
i
]){

219 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

221 
xù_id
, 
±uš
.
_Œade_id
[
i
]);

222 
	`W_DO
(
_pÿsh_Œª§ùiÚ_mª
->
	`ù_šdex_´obe
(
_pssm
, 
´ÿshŒªs
,

223 
±uš
.
_Œade_id
[
i
]));

224 
´ÿshŒªs
->
	`g‘_v®ue
(1, 
ÿsh_Œª§ùiÚ_dts
[
i
]);

225 
´ÿshŒªs
->
	`g‘_v®ue
(2, 
ÿsh_Œª§ùiÚ_amouÁ
[
i
]);

226 
´ÿshŒªs
->
	`g‘_v®ue
(3, 
ÿsh_Œª§ùiÚ_Çme
[
i
], 101);

240 
gu¬d
<
šdex_sÿn_™”_im¶
<
Œade_hi¡Üy_t
> > 
th_™”
;

242 
šdex_sÿn_™”_im¶
<
Œade_hi¡Üy_t
>* 
tmp_th_™”
;

243 
	`TRACE
(
TRACE_TRX_FLOW
, "Aµ: %d TU:th-™”-by-Œade-idx\n", 
xù_id
);

244 
	`W_DO
(
_±¿de_hi¡Üy_mª
->
	`th_g‘_™”_by_šdex
(
_pssm
, 
tmp_th_™”
,

245 
´Œadehi¡
,

246 
low»p
, 
high»p
,

247 
±uš
.
_Œade_id
[
i
]));

248 
th_™”
 = 
tmp_th_™”
;

252 
boŞ
 
eof
;

253 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TU:th-™”-Ãxˆ\n", 
xù_id
);

254 
	`W_DO
(
th_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œadehi¡
));

255 
j
=0;

256 !
eof
 && 
j
<3) {

257 
´Œadehi¡
->
	`g‘_v®ue
(1, 
Œade_hi¡Üy_dts
[
i
][
j
]);

258 
´Œadehi¡
->
	`g‘_v®ue
(2, 
Œade_hi¡Üy_¡©us_id
[
i
][
j
], 5);

259 
j
++;

260 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TU:th-™”-Ãxˆ\n", 
xù_id
);

261 
	`W_DO
(
th_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œadehi¡
));

265 
	`as£¹
(
num_found
 =ğ
max_Œades
 && 
num_upd©ed
 =ğ
±uš
.
_max_upd©es
);

266 } if(
±uš
.
_äame_to_execu‹
 == 2){

267 
i
;

269 
¬¿y_gu¬d_t
<> 
bid_´iû
 = 
Ãw
 [
max_Œades
];

270 
¬¿y_gu¬d_t
< [50] > 
exec_Çme
 = 
Ãw
 [
max_Œades
][50];

271 
¬¿y_gu¬d_t
<
boŞ
> 
is_ÿsh
 = 
Ãw
 boŞ[
max_Œades
];

272 
¬¿y_gu¬d_t
<
TId’t
> 
Œade_li¡
 = 
Ãw
 TId’t[
max_Œades
];

273 
¬¿y_gu¬d_t
<> 
Œade_´iû
 = 
Ãw
 [
max_Œades
];

274 
¬¿y_gu¬d_t
<> 
£‰Ëm’t_amouÁ
 = 
Ãw
 [
max_Œades
];

275 
¬¿y_gu¬d_t
<
myTime
> 
£‰Ëm’t_ÿsh_due_d©e
 = 
Ãw
 myTime[
max_Œades
];

276 
¬¿y_gu¬d_t
< [41] > 
£‰Ëm’t_ÿsh_ty³
 = 
Ãw
 [
max_Œades
][41];

277 
¬¿y_gu¬d_t
<> 
ÿsh_Œª§ùiÚ_amouÁ
 = 
Ãw
 [
max_Œades
];

278 
¬¿y_gu¬d_t
<
myTime
> 
ÿsh_Œª§ùiÚ_dts
 = 
Ãw
 myTime[
max_Œades
];

279 
¬¿y_gu¬d_t
< [101] > 
ÿsh_Œª§ùiÚ_Çme
=
Ãw
 [
max_Œades
][101];

280 
¬¿y_gu¬d_t
< 
myTime
[3] > 
Œade_hi¡Üy_dts
 = 
Ãw
 myTime[
max_Œades
][3];

281 
¬¿y_gu¬d_t
< [3][5] > 
Œade_hi¡Üy_¡©us_id
 = 
Ãw
 [
max_Œades
][3][5];

299 
gu¬d
<
šdex_sÿn_™”_im¶
<
Œade_t
> > 
t_™”
;

301 
šdex_sÿn_™”_im¶
<
Œade_t
>* 
tmp_t_™”
;

302 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TL:t-iter-by-idx2 %ld %ld %ld \n",

303 
xù_id
, 
±uš
.
_acù_id
,…tuš.
_¡¬t_Œade_dts
,

304 
±uš
.
_’d_Œade_dts
);

305 
	`W_DO
(
_±¿de_mª
->
	`t_g‘_™”_by_šdex2
(
_pssm
, 
tmp_t_™”
, 
´Œade
,

306 
low»p
, 
high»p
, 
±uš
.
_acù_id
,

307 
±uš
.
_¡¬t_Œade_dts
,

308 
±uš
.
_’d_Œade_dts
));

309 
t_™”
 = 
tmp_t_™”
;

312 
boŞ
 
eof
;

313 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TL:t-™”-Ãxˆ\n", 
xù_id
);

314 
	`W_DO
(
t_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œade
));

315 
j
 = 0; j < 
max_Œades
 && !
eof
; j++){

316 
´Œade
->
	`g‘_v®ue
(7, 
bid_´iû
[
j
]);

317 
´Œade
->
	`g‘_v®ue
(9, 
exec_Çme
[
j
], 50);

318 
´Œade
->
	`g‘_v®ue
(4, 
is_ÿsh
[
j
]);

319 
´Œade
->
	`g‘_v®ue
(0, 
Œade_li¡
[
j
]);

320 
´Œade
->
	`g‘_v®ue
(10, 
Œade_´iû
[
j
]);

322 
num_found
++;

324 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TL:t-™”-Ãxˆ\n", 
xù_id
);

325 
	`W_DO
(
t_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œade
));

327 
i
 = 0; i < 
num_found
; i++) {

328 if(
num_upd©ed
 < 
±uš
.
_max_upd©es
){

337 
	`TRACE
(
TRACE_TRX_FLOW
, "App: %d TU:se-idx-probe-for-update (%ld)\n",

338 
xù_id
, 
Œade_li¡
[
i
]);

339 
	`W_DO
(
_p£‰Ëm’t_mª
->
	`£_šdex_´obe_fÜupd©e
(
_pssm
,

340 
´£‰Ëm’t
,

341 
Œade_li¡
[
i
]));

342 
£_ÿsh_ty³
[41];

343 
´£‰Ëm’t
->
	`g‘_v®ue
(1, 
£_ÿsh_ty³
, 41);

345 
¡ršg
 
‹mp_ÿsh_ty³
;

346 if(
is_ÿsh
[
i
]){

347 if(
	`¡rcmp
(
£_ÿsh_ty³
, "Cash Account") == 0){

348 
‹mp_ÿsh_ty³
 = "Cash";

350 
‹mp_ÿsh_ty³
 = "Cash Account";

353 if(
	`¡rcmp
(
£_ÿsh_ty³
, "Margin Account") == 0){

354 
‹mp_ÿsh_ty³
 = "Margin";

356 
‹mp_ÿsh_ty³
 = "Margin Account";

368 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TU:se-update-exec-name (%s) \n",

369 
xù_id
, 
‹mp_ÿsh_ty³
.
	`c_¡r
());

370 
	`W_DO
(
_p£‰Ëm’t_mª
->
	`£_upd©e_Çme
(
_pssm
, 
´£‰Ëm’t
,

371 
‹mp_ÿsh_ty³
.
	`c_¡r
()));

373 
num_upd©ed
++;

391 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TU:se-idx-probe (%ld) \n",

392 
xù_id
, 
Œade_li¡
[
i
]);

393 
	`W_DO
(
_p£‰Ëm’t_mª
->
	`£_šdex_´obe
(
_pssm
, 
´£‰Ëm’t
,

394 
Œade_li¡
[
i
]));

396 
´£‰Ëm’t
->
	`g‘_v®ue
(1, 
£‰Ëm’t_ÿsh_ty³
[
i
], 41);

397 
´£‰Ëm’t
->
	`g‘_v®ue
(2, 
£‰Ëm’t_ÿsh_due_d©e
[
i
]);

398 
´£‰Ëm’t
->
	`g‘_v®ue
(3, 
£‰Ëm’t_amouÁ
[
i
]);

400 if(
is_ÿsh
[
i
]){

411 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

413 
xù_id
, 
Œade_li¡
[
i
]);

414 
	`W_DO
(
_pÿsh_Œª§ùiÚ_mª
->
	`ù_šdex_´obe
(
_pssm
, 
´ÿshŒªs
,

415 
Œade_li¡
[
i
]));

416 
´ÿshŒªs
->
	`g‘_v®ue
(1, 
ÿsh_Œª§ùiÚ_dts
[
i
]);

417 
´ÿshŒªs
->
	`g‘_v®ue
(2, 
ÿsh_Œª§ùiÚ_amouÁ
[
i
]);

418 
´ÿshŒªs
->
	`g‘_v®ue
(3, 
ÿsh_Œª§ùiÚ_Çme
[
i
], 101);

432 
gu¬d
<
šdex_sÿn_™”_im¶
<
Œade_hi¡Üy_t
> > 
th_™”
;

434 
šdex_sÿn_™”_im¶
<
Œade_hi¡Üy_t
>* 
tmp_th_™”
;

435 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TU:th-™”-by-Œade-idx\n",
xù_id
);

436 
	`W_DO
(
_±¿de_hi¡Üy_mª
->
	`th_g‘_™”_by_šdex
(
_pssm
, 
tmp_th_™”
,

437 
´Œadehi¡
,

438 
low»p
, 
high»p
,

439 
Œade_li¡
[
i
]));

440 
th_™”
 = 
tmp_th_™”
;

444 
boŞ
 
eof
;

445 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TU:th-™”-Ãxˆ\n", 
xù_id
);

446 
	`W_DO
(
th_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œadehi¡
));

447 
j
=0;

448 !
eof
 && 
j
<3) {

449 
´Œadehi¡
->
	`g‘_v®ue
(1, 
Œade_hi¡Üy_dts
[
i
][
j
]);

450 
´Œadehi¡
->
	`g‘_v®ue
(2, 
Œade_hi¡Üy_¡©us_id
[
i
][
j
], 5);

451 
j
++;

452 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TU:th-™”-Ãxˆ\n", 
xù_id
);

453 
	`W_DO
(
th_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œadehi¡
));

456 
	`as£¹
(
num_upd©ed
 =ğ
num_found
 &&‚um_updated >= 0 &&

457 
num_found
 <ğ
max_Œades
);

458 } if(
±uš
.
_äame_to_execu‹
 == 3) {

459 
i
;

461 
¬¿y_gu¬d_t
<
TId’t
> 
acù_id
 = 
Ãw
 TId’t[
max_Œades
];

462 
¬¿y_gu¬d_t
< [50] > 
exec_Çme
 = 
Ãw
 [
max_Œades
][50];

463 
¬¿y_gu¬d_t
<
boŞ
> 
is_ÿsh
 = 
Ãw
 boŞ[
max_Œades
];

464 
¬¿y_gu¬d_t
<> 
´iû
 = 
Ãw
 [
max_Œades
];

465 
¬¿y_gu¬d_t
<> 
quªt™y
 = 
Ãw
 [
max_Œades
];

466 
¬¿y_gu¬d_t
< [71] > 
s_Çme
 = 
Ãw
 [
max_Œades
][71];

467 
¬¿y_gu¬d_t
<
myTime
> 
Œade_dts
 = 
Ãw
 myTime[
max_Œades
];

468 
¬¿y_gu¬d_t
<
TId’t
> 
Œade_li¡
 = 
Ãw
 TId’t[
max_Œades
];

469 
¬¿y_gu¬d_t
< [4] > 
Œade_ty³
 = 
Ãw
 [
max_Œades
][4];

470 
¬¿y_gu¬d_t
< [13] > 
ty³_Çme
 = 
Ãw
 [
max_Œades
][13];

471 
¬¿y_gu¬d_t
<> 
£‰Ëm’t_amouÁ
 = 
Ãw
 [
max_Œades
];

472 
¬¿y_gu¬d_t
<
myTime
> 
£‰Ëm’t_ÿsh_due_d©e
 = 
Ãw
 myTime[
max_Œades
];

473 
¬¿y_gu¬d_t
< [41] > 
£‰Ëm’t_ÿsh_ty³
 = 
Ãw
 [
max_Œades
][41];

474 
¬¿y_gu¬d_t
<> 
ÿsh_Œª§ùiÚ_amouÁ
 = 
Ãw
 [
max_Œades
];

475 
¬¿y_gu¬d_t
<
myTime
> 
ÿsh_Œª§ùiÚ_dts
 = 
Ãw
 myTime[
max_Œades
];

476 
¬¿y_gu¬d_t
< [101] > 
ÿsh_Œª§ùiÚ_Çme
=
Ãw
 [
max_Œades
][101];

477 
¬¿y_gu¬d_t
< 
myTime
[3] > 
Œade_hi¡Üy_dts
 = 
Ãw
 myTime[
max_Œades
][3];

478 
¬¿y_gu¬d_t
< [3][5] > 
Œade_hi¡Üy_¡©us_id
 = 
Ãw
 [
max_Œades
][3][5];

505 
gu¬d
<
šdex_sÿn_™”_im¶
<
Œade_t
> > 
t_™”
;

507 
šdex_sÿn_™”_im¶
<
Œade_t
>* 
tmp_t_™”
;

508 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TU:t-iter-by-idx3 %s %ld %ld \n",

509 
xù_id
, 
±uš
.
_symbŞ
,…tuš.
_¡¬t_Œade_dts
,

510 
±uš
.
_’d_Œade_dts
);

511 
	`W_DO
(
_±¿de_mª
->
	`t_g‘_™”_by_šdex3
(
_pssm
, 
tmp_t_™”
, 
´Œade
,

512 
low»p
, 
high»p
, 
±uš
.
_symbŞ
,

513 
±uš
.
_¡¬t_Œade_dts
,

514 
±uš
.
_’d_Œade_dts
));

515 
t_™”
 = 
tmp_t_™”
;

518 
boŞ
 
eof
;

519 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TU:t-™”-Ãxˆ\n", 
xù_id
);

520 
	`W_DO
(
t_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œade
));

521 
j
 = 0; j < 
max_Œades
 && !
eof
; j++){

522 
´Œade
->
	`g‘_v®ue
(0, 
Œade_li¡
[
j
]);

523 
´Œade
->
	`g‘_v®ue
(1, 
Œade_dts
[
j
]);

524 
´Œade
->
	`g‘_v®ue
(3, 
Œade_ty³
[
j
], 4);

525 
´Œade
->
	`g‘_v®ue
(4, 
is_ÿsh
[
j
]);

526 
´Œade
->
	`g‘_v®ue
(6, 
quªt™y
[
j
]);

527 
´Œade
->
	`g‘_v®ue
(8, 
acù_id
[
j
]);

528 
´Œade
->
	`g‘_v®ue
(9, 
exec_Çme
[
j
], 50);

529 
´Œade
->
	`g‘_v®ue
(10, 
´iû
[
j
]);

530 
t_s_symb
[16];

531 
´Œade
->
	`g‘_v®ue
(5, 
t_s_symb
, 16);

533 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TU:s-idx-probe (%s) \n",

534 
xù_id
, 
t_s_symb
);

535 
	`W_DO
(
_p£cur™y_mª
->
	`s_šdex_´obe
(
_pssm
, 
´£cur™y
, 
t_s_symb
));

536 
´£cur™y
->
	`g‘_v®ue
(3, 
s_Çme
[
j
], 71);

538 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TU:tt-idx-probe (%s) \n",

539 
xù_id
, 
Œade_ty³
[
j
]);

540 
	`W_DO
(
_±¿de_ty³_mª
->
	`‰_šdex_´obe
(
_pssm
, 
´Œad‘y³
,

541 
Œade_ty³
[
j
]));

542 
´Œad‘y³
->
	`g‘_v®ue
(1, 
ty³_Çme
[
j
], 13);

544 
num_found
++;

546 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TU:t-™”-Ãxˆ\n", 
xù_id
);

547 
	`W_DO
(
t_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œade
));

550 
i
 = 0; i < 
num_found
; i++) {

561 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TU:se-idx-probe (%ld) \n",

562 
xù_id
, 
Œade_li¡
[
i
]);

563 
	`W_DO
(
_p£‰Ëm’t_mª
->
	`£_šdex_´obe
(
_pssm
, 
´£‰Ëm’t
,

564 
Œade_li¡
[
i
]));

565 
´£‰Ëm’t
->
	`g‘_v®ue
(1, 
£‰Ëm’t_ÿsh_ty³
[
i
], 41);

566 
´£‰Ëm’t
->
	`g‘_v®ue
(2, 
£‰Ëm’t_ÿsh_due_d©e
[
i
]);

567 
´£‰Ëm’t
->
	`g‘_v®ue
(3, 
£‰Ëm’t_amouÁ
[
i
]);

569 if(
is_ÿsh
[
i
]){

570 if(
num_upd©ed
 < 
±uš
.
_max_upd©es
){

579 
	`TRACE
(
TRACE_TRX_FLOW
,

581 
xù_id
, 
Œade_li¡
[
i
]);

582 
	`W_DO
(
_pÿsh_Œª§ùiÚ_mª
->

583 
	`ù_šdex_´obe_fÜupd©e
(
_pssm
, 
´ÿshŒªs
,

584 
Œade_li¡
[
i
]));

585 
ù_Çme
[101];

586 
´ÿshŒªs
->
	`g‘_v®ue
(3, 
ù_Çme
, 101);

588 
¡ršg
 
	`‹mp_ù_Çme
(
ù_Çme
);

589 
size_t
 
šdex
 = 
‹mp_ù_Çme
.
	`fšd
(" shares of ");

590 if(
šdex
 !ğ
¡ršg
::
Åos
){

591 
¡ršg¡»am
 
ss
;

592 
ss
 << 
ty³_Çme
[
i
] << " " << 
quªt™y
[i]

593 << " Sh¬e oà" << 
s_Çme
[
i
];

594 
‹mp_ù_Çme
 = 
ss
.
	`¡r
();

596 
¡ršg¡»am
 
ss
;

597 
ss
 << 
ty³_Çme
[
i
] << " " << 
quªt™y
[i]

598 << " sh¬e oà" << 
s_Çme
[
i
];

599 
‹mp_ù_Çme
 = 
ss
.
	`¡r
();

601 
	`¡rıy
(
ù_Çme
, 
‹mp_ù_Çme
.
	`c_¡r
());

611 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TU:ct-update-ct-name (%s) \n",

612 
xù_id
, 
ù_Çme
);

613 
	`W_DO
(
_pÿsh_Œª§ùiÚ_mª
->
	`ù_upd©e_Çme
(
_pssm
, 
´ÿshŒªs
,

614 
ù_Çme
));

616 
num_upd©ed
++;

634 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

636 
xù_id
, 
Œade_li¡
[
i
]);

637 
	`W_DO
(
_pÿsh_Œª§ùiÚ_mª
->
	`ù_šdex_´obe
(
_pssm
, 
´ÿshŒªs
,

638 
Œade_li¡
[
i
]));

640 
´ÿshŒªs
->
	`g‘_v®ue
(1, 
ÿsh_Œª§ùiÚ_dts
[
i
]);

641 
´ÿshŒªs
->
	`g‘_v®ue
(2, 
ÿsh_Œª§ùiÚ_amouÁ
[
i
]);

642 
´ÿshŒªs
->
	`g‘_v®ue
(3, 
ÿsh_Œª§ùiÚ_Çme
[
i
], 101);

656 
gu¬d
<
šdex_sÿn_™”_im¶
<
Œade_hi¡Üy_t
> > 
th_™”
;

658 
šdex_sÿn_™”_im¶
<
Œade_hi¡Üy_t
>* 
tmp_th_™”
;

659 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "App: %d TU:th-iter-by-trade-idx %ld \n",

660 
xù_id
, 
Œade_li¡
[
i
]);

661 
	`W_DO
(
_±¿de_hi¡Üy_mª
->
	`th_g‘_™”_by_šdex
(
_pssm
, 
tmp_th_™”
,

662 
´Œadehi¡
,

663 
low»p
, 
high»p
,

664 
Œade_li¡
[
i
]));

665 
th_™”
 = 
tmp_th_™”
;

669 
boŞ
 
eof
;

670 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TU:th-™”-Ãxˆ\n", 
xù_id
);

671 
	`W_DO
(
th_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œadehi¡
));

672 
j
=0;

673 !
eof
 && 
j
<3) {

674 
´Œadehi¡
->
	`g‘_v®ue
(1, 
Œade_hi¡Üy_dts
[
i
][
j
]);

675 
´Œadehi¡
->
	`g‘_v®ue
(2, 
Œade_hi¡Üy_¡©us_id
[
i
][
j
], 5);

676 
j
++;

677 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Aµ: %d TU:th-™”-Ãxˆ\n", 
xù_id
);

678 
	`W_DO
(
th_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Œadehi¡
));

683 #ifdeà
PRINT_TRX_RESULTS


686 
rÿshŒªs
.
	`´št_tu¶e
();

687 
r£cur™y
.
	`´št_tu¶e
();

688 
r£‰Ëm’t
.
	`´št_tu¶e
();

689 
¹¿de
.
	`´št_tu¶e
();

690 
¹¿d‘y³
.
	`´št_tu¶e
();

691 
¹¿dehi¡
.
	`´št_tu¶e
();

694  
RCOK
;

696 
	}
}

699 
EXIT_NAMESPACE
(
û
);

	@src/workload/tpce/tpce_input.cpp

30 #ifdeà
__SUNPRO_CC


31 
	~<¡dlib.h
>

32 
	~<¡dio.h
>

33 
	~<¡ršg.h
>

35 
	~<c¡dlib
>

36 
	~<c¡dio
>

37 
	~<c¡ršg
>

41 
	~"wÜklßd/û/û_šput.h
"

43 
	~"wÜklßd/û/eg’/CE.h
"

46 
usšg
 
Çme¥aû
 
	gTPCE
;

48 
ENTER_NAMESPACE
(
û
);

52 
myTime
 
	$Eg’TimeToTimeT
(
CD©eTime
 &
cdt
)

54 
tm
 
ts
;

55 
m£c
;

56 
cdt
.
	`G‘YMDHMS
(&
ts
.
tm_y—r
, &ts.
tm_mÚ
, &ts.
tm_mday
, &ts.
tm_hour
, &ts.
tm_mš
, &ts.
tm_£c
, &
m£c
);

57 
ts
.
tm_y—r
 -= 1900;

58 
ts
.
tm_mÚ
 -= 1;

59 
ts
.
tm_isd¡
=1;

61 
time_t
 
x
 = 
	`mktime
 (&
ts
);

63  (
myTime
)
x
;

64 
	}
}

67 
myTime
 
	$Eg’TimeSmpToTimeT
(
TIMESTAMP_STRUCT
 &
tss
)

69 
tm
 
ts
;

70 
ts
.
tm_y—r
 = 
tss
.
y—r
 -1900;

71 
ts
.
tm_mÚ
 = 
tss
.
mÚth
-1;

72 
ts
.
tm_mday
 = 
tss
.
day
;

73 
ts
.
tm_hour
 =
tss
.
hour
;

74 
ts
.
tm_mš
 =
tss
. 
mšu‹
;

75 
ts
.
tm_£c
 = 
tss
.
£cÚd
;

76 
ts
.
tm_isd¡
=1;

77 
time_t
 
x
 = 
	`mktime
 (&
ts
);

79  (
myTime
)
x
;

80 
	}
}

82 
	$dayOfMÚth
(
myTime
& 
t
)

84 
tm
* 
ts
=
	`loÿÉime
((
time_t
*)&
t
);

85  
ts
->
tm_mday
;

86 
	}
}

89 
	$¿ndom_xù_ty³
(cÚ¡ 
idx
)

91 
sum
 = 0;

93 
sum
 +ğ
PROB_TPCE_MARKET_FEED
;

94 ià(
idx
 < 
sum
)

95  
XCT_TPCE_MARKET_FEED
;

97 
sum
 +ğ
PROB_TPCE_TRADE_UPDATE
;

98 ià(
idx
 < 
sum
)

99  
XCT_TPCE_TRADE_UPDATE
;

101 
sum
 +ğ
PROB_TPCE_BROKER_VOLUME
;

102 ià(
idx
 < 
sum
)

103  
XCT_TPCE_BROKER_VOLUME
;

105 
sum
 +ğ
PROB_TPCE_TRADE_LOOKUP
;

106 ià(
idx
 < 
sum
)

107  
XCT_TPCE_TRADE_LOOKUP
;

109 
sum
 +ğ
PROB_TPCE_TRADE_RESULT
;

110 ià(
idx
 < 
sum
)

111  
XCT_TPCE_TRADE_RESULT
;

113 
sum
 +ğ
PROB_TPCE_TRADE_ORDER
;

114 ià(
idx
 < 
sum
)

115  
XCT_TPCE_TRADE_ORDER
;

117 
sum
 +ğ
PROB_TPCE_CUSTOMER_POSITION
;

118 ià(
idx
 < 
sum
)

119  
XCT_TPCE_CUSTOMER_POSITION
;

121 
sum
 +ğ
PROB_TPCE_SECURITY_DETAIL
;

122 ià(
idx
 < 
sum
)

123  
XCT_TPCE_SECURITY_DETAIL
;

125 
sum
 +ğ
PROB_TPCE_MARKET_WATCH
;

126 ià(
idx
 < 
sum
)

127  
XCT_TPCE_MARKET_WATCH
;

129 
sum
 +ğ
PROB_TPCE_TRADE_STATUS
;

130 ià(
idx
 <ğ
sum
)

131  
XCT_TPCE_TRADE_STATUS
;

133 
	`´štf
("************sum %lf**********\À", 
sum
);

135 
	}
}

139 
brok”_vŞume_šput_t
 
	$ü—‹_brok”_vŞume_šput
(
sf
, 
¥ecificIdx
)

141 
brok”_vŞume_šput_t
 
abvi
;

142 
TBrok”VŞumeTxnIÅut
 
m_Brok”VŞumeTxnIÅut
;

143 
m_TxnIÅutG’”©Ü
->
	`G’”©eBrok”VŞumeIÅut
Ğ
m_Brok”VŞumeTxnIÅut
 );

144 
i
=0; i<40; i++)

145 
	`memıy
(
abvi
.
_brok”_li¡
[
i
], 
m_Brok”VŞumeTxnIÅut
.
brok”_li¡
[i], 50);

146 
	`memıy
(
abvi
.
_£ùÜ_Çme
, 
m_Brok”VŞumeTxnIÅut
.
£ùÜ_Çme
, 31);

147  (
abvi
);

148 
	}
};

150 
	gbrok”_vŞume_šput_t
::
	$´št
()

152 
	`´štf
("\nbroker_volume_input\n");

153 
	`´štf
("broker_list:\n");

154 
i
=0; i<40; i++è
	`´štf
(" %s\n", 
_brok”_li¡
[i]);

155 
	`´štf
("£ùÜ_Çme: %s\n", 
_£ùÜ_Çme
);

156 
	}
}

160 
cu¡om”_pos™iÚ_šput_t
 
	$ü—‹_cu¡om”_pos™iÚ_šput
(
sf
, 
¥ecificIdx
)

162 
cu¡om”_pos™iÚ_šput_t
 
aıi
;

163 
TCu¡om”Pos™iÚTxnIÅut
 
m_Cu¡om”Pos™iÚTxnIÅut
;

164 
m_TxnIÅutG’”©Ü
->
	`G’”©eCu¡om”Pos™iÚIÅut
Ğ
m_Cu¡om”Pos™iÚTxnIÅut
 );

166 
aıi
.
_g‘_hi¡Üy
=
m_Cu¡om”Pos™iÚTxnIÅut
.
g‘_hi¡Üy
;

167 
aıi
.
_acù_id_idx
=
m_Cu¡om”Pos™iÚTxnIÅut
.
acù_id_idx
;

168 
aıi
.
_cu¡_id
=
m_Cu¡om”Pos™iÚTxnIÅut
.
cu¡_id
;

169 
	`memıy
(
aıi
.
_x_id
, 
m_Cu¡om”Pos™iÚTxnIÅut
.
x_id
, 
cTAX_ID_Ën
+1);

171  (
aıi
);

172 
	}
};

174 
	gcu¡om”_pos™iÚ_šput_t
::
	$´št
(){

175 
	`´štf
("\nCustomer…osition input\n");

176 
	`´štf
("acù_id_idx: %ld\n", 
_acù_id_idx
);

177 
	`´štf
("cu¡_id: %ld\n", 
_cu¡_id
);

178 
	`´štf
("g‘_hi¡Üy: %d\n", 
_g‘_hi¡Üy
);

179 
	`´štf
("x_id: %s\n", 
_x_id
);

180 
	}
}

183 
Œade_Üd”_šput_t
 
	$ü—‹_Œade_Üd”_šput
(
sf
, 
¥ecificIdx
)

185 
Œade_Üd”_šput_t
 
©i
;

186 
TT¿deOrd”TxnIÅut
 
m_T¿deOrd”TxnIÅut
;

187 
boŞ
 
bExecutÜIsAccouÁOwÃr
;

188 
INT32
 
iT¿deTy³
;

189 
m_TxnIÅutG’”©Ü
->
	`G’”©eT¿deOrd”IÅut
Ğ
m_T¿deOrd”TxnIÅut
, 
iT¿deTy³
, 
bExecutÜIsAccouÁOwÃr
 );

191 
©i
.
_acù_id
=
m_T¿deOrd”TxnIÅut
.
acù_id
;

192 
©i
.
_»que¡ed_´iû
=
m_T¿deOrd”TxnIÅut
.
»que¡ed_´iû
;

193 
©i
.
_rŞl_™_back
=(
m_T¿deOrd”TxnIÅut
.
rŞl_™_back
 !=0);

194 
©i
.
_is_lifo
=(
m_T¿deOrd”TxnIÅut
.
is_lifo
!=0);

195 
©i
.
_ty³_is_m¬gš
=(
m_T¿deOrd”TxnIÅut
.
ty³_is_m¬gš
!=0);

196 
©i
.
_Œade_qty
=
m_T¿deOrd”TxnIÅut
.
Œade_qty
;

198 
	`memıy
(
©i
.
_co_Çme
, 
m_T¿deOrd”TxnIÅut
.
co_Çme
, 61);

199 
	`memıy
(
©i
.
_exec_f_Çme
, 
m_T¿deOrd”TxnIÅut
.
exec_f_Çme
, 21);

200 
	`memıy
(
©i
.
_exec_l_Çme
, 
m_T¿deOrd”TxnIÅut
.
exec_l_Çme
, 26);

201 
	`memıy
(
©i
.
_exec_x_id
, 
m_T¿deOrd”TxnIÅut
.
exec_x_id
, 21);

202 
	`memıy
(
©i
.
_issue
, 
m_T¿deOrd”TxnIÅut
.
issue
, 7);

203 
	`memıy
(
©i
.
_¡_³ndšg_id
, 
m_T¿deOrd”TxnIÅut
.
¡_³ndšg_id
, 5);

204 
	`memıy
(
©i
.
_¡_subm™‹d_id
, 
m_T¿deOrd”TxnIÅut
.
¡_subm™‹d_id
, 5);

205 
	`memıy
(
©i
.
_symbŞ
, 
m_T¿deOrd”TxnIÅut
.
symbŞ
, 16);

206 
	`memıy
(
©i
.
_Œade_ty³_id
, 
m_T¿deOrd”TxnIÅut
.
Œade_ty³_id
, 4);

208  (
©i
);

209 
	}
};

211 
	gŒade_Üd”_šput_t
::
	$´št
()

213 
	`´štf
("\ntrade order input\n");

214 
	`´štf
("acù_id: %ld\n", 
_acù_id
);

215 
	`´štf
("co_Çme: %s\n", 
_co_Çme
);

216 
	`´štf
("exec_f_Çme: %s\n", 
_exec_f_Çme
);

217 
	`´štf
("exec_l_Çme: %s\n", 
_exec_l_Çme
);

218 
	`´štf
("exec_x_id: %s\n", 
_exec_x_id
);

219 
	`´štf
("is_lifo: %d\n", 
_is_lifo
);

220 
	`´štf
("issue: %s\n", 
_issue
);

221 
	`´štf
("»que¡ed_´iû: %.2f\n", 
_»que¡ed_´iû
);

222 
	`´štf
("rŞl_™_back: %d\n", 
_rŞl_™_back
);

223 
	`´štf
("¡_³ndšg_id: %s\n", 
_¡_³ndšg_id
);

224 
	`´štf
("¡_subm™‹d_id: %s\n", 
_¡_subm™‹d_id
);

225 
	`´štf
("symbŞ: %s\n", 
_symbŞ
);

226 
	`´štf
("Œade_qty: %d\n", 
_Œade_qty
);

227 
	`´štf
("Œade_ty³_id: %s\n", 
_Œade_ty³_id
);

228 
	`´štf
("ty³_is_m¬gš: %d\n", 
_ty³_is_m¬gš
);

229 
	}
}

232 
Œade_lookup_šput_t
 
	$ü—‹_Œade_lookup_šput
(
sf
, 
¥ecificIdx
)

234 
Œade_lookup_šput_t
 
©li
;

235 
TT¿deLookupTxnIÅut
 
m_T¿deLookupTxnIÅut
;

236 
m_TxnIÅutG’”©Ü
->
	`G’”©eT¿deLookupIÅut
Ğ
m_T¿deLookupTxnIÅut
 );

238 
©li
.
_acù_id
=
m_T¿deLookupTxnIÅut
.
acù_id
;

239 
©li
.
_äame_to_execu‹
=
m_T¿deLookupTxnIÅut
.
äame_to_execu‹
;

240 
©li
.
_max_Œades
=
m_T¿deLookupTxnIÅut
.
max_Œades
;

241 
©li
.
_max_acù_id
=
m_T¿deLookupTxnIÅut
.
max_acù_id
;

242 
	`memıy
(
©li
.
_symbŞ
, 
m_T¿deLookupTxnIÅut
.
symbŞ
, 16);

243 if(
©li
.
_äame_to_execu‹
 == 1) {

244 
	`memıy
(
©li
.
_Œade_id
, 
m_T¿deLookupTxnIÅut
.
Œade_id
,‡i.
_max_Œades
*(
TId’t
));

246 
©li
.
_¡¬t_Œade_dts
 = 
	`Eg’TimeSmpToTimeT
(
m_T¿deLookupTxnIÅut
.
¡¬t_Œade_dts
);

247 
©li
.
_’d_Œade_dts
 = 
	`Eg’TimeSmpToTimeT
(
m_T¿deLookupTxnIÅut
.
’d_Œade_dts
);

249  (
©li
);

250 
	}
};

252 
	gŒade_lookup_šput_t
::
	$´št
()

254 
	`´štf
("\ntrade†ookup input\n");

255 
	`´štf
("acù_id: %ld\n", 
_acù_id
);

256 
	`´štf
("äame_to_execu‹: %d\n", 
_äame_to_execu‹
);

257 
	`´štf
("max_acù_id: %ld\n", 
_max_acù_id
);

258 
	`´štf
("max_Œades: %d\n", 
_max_Œades
);

259 
	`´štf
("¡¬t_Œade_dts: %ld (%s)\n", 
_¡¬t_Œade_dts
, 
	`ùime
((cÚ¡ 
time_t
*)&_start_trade_dts));

260 
	`´štf
("’d_Œade_dts: %ld (%s)\n", 
_’d_Œade_dts
, 
	`ùime
((cÚ¡ 
time_t
*)&_end_trade_dts));

261 
	`´štf
("symbŞ: %s\n", 
_symbŞ
);

262 
i
=0; i<
_max_Œades
; i++) {

263 
	`´štf
("Œade_id[%d]: %ld\n", 
i
, 
_Œade_id
[i]);

265 
	}
}

268 
Œade_»suÉ_šput_t
 
	$ü—‹_Œade_»suÉ_šput
(
sf
, 
¥ecificIdx
)

270 
Œade_»suÉ_šput_t
 
©ri
;

271 
TT¿deResuÉTxnIÅut
* 
šput
 = 
T¿deResuÉIÅutBufãr
->
	`g‘
();

272 if(
šput
==
NULL
) {

273 
©ri
.
_Œade_id
=-1;

274 
©ri
.
_Œade_´iû
=-1;

276 
©ri
.
_Œade_id
=
šput
->
Œade_id
;

277 
©ri
.
_Œade_´iû
=
šput
->
Œade_´iû
;

279  (
©ri
);

280 
	}
};

282 
	gŒade_»suÉ_šput_t
::
	$´št
()

284 
	`´štf
("\ntrade_result_input\n");

285 
	`´štf
("Œade_id: %ld\n", 
_Œade_id
);

286 
	`´štf
("Œade_´iû: %.2f\n", 
_Œade_´iû
);

287 
	}
}

291 
m¬k‘_w©ch_šput_t
 
	$ü—‹_m¬k‘_w©ch_šput
(
sf
, 
¥ecificIdx
)

294 
m¬k‘_w©ch_šput_t
 
amwi
;

295 
TM¬k‘W©chTxnIÅut
 
m_M¬k‘W©chTxnIÅut
;

296 
m_TxnIÅutG’”©Ü
->
	`G’”©eM¬k‘W©chIÅut
Ğ
m_M¬k‘W©chTxnIÅut
 );

298 
amwi
.
_acù_id
=
m_M¬k‘W©chTxnIÅut
.
acù_id
;

299 
amwi
.
_cu¡_id
=
m_M¬k‘W©chTxnIÅut
.
c_id
;

300 
amwi
.
_¡¬tšg_co_id
=
m_M¬k‘W©chTxnIÅut
.
¡¬tšg_co_id
;

301 
amwi
.
_’dšg_co_id
=
m_M¬k‘W©chTxnIÅut
.
’dšg_co_id
;

303 
	`memıy
(
amwi
.
_šdu¡ry_Çme
, 
m_M¬k‘W©chTxnIÅut
.
šdu¡ry_Çme
, 51);

305 
amwi
.
_¡¬t_d©e
=
	`Eg’TimeSmpToTimeT
(
m_M¬k‘W©chTxnIÅut
.
¡¬t_day
);

307  (
amwi
);

308 
	}
};

310 
	gm¬k‘_w©ch_šput_t
::
	$´št
()

312 
	`´štf
("\nmarket_watch_input\n");

313 
	`´štf
("acù_id: %ld\n", 
_acù_id
);

314 
	`´štf
("cu¡_id: %ld\n", 
_cu¡_id
);

315 
	`´štf
("¡¬tšg_co_id: %ld\n", 
_¡¬tšg_co_id
);

316 
	`´štf
("’dšg_co_id: %ld\n", 
_’dšg_co_id
);

317 
	`´štf
("šdu¡ry_Çme: %s\n", 
_šdu¡ry_Çme
);

318 
	`´štf
("¡¬t_d©e: %ld (%s)\n", 
_¡¬t_d©e
, 
	`ùime
((cÚ¡ 
time_t
*)&_start_date));

319 
	}
}

323 
£cur™y_d‘a_šput_t
 
	$ü—‹_£cur™y_d‘a_šput
(
sf
, 
¥ecificIdx
)

325 
£cur™y_d‘a_šput_t
 
asdi
;

326 
TSecur™yD‘aTxnIÅut
 
m_Secur™yD‘aTxnIÅut
;

327 
m_TxnIÅutG’”©Ü
->
	`G’”©eSecur™yD‘aIÅut
Ğ
m_Secur™yD‘aTxnIÅut
 );

328 
asdi
.
_acûss_lob_æag
=
m_Secur™yD‘aTxnIÅut
.
acûss_lob_æag
;

329 
asdi
.
_max_rows_to_»tuº
=
m_Secur™yD‘aTxnIÅut
.
max_rows_to_»tuº
;

330 
asdi
.
_¡¬t_day
=
	`Eg’TimeSmpToTimeT
(
m_Secur™yD‘aTxnIÅut
.
¡¬t_day
);

331 
	`memıy
(
asdi
.
_symbŞ
, 
m_Secur™yD‘aTxnIÅut
.
symbŞ
, 16 );

333  (
asdi
);

334 
	}
};

337 
	g£cur™y_d‘a_šput_t
::
	$´št
()

339 
	`´štf
("\nsecurity_detail_input\n");

340 
	`´štf
("acûss_lob_æag: %d\n", 
_acûss_lob_æag
);

341 
	`´štf
("symbŞ: %s\n", 
_symbŞ
);

342 
	`´štf
("¡¬t_day: %ld (%s)\n", 
_¡¬t_day
, 
	`ùime
((cÚ¡ 
time_t
*)&_start_day));

343 
	`´štf
("max_rows_to_»tuº: %d\n", 
_max_rows_to_»tuº
);

344 
	}
}

348 
Œade_¡©us_šput_t
 
	$ü—‹_Œade_¡©us_šput
(
sf
, 
¥ecificIdx
)

350 
Œade_¡©us_šput_t
 
©si
;

351 
TT¿deStusTxnIÅut
 
m_T¿deStusTxnIÅut
;

352 
m_TxnIÅutG’”©Ü
->
	`G’”©eT¿deStusIÅut
Ğ
m_T¿deStusTxnIÅut
 );

353 
©si
.
_acù_id
 = 
m_T¿deStusTxnIÅut
.
acù_id
;

354  (
©si
);

355 
	}
};

358 
	gŒade_¡©us_šput_t
::
	$´št
()

360 
	`´štf
("\ntrade_status_input\n");

361 
	`´štf
("acù_id: %ld\n",
_acù_id
);

362 
	}
}

365 
Œade_upd©e_šput_t
 
	$ü—‹_Œade_upd©e_šput
(
sf
, 
¥ecificIdx
)

367 
Œade_upd©e_šput_t
 
©ui
;

368 
TT¿deUpd©eTxnIÅut
 
m_T¿deUpd©eTxnIÅut
;

369 
m_TxnIÅutG’”©Ü
->
	`G’”©eT¿deUpd©eIÅut
Ğ
m_T¿deUpd©eTxnIÅut
 );

371 
©ui
.
_acù_id
=
m_T¿deUpd©eTxnIÅut
.
acù_id
;

372 
©ui
.
_äame_to_execu‹
=
m_T¿deUpd©eTxnIÅut
.
äame_to_execu‹
;

373 
©ui
.
_max_Œades
=
m_T¿deUpd©eTxnIÅut
.
max_Œades
;

374 
©ui
.
_max_upd©es
=
m_T¿deUpd©eTxnIÅut
.
max_upd©es
;

375 
©ui
.
_max_acù_id
=
m_T¿deUpd©eTxnIÅut
.
max_acù_id
;

377 
©ui
.
_¡¬t_Œade_dts
 = 
	`Eg’TimeSmpToTimeT
(
m_T¿deUpd©eTxnIÅut
.
¡¬t_Œade_dts
);

378 
©ui
.
_’d_Œade_dts
 = 
	`Eg’TimeSmpToTimeT
(
m_T¿deUpd©eTxnIÅut
.
’d_Œade_dts
);

381 
	`memıy
(
©ui
.
_symbŞ
, 
m_T¿deUpd©eTxnIÅut
.
symbŞ
, 16 );

382 
	`memıy
(
©ui
.
_Œade_id
, 
m_T¿deUpd©eTxnIÅut
.
Œade_id
, 
T¿deUpd©eF¿me1MaxRows
*(
TId’t
) );

384  (
©ui
);

385 
	}
};

387 
	gŒade_upd©e_šput_t
::
	$´št
()

389 
	`´štf
("\ntrade_update_input\n");

390 
	`´štf
("acù_id: %ld\n", 
_acù_id
);

391 
	`´štf
("äame_to_execu‹: %d\n", 
_äame_to_execu‹
);

392 
	`´štf
("max_Œades: %d\n",
_max_Œades
);

393 
	`´štf
("max_upd©es: %d\n", 
_max_upd©es
);

394 
	`´štf
("symbŞ: %s\n", 
_symbŞ
);

395 
	`´štf
("¡¬t_Œade_dts: %ld (%s)\n", 
_¡¬t_Œade_dts
, 
	`ùime
((cÚ¡ 
time_t
*)&_start_trade_dts));

396 
	`´štf
("’d_Œade_dts: %ld (%s)\n", 
_’d_Œade_dts
, 
	`ùime
((cÚ¡ 
time_t
*)&_end_trade_dts));

397 
i
=0; i<
T¿deUpd©eF¿me1MaxRows
; i++) {

398 
	`´štf
("Œade_id[%d]: %ld\n", 
i
, 
_Œade_id
[i]);

400 
	`´štf
("max_acù_id: %ld\n", 
_max_acù_id
);

401 
	}
}

405 
m¬k‘_ãed_šput_t
 
	$ü—‹_m¬k‘_ãed_šput
(
sf
, 
¥ecificIdx
)

407 
m¬k‘_ãed_šput_t
 
amfi
;

408 
TM¬k‘F“dTxnIÅut
* 
šput
ğ
M¬k‘F“dIÅutBufãr
->
	`g‘
();

409 if(
šput
!=
NULL
) {

410 
	`memıy
(
amfi
.
_¡©us_subm™‹d
,
šput
->
StusAndT¿deTy³
.
¡©us_subm™‹d
,5);

411 
	`memıy
(
amfi
.
_ty³_lim™_buy
,
šput
->
StusAndT¿deTy³
.
ty³_lim™_buy
,4);

412 
	`memıy
(
amfi
.
_ty³_lim™_£Î
,
šput
->
StusAndT¿deTy³
.
ty³_lim™_£Î
,4);

413 
	`memıy
(
amfi
.
_ty³_¡İ_loss
,
šput
->
StusAndT¿deTy³
.
ty³_¡İ_loss
,4);

414 
i
=0; i<
max_ãed_Ën
; i++) {

415 
amfi
.
_Œade_qty
[
i
] = 
šput
->
EÁr›s
[i].
Œade_qty
;

416 
	`memıy
(
amfi
.
_symbŞ
[
i
], 
šput
->
EÁr›s
[i].
symbŞ
, 16);

417 
amfi
.
_´iû_quÙe
[
i
] = 
šput
->
EÁr›s
[i].
´iû_quÙe
;

419 
d–‘e
 
šput
;

421  (
amfi
);

422 
	}
}

424 
	gm¬k‘_ãed_šput_t
::
	$´št
()

426 
	`´štf
("\nmarket_feed_input\n");

427 
i
=0; i<
max_ãed_Ën
; i++ ) {

428 
	`´štf
("´iû_quÙe[%d]: %.2f\n", 
i
, 
_´iû_quÙe
[i]);

430 
	`´štf
("¡©us_subm™‹d: %s\n", 
_¡©us_subm™‹d
);

431 
i
=0; i<
max_ãed_Ën
; i++ ) {

432 
	`´štf
("symbŞ[%d]: % \n", 
i
, 
_symbŞ
[i]);

434 
i
=0; i<
max_ãed_Ën
; i++ ) {

435 
	`´štf
("Œade_qty[%d]: %d \n", 
i
, 
_Œade_qty
[i]);

437 
	`´štf
("ty³_lim™_buy: %s\n", 
_ty³_lim™_buy
);

438 
	`´štf
("ty³_lim™_£Î: %s\n", 
_ty³_lim™_£Î
);

439 
	`´štf
("ty³_¡İ_loss: %s\n", 
_ty³_¡İ_loss
);

440 
	}
}

444 
d©a_maš‹Çnû_šput_t
 
	$ü—‹_d©a_maš‹Çnû_šput
(
sf
, 
¥ecificIdx
)

446 
d©a_maš‹Çnû_šput_t
 
admi
;

447 
TD©aMaš‹ÇnûTxnIÅut
* 
m_TxnIÅut
 = 
m_CDM
->
	`ü—‹DMIÅut
();

449 
admi
.
_acù_id
=
m_TxnIÅut
->
acù_id
;

450 
admi
.
_c_id
=
m_TxnIÅut
->
c_id
;

451 
admi
.
_co_id
=
m_TxnIÅut
->
co_id
;

452 
admi
.
_day_of_mÚth
=
m_TxnIÅut
->
day_of_mÚth
;

453 
admi
.
_vŞ_šü
=
m_TxnIÅut
->
vŞ_šü
;

454 
	`memıy
(
admi
.
_symbŞ
, 
m_TxnIÅut
->
symbŞ
, 16 );

455 
	`memıy
(
admi
.
_bË_Çme
, 
m_TxnIÅut
->
bË_Çme
, 31 );

456 
	`memıy
(
admi
.
_tx_id
, 
m_TxnIÅut
->
tx_id
, 21 );

457 
d–‘e
 
m_TxnIÅut
;

458  (
admi
);

459 
	}
};

461 
	gd©a_maš‹Çnû_šput_t
::
	$´št
()

463 
	`´štf
("\ndata_maintenance_input\n");

464 
	`´štf
("acù_id: %ld\n", 
_acù_id
);

465 
	`´štf
("c_id: %ld\n", 
_c_id
);

466 
	`´štf
("co_id: %ld\n", 
_co_id
);

467 
	`´štf
("day_of_mÚth: %d \n", 
_day_of_mÚth
);

468 
	`´štf
("symbŞ: %s\n", 
_symbŞ
);

469 
	`´štf
("bË_Çme: %s\n", 
_bË_Çme
);

470 
	`´štf
("tx_id: %s\n", 
_tx_id
);

471 
	`´štf
("vŞ_šü %d\n", 
_vŞ_šü
);

472 
	}
}

476 
Œade_ş—nup_šput_t
 
	$ü—‹_Œade_ş—nup_šput
(
sf
, 
¥ecificIdx
)

478 
Œade_ş—nup_šput_t
 
©ci
;

479 
TT¿deCËªupTxnIÅut
* 
m_CËªupTxnIÅut
 = 
m_CDM
->
	`ü—‹TCIÅut
();

481 
©ci
.
_Œade_id
=
m_CËªupTxnIÅut
->
¡¬t_Œade_id
;

482 
	`memıy
(
©ci
.
_¡_ÿnûËd_id
, 
m_CËªupTxnIÅut
->
¡_ÿnûËd_id
, 5 );

483 
	`memıy
(
©ci
.
_¡_³ndšg_id
, 
m_CËªupTxnIÅut
->
¡_³ndšg_id
, 5 );

484 
	`memıy
(
©ci
.
_¡_subm™‹d_id
, 
m_CËªupTxnIÅut
->
¡_subm™‹d_id
, 5 );

485 
d–‘e
 
m_CËªupTxnIÅut
;

486  (
©ci
);

487 
	}
}

489 
	gŒade_ş—nup_šput_t
::
	$´št
()

491 
	`´štf
("\ntrade_cleanup_input\n");

492 
	`´štf
("Œade_id: %ld \n", 
_Œade_id
);

493 
	`´štf
("¡_ÿnûËd_id: %s\n", 
_¡_ÿnûËd_id
);

494 
	`´štf
("¡_³ndšg_id: %s\n", 
_¡_³ndšg_id
);

495 
	`´štf
("¡_subm™‹d_id: %s\n", 
_¡_subm™‹d_id
);

496 
	}
}

498 
EXIT_NAMESPACE
(
û
);

	@src/workload/tpch/dbgen/bcd2.cpp

35 
	~<¡dio.h
>

36 
	~"wÜklßd/ch/dbg’/bcd2.h
"

39 
ENTER_NAMESPACE
(
dbg’ch
);

42 
	#DIGITS_PER_LONG
 7

	)

43 
	#WORD_DIVISOR
 10000000

	)

44 
	#GET_DIGIT
(
num
, 
low
, 
high
) \

45 ((
num
è>ğ
DIGITS_PER_LONG
)? \

46 (
high
 & (0xF << (4 * ((
num
è- 
DIGITS_PER_LONG
)))) \

47 >> (((
num
è- 
DIGITS_PER_LONG
) * 4): \

48 (
low
 & (0xF << (4 * (
num
)))è>> (Òumè* 4)

	)

49 
	#SET_DIGIT
(
v®ue
, 
num
, 
low
, 
high
) \

50 ià((
num
è>ğ
DIGITS_PER_LONG
) \

52 *
high
 &= \

53 (0xFFFFFFF ^ (0xF << (4 * ((
num
è- 
DIGITS_PER_LONG
)))); \

54 *
high
 |ğ(
v®ue
 << (4 * ((
num
è- 
DIGITS_PER_LONG
))); \

58 *
low
 = (*low & (0xFFFFFFF ^ (0xF << (4 * (
num
))))); \

59 *
low
 |ğ(
v®ue
 << (4 * (
num
))); \

60 }

	)

62 
	$bš_bcd2
(
bš¬y
, *
low_»s
, *
high_»s
)

64 
numb”
[15],

65 *
cu¼’t
;

66 
couÁ
;

67 *
de¡
;

69 *
low_»s
 = *
high_»s
 = 0;

70 
	`¥rštf
(
numb”
, "%014ld", 
bš¬y
);

71 
cu¼’t
 = 
numb”
, 
couÁ
=13; *current; current++, count--)

73 
de¡
 = (
couÁ
 < 
DIGITS_PER_LONG
)?
low_»s
:
high_»s
;

74 *
de¡
 = *dest << 4;

75 *
de¡
 |ğ*
cu¼’t
 - '0';

78 
	}
}

81 
	$bcd2_bš
(*
de¡
, 
bcd
)

83 
couÁ
;

84 
mask
;

86 
couÁ
 = 
DIGITS_PER_LONG
 - 1;

87 
mask
 = 0xF000000;

88 *
de¡
 = 0;

89 
mask
)

91 *
de¡
 *= 10;

92 *
de¡
 +ğ(
bcd
 & 
mask
è>> (4 * 
couÁ
);

93 
mask
 = mask >> 4;

94 
couÁ
 -= 1;

97 
	}
}

100 
	$bcd2_add
(*
bcd_low
, *
bcd_high
, 
add’d
)

102 
tmp_lo
, 
tmp_hi
, 
ÿ¼y
, 
»s
;

103 
dig™
;

105 
	`bš_bcd2
(
add’d
, &
tmp_lo
, &
tmp_hi
);

106 
ÿ¼y
 = 0;

107 
dig™
=0; digit < 14; digit++)

109 
»s
 = 
	`GET_DIGIT
(
dig™
, *
bcd_low
, *
bcd_high
);

110 
»s
 +ğ
	`GET_DIGIT
(
dig™
, 
tmp_lo
, 
tmp_hi
);

111 
»s
 +ğ
ÿ¼y
;

112 
ÿ¼y
 = 
»s
 / 10;

113 
»s
 %= 10;

114 
	`SET_DIGIT
(
»s
, 
dig™
, 
bcd_low
, 
bcd_high
);

116 (
ÿ¼y
);

117 
	}
}

120 
	$bcd2_sub
(*
bcd_low
, *
bcd_high
, 
sub’d
)

122 
tmp_lo
, 
tmp_hi
, 
ÿ¼y
, 
»s
;

123 
dig™
;

125 
	`bš_bcd2
(
sub’d
, &
tmp_lo
, &
tmp_hi
);

126 
ÿ¼y
 = 0;

127 
dig™
=0; digit < 14; digit++)

129 
»s
 = 
	`GET_DIGIT
(
dig™
, *
bcd_low
, *
bcd_high
);

130 
»s
 -ğ
	`GET_DIGIT
(
dig™
, 
tmp_lo
, 
tmp_hi
);

131 
»s
 -ğ
ÿ¼y
;

132 ià(
»s
 < 0)

134 
»s
 += 10;

135 
ÿ¼y
 = 1;

137 
	`SET_DIGIT
(
»s
, 
dig™
, 
bcd_low
, 
bcd_high
);

139 (
ÿ¼y
);

140 
	}
}

143 
	$bcd2_mul
(*
bcd_low
, *
bcd_high
, 
muÉl›r
)

145 
tmp_lo
, 
tmp_hi
, 
ÿ¼y
, 
m_lo
, 
m_hi
, 
m1
, 
m2
;

146 
udig™
, 
ldig™
, 
»s
;

148 
tmp_lo
 = *
bcd_low
;

149 
tmp_hi
 = *
bcd_high
;

150 
	`bš_bcd2
(
muÉl›r
, &
m_lo
, &
m_hi
);

151 *
bcd_low
 = 0;

152 *
bcd_high
 = 0;

153 
ÿ¼y
 = 0;

154 
ldig™
=0;†digit < 14;†digit++)

156 
m1
 = 
	`GET_DIGIT
(
ldig™
, 
m_lo
, 
m_hi
);

157 
ÿ¼y
 = 0;

158 
udig™
=0; udigit < 14; udigit++)

160 
m2
 = 
	`GET_DIGIT
(
udig™
, 
tmp_lo
, 
tmp_hi
);

161 
»s
 = 
m1
 * 
m2
;

162 
»s
 +ğ
ÿ¼y
;

163 ià(
udig™
 + 
ldig™
 < 14)

165 
ÿ¼y
 = 
	`GET_DIGIT
(
udig™
 + 
ldig™
, *
bcd_low
, *
bcd_high
);

166 
»s
 +ğ
ÿ¼y
;

168 
ÿ¼y
 = 
»s
 / 10;

169 
»s
 %= 10;

170 ià(
udig™
 + 
ldig™
 < 14) {

171 
	`SET_DIGIT
(
»s
, 
udig™
 + 
ldig™
, 
bcd_low
, 
bcd_high
);

175 (
ÿ¼y
);

176 
	}
}

179 
	$bcd2_div
(*
bcd_low
, *
bcd_high
, 
divisÜ
)

181 
tmp_lo
, 
tmp_hi
, 
ÿ¼y
, 
d1
, 
»s
, 
dig™
;

184 
ÿ¼y
 = 0;

185 
tmp_lo
 = *
bcd_low
;

186 
tmp_hi
 = *
bcd_high
;

187 *
bcd_low
 = *
bcd_high
 = 0;

188 
dig™
=13; digit >= 0; digit--)

190 
d1
 = 
	`GET_DIGIT
(
dig™
, 
tmp_lo
, 
tmp_hi
);

191 
d1
 +ğ10 * 
ÿ¼y
;

192 
»s
 = 
d1
 / 
divisÜ
;

193 
ÿ¼y
 = 
d1
 % 
divisÜ
;

194 
	`SET_DIGIT
(
»s
, 
dig™
, 
bcd_low
, 
bcd_high
);

196 (
ÿ¼y
);

197 
	}
}

200 
	$bcd2_mod
(*
bcd_low
, *
bcd_high
, 
modulo
)

202 
tmp_low
, 
tmp_high
;

204 
tmp_low
 = *
bcd_low
;

205 
tmp_high
 = *
bcd_high
;

206 
tmp_high
 || 
tmp_low
 > 
modulo
)

207 
	`bcd2_sub
(&
tmp_low
, &
tmp_high
, 
modulo
);

208 (
tmp_low
);

209 
	}
}

212 
	$bcd2_cmp
(*
low1
, *
high1
, 
comp
)

214 
‹mp
 = 0;

216 
	`bcd2_bš
(&
‹mp
, *
high1
);

217 ià(
‹mp
 > 214)

219 
	`bcd2_bš
(&
‹mp
, *
low1
);

220 (
‹mp
 - 
comp
);

221 
	}
}

224 
EXIT_NAMESPACE
(
dbg’ch
);

227 #ifdeà
TEST_BCD


228 
	~<v®ues.h
>

230 
	$maš
()

232 
bš
, 
low_bcd
, 
high_bcd
;

233 
i
;

235 
bš
 = 
MAXINT
;

236 
	`´štf
("%ld\n", 
bš
);

237 
	`bš_bcd2
(
bš
, &
low_bcd
, &
high_bcd
);

238 
	`´štf
("%ld %ld\n", 
high_bcd
, 
low_bcd
);

239 
bš
 = 0;

240 
	`bcd2_bš
(&
bš
, 
high_bcd
);

241 
	`bcd2_bš
(&
bš
, 
low_bcd
);

242 
	`´štf
Ğ"%ld\n", 
bš
);

243 
i
=9; i >= 0; i--)

244 
	`´štf
("%dth digit in %d is %d\n",

245 
i
, 
bš
, 
	`GET_DIGIT
(i, 
low_bcd
, 
high_bcd
));

246 
	`bcd2_add
(&
low_bcd
, &
high_bcd
, 
MAXINT
);

247 
bš
 = 0;

248 
	`bcd2_bš
(&
bš
, 
high_bcd
);

249 
high_bcd
 = 
bš
;

250 
bš
 = 0;

251 
	`bcd2_bš
(&
bš
, 
low_bcd
);

252 
low_bcd
 = 
bš
;

253 
	`´štf
Ğ"%ld%07ld\n", 
high_bcd
, 
low_bcd
);

254 
	`bš_bcd2
(14, &
low_bcd
, &
high_bcd
);

255 
	`bcd2_mul
(&
low_bcd
, &
high_bcd
, 23L);

256 
bš
 = 0;

257 
	`bcd2_bš
(&
bš
, 
high_bcd
);

258 
	`bcd2_bš
(&
bš
, 
low_bcd
);

259 
	`´štf
Ğ"%ld\n", 
bš
);

260 
	`bcd2_div
(&
low_bcd
, &
high_bcd
, 10L);

261 
bš
 = 0;

262 
	`bcd2_bš
(&
bš
, 
high_bcd
);

263 
	`bcd2_bš
(&
bš
, 
low_bcd
);

264 
	`´štf
Ğ"%ld\n", 
bš
);

265 
	}
}

	@src/workload/tpch/dbgen/bm_utils.cpp

60 
	~"wÜklßd/ch/dbg’/cÚfig.h
"

61 
	~"wÜklßd/ch/dbg’/dss.h
"

63 
	~<¡dio.h
>

65 
	~<time.h
>

66 
	~<”ºo.h
>

67 
	~<¡ršg.h
>

68 #ifdeà
HP


69 
	~<¡ršgs.h
>

71 
	~<ùy³.h
>

72 
	~<m©h.h
>

73 #iâdeà
_POSIX_SOURCE


74 
	~<m®loc.h
>

76 
	~<fú.h
>

77 
	~<sys/ty³s.h
>

78 
	~<sys/¡©.h
>

79 
	~"wÜklßd/ch/dbg’/ds¡y³s.h
"

83 
ENTER_NAMESPACE
(
dbg’ch
);

86 
	g®pha_num
[65] =

89 #ià
defšed
(
__STDC__
è|| defšed(
__ılu¥lus
)

90 
	#PROTO
(
s
è
	)
s

92 
	#PROTO
(
s
è()

	)

95 *
g‘’v
 
PROTO
((cÚ¡ *
Çme
));

96 
u§ge
();

97 *
³rmu‹_di¡
(
di¡ributiÚ
 *
d
, 
¡»am
, 
DSS_HUGE
& 
sourû
, di¡ributiÚ* 
cd
);

98 
£ed_t
 
S“d
[];

104 cÚ¡ * 
	$’v_cÚfig
(cÚ¡ * , cÚ¡ *
dæt
)

106  (
dæt
);

107 
	}
}

113 
	$yes_no
(*
´om±
)

115 
»¶y
[128];

117 #ifdeà
WIN32


119 #´agm¨
	`w¬nšg
(
di§bË
:4127)

124 #ifdeà
WIN32


125 #´agm¨
	`w¬nšg
(:4127)

127 
	`´štf
("% [Y/N]: ", 
´om±
);

128 
	`fg‘s
(
»¶y
, 128, 
¡dš
);

129 *
»¶y
)

138 
	`´štf
("Please‡nswer 'yes' or 'no'.\n");

141 
	}
}

149 
	$a_ºd
(
mš
, 
max
, 
cŞumn
, *
de¡
)

151 
DSS_HUGE
 
i
,

152 
Ën
,

153 
ch¬_št
;

155 
	`RANDOM
(
Ën
, 
mš
, 
max
, 
cŞumn
);

156 
i
 = 0; i < 
Ën
; i++)

158 ià(
i
 % 5 == 0)

159 
	`RANDOM
(
ch¬_št
, 0, 
MAX_LONG
, 
cŞumn
);

160 *(
de¡
 + 
i
èğ
®pha_num
[
ch¬_št
 & 077];

161 
ch¬_št
 >>= 6;

163 *(
de¡
 + 
Ën
) = '\0';

165 
	}
}

173 
	$e_¡r
(
di¡ributiÚ
 *
d
, 
mš
, 
max
, 
¡»am
, *
de¡
)

175 
¡¹mp
[
MAXAGG_LEN
 + 1];

176 
DSS_HUGE
 
loc
;

177 
Ën
;

179 
	`a_ºd
(
mš
, 
max
, 
¡»am
, 
de¡
);

180 
	`pick_¡r
(
d
, 
¡»am
, 
¡¹mp
);

181 
Ën
 = 
	`¡¾’
(
¡¹mp
);

182 
	`RANDOM
(
loc
, 0, (
	`¡¾’
(
de¡
è- 1 - 
Ën
), 
¡»am
);

183 
	`¡ºıy
(
de¡
 + 
loc
, 
¡¹mp
, 
Ën
);

186 
	}
}

195 
	$pick_¡r
(
di¡ributiÚ
 *
s
, 
c
, *
rg‘
)

197 
i
 = 0;

198 
DSS_HUGE
 
j
;

200 
	`RANDOM
(
j
, 1, 
s
->
li¡
[s->
couÁ
 - 1].
weight
, 
c
);

201 
s
->
li¡
[
i
].
weight
 < 
j
) {

202 
i
++;

204 
	`¡rıy
(
rg‘
, 
s
->
li¡
[
i
].
‹xt
);

205 (
i
);

206 
	}
}

212 
	$unjulŸn
(
d©e
)

214 
i
;

215 
»s
 = 0;

217 
i
 = 
STARTDATE
 / 1000; i < 
d©e
 / 1000; i++)

218 
»s
 +ğ365 + 
	`LEAP
(
i
);

219 
»s
 +ğ
d©e
 % 1000 - 1;

221 (
»s
);

222 
	}
}

225 
	$julŸn
(
d©e
)

227 
off£t
;

228 
»suÉ
;

229 
yr
;

230 
y’d
;

232 
off£t
 = 
d©e
 - 
STARTDATE
;

233 
»suÉ
 = 
STARTDATE
;

235 #ifdeà
WIN32


237 #´agm¨
	`w¬nšg
(
di§bË
:4127)

242 #ifdeà
WIN32


243 #´agm¨
	`w¬nšg
(:4127)

245 
yr
 = 
»suÉ
 / 1000;

246 
y’d
 = 
yr
 * 1000 + 365 + 
	`LEAP
(yr);

247 ià(
»suÉ
 + 
off£t
 > 
y’d
)

249 
off£t
 -ğ
y’d
 - 
»suÉ
 + 1;

250 
»suÉ
 += 1000;

256  (
»suÉ
 + 
off£t
);

257 
	}
}

264 
	$»ad_di¡
(cÚ¡ *
·th
, cÚ¡ *
Çme
, 
di¡ributiÚ
 *
rg‘
)

266 
FILE
 *
å
;

267 
lše
[256];

268 
tok’
[256];

269 *
c
;

271 
weight
;

272 
couÁ
 = 0;

273 
Çme_£t
 = 0;

275 ià(
d_·th
 =ğ
NULL
)

277 
	`¥rštf
(
lše
, "%s%c%s",

278 
	`’v_cÚfig
(
CONFIG_TAG
, 
CONFIG_DFLT
), 
PATH_SEP
, 
·th
);

279 
å
 = 
	`fİ’
(
lše
, "r");

280 
	`OPEN_CHECK
(
å
, 
lše
);

284 
å
 = 
	`fİ’
(
d_·th
, "r");

285 
	`OPEN_CHECK
(
å
, 
d_·th
);

287 
	`fg‘s
(
lše
, Öše), 
å
è!ğ
NULL
)

289 ià((
c
 = 
	`¡rchr
(
lše
, '\n')è!ğ
NULL
)

290 *
c
 = '\0';

291 ià((
c
 = 
	`¡rchr
(
lše
, '#')è!ğ
NULL
)

292 *
c
 = '\0';

293 ià(*
lše
 == '\0')

296 ià(!
Çme_£t
)

298 ià(
	`dssÿ£cmp
(
	`¡¹ok
(
lše
, "\n\t "), "BEGIN"))

300 ià(
	`dssÿ£cmp
(
	`¡¹ok
(
NULL
, "\n\ˆ"), 
Çme
))

302 
Çme_£t
 = 1;

307 ià(!
	`ds¢ÿ£cmp
(
lše
, "END", 3))

309 
	`fşo£
(
å
);

314 ià(
	`ssÿnf
(
lše
, "%[^|]|%ld", 
tok’
, &
weight
) != 2)

317 ià(!
	`dssÿ£cmp
(
tok’
, "count"))

319 
rg‘
->
couÁ
 = 
weight
;

320 
rg‘
->
li¡
 =

321 (
£t_memb”
 *)

322 
	`m®loc
((
size_t
)(
weight
 * (
£t_memb”
)));

323 
	`MALLOC_CHECK
(
rg‘
->
li¡
);

324 
rg‘
->
max
 = 0;

327 
rg‘
->
li¡
[
couÁ
].
‹xt
 =

328 (*è
	`m®loc
((
size_t
)(
	`¡¾’
(
tok’
) + 1));

329 
	`MALLOC_CHECK
(
rg‘
->
li¡
[
couÁ
].
‹xt
);

330 
	`¡rıy
(
rg‘
->
li¡
[
couÁ
].
‹xt
, 
tok’
);

331 
rg‘
->
max
 +ğ
weight
;

332 
rg‘
->
li¡
[
couÁ
].
weight
 =¬g‘->
max
;

334 
couÁ
 += 1;

337 ià(
couÁ
 !ğ
rg‘
->count) {

338 
	`årštf
(
¡d”r
, "R—dƒ¼Ü oÀdi¡ '%s'\n", 
Çme
);

339 
	`fşo£
(
å
);

340 
	`as£¹
(0);

343 
rg‘
->
³rmu‹
 = (*)
NULL
;

344 
	`fşo£
(
å
);

346 
	}
}

352 
FILE
 *

353 
	$tbl_İ’
(
tbl
, cÚ¡ *
mode
)

355 
´om±
[256];

356 
fuÎ·th
[256];

357 
FILE
 *
f
;

358 
¡©
 
f¡©s
;

359 
»tcode
;

362 ià(*
tdefs
[
tbl
].
Çme
 =ğ
PATH_SEP
)

363 
	`¡rıy
(
fuÎ·th
, 
tdefs
[
tbl
].
Çme
);

365 
	`¥rštf
(
fuÎ·th
, "%s%c%s",

366 
	`’v_cÚfig
(
PATH_TAG
, 
PATH_DFLT
), 
PATH_SEP
, 
tdefs
[
tbl
].
Çme
);

368 
»tcode
 = 
	`¡©
(
fuÎ·th
, &
f¡©s
);

369 ià(
»tcode
 && (
”ºo
 !ğ
ENOENT
))

371 
	`årštf
(
¡d”r
, "¡©(%sèçed.\n", 
fuÎ·th
);

372 
	`ex™
(-1);

374 ià(
	`S_ISREG
(
f¡©s
.
¡_mode
è&& !
fÜû
 && *
mode
 != 'r' )

376 
	`¥rštf
(
´om±
, "DØyou wªˆtØov”wr™% ?", 
fuÎ·th
);

377 ià(!
	`yes_no
(
´om±
))

378 
	`ex™
(0);

381 ià(
	`S_ISFIFO
(
f¡©s
.
¡_mode
))

383 
»tcode
 =

384 
	`İ’
(
fuÎ·th
, ((*
mode
 =ğ'r')?
O_RDONLY
:
O_WRONLY
)|
O_CREAT
);

385 
f
 = 
	`fdİ’
(
»tcode
, 
mode
);

388 
f
 = 
	`fİ’
(
fuÎ·th
, 
mode
);

390 
	`OPEN_CHECK
(
f
, 
fuÎ·th
);

391 ià(
h—d”
 && 
cŞumÇr
 && 
tdefs
[
tbl
].h—d” !ğ
NULL
)

392 
tdefs
[
tbl
].
	`h—d”
(
f
);

394  (
f
);

395 
	}
}

403 
	$agg_¡r
(
di¡ributiÚ
 *
£t
, 
couÁ
, 
cŞ
, *
de¡
)

405 
di¡ributiÚ
 *
d
;

406 
i
;

408 
d
 = 
£t
;

409 *
de¡
 = '\0';

411 
DSS_HUGE
 
sourû
 = 0;

413 
i
=0; i < 
couÁ
; i++) {

414 
	`¡rÿt
(
de¡
, 
	`DIST_MEMBER
(
£t
,*
	`³rmu‹_di¡
(
d
, 
cŞ
, 
sourû
, set)));

415 
	`¡rÿt
(
de¡
, " ");

416 
d
 = (
di¡ributiÚ
 *)
NULL
;

419 *(
de¡
 + 
	`¡¾’
(dest) - 1) = '\0';

422 
	}
}

426 
	$ds¢ÿ£cmp
(cÚ¡ *
s1
, cÚ¡ *
s2
, 
n
)

428 ; 
n
 > 0; ++
s1
, ++
s2
, --n) {

429 ià(
	`tŞow”
(*
s1
è!ğtŞow”(*
s2
)) {

430  ((
	`tŞow”
(*
s1
è<Şow”(*
s2
)) ? -1 : 1);

432 ià(*
s1
 == '\0') {

437 
	}
}

440 
	$dssÿ£cmp
(cÚ¡ *
s1
, cÚ¡ *
s2
)

442 ; 
	`tŞow”
(*
s1
è=ğtŞow”(*
s2
); ++s1, ++s2) {

443 ià(*
s1
 == '\0') {

447  ((
	`tŞow”
(*
s1
è<Şow”(*
s2
)) ? -1 : 1);

448 
	}
}

451 #iâdeà
STDLIB_HAS_GETOPT


452 
	gİtšd
 = 0;

453 
	gİ‹¼
 = 0;

454 *
	gİrg
 = 
NULL
;

457 
	$g‘İt
(
ac
, **
av
, *
İt
)

459 *
Ãxtch¬
 = 
NULL
;

460 *
ı
;

461 
hŞd
;

463 ià(
İrg
 =ğ
NULL
)

465 
İrg
 = (*)
	`m®loc
(
BUFSIZ
);

466 
	`MALLOC_CHECK
(
İrg
);

469 ià(!
Ãxtch¬
 || *nextchar == '\0')

471 
İtšd
++;

472 ià(
İtšd
 =ğ
ac
)

474 
Ãxtch¬
 = 
av
[
İtšd
];

475 ià(*
Ãxtch¬
 != '-')

477 
Ãxtch¬
 +=1;

480 ià(
Ãxtch¬
 && *nextchar == '-')

482 
İtšd
++;

487 
ı
 = 
	`¡rchr
(
İt
, *
Ãxtch¬
);

488 
Ãxtch¬
 += 1;

489 ià(
ı
 =ğ
NULL
)

491 ià(*(
ı
 + 1) == ':')

493 ià(*
Ãxtch¬
)

495 
hŞd
 = *
ı
;

496 
ı
 = 
İrg
;

497 *
Ãxtch¬
)

498 *
ı
++ = *
Ãxtch¬
++;

499 *
ı
 = '\0';

500 *
ı
 = 
hŞd
;

504 ià(++
İtšd
 =ğ
ac
)

506 
	`¡rıy
(
İrg
, 
av
[
İtšd
]);

508 
Ãxtch¬
 = 
NULL
;

510 (*
ı
);

512 
	}
}

516 
	$mk_ascd©e
()

518 **
m
;

519 
dss_time_t
 
t
;

520 
DSS_HUGE
 
i
;

522 
m
 = (**è
	`m®loc
((
size_t
)(
TOTDATE
 *  (*)));

523 
	`MALLOC_CHECK
(
m
);

524 
i
 = 0; i < 
TOTDATE
; i++)

526 
	`mk_time
(
i
 + 1, &
t
);

527 
m
[
i
] = 
	`¡rdup
(
t
.
®pha
);

530 (
m
);

531 
	}
}

540 
DSS_HUGE


541 
	$£t_¡©e
(
bË
, 
sf
, 
´ocs
, 
¡•
, 
DSS_HUGE
 *
exŒa_rows
)

543 
i
;

544 
DSS_HUGE
 
rowcouÁ
, 
»mašd”
, 
»suÉ
;

546 ià(
sf
 =ğ0 || 
¡•
 == 0)

549 
rowcouÁ
 = 
tdefs
[
bË
].
ba£
 / 
´ocs
;

550 ià((
sf
 / 
´ocs
è> ()
MAX_32B_SCALE
) {

551 
	`INTERNAL_ERROR
("SCALE OVERFLOW. RE-RUN WITH MORE CHILDREN.");

553 
rowcouÁ
 *ğ
sf
;

554 
»mašd”
 = (
tdefs
[
bË
].
ba£
 % 
´ocs
è* 
sf
;

555 
rowcouÁ
 +ğ
»mašd”
 / 
´ocs
;

556 
»suÉ
 = 
rowcouÁ
;

557 
i
=0; i < 
¡•
 - 1; i++)

559 ià(
bË
 =ğ
LINE
)

560 
tdefs
[
bË
].
	`g’_£ed
(1, 
rowcouÁ
);

562 
tdefs
[
bË
].
	`g’_£ed
(0, 
rowcouÁ
);

565 ià(
tdefs
[
bË
].
chd
 !ğ
NONE
)

566 
tdefs
[tdefs[
bË
].
chd
].
	`g’_£ed
(0,
rowcouÁ
);

568 *
exŒa_rows
 = 
»mašd”
 % 
´ocs
;

569 ià(
¡•
 > 
´ocs
)

570 
tdefs
[
bË
].
	`g’_£ed
(0, *
exŒa_rows
);

572 (
»suÉ
);

573 
	}
}

576 
EXIT_NAMESPACE
(
dbg’ch
);

	@src/workload/tpch/dbgen/build.cpp

43 
	~<¡dio.h
>

44 
	~<¡ršg.h
>

45 #iâdeà
VMS


46 
	~<sys/ty³s.h
>

48 #ià
defšed
(
SUN
)

49 
	~<uni¡d.h
>

51 
	~<m©h.h
>

53 
	~"wÜklßd/ch/dbg’/dss.h
"

54 
	~"wÜklßd/ch/dbg’/ds¡y³s.h
"

55 
	~"wÜklßd/ch/dbg’/ºg64.h
"

58 
ENTER_NAMESPACE
(
dbg’ch
);

60 
	gÊoi£
[4] = {'|', '/', '-', '\\' };

63 
	#LEAP_ADJ
(
yr
, 
mÁh
) \

64 ((
	`LEAP
(
yr
è&& (
mÁh
è>ğ2è? 1 : 0)

	)

65 
	#JDAY_BASE
 8035

	)

66 
	#JMNTH_BASE
 (-70 * 12è

	)

67 
	#JDAY
(
d©e
è((d©eè- 
STARTDATE
 + 
JDAY_BASE
 + 1)

	)

68 
	#PART_SUPP_BRIDGE
(
tgt
, 
p
, 
s
) \

70 
DSS_HUGE
 
tÙ_sút
 = 
tdefs
[
SUPP
].
ba£
 * 
sÿË
; \

71 
tgt
 = (
p
 + 
s
 * (
tÙ_sút
 / 
SUPP_PER_PART
 + \

72 (è((
p
 - 1è/ 
tÙ_sút
))) %ot_scnt + 1; \

73 }

	)

74 
	#V_STR
(
avg
, 
sd
, 
tgt
è
	`a_ºd
(()×vg * 
V_STR_LOW
),()×vg * 
V_STR_HGH
), sd,gt)

	)

75 
	#TEXT
(
avg
, 
sd
, 
tgt
è
	`dbg_‹xt
Ñgt, ()×vg * 
V_STR_LOW
),()×vg * 
V_STR_HGH
), sd)

	)

76 
g’_phÚe
 
PROTO
((
DSS_HUGE
 
šd
, *
rg‘
, 
£ed
));

78 
DSS_HUGE


79 
	$½b_routše
(
DSS_HUGE
 
p
)

81 
DSS_HUGE
 
´iû
;

83 
´iû
 = 90000;

84 
´iû
 +ğ(
p
/10) % 20001;

85 
´iû
 +ğ(
p
 % 1000) * 100;

87 (
´iû
);

88 
	}
}

91 
	$g’_phÚe
(
DSS_HUGE
 
šd
, *
rg‘
, 
£ed
)

93 
DSS_HUGE
 
acode
,

94 
exchg
,

95 
numb”
;

97 
	`RANDOM
(
acode
, 100, 999, 
£ed
);

98 
	`RANDOM
(
exchg
, 100, 999, 
£ed
);

99 
	`RANDOM
(
numb”
, 1000, 9999, 
£ed
);

101 
	`¥rštf
(
rg‘
, "%02d", ()(10 + (
šd
 % 
NATIONS_MAX
)));

102 
	`¥rštf
(
rg‘
 + 3, "%03d", ()
acode
);

103 
	`¥rštf
(
rg‘
 + 7, "%03d", ()
exchg
);

104 
	`¥rštf
(
rg‘
 + 11, "%04d", ()
numb”
);

105 
rg‘
[2] =arget[6] =arget[10] = '-';

108 
	}
}

113 
	$mk_cu¡
(
DSS_HUGE
 
n_cu¡
, 
cu¡om”_t
 *
c
)

115 
DSS_HUGE
 
i
;

116 
bIn™
 = 0;

117 
szFÜm©
[100];

119 !
bIn™
) {

120 
	`TRACE
Ğ
TRACE_ALWAYS
, "Init mk_cust ..\n");

121 
	`¥rštf
(
szFÜm©
, 
C_NAME_FMT
, 9, 
HUGE_FORMAT
 + 1);

122 
bIn™
 = 1;

125 
c
->
cu¡key
 = 
n_cu¡
;

126 
	`¥rštf
(
c
->
Çme
, 
szFÜm©
, 
C_NAME_TAG
, 
n_cu¡
);

127 
	`V_STR
(
C_ADDR_LEN
, 
C_ADDR_SD
, 
c
->
add»ss
);

128 
c
->
®’
 = 
	`¡¾’
(c->
add»ss
);

129 
	`RANDOM
(
i
, 0, (
ÇtiÚs
.
couÁ
 - 1), 
C_NTRG_SD
);

130 
c
->
ÇtiÚ_code
 = 
i
;

131 
	`g’_phÚe
(
i
, 
c
->
phÚe
, ()
C_PHNE_SD
);

132 
	`RANDOM
(
c
->
acùb®
, 
C_ABAL_MIN
, 
C_ABAL_MAX
, 
C_ABAL_SD
);

133 
	`pick_¡r
(&
c_m£g_£t
, 
C_MSEG_SD
, 
c
->
mkt£gm’t
);

134 
	`TEXT
(
C_CMNT_LEN
, 
C_CMNT_SD
, 
c
->
comm’t
);

135 
c
->
ş’
 = 
	`¡¾’
(c->
comm’t
);

138 
	}
}

145 
	$mk_¥¬£
 (
DSS_HUGE
 
i
, DSS_HUGE *
ok
, 
£q
)

147 
low_b™s
;

149 *
ok
 = 
i
;

150 
low_b™s
 = ()(
i
 & ((1 << 
SPARSE_KEEP
) - 1));

151 *
ok
 = *ok >> 
SPARSE_KEEP
;

152 *
ok
 = *ok << 
SPARSE_BITS
;

153 *
ok
 +ğ
£q
;

154 *
ok
 = *ok << 
SPARSE_KEEP
;

155 *
ok
 +ğ
low_b™s
;

158 
	}
}

161 
	$mk_Üd”
(
DSS_HUGE
 
šdex
, 
Üd”_t
 *
o
, 
upd_num
)

163 
DSS_HUGE
 
lút
;

164 
DSS_HUGE
 
½riû
;

165 
oút
;

166 
DSS_HUGE
 
tmp_d©e
;

167 
DSS_HUGE
 
s_d©e
;

168 
DSS_HUGE
 
r_d©e
;

169 
DSS_HUGE
 
c_d©e
;

170 
DSS_HUGE
 
şk_num
;

171 
DSS_HUGE
 
suµ_num
;

172 **
asc_d©e
 = 
NULL
;

173 
tmp_¡r
[2];

174 **
mk_ascd©e
 
	`PROTO
(());

175 
d–
 = 1;

176 
bIn™
 = 0;

177 
szFÜm©
[100];

179 !
bIn™
) {

180 
	`TRACE
Ğ
TRACE_ALWAYS
, "Init mk_order ..\n");

181 
	`¥rštf
(
szFÜm©
, 
O_CLRK_FMT
, 9, 
HUGE_FORMAT
 + 1);

182 
bIn™
 = 1;

185 ià(
asc_d©e
 =ğ
NULL
) {

186 
asc_d©e
 = 
	`mk_ascd©e
();

189 
	`mk_¥¬£
 (
šdex
, &
o
->
okey
,

190 (
upd_num
 =ğ0è? 0 : 1 + upd_num / (10000 / 
¬eäesh
));

191 ià(
sÿË
 >= 30000) {

192 
	`RANDOM64
(
o
->
cu¡key
, 
O_CKEY_MIN
, 
O_CKEY_MAX
, 
O_CKEY_SD
);

195 
	`RANDOM
(
o
->
cu¡key
, 
O_CKEY_MIN
, 
O_CKEY_MAX
, 
O_CKEY_SD
);

198 
o
->
cu¡key
 % 
CUST_MORTALITY
 == 0) {

199 
o
->
cu¡key
 +ğ
d–
;

200 
o
->
cu¡key
 = 
	`MIN
(o->cu¡key, 
O_CKEY_MAX
);

201 
d–
 *= -1;

204 
	`RANDOM
(
tmp_d©e
, 
O_ODATE_MIN
, 
O_ODATE_MAX
, 
O_ODATE_SD
);

205 
	`¡rıy
(
o
->
od©e
, 
asc_d©e
[
tmp_d©e
 - 
STARTDATE
]);

207 
	`pick_¡r
(&
o_´iÜ™y_£t
, 
O_PRIO_SD
, 
o
->
İriÜ™y
);

208 
	`RANDOM
(
şk_num
, 1, 
	`MAX
((
sÿË
 * 
O_CLRK_SCL
), O_CLRK_SCL), 
O_CLRK_SD
);

209 
	`¥rštf
(
o
->
ş”k
, 
szFÜm©
, 
O_CLRK_TAG
, 
şk_num
);

210 
	`TEXT
(
O_CMNT_LEN
, 
O_CMNT_SD
, 
o
->
comm’t
);

211 
o
->
ş’
 = 
	`¡¾’
(o->
comm’t
);

212 #ifdeà
DEBUG


213 ià(
o
->
ş’
 > 
O_CMNT_MAX
è
	`årštf
(
¡d”r
, "comm’ˆ”rÜ: O%d\n", 
šdex
);

215 
o
->
¥riÜ™y
 = 0;

217 
o
->
tÙ®´iû
 = 0;

218 
o
->
Üd”¡©us
 = 'O';

219 
oút
 = 0;

221 
	`RANDOM
(
o
->
lšes
, 
O_LCNT_MIN
, 
O_LCNT_MAX
, 
O_LCNT_SD
);

222 
lút
 = 0;†úˆ< 
o
->
lšes
;†cnt++) {

223 
o
->
l
[
lút
].
okey
 = o->okey;;

224 
o
->
l
[
lút
].lcnt =†cnt + 1;

225 
	`RANDOM
(
o
->
l
[
lút
].
quªt™y
, 
L_QTY_MIN
, 
L_QTY_MAX
, 
L_QTY_SD
);

226 
	`RANDOM
(
o
->
l
[
lút
].
discouÁ
, 
L_DCNT_MIN
, 
L_DCNT_MAX
, 
L_DCNT_SD
);

227 
	`RANDOM
(
o
->
l
[
lút
].
x
, 
L_TAX_MIN
, 
L_TAX_MAX
, 
L_TAX_SD
);

228 
	`pick_¡r
(&
l_š¡ruù_£t
, 
L_SHIP_SD
, 
o
->
l
[
lút
].
shš¡ruù
);

229 
	`pick_¡r
(&
l_smode_£t
, 
L_SMODE_SD
, 
o
->
l
[
lút
].
shmode
);

230 
	`TEXT
(
L_CMNT_LEN
, 
L_CMNT_SD
, 
o
->
l
[
lút
].
comm’t
);

231 
o
->
l
[
lút
].
ş’
 = 
	`¡¾’
(o->l[lút].
comm’t
);

232 ià(
sÿË
 >= 30000) {

233 
	`RANDOM64
(
o
->
l
[
lút
].
·¹key
, 
L_PKEY_MIN
, 
L_PKEY_MAX
, 
L_PKEY_SD
);

236 
	`RANDOM
(
o
->
l
[
lút
].
·¹key
, 
L_PKEY_MIN
, 
L_PKEY_MAX
, 
L_PKEY_SD
);

239 
½riû
 = 
	`½b_routše
(
o
->
l
[
lút
].
·¹key
);

240 
	`RANDOM
(
suµ_num
, 0, 3, 
L_SKEY_SD
);

241 
	`PART_SUPP_BRIDGE
Ğ
o
->
l
[
lút
].
suµkey
, o->l[lút].
·¹key
, 
suµ_num
);

242 
o
->
l
[
lút
].
•riû
 = 
½riû
 * o->l[lút].
quªt™y
;

244 
o
->
tÙ®´iû
 +=

245 ((
o
->
l
[
lút
].
•riû
 *

246 (()100 - 
o
->
l
[
lút
].
discouÁ
)è/ ()
PENNIES
 ) *

247 (()100 + 
o
->
l
[
lút
].
x
)

248 / ()
PENNIES
;

250 
	`RANDOM
(
s_d©e
, 
L_SDTE_MIN
, 
L_SDTE_MAX
, 
L_SDTE_SD
);

251 
s_d©e
 +ğ
tmp_d©e
;

252 
	`RANDOM
(
c_d©e
, 
L_CDTE_MIN
, 
L_CDTE_MAX
, 
L_CDTE_SD
);

253 
c_d©e
 +ğ
tmp_d©e
;

254 
	`RANDOM
(
r_d©e
, 
L_RDTE_MIN
, 
L_RDTE_MAX
, 
L_RDTE_SD
);

255 
r_d©e
 +ğ
s_d©e
;

257 
	`¡rıy
(
o
->
l
[
lút
].
sd©e
, 
asc_d©e
[
s_d©e
 - 
STARTDATE
]);

258 
	`¡rıy
(
o
->
l
[
lút
].
cd©e
, 
asc_d©e
[
c_d©e
 - 
STARTDATE
]);

259 
	`¡rıy
(
o
->
l
[
lút
].
rd©e
, 
asc_d©e
[
r_d©e
 - 
STARTDATE
]);

262 ià(
	`julŸn
(
r_d©e
è<ğ
CURRENTDATE
) {

263 
	`pick_¡r
(&
l_ræag_£t
, 
L_RFLG_SD
, 
tmp_¡r
);

265 
o
->
l
[
lút
].
ræag
 = 
tmp_¡r
[0];

269 
o
->
l
[
lút
].
ræag
 = 'N';

272 ià(
	`julŸn
(
s_d©e
è<ğ
CURRENTDATE
) {

273 
oút
++;

275 
o
->
l
[
lút
].
l¡©us
 = 'F';

279 
o
->
l
[
lút
].
l¡©us
 = 'O';

283 ià(
oút
 > 0) {

284 
o
->
Üd”¡©us
 = 'P';

287 ià(
oút
 =ğ
o
->
lšes
) {

288 
o
->
Üd”¡©us
 = 'F';

292 
ušt
 
i
=0; i<
TOTDATE
; i++) {

293 
	`ä“
 (
asc_d©e
[
i
]);

295 
	`ä“
(
asc_d©e
);

298 
	}
}

301 
	$mk_·¹
(
DSS_HUGE
 
šdex
, 
·¹_t
 *
p
)

303 
DSS_HUGE
 
‹mp
;

304 
¢um
;

305 
DSS_HUGE
 
bºd
;

306 
bIn™
 = 0;

307 
szFÜm©
[100];

308 
szB¿ndFÜm©
[100];

310 ià(!
bIn™
) {

311 
	`TRACE
Ğ
TRACE_ALWAYS
, "Init mk_part ..\n");

312 
	`¥rštf
(
szFÜm©
, 
P_MFG_FMT
, 1, 
HUGE_FORMAT
 + 1);

313 
	`¥rštf
(
szB¿ndFÜm©
, 
P_BRND_FMT
, 2, 
HUGE_FORMAT
 + 1);

314 
bIn™
 = 1;

317 
p
->
·¹key
 = 
šdex
;

318 
	`agg_¡r
(&
cŞÜs
, ()
P_NAME_SCL
, ()
P_NAME_SD
, 
p
->
Çme
);

319 
	`RANDOM
(
‹mp
, 
P_MFG_MIN
, 
P_MFG_MAX
, 
P_MFG_SD
);

320 
	`¥rštf
(
p
->
mfgr
, 
szFÜm©
, 
P_MFG_TAG
, 
‹mp
);

321 
	`RANDOM
(
bºd
, 
P_BRND_MIN
, 
P_BRND_MAX
, 
P_BRND_SD
);

322 
	`¥rštf
(
p
->
b¿nd
, 
szB¿ndFÜm©
, 
P_BRND_TAG
, (
‹mp
 * 10 + 
bºd
));

323 
p
->
’
 = 
	`pick_¡r
(&
p_ty³s_£t
, 
P_TYPE_SD
,…->
ty³
);

324 
p
->
’
 = 
	`¡¾’
(
p_ty³s_£t
.
li¡
[p->’].
‹xt
);

325 
	`RANDOM
(
p
->
size
, 
P_SIZE_MIN
, 
P_SIZE_MAX
, 
P_SIZE_SD
);

326 
	`pick_¡r
(&
p_úŒ_£t
, 
P_CNTR_SD
, 
p
->
cÚš”
);

327 
p
->
»´iû
 = 
	`½b_routše
(
šdex
);

328 
	`TEXT
(
P_CMNT_LEN
, 
P_CMNT_SD
, 
p
->
comm’t
);

329 
p
->
ş’
 = 
	`¡¾’
Õ->
comm’t
);

331 
¢um
 = 0; snum < 
SUPP_PER_PART
; snum++) {

332 
p
->
s
[
¢um
].
·¹key
 =…->partkey;

333 
	`PART_SUPP_BRIDGE
Ğ
p
->
s
[
¢um
].
suµkey
, 
šdex
, snum);

334 
	`RANDOM
(
p
->
s
[
¢um
].
qty
, 
PS_QTY_MIN
, 
PS_QTY_MAX
, 
PS_QTY_SD
);

335 
	`RANDOM
(
p
->
s
[
¢um
].
sco¡
, 
PS_SCST_MIN
, 
PS_SCST_MAX
, 
PS_SCST_SD
);

336 
	`TEXT
(
PS_CMNT_LEN
, 
PS_CMNT_SD
, 
p
->
s
[
¢um
].
comm’t
);

337 
p
->
s
[
¢um
].
ş’
 = 
	`¡¾’
Õ->s[¢um].
comm’t
);

341 
	}
}

344 
	$mk_suµ
(
DSS_HUGE
 
šdex
, 
suµl›r_t
 *
s
)

346 
DSS_HUGE
 
i
;

347 
DSS_HUGE
 
bad_´ess
;

348 
DSS_HUGE
 
noi£
;

349 
DSS_HUGE
 
off£t
;

350 
DSS_HUGE
 
ty³
;

352 
szFÜm©
[100];

353 
	`¥rštf
(
szFÜm©
, 
S_NAME_FMT
, 9, 
HUGE_FORMAT
 + 1);

355 
s
->
suµkey
 = 
šdex
;

356 
	`¥rštf
(
s
->
Çme
, 
szFÜm©
, 
S_NAME_TAG
, 
šdex
);

357 
	`V_STR
(
S_ADDR_LEN
, 
S_ADDR_SD
, 
s
->
add»ss
);

358 
s
->
®’
 = 
	`¡¾’
(s->
add»ss
);

359 
	`RANDOM
(
i
, 0, 
ÇtiÚs
.
couÁ
 - 1, 
S_NTRG_SD
);

360 
s
->
ÇtiÚ_code
ğ
i
;

361 
	`g’_phÚe
(
i
, 
s
->
phÚe
, 
S_PHNE_SD
);

362 
	`RANDOM
(
s
->
acùb®
, 
S_ABAL_MIN
, 
S_ABAL_MAX
, 
S_ABAL_SD
);

364 
	`TEXT
(
S_CMNT_LEN
, 
S_CMNT_SD
, 
s
->
comm’t
);

365 
s
->
ş’
 = 
	`¡¾’
(s->
comm’t
);

369 
	`RANDOM
(
bad_´ess
, 1, 10000, 
BBB_CMNT_SD
);

370 
	`RANDOM
(
ty³
, 0, 100, 
BBB_TYPE_SD
);

371 
	`RANDOM
(
noi£
, 0, (
s
->
ş’
 - 
BBB_CMNT_LEN
), 
BBB_JNK_SD
);

372 
	`RANDOM
(
off£t
, 0, (
s
->
ş’
 - (
BBB_CMNT_LEN
 + 
noi£
)),

373 
BBB_OFFSET_SD
);

375 ià(
bad_´ess
 <ğ
S_CMNT_BBB
) {

376 
ty³
 = (ty³ < 
BBB_DEADBEATS
) ?0:1;

377 
	`memıy
(
s
->
comm’t
 + 
off£t
, 
BBB_BASE
, 
BBB_BASE_LEN
);

378 ià(
ty³
 == 0) {

379 
	`memıy
(
s
->
comm’t
 + 
BBB_BASE_LEN
 + 
off£t
 + 
noi£
,

380 
BBB_COMPLAIN
, 
BBB_TYPE_LEN
);

383 
	`memıy
(
s
->
comm’t
 + 
BBB_BASE_LEN
 + 
off£t
 + 
noi£
,

384 
BBB_COMMEND
, 
BBB_TYPE_LEN
);

388 
	}
}

390 
	smÚthEnum


392 cÚ¡ *
	mmdes
;

393 
	mdays
;

394 
	mdút
;

397 
mÚthEnum
 
	gmÚths
[13] =

399 {
NULL
, 0, 0},

416 
	$mk_time
(
DSS_HUGE
 
šdex
, 
dss_time_t
 *
t
)

418 
m
 = 0;

419 
y
;

420 
d
;

422 
t
->
timekey
 = 
šdex
 + 
JDAY_BASE
;

423 
y
 = 
	`julŸn
(
šdex
 + 
STARTDATE
 - 1) / 1000;

424 
d
 = 
	`julŸn
(
šdex
 + 
STARTDATE
 - 1) % 1000;

425 
d
 > 
mÚths
[
m
].
dút
 + 
	`LEAP_ADJ
(
y
, m))

426 
m
++;

427 
	`PR_DATE
(
t
->
®pha
, 
y
, 
m
,

428 
d
 - 
mÚths
[
m
 - 1].
dút
 - ((
	`LEAP
(
y
) && m > 2) ? 1 : 0));

429 
t
->
y—r
 = 1900 + 
y
;

430 
t
->
mÚth
 = 
m
 + 12 * 
y
 + 
JMNTH_BASE
;

431 
t
->
w“k
 = (
d
 + 
T_START_DAY
 - 1) / 7 + 1;

432 
t
->
day
 = 
d
 - 
mÚths
[
m
 - 1].
dút
 - 
	`LEAP_ADJ
(
y
, m-1);

435 
	}
}

438 
	$mk_ÇtiÚ
(
DSS_HUGE
 
šdex
, 
code_t
 *
c
)

441 
c
->
code
 = 
šdex
;

442 
c
->
‹xt
 = 
ÇtiÚs
.
li¡
[
šdex
].text;

443 
c
->
još
 = 
ÇtiÚs
.
li¡
[
šdex
].
weight
;

444 
	`TEXT
(
N_CMNT_LEN
, 
N_CMNT_SD
, 
c
->
comm’t
);

445 
c
->
ş’
 = 
	`¡¾’
(c->
comm’t
);

447 
	}
}

450 
	$mk_»giÚ
(
DSS_HUGE
 
šdex
, 
code_t
 *
c
)

452 
c
->
code
 = 
šdex
;

453 
c
->
‹xt
 = 
»giÚs
.
li¡
[
šdex
].text;

454 
c
->
još
 = 0;

455 
	`TEXT
(
R_CMNT_LEN
, 
R_CMNT_SD
, 
c
->
comm’t
);

456 
c
->
ş’
 = 
	`¡¾’
(c->
comm’t
);

458 
	}
}

461 
EXIT_NAMESPACE
(
dbg’ch
);

	@src/workload/tpch/dbgen/driver.cpp

56 
	#DECLARER


	)

57 
	#NO_FUNC
 ((*è()è
NULL


	)

58 
	#NO_LFUNC
 ((*è(, 
DSS_HUGE
)è
NULL


	)

60 
	~"wÜklßd/ch/dbg’/cÚfig.h
"

61 
	~"wÜklßd/ch/dbg’/»Ëa£.h
"

62 
	~<¡dlib.h
>

63 #ià(
defšed
(
_POSIX_
)||!defšed(
WIN32
))

64 
	~<uni¡d.h
>

65 
	~<sys/wa™.h
>

67 
	~<¡dio.h
>

68 
	~<lim™s.h
>

69 
	~<m©h.h
>

70 
	~<ùy³.h
>

71 
	~<sigÇl.h
>

72 
	~<¡ršg.h
>

73 
	~<”ºo.h
>

74 #ifdeà
HP


75 
	~<¡ršgs.h
>

78 
	~"wÜklßd/ch/dbg’/dss.h
"

79 
	~"wÜklßd/ch/dbg’/ds¡y³s.h
"

82 
ENTER_NAMESPACE
(
dbg’ch
);

89 
u§ge
 ();

90 
´•_dœeù
 (*);

91 
şo£_dœeù
 ();

92 
kl_lßd
 ();

93 
g’_tbl
 (
Šum
, 
DSS_HUGE
 
¡¬t
, DSS_HUGE 
couÁ
, 
upd_num
);

94 
´_d¿nge
 (
tbl
, 
DSS_HUGE
 
mš
, DSS_HUGE 
út
, 
num
);

95 
£t_fes
 (
t
, 
¶ßd
);

96 
·¹Ÿl
 (, );

99 
İtšd
, 
İ‹¼
;

100 *
İrg
;

101 
DSS_HUGE
 
	growút
 = 0, 
	gmšrow
 = 0;

102 
	gupd_num
 = 0;

103 
	gæt_sÿË
;

104 #ià(
defšed
(
WIN32
)&&!defšed(
_POSIX_
))

105 *
	g¥awn_¬gs
[25];

107 #ifdeà
RNG_TEST


108 
£ed_t
 
S“d
[];

138 
´_cu¡
 (* 
c
, 
mode
);

139 
´_lše
 (* 
o
, 
mode
);

140 
´_Üd”
 (* 
o
, 
mode
);

141 
´_·¹
 (* 
p
, 
mode
);

142 
´_psuµ
 (* 
p
, 
mode
);

143 
´_suµ
 (* 
s
, 
mode
);

144 
´_Üd”_lše
 (* 
o
, 
mode
);

145 
´_·¹_psuµ
 (* 
p
, 
mode
);

146 
´_ÇtiÚ
 (* 
c
, 
mode
);

147 
´_»giÚ
 (* 
c
, 
mode
);

152 
ld_cu¡
 (* 
c
, 
mode
);

153 
ld_lše
 (* 
o
, 
mode
);

154 
ld_Üd”
 (* 
o
, 
mode
);

155 
ld_·¹
 (* 
p
, 
mode
);

156 
ld_psuµ
 (* 
p
, 
mode
);

157 
ld_suµ
 (* 
s
, 
mode
);

158 
ld_Üd”_lše
 (* 
o
, 
mode
);

159 
ld_·¹_psuµ
 (* 
p
, 
mode
);

160 
ld_ÇtiÚ
 (* 
c
, 
mode
);

161 
ld_»giÚ
 (* 
c
, 
mode
);

166 
sd_cu¡
 (
chd
, 
DSS_HUGE
 
sk_couÁ
);

167 
sd_lše
 (
chd
, 
DSS_HUGE
 
sk_couÁ
);

168 
sd_Üd”
 (
chd
, 
DSS_HUGE
 
sk_couÁ
);

169 
sd_·¹
 (
chd
, 
DSS_HUGE
 
sk_couÁ
);

170 
sd_psuµ
 (
chd
, 
DSS_HUGE
 
sk_couÁ
);

171 
sd_suµ
 (
chd
, 
DSS_HUGE
 
sk_couÁ
);

172 
sd_Üd”_lše
 (
chd
, 
DSS_HUGE
 
sk_couÁ
);

173 
sd_·¹_psuµ
 (
chd
, 
DSS_HUGE
 
sk_couÁ
);

178 
hd_cu¡
 (
FILE
 * 
f
);

179 
hd_lše
 (
FILE
 * 
f
);

180 
hd_Üd”
 (
FILE
 * 
f
);

181 
hd_·¹
 (
FILE
 * 
f
);

182 
hd_psuµ
 (
FILE
 * 
f
);

183 
hd_suµ
 (
FILE
 * 
f
);

184 
hd_Üd”_lše
 (
FILE
 * 
f
);

185 
hd_·¹_psuµ
 (
FILE
 * 
f
);

186 
hd_ÇtiÚ
 (
FILE
 * 
f
);

187 
hd_»giÚ
 (
FILE
 * 
f
);

192 
vrf_cu¡
 (* 
c
, 
mode
);

193 
vrf_lše
 (* 
o
, 
mode
);

194 
vrf_Üd”
 (* 
o
, 
mode
);

195 
vrf_·¹
 (* 
p
, 
mode
);

196 
vrf_psuµ
 (* 
p
, 
mode
);

197 
vrf_suµ
 (* 
s
, 
mode
);

198 
vrf_Üd”_lše
 (* 
o
, 
mode
);

199 
vrf_·¹_psuµ
 (* 
p
, 
mode
);

200 
vrf_ÇtiÚ
 (* 
c
, 
mode
);

201 
vrf_»giÚ
 (* 
c
, 
mode
);

204 
tdef
 
	gtdefs
[] =

207 
hd_·¹
,

208 {
´_·¹
,

209 
ld_·¹
},

210 
sd_·¹
,

211 
vrf_·¹
,

212 
PSUPP
,

214 {"·¹suµ.tbl", "·¹suµl›¸bË", 200000, 
hd_psuµ
,

215 {
´_psuµ
, 
ld_psuµ
}, 
sd_psuµ
, 
vrf_psuµ
, 
NONE
, 0},

216 {"suµl›r.tbl", "suµl›r bË", 10000, 
hd_suµ
,

217 {
´_suµ
, 
ld_suµ
}, 
sd_suµ
, 
vrf_suµ
, 
NONE
, 0},

218 {"cu¡om”.tbl", "cu¡om” bË", 150000, 
hd_cu¡
,

219 {
´_cu¡
, 
ld_cu¡
}, 
sd_cu¡
, 
vrf_cu¡
, 
NONE
, 0},

220 {"Üd”s.tbl", "Üd”abË", 150000, 
hd_Üd”
,

221 {
´_Üd”
, 
ld_Üd”
}, 
sd_Üd”
, 
vrf_Üd”
, 
LINE
, 0},

222 {"lše™em.tbl", "lše™emabË", 150000, 
hd_lše
,

223 {
´_lše
, 
ld_lše
}, 
sd_lše
, 
vrf_lše
, 
NONE
, 0},

224 {"Üd”s.tbl", "Üd”s/lše™emabËs", 150000, 
hd_Üd”_lše
,

225 {
´_Üd”_lše
, 
ld_Üd”_lše
}, 
sd_Üd”
, 
vrf_Üd”_lše
, 
LINE
, 0},

226 {"·¹.tbl", "·¹/·¹suµl›¸bËs", 200000, 
hd_·¹_psuµ
,

227 {
´_·¹_psuµ
, 
ld_·¹_psuµ
}, 
sd_·¹
, 
vrf_·¹_psuµ
, 
PSUPP
, 0},

228 {"ÇtiÚ.tbl", "ÇtiÚabË", 
NATIONS_MAX
, 
hd_ÇtiÚ
,

229 {
´_ÇtiÚ
,

230 
ld_ÇtiÚ
},

231 
NO_LFUNC
,

232 
vrf_ÇtiÚ
,

233 
NONE
, 0},

234 {"»giÚ.tbl", "»giÚabË", 
NATIONS_MAX
, 
hd_»giÚ
,

235 {
´_»giÚ
, 
ld_»giÚ
}, 
NO_LFUNC
, 
vrf_»giÚ
, 
NONE
, 0},

238 *
	gpids
;

246 
	$¡İ_´oc
 ()

248 
	`ex™
 (0);

249 
	}
}

252 
	$kl_lßd
 ()

254 
i
;

256 #ià!
	`defšed
(
U2200
è&& !defšed(
DOS
)

257 
i
 = 0; i < 
chd»n
; i++)

258 ià(
pids
[
i
])

259 
	`KILL
 (
pids
[
i
]);

262 
	}
}

268 
	$£t_fes
 (
i
, 
¶ßd
)

270 
lše
[80], *
Ãw_Çme
;

272 ià(
bË
 & (1 << 
i
))

273 
chd_bË
:

275 ià(
¶ßd
 != -1)

276 
	`¥rštf
 (
lše
, "%s.%d", 
tdefs
[
i
].
Çme
, 
¶ßd
);

279 
	`´štf
 ("Enter‚ew destination for %s data: ",

280 
tdefs
[
i
].
Çme
);

281 ià(
	`fg‘s
 (
lše
,  (lše), 
¡dš
è=ğ
NULL
)

283 ià((
Ãw_Çme
 = 
	`¡rchr
 (
lše
, '\n')è!ğ
NULL
)

284 *
Ãw_Çme
 = '\0';

285 ià(
	`¡¾’
 (
lše
) == 0)

288 
Ãw_Çme
 = (*è
	`m®loc
 (
	`¡¾’
 (
lše
) + 1);

289 
	`MALLOC_CHECK
 (
Ãw_Çme
);

290 
	`¡rıy
 (
Ãw_Çme
, 
lše
);

291 
tdefs
[
i
].
Çme
 = 
Ãw_Çme
;

292 ià(
tdefs
[
i
].
chd
 !ğ
NONE
)

294 
i
 = 
tdefs
[i].
chd
;

295 
tdefs
[
i
].
chd
 = 
NONE
;

296 
chd_bË
;

301 
	}
}

309 
	$lßd_di¡s
 ()

311 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "p_úŒ", &
p_úŒ_£t
);

312 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "cŞÜs", &
cŞÜs
);

313 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "p_ty³s", &
p_ty³s_£t
);

314 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "ÇtiÚs", &
ÇtiÚs
);

315 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "»giÚs", &
»giÚs
);

316 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "o_oprio",

317 &
o_´iÜ™y_£t
);

318 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "instruct",

319 &
l_š¡ruù_£t
);

320 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "smode", &
l_smode_£t
);

321 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "category",

322 &
l_ÿ‹gÜy_£t
);

323 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "ræag", &
l_ræag_£t
);

324 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "m£gmÁ", &
c_m£g_£t
);

327 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "nouns", &
nouns
);

328 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "v”bs", &
v”bs
);

329 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "adjeùives", &
adjeùives
);

330 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "adv”bs", &
adv”bs
);

331 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "auxÏr›s", &
auxÏr›s
);

332 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "‹rmš©Üs", &
‹rmš©Üs
);

333 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "¬tişes", &
¬tişes
);

334 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "´•os™iÚs", &
´•os™iÚs
);

335 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "g¿mm¬", &
g¿mm¬
);

336 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "Å", &
Å
);

337 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "vp", &
vp
);

339 
	}
}

345 
	$g’_tbl
 (
Šum
, 
DSS_HUGE
 
¡¬t
, DSS_HUGE 
couÁ
, 
upd_num
)

347 
Üd”_t
 
o
;

348 
suµl›r_t
 
suµ
;

349 
cu¡om”_t
 
cu¡
;

350 
·¹_t
 
·¹
;

351 
code_t
 
code
;

352 
com¶‘ed
 = 0;

353 
DSS_HUGE
 
i
;

355 
DSS_HUGE
 
rows_³r_£gm’t
=0;

356 
DSS_HUGE
 
rows_this_£gm’t
=-1;

357 
DSS_HUGE
 
»sidu®_rows
=0;

359 ià(
š£¹_£gm’ts
)

361 
rows_³r_£gm’t
 = 
couÁ
 / 
š£¹_£gm’ts
;

362 
»sidu®_rows
 = 
couÁ
 - (
rows_³r_£gm’t
 * 
š£¹_£gm’ts
);

365 
i
 = 
¡¬t
; 
couÁ
; count--, i++)

367 
	`LIFENOISE
 (1000, 
i
);

368 
	`row_¡¬t
(
Šum
);

370 
Šum
)

372 
LINE
:

373 
ORDER
:

374 
ORDER_LINE
:

375 
	`mk_Üd”
 (
i
, &
o
, 
upd_num
 % 10000);

377 ià(
š£¹_£gm’ts
 && (
upd_num
 > 0)) {

378 if((
upd_num
 / 10000è< 
»sidu®_rows
)

380 if((++
rows_this_£gm’t
è> 
rows_³r_£gm’t
)

382 
rows_this_£gm’t
=0;

383 
upd_num
 += 10000;

388 if((++
rows_this_£gm’t
è>ğ
rows_³r_£gm’t
)

390 
rows_this_£gm’t
=0;

391 
upd_num
 += 10000;

396 ià(
£t_£eds
 == 0) {

397 ià(
v®id©e
) {

398 
tdefs
[
Šum
].
	`v”ify
(&
o
, 0);

401 
tdefs
[
Šum
].
lßd”
[
dœeù
] (&
o
, 
upd_num
);

406 
SUPP
:

407 
	`mk_suµ
 (
i
, &
suµ
);

408 ià(
£t_£eds
 == 0) {

409 ià(
v®id©e
) {

410 
tdefs
[
Šum
].
	`v”ify
(&
suµ
, 0);

413 
tdefs
[
Šum
].
lßd”
[
dœeù
] (&
suµ
, 
upd_num
);

418 
CUST
:

419 
	`mk_cu¡
 (
i
, &
cu¡
);

420 ià(
£t_£eds
 == 0) {

421 ià(
v®id©e
) {

422 
tdefs
[
Šum
].
	`v”ify
(&
cu¡
, 0);

425 
tdefs
[
Šum
].
lßd”
[
dœeù
] (&
cu¡
, 
upd_num
);

430 
PSUPP
:

431 
PART
:

432 
PART_PSUPP
:

433 
	`mk_·¹
 (
i
, &
·¹
);

434 ià(
£t_£eds
 == 0) {

435 ià(
v®id©e
) {

436 
tdefs
[
Šum
].
	`v”ify
(&
·¹
, 0);

439 
tdefs
[
Šum
].
lßd”
[
dœeù
] (&
·¹
, 
upd_num
);

444 
NATION
:

445 
	`mk_ÇtiÚ
 (
i
, &
code
);

446 ià(
£t_£eds
 == 0) {

447 ià(
v®id©e
) {

448 
tdefs
[
Šum
].
	`v”ify
(&
code
, 0);

451 
tdefs
[
Šum
].
lßd”
[
dœeù
] (&
code
, 0);

456 
REGION
:

457 
	`mk_»giÚ
 (
i
, &
code
);

458 ià(
£t_£eds
 == 0) {

459 ià(
v®id©e
) {

460 
tdefs
[
Šum
].
	`v”ify
(&
code
, 0);

463 
tdefs
[
Šum
].
lßd”
[
dœeù
] (&
code
, 0);

468 
	`row_¡İ
(
Šum
);

469 ià(
£t_£eds
 && (
i
 % 
tdefs
[
Šum
].
ba£
) < 2)

471 
	`´štf
("\nS“d fÜ % ©„owcouÁ %Îd\n", 
tdefs
[
Šum
].
comm’t
, 
i
);

472 
	`dump_£eds
(
Šum
);

475 
com¶‘ed
 |ğ1 << 
Šum
;

476 
	}
}

481 
	$u§ge
 ()

483 
	`årštf
 (
¡d”r
, "%s\n%s\n\t%s\n%s %s\n\n",

489 
	`årštf
 (
¡d”r
, "-b <s> --†oad distributions for <s>\n");

490 
	`årštf
 (
¡d”r
, "-C <n> -- use <n>…rocesseso generate data\n");

491 
	`årštf
 (
¡d”r
, " [Under DOS, must be used with -S]\n");

492 
	`årštf
 (
¡d”r
, "-D -- do database†oad in†ine\n");

493 
	`årštf
 (
¡d”r
, "-d <n> -- split deletes between <n> files\n");

494 
	`årštf
 (
¡d”r
, "-f -- force. Overwriteƒxisting files\n");

495 
	`årštf
 (
¡d”r
, "-F -- generate flat files output\n");

496 
	`årštf
 (
¡d”r
, "-h -- displayhis message\n");

497 
	`årštf
 (
¡d”r
, "-i <n> -- split inserts between <n> files\n");

498 
	`årštf
 (
¡d”r
, "-n <s> -- inline†oad into database <s>\n");

499 
	`årštf
 (
¡d”r
, "-O d -- generate SQL syntax for deletes\n");

500 
	`årštf
 (
¡d”r
, "-O f -- over-ride default output file‚ames\n");

501 
	`årštf
 (
¡d”r
, "-O h -- output files with headers\n");

502 
	`årštf
 (
¡d”r
, "-O m --…roduce columnar output\n");

503 
	`årštf
 (
¡d”r
, "-O„ -- generate key„anges for deletes.\n");

504 
	`årštf
 (
¡d”r
, "-O v -- Verify data set without generating it.\n");

505 
	`årštf
 (
¡d”r
, "-q --ƒnable QUIET mode\n");

506 
	`årštf
 (
¡d”r
, "-r <n> -- updates„efresh (n/100)%% ofhe\n");

507 
	`årštf
 (
¡d”r
, " data set\n");

508 
	`årštf
 (
¡d”r
, "-s <n> -- set Scale Factor (SF)o <n> \n");

509 
	`årštf
 (
¡d”r
, "-S <n> -- buildhe <n>th step ofhe data/update set\n");

510 
	`årštf
 (
¡d”r
, "-T c -- generate cutomers ONLY\n");

511 
	`årštf
 (
¡d”r
, "-T† -- generate‚ation/region ONLY\n");

512 
	`årštf
 (
¡d”r
, "-T L -- generate†ineitem ONLY\n");

513 
	`årštf
 (
¡d”r
, "-T‚ -- generate‚ation ONLY\n");

514 
	`årštf
 (
¡d”r
, "-T o -- generate orders/lineitem ONLY\n");

515 
	`årštf
 (
¡d”r
, "-T O -- generate orders ONLY\n");

516 
	`årštf
 (
¡d”r
, "-T… -- generate…arts/partsupp ONLY\n");

517 
	`årštf
 (
¡d”r
, "-T P -- generate…arts ONLY\n");

518 
	`årštf
 (
¡d”r
, "-T„ -- generate„egion ONLY\n");

519 
	`årštf
 (
¡d”r
, "-T s -- generate suppliers ONLY\n");

520 
	`årštf
 (
¡d”r
, "-T S -- generate…artsupp ONLY\n");

521 
	`årštf
 (
¡d”r
, "-U <s> -- generate <s> update sets\n");

522 
	`årštf
 (
¡d”r
, "-v --ƒnable VERBOSE mode\n");

523 
	`årštf
 (
¡d”r
,

525 
	`årštf
 (
¡d”r
, "\tdbgen -vfF -s 1\n");

526 
	`årštf
 (
¡d”r
, "\nTo generate updates for‡ SF=1 (1GB), use:\n");

527 
	`årštf
 (
¡d”r
, "\tdbgen -v -U 1 -s 1\n");

528 
	}
}

536 
	$dbg’_š™
 ()

539 
bË
 = (1 << 
CUST
) |

540 (1 << 
SUPP
) |

541 (1 << 
NATION
) |

542 (1 << 
REGION
) |

543 (1 << 
PART_PSUPP
) |

544 (1 << 
ORDER_LINE
);

545 
fÜû
 = 0;

546 
š£¹_£gm’ts
=0;

547 
d–‘e_£gm’ts
=0;

548 
š£¹_Üd”s_£gm’t
=0;

549 
š£¹_lše™em_£gm’t
=0;

550 
d–‘e_£gm’t
=0;

551 
v”bo£
 = 0;

552 
cŞumÇr
 = 0;

553 
£t_£eds
 = 0;

554 
h—d”
 = 0;

555 
dœeù
 = 0;

556 
sÿË
 = 1;

557 
æt_sÿË
 = 1.0;

558 
upd©es
 = 0;

559 
¬eäesh
 = 
UPD_PCT
;

560 
¡•
 = -1;

561 
tdefs
[
ORDER
].
ba£
 *=

562 
ORDERS_PER_CUST
;

563 
tdefs
[
LINE
].
ba£
 *=

564 
ORDERS_PER_CUST
;

565 
tdefs
[
ORDER_LINE
].
ba£
 *=

566 
ORDERS_PER_CUST
;

567 
âames
 = 0;

568 
db_Çme
 = 
NULL
;

569 
g’_sql
 = 0;

570 
g’_ºg
 = 0;

571 
chd»n
 = 1;

572 
d_·th
 = 
NULL
;

574 
	`lßd_di¡s
 ();

576 #ifdeà
RNG_TEST


577 
DSS_HUGE
 
i
=0; i <ğ
MAX_STREAM
; i++)

578 
S“d
[
i
].
nC®ls
 = 0;

582 
tdefs
[
NATION
].
ba£
 = 
ÇtiÚs
.
couÁ
;

583 
tdefs
[
REGION
].
ba£
 = 
»giÚs
.
couÁ
;

586 
	}
}

589 
EXIT_NAMESPACE
(
dbg’ch
);

	@src/workload/tpch/dbgen/load_stub.cpp

31 
	~<¡dio.h
>

32 
	~"wÜklßd/ch/dbg’/cÚfig.h
"

33 
	~"wÜklßd/ch/dbg’/dss.h
"

34 
	~"wÜklßd/ch/dbg’/ds¡y³s.h
"

37 
ENTER_NAMESPACE
(
dbg’ch
);

42 
	$şo£_dœeù
()

46 
	}
}

49 
	$´•_dœeù
(*)

53 
	}
}

55 
	$hd_cu¡
 (
FILE
* )

57 
couÁ
 = 0;

59 ià(! 
couÁ
++)

60 
	`´štf
("No header has been defined forhe customerable\n");

63 
	}
}

65 
	$ld_cu¡
 (* , )

68 
couÁ
 = 0;

70 ià(! 
couÁ
++)

71 
	`´štf
("%s %s\n",

76 
	}
}

78 
	$hd_·¹
 (
FILE
* )

80 
couÁ
 = 0;

82 ià(! 
couÁ
++)

83 
	`´štf
("No header has been defined forhe…artable\n");

86 
	}
}

88 
	$ld_·¹
 (* , )

91 
couÁ
 = 0;

93 ià(! 
couÁ
++)

94 
	`´štf
("No†oad„outine has been defined forhe…artable\n");

97 
	}
}

99 
	$ld_psuµ
 (* , )

102 
couÁ
 = 0;

104 ià(! 
couÁ
++)

105 
	`´štf
("%s %s\n",

111 
	}
}

114 
	$hd_suµ
 (
FILE
* )

116 
couÁ
 = 0;

118 ià(! 
couÁ
++)

119 
	`´štf
("No header has been defined forhe supplierable\n");

122 
	}
}

124 
	$ld_suµ
 (* , )

127 
couÁ
 = 0;

129 ià(! 
couÁ
++)

130 
	`´štf
("%s %s\n",

135 
	}
}

138 
	$hd_Üd”
 (
FILE
* )

140 
couÁ
 = 0;

142 ià(! 
couÁ
++)

143 
	`´štf
("No header has been defined forhe orderable\n");

146 
	}
}

148 
	$ld_Üd”
 (* , )

151 
couÁ
 = 0;

153 ià(! 
couÁ
++)

154 
	`´štf
("%s %s\n",

159 
	}
}

161 
	$ld_lše
 (* , )

164 
couÁ
 = 0;

166 ià(! 
couÁ
++)

167 
	`´štf
("%s %s\n",

172 
	}
}

176 
	$hd_psuµ
 (
FILE
* )

178 
couÁ
 = 0;

180 ià(! 
couÁ
++)

181 
	`´štf
("%s %s\n",

186 
	}
}

189 
	$hd_lše
 (
FILE
* )

191 
couÁ
 = 0;

193 ià(! 
couÁ
++)

194 
	`´štf
("No header has been defined forhe†ineitemable\n");

197 
	}
}

199 
	$hd_ÇtiÚ
 (
FILE
* )

201 
couÁ
 = 0;

203 ià(! 
couÁ
++)

204 
	`´štf
("No header has been defined forhe‚ationable\n");

207 
	}
}

209 
	$ld_ÇtiÚ
 (* , )

212 
couÁ
 = 0;

214 ià(! 
couÁ
++)

215 
	`´štf
("%s %s\n",

220 
	}
}

222 
	$hd_»giÚ
 (
FILE
* )

224 
couÁ
 = 0;

226 ià(! 
couÁ
++)

227 
	`´štf
("No header has been defined forhe„egionable\n");

230 
	}
}

232 
	$ld_»giÚ
 (* , )

235 
couÁ
 = 0;

237 ià(! 
couÁ
++)

238 
	`´štf
("%s %s\n",

243 
	}
}

246 
	$ld_Üd”_lše
 (*
vp
, 
mode
)

248 
Üd”_t
* 
p
 = (Üd”_t*)
vp
;

250 
	`ld_Üd”
(
p
, 
mode
);

251 
	`ld_lše
 (
p
, 
mode
);

254 
	}
}

257 
	$hd_Üd”_lše
 (
FILE
 *
f
)

259 
	`hd_Üd”
(
f
);

260 
	`hd_lše
 (
f
);

263 
	}
}

266 
	$ld_·¹_psuµ
 (*
vp
, 
mode
)

268 
·¹_t
* 
p
 = (·¹_t*)
vp
;

270 
	`ld_·¹
(
p
, 
mode
);

271 
	`ld_psuµ
 (
p
, 
mode
);

274 
	}
}

277 
	$hd_·¹_psuµ
 (
FILE
 *
f
)

279 
	`hd_·¹
(
f
);

280 
	`hd_psuµ
(
f
);

283 
	}
}

286 
EXIT_NAMESPACE
(
dbg’ch
);

	@src/workload/tpch/dbgen/permute.cpp

32 #ifdeà
TEST


33 
	#DECLARER


	)

36 
	~"wÜklßd/ch/dbg’/cÚfig.h
"

37 
	~"wÜklßd/ch/dbg’/dss.h
"

39 #ifdeà
TEST


40 
	~<¡dlib.h
>

42 
	~<uni¡d.h
>

43 
	~<sys/wa™.h
>

44 
	~<¡dio.h
>

45 
	~<lim™s.h
>

46 
	~<m©h.h
>

47 
	~<ùy³.h
>

48 
	~<sigÇl.h
>

49 
	~<¡ršg.h
>

50 
	~<”ºo.h
>

51 #ifdeà
HP


52 
	~<¡ršgs.h
>

58 
ENTER_NAMESPACE
(
dbg’ch
);

61 
DSS_HUGE
 
NextRªd
(DSS_HUGE 
£ed
);

62 *
³rmu‹
(*
£t
, 
út
, 
¡»am
, 
DSS_HUGE
& 
sourû
, * 
cs
);

63 *
³rmu‹_di¡
(
di¡ributiÚ
 *
d
, 
¡»am
, 
DSS_HUGE
& 
sourû
, di¡ributiÚ* 
cd
);

64 
	g£ed
;

65 cÚ¡ *
	geŞ
[2] = {" ", "},"};

66 
£ed_t
 
S“d
[];

67 #ifdeà
TEST


68 
tdef
 
	gtdefs
 = { 
NULL
 };

72 
	#MAX_QUERY
 22

	)

73 
	#ITERATIONS
 1000

	)

74 
	#UNSET
 0

	)

80 
	$³rmu‹
(*
a
, 
c
, 
s
, 
DSS_HUGE
& 
sourû
, * 
c£t
)

82 
i
;

83 
‹mp
;

85 ià(
a
 !ğ(*)
NULL
) {

86 
i
=0; i < 
c
; i++) {

87 *(
a
 + 
i
) = i;

90 
i
=0; i < 
c
; i++) {

91 
	`RANDOM
(
sourû
, 0L, ()(
c
 - 1), 
s
);

92 
‹mp
 = *(
a
 + 
sourû
);

93 *(
a
 + 
sourû
èğ*× + 
i
) ;

94 *(
a
 + 
i
èğ
‹mp
;

95 
sourû
 = 0;

99 
sourû
 += 1;

102 ià(
sourû
 >ğ
c
) {

103 
sourû
 -ğ
c
;

106  (
c£t
 + 
sourû
);

107 
	}
}

111 
	$³rmu‹_di¡
(
di¡ributiÚ
 *
d
, 
¡»am
,

112 
DSS_HUGE
& 
sourû
, 
di¡ributiÚ
* 
cd
)

114 
boŞ
 
bIn™
 = 
çl£
;

115 
di¡ributiÚ
 *
di¡
 = 
NULL
;

117 ià(
d
 !ğ
NULL
) {

118 ià(
d
->
³rmu‹
 =ğ(*)
NULL
) {

119 
d
->
³rmu‹
 = (*)
	`m®loc
((è* 
	`DIST_SIZE
(d));

120 
	`MALLOC_CHECK
(
d
->
³rmu‹
);

127 !
bIn™
) {

128 
di¡
 = 
d
;

129 
bIn™
 = 
Œue
;

136 
	`as£¹
 (
di¡
 =ğ
d
);

137  (
	`³rmu‹
(
di¡
->
³rmu‹
, 
	`DIST_SIZE
(di¡), 
¡»am
,

138 
sourû
, 
cd
->
³rmu‹
));

141 ià(
di¡
 !ğ
NULL
) {

142  (
	`³rmu‹
(
NULL
, 
	`DIST_SIZE
(
di¡
), 
¡»am
, 
sourû
, 
cd
->
³rmu‹
));

145 
	`INTERNAL_ERROR
("Bad callo…ermute_dist");

148  (
NULL
);

149 
	}
}

153 
EXIT_NAMESPACE
(
dbg’ch
);

157 #ifdeà
TEST


159 
	$maš
(
ac
, *
av
[])

161 *
£qu’û
,

162 
i
,

163 
j
,

164 
¡»ams
 = 
UNSET
,

165 *
a
;

166 
£p
;

167 
šdex
 = 0;

169 
£t_£eds
 = 0;

170 
£qu’û
 = (*)
	`m®loc
(
MAX_QUERY
 * ());

171 
a
 = 
£qu’û
;

172 
i
=0; i < 
MAX_QUERY
; i++)

173 *(
£qu’û
 + 
i
) = i;

174 ià(
ac
 < 3)

175 
u§ge
;

176 
S“d
[0].
v®ue
 = ()
	`©oi
(
av
[1]);

177 
¡»ams
 = 
	`©oi
(
av
[2]);

178 ià(
S“d
[0].
v®ue
 =ğ
UNSET
 || 
¡»ams
 == UNSET)

179 
u§ge
;

181 
šdex
 = 0;

182 
	`´štf
("lÚg…”mutiÚ[%d][%d] = {\n", 
¡»ams
, 
MAX_QUERY
);

183 
j
=0; j < 
¡»ams
; j++) {

184 
£p
 = '{';

185 
	`´štf
("%s\n", 
eŞ
[
šdex
]);

186 
i
=0; i < 
MAX_QUERY
; i++)

188 
	`´štf
("%c%2d", 
£p
, *
	`³rmu‹
(
a
, 
MAX_QUERY
, 0) + 1);

189 
a
 = (*)
NULL
;

190 
£p
 = ',';

192 
a
 = 
£qu’û
;

193 
šdex
=1;

196 
	`´štf
("}\n};\n");

199 
u§ge
:

200 
	`´štf
("U§ge: % <£ed> <¡»ams>\n",
av
[0]);

201 
	`´štf
(" u£ <£ed>Ø¡¬ˆthg’”©iÚ oà<¡»ams>…”mutiÚ oà[1..%d]\n", 
MAX_QUERY
);

204 
	}
}

	@src/workload/tpch/dbgen/print.cpp

37 
	~<¡dio.h
>

38 #iâdeà
VMS


39 
	~<sys/ty³s.h
>

41 #ià
defšed
(
SUN
)

42 
	~<uni¡d.h
>

44 
	~<m©h.h
>

46 
	~"wÜklßd/ch/dbg’/dss.h
"

47 
	~"wÜklßd/ch/dbg’/ds¡y³s.h
"

48 
	~<¡ršg.h
>

51 
ENTER_NAMESPACE
(
dbg’ch
);

57 
FILE
 *
´št_´•
 
PROTO
((
bË
, 
upd©e
));

58 
´_d¿nge
 
PROTO
((
tbl
, 
DSS_HUGE
 
mš
, DSS_HUGE 
út
, 
num
));

60 
FILE
 *

61 
	$´št_´•
(
bË
, 
upd©e
)

63 
u·th
[128];

64 
FILE
 *
»s
;

66 ià(
upd©es
)

68 ià(
upd©e
 > 0)

69 iàĞ
š£¹_£gm’ts
 )

71 
this_£gm’t
;

72 if(
	`¡rcmp
(
tdefs
[
bË
].
Çme
,"orders.tbl"))

73 
this_£gm’t
=++
š£¹_Üd”s_£gm’t
;

75 
this_£gm’t
=++
š£¹_lše™em_£gm’t
;

76 
	`¥rštf
(
u·th
, "%s%c%s.u%d.%d",

77 
	`’v_cÚfig
(
PATH_TAG
, 
PATH_DFLT
),

78 
PATH_SEP
, 
tdefs
[
bË
].
Çme
, 
upd©e
%10000,
this_£gm’t
);

82 
	`¥rštf
(
u·th
, "%s%c%s.u%d",

83 
	`’v_cÚfig
(
PATH_TAG
, 
PATH_DFLT
),

84 
PATH_SEP
, 
tdefs
[
bË
].
Çme
, 
upd©e
);

87 iàĞ
d–‘e_£gm’ts
 )

89 ++
d–‘e_£gm’t
;

90 
	`¥rštf
(
u·th
, "%s%cdelete.u%d.%d",

91 
	`’v_cÚfig
(
PATH_TAG
, 
PATH_DFLT
), 
PATH_SEP
, -
upd©e
%10000,

92 
d–‘e_£gm’t
);

96 
	`¥rštf
(
u·th
, "%s%cdelete.%d",

97 
	`’v_cÚfig
(
PATH_TAG
, 
PATH_DFLT
), 
PATH_SEP
, -
upd©e
);

99 (
	`fİ’
(
u·th
, "w"));

101 
»s
 = 
	`tbl_İ’
(
bË
, "w");

102 
	`OPEN_CHECK
(
»s
, 
tdefs
[
bË
].
Çme
);

103 (
»s
);

104 
	}
}

106 
dbg_´št
(
fÜm©
, 
FILE
 *
rg‘
, *
d©a
, 
Ën
, 

107 #ifdeà
EOL_HANDLING


108 
£p


112 
	gdŞÏrs
,

113 
	gûÁs
;

115 
	gfÜm©
)

117 
	gDT_STR
:

118 ià(
cŞumÇr
)

119 
årštf
(
rg‘
, "%-*s", 
Ën
, (*)
d©a
);

121 
årštf
(
rg‘
, "%s", (*)
d©a
);

123 #ifdeà
MVS


124 
	gDT_VSTR
:

126 
årštf
(
rg‘
, "%c%c%-*s",

127 (
Ën
 >> 8è& 0xFF,†’ & 0xFF,†’, (*)
d©a
);

130 
	gDT_INT
:

131 ià(
cŞumÇr
)

132 
årštf
(
rg‘
, "%12ld", ()
d©a
);

134 
årštf
(
rg‘
, "%ld", ()
d©a
);

136 
	gDT_HUGE
:

137 
årštf
(
rg‘
, 
HUGE_FORMAT
, *(
DSS_HUGE
 *)
d©a
);

139 
	gDT_KEY
:

140 
årštf
(
rg‘
, "%ld", ()
d©a
);

142 
	gDT_MONEY
:

143 
ûÁs
 = ()*(
DSS_HUGE
 *)
d©a
;

144 ià(
	gûÁs
 < 0)

146 
årštf
(
rg‘
, "-");

147 
	gûÁs
 = -
ûÁs
;

149 
	gdŞÏrs
 = 
ûÁs
 / 100;

150 
	gûÁs
 %= 100;

151 ià(
	gcŞumÇr
)

152 
årštf
(
rg‘
, "%12d.%02d", 
dŞÏrs
, 
ûÁs
);

154 
årštf
(
rg‘
, "%d.%02d", 
dŞÏrs
, 
ûÁs
);

156 
	gDT_CHR
:

157 ià(
cŞumÇr
)

158 
årštf
(
rg‘
, "%ø", *(*)
d©a
);

160 
årštf
(
rg‘
, "%c", *(*)
d©a
);

164 #ifdeà
EOL_HANDLING


165 ià(
	g£p
)

167 ià(!
	gcŞumÇr
)

168 
årštf
(
rg‘
, "%c", 
SEPARATOR
);

173 
	$´_cu¡
(*
vc
, )

175 
cu¡om”_t
* 
c
 = (cu¡om”_t*)
vc
;

177 
FILE
 *
å
 = 
NULL
;

179 ià(
å
 =ğ
NULL
)

180 
å
 = 
	`´št_´•
(
CUST
, 0);

182 
	`PR_STRT
(
å
);

183 
	`PR_HUGE
(
å
, &
c
->
cu¡key
);

184 ià(
sÿË
 <= 3000)

185 
	`PR_VSTR
(
å
, 
c
->
Çme
, 
C_NAME_LEN
);

187 
	`PR_VSTR
(
å
, 
c
->
Çme
, 
C_NAME_LEN
 + 3);

188 
	`PR_VSTR
(
å
, 
c
->
add»ss
,

189 (
cŞumÇr
)?()(
	`û
(
C_ADDR_LEN
 * 
V_STR_HGH
)):
c
->
®’
);

190 
	`PR_HUGE
(
å
, &
c
->
ÇtiÚ_code
);

191 
	`PR_STR
(
å
, 
c
->
phÚe
, 
PHONE_LEN
);

192 
	`PR_MONEY
(
å
, &
c
->
acùb®
);

193 
	`PR_STR
(
å
, 
c
->
mkt£gm’t
, 
C_MSEG_LEN
);

194 
	`PR_VSTR_LAST
(
å
, 
c
->
comm’t
,

195 (
cŞumÇr
)?()(
	`û
(
C_CMNT_LEN
 * 
V_STR_HGH
)):
c
->
ş’
);

196 
	`PR_END
(
å
);

199 
	}
}

205 
	$´_Üd”
(*
vo
, 
mode
)

207 
Üd”_t
* 
o
 = (Üd”_t*)
vo
;

208 
FILE
 *
å_o
 = 
NULL
;

209 
Ï¡_mode
 = 0;

211 ià(
å_o
 =ğ
NULL
 || 
mode
 !ğ
Ï¡_mode
)

213 ià(
å_o
)

214 
	`fşo£
(
å_o
);

215 
å_o
 = 
	`´št_´•
(
ORDER
, 
mode
);

216 
Ï¡_mode
 = 
mode
;

218 
	`PR_STRT
(
å_o
);

219 
	`PR_HUGE
(
å_o
, &
o
->
okey
);

220 
	`PR_HUGE
(
å_o
, &
o
->
cu¡key
);

221 
	`PR_CHR
(
å_o
, &
o
->
Üd”¡©us
);

222 
	`PR_MONEY
(
å_o
, &
o
->
tÙ®´iû
);

223 
	`PR_STR
(
å_o
, 
o
->
od©e
, 
DATE_LEN
);

224 
	`PR_STR
(
å_o
, 
o
->
İriÜ™y
, 
O_OPRIO_LEN
);

225 
	`PR_STR
(
å_o
, 
o
->
ş”k
, 
O_CLRK_LEN
);

226 
	`PR_INT
(
å_o
, 
o
->
¥riÜ™y
);

227 
	`PR_VSTR_LAST
(
å_o
, 
o
->
comm’t
,

228 (
cŞumÇr
)?()(
	`û
(
O_CMNT_LEN
 * 
V_STR_HGH
)):
o
->
ş’
);

229 
	`PR_END
(
å_o
);

232 
	}
}

238 
	$´_lše
(*
vo
, 
mode
)

240 
Üd”_t
* 
o
 = (Üd”_t*)
vo
;

241 
FILE
 *
å_l
 = 
NULL
;

242 
Ï¡_mode
 = 0;

243 
i
;

245 ià(
å_l
 =ğ
NULL
 || 
mode
 !ğ
Ï¡_mode
)

247 ià(
å_l
)

248 
	`fşo£
(
å_l
);

249 
å_l
 = 
	`´št_´•
(
LINE
, 
mode
);

250 
Ï¡_mode
 = 
mode
;

253 
i
 = 0; i < 
o
->
lšes
; i++)

255 
	`PR_STRT
(
å_l
);

256 
	`PR_HUGE
(
å_l
, &
o
->
l
[
i
].
okey
);

257 
	`PR_HUGE
(
å_l
, &
o
->
l
[
i
].
·¹key
);

258 
	`PR_HUGE
(
å_l
, &
o
->
l
[
i
].
suµkey
);

259 
	`PR_HUGE
(
å_l
, &
o
->
l
[
i
].
lút
);

260 
	`PR_HUGE
(
å_l
, &
o
->
l
[
i
].
quªt™y
);

261 
	`PR_MONEY
(
å_l
, &
o
->
l
[
i
].
•riû
);

262 
	`PR_MONEY
(
å_l
, &
o
->
l
[
i
].
discouÁ
);

263 
	`PR_MONEY
(
å_l
, &
o
->
l
[
i
].
x
);

265 
	`PR_CHR
(
å_l
, &
o
->
l
[
i
].
ræag
);

267 
	`PR_CHR
(
å_l
, &
o
->
l
[
i
].
l¡©us
);

268 
	`PR_STR
(
å_l
, 
o
->
l
[
i
].
sd©e
, 
DATE_LEN
);

269 
	`PR_STR
(
å_l
, 
o
->
l
[
i
].
cd©e
, 
DATE_LEN
);

270 
	`PR_STR
(
å_l
, 
o
->
l
[
i
].
rd©e
, 
DATE_LEN
);

271 
	`PR_STR
(
å_l
, 
o
->
l
[
i
].
shš¡ruù
, 
L_INST_LEN
);

272 
	`PR_STR
(
å_l
, 
o
->
l
[
i
].
shmode
, 
L_SMODE_LEN
);

273 
	`PR_VSTR_LAST
(
å_l
, 
o
->
l
[
i
].
comm’t
,

274 (
cŞumÇr
)?()(
	`û
(
L_CMNT_LEN
 * 
V_STR_HGH
)):
o
->
l
[
i
].
ş’
);

275 
	`PR_END
(
å_l
);

279 
	}
}

285 
	$´_Üd”_lše
(*
vo
, 
mode
)

287 
Üd”_t
* 
o
 = (Üd”_t*)
vo
;

288 
tdefs
[
ORDER
].
Çme
 =defs[
ORDER_LINE
].name;

289 
	`´_Üd”
(
o
, 
mode
);

290 
	`´_lše
(
o
, 
mode
);

293 
	}
}

298 
	$´_·¹
(*
vp
, )

300 
·¹_t
* 
·¹
 = (·¹_t*)
vp
;

301 
FILE
 *
p_å
 = 
NULL
;

303 ià(
p_å
 =ğ
NULL
)

304 
p_å
 = 
	`´št_´•
(
PART
, 0);

306 
	`PR_STRT
(
p_å
);

307 
	`PR_HUGE
(
p_å
, &
·¹
->
·¹key
);

308 
	`PR_VSTR
(
p_å
, 
·¹
->
Çme
,

309 (
cŞumÇr
)?()
P_NAME_LEN
:
·¹
->
Æ’
);

310 
	`PR_STR
(
p_å
, 
·¹
->
mfgr
, 
P_MFG_LEN
);

311 
	`PR_STR
(
p_å
, 
·¹
->
b¿nd
, 
P_BRND_LEN
);

312 
	`PR_VSTR
(
p_å
, 
·¹
->
ty³
,

313 (
cŞumÇr
)?()
P_TYPE_LEN
:
·¹
->
’
);

314 
	`PR_HUGE
(
p_å
, &
·¹
->
size
);

315 
	`PR_STR
(
p_å
, 
·¹
->
cÚš”
, 
P_CNTR_LEN
);

316 
	`PR_MONEY
(
p_å
, &
·¹
->
»´iû
);

317 
	`PR_VSTR_LAST
(
p_å
, 
·¹
->
comm’t
,

318 (
cŞumÇr
)?()(
	`û
(
P_CMNT_LEN
 * 
V_STR_HGH
)):
·¹
->
ş’
);

319 
	`PR_END
(
p_å
);

322 
	}
}

328 
	$´_psuµ
(*
vp
, 
mode
)

330 
·¹_t
* 
·¹
 = (·¹_t*)
vp
;

331 
FILE
 *
ps_å
 = 
NULL
;

332 
i
;

334 ià(
ps_å
 =ğ
NULL
)

335 
ps_å
 = 
	`´št_´•
(
PSUPP
, 
mode
);

337 
i
 = 0; i < 
SUPP_PER_PART
; i++)

339 
	`PR_STRT
(
ps_å
);

340 
	`PR_HUGE
(
ps_å
, &
·¹
->
s
[
i
].
·¹key
);

341 
	`PR_HUGE
(
ps_å
, &
·¹
->
s
[
i
].
suµkey
);

342 
	`PR_HUGE
(
ps_å
, &
·¹
->
s
[
i
].
qty
);

343 
	`PR_MONEY
(
ps_å
, &
·¹
->
s
[
i
].
sco¡
);

344 
	`PR_VSTR_LAST
(
ps_å
, 
·¹
->
s
[
i
].
comm’t
,

345 (
cŞumÇr
)?()(
	`û
(
PS_CMNT_LEN
 * 
V_STR_HGH
)):
·¹
->
s
[
i
].
ş’
);

346 
	`PR_END
(
ps_å
);

350 
	}
}

356 
	$´_·¹_psuµ
(*
vp
, 
mode
)

358 
·¹_t
* 
·¹
 = (·¹_t*)
vp
;

359 
tdefs
[
PART
].
Çme
 =defs[
PART_PSUPP
].name;

360 
	`´_·¹
(
·¹
, 
mode
);

361 
	`´_psuµ
(
·¹
, 
mode
);

364 
	}
}

367 
	$´_suµ
(*
vs
, 
mode
)

369 
suµl›r_t
* 
suµ
 = (suµl›r_t*)
vs
;

370 
FILE
 *
å
 = 
NULL
;

372 ià(
å
 =ğ
NULL
)

373 
å
 = 
	`´št_´•
(
SUPP
, 
mode
);

375 
	`PR_STRT
(
å
);

376 
	`PR_HUGE
(
å
, &
suµ
->
suµkey
);

377 
	`PR_STR
(
å
, 
suµ
->
Çme
, 
S_NAME_LEN
);

378 
	`PR_VSTR
(
å
, 
suµ
->
add»ss
,

379 (
cŞumÇr
)?()(
	`û
(
S_ADDR_LEN
 * 
V_STR_HGH
)):
suµ
->
®’
);

380 
	`PR_HUGE
(
å
, &
suµ
->
ÇtiÚ_code
);

381 
	`PR_STR
(
å
, 
suµ
->
phÚe
, 
PHONE_LEN
);

382 
	`PR_MONEY
(
å
, &
suµ
->
acùb®
);

383 
	`PR_VSTR_LAST
(
å
, 
suµ
->
comm’t
,

384 (
cŞumÇr
)?()(
	`û
(
S_CMNT_LEN
 * 
V_STR_HGH
)):
suµ
->
ş’
);

385 
	`PR_END
(
å
);

388 
	}
}

391 
	$´_ÇtiÚ
(*
vc
, 
mode
)

393 
code_t
* 
c
 = (code_t*)
vc
;

394 
FILE
 *
å
 = 
NULL
;

396 ià(
å
 =ğ
NULL
)

397 
å
 = 
	`´št_´•
(
NATION
, 
mode
);

399 
	`PR_STRT
(
å
);

400 
	`PR_HUGE
(
å
, &
c
->
code
);

401 
	`PR_STR
(
å
, 
c
->
‹xt
, 
NATION_LEN
);

402 
	`PR_INT
(
å
, 
c
->
još
);

403 
	`PR_VSTR_LAST
(
å
, 
c
->
comm’t
,

404 (
cŞumÇr
)?()(
	`û
(
N_CMNT_LEN
 * 
V_STR_HGH
)):
c
->
ş’
);

405 
	`PR_END
(
å
);

408 
	}
}

411 
	$´_»giÚ
(*
vc
, 
mode
)

413 
code_t
* 
c
 = (code_t*)
vc
;

414 
FILE
 *
å
 = 
NULL
;

416 ià(
å
 =ğ
NULL
)

417 
å
 = 
	`´št_´•
(
REGION
, 
mode
);

419 
	`PR_STRT
(
å
);

420 
	`PR_HUGE
(
å
, &
c
->
code
);

421 
	`PR_STR
(
å
, 
c
->
‹xt
, 
REGION_LEN
);

422 
	`PR_VSTR_LAST
(
å
, 
c
->
comm’t
,

423 (
cŞumÇr
)?()(
	`û
(
R_CMNT_LEN
 * 
V_STR_HGH
)):
c
->
ş’
);

424 
	`PR_END
(
å
);

427 
	}
}

436 
	$´_d¿nge
(
tbl
, 
DSS_HUGE
 
mš
, DSS_HUGE 
út
, 
num
)

438 
Ï¡_num
 = 0;

439 
FILE
 *
då
 = 
NULL
;

440 
DSS_HUGE
 
chd
 = -1;

441 
DSS_HUGE
 
¡¬t
, 
Ï¡
, 
ªew
;

443 
DSS_HUGE
 
rows_³r_£gm’t
=0;

444 
DSS_HUGE
 
rows_this_£gm’t
=0;

446 ià(
Ï¡_num
 !ğ
num
)

448 ià(
då
)

449 
	`fşo£
(
då
);

450 
då
 = 
	`´št_´•
(
tbl
, -
num
);

451 ià(
då
 =ğ
NULL
)

453 
Ï¡_num
 = 
num
;

454 
rows_this_£gm’t
=0;

457 
¡¬t
 = 
	`MK_SPARSE
(
mš
, 
num
/ (10000 / 
¬eäesh
));

458 
Ï¡
 = 
¡¬t
 - 1;

459 
chd
=
mš
; 
út
 > 0; child++, cnt--)

461 
ªew
 = 
	`MK_SPARSE
(
chd
, 
num
/ (10000 / 
¬eäesh
));

462 ià(
g’_ºg
 =ğ1 && 
ªew
 - 
Ï¡
 == 1)

464 
Ï¡
 = 
ªew
;

467 ià(
g’_sql
)

469 
	`årštf
(
då
,

471 
tdefs
[
ORDER
].
Çme
, "o_Üd”key", 
¡¬t
, 
Ï¡
);

472 
	`årštf
(
då
,

474 
tdefs
[
LINE
].
Çme
, "l_Üd”key", 
¡¬t
, 
Ï¡
);

475 
	`årštf
(
då
, "commit work;\n");

478 ià(
g’_ºg
)

480 
	`PR_STRT
(
då
);

481 
	`PR_HUGE
(
då
, &
¡¬t
);

482 
	`PR_HUGE
(
då
, &
Ï¡
);

483 
	`PR_END
(
då
);

487 ià(
d–‘e_£gm’ts
)

490 if(
rows_³r_£gm’t
==0)

491 
rows_³r_£gm’t
 = (
út
 / 
d–‘e_£gm’ts
) + 1;

492 if((++
rows_this_£gm’t
è> 
rows_³r_£gm’t
)

494 
	`fşo£
(
då
);

495 
då
 = 
	`´št_´•
(
tbl
, -
num
);

496 ià(
då
 =ğ
NULL
) (-1);

497 
Ï¡_num
 = 
num
;

498 
rows_this_£gm’t
=1;

501 
	`PR_STRT
(
då
);

502 
	`PR_HUGE
(
då
, &
ªew
);

503 
	`PR_END
(
då
);

505 
¡¬t
 = 
ªew
;

506 
Ï¡
 = 
ªew
;

508 ià(
g’_ºg
)

510 
	`PR_STRT
(
då
);

511 
	`PR_HUGE
(
då
, &
¡¬t
);

512 
	`PR_HUGE
(
då
, &
Ï¡
);

513 
	`PR_END
(
då
);

517 
	}
}

524 
	$vrf_cu¡
(*
vc
, )

526 
cu¡om”_t
* 
c
 = (cu¡om”_t*)
vc
;

528 
	`VRF_STRT
(
CUST
);

529 
	`VRF_INT
(
CUST
, 
c
->
cu¡key
);

530 
	`VRF_STR
(
CUST
, 
c
->
Çme
);

531 
	`VRF_STR
(
CUST
, 
c
->
add»ss
);

532 
	`VRF_INT
(
CUST
, 
c
->
ÇtiÚ_code
);

533 
	`VRF_STR
(
CUST
, 
c
->
phÚe
);

534 
	`VRF_MONEY
(
CUST
, 
c
->
acùb®
);

535 
	`VRF_STR
(
CUST
, 
c
->
mkt£gm’t
);

536 
	`VRF_STR
(
CUST
, 
c
->
comm’t
);

537 
	`VRF_END
(
CUST
);

540 
	}
}

545 
	$vrf_Üd”
(*
vo
, )

547 
Üd”_t
* 
o
 = (Üd”_t*)
vo
;

549 
	`VRF_STRT
(
ORDER
);

550 
	`VRF_HUGE
(
ORDER
, 
o
->
okey
);

551 
	`VRF_INT
(
ORDER
, 
o
->
cu¡key
);

552 
	`VRF_CHR
(
ORDER
, 
o
->
Üd”¡©us
);

553 
	`VRF_MONEY
(
ORDER
, 
o
->
tÙ®´iû
);

554 
	`VRF_STR
(
ORDER
, 
o
->
od©e
);

555 
	`VRF_STR
(
ORDER
, 
o
->
İriÜ™y
);

556 
	`VRF_STR
(
ORDER
, 
o
->
ş”k
);

557 
	`VRF_INT
(
ORDER
, 
o
->
¥riÜ™y
);

558 
	`VRF_STR
(
ORDER
, 
o
->
comm’t
);

559 
	`VRF_END
(
ORDER
);

562 
	}
}

567 
	$vrf_lše
(*
vo
, )

569 
Üd”_t
* 
o
 = (Üd”_t*)
vo
;

570 
i
;

572 
i
 = 0; i < 
o
->
lšes
; i++)

574 
	`VRF_STRT
(
LINE
);

575 
	`VRF_HUGE
(
LINE
, 
o
->
l
[
i
].
okey
);

576 
	`VRF_INT
(
LINE
, 
o
->
l
[
i
].
·¹key
);

577 
	`VRF_INT
(
LINE
, 
o
->
l
[
i
].
suµkey
);

578 
	`VRF_INT
(
LINE
, 
o
->
l
[
i
].
lút
);

579 
	`VRF_INT
(
LINE
, 
o
->
l
[
i
].
quªt™y
);

580 
	`VRF_MONEY
(
LINE
, 
o
->
l
[
i
].
•riû
);

581 
	`VRF_MONEY
(
LINE
, 
o
->
l
[
i
].
discouÁ
);

582 
	`VRF_MONEY
(
LINE
, 
o
->
l
[
i
].
x
);

584 
	`VRF_CHR
(
LINE
, 
o
->
l
[
i
].
ræag
);

586 
	`VRF_CHR
(
LINE
, 
o
->
l
[
i
].
l¡©us
);

587 
	`VRF_STR
(
LINE
, 
o
->
l
[
i
].
sd©e
);

588 
	`VRF_STR
(
LINE
, 
o
->
l
[
i
].
cd©e
);

589 
	`VRF_STR
(
LINE
, 
o
->
l
[
i
].
rd©e
);

590 
	`VRF_STR
(
LINE
, 
o
->
l
[
i
].
shš¡ruù
);

591 
	`VRF_STR
(
LINE
, 
o
->
l
[
i
].
shmode
);

592 
	`VRF_STR
(
LINE
, 
o
->
l
[
i
].
comm’t
);

593 
	`VRF_END
(
LINE
);

597 
	}
}

603 
	$vrf_Üd”_lše
(*
vo
, 
mode
)

605 
Üd”_t
* 
o
 = (Üd”_t*)
vo
;

607 
	`vrf_Üd”
(
o
, 
mode
);

608 
	`vrf_lše
(
o
, 
mode
);

611 
	}
}

616 
	$vrf_·¹
(*
vp
, )

618 
·¹_t
* 
·¹
 = (·¹_t*)
vp
;

620 
	`VRF_STRT
(
PART
);

621 
	`VRF_INT
(
PART
, 
·¹
->
·¹key
);

622 
	`VRF_STR
(
PART
, 
·¹
->
Çme
);

623 
	`VRF_STR
(
PART
, 
·¹
->
mfgr
);

624 
	`VRF_STR
(
PART
, 
·¹
->
b¿nd
);

625 
	`VRF_STR
(
PART
, 
·¹
->
ty³
);

626 
	`VRF_INT
(
PART
, 
·¹
->
size
);

627 
	`VRF_STR
(
PART
, 
·¹
->
cÚš”
);

628 
	`VRF_MONEY
(
PART
, 
·¹
->
»´iû
);

629 
	`VRF_STR
(
PART
, 
·¹
->
comm’t
);

630 
	`VRF_END
(
PART
);

633 
	}
}

638 
	$vrf_psuµ
(*
vp
, )

640 
·¹_t
* 
·¹
 = (·¹_t*)
vp
;

641 
i
;

643 
i
 = 0; i < 
SUPP_PER_PART
; i++)

645 
	`VRF_STRT
(
PSUPP
);

646 
	`VRF_INT
(
PSUPP
, 
·¹
->
s
[
i
].
·¹key
);

647 
	`VRF_INT
(
PSUPP
, 
·¹
->
s
[
i
].
suµkey
);

648 
	`VRF_INT
(
PSUPP
, 
·¹
->
s
[
i
].
qty
);

649 
	`VRF_MONEY
(
PSUPP
, 
·¹
->
s
[
i
].
sco¡
);

650 
	`VRF_STR
(
PSUPP
, 
·¹
->
s
[
i
].
comm’t
);

651 
	`VRF_END
(
PSUPP
);

655 
	}
}

661 
	$vrf_·¹_psuµ
(*
vp
, 
mode
)

663 
·¹_t
* 
·¹
 = (·¹_t*)
vp
;

665 
	`vrf_·¹
(
·¹
, 
mode
);

666 
	`vrf_psuµ
(
·¹
, 
mode
);

669 
	}
}

671 
	$vrf_suµ
(*
vs
, )

673 
suµl›r_t
* 
suµ
 = (suµl›r_t*)
vs
;

675 
	`VRF_STRT
(
SUPP
);

676 
	`VRF_INT
(
SUPP
, 
suµ
->
suµkey
);

677 
	`VRF_STR
(
SUPP
, 
suµ
->
Çme
);

678 
	`VRF_STR
(
SUPP
, 
suµ
->
add»ss
);

679 
	`VRF_INT
(
SUPP
, 
suµ
->
ÇtiÚ_code
);

680 
	`VRF_STR
(
SUPP
, 
suµ
->
phÚe
);

681 
	`VRF_MONEY
(
SUPP
, 
suµ
->
acùb®
);

682 
	`VRF_STR
(
SUPP
, 
suµ
->
comm’t
);

683 
	`VRF_END
(
SUPP
);

686 
	}
}

688 
	$vrf_ÇtiÚ
(*
vc
, )

690 
code_t
* 
c
 = (code_t*)
vc
;

692 
	`VRF_STRT
(
NATION
);

693 
	`VRF_INT
(
NATION
, 
c
->
code
);

694 
	`VRF_STR
(
NATION
, 
c
->
‹xt
);

695 
	`VRF_INT
(
NATION
, 
c
->
još
);

696 
	`VRF_STR
(
NATION
, 
c
->
comm’t
);

697 
	`VRF_END
(
NATION
);

700 
	}
}

702 
	$vrf_»giÚ
(*
vc
, )

704 
code_t
* 
c
 = (code_t*)
vc
;

706 
	`VRF_STRT
(
REGION
);

707 
	`VRF_INT
(
REGION
, 
c
->
code
);

708 
	`VRF_STR
(
REGION
, 
c
->
‹xt
);

709 
	`VRF_STR
(
REGION
, 
c
->
comm’t
);

710 
	`VRF_END
(
å
);

713 
	}
}

717 
EXIT_NAMESPACE
(
dbg’ch
);

	@src/workload/tpch/dbgen/rnd.cpp

73 
	~"wÜklßd/ch/dbg’/cÚfig.h
"

74 
	~<¡dio.h
>

75 
	~<m©h.h
>

76 #ifdeà
LINUX


77 
	~<¡dšt.h
>

79 #ifdeà
IBM


80 
	~<š‰y³s.h
>

82 #ifdeà
SUN


83 
	~<š‰y³s.h
>

85 #ifdeà
ATT


86 
	~<sys/b™y³s.h
>

89 
	~"wÜklßd/ch/dbg’/dss.h
"

90 
	~"wÜklßd/ch/dbg’/ºd.h
"

93 
ENTER_NAMESPACE
(
dbg’ch
);

97 
	gnA
 = 16807;

98 
	gnM
 = 2147483647;

99 
	gnQ
 = 127773;

100 
	gnR
 = 2836;

103 cÚ¡ *
’v_cÚfig
 
PROTO
((cÚ¡ *
g
, cÚ¡ *
dæt
));

104 
NthEËm’t
(
DSS_HUGE
, DSS_HUGE *);

107 
	$dss_¿ndom
(
DSS_HUGE
 *
tgt
, DSS_HUGE 
low”
, DSS_HUGE 
uµ”
, 
¡»am
)

109 *
tgt
 = 
	`UnifIÁ
(
low”
, 
uµ”
, 
¡»am
);

110 
S“d
[
¡»am
].
u§ge
 += 1;

113 
	}
}

115 
row_¡¬t
() \

117 
	gi
;

118 
	gi
=0; i <ğ
MAX_STREAM
; i++)

119 
	gS“d
[
i
].
	gu§ge
 = 0 ;

125 
row_¡İ
(
t
) \

127 
	gi
;

130 ià(
	gt
 =ğ
ORDER_LINE
)

131 
t
 = 
ORDER
;

132 ià(
	gt
 =ğ
PART_PSUPP
)

133 
t
 = 
PART
;

135 
	gi
=0; i <ğ
MAX_STREAM
; i++)

136 ià((
	gS“d
[
i
].
	gbË
 =ğ
t
è|| (
S“d
[i].
bË
 =ğ
tdefs
[t].
chd
))

138 ià(
£t_£eds
 && (
S“d
[
i
].
u§ge
 > S“d[i].
bound¬y
))

140 
årštf
(
¡d”r
, "\nSEED CHANGE: seed[%d].usage = %lld\n",

141 
i
, 
S“d
[i].
u§ge
);

142 
	gS“d
[
i
].
	gbound¬y
 = 
S“d
[i].
u§ge
;

146 
NthEËm’t
((
S“d
[
i
].
bound¬y
 - S“d[i].
u§ge
), &S“d[i].
v®ue
);

147 #ifdeà
RNG_TEST


148 
	gS“d
[
i
].
	gnC®ls
 +ğ
S“d
[i].
bound¬y
 - S“d[i].
u§ge
;

156 
	$dump_£eds
(
tbl
)

158 
i
;

160 
i
=0; i <ğ
MAX_STREAM
; i++)

161 ià(
S“d
[
i
].
bË
 =ğ
tbl
)

162 #ifdeà
RNG_TEST


163 
	`´štf
("%d(%ld):\t%ld\n", 
i
, 
S“d
[i].
nC®ls
, S“d[i].
v®ue
);

165 
	`´štf
("%d:\t%Îd\n", 
i
, 
S“d
[i].
v®ue
);

168 
	}
}

179 
DSS_HUGE


180 
	$NextRªd
(
DSS_HUGE
 
nS“d
)

189 
nS“d
 = (nSeed * 16807) % 2147483647;

190  (
nS“d
);

191 
	}
}

202 
DSS_HUGE


203 
	$UnifIÁ
(
DSS_HUGE
 
nLow
, DSS_HUGE 
nHigh
, 
nSŒ—m
)

212 
dRªge
;

213 
DSS_HUGE
 
nTemp
,

214 
nRªge
;

215 
nLow32
 = ()
nLow
;

216 
nHigh32
 = ()
nHigh
;

218 ià(
nSŒ—m
 < 0 ||‚SŒ—m > 
MAX_STREAM
)

219 
nSŒ—m
 = 0;

221 ià((
nHigh
 =ğ
MAX_LONG
è&& (
nLow
 == 0))

223 
dRªge
 = 
	`DOUBLE_CAST
 (
nHigh32
 - 
nLow32
 + 1);

224 
nRªge
 = 
nHigh32
 - 
nLow32
 + 1;

228 
dRªge
 = 
	`DOUBLE_CAST
 (
nHigh
 - 
nLow
 + 1);

229 
nRªge
 = 
nHigh
 - 
nLow
 + 1;

232 
S“d
[
nSŒ—m
].
v®ue
 = 
	`NextRªd
(Seed[nStream].value);

233 #ifdeà
RNG_TEST


234 
S“d
[
nSŒ—m
].
nC®ls
 += 1;

236 
nTemp
 = (è(((è
S“d
[
nSŒ—m
].
v®ue
 / 
dM
è* (
dRªge
));

237  (
nLow
 + 
nTemp
);

238 
	}
}

243 
EXIT_NAMESPACE
(
dbg’ch
);

	@src/workload/tpch/dbgen/rng64.cpp

56 
	~"wÜklßd/ch/dbg’/cÚfig.h
"

57 
	~"wÜklßd/ch/dbg’/dss.h
"

58 
	~<¡dio.h
>

59 
	~<¡dlib.h
>

60 
	~"wÜklßd/ch/dbg’/ºg64.h
"

63 
ENTER_NAMESPACE
(
dbg’ch
);

66 
dM
;

68 
£ed_t
 
S“d
[];

71 
	$dss_¿ndom64
(
DSS_HUGE
 *
tgt
, DSS_HUGE 
nLow
, DSS_HUGE 
nHigh
, 
nSŒ—m
)

73 
DSS_HUGE
 
nTemp
;

75 ià(
nSŒ—m
 < 0 ||‚SŒ—m > 
MAX_STREAM
)

76 
nSŒ—m
 = 0;

78 ià(
nLow
 > 
nHigh
)

80 
nTemp
 = 
nLow
;

81 
nLow
 = 
nHigh
;

82 
nHigh
 = 
nTemp
;

85 
S“d
[
nSŒ—m
].
v®ue
 = 
	`NextRªd64
(Seed[nStream].value);

86 
nTemp
 = 
S“d
[
nSŒ—m
].
v®ue
;

87 ià(
nTemp
 < 0)

88 
nTemp
 = -nTemp;

89 
nTemp
 %ğ(
nHigh
 - 
nLow
 + 1);

90 *
tgt
 = 
nLow
 + 
nTemp
;

91 
S“d
[
nSŒ—m
].
u§ge
 += 1;

92 #ifdeà
RNG_TEST


93 
S“d
[
nSŒ—m
].
nC®ls
 += 1;

97 
	}
}

99 
DSS_HUGE


100 
	$NextRªd64
(
DSS_HUGE
 
nS“d
){

102 
DSS_HUGE
 
a
 = (DSS_HUGEè
RNG_A
;

103 
DSS_HUGE
 
c
 = (DSS_HUGEè
RNG_C
;

104 
nS“d
 = (nS“d * 
a
 + 
c
);

106  (
nS“d
);

107 
	}
}

109 
DSS_HUGE
 
	$AdvªûRªd64
Ğ
DSS_HUGE
 
nS“d
,

110 
DSS_HUGE
 
nCouÁ
) {

111 
DSS_HUGE
 
a
 = 
RNG_A
 ;

112 
DSS_HUGE
 
c
 = 
RNG_C
 ;

113 
nB™
;

114 
DSS_HUGE
 
Apow
=
a
, 
Dsum
=
c
;

117 ifĞ
nCouÁ
 =ğ0 )  
nS“d
;

133  
nB™
 = 0; (
nCouÁ
 >>‚B™è!ğ
RNG_C
 ;‚Bit ++){}

136  --
nB™
 >= 0 ) {

137 
Dsum
 *ğ(
Apow
 + 1);

138 
Apow
 = Apow * Apow;

139 ifĞ((
nCouÁ
 >> 
nB™
) % 2) == 1 ) {

140 
Dsum
 +ğ
Apow
;

141 
Apow
 *ğ
a
;

144 
nS“d
 =‚S“d * 
Apow
 + 
Dsum
 * 
c
;

145  
nS“d
;

146 
	}
}

149 
EXIT_NAMESPACE
(
dbg’ch
);

	@src/workload/tpch/dbgen/speed_seed.cpp

49 
	~<¡dio.h
>

50 
	~<¡dlib.h
>

51 
	~"wÜklßd/ch/dbg’/dss.h
"

52 
	~"wÜklßd/ch/dbg’/ºg64.h
"

53 
	~"wÜklßd/ch/dbg’/dss.h
"

56 
ENTER_NAMESPACE
(
dbg’ch
);

61 
	#ADVANCE_STREAM
(
¡»am_id
, 
num_ÿÎs
) \

62 
	`advªûSŒ—m
(
¡»am_id
, 
num_ÿÎs
, 0)

	)

63 
	#ADVANCE_STREAM64
(
¡»am_id
, 
num_ÿÎs
) \

64 
	`advªûSŒ—m
(
¡»am_id
, 
num_ÿÎs
, 1)

	)

65 
	#MAX_COLOR
 92

	)

66 
	gÇme_b™s
[
MAX_COLOR
 / 
BITS_PER_LONG
];

67 
£ed_t
 
S“d
[];

68 
çkeVSŒ
(
nAvg
, 
nS“d
, 
DSS_HUGE
 
nCouÁ
);

69 
NthEËm’t
 (
DSS_HUGE
 
N
, DSS_HUGE *
S¹S“d
);

73 
	$advªûSŒ—m
(
nSŒ—m
, 
nC®ls
, 
bU£64B™
)

75 ià(
bU£64B™
)

76 
S“d
[
nSŒ—m
].
v®ue
 = 
	`AdvªûRªd64
(S“d[nSŒ—m].v®ue, 
nC®ls
);

78 
	`NthEËm’t
(
nC®ls
, &
S“d
[
nSŒ—m
].
v®ue
);

80 #ifdeà
RNG_TEST


81 
S“d
[
nSŒ—m
].
nC®ls
 +=‚Calls;

85 
	}
}

94 
DSS_HUGE
 
	gMuÉl›r
 = 16807;

95 
DSS_HUGE
 
	gModulus
 = 2147483647;

114 
	$NthEËm’t
 (
DSS_HUGE
 
N
, DSS_HUGE *
S¹S“d
)

116 
DSS_HUGE
 
Z
;

117 
DSS_HUGE
 
MuÉ
;

118 
Ê
=-1;

119 
i
;

121 ià((
v”bo£
 > 0è&& ++
Ê
 % 1000 == 0)

123 
i
 = 
Ê
 % 
LN_CNT
;

124 
	`årštf
(
¡d”r
, "%c\b", 
Êoi£
[
i
]);

126 
MuÉ
 = 
MuÉl›r
;

127 
Z
 = (
DSS_HUGE
è*
S¹S“d
;

128 
N
 > 0 )

130 ià(
N
 % 2 != 0)

131 
Z
 = (
MuÉ
 * Zè% 
Modulus
;

132 
N
 = N / 2;

133 
MuÉ
 = (MuÉ * MuÉè% 
Modulus
;

135 *
S¹S“d
 = 
Z
;

138 
	}
}

143 
	$çke_a_ºd
(
mš
, 
max
, 
cŞumn
)

145 
DSS_HUGE
 
Ën
;

146 
DSS_HUGE
 
™couÁ
;

148 
	`RANDOM
(
Ën
, 
mš
, 
max
, 
cŞumn
);

149 ià(
Ën
 % 5L == 0)

150 
™couÁ
 = 
Ën
/5;

152 
™couÁ
 = 
Ën
/5 + 1L;

153 
	`NthEËm’t
(
™couÁ
, &
S“d
[
cŞumn
].
u§ge
);

154 #ifdeà
RNG_TEST


155 
S“d
[
cŞumn
].
nC®ls
 +ğ
™couÁ
;

158 
	}
}

161 
	$sd_·¹
(, 
DSS_HUGE
 
sk_couÁ
)

163 
i
;

165 
i
=
P_MFG_SD
; i<ğ
P_CNTR_SD
; i++)

166 
	`ADVANCE_STREAM
(
i
, 
sk_couÁ
);

168 
	`ADVANCE_STREAM
(
P_CMNT_SD
, 
sk_couÁ
 * 2);

169 
	`ADVANCE_STREAM
(
P_NAME_SD
, 
sk_couÁ
 * 92);

172 
	}
}

175 
	$sd_lše
(
chd
, 
DSS_HUGE
 
sk_couÁ
)

177 
i
,
j
;

179 
j
=0; j < 
O_LCNT_MAX
; j++)

181 
i
=
L_QTY_SD
; i<ğ
L_RFLG_SD
; i++)

182 ià(
sÿË
 >ğ30000 && 
i
 =ğ
L_PKEY_SD
)

183 
	`ADVANCE_STREAM64
(
i
, 
sk_couÁ
);

185 
	`ADVANCE_STREAM
(
i
, 
sk_couÁ
);

186 
	`ADVANCE_STREAM
(
L_CMNT_SD
, 
sk_couÁ
 * 2);

190 ià(
chd
 == 1)

192 
	`ADVANCE_STREAM
(
O_ODATE_SD
, 
sk_couÁ
);

193 
	`ADVANCE_STREAM
(
O_LCNT_SD
, 
sk_couÁ
);

197 
	}
}

199 
	$sd_Üd”
(, 
DSS_HUGE
 
sk_couÁ
)

201 
	`ADVANCE_STREAM
(
O_LCNT_SD
, 
sk_couÁ
);

202 ià(
sÿË
 >= 30000)

203 
	`ADVANCE_STREAM64
(
O_CKEY_SD
, 
sk_couÁ
);

205 
	`ADVANCE_STREAM
(
O_CKEY_SD
, 
sk_couÁ
);

206 
	`ADVANCE_STREAM
(
O_CMNT_SD
, 
sk_couÁ
 * 2);

207 
	`ADVANCE_STREAM
(
O_SUPP_SD
, 
sk_couÁ
);

208 
	`ADVANCE_STREAM
(
O_CLRK_SD
, 
sk_couÁ
);

209 
	`ADVANCE_STREAM
(
O_PRIO_SD
, 
sk_couÁ
);

210 
	`ADVANCE_STREAM
(
O_ODATE_SD
, 
sk_couÁ
);

213 
	}
}

215 
	$sd_psuµ
(, 
DSS_HUGE
 
sk_couÁ
)

217 
j
;

219 
j
=0; j < 
SUPP_PER_PART
; j++)

221 
	`ADVANCE_STREAM
(
PS_QTY_SD
, 
sk_couÁ
);

222 
	`ADVANCE_STREAM
(
PS_SCST_SD
, 
sk_couÁ
);

223 
	`ADVANCE_STREAM
(
PS_CMNT_SD
, 
sk_couÁ
 * 2);

227 
	}
}

229 
	$sd_cu¡
(, 
DSS_HUGE
 
sk_couÁ
)

232 
	`ADVANCE_STREAM
(
C_ADDR_SD
, 
sk_couÁ
 * 9);

233 
	`ADVANCE_STREAM
(
C_CMNT_SD
, 
sk_couÁ
 * 2);

234 
	`ADVANCE_STREAM
(
C_NTRG_SD
, 
sk_couÁ
);

235 
	`ADVANCE_STREAM
(
C_PHNE_SD
, 3L * 
sk_couÁ
);

236 
	`ADVANCE_STREAM
(
C_ABAL_SD
, 
sk_couÁ
);

237 
	`ADVANCE_STREAM
(
C_MSEG_SD
, 
sk_couÁ
);

239 
	}
}

241 
	$sd_suµ
(, 
DSS_HUGE
 
sk_couÁ
)

243 
	`ADVANCE_STREAM
(
S_NTRG_SD
, 
sk_couÁ
);

244 
	`ADVANCE_STREAM
(
S_PHNE_SD
, 3L * 
sk_couÁ
);

245 
	`ADVANCE_STREAM
(
S_ABAL_SD
, 
sk_couÁ
);

246 
	`ADVANCE_STREAM
(
S_ADDR_SD
, 
sk_couÁ
 * 9);

247 
	`ADVANCE_STREAM
(
S_CMNT_SD
, 
sk_couÁ
 * 2);

248 
	`ADVANCE_STREAM
(
BBB_CMNT_SD
, 
sk_couÁ
);

249 
	`ADVANCE_STREAM
(
BBB_JNK_SD
, 
sk_couÁ
);

250 
	`ADVANCE_STREAM
(
BBB_OFFSET_SD
, 
sk_couÁ
);

251 
	`ADVANCE_STREAM
(
BBB_TYPE_SD
, 
sk_couÁ
);

254 
	}
}

257 
EXIT_NAMESPACE
(
dbg’ch
);

	@src/workload/tpch/dbgen/text.cpp

43 #ifdeà
TEXT_TEST


44 
	#DECLARER


	)

47 
	~"wÜklßd/ch/dbg’/cÚfig.h
"

48 
	~<¡dlib.h
>

49 
	~<uni¡d.h
>

50 
	~<sys/wa™.h
>

51 
	~<¡dio.h
>

52 
	~<lim™s.h
>

53 
	~<m©h.h
>

54 
	~<ùy³.h
>

55 
	~<sigÇl.h
>

56 
	~<¡ršg.h
>

57 
	~<”ºo.h
>

58 #ifdeà
HP


59 
	~<¡ršgs.h
>

62 
	~"wÜklßd/ch/dbg’/dss.h
"

63 
	~"wÜklßd/ch/dbg’/ds¡y³s.h
"

66 
ENTER_NAMESPACE
(
dbg’ch
);

70 
	#TEXT_POOL_SIZE
 (300 * 1024 * 1024)

	)

73 
	#TEXT_POOL_PROGRESS
 (30 * 1024 * 1024)

	)

88 
	$txt_vp
(*
de¡
, 
sd
)

90 
syÁax
[
MAX_GRAMMAR_LEN
 + 1],

91 *
ıŒ
,

92 *
·r£_rg‘
;

93 
di¡ributiÚ
 *
¤c
;

94 
i
,

95 
»s
 = 0;

98 
	`pick_¡r
(&
vp
, 
sd
, &
syÁax
[0]);

99 
·r£_rg‘
 = 
syÁax
;

100 (
ıŒ
 = 
	`¡¹ok
(
·r£_rg‘
, " ")è!ğ
NULL
)

102 
¤c
 = 
NULL
;

103 *
ıŒ
)

106 
¤c
 = &
adv”bs
;

109 
¤c
 = &
v”bs
;

112 
¤c
 = &
auxÏr›s
;

115 
i
 = 
	`pick_¡r
(
¤c
, 
sd
, 
de¡
);

116 
i
 = 
	`¡¾’
(
	`DIST_MEMBER
(
¤c
, i));

117 
de¡
 +ğ
i
;

118 
»s
 +ğ
i
;

119 ià(*(++
ıŒ
))

121 
de¡
 += 1;

122 
»s
 += 1;

123 *
de¡
 = *
ıŒ
;

125 *
de¡
 = ' ';

126 
de¡
++;

127 
»s
++;

128 
·r£_rg‘
 = 
NULL
;

131 (
»s
);

132 
	}
}

147 
	$txt_Å
(*
de¡
, 
sd
)

149 
syÁax
[
MAX_GRAMMAR_LEN
 + 1],

150 *
ıŒ
,

151 *
·r£_rg‘
;

152 
di¡ributiÚ
 *
¤c
;

153 
i
,

154 
»s
 = 0;

157 
	`pick_¡r
(&
Å
, 
sd
, &
syÁax
[0]);

158 
·r£_rg‘
 = 
syÁax
;

159 (
ıŒ
 = 
	`¡¹ok
(
·r£_rg‘
, " ")è!ğ
NULL
)

161 
¤c
 = 
NULL
;

162 *
ıŒ
)

165 
¤c
 = &
¬tişes
;

168 
¤c
 = &
adjeùives
;

171 
¤c
 = &
adv”bs
;

174 
¤c
 = &
nouns
;

177 
i
 = 
	`pick_¡r
(
¤c
, 
sd
, 
de¡
);

178 
i
 = 
	`¡¾’
(
	`DIST_MEMBER
(
¤c
, i));

179 
de¡
 +ğ
i
;

180 
»s
 +ğ
i
;

181 ià(*(++
ıŒ
))

183 *
de¡
 = *
ıŒ
;

184 
de¡
 += 1;

185 
»s
 += 1;

187 *
de¡
 = ' ';

188 
de¡
++;

189 
»s
++;

190 
·r£_rg‘
 = 
NULL
;

193 (
»s
);

194 
	}
}

209 
	$txt_£Á’û
(*
de¡
, 
sd
)

211 
syÁax
[
MAX_GRAMMAR_LEN
 + 1],

212 *
ıŒ
;

213 
i
,

214 
»s
 = 0,

215 
Ën
 = 0;

218 
	`pick_¡r
(&
g¿mm¬
, 
sd
, 
syÁax
);

219 
ıŒ
 = 
syÁax
;

221 
Ãxt_tok’
:

222 *
ıŒ
 && *cptr == ' ')

223 
ıŒ
++;

224 ià(*
ıŒ
 == '\0')

225 
dÚe
;

226 *
ıŒ
)

229 
Ën
 = 
	`txt_vp
(
de¡
, 
sd
);

232 
Ën
 = 
	`txt_Å
(
de¡
, 
sd
);

235 
i
 = 
	`pick_¡r
(&
´•os™iÚs
, 
sd
, 
de¡
);

236 
Ën
 = 
	`¡¾’
(
	`DIST_MEMBER
(&
´•os™iÚs
, 
i
));

237 
	`¡rıy
((
de¡
 + 
Ën
), "he ");

238 
Ën
 += 5;

239 
Ën
 +ğ
	`txt_Å
(
de¡
 +†’, 
sd
);

242 
i
 = 
	`pick_¡r
(&
‹rmš©Üs
, 
sd
, --
de¡
);

243 
Ën
 = 
	`¡¾’
(
	`DIST_MEMBER
(&
‹rmš©Üs
, 
i
));

246 
de¡
 +ğ
Ën
;

247 
»s
 +ğ
Ën
;

248 
ıŒ
++;

249 ià(*
ıŒ
 && *cptr != ' ')

251 
de¡
 += 1;

252 
»s
 += 1;

253 *
de¡
 = *
ıŒ
;

255 
Ãxt_tok’
;

256 
dÚe
:

257 *
de¡
 = '\0';

258 (--
»s
);

259 
	}
}

267 
	$dbg_‹xt
(*
tgt
, 
mš
, 
max
, 
sd
)

269 
DSS_HUGE
 
hgL’gth
 = 0;

270 
DSS_HUGE
 
hgOff£t
;

271 
DSS_HUGE
 
wÜdËn
 = 0;

272 
DSS_HUGE
 
s_Ën
;

273 
DSS_HUGE
 
Ãeded
;

274 
£Á’û
[
MAX_SENT_LEN
 + 1];

275 *
ı
;

276 
szTextPoŞ
[
TEXT_POOL_SIZE
 + 1];

277 
bIn™
 = 0;

278 
nLiãNoi£
 = 0;

279 
txtPoŞIndiÿtÜ
 = 
TEXT_POOL_PROGRESS
;

281 !
bIn™
) {

283 
ı
 = &
szTextPoŞ
[0];

284 
	`TRACE
Ğ
TRACE_ALWAYS
, "Preloadingext ..\n");

286 
wÜdËn
 < 
TEXT_POOL_SIZE
) {

287 ià(
v”bo£
 && (
wÜdËn
 > 
nLiãNoi£
)) {

288 
nLiãNoi£
 += 200000;

289 
	`årštf
(
¡d”r
, "%3.0f%%\b\b\b\b", (100.0 * 
wÜdËn
)/
TEXT_POOL_SIZE
);

292 ià(
wÜdËn
 > 
txtPoŞIndiÿtÜ
) {

293 
	`TRACE
Ğ
TRACE_ALWAYS
, "%.0f%%\n", ()(100*
wÜdËn
)/()
TEXT_POOL_SIZE
);

294 
txtPoŞIndiÿtÜ
 +ğ
TEXT_POOL_PROGRESS
;

297 
s_Ën
 = 
	`txt_£Á’û
(
£Á’û
, 5);

298 iàĞ
s_Ën
 < 0) {

299 
	`INTERNAL_ERROR
("Bad sentence formation");

302 
Ãeded
 = 
TEXT_POOL_SIZE
 - 
wÜdËn
;

303 ià(
Ãeded
 >ğ(
s_Ën
 + 1)) {

304 
	`¡rıy
(
ı
, 
£Á’û
);

305 
ı
 +ğ
s_Ën
;

306 
wÜdËn
 +ğ
s_Ën
 + 1;

307 *(
ı
++) = ' ';

310 
£Á’û
[
Ãeded
] = '\0';

311 
	`¡rıy
(
ı
, 
£Á’û
);

312 
wÜdËn
 +ğ
Ãeded
;

313 
ı
 +ğ
Ãeded
;

317 *
ı
 = '\0';

318 
bIn™
 = 1;

321 
	`RANDOM
(
hgOff£t
, 0, 
TEXT_POOL_SIZE
 - 
max
, 
sd
);

322 
	`RANDOM
(
hgL’gth
, 
mš
, 
max
, 
sd
);

323 
	`¡ºıy
(&
tgt
[0], &
szTextPoŞ
[
hgOff£t
], ()
hgL’gth
);

324 
tgt
[
hgL’gth
] = '\0';

327 
	}
}

331 
EXIT_NAMESPACE
(
dbg’ch
);

335 #ifdeà
TEXT_TEST


336 
tdef
 
	gtdefs
[1] = { 
NULL
 };

337 
di¡ributiÚ
 
	gnouns
,

338 
	gv”bs
,

339 
	gadjeùives
,

340 
	gadv”bs
,

341 
	gauxÏr›s
,

342 
	g‹rmš©Üs
,

343 
	g¬tişes
,

344 
	g´•os™iÚs
,

345 
	gg¿mm¬
,

346 
	gÅ
,

347 
	gvp
;

349 
	$maš
()

351 
´©e
[401];

353 
v”bo£
 = 1;

355 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "nouns", &
nouns
);

356 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "v”bs", &
v”bs
);

357 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "adjeùives", &
adjeùives
);

358 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "adv”bs", &
adv”bs
);

359 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "auxÏr›s", &
auxÏr›s
);

360 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "‹rmš©Üs", &
‹rmš©Üs
);

361 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "¬tişes", &
¬tişes
);

362 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "´•os™iÚs", &
´•os™iÚs
);

363 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "g¿mm¬", &
g¿mm¬
);

364 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "Å", &
Å
);

365 
	`»ad_di¡
 (
	`’v_cÚfig
 (
DIST_TAG
, 
DIST_DFLT
), "vp", &
vp
);

369 
	`dbg_‹xt
(&
´©e
[0], 300, 400, 0);

370 
	`´štf
("<%s>\n", 
´©e
);

374 
	}
}

	@src/workload/tpch/qpipe/qpipe_q1.cpp

32 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

33 
	~"qpe.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
usšg
 
Çme¥aû
 
	gqpe
;

40 
ENTER_NAMESPACE
(
ch
);

50 
	sq1_´ojeùed_lše™em_tu¶e
 {

51 
decim®
 
	mL_QUANTITY
;

52 
decim®
 
	mL_EXTENDEDPRICE
;

53 
decim®
 
	mL_DISCOUNT
;

54 
decim®
 
	mL_TAX
;

55 
	mL_RETURNFLAG
;

56 
	mL_LINESTATUS
;

61 
	sq1_agg»g©e_tu¶e
 {

62 
decim®
 
	mL_SUM_QTY
;

63 
decim®
 
	mL_SUM_BASE_PRICE
;

64 
decim®
 
	mL_SUM_DISC_PRICE
;

65 
decim®
 
	mL_SUM_CHARGE
;

66 
decim®
 
	mL_AVG_QTY
;

67 
decim®
 
	mL_AVG_PRICE
;

68 
decim®
 
	mL_AVG_DISC
;

69 
decim®
 
	mL_COUNT_ORDER
;

70 
	mL_RETURNFLAG
 ;

71 
	mL_LINESTATUS
;

77 şas 
	cq1_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


79 
´iv©e
:

80 
ShÜeTPCHEnv
* 
_chdb
;

81 
bË_row_t
* 
	m_´lše
;

82 
»p_row_t
 
	m_¼
;

84 
ch_lše™em_tu¶e
 
	m_lše™em
;

85 
time_t
 
	m_shd©e
;

91 
q1_šput_t
* 
	mq1_šput
;

92 
	mpublic
:

94 
	$q1_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q1_šput_t
 &
š
)

95 : 
	`tu¶e_f‹r_t
(
chdb
->
	`lše™em_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

100 
_´lše
 = 
_chdb
->
	`lše™em_mª
()->
	`g‘_tu¶e
();

101 
_¼
.
	`£t_ts
(
_chdb
->
	`lše™em_mª
()->
	`ts
(),

102 
_chdb
->
	`lše™em_desc
()->
	`maxsize
());

103 
_´lše
->
_»p
 = &
_¼
;

108 
q1_šput
=&
š
;

110 
d©e
[15];

111 
	`tim‘_to_¡r
(
d©e
,
q1_šput
->
l_shd©e
);

112 
	`TRACE
 (
TRACE_ALWAYS
,"Rªdom…»diÿ‹s: %s\n", 
d©e
);

115 
vœtu®
 ~
	$q1_tsÿn_f‹r_t
()

118 
_chdb
->
	`lše™em_mª
()->
	`give_tu¶e
(
_´lše
);

119 
	}
}

123 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

126 ià(!
_chdb
->
	`lše™em_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

127 
	`as£¹
(
çl£
);

131 
_´lše
->
	`g‘_v®ue
(10, 
_lše™em
.
L_SHIPDATE
, 15);

132 
_shd©e
 = 
	`¡r_to_tim‘
(
_lše™em
.
L_SHIPDATE
);

135 iàĞ
_shd©e
 <ğ
q1_šput
->
l_shd©e
 ) {

137  (
Œue
);

141  (
çl£
);

143 
	}
}

147 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

149 
q1_´ojeùed_lše™em_tu¶e
 *
de¡
;

150 
de¡
 = 
®igÃd_ÿ¡
<
q1_´ojeùed_lše™em_tu¶e
>(
d
.
d©a
);

152 
_´lše
->
	`g‘_v®ue
(4, 
_lše™em
.
L_QUANTITY
);

153 
_´lše
->
	`g‘_v®ue
(5, 
_lše™em
.
L_EXTENDEDPRICE
);

154 
_´lše
->
	`g‘_v®ue
(6, 
_lše™em
.
L_DISCOUNT
);

155 
_´lše
->
	`g‘_v®ue
(7, 
_lše™em
.
L_TAX
);

156 
_´lše
->
	`g‘_v®ue
(8, 
_lše™em
.
L_RETURNFLAG
);

157 
_´lše
->
	`g‘_v®ue
(9, 
_lše™em
.
L_LINESTATUS
);

167 
de¡
->
L_QUANTITY
 = 
_lše™em
.L_QUANTITY;

168 
de¡
->
L_EXTENDEDPRICE
 = 
_lše™em
.L_EXTENDEDPRICE / 100.0;

169 
de¡
->
L_DISCOUNT
 = 
_lše™em
.L_DISCOUNT / 100.0;

170 
de¡
->
L_TAX
 = 
_lše™em
.L_TAX / 100.0;

171 
de¡
->
L_RETURNFLAG
 = 
_lše™em
.L_RETURNFLAG;

172 
de¡
->
L_LINESTATUS
 = 
_lše™em
.L_LINESTATUS;

174 
	}
}

176 
q1_tsÿn_f‹r_t
* 
	$şÚe
() const {

177  
Ãw
 
	`q1_tsÿn_f‹r_t
(*
this
);

178 
	}
}

180 
c_¡r
 
	$to_¡ršg
() const {

181 
d©e
[15];

182 
	`tim‘_to_¡r
(
d©e
,
q1_šput
->
l_shd©e
);

183  
	`c_¡r
("q1_tsÿn_f‹r_t(%s)",
d©e
);

184 
	}
}

190 
	gq1_key_exŒaù_t
 : 
public
 
key_exŒaùÜ_t


192 
q1_key_exŒaù_t
()

193 : 
key_exŒaùÜ_t
(()*2, 
off£tof
(
q1_´ojeùed_lše™em_tu¶e
, 
L_RETURNFLAG
))

195 
as£¹
(() == 1);

198 
exŒaù_hšt
(cÚ¡ * 
key_d©a
) const {

200 *
	gkey
;

201 
	gkey
 = 
®igÃd_ÿ¡
<>(
key_d©a
);

203 
	g»suÉ
 = (*
key
 << 8) + *(key + ());

205  
	g»suÉ
;

208 
q1_key_exŒaù_t
* 
şÚe
() const {

209  
Ãw
 
q1_key_exŒaù_t
(*
this
);

216 şas 
	cq1_couÁ_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t


218 
´iv©e
:

219 
q1_key_exŒaù_t
 
_exŒaùÜ
;

221 
	mpublic
:

223 
	$q1_couÁ_agg»g©e_t
()

224 : 
	`tu¶e_agg»g©e_t
((
q1_agg»g©e_tu¶e
))

228 
key_exŒaùÜ_t
* 
	$key_exŒaùÜ
(è{  &
_exŒaùÜ
; 
	}
}

230 
	$agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
s
) {

231 
q1_´ojeùed_lše™em_tu¶e
 *
¤c
;

232 
¤c
 = 
®igÃd_ÿ¡
<
q1_´ojeùed_lše™em_tu¶e
>(
s
.
d©a
);

233 
q1_agg»g©e_tu¶e
* 
tu¶e
 = 
®igÃd_ÿ¡
<q1_agg»g©e_tu¶e>(
agg_d©a
);

236 
decim®
 
L_EXTENDEDPRICE
 = 
¤c
->L_EXTENDEDPRICE;

237 
decim®
 
L_DISCOUNT
 = 
¤c
->L_DISCOUNT;

238 
decim®
 
L_QUANTITY
 = 
¤c
->L_QUANTITY;

239 
decim®
 
L_DISC_PRICE
 = 
L_EXTENDEDPRICE
 * (1 - 
L_DISCOUNT
);

242 
tu¶e
->
L_COUNT_ORDER
++;

245 
tu¶e
->
L_SUM_QTY
 +ğ
L_QUANTITY
;

246 
tu¶e
->
L_SUM_BASE_PRICE
 +ğ
L_EXTENDEDPRICE
;

247 
tu¶e
->
L_SUM_DISC_PRICE
 +ğ
L_DISC_PRICE
;

248 
tu¶e
->
L_SUM_CHARGE
 +ğ
L_DISC_PRICE
 * (1 + 
¤c
->
L_TAX
);

249 
tu¶e
->
L_AVG_QTY
 +ğ
L_QUANTITY
;

250 
tu¶e
->
L_AVG_PRICE
 +ğ
L_EXTENDEDPRICE
;

251 
tu¶e
->
L_AVG_DISC
 +ğ
L_DISCOUNT
;

252 
tu¶e
->
L_RETURNFLAG
 = 
¤c
->L_RETURNFLAG;

253 
tu¶e
->
L_LINESTATUS
 = 
¤c
->L_LINESTATUS;

255 cÚ¡ 
ušt
 
OUTPUT_RATE
 = 10;

256 ià((
tu¶e
->
L_COUNT_ORDER
).
	`to_št
(è% 
OUTPUT_RATE
 == 0) {

258 
	`fæush
(
¡dout
);

260 
	}
}

262 
	$fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

263 
q1_agg»g©e_tu¶e
 *
de¡
;

264 
de¡
 = 
®igÃd_ÿ¡
<
q1_agg»g©e_tu¶e
>(
d
.
d©a
);

265 
q1_agg»g©e_tu¶e
* 
tu¶e
 = 
®igÃd_ÿ¡
<q1_agg»g©e_tu¶e>(
agg_d©a
);

267 *
de¡
 = *
tu¶e
;

269 
de¡
->
L_AVG_QTY
 /ğde¡->
L_COUNT_ORDER
;

270 
de¡
->
L_AVG_PRICE
 /ğde¡->
L_COUNT_ORDER
;

271 
de¡
->
L_AVG_DISC
 /ğde¡->
L_COUNT_ORDER
;

272 
	}
}

274 
q1_couÁ_agg»g©e_t
* 
	$şÚe
() const {

275  
Ãw
 
	`q1_couÁ_agg»g©e_t
(*
this
);

276 
	}
}

278 
c_¡r
 
	$to_¡ršg
() const {

280 
	}
}

284 şas 
	cch_q1_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


286 
public
:

288 
	$begš
() {

289 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q1 ANSWER ...\n");

290 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** L_RETURNFLAG\tL_LINESTATUS\tSUM_QTY\tSUM_BASE_PRICE\tSUM_DISC_PRICE\tSUM_CHARGE\tAVG_QTY\tAVG_PRICE\tAVG_DISC\tCOUNT_ORDER\n");

293 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

294 
q1_agg»g©e_tu¶e
 *
tu¶e
;

295 
tu¶e
 = 
®igÃd_ÿ¡
<
q1_agg»g©e_tu¶e
>(
ouut
.
d©a
);

296 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** %c\t%c\t%.4f\t%.4f\t%.4f\t%.4f\t%.4f\t%.4f\t%.4f\t%.4f\n",

297 
tu¶e
->
L_RETURNFLAG
,

298 
tu¶e
->
L_LINESTATUS
,

299 
tu¶e
->
L_SUM_QTY
.
	`to_doubË
(),

300 
tu¶e
->
L_SUM_BASE_PRICE
.
	`to_doubË
(),

301 
tu¶e
->
L_SUM_DISC_PRICE
.
	`to_doubË
(),

302 
tu¶e
->
L_SUM_CHARGE
.
	`to_doubË
(),

303 
tu¶e
->
L_AVG_QTY
.
	`to_doubË
(),

304 
tu¶e
->
L_AVG_PRICE
.
	`to_doubË
(),

305 
tu¶e
->
L_AVG_DISC
.
	`to_doubË
(),

306 
tu¶e
->
L_COUNT_ORDER
.
	`to_doubË
());

307 
	}
}

318 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_q1
(cÚ¡ 
xù_id
,

319 
q1_šput_t
& 
š
)

321 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** Q1 *********\n");

349 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

350 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

354 
tu¶e_fifo
* 
tsÿn_out_bufãr
 =

355 
Ãw
 
	`tu¶e_fifo
((
q1_´ojeùed_lše™em_tu¶e
));

356 
tsÿn_·ck‘_t
* 
q1_tsÿn_·ck‘
 =

357 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN LINEITEM",

358 
tsÿn_out_bufãr
,

359 
Ãw
 
	`q1_tsÿn_f‹r_t
(
this
,
š
),

360 
this
->
	`db
(),

361 
_¶še™em_desc
.
	`g‘
(),

362 
pxù


368 
tu¶e_fifo
* 
agg_ouut_bufãr
 =

369 
Ãw
 
	`tu¶e_fifo
((
q1_agg»g©e_tu¶e
));

370 
·ck‘_t
* 
q1_agg_·ck‘
 =

371 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("AGG Q1",

372 
agg_ouut_bufãr
,

373 
Ãw
 
	`ŒivŸl_f‹r_t
(
agg_ouut_bufãr
->
	`tu¶e_size
()),

374 
q1_tsÿn_·ck‘
,

375 
Ãw
 
	`q1_couÁ_agg»g©e_t
(),

376 
Ãw
 
	`q1_key_exŒaù_t
(),

377 
Ãw
 
	`št_key_com·»_t
());

379 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

380 
q1_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

381 
q1_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

384 
ch_q1_´oûss_tu¶e_t
 
±
;

385 
	`´oûss_qu”y
(
q1_agg_·ck‘
, 
±
);

386 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

388  (
RCOK
);

389 
	}
}

392 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/qpipe/qpipe_q10.cpp

33 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

34 
	~"wÜklßd/ch/ch_ut.h
"

35 
	~"qpe.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
usšg
 
Çme¥aû
 
	gqpe
;

42 
ENTER_NAMESPACE
(
ch
);

86 
	sq10_´ojeùed_lše™em_tu¶e
 {

87 
	mL_ORDERKEY
;

88 
decim®
 
	mREVENUE
;

91 
	sq10_´ojeùed_Üd”s_tu¶e
 {

92 
	mO_ORDERKEY
;

93 
	mO_CUSTKEY
;

96 
	sq10_´ojeùed_cu¡om”_tu¶e
 {

97 
	mC_CUSTKEY
;

98 
	mC_NATIONKEY
;

99 
	mC_NAME
[
STRSIZE
(25)];

100 
decim®
 
	mC_ACCTBAL
;

101 
	mC_ADDRESS
[
STRSIZE
(40)];

102 
	mC_PHONE
[
STRSIZE
(15)];

103 
	mC_COMMENT
[
STRSIZE
(117)];

106 
	sq10_´ojeùed_ÇtiÚ_tu¶e
 {

107 
	mN_NATIONKEY
;

108 
	mN_NAME
[
STRSIZE
(25)];

111 
	sq10_l_još_o_tu¶e
 {

112 
	mO_CUSTKEY
;

113 
decim®
 
	mREVENUE
;

116 
	sq10_c_još_l_o_tu¶e
 {

117 
	mC_CUSTKEY
;

118 
	mC_NATIONKEY
;

119 
	mC_NAME
[
STRSIZE
(25)];

120 
decim®
 
	mC_ACCTBAL
;

121 
	mC_ADDRESS
[
STRSIZE
(40)];

122 
	mC_PHONE
[
STRSIZE
(15)];

123 
	mC_COMMENT
[
STRSIZE
(117)];

124 
decim®
 
	mREVENUE
;

127 
	sq10_fš®_tu¶e
 {

128 
	mC_CUSTKEY
;

129 
	mC_NAME
[
STRSIZE
(25)];

130 
decim®
 
	mC_ACCTBAL
;

131 
	mC_PHONE
[
STRSIZE
(15)];

132 
	mN_NAME
[
STRSIZE
(25)];

133 
	mC_ADDRESS
[
STRSIZE
(40)];

134 
	mC_COMMENT
[
STRSIZE
(117)];

135 
decim®
 
	mREVENUE
;

139 şas 
	cq10_lše™em_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


141 
´iv©e
:

142 
ShÜeTPCHEnv
* 
_chdb
;

143 
bË_row_t
* 
	m_´lše
;

144 
»p_row_t
 
	m_¼
;

146 
ch_lše™em_tu¶e
 
	m_lše™em
;

148 
	mpublic
:

149 
	$q10_lše™em_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q10_šput_t
 &
š
)

150 : 
	`tu¶e_f‹r_t
(
chdb
->
	`lše™em_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

152 
_´lše
 = 
_chdb
->
	`lše™em_mª
()->
	`g‘_tu¶e
();

153 
_¼
.
	`£t_ts
(
_chdb
->
	`lše™em_mª
()->
	`ts
(),

154 
_chdb
->
	`lše™em_desc
()->
	`maxsize
());

155 
_´lše
->
_»p
 = &
_¼
;

158 
vœtu®
 ~
	$q10_lše™em_tsÿn_f‹r_t
()

161 
_chdb
->
	`lše™em_mª
()->
	`give_tu¶e
(
_´lše
);

162 
	}
}

164 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

166 ià(!
_chdb
->
	`lše™em_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

167 
	`as£¹
(
çl£
);

170 
_´lše
->
	`g‘_v®ue
(8, 
_lše™em
.
L_RETURNFLAG
);

172  
_lše™em
.
L_RETURNFLAG
 == 'R';

173 
	}
}

175 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

177 
q10_´ojeùed_lše™em_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q10_´ojeùed_lše™em_tu¶e>(
d
.
d©a
);

179 
_´lše
->
	`g‘_v®ue
(0, 
_lše™em
.
L_ORDERKEY
);

180 
_´lše
->
	`g‘_v®ue
(5, 
_lše™em
.
L_EXTENDEDPRICE
);

181 
_´lše
->
	`g‘_v®ue
(6, 
_lše™em
.
L_DISCOUNT
);

185 
de¡
->
L_ORDERKEY
 = 
_lše™em
.L_ORDERKEY;

186 
de¡
->
REVENUE
 = 
_lše™em
.
L_EXTENDEDPRICE
 / 100.0 * (1 - _lše™em.
L_DISCOUNT
 / 100.0);

187 #w¬nšg 
MA
: 
DiscouÁ
 
äom
 
TPCH
 
dbg’
 
is
 
ü—‹d
 
b‘w“n
 0 
ªd
 100 
š¡—d
 between 0‡nd 1.

188 
	}
}

190 
q10_lše™em_tsÿn_f‹r_t
* 
	$şÚe
() const {

191  
Ãw
 
	`q10_lše™em_tsÿn_f‹r_t
(*
this
);

192 
	}
}

194 
c_¡r
 
	$to_¡ršg
() const {

195  
	`c_¡r
("q10_lineitem_tscan_filter_t()");

196 
	}
}

199 şas 
	cq10_Üd”s_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


201 
´iv©e
:

202 
ShÜeTPCHEnv
* 
_chdb
;

203 
bË_row_t
* 
	m_´Üd”s
;

204 
»p_row_t
 
	m_¼
;

206 
ch_Üd”s_tu¶e
 
	m_Üd”s
;

207 
time_t
 
	m_Üd”d©e
;

209 
time_t
 
	m_fœ¡_Üd”d©e
;

210 
time_t
 
	m_Ï¡_Üd”d©e
;

212 
	mpublic
:

213 
	$q10_Üd”s_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q10_šput_t
 &
š
)

214 : 
	`tu¶e_f‹r_t
(
chdb
->
	`Üd”s_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

216 
_´Üd”s
 = 
_chdb
->
	`Üd”s_mª
()->
	`g‘_tu¶e
();

217 
_¼
.
	`£t_ts
(
_chdb
->
	`Üd”s_mª
()->
	`ts
(),

218 
_chdb
->
	`Üd”s_desc
()->
	`maxsize
());

219 
_´Üd”s
->
_»p
 = &
_¼
;

221 
_fœ¡_Üd”d©e
 = (&
š
)->
o_Üd”d©e
;

222 
tm
 *tm = 
	`gmtime
(&
_fœ¡_Üd”d©e
);

223 
tm
->
tm_mÚ
 += 3;

224 
_Ï¡_Üd”d©e
 = 
	`mktime
(
tm
);

226 
f_Üd”d©e
[
	`STRSIZE
(10)];

227 
l_Üd”d©e
[
	`STRSIZE
(10)];

228 
	`tim‘_to_¡r
(
f_Üd”d©e
, 
_fœ¡_Üd”d©e
);

229 
	`tim‘_to_¡r
(
l_Üd”d©e
, 
_Ï¡_Üd”d©e
);

231 
	`TRACE
(
TRACE_ALWAYS
, "Rªdom…»diÿ‹:\nO_ORDERDATE b‘w“À[%s, %s[\n", 
f_Üd”d©e
, 
l_Üd”d©e
);

234 
vœtu®
 ~
	$q10_Üd”s_tsÿn_f‹r_t
()

237 
_chdb
->
	`Üd”s_mª
()->
	`give_tu¶e
(
_´Üd”s
);

238 
	}
}

240 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

242 ià(!
_chdb
->
	`Üd”s_mª
()->
	`lßd
(
_´Üd”s
, 
šput
.
d©a
)) {

243 
	`as£¹
(
çl£
);

246 
_´Üd”s
->
	`g‘_v®ue
(4, 
_Üd”s
.
O_ORDERDATE
, (_orders.O_ORDERDATE));

247 
_Üd”d©e
 = 
	`¡r_to_tim‘
(
_Üd”s
.
O_ORDERDATE
);

249  
_Üd”d©e
 >ğ
_fœ¡_Üd”d©e
 && _Üd”d©< 
_Ï¡_Üd”d©e
;

250 
	}
}

252 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

254 
q10_´ojeùed_Üd”s_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q10_´ojeùed_Üd”s_tu¶e>(
d
.
d©a
);

256 
_´Üd”s
->
	`g‘_v®ue
(0, 
_Üd”s
.
O_ORDERKEY
);

257 
_´Üd”s
->
	`g‘_v®ue
(1, 
_Üd”s
.
O_CUSTKEY
);

261 
de¡
->
O_ORDERKEY
 = 
_Üd”s
.O_ORDERKEY;

262 
de¡
->
O_CUSTKEY
 = 
_Üd”s
.O_CUSTKEY;

263 
	}
}

265 
q10_Üd”s_tsÿn_f‹r_t
* 
	$şÚe
() const {

266  
Ãw
 
	`q10_Üd”s_tsÿn_f‹r_t
(*
this
);

267 
	}
}

269 
c_¡r
 
	$to_¡ršg
() const {

270 
f_Üd”d©e
[
	`STRSIZE
(10)];

271 
l_Üd”d©e
[
	`STRSIZE
(10)];

272 
	`tim‘_to_¡r
(
f_Üd”d©e
, 
_fœ¡_Üd”d©e
);

273 
	`tim‘_to_¡r
(
l_Üd”d©e
, 
_Ï¡_Üd”d©e
);

274  
	`c_¡r
("q10_Üd”s_tsÿn_f‹r_t(O_ORDERDATE b‘w“À[%s, %s[)", 
f_Üd”d©e
, 
l_Üd”d©e
);

275 
	}
}

278 şas 
	cq10_cu¡om”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


280 
´iv©e
:

281 
ShÜeTPCHEnv
* 
_chdb
;

282 
bË_row_t
* 
	m_´cu¡
;

283 
»p_row_t
 
	m_¼
;

285 
ch_cu¡om”_tu¶e
 
	m_cu¡om”
;

287 
	mpublic
:

288 
	$q10_cu¡om”_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q10_šput_t
 &
š
)

289 : 
	`tu¶e_f‹r_t
(
chdb
->
	`cu¡om”_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

291 
_´cu¡
 = 
_chdb
->
	`cu¡om”_mª
()->
	`g‘_tu¶e
();

292 
_¼
.
	`£t_ts
(
_chdb
->
	`cu¡om”_mª
()->
	`ts
(),

293 
_chdb
->
	`cu¡om”_desc
()->
	`maxsize
());

294 
_´cu¡
->
_»p
 = &
_¼
;

297 
vœtu®
 ~
	$q10_cu¡om”_tsÿn_f‹r_t
()

300 
_chdb
->
	`cu¡om”_mª
()->
	`give_tu¶e
(
_´cu¡
);

301 
	}
}

303 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

305 ià(!
_chdb
->
	`cu¡om”_mª
()->
	`lßd
(
_´cu¡
, 
šput
.
d©a
)) {

306 
	`as£¹
(
çl£
);

309  
Œue
;

310 
	}
}

312 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

314 
q10_´ojeùed_cu¡om”_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q10_´ojeùed_cu¡om”_tu¶e>(
d
.
d©a
);

316 
_´cu¡
->
	`g‘_v®ue
(0, 
_cu¡om”
.
C_CUSTKEY
);

317 
_´cu¡
->
	`g‘_v®ue
(1, 
_cu¡om”
.
C_NAME
, (_customer.C_NAME));

318 
_´cu¡
->
	`g‘_v®ue
(2, 
_cu¡om”
.
C_ADDRESS
, (_customer.C_ADDRESS));

319 
_´cu¡
->
	`g‘_v®ue
(3, 
_cu¡om”
.
C_NATIONKEY
);

320 
_´cu¡
->
	`g‘_v®ue
(4, 
_cu¡om”
.
C_PHONE
, (_customer.C_PHONE));

321 
_´cu¡
->
	`g‘_v®ue
(5, 
_cu¡om”
.
C_ACCTBAL
);

322 
_´cu¡
->
	`g‘_v®ue
(7, 
_cu¡om”
.
C_COMMENT
, (_customer.C_COMMENT));

327 
de¡
->
C_CUSTKEY
 = 
_cu¡om”
.C_CUSTKEY;

328 
	`memıy
(
de¡
->
C_NAME
, 
_cu¡om”
.C_NAME, (dest->C_NAME));

329 
	`memıy
(
de¡
->
C_ADDRESS
, 
_cu¡om”
.C_ADDRESS, (dest->C_ADDRESS));

330 
de¡
->
C_NATIONKEY
 = 
_cu¡om”
.C_NATIONKEY;

331 
	`memıy
(
de¡
->
C_PHONE
, 
_cu¡om”
.C_PHONE, (dest->C_PHONE));

332 
de¡
->
C_ACCTBAL
 = 
_cu¡om”
.C_ACCTBAL;

333 
	`memıy
(
de¡
->
C_COMMENT
, 
_cu¡om”
.C_COMMENT, (dest->C_COMMENT));

334 
	}
}

336 
q10_cu¡om”_tsÿn_f‹r_t
* 
	$şÚe
() const {

337  
Ãw
 
	`q10_cu¡om”_tsÿn_f‹r_t
(*
this
);

338 
	}
}

340 
c_¡r
 
	$to_¡ršg
() const {

341  
	`c_¡r
("q10_customer_tscan_filter_t");

342 
	}
}

345 şas 
	cq10_ÇtiÚ_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


347 
´iv©e
:

348 
ShÜeTPCHEnv
* 
_chdb
;

349 
bË_row_t
* 
	m_´ÇtiÚ
;

350 
»p_row_t
 
	m_¼
;

353 
ch_ÇtiÚ_tu¶e
 
	m_ÇtiÚ
;

355 
	mpublic
:

356 
	$q10_ÇtiÚ_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q10_šput_t
 &
š
)

357 : 
	`tu¶e_f‹r_t
(
chdb
->
	`ÇtiÚ_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

359 
_´ÇtiÚ
 = 
_chdb
->
	`ÇtiÚ_mª
()->
	`g‘_tu¶e
();

360 
_¼
.
	`£t_ts
(
_chdb
->
	`ÇtiÚ_mª
()->
	`ts
(),

361 
_chdb
->
	`ÇtiÚ_desc
()->
	`maxsize
());

362 
_´ÇtiÚ
->
_»p
 = &
_¼
;

365 
vœtu®
 ~
	$q10_ÇtiÚ_tsÿn_f‹r_t
()

367 
_chdb
->
	`ÇtiÚ_mª
()->
	`give_tu¶e
(
_´ÇtiÚ
);

368 
	}
}

370 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

373 ià(!
_chdb
->
	`ÇtiÚ_mª
()->
	`lßd
(
_´ÇtiÚ
, 
šput
.
d©a
)) {

374 
	`as£¹
(
çl£
);

377  
Œue
;

378 
	}
}

381 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

383 
q10_´ojeùed_ÇtiÚ_tu¶e
 *
de¡
;

384 
de¡
 = 
®igÃd_ÿ¡
<
q10_´ojeùed_ÇtiÚ_tu¶e
>(
d
.
d©a
);

386 
_´ÇtiÚ
->
	`g‘_v®ue
(0, 
_ÇtiÚ
.
N_NATIONKEY
);

387 
_´ÇtiÚ
->
	`g‘_v®ue
(1, 
_ÇtiÚ
.
N_NAME
, (_nation.N_NAME));

392 
de¡
->
N_NATIONKEY
 = 
_ÇtiÚ
.N_NATIONKEY;

393 
	`memıy
(
de¡
->
N_NAME
, 
_ÇtiÚ
.N_NAME, (dest->N_NAME));

394 
	}
}

396 
q10_ÇtiÚ_tsÿn_f‹r_t
* 
	$şÚe
() const {

397  
Ãw
 
	`q10_ÇtiÚ_tsÿn_f‹r_t
(*
this
);

398 
	}
}

400 
c_¡r
 
	$to_¡ršg
() const {

401  
	`c_¡r
("q10_nation_tscan_filter_t()");

402 
	}
}

406 
	gq10_l_još_o_t
 : 
public
 
tu¶e_još_t
 {

408 
q10_l_još_o_t
()

409 : 
tu¶e_još_t
((
q10_´ojeùed_lše™em_tu¶e
),

410 
off£tof
(
q10_´ojeùed_lše™em_tu¶e
, 
L_ORDERKEY
),

411 (
q10_´ojeùed_Üd”s_tu¶e
),

412 
off£tof
(
q10_´ojeùed_Üd”s_tu¶e
, 
O_ORDERKEY
),

414 (
q10_l_još_o_tu¶e
))

418 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

419 
q10_l_još_o_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q10_l_još_o_tu¶e>(
d
.
d©a
);

420 
q10_´ojeùed_lše™em_tu¶e
 *
	glše
 = 
®igÃd_ÿ¡
<q10_´ojeùed_lše™em_tu¶e>(
l
.
d©a
);

421 
q10_´ojeùed_Üd”s_tu¶e
 *
	gÜd”
 = 
®igÃd_ÿ¡
<q10_´ojeùed_Üd”s_tu¶e>(
r
.
d©a
);

423 
	gde¡
->
	gO_CUSTKEY
 = 
Üd”
->
O_CUSTKEY
;

424 
	gde¡
->
	gREVENUE
 = 
lše
->
REVENUE
;

429 
vœtu®
 
q10_l_još_o_t
* 
şÚe
() const {

430  
Ãw
 
q10_l_još_o_t
(*
this
);

433 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

434  
c_¡r
("join LINEITEM, ORDERS; select O_CUSTKEY, REVENUE");

438 
	gq10_c_još_l_o_t
 : 
public
 
tu¶e_još_t
 {

440 
q10_c_još_l_o_t
()

441 : 
tu¶e_još_t
((
q10_´ojeùed_cu¡om”_tu¶e
),

442 
off£tof
(
q10_´ojeùed_cu¡om”_tu¶e
, 
C_CUSTKEY
),

443 (
q10_l_još_o_tu¶e
),

444 
off£tof
(
q10_l_još_o_tu¶e
, 
O_CUSTKEY
),

446 (
q10_c_još_l_o_tu¶e
))

450 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

451 
q10_c_još_l_o_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q10_c_još_l_o_tu¶e>(
d
.
d©a
);

452 
q10_´ojeùed_cu¡om”_tu¶e
 *
	gcu¡
 = 
®igÃd_ÿ¡
<q10_´ojeùed_cu¡om”_tu¶e>(
l
.
d©a
);

453 
q10_l_još_o_tu¶e
 *
	gright
 = 
®igÃd_ÿ¡
<q10_l_još_o_tu¶e>(
r
.
d©a
);

455 
	gde¡
->
	gC_ACCTBAL
 = 
cu¡
->
C_ACCTBAL
;

456 
memıy
(
de¡
->
C_ADDRESS
, 
cu¡
->C_ADDRESS, (dest->C_ADDRESS));

457 
memıy
(
de¡
->
C_COMMENT
, 
cu¡
->C_COMMENT, (dest->C_COMMENT));

458 
	gde¡
->
	gC_CUSTKEY
 = 
cu¡
->
C_CUSTKEY
;

459 
memıy
(
de¡
->
C_NAME
, 
cu¡
->C_NAME, (dest->C_NAME));

460 
	gde¡
->
	gC_NATIONKEY
 = 
cu¡
->
C_NATIONKEY
;

461 
memıy
(
de¡
->
C_PHONE
, 
cu¡
->C_PHONE, (dest->C_PHONE));

462 
	gde¡
->
	gREVENUE
 = 
right
->
REVENUE
;

468 
vœtu®
 
q10_c_još_l_o_t
* 
şÚe
() const {

469  
Ãw
 
q10_c_još_l_o_t
(*
this
);

472 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

473  
c_¡r
("join CUSTOMER, LINEITEM_ORDERS; select C_ACCTBAL, C_ADDRESS, C_COMMENT, C_CUSTKEY, C_NAME, C_NATIONKEY, C_PHONE, REVENUE");

477 
	gq10_fš®_još_t
 : 
public
 
tu¶e_još_t
 {

479 
q10_fš®_još_t
()

480 : 
tu¶e_još_t
((
q10_´ojeùed_ÇtiÚ_tu¶e
),

481 
off£tof
(
q10_´ojeùed_ÇtiÚ_tu¶e
, 
N_NATIONKEY
),

482 (
q10_c_još_l_o_tu¶e
),

483 
off£tof
(
q10_c_još_l_o_tu¶e
, 
C_NATIONKEY
),

485 (
q10_fš®_tu¶e
))

489 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

490 
q10_fš®_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q10_fš®_tu¶e>(
d
.
d©a
);

491 
q10_´ojeùed_ÇtiÚ_tu¶e
 *
	gÇtiÚ
 = 
®igÃd_ÿ¡
<q10_´ojeùed_ÇtiÚ_tu¶e>(
l
.
d©a
);

492 
q10_c_još_l_o_tu¶e
 *
	gright
 = 
®igÃd_ÿ¡
<q10_c_još_l_o_tu¶e>(
r
.
d©a
);

494 
	gde¡
->
	gC_ACCTBAL
 = 
right
->
C_ACCTBAL
;

495 
memıy
(
de¡
->
C_ADDRESS
, 
right
->C_ADDRESS, (dest->C_ADDRESS));

496 
memıy
(
de¡
->
C_COMMENT
, 
right
->C_COMMENT, (dest->C_COMMENT));

497 
	gde¡
->
	gC_CUSTKEY
 = 
right
->
C_CUSTKEY
;

498 
memıy
(
de¡
->
C_NAME
, 
right
->C_NAME, (dest->C_NAME));

499 
memıy
(
de¡
->
C_PHONE
, 
right
->C_PHONE, (dest->C_PHONE));

500 
memıy
(
de¡
->
N_NAME
, 
ÇtiÚ
->N_NAME, (dest->N_NAME));

501 
	gde¡
->
	gREVENUE
 = 
right
->
REVENUE
;

507 
vœtu®
 
q10_fš®_još_t
* 
şÚe
() const {

508  
Ãw
 
q10_fš®_još_t
(*
this
);

511 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

512  
c_¡r
("join NATION, CUSTOMER_LINEITEM_ORDERS; select C_ACCTBAL, C_ADDRESS, C_COMMENT, C_CUSTKEY, C_NAME, C_PHONE, N_NAME, REVENUE");

516 
	gq10_tİ20_f‹r_t
 : 
public
 
tu¶e_f‹r_t


518 
_couÁ
;

520 
q10_tİ20_f‹r_t
()

521 : 
tu¶e_f‹r_t
((
q10_fš®_tu¶e
)), 
_couÁ
(0)

525 
boŞ
 
£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

526  ++
	g_couÁ
 <= 20;

529 
vœtu®
 
q10_tİ20_f‹r_t
* 
şÚe
() const {

530  
Ãw
 
q10_tİ20_f‹r_t
(*
this
);

533 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

534  
c_¡r
("q10_top20_filter_t");

539 
	gq10_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

541 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

543 
q10_agg»g©e_t
()

544 : 
tu¶e_agg»g©e_t
((
q10_fš®_tu¶e
)), 
_exŒaùÜ
(())

548 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
() {

549  &
	g_exŒaùÜ
;

552 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
t
) {

553 
q10_fš®_tu¶e
 *
	gagg
 = 
®igÃd_ÿ¡
<q10_fš®_tu¶e>(
agg_d©a
);

554 
q10_fš®_tu¶e
 *
	gš
 = 
®igÃd_ÿ¡
<q10_fš®_tu¶e>(
t
.
d©a
);

556 
	gagg
->
	gC_ACCTBAL
 = 
š
->
C_ACCTBAL
;

557 
memıy
(
agg
->
C_ADDRESS
, 
š
->C_ADDRESS, (agg->C_ADDRESS));

558 
memıy
(
agg
->
C_COMMENT
, 
š
->C_COMMENT, (agg->C_COMMENT));

559 
	gagg
->
	gC_CUSTKEY
 = 
š
->
C_CUSTKEY
;

560 
memıy
(
agg
->
C_NAME
, 
š
->C_NAME, (agg->C_NAME));

561 
memıy
(
agg
->
C_PHONE
, 
š
->C_PHONE, (agg->C_PHONE));

562 
memıy
(
agg
->
N_NAME
, 
š
->N_NAME, (agg->N_NAME));

563 
	gagg
->
	gREVENUE
 +ğ
š
->
REVENUE
;

565 
vœtu®
 
fšish
(
tu¶e_t
 &
de¡
, cÚ¡ * 
agg_d©a
) {

566 
memıy
(
de¡
.
d©a
, 
agg_d©a
, de¡.
size
);

568 
vœtu®
 
q10_agg»g©e_t
* 
şÚe
() const {

569  
Ãw
 
q10_agg»g©e_t
(*
this
);

571 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

576 
	gq10_sÜt_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

578 
q10_sÜt_key_exŒaùÜ_t
()

579 : 
key_exŒaùÜ_t
((
decim®
), 
off£tof
(
q10_fš®_tu¶e
, 
REVENUE
))

583 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

584  -(*
	g®igÃd_ÿ¡
<
	gdecim®
>(
	gkey
)).
to_št
();

587 
vœtu®
 
q10_sÜt_key_exŒaùÜ_t
* 
şÚe
() const {

588  
Ãw
 
q10_sÜt_key_exŒaùÜ_t
(*
this
);

592 
	gq10_sÜt_key_com·»_t
 : 
public
 
key_com·»_t
 {

594 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

595 
decim®
 
	g»v1
 = *
®igÃd_ÿ¡
<decim®>(
key1
);

596 
decim®
 
	g»v2
 = *
®igÃd_ÿ¡
<decim®>(
key2
);

597  
	g»v1
 > 
	g»v2
 ? -1 : (
»v1
 < 
»v2
 ? 1 : 0);

600 
vœtu®
 
q10_sÜt_key_com·»_t
* 
şÚe
() const {

601  
Ãw
 
q10_sÜt_key_com·»_t
(*
this
);

607 şas 
	cch_q10_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t
 {

609 
public
:

611 
vœtu®
 
	$begš
() {

612 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q10 %s %s %s %s %s %s %s %s\n",

616 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

617 
q10_fš®_tu¶e
 *
agg
 = 
®igÃd_ÿ¡
<q10_fš®_tu¶e>(
ouut
.
d©a
);

619 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q10 %d % %.2à%.2à% % % %s\n", 
agg
->
C_CUSTKEY
,‡gg->
C_NAME
,‡gg->
REVENUE
.
	`to_doubË
(),‡gg->
C_ACCTBAL
.to_double(),

620 
agg
->
N_NAME
,‡gg->
C_ADDRESS
,‡gg->
C_PHONE
,‡gg->
C_COMMENT
);

621 
	}
}

631 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_q10
(cÚ¡ 
xù_id
,

632 
q10_šput_t
& 
š
)

634 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** q10 *********\n");

636 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

637 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

641 
tu¶e_fifo
* 
q10_Üd”s_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q10_´ojeùed_Üd”s_tu¶e
));

642 
·ck‘_t
* 
q10_Üd”s_tsÿn_·ck‘
 =

643 
Ãw
 
	`tsÿn_·ck‘_t
("orders TSCAN",

644 
q10_Üd”s_bufãr
,

645 
Ãw
 
	`q10_Üd”s_tsÿn_f‹r_t
(
this
, 
š
),

646 
this
->
	`db
(),

647 
_pÜd”s_desc
.
	`g‘
(),

648 
pxù
);

651 
tu¶e_fifo
* 
q10_lše™em_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q10_´ojeùed_lše™em_tu¶e
));

652 
·ck‘_t
* 
q10_lše™em_tsÿn_·ck‘
 =

653 
Ãw
 
	`tsÿn_·ck‘_t
("lineitem TSCAN",

654 
q10_lše™em_bufãr
,

655 
Ãw
 
	`q10_lše™em_tsÿn_f‹r_t
(
this
, 
š
),

656 
this
->
	`db
(),

657 
_¶še™em_desc
.
	`g‘
(),

658 
pxù
);

661 
tu¶e_fifo
* 
q10_cu¡om”_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q10_´ojeùed_cu¡om”_tu¶e
));

662 
·ck‘_t
* 
q10_cu¡om”_tsÿn_·ck‘
 =

663 
Ãw
 
	`tsÿn_·ck‘_t
("customer TSCAN",

664 
q10_cu¡om”_bufãr
,

665 
Ãw
 
	`q10_cu¡om”_tsÿn_f‹r_t
(
this
, 
š
),

666 
this
->
	`db
(),

667 
_pcu¡om”_desc
.
	`g‘
(),

668 
pxù
);

671 
tu¶e_fifo
* 
q10_ÇtiÚ_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q10_´ojeùed_ÇtiÚ_tu¶e
));

672 
·ck‘_t
* 
q10_ÇtiÚ_tsÿn_·ck‘
 =

673 
Ãw
 
	`tsÿn_·ck‘_t
("nation TSCAN",

674 
q10_ÇtiÚ_bufãr
,

675 
Ãw
 
	`q10_ÇtiÚ_tsÿn_f‹r_t
(
this
, 
š
),

676 
this
->
	`db
(),

677 
_²©iÚ_desc
.
	`g‘
(),

678 
pxù
);

682 
tu¶e_fifo
* 
q10_l_još_o_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q10_l_još_o_tu¶e
));

683 
·ck‘_t
* 
q10_l_još_o_·ck‘
 =

684 
Ãw
 
	`hash_još_·ck‘_t
("lineitem - orders HJOIN",

685 
q10_l_još_o_bufãr
,

686 
Ãw
 
	`ŒivŸl_f‹r_t
((
q10_l_još_o_tu¶e
)),

687 
q10_lše™em_tsÿn_·ck‘
,

688 
q10_Üd”s_tsÿn_·ck‘
,

689 
Ãw
 
	`q10_l_još_o_t
());

692 
tu¶e_fifo
* 
q10_c_još_l_o_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q10_c_još_l_o_tu¶e
));

693 
·ck‘_t
* 
q10_c_još_l_o_·ck‘
 =

694 
Ãw
 
	`hash_još_·ck‘_t
("customer -†ineitem_orders HJOIN",

695 
q10_c_još_l_o_bufãr
,

696 
Ãw
 
	`ŒivŸl_f‹r_t
((
q10_c_još_l_o_tu¶e
)),

697 
q10_cu¡om”_tsÿn_·ck‘
,

698 
q10_l_još_o_·ck‘
,

699 
Ãw
 
	`q10_c_još_l_o_t
());

702 
tu¶e_fifo
* 
q10_®l_jošs_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q10_fš®_tu¶e
));

703 
·ck‘_t
* 
q10_®l_jošs_·ck‘
 =

704 
Ãw
 
	`hash_još_·ck‘_t
("nation - customer_lineitem_orders HJOIN",

705 
q10_®l_jošs_bufãr
,

706 
Ãw
 
	`ŒivŸl_f‹r_t
((
q10_fš®_tu¶e
)),

707 
q10_ÇtiÚ_tsÿn_·ck‘
,

708 
q10_c_još_l_o_·ck‘
,

709 
Ãw
 
	`q10_fš®_još_t
());

712 
tu¶e_fifo
* 
q10_agg_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q10_fš®_tu¶e
));

713 
·ck‘_t
* 
q10_agg_·ck‘
 =

714 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("AGGREGATE",

715 
q10_agg_bufãr
,

716 
Ãw
 
	`ŒivŸl_f‹r_t
((
q10_fš®_tu¶e
)),

717 
q10_®l_jošs_·ck‘
,

718 
Ãw
 
	`q10_agg»g©e_t
(),

719 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
((), 
	`off£tof
(
q10_fš®_tu¶e
, 
C_CUSTKEY
)),

720 
Ãw
 
	`št_key_com·»_t
());

723 
tu¶e_fifo
* 
q10_sÜt_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q10_fš®_tu¶e
));

724 
·ck‘_t
* 
q10_sÜt_·ck‘
 =

725 
Ãw
 
	`sÜt_·ck‘_t
("SORT",

726 
q10_sÜt_bufãr
,

727 
Ãw
 
	`q10_tİ20_f‹r_t
(),

728 
Ãw
 
	`q10_sÜt_key_exŒaùÜ_t
(),

729 
Ãw
 
	`q10_sÜt_key_com·»_t
(),

730 
q10_agg_·ck‘
);

733 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

734 
q10_Üd”s_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

735 
q10_lše™em_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

736 
q10_cu¡om”_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

737 
q10_ÇtiÚ_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

738 
q10_l_još_o_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

739 
q10_c_još_l_o_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

740 
q10_®l_jošs_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

741 
q10_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

742 
q10_sÜt_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

746 
ch_q10_´oûss_tu¶e_t
 
±
;

748 
	`´oûss_qu”y
(
q10_sÜt_·ck‘
, 
±
);

750 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

753  (
RCOK
);

754 
	}
}

756 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/qpipe/qpipe_q11.cpp

33 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

34 
	~"wÜklßd/ch/ch_ut.h
"

35 
	~"qpe.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
usšg
 
Çme¥aû
 
	gqpe
;

42 
ENTER_NAMESPACE
(
ch
);

81 
	sq11_´ojeùed_suµl›r_tu¶e
 {

82 
	mS_SUPPKEY
;

83 
	mS_NATIONKEY
;

86 
	sq11_´ojeùed_ÇtiÚ_tu¶e
 {

87 
	mN_NATIONKEY
;

90 
	sq11_´ojeùed_·¹suµ_tu¶e
 {

91 
	mPS_PARTKEY
;

92 
	mPS_SUPPKEY
;

93 
decim®
 
	mVALUE
;

96 
	sq11_s_još_n_tu¶e
 {

97 
	mS_SUPPKEY
;

100 
	sq11_ps_još_s_n_tu¶e
 {

101 
	mPSEUDOKEY
;

102 
	mPS_PARTKEY
;

103 
decim®
 
	mVALUE
;

106 
	sq11_®l_jošs_tu¶e
 {

107 
	mPS_PARTKEY
;

108 
decim®
 
	mVALUE
;

109 
decim®
 
	mTHRESHOLD
;

112 
	sq11_fš®_tu¶e
 {

113 
	mPS_PARTKEY
;

114 
decim®
 
	mVALUE
;

118 şas 
	cq11_suµl›r_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


120 
´iv©e
:

121 
ShÜeTPCHEnv
* 
_chdb
;

122 
bË_row_t
* 
	m_´suµl›r
;

123 
»p_row_t
 
	m_¼
;

126 
ch_suµl›r_tu¶e
 
	m_suµl›r
;

128 
	mpublic
:

129 
	$q11_suµl›r_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q11_šput_t
 &
š
)

130 : 
	`tu¶e_f‹r_t
(
chdb
->
	`suµl›r_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

132 
_´suµl›r
 = 
_chdb
->
	`suµl›r_mª
()->
	`g‘_tu¶e
();

133 
_¼
.
	`£t_ts
(
_chdb
->
	`suµl›r_mª
()->
	`ts
(),

134 
_chdb
->
	`suµl›r_desc
()->
	`maxsize
());

135 
_´suµl›r
->
_»p
 = &
_¼
;

138 
vœtu®
 ~
	$q11_suµl›r_tsÿn_f‹r_t
()

140 
_chdb
->
	`suµl›r_mª
()->
	`give_tu¶e
(
_´suµl›r
);

141 
	}
}

143 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

146 ià(!
_chdb
->
	`suµl›r_mª
()->
	`lßd
(
_´suµl›r
, 
šput
.
d©a
)) {

147 
	`as£¹
(
çl£
);

150  
Œue
;

151 
	}
}

154 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

156 
q11_´ojeùed_suµl›r_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q11_´ojeùed_suµl›r_tu¶e>(
d
.
d©a
);

159 
_´suµl›r
->
	`g‘_v®ue
(0, 
_suµl›r
.
S_SUPPKEY
);

160 
_´suµl›r
->
	`g‘_v®ue
(3, 
_suµl›r
.
S_NATIONKEY
);

165 
de¡
->
S_SUPPKEY
 = 
_suµl›r
.S_SUPPKEY;

166 
de¡
->
S_NATIONKEY
 = 
_suµl›r
.S_NATIONKEY;

168 
	}
}

170 
q11_suµl›r_tsÿn_f‹r_t
* 
	$şÚe
() const {

171  
Ãw
 
	`q11_suµl›r_tsÿn_f‹r_t
(*
this
);

172 
	}
}

174 
c_¡r
 
	$to_¡ršg
() const {

175  
	`c_¡r
("q11_supplier_tscan_filter_t");

176 
	}
}

179 şas 
	cq11_ÇtiÚ_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


181 
´iv©e
:

182 
ShÜeTPCHEnv
* 
_chdb
;

183 
bË_row_t
* 
	m_´ÇtiÚ
;

184 
»p_row_t
 
	m_¼
;

187 
ch_ÇtiÚ_tu¶e
 
	m_ÇtiÚ
;

189 
	m_Çme
[
STRSIZE
(25)];

191 
	mpublic
:

192 
	$q11_ÇtiÚ_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q11_šput_t
 &
š
)

193 : 
	`tu¶e_f‹r_t
(
chdb
->
	`ÇtiÚ_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

195 
_´ÇtiÚ
 = 
_chdb
->
	`ÇtiÚ_mª
()->
	`g‘_tu¶e
();

196 
_¼
.
	`£t_ts
(
_chdb
->
	`ÇtiÚ_mª
()->
	`ts
(),

197 
_chdb
->
	`ÇtiÚ_desc
()->
	`maxsize
());

198 
_´ÇtiÚ
->
_»p
 = &
_¼
;

200 
	`ÇtiÚ_to_¡r
((&
š
)->
n_Çme
, 
_Çme
);

201 
	`TRACE
(
TRACE_ALWAYS
, "Rªdom…»diÿ‹:\nNATION:N_NAME = %s\n", 
_Çme
);

204 
vœtu®
 ~
	$q11_ÇtiÚ_tsÿn_f‹r_t
()

206 
_chdb
->
	`ÇtiÚ_mª
()->
	`give_tu¶e
(
_´ÇtiÚ
);

207 
	}
}

209 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

212 ià(!
_chdb
->
	`ÇtiÚ_mª
()->
	`lßd
(
_´ÇtiÚ
, 
šput
.
d©a
)) {

213 
	`as£¹
(
çl£
);

216 
_´ÇtiÚ
->
	`g‘_v®ue
(1, 
_ÇtiÚ
.
N_NAME
, (_nation.N_NAME));

218  (
	`¡rcmp
(
_ÇtiÚ
.
N_NAME
, 
_Çme
) == 0);

219 
	}
}

222 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

224 
q11_´ojeùed_ÇtiÚ_tu¶e
 *
de¡
;

225 
de¡
 = 
®igÃd_ÿ¡
<
q11_´ojeùed_ÇtiÚ_tu¶e
>(
d
.
d©a
);

227 
_´ÇtiÚ
->
	`g‘_v®ue
(0, 
_ÇtiÚ
.
N_NATIONKEY
);

232 
de¡
->
N_NATIONKEY
 = 
_ÇtiÚ
.N_NATIONKEY;

233 
	}
}

235 
q11_ÇtiÚ_tsÿn_f‹r_t
* 
	$şÚe
() const {

236  
Ãw
 
	`q11_ÇtiÚ_tsÿn_f‹r_t
(*
this
);

237 
	}
}

239 
c_¡r
 
	$to_¡ršg
() const {

240  
	`c_¡r
("q11_ÇtiÚ_tsÿn_f‹r_t(%s)", 
_Çme
);

241 
	}
}

244 şas 
	cq11_·¹suµ_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


246 
´iv©e
:

247 
ShÜeTPCHEnv
* 
_chdb
;

248 
bË_row_t
* 
	m_´·¹suµ
;

249 
»p_row_t
 
	m_¼
;

252 
ch_·¹suµ_tu¶e
 
	m_·¹suµ
;

254 
	mpublic
:

255 
	$q11_·¹suµ_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q11_šput_t
 &
š
)

256 : 
	`tu¶e_f‹r_t
(
chdb
->
	`·¹suµ_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

258 
_´·¹suµ
 = 
_chdb
->
	`·¹suµ_mª
()->
	`g‘_tu¶e
();

259 
_¼
.
	`£t_ts
(
_chdb
->
	`·¹suµ_mª
()->
	`ts
(),

260 
_chdb
->
	`·¹suµ_desc
()->
	`maxsize
());

261 
_´·¹suµ
->
_»p
 = &
_¼
;

264 
vœtu®
 ~
	$q11_·¹suµ_tsÿn_f‹r_t
()

266 
_chdb
->
	`·¹suµ_mª
()->
	`give_tu¶e
(
_´·¹suµ
);

267 
	}
}

269 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

272 ià(!
_chdb
->
	`·¹suµ_mª
()->
	`lßd
(
_´·¹suµ
, 
šput
.
d©a
)) {

273 
	`as£¹
(
çl£
);

276  
Œue
;

277 
	}
}

280 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

282 
q11_´ojeùed_·¹suµ_tu¶e
 *
de¡
;

283 
de¡
 = 
®igÃd_ÿ¡
<
q11_´ojeùed_·¹suµ_tu¶e
>(
d
.
d©a
);

285 
_´·¹suµ
->
	`g‘_v®ue
(0, 
_·¹suµ
.
PS_PARTKEY
);

286 
_´·¹suµ
->
	`g‘_v®ue
(1, 
_·¹suµ
.
PS_SUPPKEY
);

287 
_´·¹suµ
->
	`g‘_v®ue
(2, 
_·¹suµ
.
PS_AVAILQTY
);

288 
_´·¹suµ
->
	`g‘_v®ue
(3, 
_·¹suµ
.
PS_SUPPLYCOST
);

295 
de¡
->
PS_SUPPKEY
 = 
_·¹suµ
.PS_SUPPKEY;

296 
de¡
->
PS_PARTKEY
 = 
_·¹suµ
.PS_PARTKEY;

297 
de¡
->
VALUE
 = 
_·¹suµ
.
PS_SUPPLYCOST
 / 100.0 * _·¹suµ.
PS_AVAILQTY
;

299 
	}
}

301 
q11_·¹suµ_tsÿn_f‹r_t
* 
	$şÚe
() const {

302  
Ãw
 
	`q11_·¹suµ_tsÿn_f‹r_t
(*
this
);

303 
	}
}

305 
c_¡r
 
	$to_¡ršg
() const {

306  
	`c_¡r
("q11_partsupp_tscan_filter_t()");

307 
	}
}

311 
	gq11_s_još_n_t
 : 
public
 
tu¶e_još_t
 {

313 
q11_s_još_n_t
()

314 : 
tu¶e_još_t
((
q11_´ojeùed_suµl›r_tu¶e
),

315 
off£tof
(
q11_´ojeùed_suµl›r_tu¶e
, 
S_NATIONKEY
),

316 (
q11_´ojeùed_ÇtiÚ_tu¶e
),

317 
off£tof
(
q11_´ojeùed_ÇtiÚ_tu¶e
, 
N_NATIONKEY
),

319 (
q11_s_još_n_tu¶e
))

323 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

324 
q11_s_još_n_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q11_s_još_n_tu¶e>(
d
.
d©a
);

325 
q11_´ojeùed_suµl›r_tu¶e
 *
	gsuµ
 = 
®igÃd_ÿ¡
<q11_´ojeùed_suµl›r_tu¶e>(
l
.
d©a
);

326 
q11_´ojeùed_ÇtiÚ_tu¶e
 *
	gÇtiÚ
 = 
®igÃd_ÿ¡
<q11_´ojeùed_ÇtiÚ_tu¶e>(
r
.
d©a
);

328 
	gde¡
->
	gS_SUPPKEY
 = 
suµ
->
S_SUPPKEY
;

333 
vœtu®
 
q11_s_još_n_t
* 
şÚe
() const {

334  
Ãw
 
q11_s_još_n_t
(*
this
);

337 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

338  
c_¡r
("join SUPPLIER, NATION; select S_SUPPKEY");

342 
	gq11_ps_još_s_n_t
 : 
public
 
tu¶e_još_t
 {

344 
q11_ps_još_s_n_t
()

345 : 
tu¶e_još_t
((
q11_´ojeùed_·¹suµ_tu¶e
),

346 
off£tof
(
q11_´ojeùed_·¹suµ_tu¶e
, 
PS_SUPPKEY
),

347 (
q11_s_još_n_tu¶e
),

348 
off£tof
(
q11_s_još_n_tu¶e
, 
S_SUPPKEY
),

350 (
q11_ps_još_s_n_tu¶e
))

354 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

355 
q11_ps_još_s_n_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q11_ps_još_s_n_tu¶e>(
d
.
d©a
);

356 
q11_´ojeùed_·¹suµ_tu¶e
 *
	g·¹suµ
 = 
®igÃd_ÿ¡
<q11_´ojeùed_·¹suµ_tu¶e>(
l
.
d©a
);

357 
q11_s_još_n_tu¶e
 *
	gright
 = 
®igÃd_ÿ¡
<q11_s_još_n_tu¶e>(
r
.
d©a
);

359 
	gde¡
->
	gPS_PARTKEY
 = 
·¹suµ
->
PS_PARTKEY
;

360 
	gde¡
->
	gVALUE
 = 
·¹suµ
->
VALUE
;

361 
	gde¡
->
	gPSEUDOKEY
 = 0;

366 
vœtu®
 
q11_ps_još_s_n_t
* 
şÚe
() const {

367  
Ãw
 
q11_ps_još_s_n_t
(*
this
);

370 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

371  
c_¡r
("join PARTSUPP, SUPPLIER_NATION; select PS_PARTKEY, VALUE");

375 
	gq11_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

377 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

378 
boŞ
 
	g_subQu”y
;

380 
q11_agg»g©e_t
(
boŞ
 
subQu”y
)

381 : 
tu¶e_agg»g©e_t
((
q11_ps_još_s_n_tu¶e
)), 
_subQu”y
(
subQu”y
), 
_exŒaùÜ
((subQuery ? 0 : ()), 0)

385 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
() {

386  &
	g_exŒaùÜ
;

389 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
t
) {

390 
q11_ps_još_s_n_tu¶e
 *
	gagg
 = 
®igÃd_ÿ¡
<q11_ps_još_s_n_tu¶e>(
agg_d©a
);

391 
q11_ps_još_s_n_tu¶e
 *
	gš
 = 
®igÃd_ÿ¡
<q11_ps_još_s_n_tu¶e>(
t
.
d©a
);

393 
	gagg
->
	gPS_PARTKEY
 = 
š
->
PS_PARTKEY
;

394 
	gagg
->
	gVALUE
 +ğ
š
->
VALUE
;

395 
	gagg
->
	gPSEUDOKEY
 = 
š
->
PSEUDOKEY
;

397 
vœtu®
 
fšish
(
tu¶e_t
 &
de¡
, cÚ¡ * 
agg_d©a
) {

398 
memıy
(
de¡
.
d©a
, 
agg_d©a
, de¡.
size
);

400 
vœtu®
 
q11_agg»g©e_t
* 
şÚe
() const {

401  
Ãw
 
q11_agg»g©e_t
(*
this
);

403 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

408 
	gq11_fš®_još_t
 : 
public
 
tu¶e_još_t
 {

410 
q11_fš®_još_t
()

411 : 
tu¶e_još_t
((
q11_ps_još_s_n_tu¶e
),

412 
off£tof
(
q11_ps_još_s_n_tu¶e
, 
PSEUDOKEY
),

413 (
q11_ps_još_s_n_tu¶e
),

414 
off£tof
(
q11_ps_još_s_n_tu¶e
, 
PSEUDOKEY
),

416 (
q11_®l_jošs_tu¶e
))

420 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

421 
q11_®l_jošs_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q11_®l_jošs_tu¶e>(
d
.
d©a
);

422 
q11_ps_još_s_n_tu¶e
 *
	gsub
 = 
®igÃd_ÿ¡
<q11_ps_još_s_n_tu¶e>(
l
.
d©a
);

423 
q11_ps_još_s_n_tu¶e
 *
	gmaš
 = 
®igÃd_ÿ¡
<q11_ps_još_s_n_tu¶e>(
r
.
d©a
);

425 
	gde¡
->
	gPS_PARTKEY
 = 
maš
->
PS_PARTKEY
;

426 
	gde¡
->
	gVALUE
 = 
maš
->
VALUE
;

427 
	gde¡
->
	gTHRESHOLD
 = 
sub
->
VALUE
;

432 
vœtu®
 
q11_fš®_još_t
* 
şÚe
() const {

433  
Ãw
 
q11_fš®_još_t
(*
this
);

436 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

437  
c_¡r
("join PARTSUPP_SUPPLIER_NATION sub, PARTSUPP_SUPPLIER_NATION main; select main.PS_PARTKEY, main.VALUE, sub.VALUE‡s THRESHOLD");

441 
	gq11_th»shŞd_f‹r_t
 : 
public
 
tu¶e_f‹r_t


444 
_äaùiÚ
;

446 
q11_th»shŞd_f‹r_t
(
äaùiÚ
)

447 : 
tu¶e_f‹r_t
((
q11_®l_jošs_tu¶e
)), 
_äaùiÚ
(
äaùiÚ
)

449 
TRACE
(
TRACE_ALWAYS
, "Rªdom…»diÿ‹: FRACTION = %.6f\n", 
_äaùiÚ
);

452 
boŞ
 
£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

453 
q11_®l_jošs_tu¶e
 *
	gtu¶e
 = 
®igÃd_ÿ¡
<q11_®l_jošs_tu¶e>(
šput
.
d©a
);

454  (
	gtu¶e
->
	gVALUE
.
to_doubË
(è>u¶e->
	gTHRESHOLD
.to_doubË(è* 
	g_äaùiÚ
);

457 
´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

459 
q11_fš®_tu¶e
 *
	gout
 = 
®igÃd_ÿ¡
<q11_fš®_tu¶e>(
d
.
d©a
);

460 
q11_®l_jošs_tu¶e
 *
	gš
 = 
®igÃd_ÿ¡
<q11_®l_jošs_tu¶e>(
s
.
d©a
);

462 
	gout
->
	gPS_PARTKEY
 = 
š
->
PS_PARTKEY
;

463 
	gout
->
	gVALUE
 = 
š
->
VALUE
;

466 
vœtu®
 
q11_th»shŞd_f‹r_t
* 
şÚe
() const {

467  
Ãw
 
q11_th»shŞd_f‹r_t
(*
this
);

470 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

471  
c_¡r
("q11_threshold_filter_t");

475 
	gq11_sÜt_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

477 
q11_sÜt_key_exŒaùÜ_t
()

478 : 
key_exŒaùÜ_t
((
decim®
), 
off£tof
(
q11_fš®_tu¶e
, 
VALUE
))

482 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

483  -(*
	g®igÃd_ÿ¡
<
	gdecim®
>(
	gkey
)).
to_št
();

486 
vœtu®
 
q11_sÜt_key_exŒaùÜ_t
* 
şÚe
() const {

487  
Ãw
 
q11_sÜt_key_exŒaùÜ_t
(*
this
);

491 
	gq11_sÜt_key_com·»_t
 : 
public
 
key_com·»_t
 {

493 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

494 
decim®
 
	g»v1
 = *
®igÃd_ÿ¡
<decim®>(
key1
);

495 
decim®
 
	g»v2
 = *
®igÃd_ÿ¡
<decim®>(
key2
);

496  
	g»v1
 > 
	g»v2
 ? -1 : (
»v1
 < 
»v2
 ? 1 : 0);

499 
vœtu®
 
q11_sÜt_key_com·»_t
* 
şÚe
() const {

500  
Ãw
 
q11_sÜt_key_com·»_t
(*
this
);

505 şas 
	cch_q11_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t
 {

507 
public
:

509 
vœtu®
 
	$begš
() {

510 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q11 %s %s\n",

514 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

515 
q11_fš®_tu¶e
 *
agg
 = 
®igÃd_ÿ¡
<q11_fš®_tu¶e>(
ouut
.
d©a
);

517 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q11 %d %.2f\n", 
agg
->
PS_PARTKEY
,‡gg->
VALUE
.
	`to_doubË
());

518 
	}
}

529 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_q11
(cÚ¡ 
xù_id
,

530 
q11_šput_t
& 
š
)

532 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** q11 *********\n");

534 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

535 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

540 
tu¶e_fifo
* 
q11_ÇtiÚ_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q11_´ojeùed_ÇtiÚ_tu¶e
));

541 
·ck‘_t
* 
q11_ÇtiÚ_tsÿn_·ck‘
 =

542 
Ãw
 
	`tsÿn_·ck‘_t
("nation TSCAN",

543 
q11_ÇtiÚ_bufãr
,

544 
Ãw
 
	`q11_ÇtiÚ_tsÿn_f‹r_t
(
this
, 
š
),

545 
this
->
	`db
(),

546 
_²©iÚ_desc
.
	`g‘
(),

547 
pxù
);

550 
tu¶e_fifo
* 
q11_ÇtiÚ_sub_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q11_´ojeùed_ÇtiÚ_tu¶e
));

551 
·ck‘_t
* 
q11_ÇtiÚ_sub_tsÿn_·ck‘
 =

552 
Ãw
 
	`tsÿn_·ck‘_t
("nation TSCAN subquery",

553 
q11_ÇtiÚ_sub_bufãr
,

554 
Ãw
 
	`q11_ÇtiÚ_tsÿn_f‹r_t
(
this
, 
š
),

555 
this
->
	`db
(),

556 
_²©iÚ_desc
.
	`g‘
(),

557 
pxù
);

560 
tu¶e_fifo
* 
q11_suµl›r_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q11_´ojeùed_suµl›r_tu¶e
));

561 
·ck‘_t
* 
q11_suµl›r_tsÿn_·ck‘
 =

562 
Ãw
 
	`tsÿn_·ck‘_t
("supplier TSCAN",

563 
q11_suµl›r_bufãr
,

564 
Ãw
 
	`q11_suµl›r_tsÿn_f‹r_t
(
this
, 
š
),

565 
this
->
	`db
(),

566 
_psuµl›r_desc
.
	`g‘
(),

567 
pxù
);

570 
tu¶e_fifo
* 
q11_suµl›r_sub_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q11_´ojeùed_suµl›r_tu¶e
));

571 
·ck‘_t
* 
q11_suµl›r_sub_tsÿn_·ck‘
 =

572 
Ãw
 
	`tsÿn_·ck‘_t
("supplier TSCAN subquery",

573 
q11_suµl›r_sub_bufãr
,

574 
Ãw
 
	`q11_suµl›r_tsÿn_f‹r_t
(
this
, 
š
),

575 
this
->
	`db
(),

576 
_psuµl›r_desc
.
	`g‘
(),

577 
pxù
);

580 
tu¶e_fifo
* 
q11_·¹suµ_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q11_´ojeùed_·¹suµ_tu¶e
));

581 
·ck‘_t
* 
q11_·¹suµ_tsÿn_·ck‘
 =

582 
Ãw
 
	`tsÿn_·ck‘_t
("partsupp TSCAN",

583 
q11_·¹suµ_bufãr
,

584 
Ãw
 
	`q11_·¹suµ_tsÿn_f‹r_t
(
this
, 
š
),

585 
this
->
	`db
(),

586 
_µ¬tsuµ_desc
.
	`g‘
(),

587 
pxù
);

590 
tu¶e_fifo
* 
q11_·¹suµ_sub_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q11_´ojeùed_·¹suµ_tu¶e
));

591 
·ck‘_t
* 
q11_·¹suµ_sub_tsÿn_·ck‘
 =

592 
Ãw
 
	`tsÿn_·ck‘_t
("partsupp TSCAN subquery",

593 
q11_·¹suµ_sub_bufãr
,

594 
Ãw
 
	`q11_·¹suµ_tsÿn_f‹r_t
(
this
, 
š
),

595 
this
->
	`db
(),

596 
_µ¬tsuµ_desc
.
	`g‘
(),

597 
pxù
);

602 
tu¶e_fifo
* 
q11_s_još_n_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q11_s_još_n_tu¶e
));

603 
·ck‘_t
* 
q11_s_još_n_·ck‘
 =

604 
Ãw
 
	`hash_još_·ck‘_t
("supplier -‚ation HJOIN",

605 
q11_s_još_n_bufãr
,

606 
Ãw
 
	`ŒivŸl_f‹r_t
((
q11_s_još_n_tu¶e
)),

607 
q11_suµl›r_tsÿn_·ck‘
,

608 
q11_ÇtiÚ_tsÿn_·ck‘
,

609 
Ãw
 
	`q11_s_još_n_t
());

612 
tu¶e_fifo
* 
q11_ps_još_s_n_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q11_ps_još_s_n_tu¶e
));

613 
·ck‘_t
* 
q11_ps_još_s_n_·ck‘
 =

614 
Ãw
 
	`hash_još_·ck‘_t
("partsupp - supplier_nation HJOIN",

615 
q11_ps_još_s_n_bufãr
,

616 
Ãw
 
	`ŒivŸl_f‹r_t
((
q11_ps_još_s_n_tu¶e
)),

617 
q11_·¹suµ_tsÿn_·ck‘
,

618 
q11_s_još_n_·ck‘
,

619 
Ãw
 
	`q11_ps_još_s_n_t
());

622 
tu¶e_fifo
* 
q11_agg_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q11_ps_još_s_n_tu¶e
));

623 
·ck‘_t
* 
q11_agg_·ck‘
 =

624 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("AGGREGATE: GROUP BY PS_PARTKEY + SUM",

625 
q11_agg_bufãr
,

626 
Ãw
 
	`ŒivŸl_f‹r_t
((
q11_ps_još_s_n_tu¶e
)),

627 
q11_ps_još_s_n_·ck‘
,

628 
Ãw
 
	`q11_agg»g©e_t
(
çl£
),

629 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
((), 
	`off£tof
(
q11_ps_još_s_n_tu¶e
, 
PS_PARTKEY
)),

630 
Ãw
 
	`št_key_com·»_t
());

636 
tu¶e_fifo
* 
q11_s_još_n_sub_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q11_s_još_n_tu¶e
));

637 
·ck‘_t
* 
q11_s_još_n_sub_·ck‘
 =

638 
Ãw
 
	`hash_još_·ck‘_t
("supplier -‚ation HJOIN subquery",

639 
q11_s_još_n_sub_bufãr
,

640 
Ãw
 
	`ŒivŸl_f‹r_t
((
q11_s_još_n_tu¶e
)),

641 
q11_suµl›r_sub_tsÿn_·ck‘
,

642 
q11_ÇtiÚ_sub_tsÿn_·ck‘
,

643 
Ãw
 
	`q11_s_još_n_t
());

646 
tu¶e_fifo
* 
q11_ps_još_s_n_sub_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q11_ps_još_s_n_tu¶e
));

647 
·ck‘_t
* 
q11_ps_još_s_n_sub_·ck‘
 =

648 
Ãw
 
	`hash_još_·ck‘_t
("partsupp - supplier_nation HJOIN subquery",

649 
q11_ps_još_s_n_sub_bufãr
,

650 
Ãw
 
	`ŒivŸl_f‹r_t
((
q11_ps_još_s_n_tu¶e
)),

651 
q11_·¹suµ_sub_tsÿn_·ck‘
,

652 
q11_s_još_n_sub_·ck‘
,

653 
Ãw
 
	`q11_ps_još_s_n_t
());

656 
tu¶e_fifo
* 
q11_agg_sub_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q11_ps_još_s_n_tu¶e
));

657 
·ck‘_t
* 
q11_agg_sub_·ck‘
 =

658 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("AGGREGATE: SUM",

659 
q11_agg_sub_bufãr
,

660 
Ãw
 
	`ŒivŸl_f‹r_t
((
q11_ps_još_s_n_tu¶e
)),

661 
q11_ps_još_s_n_sub_·ck‘
,

662 
Ãw
 
	`q11_agg»g©e_t
(
Œue
),

663 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
(0, 0),

664 
Ãw
 
	`št_key_com·»_t
());

669 
tu¶e_fifo
* 
q11_®l_jošs_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q11_fš®_tu¶e
));

670 
·ck‘_t
* 
q11_®l_jošs_·ck‘
 =

671 
Ãw
 
	`hash_još_·ck‘_t
("partsupp_supplier_nation sub -…artsupp_supplier_nation main HJOIN",

672 
q11_®l_jošs_bufãr
,

673 
Ãw
 
	`q11_th»shŞd_f‹r_t
((&
š
)->
äaùiÚ
),

674 
q11_agg_sub_·ck‘
,

675 
q11_agg_·ck‘
,

676 
Ãw
 
	`q11_fš®_još_t
());

680 
tu¶e_fifo
* 
q11_sÜt_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q11_fš®_tu¶e
));

681 
·ck‘_t
* 
q11_sÜt_·ck‘
 =

682 
Ãw
 
	`sÜt_·ck‘_t
("SORT BY VALUE desc",

683 
q11_sÜt_bufãr
,

684 
Ãw
 
	`ŒivŸl_f‹r_t
((
q11_fš®_tu¶e
)),

685 
Ãw
 
	`q11_sÜt_key_exŒaùÜ_t
(),

686 
Ãw
 
	`q11_sÜt_key_com·»_t
(),

687 
q11_®l_jošs_·ck‘
);

690 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

691 
q11_ÇtiÚ_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

692 
q11_ÇtiÚ_sub_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

693 
q11_suµl›r_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

694 
q11_suµl›r_sub_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

695 
q11_·¹suµ_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

696 
q11_·¹suµ_sub_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

697 
q11_s_još_n_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

698 
q11_ps_još_s_n_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

699 
q11_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

700 
q11_s_još_n_sub_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

701 
q11_ps_još_s_n_sub_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

702 
q11_agg_sub_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

703 
q11_®l_jošs_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

704 
q11_sÜt_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

707 
ch_q11_´oûss_tu¶e_t
 
±
;

709 
	`´oûss_qu”y
(
q11_sÜt_·ck‘
, 
±
);

711 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

714  (
RCOK
);

715 
	}
}

717 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/qpipe/qpipe_q12.cpp

32 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

33 
	~"wÜklßd/ch/ch_¡ruù.h
"

34 
	~"wÜklßd/ch/ch_ut.h
"

35 
	~"qpe.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
usšg
 
Çme¥aû
 
	gqpe
;

42 
ENTER_NAMESPACE
(
ch
);

75 
	sq12_lše™em_sÿn_tu¶e
 {

76 
	mL_ORDERKEY
;

77 
ch_l_shmode
 
	mL_SHIPMODE
;

80 
	sq12_Üd”s_sÿn_tu¶e
 {

81 
	mO_ORDERKEY
;

82 
	mO_ORDERPRIORITY
;

85 
	sq12_još_tu¶e
 {

86 
ch_l_shmode
 
	mL_SHIPMODE
;

87 
	mO_ORDERPRIORITY
;

90 
	sq12_tu¶e
 {

91 
ch_l_shmode
 
	mL_SHIPMODE
;

92 
	mHIGH_LINE_COUNT
;

93 
	mLOW_LINE_COUNT
;

96 
	sq12_fš®_tu¶e
 {

97 
	mL_SHIPMODE
[
STRSIZE
(10)];

98 
	mHIGH_LINE_COUNT
;

99 
	mLOW_LINE_COUNT
;

109 şas 
	cq12_lše™em_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


111 
´iv©e
:

112 
ShÜeTPCHEnv
* 
_chdb
;

113 
bË_row_t
* 
	m_´lše
;

114 
»p_row_t
 
	m_¼
;

116 
ch_lše™em_tu¶e
 
	m_lše™em
;

117 
time_t
 
	m_comm™d©e
;

118 
time_t
 
	m_»ûtd©e
;

119 
time_t
 
	m_shd©e
;

120 
	m_shmode
;

128 
q12_šput_t
* 
	mq12_šput
;

129 
time_t
 
	m_Ï¡_l_»ûtd©e
;

130 
	mpublic
:

132 
	$q12_lše™em_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q12_šput_t
 &
š
)

133 : 
	`tu¶e_f‹r_t
(
chdb
->
	`lše™em_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

138 
_´lše
 = 
_chdb
->
	`lše™em_mª
()->
	`g‘_tu¶e
();

139 
_¼
.
	`£t_ts
(
_chdb
->
	`lše™em_mª
()->
	`ts
(),

140 
_chdb
->
	`lše™em_desc
()->
	`maxsize
());

141 
_´lše
->
_»p
 = &
_¼
;

145 
q12_šput
=&
š
;

146 
tm
 
d©e
;

147 
	`gmtime_r
(&(
q12_šput
->
l_»ûtd©e
), &
d©e
);

148 
d©e
.
tm_y—r
 ++;

149 
_Ï¡_l_»ûtd©e
=
	`mktime
(&
d©e
);

151 
shmode1
[11];

152 
shmode2
[11];

153 
fshd©e
[15];

154 
lshd©e
[15];

156 
	`shmode_to_¡r
(
shmode1
, (
ch_l_shmode
)(
q12_šput
->
l_shmode1
));

157 
	`shmode_to_¡r
(
shmode2
, (
ch_l_shmode
)(
q12_šput
->
l_shmode2
));

158 
	`tim‘_to_¡r
(
fshd©e
, 
q12_šput
->
l_»ûtd©e
);

159 
	`tim‘_to_¡r
(
lshd©e
, 
_Ï¡_l_»ûtd©e
);

161 
	`TRACE
(
TRACE_ALWAYS
, "Rªdom P»diÿ‹s:\nL_SHIPMODE iÀ(%s, %s); % <ğL_RECEIPTDATE < %s\n", 
shmode1
, 
shmode2
, 
fshd©e
, 
lshd©e
);

164 ~
	$q12_lše™em_tsÿn_f‹r_t
()

167 
_chdb
->
	`lše™em_mª
()->
	`give_tu¶e
(
_´lše
);

168 
	}
}

172 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

175 ià(!
_chdb
->
	`lše™em_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

176 
	`as£¹
(
çl£
);

179 
_´lše
->
	`g‘_v®ue
(10, 
_lše™em
.
L_SHIPDATE
, 15);

180 
_shd©e
 = 
	`¡r_to_tim‘
(
_lše™em
.
L_SHIPDATE
);

181 
_´lše
->
	`g‘_v®ue
(11, 
_lše™em
.
L_COMMITDATE
, 15);

182 
_comm™d©e
 = 
	`¡r_to_tim‘
(
_lše™em
.
L_COMMITDATE
);

183 
_´lše
->
	`g‘_v®ue
(12, 
_lše™em
.
L_RECEIPTDATE
, 15);

184 
_»ûtd©e
 = 
	`¡r_to_tim‘
(
_lše™em
.
L_RECEIPTDATE
);

185 
_´lše
->
	`g‘_v®ue
(14, 
_lše™em
.
L_SHIPMODE
, 15);

186 
_shmode
=
	`¡r_to_shmode
(
_lše™em
.
L_SHIPMODE
);

191 iàĞ(
_shmode
==
q12_šput
->
l_shmode1
 || _shmode==q12_šput->
l_shmode2
è&& 
_comm™d©e
<
_»ûtd©e
 && 
_shd©e
<_comm™d©&& _»ûtd©>ğq12_šput->
l_»ûtd©e
 && _»ûtd©< 
_Ï¡_l_»ûtd©e
 ) {

193  (
Œue
);

197  (
çl£
);

199 
	}
}

203 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

205 
q12_lše™em_sÿn_tu¶e
 *
de¡
;

206 
de¡
 = 
®igÃd_ÿ¡
<
q12_lše™em_sÿn_tu¶e
>(
d
.
d©a
);

208 
_´lše
->
	`g‘_v®ue
(0, 
_lše™em
.
L_ORDERKEY
);

209 
_´lše
->
	`g‘_v®ue
(14, 
_lše™em
.
L_SHIPMODE
, 10);

215 
de¡
->
L_ORDERKEY
 = 
_lše™em
.L_ORDERKEY;

216 
de¡
->
L_SHIPMODE
 = 
	`¡r_to_shmode
(
_lše™em
.L_SHIPMODE);

218 
	}
}

220 
q12_lše™em_tsÿn_f‹r_t
* 
	$şÚe
() const {

221  
Ãw
 
	`q12_lše™em_tsÿn_f‹r_t
(*
this
);

222 
	}
}

224 
c_¡r
 
	$to_¡ršg
() const {

225 
d©e
[15];

226 
	`tim‘_to_¡r
(
d©e
, 
q12_šput
->
l_»ûtd©e
);

227  
	`c_¡r
("q12_lše™em_tsÿn_f‹r_t(%s, %d, %d)", 
d©e
, 
q12_šput
->
l_shmode1
, q12_šput->
l_shmode2
);

228 
	}
}

233 şas 
	cq12_Üd”s_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


235 
´iv©e
:

236 
ShÜeTPCHEnv
* 
_chdb
;

237 
bË_row_t
* 
	m_´Üd”
;

238 
»p_row_t
 
	m_¼
;

241 
ch_Üd”s_tu¶e
 
	m_Üd”s
;

242 
	mpublic
:

244 
	$q12_Üd”s_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
)

245 : 
	`tu¶e_f‹r_t
(
chdb
->
	`Üd”s_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

248 
_´Üd”
 = 
_chdb
->
	`Üd”s_mª
()->
	`g‘_tu¶e
();

249 
_¼
.
	`£t_ts
(
_chdb
->
	`Üd”s_mª
()->
	`ts
(),

250 
_chdb
->
	`Üd”s_desc
()->
	`maxsize
());

251 
_´Üd”
->
_»p
 = &
_¼
;

255 ~
	$q12_Üd”s_tsÿn_f‹r_t
()

258 
_chdb
->
	`Üd”s_mª
()->
	`give_tu¶e
(
_´Üd”
);

259 
	}
}

261 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

265 ià(!
_chdb
->
	`Üd”s_mª
()->
	`lßd
(
_´Üd”
, 
šput
.
d©a
)) {

266 
	`as£¹
(
çl£
);

269 (
Œue
);

270 
	}
}

273 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

275 
q12_Üd”s_sÿn_tu¶e
 *
de¡
;

276 
de¡
 = 
®igÃd_ÿ¡
<
q12_Üd”s_sÿn_tu¶e
>(
d
.
d©a
);

278 
_´Üd”
->
	`g‘_v®ue
(0, 
_Üd”s
.
O_ORDERKEY
);

279 
_´Üd”
->
	`g‘_v®ue
(5, 
_Üd”s
.
O_ORDERPRIORITY
, 15);

281 
numb”
[2];

282 
	`¡ºıy
(
numb”
,
_Üd”s
.
O_ORDERPRIORITY
,1);

283 
numb”
[1] = '\0';

290 
de¡
->
O_ORDERKEY
 = 
_Üd”s
.O_ORDERKEY;

291 
de¡
->
O_ORDERPRIORITY
 = 
	`©oi
(
numb”
);

292 
	}
}

294 
q12_Üd”s_tsÿn_f‹r_t
* 
	$şÚe
() const {

295  
Ãw
 
	`q12_Üd”s_tsÿn_f‹r_t
(*
this
);

296 
	}
}

298 
c_¡r
 
	$to_¡ršg
() const {

299 
c_¡r
 
	`»suÉ
("select O_ORDERKEY, O_ORDERPRIORITY from ORDERS");

300  
»suÉ
;

301 
	}
}

306 
	gq12_još_t
 : 
tu¶e_još_t
 {

308 
q12_još_t
()

309 : 
tu¶e_još_t
((
q12_Üd”s_sÿn_tu¶e
),

310 
off£tof
(
q12_Üd”s_sÿn_tu¶e
,
O_ORDERKEY
),

311 (
q12_lše™em_sÿn_tu¶e
),

312 
off£tof
(
q12_lše™em_sÿn_tu¶e
,
L_ORDERKEY
),

314 (
q12_još_tu¶e
))

318 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

320 
q12_još_tu¶e
* 
	gde¡
 = 
®igÃd_ÿ¡
<q12_još_tu¶e>(
d
.
d©a
);

321 
q12_Üd”s_sÿn_tu¶e
* 
	gËá
 = 
®igÃd_ÿ¡
<q12_Üd”s_sÿn_tu¶e>(
l
.
d©a
);

322 
q12_lše™em_sÿn_tu¶e
* 
	gright
 = 
®igÃd_ÿ¡
<q12_lše™em_sÿn_tu¶e>(
r
.
d©a
);

324 
	gde¡
->
	gL_SHIPMODE
=
right
->
L_SHIPMODE
;

325 
	gde¡
->
	gO_ORDERPRIORITY
=
Ëá
->
O_ORDERPRIORITY
;

330 
vœtu®
 
q12_još_t
* 
şÚe
() const {

331  
Ãw
 
q12_još_t
(*
this
);

334 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

353 
	gq12_agg»g©e_t
 : 
tu¶e_agg»g©e_t
 {

354 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

356 
q12_agg»g©e_t
()

357 : 
tu¶e_agg»g©e_t
((
q12_tu¶e
)),

358 
_exŒaùÜ
((
ch_l_shmode
),

359 
off£tof
(
q12_još_tu¶e
, 
L_SHIPMODE
))

363 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
() {

364  &
	g_exŒaùÜ
;

366 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
t
) {

367 
q12_još_tu¶e
* 
	gšp
 = 
®igÃd_ÿ¡
<q12_još_tu¶e>(
t
.
d©a
);

368 
q12_tu¶e
* 
	gagg
 = 
®igÃd_ÿ¡
<q12_tu¶e>(
agg_d©a
);

370 ià(
	gšp
->
	gO_ORDERPRIORITY
==1 || 
šp
->
O_ORDERPRIORITY
==2)

371 
agg
->
HIGH_LINE_COUNT
++;

373 
	gagg
->
	gLOW_LINE_COUNT
++;

375 
vœtu®
 
fšish
(
tu¶e_t
 &
de¡
, cÚ¡ * 
agg_d©a
) {

376 
memıy
(
de¡
.
d©a
, 
agg_d©a
, de¡.
size
);

378 
vœtu®
 
q12_agg»g©e_t
* 
şÚe
() const {

379  
Ãw
 
q12_agg»g©e_t
(*
this
);

381 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

386 
	gq12_agg_f‹r_t
 : 
public
 
tu¶e_f‹r_t
 {

388 
q12_agg_f‹r_t
()

389 : 
tu¶e_f‹r_t
((
q12_fš®_tu¶e
))

393 
boŞ
 
£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

394  
Œue
;

397 
´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

399 
q12_fš®_tu¶e
 *
	gout
 = 
®igÃd_ÿ¡
<q12_fš®_tu¶e>(
d
.
d©a
);

400 
q12_tu¶e
 *
	gš
 = 
®igÃd_ÿ¡
<q12_tu¶e>(
s
.
d©a
);

402 
shmode_to_¡r
(
out
->
L_SHIPMODE
, (
š
->L_SHIPMODE));

403 
	gout
->
	gHIGH_LINE_COUNT
 = 
š
->
HIGH_LINE_COUNT
;

404 
	gout
->
	gLOW_LINE_COUNT
 = 
š
->
LOW_LINE_COUNT
;

407 
vœtu®
 
q12_agg_f‹r_t
* 
şÚe
() const {

408  
Ãw
 
q12_agg_f‹r_t
(*
this
);

411 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

412  
c_¡r
("q12_agg_filter_t");

416 
	gq12_sÜt_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

418 
q12_sÜt_key_exŒaùÜ_t
()

419 : 
key_exŒaùÜ_t
(
STRSIZE
(10è* (), 
off£tof
(
q12_fš®_tu¶e
, 
L_SHIPMODE
))

423 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

424 *
	gk
;

425 
	gk
 = 
®igÃd_ÿ¡
<>(
key
);

427 
	g»suÉ
 = (*
k
 << 8) + *(k + ());

429  
	g»suÉ
;

432 
vœtu®
 
q12_sÜt_key_exŒaùÜ_t
* 
şÚe
() const {

433  
Ãw
 
q12_sÜt_key_exŒaùÜ_t
(*
this
);

437 
	gq12_sÜt_key_com·»_t
 : 
public
 
key_com·»_t
 {

439 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

440 * 
	gshmode1
 = 
®igÃd_ÿ¡
<>(
key1
);

441 * 
	gshmode2
 = 
®igÃd_ÿ¡
<>(
key2
);

443  
¡rcmp
(
shmode1
, 
shmode2
);

446 
vœtu®
 
q12_sÜt_key_com·»_t
* 
şÚe
() const {

447  
Ãw
 
q12_sÜt_key_com·»_t
(*
this
);

453 şas 
	cch_q12_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t
 {

455 
public
:

457 
vœtu®
 
	$begš
() {

458 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q12 %10s %10s %10s\n",

462 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

463 
q12_fš®_tu¶e
* 
r
 = 
®igÃd_ÿ¡
<q12_fš®_tu¶e>(
ouut
.
d©a
);

464 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q12 %10s %10d %10d\n",

465 
r
->
L_SHIPMODE
,

466 
r
->
HIGH_LINE_COUNT
,

467 
r
->
LOW_LINE_COUNT
);

468 
	}
}

480 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_q12
(cÚ¡ 
xù_id
,

481 
q12_šput_t
& 
š
)

483 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** Q12 *********\n");

485 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

486 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

490 
tu¶e_fifo
* 
q12_lše™em_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q12_lše™em_sÿn_tu¶e
));

491 
·ck‘_t
* 
q12_lše™em_tsÿn_·ck‘
 =

492 
Ãw
 
	`tsÿn_·ck‘_t
("lineitem TSCAN",

493 
q12_lše™em_bufãr
,

494 
Ãw
 
	`q12_lše™em_tsÿn_f‹r_t
(
this
,
š
),

495 
this
->
	`db
(),

496 
_¶še™em_desc
.
	`g‘
(),

497 
pxù


504 
tu¶e_fifo
* 
q12_Üd”s_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q12_Üd”s_sÿn_tu¶e
));

505 
·ck‘_t
* 
q12_Üd”s_tsÿn_·ck‘
 =

506 
Ãw
 
	`tsÿn_·ck‘_t
("orders TSCAN",

507 
q12_Üd”s_bufãr
,

508 
Ãw
 
	`q12_Üd”s_tsÿn_f‹r_t
(
this
),

509 
this
->
	`db
(),

510 
_pÜd”s_desc
.
	`g‘
(),

511 
pxù


516 
tu¶e_fifo
* 
q12_još_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q12_još_tu¶e
));

517 
·ck‘_t
* 
q12_još_·ck‘
 =

518 
Ãw
 
	`hash_još_·ck‘_t
("orders-lineitem HJOIN",

519 
q12_još_bufãr
,

520 
Ãw
 
	`ŒivŸl_f‹r_t
((
q12_još_tu¶e
)),

521 
q12_Üd”s_tsÿn_·ck‘
,

522 
q12_lše™em_tsÿn_·ck‘
,

523 
Ãw
 
	`q12_još_t
());

528 
tu¶e_fifo
* 
q12_agg_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q12_fš®_tu¶e
));

529 
tu¶e_agg»g©e_t
 *
q12_agg»g©e
 = 
Ãw
 
	`q12_agg»g©e_t
();

530 
·ck‘_t
* 
q12_agg_·ck‘
;

531 
q12_agg_·ck‘
 = 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("SUM AGG",

532 
q12_agg_bufãr
,

533 
Ãw
 
	`q12_agg_f‹r_t
(),

534 
q12_još_·ck‘
,

535 
q12_agg»g©e
,

536 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
((
ch_l_shmode
), 
	`off£tof
(
q12_još_tu¶e
, 
L_SHIPMODE
)),

537 
Ãw
 
	`št_key_com·»_t
());

539 
tu¶e_fifo
* 
q12_sÜt_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q12_fš®_tu¶e
));

540 
·ck‘_t
* 
q12_sÜt_·ck‘
 =

541 
Ãw
 
	`sÜt_·ck‘_t
("SORT BY SHIPMODE",

542 
q12_sÜt_bufãr
,

543 
Ãw
 
	`ŒivŸl_f‹r_t
((
q12_fš®_tu¶e
)),

544 
Ãw
 
	`q12_sÜt_key_exŒaùÜ_t
(),

545 
Ãw
 
	`q12_sÜt_key_com·»_t
(),

546 
q12_agg_·ck‘
);

551 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

553 
q12_lše™em_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

554 
q12_Üd”s_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

555 
q12_još_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

556 
q12_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

557 
q12_sÜt_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

560 
ch_q12_´oûss_tu¶e_t
 
±
;

563 
	`´oûss_qu”y
(
q12_sÜt_·ck‘
, 
±
);

565 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

568  (
RCOK
);

569 
	}
}

572 
EXIT_NAMESPACE
(
qpe
);

	@src/workload/tpch/qpipe/qpipe_q13.cpp

32 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

33 
	~"wÜklßd/ch/ch_¡ruù.h
"

34 
	~"wÜklßd/ch/ch_ut.h
"

35 
	~"qpe.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
usšg
 
Çme¥aû
 
	gqpe
;

42 
ENTER_NAMESPACE
(
ch
);

74 
	sq13_cu¡om”_sÿn_tu¶e


76 
	mC_CUSTKEY
;

79 
	sq13_Üd”s_sÿn_tu¶e


81 
	mO_CUSTKEY
;

84 
	sq13_key_couÁ_tu¶e


86 
	mKEY
;

87 
	mCOUNT
;

89 
q13_key_couÁ_tu¶e
 
	tq13_cu¡_Üd”_couÁ_tu¶e
;

91 
	sq13_još_tu¶e


93 
	mC_COUNT
;

96 
q13_key_couÁ_tu¶e
 
	tq13_tu¶e
;

107 şas 
	cq13_cu¡om”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


109 
´iv©e
:

110 
ShÜeTPCHEnv
* 
_chdb
;

111 
bË_row_t
* 
	m_´cu¡om”
;

112 
»p_row_t
 
	m_¼
;

115 
ch_cu¡om”_tu¶e
 
	m_cu¡om”
;

116 
	mpublic
:

118 
	$q13_cu¡om”_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
)

119 : 
	`tu¶e_f‹r_t
(
chdb
->
	`cu¡om”_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

122 
_´cu¡om”
 = 
_chdb
->
	`cu¡om”_mª
()->
	`g‘_tu¶e
();

123 
_¼
.
	`£t_ts
(
_chdb
->
	`cu¡om”_mª
()->
	`ts
(),

124 
_chdb
->
	`cu¡om”_desc
()->
	`maxsize
());

125 
_´cu¡om”
->
_»p
 = &
_¼
;

129 ~
	$q13_cu¡om”_tsÿn_f‹r_t
()

132 
_chdb
->
	`cu¡om”_mª
()->
	`give_tu¶e
(
_´cu¡om”
);

133 
	}
}

135 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

139 ià(!
_chdb
->
	`cu¡om”_mª
()->
	`lßd
(
_´cu¡om”
, 
šput
.
d©a
)) {

140 
	`as£¹
(
çl£
);

143 (
Œue
);

144 
	}
}

147 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

149 
q13_cu¡om”_sÿn_tu¶e
 *
de¡
;

150 
de¡
 = 
®igÃd_ÿ¡
<
q13_cu¡om”_sÿn_tu¶e
>(
d
.
d©a
);

152 
_´cu¡om”
->
	`g‘_v®ue
(0, 
_cu¡om”
.
C_CUSTKEY
);

158 
de¡
->
C_CUSTKEY
 = 
_cu¡om”
.C_CUSTKEY;

160 
	}
}

162 
q13_cu¡om”_tsÿn_f‹r_t
* 
	$şÚe
() const {

163  
Ãw
 
	`q13_cu¡om”_tsÿn_f‹r_t
(*
this
);

164 
	}
}

166 
c_¡r
 
	$to_¡ršg
() const {

167 
c_¡r
 
	`»suÉ
("select C_CUSTKEY from CUSTOMER");

168  
»suÉ
;

169 
	}
}

174 şas 
	cq13_Üd”s_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t
 {

175 
´iv©e
:

176 
ShÜeTPCHEnv
* 
_chdb
;

177 
bË_row_t
* 
	m_´Üd”
;

178 
»p_row_t
 
	m_¼
;

181 
ch_Üd”s_tu¶e
 
	m_Üd”s
;

185 
q13_šput_t
* 
	mq13_šput
;

186 
	mpublic
:

189 
	$q13_Üd”s_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q13_šput_t
 &
š
)

190 : 
	`tu¶e_f‹r_t
(
chdb
->
	`Üd”s_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

193 
_´Üd”
 = 
_chdb
->
	`Üd”s_mª
()->
	`g‘_tu¶e
();

194 
_¼
.
	`£t_ts
(
_chdb
->
	`Üd”s_mª
()->
	`ts
(),

195 
_chdb
->
	`Üd”s_desc
()->
	`maxsize
());

196 
_´Üd”
->
_»p
 = &
_¼
;

199 
q13_šput
=&
š
;

201 
	`TRACE
(
TRACE_ALWAYS
, "Rªdom…»diÿ‹s:\nORDERS.O_COMMENT‚Ù†ik'%%%s%%%s%%'\n", 
q13_šput
->
WORD1
, q13_šput->
WORD2
);

204 ~
	$q13_Üd”s_tsÿn_f‹r_t
()

207 
_chdb
->
	`Üd”s_mª
()->
	`give_tu¶e
(
_´Üd”
);

208 
	}
}

211 
vœtu®
 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

214 ià(!
_chdb
->
	`Üd”s_mª
()->
	`lßd
(
_´Üd”
, 
šput
.
d©a
)) {

215 
	`as£¹
(
çl£
);

218 
_´Üd”
->
	`g‘_v®ue
(8, 
_Üd”s
.
O_COMMENT
, 79);

223 * 
fœ¡
 = 
	`¡r¡r
(
_Üd”s
.
O_COMMENT
, 
q13_šput
->
WORD1
);

224 if(!
fœ¡
)

225  
Œue
;

227 * 
£cÚd
 = 
	`¡r¡r
(
fœ¡
 + 
	`¡¾’
(
q13_šput
->
WORD1
), q13_šput->
WORD2
);

228 if(!
£cÚd
)

229  
Œue
;

232  
çl£
;

233 
	}
}

236 
vœtu®
 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

238 
q13_Üd”s_sÿn_tu¶e
 *
de¡
;

239 
de¡
 = 
®igÃd_ÿ¡
<
q13_Üd”s_sÿn_tu¶e
>(
d
.
d©a
);

241 
_´Üd”
->
	`g‘_v®ue
(1, 
_Üd”s
.
O_CUSTKEY
);

246 
de¡
->
O_CUSTKEY
 = 
_Üd”s
.O_CUSTKEY;

247 
	}
}

249 
vœtu®
 
q13_Üd”s_tsÿn_f‹r_t
* 
	$şÚe
() const {

250  
Ãw
 
	`q13_Üd”s_tsÿn_f‹r_t
(*
this
);

251 
	}
}

252 
vœtu®
 
c_¡r
 
	$to_¡ršg
() const {

253  
	`c_¡r
("select O_CUSTKEY "

255 
q13_šput
->
WORD1
, q13_šput->
WORD2
);

256 
	}
}

261 
	gšt_desc_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

262 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
tu¶e_d©a
) const {

263  -*
®igÃd_ÿ¡
<>(
tu¶e_d©a
);

265 
vœtu®
 
št_desc_key_exŒaùÜ_t
* 
şÚe
() const {

266  
Ãw
 
št_desc_key_exŒaùÜ_t
(*
this
);

270 
	gq13_couÁ_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

271 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

273 
q13_couÁ_agg»g©e_t
()

274 : 
tu¶e_agg»g©e_t
((
q13_cu¡_Üd”_couÁ_tu¶e
))

277 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
(è{  &
_exŒaùÜ
; }

279 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &) {

280 
q13_cu¡_Üd”_couÁ_tu¶e
* 
	gagg
 = 
®igÃd_ÿ¡
<q13_cu¡_Üd”_couÁ_tu¶e>(
agg_d©a
);

281 
	gagg
->
	gCOUNT
++;

284 
vœtu®
 
fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

285 
memıy
(
d
.
d©a
, 
agg_d©a
, 
tu¶e_size
());

287 
vœtu®
 
q13_couÁ_agg»g©e_t
* 
şÚe
() const {

288  
Ãw
 
q13_couÁ_agg»g©e_t
(*
this
);

290 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

296 
	gq13_još_t
 : 
public
 
tu¶e_još_t
 {

298 
q13_još_t
()

299 : 
tu¶e_još_t
((
q13_cu¡om”_sÿn_tu¶e
),

301 (
q13_cu¡_Üd”_couÁ_tu¶e
),

302 
off£tof
(
q13_cu¡_Üd”_couÁ_tu¶e
, 
KEY
),

308 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

309 cÚ¡ 
tu¶e_t
 &,

310 cÚ¡ 
tu¶e_t
 &
right
)

313 
q13_cu¡_Üd”_couÁ_tu¶e
* 
	gtu¶e
 = 
®igÃd_ÿ¡
<q13_cu¡_Üd”_couÁ_tu¶e>(
right
.
d©a
);

315 *
	g®igÃd_ÿ¡
<>(
	gde¡
.
	gd©a
èğ
tu¶e
->
COUNT
;

318 
vœtu®
 
Ëá_ou‹r_još
(
tu¶e_t
 &
de¡
, constuple_t &) {

320 *
	g®igÃd_ÿ¡
<>(
	gde¡
.
	gd©a
) = 0;

323 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

329 
	gq13_key_exŒaù_t
 : 
public
 
key_exŒaùÜ_t


331 
q13_key_exŒaù_t
(è: 
key_exŒaùÜ_t
((
q13_tu¶e
)) { }

333 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
tu¶e_d©a
) const {

334 
q13_tu¶e
* 
tu¶e
 = 
®igÃd_ÿ¡
<q13_tu¶e>(
tu¶e_d©a
);

337  -
	gtu¶e
->
	gCOUNT
;

339 
vœtu®
 
q13_key_exŒaù_t
* 
şÚe
() const {

340  
Ãw
 
q13_key_exŒaù_t
(*
this
);

344 
	gq13_key_com·»_t
 : 
public
 
key_com·»_t


346 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

349 
q13_tu¶e
* 
	ga
 = 
®igÃd_ÿ¡
<q13_tu¶e>(
key1
);

350 
q13_tu¶e
* 
	gb
 = 
®igÃd_ÿ¡
<q13_tu¶e>(
key2
);

351  
	gb
->
	gKEY
 - 
	ga
->KEY;

353 
vœtu®
 
q13_key_com·»_t
* 
şÚe
() const {

354  
Ãw
 
q13_key_com·»_t
(*
this
);

360 şas 
	cch_q13_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t
 {

362 
public
:

364 
vœtu®
 
	$begš
() {

365 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q13 %10s %10s\n",

369 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

370 
q13_tu¶e
* 
r
 = 
®igÃd_ÿ¡
<q13_tu¶e>(
ouut
.
d©a
);

372 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q13 %10d %10d\n",

373 
r
->
KEY
,

374 
r
->
COUNT
);

375 
	}
}

387 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_q13
(cÚ¡ 
xù_id
,

388 
q13_šput_t
& 
š
)

390 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** Q13 *********\n");

392 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

393 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

396 
tu¶e_fifo
* 
q13_cu¡om”_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q13_cu¡om”_sÿn_tu¶e
));

397 
·ck‘_t
* 
q13_cu¡om”_tsÿn_·ck‘
 =

398 
Ãw
 
	`tsÿn_·ck‘_t
("customer TSCAN",

399 
q13_cu¡om”_bufãr
,

400 
Ãw
 
	`q13_cu¡om”_tsÿn_f‹r_t
(
this
),

401 
this
->
	`db
(),

402 
_pcu¡om”_desc
.
	`g‘
(),

403 
pxù


408 
tu¶e_fifo
* 
q13_Üd”s_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q13_Üd”s_sÿn_tu¶e
));

409 
·ck‘_t
* 
q13_Üd”s_tsÿn_·ck‘
 =

410 
Ãw
 
	`tsÿn_·ck‘_t
("orders TSCAN",

411 
q13_Üd”s_bufãr
,

412 
Ãw
 
	`q13_Üd”s_tsÿn_f‹r_t
(
this
,
š
),

413 
this
->
	`db
(),

414 
_pÜd”s_desc
.
	`g‘
(),

415 
pxù


420 
tu¶e_fifo
* 
q13_Üd”s_groupby_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q13_cu¡_Üd”_couÁ_tu¶e
));

421 
·ck‘_t
* 
q13_Üd”s_groupby_·ck‘
 = 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("Orders Group By",

422 
q13_Üd”s_groupby_bufãr
,

423 
Ãw
 
	`ŒivŸl_f‹r_t
((
q13_cu¡_Üd”_couÁ_tu¶e
)),

424 
q13_Üd”s_tsÿn_·ck‘
,

425 
Ãw
 
	`q13_couÁ_agg»g©e_t
(),

426 
Ãw
 
	`št_desc_key_exŒaùÜ_t
(),

427 
Ãw
 
	`št_key_com·»_t
()

431 
tu¶e_fifo
* 
q13_još_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q13_još_tu¶e
));

432 
·ck‘_t
* 
q13_još_·ck‘
 = 
Ãw
 
	`hash_još_·ck‘_t
("Orders - Customer JOIN",

433 
q13_još_bufãr
,

434 
Ãw
 
	`ŒivŸl_f‹r_t
((
q13_još_tu¶e
)),

435 
q13_cu¡om”_tsÿn_·ck‘
,

436 
q13_Üd”s_groupby_·ck‘
,

437 
Ãw
 
	`q13_još_t
(),

438 
Œue
);

442 
tu¶e_fifo
* 
q13_groupby_c_couÁ_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q13_tu¶e
));

443 
·ck‘_t
 *
q13_groupby_c_couÁ_·ck‘
 = 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("c_count SORT",

444 
q13_groupby_c_couÁ_bufãr
,

445 
Ãw
 
	`ŒivŸl_f‹r_t
((
q13_tu¶e
)),

446 
q13_još_·ck‘
,

447 
Ãw
 
	`q13_couÁ_agg»g©e_t
(),

448 
Ãw
 
	`št_desc_key_exŒaùÜ_t
(),

449 
Ãw
 
	`št_key_com·»_t
());

452 
tu¶e_fifo
* 
q13_sÜt_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q13_tu¶e
));

453 
·ck‘_t
 *
q13_sÜt_·ck‘
 = 
Ãw
 
	`sÜt_·ck‘_t
("custdist, c_count SORT",

454 
q13_sÜt_bufãr
,

455 
Ãw
 
	`ŒivŸl_f‹r_t
((
q13_tu¶e
)),

456 
Ãw
 
	`q13_key_exŒaù_t
(),

457 
Ãw
 
	`q13_key_com·»_t
(),

458 
q13_groupby_c_couÁ_·ck‘
);

461 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

463 
q13_Üd”s_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

464 
q13_cu¡om”_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

465 
q13_Üd”s_groupby_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

466 
q13_još_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

467 
q13_groupby_c_couÁ_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

468 
q13_sÜt_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

471 
ch_q13_´oûss_tu¶e_t
 
±
;

473 
	`´oûss_qu”y
(
q13_sÜt_·ck‘
, 
±
);

474 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

478  (
RCOK
);

479 
	}
}

482 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/qpipe/qpipe_q14.cpp

32 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

35 
	~"wÜklßd/ch/ch_ut.h
"

36 
	~"qpe.h
"

38 
usšg
 
Çme¥aû
 
	gshÜe
;

39 
usšg
 
Çme¥aû
 
	gqpe
;

43 
ENTER_NAMESPACE
(
ch
);

61 
	sq14_lše™em_sÿn_tu¶e
 {

62 
	mL_EXTENDEDPRICE
;

63 
	mL_DISCOUNT
;

64 
	mL_PARTKEY
;

67 
	sq14_·¹_sÿn_tu¶e
 {

68 
	mP_PARTKEY
;

69 
	mP_TYPE
[
STRSIZE
(25)];

72 
	sq14_još_tu¶e
 {

73 
	mL_EXTENDEDPRICE
;

74 
	mL_DISCOUNT
;

75 
	mP_TYPE
[
STRSIZE
(25)];

78 
	sq14_agg_tu¶e
 {

79 
	mPROMO_SUM
;

80 
	mTOTAL_SUM
;

81 
	mP_TYPE
[
STRSIZE
(25)];

84 
	sq14_tu¶e
 {

85 
	mPROMO_REVENUE
;

92 şas 
	cq14_lše™em_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


94 
´iv©e
:

95 
ShÜeTPCHEnv
* 
_chdb
;

96 
bË_row_t
* 
	m_´lše
;

97 
»p_row_t
 
	m_¼
;

100 
ch_lše™em_tu¶e
 
	m_lše™em
;

102 
time_t
 
	m_shd©e
;

107 
q14_šput_t
* 
	mq14_šput
;

108 
time_t
 
	md©e1
, 
	md©e2
;

109 
	mpublic
:

110 
	$q14_lše™em_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q14_šput_t
 &
š
)

111 : 
	`tu¶e_f‹r_t
(
chdb
->
	`lše™em_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

114 
_´lše
 = 
_chdb
->
	`lše™em_mª
()->
	`g‘_tu¶e
();

115 
_¼
.
	`£t_ts
(
_chdb
->
	`lše™em_mª
()->
	`ts
(),

116 
_chdb
->
	`lše™em_desc
()->
	`maxsize
());

117 
_´lše
->
_»p
 = &
_¼
;

124 
q14_šput
=&
š
;

125 
d©e1
 = 
q14_šput
->
l_shd©e
;

127 
d©e2
 = 
	`time_add_mÚth
(
d©e1
, 1);

129 
shd©e1
[15];

130 
shd©e2
[15];

132 
	`tim‘_to_¡r
(
shd©e1
, 
d©e1
);

133 
	`tim‘_to_¡r
(
shd©e2
, 
d©e2
);

135 
	`TRACE
(
TRACE_ALWAYS
, "Rªdom…»diÿ‹s:\n% <ğL_SHIPDATE < %s\n", 
shd©e1
, 
shd©e2
);

146 ~
	$q14_lše™em_tsÿn_f‹r_t
()

149 
_chdb
->
	`lše™em_mª
()->
	`give_tu¶e
(
_´lše
);

150 
	}
}

152 
vœtu®
 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

153 
q14_lše™em_sÿn_tu¶e
 *
de¡
;

154 
de¡
 = 
®igÃd_ÿ¡
<
q14_lše™em_sÿn_tu¶e
>(
d
.
d©a
);

156 
_´lše
->
	`g‘_v®ue
(1, 
_lše™em
.
L_PARTKEY
);

157 
_´lše
->
	`g‘_v®ue
(5, 
_lše™em
.
L_EXTENDEDPRICE
);

158 
_´lše
->
	`g‘_v®ue
(6, 
_lše™em
.
L_DISCOUNT
);

165 
de¡
->
L_PARTKEY
=
_lše™em
.L_PARTKEY;

166 
de¡
->
L_EXTENDEDPRICE
 = 
_lše™em
.L_EXTENDEDPRICE/100.0;

167 
de¡
->
L_DISCOUNT
 = 
_lše™em
.L_DISCOUNT/100.0;

168 #w¬nšg 
MA
: 
DiscouÁ
 
äom
 
TPCH
 
dbg’
 
is
 
ü—‹d
 
b‘w“n
 0 
ªd
 100 
š¡—d
 between 0‡nd 1.

169 
	}
}

171 
vœtu®
 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
t
)

173 ià(!
_chdb
->
	`lše™em_mª
()->
	`lßd
(
_´lše
, 
t
.
d©a
)) {

174 
	`as£¹
(
çl£
);

177 
_´lše
->
	`g‘_v®ue
(10, 
_lše™em
.
L_SHIPDATE
, 15);

178 
_shd©e
 = 
	`¡r_to_tim‘
(
_lše™em
.
L_SHIPDATE
);

180 ià(
_shd©e
>=
d©e1
 && _shd©e<
d©e2
)

182  (
Œue
);

186  (
çl£
);

189 
	}
}

190 
vœtu®
 
q14_lše™em_tsÿn_f‹r_t
* 
	$şÚe
() const {

191  
Ãw
 
	`q14_lše™em_tsÿn_f‹r_t
(*
this
);

192 
	}
}

193 
vœtu®
 
c_¡r
 
	$to_¡ršg
() const {

194 * 
d1
=
Ãw
 [15];

195 * 
d2
=
Ãw
 [15];

196 
	`tim‘_to_¡r
(
d1
,
d©e1
);

197 
	`tim‘_to_¡r
(
d2
,
d©e2
);

198 
c_¡r
 
	`»suÉ
("select L_EXTENDEDPRICE, L_DISCOUNT, L_PARTKEY "

200 
d1
, 
d2
);

201 
	`ä“
(
d1
);

202 
	`ä“
(
d2
);

203  
»suÉ
;

204 
	}
}

211 şas 
	cq14_·¹_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


213 
´iv©e
:

214 
ShÜeTPCHEnv
* 
_chdb
;

215 
bË_row_t
* 
	m_´·¹
;

216 
»p_row_t
 
	m_¼
;

219 
ch_·¹_tu¶e
 
	m_·¹
;

220 
	mpublic
:

221 
	$q14_·¹_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
)

222 : 
	`tu¶e_f‹r_t
(
chdb
->
	`·¹_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

225 
_´·¹
 = 
_chdb
->
	`·¹_mª
()->
	`g‘_tu¶e
();

226 
_¼
.
	`£t_ts
(
_chdb
->
	`·¹_mª
()->
	`ts
(),

227 
_chdb
->
	`·¹_desc
()->
	`maxsize
());

228 
_´·¹
->
_»p
 = &
_¼
;

231 ~
	$q14_·¹_tsÿn_f‹r_t
()

234 
_chdb
->
	`·¹_mª
()->
	`give_tu¶e
(
_´·¹
);

235 
	}
}

237 
vœtu®
 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

238 
q14_·¹_sÿn_tu¶e
 *
de¡
;

239 
de¡
 = 
®igÃd_ÿ¡
<
q14_·¹_sÿn_tu¶e
>(
d
.
d©a
);

241 
_´·¹
->
	`g‘_v®ue
(0, 
_·¹
.
P_PARTKEY
);

242 
_´·¹
->
	`g‘_v®ue
(4, 
_·¹
.
P_TYPE
, 25);

248 
de¡
->
P_PARTKEY
=
_·¹
.P_PARTKEY;

249 
	`memıy
(
de¡
->
P_TYPE
, 
_·¹
.P_TYPE, (dest->P_TYPE));

250 
	}
}

252 
vœtu®
 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
t
)

254 ià(!
_chdb
->
	`·¹_mª
()->
	`lßd
(
_´·¹
, 
t
.
d©a
)) {

255 
	`as£¹
(
çl£
);

258  (
Œue
);

259 
	}
}

261 
vœtu®
 
q14_·¹_tsÿn_f‹r_t
* 
	$şÚe
() const {

262  
Ãw
 
	`q14_·¹_tsÿn_f‹r_t
(*
this
);

263 
	}
}

264 
vœtu®
 
c_¡r
 
	$to_¡ršg
() const {

265 
c_¡r
 
	`»suÉ
("select L_EXTENDEDPRICE, L_DISCOUNT, L_PARTKEY ");

266  
»suÉ
;

267 
	}
}

274 
	gq14_još
 : 
tu¶e_još_t
 {

276 
q14_još
()

277 : 
tu¶e_još_t
((
q14_·¹_sÿn_tu¶e
),

278 
off£tof
(
q14_·¹_sÿn_tu¶e
, 
P_PARTKEY
),

279 (
q14_lše™em_sÿn_tu¶e
),

280 
off£tof
(
q14_lše™em_sÿn_tu¶e
, 
L_PARTKEY
),

282 (
q14_još_tu¶e
))

286 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

287 
q14_još_tu¶e
* 
	gde¡
 = 
®igÃd_ÿ¡
<q14_još_tu¶e>(
d
.
d©a
);

288 
q14_·¹_sÿn_tu¶e
* 
	gËá
 = 
®igÃd_ÿ¡
<q14_·¹_sÿn_tu¶e>(
l
.
d©a
);

289 
q14_lše™em_sÿn_tu¶e
* 
	gright
 = 
®igÃd_ÿ¡
<q14_lše™em_sÿn_tu¶e>(
r
.
d©a
);

292 
	gde¡
->
	gL_EXTENDEDPRICE
 = 
right
->
L_EXTENDEDPRICE
;

293 
	gde¡
->
	gL_DISCOUNT
 = 
right
->
L_DISCOUNT
;

294 
memıy
(
de¡
->
P_TYPE
, 
Ëá
->P_TYPE, (dest->P_TYPE));

303 
vœtu®
 
q14_još
* 
şÚe
() const {

304  
Ãw
 
q14_još
(*
this
);

307 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

319 
	gq14_agg»g©e
 : 
tu¶e_agg»g©e_t
 {

320 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

323 
q14_agg»g©e
()

324 : 
tu¶e_agg»g©e_t
((
q14_tu¶e
)),

325 
_exŒaùÜ
(0, 0)

330 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
() {

331  &
	g_exŒaùÜ
;

333 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
t
) {

334 
q14_agg_tu¶e
* 
	gagg
 = 
®igÃd_ÿ¡
<q14_agg_tu¶e>(
agg_d©a
);

335 
q14_još_tu¶e
* 
	gtu¶e
 = 
®igÃd_ÿ¡
<q14_još_tu¶e>(
t
.
d©a
);

337 
	gv®ue
 = 
tu¶e
->
L_EXTENDEDPRICE
*(1 -u¶e->
L_DISCOUNT
);

338 
	gagg
->
	gTOTAL_SUM
 +ğ
v®ue
;

340 ià(
¡r¡r
(
tu¶e
->
P_TYPE
,"PROMO"))

343 
	gagg
->
	gPROMO_SUM
 +ğ
v®ue
;

346 
vœtu®
 
fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

347 
q14_tu¶e
* 
	gde¡
 = 
®igÃd_ÿ¡
<q14_tu¶e>(
d
.
d©a
);

348 
q14_agg_tu¶e
* 
	gagg
 = 
®igÃd_ÿ¡
<q14_agg_tu¶e>(
agg_d©a
);

349 
	gde¡
->
	gPROMO_REVENUE
 = 100.*
agg
->
PROMO_SUM
/agg->
TOTAL_SUM
;

351 
vœtu®
 
q14_agg»g©e
* 
şÚe
() const {

352  
Ãw
 
q14_agg»g©e
(*
this
);

354 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

360 şas 
	cch_q14_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t
 {

362 
public
:

364 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

365 
q14_tu¶e
* 
r
 = 
®igÃd_ÿ¡
<q14_tu¶e>(
ouut
.
d©a
);

366 
	`TRACE
(
TRACE_ALWAYS
, "*** Q14 PromØRev’ue: %5.2lf\n", 
r
->
PROMO_REVENUE
);

369 
	}
};

380 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_q14
(cÚ¡ 
xù_id
,

381 
q14_šput_t
& 
š
)

383 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** Q14 *********\n");

385 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

386 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

389 
tu¶e_fifo
* 
q14_tsÿn_lše™em_out
 = 
Ãw
 
	`tu¶e_fifo
((
q14_lše™em_sÿn_tu¶e
));

390 
tsÿn_·ck‘_t
* 
q14_tsÿn_lše™em_·ck‘
 = 
Ãw
 
	`tsÿn_·ck‘_t
("lineitem TSCAN",

391 
q14_tsÿn_lše™em_out
,

392 
Ãw
 
	`q14_lše™em_tsÿn_f‹r_t
(
this
,
š
),

393 
this
->
	`db
(),

394 
_¶še™em_desc
.
	`g‘
(),

395 
pxù


400 
tu¶e_fifo
* 
q14_tsÿn_·¹_out
 = 
Ãw
 
	`tu¶e_fifo
((
q14_·¹_sÿn_tu¶e
));

401 
tsÿn_·ck‘_t
* 
q14_tsÿn_·¹_·ck‘
 = 
Ãw
 
	`tsÿn_·ck‘_t
("part TSCAN",

402 
q14_tsÿn_·¹_out
,

403 
Ãw
 
	`q14_·¹_tsÿn_f‹r_t
(
this
),

404 
this
->
	`db
(),

405 
_µ¬t_desc
.
	`g‘
(),

406 
pxù


411 
tu¶e_fifo
* 
q14_još_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q14_još_tu¶e
));

412 
·ck‘_t
* 
q14_još_·ck‘
 = 
Ãw
 
	`hash_još_·ck‘_t
("part-lineitem HJOIN",

413 
q14_još_bufãr
,

414 
Ãw
 
	`ŒivŸl_f‹r_t
((
q14_još_tu¶e
)),

415 
q14_tsÿn_·¹_·ck‘
,

416 
q14_tsÿn_lše™em_·ck‘
,

417 
Ãw
 
	`q14_još
());

420 
tu¶e_fifo
* 
q14_agg_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q14_tu¶e
));

421 
·ck‘_t
* 
q14_agg_·ck‘
 = 
Ãw
 
	`agg»g©e_·ck‘_t
("sum AGG",

422 
q14_agg_bufãr
,

423 
Ãw
 
	`ŒivŸl_f‹r_t
((
q14_tu¶e
)),

424 
Ãw
 
	`q14_agg»g©e
(),

425 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
(0, 0),

426 
q14_još_·ck‘
);

429 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

431 
q14_tsÿn_lše™em_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

432 
q14_tsÿn_·¹_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

433 
q14_još_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

434 
q14_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

437 
ch_q14_´oûss_tu¶e_t
 
±
;

440 
	`´oûss_qu”y
(
q14_agg_·ck‘
, 
±
);

441 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

445  (
RCOK
);

446 
	}
}

449 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/qpipe/qpipe_q15.cpp

33 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

34 
	~"wÜklßd/ch/ch_ut.h
"

35 
	~"qpe.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
usšg
 
Çme¥aû
 
	gqpe
;

42 
ENTER_NAMESPACE
(
ch
);

87 
	sq15_´ojeùed_lše™em_tu¶e
 {

88 
	mL_SUPPKEY
;

89 
decim®
 
	mREVENUE
;

92 
	sq15_´ojeùed_suµl›r_tu¶e
 {

93 
	mS_SUPPKEY
;

94 
	mS_NAME
[
STRSIZE
(25)];

95 
	mS_ADDRESS
[
STRSIZE
(40)];

96 
	mS_PHONE
[
STRSIZE
(15)];

99 
	sq15_fš®_tu¶e
 {

100 
	mS_SUPPKEY
;

101 
	mS_NAME
[
STRSIZE
(25)];

102 
	mS_ADDRESS
[
STRSIZE
(40)];

103 
	mS_PHONE
[
STRSIZE
(15)];

104 
decim®
 
	mTOTAL_REVENUE
;

108 şas 
	cq15_lše™em_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


110 
´iv©e
:

111 
ShÜeTPCHEnv
* 
_chdb
;

112 
bË_row_t
* 
	m_´lše
;

113 
»p_row_t
 
	m_¼
;

115 
ch_lše™em_tu¶e
 
	m_lše™em
;

116 
time_t
 
	m_shd©e
;

118 
time_t
 
	m_fœ¡d©e
;

119 
time_t
 
	m_Ï¡d©e
;

121 
	mpublic
:

122 
	$q15_lše™em_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q15_šput_t
 &
š
)

123 : 
	`tu¶e_f‹r_t
(
chdb
->
	`lše™em_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

125 
_´lše
 = 
_chdb
->
	`lše™em_mª
()->
	`g‘_tu¶e
();

126 
_¼
.
	`£t_ts
(
_chdb
->
	`lše™em_mª
()->
	`ts
(),

127 
_chdb
->
	`lše™em_desc
()->
	`maxsize
());

128 
_´lše
->
_»p
 = &
_¼
;

130 
_fœ¡d©e
 = (&
š
)->
l_shd©e
;

131 
tm
 *tm = 
	`gmtime
(&
_fœ¡d©e
);

132 
tm
->
tm_mÚ
 += 3;

133 
_Ï¡d©e
 = 
	`mktime
(
tm
);

135 
f_shd©e
[
	`STRSIZE
(10)];

136 
l_shd©e
[
	`STRSIZE
(10)];

137 
	`tim‘_to_¡r
(
f_shd©e
, 
_fœ¡d©e
);

138 
	`tim‘_to_¡r
(
l_shd©e
, 
_Ï¡d©e
);

140 
	`TRACE
(
TRACE_ALWAYS
, "Rªdom…»diÿ‹:\nLINEITEM.L_SHIPDATE b‘w“À[%s, %s[\n", 
f_shd©e
, 
l_shd©e
);

143 
vœtu®
 ~
	$q15_lše™em_tsÿn_f‹r_t
()

146 
_chdb
->
	`lše™em_mª
()->
	`give_tu¶e
(
_´lše
);

147 
	}
}

149 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

151 ià(!
_chdb
->
	`lše™em_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

152 
	`as£¹
(
çl£
);

155 
_´lše
->
	`g‘_v®ue
(10, 
_lše™em
.
L_SHIPDATE
, (_lineitem.L_SHIPDATE));

156 
_shd©e
 = 
	`¡r_to_tim‘
(
_lše™em
.
L_SHIPDATE
);

158  
_shd©e
 >ğ
_fœ¡d©e
 && _shd©< 
_Ï¡d©e
;

159 
	}
}

161 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

163 
q15_´ojeùed_lše™em_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q15_´ojeùed_lše™em_tu¶e>(
d
.
d©a
);

165 
_´lše
->
	`g‘_v®ue
(2, 
_lše™em
.
L_SUPPKEY
);

166 
_´lše
->
	`g‘_v®ue
(5, 
_lše™em
.
L_EXTENDEDPRICE
);

167 
_´lše
->
	`g‘_v®ue
(6, 
_lše™em
.
L_DISCOUNT
);

171 
de¡
->
L_SUPPKEY
 = 
_lše™em
.L_SUPPKEY;

172 
de¡
->
REVENUE
 = 
_lše™em
.
L_EXTENDEDPRICE
 / 100.0 * (1 - _lše™em.
L_DISCOUNT
 / 100.0);

173 #w¬nšg 
MA
: 
DiscouÁ
 
äom
 
TPCH
 
dbg’
 
is
 
ü—‹d
 
b‘w“n
 0 
ªd
 100 
š¡—d
 between 0‡nd 1.

174 
	}
}

176 
q15_lše™em_tsÿn_f‹r_t
* 
	$şÚe
() const {

177  
Ãw
 
	`q15_lše™em_tsÿn_f‹r_t
(*
this
);

178 
	}
}

180 
c_¡r
 
	$to_¡ršg
() const {

181 
f_shd©e
[
	`STRSIZE
(10)];

182 
l_shd©e
[
	`STRSIZE
(10)];

183 
	`tim‘_to_¡r
(
f_shd©e
, 
_fœ¡d©e
);

184 
	`tim‘_to_¡r
(
l_shd©e
, 
_Ï¡d©e
);

185  
	`c_¡r
("q15_lše™em_tsÿn_f‹r_tÖ_shd©b‘w“À[%s, %s[)", 
f_shd©e
, 
l_shd©e
);

186 
	}
}

190 şas 
	cq15_suµl›r_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


192 
´iv©e
:

193 
ShÜeTPCHEnv
* 
_chdb
;

194 
bË_row_t
* 
	m_´suµl›r
;

195 
»p_row_t
 
	m_¼
;

198 
ch_suµl›r_tu¶e
 
	m_suµl›r
;

200 
	mpublic
:

201 
	$q15_suµl›r_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q15_šput_t
 &
š
)

202 : 
	`tu¶e_f‹r_t
(
chdb
->
	`suµl›r_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

204 
_´suµl›r
 = 
_chdb
->
	`suµl›r_mª
()->
	`g‘_tu¶e
();

205 
_¼
.
	`£t_ts
(
_chdb
->
	`suµl›r_mª
()->
	`ts
(),

206 
_chdb
->
	`suµl›r_desc
()->
	`maxsize
());

207 
_´suµl›r
->
_»p
 = &
_¼
;

210 
vœtu®
 ~
	$q15_suµl›r_tsÿn_f‹r_t
()

212 
_chdb
->
	`suµl›r_mª
()->
	`give_tu¶e
(
_´suµl›r
);

213 
	}
}

215 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

218 ià(!
_chdb
->
	`suµl›r_mª
()->
	`lßd
(
_´suµl›r
, 
šput
.
d©a
)) {

219 
	`as£¹
(
çl£
);

222  
Œue
;

223 
	}
}

226 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

228 
q15_´ojeùed_suµl›r_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q15_´ojeùed_suµl›r_tu¶e>(
d
.
d©a
);

231 
_´suµl›r
->
	`g‘_v®ue
(0, 
_suµl›r
.
S_SUPPKEY
);

232 
_´suµl›r
->
	`g‘_v®ue
(1, 
_suµl›r
.
S_NAME
, (_supplier.S_NAME));

233 
_´suµl›r
->
	`g‘_v®ue
(2, 
_suµl›r
.
S_ADDRESS
, (_supplier.S_ADDRESS));

234 
_´suµl›r
->
	`g‘_v®ue
(4, 
_suµl›r
.
S_PHONE
, (_supplier.S_PHONE));

239 
de¡
->
S_SUPPKEY
 = 
_suµl›r
.S_SUPPKEY;

240 
	`memıy
(
de¡
->
S_NAME
, 
_suµl›r
.S_NAME, (dest->S_NAME));

241 
	`memıy
(
de¡
->
S_ADDRESS
, 
_suµl›r
.S_ADDRESS, (dest->S_ADDRESS));

242 
	`memıy
(
de¡
->
S_PHONE
, 
_suµl›r
.S_PHONE, (dest->S_PHONE));

244 
	}
}

246 
q15_suµl›r_tsÿn_f‹r_t
* 
	$şÚe
() const {

247  
Ãw
 
	`q15_suµl›r_tsÿn_f‹r_t
(*
this
);

248 
	}
}

250 
c_¡r
 
	$to_¡ršg
() const {

251  
	`c_¡r
("q15_supplier_tscan_filter_t");

252 
	}
}

256 
	gq15_lše™em_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

258 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

260 
q15_lše™em_agg»g©e_t
()

261 : 
tu¶e_agg»g©e_t
((
q15_´ojeùed_lše™em_tu¶e
)), 
_exŒaùÜ
((), 
off£tof
(q15_´ojeùed_lše™em_tu¶e, 
L_SUPPKEY
))

265 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
() {

266  &
	g_exŒaùÜ
;

269 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
t
) {

270 
q15_´ojeùed_lše™em_tu¶e
 *
	gagg
 = 
®igÃd_ÿ¡
<q15_´ojeùed_lše™em_tu¶e>(
agg_d©a
);

271 
q15_´ojeùed_lše™em_tu¶e
 *
	gš
 = 
®igÃd_ÿ¡
<q15_´ojeùed_lše™em_tu¶e>(
t
.
d©a
);

273 
	gagg
->
	gREVENUE
 +ğ
š
->
REVENUE
;

275 
vœtu®
 
fšish
(
tu¶e_t
 &
de¡
, cÚ¡ * 
agg_d©a
) {

276 
memıy
(
de¡
.
d©a
, 
agg_d©a
, de¡.
size
);

278 
vœtu®
 
q15_lše™em_agg»g©e_t
* 
şÚe
() const {

279  
Ãw
 
q15_lše™em_agg»g©e_t
(*
this
);

281 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

286 
	gq15_l_sÜt_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

288 
q15_l_sÜt_key_exŒaùÜ_t
()

289 : 
key_exŒaùÜ_t
((
decim®
), 
off£tof
(
q15_´ojeùed_lše™em_tu¶e
, 
REVENUE
))

293 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

294  -(*
	g®igÃd_ÿ¡
<
	gdecim®
>(
	gkey
)).
to_št
();

297 
vœtu®
 
q15_l_sÜt_key_exŒaùÜ_t
* 
şÚe
() const {

298  
Ãw
 
q15_l_sÜt_key_exŒaùÜ_t
(*
this
);

302 
	gq15_l_sÜt_key_com·»_t
 : 
public
 
key_com·»_t
 {

304 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

305 
decim®
 
	g»v1
 = *
®igÃd_ÿ¡
<decim®>(
key1
);

306 
decim®
 
	g»v2
 = *
®igÃd_ÿ¡
<decim®>(
key2
);

307  
	g»v1
 > 
	g»v2
 ? -1 : (
»v1
 < 
»v2
 ? 1 : 0);

310 
vœtu®
 
q15_l_sÜt_key_com·»_t
* 
şÚe
() const {

311  
Ãw
 
q15_l_sÜt_key_com·»_t
(*
this
);

315 
	gq15_max_f‹r_t
 : 
public
 
tu¶e_f‹r_t


317 
decim®
 
_max
;

319 
q15_max_f‹r_t
()

320 : 
tu¶e_f‹r_t
((
q15_´ojeùed_lše™em_tu¶e
)), 
_max
(0)

324 
boŞ
 
£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

325 
q15_´ojeùed_lše™em_tu¶e
 *
	gtu¶e
 = 
®igÃd_ÿ¡
<q15_´ojeùed_lše™em_tu¶e>(
šput
.
d©a
);

326 if(
	g_max
 =ğ0è
_max
 = 
tu¶e
->
REVENUE
;

327  
	gtu¶e
->
	gREVENUE
 =ğ
_max
;

330 
vœtu®
 
q15_max_f‹r_t
* 
şÚe
() const {

331  
Ãw
 
q15_max_f‹r_t
(*
this
);

334 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

335  
c_¡r
("q15_max_filter_t");

341 
	gq15_l_još_s_t
 : 
public
 
tu¶e_još_t
 {

343 
q15_l_još_s_t
()

344 : 
tu¶e_još_t
((
q15_´ojeùed_lše™em_tu¶e
),

345 
off£tof
(
q15_´ojeùed_lše™em_tu¶e
, 
L_SUPPKEY
),

346 (
q15_´ojeùed_suµl›r_tu¶e
),

347 
off£tof
(
q15_´ojeùed_suµl›r_tu¶e
, 
S_SUPPKEY
),

349 (
q15_fš®_tu¶e
))

353 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

354 
q15_fš®_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q15_fš®_tu¶e>(
d
.
d©a
);

355 
q15_´ojeùed_lše™em_tu¶e
 *
	glše
 = 
®igÃd_ÿ¡
<q15_´ojeùed_lše™em_tu¶e>(
l
.
d©a
);

356 
q15_´ojeùed_suµl›r_tu¶e
 *
	gsuµ
 = 
®igÃd_ÿ¡
<q15_´ojeùed_suµl›r_tu¶e>(
r
.
d©a
);

358 
	gde¡
->
	gS_SUPPKEY
 = 
suµ
->
S_SUPPKEY
;

359 
	gde¡
->
	gTOTAL_REVENUE
 = 
lše
->
REVENUE
;

360 
memıy
(
de¡
->
S_ADDRESS
, 
suµ
->S_ADDRESS, (dest->S_ADDRESS));

361 
memıy
(
de¡
->
S_NAME
, 
suµ
->S_NAME, (dest->S_NAME));

362 
memıy
(
de¡
->
S_PHONE
, 
suµ
->S_PHONE, (dest->S_PHONE));

367 
vœtu®
 
q15_l_još_s_t
* 
şÚe
() const {

368  
Ãw
 
q15_l_još_s_t
(*
this
);

371 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

372  
c_¡r
("join LINEITEM, SUPPLIER; select S_SUPPKEY, TOTAL_REVENUE, S_ADDRESS, S_NAME, S_PHONE");

378 şas 
	cch_q15_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t
 {

380 
public
:

382 
vœtu®
 
	$begš
() {

383 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q15 %s %s %s %s %s\n",

387 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

388 
q15_fš®_tu¶e
 *
agg
 = 
®igÃd_ÿ¡
<q15_fš®_tu¶e>(
ouut
.
d©a
);

390 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q15 %d % % % %.4f\n", 
agg
->
S_SUPPKEY
,‡gg->
S_NAME
,‡gg->
S_ADDRESS
,‡gg->
S_PHONE
,‡gg->
TOTAL_REVENUE
.
	`to_doubË
());

391 
	}
}

402 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_q15
(cÚ¡ 
xù_id
,

403 
q15_šput_t
& 
š
)

405 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** q15 *********\n");

407 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

408 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

413 
tu¶e_fifo
* 
q15_suµl›r_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q15_´ojeùed_suµl›r_tu¶e
));

414 
·ck‘_t
* 
q15_suµl›r_tsÿn_·ck‘
 =

415 
Ãw
 
	`tsÿn_·ck‘_t
("supplier TSCAN",

416 
q15_suµl›r_bufãr
,

417 
Ãw
 
	`q15_suµl›r_tsÿn_f‹r_t
(
this
, 
š
),

418 
this
->
	`db
(),

419 
_psuµl›r_desc
.
	`g‘
(),

420 
pxù
);

423 
tu¶e_fifo
* 
q15_lše™em_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q15_´ojeùed_lše™em_tu¶e
));

424 
·ck‘_t
* 
q15_lše™em_tsÿn_·ck‘
 =

425 
Ãw
 
	`tsÿn_·ck‘_t
("lineitem TSCAN",

426 
q15_lše™em_bufãr
,

427 
Ãw
 
	`q15_lše™em_tsÿn_f‹r_t
(
this
, 
š
),

428 
this
->
	`db
(),

429 
_¶še™em_desc
.
	`g‘
(),

430 
pxù
);

433 
tu¶e_fifo
* 
q15_l_agg_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q15_´ojeùed_lše™em_tu¶e
));

434 
·ck‘_t
* 
q15_l_agg_·ck‘
 =

435 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("LINEITEM AGGREGATE",

436 
q15_l_agg_bufãr
,

437 
Ãw
 
	`ŒivŸl_f‹r_t
((
q15_´ojeùed_lše™em_tu¶e
)),

438 
q15_lše™em_tsÿn_·ck‘
,

439 
Ãw
 
	`q15_lše™em_agg»g©e_t
(),

440 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
((), 
	`off£tof
(
q15_´ojeùed_lše™em_tu¶e
, 
L_SUPPKEY
)),

441 
Ãw
 
	`št_key_com·»_t
());

444 
tu¶e_fifo
* 
q15_l_sÜt_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q15_´ojeùed_lše™em_tu¶e
));

445 
·ck‘_t
* 
q15_l_sÜt_·ck‘
 =

446 
Ãw
 
	`sÜt_·ck‘_t
("SORT BY REVENUE",

447 
q15_l_sÜt_bufãr
,

448 
Ãw
 
	`q15_max_f‹r_t
(),

449 
Ãw
 
	`q15_l_sÜt_key_exŒaùÜ_t
(),

450 
Ãw
 
	`q15_l_sÜt_key_com·»_t
(),

451 
q15_l_agg_·ck‘
);

454 
tu¶e_fifo
* 
q15_l_još_s_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q15_fš®_tu¶e
));

455 
·ck‘_t
* 
q15_l_još_s_·ck‘
 =

456 
Ãw
 
	`hash_još_·ck‘_t
("lineitem - supplier HJOIN",

457 
q15_l_još_s_bufãr
,

458 
Ãw
 
	`ŒivŸl_f‹r_t
((
q15_fš®_tu¶e
)),

459 
q15_l_sÜt_·ck‘
,

460 
q15_suµl›r_tsÿn_·ck‘
,

461 
Ãw
 
	`q15_l_još_s_t
());

464 
tu¶e_fifo
* 
q15_sÜt_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q15_fš®_tu¶e
));

465 
·ck‘_t
* 
q15_sÜt_·ck‘
 =

466 
Ãw
 
	`sÜt_·ck‘_t
("SORT BY S_SUPPKEY",

467 
q15_sÜt_bufãr
,

468 
Ãw
 
	`ŒivŸl_f‹r_t
((
q15_fš®_tu¶e
)),

469 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
((), 
	`off£tof
(
q15_fš®_tu¶e
, 
S_SUPPKEY
)),

470 
Ãw
 
	`št_key_com·»_t
(),

471 
q15_l_još_s_·ck‘
);

474 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

475 
q15_suµl›r_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

476 
q15_lše™em_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

477 
q15_l_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

478 
q15_l_sÜt_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

479 
q15_l_još_s_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

480 
q15_sÜt_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

484 
ch_q15_´oûss_tu¶e_t
 
±
;

486 
	`´oûss_qu”y
(
q15_sÜt_·ck‘
, 
±
);

488 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

491  (
RCOK
);

492 
	}
}

495 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/qpipe/qpipe_q16.cpp

33 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

34 
	~"wÜklßd/ch/ch_ut.h
"

35 
	~"qpe.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
usšg
 
Çme¥aû
 
	gqpe
;

42 
ENTER_NAMESPACE
(
ch
);

96 
	sq16_´ojeùed_·¹suµ_tu¶e
 {

97 
	mPS_PARTKEY
;

98 
	mPS_SUPPKEY
;

101 
	sq16_´ojeùed_·¹_tu¶e
 {

102 
	mP_PARTKEY
;

103 
	mP_BRAND
[
STRSIZE
(10)];

104 
	mP_TYPE
[
STRSIZE
(25)];

105 
	mP_SIZE
;

108 
	sq16_´ojeùed_suµl›r_tu¶e
 {

109 
	mS_SUPPKEY
;

112 
	sq16_ps_još_p_tu¶e
 {

113 
	mPS_SUPPKEY
;

114 
	mP_BRAND
[
STRSIZE
(10)];

115 
	mP_TYPE
[
STRSIZE
(25)];

116 
	mP_SIZE
;

119 
	sq16_®l_jošs_tu¶e
 {

120 
	mP_BRAND
[
STRSIZE
(10)];

121 
	mP_TYPE
[
STRSIZE
(25)];

122 
	mP_SIZE
;

123 
	mPS_SUPPKEY
;

126 
	sq16_agg»g©e_tu¶e
 {

127 
	mP_BRAND
[
STRSIZE
(10)];

128 
	mP_TYPE
[
STRSIZE
(25)];

129 
	mP_SIZE
;

130 
	mSUPPLIER_CNT
;

133 
	sq16_agg»g©e_key
 {

134 
	mP_BRAND
[
STRSIZE
(10)];

135 
	mP_TYPE
[
STRSIZE
(25)];

136 
	mP_SIZE
;

139 
	sq16_sÜt_key
 {

140 
	mP_BRAND
[
STRSIZE
(10)];

141 
	mP_TYPE
[
STRSIZE
(25)];

142 
	mP_SIZE
;

143 
	mSUPP_CNT
;

147 şas 
	cq16_·¹suµ_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


149 
´iv©e
:

150 
ShÜeTPCHEnv
* 
_chdb
;

151 
bË_row_t
* 
	m_´·¹suµ
;

152 
»p_row_t
 
	m_¼
;

155 
ch_·¹suµ_tu¶e
 
	m_·¹suµ
;

157 
	mpublic
:

158 
	$q16_·¹suµ_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q16_šput_t
 &
š
)

159 : 
	`tu¶e_f‹r_t
(
chdb
->
	`·¹suµ_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

161 
_´·¹suµ
 = 
_chdb
->
	`·¹suµ_mª
()->
	`g‘_tu¶e
();

162 
_¼
.
	`£t_ts
(
_chdb
->
	`·¹suµ_mª
()->
	`ts
(),

163 
_chdb
->
	`·¹suµ_desc
()->
	`maxsize
());

164 
_´·¹suµ
->
_»p
 = &
_¼
;

167 
vœtu®
 ~
	$q16_·¹suµ_tsÿn_f‹r_t
()

169 
_chdb
->
	`·¹suµ_mª
()->
	`give_tu¶e
(
_´·¹suµ
);

170 
	}
}

172 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

175 ià(!
_chdb
->
	`·¹suµ_mª
()->
	`lßd
(
_´·¹suµ
, 
šput
.
d©a
)) {

176 
	`as£¹
(
çl£
);

179  
Œue
;

180 
	}
}

183 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

185 
q16_´ojeùed_·¹suµ_tu¶e
 *
de¡
;

186 
de¡
 = 
®igÃd_ÿ¡
<
q16_´ojeùed_·¹suµ_tu¶e
>(
d
.
d©a
);

188 
_´·¹suµ
->
	`g‘_v®ue
(0, 
_·¹suµ
.
PS_PARTKEY
);

189 
_´·¹suµ
->
	`g‘_v®ue
(1, 
_·¹suµ
.
PS_SUPPKEY
);

195 
de¡
->
PS_SUPPKEY
 = 
_·¹suµ
.PS_SUPPKEY;

196 
de¡
->
PS_PARTKEY
 = 
_·¹suµ
.PS_PARTKEY;

197 
	}
}

199 
q16_·¹suµ_tsÿn_f‹r_t
* 
	$şÚe
() const {

200  
Ãw
 
	`q16_·¹suµ_tsÿn_f‹r_t
(*
this
);

201 
	}
}

203 
c_¡r
 
	$to_¡ršg
() const {

204  
	`c_¡r
("q16_partsupp_tscan_filter_t()");

205 
	}
}

208 şas 
	cq16_·¹_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


210 
´iv©e
:

211 
ShÜeTPCHEnv
* 
_chdb
;

212 
bË_row_t
* 
	m_´·¹
;

213 
»p_row_t
 
	m_¼
;

216 
ch_·¹_tu¶e
 
	m_·¹
;

218 
	m_ty³
[
STRSIZE
(25)];

219 
	m_ty³2
[
STRSIZE
(25)];

220 
	m_b¿nd
[
STRSIZE
(10)];

221 
	m_size
[8];

223 
q16_šput_t
* 
	mq16_šput
;

225 
	mpublic
:

227 
	$q16_·¹_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q16_šput_t
 &
š
)

228 : 
	`tu¶e_f‹r_t
(
chdb
->
	`·¹_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

230 
_´·¹
 = 
_chdb
->
	`·¹_mª
()->
	`g‘_tu¶e
();

231 
_¼
.
	`£t_ts
(
_chdb
->
	`·¹_mª
()->
	`ts
(),

232 
_chdb
->
	`·¹_desc
()->
	`maxsize
());

233 
_´·¹
->
_»p
 = &
_¼
;

235 
q16_šput
 = &
š
;

236 
	`ty³s1_to_¡r
(
_ty³
, 
q16_šput
->
p_ty³
 / 10);

237 
	`¡rÿt
(
_ty³
, " ");

238 
	`ty³s2_to_¡r
(
_ty³2
, 
q16_šput
->
p_ty³
 % 10);

239 
	`¡rÿt
(
_ty³
, 
_ty³2
);

240 
	`B¿nd_to_¤t
(
_b¿nd
, 
q16_šput
->
p_b¿nd
);

241 
	`memıy
(
_size
, 
q16_šput
->
p_size
, (_size));

243 
	`TRACE
(
TRACE_ALWAYS
, "Random…redicates:\nPART.P_BRAND <> '%s' AND PART.P_TYPE‚ot†ike '%s%%'\nAND P_SIZE in (%d, %d, %d, %d, %d, %d, %d, %d)\n",

244 
_b¿nd
, 
_ty³
, 
_size
[0], _size[1], _size[2], _size[3], _size[4], _size[5], _size[6], _size[7]);

247 
vœtu®
 ~
	$q16_·¹_tsÿn_f‹r_t
()

250 
_chdb
->
	`·¹_mª
()->
	`give_tu¶e
(
_´·¹
);

251 
	}
}

255 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

258 ià(!
_chdb
->
	`·¹_mª
()->
	`lßd
(
_´·¹
, 
šput
.
d©a
)) {

259 
	`as£¹
(
çl£
);

262 
_´·¹
->
	`g‘_v®ue
(3, 
_·¹
.
P_BRAND
, (_part.P_BRAND));

263 
_´·¹
->
	`g‘_v®ue
(4, 
_·¹
.
P_TYPE
, (_part.P_TYPE));

264 
_´·¹
->
	`g‘_v®ue
(5, 
_·¹
.
P_SIZE
);

265 
size
 = 
_·¹
.
P_SIZE
;

267  
	`¡rcmp
(
_·¹
.
P_BRAND
, 
_b¿nd
è!ğ0 && !
	`¡r¡r
(_·¹.
P_TYPE
, 
_ty³
) &&

268 (
size
 =ğ
_size
[0] || size == _size[1] || size == _size[2] || size == _size[3] || size == _size[4] || size == _size[5] || size == _size[6] || size == _size[7]);

269 
	}
}

272 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

274 
q16_´ojeùed_·¹_tu¶e
 *
de¡
;

275 
de¡
 = 
®igÃd_ÿ¡
<
q16_´ojeùed_·¹_tu¶e
>(
d
.
d©a
);

277 
_´·¹
->
	`g‘_v®ue
(0, 
_·¹
.
P_PARTKEY
);

278 
_´·¹
->
	`g‘_v®ue
(3, 
_·¹
.
P_BRAND
, (_part.P_BRAND));

279 
_´·¹
->
	`g‘_v®ue
(4, 
_·¹
.
P_TYPE
, (_part.P_TYPE));

280 
_´·¹
->
	`g‘_v®ue
(5, 
_·¹
.
P_SIZE
);

285 
de¡
->
P_PARTKEY
 = 
_·¹
.P_PARTKEY;

286 
	`memıy
(
de¡
->
P_BRAND
, 
_·¹
.P_BRAND, (dest->P_BRAND));

287 
	`memıy
(
de¡
->
P_TYPE
, 
_·¹
.P_TYPE, (dest->P_TYPE));

288 
de¡
->
P_SIZE
 = 
_·¹
.P_SIZE;

289 
	}
}

291 
q16_·¹_tsÿn_f‹r_t
* 
	$şÚe
() const {

292  
Ãw
 
	`q16_·¹_tsÿn_f‹r_t
(*
this
);

293 
	}
}

295 
c_¡r
 
	$to_¡ršg
() const {

296  
	`c_¡r
("q16_part_tscan_filter_t()");

297 
	}
}

300 şas 
	cq16_suµl›r_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


302 
´iv©e
:

303 
ShÜeTPCHEnv
* 
_chdb
;

304 
bË_row_t
* 
	m_´suµl›r
;

305 
»p_row_t
 
	m_¼
;

308 
ch_suµl›r_tu¶e
 
	m_suµl›r
;

310 
	mpublic
:

311 
	$q16_suµl›r_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q16_šput_t
 &
š
)

312 : 
	`tu¶e_f‹r_t
(
chdb
->
	`suµl›r_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

314 
_´suµl›r
 = 
_chdb
->
	`suµl›r_mª
()->
	`g‘_tu¶e
();

315 
_¼
.
	`£t_ts
(
_chdb
->
	`suµl›r_mª
()->
	`ts
(),

316 
_chdb
->
	`suµl›r_desc
()->
	`maxsize
());

317 
_´suµl›r
->
_»p
 = &
_¼
;

320 
vœtu®
 ~
	$q16_suµl›r_tsÿn_f‹r_t
()

322 
_chdb
->
	`suµl›r_mª
()->
	`give_tu¶e
(
_´suµl›r
);

323 
	}
}

325 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

328 ià(!
_chdb
->
	`suµl›r_mª
()->
	`lßd
(
_´suµl›r
, 
šput
.
d©a
)) {

329 
	`as£¹
(
çl£
);

332 
_´suµl›r
->
	`g‘_v®ue
(6, 
_suµl›r
.
S_COMMENT
, (_supplier.S_COMMENT));

335  !(
	`¡r¡r
(
_suµl›r
.
S_COMMENT
, "Customer") && strstr(_supplier.S_COMMENT, "Complaints"));

336 
	}
}

339 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

341 
q16_´ojeùed_suµl›r_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q16_´ojeùed_suµl›r_tu¶e>(
d
.
d©a
);

344 
_´suµl›r
->
	`g‘_v®ue
(0, 
_suµl›r
.
S_SUPPKEY
);

349 
de¡
->
S_SUPPKEY
 = 
_suµl›r
.S_SUPPKEY;

351 
	}
}

353 
q16_suµl›r_tsÿn_f‹r_t
* 
	$şÚe
() const {

354  
Ãw
 
	`q16_suµl›r_tsÿn_f‹r_t
(*
this
);

355 
	}
}

357 
c_¡r
 
	$to_¡ršg
() const {

358  
	`c_¡r
("q16_supplier_tscan_filter_t");

359 
	}
}

364 
	gq16_ps_još_p_t
 : 
public
 
tu¶e_još_t
 {

366 
q16_ps_još_p_t
()

367 : 
tu¶e_još_t
((
q16_´ojeùed_·¹suµ_tu¶e
),

368 
off£tof
(
q16_´ojeùed_·¹suµ_tu¶e
, 
PS_PARTKEY
),

369 (
q16_´ojeùed_·¹_tu¶e
),

370 
off£tof
(
q16_´ojeùed_·¹_tu¶e
, 
P_PARTKEY
),

372 (
q16_ps_još_p_tu¶e
))

376 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

377 
q16_ps_još_p_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q16_ps_još_p_tu¶e>(
d
.
d©a
);

378 
q16_´ojeùed_·¹suµ_tu¶e
 *
	g·¹suµ
 = 
®igÃd_ÿ¡
<q16_´ojeùed_·¹suµ_tu¶e>(
l
.
d©a
);

379 
q16_´ojeùed_·¹_tu¶e
 *
	g·¹
 = 
®igÃd_ÿ¡
<q16_´ojeùed_·¹_tu¶e>(
r
.
d©a
);

381 
	gde¡
->
	gPS_SUPPKEY
 = 
·¹suµ
->
PS_SUPPKEY
;

382 
memıy
(
de¡
->
P_BRAND
, 
·¹
->P_BRAND, (dest->P_BRAND));

383 
	gde¡
->
	gP_SIZE
 = 
·¹
->
P_SIZE
;

384 
memıy
(
de¡
->
P_TYPE
, 
·¹
->P_TYPE, (dest->P_TYPE));

389 
vœtu®
 
q16_ps_još_p_t
* 
şÚe
() const {

390  
Ãw
 
q16_ps_još_p_t
(*
this
);

393 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

394  
c_¡r
("join PARTSUPP, PART; select PS_SUPPKEY, P_BRAND, P_SIZE, P_TYPE");

398 
	gq16_ps_p_još_s_t
 : 
public
 
tu¶e_još_t
 {

400 
q16_ps_p_još_s_t
()

401 : 
tu¶e_još_t
((
q16_ps_još_p_tu¶e
),

402 
off£tof
(
q16_ps_još_p_tu¶e
, 
PS_SUPPKEY
),

403 (
q16_´ojeùed_suµl›r_tu¶e
),

404 
off£tof
(
q16_´ojeùed_suµl›r_tu¶e
, 
S_SUPPKEY
),

406 (
q16_®l_jošs_tu¶e
))

410 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

411 
q16_®l_jošs_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q16_®l_jošs_tu¶e>(
d
.
d©a
);

412 
q16_ps_još_p_tu¶e
 *
	gËá
 = 
®igÃd_ÿ¡
<q16_ps_još_p_tu¶e>(
l
.
d©a
);

413 
q16_´ojeùed_suµl›r_tu¶e
 *
	gsuµ
 = 
®igÃd_ÿ¡
<q16_´ojeùed_suµl›r_tu¶e>(
r
.
d©a
);

415 
	gde¡
->
	gPS_SUPPKEY
 = 
Ëá
->
PS_SUPPKEY
;

416 
memıy
(
de¡
->
P_BRAND
, 
Ëá
->P_BRAND, (dest->P_BRAND));

417 
	gde¡
->
	gP_SIZE
 = 
Ëá
->
P_SIZE
;

418 
memıy
(
de¡
->
P_TYPE
, 
Ëá
->P_TYPE, (dest->P_TYPE));

423 
vœtu®
 
q16_ps_p_još_s_t
* 
şÚe
() const {

424  
Ãw
 
q16_ps_p_još_s_t
(*
this
);

427 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

428  
c_¡r
("join PARTSUPP_PART, SUPPLIER; select PS_SUPPKEY, P_BRAND, P_SIZE, P_TYPE");

433 şas 
	cq16_di¡šù_t
 : 
public
 
tu¶e_agg»g©e_t
 {

435 
public
:

437 şas 
	cq16_di¡šù_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

438 
public
:

439 
q16_di¡šù_key_exŒaùÜ_t
()

440 : 
key_exŒaùÜ_t
((
q16_®l_jošs_tu¶e
))

444 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
tu¶e_d©a
) const {

446 
q16_®l_jošs_tu¶e
 *
™em
;

447 
	m™em
 = 
®igÃd_ÿ¡
<
q16_®l_jošs_tu¶e
>(
tu¶e_d©a
);

449  (
	m™em
->
	mP_BRAND
[0] << 24) + (item->P_BRAND[1] << 16) + (item->P_BRAND[2] << 8) + item->P_BRAND[3];

452 
vœtu®
 
key_exŒaùÜ_t
* 
şÚe
() const {

453  
Ãw
 
q16_di¡šù_key_exŒaùÜ_t
(*
this
);

457 
	g´iv©e
:

459 
q16_di¡šù_key_exŒaùÜ_t
 
_exŒaùÜ
;

461 
	gpublic
:

463 
	$q16_di¡šù_t
()

464 : 
	`tu¶e_agg»g©e_t
((
q16_®l_jošs_tu¶e
)),

465 
	$_exŒaùÜ
()

467 
	}
}

469 
vœtu®
 
key_exŒaùÜ_t
* 
	$key_exŒaùÜ
(è{  &
_exŒaùÜ
; 
	}
}

471 
vœtu®
 
	$agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
& 
¤c
) {

473 
	}
}

475 
vœtu®
 
	$fšish
(
tu¶e_t
 &
de¡
, cÚ¡ * 
agg_d©a
) {

476 
	`memıy
(
de¡
.
d©a
, 
agg_d©a
, (
q16_®l_jošs_tu¶e
));

477 
	}
}

479 
vœtu®
 
q16_di¡šù_t
* 
	$şÚe
() const {

480  
Ãw
 
	`q16_di¡šù_t
(*
this
);

481 
	}
}

483 
vœtu®
 
c_¡r
 
	$to_¡ršg
() const {

485 
	}
}

488 
	gq16_key_com·»_t
 : 
public
 
key_com·»_t
 {

490 
boŞ
 
_di¡šù
;

492 
q16_key_com·»_t
(
boŞ
 
di¡šù
)

493 : 
_di¡šù
(
di¡šù
)

497 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

498 
	gdiff_b¿nd
;

499 
	gdiff_ty³
;

500 
	gdiff_size
;

501 if(
	g_di¡šù
) {

502 
q16_®l_jošs_tu¶e
 *
	gk1
 = 
®igÃd_ÿ¡
<q16_®l_jošs_tu¶e>(
key1
);

503 
q16_®l_jošs_tu¶e
 *
	gk2
 = 
®igÃd_ÿ¡
<q16_®l_jošs_tu¶e>(
key2
);

504 
	gdiff_b¿nd
 = 
¡rcmp
(
k1
->
P_BRAND
, 
k2
->P_BRAND);

505 
	gdiff_ty³
 = 
¡rcmp
(
k1
->
P_TYPE
, 
k2
->P_TYPE);

506 
	gdiff_size
 = 
k1
->
P_SIZE
 - 
k2
->P_SIZE;

507 (
	gdiff_b¿nd
 !ğ0 ? 
diff_b¿nd
 : (
diff_ty³
 !ğ0 ? diff_ty³ : (
diff_size
 !ğ0 ? diff_siz: 
k1
->
PS_SUPPKEY
 - 
k2
->PS_SUPPKEY)));

510 
q16_agg»g©e_key
 *
	gk1
 = 
®igÃd_ÿ¡
<q16_agg»g©e_key>(
key1
);

511 
q16_agg»g©e_key
 *
	gk2
 = 
®igÃd_ÿ¡
<q16_agg»g©e_key>(
key2
);

512 
	gdiff_b¿nd
 = 
¡rcmp
(
k1
->
P_BRAND
, 
k2
->P_BRAND);

513 
	gdiff_ty³
 = 
¡rcmp
(
k1
->
P_TYPE
, 
k2
->P_TYPE);

514 
	gdiff_size
 = 
k1
->
P_SIZE
 - 
k2
->P_SIZE;

515 (
	gdiff_b¿nd
 !ğ0 ? 
diff_b¿nd
 : (
diff_ty³
 !ğ0 ? diff_ty³ : 
diff_size
));

519 
vœtu®
 
q16_key_com·»_t
* 
şÚe
() const {

520  
Ãw
 
q16_key_com·»_t
(*
this
);

524 şas 
	cq16_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

525 
public
:

527 şas 
	cq16_agg_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

528 
public
:

529 
q16_agg_key_exŒaùÜ_t
()

530 : 
key_exŒaùÜ_t
((
q16_agg»g©e_key
))

534 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
tu¶e_d©a
) const {

535 
q16_agg»g©e_key
 *
™em
;

536 
	m™em
 = 
®igÃd_ÿ¡
<
q16_agg»g©e_key
>(
tu¶e_d©a
);

538  (
	m™em
->
	mP_BRAND
[0] << 24) + (item->P_BRAND[1] << 16) + (item->P_BRAND[2] << 8) + item->P_BRAND[3];

541 
vœtu®
 
q16_agg_key_exŒaùÜ_t
* 
şÚe
() const {

542  
Ãw
 
q16_agg_key_exŒaùÜ_t
(*
this
);

546 
	g´iv©e
:

548 
q16_agg_key_exŒaùÜ_t
 
_exŒaùÜ
;

550 
	gpublic
:

552 
	$q16_agg»g©e_t
()

553 : 
	`tu¶e_agg»g©e_t
((
q16_agg»g©e_tu¶e
)),

554 
	$_exŒaùÜ
()

556 
	}
}

558 
vœtu®
 
key_exŒaùÜ_t
* 
	$key_exŒaùÜ
(è{  &
_exŒaùÜ
; 
	}
}

560 
vœtu®
 
	$agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
& 
¤c
) {

561 
q16_agg»g©e_tu¶e
 *
out
 = 
®igÃd_ÿ¡
<q16_agg»g©e_tu¶e>(
agg_d©a
);

562 
q16_®l_jošs_tu¶e
 *
š
 = 
®igÃd_ÿ¡
<q16_®l_jošs_tu¶e>(
¤c
.
d©a
);

563 
out
->
SUPPLIER_CNT
++;

565 
	}
}

567 
vœtu®
 
	$fšish
(
tu¶e_t
 &
de¡
, cÚ¡ * 
agg_d©a
) {

568 
	`memıy
(
de¡
.
d©a
, 
agg_d©a
, de¡.
size
);

569 
	}
}

571 
vœtu®
 
q16_agg»g©e_t
* 
	$şÚe
() const {

572  
Ãw
 
	`q16_agg»g©e_t
(*
this
);

573 
	}
}

575 
vœtu®
 
c_¡r
 
	$to_¡ršg
() const {

577 
	}
}

580 
	gq16_sÜt_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

582 
q16_sÜt_key_exŒaùÜ_t
()

583 : 
key_exŒaùÜ_t
((
q16_sÜt_key
))

587 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

588 
q16_sÜt_key
 *
k
 = 
®igÃd_ÿ¡
<q16_sÜt_key>(
key
);

589  -(
	gk
->
	gSUPP_CNT
);

592 
vœtu®
 
q16_sÜt_key_exŒaùÜ_t
* 
şÚe
() const {

593  
Ãw
 
q16_sÜt_key_exŒaùÜ_t
(*
this
);

597 
	gq16_sÜt_key_com·»_t
 : 
public
 
key_com·»_t
 {

599 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

600 
q16_sÜt_key
 *
	gk1
 = 
®igÃd_ÿ¡
<q16_sÜt_key>(
key1
);

601 
q16_sÜt_key
 *
	gk2
 = 
®igÃd_ÿ¡
<q16_sÜt_key>(
key2
);

603 
	gdiff_út
 = 
k2
->
SUPP_CNT
 - 
k1
->SUPP_CNT;

604 
	gdiff_b¿nd
 = 
¡rcmp
(
k1
->
P_BRAND
, 
k2
->P_BRAND);

605 
	gdiff_ty³
 = 
¡rcmp
(
k1
->
P_TYPE
, 
k2
->P_TYPE);

606  (
	gdiff_út
 !ğ0 ? 
diff_út
 : (
diff_b¿nd
 !ğ0 ? diff_b¿nd : (
diff_ty³
 !ğ0 ? diff_ty³ : 
k1
->
P_SIZE
 - 
k2
->P_SIZE)));

609 
vœtu®
 
q16_sÜt_key_com·»_t
* 
şÚe
() const {

610  
Ãw
 
q16_sÜt_key_com·»_t
(*
this
);

616 şas 
	cch_q16_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t
 {

618 
public
:

620 
vœtu®
 
	$begš
() {

621 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q16 %s %s %s %s\n",

625 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

626 
q16_agg»g©e_tu¶e
 *
agg
 = 
®igÃd_ÿ¡
<q16_agg»g©e_tu¶e>(
ouut
.
d©a
);

628 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q16 % % %d %d\n", 
agg
->
P_BRAND
,‡gg->
P_TYPE
,‡gg->
P_SIZE
,‡gg->
SUPPLIER_CNT
);

629 
	}
}

640 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_q16
(cÚ¡ 
xù_id
,

641 
q16_šput_t
& 
š
)

643 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** q16 *********\n");

645 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

646 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

650 
tu¶e_fifo
* 
q16_·¹suµ_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q16_´ojeùed_·¹suµ_tu¶e
));

651 
·ck‘_t
* 
q16_·¹suµ_tsÿn_·ck‘
 =

652 
Ãw
 
	`tsÿn_·ck‘_t
("partsupp TSCAN",

653 
q16_·¹suµ_bufãr
,

654 
Ãw
 
	`q16_·¹suµ_tsÿn_f‹r_t
(
this
, 
š
),

655 
this
->
	`db
(),

656 
_µ¬tsuµ_desc
.
	`g‘
(),

657 
pxù
);

660 
tu¶e_fifo
* 
q16_·¹_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q16_´ojeùed_·¹_tu¶e
));

661 
·ck‘_t
* 
q16_·¹_tsÿn_·ck‘
 =

662 
Ãw
 
	`tsÿn_·ck‘_t
("part TSCAN",

663 
q16_·¹_bufãr
,

664 
Ãw
 
	`q16_·¹_tsÿn_f‹r_t
(
this
, 
š
),

665 
this
->
	`db
(),

666 
_µ¬t_desc
.
	`g‘
(),

667 
pxù
);

670 
tu¶e_fifo
* 
q16_suµl›r_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q16_´ojeùed_suµl›r_tu¶e
));

671 
·ck‘_t
* 
q16_suµl›r_tsÿn_·ck‘
 =

672 
Ãw
 
	`tsÿn_·ck‘_t
("supplier TSCAN",

673 
q16_suµl›r_bufãr
,

674 
Ãw
 
	`q16_suµl›r_tsÿn_f‹r_t
(
this
, 
š
),

675 
this
->
	`db
(),

676 
_psuµl›r_desc
.
	`g‘
(),

677 
pxù
);

681 
tu¶e_fifo
* 
q16_ps_još_p_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q16_ps_još_p_tu¶e
));

682 
·ck‘_t
* 
q16_ps_još_p_·ck‘
 =

683 
Ãw
 
	`hash_još_·ck‘_t
("partsupp -…art HJOIN",

684 
q16_ps_još_p_bufãr
,

685 
Ãw
 
	`ŒivŸl_f‹r_t
((
q16_ps_još_p_tu¶e
)),

686 
q16_·¹suµ_tsÿn_·ck‘
,

687 
q16_·¹_tsÿn_·ck‘
,

688 
Ãw
 
	`q16_ps_još_p_t
());

691 
tu¶e_fifo
* 
q16_ps_p_još_s_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q16_®l_jošs_tu¶e
));

692 
·ck‘_t
* 
q16_ps_p_još_s_·ck‘
 =

693 
Ãw
 
	`hash_još_·ck‘_t
("partsupp_part - supplier HJOIN",

694 
q16_ps_p_još_s_bufãr
,

695 
Ãw
 
	`ŒivŸl_f‹r_t
((
q16_®l_jošs_tu¶e
)),

696 
q16_ps_još_p_·ck‘
,

697 
q16_suµl›r_tsÿn_·ck‘
,

698 
Ãw
 
	`q16_ps_p_još_s_t
());

701 
tu¶e_fifo
* 
q16_di¡šù_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q16_®l_jošs_tu¶e
));

702 
·ck‘_t
* 
q16_di¡šù_·ck‘
 =

703 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("DISTINCT AGG",

704 
q16_di¡šù_bufãr
,

705 
Ãw
 
	`ŒivŸl_f‹r_t
((
q16_®l_jošs_tu¶e
)),

706 
q16_ps_p_još_s_·ck‘
,

707 
Ãw
 
	`q16_di¡šù_t
(),

708 
Ãw
 
q16_di¡šù_t
::
	`q16_di¡šù_key_exŒaùÜ_t
(),

709 
Ãw
 
	`q16_key_com·»_t
(
Œue
));

712 
tu¶e_fifo
* 
q16_agg_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q16_agg»g©e_tu¶e
));

713 
·ck‘_t
* 
q16_agg_·ck‘
 =

714 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("GROUP BY AGG",

715 
q16_agg_bufãr
,

716 
Ãw
 
	`ŒivŸl_f‹r_t
((
q16_agg»g©e_tu¶e
)),

717 
q16_di¡šù_·ck‘
,

718 
Ãw
 
	`q16_agg»g©e_t
(),

719 
Ãw
 
q16_agg»g©e_t
::
	`q16_agg_key_exŒaùÜ_t
(),

720 
Ãw
 
	`q16_key_com·»_t
(
çl£
));

723 
tu¶e_fifo
* 
q16_sÜt_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q16_agg»g©e_tu¶e
));

724 
·ck‘_t
* 
q16_sÜt_·ck‘
 =

725 
Ãw
 
	`sÜt_·ck‘_t
("ORDER BY SUPP_CNT",

726 
q16_sÜt_bufãr
,

727 
Ãw
 
	`ŒivŸl_f‹r_t
((
q16_agg»g©e_tu¶e
)),

728 
Ãw
 
	`q16_sÜt_key_exŒaùÜ_t
(),

729 
Ãw
 
	`q16_sÜt_key_com·»_t
(),

730 
q16_agg_·ck‘
);

733 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

734 
q16_·¹suµ_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

735 
q16_·¹_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

736 
q16_suµl›r_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

737 
q16_ps_još_p_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

738 
q16_ps_p_još_s_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

739 
q16_di¡šù_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

740 
q16_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

741 
q16_sÜt_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

745 
ch_q16_´oûss_tu¶e_t
 
±
;

747 
	`´oûss_qu”y
(
q16_sÜt_·ck‘
, 
±
);

749 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

752  (
RCOK
);

753 
	}
}

755 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/qpipe/qpipe_q17.cpp

33 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

34 
	~"wÜklßd/ch/ch_ut.h
"

35 
	~"qpe.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
usšg
 
Çme¥aû
 
	gqpe
;

42 
ENTER_NAMESPACE
(
ch
);

71 
	sq17_´ojeùed_lše™em_sub_tu¶e
 {

72 
	mL_PARTKEY
;

73 
decim®
 
	mL_QUANTITY
;

76 
	sq17_´ojeùed_·¹_tu¶e
 {

77 
	mP_PARTKEY
;

80 
	sq17_´ojeùed_lše™em_tu¶e
 {

81 
	mL_PARTKEY
;

82 
decim®
 
	mL_QUANTITY
;

83 
decim®
 
	mL_EXTENDEDPRICE
;

86 
	sq17_sub_agg»g©e_tu¶e
 {

87 
	mL_PARTKEY
;

88 
decim®
 
	mL_QUANTITY_SUM
;

89 
	mL_COUNT
;

90 
decim®
 
	mAVG_QTY
;

93 
	sq17_l_još_p_tu¶e
 {

94 
	mP_PARTKEY
;

95 
decim®
 
	mL_EXTENDEDPRICE
;

96 
decim®
 
	mL_QUANTITY
;

99 
	sq17_®l_još_tu¶e
 {

100 
decim®
 
	mL_EXTENDEDPRICE
;

101 
decim®
 
	mAVG_QTY
;

102 
decim®
 
	mL_QUANTITY
;

105 
	sq17_fš®_tu¶e
 {

106 
decim®
 
	mAVG_YEARLY
;

110 şas 
	cq17_lše™em_sub_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


112 
´iv©e
:

113 
ShÜeTPCHEnv
* 
_chdb
;

114 
bË_row_t
* 
	m_´lše
;

115 
»p_row_t
 
	m_¼
;

117 
ch_lše™em_tu¶e
 
	m_lše™em
;

119 
	mpublic
:

120 
	$q17_lše™em_sub_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q17_šput_t
 &
š
)

121 : 
	`tu¶e_f‹r_t
(
chdb
->
	`lše™em_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

123 
_´lše
 = 
_chdb
->
	`lše™em_mª
()->
	`g‘_tu¶e
();

124 
_¼
.
	`£t_ts
(
_chdb
->
	`lše™em_mª
()->
	`ts
(),

125 
_chdb
->
	`lše™em_desc
()->
	`maxsize
());

126 
_´lše
->
_»p
 = &
_¼
;

129 
vœtu®
 ~
	$q17_lše™em_sub_tsÿn_f‹r_t
()

132 
_chdb
->
	`lše™em_mª
()->
	`give_tu¶e
(
_´lše
);

133 
	}
}

135 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

137 ià(!
_chdb
->
	`lše™em_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

138 
	`as£¹
(
çl£
);

141  
Œue
;

142 
	}
}

144 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

146 
q17_´ojeùed_lše™em_sub_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q17_´ojeùed_lše™em_sub_tu¶e>(
d
.
d©a
);

148 
_´lše
->
	`g‘_v®ue
(1, 
_lše™em
.
L_PARTKEY
);

149 
_´lše
->
	`g‘_v®ue
(4, 
_lše™em
.
L_QUANTITY
);

153 
de¡
->
L_PARTKEY
 = 
_lše™em
.L_PARTKEY;

154 
de¡
->
L_QUANTITY
 = 
_lše™em
.L_QUANTITY;

155 
	}
}

157 
q17_lše™em_sub_tsÿn_f‹r_t
* 
	$şÚe
() const {

158  
Ãw
 
	`q17_lše™em_sub_tsÿn_f‹r_t
(*
this
);

159 
	}
}

161 
c_¡r
 
	$to_¡ršg
() const {

162  
	`c_¡r
("q17_lineitem_sub_tscan_filter_t()");

163 
	}
}

166 şas 
	cq17_·¹_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


168 
´iv©e
:

169 
ShÜeTPCHEnv
* 
_chdb
;

170 
bË_row_t
* 
	m_´·¹
;

171 
»p_row_t
 
	m_¼
;

174 
ch_·¹_tu¶e
 
	m_·¹
;

176 
	m_cÚš”
[
STRSIZE
(10)];

177 
	m_b¿nd
[
STRSIZE
(10)];

179 
q17_šput_t
* 
	mq17_šput
;

181 
	mpublic
:

183 
	$q17_·¹_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q17_šput_t
 &
š
)

184 : 
	`tu¶e_f‹r_t
(
chdb
->
	`·¹_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

186 
_´·¹
 = 
_chdb
->
	`·¹_mª
()->
	`g‘_tu¶e
();

187 
_¼
.
	`£t_ts
(
_chdb
->
	`·¹_mª
()->
	`ts
(),

188 
_chdb
->
	`·¹_desc
()->
	`maxsize
());

189 
_´·¹
->
_»p
 = &
_¼
;

191 
q17_šput
 = &
š
;

192 
	`B¿nd_to_¤t
(
_b¿nd
, 
q17_šput
->
p_b¿nd
);

193 
	`cÚš”_to_¡r
(
q17_šput
->
p_cÚš”
, 
_cÚš”
);

195 
	`TRACE
(
TRACE_ALWAYS
, "Random…redicates:\nPART.P_BRAND = '%s' AND PART.P_CONTAINER = '%s'\n",

196 
_b¿nd
, 
_cÚš”
);

199 
vœtu®
 ~
	$q17_·¹_tsÿn_f‹r_t
()

202 
_chdb
->
	`·¹_mª
()->
	`give_tu¶e
(
_´·¹
);

203 
	}
}

207 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

210 ià(!
_chdb
->
	`·¹_mª
()->
	`lßd
(
_´·¹
, 
šput
.
d©a
)) {

211 
	`as£¹
(
çl£
);

214 
_´·¹
->
	`g‘_v®ue
(3, 
_·¹
.
P_BRAND
, (_part.P_BRAND));

215 
_´·¹
->
	`g‘_v®ue
(6, 
_·¹
.
P_CONTAINER
, (_part.P_CONTAINER));

217  
	`¡rcmp
(
_·¹
.
P_BRAND
, 
_b¿nd
è=ğ0 && sŒcmp(_·¹.
P_CONTAINER
, 
_cÚš”
) == 0;

218 
	}
}

221 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

223 
q17_´ojeùed_·¹_tu¶e
 *
de¡
;

224 
de¡
 = 
®igÃd_ÿ¡
<
q17_´ojeùed_·¹_tu¶e
>(
d
.
d©a
);

226 
_´·¹
->
	`g‘_v®ue
(0, 
_·¹
.
P_PARTKEY
);

230 
de¡
->
P_PARTKEY
 = 
_·¹
.P_PARTKEY;

231 
	}
}

233 
q17_·¹_tsÿn_f‹r_t
* 
	$şÚe
() const {

234  
Ãw
 
	`q17_·¹_tsÿn_f‹r_t
(*
this
);

235 
	}
}

237 
c_¡r
 
	$to_¡ršg
() const {

238  
	`c_¡r
("q17_part_tscan_filter_t()");

239 
	}
}

242 şas 
	cq17_lše™em_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


244 
´iv©e
:

245 
ShÜeTPCHEnv
* 
_chdb
;

246 
bË_row_t
* 
	m_´lše
;

247 
»p_row_t
 
	m_¼
;

249 
ch_lše™em_tu¶e
 
	m_lše™em
;

251 
	mpublic
:

252 
	$q17_lše™em_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q17_šput_t
 &
š
)

253 : 
	`tu¶e_f‹r_t
(
chdb
->
	`lše™em_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

255 
_´lše
 = 
_chdb
->
	`lše™em_mª
()->
	`g‘_tu¶e
();

256 
_¼
.
	`£t_ts
(
_chdb
->
	`lše™em_mª
()->
	`ts
(),

257 
_chdb
->
	`lše™em_desc
()->
	`maxsize
());

258 
_´lše
->
_»p
 = &
_¼
;

261 
vœtu®
 ~
	$q17_lše™em_tsÿn_f‹r_t
()

264 
_chdb
->
	`lše™em_mª
()->
	`give_tu¶e
(
_´lše
);

265 
	}
}

267 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

269 ià(!
_chdb
->
	`lše™em_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

270 
	`as£¹
(
çl£
);

273  
Œue
;

274 
	}
}

276 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

278 
q17_´ojeùed_lše™em_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q17_´ojeùed_lše™em_tu¶e>(
d
.
d©a
);

280 
_´lše
->
	`g‘_v®ue
(1, 
_lše™em
.
L_PARTKEY
);

281 
_´lše
->
	`g‘_v®ue
(4, 
_lše™em
.
L_QUANTITY
);

282 
_´lše
->
	`g‘_v®ue
(5, 
_lše™em
.
L_EXTENDEDPRICE
);

286 
de¡
->
L_PARTKEY
 = 
_lše™em
.L_PARTKEY;

287 
de¡
->
L_QUANTITY
 = 
_lše™em
.L_QUANTITY;

288 
de¡
->
L_EXTENDEDPRICE
 = 
_lše™em
.L_EXTENDEDPRICE / 100.0;

289 
	}
}

291 
q17_lše™em_tsÿn_f‹r_t
* 
	$şÚe
() const {

292  
Ãw
 
	`q17_lše™em_tsÿn_f‹r_t
(*
this
);

293 
	}
}

295 
c_¡r
 
	$to_¡ršg
() const {

296  
	`c_¡r
("q17_lineitem_tscan_filter_t()");

297 
	}
}

301 
	gq17_sub_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

303 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

305 
q17_sub_agg»g©e_t
()

306 : 
tu¶e_agg»g©e_t
((
q17_sub_agg»g©e_tu¶e
)), 
_exŒaùÜ
((), 
off£tof
(
q17_´ojeùed_lše™em_sub_tu¶e
, 
L_PARTKEY
))

310 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
() {

311  &
	g_exŒaùÜ
;

314 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
t
) {

315 
q17_sub_agg»g©e_tu¶e
 *
	gagg
 = 
®igÃd_ÿ¡
<q17_sub_agg»g©e_tu¶e>(
agg_d©a
);

316 
q17_´ojeùed_lše™em_sub_tu¶e
 *
	gšput
 = 
®igÃd_ÿ¡
<q17_´ojeùed_lše™em_sub_tu¶e>(
t
.
d©a
);

318 
	gagg
->
	gL_QUANTITY_SUM
 +ğ
šput
->
L_QUANTITY
;

319 
	gagg
->
	gL_COUNT
++;

321 
vœtu®
 
fšish
(
tu¶e_t
 &
de¡
, cÚ¡ * 
agg_d©a
) {

322 
memıy
(
de¡
.
d©a
, 
agg_d©a
, de¡.
size
);

323 
q17_sub_agg»g©e_tu¶e
 *
	gagg
 = 
®igÃd_ÿ¡
<q17_sub_agg»g©e_tu¶e>(
de¡
.
d©a
);

324 
	gagg
->
	gAVG_QTY
 = 
agg
->
L_QUANTITY_SUM
.
to_doubË
(è/‡gg->
L_COUNT
;

327 
vœtu®
 
q17_sub_agg»g©e_t
* 
şÚe
() const {

328  
Ãw
 
q17_sub_agg»g©e_t
(*
this
);

330 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

335 
	gq17_l_još_p_t
 : 
public
 
tu¶e_još_t
 {

337 
q17_l_još_p_t
()

338 : 
tu¶e_još_t
((
q17_´ojeùed_lše™em_tu¶e
),

339 
off£tof
(
q17_´ojeùed_lše™em_tu¶e
, 
L_PARTKEY
),

340 (
q17_´ojeùed_·¹_tu¶e
),

341 
off£tof
(
q17_´ojeùed_·¹_tu¶e
, 
P_PARTKEY
),

343 (
q17_l_još_p_tu¶e
))

347 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

348 
q17_l_još_p_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q17_l_još_p_tu¶e>(
d
.
d©a
);

349 
q17_´ojeùed_lše™em_tu¶e
 *
	glše
 = 
®igÃd_ÿ¡
<q17_´ojeùed_lše™em_tu¶e>(
l
.
d©a
);

350 
q17_´ojeùed_·¹_tu¶e
 *
	g·¹
 = 
®igÃd_ÿ¡
<q17_´ojeùed_·¹_tu¶e>(
r
.
d©a
);

352 
	gde¡
->
	gP_PARTKEY
 = 
·¹
->
P_PARTKEY
;

353 
	gde¡
->
	gL_EXTENDEDPRICE
 = 
lše
->
L_EXTENDEDPRICE
;

354 
	gde¡
->
	gL_QUANTITY
 = 
lše
->
L_QUANTITY
;

359 
vœtu®
 
q17_l_još_p_t
* 
şÚe
() const {

360  
Ãw
 
q17_l_još_p_t
(*
this
);

363 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

364  
c_¡r
("join LINEITEM, PART; select P_PARTKEY, L_EXTENDEDPRICE, L_QUANTITY");

368 
	gq17_fš®_još_t
 : 
public
 
tu¶e_još_t
 {

370 
q17_fš®_još_t
()

371 : 
tu¶e_još_t
((
q17_sub_agg»g©e_tu¶e
),

372 
off£tof
(
q17_sub_agg»g©e_tu¶e
, 
L_PARTKEY
),

373 (
q17_l_još_p_tu¶e
),

374 
off£tof
(
q17_l_još_p_tu¶e
, 
P_PARTKEY
),

376 (
q17_®l_još_tu¶e
))

380 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

381 
q17_®l_još_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q17_®l_još_tu¶e>(
d
.
d©a
);

382 
q17_sub_agg»g©e_tu¶e
 *
	gsub
 = 
®igÃd_ÿ¡
<q17_sub_agg»g©e_tu¶e>(
l
.
d©a
);

383 
q17_l_još_p_tu¶e
 *
	gright
 = 
®igÃd_ÿ¡
<q17_l_još_p_tu¶e>(
r
.
d©a
);

385 
	gde¡
->
	gAVG_QTY
 = 
sub
->
AVG_QTY
;

386 
	gde¡
->
	gL_EXTENDEDPRICE
 = 
right
->
L_EXTENDEDPRICE
;

387 
	gde¡
->
	gL_QUANTITY
 = 
right
->
L_QUANTITY
;

392 
vœtu®
 
q17_fš®_još_t
* 
şÚe
() const {

393  
Ãw
 
q17_fš®_još_t
(*
this
);

396 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

397  
c_¡r
("join LINEITEM sub, LINEITEM_PART; select sub.AVG_QTY, L_EXTENDEDPRICE, L_QUANTITY");

401 
	gq17_još_f‹r_t
 : 
public
 
tu¶e_f‹r_t
 {

403 
q17_još_f‹r_t
()

404 : 
tu¶e_f‹r_t
((
q17_®l_još_tu¶e
))

408 
boŞ
 
£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

409 
q17_®l_još_tu¶e
 *
š
 = 
®igÃd_ÿ¡
<q17_®l_još_tu¶e>(
šput
.
d©a
);

410  
	gš
->
	gL_QUANTITY
 < 0.2 * in->
	gAVG_QTY
;

413 
vœtu®
 
q17_još_f‹r_t
* 
şÚe
() const {

414  
Ãw
 
q17_još_f‹r_t
(*
this
);

417 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

418  
c_¡r
("q17_join_filter_t");

422 
	gq17_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

424 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

426 
q17_agg»g©e_t
()

427 : 
tu¶e_agg»g©e_t
((
q17_fš®_tu¶e
)), 
_exŒaùÜ
(0, 0)

431 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
() {

432  &
	g_exŒaùÜ
;

435 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
t
) {

436 
q17_fš®_tu¶e
 *
	gagg
 = 
®igÃd_ÿ¡
<q17_fš®_tu¶e>(
agg_d©a
);

437 
q17_®l_još_tu¶e
 *
	gš
 = 
®igÃd_ÿ¡
<q17_®l_još_tu¶e>(
t
.
d©a
);

438 
	gagg
->
	gAVG_YEARLY
 +ğ
š
->
L_EXTENDEDPRICE
;

440 
vœtu®
 
fšish
(
tu¶e_t
 &
de¡
, cÚ¡ * 
agg_d©a
) {

441 
memıy
(
de¡
.
d©a
, 
agg_d©a
, de¡.
size
);

442 
q17_fš®_tu¶e
 *
	gagg
 = 
®igÃd_ÿ¡
<q17_fš®_tu¶e>(
de¡
.
d©a
);

443 
	gagg
->
	gAVG_YEARLY
 /= 7.0;

445 
vœtu®
 
q17_agg»g©e_t
* 
şÚe
() const {

446  
Ãw
 
q17_agg»g©e_t
(*
this
);

448 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

455 şas 
	cch_q17_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t
 {

457 
public
:

459 
vœtu®
 
	$begš
() {

460 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q17 %s\n",

464 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

465 
q17_fš®_tu¶e
 *
agg
 = 
®igÃd_ÿ¡
<q17_fš®_tu¶e>(
ouut
.
d©a
);

467 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q17 %.4f\n", 
agg
->
AVG_YEARLY
.
	`to_doubË
());

468 
	}
}

479 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_q17
(cÚ¡ 
xù_id
,

480 
q17_šput_t
& 
š
)

482 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** q19 *********\n");

484 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

485 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

490 
tu¶e_fifo
* 
q17_·¹_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q17_´ojeùed_·¹_tu¶e
));

491 
·ck‘_t
* 
q17_·¹_tsÿn_·ck‘
 =

492 
Ãw
 
	`tsÿn_·ck‘_t
("part TSCAN",

493 
q17_·¹_bufãr
,

494 
Ãw
 
	`q17_·¹_tsÿn_f‹r_t
(
this
, 
š
),

495 
this
->
	`db
(),

496 
_µ¬t_desc
.
	`g‘
(),

497 
pxù
);

500 
tu¶e_fifo
* 
q17_lše™em_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q17_´ojeùed_lše™em_tu¶e
));

501 
·ck‘_t
* 
q17_lše™em_tsÿn_·ck‘
 =

502 
Ãw
 
	`tsÿn_·ck‘_t
("lineitem TSCAN",

503 
q17_lše™em_bufãr
,

504 
Ãw
 
	`q17_lše™em_tsÿn_f‹r_t
(
this
, 
š
),

505 
this
->
	`db
(),

506 
_¶še™em_desc
.
	`g‘
(),

507 
pxù
);

510 
tu¶e_fifo
* 
q17_lše™em_sub_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q17_´ojeùed_lše™em_sub_tu¶e
));

511 
·ck‘_t
* 
q17_lše™em_sub_tsÿn_·ck‘
 =

512 
Ãw
 
	`tsÿn_·ck‘_t
("lineitem TSCAN subquery",

513 
q17_lše™em_sub_bufãr
,

514 
Ãw
 
	`q17_lše™em_sub_tsÿn_f‹r_t
(
this
, 
š
),

515 
this
->
	`db
(),

516 
_¶še™em_desc
.
	`g‘
(),

517 
pxù
);

521 
tu¶e_fifo
* 
q17_sub_agg»g©e_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q17_sub_agg»g©e_tu¶e
));

522 
·ck‘_t
* 
q17_sub_agg»g©e_·ck‘
 =

523 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("SUB AVG AGGREGATION",

524 
q17_sub_agg»g©e_bufãr
,

525 
Ãw
 
	`ŒivŸl_f‹r_t
((
q17_sub_agg»g©e_tu¶e
)),

526 
q17_lše™em_sub_tsÿn_·ck‘
,

527 
Ãw
 
	`q17_sub_agg»g©e_t
(),

528 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
((), 
	`off£tof
(
q17_´ojeùed_lše™em_sub_tu¶e
, 
L_PARTKEY
)),

529 
Ãw
 
	`št_key_com·»_t
());

533 
tu¶e_fifo
* 
q17_l_još_p_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q17_l_još_p_tu¶e
));

534 
·ck‘_t
* 
q17_l_još_p_·ck‘
 =

535 
Ãw
 
	`hash_još_·ck‘_t
("lineitem -…art HJOIN",

536 
q17_l_još_p_bufãr
,

537 
Ãw
 
	`ŒivŸl_f‹r_t
((
q17_l_još_p_tu¶e
)),

538 
q17_lše™em_tsÿn_·ck‘
,

539 
q17_·¹_tsÿn_·ck‘
,

540 
Ãw
 
	`q17_l_još_p_t
());

543 
tu¶e_fifo
* 
q17_®l_još_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q17_®l_još_tu¶e
));

544 
·ck‘_t
* 
q17_®l_još_·ck‘
 =

545 
Ãw
 
	`hash_još_·ck‘_t
("lineitem sub -†ineitem_part HJOIN",

546 
q17_®l_još_bufãr
,

547 
Ãw
 
	`q17_još_f‹r_t
(),

548 
q17_sub_agg»g©e_·ck‘
,

549 
q17_l_još_p_·ck‘
,

550 
Ãw
 
	`q17_fš®_još_t
());

554 
tu¶e_fifo
* 
q17_fš®_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q17_fš®_tu¶e
));

555 
·ck‘_t
* 
q17_fš®_·ck‘
 =

556 
Ãw
 
	`agg»g©e_·ck‘_t
("SUM AGGREGATION",

557 
q17_fš®_bufãr
,

558 
Ãw
 
	`ŒivŸl_f‹r_t
((
q17_fš®_tu¶e
)),

559 
Ãw
 
	`q17_agg»g©e_t
(),

560 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
(0, 0),

561 
q17_®l_još_·ck‘
);

564 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

565 
q17_·¹_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

566 
q17_lše™em_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

567 
q17_lše™em_sub_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

568 
q17_sub_agg»g©e_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

569 
q17_l_još_p_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

570 
q17_®l_još_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

571 
q17_fš®_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

575 
ch_q17_´oûss_tu¶e_t
 
±
;

577 
	`´oûss_qu”y
(
q17_fš®_·ck‘
, 
±
);

579 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

582  (
RCOK
);

583 
	}
}

585 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/qpipe/qpipe_q18.cpp

33 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

34 
	~"wÜklßd/ch/ch_ut.h
"

35 
	~"qpe.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
usšg
 
Çme¥aû
 
	gqpe
;

42 
ENTER_NAMESPACE
(
ch
);

86 
	sq18_´ojeùed_lše™em_tu¶e
 {

87 
	mL_ORDERKEY
;

88 
decim®
 
	mL_QUANTITY
;

91 
	sq18_´ojeùed_Üd”s_tu¶e
 {

92 
	mO_ORDERKEY
;

93 
	mO_CUSTKEY
;

94 
	mO_ORDERDATE
[
STRSIZE
(10)];

95 
decim®
 
	mO_TOTALPRICE
;

98 
	sq18_´ojeùed_cu¡om”_tu¶e
 {

99 
	mC_CUSTKEY
;

100 
	mC_NAME
[
STRSIZE
(25)];

104 
	sq18_l_još_o_tu¶e
 {

105 
	mO_ORDERKEY
;

106 
	mO_CUSTKEY
;

107 
	mO_ORDERDATE
[
STRSIZE
(10)];

108 
decim®
 
	mO_TOTALPRICE
;

109 
decim®
 
	mL_QUANTITY
;

112 
	sq18_fš®_tu¶e
 {

113 
	mO_ORDERDATE
[
STRSIZE
(10)];

114 
decim®
 
	mO_TOTALPRICE
;

115 
	mC_NAME
[
STRSIZE
(25)];

116 
	mC_CUSTKEY
;

117 
	mO_ORDERKEY
;

118 
decim®
 
	mL_QUANTITY
;

121 
	sq18_sÜt_key
 {

122 
	mO_ORDERDATE
[
STRSIZE
(10)];

123 
decim®
 
	mO_TOTALPRICE
;

127 şas 
	cq18_lše™em_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


129 
´iv©e
:

130 
ShÜeTPCHEnv
* 
_chdb
;

131 
bË_row_t
* 
	m_´lše
;

132 
»p_row_t
 
	m_¼
;

134 
ch_lše™em_tu¶e
 
	m_lše™em
;

136 
	mpublic
:

137 
	$q18_lše™em_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q18_šput_t
 &
š
)

138 : 
	`tu¶e_f‹r_t
(
chdb
->
	`lše™em_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

140 
_´lše
 = 
_chdb
->
	`lše™em_mª
()->
	`g‘_tu¶e
();

141 
_¼
.
	`£t_ts
(
_chdb
->
	`lše™em_mª
()->
	`ts
(),

142 
_chdb
->
	`lše™em_desc
()->
	`maxsize
());

143 
_´lše
->
_»p
 = &
_¼
;

146 
vœtu®
 ~
	$q18_lše™em_tsÿn_f‹r_t
()

149 
_chdb
->
	`lše™em_mª
()->
	`give_tu¶e
(
_´lše
);

150 
	}
}

152 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

154 ià(!
_chdb
->
	`lše™em_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

155 
	`as£¹
(
çl£
);

158  
Œue
;

159 
	}
}

161 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

163 
q18_´ojeùed_lše™em_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q18_´ojeùed_lše™em_tu¶e>(
d
.
d©a
);

165 
_´lše
->
	`g‘_v®ue
(0, 
_lše™em
.
L_ORDERKEY
);

166 
_´lše
->
	`g‘_v®ue
(4, 
_lše™em
.
L_QUANTITY
);

170 
de¡
->
L_ORDERKEY
 = 
_lše™em
.L_ORDERKEY;

171 
de¡
->
L_QUANTITY
 = 
_lše™em
.L_QUANTITY;

172 
	}
}

174 
q18_lše™em_tsÿn_f‹r_t
* 
	$şÚe
() const {

175  
Ãw
 
	`q18_lše™em_tsÿn_f‹r_t
(*
this
);

176 
	}
}

178 
c_¡r
 
	$to_¡ršg
() const {

179  
	`c_¡r
("q18_lineitem_tscan_filter_t()");

180 
	}
}

183 şas 
	cq18_Üd”s_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


185 
´iv©e
:

186 
ShÜeTPCHEnv
* 
_chdb
;

187 
bË_row_t
* 
	m_´Üd”s
;

188 
»p_row_t
 
	m_¼
;

190 
ch_Üd”s_tu¶e
 
	m_Üd”s
;

192 
	mpublic
:

193 
	$q18_Üd”s_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q18_šput_t
 &
š
)

194 : 
	`tu¶e_f‹r_t
(
chdb
->
	`Üd”s_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

196 
_´Üd”s
 = 
_chdb
->
	`Üd”s_mª
()->
	`g‘_tu¶e
();

197 
_¼
.
	`£t_ts
(
_chdb
->
	`Üd”s_mª
()->
	`ts
(),

198 
_chdb
->
	`Üd”s_desc
()->
	`maxsize
());

199 
_´Üd”s
->
_»p
 = &
_¼
;

202 
vœtu®
 ~
	$q18_Üd”s_tsÿn_f‹r_t
()

205 
_chdb
->
	`Üd”s_mª
()->
	`give_tu¶e
(
_´Üd”s
);

206 
	}
}

208 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

210 ià(!
_chdb
->
	`Üd”s_mª
()->
	`lßd
(
_´Üd”s
, 
šput
.
d©a
)) {

211 
	`as£¹
(
çl£
);

214  
Œue
;

215 
	}
}

217 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

219 
q18_´ojeùed_Üd”s_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q18_´ojeùed_Üd”s_tu¶e>(
d
.
d©a
);

221 
_´Üd”s
->
	`g‘_v®ue
(0, 
_Üd”s
.
O_ORDERKEY
);

222 
_´Üd”s
->
	`g‘_v®ue
(1, 
_Üd”s
.
O_CUSTKEY
);

223 
_´Üd”s
->
	`g‘_v®ue
(3, 
_Üd”s
.
O_TOTALPRICE
);

224 
_´Üd”s
->
	`g‘_v®ue
(4, 
_Üd”s
.
O_ORDERDATE
, (_orders.O_ORDERDATE));

228 
de¡
->
O_ORDERKEY
 = 
_Üd”s
.O_ORDERKEY;

229 
de¡
->
O_CUSTKEY
 = 
_Üd”s
.O_CUSTKEY;

230 
de¡
->
O_TOTALPRICE
 = 
_Üd”s
.O_TOTALPRICE;

231 
	`memıy
(
de¡
->
O_ORDERDATE
, 
_Üd”s
.O_ORDERDATE, (dest->O_ORDERDATE));

232 
	}
}

234 
q18_Üd”s_tsÿn_f‹r_t
* 
	$şÚe
() const {

235  
Ãw
 
	`q18_Üd”s_tsÿn_f‹r_t
(*
this
);

236 
	}
}

238 
c_¡r
 
	$to_¡ršg
() const {

239  
	`c_¡r
("q18_orders_tscan_filter_t()");

240 
	}
}

243 şas 
	cq18_cu¡om”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


245 
´iv©e
:

246 
ShÜeTPCHEnv
* 
_chdb
;

247 
bË_row_t
* 
	m_´cu¡
;

248 
»p_row_t
 
	m_¼
;

250 
ch_cu¡om”_tu¶e
 
	m_cu¡om”
;

252 
	mpublic
:

253 
	$q18_cu¡om”_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q18_šput_t
 &
š
)

254 : 
	`tu¶e_f‹r_t
(
chdb
->
	`cu¡om”_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

256 
_´cu¡
 = 
_chdb
->
	`cu¡om”_mª
()->
	`g‘_tu¶e
();

257 
_¼
.
	`£t_ts
(
_chdb
->
	`cu¡om”_mª
()->
	`ts
(),

258 
_chdb
->
	`cu¡om”_desc
()->
	`maxsize
());

259 
_´cu¡
->
_»p
 = &
_¼
;

262 
vœtu®
 ~
	$q18_cu¡om”_tsÿn_f‹r_t
()

265 
_chdb
->
	`cu¡om”_mª
()->
	`give_tu¶e
(
_´cu¡
);

266 
	}
}

268 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

270 ià(!
_chdb
->
	`cu¡om”_mª
()->
	`lßd
(
_´cu¡
, 
šput
.
d©a
)) {

271 
	`as£¹
(
çl£
);

274  
Œue
;

275 
	}
}

277 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

279 
q18_´ojeùed_cu¡om”_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q18_´ojeùed_cu¡om”_tu¶e>(
d
.
d©a
);

281 
_´cu¡
->
	`g‘_v®ue
(0, 
_cu¡om”
.
C_CUSTKEY
);

282 
_´cu¡
->
	`g‘_v®ue
(1, 
_cu¡om”
.
C_NAME
, (_customer.C_NAME));

286 
de¡
->
C_CUSTKEY
 = 
_cu¡om”
.C_CUSTKEY;

287 
	`memıy
(
de¡
->
C_NAME
, 
_cu¡om”
.C_NAME, (dest->C_NAME));

288 
	}
}

290 
q18_cu¡om”_tsÿn_f‹r_t
* 
	$şÚe
() const {

291  
Ãw
 
	`q18_cu¡om”_tsÿn_f‹r_t
(*
this
);

292 
	}
}

294 
c_¡r
 
	$to_¡ršg
() const {

295  
	`c_¡r
("q18_customer_tscan_filter_t");

296 
	}
}

300 
	gq18_l_još_o_t
 : 
public
 
tu¶e_još_t
 {

302 
q18_l_još_o_t
()

303 : 
tu¶e_još_t
((
q18_´ojeùed_lše™em_tu¶e
),

304 
off£tof
(
q18_´ojeùed_lše™em_tu¶e
, 
L_ORDERKEY
),

305 (
q18_´ojeùed_Üd”s_tu¶e
),

306 
off£tof
(
q18_´ojeùed_Üd”s_tu¶e
, 
O_ORDERKEY
),

308 (
q18_l_još_o_tu¶e
))

312 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

313 
q18_l_još_o_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q18_l_još_o_tu¶e>(
d
.
d©a
);

314 
q18_´ojeùed_lše™em_tu¶e
 *
	glše
 = 
®igÃd_ÿ¡
<q18_´ojeùed_lše™em_tu¶e>(
l
.
d©a
);

315 
q18_´ojeùed_Üd”s_tu¶e
 *
	gÜd”
 = 
®igÃd_ÿ¡
<q18_´ojeùed_Üd”s_tu¶e>(
r
.
d©a
);

317 
	gde¡
->
	gL_QUANTITY
 = 
lše
->
L_QUANTITY
;

318 
memıy
(
de¡
->
O_ORDERDATE
, 
Üd”
->O_ORDERDATE, (dest->O_ORDERDATE));

319 
	gde¡
->
	gO_ORDERKEY
 = 
Üd”
->
O_ORDERKEY
;

320 
	gde¡
->
	gO_TOTALPRICE
 = 
Üd”
->
O_TOTALPRICE
;

321 
	gde¡
->
	gO_CUSTKEY
 = 
Üd”
->
O_CUSTKEY
;

327 
vœtu®
 
q18_l_još_o_t
* 
şÚe
() const {

328  
Ãw
 
q18_l_još_o_t
(*
this
);

331 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

332  
c_¡r
("join LINEITEM, ORDERS; select L_QUANTITY, O_ORDERDATE, O_ORDERKEY, O_TOTALPRICE");

336 
	gq18_l_o_još_c_t
 : 
public
 
tu¶e_još_t
 {

338 
q18_l_o_još_c_t
()

339 : 
tu¶e_još_t
((
q18_l_još_o_tu¶e
),

340 
off£tof
(
q18_l_još_o_tu¶e
, 
O_CUSTKEY
),

341 (
q18_´ojeùed_cu¡om”_tu¶e
),

342 
off£tof
(
q18_´ojeùed_cu¡om”_tu¶e
, 
C_CUSTKEY
),

344 (
q18_fš®_tu¶e
))

348 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

349 
q18_fš®_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q18_fš®_tu¶e>(
d
.
d©a
);

350 
q18_l_još_o_tu¶e
 *
	gËá
 = 
®igÃd_ÿ¡
<q18_l_još_o_tu¶e>(
l
.
d©a
);

351 
q18_´ojeùed_cu¡om”_tu¶e
 *
	gcu¡
 = 
®igÃd_ÿ¡
<q18_´ojeùed_cu¡om”_tu¶e>(
r
.
d©a
);

353 
	gde¡
->
	gC_CUSTKEY
 = 
cu¡
->
C_CUSTKEY
;

354 
memıy
(
de¡
->
C_NAME
, 
cu¡
->C_NAME, (dest->C_NAME));

355 
	gde¡
->
	gL_QUANTITY
 = 
Ëá
->
L_QUANTITY
;

356 
memıy
(
de¡
->
O_ORDERDATE
, 
Ëá
->O_ORDERDATE, (dest->O_ORDERDATE));

357 
	gde¡
->
	gO_ORDERKEY
 = 
Ëá
->
O_ORDERKEY
;

358 
	gde¡
->
	gO_TOTALPRICE
 = 
Ëá
->
O_TOTALPRICE
;

364 
vœtu®
 
q18_l_o_još_c_t
* 
şÚe
() const {

365  
Ãw
 
q18_l_o_još_c_t
(*
this
);

368 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

369  
c_¡r
("join LINEITEM_ORDERS, CUSTOMER; select C_CUSTKEY, C_NAME, L_QUANTITY, O_ORDERDATE, O_ORDERKEY, O_TOTALPRICE");

373 
	gq18_lše™em_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

375 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

377 
q18_lše™em_agg»g©e_t
()

378 : 
tu¶e_agg»g©e_t
((
q18_´ojeùed_lše™em_tu¶e
)), 
_exŒaùÜ
(
deçuÉ_key_exŒaùÜ_t
((), 
off£tof
(q18_´ojeùed_lše™em_tu¶e, 
L_ORDERKEY
)))

382 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
() {

383  &
	g_exŒaùÜ
;

386 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
t
) {

387 
q18_´ojeùed_lše™em_tu¶e
 *
	gagg
 = 
®igÃd_ÿ¡
<q18_´ojeùed_lše™em_tu¶e>(
agg_d©a
);

388 
q18_´ojeùed_lše™em_tu¶e
 *
	gšput
 = 
®igÃd_ÿ¡
<q18_´ojeùed_lše™em_tu¶e>(
t
.
d©a
);

390 
	gagg
->
	gL_QUANTITY
 +ğ
šput
->
L_QUANTITY
;

392 
vœtu®
 
fšish
(
tu¶e_t
 &
de¡
, cÚ¡ * 
agg_d©a
) {

393 
memıy
(
de¡
.
d©a
, 
agg_d©a
, de¡.
size
);

395 
vœtu®
 
q18_lše™em_agg»g©e_t
* 
şÚe
() const {

396  
Ãw
 
q18_lše™em_agg»g©e_t
(*
this
);

398 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

404 
	gq18_qty_f‹r_t
 : 
public
 
tu¶e_f‹r_t
 {

406 
decim®
 
_quªt™y
;

408 
q18_qty_f‹r_t
(
decim®
 
quªt™y
)

409 : 
tu¶e_f‹r_t
((
q18_´ojeùed_lše™em_tu¶e
)), 
_quªt™y
(
quªt™y
)

411 
TRACE
(
TRACE_ALWAYS
, "Rªdom…»diÿ‹s:\nsumÖ_quªt™yè> %.2f\n", 
_quªt™y
.
to_doubË
());

414 
boŞ
 
£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

415 
q18_´ojeùed_lše™em_tu¶e
 *
	gtu¶e
 = 
®igÃd_ÿ¡
<q18_´ojeùed_lše™em_tu¶e>(
šput
.
d©a
);

416  
	gtu¶e
->
	gL_QUANTITY
 > 
	g_quªt™y
;

419 
vœtu®
 
q18_qty_f‹r_t
* 
şÚe
() const {

420  
Ãw
 
q18_qty_f‹r_t
(*
this
);

423 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

424  
c_¡r
("q18_qty_filter_t");

428 
	gq18_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

430 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

432 
q18_agg»g©e_t
()

433 : 
tu¶e_agg»g©e_t
((
q18_fš®_tu¶e
)), 
_exŒaùÜ
(
deçuÉ_key_exŒaùÜ_t
((q18_final_tuple)))

437 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
() {

438  &
	g_exŒaùÜ
;

441 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
t
) {

442 
memıy
(
agg_d©a
, 
t
.
d©a
, (agg_data));

444 
vœtu®
 
fšish
(
tu¶e_t
 &
de¡
, cÚ¡ * 
agg_d©a
) {

445 
memıy
(
de¡
.
d©a
, 
agg_d©a
, de¡.
size
);

447 
vœtu®
 
q18_agg»g©e_t
* 
şÚe
() const {

448  
Ãw
 
q18_agg»g©e_t
(*
this
);

450 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

455 
	gq18_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

457 
q18_key_exŒaùÜ_t
()

458 : 
key_exŒaùÜ_t
((
q18_fš®_tu¶e
))

462 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

463 
q18_fš®_tu¶e
 *
t
 = 
®igÃd_ÿ¡
<q18_fš®_tu¶e>(
key
);

465  
	gt
->
	gC_CUSTKEY
;

468 
vœtu®
 
q18_key_exŒaùÜ_t
* 
şÚe
() const {

469  
Ãw
 
q18_key_exŒaùÜ_t
(*
this
);

473 
	gq18_key_com·»_t
 : 
public
 
key_com·»_t
 {

475 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

476 
q18_fš®_tu¶e
 *
	gk1
 = 
®igÃd_ÿ¡
<q18_fš®_tu¶e>(
key1
);

477 
q18_fš®_tu¶e
 *
	gk2
 = 
®igÃd_ÿ¡
<q18_fš®_tu¶e>(
key2
);

479 
	gdiff_cu¡key
 = 
k1
->
C_CUSTKEY
 - 
k2
->C_CUSTKEY;

481  (
	gdiff_cu¡key
 !ğ0 ? 
diff_cu¡key
 : (
k1
->
O_ORDERKEY
 - 
k2
->O_ORDERKEY));

484 
vœtu®
 
q18_key_com·»_t
* 
şÚe
() const {

485  
Ãw
 
q18_key_com·»_t
(*
this
);

489 
	gq18_sÜt_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

491 
q18_sÜt_key_exŒaùÜ_t
()

492 : 
key_exŒaùÜ_t
((
q18_sÜt_key
), 
off£tof
(
q18_fš®_tu¶e
, 
O_ORDERDATE
))

496 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

497 
q18_sÜt_key
 *
	gk
 = 
®igÃd_ÿ¡
<q18_sÜt_key>(
key
);

498  - 
	gk
->
	gO_TOTALPRICE
.
to_št
();

501 
vœtu®
 
q18_sÜt_key_exŒaùÜ_t
* 
şÚe
() const {

502  
Ãw
 
q18_sÜt_key_exŒaùÜ_t
(*
this
);

506 
	gq18_sÜt_key_com·»_t
 : 
public
 
key_com·»_t
 {

508 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

509 
q18_sÜt_key
 *
	gk1
 = 
®igÃd_ÿ¡
<q18_sÜt_key>(
key1
);

510 
q18_sÜt_key
 *
	gk2
 = 
®igÃd_ÿ¡
<q18_sÜt_key>(
key2
);

512 
time_t
 
	gd1
 = 
¡r_to_tim‘
(
k1
->
O_ORDERDATE
);

513 
time_t
 
	gd2
 = 
¡r_to_tim‘
(
k2
->
O_ORDERDATE
);

515  (
	gk1
->
	gO_TOTALPRICE
 > 
	gk2
->O_TOTALPRICE ? -1 : (
k1
->
O_TOTALPRICE
 < 
k2
->O_TOTALPRICE ? 1 : 
d1
 - 
d2
));

518 
vœtu®
 
q18_sÜt_key_com·»_t
* 
şÚe
() const {

519  
Ãw
 
q18_sÜt_key_com·»_t
(*
this
);

526 şas 
	cch_q18_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t
 {

528 
public
:

530 
vœtu®
 
	$begš
() {

531 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q18 %s %s %s %s %s %s\n",

535 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

536 
q18_fš®_tu¶e
 *
agg
 = 
®igÃd_ÿ¡
<q18_fš®_tu¶e>(
ouut
.
d©a
);

538 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q18 % %d %d % %.4à%.4f\n", 
agg
->
C_NAME
,‡gg->
C_CUSTKEY
,‡gg->
O_ORDERKEY
,‡gg->
O_ORDERDATE
,‡gg->
O_TOTALPRICE
.
	`to_doubË
(),

539 
agg
->
L_QUANTITY
.
	`to_doubË
());

540 
	}
}

551 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_q18
(cÚ¡ 
xù_id
,

552 
q18_šput_t
& 
š
)

554 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** q18 *********\n");

556 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

557 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

561 
tu¶e_fifo
* 
q18_lše™em_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q18_´ojeùed_lše™em_tu¶e
));

562 
·ck‘_t
* 
q18_lše™em_tsÿn_·ck‘
 =

563 
Ãw
 
	`tsÿn_·ck‘_t
("lineitem TSCAN",

564 
q18_lše™em_bufãr
,

565 
Ãw
 
	`q18_lše™em_tsÿn_f‹r_t
(
this
, 
š
),

566 
this
->
	`db
(),

567 
_¶še™em_desc
.
	`g‘
(),

568 
pxù
);

571 
tu¶e_fifo
* 
q18_Üd”s_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q18_´ojeùed_Üd”s_tu¶e
));

572 
·ck‘_t
* 
q18_Üd”s_tsÿn_·ck‘
 =

573 
Ãw
 
	`tsÿn_·ck‘_t
("orders TSCAN",

574 
q18_Üd”s_bufãr
,

575 
Ãw
 
	`q18_Üd”s_tsÿn_f‹r_t
(
this
, 
š
),

576 
this
->
	`db
(),

577 
_pÜd”s_desc
.
	`g‘
(),

578 
pxù
);

581 
tu¶e_fifo
* 
q18_cu¡om”_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q18_´ojeùed_cu¡om”_tu¶e
));

582 
·ck‘_t
* 
q18_cu¡om”_tsÿn_·ck‘
 =

583 
Ãw
 
	`tsÿn_·ck‘_t
("customer TSCAN",

584 
q18_cu¡om”_bufãr
,

585 
Ãw
 
	`q18_cu¡om”_tsÿn_f‹r_t
(
this
, 
š
),

586 
this
->
	`db
(),

587 
_pcu¡om”_desc
.
	`g‘
(),

588 
pxù
);

591 
tu¶e_fifo
* 
q18_lše_agg_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q18_´ojeùed_lše™em_tu¶e
));

592 
·ck‘_t
* 
q18_lše_agg_·ck‘
 =

593 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("lineitem AGG",

594 
q18_lše_agg_bufãr
,

595 
Ãw
 
	`q18_qty_f‹r_t
((&
š
)->
l_quªt™y
),

596 
q18_lše™em_tsÿn_·ck‘
,

597 
Ãw
 
	`q18_lše™em_agg»g©e_t
(),

598 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
((), 
	`off£tof
(
q18_´ojeùed_lše™em_tu¶e
, 
L_ORDERKEY
)),

599 
Ãw
 
	`št_key_com·»_t
());

602 
tu¶e_fifo
* 
q18_l_još_o_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q18_l_još_o_tu¶e
));

603 
·ck‘_t
* 
q18_l_još_o_·ck‘
 =

604 
Ãw
 
	`hash_još_·ck‘_t
("lineitem - orders HJOIN",

605 
q18_l_još_o_bufãr
,

606 
Ãw
 
	`ŒivŸl_f‹r_t
((
q18_l_još_o_tu¶e
)),

607 
q18_lše_agg_·ck‘
,

608 
q18_Üd”s_tsÿn_·ck‘
,

609 
Ãw
 
	`q18_l_još_o_t
());

612 
tu¶e_fifo
* 
q18_l_o_još_c_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q18_fš®_tu¶e
));

613 
·ck‘_t
* 
q18_l_o_još_c_·ck‘
 =

614 
Ãw
 
	`hash_još_·ck‘_t
("lineitem_orders - customer HJOIN",

615 
q18_l_o_još_c_bufãr
,

616 
Ãw
 
	`ŒivŸl_f‹r_t
((
q18_fš®_tu¶e
)),

617 
q18_l_još_o_·ck‘
,

618 
q18_cu¡om”_tsÿn_·ck‘
,

619 
Ãw
 
	`q18_l_o_još_c_t
());

622 
tu¶e_fifo
* 
q18_agg_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q18_fš®_tu¶e
));

623 
·ck‘_t
* 
q18_agg_·ck‘
 =

624 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("GROUP BY AGG",

625 
q18_agg_bufãr
,

626 
Ãw
 
	`ŒivŸl_f‹r_t
((
q18_fš®_tu¶e
)),

627 
q18_l_o_još_c_·ck‘
,

628 
Ãw
 
	`q18_agg»g©e_t
(),

629 
Ãw
 
	`q18_key_exŒaùÜ_t
(),

630 
Ãw
 
	`q18_key_com·»_t
());

633 
tu¶e_fifo
* 
q18_sÜt_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q18_fš®_tu¶e
));

634 
·ck‘_t
* 
q18_sÜt_·ck‘
 =

635 
Ãw
 
	`sÜt_·ck‘_t
("SORT",

636 
q18_sÜt_bufãr
,

637 
Ãw
 
	`ŒivŸl_f‹r_t
((
q18_fš®_tu¶e
)),

638 
Ãw
 
	`q18_sÜt_key_exŒaùÜ_t
(),

639 
Ãw
 
	`q18_sÜt_key_com·»_t
(),

640 
q18_agg_·ck‘
);

643 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

644 
q18_lše™em_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

645 
q18_Üd”s_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

646 
q18_cu¡om”_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

647 
q18_lše_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

648 
q18_l_još_o_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

649 
q18_l_o_još_c_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

650 
q18_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

651 
q18_sÜt_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

655 
ch_q18_´oûss_tu¶e_t
 
±
;

657 
	`´oûss_qu”y
(
q18_sÜt_·ck‘
, 
±
);

659 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

662  (
RCOK
);

663 
	}
}

664 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/qpipe/qpipe_q19.cpp

33 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

34 
	~"wÜklßd/ch/ch_ut.h
"

35 
	~"qpe.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
usšg
 
Çme¥aû
 
	gqpe
;

42 
ENTER_NAMESPACE
(
ch
);

85 
	sq19_´ojeùed_·¹_tu¶e
 {

86 
	mP_PARTKEY
;

87 
	mCASE
;

90 
	sq19_´ojeùed_lše™em_tu¶e
 {

91 
	mL_PARTKEY
;

92 
decim®
 
	mL_QUANTITY
;

93 
decim®
 
	mREVENUE
;

96 
	sq19_l_još_p_tu¶e
 {

97 
decim®
 
	mREVENUE
;

98 
decim®
 
	mL_QUANTITY
;

99 
	mCASE
;

102 
	sq19_fš®_tu¶e
 {

103 
decim®
 
	mREVENUE
;

107 şas 
	cq19_·¹_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


109 
´iv©e
:

110 
ShÜeTPCHEnv
* 
_chdb
;

111 
bË_row_t
* 
	m_´·¹
;

112 
»p_row_t
 
	m_¼
;

115 
ch_·¹_tu¶e
 
	m_·¹
;

117 
	m_b¿nd1
[
STRSIZE
(10)];

118 
	m_b¿nd2
[
STRSIZE
(10)];

119 
	m_b¿nd3
[
STRSIZE
(10)];

121 
q19_šput_t
* 
	mq19_šput
;

123 
	mpublic
:

125 
	$q19_·¹_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q19_šput_t
 &
š
)

126 : 
	`tu¶e_f‹r_t
(
chdb
->
	`·¹_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

128 
_´·¹
 = 
_chdb
->
	`·¹_mª
()->
	`g‘_tu¶e
();

129 
_¼
.
	`£t_ts
(
_chdb
->
	`·¹_mª
()->
	`ts
(),

130 
_chdb
->
	`·¹_desc
()->
	`maxsize
());

131 
_´·¹
->
_»p
 = &
_¼
;

133 
q19_šput
 = &
š
;

134 
	`B¿nd_to_¤t
(
_b¿nd1
, 
q19_šput
->
p_b¿nd
[0]);

135 
	`B¿nd_to_¤t
(
_b¿nd2
, 
q19_šput
->
p_b¿nd
[1]);

136 
	`B¿nd_to_¤t
(
_b¿nd3
, 
q19_šput
->
p_b¿nd
[2]);

138 
	`TRACE
(
TRACE_ALWAYS
, "Rªdom…»diÿ‹s:\nPART.P_BRAND = '%s' o¸PART.P_BRAND = '%s' o¸PART.P_BRAND = '%s'\n", 
_b¿nd1
, 
_b¿nd2
, 
_b¿nd3
);

141 
vœtu®
 ~
	$q19_·¹_tsÿn_f‹r_t
()

144 
_chdb
->
	`·¹_mª
()->
	`give_tu¶e
(
_´·¹
);

145 
	}
}

149 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

152 ià(!
_chdb
->
	`·¹_mª
()->
	`lßd
(
_´·¹
, 
šput
.
d©a
)) {

153 
	`as£¹
(
çl£
);

156 
_´·¹
->
	`g‘_v®ue
(3, 
_·¹
.
P_BRAND
, (_part.P_BRAND));

157 
_´·¹
->
	`g‘_v®ue
(5, 
_·¹
.
P_SIZE
);

158 
_´·¹
->
	`g‘_v®ue
(6, 
_·¹
.
P_CONTAINER
, (_part.P_CONTAINER));

160 if(
	`¡rcmp
(
_·¹
.
P_BRAND
, 
_b¿nd1
) == 0) {

161  (
_·¹
.
P_SIZE
 >= 1 && _part.P_SIZE <= 5 &&

162 (
	`¡rcmp
(
_·¹
.
P_CONTAINER
, "SM CASE") == 0 || strcmp(_part.P_CONTAINER, "SM BOX") == 0 ||

163 
	`¡rcmp
(
_·¹
.
P_CONTAINER
, "SM PACK") == 0 || strcmp(_part.P_CONTAINER, "SM PKG") == 0));

165 if(
	`¡rcmp
(
_·¹
.
P_BRAND
, 
_b¿nd2
) == 0) {

166  (
_·¹
.
P_SIZE
 >= 1 && _part.P_SIZE <= 10 &&

167 (
	`¡rcmp
(
_·¹
.
P_CONTAINER
, "MED BAG") == 0 || strcmp(_part.P_CONTAINER, "MED BOX") == 0 ||

168 
	`¡rcmp
(
_·¹
.
P_CONTAINER
, "MED PACK") == 0 || strcmp(_part.P_CONTAINER, "MED PKG") == 0));

170 if(
	`¡rcmp
(
_·¹
.
P_BRAND
, 
_b¿nd3
) == 0) {

171  (
_·¹
.
P_SIZE
 >= 1 && _part.P_SIZE <= 15 &&

172 (
	`¡rcmp
(
_·¹
.
P_CONTAINER
, "LG CASE") == 0 || strcmp(_part.P_CONTAINER, "LG BOX") == 0 ||

173 
	`¡rcmp
(
_·¹
.
P_CONTAINER
, "LG PACK") == 0 || strcmp(_part.P_CONTAINER, "LG PKG") == 0));

176  
çl£
;

178 
	}
}

181 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

183 
q19_´ojeùed_·¹_tu¶e
 *
de¡
;

184 
de¡
 = 
®igÃd_ÿ¡
<
q19_´ojeùed_·¹_tu¶e
>(
d
.
d©a
);

186 
_´·¹
->
	`g‘_v®ue
(0, 
_·¹
.
P_PARTKEY
);

187 
_´·¹
->
	`g‘_v®ue
(3, 
_·¹
.
P_BRAND
, (_part.P_BRAND));

191 
de¡
->
P_PARTKEY
 = 
_·¹
.P_PARTKEY;

192 if(
	`¡rcmp
(
_·¹
.
P_BRAND
, 
_b¿nd1
) == 0) {

193 
de¡
->
CASE
 = 0;

195 if(
	`¡rcmp
(
_·¹
.
P_BRAND
, 
_b¿nd2
) == 0) {

196 
de¡
->
CASE
 = 1;

199 
de¡
->
CASE
 = 2;

201 
	}
}

203 
q19_·¹_tsÿn_f‹r_t
* 
	$şÚe
() const {

204  
Ãw
 
	`q19_·¹_tsÿn_f‹r_t
(*
this
);

205 
	}
}

207 
c_¡r
 
	$to_¡ršg
() const {

208  
	`c_¡r
("q19_part_tscan_filter_t()");

209 
	}
}

212 şas 
	cq19_lše™em_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


214 
´iv©e
:

215 
ShÜeTPCHEnv
* 
_chdb
;

216 
bË_row_t
* 
	m_´lše
;

217 
»p_row_t
 
	m_¼
;

219 
ch_lše™em_tu¶e
 
	m_lše™em
;

221 
	mpublic
:

222 
	$q19_lše™em_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q19_šput_t
 &
š
)

223 : 
	`tu¶e_f‹r_t
(
chdb
->
	`lše™em_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

225 
_´lše
 = 
_chdb
->
	`lše™em_mª
()->
	`g‘_tu¶e
();

226 
_¼
.
	`£t_ts
(
_chdb
->
	`lše™em_mª
()->
	`ts
(),

227 
_chdb
->
	`lše™em_desc
()->
	`maxsize
());

228 
_´lše
->
_»p
 = &
_¼
;

231 
vœtu®
 ~
	$q19_lše™em_tsÿn_f‹r_t
()

234 
_chdb
->
	`lše™em_mª
()->
	`give_tu¶e
(
_´lše
);

235 
	}
}

237 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

239 ià(!
_chdb
->
	`lše™em_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

240 
	`as£¹
(
çl£
);

243 
_´lše
->
	`g‘_v®ue
(13, 
_lše™em
.
L_SHIPINSTRUCT
, (_lineitem.L_SHIPINSTRUCT));

244 
_´lše
->
	`g‘_v®ue
(14, 
_lše™em
.
L_SHIPMODE
, (_lineitem.L_SHIPMODE));

246  (
	`¡rcmp
(
_lše™em
.
L_SHIPINSTRUCT
, "DELIVER IN PERSON"è=ğ0 && (¡rcmp(_lše™em.
L_SHIPMODE
, "AIR") == 0 || strcmp(_lineitem.L_SHIPMODE, "AIR REG") == 0));

247 
	}
}

249 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

251 
q19_´ojeùed_lše™em_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q19_´ojeùed_lše™em_tu¶e>(
d
.
d©a
);

253 
_´lše
->
	`g‘_v®ue
(1, 
_lše™em
.
L_PARTKEY
);

254 
_´lše
->
	`g‘_v®ue
(4, 
_lše™em
.
L_QUANTITY
);

255 
_´lše
->
	`g‘_v®ue
(5, 
_lše™em
.
L_EXTENDEDPRICE
);

256 
_´lše
->
	`g‘_v®ue
(6, 
_lše™em
.
L_DISCOUNT
);

260 
de¡
->
L_PARTKEY
 = 
_lše™em
.L_PARTKEY;

261 
de¡
->
L_QUANTITY
 = 
_lše™em
.L_QUANTITY;

262 
de¡
->
REVENUE
 = 
_lše™em
.
L_EXTENDEDPRICE
 / 100.0 * (1 - _lše™em.
L_DISCOUNT
 / 100.0);

263 
	}
}

265 
q19_lše™em_tsÿn_f‹r_t
* 
	$şÚe
() const {

266  
Ãw
 
	`q19_lše™em_tsÿn_f‹r_t
(*
this
);

267 
	}
}

269 
c_¡r
 
	$to_¡ršg
() const {

270  
	`c_¡r
("q19_lineitem_tscan_filter_t()");

271 
	}
}

276 
	gq19_l_još_p_t
 : 
public
 
tu¶e_još_t
 {

278 
q19_l_još_p_t
()

279 : 
tu¶e_još_t
((
q19_´ojeùed_lše™em_tu¶e
),

280 
off£tof
(
q19_´ojeùed_lše™em_tu¶e
, 
L_PARTKEY
),

281 (
q19_´ojeùed_·¹_tu¶e
),

282 
off£tof
(
q19_´ojeùed_·¹_tu¶e
, 
P_PARTKEY
),

284 (
q19_l_još_p_tu¶e
))

288 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

289 
q19_l_još_p_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q19_l_još_p_tu¶e>(
d
.
d©a
);

290 
q19_´ojeùed_lše™em_tu¶e
 *
	glše
 = 
®igÃd_ÿ¡
<q19_´ojeùed_lše™em_tu¶e>(
l
.
d©a
);

291 
q19_´ojeùed_·¹_tu¶e
 *
	g·¹
 = 
®igÃd_ÿ¡
<q19_´ojeùed_·¹_tu¶e>(
r
.
d©a
);

293 
	gde¡
->
	gCASE
 = 
·¹
->
CASE
;

294 
	gde¡
->
	gL_QUANTITY
 = 
lše
->
L_QUANTITY
;

295 
	gde¡
->
	gREVENUE
 = 
lše
->
REVENUE
;

300 
vœtu®
 
q19_l_još_p_t
* 
şÚe
() const {

301  
Ãw
 
q19_l_još_p_t
(*
this
);

304 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

305  
c_¡r
("join LINEITEM, PART; select CASE, L_QUANTITY, REVENUE");

310 
	gq19_još_f‹r_t
 : 
public
 
tu¶e_f‹r_t
 {

312 
_quªt™y
[3];

314 
q19_još_f‹r_t
(
quªt™y
[3])

315 : 
tu¶e_f‹r_t
((
q19_l_još_p_tu¶e
))

317 
memıy
(
_quªt™y
, 
quªt™y
, (_quantity));

318 
TRACE
(
TRACE_ALWAYS
, "Rªdom…»diÿ‹s:\nCa£ 1: %d <ğl_quªt™y <ğ%d\nCa£ 2: %d <ğl_quªt™y <ğ%d\nCa£ 3: %d <ğl_quªt™y <ğ%d\n", 
_quªt™y
[0], _quantity[0] + 10,

319 
_quªt™y
[1], _quantity[1] + 10, _quantity[2], _quantity[2] + 10);

322 
boŞ
 
£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

323 
q19_l_još_p_tu¶e
 *
	gtu¶e
 = 
®igÃd_ÿ¡
<q19_l_još_p_tu¶e>(
šput
.
d©a
);

324  
	gtu¶e
->
	gL_QUANTITY
.
to_št
(è>ğ
_quªt™y
[
tu¶e
->
CASE
] &&u¶e->
L_QUANTITY
.to_int() <= _quantity[tuple->CASE] + 10;

327 
vœtu®
 
´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

328 
q19_fš®_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q19_fš®_tu¶e>(
d
.
d©a
);

329 
q19_l_još_p_tu¶e
 *
	g¤c
 = 
®igÃd_ÿ¡
<q19_l_još_p_tu¶e>(
s
.
d©a
);

331 
	gde¡
->
	gREVENUE
 = 
¤c
->
REVENUE
;

334 
vœtu®
 
q19_još_f‹r_t
* 
şÚe
() const {

335  
Ãw
 
q19_još_f‹r_t
(*
this
);

338 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

339  
c_¡r
("q19_join_filter_t");

344 
	gq19_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

346 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

348 
q19_agg»g©e_t
()

349 : 
tu¶e_agg»g©e_t
((
q19_fš®_tu¶e
)), 
_exŒaùÜ
(0,0)

353 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
() {

354  &
	g_exŒaùÜ
;

357 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
t
) {

358 
q19_fš®_tu¶e
 *
	gd
 = 
®igÃd_ÿ¡
<q19_fš®_tu¶e>(
agg_d©a
);

359 
q19_fš®_tu¶e
 *
	gs
 = 
®igÃd_ÿ¡
<q19_fš®_tu¶e>(
t
.
d©a
);

361 
	gd
->
	gREVENUE
 +ğ
s
->
REVENUE
;

363 
vœtu®
 
fšish
(
tu¶e_t
 &
de¡
, cÚ¡ * 
agg_d©a
) {

364 
memıy
(
de¡
.
d©a
, 
agg_d©a
, de¡.
size
);

366 
vœtu®
 
q19_agg»g©e_t
* 
şÚe
() const {

367  
Ãw
 
q19_agg»g©e_t
(*
this
);

369 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

375 şas 
	cch_q19_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t
 {

377 
public
:

379 
vœtu®
 
	$begš
() {

380 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q19 %s\n",

384 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

385 
q19_fš®_tu¶e
 *
agg
 = 
®igÃd_ÿ¡
<q19_fš®_tu¶e>(
ouut
.
d©a
);

387 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q19 %.4f\n", 
agg
->
REVENUE
.
	`to_doubË
());

388 
	}
}

399 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_q19
(cÚ¡ 
xù_id
,

400 
q19_šput_t
& 
š
)

402 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** q19 *********\n");

404 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

405 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

410 
tu¶e_fifo
* 
q19_lše™em_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q19_´ojeùed_lše™em_tu¶e
));

411 
·ck‘_t
* 
q19_lše™em_tsÿn_·ck‘
 =

412 
Ãw
 
	`tsÿn_·ck‘_t
("lineitem TSCAN",

413 
q19_lše™em_bufãr
,

414 
Ãw
 
	`q19_lše™em_tsÿn_f‹r_t
(
this
, 
š
),

415 
this
->
	`db
(),

416 
_¶še™em_desc
.
	`g‘
(),

417 
pxù
);

420 
tu¶e_fifo
* 
q19_·¹_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q19_´ojeùed_·¹_tu¶e
));

421 
·ck‘_t
* 
q19_·¹_tsÿn_·ck‘
 =

422 
Ãw
 
	`tsÿn_·ck‘_t
("part TSCAN",

423 
q19_·¹_bufãr
,

424 
Ãw
 
	`q19_·¹_tsÿn_f‹r_t
(
this
, 
š
),

425 
this
->
	`db
(),

426 
_µ¬t_desc
.
	`g‘
(),

427 
pxù
);

431 
tu¶e_fifo
* 
q19_l_još_p_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q19_fš®_tu¶e
));

432 
·ck‘_t
* 
q19_l_još_p_·ck‘
 =

433 
Ãw
 
	`hash_još_·ck‘_t
("lineitem -…art HJOIN",

434 
q19_l_još_p_bufãr
,

435 
Ãw
 
	`q19_još_f‹r_t
((&
š
)->
l_quªt™y
),

436 
q19_lše™em_tsÿn_·ck‘
,

437 
q19_·¹_tsÿn_·ck‘
,

438 
Ãw
 
	`q19_l_još_p_t
());

441 
tu¶e_fifo
* 
q19_agg_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q19_fš®_tu¶e
));

442 
·ck‘_t
* 
q19_agg_·ck‘
 =

443 
Ãw
 
	`agg»g©e_·ck‘_t
("SUM AGG",

444 
q19_agg_bufãr
,

445 
Ãw
 
	`ŒivŸl_f‹r_t
((
q19_fš®_tu¶e
)),

446 
Ãw
 
	`q19_agg»g©e_t
(),

447 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
(0,0),

448 
q19_l_još_p_·ck‘
);

451 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

452 
q19_lše™em_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

453 
q19_·¹_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

454 
q19_l_još_p_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

455 
q19_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

459 
ch_q19_´oûss_tu¶e_t
 
±
;

461 
	`´oûss_qu”y
(
q19_agg_·ck‘
, 
±
);

463 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

466  (
RCOK
);

467 
	}
}

469 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/qpipe/qpipe_q2.cpp

32 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

33 
	~"wÜklßd/ch/ch_ut.h
"

34 
	~"qpe.h
"

36 
usšg
 
Çme¥aû
 
	gshÜe
;

37 
usšg
 
Çme¥aû
 
	gqpe
;

41 
ENTER_NAMESPACE
(
ch
);

96 
	sq2_´ojeùed_·¹_tu¶e
 {

97 
	mP_PARTKEY
;

98 
	mP_MFGR
[
STRSIZE
(25)];

102 
	sq2_´ojeùed_·¹suµ_tu¶e
 {

103 
	mPS_SUPPKEY
;

104 
	mPS_PARTKEY
;

105 
decim®
 
	mPS_SUPPLYCOST
;

109 
	sq2_´ojeùed_suµl›r_tu¶e
 {

110 
	mS_SUPPKEY
;

111 
	mS_NAME
[
STRSIZE
(25)];

112 
	mS_ADDRESS
[
STRSIZE
(40)];

113 
	mS_NATIONKEY
;

114 
	mS_PHONE
[
STRSIZE
(15)];

115 
decim®
 
	mS_ACCTBAL
;

116 
	mS_COMMENT
[
STRSIZE
(101)];

120 
	sq2_´ojeùed_ÇtiÚ_tu¶e
 {

121 
	mN_NATIONKEY
;

122 
	mN_NAME
[
STRSIZE
(25)];

123 
	mN_REGIONKEY
;

127 
	sq2_´ojeùed_»giÚ_tu¶e
 {

128 
	mR_REGIONKEY
;

133 
	sq2_´ojeùed_suµl›r_subqu”y_tu¶e
 {

134 
	mS_SUPPKEY
;

135 
	mS_NATIONKEY
;

139 
	sq2_´ojeùed_ÇtiÚ_subqu”y_tu¶e
 {

140 
	mN_NATIONKEY
;

141 
	mN_REGIONKEY
;

145 
	sq2_ps_još_p_tu¶e
 {

146 
	mPS_SUPPKEY
;

147 
	mP_PARTKEY
;

148 
decim®
 
	mPS_SUPPLYCOST
;

149 
	mP_MFGR
[
STRSIZE
(25)];

152 
	sq2_s_još_ps_p_tu¶e
 {

153 
	mP_PARTKEY
;

154 
decim®
 
	mPS_SUPPLYCOST
;

155 
	mP_MFGR
[
STRSIZE
(25)];

156 
	mS_NAME
[
STRSIZE
(25)];

157 
	mS_ADDRESS
[
STRSIZE
(40)];

158 
	mS_NATIONKEY
;

159 
	mS_PHONE
[
STRSIZE
(15)];

160 
decim®
 
	mS_ACCTBAL
;

161 
	mS_COMMENT
[
STRSIZE
(101)];

164 
	sq2_s_ps_p_još_n_tu¶e
 {

165 
	mP_PARTKEY
;

166 
decim®
 
	mPS_SUPPLYCOST
;

167 
	mP_MFGR
[
STRSIZE
(25)];

168 
	mS_NAME
[
STRSIZE
(25)];

169 
	mS_ADDRESS
[
STRSIZE
(40)];

170 
	mS_PHONE
[
STRSIZE
(15)];

171 
decim®
 
	mS_ACCTBAL
;

172 
	mS_COMMENT
[
STRSIZE
(101)];

173 
	mN_NAME
[
STRSIZE
(25)];

174 
	mN_REGIONKEY
;

177 
	sq2_s_ps_p_n_još_r_tu¶e
 {

178 
	mP_PARTKEY
;

179 
decim®
 
	mPS_SUPPLYCOST
;

180 
	mP_MFGR
[
STRSIZE
(25)];

181 
	mS_NAME
[
STRSIZE
(25)];

182 
	mS_ADDRESS
[
STRSIZE
(40)];

183 
	mS_PHONE
[
STRSIZE
(15)];

184 
decim®
 
	mS_ACCTBAL
;

185 
	mS_COMMENT
[
STRSIZE
(101)];

186 
	mN_NAME
[
STRSIZE
(25)];

189 
	sq2_n_još_r_subqu”y_tu¶e
 {

190 
	mN_NATIONKEY
;

193 
	sq2_s_još_n_r_subqu”y_tu¶e
 {

194 
	mS_SUPPKEY
;

197 
	sq2_ps_još_s_n_r_subqu”y_tu¶e
 {

198 
	mPS_PARTKEY
;

199 
decim®
 
	mPS_SUPPLYCOST
;

203 
	sq2_agg»g©e_tu¶e
 {

204 
decim®
 
	mS_ACCTBAL
;

205 
	mN_NAME
[
STRSIZE
(25)];

206 
	mS_NAME
[
STRSIZE
(25)];

207 
	mP_PARTKEY
;

208 
	mP_MFGR
[
STRSIZE
(25)];

209 
	mS_ADDRESS
[
STRSIZE
(40)];

210 
	mS_PHONE
[
STRSIZE
(15)];

211 
	mS_COMMENT
[
STRSIZE
(101)];

214 
	sq2_subqu”y_agg»g©e_tu¶e
 {

215 
	mPS_PARTKEY
;

216 
decim®
 
	mPS_SUPPLYCOST
;

219 
	sq2_sÜt_key
 {

220 
decim®
 
	mS_ACCTBAL
;

221 
	mN_NAME
[
STRSIZE
(25)];

222 
	mS_NAME
[
STRSIZE
(25)];

223 
	mP_PARTKEY
;

227 şas 
	cq2_·¹_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


229 
´iv©e
:

230 
ShÜeTPCHEnv
* 
_chdb
;

231 
bË_row_t
* 
	m_´·¹
;

232 
»p_row_t
 
	m_¼
;

235 
ch_·¹_tu¶e
 
	m_·¹
;

237 
	m_size
;

238 
	m_ty³
[
STRSIZE
(25)];

240 
q2_šput_t
* 
	mq2_šput
;

242 
	mpublic
:

244 
	$q2_·¹_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q2_šput_t
 &
š
)

245 : 
	`tu¶e_f‹r_t
(
chdb
->
	`·¹_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

247 
_´·¹
 = 
_chdb
->
	`·¹_mª
()->
	`g‘_tu¶e
();

248 
_¼
.
	`£t_ts
(
_chdb
->
	`·¹_mª
()->
	`ts
(),

249 
_chdb
->
	`·¹_desc
()->
	`maxsize
());

250 
_´·¹
->
_»p
 = &
_¼
;

252 
q2_šput
 = &
š
;

253 
_size
 = 
q2_šput
->
p_size
;

254 
	`ty³s3_to_¡r
(
_ty³
, 
q2_šput
->
p_ty³s3
);

256 
	`TRACE
(
TRACE_ALWAYS
, "Rªdom…»diÿ‹s:\nPART.P_SIZE=%d\tPART.P_TYPE†ik'%%%s'\n", 
_size
, 
_ty³
);

259 
vœtu®
 ~
	$q2_·¹_tsÿn_f‹r_t
()

262 
_chdb
->
	`·¹_mª
()->
	`give_tu¶e
(
_´·¹
);

263 
	}
}

267 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

270 ià(!
_chdb
->
	`·¹_mª
()->
	`lßd
(
_´·¹
, 
šput
.
d©a
)) {

271 
	`as£¹
(
çl£
);

274 
_´·¹
->
	`g‘_v®ue
(5, 
_·¹
.
P_SIZE
);

275 
_´·¹
->
	`g‘_v®ue
(4, 
_·¹
.
P_TYPE
, 25);

277  
_·¹
.
P_SIZE
 =ğ
_size
 && 
	`¡r¡r
(_·¹.
P_TYPE
, 
_ty³
);

278 
	}
}

281 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

283 
q2_´ojeùed_·¹_tu¶e
 *
de¡
;

284 
de¡
 = 
®igÃd_ÿ¡
<
q2_´ojeùed_·¹_tu¶e
>(
d
.
d©a
);

286 
_´·¹
->
	`g‘_v®ue
(0, 
_·¹
.
P_PARTKEY
);

287 
_´·¹
->
	`g‘_v®ue
(2, 
_·¹
.
P_MFGR
, 25);

293 
de¡
->
P_PARTKEY
 = 
_·¹
.P_PARTKEY;

294 
	`memıy
(
de¡
->
P_MFGR
, 
_·¹
.P_MFGR, (dest->P_MFGR));

296 
	}
}

298 
q2_·¹_tsÿn_f‹r_t
* 
	$şÚe
() const {

299  
Ãw
 
	`q2_·¹_tsÿn_f‹r_t
(*
this
);

300 
	}
}

302 
c_¡r
 
	$to_¡ršg
() const {

303  
	`c_¡r
("q2_·¹_tsÿn_f‹r_t(%d, %s)", 
_size
, 
_ty³
);

304 
	}
}

307 şas 
	cq2_·¹suµ_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


309 
´iv©e
:

310 
ShÜeTPCHEnv
* 
_chdb
;

311 
bË_row_t
* 
	m_´·¹suµ
;

312 
»p_row_t
 
	m_¼
;

315 
ch_·¹suµ_tu¶e
 
	m_·¹suµ
;

317 
	mpublic
:

318 
	$q2_·¹suµ_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q2_šput_t
 &
š
)

319 : 
	`tu¶e_f‹r_t
(
chdb
->
	`·¹suµ_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

321 
_´·¹suµ
 = 
_chdb
->
	`·¹suµ_mª
()->
	`g‘_tu¶e
();

322 
_¼
.
	`£t_ts
(
_chdb
->
	`·¹suµ_mª
()->
	`ts
(),

323 
_chdb
->
	`·¹suµ_desc
()->
	`maxsize
());

324 
_´·¹suµ
->
_»p
 = &
_¼
;

327 
vœtu®
 ~
	$q2_·¹suµ_tsÿn_f‹r_t
()

329 
_chdb
->
	`·¹suµ_mª
()->
	`give_tu¶e
(
_´·¹suµ
);

330 
	}
}

332 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

335 ià(!
_chdb
->
	`·¹suµ_mª
()->
	`lßd
(
_´·¹suµ
, 
šput
.
d©a
)) {

336 
	`as£¹
(
çl£
);

339  
Œue
;

340 
	}
}

343 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

345 
q2_´ojeùed_·¹suµ_tu¶e
 *
de¡
;

346 
de¡
 = 
®igÃd_ÿ¡
<
q2_´ojeùed_·¹suµ_tu¶e
>(
d
.
d©a
);

348 
_´·¹suµ
->
	`g‘_v®ue
(1, 
_·¹suµ
.
PS_SUPPKEY
);

349 
_´·¹suµ
->
	`g‘_v®ue
(0, 
_·¹suµ
.
PS_PARTKEY
);

350 
_´·¹suµ
->
	`g‘_v®ue
(3, 
_·¹suµ
.
PS_SUPPLYCOST
);

357 
de¡
->
PS_SUPPKEY
 = 
_·¹suµ
.PS_SUPPKEY;

358 
de¡
->
PS_PARTKEY
 = 
_·¹suµ
.PS_PARTKEY;

359 
de¡
->
PS_SUPPLYCOST
 = 
_·¹suµ
.PS_SUPPLYCOST;

361 
	}
}

363 
q2_·¹suµ_tsÿn_f‹r_t
* 
	$şÚe
() const {

364  
Ãw
 
	`q2_·¹suµ_tsÿn_f‹r_t
(*
this
);

365 
	}
}

367 
c_¡r
 
	$to_¡ršg
() const {

368  
	`c_¡r
("q2_partsupp_tscan_filter_t()");

369 
	}
}

373 şas 
	cq2_suµl›r_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


375 
´iv©e
:

376 
ShÜeTPCHEnv
* 
_chdb
;

377 
bË_row_t
* 
	m_´suµl›r
;

378 
»p_row_t
 
	m_¼
;

381 
ch_suµl›r_tu¶e
 
	m_suµl›r
;

383 
	mpublic
:

384 
	$q2_suµl›r_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q2_šput_t
 &
š
)

385 : 
	`tu¶e_f‹r_t
(
chdb
->
	`suµl›r_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

387 
_´suµl›r
 = 
_chdb
->
	`suµl›r_mª
()->
	`g‘_tu¶e
();

388 
_¼
.
	`£t_ts
(
_chdb
->
	`suµl›r_mª
()->
	`ts
(),

389 
_chdb
->
	`suµl›r_desc
()->
	`maxsize
());

390 
_´suµl›r
->
_»p
 = &
_¼
;

393 
vœtu®
 ~
	$q2_suµl›r_tsÿn_f‹r_t
()

395 
_chdb
->
	`suµl›r_mª
()->
	`give_tu¶e
(
_´suµl›r
);

396 
	}
}

398 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

401 ià(!
_chdb
->
	`suµl›r_mª
()->
	`lßd
(
_´suµl›r
, 
šput
.
d©a
)) {

402 
	`as£¹
(
çl£
);

405  
Œue
;

406 
	}
}

409 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

411 
q2_´ojeùed_suµl›r_tu¶e
 *
de¡
;

412 
de¡
 = 
®igÃd_ÿ¡
<
q2_´ojeùed_suµl›r_tu¶e
>(
d
.
d©a
);

415 
_´suµl›r
->
	`g‘_v®ue
(0, 
_suµl›r
.
S_SUPPKEY
);

416 
_´suµl›r
->
	`g‘_v®ue
(1, 
_suµl›r
.
S_NAME
, (_supplier.S_NAME));

417 
_´suµl›r
->
	`g‘_v®ue
(2, 
_suµl›r
.
S_ADDRESS
, (_supplier.S_ADDRESS));

418 
_´suµl›r
->
	`g‘_v®ue
(3, 
_suµl›r
.
S_NATIONKEY
);

419 
_´suµl›r
->
	`g‘_v®ue
(4, 
_suµl›r
.
S_PHONE
, (_supplier.S_PHONE));

420 
_´suµl›r
->
	`g‘_v®ue
(5, 
_suµl›r
.
S_ACCTBAL
);

421 
_´suµl›r
->
	`g‘_v®ue
(6, 
_suµl›r
.
S_COMMENT
, (_supplier.S_COMMENT));

426 
de¡
->
S_SUPPKEY
 = 
_suµl›r
.S_SUPPKEY;

427 
	`memıy
(
de¡
->
S_NAME
, 
_suµl›r
.S_NAME, (dest->S_NAME));

428 
	`memıy
(
de¡
->
S_ADDRESS
, 
_suµl›r
.S_ADDRESS, (dest->S_ADDRESS));

429 
de¡
->
S_NATIONKEY
 = 
_suµl›r
.S_NATIONKEY;

430 
	`memıy
(
de¡
->
S_PHONE
, 
_suµl›r
.S_PHONE, (dest->S_PHONE));

431 
de¡
->
S_ACCTBAL
 = 
_suµl›r
.S_ACCTBAL;

432 
	`memıy
(
de¡
->
S_COMMENT
, 
_suµl›r
.S_COMMENT, (dest->S_COMMENT));

434 
	}
}

436 
q2_suµl›r_tsÿn_f‹r_t
* 
	$şÚe
() const {

437  
Ãw
 
	`q2_suµl›r_tsÿn_f‹r_t
(*
this
);

438 
	}
}

440 
c_¡r
 
	$to_¡ršg
() const {

441  
	`c_¡r
("q2_supplier_tscan_filter_t()");

442 
	}
}

446 şas 
	cq2_suµl›r_subqu”y_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


448 
´iv©e
:

449 
ShÜeTPCHEnv
* 
_chdb
;

450 
bË_row_t
* 
	m_´suµl›r
;

451 
»p_row_t
 
	m_¼
;

454 
ch_suµl›r_tu¶e
 
	m_suµl›r
;

456 
	mpublic
:

457 
	$q2_suµl›r_subqu”y_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q2_šput_t
 &
š
)

458 : 
	`tu¶e_f‹r_t
(
chdb
->
	`suµl›r_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

460 
_´suµl›r
 = 
_chdb
->
	`suµl›r_mª
()->
	`g‘_tu¶e
();

461 
_¼
.
	`£t_ts
(
_chdb
->
	`suµl›r_mª
()->
	`ts
(),

462 
_chdb
->
	`suµl›r_desc
()->
	`maxsize
());

463 
_´suµl›r
->
_»p
 = &
_¼
;

466 
vœtu®
 ~
	$q2_suµl›r_subqu”y_tsÿn_f‹r_t
()

468 
_chdb
->
	`suµl›r_mª
()->
	`give_tu¶e
(
_´suµl›r
);

469 
	}
}

471 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

474 ià(!
_chdb
->
	`suµl›r_mª
()->
	`lßd
(
_´suµl›r
, 
šput
.
d©a
)) {

475 
	`as£¹
(
çl£
);

478  
Œue
;

479 
	}
}

482 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

484 
q2_´ojeùed_suµl›r_subqu”y_tu¶e
 *
de¡
;

485 
de¡
 = 
®igÃd_ÿ¡
<
q2_´ojeùed_suµl›r_subqu”y_tu¶e
>(
d
.
d©a
);

488 
_´suµl›r
->
	`g‘_v®ue
(0, 
_suµl›r
.
S_SUPPKEY
);

489 
_´suµl›r
->
	`g‘_v®ue
(3, 
_suµl›r
.
S_NATIONKEY
);

494 
de¡
->
S_SUPPKEY
 = 
_suµl›r
.S_SUPPKEY;

495 
de¡
->
S_NATIONKEY
 = 
_suµl›r
.S_NATIONKEY;

496 
	}
}

498 
q2_suµl›r_subqu”y_tsÿn_f‹r_t
* 
	$şÚe
() const {

499  
Ãw
 
	`q2_suµl›r_subqu”y_tsÿn_f‹r_t
(*
this
);

500 
	}
}

502 
c_¡r
 
	$to_¡ršg
() const {

503  
	`c_¡r
("q2_supplier_subquery_tscan_filter_t()");

504 
	}
}

508 şas 
	cq2_ÇtiÚ_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


510 
´iv©e
:

511 
ShÜeTPCHEnv
* 
_chdb
;

512 
bË_row_t
* 
	m_´ÇtiÚ
;

513 
»p_row_t
 
	m_¼
;

516 
ch_ÇtiÚ_tu¶e
 
	m_ÇtiÚ
;

518 
	mpublic
:

519 
	$q2_ÇtiÚ_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q2_šput_t
 &
š
)

520 : 
	`tu¶e_f‹r_t
(
chdb
->
	`ÇtiÚ_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

522 
_´ÇtiÚ
 = 
_chdb
->
	`ÇtiÚ_mª
()->
	`g‘_tu¶e
();

523 
_¼
.
	`£t_ts
(
_chdb
->
	`ÇtiÚ_mª
()->
	`ts
(),

524 
_chdb
->
	`ÇtiÚ_desc
()->
	`maxsize
());

525 
_´ÇtiÚ
->
_»p
 = &
_¼
;

528 
vœtu®
 ~
	$q2_ÇtiÚ_tsÿn_f‹r_t
()

530 
_chdb
->
	`ÇtiÚ_mª
()->
	`give_tu¶e
(
_´ÇtiÚ
);

531 
	}
}

533 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

536 ià(!
_chdb
->
	`ÇtiÚ_mª
()->
	`lßd
(
_´ÇtiÚ
, 
šput
.
d©a
)) {

537 
	`as£¹
(
çl£
);

540  
Œue
;

541 
	}
}

544 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

546 
q2_´ojeùed_ÇtiÚ_tu¶e
 *
de¡
;

547 
de¡
 = 
®igÃd_ÿ¡
<
q2_´ojeùed_ÇtiÚ_tu¶e
>(
d
.
d©a
);

549 
_´ÇtiÚ
->
	`g‘_v®ue
(0, 
_ÇtiÚ
.
N_NATIONKEY
);

550 
_´ÇtiÚ
->
	`g‘_v®ue
(1, 
_ÇtiÚ
.
N_NAME
, 25);

551 
_´ÇtiÚ
->
	`g‘_v®ue
(2, 
_ÇtiÚ
.
N_REGIONKEY
);

556 
de¡
->
N_NATIONKEY
 = 
_ÇtiÚ
.N_NATIONKEY;

557 
	`memıy
(
de¡
->
N_NAME
, 
_ÇtiÚ
.N_NAME, (dest->N_NAME));

558 
de¡
->
N_REGIONKEY
 = 
_ÇtiÚ
.N_REGIONKEY;

559 
	}
}

561 
q2_ÇtiÚ_tsÿn_f‹r_t
* 
	$şÚe
() const {

562  
Ãw
 
	`q2_ÇtiÚ_tsÿn_f‹r_t
(*
this
);

563 
	}
}

565 
c_¡r
 
	$to_¡ršg
() const {

566  
	`c_¡r
("q2_nation_tscan_filter_t()");

567 
	}
}

571 şas 
	cq2_ÇtiÚ_subqu”y_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


573 
´iv©e
:

574 
ShÜeTPCHEnv
* 
_chdb
;

575 
bË_row_t
* 
	m_´ÇtiÚ
;

576 
»p_row_t
 
	m_¼
;

579 
ch_ÇtiÚ_tu¶e
 
	m_ÇtiÚ
;

581 
	mpublic
:

582 
	$q2_ÇtiÚ_subqu”y_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q2_šput_t
 &
š
)

583 : 
	`tu¶e_f‹r_t
(
chdb
->
	`ÇtiÚ_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

585 
_´ÇtiÚ
 = 
_chdb
->
	`ÇtiÚ_mª
()->
	`g‘_tu¶e
();

586 
_¼
.
	`£t_ts
(
_chdb
->
	`ÇtiÚ_mª
()->
	`ts
(),

587 
_chdb
->
	`ÇtiÚ_desc
()->
	`maxsize
());

588 
_´ÇtiÚ
->
_»p
 = &
_¼
;

591 
vœtu®
 ~
	$q2_ÇtiÚ_subqu”y_tsÿn_f‹r_t
()

593 
_chdb
->
	`ÇtiÚ_mª
()->
	`give_tu¶e
(
_´ÇtiÚ
);

594 
	}
}

596 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

599 ià(!
_chdb
->
	`ÇtiÚ_mª
()->
	`lßd
(
_´ÇtiÚ
, 
šput
.
d©a
)) {

600 
	`as£¹
(
çl£
);

603  
Œue
;

604 
	}
}

607 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

609 
q2_´ojeùed_ÇtiÚ_subqu”y_tu¶e
 *
de¡
;

610 
de¡
 = 
®igÃd_ÿ¡
<
q2_´ojeùed_ÇtiÚ_subqu”y_tu¶e
>(
d
.
d©a
);

612 
_´ÇtiÚ
->
	`g‘_v®ue
(0, 
_ÇtiÚ
.
N_NATIONKEY
);

613 
_´ÇtiÚ
->
	`g‘_v®ue
(2, 
_ÇtiÚ
.
N_REGIONKEY
);

618 
de¡
->
N_NATIONKEY
 = 
_ÇtiÚ
.N_NATIONKEY;

619 
de¡
->
N_REGIONKEY
 = 
_ÇtiÚ
.N_REGIONKEY;

620 
	}
}

622 
q2_ÇtiÚ_subqu”y_tsÿn_f‹r_t
* 
	$şÚe
() const {

623  
Ãw
 
	`q2_ÇtiÚ_subqu”y_tsÿn_f‹r_t
(*
this
);

624 
	}
}

626 
c_¡r
 
	$to_¡ršg
() const {

627  
	`c_¡r
("q2_nation_subquery_tscan_filter_t()");

628 
	}
}

632 şas 
	cq2_»giÚ_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


634 
´iv©e
:

635 
ShÜeTPCHEnv
* 
_chdb
;

636 
bË_row_t
* 
	m_´»giÚ
;

637 
»p_row_t
 
	m_¼
;

640 
ch_»giÚ_tu¶e
 
	m_»giÚ
;

642 
	m_Çme
[
STRSIZE
(25)];

643 
q2_šput_t
* 
	mq2_šput
;

645 
	mpublic
:

646 
	$q2_»giÚ_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q2_šput_t
 &
š
)

647 : 
	`tu¶e_f‹r_t
(
chdb
->
	`»giÚ_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

649 
_´»giÚ
 = 
_chdb
->
	`»giÚ_mª
()->
	`g‘_tu¶e
();

650 
_¼
.
	`£t_ts
(
_chdb
->
	`»giÚ_mª
()->
	`ts
(),

651 
_chdb
->
	`ÇtiÚ_desc
()->
	`maxsize
());

652 
_´»giÚ
->
_»p
 = &
_¼
;

654 
q2_šput
 = &
š
;

655 
	`»giÚ_to_¡r
(
q2_šput
->
r_Çme
, 
_Çme
);

657 
	`TRACE
(
TRACE_ALWAYS
, "Rªdom…»diÿ‹s:\nREGION.R_NAME = '%s'\n", 
_Çme
);

660 
vœtu®
 ~
	$q2_»giÚ_tsÿn_f‹r_t
()

662 
_chdb
->
	`»giÚ_mª
()->
	`give_tu¶e
(
_´»giÚ
);

663 
	}
}

665 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

668 ià(!
_chdb
->
	`»giÚ_mª
()->
	`lßd
(
_´»giÚ
, 
šput
.
d©a
)) {

669 
	`as£¹
(
çl£
);

672 
_´»giÚ
->
	`g‘_v®ue
(1, 
_»giÚ
.
R_NAME
, 25);

674  (
	`¡rcmp
(
_Çme
, 
_»giÚ
.
R_NAME
) == 0);

675 
	}
}

678 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

680 
q2_´ojeùed_»giÚ_tu¶e
 *
de¡
;

681 
de¡
 = 
®igÃd_ÿ¡
<
q2_´ojeùed_»giÚ_tu¶e
>(
d
.
d©a
);

683 
_´»giÚ
->
	`g‘_v®ue
(0, 
_»giÚ
.
R_REGIONKEY
);

688 
de¡
->
R_REGIONKEY
 = 
_»giÚ
.R_REGIONKEY;

689 
	}
}

691 
q2_»giÚ_tsÿn_f‹r_t
* 
	$şÚe
() const {

692  
Ãw
 
	`q2_»giÚ_tsÿn_f‹r_t
(*
this
);

693 
	}
}

695 
c_¡r
 
	$to_¡ršg
() const {

696  
	`c_¡r
("q2_»giÚ_tsÿn_f‹r_t(%s)", 
_Çme
);

697 
	}
}

701 
	gq2_ps_još_p_t
 : 
public
 
tu¶e_još_t


704 
q2_ps_još_p_t
()

705 : 
tu¶e_još_t
((
q2_´ojeùed_·¹suµ_tu¶e
),

706 
off£tof
(
q2_´ojeùed_·¹suµ_tu¶e
, 
PS_PARTKEY
),

707 (
q2_´ojeùed_·¹_tu¶e
),

708 
off£tof
(
q2_´ojeùed_·¹_tu¶e
, 
P_PARTKEY
),

710 (
q2_ps_još_p_tu¶e
))

714 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

715 
q2_ps_još_p_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q2_ps_još_p_tu¶e>(
d
.
d©a
);

716 
q2_´ojeùed_·¹suµ_tu¶e
 *
	g·¹suµ
 = 
®igÃd_ÿ¡
<q2_´ojeùed_·¹suµ_tu¶e>(
l
.
d©a
);

717 
q2_´ojeùed_·¹_tu¶e
 *
	g·¹
 = 
®igÃd_ÿ¡
<q2_´ojeùed_·¹_tu¶e>(
r
.
d©a
);

719 
	gde¡
->
	gPS_SUPPKEY
 = 
·¹suµ
->
PS_SUPPKEY
;

720 
	gde¡
->
	gPS_SUPPLYCOST
 = 
·¹suµ
->
PS_SUPPLYCOST
;

721 
	gde¡
->
	gP_PARTKEY
 = 
·¹
->
P_PARTKEY
;

722 
memıy
(
de¡
->
P_MFGR
, 
·¹
->P_MFGR, (dest->P_MFGR));

724 
TRACE
(
TRACE_RECORD_FLOW
, "JOIN: %d=%d: %d %d %.4à%s\n", 
·¹suµ
->
PS_PARTKEY
, 
·¹
->
P_PARTKEY
,…¬t->P_PARTKEY,…¬tsuµ->
PS_SUPPKEY
,…¬tsuµ->
PS_SUPPLYCOST
.
to_doubË
(),

725 
·¹
->
P_MFGR
);

728 
vœtu®
 
q2_ps_još_p_t
* 
şÚe
() const {

729  
Ãw
 
q2_ps_još_p_t
(*
this
);

732 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

733  
c_¡r
("JOIN PARTSUPP, PART; SELECT P_PARTKEY, PS_SUPPKEY, PS_SUPPLYCOST, P_MFGR");

737 
	gq2_s_još_ps_p_t
 : 
public
 
tu¶e_još_t


740 
q2_s_još_ps_p_t
()

741 : 
tu¶e_još_t
((
q2_´ojeùed_suµl›r_tu¶e
),

742 
off£tof
(
q2_´ojeùed_suµl›r_tu¶e
, 
S_SUPPKEY
),

743 (
q2_ps_još_p_tu¶e
),

744 
off£tof
(
q2_ps_još_p_tu¶e
, 
PS_SUPPKEY
),

746 (
q2_s_još_ps_p_tu¶e
))

750 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

751 
q2_s_još_ps_p_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q2_s_još_ps_p_tu¶e>(
d
.
d©a
);

752 
q2_´ojeùed_suµl›r_tu¶e
 *
	gsuµl›r
 = 
®igÃd_ÿ¡
<q2_´ojeùed_suµl›r_tu¶e>(
l
.
d©a
);

753 
q2_ps_još_p_tu¶e
 *
	gright
 = 
®igÃd_ÿ¡
<q2_ps_još_p_tu¶e>(
r
.
d©a
);

755 
	gde¡
->
	gS_NATIONKEY
 = 
suµl›r
->
S_NATIONKEY
;

756 
	gde¡
->
	gP_PARTKEY
 = 
right
->
P_PARTKEY
;

757 
	gde¡
->
	gPS_SUPPLYCOST
 = 
right
->
PS_SUPPLYCOST
;

758 
	gde¡
->
	gS_ACCTBAL
 = 
suµl›r
->
S_ACCTBAL
;

759 
memıy
(
de¡
->
S_NAME
, 
suµl›r
->S_NAME, (dest->S_NAME));

760 
memıy
(
de¡
->
S_ADDRESS
, 
suµl›r
->S_ADDRESS, (dest->S_ADDRESS));

761 
memıy
(
de¡
->
S_PHONE
, 
suµl›r
->S_PHONE, (dest->S_PHONE));

762 
memıy
(
de¡
->
S_COMMENT
, 
suµl›r
->S_COMMENT, (dest->S_COMMENT));

763 
memıy
(
de¡
->
P_MFGR
, 
right
->P_MFGR, (dest->P_MFGR));

770 
vœtu®
 
q2_s_još_ps_p_t
* 
şÚe
() const {

771  
Ãw
 
q2_s_još_ps_p_t
(*
this
);

774 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

775  
c_¡r
("JOIN SUPPLIER, PARTSUPP_PART; SELECT S_SUPPKEY, PS_SUPPKEY, S_NATIONKEY, P_PARTKEY, PS_SUPPLYCOST, S_ACCTBAL, S_NAME, S_ADDRESS, S_PHONE, S_COMMENT, P_MFGR");

779 
	gq2_s_ps_p_još_n_t
 : 
public
 
tu¶e_još_t


782 
q2_s_ps_p_još_n_t
()

783 : 
tu¶e_još_t
((
q2_s_još_ps_p_tu¶e
),

784 
off£tof
(
q2_s_još_ps_p_tu¶e
, 
S_NATIONKEY
),

785 (
q2_´ojeùed_ÇtiÚ_tu¶e
),

786 
off£tof
(
q2_´ojeùed_ÇtiÚ_tu¶e
, 
N_NATIONKEY
),

788 (
q2_s_ps_p_još_n_tu¶e
))

792 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

793 
q2_s_ps_p_još_n_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q2_s_ps_p_još_n_tu¶e>(
d
.
d©a
);

794 
q2_s_još_ps_p_tu¶e
 *
	gËá
 = 
®igÃd_ÿ¡
<q2_s_još_ps_p_tu¶e>(
l
.
d©a
);

795 
q2_´ojeùed_ÇtiÚ_tu¶e
 *
	gÇtiÚ
 = 
®igÃd_ÿ¡
<q2_´ojeùed_ÇtiÚ_tu¶e>(
r
.
d©a
);

797 
	gde¡
->
	gN_REGIONKEY
 = 
ÇtiÚ
->
N_REGIONKEY
;

798 
	gde¡
->
	gP_PARTKEY
 = 
Ëá
->
P_PARTKEY
;

799 
	gde¡
->
	gPS_SUPPLYCOST
 = 
Ëá
->
PS_SUPPLYCOST
;

800 
	gde¡
->
	gS_ACCTBAL
 = 
Ëá
->
S_ACCTBAL
;

801 
memıy
(
de¡
->
N_NAME
, 
ÇtiÚ
->N_NAME, (dest->N_NAME));

802 
memıy
(
de¡
->
P_MFGR
, 
Ëá
->P_MFGR, (dest->P_MFGR));

803 
memıy
(
de¡
->
S_ADDRESS
, 
Ëá
->S_ADDRESS, (dest->S_ADDRESS));

804 
memıy
(
de¡
->
S_COMMENT
, 
Ëá
->S_COMMENT, (dest->S_COMMENT));

805 
memıy
(
de¡
->
S_NAME
, 
Ëá
->S_NAME, (dest->S_NAME));

806 
memıy
(
de¡
->
S_PHONE
, 
Ëá
->S_PHONE, (dest->S_PHONE));

808 
TRACE
(
TRACE_RECORD_FLOW
, "JOIN: %d=%d: %d %d %.4à%.4à% % % % % %s\n", 
Ëá
->
S_NATIONKEY
, 
ÇtiÚ
->
N_NATIONKEY
,‚©iÚ->
N_REGIONKEY
,†eá->
P_PARTKEY
,

809 
Ëá
->
PS_SUPPLYCOST
.
to_doubË
(),†eá->
S_ACCTBAL
.to_doubË(), 
ÇtiÚ
->
N_NAME
,†eá->
P_MFGR
,

810 
Ëá
->
S_ADDRESS
,†eá->
S_COMMENT
,†eá->
S_NAME
,†eá->
S_PHONE
);

813 
vœtu®
 
q2_s_ps_p_još_n_t
* 
şÚe
() const {

814  
Ãw
 
q2_s_ps_p_još_n_t
(*
this
);

817 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

818  
c_¡r
("JOIN SUPPLIER_PARTSUPP_PART, NATION; SELECT N_REGIONKEY, P_PARTKEY, PS_SUPPLYCOST, S_ACCTBAL, N_NAME, P_MFGR, S_ADDRESS, S_COMMENT, S_NAME, S_PHONE");

822 
	gq2_s_ps_p_n_još_r_t
 : 
public
 
tu¶e_još_t


825 
q2_s_ps_p_n_još_r_t
()

826 : 
tu¶e_još_t
((
q2_s_ps_p_još_n_tu¶e
),

827 
off£tof
(
q2_s_ps_p_još_n_tu¶e
, 
N_REGIONKEY
),

828 (
q2_´ojeùed_»giÚ_tu¶e
),

829 
off£tof
(
q2_´ojeùed_»giÚ_tu¶e
, 
R_REGIONKEY
),

831 (
q2_s_ps_p_n_još_r_tu¶e
))

835 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

836 
q2_s_ps_p_n_još_r_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q2_s_ps_p_n_još_r_tu¶e>(
d
.
d©a
);

837 
q2_s_ps_p_još_n_tu¶e
 *
	gËá
 = 
®igÃd_ÿ¡
<q2_s_ps_p_još_n_tu¶e>(
l
.
d©a
);

838 
q2_´ojeùed_»giÚ_tu¶e
 *
	g»giÚ
 = 
®igÃd_ÿ¡
<q2_´ojeùed_»giÚ_tu¶e>(
r
.
d©a
);

840 
	gde¡
->
	gP_PARTKEY
 = 
Ëá
->
P_PARTKEY
;

841 
	gde¡
->
	gPS_SUPPLYCOST
 = 
Ëá
->
PS_SUPPLYCOST
;

842 
	gde¡
->
	gS_ACCTBAL
 = 
Ëá
->
S_ACCTBAL
;

843 
memıy
(
de¡
->
N_NAME
, 
Ëá
->N_NAME, (dest->N_NAME));

844 
memıy
(
de¡
->
P_MFGR
, 
Ëá
->P_MFGR, (dest->P_MFGR));

845 
memıy
(
de¡
->
S_ADDRESS
, 
Ëá
->S_ADDRESS, (dest->S_ADDRESS));

846 
memıy
(
de¡
->
S_COMMENT
, 
Ëá
->S_COMMENT, (dest->S_COMMENT));

847 
memıy
(
de¡
->
S_NAME
, 
Ëá
->S_NAME, (dest->S_NAME));

848 
memıy
(
de¡
->
S_PHONE
, 
Ëá
->S_PHONE, (dest->S_PHONE));

850 
TRACE
(
TRACE_RECORD_FLOW
, "JOIN: %d=%d: %d %.4à%.4à% % % % % %s\n", 
Ëá
->
N_REGIONKEY
, 
»giÚ
->
R_REGIONKEY
,†eá->
P_PARTKEY
,†eá->
PS_SUPPLYCOST
.
to_doubË
(),

851 
Ëá
->
S_ACCTBAL
.
to_doubË
(),†eá->
N_NAME
,†eá->
P_MFGR
,†eá->
S_ADDRESS
,†eá->
S_COMMENT
,

852 
Ëá
->
S_NAME
,†eá->
S_PHONE
);

855 
vœtu®
 
q2_s_ps_p_n_još_r_t
* 
şÚe
() const {

856  
Ãw
 
q2_s_ps_p_n_još_r_t
(*
this
);

859 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

860  
c_¡r
("JOIN SUPPLIER_PARTSUPP_PART_NATION, REGION; SELECT P_PARTKEY, PS_SUPPLYCOST, S_ACCTBAL, N_NAME, P_MFGR, S_ADDRESS, S_COMMENT, S_NAME, S_PHONE");

864 
	gq2_sÜt_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t


867 
q2_sÜt_key_exŒaùÜ_t
()

868 : 
key_exŒaùÜ_t
((
q2_sÜt_key
), 
off£tof
(q2_sÜt_key, 
S_ACCTBAL
))

872 
vœtu®
 
exŒaù_hšt
(cÚ¡ *
key
) const {

873 
q2_sÜt_key
 *
	gsÜt_key
 = 
®igÃd_ÿ¡
<q2_sÜt_key>(
key
);

874  
	gsÜt_key
->
	gS_ACCTBAL
.
to_št
();

877 
vœtu®
 
q2_sÜt_key_exŒaùÜ_t
* 
şÚe
() const {

878  
Ãw
 
q2_sÜt_key_exŒaùÜ_t
(*
this
);

881 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

882  
c_¡r
("q2_sort_key_extractor_t");

886 
	gq2_sÜt_key_com·»_t
 : 
public
 
key_com·»_t


889 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
k1
, cÚ¡ * 
	gk2
) const {

890 
q2_sÜt_key
 *
	gkey1
 = 
®igÃd_ÿ¡
<q2_sÜt_key>(
k1
);

891 
q2_sÜt_key
 *
	gkey2
 = 
®igÃd_ÿ¡
<q2_sÜt_key>(
k2
);

893 
	gdiff_acùb®
 = 
key1
->
S_ACCTBAL
 < 
key2
->S_ACCTBAL ? 1 : key1->S_ACCTBAL == key2->S_ACCTBAL ? 0 : -1;

894 
	gdiff_Âame
 = 
¡rcmp
(
key1
->
N_NAME
, 
key2
->N_NAME);

895 
	gdiff_¢ame
 = 
¡rcmp
(
key1
->
S_NAME
, 
key2
->S_NAME);

896 
	gdiff_pkey
 = 
key1
->
P_PARTKEY
 - 
key2
->P_PARTKEY;

898  
	gdiff_acùb®
 !ğ0 ? 
diff_acùb®
 : (
diff_Âame
 !ğ0 ? diff_Âam: (
diff_¢ame
 !ğ0 ? diff_¢am: 
diff_pkey
));

901 
vœtu®
 
q2_sÜt_key_com·»_t
* 
şÚe
() const {

902  
Ãw
 
q2_sÜt_key_com·»_t
(*
this
);

909 
	gq2_n_još_r_subqu”y_t
 : 
public
 
tu¶e_još_t
 {

911 
q2_n_još_r_subqu”y_t
()

912 : 
tu¶e_još_t
((
q2_´ojeùed_ÇtiÚ_subqu”y_tu¶e
),

913 
off£tof
(
q2_´ojeùed_ÇtiÚ_subqu”y_tu¶e
, 
N_REGIONKEY
),

914 (
q2_´ojeùed_»giÚ_tu¶e
),

915 
off£tof
(
q2_´ojeùed_»giÚ_tu¶e
, 
R_REGIONKEY
),

917 (
q2_n_još_r_subqu”y_tu¶e
))

921 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

922 
q2_n_još_r_subqu”y_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q2_n_još_r_subqu”y_tu¶e>(
d
.
d©a
);

923 
q2_´ojeùed_ÇtiÚ_subqu”y_tu¶e
 *
	gÇtiÚ
 = 
®igÃd_ÿ¡
<q2_´ojeùed_ÇtiÚ_subqu”y_tu¶e>(
l
.
d©a
);

924 
q2_´ojeùed_»giÚ_tu¶e
 *
	g»giÚ
 = 
®igÃd_ÿ¡
<q2_´ojeùed_»giÚ_tu¶e>(
r
.
d©a
);

926 
	gde¡
->
	gN_NATIONKEY
 = 
ÇtiÚ
->
N_NATIONKEY
;

928 
TRACE
(
TRACE_RECORD_FLOW
, "JOIN: %d=%d: %d\n", 
ÇtiÚ
->
N_REGIONKEY
, 
»giÚ
->
R_REGIONKEY
,‚©iÚ->
N_NATIONKEY
);

931 
vœtu®
 
q2_n_još_r_subqu”y_t
* 
şÚe
() const {

932  
Ãw
 
q2_n_još_r_subqu”y_t
(*
this
);

935 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

936  
c_¡r
("JOIN NATION, REGION; SELECT N_NATIONKEY; subquery");

940 
	gq2_s_još_n_r_subqu”y_t
 : 
public
 
tu¶e_još_t
 {

942 
q2_s_još_n_r_subqu”y_t
()

943 : 
tu¶e_još_t
((
q2_´ojeùed_suµl›r_subqu”y_tu¶e
),

944 
off£tof
(
q2_´ojeùed_suµl›r_subqu”y_tu¶e
, 
S_NATIONKEY
),

945 (
q2_n_još_r_subqu”y_tu¶e
),

946 
off£tof
(
q2_n_još_r_subqu”y_tu¶e
, 
N_NATIONKEY
),

948 (
q2_s_još_n_r_subqu”y_tu¶e
))

952 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

953 
q2_s_još_n_r_subqu”y_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q2_s_još_n_r_subqu”y_tu¶e>(
d
.
d©a
);

954 
q2_´ojeùed_suµl›r_subqu”y_tu¶e
 *
	gsuµ
 = 
®igÃd_ÿ¡
<q2_´ojeùed_suµl›r_subqu”y_tu¶e>(
l
.
d©a
);

955 
q2_n_još_r_subqu”y_tu¶e
 *
	gright
 = 
®igÃd_ÿ¡
<q2_n_još_r_subqu”y_tu¶e>(
r
.
d©a
);

957 
	gde¡
->
	gS_SUPPKEY
 = 
suµ
->
S_SUPPKEY
;

962 
vœtu®
 
q2_s_još_n_r_subqu”y_t
* 
şÚe
() const {

963  
Ãw
 
q2_s_još_n_r_subqu”y_t
(*
this
);

966 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

967  
c_¡r
("JOIN SUPPLIER, NATION_REGION; SELECT S_SUPPKEY; subquery");

971 
	gq2_ps_još_s_n_r_subqu”y_t
 : 
public
 
tu¶e_još_t
 {

973 
q2_ps_još_s_n_r_subqu”y_t
()

974 : 
tu¶e_još_t
((
q2_´ojeùed_·¹suµ_tu¶e
),

975 
off£tof
(
q2_´ojeùed_·¹suµ_tu¶e
, 
PS_SUPPKEY
),

976 (
q2_s_još_n_r_subqu”y_tu¶e
),

977 
off£tof
(
q2_s_još_n_r_subqu”y_tu¶e
, 
S_SUPPKEY
),

979 (
q2_subqu”y_agg»g©e_tu¶e
))

983 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

984 
q2_subqu”y_agg»g©e_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q2_subqu”y_agg»g©e_tu¶e>(
d
.
d©a
);

985 
q2_´ojeùed_·¹suµ_tu¶e
 *
	g·¹suµ
 = 
®igÃd_ÿ¡
<q2_´ojeùed_·¹suµ_tu¶e>(
l
.
d©a
);

986 
q2_s_još_n_r_subqu”y_tu¶e
 *
	gright
 = 
®igÃd_ÿ¡
<q2_s_još_n_r_subqu”y_tu¶e>(
r
.
d©a
);

988 
	gde¡
->
	gPS_PARTKEY
 = 
·¹suµ
->
PS_PARTKEY
;

989 
	gde¡
->
	gPS_SUPPLYCOST
 = 
·¹suµ
->
PS_SUPPLYCOST
;

991 
TRACE
(
TRACE_RECORD_FLOW
, "JOIN: %d=%d: %d %.2f\n", 
·¹suµ
->
PS_SUPPKEY
, 
right
->
S_SUPPKEY
,…¬tsuµ->
PS_PARTKEY
,…¬tsuµ->
PS_SUPPLYCOST
.
to_doubË
());

994 
vœtu®
 
q2_ps_još_s_n_r_subqu”y_t
* 
şÚe
() const {

995  
Ãw
 
q2_ps_još_s_n_r_subqu”y_t
(*
this
);

998 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

999  
c_¡r
("JOIN PARTSUPP, SUPPLIER_NATION_REGION; SELECT PS_PARTKEY, PS_SUPPLYCOST; subquery");

1003 
	gq2_subqu”y_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t


1005 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

1007 
q2_subqu”y_agg»g©e_t
()

1008 : 
tu¶e_agg»g©e_t
((
q2_subqu”y_agg»g©e_tu¶e
))

1012 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
() {

1013  &
_exŒaùÜ
;

1016 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
s
) {

1017 
q2_subqu”y_agg»g©e_tu¶e
 *
	gagg
 = 
®igÃd_ÿ¡
<q2_subqu”y_agg»g©e_tu¶e>(
agg_d©a
);

1018 
q2_subqu”y_agg»g©e_tu¶e
 *
	g¤c
 = 
®igÃd_ÿ¡
<q2_subqu”y_agg»g©e_tu¶e>(
s
.
d©a
);

1020 
	gagg
->
	gPS_PARTKEY
 = 
¤c
->
PS_PARTKEY
;

1021 
	gagg
->
	gPS_SUPPLYCOST
 = (
agg
->
PS_SUPPLYCOST
 < 
¤c
->PS_SUPPLYCOST ?‡gg->PS_SUPPLYCOST : src->PS_SUPPLYCOST);

1024 
vœtu®
 
fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

1025 
memıy
(
d
.
d©a
, 
agg_d©a
, 
tu¶e_size
());

1026 
q2_subqu”y_agg»g©e_tu¶e
* 
	gagg
 = 
®igÃd_ÿ¡
<q2_subqu”y_agg»g©e_tu¶e>(
agg_d©a
);

1027 
TRACE
(
TRACE_RECORD_FLOW
, "SUB_AGG: %d|%.2f\n", 
agg
->
PS_PARTKEY
,‡gg->
PS_SUPPLYCOST
.
to_doubË
());

1030 
vœtu®
 
q2_subqu”y_agg»g©e_t
* 
şÚe
() const {

1031  
Ãw
 
q2_subqu”y_agg»g©e_t
(*
this
);

1033 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

1037 
vœtu®
 
š™
(* 
agg_d©a
) {

1038 
mem£t
(
agg_d©a
, 0, 
tu¶e_size
());

1039 
q2_subqu”y_agg»g©e_tu¶e
 *
	gtu¶e
 = 
®igÃd_ÿ¡
<q2_subqu”y_agg»g©e_tu¶e>(
agg_d©a
);

1040 
	gtu¶e
->
	gPS_SUPPLYCOST
 = 
decim®
(10000000);

1046 
	gq2_fš®_još_t
 : 
public
 
tu¶e_još_t


1049 
q2_fš®_još_t
()

1050 : 
tu¶e_još_t
((
q2_s_ps_p_n_još_r_tu¶e
),

1051 
off£tof
(
q2_s_ps_p_n_još_r_tu¶e
, 
P_PARTKEY
),

1052 (
q2_subqu”y_agg»g©e_tu¶e
),

1053 
off£tof
(
q2_subqu”y_agg»g©e_tu¶e
, 
PS_PARTKEY
),

1054 (è+ (
decim®
),

1055 (
q2_agg»g©e_tu¶e
))

1059 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

1060 
q2_agg»g©e_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q2_agg»g©e_tu¶e>(
d
.
d©a
);

1061 
q2_subqu”y_agg»g©e_tu¶e
 *
	gright
 = 
®igÃd_ÿ¡
<q2_subqu”y_agg»g©e_tu¶e>(
r
.
d©a
);

1062 
q2_s_ps_p_n_još_r_tu¶e
 *
	gËá
 = 
®igÃd_ÿ¡
<q2_s_ps_p_n_još_r_tu¶e>(
l
.
d©a
);

1064 
	gde¡
->
	gP_PARTKEY
 = 
Ëá
->
P_PARTKEY
;

1065 
	gde¡
->
	gS_ACCTBAL
 = 
Ëá
->
S_ACCTBAL
;

1066 
memıy
(
de¡
->
N_NAME
, 
Ëá
->N_NAME, (dest->N_NAME));

1067 
memıy
(
de¡
->
P_MFGR
, 
Ëá
->P_MFGR, (dest->P_MFGR));

1068 
memıy
(
de¡
->
S_ADDRESS
, 
Ëá
->S_ADDRESS, (dest->S_ADDRESS));

1069 
memıy
(
de¡
->
S_COMMENT
, 
Ëá
->S_COMMENT, (dest->S_COMMENT));

1070 
memıy
(
de¡
->
S_NAME
, 
Ëá
->S_NAME, (dest->S_NAME));

1071 
memıy
(
de¡
->
S_PHONE
, 
Ëá
->S_PHONE, (dest->S_PHONE));

1073 
TRACE
(
TRACE_RECORD_FLOW
, "JOIN: %d=%d AND %.4f=%.4f: %d %.4à% % % % % %s\n", 
right
->
PS_PARTKEY
, 
Ëá
->
P_PARTKEY
,„ight->
PS_SUPPLYCOST
.
to_doubË
(),

1074 
Ëá
->
PS_SUPPLYCOST
.
to_doubË
(),†eá->
P_PARTKEY
,†eá->
S_ACCTBAL
.to_double(),

1075 
Ëá
->
N_NAME
,†eá->
P_MFGR
,†eá->
S_ADDRESS
,†eá->
S_COMMENT
,†eá->
S_NAME
,

1076 
Ëá
->
S_PHONE
);

1079 
vœtu®
 
q2_fš®_još_t
* 
şÚe
() const {

1080  
Ãw
 
q2_fš®_još_t
(*
this
);

1083 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

1084  
c_¡r
("JOIN SUBQUERY, MAIN_QUERY; SELECT P_PARTKEY, S_ACCTBAL, N_NAME, P_MFGR, S_ADDRESS, S_COMMENT, S_NAME, S_PHONE");

1088 
	gq2_tİ100_f‹r_t
 : 
public
 
tu¶e_f‹r_t


1090 
_couÁ
;

1092 
q2_tİ100_f‹r_t
()

1093 : 
tu¶e_f‹r_t
((
q2_agg»g©e_tu¶e
)), 
_couÁ
(0)

1097 
boŞ
 
£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

1098  ++
	g_couÁ
 <= 100;

1101 
vœtu®
 
q2_tİ100_f‹r_t
* 
şÚe
() const {

1102  
Ãw
 
q2_tİ100_f‹r_t
(*
this
);

1105 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

1106  
c_¡r
("q2_top100_filter_t");

1110 şas 
	cch_q2_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


1112 
public
:

1114 
	$begš
() {

1115 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q2 ANSWER ...\n");

1116 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** S_ACCTBAL\tS_NAME\tN_NAME\tP_PARTKEY\tP_MFGR\tS_ADDRESS\tS_PHONE\tS_COMMENT\n");

1119 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

1120 
q2_agg»g©e_tu¶e
 *
tu¶e
 = 
®igÃd_ÿ¡
<q2_agg»g©e_tu¶e>(
ouut
.
d©a
);

1124 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** %.4f\t%s\t%s\t%d\t%s\t%s\t%s\t%s\n",

1125 
tu¶e
->
S_ACCTBAL
.
	`to_doubË
(),

1126 
tu¶e
->
S_NAME
,

1127 
tu¶e
->
N_NAME
,

1128 
tu¶e
->
P_PARTKEY
,

1129 
tu¶e
->
P_MFGR
,

1130 
tu¶e
->
S_ADDRESS
,

1131 
tu¶e
->
S_PHONE
,

1132 
tu¶e
->
S_COMMENT
);

1134 
	}
}

1137 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_q2
(cÚ¡ 
xù_id
,

1138 
q2_šput_t
& 
š
)

1140 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** Q2 *********\n");

1143 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

1144 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

1148 
tu¶e_fifo
* 
q2_·¹_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q2_´ojeùed_·¹_tu¶e
));

1149 
·ck‘_t
* 
q2_·¹_tsÿn_·ck‘
 =

1150 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN PART",

1151 
q2_·¹_bufãr
,

1152 
Ãw
 
	`q2_·¹_tsÿn_f‹r_t
(
this
,
š
),

1153 
this
->
	`db
(),

1154 
_µ¬t_desc
.
	`g‘
(),

1155 
pxù


1160 
tu¶e_fifo
* 
q2_·¹suµ_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q2_´ojeùed_·¹suµ_tu¶e
));

1161 
·ck‘_t
* 
q2_·¹suµ_tsÿn_·ck‘
 =

1162 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN PARTSUPP",

1163 
q2_·¹suµ_bufãr
,

1164 
Ãw
 
	`q2_·¹suµ_tsÿn_f‹r_t
(
this
, 
š
),

1165 
this
->
	`db
(),

1166 
_µ¬tsuµ_desc
.
	`g‘
(),

1167 
pxù
);

1170 
tu¶e_fifo
* 
q2_ps_još_p_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q2_ps_još_p_tu¶e
));

1171 
·ck‘_t
* 
q2_ps_još_p_·ck‘
 =

1172 
Ãw
 
	`hash_još_·ck‘_t
("partsupp-part HJOIN",

1173 
q2_ps_još_p_bufãr
,

1174 
Ãw
 
	`ŒivŸl_f‹r_t
((
q2_ps_još_p_tu¶e
)),

1175 
q2_·¹suµ_tsÿn_·ck‘
,

1176 
q2_·¹_tsÿn_·ck‘
,

1177 
Ãw
 
	`q2_ps_još_p_t
());

1180 
tu¶e_fifo
* 
q2_suµl›r_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q2_´ojeùed_suµl›r_tu¶e
));

1181 
·ck‘_t
* 
q2_suµl›r_tsÿn_·ck‘
 =

1182 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN SUPPLIER",

1183 
q2_suµl›r_bufãr
,

1184 
Ãw
 
	`q2_suµl›r_tsÿn_f‹r_t
(
this
, 
š
),

1185 
this
->
	`db
(),

1186 
_psuµl›r_desc
.
	`g‘
(),

1187 
pxù
);

1190 
tu¶e_fifo
* 
q2_s_još_ps_p_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q2_s_još_ps_p_tu¶e
));

1191 
·ck‘_t
* 
q2_s_još_ps_p_·k‘
 =

1192 
Ãw
 
	`hash_još_·ck‘_t
("supplier -…artsupp_part HJOIN",

1193 
q2_s_još_ps_p_bufãr
,

1194 
Ãw
 
	`ŒivŸl_f‹r_t
((
q2_s_još_ps_p_tu¶e
)),

1195 
q2_suµl›r_tsÿn_·ck‘
,

1196 
q2_ps_još_p_·ck‘
,

1197 
Ãw
 
	`q2_s_još_ps_p_t
());

1200 
tu¶e_fifo
* 
q2_ÇtiÚ_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q2_´ojeùed_ÇtiÚ_tu¶e
));

1201 
·ck‘_t
* 
q2_ÇtiÚ_tsÿn_·ck‘
 =

1202 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN NATION",

1203 
q2_ÇtiÚ_bufãr
,

1204 
Ãw
 
	`q2_ÇtiÚ_tsÿn_f‹r_t
(
this
, 
š
),

1205 
this
->
	`db
(),

1206 
_²©iÚ_desc
.
	`g‘
(),

1207 
pxù
);

1210 
tu¶e_fifo
* 
q2_s_ps_p_još_n_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q2_s_ps_p_još_n_tu¶e
));

1211 
·ck‘_t
* 
q2_s_ps_p_još_n_·ck‘
 =

1212 
Ãw
 
	`hash_još_·ck‘_t
("supplier_partsupp_part -‚ation HJOIN",

1213 
q2_s_ps_p_još_n_bufãr
,

1214 
Ãw
 
	`ŒivŸl_f‹r_t
((
q2_s_ps_p_još_n_tu¶e
)),

1215 
q2_s_još_ps_p_·k‘
,

1216 
q2_ÇtiÚ_tsÿn_·ck‘
,

1217 
Ãw
 
	`q2_s_ps_p_još_n_t
());

1220 
tu¶e_fifo
* 
q2_»giÚ_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q2_´ojeùed_»giÚ_tu¶e
));

1221 
·ck‘_t
* 
q2_»giÚ_tsÿn_·ck‘
 =

1222 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN REGION",

1223 
q2_»giÚ_bufãr
,

1224 
Ãw
 
	`q2_»giÚ_tsÿn_f‹r_t
(
this
, 
š
),

1225 
this
->
	`db
(),

1226 
_´egiÚ_desc
.
	`g‘
(),

1227 
pxù
);

1230 
tu¶e_fifo
* 
q2_s_ps_p_n_još_r_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q2_s_ps_p_n_još_r_tu¶e
));

1231 
·ck‘_t
* 
q2_s_ps_p_n_još_r_·ck‘
 =

1232 
Ãw
 
	`hash_još_·ck‘_t
("supplier_partsupp_part_nation -„egion HJOIN",

1233 
q2_s_ps_p_n_još_r_bufãr
,

1234 
Ãw
 
	`ŒivŸl_f‹r_t
((
q2_s_ps_p_n_još_r_tu¶e
)),

1235 
q2_s_ps_p_još_n_·ck‘
,

1236 
q2_»giÚ_tsÿn_·ck‘
,

1237 
Ãw
 
	`q2_s_ps_p_n_još_r_t
());

1240 
tu¶e_fifo
* 
q2_sÜt_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q2_s_ps_p_n_još_r_tu¶e
));

1241 
·ck‘_t
* 
q2_sÜt_·ck‘
 =

1242 
Ãw
 
	`sÜt_·ck‘_t
("SORT",

1243 
q2_sÜt_bufãr
,

1244 
Ãw
 
	`ŒivŸl_f‹r_t
((
q2_s_ps_p_n_još_r_tu¶e
)),

1245 
Ãw
 
	`q2_sÜt_key_exŒaùÜ_t
(),

1246 
Ãw
 
	`q2_sÜt_key_com·»_t
(),

1247 
q2_s_ps_p_n_još_r_·ck‘
);

1252 
tu¶e_fifo
* 
q2_ÇtiÚ_subqu”y_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q2_´ojeùed_ÇtiÚ_subqu”y_tu¶e
));

1253 
·ck‘_t
* 
q2_ÇtiÚ_tsÿn_subqu”y_·ck‘
 =

1254 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN NATION subquery",

1255 
q2_ÇtiÚ_subqu”y_bufãr
,

1256 
Ãw
 
	`q2_ÇtiÚ_subqu”y_tsÿn_f‹r_t
(
this
, 
š
),

1257 
this
->
	`db
(),

1258 
_²©iÚ_desc
.
	`g‘
(),

1259 
pxù
);

1262 
tu¶e_fifo
* 
q2_»giÚ_subqu”y_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q2_´ojeùed_»giÚ_tu¶e
));

1263 
·ck‘_t
* 
q2_»giÚ_tsÿn_subqu”y_·ck‘
 =

1264 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN REGION subquery",

1265 
q2_»giÚ_subqu”y_bufãr
,

1266 
Ãw
 
	`q2_»giÚ_tsÿn_f‹r_t
(
this
, 
š
),

1267 
this
->
	`db
(),

1268 
_´egiÚ_desc
.
	`g‘
(),

1269 
pxù
);

1272 
tu¶e_fifo
* 
q2_n_još_r_subqu”y_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q2_n_još_r_subqu”y_tu¶e
));

1273 
·ck‘_t
* 
q2_n_još_r_subqu”y_·ck‘
 =

1274 
Ãw
 
	`hash_još_·ck‘_t
("nation -„egion HJOIN subquery",

1275 
q2_n_još_r_subqu”y_bufãr
,

1276 
Ãw
 
	`ŒivŸl_f‹r_t
((
q2_n_još_r_subqu”y_tu¶e
)),

1277 
q2_ÇtiÚ_tsÿn_subqu”y_·ck‘
,

1278 
q2_»giÚ_tsÿn_subqu”y_·ck‘
,

1279 
Ãw
 
	`q2_n_još_r_subqu”y_t
());

1282 
tu¶e_fifo
* 
q2_suµl›r_subqu”y_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q2_´ojeùed_suµl›r_subqu”y_tu¶e
));

1283 
·ck‘_t
* 
q2_suµl›r_tsÿn_subqu”y_·ck‘
 =

1284 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN SUPPLIER subquery",

1285 
q2_suµl›r_subqu”y_bufãr
,

1286 
Ãw
 
	`q2_suµl›r_subqu”y_tsÿn_f‹r_t
(
this
, 
š
),

1287 
this
->
	`db
(),

1288 
_psuµl›r_desc
.
	`g‘
(),

1289 
pxù
);

1292 
tu¶e_fifo
* 
q2_s_još_n_r_subqu”y_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q2_s_još_n_r_subqu”y_tu¶e
));

1293 
·ck‘_t
* 
q2_s_još_n_r_subqu”y_·ck‘
 =

1294 
Ãw
 
	`hash_još_·ck‘_t
("supplier -‚ation_region HJOIN subquery",

1295 
q2_s_još_n_r_subqu”y_bufãr
,

1296 
Ãw
 
	`ŒivŸl_f‹r_t
((
q2_s_još_n_r_subqu”y_tu¶e
)),

1297 
q2_suµl›r_tsÿn_subqu”y_·ck‘
,

1298 
q2_n_još_r_subqu”y_·ck‘
,

1299 
Ãw
 
	`q2_s_još_n_r_subqu”y_t
());

1302 
tu¶e_fifo
* 
q2_·¹suµ_subqu”y_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q2_´ojeùed_·¹suµ_tu¶e
));

1303 
·ck‘_t
* 
q2_·¹suµ_tsÿn_subqu”y_·ck‘
 =

1304 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN PARTSUPP subquery",

1305 
q2_·¹suµ_subqu”y_bufãr
,

1306 
Ãw
 
	`q2_·¹suµ_tsÿn_f‹r_t
(
this
, 
š
),

1307 
this
->
	`db
(),

1308 
_µ¬tsuµ_desc
.
	`g‘
(),

1309 
pxù
);

1312 
tu¶e_fifo
* 
q2_ps_još_s_n_r_subqu”y_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q2_subqu”y_agg»g©e_tu¶e
));

1313 
·ck‘_t
* 
q2_ps_još_s_n_r_subqu”y_·ck‘
 =

1314 
Ãw
 
	`hash_još_·ck‘_t
("partsupp - supplier_nation_region HJOIN subquery",

1315 
q2_ps_još_s_n_r_subqu”y_bufãr
,

1316 
Ãw
 
	`ŒivŸl_f‹r_t
((
q2_subqu”y_agg»g©e_tu¶e
)),

1317 
q2_·¹suµ_tsÿn_subqu”y_·ck‘
,

1318 
q2_s_još_n_r_subqu”y_·ck‘
,

1319 
Ãw
 
	`q2_ps_još_s_n_r_subqu”y_t
());

1322 
tu¶e_fifo
* 
q2_subqu”y_agg»g©e_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q2_subqu”y_agg»g©e_tu¶e
));

1323 
·ck‘_t
* 
q2_subqu”y_agg»g©e_·ck‘
 =

1324 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("AGG: min(PS_PARTKEY)",

1325 
q2_subqu”y_agg»g©e_bufãr
,

1326 
Ãw
 
	`ŒivŸl_f‹r_t
((
q2_subqu”y_agg»g©e_tu¶e
)),

1327 
q2_ps_još_s_n_r_subqu”y_·ck‘
,

1328 
Ãw
 
	`q2_subqu”y_agg»g©e_t
(),

1329 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
((), 
	`off£tof
(
q2_subqu”y_agg»g©e_tu¶e
, 
PS_PARTKEY
)),

1330 
Ãw
 
	`št_key_com·»_t
());

1335 
tu¶e_fifo
* 
q2_fš®_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q2_agg»g©e_tu¶e
));

1336 
·ck‘_t
* 
q2_fš®_·ck‘
 =

1337 
Ãw
 
	`hash_još_·ck‘_t
("subquery join main_query",

1338 
q2_fš®_bufãr
,

1339 
Ãw
 
	`q2_tİ100_f‹r_t
(),

1340 
q2_sÜt_·ck‘
,

1341 
q2_subqu”y_agg»g©e_·ck‘
,

1342 
Ãw
 
	`q2_fš®_još_t
());

1344 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

1345 
q2_·¹_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1346 
q2_·¹suµ_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1347 
q2_ps_još_p_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1348 
q2_suµl›r_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1349 
q2_s_još_ps_p_·k‘
->
	`assign_qu”y_¡©e
(
qs
);

1350 
q2_ÇtiÚ_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1351 
q2_s_ps_p_još_n_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1352 
q2_»giÚ_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1353 
q2_s_ps_p_n_još_r_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1354 
q2_sÜt_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1356 
q2_ÇtiÚ_tsÿn_subqu”y_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1357 
q2_»giÚ_tsÿn_subqu”y_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1358 
q2_n_još_r_subqu”y_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1359 
q2_suµl›r_tsÿn_subqu”y_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1360 
q2_s_još_n_r_subqu”y_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1361 
q2_·¹suµ_tsÿn_subqu”y_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1362 
q2_ps_još_s_n_r_subqu”y_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1363 
q2_subqu”y_agg»g©e_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1365 
q2_fš®_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1368 
ch_q2_´oûss_tu¶e_t
 
±
;

1369 
	`´oûss_qu”y
(
q2_fš®_·ck‘
, 
±
);

1370 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

1372  (
RCOK
);

1374 
	}
}

1375 
EXIT_NAMESPACE
(
qpe
);

	@src/workload/tpch/qpipe/qpipe_q20.cpp

33 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

34 
	~"wÜklßd/ch/ch_ut.h
"

35 
	~"qpe.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
usšg
 
Çme¥aû
 
	gqpe
;

42 
ENTER_NAMESPACE
(
ch
);

87 
	sq20_´ojeùed_·¹suµ_tu¶e
 {

88 
	mPS_PARTKEY
;

89 
	mPS_SUPPKEY
;

90 
	mPS_AVAILQTY
;

93 
	sq20_´ojeùed_·¹_tu¶e
 {

94 
	mP_PARTKEY
;

97 
	sq20_´ojeùed_suµl›r_tu¶e
 {

98 
	mS_SUPPKEY
;

99 
	mS_NATIONKEY
;

100 
	mS_NAME
[
STRSIZE
(25)];

101 
	mS_ADDRESS
[
STRSIZE
(40)];

104 
	sq20_´ojeùed_ÇtiÚ_tu¶e
 {

105 
	mN_NATIONKEY
;

108 
	sq20_´ojeùed_lše™em_tu¶e
 {

109 
	mL_PARTKEY
;

110 
	mL_SUPPKEY
;

111 
decim®
 
	mL_QUANTITY
;

114 
	sq20_p_još_ps_tu¶e
 {

115 
	mPS_PARTKEY
;

116 
	mPS_SUPPKEY
;

117 
	mPS_AVAILQTY
;

120 
	sq20_s_još_n_tu¶e
 {

121 
	mS_SUPPKEY
;

122 
	mS_NAME
[
STRSIZE
(25)];

123 
	mS_ADDRESS
[
STRSIZE
(40)];

126 
	sq20_p_ps_još_s_n_tu¶e
 {

127 
	mPS_PARTKEY
;

128 
	mS_SUPPKEY
;

129 
	mPS_AVAILQTY
;

130 
	mS_NAME
[
STRSIZE
(25)];

131 
	mS_ADDRESS
[
STRSIZE
(40)];

134 
	sq20_®l_jošs_tu¶e
 {

135 
	mS_SUPPKEY
;

136 
	mPS_AVAILQTY
;

137 
decim®
 
	mAVAILQTY_THRESHOLD
;

138 
	mS_NAME
[
STRSIZE
(25)];

139 
	mS_ADDRESS
[
STRSIZE
(40)];

142 
	sq20_fš®_tu¶e
 {

143 
	mS_SUPPKEY
;

144 
	mS_NAME
[
STRSIZE
(25)];

145 
	mS_ADDRESS
[
STRSIZE
(40)];

149 şas 
	cq20_·¹suµ_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


151 
´iv©e
:

152 
ShÜeTPCHEnv
* 
_chdb
;

153 
bË_row_t
* 
	m_´·¹suµ
;

154 
»p_row_t
 
	m_¼
;

157 
ch_·¹suµ_tu¶e
 
	m_·¹suµ
;

159 
	mpublic
:

160 
	$q20_·¹suµ_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q20_šput_t
 &
š
)

161 : 
	`tu¶e_f‹r_t
(
chdb
->
	`·¹suµ_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

163 
_´·¹suµ
 = 
_chdb
->
	`·¹suµ_mª
()->
	`g‘_tu¶e
();

164 
_¼
.
	`£t_ts
(
_chdb
->
	`·¹suµ_mª
()->
	`ts
(),

165 
_chdb
->
	`·¹suµ_desc
()->
	`maxsize
());

166 
_´·¹suµ
->
_»p
 = &
_¼
;

169 
vœtu®
 ~
	$q20_·¹suµ_tsÿn_f‹r_t
()

171 
_chdb
->
	`·¹suµ_mª
()->
	`give_tu¶e
(
_´·¹suµ
);

172 
	}
}

174 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

177 ià(!
_chdb
->
	`·¹suµ_mª
()->
	`lßd
(
_´·¹suµ
, 
šput
.
d©a
)) {

178 
	`as£¹
(
çl£
);

181  
Œue
;

182 
	}
}

185 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

187 
q20_´ojeùed_·¹suµ_tu¶e
 *
de¡
;

188 
de¡
 = 
®igÃd_ÿ¡
<
q20_´ojeùed_·¹suµ_tu¶e
>(
d
.
d©a
);

190 
_´·¹suµ
->
	`g‘_v®ue
(0, 
_·¹suµ
.
PS_PARTKEY
);

191 
_´·¹suµ
->
	`g‘_v®ue
(1, 
_·¹suµ
.
PS_SUPPKEY
);

192 
_´·¹suµ
->
	`g‘_v®ue
(2, 
_·¹suµ
.
PS_AVAILQTY
);

199 
de¡
->
PS_SUPPKEY
 = 
_·¹suµ
.PS_SUPPKEY;

200 
de¡
->
PS_PARTKEY
 = 
_·¹suµ
.PS_PARTKEY;

201 
de¡
->
PS_AVAILQTY
 = 
_·¹suµ
.PS_AVAILQTY;

202 
	}
}

204 
q20_·¹suµ_tsÿn_f‹r_t
* 
	$şÚe
() const {

205  
Ãw
 
	`q20_·¹suµ_tsÿn_f‹r_t
(*
this
);

206 
	}
}

208 
c_¡r
 
	$to_¡ršg
() const {

209  
	`c_¡r
("q20_partsupp_tscan_filter_t()");

210 
	}
}

213 şas 
	cq20_·¹_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


215 
´iv©e
:

216 
ShÜeTPCHEnv
* 
_chdb
;

217 
bË_row_t
* 
	m_´·¹
;

218 
»p_row_t
 
	m_¼
;

221 
ch_·¹_tu¶e
 
	m_·¹
;

223 
	m_cŞÜ
[
STRSIZE
(25)];

225 
q20_šput_t
* 
	mq20_šput
;

227 
	mpublic
:

229 
	$q20_·¹_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q20_šput_t
 &
š
)

230 : 
	`tu¶e_f‹r_t
(
chdb
->
	`·¹_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

232 
_´·¹
 = 
_chdb
->
	`·¹_mª
()->
	`g‘_tu¶e
();

233 
_¼
.
	`£t_ts
(
_chdb
->
	`·¹_mª
()->
	`ts
(),

234 
_chdb
->
	`·¹_desc
()->
	`maxsize
());

235 
_´·¹
->
_»p
 = &
_¼
;

237 
q20_šput
 = &
š
;

238 
	`²ame_to_¡r
(
q20_šput
->
p_cŞÜ
, 
_cŞÜ
);

240 
	`TRACE
(
TRACE_ALWAYS
, "Rªdom…»diÿ‹s:\nPART.P_NAME†ik'%s%%'\n", 
_cŞÜ
);

243 
vœtu®
 ~
	$q20_·¹_tsÿn_f‹r_t
()

246 
_chdb
->
	`·¹_mª
()->
	`give_tu¶e
(
_´·¹
);

247 
	}
}

251 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

254 ià(!
_chdb
->
	`·¹_mª
()->
	`lßd
(
_´·¹
, 
šput
.
d©a
)) {

255 
	`as£¹
(
çl£
);

258 
_´·¹
->
	`g‘_v®ue
(1, 
_·¹
.
P_NAME
, (_part.P_NAME));

260  
	`¡r¡r
(
_·¹
.
P_NAME
, 
_cŞÜ
);

261 
	}
}

264 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

266 
q20_´ojeùed_·¹_tu¶e
 *
de¡
;

267 
de¡
 = 
®igÃd_ÿ¡
<
q20_´ojeùed_·¹_tu¶e
>(
d
.
d©a
);

269 
_´·¹
->
	`g‘_v®ue
(0, 
_·¹
.
P_PARTKEY
);

273 
de¡
->
P_PARTKEY
 = 
_·¹
.P_PARTKEY;

274 
	}
}

276 
q20_·¹_tsÿn_f‹r_t
* 
	$şÚe
() const {

277  
Ãw
 
	`q20_·¹_tsÿn_f‹r_t
(*
this
);

278 
	}
}

280 
c_¡r
 
	$to_¡ršg
() const {

281  
	`c_¡r
("q20_part_tscan_filter_t()");

282 
	}
}

285 şas 
	cq20_suµl›r_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


287 
´iv©e
:

288 
ShÜeTPCHEnv
* 
_chdb
;

289 
bË_row_t
* 
	m_´suµl›r
;

290 
»p_row_t
 
	m_¼
;

293 
ch_suµl›r_tu¶e
 
	m_suµl›r
;

295 
	mpublic
:

296 
	$q20_suµl›r_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q20_šput_t
 &
š
)

297 : 
	`tu¶e_f‹r_t
(
chdb
->
	`suµl›r_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

299 
_´suµl›r
 = 
_chdb
->
	`suµl›r_mª
()->
	`g‘_tu¶e
();

300 
_¼
.
	`£t_ts
(
_chdb
->
	`suµl›r_mª
()->
	`ts
(),

301 
_chdb
->
	`suµl›r_desc
()->
	`maxsize
());

302 
_´suµl›r
->
_»p
 = &
_¼
;

305 
vœtu®
 ~
	$q20_suµl›r_tsÿn_f‹r_t
()

307 
_chdb
->
	`suµl›r_mª
()->
	`give_tu¶e
(
_´suµl›r
);

308 
	}
}

310 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

313 ià(!
_chdb
->
	`suµl›r_mª
()->
	`lßd
(
_´suµl›r
, 
šput
.
d©a
)) {

314 
	`as£¹
(
çl£
);

317  
Œue
;

318 
	}
}

321 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

323 
q20_´ojeùed_suµl›r_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q20_´ojeùed_suµl›r_tu¶e>(
d
.
d©a
);

326 
_´suµl›r
->
	`g‘_v®ue
(0, 
_suµl›r
.
S_SUPPKEY
);

327 
_´suµl›r
->
	`g‘_v®ue
(1, 
_suµl›r
.
S_NAME
, (_supplier.S_NAME));

328 
_´suµl›r
->
	`g‘_v®ue
(2, 
_suµl›r
.
S_ADDRESS
, (_supplier.S_ADDRESS));

329 
_´suµl›r
->
	`g‘_v®ue
(3, 
_suµl›r
.
S_NATIONKEY
);

333 
de¡
->
S_SUPPKEY
 = 
_suµl›r
.S_SUPPKEY;

334 
	`memıy
(
de¡
->
S_NAME
, 
_suµl›r
.S_NAME, (dest->S_NAME));

335 
	`memıy
(
de¡
->
S_ADDRESS
, 
_suµl›r
.S_ADDRESS, (dest->S_ADDRESS));

336 
de¡
->
S_NATIONKEY
 = 
_suµl›r
.S_NATIONKEY;

337 
	}
}

339 
q20_suµl›r_tsÿn_f‹r_t
* 
	$şÚe
() const {

340  
Ãw
 
	`q20_suµl›r_tsÿn_f‹r_t
(*
this
);

341 
	}
}

343 
c_¡r
 
	$to_¡ršg
() const {

344  
	`c_¡r
("q20_supplier_tscan_filter_t");

345 
	}
}

348 şas 
	cq20_ÇtiÚ_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


350 
´iv©e
:

351 
ShÜeTPCHEnv
* 
_chdb
;

352 
bË_row_t
* 
	m_´ÇtiÚ
;

353 
»p_row_t
 
	m_¼
;

356 
ch_ÇtiÚ_tu¶e
 
	m_ÇtiÚ
;

358 
	m_Çme
[
STRSIZE
(25)];

360 
	mpublic
:

361 
	$q20_ÇtiÚ_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q20_šput_t
 &
š
)

362 : 
	`tu¶e_f‹r_t
(
chdb
->
	`ÇtiÚ_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

364 
_´ÇtiÚ
 = 
_chdb
->
	`ÇtiÚ_mª
()->
	`g‘_tu¶e
();

365 
_¼
.
	`£t_ts
(
_chdb
->
	`ÇtiÚ_mª
()->
	`ts
(),

366 
_chdb
->
	`ÇtiÚ_desc
()->
	`maxsize
());

367 
_´ÇtiÚ
->
_»p
 = &
_¼
;

369 
	`ÇtiÚ_to_¡r
((&
š
)->
n_Çme
, 
_Çme
);

370 
	`TRACE
(
TRACE_ALWAYS
, "Rªdom…»diÿ‹:\nNATION:N_NAME = %s\n", 
_Çme
);

373 
vœtu®
 ~
	$q20_ÇtiÚ_tsÿn_f‹r_t
()

375 
_chdb
->
	`ÇtiÚ_mª
()->
	`give_tu¶e
(
_´ÇtiÚ
);

376 
	}
}

378 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

381 ià(!
_chdb
->
	`ÇtiÚ_mª
()->
	`lßd
(
_´ÇtiÚ
, 
šput
.
d©a
)) {

382 
	`as£¹
(
çl£
);

385 
_´ÇtiÚ
->
	`g‘_v®ue
(1, 
_ÇtiÚ
.
N_NAME
, (_nation.N_NAME));

387  (
	`¡rcmp
(
_ÇtiÚ
.
N_NAME
, 
_Çme
) == 0);

388 
	}
}

391 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

393 
q20_´ojeùed_ÇtiÚ_tu¶e
 *
de¡
;

394 
de¡
 = 
®igÃd_ÿ¡
<
q20_´ojeùed_ÇtiÚ_tu¶e
>(
d
.
d©a
);

396 
_´ÇtiÚ
->
	`g‘_v®ue
(0, 
_ÇtiÚ
.
N_NATIONKEY
);

401 
de¡
->
N_NATIONKEY
 = 
_ÇtiÚ
.N_NATIONKEY;

402 
	}
}

404 
q20_ÇtiÚ_tsÿn_f‹r_t
* 
	$şÚe
() const {

405  
Ãw
 
	`q20_ÇtiÚ_tsÿn_f‹r_t
(*
this
);

406 
	}
}

408 
c_¡r
 
	$to_¡ršg
() const {

409  
	`c_¡r
("q20_ÇtiÚ_tsÿn_f‹r_t(%s)", 
_Çme
);

410 
	}
}

413 şas 
	cq20_lše™em_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


415 
´iv©e
:

416 
ShÜeTPCHEnv
* 
_chdb
;

417 
bË_row_t
* 
	m_´lše
;

418 
»p_row_t
 
	m_¼
;

420 
ch_lše™em_tu¶e
 
	m_lše™em
;

421 
time_t
 
	m_shd©e
;

423 
time_t
 
	m_fœ¡_shd©e
;

424 
time_t
 
	m_Ï¡_shd©e
;

426 
q20_šput_t
 *
	mq20_šput
;

428 
	mpublic
:

429 
	$q20_lše™em_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q20_šput_t
 &
š
)

430 : 
	`tu¶e_f‹r_t
(
chdb
->
	`lše™em_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

432 
_´lše
 = 
_chdb
->
	`lše™em_mª
()->
	`g‘_tu¶e
();

433 
_¼
.
	`£t_ts
(
_chdb
->
	`lše™em_mª
()->
	`ts
(),

434 
_chdb
->
	`lše™em_desc
()->
	`maxsize
());

435 
_´lše
->
_»p
 = &
_¼
;

437 
q20_šput
 = &
š
;

438 
_fœ¡_shd©e
 = 
q20_šput
->
l_shd©e
;

440 
tm
 *tm = 
	`gmtime
(&
_fœ¡_shd©e
);

441 
tm
->
tm_y—r
++;

442 
_Ï¡_shd©e
 = 
	`mktime
(
tm
);

444 
f_shd©e
[10];

445 
l_shd©e
[10];

446 
	`tim‘_to_¡r
(
f_shd©e
, 
_fœ¡_shd©e
);

447 
	`tim‘_to_¡r
(
l_shd©e
, 
_Ï¡_shd©e
);

449 
	`TRACE
(
TRACE_ALWAYS
, "Rªdom…»diÿ‹s:\n% <ğL_SHIPDATE < %s\n", 
f_shd©e
, 
l_shd©e
);

452 
vœtu®
 ~
	$q20_lše™em_tsÿn_f‹r_t
()

455 
_chdb
->
	`lše™em_mª
()->
	`give_tu¶e
(
_´lše
);

456 
	}
}

458 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

460 ià(!
_chdb
->
	`lše™em_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

461 
	`as£¹
(
çl£
);

464 
_´lše
->
	`g‘_v®ue
(10, 
_lše™em
.
L_SHIPDATE
, (_lineitem.L_SHIPDATE));

465 
_shd©e
 = 
	`¡r_to_tim‘
(
_lše™em
.
L_SHIPDATE
);

467  
_shd©e
 >ğ
_fœ¡_shd©e
 && _shd©< 
_Ï¡_shd©e
;

468 
	}
}

470 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

472 
q20_´ojeùed_lše™em_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q20_´ojeùed_lše™em_tu¶e>(
d
.
d©a
);

474 
_´lše
->
	`g‘_v®ue
(1, 
_lše™em
.
L_PARTKEY
);

475 
_´lše
->
	`g‘_v®ue
(2, 
_lše™em
.
L_SUPPKEY
);

476 
_´lše
->
	`g‘_v®ue
(4, 
_lše™em
.
L_QUANTITY
);

480 
de¡
->
L_PARTKEY
 = 
_lše™em
.L_PARTKEY;

481 
de¡
->
L_SUPPKEY
 = 
_lše™em
.L_SUPPKEY;

482 
de¡
->
L_QUANTITY
 = 
_lše™em
.L_QUANTITY;

483 
	}
}

485 
q20_lše™em_tsÿn_f‹r_t
* 
	$şÚe
() const {

486  
Ãw
 
	`q20_lše™em_tsÿn_f‹r_t
(*
this
);

487 
	}
}

489 
c_¡r
 
	$to_¡ršg
() const {

490  
	`c_¡r
("q20_lineitem_tscan_filter_t()");

491 
	}
}

496 
	gq20_p_još_ps_t
 : 
public
 
tu¶e_još_t
 {

498 
q20_p_još_ps_t
()

499 : 
tu¶e_još_t
((
q20_´ojeùed_·¹_tu¶e
),

500 
off£tof
(
q20_´ojeùed_·¹_tu¶e
, 
P_PARTKEY
),

501 (
q20_´ojeùed_·¹suµ_tu¶e
),

502 
off£tof
(
q20_´ojeùed_·¹suµ_tu¶e
, 
PS_PARTKEY
),

504 (
q20_p_još_ps_tu¶e
))

508 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

509 
q20_p_još_ps_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q20_p_još_ps_tu¶e>(
d
.
d©a
);

510 
q20_´ojeùed_·¹_tu¶e
 *
	g·¹
 = 
®igÃd_ÿ¡
<q20_´ojeùed_·¹_tu¶e>(
l
.
d©a
);

511 
q20_´ojeùed_·¹suµ_tu¶e
 *
	g·¹suµ
 = 
®igÃd_ÿ¡
<q20_´ojeùed_·¹suµ_tu¶e>(
r
.
d©a
);

513 
	gde¡
->
	gPS_AVAILQTY
 = 
·¹suµ
->
PS_AVAILQTY
;

514 
	gde¡
->
	gPS_PARTKEY
 = 
·¹suµ
->
PS_PARTKEY
;

515 
	gde¡
->
	gPS_SUPPKEY
 = 
·¹suµ
->
PS_SUPPKEY
;

520 
vœtu®
 
q20_p_još_ps_t
* 
şÚe
() const {

521  
Ãw
 
q20_p_još_ps_t
(*
this
);

524 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

525  
c_¡r
("join PART, PARTSUPP; select PS_AVAILQTY, PS_PARTKEY, PS_SUPPKEY");

529 
	gq20_s_još_n_t
 : 
public
 
tu¶e_još_t
 {

531 
q20_s_još_n_t
()

532 : 
tu¶e_još_t
((
q20_´ojeùed_suµl›r_tu¶e
),

533 
off£tof
(
q20_´ojeùed_suµl›r_tu¶e
, 
S_NATIONKEY
),

534 (
q20_´ojeùed_ÇtiÚ_tu¶e
),

535 
off£tof
(
q20_´ojeùed_ÇtiÚ_tu¶e
, 
N_NATIONKEY
),

537 (
q20_s_još_n_tu¶e
))

541 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

542 
q20_s_još_n_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q20_s_još_n_tu¶e>(
d
.
d©a
);

543 
q20_´ojeùed_suµl›r_tu¶e
 *
	gsuµ
 = 
®igÃd_ÿ¡
<q20_´ojeùed_suµl›r_tu¶e>(
l
.
d©a
);

544 
q20_´ojeùed_ÇtiÚ_tu¶e
 *
	gÇtiÚ
 = 
®igÃd_ÿ¡
<q20_´ojeùed_ÇtiÚ_tu¶e>(
r
.
d©a
);

546 
	gde¡
->
	gS_SUPPKEY
 = 
suµ
->
S_SUPPKEY
;

547 
memıy
(
de¡
->
S_ADDRESS
, 
suµ
->S_ADDRESS, (dest->S_ADDRESS));

548 
memıy
(
de¡
->
S_NAME
, 
suµ
->S_NAME, (dest->S_NAME));

553 
vœtu®
 
q20_s_još_n_t
* 
şÚe
() const {

554  
Ãw
 
q20_s_još_n_t
(*
this
);

557 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

558  
c_¡r
("join SUPPLIER, NATION; select S_SUPPKEY, S_ADDRESS, S_NAME");

562 
	gq20_p_ps_još_s_n_t
 : 
public
 
tu¶e_još_t
 {

564 
q20_p_ps_još_s_n_t
()

565 : 
tu¶e_još_t
((
q20_p_još_ps_tu¶e
),

566 
off£tof
(
q20_p_još_ps_tu¶e
, 
PS_SUPPKEY
),

567 (
q20_s_još_n_tu¶e
),

568 
off£tof
(
q20_s_još_n_tu¶e
, 
S_SUPPKEY
),

570 (
q20_p_ps_još_s_n_tu¶e
))

574 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

575 
q20_p_ps_još_s_n_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q20_p_ps_još_s_n_tu¶e>(
d
.
d©a
);

576 
q20_p_još_ps_tu¶e
 *
	gËá
 = 
®igÃd_ÿ¡
<q20_p_još_ps_tu¶e>(
l
.
d©a
);

577 
q20_s_još_n_tu¶e
 *
	gright
 = 
®igÃd_ÿ¡
<q20_s_još_n_tu¶e>(
r
.
d©a
);

579 
	gde¡
->
	gPS_AVAILQTY
 = 
Ëá
->
PS_AVAILQTY
;

580 
	gde¡
->
	gPS_PARTKEY
 = 
Ëá
->
PS_PARTKEY
;

581 
memıy
(
de¡
->
S_ADDRESS
, 
right
->S_ADDRESS, (dest->S_ADDRESS));

582 
memıy
(
de¡
->
S_NAME
, 
right
->S_NAME, (dest->S_NAME));

583 
	gde¡
->
	gS_SUPPKEY
 = 
right
->
S_SUPPKEY
;

588 
vœtu®
 
q20_p_ps_još_s_n_t
* 
şÚe
() const {

589  
Ãw
 
q20_p_ps_još_s_n_t
(*
this
);

592 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

593  
c_¡r
("join PART_PARTSUPP, SUPPLIER_NATION; select PS_AVAILQTY, PS_PARTKEY, S_ADDRESS, S_NAME, S_SUPPKEY");

597 
	gq20_lše™em_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

599 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

601 
q20_lše™em_agg»g©e_t
()

602 : 
tu¶e_agg»g©e_t
((
q20_´ojeùed_lše™em_tu¶e
))

606 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
() {

607  &
_exŒaùÜ
;

610 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
t
) {

611 
q20_´ojeùed_lše™em_tu¶e
 *
	gagg
 = 
®igÃd_ÿ¡
<q20_´ojeùed_lše™em_tu¶e>(
agg_d©a
);

612 
q20_´ojeùed_lše™em_tu¶e
 *
	gšput
 = 
®igÃd_ÿ¡
<q20_´ojeùed_lše™em_tu¶e>(
t
.
d©a
);

614 
	gagg
->
	gL_PARTKEY
 = 
šput
->
L_PARTKEY
;

615 
	gagg
->
	gL_SUPPKEY
 = 
šput
->
L_SUPPKEY
;

616 
	gagg
->
	gL_QUANTITY
 +ğ
šput
->
L_QUANTITY
;

618 
vœtu®
 
fšish
(
tu¶e_t
 &
de¡
, cÚ¡ * 
agg_d©a
) {

619 
memıy
(
de¡
.
d©a
, 
agg_d©a
, de¡.
size
);

621 
vœtu®
 
q20_lše™em_agg»g©e_t
* 
şÚe
() const {

622  
Ãw
 
q20_lše™em_agg»g©e_t
(*
this
);

624 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

629 
	gq20_fš®_još_t
 : 
public
 
tu¶e_još_t
 {

631 
q20_fš®_još_t
()

632 : 
tu¶e_još_t
((
q20_´ojeùed_lše™em_tu¶e
),

633 
off£tof
(
q20_´ojeùed_lše™em_tu¶e
, 
L_PARTKEY
),

634 (
q20_p_ps_još_s_n_tu¶e
),

635 
off£tof
(
q20_p_ps_još_s_n_tu¶e
, 
PS_PARTKEY
),

637 (
q20_®l_jošs_tu¶e
))

641 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

642 
q20_®l_jošs_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q20_®l_jošs_tu¶e>(
d
.
d©a
);

643 
q20_´ojeùed_lše™em_tu¶e
 *
	glše
 = 
®igÃd_ÿ¡
<q20_´ojeùed_lše™em_tu¶e>(
l
.
d©a
);

644 
q20_p_ps_još_s_n_tu¶e
 *
	gright
 = 
®igÃd_ÿ¡
<q20_p_ps_još_s_n_tu¶e>(
r
.
d©a
);

646 
	gde¡
->
	gAVAILQTY_THRESHOLD
 = 
lše
->
L_QUANTITY
;

647 
	gde¡
->
	gPS_AVAILQTY
 = 
right
->
PS_AVAILQTY
;

648 
memıy
(
de¡
->
S_ADDRESS
, 
right
->S_ADDRESS, (dest->S_ADDRESS));

649 
memıy
(
de¡
->
S_NAME
, 
right
->S_NAME, (dest->S_NAME));

650 
	gde¡
->
	gS_SUPPKEY
 = 
right
->
S_SUPPKEY
;

656 
vœtu®
 
q20_fš®_još_t
* 
şÚe
() const {

657  
Ãw
 
q20_fš®_još_t
(*
this
);

660 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

661  
c_¡r
("join LINEITEM, PART_PARTSUPP_SUPPLIER_NATION; select AVAILQTY_THRESHOLD, PS_AVAILQTY, S_ADDRESS, S_NAME");

665 
	gq20_fš®_još_f‹r_t
 : 
public
 
tu¶e_f‹r_t
 {

667 
q20_fš®_još_f‹r_t
()

668 : 
tu¶e_f‹r_t
((
q20_®l_jošs_tu¶e
))

672 
boŞ
 
£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

673 
q20_®l_jošs_tu¶e
 *
š
 = 
®igÃd_ÿ¡
<q20_®l_jošs_tu¶e>(
šput
.
d©a
);

674  
	gš
->
	gPS_AVAILQTY
 > (0.5 * in->
	gAVAILQTY_THRESHOLD
.
to_doubË
());

677 
vœtu®
 
´ojeù
(
tu¶e_t
 &
out
, cÚ¡u¶e_ˆ&
š
) {

678 
q20_fš®_tu¶e
 *
	gd
 = 
®igÃd_ÿ¡
<q20_fš®_tu¶e>(
out
.
d©a
);

679 
q20_®l_jošs_tu¶e
 *
	gs
 = 
®igÃd_ÿ¡
<q20_®l_jošs_tu¶e>(
š
.
d©a
);

681 
	gd
->
	gS_SUPPKEY
 = 
s
->
S_SUPPKEY
;

682 
memıy
(
d
->
S_NAME
, 
s
->S_NAME, (d->S_NAME));

683 
memıy
(
d
->
S_ADDRESS
, 
s
->S_ADDRESS, (d->S_ADDRESS));

688 
vœtu®
 
q20_fš®_još_f‹r_t
* 
şÚe
() const {

689  
Ãw
 
q20_fš®_još_f‹r_t
(*
this
);

692 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

693  
c_¡r
("q20_final_join_filter_t");

697 
	gq20_di¡šù_agg_t
 : 
public
 
tu¶e_agg»g©e_t
 {

699 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

701 
q20_di¡šù_agg_t
()

702 : 
tu¶e_agg»g©e_t
((
q20_fš®_tu¶e
)), 
_exŒaùÜ
((), 
off£tof
(q20_fš®_tu¶e, 
S_SUPPKEY
))

706 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
() {

707  &
	g_exŒaùÜ
;

710 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
t
) {

711 
memıy
(
agg_d©a
, 
t
.
d©a
, (
q20_fš®_tu¶e
));

713 
vœtu®
 
fšish
(
tu¶e_t
 &
de¡
, cÚ¡ * 
agg_d©a
) {

714 
memıy
(
de¡
.
d©a
, 
agg_d©a
, de¡.
size
);

716 
vœtu®
 
q20_di¡šù_agg_t
* 
şÚe
() const {

717  
Ãw
 
q20_di¡šù_agg_t
(*
this
);

719 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

724 
	gq20_sÜt_key_com·»_t
 : 
public
 
key_com·»_t
 {

726 
q20_sÜt_key_com·»_t
()

730 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

731  
¡rcmp
((*)
key1
, (*)
key2
);

734 
vœtu®
 
q20_sÜt_key_com·»_t
* 
şÚe
() const {

735  
Ãw
 
q20_sÜt_key_com·»_t
(*
this
);

740 şas 
	cch_q20_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t
 {

742 
public
:

744 
vœtu®
 
	$begš
() {

745 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q20 %s %s\n",

749 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

750 
q20_fš®_tu¶e
 *
agg
 = 
®igÃd_ÿ¡
<q20_fš®_tu¶e>(
ouut
.
d©a
);

752 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q20 % %s\n", 
agg
->
S_NAME
,‡gg->
S_ADDRESS
);

753 
	}
}

764 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_q20
(cÚ¡ 
xù_id
,

765 
q20_šput_t
& 
š
)

767 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** q20 *********\n");

769 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

770 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

774 
tu¶e_fifo
* 
q20_ÇtiÚ_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q20_´ojeùed_ÇtiÚ_tu¶e
));

775 
·ck‘_t
* 
q20_ÇtiÚ_tsÿn_·ck‘
 =

776 
Ãw
 
	`tsÿn_·ck‘_t
("nation TSCAN",

777 
q20_ÇtiÚ_bufãr
,

778 
Ãw
 
	`q20_ÇtiÚ_tsÿn_f‹r_t
(
this
, 
š
),

779 
this
->
	`db
(),

780 
_²©iÚ_desc
.
	`g‘
(),

781 
pxù
);

784 
tu¶e_fifo
* 
q20_suµl›r_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q20_´ojeùed_suµl›r_tu¶e
));

785 
·ck‘_t
* 
q20_suµl›r_tsÿn_·ck‘
 =

786 
Ãw
 
	`tsÿn_·ck‘_t
("supplier TSCAN",

787 
q20_suµl›r_bufãr
,

788 
Ãw
 
	`q20_suµl›r_tsÿn_f‹r_t
(
this
, 
š
),

789 
this
->
	`db
(),

790 
_psuµl›r_desc
.
	`g‘
(),

791 
pxù
);

794 
tu¶e_fifo
* 
q20_·¹suµ_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q20_´ojeùed_·¹suµ_tu¶e
));

795 
·ck‘_t
* 
q20_·¹suµ_tsÿn_·ck‘
 =

796 
Ãw
 
	`tsÿn_·ck‘_t
("partsupp TSCAN",

797 
q20_·¹suµ_bufãr
,

798 
Ãw
 
	`q20_·¹suµ_tsÿn_f‹r_t
(
this
, 
š
),

799 
this
->
	`db
(),

800 
_µ¬tsuµ_desc
.
	`g‘
(),

801 
pxù
);

804 
tu¶e_fifo
* 
q20_·¹_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q20_´ojeùed_·¹_tu¶e
));

805 
·ck‘_t
* 
q20_·¹_tsÿn_·ck‘
 =

806 
Ãw
 
	`tsÿn_·ck‘_t
("part TSCAN",

807 
q20_·¹_bufãr
,

808 
Ãw
 
	`q20_·¹_tsÿn_f‹r_t
(
this
, 
š
),

809 
this
->
	`db
(),

810 
_µ¬t_desc
.
	`g‘
(),

811 
pxù
);

814 
tu¶e_fifo
* 
q20_lše™em_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q20_´ojeùed_lše™em_tu¶e
));

815 
·ck‘_t
* 
q20_lše™em_tsÿn_·ck‘
 =

816 
Ãw
 
	`tsÿn_·ck‘_t
("lineitem TSCAN",

817 
q20_lše™em_bufãr
,

818 
Ãw
 
	`q20_lše™em_tsÿn_f‹r_t
(
this
, 
š
),

819 
this
->
	`db
(),

820 
_¶še™em_desc
.
	`g‘
(),

821 
pxù
);

824 
tu¶e_fifo
* 
q20_lše™em_agg»g©e_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q20_´ojeùed_lše™em_tu¶e
));

825 
·ck‘_t
* 
q20_lše™em_agg»g©e_·ck‘
 =

826 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("lineitem SUM AGGREGATE L_QUANTITY",

827 
q20_lše™em_agg»g©e_bufãr
,

828 
Ãw
 
	`ŒivŸl_f‹r_t
((
q20_´ojeùed_lše™em_tu¶e
)),

829 
q20_lše™em_tsÿn_·ck‘
,

830 
Ãw
 
	`q20_lše™em_agg»g©e_t
(),

831 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
(2 * (), 
	`off£tof
(
q20_´ojeùed_lše™em_tu¶e
, 
L_PARTKEY
)),

832 
Ãw
 
	`št_key_com·»_t
());

836 
tu¶e_fifo
* 
q20_s_još_n_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q20_s_još_n_tu¶e
));

837 
·ck‘_t
* 
q20_s_još_n_·ck‘
 =

838 
Ãw
 
	`hash_još_·ck‘_t
("supplier -‚ation HJOIN",

839 
q20_s_još_n_bufãr
,

840 
Ãw
 
	`ŒivŸl_f‹r_t
((
q20_s_još_n_tu¶e
)),

841 
q20_suµl›r_tsÿn_·ck‘
,

842 
q20_ÇtiÚ_tsÿn_·ck‘
,

843 
Ãw
 
	`q20_s_još_n_t
());

846 
tu¶e_fifo
* 
q20_p_još_ps_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q20_p_još_ps_tu¶e
));

847 
·ck‘_t
* 
q20_p_još_ps_·ck‘
 =

848 
Ãw
 
	`hash_još_·ck‘_t
("part -…artsupp HJOIN",

849 
q20_p_još_ps_bufãr
,

850 
Ãw
 
	`ŒivŸl_f‹r_t
((
q20_p_još_ps_tu¶e
)),

851 
q20_·¹_tsÿn_·ck‘
,

852 
q20_·¹suµ_tsÿn_·ck‘
,

853 
Ãw
 
	`q20_p_još_ps_t
());

856 
tu¶e_fifo
* 
q20_p_ps_još_s_n_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q20_p_ps_još_s_n_tu¶e
));

857 
·ck‘_t
* 
q20_p_ps_još_s_n_·ck‘
 =

858 
Ãw
 
	`hash_još_·ck‘_t
("part_partsupp - supplier_nation HJOIN",

859 
q20_p_ps_još_s_n_bufãr
,

860 
Ãw
 
	`ŒivŸl_f‹r_t
((
q20_p_ps_još_s_n_tu¶e
)),

861 
q20_p_još_ps_·ck‘
,

862 
q20_s_još_n_·ck‘
,

863 
Ãw
 
	`q20_p_ps_još_s_n_t
());

866 
tu¶e_fifo
* 
q20_®l_jošs_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q20_fš®_tu¶e
));

867 
·ck‘_t
* 
q20_®l_jošs_·ck‘
 =

868 
Ãw
 
	`hash_još_·ck‘_t
("lineitem -…art_partsupp_supplier_nation HJOIN",

869 
q20_®l_jošs_bufãr
,

870 
Ãw
 
	`q20_fš®_još_f‹r_t
(),

871 
q20_lše™em_agg»g©e_·ck‘
,

872 
q20_p_ps_još_s_n_·ck‘
,

873 
Ãw
 
	`q20_fš®_još_t
());

875 
tu¶e_fifo
* 
q20_di¡šù_agg_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q20_fš®_tu¶e
));

876 
·ck‘_t
* 
q20_di¡šù_agg_·ck‘
 =

877 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("DISTINCT AGG",

878 
q20_di¡šù_agg_bufãr
,

879 
Ãw
 
	`ŒivŸl_f‹r_t
((
q20_fš®_tu¶e
)),

880 
q20_®l_jošs_·ck‘
,

881 
Ãw
 
	`q20_di¡šù_agg_t
(),

882 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
((), 
	`off£tof
(
q20_fš®_tu¶e
, 
S_SUPPKEY
)),

883 
Ãw
 
	`št_key_com·»_t
());

886 
tu¶e_fifo
* 
q20_fš®_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q20_fš®_tu¶e
));

887 
·ck‘_t
* 
q20_fš®_·ck‘
 =

888 
Ãw
 
	`sÜt_·ck‘_t
("SORT BY S_NAME",

889 
q20_fš®_bufãr
,

890 
Ãw
 
	`ŒivŸl_f‹r_t
((
q20_fš®_tu¶e
)),

891 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
(
	`STRSIZE
(25è* (), 
	`off£tof
(
q20_fš®_tu¶e
, 
S_NAME
)),

892 
Ãw
 
	`q20_sÜt_key_com·»_t
(),

893 
q20_di¡šù_agg_·ck‘
);

896 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

897 
q20_ÇtiÚ_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

898 
q20_suµl›r_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

899 
q20_·¹suµ_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

900 
q20_·¹_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

901 
q20_lše™em_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

902 
q20_lše™em_agg»g©e_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

903 
q20_s_još_n_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

904 
q20_p_još_ps_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

905 
q20_p_ps_još_s_n_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

906 
q20_®l_jošs_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

907 
q20_di¡šù_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

908 
q20_fš®_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

912 
ch_q20_´oûss_tu¶e_t
 
±
;

914 
	`´oûss_qu”y
(
q20_fš®_·ck‘
, 
±
);

916 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

919  (
RCOK
);

920 
	}
}

922 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/qpipe/qpipe_q21.cpp

33 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

34 
	~"wÜklßd/ch/ch_ut.h
"

35 
	~"qpe.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
usšg
 
Çme¥aû
 
	gqpe
;

42 
ENTER_NAMESPACE
(
ch
);

90 
	sq21_´ojeùed_ÇtiÚ_tu¶e
 {

91 
	mN_NATIONKEY
;

94 
	sq21_´ojeùed_suµl›r_tu¶e
 {

95 
	mS_SUPPKEY
;

96 
	mS_NAME
[
STRSIZE
(25)];

97 
	mS_NATIONKEY
;

100 
	sq21_´ojeùed_lše™em_l1_tu¶e
 {

101 
	mL_ORDERKEY
;

102 
	mL_LINENUMBER
;

103 
	mL_SUPPKEY
;

106 
	sq21_´ojeùed_lše™em_l2_tu¶e
 {

107 
	mL_ORDERKEY
;

108 
	mL_SUPPKEY
;

111 
	sq21_´ojeùed_Üd”s_tu¶e
 {

112 
	mO_ORDERKEY
;

115 
	sq21_s_još_n_tu¶e
 {

116 
	mS_SUPPKEY
;

117 
	mS_NAME
[
STRSIZE
(25)];

120 
	sq21_l1_još_s_n_tu¶e
 {

121 
	mL1_ORDERKEY
;

122 
	mL1_LINENUMBER
;

123 
	mL1_SUPPKEY
;

124 
	mS_NAME
[
STRSIZE
(25)];

127 
	sq21_l2_još_l1_s_n_tu¶e
 {

128 
	mL1_ORDERKEY
;

129 
	mL1_LINENUMBER
;

130 
	mL1_SUPPKEY
;

131 
	mL2_SUPPKEY
;

132 
	mS_NAME
[
STRSIZE
(25)];

135 
	sq21_sub_agg_tu¶e
 {

136 
	mL_ORDERKEY
;

137 
	mS_NAME
[
STRSIZE
(25)];

140 
	sq21_®l_jošs_tu¶e
 {

141 
	mS_NAME
[
STRSIZE
(25)];

144 
	sq21_fš®_tu¶e
 {

145 
	mNUMWAIT
;

146 
	mS_NAME
[
STRSIZE
(25)];

151 şas 
	cq21_ÇtiÚ_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


153 
´iv©e
:

154 
ShÜeTPCHEnv
* 
_chdb
;

155 
bË_row_t
* 
	m_´ÇtiÚ
;

156 
»p_row_t
 
	m_¼
;

159 
ch_ÇtiÚ_tu¶e
 
	m_ÇtiÚ
;

161 
	m_Âame
[
STRSIZE
(25)];

163 
	mpublic
:

164 
	$q21_ÇtiÚ_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q21_šput_t
 &
š
)

165 : 
	`tu¶e_f‹r_t
(
chdb
->
	`ÇtiÚ_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

167 
_´ÇtiÚ
 = 
_chdb
->
	`ÇtiÚ_mª
()->
	`g‘_tu¶e
();

168 
_¼
.
	`£t_ts
(
_chdb
->
	`ÇtiÚ_mª
()->
	`ts
(),

169 
_chdb
->
	`ÇtiÚ_desc
()->
	`maxsize
());

170 
_´ÇtiÚ
->
_»p
 = &
_¼
;

172 
	`ÇtiÚ_to_¡r
((&
š
)->
n_Çme
, 
_Âame
);

173 
	`TRACE
(
TRACE_ALWAYS
, "Rªdom…»diÿ‹:\nNATION.N_NAME = %s\n", 
_Âame
);

176 
vœtu®
 ~
	$q21_ÇtiÚ_tsÿn_f‹r_t
()

178 
_chdb
->
	`ÇtiÚ_mª
()->
	`give_tu¶e
(
_´ÇtiÚ
);

179 
	}
}

181 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

184 ià(!
_chdb
->
	`ÇtiÚ_mª
()->
	`lßd
(
_´ÇtiÚ
, 
šput
.
d©a
)) {

185 
	`as£¹
(
çl£
);

188 
_´ÇtiÚ
->
	`g‘_v®ue
(1, 
_ÇtiÚ
.
N_NAME
, (_nation.N_NAME));

190  (
	`¡rcmp
(
_ÇtiÚ
.
N_NAME
, 
_Âame
) == 0);

192 
	}
}

195 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

197 
q21_´ojeùed_ÇtiÚ_tu¶e
 *
de¡
;

198 
de¡
 = 
®igÃd_ÿ¡
<
q21_´ojeùed_ÇtiÚ_tu¶e
>(
d
.
d©a
);

200 
_´ÇtiÚ
->
	`g‘_v®ue
(0, 
_ÇtiÚ
.
N_NATIONKEY
);

205 
de¡
->
N_NATIONKEY
 = 
_ÇtiÚ
.N_NATIONKEY;

206 
	}
}

208 
q21_ÇtiÚ_tsÿn_f‹r_t
* 
	$şÚe
() const {

209  
Ãw
 
	`q21_ÇtiÚ_tsÿn_f‹r_t
(*
this
);

210 
	}
}

212 
c_¡r
 
	$to_¡ršg
() const {

213  
	`c_¡r
("q21_nation_tscan_filter_t()");

214 
	}
}

218 şas 
	cq21_suµl›r_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


220 
´iv©e
:

221 
ShÜeTPCHEnv
* 
_chdb
;

222 
bË_row_t
* 
	m_´suµl›r
;

223 
»p_row_t
 
	m_¼
;

226 
ch_suµl›r_tu¶e
 
	m_suµl›r
;

228 
	mpublic
:

229 
	$q21_suµl›r_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q21_šput_t
 &
š
)

230 : 
	`tu¶e_f‹r_t
(
chdb
->
	`suµl›r_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

232 
_´suµl›r
 = 
_chdb
->
	`suµl›r_mª
()->
	`g‘_tu¶e
();

233 
_¼
.
	`£t_ts
(
_chdb
->
	`suµl›r_mª
()->
	`ts
(),

234 
_chdb
->
	`suµl›r_desc
()->
	`maxsize
());

235 
_´suµl›r
->
_»p
 = &
_¼
;

238 
vœtu®
 ~
	$q21_suµl›r_tsÿn_f‹r_t
()

240 
_chdb
->
	`suµl›r_mª
()->
	`give_tu¶e
(
_´suµl›r
);

241 
	}
}

243 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

246 ià(!
_chdb
->
	`suµl›r_mª
()->
	`lßd
(
_´suµl›r
, 
šput
.
d©a
)) {

247 
	`as£¹
(
çl£
);

250  
Œue
;

251 
	}
}

254 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

256 
q21_´ojeùed_suµl›r_tu¶e
 *
de¡
;

257 
de¡
 = 
®igÃd_ÿ¡
<
q21_´ojeùed_suµl›r_tu¶e
>(
d
.
d©a
);

260 
_´suµl›r
->
	`g‘_v®ue
(0, 
_suµl›r
.
S_SUPPKEY
);

261 
_´suµl›r
->
	`g‘_v®ue
(1, 
_suµl›r
.
S_NAME
, (_supplier.S_NAME));

262 
_´suµl›r
->
	`g‘_v®ue
(3, 
_suµl›r
.
S_NATIONKEY
);

267 
de¡
->
S_SUPPKEY
 = 
_suµl›r
.S_SUPPKEY;

268 
	`memıy
(
de¡
->
S_NAME
, 
_suµl›r
.S_NAME, (dest->S_NAME));

269 
de¡
->
S_NATIONKEY
 = 
_suµl›r
.S_NATIONKEY;

271 
	}
}

273 
q21_suµl›r_tsÿn_f‹r_t
* 
	$şÚe
() const {

274  
Ãw
 
	`q21_suµl›r_tsÿn_f‹r_t
(*
this
);

275 
	}
}

277 
c_¡r
 
	$to_¡ršg
() const {

278  
	`c_¡r
("q21_supplier_tscan_filter_t");

279 
	}
}

283 şas 
	cq21_lše™em_l1_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


285 
´iv©e
:

286 
ShÜeTPCHEnv
* 
_chdb
;

287 
bË_row_t
* 
	m_´lše
;

288 
»p_row_t
 
	m_¼
;

290 
ch_lše™em_tu¶e
 
	m_lše™em
;

292 
	mpublic
:

293 
	$q21_lše™em_l1_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q21_šput_t
 &
š
)

294 : 
	`tu¶e_f‹r_t
(
chdb
->
	`lše™em_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

296 
_´lše
 = 
_chdb
->
	`lše™em_mª
()->
	`g‘_tu¶e
();

297 
_¼
.
	`£t_ts
(
_chdb
->
	`lše™em_mª
()->
	`ts
(),

298 
_chdb
->
	`lše™em_desc
()->
	`maxsize
());

299 
_´lše
->
_»p
 = &
_¼
;

302 
vœtu®
 ~
	$q21_lše™em_l1_tsÿn_f‹r_t
()

305 
_chdb
->
	`lše™em_mª
()->
	`give_tu¶e
(
_´lše
);

306 
	}
}

308 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

310 ià(!
_chdb
->
	`lše™em_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

311 
	`as£¹
(
çl£
);

314 
_´lše
->
	`g‘_v®ue
(11, 
_lše™em
.
L_COMMITDATE
, (_lineitem.L_COMMITDATE));

315 
_´lše
->
	`g‘_v®ue
(12, 
_lše™em
.
L_RECEIPTDATE
, (_lineitem.L_RECEIPTDATE));

317  
	`¡r_to_tim‘
(
_lše™em
.
L_RECEIPTDATE
è> sŒ_to_tim‘(_lše™em.
L_COMMITDATE
);

318 
	}
}

320 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

322 
q21_´ojeùed_lše™em_l1_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q21_´ojeùed_lše™em_l1_tu¶e>(
d
.
d©a
);

324 
_´lše
->
	`g‘_v®ue
(0, 
_lše™em
.
L_ORDERKEY
);

325 
_´lše
->
	`g‘_v®ue
(2, 
_lše™em
.
L_SUPPKEY
);

326 
_´lše
->
	`g‘_v®ue
(3, 
_lše™em
.
L_LINENUMBER
);

330 
de¡
->
L_ORDERKEY
 = 
_lše™em
.L_ORDERKEY;

331 
de¡
->
L_LINENUMBER
 = 
_lše™em
.L_LINENUMBER;

332 
de¡
->
L_SUPPKEY
 = 
_lše™em
.L_SUPPKEY;

333 
	}
}

335 
q21_lše™em_l1_tsÿn_f‹r_t
* 
	$şÚe
() const {

336  
Ãw
 
	`q21_lše™em_l1_tsÿn_f‹r_t
(*
this
);

337 
	}
}

339 
c_¡r
 
	$to_¡ršg
() const {

340  
	`c_¡r
("q21_lineitem_l1_tscan_filter_t(l_receiptdate >†_commitdate)");

341 
	}
}

344 şas 
	cq21_lše™em_l2_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


346 
´iv©e
:

347 
ShÜeTPCHEnv
* 
_chdb
;

348 
bË_row_t
* 
	m_´lše
;

349 
»p_row_t
 
	m_¼
;

351 
ch_lše™em_tu¶e
 
	m_lše™em
;

353 
	mpublic
:

354 
	$q21_lše™em_l2_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q21_šput_t
 &
š
)

355 : 
	`tu¶e_f‹r_t
(
chdb
->
	`lše™em_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

357 
_´lše
 = 
_chdb
->
	`lše™em_mª
()->
	`g‘_tu¶e
();

358 
_¼
.
	`£t_ts
(
_chdb
->
	`lše™em_mª
()->
	`ts
(),

359 
_chdb
->
	`lše™em_desc
()->
	`maxsize
());

360 
_´lše
->
_»p
 = &
_¼
;

363 
vœtu®
 ~
	$q21_lše™em_l2_tsÿn_f‹r_t
()

366 
_chdb
->
	`lše™em_mª
()->
	`give_tu¶e
(
_´lše
);

367 
	}
}

369 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

371 ià(!
_chdb
->
	`lše™em_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

372 
	`as£¹
(
çl£
);

375  
Œue
;

376 
	}
}

378 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

380 
q21_´ojeùed_lše™em_l2_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q21_´ojeùed_lše™em_l2_tu¶e>(
d
.
d©a
);

382 
_´lše
->
	`g‘_v®ue
(0, 
_lše™em
.
L_ORDERKEY
);

383 
_´lše
->
	`g‘_v®ue
(2, 
_lše™em
.
L_SUPPKEY
);

387 
de¡
->
L_ORDERKEY
 = 
_lše™em
.L_ORDERKEY;

388 
de¡
->
L_SUPPKEY
 = 
_lše™em
.L_SUPPKEY;

389 
	}
}

391 
q21_lše™em_l2_tsÿn_f‹r_t
* 
	$şÚe
() const {

392  
Ãw
 
	`q21_lše™em_l2_tsÿn_f‹r_t
(*
this
);

393 
	}
}

395 
c_¡r
 
	$to_¡ršg
() const {

396  
	`c_¡r
("q21_lineitem_l2_tscan_filter_t");

397 
	}
}

401 şas 
	cq21_Üd”s_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


403 
´iv©e
:

404 
ShÜeTPCHEnv
* 
_chdb
;

405 
bË_row_t
* 
	m_´Üd”s
;

406 
»p_row_t
 
	m_¼
;

408 
ch_Üd”s_tu¶e
 
	m_Üd”s
;

410 
	mpublic
:

411 
	$q21_Üd”s_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q21_šput_t
 &
š
)

412 : 
	`tu¶e_f‹r_t
(
chdb
->
	`Üd”s_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

414 
_´Üd”s
 = 
_chdb
->
	`Üd”s_mª
()->
	`g‘_tu¶e
();

415 
_¼
.
	`£t_ts
(
_chdb
->
	`Üd”s_mª
()->
	`ts
(),

416 
_chdb
->
	`Üd”s_desc
()->
	`maxsize
());

417 
_´Üd”s
->
_»p
 = &
_¼
;

420 
vœtu®
 ~
	$q21_Üd”s_tsÿn_f‹r_t
()

423 
_chdb
->
	`Üd”s_mª
()->
	`give_tu¶e
(
_´Üd”s
);

424 
	}
}

426 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

428 ià(!
_chdb
->
	`Üd”s_mª
()->
	`lßd
(
_´Üd”s
, 
šput
.
d©a
)) {

429 
	`as£¹
(
çl£
);

432 
_´Üd”s
->
	`g‘_v®ue
(2, 
_Üd”s
.
O_ORDERSTATUS
);

434  
_Üd”s
.
O_ORDERSTATUS
 == 'F';

435 
	}
}

437 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

439 
q21_´ojeùed_Üd”s_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q21_´ojeùed_Üd”s_tu¶e>(
d
.
d©a
);

441 
_´Üd”s
->
	`g‘_v®ue
(0, 
_Üd”s
.
O_ORDERKEY
);

445 
de¡
->
O_ORDERKEY
 = 
_Üd”s
.O_ORDERKEY;

446 
	}
}

448 
q21_Üd”s_tsÿn_f‹r_t
* 
	$şÚe
() const {

449  
Ãw
 
	`q21_Üd”s_tsÿn_f‹r_t
(*
this
);

450 
	}
}

452 
c_¡r
 
	$to_¡ršg
() const {

453  
	`c_¡r
("q21_orders_tscan_filter_t(o_orderstatus = 'F')");

454 
	}
}

459 
	gq21_s_još_n_t
 : 
public
 
tu¶e_još_t
 {

461 
q21_s_još_n_t
()

462 : 
tu¶e_još_t
((
q21_´ojeùed_suµl›r_tu¶e
),

463 
off£tof
(
q21_´ojeùed_suµl›r_tu¶e
, 
S_NATIONKEY
),

464 (
q21_´ojeùed_ÇtiÚ_tu¶e
),

465 
off£tof
(
q21_´ojeùed_ÇtiÚ_tu¶e
, 
N_NATIONKEY
),

467 (
q21_s_još_n_tu¶e
))

471 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

472 
q21_s_još_n_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q21_s_još_n_tu¶e>(
d
.
d©a
);

473 
q21_´ojeùed_suµl›r_tu¶e
 *
	gsuµ
 = 
®igÃd_ÿ¡
<q21_´ojeùed_suµl›r_tu¶e>(
l
.
d©a
);

474 
q21_´ojeùed_ÇtiÚ_tu¶e
 *
	gÇtiÚ
 = 
®igÃd_ÿ¡
<q21_´ojeùed_ÇtiÚ_tu¶e>(
r
.
d©a
);

476 
	gde¡
->
	gS_SUPPKEY
 = 
suµ
->
S_SUPPKEY
;

477 
memıy
(
de¡
->
S_NAME
, 
suµ
->S_NAME, (dest->S_NAME));

482 
vœtu®
 
q21_s_još_n_t
* 
şÚe
() const {

483  
Ãw
 
q21_s_još_n_t
(*
this
);

486 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

487  
c_¡r
("join SUPPLIER, NATION; select S_SUPPKEY, S_NAME");

491 
	gq21_l1_još_s_n_t
 : 
public
 
tu¶e_još_t
 {

493 
q21_l1_još_s_n_t
()

494 : 
tu¶e_još_t
((
q21_´ojeùed_lše™em_l1_tu¶e
),

495 
off£tof
(
q21_´ojeùed_lše™em_l1_tu¶e
, 
L_SUPPKEY
),

496 (
q21_s_još_n_tu¶e
),

497 
off£tof
(
q21_s_još_n_tu¶e
, 
S_SUPPKEY
),

499 (
q21_l1_još_s_n_tu¶e
))

503 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

504 
q21_l1_još_s_n_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q21_l1_još_s_n_tu¶e>(
d
.
d©a
);

505 
q21_´ojeùed_lše™em_l1_tu¶e
 *
	glše
 = 
®igÃd_ÿ¡
<q21_´ojeùed_lše™em_l1_tu¶e>(
l
.
d©a
);

506 
q21_s_još_n_tu¶e
 *
	gright
 = 
®igÃd_ÿ¡
<q21_s_još_n_tu¶e>(
r
.
d©a
);

508 
	gde¡
->
	gL1_LINENUMBER
 = 
lše
->
L_LINENUMBER
;

509 
	gde¡
->
	gL1_ORDERKEY
 = 
lše
->
L_ORDERKEY
;

510 
	gde¡
->
	gL1_SUPPKEY
 = 
lše
->
L_SUPPKEY
;

511 
memıy
(
de¡
->
S_NAME
, 
right
->S_NAME, (dest->S_NAME));

516 
vœtu®
 
q21_l1_još_s_n_t
* 
şÚe
() const {

517  
Ãw
 
q21_l1_još_s_n_t
(*
this
);

520 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

521  
c_¡r
("join LINEITEM L1, SUPPLIER_NATION; select L1.L_LINENUMBER, L1.L_ORDERKEY, L1.L_SUPPKEY, S_NAME");

525 
	gq21_l2_još_l1_s_n_t
 : 
public
 
tu¶e_još_t
 {

527 
q21_l2_još_l1_s_n_t
()

528 : 
tu¶e_još_t
((
q21_´ojeùed_lše™em_l2_tu¶e
),

529 
off£tof
(
q21_´ojeùed_lše™em_l2_tu¶e
, 
L_ORDERKEY
),

530 (
q21_l1_još_s_n_tu¶e
),

531 
off£tof
(
q21_l1_još_s_n_tu¶e
, 
L1_ORDERKEY
),

533 (
q21_l2_još_l1_s_n_tu¶e
))

537 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

538 
q21_l2_još_l1_s_n_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q21_l2_još_l1_s_n_tu¶e>(
d
.
d©a
);

539 
q21_´ojeùed_lše™em_l2_tu¶e
 *
	glše
 = 
®igÃd_ÿ¡
<q21_´ojeùed_lše™em_l2_tu¶e>(
l
.
d©a
);

540 
q21_l1_još_s_n_tu¶e
 *
	gright
 = 
®igÃd_ÿ¡
<q21_l1_još_s_n_tu¶e>(
r
.
d©a
);

542 
	gde¡
->
	gL1_LINENUMBER
 = 
right
->
L1_LINENUMBER
;

543 
	gde¡
->
	gL1_ORDERKEY
 = 
right
->
L1_ORDERKEY
;

544 
	gde¡
->
	gL1_SUPPKEY
 = 
right
->
L1_SUPPKEY
;

545 
	gde¡
->
	gL2_SUPPKEY
 = 
lše
->
L_SUPPKEY
;

546 
memıy
(
de¡
->
S_NAME
, 
right
->S_NAME, (dest->S_NAME));

552 
vœtu®
 
q21_l2_još_l1_s_n_t
* 
şÚe
() const {

553  
Ãw
 
q21_l2_još_l1_s_n_t
(*
this
);

556 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

557  
c_¡r
("join LINEITEM L2, LINEITEM_SUPPLIER_NATION; select L1_LINENUMBER, L1_ORDERKEY, L1_SUPPKEY, L2.L_SUPPKEY, S_NAME");

561 
	gq21_exi¡s_još_f‹r_t
 : 
public
 
tu¶e_f‹r_t
 {

563 
q21_exi¡s_još_f‹r_t
()

564 : 
tu¶e_f‹r_t
((
q21_l2_još_l1_s_n_tu¶e
))

568 
boŞ
 
£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

569 
q21_l2_još_l1_s_n_tu¶e
 *
š
 = 
®igÃd_ÿ¡
<q21_l2_još_l1_s_n_tu¶e>(
šput
.
d©a
);

570  
	gš
->
	gL1_SUPPKEY
 !ğ
š
->
L2_SUPPKEY
;

573 
vœtu®
 
q21_exi¡s_još_f‹r_t
* 
şÚe
() const {

574  
Ãw
 
q21_exi¡s_još_f‹r_t
(*
this
);

577 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

578  
c_¡r
("q21_exists_join_filter_t");

582 
	gq21_sub_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

584 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

586 
q21_sub_agg»g©e_t
()

587 : 
tu¶e_agg»g©e_t
((
q21_sub_agg_tu¶e
))

591 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
() {

592  &
_exŒaùÜ
;

595 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
t
) {

596 
q21_sub_agg_tu¶e
 *
	gagg
 = 
®igÃd_ÿ¡
<q21_sub_agg_tu¶e>(
agg_d©a
);

597 
q21_l2_još_l1_s_n_tu¶e
 *
	gšput
 = 
®igÃd_ÿ¡
<q21_l2_još_l1_s_n_tu¶e>(
t
.
d©a
);

599 
	gagg
->
	gL_ORDERKEY
 = 
šput
->
L1_ORDERKEY
;

600 
memıy
(
agg
->
S_NAME
, 
šput
->S_NAME, (agg->S_NAME));

602 
vœtu®
 
fšish
(
tu¶e_t
 &
de¡
, cÚ¡ * 
agg_d©a
) {

603 
memıy
(
de¡
.
d©a
, 
agg_d©a
, de¡.
size
);

605 
vœtu®
 
q21_sub_agg»g©e_t
* 
şÚe
() const {

606  
Ãw
 
q21_sub_agg»g©e_t
(*
this
);

608 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

614 
	gq21_fš®_još_t
 : 
public
 
tu¶e_još_t
 {

616 
q21_fš®_još_t
()

617 : 
tu¶e_još_t
((
q21_´ojeùed_Üd”s_tu¶e
),

618 
off£tof
(
q21_´ojeùed_Üd”s_tu¶e
, 
O_ORDERKEY
),

619 (
q21_sub_agg_tu¶e
),

620 
off£tof
(
q21_sub_agg_tu¶e
, 
L_ORDERKEY
),

622 (
q21_®l_jošs_tu¶e
))

626 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

627 
q21_®l_jošs_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q21_®l_jošs_tu¶e>(
d
.
d©a
);

628 
q21_´ojeùed_Üd”s_tu¶e
 *
	gÜd”
 = 
®igÃd_ÿ¡
<q21_´ojeùed_Üd”s_tu¶e>(
l
.
d©a
);

629 
q21_sub_agg_tu¶e
 *
	gright
 = 
®igÃd_ÿ¡
<q21_sub_agg_tu¶e>(
r
.
d©a
);

631 
memıy
(
de¡
->
S_NAME
, 
right
->S_NAME, (dest->S_NAME));

636 
vœtu®
 
q21_fš®_još_t
* 
şÚe
() const {

637  
Ãw
 
q21_fš®_još_t
(*
this
);

640 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

641  
c_¡r
("join ORDERS, L2_L1_SUPPLIER_NATION; select S_NAME");

645 
	gq21_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

647 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

649 
q21_agg»g©e_t
()

650 : 
tu¶e_agg»g©e_t
((
q21_fš®_tu¶e
))

654 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
() {

655  &
_exŒaùÜ
;

658 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
t
) {

659 
q21_fš®_tu¶e
 *
	gagg
 = 
®igÃd_ÿ¡
<q21_fš®_tu¶e>(
agg_d©a
);

660 
q21_®l_jošs_tu¶e
 *
	gšput
 = 
®igÃd_ÿ¡
<q21_®l_jošs_tu¶e>(
t
.
d©a
);

662 
memıy
(
agg
->
S_NAME
, 
šput
->S_NAME, (agg->S_NAME));

663 
	gagg
->
	gNUMWAIT
++;

665 
vœtu®
 
fšish
(
tu¶e_t
 &
de¡
, cÚ¡ * 
agg_d©a
) {

666 
memıy
(
de¡
.
d©a
, 
agg_d©a
, de¡.
size
);

668 
vœtu®
 
q21_agg»g©e_t
* 
şÚe
() const {

669  
Ãw
 
q21_agg»g©e_t
(*
this
);

671 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

677 
	gq21_sÜt_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

679 
q21_sÜt_key_exŒaùÜ_t
()

680 : 
key_exŒaùÜ_t
((
q21_fš®_tu¶e
))

684 
vœtu®
 
exŒaù_hšt
(cÚ¡ *
key
) const {

685 
q21_fš®_tu¶e
 *
tu¶e
 = 
®igÃd_ÿ¡
<q21_fš®_tu¶e>(
key
);

686  -(
	gtu¶e
->
	gNUMWAIT
);

689 
vœtu®
 
key_exŒaùÜ_t
* 
şÚe
() const {

690  
Ãw
 
q21_sÜt_key_exŒaùÜ_t
(*
this
);

694 
	gq21_sÜt_key_com·»_t
 : 
public
 
key_com·»_t
 {

696 
q21_sÜt_key_com·»_t
()

700 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

701 
q21_fš®_tu¶e
 *
	gt1
 = 
®igÃd_ÿ¡
<q21_fš®_tu¶e>(
key1
);

702 
q21_fš®_tu¶e
 *
	gt2
 = 
®igÃd_ÿ¡
<q21_fš®_tu¶e>(
key2
);

703  (
	gt1
->
	gNUMWAIT
 !ğ
t2
->
NUMWAIT
 ?2->NUMWAIT - 
t1
->NUMWAIT : 
¡rcmp
Ñ1->
S_NAME
,2->S_NAME));

706 
vœtu®
 
q21_sÜt_key_com·»_t
* 
şÚe
() const {

707  
Ãw
 
q21_sÜt_key_com·»_t
(*
this
);

713 şas 
	cch_q21_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t
 {

715 
public
:

717 
vœtu®
 
	$begš
() {

718 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q21 %s %s\n",

722 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

723 
q21_fš®_tu¶e
 *
agg
 = 
®igÃd_ÿ¡
<q21_fš®_tu¶e>(
ouut
.
d©a
);

725 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q21 % %d\n", 
agg
->
S_NAME
,‡gg->
NUMWAIT
);

726 
	}
}

737 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_q21
(cÚ¡ 
xù_id
,

738 
q21_šput_t
& 
š
)

740 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** q21 *********\n");

742 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

743 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

747 
tu¶e_fifo
* 
q21_ÇtiÚ_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q21_´ojeùed_ÇtiÚ_tu¶e
));

748 
·ck‘_t
* 
q21_ÇtiÚ_tsÿn_·ck‘
 =

749 
Ãw
 
	`tsÿn_·ck‘_t
("nation TSCAN",

750 
q21_ÇtiÚ_bufãr
,

751 
Ãw
 
	`q21_ÇtiÚ_tsÿn_f‹r_t
(
this
, 
š
),

752 
this
->
	`db
(),

753 
_²©iÚ_desc
.
	`g‘
(),

754 
pxù
);

757 
tu¶e_fifo
* 
q21_suµl›r_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q21_´ojeùed_suµl›r_tu¶e
));

758 
·ck‘_t
* 
q21_suµl›r_tsÿn_·ck‘
 =

759 
Ãw
 
	`tsÿn_·ck‘_t
("supplier TSCAN",

760 
q21_suµl›r_bufãr
,

761 
Ãw
 
	`q21_suµl›r_tsÿn_f‹r_t
(
this
, 
š
),

762 
this
->
	`db
(),

763 
_psuµl›r_desc
.
	`g‘
(),

764 
pxù
);

767 
tu¶e_fifo
* 
q21_lše™em_l1_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q21_´ojeùed_lše™em_l1_tu¶e
));

768 
·ck‘_t
* 
q21_lše™em_l1_tsÿn_·ck‘
 =

769 
Ãw
 
	`tsÿn_·ck‘_t
("lineitem†1 TSCAN",

770 
q21_lše™em_l1_bufãr
,

771 
Ãw
 
	`q21_lše™em_l1_tsÿn_f‹r_t
(
this
, 
š
),

772 
this
->
	`db
(),

773 
_¶še™em_desc
.
	`g‘
(),

774 
pxù
);

777 
tu¶e_fifo
* 
q21_lše™em_l2_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q21_´ojeùed_lše™em_l2_tu¶e
));

778 
·ck‘_t
* 
q21_lše™em_l2_tsÿn_·ck‘
 =

779 
Ãw
 
	`tsÿn_·ck‘_t
("lineitem†2 TSCAN",

780 
q21_lše™em_l2_bufãr
,

781 
Ãw
 
	`q21_lše™em_l2_tsÿn_f‹r_t
(
this
, 
š
),

782 
this
->
	`db
(),

783 
_¶še™em_desc
.
	`g‘
(),

784 
pxù
);

787 
tu¶e_fifo
* 
q21_Üd”s_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q21_´ojeùed_Üd”s_tu¶e
));

788 
·ck‘_t
* 
q21_Üd”s_tsÿn_·ck‘
 =

789 
Ãw
 
	`tsÿn_·ck‘_t
("orders TSCAN",

790 
q21_Üd”s_bufãr
,

791 
Ãw
 
	`q21_Üd”s_tsÿn_f‹r_t
(
this
, 
š
),

792 
this
->
	`db
(),

793 
_pÜd”s_desc
.
	`g‘
(),

794 
pxù
);

798 
tu¶e_fifo
* 
q21_s_još_n_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q21_s_još_n_tu¶e
));

799 
·ck‘_t
* 
q21_s_još_n_·ck‘
 =

800 
Ãw
 
	`hash_još_·ck‘_t
("supplier -‚ation HJOIN",

801 
q21_s_još_n_bufãr
,

802 
Ãw
 
	`ŒivŸl_f‹r_t
((
q21_s_još_n_tu¶e
)),

803 
q21_suµl›r_tsÿn_·ck‘
,

804 
q21_ÇtiÚ_tsÿn_·ck‘
,

805 
Ãw
 
	`q21_s_još_n_t
());

808 
tu¶e_fifo
* 
q21_l1_još_s_n_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q21_l1_još_s_n_tu¶e
));

809 
·ck‘_t
* 
q21_l1_još_s_n_·ck‘
 =

810 
Ãw
 
	`hash_još_·ck‘_t
("lineitem†1 - supplier_nation HJOIN",

811 
q21_l1_još_s_n_bufãr
,

812 
Ãw
 
	`ŒivŸl_f‹r_t
((
q21_l1_još_s_n_tu¶e
)),

813 
q21_lše™em_l1_tsÿn_·ck‘
,

814 
q21_s_još_n_·ck‘
,

815 
Ãw
 
	`q21_l1_još_s_n_t
());

818 
tu¶e_fifo
* 
q21_l2_još_l1_s_n_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q21_l2_još_l1_s_n_tu¶e
));

819 
·ck‘_t
* 
q21_l2_još_l1_s_n_·ck‘
 =

820 
Ãw
 
	`hash_još_·ck‘_t
("lineitem†2 -†1_supplier_nation HJOIN",

821 
q21_l2_još_l1_s_n_bufãr
,

822 
Ãw
 
	`q21_exi¡s_još_f‹r_t
(),

823 
q21_lše™em_l2_tsÿn_·ck‘
,

824 
q21_l1_još_s_n_·ck‘
,

825 
Ãw
 
	`q21_l2_još_l1_s_n_t
());

828 
tu¶e_fifo
* 
q21_sub_agg_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q21_sub_agg_tu¶e
));

829 
·ck‘_t
* 
q21_sub_agg_·ck‘
 =

830 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("SUB AGGREGATE ON L_ORDERKEY, L_LINENUMBER",

831 
q21_sub_agg_bufãr
,

832 
Ãw
 
	`ŒivŸl_f‹r_t
((
q21_sub_agg_tu¶e
)),

833 
q21_l2_još_l1_s_n_·ck‘
,

834 
Ãw
 
	`q21_sub_agg»g©e_t
(),

835 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
(2 * (), 
	`off£tof
(
q21_l2_još_l1_s_n_tu¶e
, 
L1_ORDERKEY
)),

836 
Ãw
 
	`št_key_com·»_t
());

839 
tu¶e_fifo
* 
q21_®l_jošs_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q21_®l_jošs_tu¶e
));

840 
·ck‘_t
* 
q21_®l_jošs_·ck‘
 =

841 
Ãw
 
	`hash_još_·ck‘_t
("orders -†2_l1_supplier_nation HJOIN",

842 
q21_®l_jošs_bufãr
,

843 
Ãw
 
	`ŒivŸl_f‹r_t
((
q21_®l_jošs_tu¶e
)),

844 
q21_Üd”s_tsÿn_·ck‘
,

845 
q21_sub_agg_·ck‘
,

846 
Ãw
 
	`q21_fš®_još_t
());

849 
tu¶e_fifo
* 
q21_agg»g©e_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q21_fš®_tu¶e
));

850 
·ck‘_t
* 
q21_agg»g©e_·ck‘
 =

851 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("AGG GROUP BY S_NAME, COUNT",

852 
q21_agg»g©e_bufãr
,

853 
Ãw
 
	`ŒivŸl_f‹r_t
((
q21_fš®_tu¶e
)),

854 
q21_®l_jošs_·ck‘
,

855 
Ãw
 
	`q21_agg»g©e_t
(),

856 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
(
	`STRSIZE
(25è* (), 
	`off£tof
(
q21_®l_jošs_tu¶e
, 
S_NAME
)),

857 
Ãw
 
	`št_key_com·»_t
());

860 
tu¶e_fifo
* 
q21_fš®_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q21_fš®_tu¶e
));

861 
·ck‘_t
* 
q21_fš®_·ck‘
 =

862 
Ãw
 
	`sÜt_·ck‘_t
("ORDER BY NUMWAIT desc, S_NAME",

863 
q21_fš®_bufãr
,

864 
Ãw
 
	`ŒivŸl_f‹r_t
((
q21_fš®_tu¶e
)),

865 
Ãw
 
	`q21_sÜt_key_exŒaùÜ_t
(),

866 
Ãw
 
	`q21_sÜt_key_com·»_t
(),

867 
q21_agg»g©e_·ck‘
);

870 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

871 
q21_ÇtiÚ_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

872 
q21_suµl›r_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

873 
q21_lše™em_l1_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

874 
q21_lše™em_l2_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

875 
q21_Üd”s_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

876 
q21_s_još_n_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

877 
q21_l1_još_s_n_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

878 
q21_l2_još_l1_s_n_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

879 
q21_sub_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

880 
q21_®l_jošs_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

881 
q21_agg»g©e_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

882 
q21_fš®_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

886 
ch_q21_´oûss_tu¶e_t
 
±
;

888 
	`´oûss_qu”y
(
q21_fš®_·ck‘
, 
±
);

890 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

893  (
RCOK
);

894 
	}
}

896 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/qpipe/qpipe_q22.cpp

33 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

34 
	~"wÜklßd/ch/ch_ut.h
"

35 
	~"qpe.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
usšg
 
Çme¥aû
 
	gqpe
;

42 
ENTER_NAMESPACE
(
ch
);

87 
	sq22_´ojeùed_cu¡om”_tu¶e
 {

88 
	mJOINCODE
;

89 
	mCNTRYCODE
;

90 
decim®
 
	mC_ACCTBAL
;

93 
	sq22_´ojeùed_cu¡om”_sub_tu¶e
 {

94 
decim®
 
	mC_ACCTBAL
;

97 
	sq22_sub_agg_tu¶e
 {

98 
	mJOINCODE
;

99 
decim®
 
	mSUM_ACCTBAL
;

100 
	mCOUNT
;

101 
decim®
 
	mAVG_ACCTBAL
;

104 
	sq22_c_još_c_tu¶e
 {

105 
	mCNTRYCODE
;

106 
decim®
 
	mC_ACCTBAL
;

107 
decim®
 
	mACCTBAL_THRESHOLD
;

110 
	sq22_agg»g©e_tu¶e
 {

111 
	mCNTRYCODE
;

112 
	mNUMCUST
;

113 
decim®
 
	mTOTACCTBAL
;

118 şas 
	cq22_cu¡om”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


120 
´iv©e
:

121 
ShÜeTPCHEnv
* 
_chdb
;

122 
bË_row_t
* 
	m_´cu¡
;

123 
»p_row_t
 
	m_¼
;

125 
ch_cu¡om”_tu¶e
 
	m_cu¡om”
;

126 
	m_úŒycode_ch¬
[3];

127 
	m_úŒycode
;

129 
	m_úŒycodes
[7];

132 
	mpublic
:

133 
	$q22_cu¡om”_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q22_šput_t
 &
š
)

134 : 
	`tu¶e_f‹r_t
(
chdb
->
	`cu¡om”_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

136 
_´cu¡
 = 
_chdb
->
	`cu¡om”_mª
()->
	`g‘_tu¶e
();

137 
_¼
.
	`£t_ts
(
_chdb
->
	`cu¡om”_mª
()->
	`ts
(),

138 
_chdb
->
	`cu¡om”_desc
()->
	`maxsize
());

139 
_´cu¡
->
_»p
 = &
_¼
;

141 
	`memıy
(
_úŒycodes
, (&
š
)->
úŒycode
, (_cntrycodes));

142 
	`TRACE
(
TRACE_ALWAYS
, "Rªdom…»diÿ‹s:\nsub¡ršg(c_phÚäom 1 fÜ 2èš ('%d', '%d', '%d', '%d', '%d', '%d', '%d')\n", 
_úŒycodes
[0], _cntrycodes[1], _cntrycodes[2], _cntrycodes[3],

143 
_úŒycodes
[4], _cntrycodes[5], _cntrycodes[6]);

146 
vœtu®
 ~
	$q22_cu¡om”_tsÿn_f‹r_t
()

149 
_chdb
->
	`cu¡om”_mª
()->
	`give_tu¶e
(
_´cu¡
);

150 
	}
}

152 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

154 ià(!
_chdb
->
	`cu¡om”_mª
()->
	`lßd
(
_´cu¡
, 
šput
.
d©a
)) {

155 
	`as£¹
(
çl£
);

158 
_´cu¡
->
	`g‘_v®ue
(4, 
_cu¡om”
.
C_PHONE
, (_customer.C_PHONE));

160 
_úŒycode_ch¬
[0] = 
_cu¡om”
.
C_PHONE
[0];

161 
_úŒycode_ch¬
[1] = 
_cu¡om”
.
C_PHONE
[1];

162 
_úŒycode_ch¬
[2] = '\0';

163 
_úŒycode
 = 
	`©oi
(
_úŒycode_ch¬
);

165 
i
 = 0; i < 7; i++) {

166 if(
_úŒycode
 =ğ
_úŒycodes
[
i
]) {

167  
Œue
;

170  
çl£
;

171 
	}
}

173 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

175 
q22_´ojeùed_cu¡om”_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q22_´ojeùed_cu¡om”_tu¶e>(
d
.
d©a
);

177 
_´cu¡
->
	`g‘_v®ue
(4, 
_cu¡om”
.
C_PHONE
, (_customer.C_PHONE));

178 
_´cu¡
->
	`g‘_v®ue
(5, 
_cu¡om”
.
C_ACCTBAL
);

182 
_úŒycode_ch¬
[0] = 
_cu¡om”
.
C_PHONE
[0];

183 
_úŒycode_ch¬
[1] = 
_cu¡om”
.
C_PHONE
[1];

184 
_úŒycode_ch¬
[2] = '\0';

185 
de¡
->
CNTRYCODE
 = 
	`©oi
(
_úŒycode_ch¬
);

186 
de¡
->
C_ACCTBAL
 = 
_cu¡om”
.C_ACCTBAL / 100.0;

187 
de¡
->
JOINCODE
 = 0;

188 
	}
}

190 
q22_cu¡om”_tsÿn_f‹r_t
* 
	$şÚe
() const {

191  
Ãw
 
	`q22_cu¡om”_tsÿn_f‹r_t
(*
this
);

192 
	}
}

194 
c_¡r
 
	$to_¡ršg
() const {

195  
	`c_¡r
("q22_customer_tscan_filter_t");

196 
	}
}

200 şas 
	cq22_cu¡om”_sub_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


202 
´iv©e
:

203 
ShÜeTPCHEnv
* 
_chdb
;

204 
bË_row_t
* 
	m_´cu¡
;

205 
»p_row_t
 
	m_¼
;

207 
ch_cu¡om”_tu¶e
 
	m_cu¡om”
;

208 
	m_úŒycode_ch¬
[3];

209 
	m_úŒycode
;

211 
	m_úŒycodes
[7];

213 
	mpublic
:

214 
	$q22_cu¡om”_sub_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q22_šput_t
 &
š
)

215 : 
	`tu¶e_f‹r_t
(
chdb
->
	`cu¡om”_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

217 
_´cu¡
 = 
_chdb
->
	`cu¡om”_mª
()->
	`g‘_tu¶e
();

218 
_¼
.
	`£t_ts
(
_chdb
->
	`cu¡om”_mª
()->
	`ts
(),

219 
_chdb
->
	`cu¡om”_desc
()->
	`maxsize
());

220 
_´cu¡
->
_»p
 = &
_¼
;

222 
	`memıy
(
_úŒycodes
, (&
š
)->
úŒycode
, (_cntrycodes));

225 
vœtu®
 ~
	$q22_cu¡om”_sub_tsÿn_f‹r_t
()

228 
_chdb
->
	`cu¡om”_mª
()->
	`give_tu¶e
(
_´cu¡
);

229 
	}
}

231 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

233 ià(!
_chdb
->
	`cu¡om”_mª
()->
	`lßd
(
_´cu¡
, 
šput
.
d©a
)) {

234 
	`as£¹
(
çl£
);

237 
_´cu¡
->
	`g‘_v®ue
(4, 
_cu¡om”
.
C_PHONE
, (_customer.C_PHONE));

238 
_´cu¡
->
	`g‘_v®ue
(5, 
_cu¡om”
.
C_ACCTBAL
);

239 if(
_cu¡om”
.
C_ACCTBAL
 <= 0) {

240  
çl£
;

242 
_úŒycode_ch¬
[0] = 
_cu¡om”
.
C_PHONE
[0];

243 
_úŒycode_ch¬
[1] = 
_cu¡om”
.
C_PHONE
[1];

244 
_úŒycode_ch¬
[2] = '\0';

245 
_úŒycode
 = 
	`©oi
(
_úŒycode_ch¬
);

247 
i
 = 0; i < 7; i++) {

248 if(
_úŒycode
 =ğ
_úŒycodes
[
i
]) {

249  
Œue
;

252  
çl£
;

253 
	}
}

255 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

257 
q22_´ojeùed_cu¡om”_sub_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q22_´ojeùed_cu¡om”_sub_tu¶e>(
d
.
d©a
);

259 
_´cu¡
->
	`g‘_v®ue
(5, 
_cu¡om”
.
C_ACCTBAL
);

263 
de¡
->
C_ACCTBAL
 = 
_cu¡om”
.C_ACCTBAL / 100.0;

264 
	}
}

266 
q22_cu¡om”_sub_tsÿn_f‹r_t
* 
	$şÚe
() const {

267  
Ãw
 
	`q22_cu¡om”_sub_tsÿn_f‹r_t
(*
this
);

268 
	}
}

270 
c_¡r
 
	$to_¡ršg
() const {

271  
	`c_¡r
("q22_customer_sub_tscan_filter_t");

272 
	}
}

275 
	gq22_sub_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

277 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

279 
q22_sub_agg»g©e_t
()

280 : 
tu¶e_agg»g©e_t
((
q22_sub_agg_tu¶e
))

284 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
() {

285  &
_exŒaùÜ
;

288 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
t
) {

289 
q22_sub_agg_tu¶e
 *
	gagg
 = 
®igÃd_ÿ¡
<q22_sub_agg_tu¶e>(
agg_d©a
);

290 
q22_´ojeùed_cu¡om”_sub_tu¶e
 *
	gšput
 = 
®igÃd_ÿ¡
<q22_´ojeùed_cu¡om”_sub_tu¶e>(
t
.
d©a
);

292 
	gagg
->
	gCOUNT
++;

293 
	gagg
->
	gSUM_ACCTBAL
 +ğ
šput
->
C_ACCTBAL
;

295 
vœtu®
 
fšish
(
tu¶e_t
 &
de¡
, cÚ¡ * 
agg_d©a
) {

296 
memıy
(
de¡
.
d©a
, 
agg_d©a
, de¡.
size
);

297 
q22_sub_agg_tu¶e
 *
	gagg
 = 
®igÃd_ÿ¡
<q22_sub_agg_tu¶e>(
de¡
.
d©a
);

298 
	gagg
->
	gAVG_ACCTBAL
 = 
agg
->
SUM_ACCTBAL
 /‡gg->
COUNT
;

299 
	gagg
->
	gJOINCODE
 = 0;

302 
vœtu®
 
q22_sub_agg»g©e_t
* 
şÚe
() const {

303  
Ãw
 
q22_sub_agg»g©e_t
(*
this
);

305 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

311 
	gq22_c_još_c_t
 : 
public
 
tu¶e_još_t
 {

313 
q22_c_još_c_t
()

314 : 
tu¶e_još_t
((
q22_´ojeùed_cu¡om”_tu¶e
),

315 
off£tof
(
q22_´ojeùed_cu¡om”_tu¶e
, 
JOINCODE
),

316 (
q22_sub_agg_tu¶e
),

317 
off£tof
(
q22_sub_agg_tu¶e
, 
JOINCODE
),

319 (
q22_c_još_c_tu¶e
))

323 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

324 
q22_c_još_c_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q22_c_još_c_tu¶e>(
d
.
d©a
);

325 
q22_´ojeùed_cu¡om”_tu¶e
 *
	gcu¡
 = 
®igÃd_ÿ¡
<q22_´ojeùed_cu¡om”_tu¶e>(
l
.
d©a
);

326 
q22_sub_agg_tu¶e
 *
	gsub
 = 
®igÃd_ÿ¡
<q22_sub_agg_tu¶e>(
r
.
d©a
);

328 
	gde¡
->
	gACCTBAL_THRESHOLD
 = 
sub
->
AVG_ACCTBAL
;

329 
	gde¡
->
	gC_ACCTBAL
 = 
cu¡
->
C_ACCTBAL
;

330 
	gde¡
->
	gCNTRYCODE
 = 
cu¡
->
CNTRYCODE
;

335 
vœtu®
 
q22_c_još_c_t
* 
şÚe
() const {

336  
Ãw
 
q22_c_još_c_t
(*
this
);

339 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

340  
c_¡r
("join CUSTOMER c, CUSTOMER sub; select sub.ACCTBAL_THRESHOLD, c.C_ACCTBAL, c.CNTRYCODE");

344 
	gq22_još_f‹r_t
 : 
public
 
tu¶e_f‹r_t
 {

346 
q22_još_f‹r_t
()

347 : 
tu¶e_f‹r_t
((
q22_c_još_c_tu¶e
))

351 
boŞ
 
£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

352 
q22_c_još_c_tu¶e
 *
š
 = 
®igÃd_ÿ¡
<q22_c_još_c_tu¶e>(
šput
.
d©a
);

353  
	gš
->
	gC_ACCTBAL
 > in->
	gACCTBAL_THRESHOLD
;

356 
vœtu®
 
q22_još_f‹r_t
* 
şÚe
() const {

357  
Ãw
 
q22_još_f‹r_t
(*
this
);

360 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

361  
c_¡r
("q22_join_filter_t");

365 
	gq22_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

367 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

369 
q22_agg»g©e_t
()

370 : 
tu¶e_agg»g©e_t
((
q22_sub_agg_tu¶e
))

374 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
() {

375  &
_exŒaùÜ
;

378 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
t
) {

379 
q22_agg»g©e_tu¶e
 *
	gagg
 = 
®igÃd_ÿ¡
<q22_agg»g©e_tu¶e>(
agg_d©a
);

380 
q22_c_još_c_tu¶e
 *
	gšput
 = 
®igÃd_ÿ¡
<q22_c_još_c_tu¶e>(
t
.
d©a
);

382 
	gagg
->
	gNUMCUST
++;

383 
	gagg
->
	gCNTRYCODE
 = 
šput
->
CNTRYCODE
;

384 
	gagg
->
	gTOTACCTBAL
 +ğ
šput
->
C_ACCTBAL
;

386 
vœtu®
 
fšish
(
tu¶e_t
 &
de¡
, cÚ¡ * 
agg_d©a
) {

387 
memıy
(
de¡
.
d©a
, 
agg_d©a
, de¡.
size
);

389 
vœtu®
 
q22_agg»g©e_t
* 
şÚe
() const {

390  
Ãw
 
q22_agg»g©e_t
(*
this
);

392 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

397 
	gq22_sÜt_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

399 
q22_sÜt_key_exŒaùÜ_t
()

400 : 
key_exŒaùÜ_t
((), 
off£tof
(
q22_c_još_c_tu¶e
, 
CNTRYCODE
))

404 
vœtu®
 
exŒaù_hšt
(cÚ¡ *
key
) const {

405 
	gúŒycode
 = *(
®igÃd_ÿ¡
<>(
key
));

406  
	gúŒycode
;

409 
vœtu®
 
key_exŒaùÜ_t
* 
şÚe
() const {

410  
Ãw
 
q22_sÜt_key_exŒaùÜ_t
(*
this
);

414 
	gq22_sÜt_key_com·»_t
 : 
public
 
key_com·»_t
 {

416 
q22_sÜt_key_com·»_t
()

420 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

421 
	gúŒycode1
 = *(
®igÃd_ÿ¡
<>(
key1
));

422 
	gúŒycode2
 = *(
®igÃd_ÿ¡
<>(
key2
));

423  
	gúŒycode1
 - 
	gúŒycode2
;

426 
vœtu®
 
q22_sÜt_key_com·»_t
* 
şÚe
() const {

427  
Ãw
 
q22_sÜt_key_com·»_t
(*
this
);

432 şas 
	cch_q22_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t
 {

434 
public
:

436 
vœtu®
 
	$begš
() {

437 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q22 %s %s %s\n",

441 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

442 
q22_agg»g©e_tu¶e
 *
agg
 = 
®igÃd_ÿ¡
<q22_agg»g©e_tu¶e>(
ouut
.
d©a
);

444 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q22 %d %d %.4f\n", 
agg
->
CNTRYCODE
,‡gg->
NUMCUST
,‡gg->
TOTACCTBAL
.
	`to_doubË
());

445 
	}
}

456 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_q22
(cÚ¡ 
xù_id
,

457 
q22_šput_t
& 
š
)

459 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** q22 *********\n");

461 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

462 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

466 
tu¶e_fifo
* 
q22_cu¡om”_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q22_´ojeùed_cu¡om”_tu¶e
));

467 
·ck‘_t
* 
q22_cu¡om”_tsÿn_·ck‘
 =

468 
Ãw
 
	`tsÿn_·ck‘_t
("customer TSCAN",

469 
q22_cu¡om”_bufãr
,

470 
Ãw
 
	`q22_cu¡om”_tsÿn_f‹r_t
(
this
, 
š
),

471 
this
->
	`db
(),

472 
_pcu¡om”_desc
.
	`g‘
(),

473 
pxù
);

476 
tu¶e_fifo
* 
q22_cu¡om”_sub_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q22_´ojeùed_cu¡om”_sub_tu¶e
));

477 
·ck‘_t
* 
q22_cu¡om”_sub_tsÿn_·ck‘
 =

478 
Ãw
 
	`tsÿn_·ck‘_t
("customer sub TSCAN",

479 
q22_cu¡om”_sub_bufãr
,

480 
Ãw
 
	`q22_cu¡om”_sub_tsÿn_f‹r_t
(
this
, 
š
),

481 
this
->
	`db
(),

482 
_pcu¡om”_desc
.
	`g‘
(),

483 
pxù
);

486 
tu¶e_fifo
* 
q22_sub_agg_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q22_sub_agg_tu¶e
));

487 
·ck‘_t
* 
q22_sub_agg_·ck‘
 =

488 
Ãw
 
	`agg»g©e_·ck‘_t
("SUB AGGREGATE AVG C_ACCTBAL",

489 
q22_sub_agg_bufãr
,

490 
Ãw
 
	`ŒivŸl_f‹r_t
((
q22_sub_agg_tu¶e
)),

491 
Ãw
 
	`q22_sub_agg»g©e_t
(),

492 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
(0, 0),

493 
q22_cu¡om”_sub_tsÿn_·ck‘
);

496 
tu¶e_fifo
* 
q22_c_još_c_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q22_c_još_c_tu¶e
));

497 
·ck‘_t
* 
q22_c_još_c_·ck‘
 =

498 
Ãw
 
	`hash_još_·ck‘_t
("customer - customer HJOIN",

499 
q22_c_još_c_bufãr
,

500 
Ãw
 
	`q22_još_f‹r_t
(),

501 
q22_cu¡om”_tsÿn_·ck‘
,

502 
q22_sub_agg_·ck‘
,

503 
Ãw
 
	`q22_c_još_c_t
());

506 
tu¶e_fifo
* 
q22_sÜt_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q22_c_još_c_tu¶e
));

507 
·ck‘_t
* 
q22_sÜt_·ck‘
 =

508 
Ãw
 
	`sÜt_·ck‘_t
("ORDER BY CNTRYCODE",

509 
q22_sÜt_bufãr
,

510 
Ãw
 
	`ŒivŸl_f‹r_t
((
q22_c_još_c_tu¶e
)),

511 
Ãw
 
	`q22_sÜt_key_exŒaùÜ_t
(),

512 
Ãw
 
	`q22_sÜt_key_com·»_t
(),

513 
q22_c_još_c_·ck‘
);

516 
tu¶e_fifo
* 
q22_fš®_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q22_agg»g©e_tu¶e
));

517 
·ck‘_t
* 
q22_fš®_·ck‘
 =

518 
Ãw
 
	`agg»g©e_·ck‘_t
("SUM, COUNT, GROUP BY AGGREGATE",

519 
q22_fš®_bufãr
,

520 
Ãw
 
	`ŒivŸl_f‹r_t
((
q22_agg»g©e_tu¶e
)),

521 
Ãw
 
	`q22_agg»g©e_t
(),

522 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
((), 
	`off£tof
(
q22_c_još_c_tu¶e
, 
CNTRYCODE
)),

523 
q22_sÜt_·ck‘
);

526 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

527 
q22_cu¡om”_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

528 
q22_cu¡om”_sub_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

529 
q22_sub_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

530 
q22_c_još_c_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

531 
q22_sÜt_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

532 
q22_fš®_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

536 
ch_q22_´oûss_tu¶e_t
 
±
;

538 
	`´oûss_qu”y
(
q22_fš®_·ck‘
, 
±
);

540 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

543  (
RCOK
);

544 
	}
}

547 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/qpipe/qpipe_q3.cpp

32 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

33 
	~"wÜklßd/ch/ch_¡ruù.h
"

34 
	~"wÜklßd/ch/ch_ut.h
"

35 
	~"qpe.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
usšg
 
Çme¥aû
 
	gqpe
;

42 
ENTER_NAMESPACE
(
ch
);

77 
	sq3_´ojeùed_cu¡om”_tu¶e
 {

78 
	mC_CUSTKEY
;

81 
	sq3_´ojeùed_Üd”s_tu¶e
 {

82 
	mO_ORDERKEY
;

83 
	mO_CUSTKEY
;

84 
time_t
 
	mO_ORDERDATE
;

85 
	mO_SHIPPRIORITY
;

88 
	sq3_´ojeùed_lše™em_tu¶e
 {

89 
	mL_ORDERKEY
;

90 
decim®
 
	mL_EXTENDEDPRICE
;

91 
decim®
 
	mL_DISCOUNT
;

95 
	sq3_o_još_c_tu¶e
 {

96 
	mO_ORDERKEY
;

97 
time_t
 
	mO_ORDERDATE
;

98 
	mO_SHIPPRIORITY
;

101 
	sq3_agg»g©ed_lše™em_tu¶e
 {

102 
	mL_ORDERKEY
;

103 
decim®
 
	mREVENUE
;

106 
	sq3_agg»g©ed_tu¶e
 {

107 
	mL_ORDERKEY
;

108 
time_t
 
	mO_ORDERDATE
;

109 
	mO_SHIPPRIORITY
;

110 
decim®
 
	mREVENUE
;

113 
	sq3_agg_key
 {

114 
	mL_ORDERKEY
;

115 
time_t
 
	mO_ORDERDATE
;

116 
	mO_SHIPPRIORITY
;

120 şas 
	cq3_cu¡om”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


122 
´iv©e
:

123 
ShÜeTPCHEnv
* 
_chdb
;

124 
bË_row_t
* 
	m_´cu¡
;

125 
»p_row_t
 
	m_¼
;

127 
ch_cu¡om”_tu¶e
 
	m_cu¡om”
;

129 
q3_šput_t
* 
	mq3_šput
;

130 
	m_mkt£gm’t
[
STRSIZE
(10)];

132 
	mpublic
:

133 
	$q3_cu¡om”_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q3_šput_t
 &
š
)

134 : 
	`tu¶e_f‹r_t
(
chdb
->
	`cu¡om”_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

136 
_´cu¡
 = 
_chdb
->
	`cu¡om”_mª
()->
	`g‘_tu¶e
();

137 
_¼
.
	`£t_ts
(
_chdb
->
	`cu¡om”_mª
()->
	`ts
(),

138 
_chdb
->
	`cu¡om”_desc
()->
	`maxsize
());

139 
_´cu¡
->
_»p
 = &
_¼
;

142 
q3_šput
 = &
š
;

143 
	`£gm’t_to_¡r
(
_mkt£gm’t
, 
q3_šput
->
c_£gm’t
);

145 
	`TRACE
(
TRACE_ALWAYS
, "Rªdom…»diÿ‹:\nCUSTOMER.C_MKTSEGMENT = '%s'\n", 
_mkt£gm’t
);

148 
vœtu®
 ~
	$q3_cu¡om”_tsÿn_f‹r_t
()

151 
_chdb
->
	`cu¡om”_mª
()->
	`give_tu¶e
(
_´cu¡
);

152 
	}
}

154 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

156 ià(!
_chdb
->
	`cu¡om”_mª
()->
	`lßd
(
_´cu¡
, 
šput
.
d©a
)) {

157 
	`as£¹
(
çl£
);

160 
_´cu¡
->
	`g‘_v®ue
(6, 
_cu¡om”
.
C_MKTSEGMENT
, 
	`STRSIZE
(10));

162  (
	`¡rcmp
(
_cu¡om”
.
C_MKTSEGMENT
, 
_mkt£gm’t
) == 0);

163 
	}
}

165 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

167 
q3_´ojeùed_cu¡om”_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q3_´ojeùed_cu¡om”_tu¶e>(
d
.
d©a
);

169 
_´cu¡
->
	`g‘_v®ue
(0, 
_cu¡om”
.
C_CUSTKEY
);

173 
de¡
->
C_CUSTKEY
 = 
_cu¡om”
.C_CUSTKEY;

174 
	}
}

176 
q3_cu¡om”_tsÿn_f‹r_t
* 
	$şÚe
() const {

177  
Ãw
 
	`q3_cu¡om”_tsÿn_f‹r_t
(*
this
);

178 
	}
}

180 
c_¡r
 
	$to_¡ršg
() const {

182  
	`c_¡r
("q3_customer_tscan_filter_t");

183 
	}
}

187 şas 
	cq3_Üd”s_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


189 
´iv©e
:

190 
ShÜeTPCHEnv
* 
_chdb
;

191 
bË_row_t
* 
	m_´Üd”s
;

192 
»p_row_t
 
	m_¼
;

194 
ch_Üd”s_tu¶e
 
	m_Üd”s
;

195 
time_t
 
	m_Üd”d©e
;

197 
q3_šput_t
* 
	mq3_šput
;

199 
	mpublic
:

200 
	$q3_Üd”s_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q3_šput_t
 &
š
)

201 : 
	`tu¶e_f‹r_t
(
chdb
->
	`Üd”s_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

203 
_´Üd”s
 = 
_chdb
->
	`Üd”s_mª
()->
	`g‘_tu¶e
();

204 
_¼
.
	`£t_ts
(
_chdb
->
	`Üd”s_mª
()->
	`ts
(),

205 
_chdb
->
	`Üd”s_desc
()->
	`maxsize
());

206 
_´Üd”s
->
_»p
 = &
_¼
;

209 
q3_šput
 = &
š
;

211 
time
[15];

212 
	`tim‘_to_¡r
(
time
, 
q3_šput
->
cu¼’t_d©e
);

213 
	`TRACE
(
TRACE_ALWAYS
, "Rªdom…»diÿ‹:\nORDERS.O_ORDERDATE < %s\n", 
time
);

216 
vœtu®
 ~
	$q3_Üd”s_tsÿn_f‹r_t
()

219 
_chdb
->
	`Üd”s_mª
()->
	`give_tu¶e
(
_´Üd”s
);

220 
	}
}

222 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

224 ià(!
_chdb
->
	`Üd”s_mª
()->
	`lßd
(
_´Üd”s
, 
šput
.
d©a
)) {

225 
	`as£¹
(
çl£
);

228 
_´Üd”s
->
	`g‘_v®ue
(4, 
_Üd”s
.
O_ORDERDATE
, 15);

229 
_Üd”d©e
 = 
	`¡r_to_tim‘
(
_Üd”s
.
O_ORDERDATE
);

231  
_Üd”d©e
 < 
q3_šput
->
cu¼’t_d©e
;

232 
	}
}

234 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

236 
q3_´ojeùed_Üd”s_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q3_´ojeùed_Üd”s_tu¶e>(
d
.
d©a
);

238 
_´Üd”s
->
	`g‘_v®ue
(0, 
_Üd”s
.
O_ORDERKEY
);

239 
_´Üd”s
->
	`g‘_v®ue
(1, 
_Üd”s
.
O_CUSTKEY
);

240 
_´Üd”s
->
	`g‘_v®ue
(4, 
_Üd”s
.
O_ORDERDATE
, 15);

241 
_´Üd”s
->
	`g‘_v®ue
(7, 
_Üd”s
.
O_SHIPPRIORITY
);

245 
de¡
->
O_ORDERKEY
 = 
_Üd”s
.O_ORDERKEY;

246 
de¡
->
O_CUSTKEY
 = 
_Üd”s
.O_CUSTKEY;

247 
de¡
->
O_ORDERDATE
 = 
	`¡r_to_tim‘
(
_Üd”s
.O_ORDERDATE);

248 
de¡
->
O_SHIPPRIORITY
 = 
_Üd”s
.O_SHIPPRIORITY;

250 
	}
}

252 
q3_Üd”s_tsÿn_f‹r_t
* 
	$şÚe
() const {

253  
Ãw
 
	`q3_Üd”s_tsÿn_f‹r_t
(*
this
);

254 
	}
}

256 
c_¡r
 
	$to_¡ršg
() const {

257  
	`c_¡r
("q3_Üd”s_tsÿn_f‹r_t(%s)", 
	`ùime
(&(
q3_šput
->
cu¼’t_d©e
)));

258 
	}
}

261 şas 
	cq3_lše™em_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


263 
´iv©e
:

264 
ShÜeTPCHEnv
* 
_chdb
;

265 
bË_row_t
* 
	m_´lše
;

266 
»p_row_t
 
	m_¼
;

268 
ch_lše™em_tu¶e
 
	m_lše™em
;

269 
time_t
 
	m_shd©e
;

271 
q3_šput_t
* 
	mq3_šput
;

273 
	mpublic
:

274 
	$q3_lše™em_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q3_šput_t
 &
š
)

275 : 
	`tu¶e_f‹r_t
(
chdb
->
	`lše™em_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

277 
_´lše
 = 
_chdb
->
	`lše™em_mª
()->
	`g‘_tu¶e
();

278 
_¼
.
	`£t_ts
(
_chdb
->
	`lše™em_mª
()->
	`ts
(),

279 
_chdb
->
	`lše™em_desc
()->
	`maxsize
());

280 
_´lše
->
_»p
 = &
_¼
;

283 
q3_šput
 = &
š
;

285 
time
[15];

286 
	`tim‘_to_¡r
(
time
, 
q3_šput
->
cu¼’t_d©e
);

287 
	`TRACE
(
TRACE_ALWAYS
, "Rªdom…»diÿ‹:\nLINEITEM.L_SHIPDATE > %s\n", 
time
);

290 
vœtu®
 ~
	$q3_lše™em_tsÿn_f‹r_t
()

293 
_chdb
->
	`lše™em_mª
()->
	`give_tu¶e
(
_´lše
);

294 
	}
}

296 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

298 ià(!
_chdb
->
	`lše™em_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

299 
	`as£¹
(
çl£
);

302 
_´lše
->
	`g‘_v®ue
(10, 
_lše™em
.
L_SHIPDATE
, 15);

303 
_shd©e
 = 
	`¡r_to_tim‘
(
_lše™em
.
L_SHIPDATE
);

305  
_shd©e
 > 
q3_šput
->
cu¼’t_d©e
;

306 
	}
}

308 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

310 
q3_´ojeùed_lše™em_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q3_´ojeùed_lše™em_tu¶e>(
d
.
d©a
);

312 
_´lše
->
	`g‘_v®ue
(0, 
_lše™em
.
L_ORDERKEY
);

313 
_´lše
->
	`g‘_v®ue
(5, 
_lše™em
.
L_EXTENDEDPRICE
);

314 
_´lše
->
	`g‘_v®ue
(6, 
_lše™em
.
L_DISCOUNT
);

316 
de¡
->
L_ORDERKEY
 = 
_lše™em
.L_ORDERKEY;

317 
de¡
->
L_EXTENDEDPRICE
 = 
_lše™em
.L_EXTENDEDPRICE / 100.0;

318 
de¡
->
L_DISCOUNT
 = 
_lše™em
.L_DISCOUNT / 100.0;

319 
	}
}

321 
q3_lše™em_tsÿn_f‹r_t
* 
	$şÚe
() const {

322  
Ãw
 
	`q3_lše™em_tsÿn_f‹r_t
(*
this
);

323 
	}
}

325 
c_¡r
 
	$to_¡ršg
() const {

326  
	`c_¡r
("q3_lše™em_tsÿn_f‹r_t(%s)", 
	`ùime
(&(
q3_šput
->
cu¼’t_d©e
)));

327 
	}
}

332 
	gq3_o_još_c_t
 : 
public
 
tu¶e_još_t
 {

334 
q3_o_još_c_t
()

335 : 
tu¶e_još_t
((
q3_´ojeùed_Üd”s_tu¶e
),

336 
off£tof
(
q3_´ojeùed_Üd”s_tu¶e
, 
O_CUSTKEY
),

337 (
q3_´ojeùed_cu¡om”_tu¶e
),

338 
off£tof
(
q3_´ojeùed_cu¡om”_tu¶e
, 
C_CUSTKEY
),

340 (
q3_o_još_c_tu¶e
))

344 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

345 
q3_o_još_c_tu¶e
* 
	gde¡
 = 
®igÃd_ÿ¡
<q3_o_još_c_tu¶e>(
d
.
d©a
);

346 
q3_´ojeùed_Üd”s_tu¶e
* 
	gËá
 = 
®igÃd_ÿ¡
<q3_´ojeùed_Üd”s_tu¶e>(
l
.
d©a
);

347 
q3_´ojeùed_cu¡om”_tu¶e
* 
	gright
 = 
®igÃd_ÿ¡
<q3_´ojeùed_cu¡om”_tu¶e>(
r
.
d©a
);

349 
	gde¡
->
	gO_ORDERKEY
 = 
Ëá
->
O_ORDERKEY
;

350 
	gde¡
->
	gO_ORDERDATE
 = 
Ëá
->
O_ORDERDATE
;

351 
	gde¡
->
	gO_SHIPPRIORITY
 = 
Ëá
->
O_SHIPPRIORITY
;

353 
	gd©e
[
STRSIZE
(10)];

354 
tim‘_to_¡r
(
d©e
, 
Ëá
->
O_ORDERDATE
);

358 
vœtu®
 
q3_o_još_c_t
* 
şÚe
() const {

359  
Ãw
 
q3_o_još_c_t
(*
this
);

362 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

363  
c_¡r
("join ORDERS, CUSTOMER, select O_ORDERKEY, O_ORDERDATE, O_SHIPPRIORITY");

368 
	gq3_lše™em_s›ve_t
 : 
public
 
tu¶e_s›ve_t
 {

370 
q3_lše™em_s›ve_t
()

371 :
tu¶e_s›ve_t
((
q3_agg»g©ed_lše™em_tu¶e
))

375 
vœtu®
 
boŞ
 
·ss
(
tu¶e_t
& 
de¡
, cÚ¡u¶e_t& 
¤c
) {

376 
q3_agg»g©ed_lše™em_tu¶e
* 
	gout
 = 
®igÃd_ÿ¡
<q3_agg»g©ed_lše™em_tu¶e>(
de¡
.
d©a
);

377 
q3_´ojeùed_lše™em_tu¶e
* 
	gš
 = 
®igÃd_ÿ¡
<q3_´ojeùed_lše™em_tu¶e>(
¤c
.
d©a
);

379 
	gout
->
	gL_ORDERKEY
 = 
š
->
L_ORDERKEY
;

380 
	gout
->
	gREVENUE
 = 
š
->
L_EXTENDEDPRICE
 * (1 - in->
L_DISCOUNT
);

381  
	gŒue
;

384 
vœtu®
 
q3_lše™em_s›ve_t
* 
şÚe
() const {

385  
Ãw
 
q3_lše™em_s›ve_t
(*
this
);

388 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

389  
c_¡r
("q3_lineitem_sieve_t");

394 
	gq3_l_još_oc_t
 : 
public
 
tu¶e_još_t
 {

396 
q3_l_još_oc_t
()

397 :
tu¶e_još_t
((
q3_agg»g©ed_lše™em_tu¶e
),

398 
off£tof
(
q3_agg»g©ed_lše™em_tu¶e
, 
L_ORDERKEY
),

399 (
q3_o_još_c_tu¶e
),

400 
off£tof
(
q3_o_još_c_tu¶e
, 
O_ORDERKEY
),

402 (
q3_agg»g©ed_tu¶e
))

406 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

408 
q3_agg»g©ed_tu¶e
* 
	gde¡
 = 
®igÃd_ÿ¡
<q3_agg»g©ed_tu¶e>(
d
.
d©a
);

409 
q3_agg»g©ed_lše™em_tu¶e
* 
	gËá
 = 
®igÃd_ÿ¡
<q3_agg»g©ed_lše™em_tu¶e>(
l
.
d©a
);

410 
q3_o_još_c_tu¶e
* 
	gright
 = 
®igÃd_ÿ¡
<q3_o_još_c_tu¶e>(
r
.
d©a
);

412 
	gde¡
->
	gL_ORDERKEY
 = 
Ëá
->
L_ORDERKEY
;

413 
	gde¡
->
	gREVENUE
 = 
Ëá
->
REVENUE
;

414 
	gde¡
->
	gO_ORDERDATE
 = 
right
->
O_ORDERDATE
;

415 
	gde¡
->
	gO_SHIPPRIORITY
 = 
right
->
O_SHIPPRIORITY
;

417 
	gd©e
[
STRSIZE
(10)];

418 
tim‘_to_¡r
(
d©e
, 
right
->
O_ORDERDATE
);

422 
vœtu®
 
q3_l_još_oc_t
* 
şÚe
() const {

423  
Ãw
 
q3_l_još_oc_t
(*
this
);

426 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

427  
c_¡r
("join LINEITEM, ORDERS, CUSTOMER, select L_ORDERKEY, REVENUE, O_ORDERDATE, O_SHIPPRIORITY");

432 
	gq3_agg_key_com·»_t
 : 
public
 
key_com·»_t
 {

434 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

435 
q3_agg_key
* 
	gk1
 = 
®igÃd_ÿ¡
<q3_agg_key>(
key1
);

436 
q3_agg_key
* 
	gk2
 = 
®igÃd_ÿ¡
<q3_agg_key>(
key2
);

437 
	gdiff_Üd”key
 = 
k1
->
L_ORDERKEY
 - 
k2
->L_ORDERKEY;

438 
	gdiff_Üd”d©e
 = 
k1
->
O_ORDERDATE
 - 
k2
->O_ORDERDATE;

439 
	gdiff_sh´io
 = 
k1
->
O_SHIPPRIORITY
 - 
k2
->O_SHIPPRIORITY;

441  (
	gdiff_Üd”key
 !ğ0 ? 
diff_Üd”key
 : (
diff_Üd”d©e
 !ğ0 ? diff_Üd”d©: 
diff_sh´io
));

444 
vœtu®
 
q3_agg_key_com·»_t
* 
şÚe
() const {

445  
Ãw
 
q3_agg_key_com·»_t
(*
this
);

450 
	gq3_agg»g©e_t
 : 
tu¶e_agg»g©e_t
 {

451 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

453 
q3_agg»g©e_t
()

454 :
tu¶e_agg»g©e_t
((
q3_agg»g©ed_tu¶e
)),

455 
_exŒaùÜ
((
q3_agg_key
), 
off£tof
(q3_agg_key, 
L_ORDERKEY
))

459 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
() {

460  &
	g_exŒaùÜ
;

463 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
t
) {

464 
q3_agg»g©ed_tu¶e
* 
	gde¡
 = 
®igÃd_ÿ¡
<q3_agg»g©ed_tu¶e>(
agg_d©a
);

465 
q3_agg»g©ed_tu¶e
* 
	g¤c
 = 
®igÃd_ÿ¡
<q3_agg»g©ed_tu¶e>(
t
.
d©a
);

466 
	gde¡
->
	gREVENUE
 +ğ
¤c
->
REVENUE
;

467 if(
	gde¡
->
	gL_ORDERKEY
 =ğ3987331è
TRACE
(
TRACE_RECORD_FLOW
, "%.2f|%.2f\n", 
¤c
->
REVENUE
.
to_doubË
(), 
de¡
->REVENUE.to_double());

470 
vœtu®
 
q3_agg»g©e_t
* 
şÚe
() const {

471  
Ãw
 
q3_agg»g©e_t
(*
this
);

474 
vœtu®
 
fšish
(
tu¶e_t
& 
d
, cÚ¡ * 
agg_d©a
) {

475 
memıy
(
d
.
d©a
, 
agg_d©a
, 
tu¶e_size
());

478 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

479  
c_¡r
("q3_aggregate_t");

482 
vœtu®
 
š™
(* 
agg_d©a
) {

483 
mem£t
(
agg_d©a
, 0, 
tu¶e_size
());

487 
	gq3_tİ10_t
 : 
tu¶e_agg»g©e_t
 {

488 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

490 
q3_tİ10_t
()

491 : 
tu¶e_agg»g©e_t
((
q3_agg»g©ed_tu¶e
)),

492 
_exŒaùÜ
(0,0)

496 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
() {

497  &
	g_exŒaùÜ
;

500 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
t
) {

501 
memıy
(
agg_d©a
, 
t
.
d©a
, 
tu¶e_size
());

504 
vœtu®
 
q3_tİ10_t
* 
şÚe
() const {

505  
Ãw
 
q3_tİ10_t
(*
this
);

508 
vœtu®
 
fšish
(
tu¶e_t
& 
d
, cÚ¡ * 
agg_d©a
) {

509 
memıy
(
d
.
d©a
, 
agg_d©a
, 
tu¶e_size
());

512 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

513  
c_¡r
("q3_top10_t");

517 
	gq3_sÜt_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

519 
q3_sÜt_key_exŒaùÜ_t
(è: 
key_exŒaùÜ_t
((
q3_agg»g©ed_tu¶e
))

523 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
tu¶e_key
) {

524 
q3_agg»g©ed_tu¶e
* 
tu¶e
 = 
®igÃd_ÿ¡
<q3_agg»g©ed_tu¶e>(
tu¶e_key
);

525  -((
	gtu¶e
->
	gREVENUE
).
to_št
());

528 
vœtu®
 
q3_sÜt_key_exŒaùÜ_t
* 
şÚe
() const {

529  
Ãw
 
q3_sÜt_key_exŒaùÜ_t
(*
this
);

533 
	gq3_sÜt_key_com·»_t
 : 
public
 
key_com·»_t
 {

535 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

536 
q3_agg»g©ed_tu¶e
* 
	gt1
 = 
®igÃd_ÿ¡
<q3_agg»g©ed_tu¶e>(
key1
);

537 
q3_agg»g©ed_tu¶e
* 
	gt2
 = 
®igÃd_ÿ¡
<q3_agg»g©ed_tu¶e>(
key2
);

538 
	gdiff_»v
 = (
t2
->
REVENUE
 - 
t1
->REVENUE).
to_št
();

539 
	gdiff_time
 = 
t2
->
O_ORDERDATE
 - 
t1
->O_ORDERDATE;

541  (
	gdiff_»v
 !ğ0 ? 
diff_»v
 : 
diff_time
);

544 
vœtu®
 
q3_sÜt_key_com·»_t
* 
şÚe
() const {

545  
Ãw
 
q3_sÜt_key_com·»_t
(*
this
);

549 şas 
	cq3_tİ10_f‹r_t
 : 
public
 
tu¶e_f‹r_t
 {

551 
´iv©e
:

552 
_couÁ
;

554 
	mpublic
:

556 
	$q3_tİ10_f‹r_t
(è: 
	`tu¶e_f‹r_t
((
q3_agg»g©ed_tu¶e
)), 
	$_couÁ
(0)

560 
vœtu®
 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
tu¶e
) {

561 if(++
_couÁ
 <= 10) {

562  
Œue
;

565  
çl£
;

567 
	}
}

569 
vœtu®
 
q3_tİ10_f‹r_t
* 
	$şÚe
() const {

570  
Ãw
 
	`q3_tİ10_f‹r_t
(*
this
);

571 
	}
}

573 
vœtu®
 
c_¡r
 
	$to_¡ršg
() const {

574  
	`c_¡r
("q3_top10_filter_t");

575 
	}
}

580 şas 
	cch_q3_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t
 {

582 
public
:

584 
vœtu®
 
	$begš
() {

585 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q3 %14s %14s %14s %14s\n",

589 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

590 
q3_agg»g©ed_tu¶e
* 
r
 = 
®igÃd_ÿ¡
<q3_agg»g©ed_tu¶e>(
ouut
.
d©a
);

592 
d©e
[
	`STRSIZE
(10)];

593 
	`tim‘_to_¡r
(
d©e
, 
r
->
O_ORDERDATE
);

594 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q3 %14d %14.4f %14s %14d\n",

595 
r
->
L_ORDERKEY
,„->
REVENUE
.
	`to_doubË
(), 
d©e
,„->
O_SHIPPRIORITY
);

596 
	}
}

608 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_q3
(cÚ¡ 
xù_id
,

609 
q3_šput_t
& 
š
)

611 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** Q3 *********\n");

613 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

614 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

618 
tu¶e_fifo
* 
q3_cu¡om”_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q3_´ojeùed_cu¡om”_tu¶e
));

619 
·ck‘_t
* 
q3_cu¡om”_tsÿn_·ck‘
 =

620 
Ãw
 
	`tsÿn_·ck‘_t
("customer TSCAN",

621 
q3_cu¡om”_bufãr
,

622 
Ãw
 
	`q3_cu¡om”_tsÿn_f‹r_t
(
this
, 
š
),

623 
this
->
	`db
(),

624 
_pcu¡om”_desc
.
	`g‘
(),

625 
pxù
);

628 
tu¶e_fifo
* 
q3_Üd”s_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q3_´ojeùed_Üd”s_tu¶e
));

629 
·ck‘_t
* 
q3_Üd”s_tsÿn_·ck‘
 =

630 
Ãw
 
	`tsÿn_·ck‘_t
("orders TSCAN",

631 
q3_Üd”s_bufãr
,

632 
Ãw
 
	`q3_Üd”s_tsÿn_f‹r_t
(
this
, 
š
),

633 
this
->
	`db
(),

634 
_pÜd”s_desc
.
	`g‘
(),

635 
pxù
);

638 
tu¶e_fifo
* 
q3_o_još_c_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q3_o_još_c_tu¶e
));

639 
·ck‘_t
* 
q3_o_još_c_·ck‘
 =

640 
Ãw
 
	`hash_još_·ck‘_t
("orders-customer HJOIN",

641 
q3_o_još_c_bufãr
,

642 
Ãw
 
	`ŒivŸl_f‹r_t
((
q3_o_još_c_tu¶e
)),

643 
q3_Üd”s_tsÿn_·ck‘
,

644 
q3_cu¡om”_tsÿn_·ck‘
,

645 
Ãw
 
	`q3_o_još_c_t
());

648 
tu¶e_fifo
* 
q3_lše™em_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q3_´ojeùed_lše™em_tu¶e
));

649 
·ck‘_t
* 
q3_lše™em_tsÿn_·ck‘
 =

650 
Ãw
 
	`tsÿn_·ck‘_t
("lineitem TSCAN",

651 
q3_lše™em_bufãr
,

652 
Ãw
 
	`q3_lše™em_tsÿn_f‹r_t
(
this
, 
š
),

653 
this
->
	`db
(),

654 
_¶še™em_desc
.
	`g‘
(),

655 
pxù
);

658 
tu¶e_fifo
* 
q3_agg»g©ed_lše™em_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q3_agg»g©ed_lše™em_tu¶e
));

659 
s›ve_·ck‘_t
* 
q3_agg»g©ed_lše™em_·ck‘
 =

660 
Ãw
 
	`s›ve_·ck‘_t
("lineitem AGGREGATE",

661 
q3_agg»g©ed_lše™em_bufãr
,

662 
Ãw
 
	`ŒivŸl_f‹r_t
((
q3_agg»g©ed_lše™em_tu¶e
)),

663 
Ãw
 
	`q3_lše™em_s›ve_t
(),

664 
q3_lše™em_tsÿn_·ck‘
);

667 
tu¶e_fifo
* 
q3_l_još_oc_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q3_agg»g©ed_tu¶e
));

668 
·ck‘_t
* 
q3_l_još_oc_·ck‘
 =

669 
Ãw
 
	`hash_još_·ck‘_t
("lineitem-orders_customer HJOIN",

670 
q3_l_još_oc_bufãr
,

671 
Ãw
 
	`ŒivŸl_f‹r_t
((
q3_agg»g©ed_tu¶e
)),

672 
q3_agg»g©ed_lše™em_·ck‘
,

673 
q3_o_još_c_·ck‘
,

674 
Ãw
 
	`q3_l_još_oc_t
());

677 
tu¶e_fifo
* 
q3_agg_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q3_agg»g©ed_tu¶e
));

678 
·ck‘_t
* 
q3_agg_·ck‘
 =

679 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("SUM AGG",

680 
q3_agg_bufãr
,

681 
Ãw
 
	`ŒivŸl_f‹r_t
((
q3_agg»g©ed_tu¶e
)),

682 
q3_l_još_oc_·ck‘
,

683 
Ãw
 
	`q3_agg»g©e_t
(),

684 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
((
q3_agg_key
)),

685 
Ãw
 
	`q3_agg_key_com·»_t
());

688 
tu¶e_fifo
* 
q3_fš®_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q3_agg»g©ed_tu¶e
));

689 
·ck‘_t
* 
q3_fš®_·ck‘
 =

690 
Ãw
 
	`sÜt_·ck‘_t
("SORT",

691 
q3_fš®_bufãr
,

692 
Ãw
 
	`q3_tİ10_f‹r_t
(),

693 
Ãw
 
	`q3_sÜt_key_exŒaùÜ_t
(),

694 
Ãw
 
	`q3_sÜt_key_com·»_t
(),

695 
q3_agg_·ck‘
);

697 
tu¶e_fifo
* 
q3_ffš®_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q3_agg»g©ed_tu¶e
));

698 
·ck‘_t
* 
q3_ffš®_·ck‘
 =

699 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("Top10 Agg",

700 
q3_ffš®_bufãr
,

701 
Ãw
 
	`q3_tİ10_f‹r_t
(),

702 
q3_fš®_·ck‘
,

703 
Ãw
 
	`q3_tİ10_t
(),

704 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
((
q3_agg»g©ed_tu¶e
)),

705 
Ãw
 
	`št_key_com·»_t
());

709 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

710 
q3_cu¡om”_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

711 
q3_Üd”s_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

712 
q3_o_još_c_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

713 
q3_lše™em_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

714 
q3_agg»g©ed_lše™em_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

715 
q3_l_još_oc_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

716 
q3_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

717 
q3_fš®_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

718 
q3_ffš®_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

721 
ch_q3_´oûss_tu¶e_t
 
±
;

723 
	`´oûss_qu”y
(
q3_fš®_·ck‘
, 
±
);

725 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

728  (
RCOK
);

729 
	}
}

732 
EXIT_NAMESPACE
(
qpe
);

	@src/workload/tpch/qpipe/qpipe_q4.cpp

33 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

34 
	~"qpe.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
usšg
 
Çme¥aû
 
	gqpe
;

42 
ENTER_NAMESPACE
(
ch
);

84 
	sq4_´ojeùed_lše™em_tu¶e
 {

85 
	mL_ORDERKEY
;

89 
	sq4_´ojeùed_Üd”s_tu¶e
 {

90 
	mO_ORDERKEY
;

91 
	mO_ORDERPRIORITY
;

95 
	sq4_još_tu¶e
 {

96 
	mO_ORDERPRIORITY
;

100 
	sq4_agg»g©e_tu¶e
 {

101 
	mO_ORDERPRIORITY
;

102 
	mO_COUNT
;

107 şas 
	cq4_tsÿn_lše™em_f‹r_t
 : 
public
 
tu¶e_f‹r_t


109 
´iv©e
:

110 
ShÜeTPCHEnv
* 
_chdb
;

111 
bË_row_t
* 
	m_´lše
;

112 
»p_row_t
 
	m_¼
;

115 
ch_lše™em_tu¶e
 
	m_lše™em
;

117 
time_t
 
	m_comm™d©e
;

118 
time_t
 
	m_»ûtd©e
;

120 
	mpublic
:

122 
	$q4_tsÿn_lše™em_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
)

123 : 
	`tu¶e_f‹r_t
(
chdb
->
	`lše™em_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

127 
_´lše
 = 
_chdb
->
	`lše™em_mª
()->
	`g‘_tu¶e
();

128 
_¼
.
	`£t_ts
(
_chdb
->
	`lše™em_mª
()->
	`ts
(),

129 
_chdb
->
	`lše™em_desc
()->
	`maxsize
());

130 
_´lše
->
_»p
 = &
_¼
;

133 ~
	$q4_tsÿn_lše™em_f‹r_t
()

136 
_chdb
->
	`lše™em_mª
()->
	`give_tu¶e
(
_´lše
);

137 
	}
}

141 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

144 ià(!
_chdb
->
	`lše™em_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

145 
	`as£¹
(
çl£
);

148 
_´lše
->
	`g‘_v®ue
(12, 
_lše™em
.
L_RECEIPTDATE
, 15);

149 
_»ûtd©e
 = 
	`¡r_to_tim‘
(
_lše™em
.
L_RECEIPTDATE
);

151 
_´lše
->
	`g‘_v®ue
(11, 
_lše™em
.
L_COMMITDATE
, 15);

152 
_comm™d©e
 = 
	`¡r_to_tim‘
(
_lše™em
.
L_COMMITDATE
);

156 iàĞ
_»ûtd©e
 > 
_comm™d©e
) {

158  (
Œue
);

162  (
çl£
);

164 
	}
}

168 
	$´ojeù
(
tu¶e_t
 &
d
, constuple_t & ) {

170 
q4_´ojeùed_lše™em_tu¶e
 *
de¡
;

171 
de¡
 = 
®igÃd_ÿ¡
<
q4_´ojeùed_lše™em_tu¶e
>(
d
.
d©a
);

173 
_´lše
->
	`g‘_v®ue
(0, 
_lše™em
.
L_ORDERKEY
);

178 
de¡
->
L_ORDERKEY
 = 
_lše™em
.L_ORDERKEY;

179 
	}
}

181 
q4_tsÿn_lše™em_f‹r_t
* 
	$şÚe
() const {

182  
Ãw
 
	`q4_tsÿn_lše™em_f‹r_t
(*
this
);

183 
	}
}

185 
c_¡r
 
	$to_¡ršg
() const {

186  
	`c_¡r
("select L_ORDERKEY where L_COMMITDATE < L_RECEIPTDATE");

187 
	}
}

192 şas 
	cq4_di¡šù_t
 : 
public
 
tu¶e_agg»g©e_t
 {

194 
public
:

196 şas 
	cq4_di¡šù_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

197 
public
:

198 
q4_di¡šù_key_exŒaùÜ_t
()

199 : 
key_exŒaùÜ_t
((), 
off£tof
(
q4_´ojeùed_lše™em_tu¶e
,
L_ORDERKEY
))

203 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
tu¶e_d©a
) const {

205 
q4_´ojeùed_lše™em_tu¶e
 *
	m™em
;

206 
	m™em
 = 
®igÃd_ÿ¡
<
q4_´ojeùed_lše™em_tu¶e
>(
tu¶e_d©a
);

207  
	m™em
->
	mL_ORDERKEY
;

210 
vœtu®
 
key_exŒaùÜ_t
* 
şÚe
() const {

211  
Ãw
 
q4_di¡šù_key_exŒaùÜ_t
(*
this
);

215 
	g´iv©e
:

217 
q4_di¡šù_key_exŒaùÜ_t
 
_exŒaùÜ
;

219 
	gpublic
:

221 
	$q4_di¡šù_t
()

222 : 
	`tu¶e_agg»g©e_t
((
q4_´ojeùed_lše™em_tu¶e
)),

223 
	$_exŒaùÜ
()

225 
	}
}

227 
vœtu®
 
key_exŒaùÜ_t
* 
	$key_exŒaùÜ
(è{  &
_exŒaùÜ
; 
	}
}

229 
vœtu®
 
	$agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
& 
¤c
) {

230 
q4_´ojeùed_lše™em_tu¶e
* 
agg
 = 
®igÃd_ÿ¡
<q4_´ojeùed_lše™em_tu¶e>(
agg_d©a
);

231 
q4_´ojeùed_lše™em_tu¶e
* 
š
 = 
®igÃd_ÿ¡
<q4_´ojeùed_lše™em_tu¶e>(
¤c
.
d©a
);

232 
agg
->
L_ORDERKEY
=
š
->L_ORDERKEY;

234 
	}
}

236 
vœtu®
 
	$fšish
(
tu¶e_t
 &
de¡
, cÚ¡ * 
agg_d©a
) {

237 
q4_´ojeùed_lše™em_tu¶e
* 
agg
 = 
®igÃd_ÿ¡
<q4_´ojeùed_lše™em_tu¶e>(
agg_d©a
);

238 
q4_´ojeùed_lše™em_tu¶e
* 
ouut
 = 
®igÃd_ÿ¡
<q4_´ojeùed_lše™em_tu¶e>(
de¡
.
d©a
);

239 
ouut
->
L_ORDERKEY
 = 
agg
->L_ORDERKEY;

241 
	}
}

243 
vœtu®
 
q4_di¡šù_t
* 
	$şÚe
() const {

244  
Ãw
 
	`q4_di¡šù_t
(*
this
);

245 
	}
}

247 
vœtu®
 
c_¡r
 
	$to_¡ršg
() const {

249 
	}
}

255 şas 
	cq4_tsÿn_Üd”s_f‹r_t
 : 
public
 
tu¶e_f‹r_t


257 
´iv©e
:

258 
ShÜeTPCHEnv
* 
_chdb
;

259 
bË_row_t
* 
	m_´Üd”
;

260 
»p_row_t
 
	m_¼
;

263 
ch_Üd”s_tu¶e
 
	m_Üd”s
;

265 
time_t
 
	m_Üd”d©e
;

270 
q4_šput_t
* 
	mq4_šput
;

271 
time_t
 
	m_Ï¡_o_Üd”d©e
;

272 
	mpublic
:

274 
	$q4_tsÿn_Üd”s_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q4_šput_t
 &
š
)

275 : 
	`tu¶e_f‹r_t
(
chdb
->
	`Üd”s_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

278 
_´Üd”
 = 
_chdb
->
	`Üd”s_mª
()->
	`g‘_tu¶e
();

279 
_¼
.
	`£t_ts
(
_chdb
->
	`Üd”s_mª
()->
	`ts
(),

280 
_chdb
->
	`Üd”s_desc
()->
	`maxsize
());

281 
_´Üd”
->
_»p
 = &
_¼
;

289 
q4_šput
=&
š
;

290 
tm
 
d©e
;

291 
	`gmtime_r
(&(
q4_šput
->
o_Üd”d©e
), &
d©e
);

292 
d©e
.
tm_mÚ
 += 3;

293 
_Ï¡_o_Üd”d©e
=
	`mktime
(&
d©e
);

295 
d©e1
[15];

296 
d©e2
[15];

297 
	`tim‘_to_¡r
(
d©e1
,
q4_šput
->
o_Üd”d©e
);

298 
	`tim‘_to_¡r
(
d©e2
,
_Ï¡_o_Üd”d©e
);

299 
	`TRACE
 ( 
TRACE_ALWAYS
, "D©es: % - %s\n",
d©e1
,
d©e2
);

302 ~
	$q4_tsÿn_Üd”s_f‹r_t
()

305 
_chdb
->
	`Üd”s_mª
()->
	`give_tu¶e
(
_´Üd”
);

306 
	}
}

310 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

313 ià(!
_chdb
->
	`Üd”s_mª
()->
	`lßd
(
_´Üd”
, 
šput
.
d©a
)) {

314 
	`as£¹
(
çl£
);

317 
_´Üd”
->
	`g‘_v®ue
(4, 
_Üd”s
.
O_ORDERDATE
, 15);

318 
_Üd”d©e
 = 
	`¡r_to_tim‘
(
_Üd”s
.
O_ORDERDATE
);

322 iàĞ
_Üd”d©e
 >ğ
q4_šput
->
o_Üd”d©e
 && _Üd”d©< 
_Ï¡_o_Üd”d©e
 ) {

324  (
Œue
);

328  (
çl£
);

330 
	}
}

334 
	$´ojeù
(
tu¶e_t
 &
d
, constuple_t & ) {

336 
q4_´ojeùed_Üd”s_tu¶e
 *
de¡
;

337 
de¡
 = 
®igÃd_ÿ¡
<
q4_´ojeùed_Üd”s_tu¶e
>(
d
.
d©a
);

339 
_´Üd”
->
	`g‘_v®ue
(0, 
_Üd”s
.
O_ORDERKEY
);

340 
_´Üd”
->
	`g‘_v®ue
(5, 
_Üd”s
.
O_ORDERPRIORITY
, 15);

342 
numb”
[2];

343 
	`¡ºıy
(
numb”
,
_Üd”s
.
O_ORDERPRIORITY
,1);

344 
numb”
[1] = '\0';

349 
de¡
->
O_ORDERKEY
 = 
_Üd”s
.O_ORDERKEY;

350 
de¡
->
O_ORDERPRIORITY
 = 
	`©oi
(
numb”
);

351 
	}
}

353 
q4_tsÿn_Üd”s_f‹r_t
* 
	$şÚe
() const {

354  
Ãw
 
	`q4_tsÿn_Üd”s_f‹r_t
(*
this
);

355 
	}
}

357 
c_¡r
 
	$to_¡ršg
() const {

358 
d©e1
[15];

359 
d©e2
[15];

360 
	`tim‘_to_¡r
(
d©e1
, 
q4_šput
->
o_Üd”d©e
);

361 
	`tim‘_to_¡r
(
d©e2
, 
_Ï¡_o_Üd”d©e
);

362 
c_¡r
 
	`»suÉ
("select O_ORDERKEY, O_ORDERPRIORITY "

364 
d©e1
, 
d©e2
);

365  
»suÉ
;

366 
	}
}

370 
	gq4_exŒaùÜ_lše™em_t
 : 
public
 
key_exŒaùÜ_t
 {

372 
q4_exŒaùÜ_lše™em_t
()

373 : 
key_exŒaùÜ_t
((
q4_´ojeùed_lše™em_tu¶e
))

377 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

378  *
®igÃd_ÿ¡
<>(
key
);

381 
vœtu®
 
q4_exŒaùÜ_lše™em_t
* 
şÚe
() const {

382  
Ãw
 
q4_exŒaùÜ_lše™em_t
(*
this
);

386 
	gq4_com·»_lše™em_t
 : 
public
 
key_com·»_t
 {

388 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

390 * 
	ga
 = 
®igÃd_ÿ¡
<>(
key1
);

391 * 
	gb
 = 
®igÃd_ÿ¡
<>(
key2
);

395  (*
	ga
 - *
	gb
);

398 
vœtu®
 
q4_com·»_lše™em_t
* 
şÚe
() const {

399  
Ãw
 
q4_com·»_lše™em_t
(*
this
);

406 
	gq4_još_t
 : 
public
 
tu¶e_još_t
 {

409 
q4_još_t
 ()

410 : 
tu¶e_još_t
((
q4_´ojeùed_Üd”s_tu¶e
),

411 
off£tof
(
q4_´ojeùed_Üd”s_tu¶e
, 
O_ORDERKEY
),

412 (
q4_´ojeùed_lše™em_tu¶e
),

413 
off£tof
(
q4_´ojeùed_lše™em_tu¶e
, 
L_ORDERKEY
),

415 (
q4_još_tu¶e
))

420 
vœtu®
 
još
(
tu¶e_t
 &
de¡
,

421 cÚ¡ 
tu¶e_t
 &
Ëá
,

422 cÚ¡ 
tu¶e_t
 &)

425 
q4_´ojeùed_Üd”s_tu¶e
* 
	gtu¶e
 = 
®igÃd_ÿ¡
<q4_´ojeùed_Üd”s_tu¶e>(
Ëá
.
d©a
);

426 
q4_još_tu¶e
 *
	gd
 = 
®igÃd_ÿ¡
<q4_još_tu¶e>(
de¡
.
d©a
);

427 
	gd
->
	gO_ORDERPRIORITY
 = 
tu¶e
->
O_ORDERPRIORITY
;

433 
vœtu®
 
q4_još_t
* 
şÚe
() const {

434  
Ãw
 
q4_još_t
(*
this
);

437 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

443 
	gq4_couÁ_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

444 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

446 
q4_couÁ_agg»g©e_t
()

447 : 
tu¶e_agg»g©e_t
((
q4_agg»g©e_tu¶e
))

450 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
(è{  &
_exŒaùÜ
; }

452 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &) {

453 
q4_agg»g©e_tu¶e
* 
	gagg
 = 
®igÃd_ÿ¡
<q4_agg»g©e_tu¶e>(
agg_d©a
);

454 
	gagg
->
	gO_COUNT
++;

457 
vœtu®
 
fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

458 
memıy
(
d
.
d©a
, 
agg_d©a
, 
tu¶e_size
());

460 
vœtu®
 
q4_couÁ_agg»g©e_t
* 
şÚe
() const {

461  
Ãw
 
q4_couÁ_agg»g©e_t
(*
this
);

463 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

469 şas 
	cch_q4_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


471 
public
:

473 
	$begš
() {

474 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q4 ANSWER ...\n");

475 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** O_PRTY | COUNT...\n");

478 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

480 
q4_agg»g©e_tu¶e
 *
tu¶e
;

481 
tu¶e
 = 
®igÃd_ÿ¡
<
q4_agg»g©e_tu¶e
>(
ouut
.
d©a
);

482 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** %d-%d\n",

483 
tu¶e
->
O_ORDERPRIORITY
,

484 
tu¶e
->
O_COUNT
);

485 
	}
}

495 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_q4
(cÚ¡ 
xù_id
,

496 
q4_šput_t
& 
š
)

498 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** Q4 *********\n");

521 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

522 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

526 
tu¶e_fifo
* 
tsÿn_lše™em_out
 =

527 
Ãw
 
	`tu¶e_fifo
((
q4_´ojeùed_lše™em_tu¶e
));

528 
tsÿn_·ck‘_t
* 
q4_tsÿn_lše™em_·ck‘
 =

529 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN LINEITEM",

530 
tsÿn_lše™em_out
,

531 
Ãw
 
	`q4_tsÿn_lše™em_f‹r_t
(
this
),

532 
this
->
	`db
(),

533 
_¶še™em_desc
.
	`g‘
(),

534 
pxù


539 
tu¶e_f‹r_t
* 
q4_lš™em_sÜt_f‹r
 = 
Ãw
 
	`ŒivŸl_f‹r_t
((
q4_´ojeùed_lše™em_tu¶e
));

540 
tu¶e_fifo
* 
bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q4_´ojeùed_lše™em_tu¶e
));

541 
key_exŒaùÜ_t
* 
exŒaùÜ
 = 
Ãw
 
	`q4_exŒaùÜ_lše™em_t
();

542 
key_com·»_t
* 
com·»
 = 
Ãw
 
	`q4_com·»_lše™em_t
();

543 
·ck‘_t
* 
q4_sÜt_·ck‘
 = 
Ãw
 
	`sÜt_·ck‘_t
("Q4_SORT LINEITEM",

544 
bufãr
,

545 
q4_lš™em_sÜt_f‹r
,

546 
exŒaùÜ
,

547 
com·»
,

548 
q4_tsÿn_lše™em_·ck‘
);

552 
tu¶e_fifo
* 
q4_di¡šù_ouut
 = 
Ãw
 
	`tu¶e_fifo
((
q4_´ojeùed_lše™em_tu¶e
));

553 
·¹Ÿl_agg»g©e_·ck‘_t
* 
q4_di¡šù_·ck‘
 =

554 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
(
	`c_¡r
("Q4DISTINCT_PACKET"),

555 
q4_di¡šù_ouut
,

556 
Ãw
 
	`ŒivŸl_f‹r_t
(
q4_di¡šù_ouut
->
	`tu¶e_size
()),

557 
q4_sÜt_·ck‘
,

558 
Ãw
 
	`q4_di¡šù_t
(),

559 
Ãw
 
q4_di¡šù_t
::
	`q4_di¡šù_key_exŒaùÜ_t
(),

560 
Ãw
 
	`št_key_com·»_t
());

563 
tu¶e_fifo
* 
tsÿn_Üd”s_out
 =

564 
Ãw
 
	`tu¶e_fifo
((
q4_´ojeùed_Üd”s_tu¶e
));

565 
tsÿn_·ck‘_t
* 
q4_tsÿn_Üd”s_·ck‘
 =

566 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN ORDERS",

567 
tsÿn_Üd”s_out
,

568 
Ãw
 
	`q4_tsÿn_Üd”s_f‹r_t
(
this
,
š
),

569 
this
->
	`db
(),

570 
_pÜd”s_desc
.
	`g‘
(),

571 
pxù


576 
tu¶e_f‹r_t
* 
f‹r
 = 
Ãw
 
	`ŒivŸl_f‹r_t
((
q4_još_tu¶e
));

577 
tu¶e_fifo
* 
q4_još_out
 = 
Ãw
 
	`tu¶e_fifo
((
q4_još_tu¶e
));

578 
tu¶e_još_t
* 
q4_još
 = 
Ãw
 
	`q4_još_t
();

579 
·ck‘_t
* 
q4_još_·ck‘
 = 
Ãw
 
	`hash_još_·ck‘_t
("Orders - Lineitem JOIN",

580 
q4_još_out
,

581 
f‹r
,

582 
q4_tsÿn_Üd”s_·ck‘
,

583 
q4_di¡šù_·ck‘
,

584 
q4_još
);

588 
tu¶e_f‹r_t
* 
q4_agg_f‹r
 = 
Ãw
 
	`ŒivŸl_f‹r_t
((
q4_agg»g©e_tu¶e
));

589 
tu¶e_fifo
* 
q4_agg_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q4_agg»g©e_tu¶e
));

590 
tu¶e_agg»g©e_t
 *
q4_agg»g©e
 = 
Ãw
 
	`q4_couÁ_agg»g©e_t
();

591 
·ck‘_t
* 
q4_agg_·ck‘
;

592 
q4_agg_·ck‘
 = 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("O_ORDERPRIORITY COUNT",

593 
q4_agg_bufãr
,

594 
q4_agg_f‹r
,

595 
q4_još_·ck‘
,

596 
q4_agg»g©e
,

597 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
(),

598 
Ãw
 
	`št_key_com·»_t
());

602 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

604 
q4_tsÿn_Üd”s_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

605 
q4_tsÿn_lše™em_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

606 
q4_sÜt_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

607 
q4_di¡šù_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

608 
q4_još_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

609 
q4_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

612 
ch_q4_´oûss_tu¶e_t
 
±
;

614 
	`´oûss_qu”y
(
q4_agg_·ck‘
, 
±
);

616 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

619  (
RCOK
);

620 
	}
}

623 
EXIT_NAMESPACE
(
qpe
);

	@src/workload/tpch/qpipe/qpipe_q5.cpp

32 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

33 
	~"wÜklßd/ch/ch_ut.h
"

34 
	~"qpe.h
"

36 
usšg
 
Çme¥aû
 
	gshÜe
;

37 
usšg
 
Çme¥aû
 
	gqpe
;

41 
ENTER_NAMESPACE
(
ch
);

77 
	sq5_´ojeùed_»giÚ_tu¶e
 {

78 
	mR_REGIONKEY
;

81 
	sq5_´ojeùed_ÇtiÚ_tu¶e
 {

82 
	mN_NATIONKEY
;

83 
	mN_NAME
[
STRSIZE
(25)];

84 
	mN_REGIONKEY
;

87 
	sq5_´ojeùed_cu¡om”_tu¶e
 {

88 
	mC_CUSTKEY
;

89 
	mC_NATIONKEY
;

92 
	sq5_´ojeùed_Üd”s_tu¶e
 {

93 
	mO_ORDERKEY
;

94 
	mO_CUSTKEY
;

97 
	sq5_´ojeùed_lše™em_tu¶e
 {

98 
	mL_ORDERKEY
;

99 
	mL_SUPPKEY
;

100 
decim®
 
	mL_DISCOUNT
;

101 
decim®
 
	mL_EXTENDEDPRICE
;

104 
	sq5_´ojeùed_suµl›r_tu¶e
 {

105 
	mS_SUPPKEY
;

106 
	mS_NATIONKEY
;

110 
	sq5_r_još_n_tu¶e
 {

111 
	mN_NATIONKEY
;

112 
	mN_NAME
[
STRSIZE
(25)];

115 
	sq5_c_još_r_n_tu¶e
 {

116 
	mC_CUSTKEY
;

117 
	mN_NATIONKEY
;

118 
	mN_NAME
[
STRSIZE
(25)];

121 
	sq5_o_još_c_r_n_tu¶e
 {

122 
	mO_ORDERKEY
;

123 
	mN_NATIONKEY
;

124 
	mN_NAME
[
STRSIZE
(25)];

127 
	sq5_l_još_o_c_r_n_tu¶e
 {

128 
	mL_SUPPKEY
;

129 
	mN_NATIONKEY
;

130 
	mN_NAME
[
STRSIZE
(25)];

131 
decim®
 
	mL_DISCOUNT
;

132 
decim®
 
	mL_EXTENDEDPRICE
;

135 
	sq5_®l_još_tu¶e
 {

136 
	mN_NAME
[
STRSIZE
(25)];

137 
decim®
 
	mL_DISCOUNT
;

138 
decim®
 
	mL_EXTENDEDPRICE
;

141 
	sq5_fš®_tu¶e
 {

142 
	mN_NAME
[
STRSIZE
(25)];

143 
decim®
 
	mREVENUE
;

147 şas 
	cq5_»giÚ_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


149 
´iv©e
:

150 
ShÜeTPCHEnv
* 
_chdb
;

151 
bË_row_t
* 
	m_´»giÚ
;

152 
»p_row_t
 
	m_¼
;

155 
ch_»giÚ_tu¶e
 
	m_»giÚ
;

157 
	m_Çme
[
STRSIZE
(25)];

158 
q5_šput_t
* 
	mq5_šput
;

160 
	mpublic
:

161 
	$q5_»giÚ_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q5_šput_t
 &
š
)

162 : 
	`tu¶e_f‹r_t
(
chdb
->
	`»giÚ_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

164 
_´»giÚ
 = 
_chdb
->
	`»giÚ_mª
()->
	`g‘_tu¶e
();

165 
_¼
.
	`£t_ts
(
_chdb
->
	`»giÚ_mª
()->
	`ts
(),

166 
_chdb
->
	`ÇtiÚ_desc
()->
	`maxsize
());

167 
_´»giÚ
->
_»p
 = &
_¼
;

169 
q5_šput
 = &
š
;

170 
	`»giÚ_to_¡r
(
q5_šput
->
r_Çme
, 
_Çme
);

172 
	`TRACE
(
TRACE_ALWAYS
, "Rªdom…»diÿ‹s:\nREGION.R_NAME = '%s'\n", 
_Çme
);

175 
vœtu®
 ~
	$q5_»giÚ_tsÿn_f‹r_t
()

177 
_chdb
->
	`»giÚ_mª
()->
	`give_tu¶e
(
_´»giÚ
);

178 
	}
}

180 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

183 ià(!
_chdb
->
	`»giÚ_mª
()->
	`lßd
(
_´»giÚ
, 
šput
.
d©a
)) {

184 
	`as£¹
(
çl£
);

187 
_´»giÚ
->
	`g‘_v®ue
(1, 
_»giÚ
.
R_NAME
, 25);

189  (
	`¡rcmp
(
_Çme
, 
_»giÚ
.
R_NAME
) == 0);

190 
	}
}

193 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

195 
q5_´ojeùed_»giÚ_tu¶e
 *
de¡
;

196 
de¡
 = 
®igÃd_ÿ¡
<
q5_´ojeùed_»giÚ_tu¶e
>(
d
.
d©a
);

198 
_´»giÚ
->
	`g‘_v®ue
(0, 
_»giÚ
.
R_REGIONKEY
);

203 
de¡
->
R_REGIONKEY
 = 
_»giÚ
.R_REGIONKEY;

204 
	}
}

206 
q5_»giÚ_tsÿn_f‹r_t
* 
	$şÚe
() const {

207  
Ãw
 
	`q5_»giÚ_tsÿn_f‹r_t
(*
this
);

208 
	}
}

210 
c_¡r
 
	$to_¡ršg
() const {

211  
	`c_¡r
("q5_region_tscan_filter_t()");

212 
	}
}

215 şas 
	cq5_ÇtiÚ_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


217 
´iv©e
:

218 
ShÜeTPCHEnv
* 
_chdb
;

219 
bË_row_t
* 
	m_´ÇtiÚ
;

220 
»p_row_t
 
	m_¼
;

223 
ch_ÇtiÚ_tu¶e
 
	m_ÇtiÚ
;

225 
	mpublic
:

226 
	$q5_ÇtiÚ_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q5_šput_t
 &
š
)

227 : 
	`tu¶e_f‹r_t
(
chdb
->
	`ÇtiÚ_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

229 
_´ÇtiÚ
 = 
_chdb
->
	`ÇtiÚ_mª
()->
	`g‘_tu¶e
();

230 
_¼
.
	`£t_ts
(
_chdb
->
	`ÇtiÚ_mª
()->
	`ts
(),

231 
_chdb
->
	`ÇtiÚ_desc
()->
	`maxsize
());

232 
_´ÇtiÚ
->
_»p
 = &
_¼
;

235 
vœtu®
 ~
	$q5_ÇtiÚ_tsÿn_f‹r_t
()

237 
_chdb
->
	`ÇtiÚ_mª
()->
	`give_tu¶e
(
_´ÇtiÚ
);

238 
	}
}

240 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

243 ià(!
_chdb
->
	`ÇtiÚ_mª
()->
	`lßd
(
_´ÇtiÚ
, 
šput
.
d©a
)) {

244 
	`as£¹
(
çl£
);

247  
Œue
;

249 
	}
}

252 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

254 
q5_´ojeùed_ÇtiÚ_tu¶e
 *
de¡
;

255 
de¡
 = 
®igÃd_ÿ¡
<
q5_´ojeùed_ÇtiÚ_tu¶e
>(
d
.
d©a
);

257 
_´ÇtiÚ
->
	`g‘_v®ue
(0, 
_ÇtiÚ
.
N_NATIONKEY
);

258 
_´ÇtiÚ
->
	`g‘_v®ue
(1, 
_ÇtiÚ
.
N_NAME
, (_nation.N_NAME));

259 
_´ÇtiÚ
->
	`g‘_v®ue
(2, 
_ÇtiÚ
.
N_REGIONKEY
);

264 
de¡
->
N_NATIONKEY
 = 
_ÇtiÚ
.N_NATIONKEY;

265 
	`memıy
(
de¡
->
N_NAME
, 
_ÇtiÚ
.N_NAME, (dest->N_NAME));

266 
de¡
->
N_REGIONKEY
 = 
_ÇtiÚ
.N_REGIONKEY;

267 
	}
}

269 
q5_ÇtiÚ_tsÿn_f‹r_t
* 
	$şÚe
() const {

270  
Ãw
 
	`q5_ÇtiÚ_tsÿn_f‹r_t
(*
this
);

271 
	}
}

273 
c_¡r
 
	$to_¡ršg
() const {

274  
	`c_¡r
("q5_nation_tscan_filter_t()");

275 
	}
}

278 şas 
	cq5_cu¡om”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


280 
´iv©e
:

281 
ShÜeTPCHEnv
* 
_chdb
;

282 
bË_row_t
* 
	m_´cu¡
;

283 
»p_row_t
 
	m_¼
;

285 
ch_cu¡om”_tu¶e
 
	m_cu¡om”
;

287 
	mpublic
:

288 
	$q5_cu¡om”_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q5_šput_t
 &
š
)

289 : 
	`tu¶e_f‹r_t
(
chdb
->
	`cu¡om”_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

291 
_´cu¡
 = 
_chdb
->
	`cu¡om”_mª
()->
	`g‘_tu¶e
();

292 
_¼
.
	`£t_ts
(
_chdb
->
	`cu¡om”_mª
()->
	`ts
(),

293 
_chdb
->
	`cu¡om”_desc
()->
	`maxsize
());

294 
_´cu¡
->
_»p
 = &
_¼
;

297 
vœtu®
 ~
	$q5_cu¡om”_tsÿn_f‹r_t
()

300 
_chdb
->
	`cu¡om”_mª
()->
	`give_tu¶e
(
_´cu¡
);

301 
	}
}

303 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

305 ià(!
_chdb
->
	`cu¡om”_mª
()->
	`lßd
(
_´cu¡
, 
šput
.
d©a
)) {

306 
	`as£¹
(
çl£
);

309  
Œue
;

310 
	}
}

312 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

314 
q5_´ojeùed_cu¡om”_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q5_´ojeùed_cu¡om”_tu¶e>(
d
.
d©a
);

316 
_´cu¡
->
	`g‘_v®ue
(0, 
_cu¡om”
.
C_CUSTKEY
);

317 
_´cu¡
->
	`g‘_v®ue
(3, 
_cu¡om”
.
C_NATIONKEY
);

321 
de¡
->
C_CUSTKEY
 = 
_cu¡om”
.C_CUSTKEY;

322 
de¡
->
C_NATIONKEY
 = 
_cu¡om”
.C_NATIONKEY;

323 
	}
}

325 
q5_cu¡om”_tsÿn_f‹r_t
* 
	$şÚe
() const {

326  
Ãw
 
	`q5_cu¡om”_tsÿn_f‹r_t
(*
this
);

327 
	}
}

329 
c_¡r
 
	$to_¡ršg
() const {

330  
	`c_¡r
("q5_customer_tscan_filter_t");

331 
	}
}

334 şas 
	cq5_Üd”s_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


336 
´iv©e
:

337 
ShÜeTPCHEnv
* 
_chdb
;

338 
bË_row_t
* 
	m_´Üd”s
;

339 
»p_row_t
 
	m_¼
;

341 
ch_Üd”s_tu¶e
 
	m_Üd”s
;

342 
time_t
 
	m_Üd”d©e
;

344 
q5_šput_t
* 
	mq5_šput
;

345 
time_t
 
	m_Ï¡_Üd”d©e
;

347 
	mpublic
:

348 
	$q5_Üd”s_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q5_šput_t
 &
š
)

349 : 
	`tu¶e_f‹r_t
(
chdb
->
	`Üd”s_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

351 
_´Üd”s
 = 
_chdb
->
	`Üd”s_mª
()->
	`g‘_tu¶e
();

352 
_¼
.
	`£t_ts
(
_chdb
->
	`Üd”s_mª
()->
	`ts
(),

353 
_chdb
->
	`Üd”s_desc
()->
	`maxsize
());

354 
_´Üd”s
->
_»p
 = &
_¼
;

357 
q5_šput
 = &
š
;

358 
tm
 
d©e
;

359 
	`gmtime_r
(&(
q5_šput
->
o_Üd”d©e
), &
d©e
);

360 
d©e
.
tm_y—r
++;

361 
_Ï¡_Üd”d©e
 = 
	`mktime
(&
d©e
);

363 
t1
[15];

364 
t2
[15];

365 
	`tim‘_to_¡r
(
t1
, 
q5_šput
->
o_Üd”d©e
);

366 
	`tim‘_to_¡r
(
t2
, 
_Ï¡_Üd”d©e
);

368 
	`TRACE
(
TRACE_ALWAYS
, "Rªdom…»diÿ‹s:\À% <ğO_ORDERDATE < %s\n", 
t1
, 
t2
);

371 
vœtu®
 ~
	$q5_Üd”s_tsÿn_f‹r_t
()

374 
_chdb
->
	`Üd”s_mª
()->
	`give_tu¶e
(
_´Üd”s
);

375 
	}
}

377 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

379 ià(!
_chdb
->
	`Üd”s_mª
()->
	`lßd
(
_´Üd”s
, 
šput
.
d©a
)) {

380 
	`as£¹
(
çl£
);

383 
_´Üd”s
->
	`g‘_v®ue
(4, 
_Üd”s
.
O_ORDERDATE
, 15);

384 
_Üd”d©e
 = 
	`¡r_to_tim‘
(
_Üd”s
.
O_ORDERDATE
);

386  
_Üd”d©e
 >ğ
q5_šput
->
o_Üd”d©e
 && _Üd”d©< 
_Ï¡_Üd”d©e
;

387 
	}
}

389 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

391 
q5_´ojeùed_Üd”s_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q5_´ojeùed_Üd”s_tu¶e>(
d
.
d©a
);

393 
_´Üd”s
->
	`g‘_v®ue
(0, 
_Üd”s
.
O_ORDERKEY
);

394 
_´Üd”s
->
	`g‘_v®ue
(1, 
_Üd”s
.
O_CUSTKEY
);

398 
de¡
->
O_ORDERKEY
 = 
_Üd”s
.O_ORDERKEY;

399 
de¡
->
O_CUSTKEY
 = 
_Üd”s
.O_CUSTKEY;

400 
	}
}

402 
q5_Üd”s_tsÿn_f‹r_t
* 
	$şÚe
() const {

403  
Ãw
 
	`q5_Üd”s_tsÿn_f‹r_t
(*
this
);

404 
	}
}

406 
c_¡r
 
	$to_¡ršg
() const {

407  
	`c_¡r
("q5_orders_tscan_filter_t()");

408 
	}
}

411 şas 
	cq5_lše™em_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


413 
´iv©e
:

414 
ShÜeTPCHEnv
* 
_chdb
;

415 
bË_row_t
* 
	m_´lše
;

416 
»p_row_t
 
	m_¼
;

418 
ch_lše™em_tu¶e
 
	m_lše™em
;

420 
	mpublic
:

421 
	$q5_lše™em_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q5_šput_t
 &
š
)

422 : 
	`tu¶e_f‹r_t
(
chdb
->
	`lše™em_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

424 
_´lše
 = 
_chdb
->
	`lše™em_mª
()->
	`g‘_tu¶e
();

425 
_¼
.
	`£t_ts
(
_chdb
->
	`lše™em_mª
()->
	`ts
(),

426 
_chdb
->
	`lše™em_desc
()->
	`maxsize
());

427 
_´lše
->
_»p
 = &
_¼
;

430 
vœtu®
 ~
	$q5_lše™em_tsÿn_f‹r_t
()

433 
_chdb
->
	`lše™em_mª
()->
	`give_tu¶e
(
_´lše
);

434 
	}
}

436 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

438 ià(!
_chdb
->
	`lše™em_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

439 
	`as£¹
(
çl£
);

442  
Œue
;

443 
	}
}

445 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

447 
q5_´ojeùed_lše™em_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q5_´ojeùed_lše™em_tu¶e>(
d
.
d©a
);

449 
_´lše
->
	`g‘_v®ue
(0, 
_lše™em
.
L_ORDERKEY
);

450 
_´lše
->
	`g‘_v®ue
(2, 
_lše™em
.
L_SUPPKEY
);

451 
_´lše
->
	`g‘_v®ue
(5, 
_lše™em
.
L_EXTENDEDPRICE
);

452 
_´lše
->
	`g‘_v®ue
(6, 
_lše™em
.
L_DISCOUNT
);

456 
de¡
->
L_ORDERKEY
 = 
_lše™em
.L_ORDERKEY;

457 
de¡
->
L_SUPPKEY
 = 
_lše™em
.L_SUPPKEY;

458 
de¡
->
L_EXTENDEDPRICE
 = 
_lše™em
.L_EXTENDEDPRICE / 100.0;

459 
de¡
->
L_DISCOUNT
 = 
_lše™em
.L_DISCOUNT / 100.0;

460 
	}
}

462 
q5_lše™em_tsÿn_f‹r_t
* 
	$şÚe
() const {

463  
Ãw
 
	`q5_lše™em_tsÿn_f‹r_t
(*
this
);

464 
	}
}

466 
c_¡r
 
	$to_¡ršg
() const {

467  
	`c_¡r
("q5_lineitem_tscan_filter_t");

468 
	}
}

471 şas 
	cq5_suµl›r_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


473 
´iv©e
:

474 
ShÜeTPCHEnv
* 
_chdb
;

475 
bË_row_t
* 
	m_´suµl›r
;

476 
»p_row_t
 
	m_¼
;

479 
ch_suµl›r_tu¶e
 
	m_suµl›r
;

481 
	mpublic
:

482 
	$q5_suµl›r_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q5_šput_t
 &
š
)

483 : 
	`tu¶e_f‹r_t
(
chdb
->
	`suµl›r_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

485 
_´suµl›r
 = 
_chdb
->
	`suµl›r_mª
()->
	`g‘_tu¶e
();

486 
_¼
.
	`£t_ts
(
_chdb
->
	`suµl›r_mª
()->
	`ts
(),

487 
_chdb
->
	`suµl›r_desc
()->
	`maxsize
());

488 
_´suµl›r
->
_»p
 = &
_¼
;

491 
vœtu®
 ~
	$q5_suµl›r_tsÿn_f‹r_t
()

493 
_chdb
->
	`suµl›r_mª
()->
	`give_tu¶e
(
_´suµl›r
);

494 
	}
}

496 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

499 ià(!
_chdb
->
	`suµl›r_mª
()->
	`lßd
(
_´suµl›r
, 
šput
.
d©a
)) {

500 
	`as£¹
(
çl£
);

503  
Œue
;

504 
	}
}

507 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

509 
q5_´ojeùed_suµl›r_tu¶e
 *
de¡
;

510 
de¡
 = 
®igÃd_ÿ¡
<
q5_´ojeùed_suµl›r_tu¶e
>(
d
.
d©a
);

513 
_´suµl›r
->
	`g‘_v®ue
(0, 
_suµl›r
.
S_SUPPKEY
);

514 
_´suµl›r
->
	`g‘_v®ue
(3, 
_suµl›r
.
S_NATIONKEY
);

519 
de¡
->
S_SUPPKEY
 = 
_suµl›r
.S_SUPPKEY;

520 
de¡
->
S_NATIONKEY
 = 
_suµl›r
.S_NATIONKEY;

522 
	}
}

524 
q5_suµl›r_tsÿn_f‹r_t
* 
	$şÚe
() const {

525  
Ãw
 
	`q5_suµl›r_tsÿn_f‹r_t
(*
this
);

526 
	}
}

528 
c_¡r
 
	$to_¡ršg
() const {

529  
	`c_¡r
("q5_supplier_tscan_filter_t");

530 
	}
}

534 
	gq5_r_još_n_t
 : 
public
 
tu¶e_još_t
 {

536 
q5_r_još_n_t
()

537 : 
tu¶e_još_t
((
q5_´ojeùed_»giÚ_tu¶e
),

538 
off£tof
(
q5_´ojeùed_»giÚ_tu¶e
, 
R_REGIONKEY
),

539 (
q5_´ojeùed_ÇtiÚ_tu¶e
),

540 
off£tof
(
q5_´ojeùed_ÇtiÚ_tu¶e
, 
N_REGIONKEY
),

542 (
q5_r_još_n_tu¶e
))

546 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

547 
q5_r_još_n_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q5_r_još_n_tu¶e>(
d
.
d©a
);

548 
q5_´ojeùed_»giÚ_tu¶e
 *
	g»giÚ
 = 
®igÃd_ÿ¡
<q5_´ojeùed_»giÚ_tu¶e>(
l
.
d©a
);

549 
q5_´ojeùed_ÇtiÚ_tu¶e
 *
	gÇtiÚ
 = 
®igÃd_ÿ¡
<q5_´ojeùed_ÇtiÚ_tu¶e>(
r
.
d©a
);

551 
	gde¡
->
	gN_NATIONKEY
 = 
ÇtiÚ
->
N_NATIONKEY
;

552 
memıy
(
de¡
->
N_NAME
, 
ÇtiÚ
->N_NAME, (dest->N_NAME));

557 
vœtu®
 
q5_r_još_n_t
* 
şÚe
() const {

558  
Ãw
 
q5_r_još_n_t
(*
this
);

561 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

562  
c_¡r
("join REGION, NATION; select N_NATIONKEY, N_NAME");

566 
	gq5_c_još_r_n_t
 : 
public
 
tu¶e_još_t
 {

568 
q5_c_još_r_n_t
()

569 : 
tu¶e_još_t
((
q5_´ojeùed_cu¡om”_tu¶e
),

570 
off£tof
(
q5_´ojeùed_cu¡om”_tu¶e
, 
C_NATIONKEY
),

571 (
q5_r_još_n_tu¶e
),

572 
off£tof
(
q5_r_još_n_tu¶e
, 
N_NATIONKEY
),

574 (
q5_c_još_r_n_tu¶e
))

578 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

579 
q5_c_još_r_n_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q5_c_još_r_n_tu¶e>(
d
.
d©a
);

580 
q5_´ojeùed_cu¡om”_tu¶e
 *
	gcu¡
 = 
®igÃd_ÿ¡
<q5_´ojeùed_cu¡om”_tu¶e>(
l
.
d©a
);

581 
q5_r_još_n_tu¶e
 *
	gright
 = 
®igÃd_ÿ¡
<q5_r_još_n_tu¶e>(
r
.
d©a
);

583 
	gde¡
->
	gC_CUSTKEY
 = 
cu¡
->
C_CUSTKEY
;

584 
	gde¡
->
	gN_NATIONKEY
 = 
right
->
N_NATIONKEY
;

585 
memıy
(
de¡
->
N_NAME
, 
right
->N_NAME, (dest->N_NAME));

590 
vœtu®
 
q5_c_još_r_n_t
* 
şÚe
() const {

591  
Ãw
 
q5_c_još_r_n_t
(*
this
);

594 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

595  
c_¡r
("join CUSTOMER, REGION_NATION; select C_CUSTKEY, N_NATIONKEY, N_NAME");

599 
	gq5_o_još_c_r_n_t
 : 
public
 
tu¶e_još_t
 {

601 
q5_o_još_c_r_n_t
()

602 : 
tu¶e_još_t
((
q5_´ojeùed_Üd”s_tu¶e
),

603 
off£tof
(
q5_´ojeùed_Üd”s_tu¶e
, 
O_CUSTKEY
),

604 (
q5_c_još_r_n_tu¶e
),

605 
off£tof
(
q5_c_još_r_n_tu¶e
, 
C_CUSTKEY
),

607 (
q5_o_još_c_r_n_tu¶e
))

611 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

612 
q5_o_još_c_r_n_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q5_o_još_c_r_n_tu¶e>(
d
.
d©a
);

613 
q5_´ojeùed_Üd”s_tu¶e
 *
	gÜd”s
 = 
®igÃd_ÿ¡
<q5_´ojeùed_Üd”s_tu¶e>(
l
.
d©a
);

614 
q5_c_još_r_n_tu¶e
 *
	gright
 = 
®igÃd_ÿ¡
<q5_c_još_r_n_tu¶e>(
r
.
d©a
);

616 
	gde¡
->
	gO_ORDERKEY
 = 
Üd”s
->
O_ORDERKEY
;

617 
	gde¡
->
	gN_NATIONKEY
 = 
right
->
N_NATIONKEY
;

618 
memıy
(
de¡
->
N_NAME
, 
right
->N_NAME, (dest->N_NAME));

623 
vœtu®
 
q5_o_još_c_r_n_t
* 
şÚe
() const {

624  
Ãw
 
q5_o_još_c_r_n_t
(*
this
);

627 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

628  
c_¡r
("join ORDERS, CUSTOMER_REGION_NATION; select O_ORDERKEY, N_NATIONKEY, N_NAME");

633 
	gq5_l_još_o_c_r_n_t
 : 
public
 
tu¶e_još_t
 {

635 
q5_l_još_o_c_r_n_t
()

636 : 
tu¶e_još_t
((
q5_´ojeùed_lše™em_tu¶e
),

637 
off£tof
(
q5_´ojeùed_lše™em_tu¶e
, 
L_ORDERKEY
),

638 (
q5_o_još_c_r_n_tu¶e
),

639 
off£tof
(
q5_o_još_c_r_n_tu¶e
, 
O_ORDERKEY
),

641 (
q5_l_još_o_c_r_n_tu¶e
))

645 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

646 
q5_l_još_o_c_r_n_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q5_l_još_o_c_r_n_tu¶e>(
d
.
d©a
);

647 
q5_´ojeùed_lše™em_tu¶e
 *
	glše
 = 
®igÃd_ÿ¡
<q5_´ojeùed_lše™em_tu¶e>(
l
.
d©a
);

648 
q5_o_još_c_r_n_tu¶e
 *
	gright
 = 
®igÃd_ÿ¡
<q5_o_još_c_r_n_tu¶e>(
r
.
d©a
);

650 
	gde¡
->
	gL_SUPPKEY
 = 
lše
->
L_SUPPKEY
;

651 
	gde¡
->
	gN_NATIONKEY
 = 
right
->
N_NATIONKEY
;

652 
memıy
(
de¡
->
N_NAME
, 
right
->N_NAME, (dest->N_NAME));

653 
	gde¡
->
	gL_EXTENDEDPRICE
 = 
lše
->
L_EXTENDEDPRICE
;

654 
	gde¡
->
	gL_DISCOUNT
 = 
lše
 ->
L_DISCOUNT
;

660 
vœtu®
 
q5_l_još_o_c_r_n_t
* 
şÚe
() const {

661  
Ãw
 
q5_l_još_o_c_r_n_t
(*
this
);

664 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

665  
c_¡r
("join LINEITEM, ORDERS_CUSTOMER_REGION_NATION; select L_SUPPKEY, N_NATIONKEY, N_NAME, L_EXTENDEDPRICE, L_DISCOUNT");

670 
	gq5_fš®_još
 : 
public
 
tu¶e_još_t
 {

672 
q5_fš®_još
()

673 : 
tu¶e_još_t
((
q5_l_još_o_c_r_n_tu¶e
),

674 
off£tof
(
q5_l_još_o_c_r_n_tu¶e
, 
L_SUPPKEY
),

675 (
q5_´ojeùed_suµl›r_tu¶e
),

676 
off£tof
(
q5_´ojeùed_suµl›r_tu¶e
, 
S_SUPPKEY
),

678 (
q5_®l_još_tu¶e
))

682 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

683 
q5_®l_još_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q5_®l_još_tu¶e>(
d
.
d©a
);

684 
q5_l_još_o_c_r_n_tu¶e
 *
	gËá
 = 
®igÃd_ÿ¡
<q5_l_još_o_c_r_n_tu¶e>(
l
.
d©a
);

685 
q5_´ojeùed_suµl›r_tu¶e
 *
	gsuµ
 = 
®igÃd_ÿ¡
<q5_´ojeùed_suµl›r_tu¶e>(
r
.
d©a
);

687 
memıy
(
de¡
->
N_NAME
, 
Ëá
->N_NAME, (dest->N_NAME));

688 
	gde¡
->
	gL_EXTENDEDPRICE
 = 
Ëá
->
L_EXTENDEDPRICE
;

689 
	gde¡
->
	gL_DISCOUNT
 = 
Ëá
->
L_DISCOUNT
;

695 
vœtu®
 
q5_fš®_još
* 
şÚe
() const {

696  
Ãw
 
q5_fš®_još
(*
this
);

699 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

700  
c_¡r
("join LINEITEM_ORDERS_CUSTOMER_REGION_NATION, SUPPLIER; select N_NAME, L_EXTENDEDPRICE, L_DISCOUNT");

705 
	gq5_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

707 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

709 
q5_agg»g©e_t
()

710 : 
tu¶e_agg»g©e_t
((
q5_fš®_tu¶e
)), 
_exŒaùÜ
(
deçuÉ_key_exŒaùÜ_t
(
STRSIZE
(25è* (), 
off£tof
(
q5_®l_još_tu¶e
,
N_NAME
)))

714 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
() {

715  &
	g_exŒaùÜ
;

718 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
t
) {

719 
q5_fš®_tu¶e
 *
	gagg
 = 
®igÃd_ÿ¡
<q5_fš®_tu¶e>(
agg_d©a
);

720 
q5_®l_još_tu¶e
 *
	gšput
 = 
®igÃd_ÿ¡
<q5_®l_još_tu¶e>(
t
.
d©a
);

722 
memıy
(
agg
->
N_NAME
, 
šput
->N_NAME, (agg->N_NAME));

723 
	gagg
->
	gREVENUE
 +ğ
šput
->
L_EXTENDEDPRICE
 * (1 - iÅut->
L_DISCOUNT
);

725 
vœtu®
 
fšish
(
tu¶e_t
 &
de¡
, cÚ¡ * 
agg_d©a
) {

726 
memıy
(
de¡
.
d©a
, 
agg_d©a
, de¡.
size
);

728 
vœtu®
 
q5_agg»g©e_t
* 
şÚe
() const {

729  
Ãw
 
q5_agg»g©e_t
(*
this
);

731 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

736 
	gq5_agg_key_com·»_t
 : 
public
 
key_com·»_t
 {

738 
q5_agg_key_com·»_t
()

742 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

743  
¡rcmp
((*)
key1
, (*)
key2
);

746 
vœtu®
 
q5_agg_key_com·»_t
* 
şÚe
() const {

747  
Ãw
 
q5_agg_key_com·»_t
(*
this
);

751 
	gq5_sÜt_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

753 
q5_sÜt_key_exŒaùÜ_t
()

754 : 
key_exŒaùÜ_t
((
decim®
), 
off£tof
(
q5_fš®_tu¶e
, 
REVENUE
))

758 
vœtu®
 
exŒaù_hšt
(cÚ¡ *
key
) const {

759 
decim®
 
	g»v’ue
 = *(
®igÃd_ÿ¡
<decim®>(
key
));

760  -(
	g»v’ue
.
to_št
());

763 
vœtu®
 
key_exŒaùÜ_t
* 
şÚe
() const {

764  
Ãw
 
q5_sÜt_key_exŒaùÜ_t
(*
this
);

768 
	gq5_sÜt_key_com·»_t
 : 
public
 
key_com·»_t
 {

770 
q5_sÜt_key_com·»_t
()

774 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

775 
TRACE
(
TRACE_RECORD_FLOW
, "SORT_COMP\n");

776 
decim®
 
	g»v1
 = *(
®igÃd_ÿ¡
<decim®>(
key1
));

777 
decim®
 
	g»v2
 = *(
®igÃd_ÿ¡
<decim®>(
key2
));

778 
decim®
 
	gdiff
 = 
»v2
 - 
»v1
;

779  (
	gdiff
 < 0 ? -1 : (
diff
 == 0 ? 0 : 1));

782 
vœtu®
 
q5_sÜt_key_com·»_t
* 
şÚe
() const {

783  
Ãw
 
q5_sÜt_key_com·»_t
(*
this
);

788 şas 
	cch_q5_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t
 {

790 
public
:

792 
vœtu®
 
	$begš
() {

793 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q5 %25s %25s\n",

797 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

798 
q5_fš®_tu¶e
 *
»s
 = 
®igÃd_ÿ¡
<q5_fš®_tu¶e>(
ouut
.
d©a
);

800 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q5 %25s %25.2f\n",

801 
»s
->
N_NAME
,„es->
REVENUE
.
	`to_doubË
());

802 
	}
}

813 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_q5
(cÚ¡ 
xù_id
,

814 
q5_šput_t
& 
š
)

816 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** Q5 *********\n");

818 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

819 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

823 
tu¶e_fifo
* 
q5_ÇtiÚ_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q5_´ojeùed_ÇtiÚ_tu¶e
));

824 
·ck‘_t
* 
q5_ÇtiÚ_tsÿn_·ck‘
 =

825 
Ãw
 
	`tsÿn_·ck‘_t
("nation TSCAN",

826 
q5_ÇtiÚ_bufãr
,

827 
Ãw
 
	`q5_ÇtiÚ_tsÿn_f‹r_t
(
this
, 
š
),

828 
this
->
	`db
(),

829 
_²©iÚ_desc
.
	`g‘
(),

830 
pxù
);

833 
tu¶e_fifo
* 
q5_»giÚ_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q5_´ojeùed_»giÚ_tu¶e
));

834 
·ck‘_t
* 
q5_»giÚ_tsÿn_·ck‘
 =

835 
Ãw
 
	`tsÿn_·ck‘_t
("region TSCAN",

836 
q5_»giÚ_bufãr
,

837 
Ãw
 
	`q5_»giÚ_tsÿn_f‹r_t
(
this
, 
š
),

838 
this
->
	`db
(),

839 
_´egiÚ_desc
.
	`g‘
(),

840 
pxù
);

843 
tu¶e_fifo
* 
q5_r_još_n_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q5_r_još_n_tu¶e
));

844 
·ck‘_t
* 
q5_r_još_n_·ck‘
 =

845 
Ãw
 
	`hash_još_·ck‘_t
("region -‚ation HJOIN",

846 
q5_r_još_n_bufãr
,

847 
Ãw
 
	`ŒivŸl_f‹r_t
((
q5_r_još_n_tu¶e
)),

848 
q5_»giÚ_tsÿn_·ck‘
,

849 
q5_ÇtiÚ_tsÿn_·ck‘
,

850 
Ãw
 
	`q5_r_još_n_t
());

853 
tu¶e_fifo
* 
q5_cu¡om”_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q5_´ojeùed_cu¡om”_tu¶e
));

854 
·ck‘_t
* 
q5_cu¡om”_tsÿn_·ck‘
 =

855 
Ãw
 
	`tsÿn_·ck‘_t
("customer TSCAN",

856 
q5_cu¡om”_bufãr
,

857 
Ãw
 
	`q5_cu¡om”_tsÿn_f‹r_t
(
this
, 
š
),

858 
this
->
	`db
(),

859 
_pcu¡om”_desc
.
	`g‘
(),

860 
pxù
);

863 
tu¶e_fifo
* 
q5_c_još_r_n_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q5_c_još_r_n_tu¶e
));

864 
·ck‘_t
* 
q5_c_još_r_n_·ck‘
 =

865 
Ãw
 
	`hash_još_·ck‘_t
("customer -„egion_nation HJOIN",

866 
q5_c_još_r_n_bufãr
,

867 
Ãw
 
	`ŒivŸl_f‹r_t
((
q5_c_još_r_n_tu¶e
)),

868 
q5_cu¡om”_tsÿn_·ck‘
,

869 
q5_r_još_n_·ck‘
,

870 
Ãw
 
	`q5_c_još_r_n_t
());

873 
tu¶e_fifo
* 
q5_Üd”s_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q5_´ojeùed_Üd”s_tu¶e
));

874 
·ck‘_t
* 
q5_Üd”s_tsÿn_·ck‘
 =

875 
Ãw
 
	`tsÿn_·ck‘_t
("orders TSCAN",

876 
q5_Üd”s_bufãr
,

877 
Ãw
 
	`q5_Üd”s_tsÿn_f‹r_t
(
this
, 
š
),

878 
this
->
	`db
(),

879 
_pÜd”s_desc
.
	`g‘
(),

880 
pxù
);

883 
tu¶e_fifo
* 
q5_o_još_c_r_n_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q5_o_još_c_r_n_tu¶e
));

884 
·ck‘_t
* 
q5_o_još_c_r_n_·ck‘
 =

885 
Ãw
 
	`hash_još_·ck‘_t
("orders - customer_region_nation HJOIN",

886 
q5_o_još_c_r_n_bufãr
,

887 
Ãw
 
	`ŒivŸl_f‹r_t
((
q5_o_još_c_r_n_tu¶e
)),

888 
q5_Üd”s_tsÿn_·ck‘
,

889 
q5_c_još_r_n_·ck‘
,

890 
Ãw
 
	`q5_o_još_c_r_n_t
());

893 
tu¶e_fifo
* 
q5_lše™em_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q5_´ojeùed_lše™em_tu¶e
));

894 
·ck‘_t
* 
q5_lše™em_tsÿn_·ck‘
 =

895 
Ãw
 
	`tsÿn_·ck‘_t
("lineitem TSCAN",

896 
q5_lše™em_bufãr
,

897 
Ãw
 
	`q5_lše™em_tsÿn_f‹r_t
(
this
, 
š
),

898 
this
->
	`db
(),

899 
_¶še™em_desc
.
	`g‘
(),

900 
pxù
);

903 
tu¶e_fifo
* 
q5_l_još_o_c_r_n_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q5_l_još_o_c_r_n_tu¶e
));

904 
·ck‘_t
* 
q5_l_još_o_c_r_n_·ck‘
 =

905 
Ãw
 
	`hash_još_·ck‘_t
("lineitem - orders_customer_region_nation HJOIN",

906 
q5_l_još_o_c_r_n_bufãr
,

907 
Ãw
 
	`ŒivŸl_f‹r_t
((
q5_l_još_o_c_r_n_tu¶e
)),

908 
q5_lše™em_tsÿn_·ck‘
,

909 
q5_o_još_c_r_n_·ck‘
,

910 
Ãw
 
	`q5_l_još_o_c_r_n_t
());

913 
tu¶e_fifo
* 
q5_suµl›r_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q5_´ojeùed_suµl›r_tu¶e
));

914 
·ck‘_t
* 
q5_suµl›r_tsÿn_·ck‘
 =

915 
Ãw
 
	`tsÿn_·ck‘_t
("supplier TSCAN",

916 
q5_suµl›r_bufãr
,

917 
Ãw
 
	`q5_suµl›r_tsÿn_f‹r_t
(
this
, 
š
),

918 
this
->
	`db
(),

919 
_psuµl›r_desc
.
	`g‘
(),

920 
pxù
);

923 
tu¶e_fifo
* 
q5_®l_još_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q5_®l_još_tu¶e
));

924 
·ck‘_t
* 
q5_®l_još_·ck‘
 =

925 
Ãw
 
	`hash_još_·ck‘_t
("lineitem_orders_customer_region_nation - supplier HJOIN",

926 
q5_®l_još_bufãr
,

927 
Ãw
 
	`ŒivŸl_f‹r_t
((
q5_®l_još_tu¶e
)),

928 
q5_l_još_o_c_r_n_·ck‘
,

929 
q5_suµl›r_tsÿn_·ck‘
,

930 
Ãw
 
	`q5_fš®_još
());

933 
tu¶e_fifo
* 
q5_agg»g©ed_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q5_fš®_tu¶e
));

934 
·ck‘_t
* 
q5_agg»g©e_·ck‘
 =

935 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("SUM AGG",

936 
q5_agg»g©ed_bufãr
,

937 
Ãw
 
	`ŒivŸl_f‹r_t
((
q5_fš®_tu¶e
)),

938 
q5_®l_još_·ck‘
,

939 
Ãw
 
	`q5_agg»g©e_t
(),

940 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
((è* 
	`STRSIZE
(25)),

941 
Ãw
 
	`q5_agg_key_com·»_t
());

944 
tu¶e_fifo
* 
q5_fš®_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q5_fš®_tu¶e
));

945 
·ck‘_t
* 
q5_sÜt_·ck‘
 =

946 
Ãw
 
	`sÜt_·ck‘_t
("SORT",

947 
q5_fš®_bufãr
,

948 
Ãw
 
	`ŒivŸl_f‹r_t
((
q5_fš®_tu¶e
)),

949 
Ãw
 
	`q5_sÜt_key_exŒaùÜ_t
(),

950 
Ãw
 
	`q5_sÜt_key_com·»_t
(),

951 
q5_agg»g©e_·ck‘
);

956 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

957 
q5_ÇtiÚ_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

958 
q5_»giÚ_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

959 
q5_r_još_n_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

960 
q5_cu¡om”_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

961 
q5_c_još_r_n_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

962 
q5_Üd”s_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

963 
q5_o_još_c_r_n_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

964 
q5_lše™em_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

965 
q5_l_još_o_c_r_n_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

966 
q5_suµl›r_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

967 
q5_®l_još_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

968 
q5_agg»g©e_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

969 
q5_sÜt_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

972 
ch_q5_´oûss_tu¶e_t
 
±
;

974 
	`´oûss_qu”y
(
q5_sÜt_·ck‘
, 
±
);

976 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

979  (
RCOK
);

980 
	}
}

983 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/qpipe/qpipe_q6.cpp

32 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

33 
	~"qpe.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
usšg
 
Çme¥aû
 
	gqpe
;

40 
ENTER_NAMESPACE
(
ch
);

63 
	sq6_´ojeùed_lše™em_tu¶e
 {

64 
	mL_EXTENDEDPRICE
;

65 
	mL_DISCOUNT
;

69 
	sq6_muÉl›d_lše™em_tu¶e
 {

70 
	mL_EXTENDEDPRICE_MUL_DISCOUNT
;

74 
	sq6_agg»g©e_tu¶e
 {

75 
	mL_SUM_REVENUE
;

76 
	mL_COUNT
;

81 şas 
	cq6_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


83 
´iv©e
:

84 
ShÜeTPCHEnv
* 
_chdb
;

85 
bË_row_t
* 
	m_´lše
;

86 
»p_row_t
 
	m_¼
;

89 
ch_lše™em_tu¶e
 
	m_lše™em
;

91 
time_t
 
	m_shd©e
;

92 
	m_discouÁ
;

93 
	m_quªt™y
;

97 
q6_šput_t
* 
	mq6_šput
;

98 
time_t
 
	m_Ï¡_l_shd©e
;

99 
	mpublic
:

101 
	$q6_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q6_šput_t
 &
š
)

102 : 
	`tu¶e_f‹r_t
(
chdb
->
	`lše™em_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

107 
_´lše
 = 
_chdb
->
	`lše™em_mª
()->
	`g‘_tu¶e
();

108 
_¼
.
	`£t_ts
(
_chdb
->
	`lše™em_mª
()->
	`ts
(),

109 
_chdb
->
	`lše™em_desc
()->
	`maxsize
());

110 
_´lše
->
_»p
 = &
_¼
;

119 
q6_šput
=&
š
;

120 
tm
 
d©e
;

121 
	`gmtime_r
(&(
q6_šput
->
l_shd©e
), &
d©e
);

122 
d©e
.
tm_y—r
 ++;

123 
_Ï¡_l_shd©e
=
	`mktime
(&
d©e
);

125 
d©e1
[15];

126 
d©e2
[15];

127 
	`tim‘_to_¡r
(
d©e1
,
q6_šput
->
l_shd©e
);

128 
	`tim‘_to_¡r
(
d©e2
,
_Ï¡_l_shd©e
);

129 
	`TRACE
(
TRACE_ALWAYS
, "Rªdom…»diÿ‹s: D©e: %s-%s, DiscouÁ: %lf, Quªt™y: %lf\n", 
d©e1
, 
d©e2
, 
q6_šput
->
l_discouÁ
, q6_šput->
l_quªt™y
);

132 ~
	$q6_tsÿn_f‹r_t
()

135 
_chdb
->
	`lše™em_mª
()->
	`give_tu¶e
(
_´lše
);

136 
	}
}

140 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

143 ià(!
_chdb
->
	`lše™em_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

144 
	`as£¹
(
çl£
);

147 
_´lše
->
	`g‘_v®ue
(10, 
_lše™em
.
L_SHIPDATE
, 15);

148 
_shd©e
 = 
	`¡r_to_tim‘
(
_lše™em
.
L_SHIPDATE
);

149 
_´lše
->
	`g‘_v®ue
(6, 
_lše™em
.
L_DISCOUNT
);

150 
_discouÁ
=
_lše™em
.
L_DISCOUNT
/100.0;

151 #w¬nšg 
MA
: 
DiscouÁ
 
äom
 
TPCH
 
dbg’
 
is
 
ü—‹d
 
b‘w“n
 0 
ªd
 100 
š¡—d
 between 0‡nd 1.

152 
_´lše
->
	`g‘_v®ue
(4, 
_lše™em
.
L_QUANTITY
);

153 
_quªt™y
=
_lše™em
.
L_QUANTITY
;

158 iàĞ
_shd©e
 >ğ
q6_šput
->
l_shd©e
 && _shd©< 
_Ï¡_l_shd©e
 && 
_discouÁ
>=(q6_šput->
l_discouÁ
-0.01) &&

159 
_discouÁ
<=(
q6_šput
->
l_discouÁ
+0.01è&& 
_quªt™y
<q6_šput->
l_quªt™y
) {

162  (
Œue
);

166  (
çl£
);

168 
	}
}

172 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

174 
q6_´ojeùed_lše™em_tu¶e
 *
de¡
;

175 
de¡
 = 
®igÃd_ÿ¡
<
q6_´ojeùed_lše™em_tu¶e
>(
d
.
d©a
);

177 
_´lše
->
	`g‘_v®ue
(5, 
_lše™em
.
L_EXTENDEDPRICE
);

178 
_´lše
->
	`g‘_v®ue
(6, 
_lše™em
.
L_DISCOUNT
);

184 
de¡
->
L_EXTENDEDPRICE
 = 
_lše™em
.L_EXTENDEDPRICE / 100.0;

185 
de¡
->
L_DISCOUNT
 = 
_lše™em
.L_DISCOUNT/100.0;

186 #w¬nšg 
MA
: 
DiscouÁ
 
äom
 
TPCH
 
dbg’
 
is
 
ü—‹d
 
b‘w“n
 0 
ªd
 100 
š¡—d
 between 0‡nd 1.

187 
	}
}

189 
q6_tsÿn_f‹r_t
* 
	$şÚe
() const {

190  
Ãw
 
	`q6_tsÿn_f‹r_t
(*
this
);

191 
	}
}

193 
c_¡r
 
	$to_¡ršg
() const {

194 
d©e
[15];

195 
	`tim‘_to_¡r
(
d©e
,
q6_šput
->
l_shd©e
);

196  
	`c_¡r
("q6_tsÿn_f‹r_t(%s, %lf, %lf)", 
d©e
, 
q6_šput
->
l_discouÁ
, q6_šput->
l_quªt™y
);

197 
	}
}

205 şas 
	cq6_s›ve_t
 : 
public
 
tu¶e_s›ve_t
 {

207 
public
:

209 
	$q6_s›ve_t
()

210 : 
	`tu¶e_s›ve_t
((
q6_muÉl›d_lše™em_tu¶e
))

214 
vœtu®
 
boŞ
 
	$·ss
(
tu¶e_t
& 
de¡
, cÚ¡u¶e_ˆ&
¤c
) {

215 * 
š
 = 
®igÃd_ÿ¡
<>(
¤c
.
d©a
);

216 * 
out
 = 
®igÃd_ÿ¡
<>(
de¡
.
d©a
);

217 *
out
 = 
š
[0] * in[1];

218  
Œue
;

219 
	}
}

221 
vœtu®
 
tu¶e_s›ve_t
* 
	$şÚe
() const {

222  
Ãw
 
	`q6_s›ve_t
(*
this
);

223 
	}
}

225 
vœtu®
 
c_¡r
 
	$to_¡ršg
() const {

227 
	}
}

232 şas 
	cq6_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

234 
public
:

236 şas 
	cq6_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

237 
public
:

238 
q6_key_exŒaùÜ_t
()

239 : 
key_exŒaùÜ_t
(0, 0)

243 
vœtu®
 
exŒaù_hšt
(const *) const {

245 
uÄ—chabË
();

249 
vœtu®
 
key_exŒaùÜ_t
* 
şÚe
() const {

250  
Ãw
 
q6_key_exŒaùÜ_t
(*
this
);

254 
	g´iv©e
:

256 
q6_key_exŒaùÜ_t
 
_exŒaùÜ
;

258 
	gpublic
:

260 
	$q6_agg»g©e_t
()

261 : 
	`tu¶e_agg»g©e_t
((
q6_agg»g©e_tu¶e
)),

262 
	$_exŒaùÜ
()

264 
	}
}

266 
vœtu®
 
key_exŒaùÜ_t
* 
	$key_exŒaùÜ
(è{  &
_exŒaùÜ
; 
	}
}

268 
vœtu®
 
	$agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
& 
¤c
) {

269 
q6_agg»g©e_tu¶e
* 
agg
 = 
®igÃd_ÿ¡
<q6_agg»g©e_tu¶e>(
agg_d©a
);

270 * 
d
 = 
®igÃd_ÿ¡
<>(
¤c
.
d©a
);

271 
agg
->
L_COUNT
++;

272 
agg
->
L_SUM_REVENUE
 +ğ*
d
;

273 
	}
}

275 
vœtu®
 
	$fšish
(
tu¶e_t
 &
de¡
, cÚ¡ * 
agg_d©a
) {

276 
q6_agg»g©e_tu¶e
* 
agg
 = 
®igÃd_ÿ¡
<q6_agg»g©e_tu¶e>(
agg_d©a
);

277 
q6_agg»g©e_tu¶e
* 
ouut
 = 
®igÃd_ÿ¡
<q6_agg»g©e_tu¶e>(
de¡
.
d©a
);

278 
ouut
->
L_COUNT
 = 
agg
->L_COUNT;

279 
ouut
->
L_SUM_REVENUE
 = 
agg
->L_SUM_REVENUE;

281 
	}
}

283 
vœtu®
 
q6_agg»g©e_t
* 
	$şÚe
() const {

284  
Ãw
 
	`q6_agg»g©e_t
(*
this
);

285 
	}
}

287 
vœtu®
 
c_¡r
 
	$to_¡ršg
() const {

289 
	}
}

295 şas 
	cch_q6_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


297 
public
:

299 
	$begš
() {

300 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q6 ANSWER ...\n");

301 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** SUM_REVENUE(EXTPRICE*DISCOUNT)...\n");

304 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

305 
q6_agg»g©e_tu¶e
 *
tu¶e
;

306 
tu¶e
 = 
®igÃd_ÿ¡
<
q6_agg»g©e_tu¶e
>(
ouut
.
d©a
);

307 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** %.2f\n",

308 
tu¶e
->
L_SUM_REVENUE
);

309 
	}
}

320 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_q6
(cÚ¡ 
xù_id
,

321 
q6_šput_t
& 
š
)

323 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** Q6 *********\n");

343 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

344 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

349 #ifdeà
USE_ECHO


350 
tu¶e_fifo
* 
tsÿn_ouut
 = 
Ãw
 
	`tu¶e_fifo
(
_¶še™em_desc
.
	`g‘
()->
	`maxsize
());

352 
tu¶e_fifo
* 
tsÿn_ouut
 = 
Ãw
 
	`tu¶e_fifo
((
q6_´ojeùed_lše™em_tu¶e
));

355 
tsÿn_·ck‘_t
 *
q6_tsÿn_·ck‘
 =

356 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN LINEITEM",

357 
tsÿn_ouut
,

358 #ifdeà
USE_ECHO


359 
Ãw
 
	`ŒivŸl_f‹r_t
(
tsÿn_ouut
->
	`tu¶e_size
()),

361 
Ãw
 
	`q6_tsÿn_f‹r_t
(
this
, 
š
),

363 
this
->
	`db
(),

364 
_¶še™em_desc
.
	`g‘
(),

365 
pxù


371 #ifdeà
USE_ECHO


372 
tu¶e_fifo
* 
echo_ouut
 = 
Ãw
 
	`tu¶e_fifo
((
q6_´ojeùed_lše™em_tu¶e
));

373 
echo_·ck‘_t
 *
q6_echo_·ck‘
 =

374 
Ãw
 
	`echo_·ck‘_t
("Q6PIPE_ECHO_PACKET",

375 
echo_ouut
,

376 
Ãw
 
	`q6_tsÿn_f‹r_t
(
this
, 
š
),

377 
q6_tsÿn_·ck‘
);

381 
tu¶e_fifo
* 
s›ve_ouut
 = 
Ãw
 
	`tu¶e_fifo
((
q6_muÉl›d_lše™em_tu¶e
));

382 
s›ve_·ck‘_t
 *
q6_s›ve_·ck‘
 =

383 
Ãw
 
	`s›ve_·ck‘_t
("Q6PIPE_SIEVE_PACKET",

384 
s›ve_ouut
,

385 
Ãw
 
	`ŒivŸl_f‹r_t
(
s›ve_ouut
->
	`tu¶e_size
()),

386 
Ãw
 
	`q6_s›ve_t
(),

387 #ifdeà
USE_ECHO


388 
q6_echo_·ck‘
);

390 
q6_tsÿn_·ck‘
);

395 
tu¶e_fifo
* 
agg_ouut
 = 
Ãw
 
	`tu¶e_fifo
((
q6_agg»g©e_tu¶e
));

396 
agg»g©e_·ck‘_t
* 
q6_agg_·ck‘
 =

397 
Ãw
 
	`agg»g©e_·ck‘_t
(
	`c_¡r
("Q6PIPE_AGGREGATE_PACKET"),

398 
agg_ouut
,

399 
Ãw
 
	`ŒivŸl_f‹r_t
(
agg_ouut
->
	`tu¶e_size
()),

400 
Ãw
 
	`q6_agg»g©e_t
(),

401 
Ãw
 
q6_agg»g©e_t
::
	`q6_key_exŒaùÜ_t
(),

402 
q6_s›ve_·ck‘
);

404 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

405 
q6_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

406 
q6_s›ve_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

407 #ifdeà
USE_ECHO


408 
q6_echo_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

410 
q6_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

412 
ch_q6_´oûss_tu¶e_t
 
±
;

413 
	`´oûss_qu”y
(
q6_agg_·ck‘
, 
±
);

414 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

421  (
RCOK
);

422 
	}
}

425 
EXIT_NAMESPACE
(
qpe
);

	@src/workload/tpch/qpipe/qpipe_q7.cpp

33 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

34 
	~"wÜklßd/ch/ch_ut.h
"

35 
	~"qpe.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
usšg
 
Çme¥aû
 
	gqpe
;

42 
ENTER_NAMESPACE
(
ch
);

92 
	sq7_´ojeùed_ÇtiÚ_tu¶e
 {

93 
	mN_NATIONKEY
;

94 
	mN_NAME
[
STRSIZE
(25)];

97 
	sq7_´ojeùed_cu¡om”_tu¶e
 {

98 
	mC_CUSTKEY
;

99 
	mC_NATIONKEY
;

102 
	sq7_´ojeùed_Üd”s_tu¶e
 {

103 
	mO_ORDERKEY
;

104 
	mO_CUSTKEY
;

107 
	sq7_´ojeùed_lše™em_tu¶e
 {

108 
	mL_ORDERKEY
;

109 
	mL_SUPPKEY
;

110 
	mL_YEAR
;

111 
decim®
 
	mL_EXTENDEDPRICE
;

112 
decim®
 
	mL_DISCOUNT
;

115 
	sq7_´ojeùed_suµl›r_tu¶e
 {

116 
	mS_SUPPKEY
;

117 
	mS_NATIONKEY
;

121 
	sq7_c_još_n2_tu¶e
 {

122 
	mC_CUSTKEY
;

123 
	mCUST_NATION
[
STRSIZE
(25)];

126 
	sq7_o_još_c_n2_tu¶e
 {

127 
	mO_ORDERKEY
;

128 
	mCUST_NATION
[
STRSIZE
(25)];

131 
	sq7_l_još_o_c_n2_tu¶e
 {

132 
	mL_SUPPKEY
;

133 
	mCUST_NATION
[
STRSIZE
(25)];

134 
	mL_YEAR
;

135 
decim®
 
	mL_EXTENDEDPRICE
;

136 
decim®
 
	mL_DISCOUNT
;

139 
	sq7_l_o_c_n2_još_s_tu¶e
 {

140 
	mS_NATIONKEY
;

141 
	mCUST_NATION
[
STRSIZE
(25)];

142 
	mL_YEAR
;

143 
decim®
 
	mL_EXTENDEDPRICE
;

144 
decim®
 
	mL_DISCOUNT
;

147 
	sq7_‹mp_agg_key
 {

148 
	mS_NATIONKEY
;

149 
	mCUST_NATION
[
STRSIZE
(25)];

150 
	mL_YEAR
;

153 
	sq7_‹mp_agg»g©e_tu¶e
 {

154 
	mS_NATIONKEY
;

155 
	mCUST_NATION
[
STRSIZE
(25)];

156 
	mL_YEAR
;

157 
decim®
 
	mVOLUME
;

160 
	sq7_fš®_tu¶e
 {

161 
	mSUPP_NATION
[
STRSIZE
(25)];

162 
	mCUST_NATION
[
STRSIZE
(25)];

163 
	mL_YEAR
;

164 
decim®
 
	mREVENUE
;

168 şas 
	cq7_ÇtiÚ_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


170 
´iv©e
:

171 
ShÜeTPCHEnv
* 
_chdb
;

172 
bË_row_t
* 
	m_´ÇtiÚ
;

173 
»p_row_t
 
	m_¼
;

176 
ch_ÇtiÚ_tu¶e
 
	m_ÇtiÚ
;

178 
	m_Çme1
[
STRSIZE
(25)];

179 
	m_Çme2
[
STRSIZE
(25)];

180 
q7_šput_t
* 
	mq7_šput
;

182 
	mpublic
:

183 
	$q7_ÇtiÚ_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q7_šput_t
 &
š
)

184 : 
	`tu¶e_f‹r_t
(
chdb
->
	`ÇtiÚ_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

186 
_´ÇtiÚ
 = 
_chdb
->
	`ÇtiÚ_mª
()->
	`g‘_tu¶e
();

187 
_¼
.
	`£t_ts
(
_chdb
->
	`ÇtiÚ_mª
()->
	`ts
(),

188 
_chdb
->
	`ÇtiÚ_desc
()->
	`maxsize
());

189 
_´ÇtiÚ
->
_»p
 = &
_¼
;

191 
q7_šput
 = &
š
;

192 
	`ÇtiÚ_to_¡r
(
q7_šput
->
n_Çme1
, 
_Çme1
);

193 
	`ÇtiÚ_to_¡r
(
q7_šput
->
n_Çme2
, 
_Çme2
);

195 
	`TRACE
(
TRACE_ALWAYS
, "Rªdom P»diÿ‹s:\nNATION.N_NAME = '%s' o¸NATION.N_NAME = '%s'\n", 
_Çme1
, 
_Çme2
);

198 
vœtu®
 ~
	$q7_ÇtiÚ_tsÿn_f‹r_t
()

200 
_chdb
->
	`ÇtiÚ_mª
()->
	`give_tu¶e
(
_´ÇtiÚ
);

201 
	}
}

203 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

206 ià(!
_chdb
->
	`ÇtiÚ_mª
()->
	`lßd
(
_´ÇtiÚ
, 
šput
.
d©a
)) {

207 
	`as£¹
(
çl£
);

210 
_´ÇtiÚ
->
	`g‘_v®ue
(1, 
_ÇtiÚ
.
N_NAME
, 25);

212  (
	`¡rcmp
(
_ÇtiÚ
.
N_NAME
, 
_Çme1
è=ğ0 || sŒcmp(_ÇtiÚ.N_NAME, 
_Çme2
) == 0);

213 
	}
}

216 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

218 
q7_´ojeùed_ÇtiÚ_tu¶e
 *
de¡
;

219 
de¡
 = 
®igÃd_ÿ¡
<
q7_´ojeùed_ÇtiÚ_tu¶e
>(
d
.
d©a
);

221 
_´ÇtiÚ
->
	`g‘_v®ue
(0, 
_ÇtiÚ
.
N_NATIONKEY
);

222 
_´ÇtiÚ
->
	`g‘_v®ue
(1, 
_ÇtiÚ
.
N_NAME
, 25);

227 
de¡
->
N_NATIONKEY
 = 
_ÇtiÚ
.N_NATIONKEY;

228 
	`memıy
(
de¡
->
N_NAME
, 
_ÇtiÚ
.N_NAME, (dest->N_NAME));

229 
	}
}

231 
q7_ÇtiÚ_tsÿn_f‹r_t
* 
	$şÚe
() const {

232  
Ãw
 
	`q7_ÇtiÚ_tsÿn_f‹r_t
(*
this
);

233 
	}
}

235 
c_¡r
 
	$to_¡ršg
() const {

236  
	`c_¡r
("q7_ÇtiÚ_tsÿn_f‹r_t(% Ü %s)", 
_Çme1
, 
_Çme2
);

237 
	}
}

240 şas 
	cq7_cu¡om”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


242 
´iv©e
:

243 
ShÜeTPCHEnv
* 
_chdb
;

244 
bË_row_t
* 
	m_´cu¡
;

245 
»p_row_t
 
	m_¼
;

247 
ch_cu¡om”_tu¶e
 
	m_cu¡om”
;

249 
	mpublic
:

250 
	$q7_cu¡om”_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q7_šput_t
 &
š
)

251 : 
	`tu¶e_f‹r_t
(
chdb
->
	`cu¡om”_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

253 
_´cu¡
 = 
_chdb
->
	`cu¡om”_mª
()->
	`g‘_tu¶e
();

254 
_¼
.
	`£t_ts
(
_chdb
->
	`cu¡om”_mª
()->
	`ts
(),

255 
_chdb
->
	`cu¡om”_desc
()->
	`maxsize
());

256 
_´cu¡
->
_»p
 = &
_¼
;

259 
vœtu®
 ~
	$q7_cu¡om”_tsÿn_f‹r_t
()

262 
_chdb
->
	`cu¡om”_mª
()->
	`give_tu¶e
(
_´cu¡
);

263 
	}
}

265 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

267 ià(!
_chdb
->
	`cu¡om”_mª
()->
	`lßd
(
_´cu¡
, 
šput
.
d©a
)) {

268 
	`as£¹
(
çl£
);

271  
Œue
;

272 
	}
}

274 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

276 
q7_´ojeùed_cu¡om”_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q7_´ojeùed_cu¡om”_tu¶e>(
d
.
d©a
);

278 
_´cu¡
->
	`g‘_v®ue
(0, 
_cu¡om”
.
C_CUSTKEY
);

279 
_´cu¡
->
	`g‘_v®ue
(3, 
_cu¡om”
.
C_NATIONKEY
);

283 
de¡
->
C_CUSTKEY
 = 
_cu¡om”
.C_CUSTKEY;

284 
de¡
->
C_NATIONKEY
 = 
_cu¡om”
.C_NATIONKEY;

285 
	}
}

287 
vœtu®
 
q7_cu¡om”_tsÿn_f‹r_t
* 
	$şÚe
() const {

288  
Ãw
 
	`q7_cu¡om”_tsÿn_f‹r_t
(*
this
);

289 
	}
}

291 
vœtu®
 
c_¡r
 
	$to_¡ršg
() const {

292  
	`c_¡r
("q7_customer_tscan_filter_t");

293 
	}
}

296 şas 
	cq7_Üd”s_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


298 
´iv©e
:

299 
ShÜeTPCHEnv
* 
_chdb
;

300 
bË_row_t
* 
	m_´Üd”s
;

301 
»p_row_t
 
	m_¼
;

303 
ch_Üd”s_tu¶e
 
	m_Üd”s
;

305 
	mpublic
:

306 
	$q7_Üd”s_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q7_šput_t
 &
š
)

307 : 
	`tu¶e_f‹r_t
(
chdb
->
	`Üd”s_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

309 
_´Üd”s
 = 
_chdb
->
	`Üd”s_mª
()->
	`g‘_tu¶e
();

310 
_¼
.
	`£t_ts
(
_chdb
->
	`Üd”s_mª
()->
	`ts
(),

311 
_chdb
->
	`Üd”s_desc
()->
	`maxsize
());

312 
_´Üd”s
->
_»p
 = &
_¼
;

315 
vœtu®
 ~
	$q7_Üd”s_tsÿn_f‹r_t
()

318 
_chdb
->
	`Üd”s_mª
()->
	`give_tu¶e
(
_´Üd”s
);

319 
	}
}

321 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

323 ià(!
_chdb
->
	`Üd”s_mª
()->
	`lßd
(
_´Üd”s
, 
šput
.
d©a
)) {

324 
	`as£¹
(
çl£
);

327  
Œue
;

328 
	}
}

330 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

332 
q7_´ojeùed_Üd”s_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q7_´ojeùed_Üd”s_tu¶e>(
d
.
d©a
);

334 
_´Üd”s
->
	`g‘_v®ue
(0, 
_Üd”s
.
O_ORDERKEY
);

335 
_´Üd”s
->
	`g‘_v®ue
(1, 
_Üd”s
.
O_CUSTKEY
);

339 
de¡
->
O_ORDERKEY
 = 
_Üd”s
.O_ORDERKEY;

340 
de¡
->
O_CUSTKEY
 = 
_Üd”s
.O_CUSTKEY;

341 
	}
}

343 
q7_Üd”s_tsÿn_f‹r_t
* 
	$şÚe
() const {

344  
Ãw
 
	`q7_Üd”s_tsÿn_f‹r_t
(*
this
);

345 
	}
}

347 
c_¡r
 
	$to_¡ršg
() const {

348  
	`c_¡r
("q7_orders_tscan_filter_t");

349 
	}
}

352 şas 
	cq7_lše™em_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


354 
´iv©e
:

355 
ShÜeTPCHEnv
* 
_chdb
;

356 
bË_row_t
* 
	m_´lše
;

357 
»p_row_t
 
	m_¼
;

359 
ch_lše™em_tu¶e
 
	m_lše™em
;

360 
time_t
 
	m_shd©e
;

362 
time_t
 
	m_fœ¡d©e
;

363 
time_t
 
	m_Ï¡d©e
;

365 
	mpublic
:

366 
	$q7_lše™em_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q7_šput_t
 &
š
)

367 : 
	`tu¶e_f‹r_t
(
chdb
->
	`lše™em_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

369 
_´lše
 = 
_chdb
->
	`lše™em_mª
()->
	`g‘_tu¶e
();

370 
_¼
.
	`£t_ts
(
_chdb
->
	`lše™em_mª
()->
	`ts
(),

371 
_chdb
->
	`lše™em_desc
()->
	`maxsize
());

372 
_´lše
->
_»p
 = &
_¼
;

374 
_fœ¡d©e
 = 
	`¡r_to_tim‘
("1995-01-01");

375 
_Ï¡d©e
 = 
	`¡r_to_tim‘
("1996-12-31");

378 
vœtu®
 ~
	$q7_lše™em_tsÿn_f‹r_t
()

381 
_chdb
->
	`lše™em_mª
()->
	`give_tu¶e
(
_´lše
);

382 
	}
}

384 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

386 ià(!
_chdb
->
	`lše™em_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

387 
	`as£¹
(
çl£
);

390 
_´lše
->
	`g‘_v®ue
(10, 
_lše™em
.
L_SHIPDATE
, 15);

391 
_shd©e
 = 
	`¡r_to_tim‘
(
_lše™em
.
L_SHIPDATE
);

393  (
_shd©e
 >ğ
_fœ¡d©e
 && _shd©<ğ
_Ï¡d©e
);

394 
	}
}

396 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

398 
q7_´ojeùed_lše™em_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q7_´ojeùed_lše™em_tu¶e>(
d
.
d©a
);

400 
_´lše
->
	`g‘_v®ue
(0, 
_lše™em
.
L_ORDERKEY
);

401 
_´lše
->
	`g‘_v®ue
(2, 
_lše™em
.
L_SUPPKEY
);

402 
_´lše
->
	`g‘_v®ue
(5, 
_lše™em
.
L_EXTENDEDPRICE
);

403 
_´lše
->
	`g‘_v®ue
(6, 
_lše™em
.
L_DISCOUNT
);

404 
_´lše
->
	`g‘_v®ue
(10, 
_lše™em
.
L_SHIPDATE
, 15);

405 
_shd©e
 = 
	`¡r_to_tim‘
(
_lše™em
.
L_SHIPDATE
);

406 
tm
 *
tm_shd©e
 = 
	`gmtime
(&
_shd©e
);

411 
de¡
->
L_ORDERKEY
 = 
_lše™em
.L_ORDERKEY;

412 
de¡
->
L_SUPPKEY
 = 
_lše™em
.L_SUPPKEY;

413 
de¡
->
L_EXTENDEDPRICE
 = 
_lše™em
.L_EXTENDEDPRICE / 100.0;

414 #w¬nšg 
MA
: 
DiscouÁ
 
äom
 
TPCH
 
dbg’
 
is
 
ü—‹d
 
b‘w“n
 0 
ªd
 100 
š¡—d
 between 0‡nd 1.

415 
de¡
->
L_DISCOUNT
 = 
_lše™em
.L_DISCOUNT / 100.0;

416 
de¡
->
L_YEAR
 = 
tm_shd©e
->
tm_y—r
 + 1900;

421 
	}
}

423 
q7_lše™em_tsÿn_f‹r_t
* 
	$şÚe
() const {

424  
Ãw
 
	`q7_lše™em_tsÿn_f‹r_t
(*
this
);

425 
	}
}

427 
c_¡r
 
	$to_¡ršg
() const {

428  
	`c_¡r
("q7_lše™em_tsÿn_f‹r_t(b‘w“n(%s, %s))", 
	`ùime
(&(
_fœ¡d©e
)), ctime(&(
_Ï¡d©e
)));

429 
	}
}

432 şas 
	cq7_suµl›r_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


434 
´iv©e
:

435 
ShÜeTPCHEnv
* 
_chdb
;

436 
bË_row_t
* 
	m_´suµl›r
;

437 
»p_row_t
 
	m_¼
;

440 
ch_suµl›r_tu¶e
 
	m_suµl›r
;

442 
	mpublic
:

443 
	$q7_suµl›r_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q7_šput_t
 &
š
)

444 : 
	`tu¶e_f‹r_t
(
chdb
->
	`suµl›r_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

446 
_´suµl›r
 = 
_chdb
->
	`suµl›r_mª
()->
	`g‘_tu¶e
();

447 
_¼
.
	`£t_ts
(
_chdb
->
	`suµl›r_mª
()->
	`ts
(),

448 
_chdb
->
	`suµl›r_desc
()->
	`maxsize
());

449 
_´suµl›r
->
_»p
 = &
_¼
;

452 
vœtu®
 ~
	$q7_suµl›r_tsÿn_f‹r_t
()

454 
_chdb
->
	`suµl›r_mª
()->
	`give_tu¶e
(
_´suµl›r
);

455 
	}
}

457 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

460 ià(!
_chdb
->
	`suµl›r_mª
()->
	`lßd
(
_´suµl›r
, 
šput
.
d©a
)) {

461 
	`as£¹
(
çl£
);

464  
Œue
;

465 
	}
}

468 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

470 
q7_´ojeùed_suµl›r_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q7_´ojeùed_suµl›r_tu¶e>(
d
.
d©a
);

473 
_´suµl›r
->
	`g‘_v®ue
(0, 
_suµl›r
.
S_SUPPKEY
);

474 
_´suµl›r
->
	`g‘_v®ue
(3, 
_suµl›r
.
S_NATIONKEY
);

479 
de¡
->
S_SUPPKEY
 = 
_suµl›r
.S_SUPPKEY;

480 
de¡
->
S_NATIONKEY
 = 
_suµl›r
.S_NATIONKEY;

482 
	}
}

484 
q7_suµl›r_tsÿn_f‹r_t
* 
	$şÚe
() const {

485  
Ãw
 
	`q7_suµl›r_tsÿn_f‹r_t
(*
this
);

486 
	}
}

488 
c_¡r
 
	$to_¡ršg
() const {

489  
	`c_¡r
("q7_supplier_tscan_filter_t");

490 
	}
}

494 
	gq7_c_još_n2_t
 : 
public
 
tu¶e_još_t
 {

496 
q7_c_još_n2_t
()

497 : 
tu¶e_još_t
((
q7_´ojeùed_cu¡om”_tu¶e
),

498 
off£tof
(
q7_´ojeùed_cu¡om”_tu¶e
, 
C_NATIONKEY
),

499 (
q7_´ojeùed_ÇtiÚ_tu¶e
),

500 
off£tof
(
q7_´ojeùed_ÇtiÚ_tu¶e
, 
N_NATIONKEY
),

502 (
q7_c_još_n2_tu¶e
))

506 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

507 
q7_c_još_n2_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q7_c_još_n2_tu¶e>(
d
.
d©a
);

508 
q7_´ojeùed_cu¡om”_tu¶e
 *
	gcu¡
 = 
®igÃd_ÿ¡
<q7_´ojeùed_cu¡om”_tu¶e>(
l
.
d©a
);

509 
q7_´ojeùed_ÇtiÚ_tu¶e
 *
	gÇtiÚ
 = 
®igÃd_ÿ¡
<q7_´ojeùed_ÇtiÚ_tu¶e>(
r
.
d©a
);

511 
	gde¡
->
	gC_CUSTKEY
 = 
cu¡
->
C_CUSTKEY
;

512 
memıy
(
de¡
->
CUST_NATION
, 
ÇtiÚ
->
N_NAME
, (dest->CUST_NATION));

517 
vœtu®
 
q7_c_još_n2_t
* 
şÚe
() const {

518  
Ãw
 
q7_c_još_n2_t
(*
this
);

521 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

522  
c_¡r
("JOIN CUSTOMER, NATION‚2; select C_CUSTKEY,‚2.N_NAME‡s CUST_NAME");

526 
	gq7_o_još_c_n2_t
 : 
public
 
tu¶e_još_t
 {

528 
q7_o_još_c_n2_t
()

529 : 
tu¶e_još_t
((
q7_´ojeùed_Üd”s_tu¶e
),

530 
off£tof
(
q7_´ojeùed_Üd”s_tu¶e
, 
O_CUSTKEY
),

531 (
q7_c_još_n2_tu¶e
),

532 
off£tof
(
q7_c_još_n2_tu¶e
, 
C_CUSTKEY
),

534 (
q7_o_još_c_n2_tu¶e
))

538 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

539 
q7_o_još_c_n2_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q7_o_još_c_n2_tu¶e>(
d
.
d©a
);

540 
q7_´ojeùed_Üd”s_tu¶e
 *
	gÜd”s
 = 
®igÃd_ÿ¡
<q7_´ojeùed_Üd”s_tu¶e>(
l
.
d©a
);

541 
q7_c_još_n2_tu¶e
 *
	gright
 = 
®igÃd_ÿ¡
<q7_c_još_n2_tu¶e>(
r
.
d©a
);

543 
	gde¡
->
	gO_ORDERKEY
 = 
Üd”s
->
O_ORDERKEY
;

544 
memıy
(
de¡
->
CUST_NATION
, 
right
->CUST_NATION, (dest->CUST_NATION));

549 
vœtu®
 
q7_o_još_c_n2_t
* 
şÚe
() const {

550  
Ãw
 
q7_o_još_c_n2_t
(*
this
);

553 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

554  
c_¡r
("JOIN ORDERS, CUSTOMER_NATION; select O_ORDERKEY, CUST_NAME");

558 
	gq7_l_još_o_c_n2_t
 : 
public
 
tu¶e_još_t
 {

560 
q7_l_još_o_c_n2_t
()

561 : 
tu¶e_još_t
((
q7_´ojeùed_lše™em_tu¶e
),

562 
off£tof
(
q7_´ojeùed_lše™em_tu¶e
, 
L_ORDERKEY
),

563 (
q7_o_još_c_n2_tu¶e
),

564 
off£tof
(
q7_o_još_c_n2_tu¶e
, 
O_ORDERKEY
),

566 (
q7_l_još_o_c_n2_tu¶e
))

570 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

571 
q7_l_još_o_c_n2_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q7_l_još_o_c_n2_tu¶e>(
d
.
d©a
);

572 
q7_´ojeùed_lše™em_tu¶e
 *
	glše
 = 
®igÃd_ÿ¡
<q7_´ojeùed_lše™em_tu¶e>(
l
.
d©a
);

573 
q7_o_još_c_n2_tu¶e
 *
	gright
 = 
®igÃd_ÿ¡
<q7_o_još_c_n2_tu¶e>(
r
.
d©a
);

575 
	gde¡
->
	gL_SUPPKEY
 = 
lše
->
L_SUPPKEY
;

576 
memıy
(
de¡
->
CUST_NATION
, 
right
->CUST_NATION, (dest->CUST_NATION));

577 
	gde¡
->
	gL_EXTENDEDPRICE
 = 
lše
->
L_EXTENDEDPRICE
;

578 
	gde¡
->
	gL_DISCOUNT
 = 
lše
->
L_DISCOUNT
;

579 
	gde¡
->
	gL_YEAR
 = 
lše
->
L_YEAR
;

585 
vœtu®
 
q7_l_još_o_c_n2_t
* 
şÚe
() const {

586  
Ãw
 
q7_l_još_o_c_n2_t
(*
this
);

589 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

594 
	gq7_l_o_c_n2_još_s_t
 : 
public
 
tu¶e_još_t
 {

596 
q7_l_o_c_n2_još_s_t
()

597 : 
tu¶e_još_t
((
q7_l_još_o_c_n2_tu¶e
),

598 
off£tof
(
q7_l_još_o_c_n2_tu¶e
, 
L_SUPPKEY
),

599 (
q7_´ojeùed_suµl›r_tu¶e
),

600 
off£tof
(
q7_´ojeùed_suµl›r_tu¶e
, 
S_SUPPKEY
),

602 (
q7_l_o_c_n2_još_s_tu¶e
))

606 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

607 
q7_l_o_c_n2_još_s_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q7_l_o_c_n2_još_s_tu¶e>(
d
.
d©a
);

608 
q7_l_još_o_c_n2_tu¶e
 *
	gËá
 = 
®igÃd_ÿ¡
<q7_l_još_o_c_n2_tu¶e>(
l
.
d©a
);

609 
q7_´ojeùed_suµl›r_tu¶e
 *
	gsuµl›r
 = 
®igÃd_ÿ¡
<q7_´ojeùed_suµl›r_tu¶e>(
r
.
d©a
);

611 
	gde¡
->
	gS_NATIONKEY
 = 
suµl›r
->
S_NATIONKEY
;

612 
memıy
(
de¡
->
CUST_NATION
, 
Ëá
->CUST_NATION, (dest->CUST_NATION));

613 
	gde¡
->
	gL_EXTENDEDPRICE
 = 
Ëá
->
L_EXTENDEDPRICE
;

614 
	gde¡
->
	gL_DISCOUNT
 = 
Ëá
->
L_DISCOUNT
;

615 
	gde¡
->
	gL_YEAR
 = 
Ëá
->
L_YEAR
;

621 
vœtu®
 
q7_l_o_c_n2_još_s_t
* 
şÚe
() const {

622  
Ãw
 
q7_l_o_c_n2_još_s_t
(*
this
);

625 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

626  
c_¡r
("JOIN LINEITEM_ORDERS_CUSTOMER_NATION, SUPPLIER; select S_NATIONKEY, CUST_NATION, L_EXTENDEDPRICE, L_DISCOUNT, L_YEAR");

630 şas 
	cq7_‹mp_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

632 
´iv©e
:

634 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

636 
	mpublic
:

638 
	$q7_‹mp_agg»g©e_t
()

639 : 
	`tu¶e_agg»g©e_t
((
q7_‹mp_agg»g©e_tu¶e
)), 
	`_exŒaùÜ
(2 * (è+ 
	`STRSIZE
(25), 
	$off£tof
(
q7_‹mp_agg»g©e_tu¶e
, 
S_NATIONKEY
))

643 
vœtu®
 
key_exŒaùÜ_t
* 
	$key_exŒaùÜ
(è{ &
_exŒaùÜ
;
	}
}

645 
vœtu®
 
	$agg»g©e
(*
agg_d©a
, cÚ¡ 
tu¶e_t
 &
s
) {

646 
q7_‹mp_agg»g©e_tu¶e
 *
agg
 = 
®igÃd_ÿ¡
<q7_‹mp_agg»g©e_tu¶e>(
agg_d©a
);

647 
q7_l_o_c_n2_još_s_tu¶e
 *
¤c
 = 
®igÃd_ÿ¡
<q7_l_o_c_n2_još_s_tu¶e>(
s
.
d©a
);

649 
agg
->
VOLUME
 +ğ
¤c
->
L_EXTENDEDPRICE
 * (1 - src->
L_DISCOUNT
);

650 
	}
}

652 
vœtu®
 
	$fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

653 
	`memıy
(
d
.
d©a
, 
agg_d©a
, 
	`tu¶e_size
());

654 
	}
}

656 
vœtu®
 
q7_‹mp_agg»g©e_t
* 
	$şÚe
() const {

657  
Ãw
 
	`q7_‹mp_agg»g©e_t
(*
this
);

658 
	}
}

660 
vœtu®
 
c_¡r
 
	$to_¡ršg
() const {

661  
	`c_¡r
("q7_temp_aggregate_t");

662 
	}
}

665 
	gq7_fš®_još_t
 : 
public
 
tu¶e_još_t
 {

667 
q7_fš®_još_t
()

668 : 
tu¶e_još_t
((
q7_´ojeùed_ÇtiÚ_tu¶e
),

669 
off£tof
(
q7_´ojeùed_ÇtiÚ_tu¶e
, 
N_NATIONKEY
),

670 (
q7_‹mp_agg»g©e_tu¶e
),

671 
off£tof
(
q7_‹mp_agg»g©e_tu¶e
, 
S_NATIONKEY
),

673 (
q7_fš®_tu¶e
))

677 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

678 
q7_fš®_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q7_fš®_tu¶e>(
d
.
d©a
);

679 
q7_´ojeùed_ÇtiÚ_tu¶e
 *
	gÇtiÚ
 = 
®igÃd_ÿ¡
<q7_´ojeùed_ÇtiÚ_tu¶e>(
l
.
d©a
);

680 
q7_‹mp_agg»g©e_tu¶e
 *
	g‹mp
 = 
®igÃd_ÿ¡
<q7_‹mp_agg»g©e_tu¶e>(
r
.
d©a
);

682 
memıy
(
de¡
->
SUPP_NATION
, 
ÇtiÚ
->
N_NAME
, (dest->SUPP_NATION));

683 
memıy
(
de¡
->
CUST_NATION
, 
‹mp
->CUST_NATION, (dest->CUST_NATION));

684 
	gde¡
->
	gL_YEAR
 = 
‹mp
->
L_YEAR
;

685 
	gde¡
->
	gREVENUE
 = 
‹mp
->
VOLUME
;

690 
vœtu®
 
q7_fš®_još_t
* 
şÚe
() const {

691  
Ãw
 
q7_fš®_još_t
(*
this
);

694 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

695  
c_¡r
("JOIN NATION‚1, LINEITEM_ORDERS_CUSTOMER_NATION_SUPPLIER; select‚1.N_NAME‡s SUPP_NATION, CUST_NATION, L_YEAR, REVENUE");

699 
	gq7_još_ÇtiÚ_f‹r_t
 : 
public
 
tu¶e_f‹r_t
 {

701 
q7_još_ÇtiÚ_f‹r_t
()

702 : 
tu¶e_f‹r_t
((
q7_fš®_tu¶e
))

706 
boŞ
 
£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

707 
q7_fš®_tu¶e
 *
š
 = 
®igÃd_ÿ¡
<q7_fš®_tu¶e>(
šput
.
d©a
);

708  (
¡rcmp
(
š
->
CUST_NATION
, in->
SUPP_NATION
) != 0);

711 
vœtu®
 
q7_još_ÇtiÚ_f‹r_t
* 
şÚe
() const {

712  
Ãw
 
q7_još_ÇtiÚ_f‹r_t
(*
this
);

715 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

716  
c_¡r
("q7_join_nation_filter_t");

720 
	gq7_‹mp_agg_key_com·»_t
 : 
public
 
key_com·»_t
 {

722 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

723 
q7_‹mp_agg_key
 *
	gk1
 = 
®igÃd_ÿ¡
<q7_‹mp_agg_key>(
key1
);

724 
q7_‹mp_agg_key
 *
	gk2
 = 
®igÃd_ÿ¡
<q7_‹mp_agg_key>(
key2
);

725 
	gdiff_key
 = 
k1
->
S_NATIONKEY
 - 
k2
->S_NATIONKEY;

726 
	gdiff_Çme
 = 
¡rcmp
(
k1
->
CUST_NATION
, 
k2
->CUST_NATION);

727 
	gdiff_y—r
 = 
k1
->
L_YEAR
 - 
k2
->L_YEAR;

728  (
	gdiff_key
 !ğ0 ? 
diff_key
 : (
diff_Çme
 !ğ0 ? diff_Çm: 
diff_y—r
));

731 
vœtu®
 
q7_‹mp_agg_key_com·»_t
* 
şÚe
() const {

732  
Ãw
 
q7_‹mp_agg_key_com·»_t
(*
this
);

736 
	gq7_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

738 
q7_key_exŒaùÜ_t
()

739 : 
key_exŒaùÜ_t
((
q7_fš®_tu¶e
))

743 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

744 *
k
;

745 
	gk
 = 
®igÃd_ÿ¡
<>(
key
);

747 
	g»suÉ
 = (*
k
 << 24) + (*(k + ()) << 16) + (*(k + 2*()) << 8) + *(k + 3*());

749  
	g»suÉ
;

752 
vœtu®
 
q7_key_exŒaùÜ_t
* 
şÚe
() const {

753  
Ãw
 
q7_key_exŒaùÜ_t
(*
this
);

757 
	gq7_key_com·»_t
 : 
public
 
key_com·»_t
 {

759 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

760 
q7_fš®_tu¶e
* 
	gt1
 = 
®igÃd_ÿ¡
<q7_fš®_tu¶e>(
key1
);

761 
q7_fš®_tu¶e
* 
	gt2
 = 
®igÃd_ÿ¡
<q7_fš®_tu¶e>(
key2
);

762 
	gdiff_n1
 = 
¡rcmp
(
t1
->
SUPP_NATION
, 
t2
->SUPP_NATION);

763 
	gdiff_n2
 = 
¡rcmp
(
t1
->
CUST_NATION
, 
t2
->CUST_NATION);

764 
	gdiff_y—r
 = 
t1
->
L_YEAR
 - 
t2
->L_YEAR;

766  (
	gdiff_n1
 !ğ0 ? 
diff_n1
 : (
diff_n2
 !ğ0 ? diff_n2 : 
diff_y—r
));

769 
vœtu®
 
q7_key_com·»_t
* 
şÚe
() const {

770  
Ãw
 
q7_key_com·»_t
(*
this
);

774 şas 
	cch_q7_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t
 {

776 
public
:

778 
vœtu®
 
	$begš
() {

779 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q7 %25s %25s %25s %25s\n",

783 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

784 
q7_fš®_tu¶e
 *
»s
 = 
®igÃd_ÿ¡
<q7_fš®_tu¶e>(
ouut
.
d©a
);

786 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q7 %25s %25s %25d %25.2f\n",

787 
»s
->
SUPP_NATION
,„es->
CUST_NATION
,„es->
L_YEAR
,„es->
REVENUE
.
	`to_doubË
());

788 
	}
}

797 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_q7
(cÚ¡ 
xù_id
,

798 
q7_šput_t
& 
š
)

801 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** Q7 *********\n");

803 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

804 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

807 
tu¶e_fifo
* 
q7_ÇtiÚ_n2_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q7_´ojeùed_ÇtiÚ_tu¶e
));

808 
·ck‘_t
* 
q7_ÇtiÚ_n2_tsÿn_·ck‘
 =

809 
Ãw
 
	`tsÿn_·ck‘_t
("nation‚2 TSCAN",

810 
q7_ÇtiÚ_n2_bufãr
,

811 
Ãw
 
	`q7_ÇtiÚ_tsÿn_f‹r_t
(
this
, 
š
),

812 
this
->
	`db
(),

813 
_²©iÚ_desc
.
	`g‘
(),

814 
pxù
);

817 
tu¶e_fifo
* 
q7_cu¡om”_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q7_´ojeùed_cu¡om”_tu¶e
));

818 
·ck‘_t
* 
q7_cu¡om”_tsÿn_·ck‘
 =

819 
Ãw
 
	`tsÿn_·ck‘_t
("customer TSCAN",

820 
q7_cu¡om”_bufãr
,

821 
Ãw
 
	`q7_cu¡om”_tsÿn_f‹r_t
(
this
, 
š
),

822 
this
->
	`db
(),

823 
_pcu¡om”_desc
.
	`g‘
(),

824 
pxù
);

827 
tu¶e_fifo
* 
q7_c_još_n2_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q7_c_još_n2_tu¶e
));

828 
·ck‘_t
* 
q7_c_još_n2_·ck‘
 =

829 
Ãw
 
	`hash_još_·ck‘_t
("customer -‚ation(n2) HJOIN",

830 
q7_c_još_n2_bufãr
,

831 
Ãw
 
	`ŒivŸl_f‹r_t
((
q7_c_još_n2_tu¶e
)),

832 
q7_cu¡om”_tsÿn_·ck‘
,

833 
q7_ÇtiÚ_n2_tsÿn_·ck‘
,

834 
Ãw
 
	`q7_c_još_n2_t
());

837 
tu¶e_fifo
* 
q7_Üd”s_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q7_´ojeùed_Üd”s_tu¶e
));

838 
·ck‘_t
* 
q7_Üd”s_tsÿn_·ck‘
 =

839 
Ãw
 
	`tsÿn_·ck‘_t
("orders TSCAN",

840 
q7_Üd”s_bufãr
,

841 
Ãw
 
	`q7_Üd”s_tsÿn_f‹r_t
(
this
, 
š
),

842 
this
->
	`db
(),

843 
_pÜd”s_desc
.
	`g‘
(),

844 
pxù
);

847 
tu¶e_fifo
* 
q7_o_još_c_n2_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q7_o_još_c_n2_tu¶e
));

848 
·ck‘_t
* 
q7_o_još_c_n2_·ck‘
 =

849 
Ãw
 
	`hash_još_·ck‘_t
("orders - customer_nation HJOIN",

850 
q7_o_još_c_n2_bufãr
,

851 
Ãw
 
	`ŒivŸl_f‹r_t
((
q7_o_još_c_n2_tu¶e
)),

852 
q7_Üd”s_tsÿn_·ck‘
,

853 
q7_c_još_n2_·ck‘
,

854 
Ãw
 
	`q7_o_još_c_n2_t
());

857 
tu¶e_fifo
* 
q7_lše™em_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q7_´ojeùed_lše™em_tu¶e
));

858 
·ck‘_t
* 
q7_lše™em_tsÿn_·ck‘
 =

859 
Ãw
 
	`tsÿn_·ck‘_t
("lineitem TSCAN",

860 
q7_lše™em_bufãr
,

861 
Ãw
 
	`q7_lše™em_tsÿn_f‹r_t
(
this
, 
š
),

862 
this
->
	`db
(),

863 
_¶še™em_desc
.
	`g‘
(),

864 
pxù
);

867 
tu¶e_fifo
* 
q7_l_još_o_c_n2_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q7_l_još_o_c_n2_tu¶e
));

868 
·ck‘_t
* 
q7_l_još_o_c_n2_·ck‘
 =

869 
Ãw
 
	`hash_još_·ck‘_t
("lineitem - orders_customer_nation HJOIN",

870 
q7_l_još_o_c_n2_bufãr
,

871 
Ãw
 
	`ŒivŸl_f‹r_t
((
q7_l_još_o_c_n2_tu¶e
)),

872 
q7_lše™em_tsÿn_·ck‘
,

873 
q7_o_još_c_n2_·ck‘
,

874 
Ãw
 
	`q7_l_još_o_c_n2_t
());

877 
tu¶e_fifo
* 
q7_suµl›r_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q7_´ojeùed_suµl›r_tu¶e
));

878 
·ck‘_t
* 
q7_suµl›r_tsÿn_·ck‘
 =

879 
Ãw
 
	`tsÿn_·ck‘_t
("supplier TSCAN",

880 
q7_suµl›r_bufãr
,

881 
Ãw
 
	`q7_suµl›r_tsÿn_f‹r_t
(
this
, 
š
),

882 
this
->
	`db
(),

883 
_psuµl›r_desc
.
	`g‘
(),

884 
pxù
);

887 
tu¶e_fifo
* 
q7_l_o_c_n2_još_s_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q7_l_o_c_n2_još_s_tu¶e
));

888 
·ck‘_t
* 
q7_l_o_c_n2_još_s_·ck‘
 =

889 
Ãw
 
	`hash_još_·ck‘_t
("lineitem_orders_customer_nation - supplier HJOIN",

890 
q7_l_o_c_n2_još_s_bufãr
,

891 
Ãw
 
	`ŒivŸl_f‹r_t
((
q7_l_o_c_n2_još_s_tu¶e
)),

892 
q7_l_još_o_c_n2_·ck‘
,

893 
q7_suµl›r_tsÿn_·ck‘
,

894 
Ãw
 
	`q7_l_o_c_n2_još_s_t
());

897 
tu¶e_fifo
* 
q7_‹mp_agg»g©e_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q7_‹mp_agg»g©e_tu¶e
));

898 
·ck‘_t
* 
q7_‹mp_agg»g©e_·ck‘
 =

899 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("SUM AGG",

900 
q7_‹mp_agg»g©e_bufãr
,

901 
Ãw
 
	`ŒivŸl_f‹r_t
((
q7_‹mp_agg»g©e_tu¶e
)),

902 
q7_l_o_c_n2_još_s_·ck‘
,

903 
Ãw
 
	`q7_‹mp_agg»g©e_t
(),

904 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
(2*(è+ 
	`STRSIZE
(25è* (), 
	`off£tof
(
q7_l_o_c_n2_još_s_tu¶e
, 
S_NATIONKEY
)),

905 
Ãw
 
	`q7_‹mp_agg_key_com·»_t
());

908 
tu¶e_fifo
* 
q7_ÇtiÚ_n1_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q7_´ojeùed_ÇtiÚ_tu¶e
));

909 
·ck‘_t
* 
q7_ÇtiÚ_n1_tsÿn_·ck‘
 =

910 
Ãw
 
	`tsÿn_·ck‘_t
("nation‚1 TSCAN",

911 
q7_ÇtiÚ_n1_bufãr
,

912 
Ãw
 
	`q7_ÇtiÚ_tsÿn_f‹r_t
(
this
, 
š
),

913 
this
->
	`db
(),

914 
_²©iÚ_desc
.
	`g‘
(),

915 
pxù
);

918 
tu¶e_fifo
* 
q7_®l_još_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q7_fš®_tu¶e
));

919 
·ck‘_t
* 
q7_®l_još_·ck‘
 =

920 
Ãw
 
	`hash_još_·ck‘_t
("nation(n1) -†ineitem_orders_customer_nation_supplier HJOIN",

921 
q7_®l_još_bufãr
,

922 
Ãw
 
	`q7_još_ÇtiÚ_f‹r_t
(),

923 
q7_ÇtiÚ_n1_tsÿn_·ck‘
,

924 
q7_‹mp_agg»g©e_·ck‘
,

925 
Ãw
 
	`q7_fš®_još_t
());

928 
tu¶e_fifo
* 
q7_fš®_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q7_fš®_tu¶e
));

929 
·ck‘_t
* 
q7_sÜt_·ck‘
 =

930 
Ãw
 
	`sÜt_·ck‘_t
("SORT",

931 
q7_fš®_bufãr
,

932 
Ãw
 
	`ŒivŸl_f‹r_t
((
q7_fš®_tu¶e
)),

933 
Ãw
 
	`q7_key_exŒaùÜ_t
(),

934 
Ãw
 
	`q7_key_com·»_t
(),

935 
q7_®l_još_·ck‘
);

937 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

938 
q7_ÇtiÚ_n2_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

939 
q7_cu¡om”_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

940 
q7_c_još_n2_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

941 
q7_Üd”s_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

942 
q7_o_još_c_n2_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

943 
q7_lše™em_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

944 
q7_l_još_o_c_n2_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

945 
q7_suµl›r_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

946 
q7_l_o_c_n2_još_s_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

947 
q7_‹mp_agg»g©e_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

948 
q7_ÇtiÚ_n1_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

949 
q7_®l_još_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

950 
q7_sÜt_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

953 
ch_q7_´oûss_tu¶e_t
 
±
;

955 
	`´oûss_qu”y
(
q7_sÜt_·ck‘
, 
±
);

957 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

960 (
RCOK
);

961 
	}
}

963 
EXIT_NAMESPACE
(
ch
)

	@src/workload/tpch/qpipe/qpipe_q8.cpp

33 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

34 
	~"wÜklßd/ch/ch_ut.h
"

35 
	~"qpe.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
usšg
 
Çme¥aû
 
	gqpe
;

42 
ENTER_NAMESPACE
(
ch
);

92 
	sq8_´ojeùed_lše™em_tu¶e
 {

93 
	mL_PARTKEY
;

94 
	mL_ORDERKEY
;

95 
	mL_SUPPKEY
;

96 
decim®
 
	mVOLUME
;

99 
	sq8_´ojeùed_·¹_tu¶e
 {

100 
	mP_PARTKEY
;

103 
	sq8_´ojeùed_Üd”s_tu¶e
 {

104 
	mO_ORDERKEY
;

105 
	mO_CUSTKEY
;

106 
	mO_YEAR
;

109 
	sq8_´ojeùed_cu¡om”_tu¶e
 {

110 
	mC_CUSTKEY
;

111 
	mC_NATIONKEY
;

114 
	sq8_´ojeùed_ÇtiÚ_n1_tu¶e
 {

115 
	mN_NATIONKEY
;

116 
	mN_REGIONKEY
;

119 
	sq8_´ojeùed_»giÚ_tu¶e
 {

120 
	mR_REGIONKEY
;

123 
	sq8_´ojeùed_suµl›r_tu¶e
 {

124 
	mS_SUPPKEY
;

125 
	mS_NATIONKEY
;

128 
	sq8_´ojeùed_ÇtiÚ_n2_tu¶e
 {

129 
	mN_NATIONKEY
;

130 
	mN_NAME
[
STRSIZE
(25)];

133 
	sq8_l_još_p_tu¶e
 {

134 
	mL_ORDERKEY
;

135 
	mL_SUPPKEY
;

136 
decim®
 
	mVOLUME
;

139 
	sq8_o_još_l_p_tu¶e
 {

140 
	mO_CUSTKEY
;

141 
	mO_YEAR
;

142 
	mL_SUPPKEY
;

143 
decim®
 
	mVOLUME
;

146 
	sq8_c_još_o_l_p_tu¶e
 {

147 
	mC_NATIONKEY
;

148 
	mO_YEAR
;

149 
	mL_SUPPKEY
;

150 
decim®
 
	mVOLUME
;

153 
	sq8_c_o_l_p_još_n1_tu¶e
 {

154 
	mN_REGIONKEY
;

155 
	mO_YEAR
;

156 
	mL_SUPPKEY
;

157 
decim®
 
	mVOLUME
;

160 
	sq8_c_o_l_p_n1_još_r_tu¶e
 {

161 
	mO_YEAR
;

162 
	mL_SUPPKEY
;

163 
decim®
 
	mVOLUME
;

166 
	sq8_s_još_c_o_l_p_n1_r_tu¶e
 {

167 
	mS_NATIONKEY
;

168 
	mO_YEAR
;

169 
decim®
 
	mVOLUME
;

172 
	sq8_®l_jošs_tu¶e
 {

173 
	mO_YEAR
;

174 
decim®
 
	mVOLUME
;

175 
	mNATION
[
STRSIZE
(25)];

178 
	sq8_agg»g©e_tu¶e
 {

179 
	mO_YEAR
;

180 
decim®
 
	mSUM_VOLUME
;

181 
decim®
 
	mSUM_VOLUME_NATION
;

182 
	mMKT_SHARE
;

186 şas 
	cq8_lše™em_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


188 
´iv©e
:

189 
ShÜeTPCHEnv
* 
_chdb
;

190 
bË_row_t
* 
	m_´lše
;

191 
»p_row_t
 
	m_¼
;

193 
ch_lše™em_tu¶e
 
	m_lše™em
;

195 
	mpublic
:

196 
	$q8_lše™em_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q8_šput_t
 &
š
)

197 : 
	`tu¶e_f‹r_t
(
chdb
->
	`lše™em_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

199 
_´lše
 = 
_chdb
->
	`lše™em_mª
()->
	`g‘_tu¶e
();

200 
_¼
.
	`£t_ts
(
_chdb
->
	`lše™em_mª
()->
	`ts
(),

201 
_chdb
->
	`lše™em_desc
()->
	`maxsize
());

202 
_´lše
->
_»p
 = &
_¼
;

205 
vœtu®
 ~
	$q8_lše™em_tsÿn_f‹r_t
()

208 
_chdb
->
	`lše™em_mª
()->
	`give_tu¶e
(
_´lše
);

209 
	}
}

211 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

213 ià(!
_chdb
->
	`lše™em_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

214 
	`as£¹
(
çl£
);

217  
Œue
;

218 
	}
}

220 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

222 
q8_´ojeùed_lše™em_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q8_´ojeùed_lše™em_tu¶e>(
d
.
d©a
);

224 
_´lše
->
	`g‘_v®ue
(0, 
_lše™em
.
L_ORDERKEY
);

225 
_´lše
->
	`g‘_v®ue
(1, 
_lše™em
.
L_PARTKEY
);

226 
_´lše
->
	`g‘_v®ue
(2, 
_lše™em
.
L_SUPPKEY
);

227 
_´lše
->
	`g‘_v®ue
(5, 
_lše™em
.
L_EXTENDEDPRICE
);

228 
_´lše
->
	`g‘_v®ue
(6, 
_lše™em
.
L_DISCOUNT
);

232 
de¡
->
L_ORDERKEY
 = 
_lše™em
.L_ORDERKEY;

233 
de¡
->
L_PARTKEY
 = 
_lše™em
.L_PARTKEY;

234 
de¡
->
L_SUPPKEY
 = 
_lše™em
.L_SUPPKEY;

235 
de¡
->
VOLUME
 = 
_lše™em
.
L_EXTENDEDPRICE
 / 100.0 * (1 - _lše™em.
L_DISCOUNT
 / 100.0);

236 #w¬nšg 
MA
: 
DiscouÁ
 
äom
 
TPCH
 
dbg’
 
is
 
ü—‹d
 
b‘w“n
 0 
ªd
 100 
š¡—d
 between 0‡nd 1.

237 
	}
}

239 
q8_lše™em_tsÿn_f‹r_t
* 
	$şÚe
() const {

240  
Ãw
 
	`q8_lše™em_tsÿn_f‹r_t
(*
this
);

241 
	}
}

243 
c_¡r
 
	$to_¡ršg
() const {

244  
	`c_¡r
("q8_lineitem_tscan_filter_t()");

245 
	}
}

248 şas 
	cq8_·¹_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


250 
´iv©e
:

251 
ShÜeTPCHEnv
* 
_chdb
;

252 
bË_row_t
* 
	m_´·¹
;

253 
»p_row_t
 
	m_¼
;

256 
ch_·¹_tu¶e
 
	m_·¹
;

258 
	m_ty³
[
STRSIZE
(25)];

260 
q8_šput_t
* 
	mq8_šput
;

262 
	mpublic
:

264 
	$q8_·¹_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q8_šput_t
 &
š
)

265 : 
	`tu¶e_f‹r_t
(
chdb
->
	`·¹_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

267 
_´·¹
 = 
_chdb
->
	`·¹_mª
()->
	`g‘_tu¶e
();

268 
_¼
.
	`£t_ts
(
_chdb
->
	`·¹_mª
()->
	`ts
(),

269 
_chdb
->
	`·¹_desc
()->
	`maxsize
());

270 
_´·¹
->
_»p
 = &
_¼
;

272 
q8_šput
 = &
š
;

273 
	`ty³_to_¡r
(
q8_šput
->
p_ty³
, 
_ty³
);

275 
	`TRACE
(
TRACE_ALWAYS
, "Rªdom…»diÿ‹s:\nPART.P_TYPE = '%s'\n", 
_ty³
);

278 
vœtu®
 ~
	$q8_·¹_tsÿn_f‹r_t
()

281 
_chdb
->
	`·¹_mª
()->
	`give_tu¶e
(
_´·¹
);

282 
	}
}

286 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

289 ià(!
_chdb
->
	`·¹_mª
()->
	`lßd
(
_´·¹
, 
šput
.
d©a
)) {

290 
	`as£¹
(
çl£
);

293 
_´·¹
->
	`g‘_v®ue
(4, 
_·¹
.
P_TYPE
, 25);

295  
	`¡rcmp
(
_·¹
.
P_TYPE
, 
_ty³
) == 0;

296 
	}
}

299 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

301 
q8_´ojeùed_·¹_tu¶e
 *
de¡
;

302 
de¡
 = 
®igÃd_ÿ¡
<
q8_´ojeùed_·¹_tu¶e
>(
d
.
d©a
);

304 
_´·¹
->
	`g‘_v®ue
(0, 
_·¹
.
P_PARTKEY
);

309 
de¡
->
P_PARTKEY
 = 
_·¹
.P_PARTKEY;

310 
	}
}

312 
q8_·¹_tsÿn_f‹r_t
* 
	$şÚe
() const {

313  
Ãw
 
	`q8_·¹_tsÿn_f‹r_t
(*
this
);

314 
	}
}

316 
c_¡r
 
	$to_¡ršg
() const {

317  
	`c_¡r
("q8_·¹_tsÿn_f‹r_t(%s)", 
_ty³
);

318 
	}
}

321 şas 
	cq8_Üd”s_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


323 
´iv©e
:

324 
ShÜeTPCHEnv
* 
_chdb
;

325 
bË_row_t
* 
	m_´Üd”s
;

326 
»p_row_t
 
	m_¼
;

328 
ch_Üd”s_tu¶e
 
	m_Üd”s
;

329 
time_t
 
	m_Üd”d©e
;

331 
time_t
 
	m_fœ¡_Üd”d©e
;

332 
time_t
 
	m_Ï¡_Üd”d©e
;

334 
	mpublic
:

335 
	$q8_Üd”s_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q8_šput_t
 &
š
)

336 : 
	`tu¶e_f‹r_t
(
chdb
->
	`Üd”s_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

338 
_´Üd”s
 = 
_chdb
->
	`Üd”s_mª
()->
	`g‘_tu¶e
();

339 
_¼
.
	`£t_ts
(
_chdb
->
	`Üd”s_mª
()->
	`ts
(),

340 
_chdb
->
	`Üd”s_desc
()->
	`maxsize
());

341 
_´Üd”s
->
_»p
 = &
_¼
;

343 
_fœ¡_Üd”d©e
 = 
	`¡r_to_tim‘
("1995-01-01");

344 
_Ï¡_Üd”d©e
 = 
	`¡r_to_tim‘
("1996-12-31");

347 
vœtu®
 ~
	$q8_Üd”s_tsÿn_f‹r_t
()

350 
_chdb
->
	`Üd”s_mª
()->
	`give_tu¶e
(
_´Üd”s
);

351 
	}
}

353 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

355 ià(!
_chdb
->
	`Üd”s_mª
()->
	`lßd
(
_´Üd”s
, 
šput
.
d©a
)) {

356 
	`as£¹
(
çl£
);

359 
_´Üd”s
->
	`g‘_v®ue
(4, 
_Üd”s
.
O_ORDERDATE
, (_orders.O_ORDERDATE));

360 
_Üd”d©e
 = 
	`¡r_to_tim‘
(
_Üd”s
.
O_ORDERDATE
);

362  
_Üd”d©e
 >ğ
_fœ¡_Üd”d©e
 && _Üd”d©<ğ
_Ï¡_Üd”d©e
;

363 
	}
}

365 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

367 
q8_´ojeùed_Üd”s_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q8_´ojeùed_Üd”s_tu¶e>(
d
.
d©a
);

369 
_´Üd”s
->
	`g‘_v®ue
(0, 
_Üd”s
.
O_ORDERKEY
);

370 
_´Üd”s
->
	`g‘_v®ue
(1, 
_Üd”s
.
O_CUSTKEY
);

371 
_´Üd”s
->
	`g‘_v®ue
(4, 
_Üd”s
.
O_ORDERDATE
, (_orders.O_ORDERDATE));

372 
_Üd”d©e
 = 
	`¡r_to_tim‘
(
_Üd”s
.
O_ORDERDATE
);

373 
tm
 *
tm_Üd”d©e
 = 
	`gmtime
(&
_Üd”d©e
);

377 
de¡
->
O_ORDERKEY
 = 
_Üd”s
.O_ORDERKEY;

378 
de¡
->
O_CUSTKEY
 = 
_Üd”s
.O_CUSTKEY;

379 
de¡
->
O_YEAR
 = 
tm_Üd”d©e
->
tm_y—r
 + 1900;

380 
	}
}

382 
q8_Üd”s_tsÿn_f‹r_t
* 
	$şÚe
() const {

383  
Ãw
 
	`q8_Üd”s_tsÿn_f‹r_t
(*
this
);

384 
	}
}

386 
c_¡r
 
	$to_¡ršg
() const {

387  
	`c_¡r
("q8_Üd”s_tsÿn_f‹r_t(b‘w“À(%s, %s))", 
	`ùime
(&(
_fœ¡_Üd”d©e
)), ctime(&(
_Ï¡_Üd”d©e
)));

388 
	}
}

391 şas 
	cq8_cu¡om”_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


393 
´iv©e
:

394 
ShÜeTPCHEnv
* 
_chdb
;

395 
bË_row_t
* 
	m_´cu¡
;

396 
»p_row_t
 
	m_¼
;

398 
ch_cu¡om”_tu¶e
 
	m_cu¡om”
;

400 
	mpublic
:

401 
	$q8_cu¡om”_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q8_šput_t
 &
š
)

402 : 
	`tu¶e_f‹r_t
(
chdb
->
	`cu¡om”_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

404 
_´cu¡
 = 
_chdb
->
	`cu¡om”_mª
()->
	`g‘_tu¶e
();

405 
_¼
.
	`£t_ts
(
_chdb
->
	`cu¡om”_mª
()->
	`ts
(),

406 
_chdb
->
	`cu¡om”_desc
()->
	`maxsize
());

407 
_´cu¡
->
_»p
 = &
_¼
;

410 
vœtu®
 ~
	$q8_cu¡om”_tsÿn_f‹r_t
()

413 
_chdb
->
	`cu¡om”_mª
()->
	`give_tu¶e
(
_´cu¡
);

414 
	}
}

416 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

418 ià(!
_chdb
->
	`cu¡om”_mª
()->
	`lßd
(
_´cu¡
, 
šput
.
d©a
)) {

419 
	`as£¹
(
çl£
);

422  
Œue
;

423 
	}
}

425 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

427 
q8_´ojeùed_cu¡om”_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q8_´ojeùed_cu¡om”_tu¶e>(
d
.
d©a
);

429 
_´cu¡
->
	`g‘_v®ue
(0, 
_cu¡om”
.
C_CUSTKEY
);

430 
_´cu¡
->
	`g‘_v®ue
(3, 
_cu¡om”
.
C_NATIONKEY
);

434 
de¡
->
C_CUSTKEY
 = 
_cu¡om”
.C_CUSTKEY;

435 
de¡
->
C_NATIONKEY
 = 
_cu¡om”
.C_NATIONKEY;

436 
	}
}

438 
q8_cu¡om”_tsÿn_f‹r_t
* 
	$şÚe
() const {

439  
Ãw
 
	`q8_cu¡om”_tsÿn_f‹r_t
(*
this
);

440 
	}
}

442 
c_¡r
 
	$to_¡ršg
() const {

443  
	`c_¡r
("q8_customer_tscan_filter_t");

444 
	}
}

447 şas 
	cq8_ÇtiÚ_n1_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


449 
´iv©e
:

450 
ShÜeTPCHEnv
* 
_chdb
;

451 
bË_row_t
* 
	m_´ÇtiÚ
;

452 
»p_row_t
 
	m_¼
;

455 
ch_ÇtiÚ_tu¶e
 
	m_ÇtiÚ
;

457 
	mpublic
:

458 
	$q8_ÇtiÚ_n1_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q8_šput_t
 &
š
)

459 : 
	`tu¶e_f‹r_t
(
chdb
->
	`ÇtiÚ_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

461 
_´ÇtiÚ
 = 
_chdb
->
	`ÇtiÚ_mª
()->
	`g‘_tu¶e
();

462 
_¼
.
	`£t_ts
(
_chdb
->
	`ÇtiÚ_mª
()->
	`ts
(),

463 
_chdb
->
	`ÇtiÚ_desc
()->
	`maxsize
());

464 
_´ÇtiÚ
->
_»p
 = &
_¼
;

467 
vœtu®
 ~
	$q8_ÇtiÚ_n1_tsÿn_f‹r_t
()

469 
_chdb
->
	`ÇtiÚ_mª
()->
	`give_tu¶e
(
_´ÇtiÚ
);

470 
	}
}

472 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

475 ià(!
_chdb
->
	`ÇtiÚ_mª
()->
	`lßd
(
_´ÇtiÚ
, 
šput
.
d©a
)) {

476 
	`as£¹
(
çl£
);

479  
Œue
;

480 
	}
}

483 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

485 
q8_´ojeùed_ÇtiÚ_n1_tu¶e
 *
de¡
;

486 
de¡
 = 
®igÃd_ÿ¡
<
q8_´ojeùed_ÇtiÚ_n1_tu¶e
>(
d
.
d©a
);

488 
_´ÇtiÚ
->
	`g‘_v®ue
(0, 
_ÇtiÚ
.
N_NATIONKEY
);

489 
_´ÇtiÚ
->
	`g‘_v®ue
(2, 
_ÇtiÚ
.
N_REGIONKEY
);

494 
de¡
->
N_NATIONKEY
 = 
_ÇtiÚ
.N_NATIONKEY;

495 
de¡
->
N_REGIONKEY
 = 
_ÇtiÚ
.N_REGIONKEY;

496 
	}
}

498 
q8_ÇtiÚ_n1_tsÿn_f‹r_t
* 
	$şÚe
() const {

499  
Ãw
 
	`q8_ÇtiÚ_n1_tsÿn_f‹r_t
(*
this
);

500 
	}
}

502 
c_¡r
 
	$to_¡ršg
() const {

503  
	`c_¡r
("q8_nation_n1_tscan_filter_t()");

504 
	}
}

507 şas 
	cq8_ÇtiÚ_n2_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


509 
´iv©e
:

510 
ShÜeTPCHEnv
* 
_chdb
;

511 
bË_row_t
* 
	m_´ÇtiÚ
;

512 
»p_row_t
 
	m_¼
;

515 
ch_ÇtiÚ_tu¶e
 
	m_ÇtiÚ
;

517 
	mpublic
:

518 
	$q8_ÇtiÚ_n2_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q8_šput_t
 &
š
)

519 : 
	`tu¶e_f‹r_t
(
chdb
->
	`ÇtiÚ_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

521 
_´ÇtiÚ
 = 
_chdb
->
	`ÇtiÚ_mª
()->
	`g‘_tu¶e
();

522 
_¼
.
	`£t_ts
(
_chdb
->
	`ÇtiÚ_mª
()->
	`ts
(),

523 
_chdb
->
	`ÇtiÚ_desc
()->
	`maxsize
());

524 
_´ÇtiÚ
->
_»p
 = &
_¼
;

527 
vœtu®
 ~
	$q8_ÇtiÚ_n2_tsÿn_f‹r_t
()

529 
_chdb
->
	`ÇtiÚ_mª
()->
	`give_tu¶e
(
_´ÇtiÚ
);

530 
	}
}

532 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

535 ià(!
_chdb
->
	`ÇtiÚ_mª
()->
	`lßd
(
_´ÇtiÚ
, 
šput
.
d©a
)) {

536 
	`as£¹
(
çl£
);

539  
Œue
;

540 
	}
}

543 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

545 
q8_´ojeùed_ÇtiÚ_n2_tu¶e
 *
de¡
;

546 
de¡
 = 
®igÃd_ÿ¡
<
q8_´ojeùed_ÇtiÚ_n2_tu¶e
>(
d
.
d©a
);

548 
_´ÇtiÚ
->
	`g‘_v®ue
(0, 
_ÇtiÚ
.
N_NATIONKEY
);

549 
_´ÇtiÚ
->
	`g‘_v®ue
(1, 
_ÇtiÚ
.
N_NAME
, 25);

554 
de¡
->
N_NATIONKEY
 = 
_ÇtiÚ
.N_NATIONKEY;

555 
	`memıy
(
de¡
->
N_NAME
, 
_ÇtiÚ
.N_NAME, (dest->N_NAME));

556 
	}
}

558 
q8_ÇtiÚ_n2_tsÿn_f‹r_t
* 
	$şÚe
() const {

559  
Ãw
 
	`q8_ÇtiÚ_n2_tsÿn_f‹r_t
(*
this
);

560 
	}
}

562 
c_¡r
 
	$to_¡ršg
() const {

563  
	`c_¡r
("q8_nation_n2_tscan_filter_t()");

564 
	}
}

567 şas 
	cq8_»giÚ_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


569 
´iv©e
:

570 
ShÜeTPCHEnv
* 
_chdb
;

571 
bË_row_t
* 
	m_´»giÚ
;

572 
»p_row_t
 
	m_¼
;

575 
ch_»giÚ_tu¶e
 
	m_»giÚ
;

577 
	m_Çme
[
STRSIZE
(25)];

578 
q8_šput_t
* 
	mq8_šput
;

580 
	mpublic
:

581 
	$q8_»giÚ_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q8_šput_t
 &
š
)

582 : 
	`tu¶e_f‹r_t
(
chdb
->
	`»giÚ_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

584 
_´»giÚ
 = 
_chdb
->
	`»giÚ_mª
()->
	`g‘_tu¶e
();

585 
_¼
.
	`£t_ts
(
_chdb
->
	`»giÚ_mª
()->
	`ts
(),

586 
_chdb
->
	`ÇtiÚ_desc
()->
	`maxsize
());

587 
_´»giÚ
->
_»p
 = &
_¼
;

589 
q8_šput
 = &
š
;

590 
	`»giÚ_to_¡r
(
q8_šput
->
r_Çme
, 
_Çme
);

592 
	`TRACE
(
TRACE_ALWAYS
, "Rªdom…»diÿ‹s:\nREGION.R_NAME = '%s'\n", 
_Çme
);

595 
vœtu®
 ~
	$q8_»giÚ_tsÿn_f‹r_t
()

597 
_chdb
->
	`»giÚ_mª
()->
	`give_tu¶e
(
_´»giÚ
);

598 
	}
}

600 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

603 ià(!
_chdb
->
	`»giÚ_mª
()->
	`lßd
(
_´»giÚ
, 
šput
.
d©a
)) {

604 
	`as£¹
(
çl£
);

607 
_´»giÚ
->
	`g‘_v®ue
(1, 
_»giÚ
.
R_NAME
, 25);

609  (
	`¡rcmp
(
_Çme
, 
_»giÚ
.
R_NAME
) == 0);

610 
	}
}

613 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

615 
q8_´ojeùed_»giÚ_tu¶e
 *
de¡
;

616 
de¡
 = 
®igÃd_ÿ¡
<
q8_´ojeùed_»giÚ_tu¶e
>(
d
.
d©a
);

618 
_´»giÚ
->
	`g‘_v®ue
(0, 
_»giÚ
.
R_REGIONKEY
);

623 
de¡
->
R_REGIONKEY
 = 
_»giÚ
.R_REGIONKEY;

624 
	}
}

626 
q8_»giÚ_tsÿn_f‹r_t
* 
	$şÚe
() const {

627  
Ãw
 
	`q8_»giÚ_tsÿn_f‹r_t
(*
this
);

628 
	}
}

630 
c_¡r
 
	$to_¡ršg
() const {

631  
	`c_¡r
("q8_»giÚ_tsÿn_f‹r_t(%s)", 
_Çme
);

632 
	}
}

635 şas 
	cq8_suµl›r_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


637 
´iv©e
:

638 
ShÜeTPCHEnv
* 
_chdb
;

639 
bË_row_t
* 
	m_´suµl›r
;

640 
»p_row_t
 
	m_¼
;

643 
ch_suµl›r_tu¶e
 
	m_suµl›r
;

645 
	mpublic
:

646 
	$q8_suµl›r_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q8_šput_t
 &
š
)

647 : 
	`tu¶e_f‹r_t
(
chdb
->
	`suµl›r_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

649 
_´suµl›r
 = 
_chdb
->
	`suµl›r_mª
()->
	`g‘_tu¶e
();

650 
_¼
.
	`£t_ts
(
_chdb
->
	`suµl›r_mª
()->
	`ts
(),

651 
_chdb
->
	`suµl›r_desc
()->
	`maxsize
());

652 
_´suµl›r
->
_»p
 = &
_¼
;

655 
vœtu®
 ~
	$q8_suµl›r_tsÿn_f‹r_t
()

657 
_chdb
->
	`suµl›r_mª
()->
	`give_tu¶e
(
_´suµl›r
);

658 
	}
}

660 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

663 ià(!
_chdb
->
	`suµl›r_mª
()->
	`lßd
(
_´suµl›r
, 
šput
.
d©a
)) {

664 
	`as£¹
(
çl£
);

667  
Œue
;

668 
	}
}

671 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

673 
q8_´ojeùed_suµl›r_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q8_´ojeùed_suµl›r_tu¶e>(
d
.
d©a
);

676 
_´suµl›r
->
	`g‘_v®ue
(0, 
_suµl›r
.
S_SUPPKEY
);

677 
_´suµl›r
->
	`g‘_v®ue
(3, 
_suµl›r
.
S_NATIONKEY
);

682 
de¡
->
S_SUPPKEY
 = 
_suµl›r
.S_SUPPKEY;

683 
de¡
->
S_NATIONKEY
 = 
_suµl›r
.S_NATIONKEY;

685 
	}
}

687 
q8_suµl›r_tsÿn_f‹r_t
* 
	$şÚe
() const {

688  
Ãw
 
	`q8_suµl›r_tsÿn_f‹r_t
(*
this
);

689 
	}
}

691 
c_¡r
 
	$to_¡ršg
() const {

692  
	`c_¡r
("q8_supplier_tscan_filter_t");

693 
	}
}

697 
	gq8_l_još_p_t
 : 
public
 
tu¶e_još_t
 {

699 
q8_l_još_p_t
()

700 : 
tu¶e_još_t
((
q8_´ojeùed_lše™em_tu¶e
),

701 
off£tof
(
q8_´ojeùed_lše™em_tu¶e
, 
L_PARTKEY
),

702 (
q8_´ojeùed_·¹_tu¶e
),

703 
off£tof
(
q8_´ojeùed_·¹_tu¶e
, 
P_PARTKEY
),

705 (
q8_l_još_p_tu¶e
))

709 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

710 
q8_l_još_p_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q8_l_još_p_tu¶e>(
d
.
d©a
);

711 
q8_´ojeùed_lše™em_tu¶e
 *
	glše
 = 
®igÃd_ÿ¡
<q8_´ojeùed_lše™em_tu¶e>(
l
.
d©a
);

712 
q8_´ojeùed_·¹_tu¶e
 *
	g·¹
 = 
®igÃd_ÿ¡
<q8_´ojeùed_·¹_tu¶e>(
r
.
d©a
);

714 
	gde¡
->
	gL_ORDERKEY
 = 
lše
->
L_ORDERKEY
;

715 
	gde¡
->
	gL_SUPPKEY
 = 
lše
->
L_SUPPKEY
;

716 
	gde¡
->
	gVOLUME
 = 
lše
->
VOLUME
;

721 
vœtu®
 
q8_l_još_p_t
* 
şÚe
() const {

722  
Ãw
 
q8_l_još_p_t
(*
this
);

725 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

726  
c_¡r
("join LINEITEM, PART; select L_ORDERKEY, L_SUPPKEY, VOLUME");

730 
	gq8_o_još_l_p_t
 : 
public
 
tu¶e_još_t
 {

732 
q8_o_još_l_p_t
()

733 : 
tu¶e_još_t
((
q8_´ojeùed_Üd”s_tu¶e
),

734 
off£tof
(
q8_´ojeùed_Üd”s_tu¶e
, 
O_ORDERKEY
),

735 (
q8_l_još_p_tu¶e
),

736 
off£tof
(
q8_l_još_p_tu¶e
, 
L_ORDERKEY
),

738 (
q8_o_još_l_p_tu¶e
))

742 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

743 
q8_o_još_l_p_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q8_o_još_l_p_tu¶e>(
d
.
d©a
);

744 
q8_´ojeùed_Üd”s_tu¶e
 *
	gÜd”
 = 
®igÃd_ÿ¡
<q8_´ojeùed_Üd”s_tu¶e>(
l
.
d©a
);

745 
q8_l_još_p_tu¶e
 *
	gright
 = 
®igÃd_ÿ¡
<q8_l_još_p_tu¶e>(
r
.
d©a
);

747 
	gde¡
->
	gL_SUPPKEY
 = 
right
->
L_SUPPKEY
;

748 
	gde¡
->
	gVOLUME
 = 
right
->
VOLUME
;

749 
	gde¡
->
	gO_CUSTKEY
 = 
Üd”
->
O_CUSTKEY
;

750 
	gde¡
->
	gO_YEAR
 = 
Üd”
->
O_YEAR
;

755 
vœtu®
 
q8_o_još_l_p_t
* 
şÚe
() const {

756  
Ãw
 
q8_o_još_l_p_t
(*
this
);

759 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

760  
c_¡r
("join ORDERS, LINEITEM_PART; select L_SUPPKEY, VOLUME, O_CUSTKEY, O_YEAR");

764 
	gq8_c_još_o_l_p_t
 : 
public
 
tu¶e_još_t
 {

766 
q8_c_još_o_l_p_t
()

767 : 
tu¶e_još_t
((
q8_´ojeùed_cu¡om”_tu¶e
),

768 
off£tof
(
q8_´ojeùed_cu¡om”_tu¶e
, 
C_CUSTKEY
),

769 (
q8_o_još_l_p_tu¶e
),

770 
off£tof
(
q8_o_još_l_p_tu¶e
, 
O_CUSTKEY
),

772 (
q8_c_još_o_l_p_tu¶e
))

776 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

777 
q8_c_još_o_l_p_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q8_c_još_o_l_p_tu¶e>(
d
.
d©a
);

778 
q8_´ojeùed_cu¡om”_tu¶e
 *
	gcu¡
 = 
®igÃd_ÿ¡
<q8_´ojeùed_cu¡om”_tu¶e>(
l
.
d©a
);

779 
q8_o_još_l_p_tu¶e
 *
	gright
 = 
®igÃd_ÿ¡
<q8_o_još_l_p_tu¶e>(
r
.
d©a
);

781 
	gde¡
->
	gL_SUPPKEY
 = 
right
->
L_SUPPKEY
;

782 
	gde¡
->
	gVOLUME
 = 
right
->
VOLUME
;

783 
	gde¡
->
	gO_YEAR
 = 
right
->
O_YEAR
;

784 
	gde¡
->
	gC_NATIONKEY
 = 
cu¡
->
C_NATIONKEY
;

789 
vœtu®
 
q8_c_još_o_l_p_t
* 
şÚe
() const {

790  
Ãw
 
q8_c_još_o_l_p_t
(*
this
);

793 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

794  
c_¡r
("join CUSTOMER, ORDERS_LINEITEM_PART; select L_SUPPKEY, VOLUME, O_YEAR, C_NATIONKEY");

798 
	gq8_c_o_l_p_još_n1_t
 : 
public
 
tu¶e_još_t
 {

800 
q8_c_o_l_p_još_n1_t
()

801 : 
tu¶e_još_t
((
q8_c_još_o_l_p_tu¶e
),

802 
off£tof
(
q8_c_još_o_l_p_tu¶e
, 
C_NATIONKEY
),

803 (
q8_´ojeùed_ÇtiÚ_n1_tu¶e
),

804 
off£tof
(
q8_´ojeùed_ÇtiÚ_n1_tu¶e
, 
N_NATIONKEY
),

806 (
q8_c_o_l_p_još_n1_tu¶e
))

810 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

811 
q8_c_o_l_p_još_n1_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q8_c_o_l_p_još_n1_tu¶e>(
d
.
d©a
);

812 
q8_c_još_o_l_p_tu¶e
 *
	gËá
 = 
®igÃd_ÿ¡
<q8_c_još_o_l_p_tu¶e>(
l
.
d©a
);

813 
q8_´ojeùed_ÇtiÚ_n1_tu¶e
 *
	gÇtiÚ
 = 
®igÃd_ÿ¡
<q8_´ojeùed_ÇtiÚ_n1_tu¶e>(
r
.
d©a
);

815 
	gde¡
->
	gL_SUPPKEY
 = 
Ëá
->
L_SUPPKEY
;

816 
	gde¡
->
	gVOLUME
 = 
Ëá
->
VOLUME
;

817 
	gde¡
->
	gO_YEAR
 = 
Ëá
->
O_YEAR
;

818 
	gde¡
->
	gN_REGIONKEY
 = 
ÇtiÚ
->
N_REGIONKEY
;

823 
vœtu®
 
q8_c_o_l_p_još_n1_t
* 
şÚe
() const {

824  
Ãw
 
q8_c_o_l_p_još_n1_t
(*
this
);

827 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

828  
c_¡r
("join CUSTOMER_ORDERS_LINEITEM_PART, NATION‚1; select L_SUPPKEY, VOLUME, O_YEAR,‚1.N_REGIONKEY");

832 
	gq8_c_o_l_p_n1_još_r_t
 : 
public
 
tu¶e_još_t
 {

834 
q8_c_o_l_p_n1_još_r_t
()

835 : 
tu¶e_još_t
((
q8_c_o_l_p_još_n1_tu¶e
),

836 
off£tof
(
q8_c_o_l_p_još_n1_tu¶e
, 
N_REGIONKEY
),

837 (
q8_´ojeùed_»giÚ_tu¶e
),

838 
off£tof
(
q8_´ojeùed_»giÚ_tu¶e
, 
R_REGIONKEY
),

840 (
q8_c_o_l_p_n1_još_r_tu¶e
))

844 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

845 
q8_c_o_l_p_n1_još_r_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q8_c_o_l_p_n1_još_r_tu¶e>(
d
.
d©a
);

846 
q8_c_o_l_p_još_n1_tu¶e
 *
	gËá
 = 
®igÃd_ÿ¡
<q8_c_o_l_p_još_n1_tu¶e>(
l
.
d©a
);

847 
q8_´ojeùed_»giÚ_tu¶e
 *
	g»giÚ
 = 
®igÃd_ÿ¡
<q8_´ojeùed_»giÚ_tu¶e>(
r
.
d©a
);

849 
	gde¡
->
	gL_SUPPKEY
 = 
Ëá
->
L_SUPPKEY
;

850 
	gde¡
->
	gVOLUME
 = 
Ëá
->
VOLUME
;

851 
	gde¡
->
	gO_YEAR
 = 
Ëá
->
O_YEAR
;

856 
vœtu®
 
q8_c_o_l_p_n1_još_r_t
* 
şÚe
() const {

857  
Ãw
 
q8_c_o_l_p_n1_još_r_t
(*
this
);

860 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

861  
c_¡r
("join CUSTOMER_ORDERS_LINEITEM_PART_NATION, REGION; select L_SUPPKEY, VOLUME, O_YEAR");

865 
	gq8_s_još_c_o_l_p_n1_r_t
 : 
public
 
tu¶e_još_t
 {

867 
q8_s_još_c_o_l_p_n1_r_t
()

868 : 
tu¶e_još_t
((
q8_´ojeùed_suµl›r_tu¶e
),

869 
off£tof
(
q8_´ojeùed_suµl›r_tu¶e
, 
S_SUPPKEY
),

870 (
q8_c_o_l_p_n1_još_r_tu¶e
),

871 
off£tof
(
q8_c_o_l_p_n1_još_r_tu¶e
, 
L_SUPPKEY
),

873 (
q8_s_još_c_o_l_p_n1_r_tu¶e
))

877 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

878 
q8_s_još_c_o_l_p_n1_r_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q8_s_još_c_o_l_p_n1_r_tu¶e>(
d
.
d©a
);

879 
q8_´ojeùed_suµl›r_tu¶e
 *
	gsuµ
 = 
®igÃd_ÿ¡
<q8_´ojeùed_suµl›r_tu¶e>(
l
.
d©a
);

880 
q8_c_o_l_p_n1_još_r_tu¶e
 *
	gright
 = 
®igÃd_ÿ¡
<q8_c_o_l_p_n1_još_r_tu¶e>(
r
.
d©a
);

882 
	gde¡
->
	gS_NATIONKEY
 = 
suµ
->
S_NATIONKEY
;

883 
	gde¡
->
	gVOLUME
 = 
right
->
VOLUME
;

884 
	gde¡
->
	gO_YEAR
 = 
right
->
O_YEAR
;

889 
vœtu®
 
q8_s_još_c_o_l_p_n1_r_t
* 
şÚe
() const {

890  
Ãw
 
q8_s_još_c_o_l_p_n1_r_t
(*
this
);

893 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

894  
c_¡r
("join SUPPLIER, CUSTOMER_ORDERS_LINEITEM_PART_NATION_REGION; select S_NATIONKEY, VOLUEM, O_YEAR");

898 
	gq8_fš®_još
 : 
public
 
tu¶e_još_t
 {

900 
q8_fš®_još
()

901 : 
tu¶e_još_t
((
q8_s_još_c_o_l_p_n1_r_tu¶e
),

902 
off£tof
(
q8_s_još_c_o_l_p_n1_r_tu¶e
, 
S_NATIONKEY
),

903 (
q8_´ojeùed_ÇtiÚ_n2_tu¶e
),

904 
off£tof
(
q8_´ojeùed_ÇtiÚ_n2_tu¶e
, 
N_NATIONKEY
),

906 (
q8_®l_jošs_tu¶e
))

910 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

911 
q8_®l_jošs_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q8_®l_jošs_tu¶e>(
d
.
d©a
);

912 
q8_s_još_c_o_l_p_n1_r_tu¶e
 *
	gËá
 = 
®igÃd_ÿ¡
<q8_s_još_c_o_l_p_n1_r_tu¶e>(
l
.
d©a
);

913 
q8_´ojeùed_ÇtiÚ_n2_tu¶e
 *
	gÇtiÚ
 = 
®igÃd_ÿ¡
<q8_´ojeùed_ÇtiÚ_n2_tu¶e>(
r
.
d©a
);

915 
	gde¡
->
	gVOLUME
 = 
Ëá
->
VOLUME
;

916 
	gde¡
->
	gO_YEAR
 = 
Ëá
->
O_YEAR
;

917 
memıy
(
de¡
->
NATION
, 
ÇtiÚ
->
N_NAME
, (dest->NATION));

922 
vœtu®
 
q8_fš®_još
* 
şÚe
()const {

923  
Ãw
 
q8_fš®_još
(*
this
);

926 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

927  
c_¡r
("join SUPPLIER_CUSTOMER_ORDERS_LINEITEM_PART_NATION_REGION, NATION‚2; select VOLUME, O_YEAR,‚2.N_NAME‡s NATION");

931 
	gq8_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

933 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

934 
	g_ÇtiÚ
[
STRSIZE
(25)];

936 
q8_agg»g©e_t
(
q8_šput_t
 &
š
)

937 : 
tu¶e_agg»g©e_t
((
q8_agg»g©e_tu¶e
))

939 
ÇtiÚ_to_¡r
((&
š
)->
n_Çme
, 
_ÇtiÚ
);

940 
TRACE
(
TRACE_ALWAYS
, "Rªdom…»diÿ‹s:\ÀNATION.N_NAME = %s\n", 
_ÇtiÚ
);

943 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
() {

944  &
	g_exŒaùÜ
;

947 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
t
) {

948 
q8_agg»g©e_tu¶e
 *
	gagg
 = 
®igÃd_ÿ¡
<q8_agg»g©e_tu¶e>(
agg_d©a
);

949 
q8_®l_jošs_tu¶e
 *
	gš
 = 
®igÃd_ÿ¡
<q8_®l_jošs_tu¶e>(
t
.
d©a
);

951 
	gagg
->
	gO_YEAR
 = 
š
->
O_YEAR
;

952 if(
¡rcmp
(
_ÇtiÚ
, 
š
->
NATION
) == 0) {

953 
agg
->
SUM_VOLUME_NATION
 +ğ
š
->
VOLUME
;

955 
	gagg
->
	gSUM_VOLUME
 +ğ
š
->
VOLUME
;

958 
vœtu®
 
fšish
(
tu¶e_t
 &
de¡
, cÚ¡ * 
agg_d©a
) {

959 
memıy
(
de¡
.
d©a
, 
agg_d©a
, de¡.
size
);

960 
q8_agg»g©e_tu¶e
 *
	gagg
 = 
®igÃd_ÿ¡
<q8_agg»g©e_tu¶e>(
de¡
.
d©a
);

961 
	gagg
->
	gMKT_SHARE
 = 
agg
->
SUM_VOLUME_NATION
.
to_doubË
(è/‡gg->
SUM_VOLUME
.to_double();

963 
vœtu®
 
q8_agg»g©e_t
* 
şÚe
() const {

964  
Ãw
 
q8_agg»g©e_t
(*
this
);

966 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

971 
	gq8_sÜt_key_com·»_t
 : 
public
 
key_com·»_t
 {

973 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

974  (*)
	gkey1
 - (*)
	gkey2
;

977 
vœtu®
 
q8_sÜt_key_com·»_t
* 
şÚe
() const {

978  
Ãw
 
q8_sÜt_key_com·»_t
(*
this
);

985 şas 
	cch_q8_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t
 {

987 
public
:

989 
vœtu®
 
	$begš
() {

990 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q8 %6s %25s\n",

994 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

995 
q8_agg»g©e_tu¶e
 *
agg
 = 
®igÃd_ÿ¡
<q8_agg»g©e_tu¶e>(
ouut
.
d©a
);

997 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q8 %6d %25.4f\n", 
agg
->
O_YEAR
,‡gg->
MKT_SHARE
);

998 
	}
}

1009 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_q8
(cÚ¡ 
xù_id
,

1010 
q8_šput_t
& 
š
)

1012 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** q8 *********\n");

1014 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

1015 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

1019 
tu¶e_fifo
* 
q8_·¹_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q8_´ojeùed_·¹_tu¶e
));

1020 
·ck‘_t
* 
q8_·¹_tsÿn_·ck‘
 =

1021 
Ãw
 
	`tsÿn_·ck‘_t
("part TSCAN",

1022 
q8_·¹_bufãr
,

1023 
Ãw
 
	`q8_·¹_tsÿn_f‹r_t
(
this
, 
š
),

1024 
this
->
	`db
(),

1025 
_µ¬t_desc
.
	`g‘
(),

1026 
pxù
);

1029 
tu¶e_fifo
* 
q8_lše™em_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q8_´ojeùed_lše™em_tu¶e
));

1030 
·ck‘_t
* 
q8_lše™em_tsÿn_·ck‘
 =

1031 
Ãw
 
	`tsÿn_·ck‘_t
("lineitem TSCAN",

1032 
q8_lše™em_bufãr
,

1033 
Ãw
 
	`q8_lše™em_tsÿn_f‹r_t
(
this
, 
š
),

1034 
this
->
	`db
(),

1035 
_¶še™em_desc
.
	`g‘
(),

1036 
pxù
);

1039 
tu¶e_fifo
* 
q8_Üd”s_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q8_´ojeùed_Üd”s_tu¶e
));

1040 
·ck‘_t
* 
q8_Üd”s_tsÿn_·ck‘
 =

1041 
Ãw
 
	`tsÿn_·ck‘_t
("orders TSCAN",

1042 
q8_Üd”s_bufãr
,

1043 
Ãw
 
	`q8_Üd”s_tsÿn_f‹r_t
(
this
, 
š
),

1044 
this
->
	`db
(),

1045 
_pÜd”s_desc
.
	`g‘
(),

1046 
pxù
);

1049 
tu¶e_fifo
* 
q8_cu¡om”_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q8_´ojeùed_cu¡om”_tu¶e
));

1050 
·ck‘_t
* 
q8_cu¡om”_tsÿn_·ck‘
 =

1051 
Ãw
 
	`tsÿn_·ck‘_t
("customer TSCAN",

1052 
q8_cu¡om”_bufãr
,

1053 
Ãw
 
	`q8_cu¡om”_tsÿn_f‹r_t
(
this
, 
š
),

1054 
this
->
	`db
(),

1055 
_pcu¡om”_desc
.
	`g‘
(),

1056 
pxù
);

1059 
tu¶e_fifo
* 
q8_ÇtiÚ_n1_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q8_´ojeùed_ÇtiÚ_n1_tu¶e
));

1060 
·ck‘_t
* 
q8_ÇtiÚ_n1_tsÿn_·ck‘
 =

1061 
Ãw
 
	`tsÿn_·ck‘_t
("nation‚1 TSCAN",

1062 
q8_ÇtiÚ_n1_bufãr
,

1063 
Ãw
 
	`q8_ÇtiÚ_n1_tsÿn_f‹r_t
(
this
, 
š
),

1064 
this
->
	`db
(),

1065 
_²©iÚ_desc
.
	`g‘
(),

1066 
pxù
);

1069 
tu¶e_fifo
* 
q8_»giÚ_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q8_´ojeùed_»giÚ_tu¶e
));

1070 
·ck‘_t
* 
q8_»giÚ_tsÿn_·ck‘
 =

1071 
Ãw
 
	`tsÿn_·ck‘_t
("region TSCAN",

1072 
q8_»giÚ_bufãr
,

1073 
Ãw
 
	`q8_»giÚ_tsÿn_f‹r_t
(
this
, 
š
),

1074 
this
->
	`db
(),

1075 
_´egiÚ_desc
.
	`g‘
(),

1076 
pxù
);

1079 
tu¶e_fifo
* 
q8_suµl›r_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q8_´ojeùed_suµl›r_tu¶e
));

1080 
·ck‘_t
* 
q8_suµl›r_tsÿn_·ck‘
 =

1081 
Ãw
 
	`tsÿn_·ck‘_t
("supplier TSCAN",

1082 
q8_suµl›r_bufãr
,

1083 
Ãw
 
	`q8_suµl›r_tsÿn_f‹r_t
(
this
, 
š
),

1084 
this
->
	`db
(),

1085 
_psuµl›r_desc
.
	`g‘
(),

1086 
pxù
);

1089 
tu¶e_fifo
* 
q8_ÇtiÚ_n2_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q8_´ojeùed_ÇtiÚ_n2_tu¶e
));

1090 
·ck‘_t
* 
q8_ÇtiÚ_n2_tsÿn_·ck‘
 =

1091 
Ãw
 
	`tsÿn_·ck‘_t
("nation‚2 TSCAN",

1092 
q8_ÇtiÚ_n2_bufãr
,

1093 
Ãw
 
	`q8_ÇtiÚ_n2_tsÿn_f‹r_t
(
this
, 
š
),

1094 
this
->
	`db
(),

1095 
_²©iÚ_desc
.
	`g‘
(),

1096 
pxù
);

1100 
tu¶e_fifo
* 
q8_l_još_p_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q8_l_još_p_tu¶e
));

1101 
·ck‘_t
* 
q8_l_još_p_·ck‘
 =

1102 
Ãw
 
	`hash_još_·ck‘_t
("lineitem -…art HJOIN",

1103 
q8_l_još_p_bufãr
,

1104 
Ãw
 
	`ŒivŸl_f‹r_t
((
q8_l_još_p_tu¶e
)),

1105 
q8_lše™em_tsÿn_·ck‘
,

1106 
q8_·¹_tsÿn_·ck‘
,

1107 
Ãw
 
	`q8_l_još_p_t
());

1110 
tu¶e_fifo
* 
q8_o_još_l_p_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q8_o_još_l_p_tu¶e
));

1111 
·ck‘_t
* 
q8_o_još_l_p_·ck‘
 =

1112 
Ãw
 
	`hash_još_·ck‘_t
("orders -†ineitem_part HJOIN",

1113 
q8_o_još_l_p_bufãr
,

1114 
Ãw
 
	`ŒivŸl_f‹r_t
((
q8_o_još_l_p_tu¶e
)),

1115 
q8_Üd”s_tsÿn_·ck‘
,

1116 
q8_l_još_p_·ck‘
,

1117 
Ãw
 
	`q8_o_još_l_p_t
());

1120 
tu¶e_fifo
* 
q8_c_još_o_l_p_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q8_c_još_o_l_p_tu¶e
));

1121 
·ck‘_t
* 
q8_c_još_o_l_p_·ck‘
 =

1122 
Ãw
 
	`hash_još_·ck‘_t
("customer - orders_lineitem_part HJOIN",

1123 
q8_c_još_o_l_p_bufãr
,

1124 
Ãw
 
	`ŒivŸl_f‹r_t
((
q8_c_još_o_l_p_tu¶e
)),

1125 
q8_cu¡om”_tsÿn_·ck‘
,

1126 
q8_o_još_l_p_·ck‘
,

1127 
Ãw
 
	`q8_c_još_o_l_p_t
());

1130 
tu¶e_fifo
* 
q8_c_o_l_p_još_n1_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q8_c_o_l_p_još_n1_tu¶e
));

1131 
·ck‘_t
* 
q8_c_o_l_p_još_n1_·ck‘
 =

1132 
Ãw
 
	`hash_još_·ck‘_t
("customer_orders_lineitem_part -‚ation‚1 HJOIN",

1133 
q8_c_o_l_p_još_n1_bufãr
,

1134 
Ãw
 
	`ŒivŸl_f‹r_t
((
q8_c_o_l_p_još_n1_tu¶e
)),

1135 
q8_c_još_o_l_p_·ck‘
,

1136 
q8_ÇtiÚ_n1_tsÿn_·ck‘
,

1137 
Ãw
 
	`q8_c_o_l_p_još_n1_t
());

1140 
tu¶e_fifo
* 
q8_c_o_l_p_n1_još_r_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q8_c_o_l_p_n1_još_r_tu¶e
));

1141 
·ck‘_t
* 
q8_c_o_l_p_n1_još_r_·ck‘
 =

1142 
Ãw
 
	`hash_još_·ck‘_t
("customer_orders_lineitem_part_nation -„egion HJOIN",

1143 
q8_c_o_l_p_n1_još_r_bufãr
,

1144 
Ãw
 
	`ŒivŸl_f‹r_t
((
q8_c_o_l_p_n1_još_r_tu¶e
)),

1145 
q8_c_o_l_p_još_n1_·ck‘
,

1146 
q8_»giÚ_tsÿn_·ck‘
,

1147 
Ãw
 
	`q8_c_o_l_p_n1_još_r_t
());

1150 
tu¶e_fifo
* 
q8_s_još_c_o_l_p_n1_r_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q8_s_još_c_o_l_p_n1_r_tu¶e
));

1151 
·ck‘_t
* 
q8_s_još_c_o_l_p_n1_r_·ck‘
 =

1152 
Ãw
 
	`hash_još_·ck‘_t
("supplier - customer_orders_lineitem_part_nation_region HJOIN",

1153 
q8_s_još_c_o_l_p_n1_r_bufãr
,

1154 
Ãw
 
	`ŒivŸl_f‹r_t
((
q8_s_još_c_o_l_p_n1_r_tu¶e
)),

1155 
q8_suµl›r_tsÿn_·ck‘
,

1156 
q8_c_o_l_p_n1_još_r_·ck‘
,

1157 
Ãw
 
	`q8_s_još_c_o_l_p_n1_r_t
());

1160 
tu¶e_fifo
* 
q8_®l_jošs_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q8_®l_jošs_tu¶e
));

1161 
·ck‘_t
* 
q8_®l_jošs_·ck‘
 =

1162 
Ãw
 
	`hash_još_·ck‘_t
("supplier_customer_orders_lineitem_part_nation_region -‚ation‚2 HJOIN",

1163 
q8_®l_jošs_bufãr
,

1164 
Ãw
 
	`ŒivŸl_f‹r_t
((
q8_®l_jošs_tu¶e
)),

1165 
q8_s_još_c_o_l_p_n1_r_·ck‘
,

1166 
q8_ÇtiÚ_n2_tsÿn_·ck‘
,

1167 
Ãw
 
	`q8_fš®_još
());

1170 
tu¶e_fifo
* 
q8_agg»g©e_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q8_agg»g©e_tu¶e
));

1171 
·ck‘_t
* 
q8_agg»g©e_·ck‘
 =

1172 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("AGGREGATE",

1173 
q8_agg»g©e_bufãr
,

1174 
Ãw
 
	`ŒivŸl_f‹r_t
((
q8_agg»g©e_tu¶e
)),

1175 
q8_®l_jošs_·ck‘
,

1176 
Ãw
 
	`q8_agg»g©e_t
(
š
),

1177 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
((), 
	`off£tof
(
q8_®l_jošs_tu¶e
, 
O_YEAR
)),

1178 
Ãw
 
	`q8_sÜt_key_com·»_t
());

1180 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

1181 
q8_·¹_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1182 
q8_lše™em_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1183 
q8_Üd”s_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1184 
q8_cu¡om”_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1185 
q8_ÇtiÚ_n1_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1186 
q8_»giÚ_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1187 
q8_suµl›r_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1188 
q8_ÇtiÚ_n2_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1189 
q8_l_još_p_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1190 
q8_o_još_l_p_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1191 
q8_c_još_o_l_p_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1192 
q8_c_o_l_p_još_n1_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1193 
q8_c_o_l_p_n1_još_r_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1194 
q8_s_još_c_o_l_p_n1_r_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1195 
q8_®l_jošs_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1196 
q8_agg»g©e_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

1200 
ch_q8_´oûss_tu¶e_t
 
±
;

1202 
	`´oûss_qu”y
(
q8_agg»g©e_·ck‘
, 
±
);

1204 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

1207  (
RCOK
);

1208 
	}
}

1211 
EXIT_NAMESPACE
(
qpe
);

	@src/workload/tpch/qpipe/qpipe_q9.cpp

33 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

34 
	~"wÜklßd/ch/ch_ut.h
"

35 
	~"qpe.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

38 
usšg
 
Çme¥aû
 
	gqpe
;

42 
ENTER_NAMESPACE
(
ch
);

86 
	sq9_´ojeùed_lše™em_tu¶e
 {

87 
	mL_PARTKEY
;

88 
	mL_SUPPKEY
;

89 
	mL_ORDERKEY
;

90 
decim®
 
	mVOLUME
;

91 
decim®
 
	mL_QUANTITY
;

94 
	sq9_´ojeùed_·¹_tu¶e
 {

95 
	mP_PARTKEY
;

98 
	sq9_´ojeùed_suµl›r_tu¶e
 {

99 
	mS_SUPPKEY
;

100 
	mS_NATIONKEY
;

103 
	sq9_´ojeùed_ÇtiÚ_tu¶e
 {

104 
	mN_NATIONKEY
;

105 
	mN_NAME
[
STRSIZE
(25)];

108 
	sq9_´ojeùed_Üd”s_tu¶e
 {

109 
	mO_ORDERKEY
;

110 
	mO_YEAR
;

113 
	sq9_´ojeùed_·¹suµ_tu¶e
 {

114 
	mPS_PARTKEY
;

115 
	mPS_SUPPKEY
;

116 
decim®
 
	mPS_SUPPLYCOST
;

119 
	sq9_l_još_p_tu¶e
 {

120 
	mL_PARTKEY
;

121 
	mL_SUPPKEY
;

122 
	mL_ORDERKEY
;

123 
decim®
 
	mVOLUME
;

124 
decim®
 
	mL_QUANTITY
;

127 
	sq9_l_p_još_s_tu¶e
 {

128 
	mL_PARTKEY
;

129 
	mL_SUPPKEY
;

130 
	mL_ORDERKEY
;

131 
decim®
 
	mVOLUME
;

132 
decim®
 
	mL_QUANTITY
;

133 
	mS_NATIONKEY
;

136 
	sq9_l_p_s_još_n_tu¶e
 {

137 
	mL_PARTKEY
;

138 
	mL_SUPPKEY
;

139 
	mL_ORDERKEY
;

140 
decim®
 
	mVOLUME
;

141 
decim®
 
	mL_QUANTITY
;

142 
	mN_NAME
[
STRSIZE
(25)];

145 
	sq9_l_p_s_n_još_o_tu¶e
 {

146 
	mL_PARTKEY
;

147 
	mL_SUPPKEY
;

148 
decim®
 
	mVOLUME
;

149 
decim®
 
	mL_QUANTITY
;

150 
	mN_NAME
[
STRSIZE
(25)];

151 
	mO_YEAR
;

154 
	sq9_®l_jošs_tu¶e
 {

155 
	mN_NAME
[
STRSIZE
(25)];

156 
	mO_YEAR
;

157 
decim®
 
	mVOLUME
;

158 
decim®
 
	mL_QUANTITY
;

159 
decim®
 
	mPS_SUPPLYCOST
;

162 
	sq9_agg»g©e_tu¶e
 {

163 
	mNATION
[
STRSIZE
(25)];

164 
	mO_YEAR
;

165 
decim®
 
	mSUM_PROFIT
;

168 
	sq9_key
 {

169 
	mNATION
[
STRSIZE
(25)];

170 
	mO_YEAR
;

174 şas 
	cq9_lše™em_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


176 
´iv©e
:

177 
ShÜeTPCHEnv
* 
_chdb
;

178 
bË_row_t
* 
	m_´lše
;

179 
»p_row_t
 
	m_¼
;

181 
ch_lše™em_tu¶e
 
	m_lše™em
;

183 
	mpublic
:

184 
	$q9_lše™em_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q9_šput_t
 &
š
)

185 : 
	`tu¶e_f‹r_t
(
chdb
->
	`lše™em_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

187 
_´lše
 = 
_chdb
->
	`lše™em_mª
()->
	`g‘_tu¶e
();

188 
_¼
.
	`£t_ts
(
_chdb
->
	`lše™em_mª
()->
	`ts
(),

189 
_chdb
->
	`lše™em_desc
()->
	`maxsize
());

190 
_´lše
->
_»p
 = &
_¼
;

193 
vœtu®
 ~
	$q9_lše™em_tsÿn_f‹r_t
()

196 
_chdb
->
	`lše™em_mª
()->
	`give_tu¶e
(
_´lše
);

197 
	}
}

199 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

201 ià(!
_chdb
->
	`lše™em_mª
()->
	`lßd
(
_´lše
, 
šput
.
d©a
)) {

202 
	`as£¹
(
çl£
);

205  
Œue
;

206 
	}
}

208 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

210 
q9_´ojeùed_lše™em_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q9_´ojeùed_lše™em_tu¶e>(
d
.
d©a
);

212 
_´lše
->
	`g‘_v®ue
(0, 
_lše™em
.
L_ORDERKEY
);

213 
_´lše
->
	`g‘_v®ue
(1, 
_lše™em
.
L_PARTKEY
);

214 
_´lše
->
	`g‘_v®ue
(2, 
_lše™em
.
L_SUPPKEY
);

215 
_´lše
->
	`g‘_v®ue
(4, 
_lše™em
.
L_QUANTITY
);

216 
_´lše
->
	`g‘_v®ue
(5, 
_lše™em
.
L_EXTENDEDPRICE
);

217 
_´lše
->
	`g‘_v®ue
(6, 
_lše™em
.
L_DISCOUNT
);

222 
de¡
->
L_ORDERKEY
 = 
_lše™em
.L_ORDERKEY;

223 
de¡
->
L_PARTKEY
 = 
_lše™em
.L_PARTKEY;

224 
de¡
->
L_SUPPKEY
 = 
_lše™em
.L_SUPPKEY;

225 
de¡
->
L_QUANTITY
 = 
_lše™em
.L_QUANTITY;

226 
de¡
->
VOLUME
 = 
_lše™em
.
L_EXTENDEDPRICE
 / 100.0 * (1 - _lše™em.
L_DISCOUNT
 / 100.0);

227 #w¬nšg 
MA
: 
DiscouÁ
 
äom
 
TPCH
 
dbg’
 
is
 
ü—‹d
 
b‘w“n
 0 
ªd
 100 
š¡—d
 between 0‡nd 1.

228 
	}
}

230 
q9_lše™em_tsÿn_f‹r_t
* 
	$şÚe
() const {

231  
Ãw
 
	`q9_lše™em_tsÿn_f‹r_t
(*
this
);

232 
	}
}

234 
c_¡r
 
	$to_¡ršg
() const {

235  
	`c_¡r
("q9_lineitem_tscan_filter_t()");

236 
	}
}

239 şas 
	cq9_·¹_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


241 
´iv©e
:

242 
ShÜeTPCHEnv
* 
_chdb
;

243 
bË_row_t
* 
	m_´·¹
;

244 
»p_row_t
 
	m_¼
;

247 
ch_·¹_tu¶e
 
	m_·¹
;

249 
	m_cŞÜ
[
STRSIZE
(10)];

251 
q9_šput_t
* 
	mq9_šput
;

253 
	mpublic
:

255 
	$q9_·¹_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q9_šput_t
 &
š
)

256 : 
	`tu¶e_f‹r_t
(
chdb
->
	`·¹_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

258 
_´·¹
 = 
_chdb
->
	`·¹_mª
()->
	`g‘_tu¶e
();

259 
_¼
.
	`£t_ts
(
_chdb
->
	`·¹_mª
()->
	`ts
(),

260 
_chdb
->
	`·¹_desc
()->
	`maxsize
());

261 
_´·¹
->
_»p
 = &
_¼
;

263 
q9_šput
 = &
š
;

264 
	`²ame_to_¡r
(
q9_šput
->
p_Çme
, 
_cŞÜ
);

266 
	`TRACE
(
TRACE_ALWAYS
, "Rªdom…»diÿ‹s:\nPART.P_NAME†ik'%%%s%%'\n", 
_cŞÜ
);

269 
vœtu®
 ~
	$q9_·¹_tsÿn_f‹r_t
()

272 
_chdb
->
	`·¹_mª
()->
	`give_tu¶e
(
_´·¹
);

273 
	}
}

277 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

280 ià(!
_chdb
->
	`·¹_mª
()->
	`lßd
(
_´·¹
, 
šput
.
d©a
)) {

281 
	`as£¹
(
çl£
);

284 
_´·¹
->
	`g‘_v®ue
(1, 
_·¹
.
P_NAME
, (_part.P_NAME));

286  
	`¡r¡r
(
_·¹
.
P_NAME
, 
_cŞÜ
);

287 
	}
}

290 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

292 
q9_´ojeùed_·¹_tu¶e
 *
de¡
;

293 
de¡
 = 
®igÃd_ÿ¡
<
q9_´ojeùed_·¹_tu¶e
>(
d
.
d©a
);

295 
_´·¹
->
	`g‘_v®ue
(0, 
_·¹
.
P_PARTKEY
);

300 
de¡
->
P_PARTKEY
 = 
_·¹
.P_PARTKEY;

301 
	}
}

303 
q9_·¹_tsÿn_f‹r_t
* 
	$şÚe
() const {

304  
Ãw
 
	`q9_·¹_tsÿn_f‹r_t
(*
this
);

305 
	}
}

307 
c_¡r
 
	$to_¡ršg
() const {

308  
	`c_¡r
("q9_·¹_tsÿn_f‹r_t(%s)", 
_cŞÜ
);

309 
	}
}

312 şas 
	cq9_suµl›r_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


314 
´iv©e
:

315 
ShÜeTPCHEnv
* 
_chdb
;

316 
bË_row_t
* 
	m_´suµl›r
;

317 
»p_row_t
 
	m_¼
;

320 
ch_suµl›r_tu¶e
 
	m_suµl›r
;

322 
	mpublic
:

323 
	$q9_suµl›r_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q9_šput_t
 &
š
)

324 : 
	`tu¶e_f‹r_t
(
chdb
->
	`suµl›r_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

326 
_´suµl›r
 = 
_chdb
->
	`suµl›r_mª
()->
	`g‘_tu¶e
();

327 
_¼
.
	`£t_ts
(
_chdb
->
	`suµl›r_mª
()->
	`ts
(),

328 
_chdb
->
	`suµl›r_desc
()->
	`maxsize
());

329 
_´suµl›r
->
_»p
 = &
_¼
;

332 
vœtu®
 ~
	$q9_suµl›r_tsÿn_f‹r_t
()

334 
_chdb
->
	`suµl›r_mª
()->
	`give_tu¶e
(
_´suµl›r
);

335 
	}
}

337 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

340 ià(!
_chdb
->
	`suµl›r_mª
()->
	`lßd
(
_´suµl›r
, 
šput
.
d©a
)) {

341 
	`as£¹
(
çl£
);

344  
Œue
;

345 
	}
}

348 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

350 
q9_´ojeùed_suµl›r_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q9_´ojeùed_suµl›r_tu¶e>(
d
.
d©a
);

353 
_´suµl›r
->
	`g‘_v®ue
(0, 
_suµl›r
.
S_SUPPKEY
);

354 
_´suµl›r
->
	`g‘_v®ue
(3, 
_suµl›r
.
S_NATIONKEY
);

359 
de¡
->
S_SUPPKEY
 = 
_suµl›r
.S_SUPPKEY;

360 
de¡
->
S_NATIONKEY
 = 
_suµl›r
.S_NATIONKEY;

362 
	}
}

364 
q9_suµl›r_tsÿn_f‹r_t
* 
	$şÚe
() const {

365  
Ãw
 
	`q9_suµl›r_tsÿn_f‹r_t
(*
this
);

366 
	}
}

368 
c_¡r
 
	$to_¡ršg
() const {

369  
	`c_¡r
("q9_supplier_tscan_filter_t");

370 
	}
}

373 şas 
	cq9_ÇtiÚ_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


375 
´iv©e
:

376 
ShÜeTPCHEnv
* 
_chdb
;

377 
bË_row_t
* 
	m_´ÇtiÚ
;

378 
»p_row_t
 
	m_¼
;

381 
ch_ÇtiÚ_tu¶e
 
	m_ÇtiÚ
;

383 
	mpublic
:

384 
	$q9_ÇtiÚ_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q9_šput_t
 &
š
)

385 : 
	`tu¶e_f‹r_t
(
chdb
->
	`ÇtiÚ_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

387 
_´ÇtiÚ
 = 
_chdb
->
	`ÇtiÚ_mª
()->
	`g‘_tu¶e
();

388 
_¼
.
	`£t_ts
(
_chdb
->
	`ÇtiÚ_mª
()->
	`ts
(),

389 
_chdb
->
	`ÇtiÚ_desc
()->
	`maxsize
());

390 
_´ÇtiÚ
->
_»p
 = &
_¼
;

393 
vœtu®
 ~
	$q9_ÇtiÚ_tsÿn_f‹r_t
()

395 
_chdb
->
	`ÇtiÚ_mª
()->
	`give_tu¶e
(
_´ÇtiÚ
);

396 
	}
}

398 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

401 ià(!
_chdb
->
	`ÇtiÚ_mª
()->
	`lßd
(
_´ÇtiÚ
, 
šput
.
d©a
)) {

402 
	`as£¹
(
çl£
);

405  
Œue
;

406 
	}
}

409 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

411 
q9_´ojeùed_ÇtiÚ_tu¶e
 *
de¡
;

412 
de¡
 = 
®igÃd_ÿ¡
<
q9_´ojeùed_ÇtiÚ_tu¶e
>(
d
.
d©a
);

414 
_´ÇtiÚ
->
	`g‘_v®ue
(0, 
_ÇtiÚ
.
N_NATIONKEY
);

415 
_´ÇtiÚ
->
	`g‘_v®ue
(1, 
_ÇtiÚ
.
N_NAME
, 25);

420 
de¡
->
N_NATIONKEY
 = 
_ÇtiÚ
.N_NATIONKEY;

421 
	`memıy
(
de¡
->
N_NAME
, 
_ÇtiÚ
.N_NAME, (dest->N_NAME));

422 
	}
}

424 
q9_ÇtiÚ_tsÿn_f‹r_t
* 
	$şÚe
() const {

425  
Ãw
 
	`q9_ÇtiÚ_tsÿn_f‹r_t
(*
this
);

426 
	}
}

428 
c_¡r
 
	$to_¡ršg
() const {

429  
	`c_¡r
("q9_nation_tscan_filter_t()");

430 
	}
}

433 şas 
	cq9_Üd”s_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


435 
´iv©e
:

436 
ShÜeTPCHEnv
* 
_chdb
;

437 
bË_row_t
* 
	m_´Üd”s
;

438 
»p_row_t
 
	m_¼
;

440 
ch_Üd”s_tu¶e
 
	m_Üd”s
;

441 
time_t
 
	m_Üd”d©e
;

443 
	mpublic
:

444 
	$q9_Üd”s_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q9_šput_t
 &
š
)

445 : 
	`tu¶e_f‹r_t
(
chdb
->
	`Üd”s_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

447 
_´Üd”s
 = 
_chdb
->
	`Üd”s_mª
()->
	`g‘_tu¶e
();

448 
_¼
.
	`£t_ts
(
_chdb
->
	`Üd”s_mª
()->
	`ts
(),

449 
_chdb
->
	`Üd”s_desc
()->
	`maxsize
());

450 
_´Üd”s
->
_»p
 = &
_¼
;

453 
vœtu®
 ~
	$q9_Üd”s_tsÿn_f‹r_t
()

456 
_chdb
->
	`Üd”s_mª
()->
	`give_tu¶e
(
_´Üd”s
);

457 
	}
}

459 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

461 ià(!
_chdb
->
	`Üd”s_mª
()->
	`lßd
(
_´Üd”s
, 
šput
.
d©a
)) {

462 
	`as£¹
(
çl£
);

465  
Œue
;

466 
	}
}

468 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

470 
q9_´ojeùed_Üd”s_tu¶e
 *
de¡
 = 
®igÃd_ÿ¡
<q9_´ojeùed_Üd”s_tu¶e>(
d
.
d©a
);

472 
_´Üd”s
->
	`g‘_v®ue
(0, 
_Üd”s
.
O_ORDERKEY
);

473 
_´Üd”s
->
	`g‘_v®ue
(4, 
_Üd”s
.
O_ORDERDATE
, (_orders.O_ORDERDATE));

474 
_Üd”d©e
 = 
	`¡r_to_tim‘
(
_Üd”s
.
O_ORDERDATE
);

475 
tm
 *
tm_Üd”d©e
 = 
	`gmtime
(&
_Üd”d©e
);

479 
de¡
->
O_ORDERKEY
 = 
_Üd”s
.O_ORDERKEY;

480 
de¡
->
O_YEAR
 = 
tm_Üd”d©e
->
tm_y—r
 + 1900;

481 
	}
}

483 
q9_Üd”s_tsÿn_f‹r_t
* 
	$şÚe
() const {

484  
Ãw
 
	`q9_Üd”s_tsÿn_f‹r_t
(*
this
);

485 
	}
}

487 
c_¡r
 
	$to_¡ršg
() const {

488  
	`c_¡r
("q9_orders_tscan_filter_t()");

489 
	}
}

492 şas 
	cq9_·¹suµ_tsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


494 
´iv©e
:

495 
ShÜeTPCHEnv
* 
_chdb
;

496 
bË_row_t
* 
	m_´·¹suµ
;

497 
»p_row_t
 
	m_¼
;

500 
ch_·¹suµ_tu¶e
 
	m_·¹suµ
;

502 
	mpublic
:

503 
	$q9_·¹suµ_tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q9_šput_t
 &
š
)

504 : 
	`tu¶e_f‹r_t
(
chdb
->
	`·¹suµ_desc
()->
	`maxsize
()), 
	$_chdb
(
chdb
)

506 
_´·¹suµ
 = 
_chdb
->
	`·¹suµ_mª
()->
	`g‘_tu¶e
();

507 
_¼
.
	`£t_ts
(
_chdb
->
	`·¹suµ_mª
()->
	`ts
(),

508 
_chdb
->
	`·¹suµ_desc
()->
	`maxsize
());

509 
_´·¹suµ
->
_»p
 = &
_¼
;

512 
vœtu®
 ~
	$q9_·¹suµ_tsÿn_f‹r_t
()

514 
_chdb
->
	`·¹suµ_mª
()->
	`give_tu¶e
(
_´·¹suµ
);

515 
	}
}

517 
boŞ
 
	$£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

520 ià(!
_chdb
->
	`·¹suµ_mª
()->
	`lßd
(
_´·¹suµ
, 
šput
.
d©a
)) {

521 
	`as£¹
(
çl£
);

524  
Œue
;

525 
	}
}

528 
	$´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

530 
q9_´ojeùed_·¹suµ_tu¶e
 *
de¡
;

531 
de¡
 = 
®igÃd_ÿ¡
<
q9_´ojeùed_·¹suµ_tu¶e
>(
d
.
d©a
);

533 
_´·¹suµ
->
	`g‘_v®ue
(1, 
_·¹suµ
.
PS_SUPPKEY
);

534 
_´·¹suµ
->
	`g‘_v®ue
(0, 
_·¹suµ
.
PS_PARTKEY
);

535 
_´·¹suµ
->
	`g‘_v®ue
(3, 
_·¹suµ
.
PS_SUPPLYCOST
);

542 
de¡
->
PS_SUPPKEY
 = 
_·¹suµ
.PS_SUPPKEY;

543 
de¡
->
PS_PARTKEY
 = 
_·¹suµ
.PS_PARTKEY;

544 
de¡
->
PS_SUPPLYCOST
 = 
_·¹suµ
.PS_SUPPLYCOST / 100.0;

546 
	}
}

548 
q9_·¹suµ_tsÿn_f‹r_t
* 
	$şÚe
() const {

549  
Ãw
 
	`q9_·¹suµ_tsÿn_f‹r_t
(*
this
);

550 
	}
}

552 
c_¡r
 
	$to_¡ršg
() const {

553  
	`c_¡r
("q9_partsupp_tscan_filter_t()");

554 
	}
}

558 
	gq9_l_još_p_t
 : 
public
 
tu¶e_još_t
 {

560 
q9_l_još_p_t
()

561 : 
tu¶e_još_t
((
q9_´ojeùed_lše™em_tu¶e
),

562 
off£tof
(
q9_´ojeùed_lše™em_tu¶e
, 
L_PARTKEY
),

563 (
q9_´ojeùed_·¹_tu¶e
),

564 
off£tof
(
q9_´ojeùed_·¹_tu¶e
, 
P_PARTKEY
),

566 (
q9_l_još_p_tu¶e
))

570 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

571 
q9_l_još_p_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q9_l_još_p_tu¶e>(
d
.
d©a
);

572 
q9_´ojeùed_lše™em_tu¶e
 *
	glše
 = 
®igÃd_ÿ¡
<q9_´ojeùed_lše™em_tu¶e>(
l
.
d©a
);

573 
q9_´ojeùed_·¹_tu¶e
 *
	g·¹
 = 
®igÃd_ÿ¡
<q9_´ojeùed_·¹_tu¶e>(
r
.
d©a
);

575 
	gde¡
->
	gL_ORDERKEY
 = 
lše
->
L_ORDERKEY
;

576 
	gde¡
->
	gL_PARTKEY
 = 
lše
->
L_PARTKEY
;

577 
	gde¡
->
	gL_QUANTITY
 = 
lše
->
L_QUANTITY
;

578 
	gde¡
->
	gL_SUPPKEY
 = 
lše
->
L_SUPPKEY
;

579 
	gde¡
->
	gVOLUME
 = 
lše
->
VOLUME
;

585 
vœtu®
 
q9_l_još_p_t
* 
şÚe
() const {

586  
Ãw
 
q9_l_još_p_t
(*
this
);

589 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

590  
c_¡r
("join LINEITEM, PART; select L_ORDERKEY, L_PARTKEY, L_QUANTITY, L_SUPPKEY, VOLUME");

594 
	gq9_l_p_još_s_t
 : 
public
 
tu¶e_još_t
 {

596 
q9_l_p_još_s_t
()

597 : 
tu¶e_još_t
((
q9_l_još_p_tu¶e
),

598 
off£tof
(
q9_l_još_p_tu¶e
, 
L_SUPPKEY
),

599 (
q9_´ojeùed_suµl›r_tu¶e
),

600 
off£tof
(
q9_´ojeùed_suµl›r_tu¶e
, 
S_SUPPKEY
),

602 (
q9_l_p_još_s_tu¶e
))

606 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

607 
q9_l_p_još_s_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q9_l_p_još_s_tu¶e>(
d
.
d©a
);

608 
q9_l_još_p_tu¶e
 *
	gËá
 = 
®igÃd_ÿ¡
<q9_l_još_p_tu¶e>(
l
.
d©a
);

609 
q9_´ojeùed_suµl›r_tu¶e
 *
	gsuµ
 = 
®igÃd_ÿ¡
<q9_´ojeùed_suµl›r_tu¶e>(
r
.
d©a
);

611 
	gde¡
->
	gL_ORDERKEY
 = 
Ëá
->
L_ORDERKEY
;

612 
	gde¡
->
	gL_PARTKEY
 = 
Ëá
->
L_PARTKEY
;

613 
	gde¡
->
	gL_QUANTITY
 = 
Ëá
->
L_QUANTITY
;

614 
	gde¡
->
	gL_SUPPKEY
 = 
Ëá
->
L_SUPPKEY
;

615 
	gde¡
->
	gS_NATIONKEY
 = 
suµ
->
S_NATIONKEY
;

616 
	gde¡
->
	gVOLUME
 = 
Ëá
->
VOLUME
;

622 
vœtu®
 
q9_l_p_još_s_t
* 
şÚe
() const {

623  
Ãw
 
q9_l_p_još_s_t
(*
this
);

626 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

627  
c_¡r
("join LINEITEM_PART, SUPPLIER; select L_ORDERKEY, L_PARTKEY, L_QUANTITY, L_SUPPKEY, S_NATIONKEY, VOLUME");

631 
	gq9_l_p_s_još_n_t
 : 
public
 
tu¶e_još_t
 {

633 
q9_l_p_s_još_n_t
()

634 : 
tu¶e_još_t
((
q9_l_p_još_s_tu¶e
),

635 
off£tof
(
q9_l_p_još_s_tu¶e
, 
S_NATIONKEY
),

636 (
q9_´ojeùed_ÇtiÚ_tu¶e
),

637 
off£tof
(
q9_´ojeùed_ÇtiÚ_tu¶e
, 
N_NATIONKEY
),

639 (
q9_l_p_s_još_n_tu¶e
))

643 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

644 
q9_l_p_s_još_n_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q9_l_p_s_još_n_tu¶e>(
d
.
d©a
);

645 
q9_l_p_još_s_tu¶e
 *
	gËá
 = 
®igÃd_ÿ¡
<q9_l_p_još_s_tu¶e>(
l
.
d©a
);

646 
q9_´ojeùed_ÇtiÚ_tu¶e
 *
	gÇtiÚ
 = 
®igÃd_ÿ¡
<q9_´ojeùed_ÇtiÚ_tu¶e>(
r
.
d©a
);

648 
	gde¡
->
	gL_ORDERKEY
 = 
Ëá
->
L_ORDERKEY
;

649 
	gde¡
->
	gL_PARTKEY
 = 
Ëá
->
L_PARTKEY
;

650 
	gde¡
->
	gL_QUANTITY
 = 
Ëá
->
L_QUANTITY
;

651 
	gde¡
->
	gL_SUPPKEY
 = 
Ëá
->
L_SUPPKEY
;

652 
memıy
(
de¡
->
N_NAME
, 
ÇtiÚ
->N_NAME, (dest->N_NAME));

653 
	gde¡
->
	gVOLUME
 = 
Ëá
->
VOLUME
;

659 
vœtu®
 
q9_l_p_s_još_n_t
* 
şÚe
() const {

660  
Ãw
 
q9_l_p_s_još_n_t
(*
this
);

663 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

664  
c_¡r
("join LINEITEM_PART_SUPPLIER, NATION; select L_ORDERKEY, L_PARTKEY, L_QUANTITY, L_SUPPKEY, N_NAME, VOLUME");

668 
	gq9_l_p_s_n_još_o_t
 : 
public
 
tu¶e_još_t
 {

670 
q9_l_p_s_n_još_o_t
()

671 : 
tu¶e_još_t
((
q9_l_p_s_još_n_tu¶e
),

672 
off£tof
(
q9_l_p_s_još_n_tu¶e
, 
L_ORDERKEY
),

673 (
q9_´ojeùed_Üd”s_tu¶e
),

674 
off£tof
(
q9_´ojeùed_Üd”s_tu¶e
, 
O_ORDERKEY
),

676 (
q9_l_p_s_n_još_o_tu¶e
))

680 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

681 
q9_l_p_s_n_još_o_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q9_l_p_s_n_još_o_tu¶e>(
d
.
d©a
);

682 
q9_l_p_s_još_n_tu¶e
 *
	gËá
 = 
®igÃd_ÿ¡
<q9_l_p_s_još_n_tu¶e>(
l
.
d©a
);

683 
q9_´ojeùed_Üd”s_tu¶e
 *
	gÜd”
 = 
®igÃd_ÿ¡
<q9_´ojeùed_Üd”s_tu¶e>(
r
.
d©a
);

685 
	gde¡
->
	gL_PARTKEY
 = 
Ëá
->
L_PARTKEY
;

686 
	gde¡
->
	gL_QUANTITY
 = 
Ëá
->
L_QUANTITY
;

687 
	gde¡
->
	gL_SUPPKEY
 = 
Ëá
->
L_SUPPKEY
;

688 
memıy
(
de¡
->
N_NAME
, 
Ëá
->N_NAME, (dest->N_NAME));

689 
	gde¡
->
	gO_YEAR
 = 
Üd”
->
O_YEAR
;

690 
	gde¡
->
	gVOLUME
 = 
Ëá
->
VOLUME
;

696 
vœtu®
 
q9_l_p_s_n_još_o_t
* 
şÚe
() const {

697  
Ãw
 
q9_l_p_s_n_još_o_t
(*
this
);

700 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

701  
c_¡r
("join LINEITEM_PART_SUPPLIER_NATION, ORDERS; select L_PARTKEY, L_QUANTITY, L_SUPPKEY, N_NAME, O_YEAR, VOLUME");

705 
	gq9_fš®_još_t
 : 
public
 
tu¶e_još_t
 {

707 
q9_fš®_još_t
()

708 : 
tu¶e_još_t
((
q9_l_p_s_n_još_o_tu¶e
),

709 
off£tof
(
q9_l_p_s_n_još_o_tu¶e
, 
L_PARTKEY
),

710 (
q9_´ojeùed_·¹suµ_tu¶e
),

711 
off£tof
(
q9_´ojeùed_·¹suµ_tu¶e
, 
PS_PARTKEY
),

713 (
q9_®l_jošs_tu¶e
))

717 
vœtu®
 
još
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
l
, cÚ¡u¶e_ˆ&
r
) {

718 
q9_®l_jošs_tu¶e
 *
	gde¡
 = 
®igÃd_ÿ¡
<q9_®l_jošs_tu¶e>(
d
.
d©a
);

719 
q9_l_p_s_n_još_o_tu¶e
 *
	gËá
 = 
®igÃd_ÿ¡
<q9_l_p_s_n_još_o_tu¶e>(
l
.
d©a
);

720 
q9_´ojeùed_·¹suµ_tu¶e
 *
	g·¹suµ
 = 
®igÃd_ÿ¡
<q9_´ojeùed_·¹suµ_tu¶e>(
r
.
d©a
);

722 
	gde¡
->
	gL_QUANTITY
 = 
Ëá
->
L_QUANTITY
;

723 
memıy
(
de¡
->
N_NAME
, 
Ëá
->N_NAME, (dest->N_NAME));

724 
	gde¡
->
	gO_YEAR
 = 
Ëá
->
O_YEAR
;

725 
	gde¡
->
	gPS_SUPPLYCOST
 = 
·¹suµ
->
PS_SUPPLYCOST
;

726 
	gde¡
->
	gVOLUME
 = 
Ëá
->
VOLUME
;

732 
vœtu®
 
q9_fš®_još_t
* 
şÚe
() const {

733  
Ãw
 
q9_fš®_još_t
(*
this
);

736 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

737  
c_¡r
("join LINEIETEM_PART_SUPPLIER_NATION_ORDERS, PARTSUPP; select L_QUANTITY, N_NAME, O_YEAR, PS_SUPPLYCOST, VOLUME");

741 
	gq9_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

743 
q9_key_exŒaùÜ_t
()

744 : 
key_exŒaùÜ_t
((
q9_key
))

748 
vœtu®
 
exŒaù_hšt
(cÚ¡ * 
key
) const {

749 *
k
;

750 
	gk
 = 
®igÃd_ÿ¡
<>(
key
);

752 
	g»suÉ
 = (*
k
 << 24) + (*(k + ()) << 16) + (*(k + 2*()) << 8) + *(k + 3*());

754  
	g»suÉ
;

757 
vœtu®
 
q9_key_exŒaùÜ_t
* 
şÚe
() const {

758  
Ãw
 
q9_key_exŒaùÜ_t
(*
this
);

762 
	gq9_key_com·»_t
 : 
public
 
key_com·»_t
 {

764 
vœtu®
 
İ”©Ü
()(cÚ¡ * 
key1
, cÚ¡ * 
	gkey2
) const {

765 
q9_key
 *
	gk1
 = 
®igÃd_ÿ¡
<q9_key>(
key1
);

766 
q9_key
 *
	gk2
 = 
®igÃd_ÿ¡
<q9_key>(
key2
);

768 
	gdiff_ÇtiÚ
 = 
¡rcmp
(
k1
->
NATION
, 
k2
->NATION);

769 
	gdiff_y—r
 = 
k2
->
O_YEAR
 - 
k1
->O_YEAR;

771  (
	gdiff_ÇtiÚ
 !ğ0 ? 
diff_ÇtiÚ
 : 
diff_y—r
);

774 
vœtu®
 
q9_key_com·»_t
* 
şÚe
() const {

775  
Ãw
 
q9_key_com·»_t
(*
this
);

779 
	gq9_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t
 {

781 
deçuÉ_key_exŒaùÜ_t
 
_exŒaùÜ
;

783 
q9_agg»g©e_t
()

784 : 
tu¶e_agg»g©e_t
((
q9_agg»g©e_tu¶e
)), 
_exŒaùÜ
((
q9_key
))

788 
vœtu®
 
key_exŒaùÜ_t
* 
key_exŒaùÜ
() {

789  &
	g_exŒaùÜ
;

792 
vœtu®
 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
t
) {

793 
q9_agg»g©e_tu¶e
 *
	gagg
 = 
®igÃd_ÿ¡
<q9_agg»g©e_tu¶e>(
agg_d©a
);

794 
q9_®l_jošs_tu¶e
 *
	gš
 = 
®igÃd_ÿ¡
<q9_®l_jošs_tu¶e>(
t
.
d©a
);

796 
memıy
(
agg
->
NATION
, 
š
->
N_NAME
, (agg->NATION));

797 
	gagg
->
	gO_YEAR
 = 
š
->
O_YEAR
;

798 
	gagg
->
	gSUM_PROFIT
 +ğ(
š
->
VOLUME
 - in->
PS_SUPPLYCOST
 * in->
L_QUANTITY
);

801 
vœtu®
 
fšish
(
tu¶e_t
 &
de¡
, cÚ¡ * 
agg_d©a
) {

802 
memıy
(
de¡
.
d©a
, 
agg_d©a
, de¡.
size
);

804 
vœtu®
 
q9_agg»g©e_t
* 
şÚe
() const {

805  
Ãw
 
q9_agg»g©e_t
(*
this
);

807 
vœtu®
 
c_¡r
 
to_¡ršg
() const {

813 şas 
	cch_q9_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t
 {

815 
public
:

817 
vœtu®
 
	$begš
() {

818 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q9 %25s %6s %25s\n",

822 
vœtu®
 
	$´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

823 
q9_agg»g©e_tu¶e
 *
agg
 = 
®igÃd_ÿ¡
<q9_agg»g©e_tu¶e>(
ouut
.
d©a
);

825 
	`TRACE
(
TRACE_QUERY_RESULTS
, "*** Q9 %25 %6d %25.4f\n", 
agg
->
NATION
,‡gg->
O_YEAR
,‡gg->
SUM_PROFIT
.
	`to_doubË
());

826 
	}
}

836 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_q9
(cÚ¡ 
xù_id
,

837 
q9_šput_t
& 
š
)

839 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** q9 *********\n");

841 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

842 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

846 
tu¶e_fifo
* 
q9_lše™em_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q9_´ojeùed_lše™em_tu¶e
));

847 
·ck‘_t
* 
q9_lše™em_tsÿn_·ck‘
 =

848 
Ãw
 
	`tsÿn_·ck‘_t
("lineitem TSCAN",

849 
q9_lše™em_bufãr
,

850 
Ãw
 
	`q9_lše™em_tsÿn_f‹r_t
(
this
, 
š
),

851 
this
->
	`db
(),

852 
_¶še™em_desc
.
	`g‘
(),

853 
pxù
);

856 
tu¶e_fifo
* 
q9_·¹_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q9_´ojeùed_·¹_tu¶e
));

857 
·ck‘_t
* 
q9_·¹_tsÿn_·ck‘
 =

858 
Ãw
 
	`tsÿn_·ck‘_t
("part TSCAN",

859 
q9_·¹_bufãr
,

860 
Ãw
 
	`q9_·¹_tsÿn_f‹r_t
(
this
, 
š
),

861 
this
->
	`db
(),

862 
_µ¬t_desc
.
	`g‘
(),

863 
pxù
);

866 
tu¶e_fifo
* 
q9_suµl›r_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q9_´ojeùed_suµl›r_tu¶e
));

867 
·ck‘_t
* 
q9_suµl›r_tsÿn_·ck‘
 =

868 
Ãw
 
	`tsÿn_·ck‘_t
("supplier TSCAN",

869 
q9_suµl›r_bufãr
,

870 
Ãw
 
	`q9_suµl›r_tsÿn_f‹r_t
(
this
, 
š
),

871 
this
->
	`db
(),

872 
_psuµl›r_desc
.
	`g‘
(),

873 
pxù
);

876 
tu¶e_fifo
* 
q9_ÇtiÚ_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q9_´ojeùed_ÇtiÚ_tu¶e
));

877 
·ck‘_t
* 
q9_ÇtiÚ_tsÿn_·ck‘
 =

878 
Ãw
 
	`tsÿn_·ck‘_t
("nation TSCAN",

879 
q9_ÇtiÚ_bufãr
,

880 
Ãw
 
	`q9_ÇtiÚ_tsÿn_f‹r_t
(
this
, 
š
),

881 
this
->
	`db
(),

882 
_²©iÚ_desc
.
	`g‘
(),

883 
pxù
);

886 
tu¶e_fifo
* 
q9_Üd”s_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q9_´ojeùed_Üd”s_tu¶e
));

887 
·ck‘_t
* 
q9_Üd”s_tsÿn_·ck‘
 =

888 
Ãw
 
	`tsÿn_·ck‘_t
("orders TSCAN",

889 
q9_Üd”s_bufãr
,

890 
Ãw
 
	`q9_Üd”s_tsÿn_f‹r_t
(
this
, 
š
),

891 
this
->
	`db
(),

892 
_pÜd”s_desc
.
	`g‘
(),

893 
pxù
);

896 
tu¶e_fifo
* 
q9_·¹suµ_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q9_´ojeùed_·¹suµ_tu¶e
));

897 
·ck‘_t
* 
q9_·¹suµ_tsÿn_·ck‘
 =

898 
Ãw
 
	`tsÿn_·ck‘_t
("partsupp TSCAN",

899 
q9_·¹suµ_bufãr
,

900 
Ãw
 
	`q9_·¹suµ_tsÿn_f‹r_t
(
this
, 
š
),

901 
this
->
	`db
(),

902 
_µ¬tsuµ_desc
.
	`g‘
(),

903 
pxù
);

907 
tu¶e_fifo
* 
q9_l_još_p_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q9_l_još_p_tu¶e
));

908 
·ck‘_t
* 
q9_l_još_p_·ck‘
 =

909 
Ãw
 
	`hash_još_·ck‘_t
("lineitem -…art HJOIN",

910 
q9_l_još_p_bufãr
,

911 
Ãw
 
	`ŒivŸl_f‹r_t
((
q9_l_još_p_tu¶e
)),

912 
q9_lše™em_tsÿn_·ck‘
,

913 
q9_·¹_tsÿn_·ck‘
,

914 
Ãw
 
	`q9_l_još_p_t
());

917 
tu¶e_fifo
* 
q9_l_p_još_s_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q9_l_p_još_s_tu¶e
));

918 
·ck‘_t
* 
q9_l_p_još_s_·ck‘
 =

919 
Ãw
 
	`hash_još_·ck‘_t
("lineitem_part - supplier HJOIN",

920 
q9_l_p_još_s_bufãr
,

921 
Ãw
 
	`ŒivŸl_f‹r_t
((
q9_l_p_još_s_tu¶e
)),

922 
q9_l_još_p_·ck‘
,

923 
q9_suµl›r_tsÿn_·ck‘
,

924 
Ãw
 
	`q9_l_p_još_s_t
());

927 
tu¶e_fifo
* 
q9_l_p_s_još_n_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q9_l_p_s_još_n_tu¶e
));

928 
·ck‘_t
* 
q9_l_p_s_još_n_·ck‘
 =

929 
Ãw
 
	`hash_još_·ck‘_t
("lineitem_part_supplier -‚ation HJOIN",

930 
q9_l_p_s_još_n_bufãr
,

931 
Ãw
 
	`ŒivŸl_f‹r_t
((
q9_l_p_s_još_n_tu¶e
)),

932 
q9_l_p_još_s_·ck‘
,

933 
q9_ÇtiÚ_tsÿn_·ck‘
,

934 
Ãw
 
	`q9_l_p_s_još_n_t
());

937 
tu¶e_fifo
* 
q9_l_p_s_n_još_o_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q9_l_p_s_n_još_o_tu¶e
));

938 
·ck‘_t
* 
q9_l_p_s_n_još_o_·ck‘
 =

939 
Ãw
 
	`hash_još_·ck‘_t
("lineitem_part_supplier_nation - orders HJOIN",

940 
q9_l_p_s_n_još_o_bufãr
,

941 
Ãw
 
	`ŒivŸl_f‹r_t
((
q9_l_p_s_n_još_o_tu¶e
)),

942 
q9_l_p_s_još_n_·ck‘
,

943 
q9_Üd”s_tsÿn_·ck‘
,

944 
Ãw
 
	`q9_l_p_s_n_još_o_t
());

947 
tu¶e_fifo
* 
q9_®l_jošs_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q9_®l_jošs_tu¶e
));

948 
·ck‘_t
* 
q9_®l_jošs_·ck‘
 =

949 
Ãw
 
	`hash_još_·ck‘_t
("lineitem_part_supplier_nation_orders -…artsupp HJOIN",

950 
q9_®l_jošs_bufãr
,

951 
Ãw
 
	`ŒivŸl_f‹r_t
((
q9_®l_jošs_tu¶e
)),

952 
q9_l_p_s_n_još_o_·ck‘
,

953 
q9_·¹suµ_tsÿn_·ck‘
,

954 
Ãw
 
	`q9_fš®_još_t
());

957 
tu¶e_fifo
* 
q9_agg_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q9_agg»g©e_tu¶e
));

958 
·ck‘_t
* 
q9_agg_·ck‘
 =

959 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("AGGREGATE",

960 
q9_agg_bufãr
,

961 
Ãw
 
	`ŒivŸl_f‹r_t
((
q9_agg»g©e_tu¶e
)),

962 
q9_®l_jošs_·ck‘
,

963 
Ãw
 
	`q9_agg»g©e_t
(),

964 
Ãw
 
	`deçuÉ_key_exŒaùÜ_t
((
q9_key
)),

965 
Ãw
 
	`q9_key_com·»_t
());

968 
tu¶e_fifo
* 
q9_sÜt_bufãr
 = 
Ãw
 
	`tu¶e_fifo
((
q9_agg»g©e_tu¶e
));

969 
·ck‘_t
* 
q9_sÜt_·ck‘
 =

970 
Ãw
 
	`sÜt_·ck‘_t
("SORT",

971 
q9_sÜt_bufãr
,

972 
Ãw
 
	`ŒivŸl_f‹r_t
((
q9_agg»g©e_tu¶e
)),

973 
Ãw
 
	`q9_key_exŒaùÜ_t
(),

974 
Ãw
 
	`q9_key_com·»_t
(),

975 
q9_agg_·ck‘
);

978 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

979 
q9_lše™em_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

980 
q9_·¹_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

981 
q9_suµl›r_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

982 
q9_ÇtiÚ_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

983 
q9_Üd”s_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

984 
q9_·¹suµ_tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

985 
q9_l_još_p_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

986 
q9_l_p_još_s_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

987 
q9_l_p_s_još_n_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

988 
q9_l_p_s_n_još_o_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

989 
q9_®l_jošs_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

990 
q9_agg_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

991 
q9_sÜt_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

995 
ch_q9_´oûss_tu¶e_t
 
±
;

997 
	`´oûss_qu”y
(
q9_sÜt_·ck‘
, 
±
);

999 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

1002  (
RCOK
);

1003 
	}
}

1006 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/qpipe/qpipe_tpch_qcustomer.cpp

32 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

33 
	~"qpe.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
usšg
 
Çme¥aû
 
	gqpe
;

40 
ENTER_NAMESPACE
(
ch
);

50 şas 
	cch_qcu¡om”
{

52 
	mpublic
:

55 
	scouÁ_tu¶e
 {

56 
COUNT
;

62 şas 
	ctsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


64 
´iv©e
:

65 
ShÜeTPCHEnv
* 
_chdb
;

66 
bË_row_t
* 
	g_´cu¡
;

67 
»p_row_t
 
	g_¼
;

69 
ch_cu¡om”_tu¶e
 
	g_cu¡om”
;

70 
	gpublic
:

72 
tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
qcu¡om”_šput_t
 &
š
)

73 : 
tu¶e_f‹r_t
(
chdb
->
cu¡om”_desc
()->
maxsize
()), 
_chdb
(tpchdb)

78 
	g_´cu¡
 = 
_chdb
->
cu¡om”_mª
()->
g‘_tu¶e
();

79 
	g_¼
.
£t_ts
(
_chdb
->
cu¡om”_mª
()->
ts
(),

80 
_chdb
->
cu¡om”_desc
()->
maxsize
());

81 
	g_´cu¡
->
	g_»p
 = &
_¼
;

85 ~
tsÿn_f‹r_t
()

88 
	g_chdb
->
cu¡om”_mª
()->
give_tu¶e
(
_´cu¡
);

93 
boŞ
 
£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

96 ià(!
	g_chdb
->
cu¡om”_mª
()->
lßd
(
_´cu¡
, 
šput
.
d©a
)) {

97 
as£¹
(
çl£
);

100  (
	gŒue
);

105 
´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

107 
ch_cu¡om”_tu¶e
 *
	gde¡
;

108 
	gde¡
 = 
®igÃd_ÿ¡
<
ch_cu¡om”_tu¶e
>(
d
.
d©a
);

110 
	g_´cu¡
->
g‘_v®ue
(0, 
_cu¡om”
.
C_CUSTKEY
);

111 
	g_´cu¡
->
g‘_v®ue
(1, 
_cu¡om”
.
C_NAME
,25);

112 
	g_´cu¡
->
g‘_v®ue
(2, 
_cu¡om”
.
C_ADDRESS
,40);

113 
	g_´cu¡
->
g‘_v®ue
(3, 
_cu¡om”
.
C_NATIONKEY
);

114 
	g_´cu¡
->
g‘_v®ue
(4, 
_cu¡om”
.
C_PHONE
,15);

115 
	g_´cu¡
->
g‘_v®ue
(5, 
_cu¡om”
.
C_ACCTBAL
);

116 
	g_´cu¡
->
g‘_v®ue
(6, 
_cu¡om”
.
C_MKTSEGMENT
,10);

117 
	g_´cu¡
->
g‘_v®ue
(7, 
_cu¡om”
.
C_COMMENT
,117);

119 
memıy
(
de¡
,&
_cu¡om”
,(
ch_cu¡om”_tu¶e
));

120 ià(
	gde¡
->
	gC_CUSTKEY
%10000==0)

121 
TRACE
(
TRACE_RECORD_FLOW
, "%d %s\n", 
de¡
->
C_CUSTKEY
, de¡->
C_NAME
);

125 
tsÿn_f‹r_t
* 
şÚe
() const {

126  
Ãw
 
tsÿn_f‹r_t
(*
this
);

129 
c_¡r
 
to_¡ršg
() const {

130  
c_¡r
("tscan_filter_t");

137 şas 
	ccouÁ_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t


139 
public
:

141 şas 
	ccouÁ_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

142 
public
:

144 
couÁ_key_exŒaùÜ_t
()

145 : 
key_exŒaùÜ_t
(0, 0) {

149 
vœtu®
 
key_exŒaùÜ_t
* 
şÚe
() const {

150  
Ãw
 
couÁ_key_exŒaùÜ_t
(*
this
);

154 
	g´iv©e
:

155 
couÁ_key_exŒaùÜ_t
 
_exŒaùÜ
;

157 
	gpublic
:

159 
couÁ_agg»g©e_t
()

160 : 
tu¶e_agg»g©e_t
((
couÁ_tu¶e
))

164 
key_exŒaùÜ_t
* 
key_exŒaùÜ
(è{  &
_exŒaùÜ
; }

168 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
s
) {

169 
couÁ_tu¶e
* 
	gtu¶e
 = 
®igÃd_ÿ¡
<couÁ_tu¶e>(
agg_d©a
);

172 
	gtu¶e
->
	gCOUNT
++;

176 
fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

177 
couÁ_tu¶e
 *
	gde¡
;

178 
	gde¡
 = 
®igÃd_ÿ¡
<
couÁ_tu¶e
>(
d
.
d©a
);

179 
couÁ_tu¶e
* 
	gtu¶e
 = 
®igÃd_ÿ¡
<couÁ_tu¶e>(
agg_d©a
);

181 
	gde¡
->
	gCOUNT
=
tu¶e
->
COUNT
;

184 
couÁ_agg»g©e_t
* 
şÚe
() const {

185  
Ãw
 
couÁ_agg»g©e_t
(*
this
);

188 
c_¡r
 
to_¡ršg
() const {

194 şas 
	cch_cu¡om”_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


196 
public
:

198 
begš
() {

199 
TRACE
(
TRACE_QUERY_RESULTS
, "*** SCAN CUSTOMER ANSWER ...\n");

200 
TRACE
(
TRACE_QUERY_RESULTS
, "*** COUNT ...\n");

203 
vœtu®
 
´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

204 
couÁ_tu¶e
 *
	gtu¶e
;

205 
	gtu¶e
 = 
®igÃd_ÿ¡
<
couÁ_tu¶e
>(
ouut
.
d©a
);

206 
TRACE
(
TRACE_QUERY_RESULTS
, "*** %d\n",

207 
tu¶e
->
COUNT
);

212 cÚ¡ 
c_¡r
* 
	$dump_tu¶e
(
tu¶e_t
* 
tup
) {

213 
ch_cu¡om”_tu¶e
 *
de¡
;

214 
de¡
 = 
®igÃd_ÿ¡
<
ch_cu¡om”_tu¶e
> (
tup
->
d©a
);

215  
Ãw
 
	`c_¡r
("%d|%s|%s|%d|%s|%lf|%s|%s|\n",

216 
de¡
->
C_CUSTKEY
,

217 
de¡
->
C_NAME
,

218 
de¡
->
C_ADDRESS
,

219 
de¡
->
C_NATIONKEY
,

220 
de¡
->
C_PHONE
,

221 
de¡
->
C_ACCTBAL
.
	`to_doubË
(),

222 
de¡
->
C_MKTSEGMENT
,

223 
de¡
->
C_COMMENT
);

224 
	}
}

235 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_qcu¡om”
(cÚ¡ 
xù_id
, 
qcu¡om”_šput_t
& 
š
)

237 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** SCAN CUSTOMER *********\n");

239 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

240 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

244 
tu¶e_fifo
* 
tsÿn_out_bufãr
 =

245 
Ãw
 
	`tu¶e_fifo
((
ch_cu¡om”_tu¶e
));

246 
tsÿn_·ck‘_t
* 
tsÿn_·ck‘
 =

247 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN CUSTOMER",

248 
tsÿn_out_bufãr
,

249 
Ãw
 
ch_qcu¡om”
::
	`tsÿn_f‹r_t
(
this
,
š
),

250 
this
->
	`db
(),

251 
_pcu¡om”_desc
.
	`g‘
(),

252 
pxù


256 
tu¶e_fifo
* 
fdump_ouut
 = 
Ãw
 
	`tu¶e_fifo
((
ch_cu¡om”_tu¶e
));

257 
fdump_·ck‘_t
* 
fdump_·ck‘
 =

258 
Ãw
 
	`fdump_·ck‘_t
(
	`c_¡r
("FDUMP"),

259 
fdump_ouut
,

260 
Ãw
 
	`ŒivŸl_f‹r_t
(
fdump_ouut
->
	`tu¶e_size
()),

261 
NULL
,

262 
	`c_¡r
("%s/cu¡om”.tbl", 
	`g‘’v
("HOME")),

263 
NULL
,

264 
tsÿn_·ck‘
,

265 
ch_qcu¡om”
::
dump_tu¶e
);

269 
tu¶e_fifo
* 
couÁ_ouut_bufãr
 =

270 
Ãw
 
	`tu¶e_fifo
((
ch_qcu¡om”
::
couÁ_tu¶e
));

271 
·ck‘_t
* 
couÁ_·ck‘
 =

272 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("COUNT",

273 
couÁ_ouut_bufãr
,

274 
Ãw
 
	`ŒivŸl_f‹r_t
(
couÁ_ouut_bufãr
->
	`tu¶e_size
()),

275 
fdump_·ck‘
,

276 
Ãw
 
ch_qcu¡om”
::
	`couÁ_agg»g©e_t
(),

277 
Ãw
 
ch_qcu¡om”
::
couÁ_agg»g©e_t
::
	`couÁ_key_exŒaùÜ_t
(),

278 
Ãw
 
	`št_key_com·»_t
());

280 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

281 
couÁ_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

282 
fdump_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

283 
tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

286 
ch_qcu¡om”
::
ch_cu¡om”_´oûss_tu¶e_t
 
±
;

287 
	`´oûss_qu”y
(
couÁ_·ck‘
, 
±
);

288 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

290  (
RCOK
);

291 
	}
}

294 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/qpipe/qpipe_tpch_qlineitem.cpp

32 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

33 
	~"qpe.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
usšg
 
Çme¥aû
 
	gqpe
;

40 
ENTER_NAMESPACE
(
ch
);

50 şas 
	cch_qlše™em
{

52 
	mpublic
:

55 
	scouÁ_tu¶e
 {

56 
COUNT
;

62 şas 
	ctsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


64 
´iv©e
:

65 
ShÜeTPCHEnv
* 
_chdb
;

66 
bË_row_t
* 
	g_´lše
;

67 
»p_row_t
 
	g_¼
;

69 
ch_lše™em_tu¶e
 
	g_lše™em
;

70 
	gpublic
:

72 
tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
qlše™em_šput_t
 &
š
)

73 : 
tu¶e_f‹r_t
(
chdb
->
lše™em_desc
()->
maxsize
()), 
_chdb
(tpchdb)

78 
	g_´lše
 = 
_chdb
->
lše™em_mª
()->
g‘_tu¶e
();

79 
	g_¼
.
£t_ts
(
_chdb
->
lše™em_mª
()->
ts
(),

80 
_chdb
->
lše™em_desc
()->
maxsize
());

81 
	g_´lše
->
	g_»p
 = &
_¼
;

85 ~
tsÿn_f‹r_t
()

88 
	g_chdb
->
lše™em_mª
()->
give_tu¶e
(
_´lše
);

93 
boŞ
 
£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

96 ià(!
	g_chdb
->
lše™em_mª
()->
lßd
(
_´lše
, 
šput
.
d©a
)) {

97 
as£¹
(
çl£
);

100  (
	gŒue
);

105 
´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

107 
ch_lše™em_tu¶e
 *
	gde¡
;

108 
	gde¡
 = 
®igÃd_ÿ¡
<
ch_lše™em_tu¶e
>(
d
.
d©a
);

110 
	g_´lše
->
g‘_v®ue
(0, 
_lše™em
.
L_ORDERKEY
);

111 
	g_´lše
->
g‘_v®ue
(1, 
_lše™em
.
L_PARTKEY
);

112 
	g_´lše
->
g‘_v®ue
(2, 
_lše™em
.
L_SUPPKEY
);

113 
	g_´lše
->
g‘_v®ue
(3, 
_lše™em
.
L_LINENUMBER
);

114 
	g_´lše
->
g‘_v®ue
(4, 
_lše™em
.
L_QUANTITY
);

115 
	g_´lše
->
g‘_v®ue
(5, 
_lše™em
.
L_EXTENDEDPRICE
);

116 
	g_´lše
->
g‘_v®ue
(6, 
_lše™em
.
L_DISCOUNT
);

117 
	g_´lše
->
g‘_v®ue
(7, 
_lše™em
.
L_TAX
);

118 
	g_´lše
->
g‘_v®ue
(8, 
_lše™em
.
L_RETURNFLAG
);

119 
	g_´lše
->
g‘_v®ue
(9, 
_lše™em
.
L_LINESTATUS
);

120 
	g_´lše
->
g‘_v®ue
(10, 
_lše™em
.
L_SHIPDATE
,15);

121 
	g_´lše
->
g‘_v®ue
(11, 
_lše™em
.
L_COMMITDATE
,15);

122 
	g_´lše
->
g‘_v®ue
(12, 
_lše™em
.
L_RECEIPTDATE
,15);

123 
	g_´lše
->
g‘_v®ue
(13, 
_lše™em
.
L_SHIPINSTRUCT
,25);

124 
	g_´lše
->
g‘_v®ue
(14, 
_lše™em
.
L_SHIPMODE
,10);

125 
	g_´lše
->
g‘_v®ue
(15, 
_lše™em
.
L_COMMENT
,44);

127 
memıy
(
de¡
,&
_lše™em
,(
ch_lše™em_tu¶e
));

128 ià(
	gde¡
->
	gL_ORDERKEY
%1000000==0)

129 
TRACE
(
TRACE_RECORD_FLOW
, "%d %d %d %d\n", 
de¡
->
L_LINENUMBER
, de¡->
L_ORDERKEY
, de¡->
L_PARTKEY
, de¡->
L_SUPPKEY
);

133 
tsÿn_f‹r_t
* 
şÚe
() const {

134  
Ãw
 
tsÿn_f‹r_t
(*
this
);

137 
c_¡r
 
to_¡ršg
() const {

138  
c_¡r
("tscan_filter_t");

145 şas 
	ccouÁ_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t


147 
public
:

149 şas 
	ccouÁ_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

150 
public
:

152 
couÁ_key_exŒaùÜ_t
()

153 : 
key_exŒaùÜ_t
(0, 0) {

157 
vœtu®
 
key_exŒaùÜ_t
* 
şÚe
() const {

158  
Ãw
 
couÁ_key_exŒaùÜ_t
(*
this
);

162 
	g´iv©e
:

163 
couÁ_key_exŒaùÜ_t
 
_exŒaùÜ
;

165 
	gpublic
:

167 
couÁ_agg»g©e_t
()

168 : 
tu¶e_agg»g©e_t
((
couÁ_tu¶e
))

172 
key_exŒaùÜ_t
* 
key_exŒaùÜ
(è{  &
_exŒaùÜ
; }

176 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
s
) {

177 
couÁ_tu¶e
* 
	gtu¶e
 = 
®igÃd_ÿ¡
<couÁ_tu¶e>(
agg_d©a
);

180 
	gtu¶e
->
	gCOUNT
++;

184 
fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

185 
couÁ_tu¶e
 *
	gde¡
;

186 
	gde¡
 = 
®igÃd_ÿ¡
<
couÁ_tu¶e
>(
d
.
d©a
);

187 
couÁ_tu¶e
* 
	gtu¶e
 = 
®igÃd_ÿ¡
<couÁ_tu¶e>(
agg_d©a
);

189 
	gde¡
->
	gCOUNT
=
tu¶e
->
COUNT
;

192 
couÁ_agg»g©e_t
* 
şÚe
() const {

193  
Ãw
 
couÁ_agg»g©e_t
(*
this
);

196 
c_¡r
 
to_¡ršg
() const {

202 şas 
	cch_lše™em_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


204 
public
:

206 
begš
() {

207 
TRACE
(
TRACE_QUERY_RESULTS
, "*** SCAN LINEITEM ANSWER ...\n");

208 
TRACE
(
TRACE_QUERY_RESULTS
, "*** COUNT ...\n");

211 
vœtu®
 
´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

212 
couÁ_tu¶e
 *
	gtu¶e
;

213 
	gtu¶e
 = 
®igÃd_ÿ¡
<
couÁ_tu¶e
>(
ouut
.
d©a
);

214 
TRACE
(
TRACE_QUERY_RESULTS
, "*** %d\n",

215 
tu¶e
->
COUNT
);

219 cÚ¡ 
c_¡r
* 
	$dump_tu¶e
(
tu¶e_t
* 
tup
) {

220 
ch_lše™em_tu¶e
 *
de¡
;

221 
de¡
 = 
®igÃd_ÿ¡
<
ch_lše™em_tu¶e
> (
tup
->
d©a
);

222  
Ãw
 
	`c_¡r
("%d|%d|%d|%d|%lf|%lf|%lf|%lf|%c|%c|%s|%s|%s|%s|%s|%s|\n",

223 
de¡
->
L_ORDERKEY
,

224 
de¡
->
L_PARTKEY
,

225 
de¡
->
L_SUPPKEY
,

226 
de¡
->
L_LINENUMBER
,

227 
de¡
->
L_QUANTITY
,

228 
de¡
->
L_EXTENDEDPRICE
,

229 
de¡
->
L_DISCOUNT
,

230 
de¡
->
L_TAX
,

231 
de¡
->
L_RETURNFLAG
,

232 
de¡
->
L_LINESTATUS
,

233 
de¡
->
L_SHIPDATE
,

234 
de¡
->
L_COMMITDATE
,

235 
de¡
->
L_RECEIPTDATE
,

236 
de¡
->
L_SHIPINSTRUCT
,

237 
de¡
->
L_SHIPMODE
,

238 
de¡
->
L_COMMENT
);

239 
	}
}

249 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_qlše™em
(cÚ¡ 
xù_id
, 
qlše™em_šput_t
& 
š
)

251 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** SCAN LINEITEM *********\n");

253 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

254 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

258 
tu¶e_fifo
* 
tsÿn_out_bufãr
 =

259 
Ãw
 
	`tu¶e_fifo
((
ch_lše™em_tu¶e
));

260 
tsÿn_·ck‘_t
* 
tsÿn_·ck‘
 =

261 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN LINEITEM",

262 
tsÿn_out_bufãr
,

263 
Ãw
 
ch_qlše™em
::
	`tsÿn_f‹r_t
(
this
,
š
),

264 
this
->
	`db
(),

265 
_¶še™em_desc
.
	`g‘
(),

266 
pxù


270 
tu¶e_fifo
* 
fdump_ouut
 = 
Ãw
 
	`tu¶e_fifo
((
ch_lše™em_tu¶e
));

271 
fdump_·ck‘_t
* 
fdump_·ck‘
 =

272 
Ãw
 
	`fdump_·ck‘_t
(
	`c_¡r
("FDUMP"),

273 
fdump_ouut
,

274 
Ãw
 
	`ŒivŸl_f‹r_t
(
fdump_ouut
->
	`tu¶e_size
()),

275 
NULL
,

276 
	`c_¡r
("%s/lše™em.tbl", 
	`g‘’v
("HOME")),

277 
NULL
,

278 
tsÿn_·ck‘
,

279 
ch_qlše™em
::
dump_tu¶e
);

282 
tu¶e_fifo
* 
couÁ_ouut_bufãr
 =

283 
Ãw
 
	`tu¶e_fifo
((
ch_qlše™em
::
couÁ_tu¶e
));

284 
·ck‘_t
* 
couÁ_·ck‘
 =

285 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("COUNT",

286 
couÁ_ouut_bufãr
,

287 
Ãw
 
	`ŒivŸl_f‹r_t
(
couÁ_ouut_bufãr
->
	`tu¶e_size
()),

288 
fdump_·ck‘
,

289 
Ãw
 
ch_qlše™em
::
	`couÁ_agg»g©e_t
(),

290 
Ãw
 
ch_qlše™em
::
couÁ_agg»g©e_t
::
	`couÁ_key_exŒaùÜ_t
(),

291 
Ãw
 
	`št_key_com·»_t
());

293 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

294 
couÁ_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

295 
tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

298 
ch_qlše™em
::
ch_lše™em_´oûss_tu¶e_t
 
±
;

299 
	`´oûss_qu”y
(
couÁ_·ck‘
, 
±
);

300 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

302  (
RCOK
);

303 
	}
}

306 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/qpipe/qpipe_tpch_qnation.cpp

32 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

33 
	~"qpe.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
usšg
 
Çme¥aû
 
	gqpe
;

40 
ENTER_NAMESPACE
(
ch
);

50 şas 
	cch_qÇtiÚ
{

52 
	mpublic
:

55 
	scouÁ_tu¶e
 {

56 
COUNT
;

62 şas 
	ctsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


64 
´iv©e
:

65 
ShÜeTPCHEnv
* 
_chdb
;

66 
bË_row_t
* 
	g_´Çt
;

67 
»p_row_t
 
	g_¼
;

69 
ch_ÇtiÚ_tu¶e
 
	g_ÇtiÚ
;

70 
	gpublic
:

72 
tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
qÇtiÚ_šput_t
 &
š
)

73 : 
tu¶e_f‹r_t
(
chdb
->
ÇtiÚ_desc
()->
maxsize
()), 
_chdb
(tpchdb)

78 
	g_´Çt
 = 
_chdb
->
ÇtiÚ_mª
()->
g‘_tu¶e
();

79 
	g_¼
.
£t_ts
(
_chdb
->
ÇtiÚ_mª
()->
ts
(),

80 
_chdb
->
ÇtiÚ_desc
()->
maxsize
());

81 
	g_´Çt
->
	g_»p
 = &
_¼
;

85 ~
tsÿn_f‹r_t
()

88 
	g_chdb
->
ÇtiÚ_mª
()->
give_tu¶e
(
_´Çt
);

93 
boŞ
 
£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

96 ià(!
	g_chdb
->
ÇtiÚ_mª
()->
lßd
(
_´Çt
, 
šput
.
d©a
)) {

97 
as£¹
(
çl£
);

100  (
	gŒue
);

105 
´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

107 
ch_ÇtiÚ_tu¶e
 *
	gde¡
;

108 
	gde¡
 = 
®igÃd_ÿ¡
<
ch_ÇtiÚ_tu¶e
>(
d
.
d©a
);

110 
	g_´Çt
->
g‘_v®ue
(0, 
_ÇtiÚ
.
N_NATIONKEY
);

111 
	g_´Çt
->
g‘_v®ue
(1, 
_ÇtiÚ
.
N_NAME
, 25);

112 
	g_´Çt
->
g‘_v®ue
(2, 
_ÇtiÚ
.
N_REGIONKEY
);

113 
	g_´Çt
->
g‘_v®ue
(3, 
_ÇtiÚ
.
N_COMMENT
, 152);

115 
memıy
(
de¡
,&
_ÇtiÚ
,(
ch_ÇtiÚ_tu¶e
));

116 
TRACE
(
TRACE_RECORD_FLOW
, "%d %s\n", 
de¡
->
N_NATIONKEY
, de¡->
N_NAME
);

119 
tsÿn_f‹r_t
* 
şÚe
() const {

120  
Ãw
 
tsÿn_f‹r_t
(*
this
);

123 
c_¡r
 
to_¡ršg
() const {

124  
c_¡r
("tscan_filter_t");

131 şas 
	ccouÁ_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t


133 
public
:

135 şas 
	ccouÁ_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

136 
public
:

138 
couÁ_key_exŒaùÜ_t
()

139 : 
key_exŒaùÜ_t
(0, 0) {

143 
vœtu®
 
key_exŒaùÜ_t
* 
şÚe
() const {

144  
Ãw
 
couÁ_key_exŒaùÜ_t
(*
this
);

148 
	g´iv©e
:

149 
couÁ_key_exŒaùÜ_t
 
_exŒaùÜ
;

151 
	gpublic
:

153 
couÁ_agg»g©e_t
()

154 : 
tu¶e_agg»g©e_t
((
couÁ_tu¶e
))

158 
key_exŒaùÜ_t
* 
key_exŒaùÜ
(è{  &
_exŒaùÜ
; }

162 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
s
) {

163 
couÁ_tu¶e
* 
	gtu¶e
 = 
®igÃd_ÿ¡
<couÁ_tu¶e>(
agg_d©a
);

166 
	gtu¶e
->
	gCOUNT
++;

170 
fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

171 
couÁ_tu¶e
 *
	gde¡
;

172 
	gde¡
 = 
®igÃd_ÿ¡
<
couÁ_tu¶e
>(
d
.
d©a
);

173 
couÁ_tu¶e
* 
	gtu¶e
 = 
®igÃd_ÿ¡
<couÁ_tu¶e>(
agg_d©a
);

175 
	gde¡
->
	gCOUNT
=
tu¶e
->
COUNT
;

178 
couÁ_agg»g©e_t
* 
şÚe
() const {

179  
Ãw
 
couÁ_agg»g©e_t
(*
this
);

182 
c_¡r
 
to_¡ršg
() const {

188 şas 
	cch_ÇtiÚ_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


190 
public
:

192 
begš
() {

193 
TRACE
(
TRACE_QUERY_RESULTS
, "*** SCAN NATION ANSWER ...\n");

194 
TRACE
(
TRACE_QUERY_RESULTS
, "*** COUNT ...\n");

197 
vœtu®
 
´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

198 
couÁ_tu¶e
 *
	gtu¶e
;

199 
	gtu¶e
 = 
®igÃd_ÿ¡
<
couÁ_tu¶e
>(
ouut
.
d©a
);

200 
TRACE
(
TRACE_QUERY_RESULTS
, "*** %d\n",

201 
tu¶e
->
COUNT
);

206 cÚ¡ 
c_¡r
* 
	$dump_tu¶e
(
tu¶e_t
* 
tup
) {

207 
ch_ÇtiÚ_tu¶e
 *
de¡
;

208 
de¡
 = 
®igÃd_ÿ¡
<
ch_ÇtiÚ_tu¶e
> (
tup
->
d©a
);

209  
Ãw
 
	`c_¡r
("%d|%s|%d|%s|\n",

210 
de¡
->
N_NATIONKEY
,

211 
de¡
->
N_NAME
,

212 
de¡
->
N_REGIONKEY
,

213 
de¡
->
N_COMMENT
);

214 
	}
}

225 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_qÇtiÚ
(cÚ¡ 
xù_id
, 
qÇtiÚ_šput_t
& 
š
)

227 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** SCAN NATION *********\n");

229 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

230 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

234 
tu¶e_fifo
* 
tsÿn_out_bufãr
 =

235 
Ãw
 
	`tu¶e_fifo
((
ch_ÇtiÚ_tu¶e
));

236 
tsÿn_·ck‘_t
* 
tsÿn_·ck‘
 =

237 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN NATION",

238 
tsÿn_out_bufãr
,

239 
Ãw
 
ch_qÇtiÚ
::
	`tsÿn_f‹r_t
(
this
,
š
),

240 
this
->
	`db
(),

241 
_²©iÚ_desc
.
	`g‘
(),

242 
pxù


247 
tu¶e_fifo
* 
fdump_ouut
 = 
Ãw
 
	`tu¶e_fifo
((
ch_ÇtiÚ_tu¶e
));

248 
fdump_·ck‘_t
* 
fdump_·ck‘
 =

249 
Ãw
 
	`fdump_·ck‘_t
(
	`c_¡r
("FDUMP"),

250 
fdump_ouut
,

251 
Ãw
 
	`ŒivŸl_f‹r_t
(
fdump_ouut
->
	`tu¶e_size
()),

252 
NULL
,

253 
	`c_¡r
("%s/ÇtiÚ.tbl", 
	`g‘’v
("HOME")),

254 
NULL
,

255 
tsÿn_·ck‘
,

256 
ch_qÇtiÚ
::
dump_tu¶e
);

260 
tu¶e_fifo
* 
couÁ_ouut_bufãr
 =

261 
Ãw
 
	`tu¶e_fifo
((
ch_qÇtiÚ
::
couÁ_tu¶e
));

262 
·ck‘_t
* 
couÁ_·ck‘
 =

263 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("COUNT",

264 
couÁ_ouut_bufãr
,

265 
Ãw
 
	`ŒivŸl_f‹r_t
(
couÁ_ouut_bufãr
->
	`tu¶e_size
()),

266 
fdump_·ck‘
,

267 
Ãw
 
ch_qÇtiÚ
::
	`couÁ_agg»g©e_t
(),

268 
Ãw
 
ch_qÇtiÚ
::
couÁ_agg»g©e_t
::
	`couÁ_key_exŒaùÜ_t
(),

269 
Ãw
 
	`št_key_com·»_t
());

271 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

272 
couÁ_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

273 
tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

276 
ch_qÇtiÚ
::
ch_ÇtiÚ_´oûss_tu¶e_t
 
±
;

277 
	`´oûss_qu”y
(
couÁ_·ck‘
, 
±
);

278 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

280  (
RCOK
);

281 
	}
}

284 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/qpipe/qpipe_tpch_qorders.cpp

32 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

33 
	~"qpe.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
usšg
 
Çme¥aû
 
	gqpe
;

40 
ENTER_NAMESPACE
(
ch
);

50 şas 
	cch_qÜd”s
{

52 
	mpublic
:

55 
	scouÁ_tu¶e
 {

56 
COUNT
;

62 şas 
	ctsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


64 
´iv©e
:

65 
ShÜeTPCHEnv
* 
_chdb
;

66 
bË_row_t
* 
	g_´Üd
;

67 
»p_row_t
 
	g_¼
;

69 
ch_Üd”s_tu¶e
 
	g_Üd”s
;

70 
	gpublic
:

72 
tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
qÜd”s_šput_t
 &
š
)

73 : 
tu¶e_f‹r_t
(
chdb
->
Üd”s_desc
()->
maxsize
()), 
_chdb
(tpchdb)

78 
	g_´Üd
 = 
_chdb
->
Üd”s_mª
()->
g‘_tu¶e
();

79 
	g_¼
.
£t_ts
(
_chdb
->
Üd”s_mª
()->
ts
(),

80 
_chdb
->
Üd”s_desc
()->
maxsize
());

81 
	g_´Üd
->
	g_»p
 = &
_¼
;

85 ~
tsÿn_f‹r_t
()

88 
	g_chdb
->
Üd”s_mª
()->
give_tu¶e
(
_´Üd
);

93 
boŞ
 
£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

96 ià(!
	g_chdb
->
Üd”s_mª
()->
lßd
(
_´Üd
, 
šput
.
d©a
)) {

97 
as£¹
(
çl£
);

100  (
	gŒue
);

105 
´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

107 
ch_Üd”s_tu¶e
 *
	gde¡
;

108 
	gde¡
 = 
®igÃd_ÿ¡
<
ch_Üd”s_tu¶e
>(
d
.
d©a
);

110 
	g_´Üd
->
g‘_v®ue
(0, 
_Üd”s
.
O_ORDERKEY
);

111 
	g_´Üd
->
g‘_v®ue
(1, 
_Üd”s
.
O_CUSTKEY
);

112 
	g_´Üd
->
g‘_v®ue
(2, 
_Üd”s
.
O_ORDERSTATUS
);

113 
	g_´Üd
->
g‘_v®ue
(3, 
_Üd”s
.
O_TOTALPRICE
);

114 
	g_´Üd
->
g‘_v®ue
(4, 
_Üd”s
.
O_ORDERDATE
,15);

115 
	g_´Üd
->
g‘_v®ue
(5, 
_Üd”s
.
O_ORDERPRIORITY
,15);

116 
	g_´Üd
->
g‘_v®ue
(6, 
_Üd”s
.
O_CLERK
,15);

117 
	g_´Üd
->
g‘_v®ue
(7, 
_Üd”s
.
O_SHIPPRIORITY
);

118 
	g_´Üd
->
g‘_v®ue
(8, 
_Üd”s
.
O_COMMENT
,79);

120 
memıy
(
de¡
,&
_Üd”s
,(
ch_Üd”s_tu¶e
));

122 ià(
	gde¡
->
	gO_ORDERKEY
<100000)

125 
TRACE
(
TRACE_ALWAYS
, "%d|\n",

126 
de¡
->
O_ORDERKEY
);

143 
tsÿn_f‹r_t
* 
şÚe
() const {

144  
Ãw
 
tsÿn_f‹r_t
(*
this
);

147 
c_¡r
 
to_¡ršg
() const {

148  
c_¡r
("tscan_filter_t");

155 şas 
	ccouÁ_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t


157 
public
:

159 şas 
	ccouÁ_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

160 
public
:

162 
couÁ_key_exŒaùÜ_t
()

163 : 
key_exŒaùÜ_t
(0, 0) {

167 
vœtu®
 
key_exŒaùÜ_t
* 
şÚe
() const {

168  
Ãw
 
couÁ_key_exŒaùÜ_t
(*
this
);

172 
	g´iv©e
:

173 
couÁ_key_exŒaùÜ_t
 
_exŒaùÜ
;

175 
	gpublic
:

177 
couÁ_agg»g©e_t
()

178 : 
tu¶e_agg»g©e_t
((
couÁ_tu¶e
))

182 
key_exŒaùÜ_t
* 
key_exŒaùÜ
(è{  &
_exŒaùÜ
; }

186 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
s
) {

187 
couÁ_tu¶e
* 
	gtu¶e
 = 
®igÃd_ÿ¡
<couÁ_tu¶e>(
agg_d©a
);

190 
	gtu¶e
->
	gCOUNT
++;

194 
fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

195 
couÁ_tu¶e
 *
	gde¡
;

196 
	gde¡
 = 
®igÃd_ÿ¡
<
couÁ_tu¶e
>(
d
.
d©a
);

197 
couÁ_tu¶e
* 
	gtu¶e
 = 
®igÃd_ÿ¡
<couÁ_tu¶e>(
agg_d©a
);

199 
	gde¡
->
	gCOUNT
=
tu¶e
->
COUNT
;

202 
couÁ_agg»g©e_t
* 
şÚe
() const {

203  
Ãw
 
couÁ_agg»g©e_t
(*
this
);

206 
c_¡r
 
to_¡ršg
() const {

212 şas 
	cch_Üd”s_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


214 
public
:

216 
begš
() {

217 
TRACE
(
TRACE_QUERY_RESULTS
, "*** SCAN ORDERS ANSWER ...\n");

218 
TRACE
(
TRACE_QUERY_RESULTS
, "*** COUNT ...\n");

221 
vœtu®
 
´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

222 
couÁ_tu¶e
 *
	gtu¶e
;

223 
	gtu¶e
 = 
®igÃd_ÿ¡
<
couÁ_tu¶e
>(
ouut
.
d©a
);

224 
TRACE
(
TRACE_QUERY_RESULTS
, "*** %d\n",

225 
tu¶e
->
COUNT
);

230 cÚ¡ 
c_¡r
* 
	$dump_o_tu¶e
(
tu¶e_t
* 
tup
) {

231 
ch_Üd”s_tu¶e
 *
de¡
;

232 
de¡
 = 
®igÃd_ÿ¡
<
ch_Üd”s_tu¶e
> (
tup
->
d©a
);

233  
Ãw
 
	`c_¡r
("%d|%d|%c|%lf|%s|%s|%s|%d|%s|\n",

234 
de¡
->
O_ORDERKEY
,

235 
de¡
->
O_CUSTKEY
,

236 
de¡
->
O_ORDERSTATUS
,

237 
de¡
->
O_TOTALPRICE
.
	`to_doubË
(),

238 
de¡
->
O_ORDERDATE
,

239 
de¡
->
O_ORDERPRIORITY
,

240 
de¡
->
O_CLERK
,

241 
de¡
->
O_SHIPPRIORITY
,

242 
de¡
->
O_COMMENT
);

243 
	}
}

254 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_qÜd”s
(cÚ¡ 
xù_id
, 
qÜd”s_šput_t
& 
š
)

256 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** SCAN ORDERS *********\n");

258 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

259 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

263 
tu¶e_fifo
* 
tsÿn_out_bufãr
 =

264 
Ãw
 
	`tu¶e_fifo
((
ch_Üd”s_tu¶e
));

265 
tsÿn_·ck‘_t
* 
tsÿn_·ck‘
 =

266 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN ORDERS",

267 
tsÿn_out_bufãr
,

268 
Ãw
 
ch_qÜd”s
::
	`tsÿn_f‹r_t
(
this
,
š
),

269 
this
->
	`db
(),

270 
_pÜd”s_desc
.
	`g‘
(),

271 
pxù


276 
tu¶e_fifo
* 
fdump_ouut
 = 
Ãw
 
	`tu¶e_fifo
((
ch_Üd”s_tu¶e
));

277 
fdump_·ck‘_t
* 
fdump_·ck‘
 =

278 
Ãw
 
	`fdump_·ck‘_t
(
	`c_¡r
("FDUMP"),

279 
fdump_ouut
,

280 
Ãw
 
	`ŒivŸl_f‹r_t
(
fdump_ouut
->
	`tu¶e_size
()),

281 
NULL
,

282 
	`c_¡r
("%s/Üd”s.tbl", 
	`g‘’v
("HOME")),

283 
NULL
,

284 
tsÿn_·ck‘
,

285 
ch_qÜd”s
::
dump_o_tu¶e
);

290 
tu¶e_fifo
* 
couÁ_ouut_bufãr
 =

291 
Ãw
 
	`tu¶e_fifo
((
ch_qÜd”s
::
couÁ_tu¶e
));

292 
·ck‘_t
* 
couÁ_·ck‘
 =

293 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("COUNT",

294 
couÁ_ouut_bufãr
,

295 
Ãw
 
	`ŒivŸl_f‹r_t
(
couÁ_ouut_bufãr
->
	`tu¶e_size
()),

296 
fdump_·ck‘
,

298 
Ãw
 
ch_qÜd”s
::
	`couÁ_agg»g©e_t
(),

299 
Ãw
 
ch_qÜd”s
::
couÁ_agg»g©e_t
::
	`couÁ_key_exŒaùÜ_t
(),

300 
Ãw
 
	`št_key_com·»_t
());

302 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

303 
tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

304 
fdump_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

305 
couÁ_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

308 
ch_qÜd”s
::
ch_Üd”s_´oûss_tu¶e_t
 
±
;

309 
	`´oûss_qu”y
(
couÁ_·ck‘
, 
±
);

310 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

312  (
RCOK
);

313 
	}
}

316 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/qpipe/qpipe_tpch_qpart.cpp

32 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

33 
	~"qpe.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
usšg
 
Çme¥aû
 
	gqpe
;

40 
ENTER_NAMESPACE
(
ch
);

50 şas 
	cch_q·¹
{

52 
	mpublic
:

55 
	scouÁ_tu¶e
 {

56 
COUNT
;

62 şas 
	ctsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


64 
´iv©e
:

65 
ShÜeTPCHEnv
* 
_chdb
;

66 
bË_row_t
* 
	g_´·¹
;

67 
»p_row_t
 
	g_¼
;

69 
ch_·¹_tu¶e
 
	g_·¹
;

70 
	gpublic
:

72 
tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q·¹_šput_t
 &
š
)

73 : 
tu¶e_f‹r_t
(
chdb
->
·¹_desc
()->
maxsize
()), 
_chdb
(tpchdb)

78 
	g_´·¹
 = 
_chdb
->
·¹_mª
()->
g‘_tu¶e
();

79 
	g_¼
.
£t_ts
(
_chdb
->
·¹_mª
()->
ts
(),

80 
_chdb
->
·¹_desc
()->
maxsize
());

81 
	g_´·¹
->
	g_»p
 = &
_¼
;

85 ~
tsÿn_f‹r_t
()

88 
	g_chdb
->
·¹_mª
()->
give_tu¶e
(
_´·¹
);

93 
boŞ
 
£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

96 ià(!
	g_chdb
->
·¹_mª
()->
lßd
(
_´·¹
, 
šput
.
d©a
)) {

97 
as£¹
(
çl£
);

100  (
	gŒue
);

105 
´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

107 
ch_·¹_tu¶e
 *
	gde¡
;

108 
	gde¡
 = 
®igÃd_ÿ¡
<
ch_·¹_tu¶e
>(
d
.
d©a
);

110 
	g_´·¹
->
g‘_v®ue
(0, 
_·¹
.
P_PARTKEY
);

111 
	g_´·¹
->
g‘_v®ue
(1, 
_·¹
.
P_NAME
,55);

112 
	g_´·¹
->
g‘_v®ue
(2, 
_·¹
.
P_MFGR
,25);

113 
	g_´·¹
->
g‘_v®ue
(3, 
_·¹
.
P_BRAND
,10);

114 
	g_´·¹
->
g‘_v®ue
(4, 
_·¹
.
P_TYPE
,25);

115 
	g_´·¹
->
g‘_v®ue
(5, 
_·¹
.
P_SIZE
);

116 
	g_´·¹
->
g‘_v®ue
(6, 
_·¹
.
P_CONTAINER
,10);

117 
	g_´·¹
->
g‘_v®ue
(7, 
_·¹
.
P_RETAILPRICE
);

118 
	g_´·¹
->
g‘_v®ue
(8, 
_·¹
.
P_COMMENT
,23);

120 
memıy
(
de¡
,&
_·¹
,(
ch_·¹_tu¶e
));

121 ià(
	gde¡
->
	gP_PARTKEY
%10000==0)

122 
TRACE
(
TRACE_RECORD_FLOW
, "%d %s\n", 
de¡
->
P_PARTKEY
, de¡->
P_NAME
);

126 
tsÿn_f‹r_t
* 
şÚe
() const {

127  
Ãw
 
tsÿn_f‹r_t
(*
this
);

130 
c_¡r
 
to_¡ršg
() const {

131  
c_¡r
("tscan_filter_t");

138 şas 
	ccouÁ_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t


140 
public
:

142 şas 
	ccouÁ_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

143 
public
:

145 
couÁ_key_exŒaùÜ_t
()

146 : 
key_exŒaùÜ_t
(0, 0) {

150 
vœtu®
 
key_exŒaùÜ_t
* 
şÚe
() const {

151  
Ãw
 
couÁ_key_exŒaùÜ_t
(*
this
);

155 
	g´iv©e
:

156 
couÁ_key_exŒaùÜ_t
 
_exŒaùÜ
;

158 
	gpublic
:

160 
couÁ_agg»g©e_t
()

161 : 
tu¶e_agg»g©e_t
((
couÁ_tu¶e
))

165 
key_exŒaùÜ_t
* 
key_exŒaùÜ
(è{  &
_exŒaùÜ
; }

169 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
s
) {

170 
couÁ_tu¶e
* 
	gtu¶e
 = 
®igÃd_ÿ¡
<couÁ_tu¶e>(
agg_d©a
);

173 
	gtu¶e
->
	gCOUNT
++;

177 
fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

178 
couÁ_tu¶e
 *
	gde¡
;

179 
	gde¡
 = 
®igÃd_ÿ¡
<
couÁ_tu¶e
>(
d
.
d©a
);

180 
couÁ_tu¶e
* 
	gtu¶e
 = 
®igÃd_ÿ¡
<couÁ_tu¶e>(
agg_d©a
);

182 
	gde¡
->
	gCOUNT
=
tu¶e
->
COUNT
;

185 
couÁ_agg»g©e_t
* 
şÚe
() const {

186  
Ãw
 
couÁ_agg»g©e_t
(*
this
);

189 
c_¡r
 
to_¡ršg
() const {

195 şas 
	cch_·¹_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


197 
public
:

199 
begš
() {

200 
TRACE
(
TRACE_QUERY_RESULTS
, "*** SCAN PARTS ANSWER ...\n");

201 
TRACE
(
TRACE_QUERY_RESULTS
, "*** COUNT ...\n");

204 
vœtu®
 
´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

205 
couÁ_tu¶e
 *
	gtu¶e
;

206 
	gtu¶e
 = 
®igÃd_ÿ¡
<
couÁ_tu¶e
>(
ouut
.
d©a
);

207 
TRACE
(
TRACE_QUERY_RESULTS
, "*** %d\n",

208 
tu¶e
->
COUNT
);

212 cÚ¡ 
c_¡r
* 
	$dump_tu¶e
(
tu¶e_t
* 
tup
) {

213 
ch_·¹_tu¶e
 *
de¡
;

214 
de¡
 = 
®igÃd_ÿ¡
<
ch_·¹_tu¶e
> (
tup
->
d©a
);

215  
Ãw
 
	`c_¡r
("%d|%s|%s|%s|%s|%d|%s|%lf|%s|\n",

216 
de¡
->
P_PARTKEY
,

217 
de¡
->
P_NAME
,

218 
de¡
->
P_MFGR
,

219 
de¡
->
P_BRAND
,

220 
de¡
->
P_TYPE
,

221 
de¡
->
P_SIZE
,

222 
de¡
->
P_CONTAINER
,

223 
de¡
->
P_RETAILPRICE
.
	`to_doubË
(),

224 
de¡
->
P_COMMENT
);

225 
	}
}

236 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_q·¹
(cÚ¡ 
xù_id
, 
q·¹_šput_t
& 
š
)

238 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** SCAN PARTS *********\n");

240 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

241 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

245 
tu¶e_fifo
* 
tsÿn_out_bufãr
 =

246 
Ãw
 
	`tu¶e_fifo
((
ch_·¹_tu¶e
));

247 
tsÿn_·ck‘_t
* 
tsÿn_·ck‘
 =

248 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN PARTS",

249 
tsÿn_out_bufãr
,

250 
Ãw
 
ch_q·¹
::
	`tsÿn_f‹r_t
(
this
,
š
),

251 
this
->
	`db
(),

252 
_µ¬t_desc
.
	`g‘
(),

253 
pxù


257 
tu¶e_fifo
* 
fdump_ouut
 = 
Ãw
 
	`tu¶e_fifo
((
ch_·¹_tu¶e
));

258 
fdump_·ck‘_t
* 
fdump_·ck‘
 =

259 
Ãw
 
	`fdump_·ck‘_t
(
	`c_¡r
("FDUMP"),

260 
fdump_ouut
,

261 
Ãw
 
	`ŒivŸl_f‹r_t
(
fdump_ouut
->
	`tu¶e_size
()),

262 
NULL
,

263 
	`c_¡r
("%s/·¹.tbl", 
	`g‘’v
("HOME")),

264 
NULL
,

265 
tsÿn_·ck‘
,

266 
ch_q·¹
::
dump_tu¶e
);

269 
tu¶e_fifo
* 
couÁ_ouut_bufãr
 =

270 
Ãw
 
	`tu¶e_fifo
((
ch_q·¹
::
couÁ_tu¶e
));

271 
·ck‘_t
* 
couÁ_·ck‘
 =

272 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("COUNT",

273 
couÁ_ouut_bufãr
,

274 
Ãw
 
	`ŒivŸl_f‹r_t
(
couÁ_ouut_bufãr
->
	`tu¶e_size
()),

275 
fdump_·ck‘
,

276 
Ãw
 
ch_q·¹
::
	`couÁ_agg»g©e_t
(),

277 
Ãw
 
ch_q·¹
::
couÁ_agg»g©e_t
::
	`couÁ_key_exŒaùÜ_t
(),

278 
Ãw
 
	`št_key_com·»_t
());

280 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

281 
couÁ_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

282 
fdump_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

283 
tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

286 
ch_q·¹
::
ch_·¹_´oûss_tu¶e_t
 
±
;

287 
	`´oûss_qu”y
(
couÁ_·ck‘
, 
±
);

288 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

290  (
RCOK
);

291 
	}
}

294 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/qpipe/qpipe_tpch_qpartsupp.cpp

32 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

33 
	~"qpe.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
usšg
 
Çme¥aû
 
	gqpe
;

40 
ENTER_NAMESPACE
(
ch
);

50 şas 
	cch_q·¹suµ
{

52 
	mpublic
:

55 
	scouÁ_tu¶e
 {

56 
COUNT
;

62 şas 
	ctsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


64 
´iv©e
:

65 
ShÜeTPCHEnv
* 
_chdb
;

66 
bË_row_t
* 
	g_´·¹suµ
;

67 
»p_row_t
 
	g_¼
;

69 
ch_·¹suµ_tu¶e
 
	g_·¹suµ
;

70 
	gpublic
:

72 
tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q·¹suµ_šput_t
 &
š
)

73 : 
tu¶e_f‹r_t
(
chdb
->
·¹suµ_desc
()->
maxsize
()), 
_chdb
(tpchdb)

78 
	g_´·¹suµ
 = 
_chdb
->
·¹suµ_mª
()->
g‘_tu¶e
();

79 
	g_¼
.
£t_ts
(
_chdb
->
·¹suµ_mª
()->
ts
(),

80 
_chdb
->
·¹suµ_desc
()->
maxsize
());

81 
	g_´·¹suµ
->
	g_»p
 = &
_¼
;

85 ~
tsÿn_f‹r_t
()

88 
	g_chdb
->
·¹suµ_mª
()->
give_tu¶e
(
_´·¹suµ
);

93 
boŞ
 
£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

96 ià(!
	g_chdb
->
·¹suµ_mª
()->
lßd
(
_´·¹suµ
, 
šput
.
d©a
)) {

97 
as£¹
(
çl£
);

100  (
	gŒue
);

105 
´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

107 
ch_·¹suµ_tu¶e
 *
	gde¡
;

108 
	gde¡
 = 
®igÃd_ÿ¡
<
ch_·¹suµ_tu¶e
>(
d
.
d©a
);

110 
	g_´·¹suµ
->
g‘_v®ue
(0, 
_·¹suµ
.
PS_PARTKEY
);

111 
	g_´·¹suµ
->
g‘_v®ue
(1, 
_·¹suµ
.
PS_SUPPKEY
);

112 
	g_´·¹suµ
->
g‘_v®ue
(2, 
_·¹suµ
.
PS_AVAILQTY
);

113 
	g_´·¹suµ
->
g‘_v®ue
(3, 
_·¹suµ
.
PS_SUPPLYCOST
);

114 
	g_´·¹suµ
->
g‘_v®ue
(4, 
_·¹suµ
.
PS_COMMENT
,199);

117 
memıy
(
de¡
,&
_·¹suµ
,(
ch_·¹suµ_tu¶e
));

118 ià(
	gde¡
->
	gPS_PARTKEY
%100000==0)

119 
TRACE
(
TRACE_RECORD_FLOW
, "%d %d\n", 
de¡
->
PS_PARTKEY
, de¡->
PS_SUPPKEY
);

122 
tsÿn_f‹r_t
* 
şÚe
() const {

123  
Ãw
 
tsÿn_f‹r_t
(*
this
);

126 
c_¡r
 
to_¡ršg
() const {

127  
c_¡r
("tscan_filter_t");

134 şas 
	ccouÁ_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t


136 
public
:

138 şas 
	ccouÁ_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

139 
public
:

141 
couÁ_key_exŒaùÜ_t
()

142 : 
key_exŒaùÜ_t
(0, 0) {

146 
vœtu®
 
key_exŒaùÜ_t
* 
şÚe
() const {

147  
Ãw
 
couÁ_key_exŒaùÜ_t
(*
this
);

151 
	g´iv©e
:

152 
couÁ_key_exŒaùÜ_t
 
_exŒaùÜ
;

154 
	gpublic
:

156 
couÁ_agg»g©e_t
()

157 : 
tu¶e_agg»g©e_t
((
couÁ_tu¶e
))

161 
key_exŒaùÜ_t
* 
key_exŒaùÜ
(è{  &
_exŒaùÜ
; }

165 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
s
) {

166 
couÁ_tu¶e
* 
	gtu¶e
 = 
®igÃd_ÿ¡
<couÁ_tu¶e>(
agg_d©a
);

169 
	gtu¶e
->
	gCOUNT
++;

173 
fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

174 
couÁ_tu¶e
 *
	gde¡
;

175 
	gde¡
 = 
®igÃd_ÿ¡
<
couÁ_tu¶e
>(
d
.
d©a
);

176 
couÁ_tu¶e
* 
	gtu¶e
 = 
®igÃd_ÿ¡
<couÁ_tu¶e>(
agg_d©a
);

178 
	gde¡
->
	gCOUNT
=
tu¶e
->
COUNT
;

181 
couÁ_agg»g©e_t
* 
şÚe
() const {

182  
Ãw
 
couÁ_agg»g©e_t
(*
this
);

185 
c_¡r
 
to_¡ršg
() const {

191 şas 
	cch_·¹suµ_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


193 
public
:

195 
begš
() {

196 
TRACE
(
TRACE_QUERY_RESULTS
, "*** SCAN PARTSUPPS ANSWER ...\n");

197 
TRACE
(
TRACE_QUERY_RESULTS
, "*** COUNT ...\n");

200 
vœtu®
 
´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

201 
couÁ_tu¶e
 *
	gtu¶e
;

202 
	gtu¶e
 = 
®igÃd_ÿ¡
<
couÁ_tu¶e
>(
ouut
.
d©a
);

203 
TRACE
(
TRACE_QUERY_RESULTS
, "*** %d\n",

204 
tu¶e
->
COUNT
);

208 cÚ¡ 
c_¡r
* 
	$dump_tu¶e
(
tu¶e_t
* 
tup
) {

209 
ch_·¹suµ_tu¶e
 *
de¡
;

210 
de¡
 = 
®igÃd_ÿ¡
<
ch_·¹suµ_tu¶e
> (
tup
->
d©a
);

211  
Ãw
 
	`c_¡r
("%d|%d|%d|%lf|%s|\n",

212 
de¡
->
PS_PARTKEY
,

213 
de¡
->
PS_SUPPKEY
,

214 
de¡
->
PS_AVAILQTY
,

215 
de¡
->
PS_SUPPLYCOST
.
	`to_doubË
(),

216 
de¡
->
PS_COMMENT
);

217 
	}
}

228 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_q·¹suµ
(cÚ¡ 
xù_id
, 
q·¹suµ_šput_t
& 
š
)

230 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** SCAN PARTSUPPS *********\n");

232 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

233 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

237 
tu¶e_fifo
* 
tsÿn_out_bufãr
 =

238 
Ãw
 
	`tu¶e_fifo
((
ch_·¹suµ_tu¶e
));

239 
tsÿn_·ck‘_t
* 
tsÿn_·ck‘
 =

240 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN PARTSUPPS",

241 
tsÿn_out_bufãr
,

242 
Ãw
 
ch_q·¹suµ
::
	`tsÿn_f‹r_t
(
this
,
š
),

243 
this
->
	`db
(),

244 
_µ¬tsuµ_desc
.
	`g‘
(),

245 
pxù


250 
tu¶e_fifo
* 
fdump_ouut
 = 
Ãw
 
	`tu¶e_fifo
((
ch_·¹suµ_tu¶e
));

251 
fdump_·ck‘_t
* 
fdump_·ck‘
 =

252 
Ãw
 
	`fdump_·ck‘_t
(
	`c_¡r
("FDUMP"),

253 
fdump_ouut
,

254 
Ãw
 
	`ŒivŸl_f‹r_t
(
fdump_ouut
->
	`tu¶e_size
()),

255 
NULL
,

256 
	`c_¡r
("%s/·¹suµ.tbl", 
	`g‘’v
("HOME")),

257 
NULL
,

258 
tsÿn_·ck‘
,

259 
ch_q·¹suµ
::
dump_tu¶e
);

263 
tu¶e_fifo
* 
couÁ_ouut_bufãr
 =

264 
Ãw
 
	`tu¶e_fifo
((
ch_q·¹suµ
::
couÁ_tu¶e
));

265 
·ck‘_t
* 
couÁ_·ck‘
 =

266 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("COUNT",

267 
couÁ_ouut_bufãr
,

268 
Ãw
 
	`ŒivŸl_f‹r_t
(
couÁ_ouut_bufãr
->
	`tu¶e_size
()),

269 
fdump_·ck‘
,

270 
Ãw
 
ch_q·¹suµ
::
	`couÁ_agg»g©e_t
(),

271 
Ãw
 
ch_q·¹suµ
::
couÁ_agg»g©e_t
::
	`couÁ_key_exŒaùÜ_t
(),

272 
Ãw
 
	`št_key_com·»_t
());

274 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

275 
couÁ_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

276 
fdump_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

277 
tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

280 
ch_q·¹suµ
::
ch_·¹suµ_´oûss_tu¶e_t
 
±
;

281 
	`´oûss_qu”y
(
couÁ_·ck‘
, 
±
);

282 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

284  (
RCOK
);

285 
	}
}

288 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/qpipe/qpipe_tpch_qregion.cpp

32 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

33 
	~"qpe.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
usšg
 
Çme¥aû
 
	gqpe
;

40 
ENTER_NAMESPACE
(
ch
);

50 şas 
	cch_q»giÚ
{

52 
	mpublic
:

55 
	scouÁ_tu¶e
 {

56 
COUNT
;

62 şas 
	ctsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


64 
´iv©e
:

65 
ShÜeTPCHEnv
* 
_chdb
;

66 
bË_row_t
* 
	g_´Çt
;

67 
»p_row_t
 
	g_¼
;

69 
ch_»giÚ_tu¶e
 
	g_»giÚ
;

70 
	gpublic
:

72 
tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
q»giÚ_šput_t
 &
š
)

73 : 
tu¶e_f‹r_t
(
chdb
->
»giÚ_desc
()->
maxsize
()), 
_chdb
(tpchdb)

78 
	g_´Çt
 = 
_chdb
->
»giÚ_mª
()->
g‘_tu¶e
();

79 
	g_¼
.
£t_ts
(
_chdb
->
»giÚ_mª
()->
ts
(),

80 
_chdb
->
»giÚ_desc
()->
maxsize
());

81 
	g_´Çt
->
	g_»p
 = &
_¼
;

85 ~
tsÿn_f‹r_t
()

88 
	g_chdb
->
»giÚ_mª
()->
give_tu¶e
(
_´Çt
);

93 
boŞ
 
£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

96 ià(!
	g_chdb
->
»giÚ_mª
()->
lßd
(
_´Çt
, 
šput
.
d©a
)) {

97 
as£¹
(
çl£
);

100  (
	gŒue
);

105 
´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

107 
ch_»giÚ_tu¶e
 *
	gde¡
;

108 
	gde¡
 = 
®igÃd_ÿ¡
<
ch_»giÚ_tu¶e
>(
d
.
d©a
);

110 
	g_´Çt
->
g‘_v®ue
(0, 
_»giÚ
.
R_REGIONKEY
);

111 
	g_´Çt
->
g‘_v®ue
(1, 
_»giÚ
.
R_NAME
, 25);

112 
	g_´Çt
->
g‘_v®ue
(2, 
_»giÚ
.
R_COMMENT
, 25);

114 
memıy
(
de¡
,&
_»giÚ
,(
ch_»giÚ_tu¶e
));

115 
TRACE
(
TRACE_RECORD_FLOW
, "%d %s\n", 
de¡
->
R_REGIONKEY
, de¡->
R_NAME
);

118 
tsÿn_f‹r_t
* 
şÚe
() const {

119  
Ãw
 
tsÿn_f‹r_t
(*
this
);

122 
c_¡r
 
to_¡ršg
() const {

123  
c_¡r
("tscan_filter_t");

130 şas 
	ccouÁ_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t


132 
public
:

134 şas 
	ccouÁ_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

135 
public
:

137 
couÁ_key_exŒaùÜ_t
()

138 : 
key_exŒaùÜ_t
(0, 0) {

142 
vœtu®
 
key_exŒaùÜ_t
* 
şÚe
() const {

143  
Ãw
 
couÁ_key_exŒaùÜ_t
(*
this
);

147 
	g´iv©e
:

148 
couÁ_key_exŒaùÜ_t
 
_exŒaùÜ
;

150 
	gpublic
:

152 
couÁ_agg»g©e_t
()

153 : 
tu¶e_agg»g©e_t
((
couÁ_tu¶e
))

157 
key_exŒaùÜ_t
* 
key_exŒaùÜ
(è{  &
_exŒaùÜ
; }

161 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
s
) {

162 
couÁ_tu¶e
* 
	gtu¶e
 = 
®igÃd_ÿ¡
<couÁ_tu¶e>(
agg_d©a
);

165 
	gtu¶e
->
	gCOUNT
++;

169 
fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

170 
couÁ_tu¶e
 *
	gde¡
;

171 
	gde¡
 = 
®igÃd_ÿ¡
<
couÁ_tu¶e
>(
d
.
d©a
);

172 
couÁ_tu¶e
* 
	gtu¶e
 = 
®igÃd_ÿ¡
<couÁ_tu¶e>(
agg_d©a
);

174 
	gde¡
->
	gCOUNT
=
tu¶e
->
COUNT
;

177 
couÁ_agg»g©e_t
* 
şÚe
() const {

178  
Ãw
 
couÁ_agg»g©e_t
(*
this
);

181 
c_¡r
 
to_¡ršg
() const {

187 şas 
	cch_»giÚ_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


189 
public
:

191 
begš
() {

192 
TRACE
(
TRACE_QUERY_RESULTS
, "*** SCAN REGION ANSWER ...\n");

193 
TRACE
(
TRACE_QUERY_RESULTS
, "*** COUNT ...\n");

196 
vœtu®
 
´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

197 
couÁ_tu¶e
 *
	gtu¶e
;

198 
	gtu¶e
 = 
®igÃd_ÿ¡
<
couÁ_tu¶e
>(
ouut
.
d©a
);

199 
TRACE
(
TRACE_QUERY_RESULTS
, "*** %d\n",

200 
tu¶e
->
COUNT
);

204 cÚ¡ 
c_¡r
* 
	$dump_tu¶e
(
tu¶e_t
* 
tup
) {

205 
ch_»giÚ_tu¶e
 *
de¡
;

206 
de¡
 = 
®igÃd_ÿ¡
<
ch_»giÚ_tu¶e
> (
tup
->
d©a
);

207  
Ãw
 
	`c_¡r
("%d|%s|%s|\n",

208 
de¡
->
R_REGIONKEY
,

209 
de¡
->
R_NAME
,

210 
de¡
->
R_COMMENT
);

211 
	}
}

222 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_q»giÚ
(cÚ¡ 
xù_id
, 
q»giÚ_šput_t
& 
š
)

224 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** SCAN REGION *********\n");

226 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

227 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

231 
tu¶e_fifo
* 
tsÿn_out_bufãr
 =

232 
Ãw
 
	`tu¶e_fifo
((
ch_»giÚ_tu¶e
));

233 
tsÿn_·ck‘_t
* 
tsÿn_·ck‘
 =

234 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN REGION",

235 
tsÿn_out_bufãr
,

236 
Ãw
 
ch_q»giÚ
::
	`tsÿn_f‹r_t
(
this
,
š
),

237 
this
->
	`db
(),

238 
_´egiÚ_desc
.
	`g‘
(),

239 
pxù


243 
tu¶e_fifo
* 
fdump_ouut
 = 
Ãw
 
	`tu¶e_fifo
((
ch_»giÚ_tu¶e
));

244 
fdump_·ck‘_t
* 
fdump_·ck‘
 =

245 
Ãw
 
	`fdump_·ck‘_t
(
	`c_¡r
("FDUMP"),

246 
fdump_ouut
,

247 
Ãw
 
	`ŒivŸl_f‹r_t
(
fdump_ouut
->
	`tu¶e_size
()),

248 
NULL
,

249 
	`c_¡r
("%s/»giÚ.tbl", 
	`g‘’v
("HOME")),

250 
NULL
,

251 
tsÿn_·ck‘
,

252 
ch_q»giÚ
::
dump_tu¶e
);

256 
tu¶e_fifo
* 
couÁ_ouut_bufãr
 =

257 
Ãw
 
	`tu¶e_fifo
((
ch_q»giÚ
::
couÁ_tu¶e
));

258 
·ck‘_t
* 
couÁ_·ck‘
 =

259 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("COUNT",

260 
couÁ_ouut_bufãr
,

261 
Ãw
 
	`ŒivŸl_f‹r_t
(
couÁ_ouut_bufãr
->
	`tu¶e_size
()),

262 
fdump_·ck‘
,

263 
Ãw
 
ch_q»giÚ
::
	`couÁ_agg»g©e_t
(),

264 
Ãw
 
ch_q»giÚ
::
couÁ_agg»g©e_t
::
	`couÁ_key_exŒaùÜ_t
(),

265 
Ãw
 
	`št_key_com·»_t
());

267 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

268 
couÁ_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

269 
tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

272 
ch_q»giÚ
::
ch_»giÚ_´oûss_tu¶e_t
 
±
;

273 
	`´oûss_qu”y
(
couÁ_·ck‘
, 
±
);

274 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

276  (
RCOK
);

277 
	}
}

280 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/qpipe/qpipe_tpch_qsupplier.cpp

32 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

33 
	~"qpe.h
"

35 
usšg
 
Çme¥aû
 
	gshÜe
;

36 
usšg
 
Çme¥aû
 
	gqpe
;

40 
ENTER_NAMESPACE
(
ch
);

50 şas 
	cch_qsuµl›r
{

52 
	mpublic
:

55 
	scouÁ_tu¶e
 {

56 
COUNT
;

62 şas 
	ctsÿn_f‹r_t
 : 
public
 
tu¶e_f‹r_t


64 
´iv©e
:

65 
ShÜeTPCHEnv
* 
_chdb
;

66 
bË_row_t
* 
	g_´suµl›r
;

67 
»p_row_t
 
	g_¼
;

69 
ch_suµl›r_tu¶e
 
	g_suµl›r
;

70 
	gpublic
:

72 
tsÿn_f‹r_t
(
ShÜeTPCHEnv
* 
chdb
, 
qsuµl›r_šput_t
 &
š
)

73 : 
tu¶e_f‹r_t
(
chdb
->
suµl›r_desc
()->
maxsize
()), 
_chdb
(tpchdb)

78 
	g_´suµl›r
 = 
_chdb
->
suµl›r_mª
()->
g‘_tu¶e
();

79 
	g_¼
.
£t_ts
(
_chdb
->
suµl›r_mª
()->
ts
(),

80 
_chdb
->
suµl›r_desc
()->
maxsize
());

81 
	g_´suµl›r
->
	g_»p
 = &
_¼
;

85 ~
tsÿn_f‹r_t
()

88 
	g_chdb
->
suµl›r_mª
()->
give_tu¶e
(
_´suµl›r
);

93 
boŞ
 
£Ëù
(cÚ¡ 
tu¶e_t
 &
šput
) {

96 ià(!
	g_chdb
->
suµl›r_mª
()->
lßd
(
_´suµl›r
, 
šput
.
d©a
)) {

97 
as£¹
(
çl£
);

100  (
	gŒue
);

105 
´ojeù
(
tu¶e_t
 &
d
, cÚ¡u¶e_ˆ&
s
) {

107 
ch_suµl›r_tu¶e
 *
	gde¡
;

108 
	gde¡
 = 
®igÃd_ÿ¡
<
ch_suµl›r_tu¶e
>(
d
.
d©a
);

110 
	g_´suµl›r
->
g‘_v®ue
(0, 
_suµl›r
.
S_SUPPKEY
);

111 
	g_´suµl›r
->
g‘_v®ue
(1, 
_suµl›r
.
S_NAME
, 25);

112 
	g_´suµl›r
->
g‘_v®ue
(2, 
_suµl›r
.
S_ADDRESS
, 40);

113 
	g_´suµl›r
->
g‘_v®ue
(3, 
_suµl›r
.
S_NATIONKEY
);

114 
	g_´suµl›r
->
g‘_v®ue
(4, 
_suµl›r
.
S_PHONE
,15);

115 
	g_´suµl›r
->
g‘_v®ue
(5, 
_suµl›r
.
S_ACCTBAL
);

116 
	g_´suµl›r
->
g‘_v®ue
(6, 
_suµl›r
.
S_COMMENT
,101);

118 
memıy
(
de¡
,&
_suµl›r
,(
ch_suµl›r_tu¶e
));

119 ià(
	gde¡
->
	gS_SUPPKEY
%10000==0)

120 
TRACE
(
TRACE_RECORD_FLOW
, "%d %s\n", 
de¡
->
S_SUPPKEY
, de¡->
S_NAME
);

123 
tsÿn_f‹r_t
* 
şÚe
() const {

124  
Ãw
 
tsÿn_f‹r_t
(*
this
);

127 
c_¡r
 
to_¡ršg
() const {

128  
c_¡r
("tscan_filter_t");

135 şas 
	ccouÁ_agg»g©e_t
 : 
public
 
tu¶e_agg»g©e_t


137 
public
:

139 şas 
	ccouÁ_key_exŒaùÜ_t
 : 
public
 
key_exŒaùÜ_t
 {

140 
public
:

142 
couÁ_key_exŒaùÜ_t
()

143 : 
key_exŒaùÜ_t
(0, 0) {

147 
vœtu®
 
key_exŒaùÜ_t
* 
şÚe
() const {

148  
Ãw
 
couÁ_key_exŒaùÜ_t
(*
this
);

152 
	g´iv©e
:

153 
couÁ_key_exŒaùÜ_t
 
_exŒaùÜ
;

155 
	gpublic
:

157 
couÁ_agg»g©e_t
()

158 : 
tu¶e_agg»g©e_t
((
couÁ_tu¶e
))

162 
key_exŒaùÜ_t
* 
key_exŒaùÜ
(è{  &
_exŒaùÜ
; }

166 
agg»g©e
(* 
agg_d©a
, cÚ¡ 
tu¶e_t
 &
s
) {

167 
couÁ_tu¶e
* 
	gtu¶e
 = 
®igÃd_ÿ¡
<couÁ_tu¶e>(
agg_d©a
);

170 
	gtu¶e
->
	gCOUNT
++;

174 
fšish
(
tu¶e_t
 &
d
, cÚ¡ * 
agg_d©a
) {

175 
couÁ_tu¶e
 *
	gde¡
;

176 
	gde¡
 = 
®igÃd_ÿ¡
<
couÁ_tu¶e
>(
d
.
d©a
);

177 
couÁ_tu¶e
* 
	gtu¶e
 = 
®igÃd_ÿ¡
<couÁ_tu¶e>(
agg_d©a
);

179 
	gde¡
->
	gCOUNT
=
tu¶e
->
COUNT
;

182 
couÁ_agg»g©e_t
* 
şÚe
() const {

183  
Ãw
 
couÁ_agg»g©e_t
(*
this
);

186 
c_¡r
 
to_¡ršg
() const {

192 şas 
	cch_suµl›r_´oûss_tu¶e_t
 : 
public
 
´oûss_tu¶e_t


194 
public
:

196 
begš
() {

197 
TRACE
(
TRACE_QUERY_RESULTS
, "*** SCAN SUPPLIERS ANSWER ...\n");

198 
TRACE
(
TRACE_QUERY_RESULTS
, "*** COUNT ...\n");

201 
vœtu®
 
´oûss
(cÚ¡ 
tu¶e_t
& 
ouut
) {

202 
couÁ_tu¶e
 *
	gtu¶e
;

203 
	gtu¶e
 = 
®igÃd_ÿ¡
<
couÁ_tu¶e
>(
ouut
.
d©a
);

204 
TRACE
(
TRACE_QUERY_RESULTS
, "*** %d\n",

205 
tu¶e
->
COUNT
);

209 cÚ¡ 
c_¡r
* 
	$dump_tu¶e
(
tu¶e_t
* 
tup
) {

210 
ch_suµl›r_tu¶e
 *
de¡
;

211 
de¡
 = 
®igÃd_ÿ¡
<
ch_suµl›r_tu¶e
> (
tup
->
d©a
);

212  
Ãw
 
	`c_¡r
("%d|%s|%s|%d|%s|%lf|%s|\n",

213 
de¡
->
S_SUPPKEY
,

214 
de¡
->
S_NAME
,

215 
de¡
->
S_ADDRESS
,

216 
de¡
->
S_NATIONKEY
,

217 
de¡
->
S_PHONE
,

218 
de¡
->
S_ACCTBAL
.
	`to_doubË
(),

219 
de¡
->
S_COMMENT
);

220 
	}
}

231 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qpe_qsuµl›r
(cÚ¡ 
xù_id
, 
qsuµl›r_šput_t
& 
š
)

233 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** SCAN SUPPLIERS *********\n");

235 
pŞicy_t
* 
dp
 = 
this
->
	`g‘_sched_pŞicy
();

236 
xù_t
* 
pxù
 = 
smth»ad_t
::
	`me
()->
	`xù
();

240 
tu¶e_fifo
* 
tsÿn_out_bufãr
 =

241 
Ãw
 
	`tu¶e_fifo
((
ch_suµl›r_tu¶e
));

242 
tsÿn_·ck‘_t
* 
tsÿn_·ck‘
 =

243 
Ãw
 
	`tsÿn_·ck‘_t
("TSCAN SUPPLIERS",

244 
tsÿn_out_bufãr
,

245 
Ãw
 
ch_qsuµl›r
::
	`tsÿn_f‹r_t
(
this
,
š
),

246 
this
->
	`db
(),

247 
_psuµl›r_desc
.
	`g‘
(),

248 
pxù


252 
tu¶e_fifo
* 
fdump_ouut
 = 
Ãw
 
	`tu¶e_fifo
((
ch_suµl›r_tu¶e
));

253 
fdump_·ck‘_t
* 
fdump_·ck‘
 =

254 
Ãw
 
	`fdump_·ck‘_t
(
	`c_¡r
("FDUMP"),

255 
fdump_ouut
,

256 
Ãw
 
	`ŒivŸl_f‹r_t
(
fdump_ouut
->
	`tu¶e_size
()),

257 
NULL
,

258 
	`c_¡r
("%s/suµl›r.tbl", 
	`g‘’v
("HOME")),

259 
NULL
,

260 
tsÿn_·ck‘
,

261 
ch_qsuµl›r
::
dump_tu¶e
);

264 
tu¶e_fifo
* 
couÁ_ouut_bufãr
 =

265 
Ãw
 
	`tu¶e_fifo
((
ch_qsuµl›r
::
couÁ_tu¶e
));

266 
·ck‘_t
* 
couÁ_·ck‘
 =

267 
Ãw
 
	`·¹Ÿl_agg»g©e_·ck‘_t
("COUNT",

268 
couÁ_ouut_bufãr
,

269 
Ãw
 
	`ŒivŸl_f‹r_t
(
couÁ_ouut_bufãr
->
	`tu¶e_size
()),

270 
fdump_·ck‘
,

271 
Ãw
 
ch_qsuµl›r
::
	`couÁ_agg»g©e_t
(),

272 
Ãw
 
ch_qsuµl›r
::
couÁ_agg»g©e_t
::
	`couÁ_key_exŒaùÜ_t
(),

273 
Ãw
 
	`št_key_com·»_t
());

275 
qpe
::
qu”y_¡©e_t
* 
qs
 = 
dp
->
	`qu”y_¡©e_ü—‹
();

276 
couÁ_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

277 
tsÿn_·ck‘
->
	`assign_qu”y_¡©e
(
qs
);

280 
ch_qsuµl›r
::
ch_suµl›r_´oûss_tu¶e_t
 
±
;

281 
	`´oûss_qu”y
(
couÁ_·ck‘
, 
±
);

282 
dp
->
	`qu”y_¡©e_de¡roy
(
qs
);

284  (
RCOK
);

285 
	}
}

288 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/qpipe_tpch_xct.cpp

32 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

33 
	~"qpe/¡ages.h
"

34 
	~"qpe/qcommÚ.h
"

36 
usšg
 
Çme¥aû
 
	gshÜe
;

37 
usšg
 
Çme¥aû
 
	gqpe
;

41 
ENTER_NAMESPACE
(
ch
);

76 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
q1
);

77 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
q2
);

78 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
q3
);

79 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
q4
);

80 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
q5
);

81 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
q6
);

82 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
q7
);

83 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
q8
);

84 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
q9
);

85 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
q10
);

86 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
q11
);

87 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
q12
);

88 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
q13
);

89 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
q14
);

90 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
q15
);

91 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
q16
);

92 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
q17
);

93 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
q18
);

94 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
q19
);

95 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
q20
);

96 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
q21
);

97 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
q22
);

98 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
qlše™em
);

99 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
qÜd”s
);

100 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
q·¹
);

101 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
q·¹suµ
);

102 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
qsuµl›r
);

103 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
qÇtiÚ
);

104 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
q»giÚ
);

105 
DEFINE_QPIPE_TRX
(
ShÜeTPCHEnv
,
qcu¡om”
);

117 
w_rc_t
 
	gShÜeTPCHEnv
::
	$run_Úe_qpe_xù
(
Reque¡
* 
´eque¡
)

121 
ty³
 = 
´eque¡
->
	`ty³
();

122 
	`as£¹
 (
ty³
 >ğ
XCT_QPIPE_TPCH_MIX
);

123 ià(
ty³
 =ğ
XCT_QPIPE_TPCH_MIX
) {

124 
ty³
 = 
	`abs
(
smth»ad_t
::
	`me
()->
	`¿nd
()%22);

128 
ty³
 -ğ(
XCT_QPIPE_TPCH_MIX
 - 
XCT_TPCH_MIX
);

131 
ty³
) {

134 
XCT_TPCH_Q1
:

135  (
	`run_qpe_q1
(
´eque¡
));

137 
XCT_TPCH_Q2
:

138  (
	`run_qpe_q2
(
´eque¡
));

140 
XCT_TPCH_Q3
:

141  (
	`run_qpe_q3
(
´eque¡
));

143 
XCT_TPCH_Q4
:

144  (
	`run_qpe_q4
(
´eque¡
));

146 
XCT_TPCH_Q5
:

147  (
	`run_qpe_q5
(
´eque¡
));

149 
XCT_TPCH_Q6
:

150  (
	`run_qpe_q6
(
´eque¡
));

152 
XCT_TPCH_Q7
:

153  (
	`run_qpe_q7
(
´eque¡
));

155 
XCT_TPCH_Q8
:

156  (
	`run_qpe_q8
(
´eque¡
));

158 
XCT_TPCH_Q9
:

159  (
	`run_qpe_q9
(
´eque¡
));

161 
XCT_TPCH_Q10
:

162  (
	`run_qpe_q10
(
´eque¡
));

164 
XCT_TPCH_Q11
:

165  (
	`run_qpe_q11
(
´eque¡
));

167 
XCT_TPCH_Q12
:

168  (
	`run_qpe_q12
(
´eque¡
));

170 
XCT_TPCH_Q13
:

171  (
	`run_qpe_q13
(
´eque¡
));

173 
XCT_TPCH_Q14
:

174  (
	`run_qpe_q14
(
´eque¡
));

176 
XCT_TPCH_Q15
:

177  (
	`run_qpe_q15
(
´eque¡
));

179 
XCT_TPCH_Q16
:

180  (
	`run_qpe_q16
(
´eque¡
));

182 
XCT_TPCH_Q17
:

183  (
	`run_qpe_q17
(
´eque¡
));

185 
XCT_TPCH_Q18
:

186  (
	`run_qpe_q18
(
´eque¡
));

188 
XCT_TPCH_Q19
:

189  (
	`run_qpe_q19
(
´eque¡
));

191 
XCT_TPCH_Q20
:

192  (
	`run_qpe_q20
(
´eque¡
));

194 
XCT_TPCH_Q21
:

195  (
	`run_qpe_q21
(
´eque¡
));

197 
XCT_TPCH_Q22
:

198  (
	`run_qpe_q22
(
´eque¡
));

200 
XCT_TPCH_QLINEITEM
:

201  (
	`run_qpe_qlše™em
(
´eque¡
));

203 
XCT_TPCH_QORDERS
:

204  (
	`run_qpe_qÜd”s
(
´eque¡
));

206 
XCT_TPCH_QREGION
:

207  (
	`run_qpe_q»giÚ
(
´eque¡
));

209 
XCT_TPCH_QNATION
:

210  (
	`run_qpe_qÇtiÚ
(
´eque¡
));

212 
XCT_TPCH_QCUSTOMER
:

213  (
	`run_qpe_qcu¡om”
(
´eque¡
));

215 
XCT_TPCH_QSUPPLIER
:

216  (
	`run_qpe_qsuµl›r
(
´eque¡
));

218 
XCT_TPCH_QPART
:

219  (
	`run_qpe_q·¹
(
´eque¡
));

221 
XCT_TPCH_QPARTSUPP
:

222  (
	`run_qpe_q·¹suµ
(
´eque¡
));

226 
	`TRACE
Ğ
TRACE_ALWAYS
, "Unknownransaction\n");

228  (
RCOK
);

229 
	}
}

235 
EXIT_NAMESPACE
(
qpe
);

	@src/workload/tpch/shore_tpch_client.cpp

33 
	~"wÜklßd/ch/shÜe_ch_ş›Á.h
"

35 
ENTER_NAMESPACE
(
ch
);

44 
	gba£lše_ch_ş›Á_t
::
	$ba£lše_ch_ş›Á_t
(
c_¡r
 
Šame
, cÚ¡ 
id
,

45 
ShÜeTPCHEnv
* 
’v
,

46 cÚ¡ 
M—su»m’tTy³
 
aTy³
,

47 cÚ¡ 
Œxid
,

48 cÚ¡ 
numOfTrxs
,

49 
´oûssÜid_t
 
­rsid
,

50 cÚ¡ 
£lID
, cÚ¡ 
qf
)

51 : 
	`ba£_ş›Á_t
(
Šame
,
id
,
’v
,
aTy³
,
Œxid
,
numOfTrxs
,
­rsid
),

52 
	`_£lid
(
£lID
), 
	$_qf
(
qf
)

54 
	`as£¹
 (
’v
);

55 
	`as£¹
 (
_id
>=0 && 
_qf
>0);

58 
_wÜk”
 = 
_’v
->
	`wÜk”
(
_id
);

59 
	`as£¹
 (
_wÜk”
);

60 
	}
}

62 
	gba£lše_ch_ş›Á_t
::
	$lßd_sup_xù
(
m­SupTrxs
& 
¡m­
)

65 
¡m­
.
	`ş—r
();

68 
¡m­
[
XCT_TPCH_MIX
] = "TPCH-Mix";

69 
¡m­
[
XCT_TPCH_Q1
] = "TPCH-Q1";

70 
¡m­
[
XCT_TPCH_Q2
] = "TPCH-Q2";

71 
¡m­
[
XCT_TPCH_Q3
] = "TPCH-Q3";

72 
¡m­
[
XCT_TPCH_Q4
] = "TPCH-Q4";

73 
¡m­
[
XCT_TPCH_Q5
] = "TPCH-Q5";

74 
¡m­
[
XCT_TPCH_Q6
] = "TPCH-Q6";

75 
¡m­
[
XCT_TPCH_Q7
] = "TPCH-Q7";

76 
¡m­
[
XCT_TPCH_Q8
] = "TPCH-Q8";

77 
¡m­
[
XCT_TPCH_Q9
] = "TPCH-Q9";

78 
¡m­
[
XCT_TPCH_Q10
] = "TPCH-Q10";

79 
¡m­
[
XCT_TPCH_Q11
] = "TPCH-Q11";

80 
¡m­
[
XCT_TPCH_Q12
] = "TPCH-Q12";

81 
¡m­
[
XCT_TPCH_Q13
] = "TPCH-Q13";

82 
¡m­
[
XCT_TPCH_Q14
] = "TPCH-Q14";

83 
¡m­
[
XCT_TPCH_Q15
] = "TPCH-Q15";

84 
¡m­
[
XCT_TPCH_Q16
] = "TPCH-Q16";

85 
¡m­
[
XCT_TPCH_Q17
] = "TPCH-Q17";

86 
¡m­
[
XCT_TPCH_Q18
] = "TPCH-Q18";

87 
¡m­
[
XCT_TPCH_Q19
] = "TPCH-Q19";

88 
¡m­
[
XCT_TPCH_Q20
] = "TPCH-Q20";

89 
¡m­
[
XCT_TPCH_Q21
] = "TPCH-Q21";

90 
¡m­
[
XCT_TPCH_QLINEITEM
] = "TPCH-QLINEITEM";

91 
¡m­
[
XCT_TPCH_QORDERS
] = "TPCH-QORDERS";

92 
¡m­
[
XCT_TPCH_QREGION
] = "TPCH-QREGION";

93 
¡m­
[
XCT_TPCH_QNATION
] = "TPCH-QNATION";

94 
¡m­
[
XCT_TPCH_QCUSTOMER
] = "TPCH-QCUSTOMER";

95 
¡m­
[
XCT_TPCH_QSUPPLIER
] = "TPCH-QSUPPLIER";

96 
¡m­
[
XCT_TPCH_QPART
] = "TPCH-QPART";

97 
¡m­
[
XCT_TPCH_QPARTSUPP
] = "TPCH-QPARTSUPP";

101 #ifdeà
CFG_QPIPE


103 
¡m­
[
XCT_QPIPE_TPCH_MIX
] = "QPIPE-TPCH-MIX";

105 
ušt
 
qpeba£
 = 
XCT_QPIPE_TPCH_MIX
 - 
XCT_TPCH_MIX
;

106 
¡m­
[
qpeba£
 + 
XCT_TPCH_Q1
] = "QPIPE-TPCH-Q1";

107 
¡m­
[
qpeba£
 + 
XCT_TPCH_Q2
] = "QPIPE-TPCH-Q2";

108 
¡m­
[
qpeba£
 + 
XCT_TPCH_Q3
] = "QPIPE-TPCH-Q3";

109 
¡m­
[
qpeba£
 + 
XCT_TPCH_Q4
] = "QPIPE-TPCH-Q4";

110 
¡m­
[
qpeba£
 + 
XCT_TPCH_Q5
] = "QPIPE-TPCH-Q5";

111 
¡m­
[
qpeba£
 + 
XCT_TPCH_Q6
] = "QPIPE-TPCH-Q6";

112 
¡m­
[
qpeba£
 + 
XCT_TPCH_Q7
] = "QPIPE-TPCH-Q7";

113 
¡m­
[
qpeba£
 + 
XCT_TPCH_Q8
] = "QPIPE-TPCH-Q8";

114 
¡m­
[
qpeba£
 + 
XCT_TPCH_Q9
] = "QPIPE-TPCH-Q9";

115 
¡m­
[
qpeba£
 + 
XCT_TPCH_Q10
] = "QPIPE-TPCH-Q10";

116 
¡m­
[
qpeba£
 + 
XCT_TPCH_Q11
] = "QPIPE-TPCH-Q11";

117 
¡m­
[
qpeba£
 + 
XCT_TPCH_Q12
] = "QPIPE-TPCH-Q12";

118 
¡m­
[
qpeba£
 + 
XCT_TPCH_Q13
] = "QPIPE-TPCH-Q13";

119 
¡m­
[
qpeba£
 + 
XCT_TPCH_Q14
] = "QPIPE-TPCH-Q14";

120 
¡m­
[
qpeba£
 + 
XCT_TPCH_Q15
] = "QPIPE-TPCH-Q15";

121 
¡m­
[
qpeba£
 + 
XCT_TPCH_Q16
] = "QPIPE-TPCH-Q16";

122 
¡m­
[
qpeba£
 + 
XCT_TPCH_Q17
] = "QPIPE-TPCH-Q17";

123 
¡m­
[
qpeba£
 + 
XCT_TPCH_Q18
] = "QPIPE-TPCH-Q18";

124 
¡m­
[
qpeba£
 + 
XCT_TPCH_Q19
] = "QPIPE-TPCH-Q19";

125 
¡m­
[
qpeba£
 + 
XCT_TPCH_Q20
] = "QPIPE-TPCH-Q20";

126 
¡m­
[
qpeba£
 + 
XCT_TPCH_Q21
] = "QPIPE-TPCH-Q21";

127 
¡m­
[
qpeba£
 + 
XCT_TPCH_Q22
] = "QPIPE-TPCH-Q22";

128 
¡m­
[
qpeba£
 + 
XCT_TPCH_QLINEITEM
] = "QPIPE-TPCH-QLINEITEM";

129 
¡m­
[
qpeba£
 + 
XCT_TPCH_QORDERS
] = "QPIPE-TPCH-QORDERS";

130 
¡m­
[
qpeba£
 + 
XCT_TPCH_QREGION
] = "QPIPE-TPCH-QREGION";

131 
¡m­
[
qpeba£
 + 
XCT_TPCH_QNATION
] = "QPIPE-TPCH-QNATION";

132 
¡m­
[
qpeba£
 + 
XCT_TPCH_QCUSTOMER
] = "QPIPE-TPCH-QCUSTOMER";

133 
¡m­
[
qpeba£
 + 
XCT_TPCH_QSUPPLIER
] = "QPIPE-TPCH-QSUPPLIER";

134 
¡m­
[
qpeba£
 + 
XCT_TPCH_QPART
] = "QPIPE-TPCH-QPART";

135 
¡m­
[
qpeba£
 + 
XCT_TPCH_QPARTSUPP
] = "QPIPE-TPCH-QPARTSUPP";

140  (
¡m­
.
	`size
());

141 
	}
}

155 
w_rc_t
 
	gba£lše_ch_ş›Á_t
::
	$subm™_Úe
(
xù_ty³
, 
xùid
)

158 
Œx_»suÉ_tu¶e_t
 
©¹
;

159 
boŞ
 
bWake
 = 
çl£
;

160 ià(
cÚdex
* 
c
 = 
_ı
->
	`ke_Úe
()) {

161 
©¹
.
	`£t_nÙify
(
c
);

162 
	`TRACE
Ğ
TRACE_TRX_FLOW
, "Sleeping\n");

163 
bWake
 = 
Œue
;

167 
£lid
 = 
_£lid
;

172 
Œx_»que¡_t
* 
¬eque¡
 = 
	`Ãw
 (
_’v
->
_»que¡_poŞ
)rx_request_t;

173 
tid_t
 
©id
;

174 
¬eque¡
->
	`£t
(
NULL
,
©id
,
xùid
,
©¹
,
xù_ty³
,
£lid
);

177 
	`as£¹
 (
_wÜk”
);

178 
_wÜk”
->
	`’queue
(
¬eque¡
,
bWake
);

179  (
RCOK
);

180 
	}
}

183 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/shore_tpch_env.cpp

31 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

32 
	~"sm/shÜe/shÜe_h–³r_lßd”.h
"

34 
	~"wÜklßd/ch/ch_¿ndom.h
"

36 
	~"wÜklßd/ch/dbg’/dss.h
"

37 
	~"wÜklßd/ch/dbg’/ds¡y³s.h
"

40 
usšg
 
Çme¥aû
 
	gshÜe
;

41 
usšg
 
Çme¥aû
 
	gdbg’ch
;

44 
ENTER_NAMESPACE
(
shÜe
);

45 
DEFINE_ROW_CACHE_TLS
(
ch
, 
ÇtiÚ
);

46 
DEFINE_ROW_CACHE_TLS
(
ch
, 
»giÚ
);

47 
DEFINE_ROW_CACHE_TLS
(
ch
, 
·¹
);

48 
DEFINE_ROW_CACHE_TLS
(
ch
, 
suµl›r
);

49 
DEFINE_ROW_CACHE_TLS
(
ch
, 
·¹suµ
);

50 
DEFINE_ROW_CACHE_TLS
(
ch
, 
cu¡om”
);

51 
DEFINE_ROW_CACHE_TLS
(
ch
, 
Üd”s
);

52 
DEFINE_ROW_CACHE_TLS
(
ch
, 
lše™em
);

53 
EXIT_NAMESPACE
(
shÜe
);

56 
ENTER_NAMESPACE
(
ch
);

73 cÚ¡ 
	gPART_UNIT_PER_SF
 = 200000;

74 cÚ¡ 
	gCUST_UNIT_PER_SF
 = 150000;

75 cÚ¡ 
	gDIVISOR
 = 50;

76 cÚ¡ 
	gPART_COUNT
 = 10000;

77 cÚ¡ 
	gCUST_COUNT
 = 10000;

79 
	gShÜeTPCHEnv
::
checkpoš‹r_t
 : 
public
 
th»ad_t


81 
ShÜeTPCHEnv
* 
_’v
;

82 
checkpoš‹r_t
(
ShÜeTPCHEnv
* 
’v
)

83 : 
th»ad_t
("TPC-H Lßd Checkpoš‹r"), 
_’v
(
’v
) { }

84 
vœtu®
 
wÜk
();

87 şas 
	cShÜeTPCHEnv
::
bË_bud”_t
 : 
public
 
th»ad_t


89 
ShÜeTPCHEnv
* 
_’v
;

90 
	m_·¹_¡¬t
;

91 
	m_·¹_’d
;

92 
	m_cu¡_¡¬t
;

93 
	m_cu¡_’d
;

94 
	m_sf
;

95 
	m_lßd”s
;

96 
	mpublic
:

97 
	$bË_bud”_t
(
ShÜeTPCHEnv
* 
’v
, cÚ¡ 
id
,

98 cÚ¡ 
·¹_¡¬t
, cÚ¡ 
·¹_’d
,

99 cÚ¡ 
cu¡_¡¬t
, cÚ¡ 
cu¡_’d
,

100 cÚ¡ 
sf
, cÚ¡ 
lßd”s
)

101 : 
	`th»ad_t
(
	`c_¡r
("TPC-H L-%d",
id
)), 
	`_’v
(
’v
),

102 
	`_·¹_¡¬t
(
·¹_¡¬t
), 
	`_·¹_’d
(
·¹_’d
),

103 
	`_cu¡_¡¬t
(
cu¡_¡¬t
), 
	`_cu¡_’d
(
cu¡_’d
),

104 
	`_sf
(
sf
), 
	$_lßd”s
(
lßd”s
)

106 
vœtu®
 
	`wÜk
();

107 
	}
};

109 
	gShÜeTPCHEnv
::
bË_ü—tÜ_t
 : 
public
 
th»ad_t


111 
ShÜeTPCHEnv
* 
_’v
;

112 
	g_sf
;

113 
	g_lßd”_couÁ
;

114 
	g_·¹s_³r_th»ad
;

115 
	g_cu¡s_³r_th»ad
;

117 
bË_ü—tÜ_t
(
ShÜeTPCHEnv
* 
’v
, cÚ¡ 
sf
, cÚ¡ 
lßd”_couÁ
,

118 cÚ¡ 
·¹s_³r_th»ad
, cÚ¡ 
cu¡s_³r_th»ad
)

119 : 
th»ad_t
("TPC-H C"),

120 
_’v
(
’v
), 
_sf
(
sf
),

121 
_lßd”_couÁ
(
lßd”_couÁ
),

122 
_·¹s_³r_th»ad
(
·¹s_³r_th»ad
),

123 
_cu¡s_³r_th»ad
(
cu¡s_³r_th»ad
)

125 
vœtu®
 
wÜk
();

129 
	gShÜeTPCHEnv
::
checkpoš‹r_t
::
	$wÜk
()

131 
boŞ
 vŞ©e* 
lßded
 = &
_’v
->
_lßded
;

132 !*
lßded
) {

133 
_’v
->
	`£t_m—su»
(
MST_MEASURE
);

134 
i
=0; i < 60 && ! *
lßded
; i++) {

135 ::
	`¦“p
(1);

138 
	`TRACE
Ğ
TRACE_ALWAYS
, "db checkpoint - start\n");

139 
_’v
->
	`checkpošt
();

140 
	`TRACE
Ğ
TRACE_ALWAYS
, "db checkpoint -ƒnd\n");

142 
_’v
->
	`£t_m—su»
(
MST_PAUSE
);

143 
	}
}

146 
	gShÜeTPCHEnv
::
bË_ü—tÜ_t
::
	$wÜk
()

159 
	`W_COERCE
(
_’v
->
	`db
()->
	`begš_xù
());

160 
	`W_COERCE
(
_’v
->
_²©iÚ_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

161 
	`W_COERCE
(
_’v
->
_´egiÚ_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

162 
	`W_COERCE
(
_’v
->
_µ¬t_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

163 
	`W_COERCE
(
_’v
->
_psuµl›r_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

164 
	`W_COERCE
(
_’v
->
_µ¬tsuµ_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

165 
	`W_COERCE
(
_’v
->
_pcu¡om”_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

166 
	`W_COERCE
(
_’v
->
_pÜd”s_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

167 
	`W_COERCE
(
_’v
->
_¶še™em_desc
->
	`ü—‹_physiÿl_bË
(_’v->
	`db
()));

168 
	`W_COERCE
(
_’v
->
	`db
()->
	`comm™_xù
());

172 
_’v
->
_²©iÚ_mª
->
	`»gi¡”_bË_mª
();

173 
_’v
->
_´egiÚ_mª
->
	`»gi¡”_bË_mª
();

174 
_’v
->
_µ¬t_mª
->
	`»gi¡”_bË_mª
();

175 
_’v
->
_psuµl›r_mª
->
	`»gi¡”_bË_mª
();

176 
_’v
->
_µ¬tsuµ_mª
->
	`»gi¡”_bË_mª
();

177 
_’v
->
_pcu¡om”_mª
->
	`»gi¡”_bË_mª
();

178 
_’v
->
_pÜd”s_mª
->
	`»gi¡”_bË_mª
();

179 
_’v
->
_¶še™em_mª
->
	`»gi¡”_bË_mª
();

183 
pİuÏ‹_ba£lše_šput_t
 
š
 = {
_sf
, 
_lßd”_couÁ
, 
DIVISOR
,

184 
_·¹s_³r_th»ad
, 
_cu¡s_³r_th»ad
};

186 
w_rc_t
 
e
 = 
RCOK
;

188 
log_¥aû_Ãeded
 = 0;

189 
»Œyba£lše
:

190 
	`W_COERCE
(
_’v
->
	`db
()->
	`begš_xù
());

191 #ifdeà
USE_SHORE_6


192 if(
log_¥aû_Ãeded
 > 0) {

193 
	`W_COERCE
(
_’v
->
	`db
()->
	`xù_»£rve_log_¥aû
(
log_¥aû_Ãeded
));

196 
e
 = 
_’v
->
	`xù_pİuÏ‹_ba£lše
(0, 
š
);

198 
	`CHECK_XCT_RETURN
(
e
,
log_¥aû_Ãeded
,
»Œyba£lše
,
_’v
);

200 
	`W_COERCE
(
_’v
->
	`db
()->
	`begš_xù
());

201 
	`W_COERCE
(
_’v
->
	`_po¡_š™_im¶
());

202 
	`W_COERCE
(
_’v
->
	`db
()->
	`comm™_xù
());

203 
	}
}

206 
	g·¹_com¶‘ed
 = 0;

207 
	gcu¡_com¶‘ed
 = 0;

209 
	gShÜeTPCHEnv
::
bË_bud”_t
::
	$wÜk
()

211 
w_rc_t
 
e
 = 
RCOK
;

213 ià(
_lßd”s
==1)

215 
	`TRACE
Ğ
TRACE_ALWAYS
, "Using simple†oader with 1hread.\n");

219 
i
=
_·¹_¡¬t
 ; i < 
_·¹_’d
; i+=
PART_POP_UNIT
) {

220 
_’v
->
	`g‘_m—su»
(è!ğ
MST_MEASURE
) {

221 
	`u¦“p
(1000);

224 
tid
 = 
i
;

225 
pİuÏ‹_some_·¹s_šput_t
 
š
 = {
tid
};

227 
tid
 = 
¡d
::
	`mš
(
_·¹_’d
-
i
,
PART_POP_UNIT
);

229 
log_¥aû_Ãeded
 = 0;

230 
»Œy·¹
:

231 
	`W_COERCE
(
_’v
->
	`db
()->
	`begš_xù
());

232 #ifdeà
USE_SHORE_6


233 if(
log_¥aû_Ãeded
 > 0) {

234 
	`W_COERCE
(
_’v
->
	`db
()->
	`xù_»£rve_log_¥aû
(
log_¥aû_Ãeded
));

237 
e
 = 
_’v
->
	`xù_pİuÏ‹_some_·¹s
(
tid
, 
š
);

239 
	`CHECK_XCT_RETURN
(
e
,
log_¥aû_Ãeded
,
»Œy·¹
,
_’v
);

241 
nv®
 = 
	`©omic_add_64_nv
(&
·¹_com¶‘ed
,
tid
);

242 ià(
nv®
 % 
PART_COUNT
 == 0) {

243 
	`TRACE
Ğ
TRACE_ALWAYS
, "Parts %d/%d (%.0f%%)\n",

244 
nv®
, ()(
_sf
*
PART_UNIT_PER_SF
),

245 ()(100*
nv®
)/()(
_sf
*
PART_UNIT_PER_SF
));

249 
	`TRACE
Ğ
TRACE_ALWAYS
, "Fšished P¬t %d .. %d \n", 
_·¹_¡¬t
, 
_·¹_’d
);

252 
ušt
 
i
=
_cu¡_¡¬t
 ; i < 
_cu¡_’d
; i+=
CUST_POP_UNIT
) {

253 
_’v
->
	`g‘_m—su»
(è!ğ
MST_MEASURE
) {

254 
	`u¦“p
(1000);

257 
tid
 = 
i
;

258 
pİuÏ‹_some_cu¡s_šput_t
 
š
 = {
tid
};

260 
tid
 = 
¡d
::
	`mš
(
_cu¡_’d
-
i
,
CUST_POP_UNIT
);

262 
log_¥aû_Ãeded
 = 0;

263 
»Œycu¡
:

264 
	`W_COERCE
(
_’v
->
	`db
()->
	`begš_xù
());

265 #ifdeà
USE_SHORE_6


266 if(
log_¥aû_Ãeded
 > 0) {

267 
	`W_COERCE
(
_’v
->
	`db
()->
	`xù_»£rve_log_¥aû
(
log_¥aû_Ãeded
));

270 
e
 = 
_’v
->
	`xù_pİuÏ‹_some_cu¡s
(
tid
, 
š
);

272 
	`CHECK_XCT_RETURN
(
e
,
log_¥aû_Ãeded
,
»Œycu¡
,
_’v
);

274 
nv®
 = 
	`©omic_add_64_nv
(&
cu¡_com¶‘ed
,
tid
);

275 ià(
nv®
 % 
PART_COUNT
 == 0) {

276 
	`TRACE
Ğ
TRACE_ALWAYS
, "Customers %d/%d (%.0f%%)\n",

277 
nv®
, ()(
_sf
*
CUST_UNIT_PER_SF
),

278 ()(100*
nv®
)/()(
_sf
*
CUST_UNIT_PER_SF
));

282 
	`TRACE
Ğ
TRACE_ALWAYS
, "Fšished Cu¡ %d .. %d \n", 
_cu¡_¡¬t
, 
_cu¡_’d
);

283 
	}
}

294 
	gShÜeTPCHEnv
::
	$ShÜeTPCHEnv
()

295 : 
	$ShÜeEnv
()

297 
_sÿlšg_çùÜ
 = 
TPCH_SCALING_FACTOR
;

299 #ifdeà
CFG_QPIPE


302 
	`£t_sched_pŞicy
(
NULL
);

305 
	`»gi¡”_¡age_cÚš”s
();

307 
	}
}

310 
	gShÜeTPCHEnv
::~
	$ShÜeTPCHEnv
()

312 
	}
}

316 
w_rc_t
 
ShÜeTPCHEnv
::
	$lßd_schema
()

319 
_²©iÚ_desc
 = 
Ãw
 
	`ÇtiÚ_t
(
	`g‘_pd
());

320 
_´egiÚ_desc
 = 
Ãw
 
	`»giÚ_t
(
	`g‘_pd
());

321 
_µ¬t_desc
 = 
Ãw
 
	`·¹_t
(
	`g‘_pd
());

322 
_psuµl›r_desc
 = 
Ãw
 
	`suµl›r_t
(
	`g‘_pd
());

323 
_µ¬tsuµ_desc
 = 
Ãw
 
	`·¹suµ_t
(
	`g‘_pd
());

324 
_pcu¡om”_desc
 = 
Ãw
 
	`cu¡om”_t
(
	`g‘_pd
());

325 
_pÜd”s_desc
 = 
Ãw
 
	`Üd”s_t
(
	`g‘_pd
());

326 
_¶še™em_desc
 = 
Ãw
 
	`lše™em_t
(
	`g‘_pd
());

329 
_²©iÚ_mª
 = 
Ãw
 
	`ÇtiÚ_mª_im¶
(
_²©iÚ_desc
.
	`g‘
());

330 
_´egiÚ_mª
 = 
Ãw
 
	`»giÚ_mª_im¶
(
_´egiÚ_desc
.
	`g‘
());

331 
_µ¬t_mª
 = 
Ãw
 
	`·¹_mª_im¶
(
_µ¬t_desc
.
	`g‘
());

332 
_psuµl›r_mª
 = 
Ãw
 
	`suµl›r_mª_im¶
(
_psuµl›r_desc
.
	`g‘
());

333 
_µ¬tsuµ_mª
 = 
Ãw
 
	`·¹suµ_mª_im¶
(
_µ¬tsuµ_desc
.
	`g‘
());

334 
_pcu¡om”_mª
 = 
Ãw
 
	`cu¡om”_mª_im¶
(
_pcu¡om”_desc
.
	`g‘
());

335 
_pÜd”s_mª
 = 
Ãw
 
	`Üd”s_mª_im¶
(
_pÜd”s_desc
.
	`g‘
());

336 
_¶še™em_mª
 = 
Ãw
 
	`lše™em_mª_im¶
(
_¶še™em_desc
.
	`g‘
());

338  (
RCOK
);

339 
	}
}

343 
w_rc_t
 
	gShÜeTPCHEnv
::
	$lßd_ªd_»gi¡”_fids
()

345 
	`W_DO
(
_²©iÚ_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

346 
	`W_DO
(
_´egiÚ_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

347 
	`W_DO
(
_µ¬t_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

348 
	`W_DO
(
_psuµl›r_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

349 
	`W_DO
(
_µ¬tsuµ_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

350 
	`W_DO
(
_pcu¡om”_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

351 
	`W_DO
(
_pÜd”s_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

352 
	`W_DO
(
_¶še™em_mª
->
	`lßd_ªd_»gi¡”_fid
(
	`db
()));

353  (
RCOK
);

354 
	}
}

358 #ifdeà
CFG_QPIPE


366 
pŞicy_t
* 
	gShÜeTPCHEnv
::
	$g‘_sched_pŞicy
()

368 
	`CRITICAL_SECTION
(
š™_cs
,
_lßd_mu‹x
);

369  (
_sched_pŞicy
.
	`g‘
());

370 
	}
}

372 
pŞicy_t
* 
	gShÜeTPCHEnv
::
	$£t_sched_pŞicy
(cÚ¡ * 
¥Şicy
)

374 
	`CRITICAL_SECTION
(
š™_cs
,
_lßd_mu‹x
);

375 ià(
¥Şicy
) {

377 
	`TRACE
Ğ
TRACE_ALWAYS
, "S‘tšg…Şicy (%s)\n", 
¥Şicy
);

379 iàĞ!
	`¡rcmp
(
¥Şicy
, "OS") ) {

380 
_sched_pŞicy
 = 
Ãw
 
	`pŞicy_os_t
();

381  (
_sched_pŞicy
);

384 iàĞ!
	`¡rcmp
(
¥Şicy
, "RR_CPU") ) {

385 
_sched_pŞicy
 = 
Ãw
 
	`pŞicy_¼_ıu_t
();

386  (
_sched_pŞicy
);

389 iàĞ!
	`¡rcmp
(
¥Şicy
, "QUERY_CPU") ) {

390 
_sched_pŞicy
 = 
Ãw
 
	`pŞicy_qu”y_ıu_t
();

391  (
_sched_pŞicy
);

394 iàĞ!
	`¡rcmp
(
¥Şicy
, "RR_MODULE") ) {

395 
_sched_pŞicy
 = 
Ãw
 
	`pŞicy_¼_moduË_t
();

396  (
_sched_pŞicy
);

400 
	`TRACE
Ğ
TRACE_ALWAYS
, "Default scheduling…olicy (OS)\n");

401 
_sched_pŞicy
 = 
Ãw
 
	`pŞicy_os_t
();

402  (
_sched_pŞicy
);

403 
	}
}

416 
	gShÜeTPCHEnv
::
	$šfo
() const

418 
	`TRACE
Ğ
TRACE_ALWAYS
, "SF = (%.1f)\n", 
_sÿlšg_çùÜ
);

420 
	}
}

432 
	gShÜeTPCHEnv
::
	$¡©i¡ics
()

435 
	}
}

447 
	gShÜeTPCHEnv
::
	$¡¬t
()

449  (
ShÜeEnv
::
	`¡¬t
());

450 
	}
}

452 
	gShÜeTPCHEnv
::
	$¡İ
()

454  (
ShÜeEnv
::
	`¡İ
());

455 
	}
}

475 
w_rc_t
 
	gShÜeTPCHEnv
::
	$lßdd©a
()

478 
	`CRITICAL_SECTION
(
lßd_cs
, 
_lßd_mu‹x
);

479 ià(
_lßded
) {

480 
	`TRACE
Ğ
TRACE_TRX_FLOW
,

482  (
RCOK
);

484 
	`CRITICAL_SECTION
(
sÿË_cs
, 
_sÿlšg_mu‹x
);

487 
	`dbg’_š™
();

490 
time_t
 
t¡¬t
 = 
	`time
(
NULL
);

500 
lßd”s_to_u£
 = 
’vV¬
::
	`š¡ªû
()->
	`g‘V¬IÁ
("db-loaders",10);

501 
tÙ®_·¹s
 = 
_sÿlšg_çùÜ
*
PART_UNIT_PER_SF
;

502 
tÙ®_cu¡s
 = 
_sÿlšg_çùÜ
*
CUST_UNIT_PER_SF
;

503 
·¹s_³r_th»ad
 = 
tÙ®_·¹s
/
lßd”s_to_u£
;

504 
cu¡s_³r_th»ad
 = 
tÙ®_cu¡s
/
lßd”s_to_u£
;

508 
gu¬d
<
bË_ü—tÜ_t
> 
tc
;

509 
tc
 = 
Ãw
 
	`bË_ü—tÜ_t
(
this
, 
_sÿlšg_çùÜ
, 
lßd”s_to_u£
,

510 
·¹s_³r_th»ad
, 
cu¡s_³r_th»ad
);

511 
tc
->
	`fÜk
();

512 
tc
->
	`još
();

516 
gu¬d
<
checkpoš‹r_t
> 
	`chk
(
Ãw
 
	`checkpoš‹r_t
(
this
));

517 
chk
->
	`fÜk
();

520 
	`TRACE
Ğ
TRACE_ALWAYS
, "Fœšg u°%d†ßd” ..\n", 
lßd”s_to_u£
);

521 
¬¿y_gu¬d_t
< 
gu¬d
<
bË_bud”_t
> > 
	`lßd”s
(
Ãw
 gu¬d<bË_bud”_t>[
lßd”s_to_u£
]);

522 
i
=0; i < 
lßd”s_to_u£
; i++) {

523 
·¹_¡¬t
 = (
i
*
·¹s_³r_th»ad
è+ 
DIVISOR
;

524 
·¹_’d
 = ((
i
+1)*
·¹s_³r_th»ad
 > 
tÙ®_·¹s
 - 1) ?

525 
tÙ®_·¹s
 : (
i
+1)*
·¹s_³r_th»ad
 - 1;

526 
	`as£¹
 (
·¹_¡¬t
 <ğ
·¹_’d
);

528 
cu¡_¡¬t
 = (
i
*
cu¡s_³r_th»ad
è+ 
DIVISOR
;

529 
cu¡_’d
 = ((
i
+1)*
cu¡s_³r_th»ad
 > 
tÙ®_cu¡s
 - 1) ?

530 
tÙ®_cu¡s
 : (
i
+1)*
cu¡s_³r_th»ad
 - 1;

531 
	`as£¹
 (
cu¡_¡¬t
 <ğ
cu¡_’d
);

533 
lßd”s
[
i
] = 
Ãw
 
	`bË_bud”_t
(
this
, i,

534 
·¹_¡¬t
, 
·¹_’d
,

535 
cu¡_¡¬t
, 
cu¡_’d
,

536 
_sÿlšg_çùÜ
, 
lßd”s_to_u£
);

537 
lßd”s
[
i
]->
	`fÜk
();

540 
i
=0; i < 
lßd”s_to_u£
; i++) {

541 
lßd”s
[
i
]->
	`još
();

544 
time_t
 
t¡İ
 = 
	`time
(
NULL
);

547 
	`TRACE
Ğ
TRACE_STATISTICS
, "Loading finished. %dables†oaded in (%d) secs...\n",

548 
SHORE_TPCH_TABLES
, (
t¡İ
 - 
t¡¬t
));

551 
_lßded
 = 
Œue
;

552 
chk
->
	`još
();

554  (
RCOK
);

555 
	}
}

567 
w_rc_t
 
	gShÜeTPCHEnv
::
	$check_cÚsi¡’cy
()

569  (
RCOK
);

570 
	}
}

582 
w_rc_t
 
	gShÜeTPCHEnv
::
	$w¬mup
()

584  (
	`check_cÚsi¡’cy
());

585 
	}
}

596 
	gShÜeTPCHEnv
::
	$dump
()

599 
	}
}

602 
	gShÜeTPCHEnv
::
	$cÚf
()

605 
ShÜeEnv
::
	`cÚf
();

606 
	`upd_sf
();

608 
	}
}

627 
	gShÜeTPCHEnv
::
	$po¡_š™
()

629 
	`cÚf
();

631 
	`W_COERCE
(
	`db
()->
	`begš_xù
());

632 
w_rc_t
 
rc
 = 
	`_po¡_š™_im¶
();

633 if(
rc
.
	`is_”rÜ
()) {

634 
	`db
()->
	`abÜt_xù
();

635  (
rc
.
	`”r_num
());

638 
	`TRACE
Ğ
TRACE_ALWAYS
, "-> Done\n");

639 
	`db
()->
	`comm™_xù
();

642 
	}
}

653 
w_rc_t


654 
	gShÜeTPCHEnv
::
	$_po¡_š™_im¶
()

656 
	`TRACE
Ğ
TRACE_DEBUG
, "So far,‚othingo…ad in TPC-H..\n");

657  (
RCOK
);

658 
	}
}

662 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/shore_tpch_schema.cpp

85 
	~"wÜklßd/ch/shÜe_ch_schema.h
"

87 
usšg
 
Çme¥aû
 
	gshÜe
;

89 
ENTER_NAMESPACE
(
ch
);

91 
	gÇtiÚ_t
::
	$ÇtiÚ_t
(cÚ¡ 
ušt4_t
& 
pd
) :

92 
	`bË_desc_t
("NATION", 
TPCH_NATION_FCOUNT
, 
pd
)

95 
_desc
[0].
	`£tup
(
SQL_INT
, "N_NATIONKEY");

96 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "N_NAME", 25);

97 
_desc
[2].
	`£tup
(
SQL_INT
, "N_REGIONKEY");

98 
_desc
[3].
	`£tup
(
SQL_FIXCHAR
, "N_COMMENT", 152);

100 
ušt
 
keys
[1] = { 0 };

102 
ušt
 
fkeys
[1] = { 2 };

107 ià((
pd
 & 
PD_NORMAL
è&& !Õd & 
PD_NOLOCK
)) {

108 
	`TRACE
Ğ
TRACE_DEBUG
, "ReguÏ¸idx fÜ (%s)\n", 
_Çme
);

110 
	`ü—‹_´im¬y_idx_desc
("N_IDX", 0, 
keys
, 1);

112 
	`ü—‹_šdex_desc
("N_FK_REGION", 0, 
fkeys
, 1, 
çl£
);

114 
	}
}

117 
	g»giÚ_t
::
	$»giÚ_t
(cÚ¡ 
ušt4_t
& 
pd
) :

118 
	`bË_desc_t
("REGION", 
TPCH_REGION_FCOUNT
, 
pd
)

121 
_desc
[0].
	`£tup
(
SQL_INT
, "R_REGIONKEY");

122 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "R_NAME", 25);

123 
_desc
[2].
	`£tup
(
SQL_FIXCHAR
, "R_COMMENT", 25);

125 
ušt
 
keys
[1] = { 0 };

128 ià((
pd
 & 
PD_NORMAL
è&& !Õd & 
PD_NOLOCK
)) {

129 
	`TRACE
Ğ
TRACE_DEBUG
, "ReguÏ¸idx fÜ (%s)\n", 
_Çme
);

131 
	`ü—‹_´im¬y_idx_desc
("R_IDX", 0, 
keys
, 1);

133 
	}
}

136 
	gsuµl›r_t
::
	$suµl›r_t
(cÚ¡ 
ušt4_t
& 
pd
) :

137 
	`bË_desc_t
("SUPPLIER", 
TPCH_SUPPLIER_FCOUNT
, 
pd
)

140 
_desc
[0].
	`£tup
(
SQL_INT
, "S_SUPPKEY");

141 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "S_NAME", 25);

142 
_desc
[2].
	`£tup
(
SQL_FIXCHAR
, "S_ADDRESS", 40);

143 
_desc
[3].
	`£tup
(
SQL_INT
, "S_NATIONKEY");

144 
_desc
[4].
	`£tup
(
SQL_FIXCHAR
, "S_PHONE", 15);

145 
_desc
[5].
	`£tup
(
SQL_FLOAT
, "S_ACCTBAL");

146 
_desc
[6].
	`£tup
(
SQL_FIXCHAR
, "S_COMMENT", 101);

148 
ušt
 
keys
[1] = {0};

150 
ušt
 
fkeys
[1] = {3};

153 ià((
pd
 & 
PD_NORMAL
è&& !Õd & 
PD_NOLOCK
)) {

154 
	`TRACE
Ğ
TRACE_DEBUG
, "ReguÏ¸idx fÜ (%s)\n", 
_Çme
);

157 
	`ü—‹_´im¬y_idx_desc
("S_IDX", 0, 
keys
, 1);

159 
	`ü—‹_šdex_desc
("S_FK_NATION", 0, 
fkeys
, 1, 
çl£
);

161 
	}
}

164 
	g·¹_t
::
	$·¹_t
(cÚ¡ 
ušt4_t
& 
pd
) :

165 
	`bË_desc_t
("PART", 
TPCH_PART_FCOUNT
, 
pd
)

168 
_desc
[0].
	`£tup
(
SQL_INT
, "P_PARTKEY");

169 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "P_NAME", 55);

170 
_desc
[2].
	`£tup
(
SQL_FIXCHAR
, "P_MFGR", 25);

171 
_desc
[3].
	`£tup
(
SQL_FIXCHAR
, "P_BRAND", 10);

172 
_desc
[4].
	`£tup
(
SQL_FIXCHAR
, "P_TYPE", 25);

173 
_desc
[5].
	`£tup
(
SQL_INT
, "P_SIZE");

174 
_desc
[6].
	`£tup
(
SQL_FIXCHAR
, "P_CONTAINER", 10);

175 
_desc
[7].
	`£tup
(
SQL_FLOAT
, "P_RETAILPRICE");

176 
_desc
[8].
	`£tup
(
SQL_FIXCHAR
, "P_COMMENT", 23);

178 
ušt
 
keys
[1] = { 0 };

180 ià((
pd
 & 
PD_NORMAL
è&& !Õd & 
PD_NOLOCK
)) {

181 
	`TRACE
(
TRACE_DEBUG
, "ReguÏ¸idx fÜ (%s)\n", 
_Çme
);

183 
	`ü—‹_´im¬y_idx_desc
("P_IDX", 0, 
keys
, 1);

185 
	}
}

187 
	g·¹suµ_t
::
	$·¹suµ_t
(cÚ¡ 
ušt4_t
& 
pd
) :

188 
	`bË_desc_t
("PARTSUPP", 
TPCH_PARTSUPP_FCOUNT
, 
pd
)

191 
_desc
[0].
	`£tup
(
SQL_INT
, "PS_PARTKEY");

192 
_desc
[1].
	`£tup
(
SQL_INT
, "PS_SUPPKEY");

193 
_desc
[2].
	`£tup
(
SQL_INT
, "PS_AVAILQTY");

194 
_desc
[3].
	`£tup
(
SQL_FLOAT
, "PS_SUPPLYCOST");

195 
_desc
[4].
	`£tup
(
SQL_FIXCHAR
, "PS_COMMENT", 199);

197 
ušt
 
keys
[2] = { 0, 1 };

199 
ušt
 
fkeys1
[1] = { 0 };

201 
ušt
 
fkeys2
[1] = { 1 };

204 ià((
pd
 & 
PD_NORMAL
è&& !Õd & 
PD_NOLOCK
)) {

205 
	`TRACE
Ğ
TRACE_DEBUG
, "ReguÏ¸idx fÜ (%s)\n", 
_Çme
);

208 
	`ü—‹_´im¬y_idx_desc
("PS_IDX", 0, 
keys
, 2);

210 
	`ü—‹_šdex_desc
("PS_FK_PART", 0, 
fkeys1
, 1, 
çl£
);

212 
	`ü—‹_šdex_desc
("PS_FK_SUPP", 0, 
fkeys2
, 1, 
çl£
);

214 
	}
}

217 
	gcu¡om”_t
::
	$cu¡om”_t
(cÚ¡ 
ušt4_t
& 
pd
) :

218 
	`bË_desc_t
("CUSTOMER", 
TPCH_CUSTOMER_FCOUNT
, 
pd
)

221 
_desc
[0].
	`£tup
(
SQL_INT
, "C_CUSTKEY");

222 
_desc
[1].
	`£tup
(
SQL_FIXCHAR
, "C_NAME", 25);

223 
_desc
[2].
	`£tup
(
SQL_FIXCHAR
, "C_ADDRESS", 40);

224 
_desc
[3].
	`£tup
(
SQL_INT
, "C_NATIONKEY");

225 
_desc
[4].
	`£tup
(
SQL_FIXCHAR
, "C_PHONE", 15);

226 
_desc
[5].
	`£tup
(
SQL_FLOAT
, "C_ACCTBAL");

227 
_desc
[6].
	`£tup
(
SQL_FIXCHAR
, "C_MKTSEGMENT", 10);

228 
_desc
[7].
	`£tup
(
SQL_FIXCHAR
, "C_COMMENT", 117);

230 
ušt
 
keys
[1] = { 0 };

232 
ušt
 
fkeys
[1] = { 3 };

235 ià((
pd
 & 
PD_NORMAL
è&& !Õd & 
PD_NOLOCK
)) {

236 
	`TRACE
Ğ
TRACE_DEBUG
, "ReguÏ¸idx fÜ (%s)\n", 
_Çme
);

239 
	`ü—‹_´im¬y_idx_desc
("C_IDX", 0, 
keys
, 1);

241 
	`ü—‹_šdex_desc
("C_FK_NATION", 0, 
fkeys
, 1, 
çl£
);

243 
	}
}

246 
	gÜd”s_t
::
	$Üd”s_t
(cÚ¡ 
ušt4_t
& 
pd
) :

247 
	`bË_desc_t
("ORDERS", 
TPCH_ORDERS_FCOUNT
, 
pd
)

250 
_desc
[0].
	`£tup
(
SQL_INT
, "O_ORDERKEY");

251 
_desc
[1].
	`£tup
(
SQL_INT
, "O_CUSTKEY");

252 
_desc
[2].
	`£tup
(
SQL_CHAR
, "O_ORDERSTATUS");

253 
_desc
[3].
	`£tup
(
SQL_FLOAT
, "O_TOTALPRICE");

254 
_desc
[4].
	`£tup
(
SQL_FIXCHAR
, "O_ORDERDATE", 15);

255 
_desc
[5].
	`£tup
(
SQL_FIXCHAR
, "O_ORDERPRIORITY", 15);

256 
_desc
[6].
	`£tup
(
SQL_FIXCHAR
, "O_CLERK", 15);

257 
_desc
[7].
	`£tup
(
SQL_INT
, "O_SHIPPRIORITY");

258 
_desc
[8].
	`£tup
(
SQL_FIXCHAR
, "O_COMMENT", 79);

260 
ušt
 
keys
[1] = { 0 };

262 
ušt
 
fkeys
[1] = { 1 };

264 
ušt
 
keys2
[1] = { 4 };

267 ià((
pd
 & 
PD_NORMAL
è&& !Õd & 
PD_NOLOCK
)) {

268 
	`TRACE
Ğ
TRACE_DEBUG
, "ReguÏ¸idx fÜ (%s)\n", 
_Çme
);

271 
	`ü—‹_´im¬y_idx_desc
("O_IDX", 0, 
keys
, 1);

273 
	`ü—‹_šdex_desc
("O_FK_CUSTKEY", 0, 
fkeys
, 1, 
çl£
);

275 
	`ü—‹_šdex_desc
("O_IDX_ORDERDATE", 0, 
keys2
, 1, 
çl£
);

277 
	}
}

280 
	glše™em_t
::
	$lše™em_t
(cÚ¡ 
ušt4_t
& 
pd
) :

281 
	`bË_desc_t
("LINEITEM", 
TPCH_LINEITEM_FCOUNT
, 
pd
)

284 
_desc
[0].
	`£tup
(
SQL_INT
, "L_ORDERKEY");

285 
_desc
[1].
	`£tup
(
SQL_INT
, "L_PARTKEY");

286 
_desc
[2].
	`£tup
(
SQL_INT
, "L_SUPPKEY");

287 
_desc
[3].
	`£tup
(
SQL_INT
, "L_LINENUMBER");

288 
_desc
[4].
	`£tup
(
SQL_FLOAT
, "L_QUANTITY");

289 
_desc
[5].
	`£tup
(
SQL_FLOAT
, "L_EXTENDEDPRICE");

290 
_desc
[6].
	`£tup
(
SQL_FLOAT
, "L_DISCOUNT");

291 
_desc
[7].
	`£tup
(
SQL_FLOAT
, "L_TAX");

292 
_desc
[8].
	`£tup
(
SQL_CHAR
, "L_RETURNFLAG");

293 
_desc
[9].
	`£tup
(
SQL_CHAR
, "L_LINESTATUS");

294 
_desc
[10].
	`£tup
(
SQL_FIXCHAR
, "L_SHIPDATE", 15);

295 
_desc
[11].
	`£tup
(
SQL_FIXCHAR
, "L_COMMITDATE", 15);

296 
_desc
[12].
	`£tup
(
SQL_FIXCHAR
, "L_RECEIPTDATE", 15);

297 
_desc
[13].
	`£tup
(
SQL_FIXCHAR
, "L_SHIPINSTRUCT", 25);

298 
_desc
[14].
	`£tup
(
SQL_FIXCHAR
, "L_SHIPMODE", 10);

299 
_desc
[15].
	`£tup
(
SQL_FIXCHAR
, "L_COMMENT", 44);

301 
ušt
 
keys
[2] = {0, 3};

303 
ušt
 
fkeys1
[1] = { 0 };

305 
ušt
 
fkeys2
[2] = {1, 2};

307 
ušt
 
keys2
[1] = {10};

309 
ušt
 
keys3
[1] = {12};

313 ià((
pd
 & 
PD_NORMAL
è&& !Õd & 
PD_NOLOCK
)) {

314 
	`TRACE
Ğ
TRACE_DEBUG
, "ReguÏ¸idx fÜ (%s)\n", 
_Çme
);

317 
	`ü—‹_´im¬y_idx_desc
("L_IDX", 0, 
keys
, 2);

319 
	`ü—‹_šdex_desc
("L_FK_ORDERKEY", 0, 
fkeys1
, 1, 
çl£
);

320 
	`ü—‹_šdex_desc
("L_FK_PARTSUPP", 0, 
fkeys2
, 2, 
çl£
);

322 
	`ü—‹_šdex_desc
("L_IDX_SHIPDATE", 0, 
keys2
, 1, 
çl£
);

323 
	`ü—‹_šdex_desc
("L_IDX_RECEIPTDATE", 0, 
keys3
, 1, 
çl£
);

325 
	}
}

328 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/shore_tpch_schema_man.cpp

34 
	~"wÜklßd/ch/shÜe_ch_schema_mª.h
"

35 
	~"ut.h
"

37 
usšg
 
Çme¥aû
 
	gshÜe
;

40 
ENTER_NAMESPACE
(
ch
);

55 
w_rc_t
 
	gÇtiÚ_mª_im¶
::
	$n_šdex_´obe
(
ss_m
* 
db
,

56 
ÇtiÚ_tu¶e
* 
±u¶e
,

57 cÚ¡ 
n_ÇtiÚkey
)

59 
	`as£¹
 (
±u¶e
);

60 
±u¶e
->
	`£t_v®ue
(0, 
n_ÇtiÚkey
);

61  (
	`šdex_´obe_by_Çme
(
db
, "N_IDX", 
±u¶e
));

62 
	}
}

70 
w_rc_t
 
	g»giÚ_mª_im¶
::
	$r_šdex_´obe
(
ss_m
* 
db
,

71 
»giÚ_tu¶e
* 
±u¶e
,

72 cÚ¡ 
r_»giÚkey
)

74 
	`as£¹
 (
±u¶e
);

75 
±u¶e
->
	`£t_v®ue
(0, 
r_»giÚkey
);

76  (
	`šdex_´obe_by_Çme
(
db
, "R_IDX", 
±u¶e
));

77 
	}
}

83 
w_rc_t
 
	g·¹_mª_im¶
::
	$p_šdex_´obe
(
ss_m
* 
db
,

84 
·¹_tu¶e
* 
±u¶e
,

85 cÚ¡ 
p_·¹key
)

87 
	`as£¹
(
±u¶e
);

89 
±u¶e
->
	`£t_v®ue
(0, 
p_·¹key
);

90  (
	`šdex_´obe_by_Çme
(
db
, "P_IDX", 
±u¶e
));

91 
	}
}

99 
w_rc_t
 
	gsuµl›r_mª_im¶
::
	$s_šdex_´obe
(
ss_m
* 
db
,

100 
suµl›r_tu¶e
* 
±u¶e
,

101 cÚ¡ 
s_suµkey
)

103 
	`as£¹
 (
±u¶e
);

104 
±u¶e
->
	`£t_v®ue
(0, 
s_suµkey
);

105  (
	`šdex_´obe_by_Çme
(
db
, "S_IDX", 
±u¶e
));

106 
	}
}

114 
w_rc_t
 
	g·¹suµ_mª_im¶
::
	$ps_šdex_´obe
(
ss_m
* 
db
,

115 
·¹suµ_tu¶e
* 
±u¶e
,

116 cÚ¡ 
ps_·¹key
,

117 cÚ¡ 
ps_suµkey
)

119 
	`as£¹
 (
±u¶e
);

120 
±u¶e
->
	`£t_v®ue
(0, 
ps_·¹key
);

121 
±u¶e
->
	`£t_v®ue
(1, 
ps_suµkey
);

122  (
	`šdex_´obe_by_Çme
(
db
, "PS_IDX", 
±u¶e
));

123 
	}
}

176 
w_rc_t
 
	gcu¡om”_mª_im¶
::
	$c_šdex_´obe
(
ss_m
* 
db
,

177 
cu¡om”_tu¶e
* 
±u¶e
,

178 cÚ¡ 
c_cu¡key
)

180 
	`as£¹
 (
±u¶e
);

181  (
	`c_šdex_´obe_by_Çme
(
db
, "C_IDX", 
±u¶e
, 
c_cu¡key
));

182 
	}
}

184 
w_rc_t
 
	gcu¡om”_mª_im¶
::
	$c_šdex_´obe_by_Çme
(
ss_m
* 
db
,

185 cÚ¡ * 
idx_Çme
,

186 
cu¡om”_tu¶e
* 
±u¶e
,

187 cÚ¡ 
c_cu¡key
)

189 
	`as£¹
 (
idx_Çme
);

190 
±u¶e
->
	`£t_v®ue
(0, 
c_cu¡key
);

191  (
	`šdex_´obe_by_Çme
(
db
, 
idx_Çme
, 
±u¶e
));

192 
	}
}

200 
w_rc_t
 
	gÜd”s_mª_im¶
::
	$o_g‘_™”_by_šdex
(
ss_m
* 
db
,

201 
Üd”s_šdex_™”
* &
™”
,

202 
Üd”s_tu¶e
* 
±u¶e
,

203 
»p_row_t
 &
»¶ow
,

204 
»p_row_t
 &
»phigh
,

205 cÚ¡ 
c_Üd”key
,

206 
lock_mode_t
 
®m
,

207 
boŞ
 
Ãed_tu¶e
)

209 
	`as£¹
 (
±u¶e
);

212 
	`as£¹
 (
_±abË
);

213 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("O_IDX");

214 
	`as£¹
 (
pšdex
);

217 
±u¶e
->
	`£t_v®ue
(0, 
c_Üd”key
);

219 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

220 
	`as£¹
 (
»¶ow
.
_de¡
);

223 
±u¶e
->
	`£t_v®ue
(0, 
c_Üd”key
 + 1);

225 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

226 
	`as£¹
 (
»phigh
.
_de¡
);

228 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
,

229 
®m
, 
Ãed_tu¶e
,

230 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

231 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

232  (
RCOK
);

233 
	}
}

235 
w_rc_t
 
	gÜd”s_mª_im¶
::
	$o_g‘_™”_by_fšdex
(
ss_m
* 
db
,

236 
Üd”s_šdex_™”
* &
™”
,

237 
Üd”s_tu¶e
* 
±u¶e
,

238 
»p_row_t
 &
»¶ow
,

239 
»p_row_t
 &
»phigh
,

240 cÚ¡ 
o_cu¡key
,

241 
lock_mode_t
 
®m
,

242 
boŞ
 
Ãed_tu¶e
)

244 
	`as£¹
 (
±u¶e
);

247 
	`as£¹
 (
_±abË
);

248 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("O_FK_CUSTKEY");

249 
	`as£¹
 (
pšdex
);

252 
±u¶e
->
	`£t_v®ue
(1, 
o_cu¡key
);

254 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

255 
	`as£¹
 (
»¶ow
.
_de¡
);

258 
±u¶e
->
	`£t_v®ue
(1, 
o_cu¡key
 + 1);

260 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

261 
	`as£¹
 (
»phigh
.
_de¡
);

263 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
,

264 
®m
, 
Ãed_tu¶e
,

265 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

266 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

267  (
RCOK
);

268 
	}
}

270 
w_rc_t
 
	gÜd”s_mª_im¶
::
	$o_g‘_¿nge_™”_by_šdex
(
ss_m
* 
db
,

271 
Üd”s_šdex_™”
* &
™”
,

272 
Üd”s_tu¶e
* 
±u¶e
,

273 
»p_row_t
 &
»¶ow
,

274 
»p_row_t
 &
»phigh
,

275 cÚ¡ 
time_t
 
low_o_Üd”d©e
,

276 cÚ¡ 
time_t
 
high_o_Üd”d©e
,

277 
lock_mode_t
 
®m
,

278 
boŞ
 
Ãed_tu¶e
)

280 
	`as£¹
(
±u¶e
);

283 
	`as£¹
 (
_±abË
);

284 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("O_IDX_ORDERDATE");

285 
	`as£¹
 (
pšdex
);

288 
low_d©e
[15];

289 
	`tim‘_to_¡r
(
low_d©e
, 
low_o_Üd”d©e
);

290 
±u¶e
->
	`£t_v®ue
(4, 
low_d©e
);

292 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

293 
	`as£¹
 (
»¶ow
.
_de¡
);

296 
high_d©e
[15];

297 
	`tim‘_to_¡r
(
high_d©e
, 
high_o_Üd”d©e
+1);

298 
±u¶e
->
	`£t_v®ue
(4, 
high_d©e
);

300 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

301 
	`as£¹
 (
»phigh
.
_de¡
);

304 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
,

305 
®m
, 
Ãed_tu¶e
,

306 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

307 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

308  (
RCOK
);

309 
	}
}

316 
w_rc_t
 
	glše™em_mª_im¶
::
	$l_g‘_¿nge_™”_by_»ûtd©e_šdex
(
ss_m
* 
db
,

317 
lše™em_šdex_™”
* &
™”
,

318 
lše™em_tu¶e
* 
±u¶e
,

319 
»p_row_t
 &
»¶ow
,

320 
»p_row_t
 &
»phigh
,

321 cÚ¡ 
time_t
 
low_l_»ûtd©e
,

322 cÚ¡ 
time_t
 
high_l_»ûtd©e
,

323 
lock_mode_t
 
®m
,

324 
boŞ
 
Ãed_tu¶e
)

326 
	`as£¹
 (
±u¶e
);

329 
	`as£¹
 (
_±abË
);

330 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("L_IDX_RECEIPTDATE");

331 
	`as£¹
 (
pšdex
);

334 
lowd©e
[15];

335 
	`tim‘_to_¡r
(
lowd©e
, 
low_l_»ûtd©e
);

336 
±u¶e
->
	`£t_v®ue
(12, 
lowd©e
);

338 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

339 
	`as£¹
 (
»¶ow
.
_de¡
);

342 
highd©e
[15];

343 
	`tim‘_to_¡r
(
highd©e
, 
high_l_»ûtd©e
+1);

344 
±u¶e
->
	`£t_v®ue
(12,
highd©e
 );

346 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

347 
	`as£¹
 (
»phigh
.
_de¡
);

350 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
,

351 
®m
, 
Ãed_tu¶e
,

352 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

353 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

354  (
RCOK
);

355 
	}
}

357 
w_rc_t
 
	glše™em_mª_im¶
::
	$l_g‘_¿nge_™”_by_šdex
(
ss_m
* 
db
,

358 
lše™em_šdex_™”
* &
™”
,

359 
lše™em_tu¶e
* 
±u¶e
,

360 
»p_row_t
 &
»¶ow
,

361 
»p_row_t
 &
»phigh
,

362 cÚ¡ 
time_t
 
low_l_shd©e
,

363 cÚ¡ 
time_t
 
high_l_shd©e
,

364 
lock_mode_t
 
®m
,

365 
boŞ
 
Ãed_tu¶e
)

367 
	`as£¹
 (
±u¶e
);

370 
	`as£¹
 (
_±abË
);

371 
šdex_desc_t
* 
pšdex
 = 
_±abË
->
	`fšd_šdex
("L_IDX_SHIPDATE");

372 
	`as£¹
 (
pšdex
);

375 
lowd©e
[15];

376 
	`tim‘_to_¡r
(
lowd©e
, 
low_l_shd©e
);

377 
±u¶e
->
	`£t_v®ue
(10, 
lowd©e
);

379 
lowsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»¶ow
);

380 
	`as£¹
 (
»¶ow
.
_de¡
);

383 
highd©e
[15];

384 
	`tim‘_to_¡r
(
highd©e
, 
high_l_shd©e
+1);

385 
±u¶e
->
	`£t_v®ue
(10, 
highd©e
);

387 
highsz
 = 
	`fÜm©_key
(
pšdex
, 
±u¶e
, 
»phigh
);

388 
	`as£¹
 (
»phigh
.
_de¡
);

391 
	`W_DO
(
	`g‘_™”_fÜ_šdex_sÿn
(
db
, 
pšdex
, 
™”
,

392 
®m
, 
Ãed_tu¶e
,

393 
sÿn_šdex_i
::
ge
, 
	`vec_t
(
»¶ow
.
_de¡
, 
lowsz
),

394 
sÿn_šdex_i
::
É
, 
	`vec_t
(
»phigh
.
_de¡
, 
highsz
)));

395  (
RCOK
);

396 
	}
}

399 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/shore_tpch_xct.cpp

32 
	~"wÜklßd/ch/shÜe_ch_’v.h
"

33 
	~"wÜklßd/ch/ch_¿ndom.h
"

34 
	~"wÜklßd/ch/ch_¡ruù.h
"

35 
	~"wÜklßd/ch/ch_ut.h
"

37 
	~<veùÜ
>

38 
	~<m­
>

39 
	~<£t
>

40 
	~<num”ic
>

41 
	~<®gÜ™hm
>

42 
	~<¡dio.h
>

43 
	~<f¡»am
>

44 
	~"wÜklßd/ch/dbg’/dss.h
"

45 
	~"wÜklßd/ch/dbg’/ds¡y³s.h
"

50 
	~"sm_ba£.h
"

52 
usšg
 
Çme¥aû
 
	g¡d
;

53 
usšg
 
Çme¥aû
 
	gshÜe
;

54 
usšg
 
Çme¥aû
 
	gdbg’ch
;

58 
ENTER_NAMESPACE
(
ch
);

69 
__th»ad
 
ShÜeTPCHTrxSts
 
	gmy_¡©s
;

71 
	gShÜeTPCHEnv
::
	$’v_th»ad_š™
()

73 
	`CRITICAL_SECTION
(
¡©_mu‹x_cs
, 
_¡©m­_mu‹x
);

74 
_¡©m­
[
	`±h»ad_£lf
()] = &
my_¡©s
;

75 
	}
}

77 
	gShÜeTPCHEnv
::
	$’v_th»ad_fši
()

79 
	`CRITICAL_SECTION
(
¡©_mu‹x_cs
, 
_¡©m­_mu‹x
);

80 
_¡©m­
.
	`”a£
(
	`±h»ad_£lf
());

81 
	}
}

92 
ShÜeTPCHTrxSts
 
	gShÜeTPCHEnv
::
	$_g‘_¡©s
()

94 
	`CRITICAL_SECTION
(
cs
, 
_¡©m­_mu‹x
);

95 
ShÜeTPCHTrxSts
 
rv®
;

96 
rv®
 -=„val;

97 
¡©m­_t
::
™”©Ü
 
™
=
_¡©m­
.
	`begš
(); iˆ!ğ_¡©m­.
	`’d
(); ++it)

98 
rv®
 +ğ*
™
->
£cÚd
;

99  (
rv®
);

100 
	}
}

111 
	gShÜeTPCHEnv
::
	$»£t_¡©s
()

113 
	`CRITICAL_SECTION
(
Ï¡_¡©s_cs
, 
_Ï¡_¡©s_mu‹x
);

114 
_Ï¡_¡©s
 = 
	`_g‘_¡©s
();

115 
	}
}

126 
	gShÜeTPCHEnv
::
	$´št_throughput
(cÚ¡ 
iQu”›dSF
,

127 cÚ¡ 
iS´—d
,

128 cÚ¡ 
iNumOfTh»ads
,

129 cÚ¡ 
d–ay
,

130 cÚ¡ 
ulÚg_t
 
mioch
,

131 cÚ¡ 
avgıuu§ge
)

133 
	`CRITICAL_SECTION
(
Ï¡_¡©s_cs
, 
_Ï¡_¡©s_mu‹x
);

136 
ShÜeTPCHTrxSts
 
cu¼’t_¡©s
 = 
	`_g‘_¡©s
();

139 
cu¼’t_¡©s
 -ğ
_Ï¡_¡©s
;

141 
ušt
 
Œxs_©t
 = 
cu¼’t_¡©s
.
©‹m±ed
.
	`tÙ®
();

142 
ušt
 
Œxs_abt
 = 
cu¼’t_¡©s
.
çed
.
	`tÙ®
();

143 
ušt
 
Œxs_dld
 = 
cu¼’t_¡©s
.
d—dlocked
.
	`tÙ®
();

145 
	`TRACE
Ğ
TRACE_ALWAYS
, "*******\n" \

156 
iQu”›dSF
,

157 (
iS´—d
 ? "Yes" : "No"),

158 
iNumOfTh»ads
, 
Œxs_©t
, 
Œxs_abt
, 
Œxs_dld
,

159 
d–ay
, 
mioch
/d–ay, 
avgıuu§ge
,

160 100*
avgıuu§ge
/
	`g‘_max_ıu_couÁ
(),

161 (
Œxs_©t
-
Œxs_abt
-
Œxs_dld
)/
d–ay
);

162 
	}
}

224 #undeà
DO_PRINT_TPCH_RECS


228 
w_rc_t
 
	gShÜeTPCHEnv
::
	$_g’_Úe_ÇtiÚ
(cÚ¡ 
id
, 
»p_row_t
& 
¬•row
)

230 
tu¶e_gu¬d
<
ÇtiÚ_mª_im¶
> 
	`´Ç
(
_²©iÚ_mª
);

231 
´Ç
->
_»p
 = &
¬•row
;

233 
code_t
 
ac
;

234 
	`mk_ÇtiÚ
(
id
, &
ac
);

236 #ifdeà
DO_PRINT_TPCH_RECS


237 
	`TRACE
Ğ
TRACE_ALWAYS
, "%ld,%s,%ld,%s,%d\n",

238 
ac
.
code
,‡c.
‹xt
,‡c.
još
,‡c.
comm’t
,‡c.
ş’
);

241 
´Ç
->
	`£t_v®ue
(0, ()
ac
.
code
);

242 
´Ç
->
	`£t_v®ue
(1, 
ac
.
‹xt
);

243 
´Ç
->
	`£t_v®ue
(2, ()
ac
.
još
);

244 
´Ç
->
	`£t_v®ue
(3, 
ac
.
comm’t
);

245 
	`W_DO
(
_²©iÚ_mª
->
	`add_tu¶e
(
_pssm
, 
´Ç
));

247  
RCOK
;

248 
	}
}

251 
w_rc_t
 
	gShÜeTPCHEnv
::
	$_g’_Úe_»giÚ
(cÚ¡ 
id
, 
»p_row_t
& 
¬•row
)

253 
tu¶e_gu¬d
<
»giÚ_mª_im¶
> 
	`´»
(
_´egiÚ_mª
);

254 
´»
->
_»p
 = &
¬•row
;

256 
code_t
 
ac
;

257 
	`mk_»giÚ
(
id
, &
ac
);

259 #ifdeà
DO_PRINT_TPCH_RECS


260 
	`TRACE
Ğ
TRACE_ALWAYS
, "%ld,%s,%s,%d\n",

261 
ac
.
code
,‡c.
‹xt
,‡c.
comm’t
,‡c.
ş’
);

264 
´»
->
	`£t_v®ue
(0, ()
ac
.
code
);

265 
´»
->
	`£t_v®ue
(1, 
ac
.
‹xt
);

266 
´»
->
	`£t_v®ue
(2, 
ac
.
comm’t
);

267 
	`W_DO
(
_´egiÚ_mª
->
	`add_tu¶e
(
_pssm
, 
´»
));

269  
RCOK
;

270 
	}
}

273 
w_rc_t
 
	gShÜeTPCHEnv
::
	$_g’_Úe_suµl›r
(cÚ¡ 
id
, 
»p_row_t
& 
¬•row
)

275 
tu¶e_gu¬d
<
suµl›r_mª_im¶
> 
	`´su
(
_psuµl›r_mª
);

276 
´su
->
_»p
 = &
¬•row
;

278 
dbg’ch
::
suµl›r_t
 
as
;

279 
	`mk_suµ
(
id
, &
as
);

281 #ifdeà
DO_PRINT_TPCH_RECS


282 ià(
id
%100==0) {

283 
	`TRACE
Ğ
TRACE_ALWAYS
, "%ld,%s,%s,%d,%ld,%s,%ld,%s,%d\n",

284 
as
.
suµkey
,as.
Çme
,as.
add»ss
,as.
®’
,as.
ÇtiÚ_code
,

285 
as
.
phÚe
,as.
acùb®
,as.
comm’t
,as.
ş’
);

289 
´su
->
	`£t_v®ue
(0, ()
as
.
suµkey
);

290 
´su
->
	`£t_v®ue
(1, 
as
.
Çme
);

291 
´su
->
	`£t_v®ue
(2, 
as
.
add»ss
);

292 
´su
->
	`£t_v®ue
(3, ()
as
.
ÇtiÚ_code
);

293 
´su
->
	`£t_v®ue
(4, 
as
.
phÚe
);

294 
´su
->
	`£t_v®ue
(5, ()
as
.
acùb®
);

295 
´su
->
	`£t_v®ue
(6, 
as
.
comm’t
);

296 
	`W_DO
(
_psuµl›r_mª
->
	`add_tu¶e
(
_pssm
, 
´su
));

298  
RCOK
;

299 
	}
}

302 
w_rc_t
 
	gShÜeTPCHEnv
::
	$_g’_Úe_·¹_ba£d
(cÚ¡ 
id
, 
»p_row_t
& 
¬•row
)

304 
tu¶e_gu¬d
<
·¹_mª_im¶
> 
	`´·
(
_µ¬t_mª
);

305 
tu¶e_gu¬d
<
·¹suµ_mª_im¶
> 
	`´ps
(
_µ¬tsuµ_mª
);

307 
´·
->
_»p
 = &
¬•row
;

308 
´ps
->
_»p
 = &
¬•row
;

311 
dbg’ch
::
·¹_t
 
­
;

312 
	`mk_·¹
(
id
, &
­
);

314 #ifdeà
DO_PRINT_TPCH_RECS


315 ià(
id
%100==0) {

316 
	`TRACE
Ğ
TRACE_ALWAYS
, "%ld,%s,%s,%s,%s,%ld,%s,%ld,%s\n",

317 
­
.
·¹key
,­.
Çme
,­.
mfgr
,­.
b¿nd
,­.
ty³
,

318 
­
.
size
,­.
cÚš”
,­.
»´iû
,­.
comm’t
);

322 
´·
->
	`£t_v®ue
(0, ()
­
.
·¹key
);

323 
´·
->
	`£t_v®ue
(1, 
­
.
Çme
);

324 
´·
->
	`£t_v®ue
(2, 
­
.
mfgr
);

325 
´·
->
	`£t_v®ue
(3, 
­
.
b¿nd
);

326 
´·
->
	`£t_v®ue
(4, 
­
.
ty³
);

327 
´·
->
	`£t_v®ue
(5, ()
­
.
size
);

328 
´·
->
	`£t_v®ue
(6, 
­
.
cÚš”
);

329 
´·
->
	`£t_v®ue
(7, ()
­
.
»´iû
);

330 
´·
->
	`£t_v®ue
(8, 
­
.
comm’t
);

331 
	`W_DO
(
_µ¬t_mª
->
	`add_tu¶e
(
_pssm
, 
´·
));

333 
i
=0; i< 
SUPP_PER_PART
; ++i) {

335 #ifdeà
DO_PRINT_TPCH_RECS


336 ià(
id
%100==0) {

337 
	`TRACE
Ğ
TRACE_ALWAYS
, "%ld,%ld,%ld,%ld,%s\n",

338 
­
.
s
[
i
].
·¹key
,­.s[i].
suµkey
,

339 
­
.
s
[
i
].
qty
,­.s[i].
sco¡
,

340 
­
.
s
[
i
].
comm’t
);

345 
´ps
->
	`£t_v®ue
(0, ()
­
.
s
[
i
].
·¹key
);

346 
´ps
->
	`£t_v®ue
(1, ()
­
.
s
[
i
].
suµkey
);

347 
´ps
->
	`£t_v®ue
(2, ()
­
.
s
[
i
].
qty
);

348 
´ps
->
	`£t_v®ue
(3, ()
­
.
s
[
i
].
sco¡
);

349 
´ps
->
	`£t_v®ue
(4, 
­
.
s
[
i
].
comm’t
);

350 
	`W_DO
(
_µ¬tsuµ_mª
->
	`add_tu¶e
(
_pssm
, 
´ps
));

353  
RCOK
;

354 
	}
}

357 
w_rc_t
 
	gShÜeTPCHEnv
::
	$_g’_Úe_cu¡_ba£d
(cÚ¡ 
id
, 
»p_row_t
& 
¬•row
)

359 
tu¶e_gu¬d
<
cu¡om”_mª_im¶
> 
	`´cu
(
_pcu¡om”_mª
);

360 
tu¶e_gu¬d
<
Üd”s_mª_im¶
> 
	`´Ü
(
_pÜd”s_mª
);

361 
tu¶e_gu¬d
<
lše™em_mª_im¶
> 
	`´li
(
_¶še™em_mª
);

363 
´cu
->
_»p
 = &
¬•row
;

364 
´Ü
->
_»p
 = &
¬•row
;

365 
´li
->
_»p
 = &
¬•row
;

368 
dbg’ch
::
cu¡om”_t
 
ac
;

369 
	`mk_cu¡
(
id
, &
ac
);

371 #ifdeà
DO_PRINT_TPCH_RECS


372 ià(
id
%100==0) {

373 
	`TRACE
Ğ
TRACE_ALWAYS
, "%ld,%s,%s,%ld,%s,%ld,%s,%s\n",

374 
ac
.
cu¡key
,ac.
Çme
,ac.
add»ss
,ac.
ÇtiÚ_code
,

375 
ac
.
phÚe
,ac.
acùb®
,ac.
mkt£gm’t
,ac.
comm’t
);

379 
´cu
->
	`£t_v®ue
(0, ()
ac
.
cu¡key
);

380 
´cu
->
	`£t_v®ue
(1, 
ac
.
Çme
);

381 
´cu
->
	`£t_v®ue
(2, 
ac
.
add»ss
);

382 
´cu
->
	`£t_v®ue
(3, ()
ac
.
ÇtiÚ_code
);

383 
´cu
->
	`£t_v®ue
(4, 
ac
.
phÚe
);

384 
´cu
->
	`£t_v®ue
(5, ()
ac
.
acùb®
);

385 
´cu
->
	`£t_v®ue
(6, 
ac
.
mkt£gm’t
);

386 
´cu
->
	`£t_v®ue
(7, 
ac
.
comm’t
);

387 
	`W_DO
Ğ
_pcu¡om”_mª
->
	`add_tu¶e
(
_pssm
, 
´cu
));

389 
i
=0; i<
ORDERS_PER_CUSTOMER
; ++i) {

391 
dbg’ch
::
Üd”_t
 
ao
;

392 
	`mk_Üd”
(
id
*10+
i
, &
ao
, 0);

394 #ifdeà
DO_PRINT_TPCH_RECS


395 ià(
id
%100==0) {

396 
	`TRACE
Ğ
TRACE_ALWAYS
, "%ld,%ld,%s,%ld,%s,%s,%s,%ld,%s\n",

397 
ao
.
okey
,ao.
cu¡key
,ao.
Üd”¡©us
,ao.
tÙ®´iû
,

398 
ao
.
od©e
,ao.
İriÜ™y
,ao.
ş”k
,ao.
¥riÜ™y
,ao.
comm’t
);

402 
´Ü
->
	`£t_v®ue
(0, ()
ao
.
okey
);

403 
´Ü
->
	`£t_v®ue
(1, ()
ao
.
cu¡key
);

404 
´Ü
->
	`£t_v®ue
(2, 
ao
.
Üd”¡©us
);

405 
´Ü
->
	`£t_v®ue
(3, ()
ao
.
tÙ®´iû
);

406 
´Ü
->
	`£t_v®ue
(4, 
ao
.
od©e
);

407 
´Ü
->
	`£t_v®ue
(5, 
ao
.
İriÜ™y
);

408 
´Ü
->
	`£t_v®ue
(6, 
ao
.
ş”k
);

409 
´Ü
->
	`£t_v®ue
(7, ()
ao
.
¥riÜ™y
);

410 
´Ü
->
	`£t_v®ue
(8, 
ao
.
comm’t
);

411 
	`W_DO
(
_pÜd”s_mª
->
	`add_tu¶e
(
_pssm
, 
´Ü
));

413 
j
=0; j<
ao
.
lšes
; ++j) {

415 #ifdeà
DO_PRINT_TPCH_RECS


416 ià(
id
%100==0) {

417 
	`TRACE
(
TRACE_ALWAYS
,"%ld,%ld,%ld,%ld,%ld,%ld,%ld,%ld,%s,%s,%s,%s,%s,%s,%s,%s\n",

418 
ao
.
l
[
j
].
okey
,ao.l[j].
·¹key
,ao.l[j].
suµkey
,

419 
ao
.
l
[
j
].
lút
,ao.l[j].
quªt™y
,ao.l[j].
•riû
,

420 
ao
.
l
[
j
].
discouÁ
,ao.l[j].
x
,

421 
ao
.
l
[
j
].
ræag
,ao.l[j].
l¡©us
,

422 
ao
.
l
[
j
].
cd©e
,ao.l[j].
sd©e
,ao.l[j].
rd©e
,

423 
ao
.
l
[
j
].
shš¡ruù
,ao.l[j].
shmode
,ao.l[j].
comm’t
);

427 
´li
->
	`£t_v®ue
(0, ()
ao
.
l
[
j
].
okey
);

428 
´li
->
	`£t_v®ue
(1, ()
ao
.
l
[
j
].
·¹key
);

429 
´li
->
	`£t_v®ue
(2, ()
ao
.
l
[
j
].
suµkey
);

430 
´li
->
	`£t_v®ue
(3, ()
ao
.
l
[
j
].
lút
);

431 
´li
->
	`£t_v®ue
(4, ()
ao
.
l
[
j
].
quªt™y
);

432 
´li
->
	`£t_v®ue
(5, ()
ao
.
l
[
j
].
•riû
);

433 
´li
->
	`£t_v®ue
(6, ()
ao
.
l
[
j
].
discouÁ
);

434 
´li
->
	`£t_v®ue
(7, ()
ao
.
l
[
j
].
x
);

435 
´li
->
	`£t_v®ue
(8, 
ao
.
l
[
j
].
ræag
);

436 
´li
->
	`£t_v®ue
(9, 
ao
.
l
[
j
].
l¡©us
);

437 
´li
->
	`£t_v®ue
(10, 
ao
.
l
[
j
].
cd©e
);

438 
´li
->
	`£t_v®ue
(11, 
ao
.
l
[
j
].
sd©e
);

439 
´li
->
	`£t_v®ue
(12, 
ao
.
l
[
j
].
rd©e
);

440 
´li
->
	`£t_v®ue
(13, 
ao
.
l
[
j
].
shš¡ruù
);

441 
´li
->
	`£t_v®ue
(14, 
ao
.
l
[
j
].
shmode
);

442 
´li
->
	`£t_v®ue
(15, 
ao
.
l
[
j
].
comm’t
);

443 
	`W_DO
(
_¶še™em_mª
->
	`add_tu¶e
(
_pssm
, 
´li
));

447  
RCOK
;

448 
	}
}

457 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_pİuÏ‹_ba£lše
(const ,

458 
pİuÏ‹_ba£lše_šput_t
& 
š
)

461 
	`as£¹
 (
_pssm
);

462 
	`as£¹
 (
_š™Ÿlized
);

465 
»p_row_t
 
	`¬•row
(
_pcu¡om”_mª
->
	`ts
());

466 
¬•row
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

469 
	`TRACE
Ğ
TRACE_ALWAYS
, "Building NATION !!!\n");

470 
i
=0; i<
NO_NATIONS
; ++i) {

471 
	`W_DO
(
	`_g’_Úe_ÇtiÚ
(
i
, 
¬•row
));

474 
	`TRACE
Ğ
TRACE_ALWAYS
, "Building REGION !!!\n");

475 
i
=0; i<
NO_REGIONS
; ++i) {

476 
	`W_DO
(
	`_g’_Úe_»giÚ
(
i
, 
¬•row
));

479 
	`TRACE
Ğ
TRACE_ALWAYS
, "Building SUPPLIER !!!\n");

480 
i
=0; i<
š
.
_sf
*
SUPPLIER_PER_SF
; ++i) {

481 
	`W_DO
(
	`_g’_Úe_suµl›r
(
i
, 
¬•row
));

484 
	`W_COERCE
(
_pssm
->
	`comm™_xù
());

485 
	`W_COERCE
(
_pssm
->
	`begš_xù
());

488 ià(
š
.
_lßd”_couÁ
 == 1) {

489 
sf
=
š
.
_sf
;

490 
µsf
=
PART_PER_SF
;

491 
	`TRACE
Ğ
TRACE_ALWAYS
, "Budšg PARTS‡nd PARTSUPP (%d)!!!\n",
sf
*
µsf
);

493 
¡•
=
š
.
_sf
*
PART_PER_SF
/10;

494 
i
=0; i<
š
.
_sf
*
PART_PER_SF
; ++i) {

495 
	`W_DO
(
	`_g’_Úe_·¹_ba£d
(
i
, 
¬•row
));

496 ià(
i
>0 && i%
¡•
==0) {

497 
	`TRACE
Ğ
TRACE_ALWAYS
, "PARTS-PARTSUPP(%d\%)!!!\n", 10*
i
/
¡•
);

498 
	`W_COERCE
(
_pssm
->
	`comm™_xù
());

499 
	`W_COERCE
(
_pssm
->
	`begš_xù
());

503 
	`TRACE
Ğ
TRACE_ALWAYS
, "Starting PARTS !!!\n");

504 
i
 = 0; i < 
š
.
_lßd”_couÁ
; ++i) {

505 
¡¬t
 = 
i
 * 
š
.
_·¹s_³r_th»ad
;

506 
’d
 = 
¡¬t
 + 
š
.
_divisÜ
 - 1;

507 
	`TRACE
(
TRACE_ALWAYS
, "P¬t %d .. %d\n", 
¡¬t
, 
’d
);

508 
j
 = 
¡¬t
; j < 
’d
; ++j) {

509 
	`W_DO
(
	`_g’_Úe_·¹_ba£d
(
j
, 
¬•row
));

515 ià(
š
.
_lßd”_couÁ
 == 1) {

516 
sf
=
š
.
_sf
;

517 
ısf
=
CUSTOMER_PER_SF
;

518 
	`TRACE
Ğ
TRACE_ALWAYS
,"Budšg CUSTS, ORDERS, LINEITEM (%d)!!!\n",
sf
*
ısf
);

520 
¡•
=
š
.
_sf
*
CUSTOMER_PER_SF
/10;

521 
¡•100
=
š
.
_sf
*
CUSTOMER_PER_SF
/100;

522 
cu¼’t
=0;

523 
i
=0; i<
š
.
_sf
*
CUSTOMER_PER_SF
; ++i) {

524 
	`W_DO
(
	`_g’_Úe_cu¡_ba£d
(
i
,
¬•row
));

525 ià(
i
>0 && i%
¡•
==0) {

526 
	`TRACE
(
TRACE_ALWAYS
,"\nCUSTS-ORDERS-LINEITEM(%d\%)!\n",100*
i
/
¡•
);

528 ià(
i
>0 && i%
¡•100
==0) {

529 
	`W_COERCE
(
_pssm
->
	`comm™_xù
());

530 
	`W_COERCE
(
_pssm
->
	`begš_xù
());

532 ià(
cu¼’t
==1000) {

533 
	`´štf
(".");

534 
cu¼’t
=0;

536 
cu¼’t
++;

540 
	`TRACE
Ğ
TRACE_ALWAYS
, "Starting CUSTS !!!\n");

541 
i
=0; i < 
š
.
_lßd”_couÁ
; ++i) {

542 
¡¬t
 = 
i
*
š
.
_cu¡s_³r_th»ad
;

543 
’d
 = 
¡¬t
 + 
š
.
_divisÜ
 - 1;

544 
	`TRACE
Ğ
TRACE_ALWAYS
, "[%d/%d] Custs %d .. %d\n",

545 
i
, 
š
.
_lßd”_couÁ
, 
¡¬t
, 
’d
);

546 
j
=
¡¬t
; j<
’d
; ++j) {

547 
	`W_DO
(
	`_g’_Úe_cu¡_ba£d
(
j
,
¬•row
));

552  (
_pssm
->
	`comm™_xù
());

553 
	}
}

557 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_pİuÏ‹_some_·¹s
(cÚ¡ 
xù_id
,

558 
pİuÏ‹_some_·¹s_šput_t
& 
š
)

561 
	`as£¹
 (
_pssm
);

562 
	`as£¹
 (
_š™Ÿlized
);

565 
»p_row_t
 
	`¬•row
(
_µ¬tsuµ_mª
->
	`ts
());

566 
¬•row
.
	`£t
(
_µ¬tsuµ_desc
->
	`maxsize
());

568 
id
 = 
š
.
_·¹id
;

571 
id
=
š
.
_·¹id
; id<š._·¹id+
xù_id
; id++) {

572 
	`W_DO
(
	`_g’_Úe_·¹_ba£d
(
id
, 
¬•row
));

575  (
_pssm
->
	`comm™_xù
());

576 
	}
}

580 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_pİuÏ‹_some_cu¡s
(cÚ¡ 
xù_id
,

581 
pİuÏ‹_some_cu¡s_šput_t
& 
š
)

584 
	`as£¹
 (
_pssm
);

585 
	`as£¹
 (
_š™Ÿlized
);

588 
»p_row_t
 
	`¬•row
(
_pcu¡om”_mª
->
	`ts
());

589 
¬•row
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

591 
id
 = 
š
.
_cu¡id
;

594 
id
=
š
.
_cu¡id
; id<š._cu¡id+
xù_id
; id++) {

595 
	`W_DO
(
	`_g’_Úe_cu¡_ba£d
(
id
, 
¬•row
));

598  (
_pssm
->
	`comm™_xù
());

599 
	}
}

624 
w_rc_t
 
	gShÜeTPCHEnv
::
	$run_Úe_xù
(
Reque¡
* 
´eque¡
)

626 #ifdeà
CFG_QPIPE


627 ià(
´eque¡
->
	`ty³
(è>ğ
XCT_QPIPE_TPCH_MIX
) {

628  (
	`run_Úe_qpe_xù
(
´eque¡
));

633 ià(
´eque¡
->
	`ty³
(è=ğ
XCT_TPCH_MIX
) {

634 
´eque¡
->
	`£t_ty³
(
XCT_TPCH_MIX
 + 
smth»ad_t
::
	`¿nd
()%22);

637 
´eque¡
->
	`ty³
()) {

640 
XCT_TPCH_Q1
:

641  (
	`run_q1
(
´eque¡
));

643 
XCT_TPCH_Q2
:

644  (
	`run_q2
(
´eque¡
));

646 
XCT_TPCH_Q3
:

647  (
	`run_q3
(
´eque¡
));

649 
XCT_TPCH_Q4
:

650  (
	`run_q4
(
´eque¡
));

652 
XCT_TPCH_Q5
:

653  (
	`run_q5
(
´eque¡
));

655 
XCT_TPCH_Q6
:

656  (
	`run_q6
(
´eque¡
));;

658 
XCT_TPCH_Q7
:

659  (
	`run_q7
(
´eque¡
));

661 
XCT_TPCH_Q8
:

662  (
	`run_q8
(
´eque¡
));

664 
XCT_TPCH_Q9
:

665  (
	`run_q9
(
´eque¡
));

667 
XCT_TPCH_Q10
:

668  (
	`run_q10
(
´eque¡
));

670 
XCT_TPCH_Q11
:

671  (
	`run_q11
(
´eque¡
));

673 
XCT_TPCH_Q12
:

674  (
	`run_q12
(
´eque¡
));;

676 
XCT_TPCH_Q13
:

677  (
	`run_q13
(
´eque¡
));

679 
XCT_TPCH_Q14
:

680  (
	`run_q14
(
´eque¡
));;

682 
XCT_TPCH_Q15
:

683  (
	`run_q15
(
´eque¡
));

685 
XCT_TPCH_Q16
:

686  (
	`run_q16
(
´eque¡
));

688 
XCT_TPCH_Q17
:

689  (
	`run_q17
(
´eque¡
));

691 
XCT_TPCH_Q18
:

692  (
	`run_q18
(
´eque¡
));

694 
XCT_TPCH_Q19
:

695  (
	`run_q19
(
´eque¡
));

697 
XCT_TPCH_Q20
:

698  (
	`run_q20
(
´eque¡
));

700 
XCT_TPCH_Q21
:

701  (
	`run_q21
(
´eque¡
));

703 
XCT_TPCH_Q22
:

704  (
	`run_q22
(
´eque¡
));

706 
XCT_TPCH_QLINEITEM
:

707  (
	`run_qlše™em
(
´eque¡
));

709 
XCT_TPCH_QORDERS
:

710  (
	`run_qÜd”s
(
´eque¡
));

712 
XCT_TPCH_QREGION
:

713  (
	`run_q»giÚ
(
´eque¡
));

715 
XCT_TPCH_QNATION
:

716  (
	`run_qÇtiÚ
(
´eque¡
));

718 
XCT_TPCH_QCUSTOMER
:

719  (
	`run_qcu¡om”
(
´eque¡
));

721 
XCT_TPCH_QSUPPLIER
:

722  (
	`run_qsuµl›r
(
´eque¡
));

724 
XCT_TPCH_QPART
:

725  (
	`run_q·¹
(
´eque¡
));

727 
XCT_TPCH_QPARTSUPP
:

728  (
	`run_q·¹suµ
(
´eque¡
));

732 
	`TRACE
Ğ
TRACE_ALWAYS
, "Unknownransaction\n");

733 
	`as£¹
(0);

735  (
RCOK
);

736 
	}
}

756 
DEFINE_TRX
(
ShÜeTPCHEnv
,
q1
);

757 
DEFINE_TRX
(
ShÜeTPCHEnv
,
q2
);

758 
DEFINE_TRX
(
ShÜeTPCHEnv
,
q3
);

759 
DEFINE_TRX
(
ShÜeTPCHEnv
,
q4
);

760 
DEFINE_TRX
(
ShÜeTPCHEnv
,
q5
);

761 
DEFINE_TRX
(
ShÜeTPCHEnv
,
q6
);

762 
DEFINE_TRX
(
ShÜeTPCHEnv
,
q7
);

763 
DEFINE_TRX
(
ShÜeTPCHEnv
,
q8
);

764 
DEFINE_TRX
(
ShÜeTPCHEnv
,
q9
);

765 
DEFINE_TRX
(
ShÜeTPCHEnv
,
q10
);

766 
DEFINE_TRX
(
ShÜeTPCHEnv
,
q11
);

767 
DEFINE_TRX
(
ShÜeTPCHEnv
,
q12
);

768 
DEFINE_TRX
(
ShÜeTPCHEnv
,
q13
);

769 
DEFINE_TRX
(
ShÜeTPCHEnv
,
q14
);

770 
DEFINE_TRX
(
ShÜeTPCHEnv
,
q15
);

771 
DEFINE_TRX
(
ShÜeTPCHEnv
,
q16
);

772 
DEFINE_TRX
(
ShÜeTPCHEnv
,
q17
);

773 
DEFINE_TRX
(
ShÜeTPCHEnv
,
q18
);

774 
DEFINE_TRX
(
ShÜeTPCHEnv
,
q19
);

775 
DEFINE_TRX
(
ShÜeTPCHEnv
,
q20
);

776 
DEFINE_TRX
(
ShÜeTPCHEnv
,
q21
);

777 
DEFINE_TRX
(
ShÜeTPCHEnv
,
q22
);

778 
DEFINE_TRX
(
ShÜeTPCHEnv
,
qlše™em
);

779 
DEFINE_TRX
(
ShÜeTPCHEnv
,
qÜd”s
);

780 
DEFINE_TRX
(
ShÜeTPCHEnv
,
q·¹
);

781 
DEFINE_TRX
(
ShÜeTPCHEnv
,
q·¹suµ
);

782 
DEFINE_TRX
(
ShÜeTPCHEnv
,
qsuµl›r
);

783 
DEFINE_TRX
(
ShÜeTPCHEnv
,
qÇtiÚ
);

784 
DEFINE_TRX
(
ShÜeTPCHEnv
,
q»giÚ
);

785 
DEFINE_TRX
(
ShÜeTPCHEnv
,
qcu¡om”
);

792 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qlše™em
 (cÚ¡ , 
qlše™em_šput_t
&)

794 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** SCAN *********\n");

795  (
	`RC
(
smËv–_0
::
eNOTIMPLEMENTED
));

796 
	}
}

798 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qÜd”s
 (cÚ¡ , 
qÜd”s_šput_t
&)

800 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** SCAN *********\n");

801  (
	`RC
(
smËv–_0
::
eNOTIMPLEMENTED
));

802 
	}
}

804 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qÇtiÚ
 (cÚ¡ , 
qÇtiÚ_šput_t
&)

806 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** SCAN *********\n");

807  (
	`RC
(
smËv–_0
::
eNOTIMPLEMENTED
));

808 
	}
}

810 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_q»giÚ
 (cÚ¡ , 
q»giÚ_šput_t
&)

812 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** SCAN *********\n");

813  (
	`RC
(
smËv–_0
::
eNOTIMPLEMENTED
));

814 
	}
}

816 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qcu¡om”
(cÚ¡ , 
qcu¡om”_šput_t
&)

818 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** SCAN *********\n");

819  (
	`RC
(
smËv–_0
::
eNOTIMPLEMENTED
));

820 
	}
}

822 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_qsuµl›r
(cÚ¡ , 
qsuµl›r_šput_t
&)

824 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** SCAN *********\n");

825  (
	`RC
(
smËv–_0
::
eNOTIMPLEMENTED
));

826 
	}
}

828 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_q·¹
 (cÚ¡ , 
q·¹_šput_t
&)

830 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** SCAN *********\n");

831  (
	`RC
(
smËv–_0
::
eNOTIMPLEMENTED
));

832 
	}
}

834 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_q·¹suµ
(cÚ¡ , 
q·¹suµ_šput_t
&)

836 
	`TRACE
Ğ
TRACE_ALWAYS
, "********** SCAN *********\n");

837  (
	`RC
(
smËv–_0
::
eNOTIMPLEMENTED
));

838 
	}
}

848 
	sq1_group_by_key_t


850 
	m»tuº_æag
;

851 
	mlše¡©us
;

853 
q1_group_by_key_t
(
æag
, 
¡©us
)

855 
	m»tuº_æag
 = 
æag
;

856 
	mlše¡©us
 = 
¡©us
;

861 
q1_group_by_key_t
(cÚ¡ q1_group_by_key_t& 
rhs
)

863 
	m»tuº_æag
 = 
rhs
.
»tuº_æag
;

864 
	mlše¡©us
 = 
rhs
.
lše¡©us
;

869 
	mq1_group_by_key_t
& 
	mİ”©Ü
=(cÚ¡ 
q1_group_by_key_t
& 
rhs
)

871 
»tuº_æag
 = 
rhs
.return_flag;

872 
	mlše¡©us
 = 
rhs
.
lše¡©us
;

875  (*
	mthis
);

880 şas 
	cq1_group_by_comp
 {

881 
	mpublic
:

882 
boŞ
 
	$İ”©Ü
() (

883 cÚ¡ 
q1_group_by_key_t
& 
lhs
,

884 cÚ¡ 
q1_group_by_key_t
& 
rhs
) const

886  ((
lhs
.
»tuº_æag
 < 
rhs
.return_flag) ||

887 ((
lhs
.
»tuº_æag
 =ğ
rhs
.return_flag) &&

888 (
lhs
.
lše¡©us
 < 
rhs
.linestatus))

891 
	}
};

894 şas 
	cq1_group_by_v®ue_t
 {

895 
	mpublic
:

896 
sum_qty
;

897 
	msum_ba£_´iû
;

898 
decim®
 
	msum_disc_´iû
;

899 
decim®
 
	msum_ch¬ge
;

900 
decim®
 
	msum_discouÁ
;

901 
	mcouÁ
;

903 
	$q1_group_by_v®ue_t
() {

904 
sum_qty
 = 0;

905 
sum_ba£_´iû
 = 0;

906 
sum_disc_´iû
 = 0;

907 
sum_ch¬ge
 = 0;

908 
sum_discouÁ
 = 0;

909 
couÁ
 = 0;

912 
	$q1_group_by_v®ue_t
(cÚ¡ 
q1_group_by_v®ue_t
& 
rhs
) {

913 
sum_qty
 = 
rhs
.sum_qty;

914 
sum_ba£_´iû
 = 
rhs
.sum_base_price;

915 
sum_disc_´iû
 = 
rhs
.sum_disc_price;;

916 
sum_ch¬ge
 = 
rhs
.sum_charge;

917 
sum_discouÁ
 = 
rhs
.sum_discount;

918 
couÁ
 = 
rhs
.count;

919 
	}
}

921 
	gq1_group_by_v®ue_t
& 
	gİ”©Ü
+=(cÚ¡ 
q1_group_by_v®ue_t
& 
rhs
)

923 
sum_qty
 +ğ
rhs
.sum_qty;

924 
	gsum_ba£_´iû
 +ğ
rhs
.
sum_ba£_´iû
;

925 
	gsum_disc_´iû
 +ğ
rhs
.
sum_disc_´iû
;;

926 
	gsum_ch¬ge
 +ğ
rhs
.
sum_ch¬ge
;

927 
	gsum_discouÁ
 +ğ
rhs
.
sum_discouÁ
;

928 
	gcouÁ
 +ğ
rhs
.
couÁ
;

930 (*
	gthis
);

935 
	sq1_ouut_–e_t


937 
	ml_»tuºæag
;

938 
	ml_lše¡©us
;

939 
	msum_qty
;

940 
	msum_ba£_´iû
;

941 
decim®
 
	msum_disc_´iû
;

942 
decim®
 
	msum_ch¬ge
;

943 
decim®
 
	mavg_qty
;

944 
decim®
 
	mavg_´iû
;

945 
decim®
 
	mavg_disc
;

946 
	mcouÁ_Üd”
;

950 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_q1
(cÚ¡ , 
q1_šput_t
& 
pq1š
)

953 
	`as£¹
 (
_pssm
);

954 
	`as£¹
 (
_š™Ÿlized
);

955 
	`as£¹
 (
_lßded
);

959 
tu¶e_gu¬d
<
lše™em_mª_im¶
> 
	`´lše™em
(
_¶še™em_mª
);

962 
»p_row_t
 
	`¬•row
(
_¶še™em_mª
->
	`ts
());

963 
¬•row
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

965 
´lše™em
->
_»p
 = &
¬•row
;

992 
gu¬d
< 
bË_sÿn_™”_im¶
<
lše™em_t
> > 
l_™”
;

994 
bË_sÿn_™”_im¶
<
lše™em_t
>* 
tmp_l_™”
;

995 
	`W_DO
(
_¶še™em_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_l_™”
));

996 
l_™”
 = 
tmp_l_™”
;

999 
boŞ
 
eof
;

1000 
ch_lše™em_tu¶e
 
®še
;

1001 
m­
<
q1_group_by_key_t
, 
q1_group_by_v®ue_t
, 
q1_group_by_comp
> 
q1_»suÉ
;

1002 
m­
<
q1_group_by_key_t
, 
q1_group_by_v®ue_t
>::
™”©Ü
 
™
;

1003 
veùÜ
<
q1_ouut_–e_t
> 
q1_ouut
;

1019 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

1020 
q1_group_by_v®ue_t
 
v®ue
;

1021 !
eof
) {

1022 
´lše™em
->
	`g‘_v®ue
(4, 
®še
.
L_QUANTITY
);

1023 
´lše™em
->
	`g‘_v®ue
(5, 
®še
.
L_EXTENDEDPRICE
);

1024 
´lše™em
->
	`g‘_v®ue
(6, 
®še
.
L_DISCOUNT
);

1025 
´lše™em
->
	`g‘_v®ue
(7, 
®še
.
L_TAX
);

1026 
´lše™em
->
	`g‘_v®ue
(8, 
®še
.
L_RETURNFLAG
);

1027 
´lše™em
->
	`g‘_v®ue
(9, 
®še
.
L_LINESTATUS
);

1028 
´lše™em
->
	`g‘_v®ue
(10, 
®še
.
L_SHIPDATE
, 15);

1030 
time_t
 
the_shd©e
 = 
	`¡r_to_tim‘
(
®še
.
L_SHIPDATE
);

1032 ià(
the_shd©e
 <ğ
pq1š
.
l_shd©e
) {

1033 
q1_group_by_key_t
 
	`key
(
®še
.
L_RETURNFLAG
,‡lše.
L_LINESTATUS
);

1035 
v®ue
.
sum_qty
 = 
®še
.
L_QUANTITY
;

1036 
v®ue
.
sum_ba£_´iû
 = 
®še
.
L_EXTENDEDPRICE
;

1037 
v®ue
.
sum_disc_´iû
 = (
®še
.
L_EXTENDEDPRICE
 * (1-®še.
L_DISCOUNT
));

1038 
v®ue
.
sum_ch¬ge
 = (
®še
.
L_EXTENDEDPRICE
 * (1-®še.
L_DISCOUNT
) *

1039 (1+
®še
.
L_TAX
));

1040 
v®ue
.
sum_discouÁ
 = (
®še
.
L_DISCOUNT
);

1041 
v®ue
.
couÁ
 = 1;

1043 
™
 = 
q1_»suÉ
.
	`fšd
(
key
);

1044 ià(
™
 !ğ
q1_»suÉ
.
	`’d
()) {

1046 (*
™
).
£cÚd
 +ğ
v®ue
;

1048 
q1_»suÉ
.
	`š£¹
(
·œ
<
q1_group_by_key_t
,

1049 
q1_group_by_v®ue_t
>(
key
, 
v®ue
));

1052 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

1055 
q1_ouut_–e_t
 
q1_ouut_–e
;

1056 
™
 = 
q1_»suÉ
.
	`begš
(); iˆ!ğq1_»suÉ.
	`’d
(); it ++) {

1057 
q1_ouut_–e
.
l_»tuºæag
 = (*
™
).
fœ¡
.
»tuº_æag
;

1058 
q1_ouut_–e
.
l_lše¡©us
 = (*
™
).
fœ¡
.
lše¡©us
;

1059 
q1_ouut_–e
.
sum_qty
 = (*
™
).
£cÚd
.sum_qty;

1060 
q1_ouut_–e
.
sum_ba£_´iû
 = (*
™
).
£cÚd
.sum_base_price;

1061 
q1_ouut_–e
.
sum_disc_´iû
 = (*
™
).
£cÚd
.sum_disc_price;

1062 
q1_ouut_–e
.
sum_ch¬ge
 = (*
™
).
£cÚd
.sum_charge;

1063 
q1_ouut_–e
.
avg_qty
 = (*
™
).
£cÚd
.
sum_qty
 / (*™).£cÚd.
couÁ
;

1064 
q1_ouut_–e
.
avg_´iû
 = (*
™
).
£cÚd
.
sum_ba£_´iû
/(*™).£cÚd.
couÁ
;

1065 
q1_ouut_–e
.
avg_disc
 = (*
™
).
£cÚd
.
sum_discouÁ
 / (*™).£cÚd.
couÁ
;

1066 
q1_ouut_–e
.
couÁ_Üd”
 = (*
™
).
£cÚd
.
couÁ
;

1067 
q1_ouut
.
	`push_back
(
q1_ouut_–e
);

1069 
	`TRACE
Ğ
TRACE_QUERY_RESULTS
, "%d|%d|%d|%d|%.2f|%.2f|%.2f|%.2f|%.2f|%d\n",

1070 
q1_ouut_–e
.
l_»tuºæag
,

1071 
q1_ouut_–e
.
l_lše¡©us
,

1072 
q1_ouut_–e
.
sum_qty
,

1073 
q1_ouut_–e
.
sum_ba£_´iû
,

1074 
q1_ouut_–e
.
sum_disc_´iû
.
	`to_doubË
(),

1075 
q1_ouut_–e
.
sum_ch¬ge
.
	`to_doubË
(),

1076 
q1_ouut_–e
.
avg_qty
.
	`to_doubË
(),

1077 
q1_ouut_–e
.
avg_´iû
.
	`to_doubË
(),

1078 
q1_ouut_–e
.
avg_disc
.
	`to_doubË
(),

1079 
q1_ouut_–e
.
couÁ_Üd”
);

1082  
RCOK
;

1084 
	}
};

1094 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_q2
(cÚ¡ , 
q2_šput_t
& 
q2š
)

1097 
	`as£¹
 (
_pssm
);

1098 
	`as£¹
 (
_š™Ÿlized
);

1099 
	`as£¹
 (
_lßded
);

1102 
m­
<, 
·œ
< 
decim®
, 
veùÜ
<>* > > 
mšli¡
;

1104 
tu¶e_gu¬d
<
·¹_mª_im¶
> 
	`´·¹
(
_µ¬t_mª
);

1106 
»p_row_t
 
	`´•row
(
_µ¬t_mª
->
	`ts
());

1107 
´•row
.
	`£t
(
_µ¬t_desc
->
	`maxsize
());

1109 
´·¹
->
_»p
 = &
´•row
;

1111 
gu¬d
<
bË_sÿn_™”_im¶
<
·¹_t
> > 
p_™”
;

1113 
bË_sÿn_™”_im¶
<
·¹_t
>* 
tmp_p_™”
;

1114 
	`W_DO
(
_µ¬t_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_p_™”
));

1115 
p_™”
 = 
tmp_p_™”
;

1118 
boŞ
 
eof
;

1119 
ch_·¹_tu¶e
 
­¬t
;

1121 
	`W_DO
(
p_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´·¹
));

1123 !
eof
){

1124 
size
;

1125 
´·¹
->
	`g‘_v®ue
(0, 
­¬t
.
P_PARTKEY
);

1126 
´·¹
->
	`g‘_v®ue
(4, 
­¬t
.
P_TYPE
, 25);

1127 
´·¹
->
	`g‘_v®ue
(5, 
size
);

1129 
ty³s3
[10];

1130 
	`ty³s3_to_¡r
(
ty³s3
, 
q2š
.
p_ty³s3
);

1132 ifĞ
size
 =ğ
q2š
.
p_size
 && 
	`¡r¡r
(
­¬t
.
P_TYPE
, 
ty³s3
è!ğ
NULL
){

1133 
veùÜ
<>* 
v
 = 
Ãw
 vector<>();

1134 
mšli¡
.
	`š£¹
(
·œ
<,

1135 
·œ
< 
decim®
,
veùÜ
<>* > >(
­¬t
.
P_PARTKEY
,

1136 
·œ
<
decim®
,

1137 
veùÜ
<>* >(-1, 
v
)));

1139 
	`W_DO
(
p_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´·¹
));

1143 
m­
<,
boŞ
> 
ÇtiÚK
;

1145 
tu¶e_gu¬d
<
ÇtiÚ_mª_im¶
> 
	`´ÇtiÚ
(
_²©iÚ_mª
);

1147 
»p_row_t
 
	`¬•row
(
_²©iÚ_mª
->
	`ts
());

1148 
¬•row
.
	`£t
(
_²©iÚ_desc
->
	`maxsize
());

1150 
´ÇtiÚ
->
_»p
 = &
¬•row
;

1152 
gu¬d
< 
bË_sÿn_™”_im¶
<
ÇtiÚ_t
> > 
n_™”
;

1154 
bË_sÿn_™”_im¶
<
ÇtiÚ_t
>* 
tmp_n_™”
;

1155 
	`W_DO
(
_²©iÚ_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_n_™”
));

1156 
n_™”
 = 
tmp_n_™”
;

1159 
ch_ÇtiÚ_tu¶e
 
ª©iÚ
;

1161 
	`W_DO
(
n_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´ÇtiÚ
));

1163 !
eof
) {

1164 
´ÇtiÚ
->
	`g‘_v®ue
(0, 
ª©iÚ
.
N_NATIONKEY
);

1165 
´ÇtiÚ
->
	`g‘_v®ue
(2, 
ª©iÚ
.
N_REGIONKEY
);

1166 ifĞ
ª©iÚ
.
N_REGIONKEY
 =ğ
q2š
.
r_Çme
 ) {

1167 
ÇtiÚK
.
	`š£¹
(
·œ
<,
boŞ
> (
ª©iÚ
.
N_NATIONKEY
,0));

1169 
	`W_DO
(
n_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´ÇtiÚ
));

1173 
m­
<, 
boŞ
> 
suµK
;

1175 
tu¶e_gu¬d
<
suµl›r_mª_im¶
> 
	`´suµ
(
_psuµl›r_mª
);

1177 
»p_row_t
 
	`¤•row
(
_psuµl›r_mª
->
	`ts
());

1178 
¤•row
.
	`£t
(
_psuµl›r_desc
->
	`maxsize
());

1180 
´suµ
->
_»p
 = &
¤•row
;

1182 
gu¬d
<
bË_sÿn_™”_im¶
<
suµl›r_t
> > 
s_™”
;

1184 
bË_sÿn_™”_im¶
<
suµl›r_t
>* 
tmp_s_™”
;

1185 
	`W_DO
(
_psuµl›r_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_s_™”
));

1186 
s_™”
 = 
tmp_s_™”
;

1189 
ch_suµl›r_tu¶e
 
asuµl›r
;

1191 
	`W_DO
(
s_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´suµ
));

1193 !
eof
){

1194 
´suµ
->
	`g‘_v®ue
(0, 
asuµl›r
.
S_SUPPKEY
);

1195 
´suµ
->
	`g‘_v®ue
(3, 
asuµl›r
.
S_NATIONKEY
);

1196 ifĞ
ÇtiÚK
.
	`fšd
(
asuµl›r
.
S_NATIONKEY
è!ğÇtiÚK.
	`’d
()){

1197 
suµK
.
	`š£¹
(
·œ
<,
boŞ
>(
asuµl›r
.
S_SUPPKEY
, 
Œue
));

1199 
	`W_DO
(
s_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´suµ
));

1203 
tu¶e_gu¬d
<
·¹suµ_mª_im¶
> 
	`´·¹suµ
(
_µ¬tsuµ_mª
);

1205 
»p_row_t
 
	`p¤•row
(
_µ¬tsuµ_mª
->
	`ts
());

1206 
p¤•row
.
	`£t
(
_µ¬tsuµ_desc
->
	`maxsize
());

1208 
´·¹suµ
->
_»p
 = &
p¤•row
;

1210 
gu¬d
<
bË_sÿn_™”_im¶
<
·¹suµ_t
> > 
ps_™”
;

1212 
bË_sÿn_™”_im¶
<
·¹suµ_t
>* 
tmp_ps_™”
;

1213 
	`W_DO
(
_µ¬tsuµ_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_ps_™”
));

1214 
ps_™”
 = 
tmp_ps_™”
;

1217 
ch_·¹suµ_tu¶e
 
­¬tsuµ
;

1219 
	`W_DO
(
ps_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´·¹suµ
));

1221 !
eof
){

1222 
´·¹suµ
->
	`g‘_v®ue
(0, 
­¬tsuµ
.
PS_PARTKEY
);

1223 
´·¹suµ
->
	`g‘_v®ue
(1, 
­¬tsuµ
.
PS_SUPPKEY
);

1224 
´·¹suµ
->
	`g‘_v®ue
(3, 
­¬tsuµ
.
PS_SUPPLYCOST
);

1226 
m­
<, 
·œ
< 
decim®
, 
veùÜ
<>* > >::
™”©Ü
 
p™
 = 
mšli¡
.
fšd


1227 (
­¬tsuµ
.
PS_PARTKEY
);

1228 
m­
<,
boŞ
>::
™”©Ü
 
s™
 = 
suµK
.
	`fšd
(
­¬tsuµ
.
PS_SUPPKEY
);

1230 ifĞ
p™
 !ğ
mšli¡
.
	`’d
(è&& 
s™
 !ğ
suµK
.end() ){

1231 ifĞ
p™
->
£cÚd
.
fœ¡
 > 
­¬tsuµ
.
PS_SUPPLYCOST
 ||

1232 
p™
->
£cÚd
.
fœ¡
 == -1){

1233 
mšli¡
.
	`š£¹
(
·œ
<,…aœ< 
decim®
, 
veùÜ
<>* > >

1234 (
­¬tsuµ
.
PS_PARTKEY
,
·œ
< 
decim®
, 
veùÜ
<>* >

1235 (
­¬tsuµ
.
PS_SUPPLYCOST
, 
Ãw
 
veùÜ
<>()) ));

1238 ifĞ
p™
->
£cÚd
.
fœ¡
 =ğ
­¬tsuµ
.
PS_SUPPLYCOST
){

1239 
p™
->
£cÚd
.£cÚd->
	`push_back
(
­¬tsuµ
.
PS_SUPPKEY
);

1242 
	`W_DO
(
ps_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´·¹suµ
));

1245  
RCOK
;

1246 
	}
}

1256 
	sq3_group_by_key_t


1258 
	ml_Üd”key
;

1259 
time_t
 
	mo_Üd”d©e
;

1260 
	mo_sh´iÜ™y
;

1262 
q3_group_by_key_t
(
okey
, 
time_t
 
d©e
, 
shµ¼ty
)

1264 
	ml_Üd”key
 = 
okey
;

1265 
	mo_Üd”d©e
 = 
d©e
;

1266 
	mo_sh´iÜ™y
 = 
shµ¼ty
;

1270 
q3_group_by_key_t
(cÚ¡ q3_group_by_key_t& 
rhs
)

1272 
	ml_Üd”key
 = 
rhs
.
l_Üd”key
;

1273 
	mo_Üd”d©e
 = 
rhs
.
o_Üd”d©e
;

1274 
	mo_sh´iÜ™y
 = 
rhs
.
o_sh´iÜ™y
;

1278 
	mq3_group_by_key_t
& 
	mİ”©Ü
=(cÚ¡ 
q3_group_by_key_t
& 
rhs
)

1280 
l_Üd”key
 = 
rhs
.l_orderkey;

1281 
	mo_Üd”d©e
 = 
rhs
.
o_Üd”d©e
;

1282 
	mo_sh´iÜ™y
 = 
rhs
.
o_sh´iÜ™y
;

1283  (*
	mthis
);

1288 şas 
	cq3_group_by_comp
 {

1289 
	mpublic
:

1290 
boŞ
 
	$İ”©Ü
() (

1291 cÚ¡ 
q3_group_by_key_t
& 
lhs
,

1292 cÚ¡ 
q3_group_by_key_t
& 
rhs
) const

1294  ((
lhs
.
l_Üd”key
 < 
rhs
.l_orderkey) ||

1295 ((
lhs
.
l_Üd”key
 =ğ
rhs
.l_orderkey) &&

1296 (
lhs
.
o_Üd”d©e
 < 
rhs
.o_orderdate))||

1297 (
lhs
.
l_Üd”key
 =ğ
rhs
.l_orderkey) &&

1298 (
lhs
.
o_Üd”d©e
 =ğ
rhs
.o_orderdate) &&

1299 (
lhs
.
o_sh´iÜ™y
 < 
rhs
.o_shippriority)

1302 
	}
};

1304 şas 
	cq3_Üd”_Ãeded_d©a
{

1305 
	mpublic
:

1306 
time_t
 
o_Üd”d©e
;

1307 
	mo_sh´iÜ™y
;

1309 
	$q3_Üd”_Ãeded_d©a
(
time_t
 
d©e
, 
shµ¼ty
)

1311 
o_Üd”d©e
 = 
d©e
;

1312 
o_sh´iÜ™y
 = 
shµ¼ty
;

1316 
	}
};

1318 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_q3
(cÚ¡ , 
q3_šput_t
& 
q3š
)

1321 
	`as£¹
 (
_pssm
);

1322 
	`as£¹
 (
_š™Ÿlized
);

1323 
	`as£¹
 (
_lßded
);

1326 
m­
<,
boŞ
> 
cu¡keys
;

1328 
tu¶e_gu¬d
<
cu¡om”_mª_im¶
> 
	`´cu¡om”
(
_pcu¡om”_mª
);

1330 
»p_row_t
 
	`¬•row
(
_pcu¡om”_mª
->
	`ts
());

1331 
¬•row
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

1333 
´cu¡om”
->
_»p
 = &
¬•row
;

1335 
gu¬d
< 
bË_sÿn_™”_im¶
<
cu¡om”_t
> > 
c_™”
;

1337 
bË_sÿn_™”_im¶
<
cu¡om”_t
>* 
tmp_c_™”
;

1338 
	`W_DO
(
_pcu¡om”_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_c_™”
));

1339 
c_™”
 = 
tmp_c_™”
;

1342 
boŞ
 
eof
;

1343 
ch_cu¡om”_tu¶e
 
acu¡
;

1345 
	`W_DO
(
c_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cu¡om”
));

1347 !
eof
) {

1348 
´cu¡om”
->
	`g‘_v®ue
(0, 
acu¡
.
C_CUSTKEY
);

1349 
´cu¡om”
->
	`g‘_v®ue
(6, 
acu¡
.
C_MKTSEGMENT
, 10);

1350 
£g
 = 
	`¡r_to_£gm’t
(
acu¡
.
C_MKTSEGMENT
);

1351 ifĞ
£g
 =ğ
q3š
.
c_£gm’t
) {

1352 
cu¡keys
.
	`š£¹
(
·œ
<,
boŞ
> (
acu¡
.
C_CUSTKEY
, 
Œue
));

1354 
	`W_DO
(
c_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cu¡om”
));

1358 
c
 =0 ;

1359 
m­
<, 
q3_Üd”_Ãeded_d©a
> 
Üd”sdt
;

1361 
tu¶e_gu¬d
<
Üd”s_mª_im¶
> 
	`´Üd”
(
_pÜd”s_mª
);

1363 
»p_row_t
 
	`o_¬•row
(
_pÜd”s_mª
->
	`ts
());

1364 
o_¬•row
.
	`£t
(
_pÜd”s_desc
->
	`maxsize
());

1366 
´Üd”
->
_»p
 = &
o_¬•row
;

1368 
gu¬d
< 
bË_sÿn_™”_im¶
<
Üd”s_t
> > 
o_™”
;

1370 
bË_sÿn_™”_im¶
<
Üd”s_t
>* 
tmp_o_™”
;

1371 
	`W_DO
(
_pÜd”s_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_o_™”
));

1372 
o_™”
 = 
tmp_o_™”
;

1375 
ch_Üd”s_tu¶e
 
ªÜd”
;

1377 
	`W_DO
(
o_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Üd”
));

1379 !
eof
){

1380 
c
++;

1381 
´Üd”
->
	`g‘_v®ue
(0, 
ªÜd”
.
O_ORDERKEY
);

1382 
´Üd”
->
	`g‘_v®ue
(1, 
ªÜd”
.
O_CUSTKEY
);

1383 
´Üd”
->
	`g‘_v®ue
(4, 
ªÜd”
.
O_ORDERDATE
, 15);

1384 
´Üd”
->
	`g‘_v®ue
(7, 
ªÜd”
.
O_SHIPPRIORITY
);

1385 
time_t
 
the_d©e
 = 
	`¡r_to_tim‘
(
ªÜd”
.
O_ORDERDATE
);

1386 if(
cu¡keys
.
	`fšd
(
ªÜd”
.
O_CUSTKEY
è!ğcu¡keys.
	`’d
()

1387 && 
the_d©e
 < 
q3š
.
cu¼’t_d©e
) {

1388 
Üd”sdt
.
	`š£¹
(
·œ
<,
q3_Üd”_Ãeded_d©a
>

1389 (
ªÜd”
.
O_ORDERKEY
, 
q3_Üd”_Ãeded_d©a


1390 (
the_d©e
, 
ªÜd”
.
O_SHIPPRIORITY
)));

1392 
	`W_DO
(
o_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Üd”
));

1396 
m­
<
q3_group_by_key_t
, , 
q3_group_by_comp
> 
shpšgQ
;

1398 
tu¶e_gu¬d
<
lše™em_mª_im¶
> 
	`´lše™em
(
_¶še™em_mª
);

1400 
»p_row_t
 
	`®»´ow
(
_¶še™em_mª
->
	`ts
());

1401 
®»´ow
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

1403 
´lše™em
->
_»p
 = &
®»´ow
;

1405 
gu¬d
< 
bË_sÿn_™”_im¶
<
lše™em_t
> > 
l_™”
;

1407 
bË_sÿn_™”_im¶
<
lše™em_t
>* 
tmp_l_™”
;

1408 
	`W_DO
(
_¶še™em_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_l_™”
));

1409 
l_™”
 = 
tmp_l_™”
;

1412 
ch_lše™em_tu¶e
 
®še
;

1414 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

1416 !
eof
) {

1417 
´lše™em
->
	`g‘_v®ue
(0, 
®še
.
L_ORDERKEY
);

1418 
´lše™em
->
	`g‘_v®ue
(10, 
®še
.
L_SHIPDATE
, 15);

1419 
´lše™em
->
	`g‘_v®ue
(5, 
®še
.
L_EXTENDEDPRICE
);

1420 
´lše™em
->
	`g‘_v®ue
(6, 
®še
.
L_DISCOUNT
);

1421 
time_t
 
the_shd©e
 = 
	`¡r_to_tim‘
(
®še
.
L_SHIPDATE
);

1422 
m­
<, 
q3_Üd”_Ãeded_d©a
>::
™”©Ü
 
tmp
 =

1423 
Üd”sdt
.
	`fšd
(
®še
.
L_ORDERKEY
);

1424 if(
tmp
 !ğ
Üd”sdt
.
	`’d
(è&& 
the_shd©e
 > 
q3š
.
cu¼’t_d©e
 ){

1425 
m­
<
q3_group_by_key_t
, , 
q3_group_by_comp
>::
™”©Ü
 
tmp2
 =

1426 
shpšgQ
.
	`fšd
(
	`q3_group_by_key_t
(
®še
.
L_ORDERKEY
,

1427 
tmp
->
£cÚd
.
o_Üd”d©e
,

1428 
tmp
->
£cÚd
.
o_sh´iÜ™y
));

1429 
sum
 = 
®še
.
L_EXTENDEDPRICE
 * (1-®še.
L_DISCOUNT
);

1430 if(
tmp2
 !ğ
shpšgQ
.
	`’d
()){

1431 
sum
 +ğ
tmp2
->
£cÚd
;

1433 
shpšgQ
.
	`š£¹
(
·œ
<
q3_group_by_key_t
, >

1434 (
	`q3_group_by_key_t
(
®še
.
L_ORDERKEY
,

1435 
tmp
->
£cÚd
.
o_Üd”d©e
,

1436 
tmp
->
£cÚd
.
o_sh´iÜ™y
),
sum
));

1438 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

1441  
RCOK
;

1442 
	}
}

1452 
	sÉ¡r
 {

1453 
boŞ
 
İ”©Ü
()(cÚ¡ * 
	ms1
, cÚ¡ * 
	ms2
) const {

1454  
¡rcmp
(
s1
, 
s2
) < 0; }

1458 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_q4
(cÚ¡ , 
q4_šput_t
& 
š
)

1461 
	`as£¹
 (
_pssm
);

1462 
	`as£¹
 (
_š™Ÿlized
);

1463 
	`as£¹
 (
_lßded
);

1466 
m­
<, > 
fÜd”_´io
;

1469 
tu¶e_gu¬d
<
Üd”s_mª_im¶
> 
	`´Üd”s
(
_pÜd”s_mª
);

1472 
»p_row_t
 
	`¬•row
(
_pÜd”s_mª
->
	`ts
());

1473 
¬•row
.
	`£t
(
_pÜd”s_desc
->
	`maxsize
());

1475 
´Üd”s
->
_»p
 = & 
¬•row
;

1477 
»p_row_t
 
	`low»p
(
_pÜd”s_mª
->
	`ts
());

1478 
»p_row_t
 
	`high»p
(
_pÜd”s_mª
->
	`ts
());

1480 
low»p
.
	`£t
(
_pÜd”s_desc
->
	`maxsize
());

1481 
high»p
.
	`£t
(
_pÜd”s_desc
->
	`maxsize
());

1483 
tm
 
d©e
 = (*
	`loÿÉime
(&
š
.
o_Üd”d©e
));

1484 
d©e
.
tm_mÚ
 += 2;

1485 if(
d©e
.
tm_mÚ
 > 11){

1486 
d©e
.
tm_mÚ
 -= 12;

1487 
d©e
.
tm_y—r
 ++;

1489 
time_t
 
Ï¡_Üd”d©e
 = 
	`mktime
(&
d©e
);

1491 
ch_Üd”s_tu¶e
 
ªÜd”
;

1493 
gu¬d
<
šdex_sÿn_™”_im¶
<
Üd”s_t
> > 
o_™”
;

1495 
šdex_sÿn_™”_im¶
<
Üd”s_t
>* 
tmp_o_™”
;

1496 
	`W_DO
(
_pÜd”s_mª
->
	`o_g‘_¿nge_™”_by_šdex
(
_pssm
, 
tmp_o_™”
, 
´Üd”s
,

1497 
low»p
, 
high»p
,

1498 
š
.
o_Üd”d©e
,

1499 
Ï¡_Üd”d©e
));

1500 
o_™”
 = 
tmp_o_™”
;

1503 
boŞ
 
eof
;

1504 
	`W_DO
(
o_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Üd”s
));

1505 !
eof
){

1506 
´Üd”s
->
	`g‘_v®ue
(0, 
ªÜd”
.
O_ORDERKEY
);

1507 
´Üd”s
->
	`g‘_v®ue
(5, 
ªÜd”
.
O_ORDERPRIORITY
, 16);

1508 
p
 = 
	`¡r_to_´iÜ™y
(
ªÜd”
.
O_ORDERPRIORITY
);

1509 
fÜd”_´io
.
	`š£¹
(
·œ
<, >Ğ
ªÜd”
.
O_ORDERKEY
, 
p
));

1510 
	`W_DO
(
o_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Üd”s
));

1514 
m­
<,> 
´iÜ™y_couÁ
;

1515  
i
 = 0; i < 5; i++) {

1516 
´iÜ™y_couÁ
.
	`š£¹
(
·œ
<,>(
i
,0));

1519 
tu¶e_gu¬d
<
lše™em_mª_im¶
> 
	`´lše™em
(
_¶še™em_mª
);

1522 
»p_row_t
 
	`¬•row2
(
_¶še™em_mª
->
	`ts
());

1523 
¬•row2
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

1525 
´lše™em
->
_»p
 = &
¬•row2
;

1527 
gu¬d
< 
bË_sÿn_™”_im¶
<
lše™em_t
> > 
l_™”
;

1529 
bË_sÿn_™”_im¶
<
lše™em_t
>* 
tmp_l_™”
;

1530 
	`W_DO
(
_¶še™em_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_l_™”
));

1531 
l_™”
 = 
tmp_l_™”
;

1534 
ch_lše™em_tu¶e
 
®še
;

1536 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

1538 !
eof
) {

1539 
´lše™em
->
	`g‘_v®ue
(0, 
®še
.
L_ORDERKEY
);

1540 
´lše™em
->
	`g‘_v®ue
(11, 
®še
.
L_COMMITDATE
, 15);

1541 
´lše™em
->
	`g‘_v®ue
(12, 
®še
.
L_RECEIPTDATE
, 15);

1542 
time_t
 
the_comm™d©e
 = 
	`¡r_to_tim‘
(
®še
.
L_COMMITDATE
);

1543 
time_t
 
the_»ûtd©e
 = 
	`¡r_to_tim‘
(
®še
.
L_RECEIPTDATE
);

1544 
m­
<,>::
™”©Ü
 
tmp
;

1545 if((
tmp
 = 
fÜd”_´io
.
	`fšd
(
®še
.
L_ORDERKEY
)è!ğfÜd”_´io.
	`’d
() &&

1546 
the_comm™d©e
 < 
the_»ûtd©e
){

1547 
c
 =
´iÜ™y_couÁ
.
	`fšd
(
tmp
->
£cÚd
)->second;

1548 
c
++;

1549 
´iÜ™y_couÁ
[
tmp
->
£cÚd
] = 
c
;

1550 
fÜd”_´io
.
	`”a£
Ğ
tmp
);

1552 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

1555  
RCOK
;

1556 
	}
};

1566 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_q5
(cÚ¡ , 
q5_šput_t
& 
q5š
)

1569 
	`as£¹
 (
_pssm
);

1570 
	`as£¹
 (
_š™Ÿlized
);

1571 
	`as£¹
 (
_lßded
);

1573 
m­
<, > 
ÇtiÚ_»v
;

1575 
tu¶e_gu¬d
<
ÇtiÚ_mª_im¶
> 
	`´ÇtiÚ
(
_²©iÚ_mª
);

1577 
»p_row_t
 
	`¬•row
(
_²©iÚ_mª
->
	`ts
());

1578 
¬•row
.
	`£t
(
_²©iÚ_desc
->
	`maxsize
());

1580 
´ÇtiÚ
->
_»p
 = &
¬•row
;

1582 
gu¬d
< 
bË_sÿn_™”_im¶
<
ÇtiÚ_t
> > 
n_™”
;

1584 
bË_sÿn_™”_im¶
<
ÇtiÚ_t
>* 
tmp_n_™”
;

1585 
	`W_DO
(
_²©iÚ_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_n_™”
));

1586 
n_™”
 = 
tmp_n_™”
;

1589 
ch_ÇtiÚ_tu¶e
 
ª©iÚ
;

1590 
boŞ
 
eof
;

1592 
	`W_DO
(
n_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´ÇtiÚ
));

1594 !
eof
) {

1595 
´ÇtiÚ
->
	`g‘_v®ue
(0, 
ª©iÚ
.
N_NATIONKEY
);

1596 
´ÇtiÚ
->
	`g‘_v®ue
(2, 
ª©iÚ
.
N_REGIONKEY
);

1597 ifĞ
ª©iÚ
.
N_REGIONKEY
 =ğ
q5š
.
r_Çme
 ) {

1598 
ÇtiÚ_»v
.
	`š£¹
(
·œ
<,> (
ª©iÚ
.
N_NATIONKEY
,0.0));

1600 
	`W_DO
(
n_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´ÇtiÚ
));

1604 
m­
<, > 
cu¡om”_ÇtiÚ
;

1606 
tu¶e_gu¬d
<
cu¡om”_mª_im¶
> 
	`´cu¡om”
(
_pcu¡om”_mª
);

1608 
»p_row_t
 
	`aü•row
(
_pcu¡om”_mª
->
	`ts
());

1609 
aü•row
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

1611 
´cu¡om”
->
_»p
 = &
aü•row
;

1613 
gu¬d
< 
bË_sÿn_™”_im¶
<
cu¡om”_t
> > 
c_™”
;

1615 
bË_sÿn_™”_im¶
<
cu¡om”_t
>* 
tmp_c_™”
;

1616 
	`W_DO
(
_pcu¡om”_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_c_™”
));

1617 
c_™”
 = 
tmp_c_™”
;

1620 
ch_cu¡om”_tu¶e
 
acu¡
;

1622 
	`W_DO
(
c_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cu¡om”
));

1624 !
eof
){

1625 
´cu¡om”
->
	`g‘_v®ue
(0, 
acu¡
.
C_CUSTKEY
);

1626 
´cu¡om”
->
	`g‘_v®ue
(3, 
acu¡
.
C_NATIONKEY
);

1627 ifĞ
ÇtiÚ_»v
.
	`fšd
(
acu¡
.
C_NATIONKEY
è!ğÇtiÚ_»v.
	`’d
() ){

1628 
cu¡om”_ÇtiÚ
.
	`š£¹
(
·œ
<,>(
acu¡
.
C_CUSTKEY
,

1629 
acu¡
.
C_NATIONKEY
));

1631 
	`W_DO
(
c_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cu¡om”
));

1635 
m­
<, > 
Üd”sK_cu¡
;

1637 
tu¶e_gu¬d
<
Üd”s_mª_im¶
> 
	`´Üd”s
(
_pÜd”s_mª
);

1639 
»p_row_t
 
	`aÜ•row
(
_pÜd”s_mª
->
	`ts
());

1640 
aÜ•row
.
	`£t
(
_pÜd”s_desc
->
	`maxsize
());

1642 
´Üd”s
->
_»p
 = & 
aÜ•row
;

1644 
»p_row_t
 
	`low»p
(
_pÜd”s_mª
->
	`ts
());

1645 
»p_row_t
 
	`high»p
(
_pÜd”s_mª
->
	`ts
());

1647 
low»p
.
	`£t
(
_pÜd”s_desc
->
	`maxsize
());

1648 
high»p
.
	`£t
(
_pÜd”s_desc
->
	`maxsize
());

1650 
tm
 
d©e
 = (*
	`loÿÉime
(&
q5š
.
o_Üd”d©e
));

1652 
d©e
.
tm_y—r
 += 1;

1654 
time_t
 
Ï¡_Üd”d©e
 = 
	`mktime
(&
d©e
);

1656 
ch_Üd”s_tu¶e
 
ªÜd”
;

1658 
gu¬d
< 
bË_sÿn_™”_im¶
<
Üd”s_t
> > 
o_™”
;

1660 
bË_sÿn_™”_im¶
<
Üd”s_t
>* 
tmp_o_™”
;

1661 
	`W_DO
(
_pÜd”s_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_o_™”
));

1662 
o_™”
 = 
tmp_o_™”
;

1665 
	`W_DO
(
o_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Üd”s
));

1666 !
eof
){

1667 
´Üd”s
->
	`g‘_v®ue
(0, 
ªÜd”
.
O_ORDERKEY
);

1668 
´Üd”s
->
	`g‘_v®ue
(1, 
ªÜd”
.
O_CUSTKEY
);

1669 
´Üd”s
->
	`g‘_v®ue
(4, 
ªÜd”
.
O_ORDERDATE
, 15);

1670 
time_t
 
Üd”T
 = 
	`¡r_to_tim‘
(
ªÜd”
.
O_ORDERDATE
);

1671 ifĞ
cu¡om”_ÇtiÚ
.
	`fšd
(
ªÜd”
.
O_CUSTKEY
è!ğcu¡om”_ÇtiÚ.
	`’d
() &&

1672 (
Üd”T
 >ğ
q5š
.
o_Üd”d©e
 && ord”T < 
Ï¡_Üd”d©e
)) {

1673 
Üd”sK_cu¡
.
	`š£¹
(
·œ
<,> (
ªÜd”
.
O_ORDERKEY
,

1674 
ªÜd”
.
O_CUSTKEY
));

1676 
	`W_DO
(
o_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Üd”s
));

1680 
m­
<,> 
suµ_ÇtiÚ
;

1682 
tu¶e_gu¬d
<
suµl›r_mª_im¶
> 
	`´suµ
(
_psuµl›r_mª
);

1684 
»p_row_t
 
	`¤•row
(
_psuµl›r_mª
->
	`ts
());

1685 
¤•row
.
	`£t
(
_psuµl›r_desc
->
	`maxsize
());

1687 
´suµ
->
_»p
 = &
¤•row
;

1689 
gu¬d
<
bË_sÿn_™”_im¶
<
suµl›r_t
> > 
s_™”
;

1691 
bË_sÿn_™”_im¶
<
suµl›r_t
>* 
tmp_s_™”
;

1692 
	`W_DO
(
_psuµl›r_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_s_™”
));

1693 
s_™”
 = 
tmp_s_™”
;

1696 
ch_suµl›r_tu¶e
 
asuµl›r
;

1698 
	`W_DO
(
s_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´suµ
));

1700 !
eof
){

1701 
´suµ
->
	`g‘_v®ue
(0, 
asuµl›r
.
S_SUPPKEY
);

1702 
´suµ
->
	`g‘_v®ue
(3, 
asuµl›r
.
S_NATIONKEY
);

1703 if(
ÇtiÚ_»v
.
	`fšd
(
asuµl›r
.
S_NATIONKEY
è!ğÇtiÚ_»v.
	`’d
()){

1704 
suµ_ÇtiÚ
.
	`š£¹
(
·œ
<,>

1705 (
asuµl›r
.
S_SUPPKEY
,‡suµl›r.
S_NATIONKEY
));

1707 
	`W_DO
(
s_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´suµ
));

1711 
tu¶e_gu¬d
<
lše™em_mª_im¶
> 
	`´lše™em
(
_¶še™em_mª
);

1713 
»p_row_t
 
	`®»´ow
(
_¶še™em_mª
->
	`ts
());

1714 
®»´ow
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

1716 
´lše™em
->
_»p
 = &
®»´ow
;

1718 
gu¬d
< 
bË_sÿn_™”_im¶
<
lše™em_t
> > 
l_™”
;

1720 
bË_sÿn_™”_im¶
<
lše™em_t
>* 
tmp_l_™”
;

1721 
	`W_DO
(
_¶še™em_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_l_™”
));

1722 
l_™”
 = 
tmp_l_™”
;

1725 
ch_lše™em_tu¶e
 
®še
;

1727 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

1729 !
eof
) {

1730 
´lše™em
->
	`g‘_v®ue
(0, 
®še
.
L_ORDERKEY
);

1731 
´lše™em
->
	`g‘_v®ue
(2, 
®še
.
L_SUPPKEY
);

1732 
´lše™em
->
	`g‘_v®ue
(5, 
®še
.
L_EXTENDEDPRICE
);

1733 
´lše™em
->
	`g‘_v®ue
(6, 
®še
.
L_DISCOUNT
);

1734 
´iû
 = ( 1 - 
®še
.
L_DISCOUNT
)*®še.
L_EXTENDEDPRICE
;

1735 
m­
<,>::
™”©Ü
 
suµ™”
 = 
suµ_ÇtiÚ
.
	`fšd
(
®še
.
L_SUPPKEY
);

1736 
m­
<,>::
™”©Ü
 
Üd”™”
 = 
Üd”sK_cu¡
.
	`fšd
(
®še
.
L_ORDERKEY
);

1737 if(
Üd”™”
 !ğ
Üd”sK_cu¡
.
	`’d
(è&& 
suµ™”
 !ğ
suµ_ÇtiÚ
.end()){

1738 
m­
<,>::
™”©Ü
 
cu¡™”
 =

1739 
cu¡om”_ÇtiÚ
.
	`fšd
(
Üd”™”
->
£cÚd
);

1740 if(
cu¡™”
 !ğ
cu¡om”_ÇtiÚ
.
	`’d
()

1741 && 
cu¡™”
->
£cÚd
 =ğ
suµ™”
->second){

1742 
ÇtiÚKey
 = 
cu¡™”
->
£cÚd
;

1743 
c
 =
ÇtiÚ_»v
.
	`fšd
(
ÇtiÚKey
)->
£cÚd
;

1744 
c
 +ğ
´iû
;

1745 
ÇtiÚ_»v
[
ÇtiÚKey
] = 
c
;

1748 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

1751  
RCOK
;

1752 
	}
}

1764 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_q6
(cÚ¡ , 
q6_šput_t
& 
pq6š
)

1767 
	`as£¹
 (
_pssm
);

1768 
	`as£¹
 (
_š™Ÿlized
);

1769 
	`as£¹
 (
_lßded
);

1772 
tu¶e_gu¬d
<
lše™em_mª_im¶
> 
	`´lše™em
(
_¶še™em_mª
);

1774 
»p_row_t
 
	`¬•row
(
_¶še™em_mª
->
	`ts
());

1775 
¬•row
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

1777 
´lše™em
->
_»p
 = &
¬•row
;

1790 
»p_row_t
 
	`low»p
(
_¶še™em_mª
->
	`ts
());

1791 
»p_row_t
 
	`high»p
(
_¶še™em_mª
->
	`ts
());

1793 
low»p
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

1794 
high»p
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

1796 
tm
 
d©e
;

1797 ià(
	`gmtime_r
(&(
pq6š
.
l_shd©e
), &
d©e
è=ğ
NULL
) {

1798  
RCOK
;

1800 
d©e
.
tm_y—r
 ++;

1801 
time_t
 
Ï¡_shd©e
 = 
	`mktime
(&
d©e
);

1803 
gu¬d
< 
šdex_sÿn_™”_im¶
<
lše™em_t
> > 
l_™”
;

1805 
šdex_sÿn_™”_im¶
<
lše™em_t
>* 
tmp_l_™”
;

1806 
	`W_DO
(
_¶še™em_mª
->
	`l_g‘_¿nge_™”_by_šdex
(
_pssm
, 
tmp_l_™”
,

1807 
´lše™em
, 
low»p
,

1808 
high»p
, 
pq6š
.
l_shd©e
,

1809 
Ï¡_shd©e
));

1810 
l_™”
 = 
tmp_l_™”
;

1813 
boŞ
 
eof
;

1814 
ch_lše™em_tu¶e
 
®še
;

1815 
q6_»suÉ
 = 0;

1817 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

1819 !
eof
) {

1820 
´lše™em
->
	`g‘_v®ue
(4, 
®še
.
L_QUANTITY
);

1821 
´lše™em
->
	`g‘_v®ue
(5, 
®še
.
L_EXTENDEDPRICE
);

1822 
´lše™em
->
	`g‘_v®ue
(6, 
®še
.
L_DISCOUNT
);

1823 
´lše™em
->
	`g‘_v®ue
(10, 
®še
.
L_SHIPDATE
, 15);

1824 ià((
®še
.
L_DISCOUNT
 > 
pq6š
.
l_discouÁ
 - 0.01) &&

1825 (
®še
.
L_DISCOUNT
 < 
pq6š
.
l_discouÁ
 + 0.01) &&

1826 (
®še
.
L_QUANTITY
 < 
pq6š
.
l_quªt™y
)) {

1827 
q6_»suÉ
 +ğ(
®še
.
L_EXTENDEDPRICE
 *‡lše.
L_DISCOUNT
);

1829 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

1832  
RCOK
;

1834 
	}
};

1844 
	sq7_group_by_key_t
{

1846 
	msuµ_ÇtiÚ
;

1847 
	mcu¡_ÇtiÚ
;

1848 
	ml_y—r
;

1850 
q7_group_by_key_t
(
s_n
, 
c_n
, 
y
)

1852 
	msuµ_ÇtiÚ
 = 
s_n
;

1853 
	mcu¡_ÇtiÚ
 = 
c_n
;

1854 
	ml_y—r
 = 
y
;

1858 
q7_group_by_key_t
(cÚ¡ q7_group_by_key_t& 
rhs
)

1860 
	msuµ_ÇtiÚ
 = 
rhs
.
suµ_ÇtiÚ
;

1861 
	mcu¡_ÇtiÚ
 = 
rhs
.
cu¡_ÇtiÚ
;

1862 
	ml_y—r
 = 
rhs
.
l_y—r
;

1865 
	mq7_group_by_key_t
& 
	mİ”©Ü
=(cÚ¡ 
q7_group_by_key_t
& 
rhs
)

1867 
suµ_ÇtiÚ
 = 
rhs
.supp_nation;

1868 
	mcu¡_ÇtiÚ
 = 
rhs
.
cu¡_ÇtiÚ
;

1869 
	ml_y—r
 = 
rhs
.
l_y—r
;

1871  (*
	mthis
);

1876 şas 
	cq7_group_by_comp
 {

1877 
	mpublic
:

1878 
boŞ
 
	$İ”©Ü
() (

1879 cÚ¡ 
q7_group_by_key_t
& 
lhs
,

1880 cÚ¡ 
q7_group_by_key_t
& 
rhs
) const

1882  (
lhs
.
suµ_ÇtiÚ
 < 
rhs
.supp_nation ||

1883 (
lhs
.
suµ_ÇtiÚ
 =ğ
rhs
.supp_nation &&

1884 
lhs
.
cu¡_ÇtiÚ
 < 
rhs
.cust_nation ) ||

1885 (
lhs
.
suµ_ÇtiÚ
 =ğ
rhs
.supp_nation &&

1886 
lhs
.
cu¡_ÇtiÚ
 =ğ
rhs
.cust_nation &&

1887 
rhs
.
l_y—r
 < 
lhs
.l_year) );

1889 
	}
};

1891 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_q7
(cÚ¡ , 
q7_šput_t
& 
q7š
 )

1894 
	`as£¹
 (
_pssm
);

1895 
	`as£¹
 (
_š™Ÿlized
);

1896 
	`as£¹
 (
_lßded
);

1899 
m­
<,> 
cu¡_ÇtiÚK
;

1901 
tu¶e_gu¬d
<
cu¡om”_mª_im¶
> 
	`´cu¡om”
(
_pcu¡om”_mª
);

1903 
»p_row_t
 
	`¬•row
(
_pcu¡om”_mª
->
	`ts
());

1904 
¬•row
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

1906 
´cu¡om”
->
_»p
 = &
¬•row
;

1908 
gu¬d
< 
bË_sÿn_™”_im¶
<
cu¡om”_t
> > 
c_™”
;

1910 
bË_sÿn_™”_im¶
<
cu¡om”_t
>* 
tmp_c_™”
;

1911 
	`W_DO
(
_pcu¡om”_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_c_™”
));

1912 
c_™”
 = 
tmp_c_™”
;

1915 
boŞ
 
eof
;

1916 
ch_cu¡om”_tu¶e
 
acu¡
;

1918 
	`W_DO
(
c_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cu¡om”
));

1920 !
eof
){

1921 
´cu¡om”
->
	`g‘_v®ue
(0, 
acu¡
.
C_CUSTKEY
);

1922 
´cu¡om”
->
	`g‘_v®ue
(3, 
acu¡
.
C_NATIONKEY
);

1923 if(
acu¡
.
C_NATIONKEY
 =ğ
q7š
.
n_Çme1
||acu¡.C_NATIONKEY =ğq7š.
n_Çme2
) {

1924 
cu¡_ÇtiÚK
.
	`š£¹
(
·œ
<,>(
acu¡
.
C_CUSTKEY
,acu¡.
C_NATIONKEY
));

1926 
	`W_DO
(
c_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cu¡om”
));

1930 
m­
<,> 
Üd”k_cu¡k
;

1932 
tu¶e_gu¬d
<
Üd”s_mª_im¶
> 
	`´Üd”
(
_pÜd”s_mª
);

1934 
»p_row_t
 
	`o_¬•row
(
_pÜd”s_mª
->
	`ts
());

1935 
o_¬•row
.
	`£t
(
_pÜd”s_desc
->
	`maxsize
());

1937 
´Üd”
->
_»p
 = &
o_¬•row
;

1939 
gu¬d
< 
bË_sÿn_™”_im¶
<
Üd”s_t
> > 
o_™”
;

1941 
bË_sÿn_™”_im¶
<
Üd”s_t
>* 
tmp_o_™”
;

1942 
	`W_DO
(
_pÜd”s_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_o_™”
));

1943 
o_™”
 = 
tmp_o_™”
;

1946 
ch_Üd”s_tu¶e
 
ªÜd”
;

1948 
	`W_DO
(
o_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Üd”
));

1950 !
eof
){

1951 
´Üd”
->
	`g‘_v®ue
(0, 
ªÜd”
.
O_ORDERKEY
);

1952 
´Üd”
->
	`g‘_v®ue
(1, 
ªÜd”
.
O_CUSTKEY
);

1953 ifĞ
cu¡_ÇtiÚK
.
	`fšd
(
ªÜd”
.
O_CUSTKEY
è!ğcu¡_ÇtiÚK.
	`’d
()) {

1954 
Üd”k_cu¡k
.
	`š£¹
(
·œ
<,>(
ªÜd”
.
O_ORDERKEY
,

1955 
ªÜd”
.
O_CUSTKEY
));

1957 
	`W_DO
(
o_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Üd”
));

1961 
m­
<,> 
suµ_ÇtiÚk
;

1963 
tu¶e_gu¬d
<
suµl›r_mª_im¶
> 
	`´suµ
(
_psuµl›r_mª
);

1965 
»p_row_t
 
	`¤•row
(
_psuµl›r_mª
->
	`ts
());

1966 
¤•row
.
	`£t
(
_psuµl›r_desc
->
	`maxsize
());

1968 
´suµ
->
_»p
 = &
¤•row
;

1970 
gu¬d
<
bË_sÿn_™”_im¶
<
suµl›r_t
> > 
s_™”
;

1972 
bË_sÿn_™”_im¶
<
suµl›r_t
>* 
tmp_s_™”
;

1973 
	`W_DO
(
_psuµl›r_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_s_™”
));

1974 
s_™”
 = 
tmp_s_™”
;

1977 
ch_suµl›r_tu¶e
 
asuµl›r
;

1979 
	`W_DO
(
s_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´suµ
));

1981 !
eof
){

1982 
´suµ
->
	`g‘_v®ue
(0, 
asuµl›r
.
S_SUPPKEY
);

1983 
´suµ
->
	`g‘_v®ue
(3, 
asuµl›r
.
S_NATIONKEY
);

1984 ifĞ
asuµl›r
.
S_NATIONKEY
 =ğ
q7š
.
n_Çme1
 ||

1985 
asuµl›r
.
S_NATIONKEY
 =ğ
q7š
.
n_Çme2
) {

1986 
suµ_ÇtiÚk
.
	`š£¹
(
·œ
<,>

1987 (
asuµl›r
.
S_SUPPKEY
,‡suµl›r.
S_NATIONKEY
));

1989 
	`W_DO
(
s_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´suµ
));

1993 
m­
<
q7_group_by_key_t
, , 
q7_group_by_comp
> 
vŞ_shpšg
;

1995 
tu¶e_gu¬d
<
lše™em_mª_im¶
> 
	`´lše™em
(
_¶še™em_mª
);

1997 
»p_row_t
 
	`®»´ow
(
_¶še™em_mª
->
	`ts
());

1998 
®»´ow
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

2000 
´lše™em
->
_»p
 = &
®»´ow
;

2002 
tm
 
¡¬t_shd©e
;

2003 
¡¬t_shd©e
.
tm_y—r
 = 95;

2004 
¡¬t_shd©e
.
tm_mÚ
 = 0;

2005 
¡¬t_shd©e
.
tm_mday
 = 1;

2006 
time_t
 
s_sh
 = 
	`mktime
(&
¡¬t_shd©e
);

2008 
tm
 
’d_shd©e
;

2009 
’d_shd©e
.
tm_y—r
 = 96;

2010 
’d_shd©e
.
tm_mÚ
 = 11;

2011 
’d_shd©e
.
tm_mday
 =31;

2012 
time_t
 
e_sh
 = 
	`mktime
(&
’d_shd©e
);

2014 
gu¬d
< 
bË_sÿn_™”_im¶
<
lše™em_t
> > 
l_™”
;

2016 
bË_sÿn_™”_im¶
<
lše™em_t
>* 
tmp_l_™”
;

2017 
	`W_DO
(
_¶še™em_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_l_™”
));

2018 
l_™”
 = 
tmp_l_™”
;

2021 
ch_lše™em_tu¶e
 
®še
;

2023 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

2025 !
eof
) {

2026 
´lše™em
->
	`g‘_v®ue
(0, 
®še
.
L_ORDERKEY
);

2027 
´lše™em
->
	`g‘_v®ue
(2, 
®še
.
L_SUPPKEY
);

2028 
´lše™em
->
	`g‘_v®ue
(5, 
®še
.
L_EXTENDEDPRICE
);

2029 
´lše™em
->
	`g‘_v®ue
(6, 
®še
.
L_DISCOUNT
);

2030 
´lše™em
->
	`g‘_v®ue
(10, 
®še
.
L_SHIPDATE
, 15);

2032 
time_t
 
shd©e
 = 
	`¡r_to_tim‘
(
®še
.
L_SHIPDATE
);

2033 
tm
 
d©e
 = (*
	`loÿÉime
(&
shd©e
));

2034 
´iû
 = 
®še
.
L_EXTENDEDPRICE
*(1-‡lše.
L_DISCOUNT
);

2036 
m­
<,>:: 
™”©Ü
 
Üd”
 = 
Üd”k_cu¡k
.
	`fšd
(
®še
.
L_ORDERKEY
);

2037 
m­
<,>:: 
™”©Ü
 
suµ
 = 
suµ_ÇtiÚk
.
	`fšd
(
®še
.
L_SUPPKEY
);

2038 
m­
<,>:: 
™”©Ü
 
cu¡
;

2040 if(
Üd”
 !ğ
Üd”k_cu¡k
.
	`’d
(è&& 
suµ
 !ğ
suµ_ÇtiÚk
.end() &&

2041 
d©e
.
tm_y—r
 <= 96 && date.tm_year >= 95){

2043 
cu¡
 = 
cu¡_ÇtiÚK
.
	`fšd
(
Üd”
->
£cÚd
);

2045 if(
cu¡
 !ğ
cu¡_ÇtiÚK
.
	`’d
()){

2046 if(
cu¡
->
£cÚd
 !ğ
suµ
->second){

2047 
m­
<
q7_group_by_key_t
, , 
q7_group_by_comp
>::
™”©Ü
 
™
=

2048 
vŞ_shpšg
.
	`fšd
(
	`q7_group_by_key_t
(
suµ
->
£cÚd
,

2049 
cu¡
->
£cÚd
,

2050 
d©e
.
tm_y—r
));

2051 ifĞ
™
 !ğ
vŞ_shpšg
.
	`’d
()){

2052 
c
 = 
™
->
£cÚd
;

2053 
c
 +ğ
´iû
;

2054 
vŞ_shpšg
.
	`š£¹
(
·œ
<
q7_group_by_key_t
,

2056 (
	`q7_group_by_key_t
(
suµ
->
£cÚd
,

2057 
cu¡
->
£cÚd
,

2058 
d©e
.
tm_y—r
), 
c
));

2060 
vŞ_shpšg
.
	`š£¹
(
·œ
<
q7_group_by_key_t
, >

2061 (
	`q7_group_by_key_t
(
suµ
->
£cÚd
,

2062 
cu¡
->
£cÚd
,

2063 
d©e
.
tm_y—r
),

2064 
´iû
));

2069 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

2072  
RCOK
;

2073 
	}
}

2083 
	sq8_šÃr_bË
{

2085 
	ms_key
;

2086 
	mo_y—r
;

2087 
	m´iû
;

2089 
q8_šÃr_bË
(
s
, 
o
, 
p
){

2090 
	ms_key
 = 
s
;

2091 
	mo_y—r
 = 
o
;

2092 
	m´iû
 = 
p
;

2097 
	sq8_grou³_by_v®ue_t
{

2098 
	ma
;

2099 
	mb
;

2101 
q8_grou³_by_v®ue_t
(
¯
, 
bb
){

2103 
	ma
 = 
¯
;

2104 
	mb
 = 
bb
;

2109 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_q8
(cÚ¡ , 
q8_šput_t
& 
q8š
)

2112 
	`as£¹
 (
_pssm
);

2113 
	`as£¹
 (
_š™Ÿlized
);

2114 
	`as£¹
 (
_lßded
);

2117 
r_key
;

2118 
m­
<, 
boŞ
> 
ÇtiÚ_k
;

2120 
tu¶e_gu¬d
<
ÇtiÚ_mª_im¶
> 
	`´ÇtiÚ
(
_²©iÚ_mª
);

2122 
»p_row_t
 
	`¬•row
(
_²©iÚ_mª
->
	`ts
());

2123 
¬•row
.
	`£t
(
_²©iÚ_desc
->
	`maxsize
());

2125 
´ÇtiÚ
->
_»p
 = &
¬•row
;

2127 
	`W_DO
(
_²©iÚ_mª
->
	`n_šdex_´obe
(
_pssm
, 
´ÇtiÚ
, 
q8š
.
n_Çme
));

2129 
´ÇtiÚ
->
	`g‘_v®ue
(2, 
r_key
);

2132 
gu¬d
< 
bË_sÿn_™”_im¶
<
ÇtiÚ_t
> > 
n_™”
;

2134 
bË_sÿn_™”_im¶
<
ÇtiÚ_t
>* 
tmp_n_™”
;

2135 
	`W_DO
(
_²©iÚ_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_n_™”
));

2136 
n_™”
 = 
tmp_n_™”
;

2139 
boŞ
 
eof
;

2140 
ch_ÇtiÚ_tu¶e
 
ª©iÚ
;

2142 
	`W_DO
(
n_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´ÇtiÚ
));

2144 !
eof
) {

2145 
´ÇtiÚ
->
	`g‘_v®ue
(2, 
ª©iÚ
.
N_REGIONKEY
);

2146 
´ÇtiÚ
->
	`g‘_v®ue
(0, 
ª©iÚ
.
N_NATIONKEY
);

2147 if(
ª©iÚ
.
N_REGIONKEY
 =ğ
r_key
) {

2148 
ÇtiÚ_k
.
	`š£¹
(
·œ
<,
boŞ
>(
ª©iÚ
.
N_NATIONKEY
, 
Œue
));

2150 
	`W_DO
(
n_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´ÇtiÚ
));

2154 
m­
<, 
boŞ
> 
p_keys
;

2155 
p_ty³
[26];

2156 
	`ty³_to_¡r
(
q8š
.
p_ty³
,…_type);

2158 
tu¶e_gu¬d
<
·¹_mª_im¶
> 
	`´·¹
(
_µ¬t_mª
);

2160 
»p_row_t
 
	`´•row
(
_µ¬t_mª
->
	`ts
());

2161 
´•row
.
	`£t
(
_µ¬t_desc
->
	`maxsize
());

2163 
´·¹
->
_»p
 = &
´•row
;

2165 
gu¬d
<
bË_sÿn_™”_im¶
<
·¹_t
> > 
p_™”
;

2167 
bË_sÿn_™”_im¶
<
·¹_t
>* 
tmp_p_™”
;

2168 
	`W_DO
(
_µ¬t_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_p_™”
));

2169 
p_™”
 = 
tmp_p_™”
;

2172 
ch_·¹_tu¶e
 
­¬t
;

2174 
	`W_DO
(
p_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´·¹
));

2176 !
eof
){

2177 
´·¹
->
	`g‘_v®ue
(4, 
­¬t
.
P_TYPE
, 25);

2178 
´·¹
->
	`g‘_v®ue
(0, 
­¬t
.
P_PARTKEY
);

2179 ifĞ
	`¡rcmp
(
­¬t
.
P_TYPE
, 
p_ty³
 ) == 0 ){

2180 
p_keys
.
	`š£¹
(
·œ
<,
boŞ
> (
­¬t
.
P_PARTKEY
, 
Œue
));

2182 
	`W_DO
(
p_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´·¹
));

2186 
m­
<, 
boŞ
> 
cu¡_k
;

2188 
tu¶e_gu¬d
<
cu¡om”_mª_im¶
> 
	`´cu¡om”
(
_pcu¡om”_mª
);

2190 
»p_row_t
 
	`aü•row
(
_pcu¡om”_mª
->
	`ts
());

2191 
aü•row
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

2193 
´cu¡om”
->
_»p
 = &
aü•row
;

2195 
gu¬d
< 
bË_sÿn_™”_im¶
<
cu¡om”_t
> > 
c_™”
;

2197 
bË_sÿn_™”_im¶
<
cu¡om”_t
>* 
tmp_c_™”
;

2198 
	`W_DO
(
_pcu¡om”_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_c_™”
));

2199 
c_™”
 = 
tmp_c_™”
;

2202 
ch_cu¡om”_tu¶e
 
acu¡
;

2204 
	`W_DO
(
c_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cu¡om”
));

2206 !
eof
){

2207 
´cu¡om”
->
	`g‘_v®ue
(0, 
acu¡
.
C_CUSTKEY
);

2208 
´cu¡om”
->
	`g‘_v®ue
(3, 
acu¡
.
C_NATIONKEY
);

2209 ifĞ
ÇtiÚ_k
.
	`fšd
(
acu¡
.
C_NATIONKEY
è!ğÇtiÚ_k.
	`’d
()){

2210 
cu¡_k
.
	`š£¹
(
·œ
<,
boŞ
>(
acu¡
.
C_CUSTKEY
,
Œue
));

2212 
	`W_DO
(
c_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cu¡om”
));

2217 
m­
<,> 
Üd”s_ky
;

2219 
tu¶e_gu¬d
<
Üd”s_mª_im¶
> 
	`´Üd”s
(
_pÜd”s_mª
);

2221 
»p_row_t
 
	`aÜ•row
(
_pÜd”s_mª
->
	`ts
());

2222 
aÜ•row
.
	`£t
(
_pÜd”s_desc
->
	`maxsize
());

2224 
´Üd”s
->
_»p
 = & 
aÜ•row
;

2226 
»p_row_t
 
	`low»p
(
_pÜd”s_mª
->
	`ts
());

2227 
»p_row_t
 
	`high»p
(
_pÜd”s_mª
->
	`ts
());

2229 
low»p
.
	`£t
(
_pÜd”s_desc
->
	`maxsize
());

2230 
high»p
.
	`£t
(
_pÜd”s_desc
->
	`maxsize
());

2232 
tm
 
d©e1
; d©e1.
tm_y—r
 = 95; d©e1.
tm_mÚ
 = 0; d©e1.
tm_mday
 = 1;

2233 
tm
 
d©e2
; d©e2.
tm_y—r
 = 96; d©e2.
tm_mÚ
 = 11; d©e2.
tm_mday
 = 31;

2234 
time_t
 
t1
 = 
	`mktime
(&
d©e1
);

2235 
time_t
 
t2
 = 
	`mktime
(&
d©e2
);

2237 
gu¬d
<
šdex_sÿn_™”_im¶
<
Üd”s_t
> > 
o_™”
;

2239 
šdex_sÿn_™”_im¶
<
Üd”s_t
>* 
tmp_o_™”
;

2240 
	`W_DO
(
_pÜd”s_mª
->
	`o_g‘_¿nge_™”_by_šdex
(
_pssm
, 
tmp_o_™”
, 
´Üd”s
,

2241 
low»p
, 
high»p
, 
t1
, 
t2
));

2242 
o_™”
 = 
tmp_o_™”
;

2245 
ch_Üd”s_tu¶e
 
ªÜd”
;

2247 
	`W_DO
(
o_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Üd”s
));

2249 !
eof
){

2250 
´Üd”s
->
	`g‘_v®ue
(0, 
ªÜd”
.
O_ORDERKEY
);

2251 
´Üd”s
->
	`g‘_v®ue
(1, 
ªÜd”
.
O_CUSTKEY
);

2252 
´Üd”s
->
	`g‘_v®ue
(4, 
ªÜd”
.
O_ORDERDATE
, 15);

2253 
time_t
 
t
 = 
	`¡r_to_tim‘
(
ªÜd”
.
O_ORDERDATE
);

2254 
tm
 
d©e
 = *(
	`loÿÉime
(&
t
));

2255 ifĞ
cu¡_k
.
	`fšd
(
ªÜd”
.
O_CUSTKEY
è!ğcu¡_k.
	`’d
()) {

2256 
Üd”s_ky
.
	`š£¹
(
·œ
<,>(
ªÜd”
.
O_ORDERKEY
, 
d©e
.
tm_y—r
));

2258 
	`W_DO
(
o_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Üd”s
));

2262 
m­
<,> 
suµ_ÇtiÚ
;

2264 
tu¶e_gu¬d
<
suµl›r_mª_im¶
> 
	`´suµ
(
_psuµl›r_mª
);

2266 
»p_row_t
 
	`¤•row
(
_psuµl›r_mª
->
	`ts
());

2267 
¤•row
.
	`£t
(
_psuµl›r_desc
->
	`maxsize
());

2269 
´suµ
->
_»p
 = &
¤•row
;

2271 
gu¬d
<
bË_sÿn_™”_im¶
<
suµl›r_t
> > 
s_™”
;

2273 
bË_sÿn_™”_im¶
<
suµl›r_t
>* 
tmp_s_™”
;

2274 
	`W_DO
(
_psuµl›r_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_s_™”
));

2275 
s_™”
 = 
tmp_s_™”
;

2278 
ch_suµl›r_tu¶e
 
asuµl›r
;

2280 
	`W_DO
(
s_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´suµ
));

2282 !
eof
){

2283 
´suµ
->
	`g‘_v®ue
(0, 
asuµl›r
.
S_SUPPKEY
);

2284 
´suµ
->
	`g‘_v®ue
(3, 
asuµl›r
.
S_NATIONKEY
);

2285 
suµ_ÇtiÚ
.
	`š£¹
(
·œ
<,>(
asuµl›r
.
S_SUPPKEY
,

2286 
asuµl›r
.
S_NATIONKEY
));

2287 
	`W_DO
(
s_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´suµ
));

2291 
veùÜ
 <
q8_šÃr_bË
> 
®l_ÇtiÚ
;

2293 
tu¶e_gu¬d
<
lše™em_mª_im¶
> 
	`´lše™em
(
_¶še™em_mª
);

2295 
»p_row_t
 
	`®»´ow
(
_¶še™em_mª
->
	`ts
());

2296 
®»´ow
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

2298 
´lše™em
->
_»p
 = &
®»´ow
;

2300 
gu¬d
< 
bË_sÿn_™”_im¶
<
lše™em_t
> > 
l_™”
;

2302 
bË_sÿn_™”_im¶
<
lše™em_t
>* 
tmp_l_™”
;

2303 
	`W_DO
(
_¶še™em_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_l_™”
));

2304 
l_™”
 = 
tmp_l_™”
;

2307 
ch_lše™em_tu¶e
 
®še
;

2309 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

2311 !
eof
) {

2312 
´lše™em
->
	`g‘_v®ue
(0, 
®še
.
L_ORDERKEY
);

2313 
´lše™em
->
	`g‘_v®ue
(1, 
®še
.
L_PARTKEY
);

2314 
´lše™em
->
	`g‘_v®ue
(2, 
®še
.
L_SUPPKEY
);

2315 
´lše™em
->
	`g‘_v®ue
(5, 
®še
.
L_EXTENDEDPRICE
);

2316 
´lše™em
->
	`g‘_v®ue
(6, 
®še
.
L_DISCOUNT
);

2317 
´iû
 = (1-
®še
.
L_DISCOUNT
)*®še.
L_EXTENDEDPRICE
;

2318 
m­
<,
boŞ
>:: 
™”©Ü
 
p™
 = 
p_keys
.
	`fšd
(
®še
.
L_PARTKEY
);

2319 
m­
<,>::
™”©Ü
 
o™
 = 
Üd”s_ky
.
	`fšd
(
®še
.
L_ORDERKEY
);

2320 if(
p™
 !ğ
p_keys
.
	`’d
(è&& 
o™
 !ğ
Üd”s_ky
.end()) {

2321 
®l_ÇtiÚ
.
	`push_back
(
	`q8_šÃr_bË
(
®še
.
L_SUPPKEY
,

2322 
o™
->
£cÚd
, 
´iû
));

2324 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

2328 
m­
<,
q8_grou³_by_v®ue_t
> 
mkt_sh¬e
;

2329 
m­
<,
q8_grou³_by_v®ue_t
>::
™”©Ü
 
™
;

2331 
i
 = 0; i < 
®l_ÇtiÚ
.
	`size
(); i++){

2332 
™
 = 
mkt_sh¬e
.
	`fšd
(
®l_ÇtiÚ
[
i
].
o_y—r
);

2333 
a
,
b
;

2334 ià(
™
 !ğ
mkt_sh¬e
.
	`’d
()){

2335 
a
 = 
™
->
£cÚd
.a;

2336 
b
 = 
™
->
£cÚd
.b;

2338 
a
 = 0;

2339 
b
 =0;

2341 ifĞ
suµ_ÇtiÚ
.
	`fšd
(
®l_ÇtiÚ
[
i
].
s_key
)->
£cÚd
 =ğ
q8š
.
n_Çme
){

2342 
a
+=
®l_ÇtiÚ
[
i
].
´iû
;

2344 
b
+=
®l_ÇtiÚ
[
i
].
´iû
;

2345 
mkt_sh¬e
.
	`š£¹
(
·œ
<,
q8_grou³_by_v®ue_t
>(
®l_ÇtiÚ
[
i
].
o_y—r
,

2346 
	`q8_grou³_by_v®ue_t
(
a
,

2347 
b
)));

2350  
RCOK
;

2351 
	}
}

2361 
	sq9_group_by_key_t
{

2363 
	mÇtiÚ_k
;

2364 
	my—r
;

2366 
q9_group_by_key_t
(
n
, 
y
){

2368 
	mÇtiÚ_k
 = 
n
;

2369 
	my—r
 = 
y
;

2373 şas 
	cq9_group_by_comp
 {

2374 
	mpublic
:

2375 
boŞ
 
	$İ”©Ü
() (

2376 cÚ¡ 
q9_group_by_key_t
& 
lhs
,

2377 cÚ¡ 
q9_group_by_key_t
& 
rhs
) const

2379  (
lhs
.
ÇtiÚ_k
 < 
rhs
.nation_k) ||

2380 (
lhs
.
ÇtiÚ_k
 =ğ
rhs
.ÇtiÚ_k &&†hs.
y—r
 <„hs.year);

2382 
	}
};

2385 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_q9
(cÚ¡ , 
q9_šput_t
& 
q9š
)

2388 
	`as£¹
 (
_pssm
);

2389 
	`as£¹
 (
_š™Ÿlized
);

2390 
	`as£¹
 (
_lßded
);

2393 
m­
<, 
boŞ
> 
p_keys
;

2395 
tu¶e_gu¬d
<
·¹_mª_im¶
> 
	`´·¹
(
_µ¬t_mª
);

2397 
»p_row_t
 
	`´•row
(
_µ¬t_mª
->
	`ts
());

2398 
´•row
.
	`£t
(
_µ¬t_desc
->
	`maxsize
());

2400 
´·¹
->
_»p
 = &
´•row
;

2402 
gu¬d
<
bË_sÿn_™”_im¶
<
·¹_t
> > 
p_™”
;

2404 
bË_sÿn_™”_im¶
<
·¹_t
>* 
tmp_p_™”
;

2405 
	`W_DO
(
_µ¬t_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_p_™”
));

2406 
p_™”
 = 
tmp_p_™”
;

2409 
boŞ
 
eof
;

2410 
ch_·¹_tu¶e
 
­¬t
;

2412 
	`W_DO
(
p_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´·¹
));

2414 !
eof
){

2415 
´·¹
->
	`g‘_v®ue
(0, 
­¬t
.
P_PARTKEY
);

2416 
´·¹
->
	`g‘_v®ue
(1, 
­¬t
.
P_NAME
, 55);

2417 
·¹_Çme
[55];

2418 
	`²ame_to_¡r
(
q9š
.
p_Çme
, 
·¹_Çme
);

2419 if(
	`¡r¡r
(
­¬t
.
P_NAME
,
·¹_Çme
è!ğ
NULL
){

2420 
p_keys
.
	`š£¹
(
·œ
<,
boŞ
> ( 
­¬t
.
P_PARTKEY
, 0));

2422 
	`W_DO
(
p_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´·¹
));

2426 
m­
<,> 
suµK_nK
;

2428 
tu¶e_gu¬d
<
suµl›r_mª_im¶
> 
	`´suµ
(
_psuµl›r_mª
);

2430 
»p_row_t
 
	`¤•row
(
_psuµl›r_mª
->
	`ts
());

2431 
¤•row
.
	`£t
(
_psuµl›r_desc
->
	`maxsize
());

2433 
´suµ
->
_»p
 = &
¤•row
;

2435 
gu¬d
<
bË_sÿn_™”_im¶
<
suµl›r_t
> > 
s_™”
;

2437 
bË_sÿn_™”_im¶
<
suµl›r_t
>* 
tmp_s_™”
;

2438 
	`W_DO
(
_psuµl›r_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_s_™”
));

2439 
s_™”
 = 
tmp_s_™”
;

2442 
ch_suµl›r_tu¶e
 
asuµl›r
;

2444 
	`W_DO
(
s_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´suµ
));

2446 !
eof
){

2447 
´suµ
->
	`g‘_v®ue
(0, 
asuµl›r
.
S_SUPPKEY
);

2448 
´suµ
->
	`g‘_v®ue
(3, 
asuµl›r
.
S_NATIONKEY
);

2449 
suµK_nK
.
	`š£¹
(
·œ
<,>(
asuµl›r
.
S_SUPPKEY
,asuµl›r.
S_NATIONKEY
));

2450 
	`W_DO
(
s_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´suµ
));

2454 
m­
<,> 
Üd”K_y
;

2456 
tu¶e_gu¬d
<
Üd”s_mª_im¶
> 
	`´Üd”
(
_pÜd”s_mª
);

2458 
»p_row_t
 
	`o_¬•row
(
_pÜd”s_mª
->
	`ts
());

2459 
o_¬•row
.
	`£t
(
_pÜd”s_desc
->
	`maxsize
());

2461 
´Üd”
->
_»p
 = &
o_¬•row
;

2463 
gu¬d
< 
bË_sÿn_™”_im¶
<
Üd”s_t
> > 
o_™”
;

2465 
bË_sÿn_™”_im¶
<
Üd”s_t
>* 
tmp_o_™”
;

2466 
	`W_DO
(
_pÜd”s_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_o_™”
));

2467 
o_™”
 = 
tmp_o_™”
;

2470 
ch_Üd”s_tu¶e
 
ªÜd”
;

2472 
	`W_DO
(
o_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Üd”
));

2474 !
eof
){

2475 
´Üd”
->
	`g‘_v®ue
(1, 
ªÜd”
.
O_ORDERKEY
);

2476 
´Üd”
->
	`g‘_v®ue
(4, 
ªÜd”
.
O_ORDERDATE
,15);

2477 
time_t
 
t
 = 
	`¡r_to_tim‘
(
ªÜd”
.
O_ORDERDATE
);

2478 
tm
 
d©e
 = *
	`loÿÉime
(&
t
);

2479 
Üd”K_y
.
	`š£¹
Ğ
·œ
<,> (
ªÜd”
.
O_ORDERKEY
, 
d©e
.
tm_y—r
));

2480 
	`W_DO
(
o_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Üd”
));

2484 
m­
 <
q9_group_by_key_t
, 
decim®
, 
q9_group_by_comp
> 
´of™_m
;

2486 
tu¶e_gu¬d
<
lše™em_mª_im¶
> 
	`´lše™em
(
_¶še™em_mª
);

2488 
»p_row_t
 
	`¬•row
(
_¶še™em_mª
->
	`ts
());

2489 
¬•row
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

2491 
´lše™em
->
_»p
 = &
¬•row
;

2493 
tu¶e_gu¬d
<
·¹suµ_mª_im¶
> 
	`´·¹suµ
(
_µ¬tsuµ_mª
);

2495 
»p_row_t
 
	`­¤•row
(
_µ¬tsuµ_mª
->
	`ts
());

2496 
­¤•row
.
	`£t
(
_µ¬tsuµ_desc
->
	`maxsize
());

2498 
´·¹suµ
->
_»p
 = &
­¤•row
;

2500 
gu¬d
< 
bË_sÿn_™”_im¶
<
lše™em_t
> > 
l_™”
;

2502 
bË_sÿn_™”_im¶
<
lše™em_t
>* 
tmp_l_™”
;

2503 
	`W_DO
(
_¶še™em_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_l_™”
));

2504 
l_™”
 = 
tmp_l_™”
;

2507 
ch_lše™em_tu¶e
 
®še
;

2508 
ch_·¹suµ_tu¶e
 
­¬tsuµ
;

2510 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

2512 !
eof
) {

2513 
´lše™em
->
	`g‘_v®ue
(0, 
®še
.
L_ORDERKEY
);

2514 
´lše™em
->
	`g‘_v®ue
(1, 
®še
.
L_PARTKEY
);

2515 
´lše™em
->
	`g‘_v®ue
(2, 
®še
.
L_SUPPKEY
);

2516 
´lše™em
->
	`g‘_v®ue
(4, 
®še
.
L_QUANTITY
);

2517 
´lše™em
->
	`g‘_v®ue
(5, 
®še
.
L_EXTENDEDPRICE
);

2518 
´lše™em
->
	`g‘_v®ue
(6, 
®še
.
L_DISCOUNT
);

2519 if((
_µ¬tsuµ_mª
->
	`ps_šdex_´obe
(
_pssm
, 
´·¹suµ
, 
®še
.
L_PARTKEY
,

2520 
®še
.
L_SUPPKEY
)).
	`is_”rÜ
()) {

2521 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

2524 
´·¹suµ
->
	`g‘_v®ue
(3, 
­¬tsuµ
.
PS_SUPPLYCOST
);

2526 
decim®
 
´iû
 = 
®še
.
L_EXTENDEDPRICE
 * (1 -‡lše.
L_DISCOUNT
) -

2527 
­¬tsuµ
.
PS_SUPPLYCOST
* 
®še
.
L_QUANTITY
;

2529 ifĞ
p_keys
.
	`fšd
(
®še
.
L_PARTKEY
è!ğp_keys.
	`’d
() ){

2530 
m­
<,>::
™”©Ü
 
o™
 = 
Üd”K_y
.
	`fšd
Ğ
®še
.
L_ORDERKEY
);

2531 
m­
<,>::
™”©Ü
 
s™
 = 
suµK_nK
.
	`fšd
Ğ
®še
.
L_SUPPKEY
);

2533 if(
o™
 =ğ
Üd”K_y
.
	`’d
(è|| 
s™
 =ğ
suµK_nK
.end()){

2534 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

2538 
y
 = 
o™
->
£cÚd
;

2539 
ÇtiÚ_k
 = 
s™
->
£cÚd
;

2540 
m­
 <
q9_group_by_key_t
, 
decim®
, 
q9_group_by_comp
>::
™”©Ü
 
™
 =

2541 
´of™_m
.
	`fšd
(
	`q9_group_by_key_t
(
ÇtiÚ_k
, 
y
));

2542 
decim®
 
c
 = 
´iû
;

2543 ifĞ
™
 !ğ
´of™_m
.
	`’d
()) {

2544 
c
 +ğ
™
->
£cÚd
;

2546 
´of™_m
.
	`š£¹
(
·œ
<
q9_group_by_key_t
, 
decim®
>

2547 (
	`q9_group_by_key_t
(
ÇtiÚ_k
, 
y
è,
c
) );

2549 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

2552  
RCOK
;

2553 
	}
}

2563 şas 
	cq10_group_by_key_t
{

2565 
	mpublic
:

2567 
c_cu¡key
;

2568 
	mc_Çme
[25];

2569 
decim®
 
	mc_acùb®
;

2570 
	mphÚe
[15];

2571 
	mn_key
;

2572 
	mc_add»ss
[40];

2573 
	mc_comm’t
[117];

2575 
	mq10_group_by_key_t


2576 (
	mk
, * 
	mÇme
, 
decim®
 
	mb®
, * 
	mphÚe
, 
	mn
, * 
	madd
, * 
	mcmt
){

2577 
	mc_cu¡key
 = 
k
;

2578 
¡rıy
(
c_Çme
, 
Çme
);

2579 
	mc_acùb®
 = 
b®
;

2580 
¡rıy
(
phÚe
,…hone);

2581 
	mn_key
 = 
n
;

2582 
¡rıy
(
c_add»ss
, 
add
);

2583 
¡rıy
(
c_comm’t
, 
cmt
);

2588 şas 
	cq10_group_by_key_comp
{

2590 
	mpublic
:

2591 
boŞ
 
	$İ”©Ü
() (

2592 cÚ¡ 
q10_group_by_key_t
& 
lhs
,

2593 cÚ¡ 
q10_group_by_key_t
& 
rhs
) const

2595  
lhs
.
c_cu¡key
 < 
rhs
.c_custkey;

2597 
	}
};

2601 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_q10
(cÚ¡ , 
q10_šput_t
& 
q10š
)

2604 
	`as£¹
 (
_pssm
);

2605 
	`as£¹
 (
_š™Ÿlized
);

2606 
	`as£¹
 (
_lßded
);

2608 
tm
 
d©e2
 = *
	`gmtime
(&
q10š
.
o_Üd”d©e
);

2609 
d©e2
.
tm_mÚ
 += 3;

2610 ifĞ
d©e2
.
tm_mÚ
 > 11){

2611 
d©e2
.
tm_mÚ
 -= 12;

2612 
d©e2
.
tm_y—r
++;

2615 
time_t
 
t2
 = 
	`mktime
(&
d©e2
);

2616 
time_t
 
t1
 = 
q10š
.
o_Üd”d©e
;

2619 
m­
<, 
veùÜ
<>* > 
cu¡_Üd”sK
;

2620 
m­
<, > 
Üd”s_´iû
;

2622 
tu¶e_gu¬d
<
Üd”s_mª_im¶
> 
	`´Üd”
(
_pÜd”s_mª
);

2624 
»p_row_t
 
	`o_¬•row
(
_pÜd”s_mª
->
	`ts
());

2625 
o_¬•row
.
	`£t
(
_pÜd”s_desc
->
	`maxsize
());

2627 
´Üd”
->
_»p
 = &
o_¬•row
;

2629 
gu¬d
< 
bË_sÿn_™”_im¶
<
Üd”s_t
> > 
o_™”
;

2631 
bË_sÿn_™”_im¶
<
Üd”s_t
>* 
tmp_o_™”
;

2632 
	`W_DO
(
_pÜd”s_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_o_™”
));

2633 
o_™”
 = 
tmp_o_™”
;

2636 
boŞ
 
eof
;

2637 
ch_Üd”s_tu¶e
 
ªÜd”
;

2639 
	`W_DO
(
o_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Üd”
));

2641 !
eof
){

2642 
´Üd”
->
	`g‘_v®ue
(0, 
ªÜd”
.
O_ORDERKEY
);

2643 
´Üd”
->
	`g‘_v®ue
(1, 
ªÜd”
.
O_CUSTKEY
);

2644 
´Üd”
->
	`g‘_v®ue
(4, 
ªÜd”
.
O_ORDERDATE
, 15);

2645 
time_t
 
Üd”d©e
 = 
	`¡r_to_tim‘
(
ªÜd”
.
O_ORDERDATE
);

2646 if(
Üd”d©e
 >ğ
t1
 && ord”d©< 
t2
){

2647 
Üd”s_´iû
.
	`š£¹
(
·œ
<,>(
ªÜd”
.
O_ORDERKEY
, 0.0));

2648 
m­
<, 
veùÜ
<>* >::
™”©Ü
 
™
 =

2649 
cu¡_Üd”sK
.
	`fšd
(
ªÜd”
.
O_CUSTKEY
);

2650 ifĞ
™
 !ğ
cu¡_Üd”sK
.
	`’d
() ){

2651 
™
->
£cÚd
->
	`push_back
(
ªÜd”
.
O_ORDERKEY
);

2653 
veùÜ
<> * 
v
 = 
Ãw
 vector<>();

2654 
v
->
	`push_back
(
ªÜd”
.
O_ORDERKEY
);

2655 
cu¡_Üd”sK
.
	`š£¹
(
·œ
<, 
veùÜ
<>*>(
ªÜd”
.
O_CUSTKEY
,
v
));

2658 
	`W_DO
(
o_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Üd”
));

2662 
tu¶e_gu¬d
<
lše™em_mª_im¶
> 
	`´lše™em
(
_¶še™em_mª
);

2664 
»p_row_t
 
	`¬•row
(
_¶še™em_mª
->
	`ts
());

2665 
¬•row
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

2667 
´lše™em
->
_»p
 = &
¬•row
;

2669 
gu¬d
< 
bË_sÿn_™”_im¶
<
lše™em_t
> > 
l_™”
;

2671 
bË_sÿn_™”_im¶
<
lše™em_t
>* 
tmp_l_™”
;

2672 
	`W_DO
(
_¶še™em_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_l_™”
));

2673 
l_™”
 = 
tmp_l_™”
;

2676 
ch_lše™em_tu¶e
 
®še
;

2678 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

2680 !
eof
) {

2681 
´lše™em
->
	`g‘_v®ue
(0, 
®še
.
L_ORDERKEY
);

2682 
´lše™em
->
	`g‘_v®ue
(8, 
®še
.
L_RETURNFLAG
);

2683 
´lše™em
->
	`g‘_v®ue
(5, 
®še
.
L_EXTENDEDPRICE
);

2684 
´lše™em
->
	`g‘_v®ue
(6, 
®še
.
L_DISCOUNT
);

2685 
´iû
 = (1 - 
®še
.
L_DISCOUNT
è*‡lše.
L_EXTENDEDPRICE
;

2686 
m­
<,>::
™”©Ü
 
™
 = 
Üd”s_´iû
.
	`fšd
(
®še
.
L_ORDERKEY
);

2687 if(
®še
.
L_RETURNFLAG
 =ğ'R' && 
™
 !ğ
Üd”s_´iû
.
	`’d
() ){

2688 
c
 = 
™
->
£cÚd
;

2689 
c
 +ğ
´iû
;

2690 
Üd”s_´iû
[ 
®še
.
L_ORDERKEY
 ] = 
c
;

2692 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

2696 
tu¶e_gu¬d
<
cu¡om”_mª_im¶
> 
	`´cu¡om”
(
_pcu¡om”_mª
);

2698 
»p_row_t
 
	`aü•row
(
_pcu¡om”_mª
->
	`ts
());

2699 
aü•row
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

2701 
´cu¡om”
->
_»p
 = &
aü•row
;

2703 
ch_cu¡om”_tu¶e
 
acu¡
;

2704 
m­
<
q10_group_by_key_t
, , 
q10_group_by_key_comp
> 
cu¡om”_»v
;

2705 
m­
<, 
veùÜ
<>* > :: 
™”©Ü
 
c™
 = 
cu¡_Üd”sK
.
	`begš
();

2707  
c™
 !ğ
cu¡_Üd”sK
.
	`’d
()){

2708 
veùÜ
<>::
™”©Ü
 
o™
 = 
c™
->
£cÚd
->
	`begš
();

2709 
»v
 = 0;

2710 
o™
 !ğ
c™
->
£cÚd
->
	`’d
()){

2711 
»v
 +ğ
Üd”s_´iû
.
	`fšd
(*
o™
)->
£cÚd
;

2712 
o™
++;

2714 if((
_pcu¡om”_mª
->
	`c_šdex_´obe
(
_pssm
, 
´cu¡om”
,

2715 
c™
->
fœ¡
)).
	`is_”rÜ
()) {

2716 
c™
++;

2719 
´cu¡om”
->
	`g‘_v®ue
(1, 
acu¡
.
C_NAME
, 25);

2720 
´cu¡om”
->
	`g‘_v®ue
(2, 
acu¡
.
C_ADDRESS
, 40);

2721 
´cu¡om”
->
	`g‘_v®ue
(3, 
acu¡
.
C_NATIONKEY
);

2722 
´cu¡om”
->
	`g‘_v®ue
(4, 
acu¡
.
C_PHONE
, 15);

2723 
´cu¡om”
->
	`g‘_v®ue
(5, 
acu¡
.
C_ACCTBAL
);

2724 
´cu¡om”
->
	`g‘_v®ue
(2, 
acu¡
.
C_COMMENT
, 117);

2725 
cu¡om”_»v
[
	`q10_group_by_key_t
(
c™
->
fœ¡
, 
acu¡
.
C_NAME
,‡cu¡.
C_ACCTBAL
,

2726 
acu¡
.
C_PHONE
,‡cu¡.
C_NATIONKEY
,

2727 
acu¡
.
C_ADDRESS
,‡cu¡.
C_COMMENT
)] = 
»v
;

2728 
c™
++;

2731  
RCOK
;

2732 
	}
}

2742 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_q11
(cÚ¡ , 
q11_šput_t
& 
q11š
)

2745 
	`as£¹
 (
_pssm
);

2746 
	`as£¹
 (
_š™Ÿlized
);

2747 
	`as£¹
 (
_lßded
);

2750 
m­
<,
boŞ
> 
suµK
;

2752 
tu¶e_gu¬d
<
suµl›r_mª_im¶
> 
	`´suµ
(
_psuµl›r_mª
);

2754 
»p_row_t
 
	`¤•row
(
_psuµl›r_mª
->
	`ts
());

2755 
¤•row
.
	`£t
(
_psuµl›r_desc
->
	`maxsize
());

2757 
´suµ
->
_»p
 = &
¤•row
;

2759 
gu¬d
<
bË_sÿn_™”_im¶
<
suµl›r_t
> > 
s_™”
;

2761 
bË_sÿn_™”_im¶
<
suµl›r_t
>* 
tmp_s_™”
;

2762 
	`W_DO
(
_psuµl›r_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_s_™”
));

2763 
s_™”
 = 
tmp_s_™”
;

2766 
boŞ
 
eof
;

2767 
ch_suµl›r_tu¶e
 
asuµl›r
;

2769 
	`W_DO
(
s_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´suµ
));

2771 !
eof
){

2772 
´suµ
->
	`g‘_v®ue
(0, 
asuµl›r
.
S_SUPPKEY
);

2773 
´suµ
->
	`g‘_v®ue
(3, 
asuµl›r
.
S_NATIONKEY
);

2774 ifĞ
asuµl›r
.
S_NATIONKEY
 =ğ
q11š
.
n_Çme
 ) {

2775 
suµK
.
	`š£¹
(
·œ
<,
boŞ
>(
asuµl›r
.
S_SUPPKEY
,
Œue
));

2777 
	`W_DO
(
s_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´suµ
));

2781 
m­
<, 
decim®
> 
·¹K_v®
;

2782 
decim®
 
tÙ®v®
 = 0;

2784 
tu¶e_gu¬d
<
·¹suµ_mª_im¶
> 
	`´·¹suµ
(
_µ¬tsuµ_mª
);

2786 
»p_row_t
 
	`p¤•row
(
_µ¬tsuµ_mª
->
	`ts
());

2787 
p¤•row
.
	`£t
(
_µ¬tsuµ_desc
->
	`maxsize
());

2789 
´·¹suµ
->
_»p
 = &
p¤•row
;

2791 
gu¬d
<
bË_sÿn_™”_im¶
<
·¹suµ_t
> > 
ps_™”
;

2793 
bË_sÿn_™”_im¶
<
·¹suµ_t
>* 
tmp_ps_™”
;

2794 
	`W_DO
(
_µ¬tsuµ_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_ps_™”
));

2795 
ps_™”
 = 
tmp_ps_™”
;

2798 
ch_·¹suµ_tu¶e
 
­¬tsuµ
;

2800 
	`W_DO
(
ps_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´·¹suµ
));

2802 !
eof
){

2803 
´·¹suµ
->
	`g‘_v®ue
(0, 
­¬tsuµ
.
PS_PARTKEY
);

2804 
´·¹suµ
->
	`g‘_v®ue
(1, 
­¬tsuµ
.
PS_SUPPKEY
);

2805 
´·¹suµ
->
	`g‘_v®ue
(2, 
­¬tsuµ
.
PS_AVAILQTY
);

2806 
´·¹suµ
->
	`g‘_v®ue
(3, 
­¬tsuµ
.
PS_SUPPLYCOST
);

2807 ifĞ
suµK
.
	`fšd
(
­¬tsuµ
.
PS_SUPPKEY
è!ğsuµK.
	`’d
() ){

2808 
m­
<,
decim®
>::
™”©Ü
 
p™
 =
·¹K_v®
.
	`fšd
(
­¬tsuµ
.
PS_PARTKEY
);

2809 
decim®
 
c
 = 
­¬tsuµ
.
PS_AVAILQTY
 *‡·¹suµ.
PS_SUPPLYCOST
;

2810 
tÙ®v®
 +ğ
c
;

2811 ifĞ
p™
 !ğ
·¹K_v®
.
	`’d
()){

2812 
c
 +ğ
p™
->
£cÚd
;

2814 
·¹K_v®
[
­¬tsuµ
.
PS_PARTKEY
] = 
c
;

2816 
	`W_DO
(
ps_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´·¹suµ
));

2819  
RCOK
;

2820 
	}
}

2853 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_q12
(cÚ¡ , 
q12_šput_t
& 
q12š
)

2856 
	`as£¹
 (
_pssm
);

2857 
	`as£¹
 (
_š™Ÿlized
);

2858 
	`as£¹
 (
_lßded
);

2861 
veùÜ
<
·œ
<, > > 
Üd”K_shmode
;

2862 
m­
<, 
·œ
<,> > 
shpmd_HLC_LLC
;

2863 
shpmd_HLC_LLC
.
	`š£¹
(
·œ
<,…air<,> >

2864 (
q12š
.
l_shmode1
, 
·œ
<,>(0,0)));

2865 
shpmd_HLC_LLC
.
	`š£¹
(
·œ
<,…air<,> >

2866 (
q12š
.
l_shmode2
, 
·œ
<,>(0,0)));

2868 
tu¶e_gu¬d
<
lše™em_mª_im¶
> 
	`´lše™em
(
_¶še™em_mª
);

2870 
»p_row_t
 
	`¬•row
(
_¶še™em_mª
->
	`ts
());

2871 
¬•row
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

2873 
´lše™em
->
_»p
 = &
¬•row
;

2875 
»p_row_t
 
	`low»p
(
_¶še™em_mª
->
	`ts
());

2876 
»p_row_t
 
	`high»p
(
_¶še™em_mª
->
	`ts
());

2878 
low»p
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

2879 
high»p
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

2881 
tm
 
d©e
;

2882 if(
	`gmtime_r
(&(
q12š
.
l_»ûtd©e
), &
d©e
è=ğ
NULL
){

2883  
RCOK
;

2885 
d©e
.
tm_y—r
++;

2886 
time_t
 
Ï¡_»ûtd©e
 = 
	`mktime
(&
d©e
);

2888 
gu¬d
 <
šdex_sÿn_™”_im¶
<
lše™em_t
> >
l_™”
;

2890 
šdex_sÿn_™”_im¶
<
lše™em_t
>* 
tmp_l_™”
;

2891 
	`W_DO
(
_¶še™em_mª
->

2892 
	`l_g‘_¿nge_™”_by_»ûtd©e_šdex
(
_pssm
, 
tmp_l_™”
, 
´lše™em
,

2893 
low»p
, 
high»p
,

2894 
q12š
.
l_»ûtd©e
,

2895 
Ï¡_»ûtd©e
));

2896 
l_™”
 = 
tmp_l_™”
;

2899 
boŞ
 
eof
;

2900 
ch_lše™em_tu¶e
 
®še
;

2902 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

2904 !
eof
){

2905 
´lše™em
->
	`g‘_v®ue
(0, 
®še
.
L_ORDERKEY
);

2906 
´lše™em
->
	`g‘_v®ue
(10, 
®še
.
L_SHIPDATE
, 15);

2907 
´lše™em
->
	`g‘_v®ue
(11, 
®še
.
L_COMMITDATE
, 15);

2908 
´lše™em
->
	`g‘_v®ue
(12, 
®še
.
L_RECEIPTDATE
, 15);

2909 
´lše™em
->
	`g‘_v®ue
(14, 
®še
.
L_SHIPMODE
, 10);

2910 
time_t
 
shd©e
 = 
	`¡r_to_tim‘
(
®še
.
L_SHIPDATE
);

2911 
time_t
 
comm™d©e
 = 
	`¡r_to_tim‘
(
®še
.
L_COMMITDATE
);

2912 
time_t
 
»ûtd©e
 = 
	`¡r_to_tim‘
(
®še
.
L_RECEIPTDATE
);

2913 
shmode
 = 
	`¡r_to_shmode
(
®še
.
L_SHIPMODE
);

2914 if(
shmode
 =ğ
q12š
.
l_shmode1
 || shmod=ğq12š.
l_shmode2
) {

2915 if(
comm™d©e
 < 
»ûtd©e
 && 
shd©e
 < commitdate) {

2916 
Üd”K_shmode
.
	`push_back
(
·œ
<,>(
®še
.
L_ORDERKEY
,

2917 
shmode
));

2920 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

2924 
tu¶e_gu¬d
<
Üd”s_mª_im¶
> 
	`´Üd”
(
_pÜd”s_mª
);

2926 
»p_row_t
 
	`aÜ•row
(
_pÜd”s_mª
->
	`ts
());

2927 
aÜ•row
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

2929 
´Üd”
->
_»p
 = &
aÜ•row
;

2931 
»p_row_t
 
	`low_»p
(
_pÜd”s_mª
->
	`ts
());

2932 
»p_row_t
 
	`high_»p
(
_pÜd”s_mª
->
	`ts
());

2934 
low_»p
.
	`£t
(
_pÜd”s_desc
->
	`maxsize
());

2935 
high_»p
.
	`£t
(
_pÜd”s_desc
->
	`maxsize
());

2936 
veùÜ
<
·œ
<,> >::
™”©Ü
 
™”
 = 
Üd”K_shmode
.
	`begš
();

2937 
™”
 !ğ
Üd”K_shmode
.
	`’d
();

2938 
™”
++){

2940 
Üd”Key
 = 
™”
->
fœ¡
;

2941 
gu¬d
<
šdex_sÿn_™”_im¶
<
Üd”s_t
> > 
o_™”
;

2943 
šdex_sÿn_™”_im¶
<
Üd”s_t
>* 
tmp_o_™”
;

2944 
	`W_DO
(
_pÜd”s_mª
->
	`o_g‘_™”_by_šdex
(
_pssm
, 
tmp_o_™”
, 
´Üd”
,

2945 
low_»p
, 
high_»p
, 
Üd”Key
));

2946 
o_™”
 = 
tmp_o_™”
;

2949 
boŞ
 
eof
;

2951 
	`W_DO
(
o_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Üd”
));

2953 
´iÜ™y
[15];

2954 
´Üd”
->
	`g‘_v®ue
(5, 
´iÜ™y
, 15);

2956 
hlc
 = 
shpmd_HLC_LLC
[
™”
->
£cÚd
].
fœ¡
;

2957 
Îc
 = 
shpmd_HLC_LLC
[
™”
->
£cÚd
].second;

2959 if(
	`¡rcmp
(
´iÜ™y
,"2-HIGH"è=ğ0 
Ü
 strcmp(priority,"1-URGENT") ==0){

2960 
shpmd_HLC_LLC
[
™”
->
£cÚd
] = 
·œ
<,>Ğ
hlc
+1, 
Îc
);

2962 
shpmd_HLC_LLC
[
™”
->
£cÚd
] = 
·œ
<,>Ğ
hlc
, 
Îc
+1);

2966  
RCOK
;

2967 
	}
}

2977 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_q13
(cÚ¡ , 
q13_šput_t
& )

2980 
	`as£¹
 (
_pssm
);

2981 
	`as£¹
 (
_š™Ÿlized
);

2982 
	`as£¹
 (
_lßded
);

3004 
m­
<,> 
c_Üd”s
;

3006 
tu¶e_gu¬d
<
cu¡om”_mª_im¶
> 
	`´cu¡om”
(
_pcu¡om”_mª
);

3008 
»p_row_t
 
	`¬•row
(
_pcu¡om”_mª
->
	`ts
());

3009 
¬•row
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

3011 
´cu¡om”
->
_»p
 = &
¬•row
;

3014 
gu¬d
< 
bË_sÿn_™”_im¶
<
cu¡om”_t
> > 
c_™”
;

3016 
bË_sÿn_™”_im¶
<
cu¡om”_t
>* 
tmp_c_™”
;

3017 
	`W_DO
(
_pcu¡om”_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_c_™”
));

3018 
c_™”
 = 
tmp_c_™”
;

3021 
boŞ
 
eof
;

3022 
ch_cu¡om”_tu¶e
 
acu¡
;

3024 
	`W_DO
(
c_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cu¡om”
));

3026 !
eof
){

3027 
´cu¡om”
->
	`g‘_v®ue
(0, 
acu¡
.
C_CUSTKEY
);

3028 
c_Üd”s
[ 
acu¡
.
C_CUSTKEY
 ] = 0;

3029 
	`W_DO
(
c_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cu¡om”
));

3033 
tu¶e_gu¬d
<
Üd”s_mª_im¶
> 
	`´Üd”
(
_pÜd”s_mª
);

3035 
»p_row_t
 
	`o_¬•row
(
_pÜd”s_mª
->
	`ts
());

3036 
o_¬•row
.
	`£t
(
_pÜd”s_desc
->
	`maxsize
());

3038 
´Üd”
->
_»p
 = &
o_¬•row
;

3040 
gu¬d
< 
bË_sÿn_™”_im¶
<
Üd”s_t
> > 
o_™”
;

3042 
bË_sÿn_™”_im¶
<
Üd”s_t
>* 
tmp_o_™”
;

3043 
	`W_DO
(
_pÜd”s_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_o_™”
));

3044 
o_™”
 = 
tmp_o_™”
;

3047 
ch_Üd”s_tu¶e
 
aÜd”
;

3049 
	`W_DO
(
o_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Üd”
));

3051 !
eof
){

3052 
´Üd”
->
	`g‘_v®ue
(1, 
aÜd”
.
O_CUSTKEY
);

3053 
n
 = 
c_Üd”s
[ 
aÜd”
.
O_CUSTKEY
 ];

3054 
n
++;

3055 
c_Üd”s
[ 
aÜd”
.
O_CUSTKEY
 ] = 
n
;

3056 
	`W_DO
(
o_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Üd”
));

3060 
m­
<, > 
o_couÁ_cu¡
;

3062 
m­
<,>::
™”©Ü
 
™”
 = 
c_Üd”s
.
	`begš
();

3063 
™”
 !ğ
c_Üd”s
.
	`’d
();

3064 
™”
++){

3065 
m­
<,>::
™”©Ü
 
tmp
 = 
o_couÁ_cu¡
.
	`fšd
(
™”
->
£cÚd
);

3066 if(
tmp
 !ğ
o_couÁ_cu¡
.
	`’d
()){

3067 
c
 = 
tmp
->
£cÚd
;

3068 
c
++;

3069 
o_couÁ_cu¡
[
™”
->
£cÚd
] = 
c
;

3071 
o_couÁ_cu¡
[
™”
->
£cÚd
] = 1;

3075  
RCOK
;

3076 
	}
}

3086 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_q14
(cÚ¡ , 
q14_šput_t
& 
q14š
)

3089 
	`as£¹
 (
_pssm
);

3090 
	`as£¹
 (
_š™Ÿlized
);

3091 
	`as£¹
 (
_lßded
);

3093 
m­
<, 
veùÜ
<>* > 
pKey_´iûs
;

3094 
tÙ®»v’ue
 = 0;

3097 
tu¶e_gu¬d
<
lše™em_mª_im¶
> 
	`´lše™em
(
_¶še™em_mª
);

3099 
»p_row_t
 
	`¬•row
(
_¶še™em_mª
->
	`ts
());

3100 
¬•row
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

3102 
´lše™em
->
_»p
 = &
¬•row
;

3104 
»p_row_t
 
	`low»p
(
_¶še™em_mª
->
	`ts
());

3105 
»p_row_t
 
	`high»p
(
_¶še™em_mª
->
	`ts
());

3107 
low»p
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

3108 
high»p
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

3110 
tm
 
d©e
;

3111 if(
	`gmtime_r
(&(
q14š
.
l_shd©e
), &
d©e
è=ğ
NULL
){

3112  
RCOK
;

3114 
d©e
.
tm_mÚ
+=1;

3115 ifĞ
d©e
.
tm_mÚ
 > 11){

3116 
d©e
.
tm_mÚ
 -= 12;

3117 
d©e
.
tm_y—r
 ++;

3119 
time_t
 
Ï¡_shd©e
 = 
	`mktime
(&
d©e
);

3121 
gu¬d
<
šdex_sÿn_™”_im¶
<
lše™em_t
> > 
l_™”
;

3123 
šdex_sÿn_™”_im¶
<
lše™em_t
>* 
tmp_l_™”
;

3124 
	`W_DO
(
_¶še™em_mª
->
	`l_g‘_¿nge_™”_by_šdex
(
_pssm
, 
tmp_l_™”
,

3125 
´lše™em
, 
low»p
,

3126 
high»p
, 
q14š
.
l_shd©e
,

3127 
Ï¡_shd©e
));

3128 
l_™”
 = 
tmp_l_™”
;

3131 
boŞ
 
eof
;

3132 
ch_lše™em_tu¶e
 
®še
;

3134 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

3136 !
eof
){

3137 
´lše™em
->
	`g‘_v®ue
(1, 
®še
.
L_PARTKEY
);

3138 
´lše™em
->
	`g‘_v®ue
(5, 
®še
.
L_EXTENDEDPRICE
);

3139 
´lše™em
->
	`g‘_v®ue
(6, 
®še
.
L_DISCOUNT
);

3140 
th•riû
 = 
®še
.
L_EXTENDEDPRICE
 *(1 -‡lše.
L_DISCOUNT
);

3141 
m­
<, 
veùÜ
<>*>::
™”©Ü
 
pveùÜ
 =

3142 
pKey_´iûs
.
	`fšd
(
®še
.
L_PARTKEY
);

3143 ifĞ
pveùÜ
 !ğ
pKey_´iûs
.
	`’d
() ){

3144 
pveùÜ
->
£cÚd
->
	`push_back
Ğ
th•riû
 );

3146 
veùÜ
<>* 
v
 = 
Ãw
 vector<>();

3147 
v
->
	`push_back
Ğ
th•riû
 );

3148 
pKey_´iûs
.
	`š£¹
(
·œ
<, 
veùÜ
<>* > (
®še
.
L_PARTKEY
, 
v
));

3150 
tÙ®»v’ue
 +ğ
th•riû
;

3151 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

3155 
´omÜev’ue
 = 0;

3158 
tu¶e_gu¬d
<
·¹_mª_im¶
> 
	`´·¹
(
_µ¬t_mª
);

3160 
»p_row_t
 
	`´•row
(
_µ¬t_mª
->
	`ts
());

3161 
´•row
.
	`£t
(
_µ¬t_desc
->
	`maxsize
());

3163 
´·¹
->
_»p
 = &
´•row
;

3165 
gu¬d
<
bË_sÿn_™”_im¶
<
·¹_t
> > 
p_™”
;

3167 
bË_sÿn_™”_im¶
<
·¹_t
>* 
tmp_p_™”
;

3168 
	`W_DO
(
_µ¬t_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_p_™”
));

3169 
p_™”
 = 
tmp_p_™”
;

3172 
ch_·¹_tu¶e
 
­¬t
;

3174 
	`W_DO
(
p_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´·¹
));

3176 !
eof
){

3177 
´·¹
->
	`g‘_v®ue
(4, 
­¬t
.
P_TYPE
, 25);

3178 
´·¹
->
	`g‘_v®ue
(0, 
­¬t
.
P_PARTKEY
);

3179 
m­
<,
veùÜ
<>* >::
™”©Ü
 
‹mp
=
pKey_´iûs
.
	`fšd
(
­¬t
.
P_PARTKEY
);

3180 ifĞ
	`¡r¡r
(
­¬t
.
P_TYPE
, "PROMO"è!ğ
NULL
 && 
‹mp
 !ğ
pKey_´iûs
.
	`’d
() ){

3181 
i
 = 0; i < 
‹mp
->
£cÚd
->
	`size
(); i++ ){

3182 
´omÜev’ue
 +ğĞ*Ğ
‹mp
->
£cÚd
 ) )[
i
];

3185 
	`W_DO
(
p_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´·¹
));

3188  
RCOK
;

3189 
	}
}

3199 
	ssuµl›rcmp
 {

3200 
boŞ
 
İ”©Ü
()ĞcÚ¡ 
	mch_suµl›r_tu¶e
& 
	ms1
, cÚ¡pch_suµl›r_tu¶e& 
	ms2
 ) const {

3201  
	ms1
.
	mS_SUPPKEY
 < 
	ms2
.S_SUPPKEY;

3206 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_q15
(cÚ¡ , 
q15_šput_t
& 
q15š
)

3209 
	`as£¹
 (
_pssm
);

3210 
	`as£¹
 (
_š™Ÿlized
);

3211 
	`as£¹
 (
_lßded
);

3213 
m­
<,> 
¡»am_id
;

3216 
tu¶e_gu¬d
<
lše™em_mª_im¶
> 
	`´lše™em
(
_¶še™em_mª
);

3218 
»p_row_t
 
	`¬•row
(
_¶še™em_mª
->
	`ts
());

3219 
¬•row
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

3221 
´lše™em
->
_»p
 = &
¬•row
;

3223 
»p_row_t
 
	`low»p
(
_¶še™em_mª
->
	`ts
());

3224 
»p_row_t
 
	`high»p
(
_¶še™em_mª
->
	`ts
());

3226 
low»p
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

3227 
high»p
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

3229 
tm
 
d©e
;

3230 if(
	`gmtime_r
(&(
q15š
.
l_shd©e
), &
d©e
è=ğ
NULL
){

3231  
RCOK
;

3234 
d©e
.
tm_mÚ
+=3;

3235 ifĞ
d©e
.
tm_mÚ
 > 11){

3236 
d©e
.
tm_mÚ
 -= 12;

3237 
d©e
.
tm_y—r
 ++;

3239 
time_t
 
Ï¡_shd©e
 = 
	`mktime
(&
d©e
);

3241 
gu¬d
<
šdex_sÿn_™”_im¶
<
lše™em_t
> > 
l_™”
;

3243 
šdex_sÿn_™”_im¶
<
lše™em_t
>* 
tmp_l_™”
;

3244 
	`W_DO
(
_¶še™em_mª
->
	`l_g‘_¿nge_™”_by_šdex
(
_pssm
, 
tmp_l_™”
,

3245 
´lše™em
, 
low»p
,

3246 
high»p
, 
q15š
.
l_shd©e
,

3247 
Ï¡_shd©e
));

3248 
l_™”
 = 
tmp_l_™”
;

3251 
boŞ
 
eof
;

3252 
ch_lše™em_tu¶e
 
®še
;

3254 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

3256 !
eof
){

3257 
´lše™em
->
	`g‘_v®ue
(2, 
®še
.
L_SUPPKEY
);

3258 
´lše™em
->
	`g‘_v®ue
(5, 
®še
.
L_EXTENDEDPRICE
);

3259 
´lše™em
->
	`g‘_v®ue
(6, 
®še
.
L_DISCOUNT
);

3260 
th•riû
 = 
®še
.
L_EXTENDEDPRICE
 *(1 -‡lše.
L_DISCOUNT
);

3261 
m­
<, >::
™”©Ü
 
tmp
 = 
¡»am_id
.
	`fšd
(
®še
.
L_SUPPKEY
);

3262 if(
tmp
 !ğ
¡»am_id
.
	`’d
()){

3263 
s
 = 
tmp
->
£cÚd
;

3264 
s
 +ğ
th•riû
;

3265 
¡»am_id
[ 
®še
.
L_SUPPKEY
 ] = 
s
;

3267 
¡»am_id
[
®še
.
L_SUPPKEY
] = 
th•riû
;

3269 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

3272 
max»v
 = 
¡»am_id
.
	`begš
()->
£cÚd
;

3273 
m­
<,>::
™”©Ü
 
™”
 = 
¡»am_id
.
	`begš
();

3274 
™”
 !ğ
¡»am_id
.
	`’d
();

3275 
™”
++) {

3276 ifĞ
max»v
 < 
™”
->
£cÚd
 ) {

3277 
max»v
 = 
™”
->
£cÚd
;

3280 
m­
<,>::
™”©Ü
 
™”
 = 
¡»am_id
.
	`begš
();

3281 
™”
 !ğ
¡»am_id
.
	`’d
();

3282 
™”
++) {

3283 if(
™”
->
£cÚd
 !ğ
max»v
) {

3284 
¡»am_id
.
	`”a£
(
™”
);

3289 
m­
<
ch_suµl›r_tu¶e
, , 
suµl›rcmp
> 
suµ»v
;

3291 
tu¶e_gu¬d
<
suµl›r_mª_im¶
> 
	`´suµ
(
_psuµl›r_mª
);

3293 
»p_row_t
 
	`¤•row
(
_psuµl›r_mª
->
	`ts
());

3294 
¤•row
.
	`£t
(
_psuµl›r_desc
->
	`maxsize
());

3296 
´suµ
->
_»p
 = &
¤•row
;

3298 
m­
<,>::
™”©Ü
 
™”
 = 
¡»am_id
.
	`begš
();

3299 
™”
 !ğ
¡»am_id
.
	`’d
();

3300 
™”
++){

3301 
_psuµl›r_mª
->
	`s_šdex_´obe
(
_pssm
, 
´suµ
, 
™”
->
fœ¡
);

3302 
ch_suµl›r_tu¶e
 
asuµ
;

3303 
´suµ
->
	`g‘_v®ue
(1, 
asuµ
.
S_NAME
, 25);

3304 
´suµ
->
	`g‘_v®ue
(2, 
asuµ
.
S_ADDRESS
, 40);

3305 
´suµ
->
	`g‘_v®ue
(4, 
asuµ
.
S_PHONE
, 15);

3306 
suµ»v
[
asuµ
] = 
™”
->
£cÚd
;

3309  
RCOK
;

3310 
	}
}

3319 
	s»quœed_ty³
{

3321 
	mpublic
:

3323 
b¿nd
;

3324 
	mty³
;

3325 
	msize
;

3327 
»quœed_ty³
(
b
, 
t
, 
s
){

3329 
	mb¿nd
 = 
b
;

3330 
	mty³
 = 
t
;

3331 
	msize
 = 
s
;

3334 
»quœed_ty³
(){}

3337 
	s»quœed_ty³_cmp
 {

3338 
boŞ
 
İ”©Ü
()ĞcÚ¡ 
	m»quœed_ty³
& 
	mr1
, cÚ¡„equœed_ty³& 
	mr2
 ) const {

3339  ( (
	mr1
.
	mb¿nd
 < 
	mr2
.brand) ||

3340 (
	mr1
.
	mb¿nd
 =ğ
r2
.
b¿nd
 && 
r1
.
ty³
 <„2.type)||

3341 (
r1
.
b¿nd
 =ğ
r2
.b¿nd &&„1.
ty³
 =ğr2.ty³ &&„1.
size
 <„2.size) );

3346 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_q16
(cÚ¡ , 
q16_šput_t
& 
q16š
)

3349 
	`as£¹
 (
_pssm
);

3350 
	`as£¹
 (
_š™Ÿlized
);

3351 
	`as£¹
 (
_lßded
);

3354 
m­
<, 
»quœed_ty³
> 
pKeys_ty³
;

3356 
tu¶e_gu¬d
<
·¹_mª_im¶
> 
	`´·¹
(
_µ¬t_mª
);

3358 
»p_row_t
 
	`´•row
(
_µ¬t_mª
->
	`ts
());

3359 
´•row
.
	`£t
(
_µ¬t_desc
->
	`maxsize
());

3361 
´·¹
->
_»p
 = &
´•row
;

3363 
gu¬d
<
bË_sÿn_™”_im¶
<
·¹_t
> > 
p_™”
;

3365 
bË_sÿn_™”_im¶
<
·¹_t
>* 
tmp_p_™”
;

3366 
	`W_DO
(
_µ¬t_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_p_™”
));

3367 
p_™”
 = 
tmp_p_™”
;

3370 
boŞ
 
eof
;

3371 
ch_·¹_tu¶e
 
­¬t
;

3373 
	`W_DO
(
p_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´·¹
));

3375 !
eof
){

3376 
psize
;

3377 
´·¹
->
	`g‘_v®ue
(0, 
­¬t
.
P_PARTKEY
);

3378 
´·¹
->
	`g‘_v®ue
(3, 
­¬t
.
P_BRAND
, 10);

3379 
´·¹
->
	`g‘_v®ue
(4, 
­¬t
.
P_TYPE
, 25);

3380 
´·¹
->
	`g‘_v®ue
(5, 
psize
);

3381 
b¿nd
 = 
	`¡r_to_B¿nd
(
­¬t
.
P_BRAND
);

3382 *
sylb
;

3383 
ty³
;

3384 
sylb
 = 
	`¡¹ok
Ğ
­¬t
.
P_TYPE
," ");

3385 
ty³
 = 
	`¡r_to_ty³s1
(
sylb
)*10 + 
	`¡r_to_ty³s2
(
	`¡¹ok
(
NULL
," "));

3386 ifĞ
b¿nd
 !ğ
q16š
.
p_b¿nd
 && 
ty³
 !ğq16š.
p_ty³
){

3387 
i
 = 0; i < 8; i++) {

3388 ifĞ
q16š
.
p_size
[
i
] =ğ
psize
){

3389 
pKeys_ty³
[
­¬t
.
P_PARTKEY
]=
	`»quœed_ty³
(
b¿nd
, 
psize
, 
ty³
);

3394 
	`W_DO
(
p_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´·¹
));

3398 
m­
<,
boŞ
> 
suµkeybl
;

3400 
tu¶e_gu¬d
<
suµl›r_mª_im¶
> 
	`´suµ
(
_psuµl›r_mª
);

3402 
»p_row_t
 
	`¤•row
(
_psuµl›r_mª
->
	`ts
());

3403 
¤•row
.
	`£t
(
_psuµl›r_desc
->
	`maxsize
());

3405 
´suµ
->
_»p
 = &
¤•row
;

3407 
gu¬d
<
bË_sÿn_™”_im¶
<
suµl›r_t
> > 
s_™”
;

3409 
bË_sÿn_™”_im¶
<
suµl›r_t
>* 
tmp_s_™”
;

3410 
	`W_DO
(
_psuµl›r_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_s_™”
));

3411 
s_™”
 = 
tmp_s_™”
;

3414 
ch_suµl›r_tu¶e
 
asuµl›r
;

3416 
	`W_DO
(
s_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´suµ
));

3418 !
eof
){

3419 
´suµ
->
	`g‘_v®ue
(0, 
asuµl›r
.
S_SUPPKEY
);

3420 
´suµ
->
	`g‘_v®ue
(6, 
asuµl›r
.
S_COMMENT
, 101);

3421 * 
p1
 = 
	`¡r¡r
(
asuµl›r
.
S_COMMENT
, "Customer");

3422 * 
p2
 = 
	`¡r¡r
(
asuµl›r
.
S_COMMENT
, "Complaints");

3423 ifĞ
p1
!ğ
NULL
 && 
p2
 != NULL){

3424 ifĞ
p2
 - 
p1
 > 0 ) {

3425 
suµkeybl
[
asuµl›r
.
S_SUPPKEY
] = 
Œue
;

3428 
	`W_DO
(
s_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´suµ
));

3432 
m­
<
»quœed_ty³
, , 
»quœed_ty³_cmp
> 
suµcouÁ
;

3434 
tu¶e_gu¬d
<
·¹suµ_mª_im¶
> 
	`´·¹suµ
(
_µ¬tsuµ_mª
);

3436 
»p_row_t
 
	`p¤•row
(
_µ¬tsuµ_mª
->
	`ts
());

3437 
¤•row
.
	`£t
(
_µ¬tsuµ_desc
->
	`maxsize
());

3439 
´·¹suµ
->
_»p
 = &
p¤•row
;

3441 
gu¬d
<
bË_sÿn_™”_im¶
<
·¹suµ_t
> > 
ps_™”
;

3443 
bË_sÿn_™”_im¶
<
·¹suµ_t
>* 
tmp_ps_™”
;

3444 
	`W_DO
(
_µ¬tsuµ_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_ps_™”
));

3445 
ps_™”
 = 
tmp_ps_™”
;

3448 
ch_·¹suµ_tu¶e
 
­¬tsuµ
;

3450 
	`W_DO
(
ps_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´·¹suµ
));

3452 !
eof
){

3453 
´·¹suµ
->
	`g‘_v®ue
(0, 
­¬tsuµ
.
PS_PARTKEY
);

3454 
´·¹suµ
->
	`g‘_v®ue
(1, 
­¬tsuµ
.
PS_SUPPKEY
);

3455 
m­
<, 
»quœed_ty³
>::
™”©Ü
 
tmp™”
;

3456 if((
tmp™”
 = 
pKeys_ty³
.
	`fšd
(
­¬tsuµ
.
PS_PARTKEY
))!õKeys_ty³.
	`’d
() &&

3457 
suµkeybl
.
	`fšd
(
­¬tsuµ
.
PS_SUPPKEY
è=ğsuµkeybl.
	`’d
()){

3458 
m­
<
»quœed_ty³
, , 
»quœed_ty³_cmp
>::
™”©Ü
 
tmp™”2
;

3459 if((
tmp™”2
 = 
suµcouÁ
.
	`fšd
(
tmp™”
->
£cÚd
))!ğsuµcouÁ.
	`’d
()){

3460 
c
 = 
tmp™”2
->
£cÚd
;

3461 
c
++;

3462 
suµcouÁ
[
tmp™”2
->
fœ¡
] = 
c
;

3464 
suµcouÁ
[
tmp™”2
->
fœ¡
] = 1;

3467 
	`W_DO
(
ps_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´·¹suµ
));

3470  
RCOK
;

3471 
	}
}

3481 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_q17
(cÚ¡ , 
q17_šput_t
& 
q17š
 )

3484 
	`as£¹
 (
_pssm
);

3485 
	`as£¹
 (
_š™Ÿlized
);

3486 
	`as£¹
 (
_lßded
);

3489 
m­
<, 
veùÜ
<
·œ
<,> >* > 
pKey_lše™ems
;

3491 
tu¶e_gu¬d
<
·¹_mª_im¶
> 
	`´·¹
(
_µ¬t_mª
);

3493 
»p_row_t
 
	`´•row
(
_µ¬t_mª
->
	`ts
());

3494 
´•row
.
	`£t
(
_µ¬t_desc
->
	`maxsize
());

3496 
´·¹
->
_»p
 = &
´•row
;

3498 
gu¬d
<
bË_sÿn_™”_im¶
<
·¹_t
> > 
p_™”
;

3500 
bË_sÿn_™”_im¶
<
·¹_t
>* 
tmp_p_™”
;

3501 
	`W_DO
(
_µ¬t_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_p_™”
));

3502 
p_™”
 = 
tmp_p_™”
;

3505 
boŞ
 
eof
;

3506 
ch_·¹_tu¶e
 
­¬t
;

3508 
	`W_DO
(
p_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´·¹
));

3510 !
eof
){

3511 
´·¹
->
	`g‘_v®ue
(0, 
­¬t
.
P_PARTKEY
);

3512 
´·¹
->
	`g‘_v®ue
(3, 
­¬t
.
P_BRAND
, 10);

3513 
´·¹
->
	`g‘_v®ue
(6, 
­¬t
.
P_CONTAINER
, 10);

3514 
b¿nd
 = 
	`¡r_to_B¿nd
(
­¬t
.
P_BRAND
);

3515 *
s1
 = 
	`¡¹ok
(
­¬t
.
P_CONTAINER
, " ");

3516 
cÚš”
 = 
	`¡r_to_cÚš”s1
(
s1
)*10+

3517 
	`¡r_to_cÚš”s2
(
	`¡¹ok
(
NULL
," "));

3518 if(
b¿nd
 =ğ
q17š
.
p_b¿nd
 && 
cÚš”
 =ğq17š.
p_cÚš”
){

3519 
veùÜ
<
·œ
<,> > * 
v
 = 
Ãw
 vector<pair<,> > ();

3520 
pKey_lše™ems
[
­¬t
.
P_PARTKEY
] = 
v
;

3522 
	`W_DO
(
p_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´·¹
));

3526 
tu¶e_gu¬d
<
lše™em_mª_im¶
> 
	`´lše™em
(
_¶še™em_mª
);

3528 
»p_row_t
 
	`¬•row
(
_¶še™em_mª
->
	`ts
());

3529 
¬•row
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

3531 
´lše™em
->
_»p
 = &
¬•row
;

3533 
gu¬d
< 
bË_sÿn_™”_im¶
<
lše™em_t
> > 
l_™”
;

3535 
bË_sÿn_™”_im¶
<
lše™em_t
>* 
tmp_l_™”
;

3536 
	`W_DO
(
_¶še™em_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_l_™”
));

3537 
l_™”
 = 
tmp_l_™”
;

3540 
ch_lše™em_tu¶e
 
®še
;

3542 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

3544 !
eof
) {

3545 
´lše™em
->
	`g‘_v®ue
(1, 
®še
.
L_PARTKEY
);

3546 
´lše™em
->
	`g‘_v®ue
(5, 
®še
.
L_EXTENDEDPRICE
);

3547 
´lše™em
->
	`g‘_v®ue
(4, 
®še
.
L_QUANTITY
);

3548 
m­
<, 
veùÜ
<
·œ
<,> >* >::
™”©Ü
 
tmp™”
;

3549 
tmp™”
 = 
pKey_lše™ems
.
	`fšd
(
®še
.
L_PARTKEY
);

3550 if(
tmp™”
 !ğ
pKey_lše™ems
.
	`’d
()){

3551 
tmp™”
->
£cÚd
->
	`push_back
(
·œ
<,>

3552 (
®še
.
L_EXTENDEDPRICE
,‡lše.
L_QUANTITY
));

3554 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

3558 
sum
 = 0;

3559 
m­
<, 
veùÜ
<
·œ
<,> >* >::
™”©Ü
 
™”
=
pKey_lše™ems
.
	`begš
();

3560 
™”
 !ğ
pKey_lše™ems
.
	`’d
();

3561 
™”
++){

3562 if(
™”
->
£cÚd
->
	`size
() == 0){

3563 
	`d–‘e
 (
™”
->
£cÚd
);

3566 
avg
 = 0;

3567 
i
=0; i< 
™”
->
£cÚd
->
	`size
(); i++){

3568 
avg
+ğ(*(
™”
->
£cÚd
))[
i
].second;

3570 
avg
 /ğ
™”
->
£cÚd
->
	`size
();

3571 
avg
 *= .2;

3572 
i
=0; i< 
™”
->
£cÚd
->
	`size
(); i++){

3573 if((*(
™”
->
£cÚd
))[
i
].£cÚd < 
avg
){

3574 
sum
 +ğ(*(
™”
->
£cÚd
))[
i
].
fœ¡
;

3577 
	`d–‘e
 (
™”
->
£cÚd
);

3580  
RCOK
;

3581 
	}
}

3590 
	sQ18_row
{

3591 
	mc_Çme
 [25];

3592 
	mc_key
;

3593 
time_t
 
	mo_Üd”d©e
;

3594 
decim®
 
	mo_tÙ®´iû
;

3596 
Q18_row
(){}

3598 
Q18_row
(* 
Çme
, 
key
, 
time_t
 
d©e
, 
decim®
 
´iû
){

3600 
¡rıy
(
c_Çme
, 
Çme
);

3601 
	mc_key
 = 
key
;

3602 
	mo_Üd”d©e
 = 
d©e
;

3603 
	mo_tÙ®´iû
 = 
´iû
;

3607 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_q18
(cÚ¡ , 
q18_šput_t
& 
q18š
)

3610 
	`as£¹
 (
_pssm
);

3611 
	`as£¹
 (
_š™Ÿlized
);

3612 
	`as£¹
 (
_lßded
);

3615 
tu¶e_gu¬d
<
lše™em_mª_im¶
> 
	`´lše™em
(
_¶še™em_mª
);

3617 
»p_row_t
 
	`Ì•row
(
_¶še™em_mª
->
	`ts
());

3618 
Ì•row
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

3620 
´lše™em
->
_»p
 = &
Ì•row
;

3622 
m­
<, > 
Üd”_Squªt
;

3623 
m­
<, 
Q18_row
> 
»suÉ
;

3625 
gu¬d
< 
bË_sÿn_™”_im¶
<
lše™em_t
> > 
l_™”
;

3627 
bË_sÿn_™”_im¶
<
lše™em_t
>* 
tmp_l_™”
;

3628 
	`W_DO
(
_¶še™em_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_l_™”
));

3629 
l_™”
 = 
tmp_l_™”
;

3632 
ch_lše™em_tu¶e
 
®še
;

3633 
boŞ
 
eof
;

3635 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

3637 !
eof
) {

3638 
´lše™em
->
	`g‘_v®ue
(0, 
®še
.
L_ORDERKEY
);

3639 
´lše™em
->
	`g‘_v®ue
(4, 
®še
.
L_QUANTITY
);

3640 
m­
<,>::
™”©Ü
 
™”
 = 
Üd”_Squªt
.
	`fšd
Ğ
®še
.
L_ORDERKEY
);

3641 ifĞ
™”
 !ğ
Üd”_Squªt
.
	`’d
()){

3642 
c
 = 
™”
->
£cÚd
;

3643 
c
+ğ
®še
.
L_QUANTITY
;

3644 
Üd”_Squªt
[
®še
.
L_ORDERKEY
] = 
c
;

3646 
Üd”_Squªt
[
®še
.
L_ORDERKEY
] =‡lše.
L_QUANTITY
;

3648 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

3652 
tu¶e_gu¬d
<
Üd”s_mª_im¶
> 
	`´Üd”s
(
_pÜd”s_mª
);

3653 
tu¶e_gu¬d
<
cu¡om”_mª_im¶
> 
	`´cu¡om”
(
_pcu¡om”_mª
);

3655 
»p_row_t
 
	`Ü•row
(
_pcu¡om”_mª
->
	`ts
());

3656 
Ü•row
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

3658 
´Üd”s
->
_»p
 = &
Ü•row
;

3659 
´cu¡om”
->
_»p
 = &
Ü•row
;

3661 
»p_row_t
 
	`low»p
(
_pcu¡om”_mª
->
	`ts
());

3662 
»p_row_t
 
	`high»p
(
_pcu¡om”_mª
->
	`ts
());

3664 
low»p
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

3665 
high»p
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

3667 
m­
<,>::
™”©Ü
 
™
 = 
Üd”_Squªt
.
	`begš
();

3668 
™
 !ğ
Üd”_Squªt
.
	`’d
();

3669 
™
++){

3671 
ch_Üd”s_tu¶e
 
ªÜd”
;

3672 ifĞ
™
->
£cÚd
 > 
q18š
.
l_quªt™y
){

3673 
gu¬d
<
šdex_sÿn_™”_im¶
<
Üd”s_t
> > 
o_™”
;

3675 
šdex_sÿn_™”_im¶
<
Üd”s_t
>* 
tmp_o_™”
;

3676 
	`W_DO
(
_pÜd”s_mª
->
	`o_g‘_™”_by_šdex
(
_pssm
, 
tmp_o_™”
,

3677 
´Üd”s
, 
low»p
, 
high»p
,

3678 
™
->
fœ¡
));

3679 
o_™”
 = 
tmp_o_™”
;

3682 
boŞ
 
eof
;

3684 
	`W_DO
(
o_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Üd”s
));

3685 
´Üd”s
->
	`g‘_v®ue
(1, 
ªÜd”
.
O_CUSTKEY
);

3686 
´Üd”s
->
	`g‘_v®ue
(3, 
ªÜd”
.
O_TOTALPRICE
);

3687 
´Üd”s
->
	`g‘_v®ue
(4, 
ªÜd”
.
O_ORDERDATE
, 15);

3691 
time_t
 
the_Üd”d©e
 = 
	`¡r_to_tim‘
(
ªÜd”
.
O_ORDERDATE
);

3692 
ch_cu¡om”_tu¶e
 
acu¡om”
;

3693 
_pcu¡om”_mª
->
	`c_šdex_´obe
(
_pssm
, 
´cu¡om”
, 
ªÜd”
.
O_CUSTKEY
);

3694 
´cu¡om”
->
	`g‘_v®ue
(1, 
acu¡om”
.
C_NAME
, 25);

3695 
_pcu¡om”_mª
->
	`give_tu¶e
(
´cu¡om”
);

3696 
»suÉ
.
	`š£¹
(
·œ
<,
Q18_row
>(
™
->
fœ¡
,
	`Q18_row
(
acu¡om”
.
C_NAME
,

3697 
ªÜd”
.
O_CUSTKEY
,

3698 
the_Üd”d©e
,

3699 
ªÜd”
.
O_TOTALPRICE
)));

3702  
RCOK
;

3703 
	}
}

3713 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_q19
(cÚ¡ , 
q19_šput_t
& 
q19š
)

3716 
	`as£¹
 (
_pssm
);

3717 
	`as£¹
 (
_š™Ÿlized
);

3718 
	`as£¹
 (
_lßded
);

3721 
m­
<, > 
·¹key_b¿nd
;

3722 
»v’ue
 = 0;

3724 
tu¶e_gu¬d
<
·¹_mª_im¶
> 
	`´·¹
(
_µ¬t_mª
);

3726 
»p_row_t
 
	`´•row
(
_µ¬t_mª
->
	`ts
());

3727 
´•row
.
	`£t
(
_µ¬t_desc
->
	`maxsize
());

3729 
´·¹
->
_»p
 = &
´•row
;

3731 
gu¬d
<
bË_sÿn_™”_im¶
<
·¹_t
> > 
p_™”
;

3733 
bË_sÿn_™”_im¶
<
·¹_t
>* 
tmp_p_™”
;

3734 
	`W_DO
(
_µ¬t_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_p_™”
));

3735 
p_™”
 = 
tmp_p_™”
;

3738 
boŞ
 
eof
;

3739 
ch_·¹_tu¶e
 
­¬t
;

3741 
	`W_DO
(
p_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´·¹
));

3743 !
eof
){

3744 
size
;

3745 
´·¹
->
	`g‘_v®ue
(0, 
­¬t
.
P_PARTKEY
);

3746 
´·¹
->
	`g‘_v®ue
(3, 
­¬t
.
P_BRAND
, 10);

3747 
´·¹
->
	`g‘_v®ue
(5, 
size
 );

3748 
´·¹
->
	`g‘_v®ue
(6, 
­¬t
.
P_CONTAINER
, 10);

3749 
b¿nd
 = 
	`¡r_to_B¿nd
Ğ
­¬t
.
P_BRAND
 );

3750 ifĞ
b¿nd
 =ğ
q19š
.
p_b¿nd
[0] &&

3751 Ğ
	`¡rcmp
Ğ
­¬t
.
P_CONTAINER
, "SM CASE") == 0 ||

3752 
	`¡rcmp
Ğ
­¬t
.
P_CONTAINER
, "SM BOX") == 0 ||

3753 
	`¡rcmp
Ğ
­¬t
.
P_CONTAINER
, "SM PACK") == 0 ||

3754 
	`¡rcmp
Ğ
­¬t
.
P_CONTAINER
, "SM PKG") == 0 ) &&

3755 
size
 > 1 && size < 5 ){

3756 
·¹key_b¿nd
.
	`š£¹
Ğ
·œ
<,>(
­¬t
.
P_PARTKEY
, 1));

3757 } ifĞ
b¿nd
 =ğ
q19š
.
p_b¿nd
[1] &&

3758 Ğ
	`¡rcmp
Ğ
­¬t
.
P_CONTAINER
, "MED BAG") ||

3759 
	`¡rcmp
Ğ
­¬t
.
P_CONTAINER
, "MED BOX") ||

3760 
	`¡rcmp
Ğ
­¬t
.
P_CONTAINER
, "MED PKG") ||

3761 
	`¡rcmp
Ğ
­¬t
.
P_CONTAINER
, "MED PACK") ) &&

3762 
size
 > 1 && size < 10){

3763 
·¹key_b¿nd
.
	`š£¹
Ğ
·œ
<,> (
­¬t
.
P_PARTKEY
, 2));

3764 } ifĞ
b¿nd
 =ğ
q19š
.
p_b¿nd
[2] &&

3765 Ğ
	`¡rcmp
Ğ
­¬t
.
P_CONTAINER
, "MED BAG") ||

3766 
	`¡rcmp
Ğ
­¬t
.
P_CONTAINER
, "MED BAG") ||

3767 
	`¡rcmp
Ğ
­¬t
.
P_CONTAINER
, "MED BAG") ||

3768 
	`¡rcmp
Ğ
­¬t
.
P_CONTAINER
, "MED BAG") ) &&

3769 
size
 > 1 && size < 15 ){

3770 
·¹key_b¿nd
.
	`š£¹
Ğ
·œ
<,> (
­¬t
.
P_PARTKEY
, 3));

3772 
	`W_DO
(
p_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´·¹
));

3776 
tu¶e_gu¬d
<
lše™em_mª_im¶
> 
	`´lše™em
(
_¶še™em_mª
);

3778 
»p_row_t
 
	`Ì•row
(
_¶še™em_mª
->
	`ts
());

3779 
Ì•row
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

3781 
´lše™em
->
_»p
 = &
Ì•row
;

3783 
gu¬d
< 
bË_sÿn_™”_im¶
<
lše™em_t
> > 
l_™”
;

3785 
bË_sÿn_™”_im¶
<
lše™em_t
>* 
tmp_l_™”
;

3786 
	`W_DO
(
_¶še™em_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_l_™”
));

3787 
l_™”
 = 
tmp_l_™”
;

3790 
ch_lše™em_tu¶e
 
®še
;

3792 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

3794 !
eof
) {

3795 
´lše™em
->
	`g‘_v®ue
(1, 
®še
.
L_PARTKEY
);

3796 
´lše™em
->
	`g‘_v®ue
(4, 
®še
.
L_QUANTITY
);

3797 
´lše™em
->
	`g‘_v®ue
(5, 
®še
.
L_EXTENDEDPRICE
);

3798 
´lše™em
->
	`g‘_v®ue
(6, 
®še
.
L_DISCOUNT
);

3799 
´lše™em
->
	`g‘_v®ue
(13, 
®še
.
L_SHIPINSTRUCT
, 25);

3800 
´lše™em
->
	`g‘_v®ue
(14, 
®še
.
L_SHIPMODE
, 10);

3801 
m­
<,>::
™”©Ü
 
™”
 = 
·¹key_b¿nd
.
	`fšd
Ğ
®še
.
L_PARTKEY
 );

3802 if(
™”
 !ğ
·¹key_b¿nd
.
	`’d
() &&

3803 Ğ
	`¡rcmp
Ğ
®še
.
L_SHIPMODE
, "AIR") == 0 ||

3804 
	`¡rcmp
Ğ
®še
.
L_SHIPMODE
, "AIR REG") == 0 ) &&

3805 
	`¡rcmp
Ğ
®še
.
L_SHIPINSTRUCT
, "DELIVER IN PERSON") == 0 &&

3806 
®še
.
L_QUANTITY
 >ğ
q19š
.
l_quªt™y
[
™”
->
£cÚd
-1] &&

3807 
®še
.
L_QUANTITY
 <ğ
q19š
.
l_quªt™y
[
™”
->
£cÚd
-1] + 10 ){

3808 
»v’ue
 +ğ
®še
.
L_EXTENDEDPRICE
 * ( 1 -‡lše.
L_DISCOUNT
 );

3810 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

3813  
RCOK
;

3814 
	}
}

3824 
	sšt_·œ_cmp
 {

3825 
boŞ
 
İ”©Ü
()ĞcÚ¡ 
	m·œ
<,>& 
	mr1
, cÚ¡…aœ<,>& 
	mr2
 ) const {

3826  (
	mr1
.
	mfœ¡
 < 
	mr2
.fœ¡ || („1.fœ¡ =ğ
r2
.
fœ¡
 && 
r1
.
£cÚd
 <„2.second)) ;

3831 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_q20
(cÚ¡ , 
q20_šput_t
& 
q20š
)

3834 
	`as£¹
 (
_pssm
);

3835 
	`as£¹
 (
_š™Ÿlized
);

3836 
	`as£¹
 (
_lßded
);

3838 
p_Çme
[55];

3839 
	`²ame_to_¡r
(
q20š
.
p_cŞÜ
, 
p_Çme
);

3842 
m­
<,
boŞ
> 
·¹key
;

3844 
tu¶e_gu¬d
<
·¹_mª_im¶
> 
	`´·¹
(
_µ¬t_mª
);

3846 
»p_row_t
 
	`´•row
(
_µ¬t_mª
->
	`ts
());

3847 
´•row
.
	`£t
(
_µ¬t_desc
->
	`maxsize
());

3849 
´·¹
->
_»p
 = &
´•row
;

3851 
gu¬d
<
bË_sÿn_™”_im¶
<
·¹_t
> > 
p_™”
;

3853 
bË_sÿn_™”_im¶
<
·¹_t
>* 
tmp_p_™”
;

3854 
	`W_DO
(
_µ¬t_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_p_™”
));

3855 
p_™”
 = 
tmp_p_™”
;

3858 
boŞ
 
eof
;

3859 
ch_·¹_tu¶e
 
­¬t
;

3861 
	`W_DO
(
p_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´·¹
));

3863 !
eof
){

3864 
´·¹
->
	`g‘_v®ue
(0, 
­¬t
.
P_PARTKEY
);

3865 
´·¹
->
	`g‘_v®ue
(1, 
­¬t
.
P_NAME
, 55);

3866 * 
s1
 = 
	`¡¹ok
(
­¬t
.
P_NAME
, " ");

3867 ifĞ
	`¡rcmp
Ğ
s1
, 
p_Çme
) == 0 ) {

3868 
·¹key
.
	`š£¹
(
·œ
<, 
boŞ
> (
­¬t
.
P_PARTKEY
, 1));

3870 
	`W_DO
(
p_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´·¹
));

3874 
m­
<
·œ
<,>,…aœ<,>, 
št_·œ_cmp
> 
suµ·¹_avquªt_sumquªt
;

3876 
tu¶e_gu¬d
<
·¹suµ_mª_im¶
> 
	`´·¹suµ
(
_µ¬tsuµ_mª
);

3878 
»p_row_t
 
	`p¤•row
(
_µ¬tsuµ_mª
->
	`ts
());

3879 
p¤•row
.
	`£t
(
_µ¬tsuµ_desc
->
	`maxsize
());

3881 
´·¹suµ
->
_»p
 = &
p¤•row
;

3883 
gu¬d
<
bË_sÿn_™”_im¶
<
·¹suµ_t
> > 
ps_™”
;

3885 
bË_sÿn_™”_im¶
<
·¹suµ_t
>* 
tmp_ps_™”
;

3886 
	`W_DO
(
_µ¬tsuµ_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_ps_™”
));

3887 
ps_™”
 = 
tmp_ps_™”
;

3890 
ch_·¹suµ_tu¶e
 
­¬tsuµ
;

3892 
	`W_DO
(
ps_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´·¹suµ
));

3894 !
eof
){

3895 
´·¹suµ
->
	`g‘_v®ue
(0, 
­¬tsuµ
.
PS_PARTKEY
);

3896 
´·¹suµ
->
	`g‘_v®ue
(1, 
­¬tsuµ
.
PS_SUPPKEY
);

3897 
´·¹suµ
->
	`g‘_v®ue
(2, 
­¬tsuµ
.
PS_AVAILQTY
);

3898 ifĞ
·¹key
.
	`fšd
(
­¬tsuµ
.
PS_PARTKEY
è!ğ·¹key.
	`’d
() ){

3899 
·œ
<…aœ <, >,·œ<,> > 
tmp


3900 (
·œ
<,>Ğ
­¬tsuµ
.
PS_SUPPKEY
,‡partsupp.PS_SUPPKEY),

3901 
·œ
<,>Ğ
­¬tsuµ
.
PS_AVAILQTY
, 0) );

3902 
suµ·¹_avquªt_sumquªt
.
	`š£¹
(
tmp
);

3904 
	`W_DO
(
ps_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´·¹suµ
));

3908 
tu¶e_gu¬d
<
lše™em_mª_im¶
> 
	`´lše™em
(
_¶še™em_mª
);

3910 
»p_row_t
 
	`Ì•row
(
_¶še™em_mª
->
	`ts
());

3911 
Ì•row
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

3913 
´lše™em
->
_»p
 = &
Ì•row
;

3915 
»p_row_t
 
	`low»p
(
_¶še™em_mª
->
	`ts
());

3916 
»p_row_t
 
	`high»p
(
_¶še™em_mª
->
	`ts
());

3918 
low»p
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

3919 
high»p
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

3921 
tm
 
d©e
;

3922 ià(
	`gmtime_r
(&(
q20š
.
l_shd©e
), &
d©e
è=ğ
NULL
) {

3923  
RCOK
;

3925 
d©e
.
tm_y—r
 ++;

3926 
time_t
 
Ï¡_shd©e
 = 
	`mktime
(&
d©e
);

3928 
gu¬d
< 
šdex_sÿn_™”_im¶
<
lše™em_t
> > 
l_™”
;

3930 
šdex_sÿn_™”_im¶
<
lše™em_t
>* 
tmp_l_™”
;

3931 
	`W_DO
(
_¶še™em_mª
->
	`l_g‘_¿nge_™”_by_šdex
(
_pssm
, 
tmp_l_™”
,

3932 
´lše™em
, 
low»p
,

3933 
high»p
, 
q20š
.
l_shd©e
,

3934 
Ï¡_shd©e
));

3935 
l_™”
 = 
tmp_l_™”
;

3938 
ch_lše™em_tu¶e
 
®še
;

3939 
q6_»suÉ
 = 0;

3941 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

3943 !
eof
) {

3944 
´lše™em
->
	`g‘_v®ue
(1, 
®še
.
L_PARTKEY
);

3945 
´lše™em
->
	`g‘_v®ue
(2, 
®še
.
L_SUPPKEY
);

3946 
´lše™em
->
	`g‘_v®ue
(4, 
®še
.
L_QUANTITY
);

3947 
m­
< 
·œ
<,>,…aœ<,>, 
št_·œ_cmp
 >::
™”©Ü
 
™
 =

3948 
suµ·¹_avquªt_sumquªt
.
	`fšd
(
·œ
<,>

3949 (
®še
.
L_PARTKEY
,‡lše.
L_SUPPKEY
));

3950 ifĞ
™
 !ğ
suµ·¹_avquªt_sumquªt
.
	`’d
()){

3951 
c
 = 
™
->
£cÚd
.second;

3952 
c
+ğ
®še
.
L_QUANTITY
;

3953 
suµ·¹_avquªt_sumquªt
[ 
·œ
<,>(
®še
.
L_PARTKEY
,

3954 
®še
.
L_SUPPKEY
)]=

3955 
·œ
<,>Ğ
™
->
£cÚd
.
fœ¡
, 
c
);

3957 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

3961 
m­
<, 
boŞ
> 
suµkey
;

3962 
m­
< 
·œ
<,>,…aœ<, > > :: 
™”©Ü
 
™
 =

3963 
suµ·¹_avquªt_sumquªt
.
	`begš
();

3964  
™
 !ğ
suµ·¹_avquªt_sumquªt
.
	`’d
()){

3965 ifĞ
™
->
£cÚd
.
fœ¡
 > .5 * it->second.second ){

3966 
suµkey
.
	`š£¹
Ğ
·œ
<,
boŞ
>(
™
->
fœ¡
.fœ¡, 
Œue
));

3968 
™
++;

3975 
tu¶e_gu¬d
<
suµl›r_mª_im¶
> 
	`´suµ
(
_psuµl›r_mª
);

3977 
»p_row_t
 
	`¤•row
(
_psuµl›r_mª
->
	`ts
());

3978 
¤•row
.
	`£t
(
_psuµl›r_desc
->
	`maxsize
());

3980 
´suµ
->
_»p
 = &
¤•row
;

3982 
m­
<,
boŞ
>::
™”©Ü
 
™”
 = 
suµkey
.
	`begš
();

3983 
™”
 !ğ
suµkey
.
	`’d
();

3984 
™”
++){

3985 
_psuµl›r_mª
->
	`s_šdex_´obe
(
_pssm
, 
´suµ
, 
™”
->
fœ¡
);

3986 
ch_suµl›r_tu¶e
 
asuµ
;

3987 
´suµ
->
	`g‘_v®ue
(1, 
asuµ
.
S_NAME
, 25);

3988 
´suµ
->
	`g‘_v®ue
(2, 
asuµ
.
S_ADDRESS
, 40);

3989 
´suµ
->
	`g‘_v®ue
(3, 
asuµ
.
S_NATIONKEY
);

3990 if(
asuµ
.
S_NATIONKEY
 =ğ
q20š
.
n_Çme
){

3995  
RCOK
;

3996 
	}
}

4006 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_q21
(cÚ¡ , 
q21_šput_t
& 
q21š
)

4009 
	`as£¹
 (
_pssm
);

4010 
	`as£¹
 (
_š™Ÿlized
);

4011 
	`as£¹
 (
_lßded
);

4014 
m­
<, 
¡ršg
> 
suµkey
;

4016 
tu¶e_gu¬d
<
suµl›r_mª_im¶
> 
	`´suµ
(
_psuµl›r_mª
);

4018 
»p_row_t
 
	`¤•row
(
_psuµl›r_mª
->
	`ts
());

4019 
¤•row
.
	`£t
(
_psuµl›r_desc
->
	`maxsize
());

4021 
´suµ
->
_»p
 = &
¤•row
;

4023 
gu¬d
<
bË_sÿn_™”_im¶
<
suµl›r_t
> > 
s_™”
;

4025 
bË_sÿn_™”_im¶
<
suµl›r_t
>* 
tmp_s_™”
;

4026 
	`W_DO
(
_psuµl›r_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_s_™”
));

4027 
s_™”
 = 
tmp_s_™”
;

4030 
boŞ
 
eof
;

4031 
ch_suµl›r_tu¶e
 
asuµl›r
;

4033 
	`W_DO
(
s_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´suµ
));

4035 !
eof
){

4036 
´suµ
->
	`g‘_v®ue
(0, 
asuµl›r
.
S_SUPPKEY
);

4037 
´suµ
->
	`g‘_v®ue
(1, 
asuµl›r
.
S_NAME
,25);

4038 
´suµ
->
	`g‘_v®ue
(3, 
asuµl›r
.
S_NATIONKEY
);

4039 ifĞ
asuµl›r
.
S_NATIONKEY
 =ğ
q21š
.
n_Çme
){

4040 
suµkey
.
	`š£¹
(
·œ
<,
¡ršg
>

4041 Ğ
asuµl›r
.
S_SUPPKEY
, 
	`¡ršg
×suµl›r.
S_NAME
)));

4043 
	`W_DO
(
s_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´suµ
));

4047 
m­
<,
boŞ
> 
Üd”key
;

4049 
tu¶e_gu¬d
<
Üd”s_mª_im¶
> 
	`´Üd”
(
_pÜd”s_mª
);

4051 
»p_row_t
 
	`o_¬•row
(
_pÜd”s_mª
->
	`ts
());

4052 
o_¬•row
.
	`£t
(
_pÜd”s_desc
->
	`maxsize
());

4054 
´Üd”
->
_»p
 = &
o_¬•row
;

4056 
gu¬d
< 
bË_sÿn_™”_im¶
<
Üd”s_t
> > 
o_™”
;

4058 
bË_sÿn_™”_im¶
<
Üd”s_t
>* 
tmp_o_™”
;

4059 
	`W_DO
(
_pÜd”s_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_o_™”
));

4060 
o_™”
 = 
tmp_o_™”
;

4063 
ch_Üd”s_tu¶e
 
ªÜd”
;

4065 
	`W_DO
(
o_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Üd”
));

4067 !
eof
){

4068 
´Üd”
->
	`g‘_v®ue
(0, 
ªÜd”
.
O_ORDERKEY
);

4069 
´Üd”
->
	`g‘_v®ue
(2, 
ªÜd”
.
O_ORDERSTATUS
);

4070 ifĞ
ªÜd”
.
O_ORDERSTATUS
 == 'F' ) {

4071 
Üd”key
.
	`š£¹
Ğ
·œ
 <,
boŞ
> (
ªÜd”
.
O_ORDERKEY
, 
Œue
) );

4073 
	`W_DO
(
o_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Üd”
));

4077 
veùÜ
<
·œ
<,> > 
suµkey_Üd”key
;

4078 
m­
<,> 
muÉiOrd”s
;

4079 
m­
<,> 
d–ay2Üd”
;

4081 
tu¶e_gu¬d
<
lše™em_mª_im¶
> 
	`´lše™em
(
_¶še™em_mª
);

4083 
»p_row_t
 
	`¬•row2
(
_¶še™em_mª
->
	`ts
());

4084 
¬•row2
.
	`£t
(
_¶še™em_desc
->
	`maxsize
());

4086 
´lše™em
->
_»p
 = &
¬•row2
;

4088 
gu¬d
< 
bË_sÿn_™”_im¶
<
lše™em_t
> > 
l_™”
;

4090 
bË_sÿn_™”_im¶
<
lše™em_t
>* 
tmp_l_™”
;

4091 
	`W_DO
(
_¶še™em_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_l_™”
));

4092 
l_™”
 = 
tmp_l_™”
;

4095 
ch_lše™em_tu¶e
 
®še
;

4097 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

4099 !
eof
) {

4100 
´lše™em
->
	`g‘_v®ue
(0, 
®še
.
L_ORDERKEY
);

4101 
´lše™em
->
	`g‘_v®ue
(2, 
®še
.
L_SUPPKEY
);

4102 
´lše™em
->
	`g‘_v®ue
(11, 
®še
.
L_COMMITDATE
, 15);

4103 
´lše™em
->
	`g‘_v®ue
(12, 
®še
.
L_RECEIPTDATE
, 15);

4104 
time_t
 
the_comm™d©e
 = 
	`¡r_to_tim‘
(
®še
.
L_COMMITDATE
);

4105 
time_t
 
the_»ûtd©e
 = 
	`¡r_to_tim‘
(
®še
.
L_RECEIPTDATE
);

4106 ifĞ
Üd”key
.
	`fšd
(
®še
.
L_ORDERKEY
è!ğÜd”key.
	`’d
()){

4107 ià(
the_comm™d©e
 < 
the_»ûtd©e
 &&

4108 
suµkey
.
	`fšd
(
®še
.
L_SUPPKEY
è!ğsuµkey.
	`’d
()){

4109 
suµkey_Üd”key
.
	`push_back
(
·œ
<,>

4110 (
®še
.
L_SUPPKEY
,‡lše.
L_ORDERKEY
));

4111 
m­
<,>::
™”©Ü
 
™
 = 
d–ay2Üd”
.
	`fšd
(
®še
.
L_ORDERKEY
);

4112 ià(
™
 !ğ
d–ay2Üd”
.
	`’d
(è&& it->
£cÚd
 !ğ
®še
.
L_SUPPKEY
){

4113 
d–ay2Üd”
[
™
->
fœ¡
] = -1;

4115 
d–ay2Üd”
[
™
->
fœ¡
] = 
®še
.
L_SUPPKEY
;

4118 
m­
<,>::
™”©Ü
 
™
 = 
muÉiOrd”s
.
	`fšd
(
®še
.
L_ORDERKEY
);

4119 ià(
™
 !ğ
muÉiOrd”s
.
	`’d
(è&& it->
£cÚd
 !ğ
®še
.
L_SUPPKEY
){

4120 
muÉiOrd”s
[
™
->
fœ¡
] = -1;

4122 
muÉiOrd”s
[
™
->
fœ¡
] = 
®še
.
L_SUPPKEY
;

4125 
	`W_DO
(
l_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´lše™em
));

4129 
m­
<,> 
supK_numwa™
;

4130 
i
 = 0; i < 
suµkey_Üd”key
.
	`size
(); i++){

4131 ifĞ
muÉiOrd”s
[
suµkey_Üd”key
[
i
].
£cÚd
] == -1 &&

4132 
d–ay2Üd”
[
suµkey_Üd”key
[
i
].
£cÚd
] != -1) {

4133 if(
supK_numwa™
.
	`fšd
(
suµkey_Üd”key
[
i
].
fœ¡
)!=supK_numwa™.
	`’d
()){

4134 
n
 = 
supK_numwa™
.
	`fšd
(
suµkey_Üd”key
[
i
].
fœ¡
)->
£cÚd
;

4135 
n
++;

4136 
supK_numwa™
[
suµkey_Üd”key
[
i
].
fœ¡
] = 
n
;

4138 
supK_numwa™
[
suµkey_Üd”key
[
i
].
fœ¡
] = 1;

4143  
RCOK
;

4144 
	}
}

4154 
w_rc_t
 
	gShÜeTPCHEnv
::
	$xù_q22
(cÚ¡ , 
q22_šput_t
& 
q22š
)

4157 
	`as£¹
 (
_pssm
);

4158 
	`as£¹
 (
_š™Ÿlized
);

4159 
	`as£¹
 (
_lßded
);

4162 
m­
<, 
·œ
<
decim®
,> > 
ckey_acb®Ccode
;

4163 
decim®
 
b®_avg
 = 0;

4165 
tu¶e_gu¬d
<
cu¡om”_mª_im¶
> 
	`´cu¡om”
(
_pcu¡om”_mª
);

4167 
»p_row_t
 
	`¬•row
(
_pcu¡om”_mª
->
	`ts
());

4168 
¬•row
.
	`£t
(
_pcu¡om”_desc
->
	`maxsize
());

4170 
´cu¡om”
->
_»p
 = &
¬•row
;

4172 
gu¬d
< 
bË_sÿn_™”_im¶
<
cu¡om”_t
> > 
c_™”
;

4174 
bË_sÿn_™”_im¶
<
cu¡om”_t
>* 
tmp_c_™”
;

4175 
	`W_DO
(
_pcu¡om”_mª
->
	`g‘_™”_fÜ_fe_sÿn
(
_pssm
, 
tmp_c_™”
));

4176 
c_™”
 = 
tmp_c_™”
;

4179 
boŞ
 
eof
;

4180 
ch_cu¡om”_tu¶e
 
acu¡
;

4182 
	`W_DO
(
c_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cu¡om”
));

4184 !
eof
){

4185 
´cu¡om”
->
	`g‘_v®ue
(0, 
acu¡
.
C_CUSTKEY
);

4186 
´cu¡om”
->
	`g‘_v®ue
(4, 
acu¡
.
C_PHONE
, 15);

4187 
´cu¡om”
->
	`g‘_v®ue
(5, 
acu¡
.
C_ACCTBAL
);

4188 * 
c_úŒycode_¡r
 = 
	`¡¹ok
 ( 
acu¡
.
C_PHONE
, "-" );

4189 
c_úŒycode
 = 
	`©oi
Ğ
c_úŒycode_¡r
);

4190 
i
 = 0; i < 7; i++ ){

4191 ifĞ
q22š
.
úŒycode
[
i
] =ğ
c_úŒycode
){

4192 
ckey_acb®Ccode
.
	`š£¹
Ğ
·œ
<,…aœ<
decim®
,> >

4193 (
acu¡
.
C_CUSTKEY
, 
·œ
<
decim®
,>

4194 (
acu¡
.
C_ACCTBAL
, 
c_úŒycode
)));

4195 
b®_avg
 +ğ
acu¡
.
C_ACCTBAL
;

4199 
	`W_DO
(
c_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´cu¡om”
));

4202 
b®_avg
 /ğ()
ckey_acb®Ccode
.
	`size
();

4206 
m­
<, 
·œ
<, 
decim®
> > 
úŒycode_sÿÏrs
;

4208 
tu¶e_gu¬d
<
Üd”s_mª_im¶
> 
	`´Üd”s
(
_pÜd”s_mª
);

4210 
»p_row_t
 
	`aÜ•row
(
_pÜd”s_mª
->
	`ts
());

4211 
aÜ•row
.
	`£t
(
_pÜd”s_desc
->
	`maxsize
());

4213 
´Üd”s
->
_»p
 = & 
aÜ•row
;

4215 
»p_row_t
 
	`low»p
(
_pÜd”s_mª
->
	`ts
());

4216 
»p_row_t
 
	`high»p
(
_pÜd”s_mª
->
	`ts
());

4218 
low»p
.
	`£t
(
_pÜd”s_desc
->
	`maxsize
());

4219 
high»p
.
	`£t
(
_pÜd”s_desc
->
	`maxsize
());

4221 
m­
<, 
·œ
<
decim®
,> >::
™”©Ü
 
™
 = 
ckey_acb®Ccode
.
	`begš
();

4222 
™
 !ğ
ckey_acb®Ccode
.
	`’d
()){

4223 
gu¬d
<
šdex_sÿn_™”_im¶
<
Üd”s_t
> > 
o_™”
;

4225 
šdex_sÿn_™”_im¶
<
Üd”s_t
>* 
tmp_o_™”
;

4226 
	`W_DO
(
_pÜd”s_mª
->
	`o_g‘_™”_by_fšdex
(
_pssm
, 
tmp_o_™”
, 
´Üd”s
,

4227 
low»p
, 
high»p
, 
™
->
fœ¡
));

4228 
o_™”
 = 
tmp_o_™”
;

4231 
boŞ
 
eof
;

4232 
	`W_DO
(
o_™”
->
	`Ãxt
(
_pssm
, 
eof
, *
´Üd”s
));

4234 if(!
eof
 && 
™
->
£cÚd
.
fœ¡
 > 
b®_avg
){

4235 
m­
<, 
·œ
<,
decim®
> >::
™”©Ü
 
tmp
 =

4236 
úŒycode_sÿÏrs
.
	`fšd
Ğ
™
->
£cÚd
.second);

4237 if(
tmp
 !ğ
úŒycode_sÿÏrs
.
	`’d
()){

4238 
c
 = 
tmp
->
£cÚd
.
fœ¡
;

4239 
decim®
 
t
 = 
tmp
->
£cÚd
.second;

4240 
c
++;

4241 
t
+ğ
™
->
£cÚd
.
fœ¡
;

4242 
úŒycode_sÿÏrs
[
™
->
£cÚd
.£cÚd] = 
·œ
<, 
decim®
> (
c
, 
t
);

4244 
úŒycode_sÿÏrs
[
™
->
£cÚd
.£cÚd] = 
·œ
<, 
decim®
>

4245 (1, 
™
->
£cÚd
.
fœ¡
);

4248 
™
++;

4251  
RCOK
;

4252 
	}
}

4255 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/tpch_input.cpp

34 
	~"ut.h
"

35 
	~"wÜklßd/ch/ch_¿ndom.h
"

36 
	~"wÜklßd/ch/ch_šput.h
"

38 
	~"wÜklßd/ch/dbg’/dss.h
"

39 
	~"wÜklßd/ch/dbg’/ds¡y³s.h
"

40 
	~"wÜklßd/ch/ch_ut.h
"

42 
usšg
 
Çme¥aû
 
	gdbg’ch
;

44 
ENTER_NAMESPACE
(
ch
);

47 
	gqlše™em_šput_t
& qlše™em_šput_t::
İ”©Ü
=(cÚ¡ 
qlše™em_šput_t
& 
rhs
){
dummy
ôhs.dummy;  (*
	gthis
);}

48 
qlše™em_šput_t
 
	$ü—‹_qlše™em_šput
(cÚ¡ 
sf
,

49 cÚ¡ 
¥ecificWH
){
qlše™em_šput_t
 
r
;r.
dummy
=0;„;
	}
}

51 
	gqÜd”s_šput_t
& qÜd”s_šput_t::
İ”©Ü
=(cÚ¡ 
qÜd”s_šput_t
& 
rhs
){
dummy
ôhs.dummy;  (*
	gthis
);}

52 
qÜd”s_šput_t
 
	$ü—‹_qÜd”s_šput
(cÚ¡ 
sf
,

53 cÚ¡ 
¥ecificWH
){
qÜd”s_šput_t
 
r
;r.
dummy
=0;„;
	}
}

55 
	gqÇtiÚ_šput_t
& qÇtiÚ_šput_t::
İ”©Ü
=(cÚ¡ 
qÇtiÚ_šput_t
& 
rhs
){
dummy
ôhs.dummy;  (*
	gthis
);}

56 
qÇtiÚ_šput_t
 
	$ü—‹_qÇtiÚ_šput
(cÚ¡ 
sf
,

57 cÚ¡ 
¥ecificWH
){
qÇtiÚ_šput_t
 
r
;r.
dummy
=0;„;
	}
}

59 
	gq»giÚ_šput_t
& q»giÚ_šput_t::
İ”©Ü
=(cÚ¡ 
q»giÚ_šput_t
& 
rhs
){
dummy
ôhs.dummy;  (*
	gthis
);}

60 
q»giÚ_šput_t
 
	$ü—‹_q»giÚ_šput
(cÚ¡ 
sf
,

61 cÚ¡ 
¥ecificWH
 ){
q»giÚ_šput_t
 
r
;r.
dummy
=0;„;
	}
}

63 
	gqsuµl›r_šput_t
& qsuµl›r_šput_t::
İ”©Ü
=(cÚ¡ 
qsuµl›r_šput_t
& 
rhs
){
dummy
ôhs.dummy;  (*
	gthis
);}

64 
qsuµl›r_šput_t
 
	$ü—‹_qsuµl›r_šput
(cÚ¡ 
sf
,

65 cÚ¡ 
¥ecificWH
){
qsuµl›r_šput_t
 
r
;r.
dummy
=0;„;
	}
}

67 
	gq·¹_šput_t
& q·¹_šput_t::
İ”©Ü
=(cÚ¡ 
q·¹_šput_t
& 
rhs
){
dummy
ôhs.dummy;  (*
	gthis
);}

68 
q·¹_šput_t
 
	$ü—‹_q·¹_šput
(cÚ¡ 
sf
,

69 cÚ¡ 
¥ecificWH
){
q·¹_šput_t
 
r
;r.
dummy
=0;„;
	}
}

71 
	gq·¹suµ_šput_t
& q·¹suµ_šput_t::
İ”©Ü
=(cÚ¡ 
q·¹suµ_šput_t
& 
rhs
){
dummy
ôhs.dummy;  (*
	gthis
);}

72 
q·¹suµ_šput_t
 
	$ü—‹_q·¹suµ_šput
(cÚ¡ 
sf
,

73 cÚ¡ 
¥ecificWH
){
q·¹suµ_šput_t
 
r
;r.
dummy
=0;„;
	}
}

75 
	gqcu¡om”_šput_t
& qcu¡om”_šput_t::
İ”©Ü
=(cÚ¡ 
qcu¡om”_šput_t
& 
rhs
){
dummy
ôhs.dummy;  (*
	gthis
);}

76 
qcu¡om”_šput_t
 
	$ü—‹_qcu¡om”_šput
(cÚ¡ 
sf
,

77 cÚ¡ 
¥ecificWH
){
qcu¡om”_šput_t
 
r
;r.
dummy
=0;„;
	}
}

87 
	gq1_šput_t
& q1_šput_t::
İ”©Ü
=(cÚ¡ 
q1_šput_t
& 
rhs
)

89 
l_shd©e
 = 
rhs
.l_shipdate;

90  (*
	gthis
);

94 
q1_šput_t
 
	$ü—‹_q1_šput
(const ,

97 
q1_šput_t
 
q1_šput
;

99 
tm
 
shd©e
;

101 
shd©e
.
tm_y—r
 = 98;

102 
shd©e
.
tm_mÚ
 = 11;

103 
shd©e
.
tm_mday
 = 1-
	`URªd
(60, 120);

104 
shd©e
.
tm_hour
 = 0;

105 
shd©e
.
tm_mš
 = 0;

106 
shd©e
.
tm_£c
 = 0;

110 
q1_šput
.
l_shd©e
 = 
	`mktime
(&
shd©e
);

112  (
q1_šput
);

113 
	}
};

120 
	gq2_šput_t
& q2_šput_t::
İ”©Ü
=(cÚ¡ 
q2_šput_t
& 
rhs
){

122 
p_size
 = 
rhs
.p_size;

123 
	gp_ty³s3
 = 
rhs
.
p_ty³s3
;

124 
	gr_Çme
 = 
rhs
.
r_Çme
;

126  (*
	gthis
);

129 
q2_šput_t
 
	$ü—‹_q2_šput
(const ,

131 
q2_šput_t
 
q2_šput
;

133 
q2_šput
.
p_size
 = 
	`URªd
(1,50);

134 
q2_šput
.
r_Çme
 = 
	`URªd
(0,
END_R_NAME
-1);

135 
q2_šput
.
p_ty³s3
 = 
	`URªd
(0,
END_TYPE_S3
-1);

141  (
q2_šput
);

142 
	}
};

151 
	gq3_šput_t
& q3_šput_t::
İ”©Ü
=(cÚ¡ 
q3_šput_t
& 
rhs
){

153 
cu¼’t_d©e
 = 
rhs
.current_date;

154 
	gc_£gm’t
 = 
rhs
.
c_£gm’t
;

156  (*
	gthis
);

160 
q3_šput_t
 
	$ü—‹_q3_šput
(cÚ¡ 
sf
, cÚ¡ 
¥ecificWH
){

162 
q3_šput_t
 
q3š
;

164 
q3š
.
c_£gm’t
 = 
	`URªd
(0, 
END_SEGMENT
-1);

166 
tm
 
d©e
;

167 
d©e
.
tm_y—r
 = 95;

168 
d©e
.
tm_mÚ
 = 2;

169 
d©e
.
tm_mday
 = 
	`URªd
(1,31);

171 
d©e
.
tm_£c
 = 0;

172 
d©e
.
tm_mš
 = 0;

173 
d©e
.
tm_hour
 = 0;

175 
q3š
.
cu¼’t_d©e
 = 
	`mktime
(&
d©e
);

192  
q3š
;

194 
	}
}

204 
	gq4_šput_t
& q4_šput_t::
İ”©Ü
=(cÚ¡ 
q4_šput_t
& 
rhs
)

206 
o_Üd”d©e
 = 
rhs
.o_orderdate;

207  (*
	gthis
);

211 
q4_šput_t
 
	$ü—‹_q4_šput
(const ,

214 
q4_šput_t
 
q4_šput
;

216 
tm
 
Üd”d©e
;

218 
mÚth
=
	`URªd
(0,57);

219 
y—r
=
mÚth
/12;

220 
mÚth
=month%12;

222 
Üd”d©e
.
tm_y—r
 = 93+
y—r
;

223 
Üd”d©e
.
tm_mÚ
 = 
mÚth
;

224 
Üd”d©e
.
tm_mday
 = 1;

225 
Üd”d©e
.
tm_hour
 = 0;

226 
Üd”d©e
.
tm_mš
 = 0;

227 
Üd”d©e
.
tm_£c
 = 0;

241 
q4_šput
.
o_Üd”d©e
 = 
	`mktime
(&
Üd”d©e
);

243  (
q4_šput
);

244 
	}
};

252 
	gq5_šput_t
& q5_šput_t::
İ”©Ü
=(cÚ¡ 
q5_šput_t
& 
rhs
){

254 
r_Çme
 = 
rhs
.r_name;

255 
	go_Üd”d©e
 = 
rhs
.
o_Üd”d©e
;

257  (*
	gthis
);

261 
q5_šput_t
 
	$ü—‹_q5_šput
(const , const ) {

263 
q5_šput_t
 
q5š
;

265 
q5š
.
r_Çme
 = 
	`URªd
(0, 
END_R_NAME
-1);

267 
tm
 
Üd”d©e
;

269 
Üd”d©e
.
tm_y—r
 = 
	`URªd
(93, 97);

270 
Üd”d©e
.
tm_mÚ
 = 0;

271 
Üd”d©e
.
tm_mday
 = 1;

272 
Üd”d©e
.
tm_hour
 = 0;

273 
Üd”d©e
.
tm_mš
 = 0;

274 
Üd”d©e
.
tm_£c
 = 0;

276 
q5š
.
o_Üd”d©e
 = 
	`mktime
(&
Üd”d©e
);

289 
q5š
.
o_Üd”d©e
 = 
	`mktime
(&
Üd”d©e
);

292  (
q5š
);

293 
	}
};

301 
	gq6_šput_t
& q6_šput_t::
İ”©Ü
=(cÚ¡ 
q6_šput_t
& 
rhs
){

303 
l_shd©e
 = 
rhs
.l_shipdate;

304 
	gl_quªt™y
 = 
rhs
.
l_quªt™y
;

305 
	gl_discouÁ
 = 
rhs
.
l_discouÁ
;

307  (*
	gthis
);

311 
q6_šput_t
 
	$ü—‹_q6_šput
(const , const ) {

313 
q6_šput_t
 
q6š
;

315 
tm
 
shd©e
;

317 
shd©e
.
tm_y—r
 = 
	`URªd
(93, 97);

318 
shd©e
.
tm_mÚ
 = 0;

319 
shd©e
.
tm_mday
 = 1;

320 
shd©e
.
tm_hour
 = 0;

321 
shd©e
.
tm_mš
 = 0;

322 
shd©e
.
tm_£c
 = 0;

324 
q6š
.
l_shd©e
 = 
	`mktime
(&
shd©e
);

327 
q6š
.
l_discouÁ
 = (
	`¿nd
(è/ 
RAND_MAX
) * 0.07 + 0.02;

329 
q6š
.
l_quªt™y
 = 
	`URªd
(24,25);

332  (
q6š
);

333 
	}
};

341 
	gq7_šput_t
& q7_šput_t::
İ”©Ü
=(cÚ¡ 
q7_šput_t
& 
rhs
){

343 
n_Çme1
 = 
rhs
.n_name1;

344 
	gn_Çme2
 = 
rhs
.
n_Çme2
;

346  (*
	gthis
);

350 
q7_šput_t
 
	$ü—‹_q7_šput
(const , const ) {

352 
q7_šput_t
 
q7š
;

354 
q7š
.
n_Çme1
 = 
	`URªd
(0, 
END_N_NAME
-1);

355 
q7š
.
n_Çme2
 = 
	`URªd
(0, 
END_N_NAME
-1);

357 
q7š
.
n_Çme1
 =ğq7š.
n_Çme2
)

358 
q7š
.
n_Çme2
 = 
	`URªd
(0, 
END_N_NAME
-1);

363  
q7š
;

364 
	}
}

372 
	gq8_šput_t
& q8_šput_t::
İ”©Ü
=(cÚ¡ 
q8_šput_t
& 
rhs
){

374 
n_Çme
 = 
rhs
.n_name;

375 
	gr_Çme
 = 
rhs
.
n_Çme
;

377 
	gp_ty³
 = 
rhs
.
p_ty³
;

379  (*
	gthis
);

382 
q8_šput_t
 
	$ü—‹_q8_šput
(const , const ) {

384 
q8_šput_t
 
q8š
;

388 
q8š
.
r_Çme
 = 
	`URªd
(0, 
END_R_NAME
-1);

389 
boŞ
 
ÇtiÚ_ok
 = 
çl£
;

390 !
ÇtiÚ_ok
) {

391 
q8š
.
n_Çme
 = 
	`URªd
(0, 
END_N_NAME
-1);

392 
q8š
.
r_Çme
) {

393 
AFRICA
:

394 
ÇtiÚ_ok
 = (
q8š
.
n_Çme
 =ğ
ALGERIA
 || q8š.n_Çm=ğ
ETHIOPIA
 || q8š.n_Çm=ğ
KENYA
 || q8š.n_Çm=ğ
MOROCCO
 || q8š.n_Çm=ğ
MOZAMBIQUE
);

396 
AMERICA
:

397 
ÇtiÚ_ok
 = (
q8š
.
n_Çme
 =ğ
ARGENTINA
 || q8š.n_Çm=ğ
BRAZIL
 || q8š.n_Çm=ğ
CANADA
 || q8š.n_Çm=ğ
PERU
 || q8š.n_Çm=ğ
UNITED_STATES
);

399 
ASIA
:

400 
ÇtiÚ_ok
 = (
q8š
.
n_Çme
 =ğ
INDIA
 || q8š.n_Çm=ğ
INDONESIA
 || q8š.n_Çm=ğ
JAPAN
 || q8š.n_Çm=ğ
CHINA
 || q8š.n_Çm=ğ
VIETNAM
);

402 
EUROPE
:

403 
ÇtiÚ_ok
 = (
q8š
.
n_Çme
 =ğ
FRANCE
 || q8š.n_Çm=ğ
GERMANY
 || q8š.n_Çm=ğ
ROMANIA
 || q8š.n_Çm=ğ
RUSSIA
 || q8š.n_Çm=ğ
UNITED_KINGDOM
);

405 
MIDDLE_EAST
:

406 
ÇtiÚ_ok
 = (
q8š
.
n_Çme
 =ğ
EGYPT
 || q8š.n_Çm=ğ
IRAN
 || q8š.n_Çm=ğ
IRAQ
 || q8š.n_Çm=ğ
JORDAN
 || q8š.n_Çm=ğ
SAUDI_ARABIA
);

411 
q8š
.
p_ty³
.
s1
 = 
	`URªd
(0, 
END_TYPE_S1
-1);

412 
q8š
.
p_ty³
.
s2
 = 
	`URªd
(0, 
END_TYPE_S2
-1);

413 
q8š
.
p_ty³
.
s3
 = 
	`URªd
(0, 
END_TYPE_S3
-1);

422  
q8š
;

423 
	}
}

432 
	gq9_šput_t
& q9_šput_t::
İ”©Ü
=(cÚ¡ 
q9_šput_t
& 
rhs
){

434 
p_Çme
 = 
rhs
.p_name;

435  (*
	gthis
);

438 
q9_šput_t
 
	$ü—‹_q9_šput
(const , const ) {

440 
q9_šput_t
 
q9š
;

442 
q9š
.
p_Çme
 = 
	`URªd
(0, 
END_P_NAME
-1);

445  
q9š
; 
	}
}

453 
	gq10_šput_t
& q10_šput_t::
İ”©Ü
=(cÚ¡ 
q10_šput_t
& 
rhs
){

455 
o_Üd”d©e
 = 
rhs
.o_orderdate;

457  (*
	gthis
);

460 
q10_šput_t
 
	$ü—‹_q10_šput
(const , const ) {

462 
q10_šput_t
 
q10š
;

464 
tm
 
d©e1
;

465 
d©e1
.
tm_y—r
 = 93; d©e1.
tm_mÚ
 = 1; d©e1.
tm_mday
 = 1;

466 
d©e1
.
tm_£c
 = 0; d©e1.
tm_mš
 = 0; d©e1.
tm_hour
 = 0;

468 
tm
 
d©e2
;

469 
d©e2
.
tm_y—r
 = 95; d©e2.
tm_mÚ
 = 0; d©e2.
tm_mday
 = 31;

470 
d©e2
.
tm_£c
 = 59; d©e2.
tm_mš
 = 59; d©e2.
tm_hour
 = 23;

472 
time_t
 
t1
 = 
	`mktime
(&
d©e1
);

473 
time_t
 
t2
 = 
	`mktime
(&
d©e2
);

475 
q10š
.
o_Üd”d©e
 = 
	`URªd
(
t1
,
t2
);

483  
q10š
;

484 
	}
}

491 
	gq11_šput_t
& q11_šput_t::
İ”©Ü
=(cÚ¡ 
q11_šput_t
& 
rhs
){

493 
n_Çme
 = 
rhs
.n_name;

494 
	gäaùiÚ
 = 
rhs
.
äaùiÚ
;

496  (*
	gthis
);

499 
q11_šput_t
 
	$ü—‹_q11_šput
(const , const ) {

500 
q11_šput_t
 
q11š
;

502 
q11š
.
n_Çme
 = 
	`URªd
(0, 
END_N_NAME
-1);

503 
q11š
.
äaùiÚ
 = 0.0001;

508  
q11š
;

509 
	}
}

524 
	gq12_šput_t
& q12_šput_t::
İ”©Ü
=(cÚ¡ 
q12_šput_t
& 
rhs
)

526 
l_shmode1
=
rhs
.l_shipmode1;

527 
	gl_shmode2
=
rhs
.
l_shmode2
;

528 
	gl_»ûtd©e
 = 
rhs
.
l_»ûtd©e
;

529  (*
	gthis
);

533 
q12_šput_t
 
	$ü—‹_q12_šput
(const ,

536 
q12_šput_t
 
q12_šput
;

540 
q12_šput
.
l_shmode1
=
	`URªd
(0,
END_SHIPMODE
-1);

541 
q12_šput
.
l_shmode2
=(q12_šput.
l_shmode1
+
	`URªd
(0,
END_SHIPMODE
-2)+1)%END_SHIPMODE;

543 
tm
 
»ûtd©e
;

546 
»ûtd©e
.
tm_y—r
 = 
	`URªd
(93, 97);

549 
»ûtd©e
.
tm_mÚ
 = 0;

550 
»ûtd©e
.
tm_mday
 = 1;

551 
»ûtd©e
.
tm_hour
 = 0;

552 
»ûtd©e
.
tm_mš
 = 0;

553 
»ûtd©e
.
tm_£c
 = 0;

555 
q12_šput
.
l_»ûtd©e
 = 
	`mktime
(&
»ûtd©e
);

557  (
q12_šput
);

558 
	}
};

572 
	gq13_šput_t
& q13_šput_t::
İ”©Ü
=(cÚ¡ 
q13_šput_t
& 
rhs
)

574 
¡rıy
(
WORD1
,
rhs
.WORD1);

575 
¡rıy
(
WORD2
,
rhs
.WORD2);

576  (*
	gthis
);

580 
q13_šput_t
 
	$ü—‹_q13_šput
(const ,

583 
q13_šput_t
 
q13_šput
;

585 
num_fœ¡_’Œ›s
, 
num_£cÚd_’Œ›s
;

588 cÚ¡* 
FIRST
[] = {"special", "pending", "unusual", "express"};

589 cÚ¡* 
SECOND
[] = {"packages", "requests", "accounts", "deposits"};

591 
num_fœ¡_’Œ›s
 = (
FIRST
)/(FIRST[0]);

592 
num_£cÚd_’Œ›s
 = (
SECOND
)/(SECOND[0]);

594 
	`¡rıy
(
q13_šput
.
WORD1
,
FIRST
[
	`URªd
(1,
num_fœ¡_’Œ›s
)-1]);

595 
	`¡rıy
(
q13_šput
.
WORD2
,
SECOND
[
	`URªd
(1,
num_£cÚd_’Œ›s
)-1]);

597  (
q13_šput
);

598 
	}
};

611 
	gq14_šput_t
& q14_šput_t::
İ”©Ü
=(cÚ¡ 
q14_šput_t
& 
rhs
)

613 
l_shd©e
 = 
rhs
.l_shipdate;

614  (*
	gthis
);

618 
q14_šput_t
 
	$ü—‹_q14_šput
(const ,

621 
q14_šput_t
 
q14_šput
;

623 
tm
 
shd©e
;

626 
shd©e
.
tm_y—r
 = 
	`URªd
(93, 97);

629 
shd©e
.
tm_mÚ
 = 
	`URªd
(0,11);

632 
shd©e
.
tm_mday
 = 1;

633 
shd©e
.
tm_hour
 = 0;

634 
shd©e
.
tm_mš
 = 0;

635 
shd©e
.
tm_£c
 = 0;

637 
q14_šput
.
l_shd©e
 = 
	`mktime
(&
shd©e
);

639  (
q14_šput
);

640 
	}
};

652 
	gq15_šput_t
& q15_šput_t::
İ”©Ü
=(cÚ¡ 
q15_šput_t
& 
rhs
)

654 
l_shd©e
 = 
rhs
.l_shipdate;

655  (*
	gthis
);

659 
q15_šput_t
 
	$ü—‹_q15_šput
(const ,

662 
q15_šput_t
 
q15_šput
;

664 
tm
 
shd©e
;

667 
shd©e
.
tm_y—r
 = 
	`URªd
(93, 97);

670 
shd©e
.
tm_mÚ
 = 
	`URªd
(0,11);

673 
shd©e
.
tm_mday
 = 1;

674 
shd©e
.
tm_hour
 = 0;

675 
shd©e
.
tm_mš
 = 0;

676 
shd©e
.
tm_£c
 = 0;

678 
q15_šput
.
l_shd©e
 = 
	`mktime
(&
shd©e
);

680  (
q15_šput
);

681 
	}
};

691 
	gq16_šput_t
& q16_šput_t::
İ”©Ü
=(cÚ¡ 
q16_šput_t
& 
rhs
){

693 
p_b¿nd
 = 
rhs
.p_brand;

694 
	gp_ty³
 = 
rhs
.
p_ty³
;

696 
	gi
=0; i<8; i++)

697 
	gp_size
[
i
] = 
rhs
.
p_size
[i];

699  (*
	gthis
);

702 
q16_šput_t
 
	$ü—‹_q16_šput
(const , const ) {

704 
q16_šput_t
 
q16_šput
;

706 
q16_šput
.
p_b¿nd
 = 
	`URªd
(1,5)*10 + URand(1,5);

707 
q16_šput
.
p_ty³
 = 
	`URªd
(0,5)*10 + URand(0,4);

709 
boŞ
 
cÚšs
;

710 
j
;

712 
i
=0; i<8; i++) {

714 
q16_šput
.
p_size
[
i
] = 
	`URªd
(1,50);

715 
cÚšs
 = 
çl£
;

716 
j
 = 0; j < 
i
; j++) {

717 if(
q16_šput
.
p_size
[
i
] =ğq16_šput.p_size[
j
]è
cÚšs
 = 
Œue
;

719 } 
cÚšs
);

722  
q16_šput
;

724 
	}
};

734 
	gq17_šput_t
& q17_šput_t::
İ”©Ü
=(cÚ¡ 
q17_šput_t
& 
rhs
){

736 
p_b¿nd
 = 
rhs
.p_brand;

737 
	gp_cÚš”
 = 
rhs
.
p_cÚš”
;

739  (*
	gthis
);

742 
q17_šput_t
 
	$ü—‹_q17_šput
(const , const ) {

744 
q17_šput_t
 
q17_šput
;

746 
q17_šput
.
p_b¿nd
 = 
	`URªd
(1,5)*10 + URand(1,5);

747 
q17_šput
.
p_cÚš”
 = 
	`URªd
(0,4)*10 +URand(0,7);

752  
q17_šput
;

753 
	}
}

763 
	gq18_šput_t
& q18_šput_t::
İ”©Ü
=(cÚ¡ 
q18_šput_t
& 
rhs
){

764 
l_quªt™y
 = 
rhs
.l_quantity;

765  (*
	gthis
);

768 
q18_šput_t
 
	$ü—‹_q18_šput
(const , const ) {

770 
q18_šput_t
 
q18šput
;

772 
q18šput
.
l_quªt™y
 = 
	`URªd
(312,315);

774  
q18šput
;

775 
	}
}

785 
	gq19_šput_t
& q19_šput_t::
İ”©Ü
=(cÚ¡ 
q19_šput_t
& 
rhs
){

787 
i
=0; 
	gi
<3; i++){

789 
	gl_quªt™y
[
i
] = 
rhs
.
l_quªt™y
[i];

790 
	gp_b¿nd
[
i
] = 
rhs
.
p_b¿nd
[i];

793  (*
	gthis
);

796 
q19_šput_t
 
	$ü—‹_q19_šput
(const , const ) {

798 
q19_šput_t
 
q19š
;

800 
q19š
.
l_quªt™y
[0] = 
	`URªd
(1,10);

801 
q19š
.
l_quªt™y
[1] = 
	`URªd
(10,20);

802 
q19š
.
l_quªt™y
[2] = 
	`URªd
(20,30);

804 
i
 = 0; i < 3; i++){

805 
q19š
.
p_b¿nd
[
i
] = 
	`URªd
(0,4)*10+ URand(0,4);

808  
q19š
;

809 
	}
}

819 
	gq20_šput_t
& q20_šput_t::
İ”©Ü
=(cÚ¡ 
q20_šput_t
& 
rhs
){

821 
n_Çme
 = 
rhs
.n_name;

822 
	gp_cŞÜ
 = 
rhs
. 
p_cŞÜ
;

823 
	gl_shd©e
 = 
rhs
.
l_shd©e
;

825  (*
	gthis
);

828 
q20_šput_t
 
	$ü—‹_q20_šput
(const , const ) {

830 
q20_šput_t
 
q20š
;

832 
q20š
.
n_Çme
 = 
	`URªd
(0, 
END_N_NAME
);

833 
q20š
.
p_cŞÜ
 = 
	`URªd
(0, 
END_P_NAME
);

835 
tm
 
t
;

836 
t
.
tm_£c
 = 0;

837 
t
.
tm_mš
 = 0;

838 
t
.
tm_hour
 = 0;

839 
t
.
tm_mday
 = 1;

840 
t
.
tm_mÚ
 = 0;

841 
t
.
tm_y—r
 = 
	`URªd
(93,97);

842 
t
.
tm_wday
 = 0;

843 
t
.
tm_yday
 = 0;

845 
q20š
.
l_shd©e
 = 
	`mktime
(&
t
);

847  
q20š
;

848 
	}
}

858 
	gq21_šput_t
& q21_šput_t::
İ”©Ü
=(cÚ¡ 
q21_šput_t
& 
rhs
){

860 
n_Çme
 = 
rhs
.n_name;

862  (*
	gthis
);

865 
q21_šput_t
 
	$ü—‹_q21_šput
(cÚ¡ 
sf
, cÚ¡ 
¥ecificWH
){

867 
q21_šput_t
 
q21š
;

869 
q21š
.
n_Çme
 = 
	`URªd
(0, 
END_N_NAME
-1);

871  
q21š
;

873 
	}
}

883 
q22_šput_t
 
	$ü—‹_q22_šput
(const , const ) {

885 
q22_šput_t
 
q22š
;

887 
boŞ
 
cÚšs
;

888 
j
;

890 
i
=0; i<7; i++) {

892 
q22š
.
úŒycode
[
i
] = 
	`URªd
(10, 34);

893 
cÚšs
 = 
çl£
;

894 
j
 = 0; j < 
i
; j++) {

895 if(
q22š
.
úŒycode
[
i
] =ğq22š.úŒycode[
j
]è
cÚšs
 = 
Œue
;

897 } 
cÚšs
);

901  
q22š
;

902 
	}
}

904 
	gq22_šput_t
& q22_šput_t::
İ”©Ü
=(cÚ¡ 
q22_šput_t
& 
rhs
){

906 
i
 = 0; 
	gi
 < 7; i++)

907 
	gúŒycode
[
i
] = 
rhs
.
úŒycode
[i];

909  (*
	gthis
);

912 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/tpch_random.cpp

33 
	~"wÜklßd/ch/ch_¿ndom.h
"

34 
	~"wÜklßd/ch/ch_cÚ¡.h
"

37 
ENTER_NAMESPACE
(
ch
);

62 
	$¿ndom
(
low
, 
high
, 
¿ndg’_t
* 
½
) {

64  (
low
 + 
½
->
	`¿nd
(
high
 -†ow + 1));

65 
	}
}

73 
	$URªd
(
low
, 
high
) {

75 
th»ad_t
* 
£lf
 = 
	`th»ad_g‘_£lf
();

76 
	`as£¹
 (
£lf
);

77 
¿ndg’_t
* 
¿ndg’p
 = 
£lf
->
	`¿ndg’
();

78 
	`as£¹
 (
¿ndg’p
);

80 
d
 = 
high
 - 
low
 + 1;

90  (
low
 + 
¿ndg’p
->
	`¿nd
(
d
));

91 
	}
}

99 
	$NURªd
(
A
, 
low
, 
high
) {

101 
th»ad_t
* 
£lf
 = 
	`th»ad_g‘_£lf
();

102 
	`as£¹
 (
£lf
);

103 
¿ndg’_t
* 
¿ndg’p
 = 
£lf
->
	`¿ndg’
();

104 
	`as£¹
 (
¿ndg’p
);

106  ( (((
	`¿ndom
(0, 
A
, 
¿ndg’p
è|„ªdom(
low
, 
high
,„andgenp))

107 + 
	`¿ndom
(0, 
A
, 
¿ndg’p
))

108 % (
high
 - 
low
 + 1)) +†ow );

109 
	}
}

111 
EXIT_NAMESPACE
(
ch
);

	@src/workload/tpch/tpch_util.cpp

33 
	~"wÜklßd/ch/ch_¡ruù.h
"

34 
	~"wÜklßd/ch/ch_ut.h
"

35 
	~<¡ršg
>

37 
ENTER_NAMESPACE
(
ch
);

39 
ch_l_shmode
 
	$¡r_to_shmode
(* 
shmode
)

41 
ch_l_shmode
 
»t
;

42 iàĞ!
	`¡rcmp
(
shmode
,"REG_AIR") || !strcmp(shipmode,"REG AIR") )

43 { 
»t
=
REG_AIR
; }

44 ià(!
	`¡rcmp
(
shmode
,"AIR"))

45 { 
»t
=
AIR
; }

46 ià(!
	`¡rcmp
(
shmode
,"RAIL"))

47 { 
»t
=
RAIL
; }

48 ià(!
	`¡rcmp
(
shmode
,"TRUCK"))

49 { 
»t
=
TRUCK
; }

50 ià(!
	`¡rcmp
(
shmode
,"MAIL"))

51 { 
»t
=
MAIL
; }

52 ià(!
	`¡rcmp
(
shmode
,"FOB"))

53 { 
»t
=
FOB
; }

55 { 
»t
=
SHIP
; }

57  
»t
;

58 
	}
}

60 
	$shmode_to_¡r
(* 
¡r
, 
ch_l_shmode
 
shmode
)

63 iàĞ
shmode
 =ğ
REG_AIR
 )

64 { 
	`¡rıy
(
¡r
,"REG AIR"); }

65 iàĞ
shmode
 =ğ
AIR
 )

66 { 
	`¡rıy
(
¡r
,"AIR"); }

67 iàĞ
shmode
 =ğ
RAIL
 )

68 { 
	`¡rıy
(
¡r
,"RAIL"); }

69 iàĞ
shmode
 =ğ
TRUCK
 )

70 { 
	`¡rıy
(
¡r
,"TRUCK"); }

71 iàĞ
shmode
 =ğ
MAIL
 )

72 { 
	`¡rıy
(
¡r
,"MAIL"); }

73 iàĞ
shmode
 =ğ
FOB
 )

74 { 
	`¡rıy
(
¡r
,"FOB"); }

76 { 
	`¡rıy
(
¡r
,"SHIP"); }

78 
	}
}

80 
	$B¿nd_to_¤t
(* 
¡r
, 
b¿nd
){

82 ifĞ
b¿nd
/100 != 0)

85 
num
[3];

86 
	`¥rštf
(
num
, "%d", 
b¿nd
);

88 
	`¡rıy
(
¡r
, "Brand#");

89 
	`¡rÿt
(
¡r
, 
num
);

92 
	}
}

94 
	$¡r_to_B¿nd
(* 
B¿nd
 ){

96 
num
[3];

98 
i
 = 6; i < 9; i++ )

99 
num
[ 
i
 - 6 ] = 
B¿nd
[i];

101  
	`©oi
(
num
);

102 
	}
}

104 
	$ty³s1_to_¡r
(*
¡r
 , 
s1
){

106 ifĞ
s1
 =ğ
STANDARD
)

107 
	`¡rıy
(
¡r
, "STANDARD");

108 ifĞ
s1
 =ğ
SMALL
)

109 
	`¡rıy
(
¡r
, "SMALL");

110 ifĞ
s1
 =ğ
MEDIUM
)

111 
	`¡rıy
(
¡r
, "MEDIUM");

112 ifĞ
s1
 =ğ
LARGE
)

113 
	`¡rıy
(
¡r
, "LARGE");

114 ifĞ
s1
 =ğ
ECONOMY
)

115 
	`¡rıy
(
¡r
,"ECONOMY");

116 iàĞ
s1
 =ğ
PROMO
)

117 
	`¡rıy
(
¡r
, "PROMO");

119 
	}
}

121 
ch_p_ty³_s1
 
	$¡r_to_ty³s1
(*
s1
){

123 if(
	`¡rcmp
(
s1
, "STANDARD") == 0)

124  
STANDARD
;

126 if(
	`¡rcmp
(
s1
, "SMALL") == 0)

127  
SMALL
;

129 if(
	`¡rcmp
(
s1
, "MEDIUM") == 0)

130  
MEDIUM
;

132 if(
	`¡rcmp
(
s1
, "LARGE") == 0)

133  
LARGE
;

135 if(
	`¡rcmp
(
s1
, "ECONOMY") == 0)

136  
ECONOMY
;

138 if(
	`¡rcmp
(
s1
, "PROMO") == 0)

139  
PROMO
;

141 
	}
}

143 
	$ty³s2_to_¡r
(* 
¡r
 , 
s2
){

145 ifĞ
s2
 =ğ
ANODIZED
 )

146 
	`¡rıy
(
¡r
, "ANODIZED");

148 ifĞ
s2
 =ğ
BURNISHED
 )

149 
	`¡rıy
(
¡r
, "BURNISHED");

151 ifĞ
s2
 =ğ
PLATED
)

152 
	`¡rıy
(
¡r
, "PLATED");

154 ifĞ
s2
 =ğ
POLISHED
)

155 
	`¡rıy
(
¡r
, "POLISHED");

157 ifĞ
s2
 =ğ
BRUSHED
)

158 
	`¡rıy
(
¡r
, "BRUSHED");

161 
	}
}

163 
ch_p_ty³_s2
 
	$¡r_to_ty³s2
(* 
s2
){

165 ifĞ
	`¡rcmp
(
s2
, "ANODIZED") == 0)

166  
ANODIZED
;

168 ifĞ
	`¡rcmp
(
s2
, "BURNISHED") ==0)

169  
BURNISHED
;

171 ifĞ
	`¡rcmp
(
s2
, "PLATED") ==0)

172  
PLATED
;

174 ifĞ
	`¡rcmp
(
s2
, "POLISHED") ==0)

175  
POLISHED
;

177 ifĞ
	`¡rcmp
(
s2
, "BRUSHED") ==0)

178  
BRUSHED
;

180 
	}
}

182 
	$ty³s3_to_¡r
(* 
¡r
 , 
s3
){

184 ifĞ
s3
 =ğ
TIN
)

185 
	`¡rıy
Ğ
¡r
, "TIN");

187 iàĞ
s3
 =ğ
NICKEL
)

188 
	`¡rıy
Ğ
¡r
, "NICKEL");

190 iàĞ
s3
 =ğ
BRASS
)

191 
	`¡rıy
Ğ
¡r
, "BRASS");

193 iàĞ
s3
 =ğ
STEEL
)

194 
	`¡rıy
Ğ
¡r
, "STEEL");

196 iàĞ
s3
 =ğ
COPPER
)

197 
	`¡rıy
Ğ
¡r
, "COPPER");

198 
	}
}

200 
ch_p_ty³_s3
 
	$¡r_to_ty³s3
(* 
s3
){

202 ifĞ
	`¡rcmp
(
s3
, "TIN") == 0)

203  
TIN
;

205 ifĞ
	`¡rcmp
(
s3
, "NICKEL") == 0)

206  
NICKEL
;

208 ifĞ
	`¡rcmp
(
s3
, "BRASS") == 0)

209  
BRASS
;

211 ifĞ
	`¡rcmp
(
s3
, "STEEL") == 0)

212  
STEEL
;

214 ifĞ
	`¡rcmp
(
s3
, "COPPER") == 0)

215  
COPPER
;

216 
	}
}

218 
	$ty³_to_¡r
(
ch_p_ty³
 
t
, * 
¡r
){

219 
ty³s1
[
	`STRSIZE
(25)];

220 
ty³s2
[
	`STRSIZE
(25)];

221 
ty³s3
[
	`STRSIZE
(25)];

222 
	`ty³s1_to_¡r
Ğ
ty³s1
, 
t
.
s1
);

223 
	`ty³s2_to_¡r
Ğ
ty³s2
, 
t
.
s2
);

224 
	`ty³s3_to_¡r
Ğ
ty³s3
, 
t
.
s3
);

226 
¡r
[0] = '\0';

227 
	`¡rÿt
(
¡r
, 
ty³s1
);

228 
	`¡rÿt
(
¡r
, " ");

229 
	`¡rÿt
(
¡r
, 
ty³s2
);

230 
	`¡rÿt
(
¡r
, " ");

231 
	`¡rÿt
(
¡r
, 
ty³s3
);

234 
	}
}

236 
ch_p_cÚš”_s1
 
	$¡r_to_cÚš”s1
(* 
s1
){

237 ifĞ
	`¡rcmp
(
s1
, "SM") == 0)

238  
SM
;

239 if(
	`¡rcmp
(
s1
, "LG") == 0)

240  
LG
;

241 if(
	`¡rcmp
(
s1
, "MED") == 0)

242  
MED
;

243 if(
	`¡rcmp
(
s1
, "JUMBO") == 0)

244  
JUMBO
;

245 if(
	`¡rcmp
(
s1
, "WRAP") == 0)

246  
WRAP
;

247 
	}
}

249 
	$cÚš”s1_to_¡r
Ğ
ch_p_cÚš”_s1
 
s1
, * 
¡r
){

250 ifĞ
s1
 =ğ
SM
)

251 
	`¡rıy
(
¡r
, "SM");

252 ifĞ
s1
 =ğ
LG
)

253 
	`¡rıy
(
¡r
, "LG");

254 ifĞ
s1
 =ğ
MED
)

255 
	`¡rıy
(
¡r
, "MED");

256 ifĞ
s1
 =ğ
JUMBO
)

257 
	`¡rıy
(
¡r
, "JUMBO");

258 ifĞ
s1
 =ğ
WRAP
)

259 
	`¡rıy
(
¡r
, "WRAP");

261 
	}
}

263 
ch_p_cÚš”_s2
 
	$¡r_to_cÚš”s2
(* 
s2
){

265 ifĞ
	`¡rcmp
(
s2
, "CASE") == 0)

266  
CASE
;

267 iàĞ
	`¡rcmp
(
s2
, "BOX") == 0)

268  
BOX
;

269 iàĞ
	`¡rcmp
(
s2
, "BAG") == 0)

270  
BAG
;

271 iàĞ
	`¡rcmp
(
s2
, "JAR") == 0)

272  
JAR
;

273 iàĞ
	`¡rcmp
(
s2
, "PKG") == 0)

274  
PKG
;

275 iàĞ
	`¡rcmp
(
s2
, "PACK") == 0)

276  
PACK
;

277 iàĞ
	`¡rcmp
(
s2
, "CAN") == 0)

278  
CAN
;

279 iàĞ
	`¡rcmp
(
s2
, "DRUM") == 0)

280  
DRUM
;

282 
	}
}

284 
	$cÚš”s2_to_¡r
Ğ
ch_p_cÚš”_s2
 
s2
, * 
¡r
){

285 if(
s2
 =ğ
CASE
)

286 
	`¡rıy
(
¡r
, "CASE");

287 if(
s2
 =ğ
BOX
)

288 
	`¡rıy
(
¡r
, "BOX");

289 if(
s2
 =ğ
BAG
)

290 
	`¡rıy
(
¡r
, "BAG");

291 if(
s2
 =ğ
JAR
)

292 
	`¡rıy
(
¡r
, "JAR");

293 if(
s2
 =ğ
PKG
)

294 
	`¡rıy
(
¡r
, "PKG");

295 if(
s2
 =ğ
PACK
)

296 
	`¡rıy
(
¡r
, "PACK");

297 if(
s2
 =ğ
CAN
)

298 
	`¡rıy
(
¡r
, "CAN");

299 if(
s2
 =ğ
DRUM
)

300 
	`¡rıy
(
¡r
, "DRUM");

302 
	}
}

304 
	$cÚš”_to_¡r
(
p_cÚš”
, * 
¡r
) {

305 
s1
[
	`STRSIZE
(6)];

306 
s2
[
	`STRSIZE
(4)];

308 
p_cÚš”
 / 10) {

309 
SM
:

310 
	`¡rıy
(
s1
, "SM ");

312 
LG
:

313 
	`¡rıy
(
s1
, "LG ");

315 
MED
:

316 
	`¡rıy
(
s1
, "MED ");

318 
JUMBO
:

319 
	`¡rıy
(
s1
, "JUMBO ");

321 
WRAP
:

322 
	`¡rıy
(
s1
, "WRAP ");

326 
p_cÚš”
 % 10) {

327 
CASE
:

328 
	`¡rıy
(
s2
, "CASE");

330 
BOX
:

331 
	`¡rıy
(
s2
, "BOX");

333 
BAG
:

334 
	`¡rıy
(
s2
, "BAG");

336 
JAR
:

337 
	`¡rıy
(
s2
, "JAR");

339 
PKG
:

340 
	`¡rıy
(
s2
, "PKG");

342 
PACK
:

343 
	`¡rıy
(
s2
, "PACK");

345 
CAN
:

346 
	`¡rıy
(
s2
, "CAN");

348 
DRUM
:

349 
	`¡rıy
(
s2
, "DRUM");

352 
¡r
[0] = '\0';

353 
	`¡rÿt
(
¡r
, 
s1
);

354 
	`¡rÿt
(
¡r
, 
s2
);

355 
	}
}

357 
	$²ame_to_¡r
(
p
, * 
¤t
){

359 
p
){

361 
®mÚd
:

362 
	`¡rıy
(
¤t
,"almond");

364 
ªtique
:

365 
	`¡rıy
(
¤t
,"antique");

367 
aquam¬še
:

368 
	`¡rıy
(
¤t
,"aquamarine");

370 
azu»
:

371 
	`¡rıy
(
¤t
,"azure");

373 
beige
:

374 
	`¡rıy
(
¤t
,"beige");

376 
bisque
:

377 
	`¡rıy
(
¤t
,"bisque");

379 
bÏck
:

380 
	`¡rıy
(
¤t
,"black");

382 
bÏnched
:

383 
	`¡rıy
(
¤t
,"blanched");

385 
blue
:

386 
	`¡rıy
(
¤t
,"blue");

388 
blush
:

389 
	`¡rıy
(
¤t
,"blush");

391 
brown
:

392 
	`¡rıy
(
¤t
,"brown");

394 
bu¾ywood
:

395 
	`¡rıy
(
¤t
,"burlywood");

397 
buºished
:

398 
	`¡rıy
(
¤t
,"burnished");

400 
ch¬Œeu£
:

401 
	`¡rıy
(
¤t
,"chartreuse");

403 
chiffÚ
:

404 
	`¡rıy
(
¤t
,"chiffon");

406 
chocŞ©e
:

407 
	`¡rıy
(
¤t
,"chocolate");

409 
cÜ®
:

410 
	`¡rıy
(
¤t
,"coral");

412 
cÜnæow”
:

413 
	`¡rıy
(
¤t
,"cornflower");

415 
cÜnsk
:

416 
	`¡rıy
(
¤t
,"cornsilk");

418 
ü—m
:

419 
	`¡rıy
(
¤t
,"cream");

421 
cyª
:

422 
	`¡rıy
(
¤t
,"cyan");

424 
d¬k
:

425 
	`¡rıy
(
¤t
,"dark");

427 
d“p
:

428 
	`¡rıy
(
¤t
,"deep");

430 
dim
:

431 
	`¡rıy
(
¤t
,"dim");

433 
dodg”
:

434 
	`¡rıy
(
¤t
,"dodger");

436 
d¿b
:

437 
	`¡rıy
(
¤t
,"drab");

439 
fœebrick
:

440 
	`¡rıy
(
¤t
,"firebrick");

442 
æÜ®
:

443 
	`¡rıy
(
¤t
,"floral");

445 
fÜe¡
:

446 
	`¡rıy
(
¤t
,"forest");

448 
äo¡ed
:

449 
	`¡rıy
(
¤t
,"frosted");

451 
gašsbÜo
:

452 
	`¡rıy
(
¤t
,"gainsboro");

454 
gho¡
:

455 
	`¡rıy
(
¤t
,"ghost");

457 
gŞd’rod
:

458 
	`¡rıy
(
¤t
,"goldenrod");

460 
g»’
:

461 
	`¡rıy
(
¤t
,"green");

463 
g»y
:

464 
	`¡rıy
(
¤t
,"grey");

466 
hÚeydew
:

467 
	`¡rıy
(
¤t
,"honeydew");

469 
hÙ
:

470 
	`¡rıy
(
¤t
,"hot");

472 
šdŸn
:

473 
	`¡rıy
(
¤t
,"indian");

475 
ivÜy
:

476 
	`¡rıy
(
¤t
,"ivory");

478 
khaki
:

479 
	`¡rıy
(
¤t
,"khaki");

481 
Ïû
:

482 
	`¡rıy
(
¤t
,"lace");

484 
Ïv’d”
:

485 
	`¡rıy
(
¤t
,"lavender");

487 
Ïwn
:

488 
	`¡rıy
(
¤t
,"lawn");

490 
ËmÚ
:

491 
	`¡rıy
(
¤t
,"lemon");

493 
light
:

494 
	`¡rıy
(
¤t
,"light");

496 
lime
:

497 
	`¡rıy
(
¤t
,"lime");

499 
lš’
:

500 
	`¡rıy
(
¤t
,"linen");

502 
mag’
:

503 
	`¡rıy
(
¤t
,"magenta");

505 
m¬oÚ
:

506 
	`¡rıy
(
¤t
,"maroon");

508 
medium
:

509 
	`¡rıy
(
¤t
,"medium");

511 
m‘®lic
:

512 
	`¡rıy
(
¤t
,"metallic");

514 
midnight
:

515 
	`¡rıy
(
¤t
,"midnight");

517 
mšt
:

518 
	`¡rıy
(
¤t
,"mint");

520 
mi¡y
:

521 
	`¡rıy
(
¤t
,"misty");

523 
mocÿsš
:

524 
	`¡rıy
(
¤t
,"moccasin");

526 
Çvajo
:

527 
	`¡rıy
(
¤t
,"navajo");

529 
Çvy
:

530 
	`¡rıy
(
¤t
,"navy");

532 
Şive
:

533 
	`¡rıy
(
¤t
,"olive");

535 
Üªge
:

536 
	`¡rıy
(
¤t
,"orange");

538 
Üchid
:

539 
	`¡rıy
(
¤t
,"orchid");

541 
·Ë
:

542 
	`¡rıy
(
¤t
,"pale");

544 
··ya
:

545 
	`¡rıy
(
¤t
,"papaya");

547 
³ach
:

548 
	`¡rıy
(
¤t
,"peach");

550 
³ru
:

551 
	`¡rıy
(
¤t
,"peru");

553 
pšk
:

554 
	`¡rıy
(
¤t
,"pink");

556 
¶um
:

557 
	`¡rıy
(
¤t
,"plum");

559 
powd”
:

560 
	`¡rıy
(
¤t
,"powder");

562 
puff
:

563 
	`¡rıy
(
¤t
,"puff");

565 
pu½Ë
:

566 
	`¡rıy
(
¤t
,"purple");

568 
»d
:

569 
	`¡rıy
(
¤t
,"red");

571 
ro£
:

572 
	`¡rıy
(
¤t
,"rose");

574 
rosy
:

575 
	`¡rıy
(
¤t
,"rosy");

577 
roy®
:

578 
	`¡rıy
(
¤t
,"royal");

580 
§ddË
:

581 
	`¡rıy
(
¤t
,"saddle");

583 
§lmÚ
:

584 
	`¡rıy
(
¤t
,"salmon");

586 
§ndy
:

587 
	`¡rıy
(
¤t
,"sandy");

589 
£ash–l
:

590 
	`¡rıy
(
¤t
,"seashell");

592 
s›Âa
:

593 
	`¡rıy
(
¤t
,"sienna");

595 
sky
:

596 
	`¡rıy
(
¤t
,"sky");

598 
¦©e
:

599 
	`¡rıy
(
¤t
,"slate");

601 
smoke
:

602 
	`¡rıy
(
¤t
,"smoke");

604 
¢ow
:

605 
	`¡rıy
(
¤t
,"snow");

607 
¥ršg
:

608 
	`¡rıy
(
¤t
,"spring");

610 
¡“l
:

611 
	`¡rıy
(
¤t
,"steel");

613 
n
:

614 
	`¡rıy
(
¤t
,"tan");

616 
thi¡Ë
:

617 
	`¡rıy
(
¤t
,"thistle");

619 
tom©o
:

620 
	`¡rıy
(
¤t
,"tomato");

622 
turquoi£
:

623 
	`¡rıy
(
¤t
,"turquoise");

625 
viŞ‘
:

626 
	`¡rıy
(
¤t
,"violet");

628 
wh—t
:

629 
	`¡rıy
(
¤t
,"wheat");

631 
wh™e
:

632 
	`¡rıy
(
¤t
,"white");

634 
y–low
:

635 
	`¡rıy
(
¤t
,"yellow");

638 
	}
}

640 
ch_o_´iÜ™y
 
	$¡r_to_´iÜ™y
(* 
¡r
 ){

642 
ch_o_´iÜ™y
 
»t
;

644 ifĞ!
	`¡rcmp
(
¡r
, "1-URGENT") )

645 
»t
 = 
O_URGENT
;

646 ifĞ!
	`¡rcmp
(
¡r
, "2-HIGH"))

647 
»t
 = 
O_HIGH
;

648 ifĞ!
	`¡rcmp
(
¡r
, "3-MEDIUM"))

649 
»t
 = 
O_MEDIUM
;

650 ifĞ!
	`¡rcmp
(
¡r
, "4-NOT SPECIFIED"))

651 
»t
 = 
O_NOT_SPECIFIED
;

652 ifĞ!
	`¡rcmp
(
¡r
, "5-LOW"))

653 
»t
 = 
O_LOW
;

655  
»t
;

657 
	}
}

659 
	$£gm’t_to_¡r
(* 
¡r
, 
£g
){

660 
£g
) {

661 
AUTOMOBILE
:

662 
	`¡rıy
(
¡r
, "AUTOMOBILE");

664 
BUILDING
:

665 
	`¡rıy
(
¡r
, "BUILDING");

667 
FURNITURE
:

668 
	`¡rıy
(
¡r
, "FURNITURE");

670 
MACHINERY
:

671 
	`¡rıy
(
¡r
, "MACHINERY");

673 
HOUSEHOLD
:

674 
	`¡rıy
(
¡r
, "HOUSEHOLD");

677 
	}
}

679 
ch_c_£gm’t
 
	$¡r_to_£gm’t
(*
¡r
){

681 
ch_c_£gm’t
 
»t
;

683 ifĞ!
	`¡rcmp
(
¡r
, "AUTOMOBILE"))

684 
»t
 = 
AUTOMOBILE
;

685 ifĞ!
	`¡rcmp
(
¡r
, "BUILDING"))

686 
»t
 = 
BUILDING
;

687 ifĞ!
	`¡rcmp
(
¡r
, "FURNITURE"))

688 
»t
 = 
FURNITURE
;

689 ifĞ!
	`¡rcmp
(
¡r
, "MACHINERY"))

690 
»t
 = 
MACHINERY
;

691 ifĞ!
	`¡rcmp
(
¡r
, "HOUSEHOLD"))

692 
»t
 = 
HOUSEHOLD
;

694  
»t
;

695 
	}
}

697 
ch_n_Çme
 
	$¡r_to_ÇtiÚ
(* 
¡r
 ){

699 if(
	`¡rcmp
Ğ"ALGERIA", 
¡r
) == 0 )

700  
ALGERIA
;

701 if(
	`¡rcmp
Ğ"ARGENTINA", 
¡r
) == 0 )

702  
ARGENTINA
;

703 if(
	`¡rcmp
Ğ"BRAZIL", 
¡r
) == 0 )

704  
BRAZIL
;

705 if(
	`¡rcmp
Ğ"CANADA", 
¡r
) == 0 )

706  
CANADA
;

707 if(
	`¡rcmp
Ğ"EGYPT", 
¡r
) == 0 )

708  
EGYPT
;

709 if(
	`¡rcmp
Ğ"ETHIOPIA", 
¡r
) == 0 )

710  
ETHIOPIA
;

711 if(
	`¡rcmp
Ğ"FRANCE", 
¡r
) == 0 )

712  
FRANCE
;

713 if(
	`¡rcmp
Ğ"GERMANY", 
¡r
) == 0 )

714  
GERMANY
;

715 if(
	`¡rcmp
Ğ"INDIA", 
¡r
) == 0 )

716  
INDIA
;

717 if(
	`¡rcmp
Ğ"INDONESIA", 
¡r
) == 0 )

718  
INDONESIA
;

719 if(
	`¡rcmp
Ğ"IRAN", 
¡r
) == 0 )

720  
IRAN
;

721 if(
	`¡rcmp
Ğ"IRAQ", 
¡r
) == 0 )

722  
IRAQ
;

723 if(
	`¡rcmp
Ğ"JAPAN", 
¡r
) == 0 )

724  
JAPAN
;

725 if(
	`¡rcmp
Ğ"JORDAN", 
¡r
) == 0 )

726  
JORDAN
;

727 if(
	`¡rcmp
Ğ"KENYA", 
¡r
) == 0 )

728  
KENYA
;

729 if(
	`¡rcmp
Ğ"MOROCCO", 
¡r
) == 0 )

730  
MOROCCO
;

731 if(
	`¡rcmp
Ğ"MOZAMBIQUE", 
¡r
) == 0 )

732  
MOZAMBIQUE
;

733 if(
	`¡rcmp
Ğ"PERU", 
¡r
) == 0 )

734  
PERU
;

735 if(
	`¡rcmp
Ğ"CHINA", 
¡r
) == 0 )

736  
CHINA
;

737 if(
	`¡rcmp
Ğ"ROMANIA", 
¡r
) == 0 )

738  
ROMANIA
;

739 if(
	`¡rcmp
Ğ"SAUDI ARABIA", 
¡r
) == 0 )

740  
SAUDI_ARABIA
;

741 if(
	`¡rcmp
Ğ"VIETNAM", 
¡r
) == 0 )

742  
VIETNAM
;

743 if(
	`¡rcmp
Ğ"RUSSIA", 
¡r
) == 0 )

744  
RUSSIA
;

745 if(
	`¡rcmp
Ğ"UNITED KINGDOM", 
¡r
) == 0 )

746  
UNITED_KINGDOM
;

747 if(
	`¡rcmp
Ğ"UNITED STATES", 
¡r
) == 0 )

748  
UNITED_STATES
;

750 
	}
}

752 
	$ÇtiÚ_to_¡r
Ğ
n_ÇtiÚ
 , * 
¡r
 ){

754 
n_ÇtiÚ
){

755 
ALGERIA
:

756 
	`¡rıy
(
¡r
,"ALGERIA");

759 
ARGENTINA
:

760 
	`¡rıy
(
¡r
,"ARGENTINA");

763 
BRAZIL
:

764 
	`¡rıy
(
¡r
,"BRAZIL");

767 
CANADA
:

768 
	`¡rıy
(
¡r
,"CANADA");

771 
EGYPT
:

772 
	`¡rıy
(
¡r
,"EGYPT");

775 
ETHIOPIA
:

776 
	`¡rıy
(
¡r
,"ETHIOPIA");

779 
FRANCE
:

780 
	`¡rıy
(
¡r
,"FRANCE");

783 
GERMANY
:

784 
	`¡rıy
(
¡r
,"GERMANY");

787 
INDIA
:

788 
	`¡rıy
(
¡r
,"INDIA");

791 
INDONESIA
:

792 
	`¡rıy
(
¡r
,"INDONESIA");

795 
IRAN
:

796 
	`¡rıy
(
¡r
,"IRAN");

799 
IRAQ
:

800 
	`¡rıy
(
¡r
,"IRAQ");

803 
JAPAN
:

804 
	`¡rıy
(
¡r
,"JAPAN");

807 
JORDAN
:

808 
	`¡rıy
(
¡r
,"JORDAN");

811 
KENYA
:

812 
	`¡rıy
(
¡r
,"KENYA");

815 
MOROCCO
:

816 
	`¡rıy
(
¡r
,"MOROCCO");

819 
MOZAMBIQUE
:

820 
	`¡rıy
(
¡r
,"MOZAMBIQUE");

823 
PERU
:

824 
	`¡rıy
(
¡r
,"PERU");

827 
CHINA
:

828 
	`¡rıy
(
¡r
,"CHINA");

831 
ROMANIA
:

832 
	`¡rıy
(
¡r
,"ROMANIA");

835 
SAUDI_ARABIA
:

836 
	`¡rıy
(
¡r
,"SAUDI ARABIA");

839 
VIETNAM
:

840 
	`¡rıy
(
¡r
,"VIETNAM");

843 
RUSSIA
:

844 
	`¡rıy
(
¡r
,"RUSSIA");

847 
UNITED_KINGDOM
:

848 
	`¡rıy
(
¡r
,"UNITED KINGDOM");

851 
UNITED_STATES
:

852 
	`¡rıy
(
¡r
,"UNITED STATES");

857 
	}
}

859 
ch_r_Çme
 
	$¡r_to_»giÚ
(* 
¡r
) {

860 if(
	`¡rcmp
Ğ"AFRICA", 
¡r
) == 0 )

861  
AFRICA
;

862 if(
	`¡rcmp
Ğ"AMERICA", 
¡r
) == 0 )

863  
AMERICA
;

864 if(
	`¡rcmp
Ğ"ASIA", 
¡r
) == 0 )

865  
ASIA
;

866 if(
	`¡rcmp
Ğ"EUROPE", 
¡r
) == 0 )

867  
EUROPE
;

868 if(
	`¡rcmp
Ğ"MIDDLE EAST", 
¡r
) == 0 )

869  
MIDDLE_EAST
;

870 
	}
}

872 
	$»giÚ_to_¡r
(
r_Çme
, * 
¡r
) {

873 
r_Çme
){

874 
AFRICA
:

875 
	`¡rıy
(
¡r
,"AFRICA");

878 
AMERICA
:

879 
	`¡rıy
(
¡r
,"AMERICA");

882 
ASIA
:

883 
	`¡rıy
(
¡r
,"ASIA");

886 
EUROPE
:

887 
	`¡rıy
(
¡r
,"EUROPE");

890 
MIDDLE_EAST
:

891 
	`¡rıy
(
¡r
,"MIDDLE EAST");

894 
	}
}

896 
EXIT_NAMESPACE
(
ch
);

	@/usr/include/assert.h

22 #ifdef 
_ASSERT_H


24 #undeà
_ASSERT_H


25 #undeà
as£¹


26 #undeà
__ASSERT_VOID_CAST


28 #ifdef 
__USE_GNU


29 #undeà
as£¹_³¼Ü


34 
	#_ASSERT_H
 1

	)

35 
	~<ã©u»s.h
>

37 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,95)

38 
	#__ASSERT_VOID_CAST
 
¡©ic_ÿ¡
<>

	)

40 
	#__ASSERT_VOID_CAST
 ()

	)

48 #ifdef 
NDEBUG


50 
	#as£¹
(
ex´
è(
	`__ASSERT_VOID_CAST
 (0))

	)

58 #ifdef 
__USE_GNU


59 
	#as£¹_³¼Ü
(
”ºum
è(
	`__ASSERT_VOID_CAST
 (0))

	)

64 #iâdeà
_ASSERT_H_DECLS


65 
	#_ASSERT_H_DECLS


	)

66 
__BEGIN_DECLS


69 
	$__as£¹_ç
 (cÚ¡ *
__as£¹iÚ
, cÚ¡ *
__fe
,

70 
__lše
, cÚ¡ *
__funùiÚ
)

71 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

74 
	$__as£¹_³¼Ü_ç
 (
__”ºum
, cÚ¡ *
__fe
,

75 
__lše
, cÚ¡ *
__funùiÚ
)

76 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

81 
	$__as£¹
 (cÚ¡ *
__as£¹iÚ
, cÚ¡ *
__fe
, 
__lše
)

82 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

85 
__END_DECLS


88 
	#as£¹
(
ex´
) \

89 ((
ex´
) \

90 ? 
	`__ASSERT_VOID_CAST
 (0) \

91 : 
	`__as£¹_ç
 (
	`__STRING
(
ex´
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

93 #ifdef 
__USE_GNU


94 
	#as£¹_³¼Ü
(
”ºum
) \

95 (!(
”ºum
) \

96 ? 
	`__ASSERT_VOID_CAST
 (0) \

97 : 
	`__as£¹_³¼Ü_ç
 ((
”ºum
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

105 #ià
defšed
 
__ılu¥lus
 ? 
	`__GNUC_PREREQ
 (2, 6) : __GNUC_PREREQ (2, 4)

106 
	#__ASSERT_FUNCTION
 
__PRETTY_FUNCTION__


	)

108 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

109 
	#__ASSERT_FUNCTION
 
__func__


	)

111 
	#__ASSERT_FUNCTION
 ((cÚ¡ *è0)

	)

118 #ià
defšed
 
__USE_ISOC11
 && !defšed 
__ılu¥lus


120 #undeà
¡©ic_as£¹


121 
	#¡©ic_as£¹
 
_Stic_as£¹


	)

	@/usr/include/ctype.h

22 #iâdef 
_CTYPE_H


23 
	#_CTYPE_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	~<b™s/ty³s.h
>

28 
	g__BEGIN_DECLS


30 #iâdeà
_ISb™


39 
	~<’dŸn.h
>

40 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


41 
	#_ISb™
(
b™
è(1 << (b™))

	)

43 
	#_ISb™
(
b™
è((b™è< 8 ? ((1 << (b™)è<< 8è: ((1 << (b™)è>> 8))

	)

48 
	m_ISuµ”
 = 
_ISb™
 (0),

49 
	m_ISlow”
 = 
_ISb™
 (1),

50 
	m_IS®pha
 = 
_ISb™
 (2),

51 
	m_ISdig™
 = 
_ISb™
 (3),

52 
	m_ISxdig™
 = 
_ISb™
 (4),

53 
	m_IS¥aû
 = 
_ISb™
 (5),

54 
	m_IS´št
 = 
_ISb™
 (6),

55 
	m_ISg¿ph
 = 
_ISb™
 (7),

56 
	m_ISbÏnk
 = 
_ISb™
 (8),

57 
	m_ISúŒl
 = 
_ISb™
 (9),

58 
	m_ISpunù
 = 
_ISb™
 (10),

59 
	m_IS®num
 = 
_ISb™
 (11)

79 cÚ¡ **
	$__ùy³_b_loc
 ()

80 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

81 cÚ¡ 
__št32_t
 **
	$__ùy³_tŞow”_loc
 ()

82 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

83 cÚ¡ 
__št32_t
 **
	$__ùy³_touµ”_loc
 ()

84 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

87 #iâdeà
__ılu¥lus


88 
	#__isùy³
(
c
, 
ty³
) \

89 ((*
	`__ùy³_b_loc
 ())[(è(
c
)] & (è
ty³
)

	)

90 #–ià
defšed
 
__USE_EXTERN_INLINES


91 
	#__isùy³_f
(
ty³
) \

92 
__ex‹º_šlše
 \

93 
is
##
	`ty³
 (
__c
è
__THROW
 \

95  (*
	`__ùy³_b_loc
 ())[(è(
__c
)] & (è
_IS
##
ty³
; \

96 
	}

	)
}

99 
	#__i§scii
(
c
è(((cè& ~0x7fè=ğ0è

	)

100 
	#__tßscii
(
c
è((cè& 0x7fè

	)

102 
	#__exùy³
(
Çme
è
	`Çme
 (è
__THROW


	)

104 
__BEGIN_NAMESPACE_STD


110 
__exùy³
 (
i§Êum
);

111 
__exùy³
 (
i§Íha
);

112 
__exùy³
 (
isúŒl
);

113 
__exùy³
 (
isdig™
);

114 
__exùy³
 (
i¦ow”
);

115 
__exùy³
 (
isg¿ph
);

116 
__exùy³
 (
i¥ršt
);

117 
__exùy³
 (
i¥unù
);

118 
__exùy³
 (
is¥aû
);

119 
__exùy³
 (
isuµ”
);

120 
__exùy³
 (
isxdig™
);

124 
	$tŞow”
 (
__c
è
__THROW
;

127 
	$touµ”
 (
__c
è
__THROW
;

129 
__END_NAMESPACE_STD


133 #ifdef 
__USE_ISOC99


134 
__BEGIN_NAMESPACE_C99


136 
	`__exùy³
 (
isbÏnk
);

138 
__END_NAMESPACE_C99


141 #ifdeà
__USE_GNU


143 
	$isùy³
 (
__c
, 
__mask
è
__THROW
;

146 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


150 
	$i§scii
 (
__c
è
__THROW
;

154 
	$tßscii
 (
__c
è
__THROW
;

158 
	`__exùy³
 (
_touµ”
);

159 
	`__exùy³
 (
_tŞow”
);

163 
	#__tobody
(
c
, 
f
, 
a
, 
¬gs
) \

164 (
__ex‹nsiÚ__
 \

165 ({ 
__»s
; \

166 ià( (
c
) > 1) \

168 ià(
	`__butš_cÚ¡ªt_p
 (
c
)) \

170 
__c
 = (
c
); \

171 
__»s
 = 
__c
 < -128 || __ø> 255 ? __ø: (
a
)[__c]; \

174 
__»s
 = 
f
 
¬gs
; \

177 
__»s
 = (
a
)[(è(
c
)]; \

178 
__»s
; 
	}
}))

	)

180 #ià!
defšed
 
__NO_CTYPE


181 #ifdeà
__isùy³_f


182 
	$__isùy³_f
 (
®num
)

183 
	$__isùy³_f
 (
®pha
)

184 
	$__isùy³_f
 (
úŒl
)

185 
	$__isùy³_f
 (
dig™
)

186 
	$__isùy³_f
 (
low”
)

187 
	$__isùy³_f
 (
g¿ph
)

188 
	$__isùy³_f
 (
´št
)

189 
	$__isùy³_f
 (
punù
)

190 
	$__isùy³_f
 (
¥aû
)

191 
	$__isùy³_f
 (
uµ”
)

192 
	$__isùy³_f
 (
xdig™
)

193 #ifdeà
__USE_ISOC99


194 
	$__isùy³_f
 (
bÏnk
)

196 #–ià
defšed
 
__isùy³


197 
	#i§Êum
(
c
è
	`__isùy³
((c), 
_IS®num
)

	)

198 
	#i§Íha
(
c
è
	`__isùy³
((c), 
_IS®pha
)

	)

199 
	#isúŒl
(
c
è
	`__isùy³
((c), 
_ISúŒl
)

	)

200 
	#isdig™
(
c
è
	`__isùy³
((c), 
_ISdig™
)

	)

201 
	#i¦ow”
(
c
è
	`__isùy³
((c), 
_ISlow”
)

	)

202 
	#isg¿ph
(
c
è
	`__isùy³
((c), 
_ISg¿ph
)

	)

203 
	#i¥ršt
(
c
è
	`__isùy³
((c), 
_IS´št
)

	)

204 
	#i¥unù
(
c
è
	`__isùy³
((c), 
_ISpunù
)

	)

205 
	#is¥aû
(
c
è
	`__isùy³
((c), 
_IS¥aû
)

	)

206 
	#isuµ”
(
c
è
	`__isùy³
((c), 
_ISuµ”
)

	)

207 
	#isxdig™
(
c
è
	`__isùy³
((c), 
_ISxdig™
)

	)

208 #ifdeà
__USE_ISOC99


209 
	#isbÏnk
(
c
è
	`__isùy³
((c), 
_ISbÏnk
)

	)

213 #ifdeà
__USE_EXTERN_INLINES


214 
__ex‹º_šlše
 

215 
	`__NTH
 (
	$tŞow”
 (
__c
))

217  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_tŞow”_loc
 ())[__c] : __c;

218 
	}
}

220 
__ex‹º_šlše
 

221 
__NTH
 (
	$touµ”
 (
__c
))

223  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_touµ”_loc
 ())[__c] : __c;

224 
	}
}

227 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


228 
	#tŞow”
(
c
è
	`__tobody
 (c, 
tŞow”
, *
	`__ùy³_tŞow”_loc
 (), (c))

	)

229 
	#touµ”
(
c
è
	`__tobody
 (c, 
touµ”
, *
	`__ùy³_touµ”_loc
 (), (c))

	)

232 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


233 
	#i§scii
(
c
è
	`__i§scii
 (c)

	)

234 
	#tßscii
(
c
è
	`__tßscii
 (c)

	)

236 
	#_tŞow”
(
c
è((è(*
	`__ùy³_tŞow”_loc
 ())[(è(c)])

	)

237 
	#_touµ”
(
c
è((è(*
	`__ùy³_touµ”_loc
 ())[(è(c)])

	)

243 #ifdeà
__USE_XOPEN2K8


257 
	~<xloÿË.h
>

261 
	#__isùy³_l
(
c
, 
ty³
, 
loÿË
) \

262 ((
loÿË
)->
__ùy³_b
[(è(
c
)] & (è
ty³
)

	)

264 
	#__exùy³_l
(
Çme
) \

265 
	`Çme
 (, 
__loÿË_t
è
__THROW


	)

271 
__exùy³_l
 (
i§Êum_l
);

272 
__exùy³_l
 (
i§Íha_l
);

273 
__exùy³_l
 (
isúŒl_l
);

274 
__exùy³_l
 (
isdig™_l
);

275 
__exùy³_l
 (
i¦ow”_l
);

276 
__exùy³_l
 (
isg¿ph_l
);

277 
__exùy³_l
 (
i¥ršt_l
);

278 
__exùy³_l
 (
i¥unù_l
);

279 
__exùy³_l
 (
is¥aû_l
);

280 
__exùy³_l
 (
isuµ”_l
);

281 
__exùy³_l
 (
isxdig™_l
);

283 
__exùy³_l
 (
isbÏnk_l
);

287 
	$__tŞow”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

288 
	$tŞow”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

291 
	$__touµ”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

292 
	$touµ”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

294 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


295 
	#__tŞow”_l
(
c
, 
loÿË
) \

296 
	`__tobody
 (
c
, 
__tŞow”_l
, (
loÿË
)->
__ùy³_tŞow”
, (c,†oÿË))

	)

297 
	#__touµ”_l
(
c
, 
loÿË
) \

298 
	`__tobody
 (
c
, 
__touµ”_l
, (
loÿË
)->
__ùy³_touµ”
, (c,†oÿË))

	)

299 
	#tŞow”_l
(
c
, 
loÿË
è
	`__tŞow”_l
 ((c), (loÿË))

	)

300 
	#touµ”_l
(
c
, 
loÿË
è
	`__touµ”_l
 ((c), (loÿË))

	)

304 #iâdeà
__NO_CTYPE


305 
	#__i§Êum_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®num
, (l))

	)

306 
	#__i§Íha_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®pha
, (l))

	)

307 
	#__isúŒl_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISúŒl
, (l))

	)

308 
	#__isdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISdig™
, (l))

	)

309 
	#__i¦ow”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISlow”
, (l))

	)

310 
	#__isg¿ph_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISg¿ph
, (l))

	)

311 
	#__i¥ršt_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS´št
, (l))

	)

312 
	#__i¥unù_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISpunù
, (l))

	)

313 
	#__is¥aû_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS¥aû
, (l))

	)

314 
	#__isuµ”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISuµ”
, (l))

	)

315 
	#__isxdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISxdig™
, (l))

	)

317 
	#__isbÏnk_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISbÏnk
, (l))

	)

319 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC


320 
	#__i§scii_l
(
c
,
l
è(Ö), 
	`__i§scii
 (c))

	)

321 
	#__tßscii_l
(
c
,
l
è(Ö), 
	`__tßscii
 (c))

	)

324 
	#i§Êum_l
(
c
,
l
è
	`__i§Êum_l
 ((c), (l))

	)

325 
	#i§Íha_l
(
c
,
l
è
	`__i§Íha_l
 ((c), (l))

	)

326 
	#isúŒl_l
(
c
,
l
è
	`__isúŒl_l
 ((c), (l))

	)

327 
	#isdig™_l
(
c
,
l
è
	`__isdig™_l
 ((c), (l))

	)

328 
	#i¦ow”_l
(
c
,
l
è
	`__i¦ow”_l
 ((c), (l))

	)

329 
	#isg¿ph_l
(
c
,
l
è
	`__isg¿ph_l
 ((c), (l))

	)

330 
	#i¥ršt_l
(
c
,
l
è
	`__i¥ršt_l
 ((c), (l))

	)

331 
	#i¥unù_l
(
c
,
l
è
	`__i¥unù_l
 ((c), (l))

	)

332 
	#is¥aû_l
(
c
,
l
è
	`__is¥aû_l
 ((c), (l))

	)

333 
	#isuµ”_l
(
c
,
l
è
	`__isuµ”_l
 ((c), (l))

	)

334 
	#isxdig™_l
(
c
,
l
è
	`__isxdig™_l
 ((c), (l))

	)

336 
	#isbÏnk_l
(
c
,
l
è
	`__isbÏnk_l
 ((c), (l))

	)

338 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC


339 
	#i§scii_l
(
c
,
l
è
	`__i§scii_l
 ((c), (l))

	)

340 
	#tßscii_l
(
c
,
l
è
	`__tßscii_l
 ((c), (l))

	)

347 
__END_DECLS


	@/usr/include/dirent.h

22 #iâdef 
_DIRENT_H


23 
	#_DIRENT_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


29 
	~<b™s/ty³s.h
>

31 #ifdeà
__USE_XOPEN


32 #iâdeà
__šo_t_defšed


33 #iâdeà
__USE_FILE_OFFSET64


34 
__šo_t
 
	tšo_t
;

36 
__šo64_t
 
	tšo_t
;

38 
	#__šo_t_defšed


	)

40 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__šo64_t_defšed


41 
__šo64_t
 
	tšo64_t
;

42 
	#__šo64_t_defšed


	)

61 
	~<b™s/dœ’t.h
>

63 #ià(
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
è&& !defšed 
d_f’o


64 
	#d_šo
 
d_f’o


	)

81 #ifdeà
_DIRENT_HAVE_D_NAMLEN


82 
	#_D_EXACT_NAMLEN
(
d
è((d)->
d_ÇmËn
)

	)

83 
	#_D_ALLOC_NAMLEN
(
d
è(
	`_D_EXACT_NAMLEN
 (dè+ 1)

	)

85 
	#_D_EXACT_NAMLEN
(
d
è(
	`¡¾’
 ((d)->
d_Çme
))

	)

86 #ifdeà
_DIRENT_HAVE_D_RECLEN


87 
	#_D_ALLOC_NAMLEN
(
d
è(((*è(dè+ (d)->
d_»ş’
è- &(d)->
d_Çme
[0])

	)

89 
	#_D_ALLOC_NAMLEN
(
d
è( (d)->
d_Çme
 > 1 ?  (d)->d_name : \

90 
	`_D_EXACT_NAMLEN
 (
d
è+ 1)

	)

95 #ifdeà
__USE_BSD


99 
	mDT_UNKNOWN
 = 0,

100 
	#DT_UNKNOWN
 
DT_UNKNOWN


	)

101 
	mDT_FIFO
 = 1,

102 
	#DT_FIFO
 
DT_FIFO


	)

103 
	mDT_CHR
 = 2,

104 
	#DT_CHR
 
DT_CHR


	)

105 
	mDT_DIR
 = 4,

106 
	#DT_DIR
 
DT_DIR


	)

107 
	mDT_BLK
 = 6,

108 
	#DT_BLK
 
DT_BLK


	)

109 
	mDT_REG
 = 8,

110 
	#DT_REG
 
DT_REG


	)

111 
	mDT_LNK
 = 10,

112 
	#DT_LNK
 
DT_LNK


	)

113 
	mDT_SOCK
 = 12,

114 
	#DT_SOCK
 
DT_SOCK


	)

115 
	mDT_WHT
 = 14

116 
	#DT_WHT
 
DT_WHT


	)

120 
	#IFTODT
(
mode
è(((modeè& 0170000è>> 12)

	)

121 
	#DTTOIF
(
dœty³
è((dœty³è<< 12)

	)

127 
__dœ¡»am
 
	tDIR
;

134 
DIR
 *
	$İ’dœ
 (cÚ¡ *
__Çme
è
	`__nÚnuÎ
 ((1));

136 #ifdeà
__USE_XOPEN2K8


141 
DIR
 *
	`fdİ’dœ
 (
__fd
);

149 
	$şo£dœ
 (
DIR
 *
__dœp
è
	`__nÚnuÎ
 ((1));

161 #iâdeà
__USE_FILE_OFFSET64


162 
dœ’t
 *
	$»addœ
 (
DIR
 *
__dœp
è
	`__nÚnuÎ
 ((1));

164 #ifdeà
__REDIRECT


165 
dœ’t
 *
	`__REDIRECT
 (
»addœ
, (
DIR
 *
__dœp
), 
»addœ64
)

166 
	`__nÚnuÎ
 ((1));

168 
	#»addœ
 
»addœ64


	)

172 #ifdeà
__USE_LARGEFILE64


173 
dœ’t64
 *
	$»addœ64
 (
DIR
 *
__dœp
è
	`__nÚnuÎ
 ((1));

176 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


182 #iâdeà
__USE_FILE_OFFSET64


183 
	$»addœ_r
 (
DIR
 *
__»¡riù
 
__dœp
,

184 
dœ’t
 *
__»¡riù
 
__’Œy
,

185 
dœ’t
 **
__»¡riù
 
__»suÉ
)

186 
	`__nÚnuÎ
 ((1, 2, 3));

188 #ifdeà
__REDIRECT


189 
	`__REDIRECT
 (
»addœ_r
,

190 (
DIR
 *
__»¡riù
 
__dœp
,

191 
dœ’t
 *
__»¡riù
 
__’Œy
,

192 
dœ’t
 **
__»¡riù
 
__»suÉ
),

193 
»addœ64_r
è
	`__nÚnuÎ
 ((1, 2, 3));

195 
	#»addœ_r
 
»addœ64_r


	)

199 #ifdeà
__USE_LARGEFILE64


200 
	$»addœ64_r
 (
DIR
 *
__»¡riù
 
__dœp
,

201 
dœ’t64
 *
__»¡riù
 
__’Œy
,

202 
dœ’t64
 **
__»¡riù
 
__»suÉ
)

203 
	`__nÚnuÎ
 ((1, 2, 3));

208 
	$»wšddœ
 (
DIR
 *
__dœp
è
__THROW
 
	`__nÚnuÎ
 ((1));

210 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


211 
	~<b™s/ty³s.h
>

214 
	$£ekdœ
 (
DIR
 *
__dœp
, 
__pos
è
__THROW
 
	`__nÚnuÎ
 ((1));

217 
	$‹Îdœ
 (
DIR
 *
__dœp
è
__THROW
 
	`__nÚnuÎ
 ((1));

220 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN2K8


223 
	$dœfd
 (
DIR
 *
__dœp
è
__THROW
 
	`__nÚnuÎ
 ((1));

225 #ià
defšed
 
__OPTIMIZE__
 && defšed 
_DIR_dœfd


226 
	#dœfd
(
dœp
è
	`_DIR_dœfd
 (dœp)

	)

229 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC


230 #iâdeà
MAXNAMLEN


232 
	~<b™s/posix1_lim.h
>

235 #ifdeà
NAME_MAX


236 
	#MAXNAMLEN
 
NAME_MAX


	)

238 
	#MAXNAMLEN
 255

	)

243 
	#__Ãed_size_t


	)

244 
	~<¡ddef.h
>

253 #iâdeà
__USE_FILE_OFFSET64


254 
	`sÿndœ
 (cÚ¡ *
__»¡riù
 
__dœ
,

255 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

256 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

257 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

258 cÚ¡ 
dœ’t
 **))

259 
	`__nÚnuÎ
 ((1, 2));

261 #ifdeà
__REDIRECT


262 
	`__REDIRECT
 (
sÿndœ
,

263 (cÚ¡ *
__»¡riù
 
__dœ
,

264 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

265 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

266 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

267 cÚ¡ 
dœ’t
 **)),

268 
sÿndœ64
è
	`__nÚnuÎ
 ((1, 2));

270 
	#sÿndœ
 
sÿndœ64


	)

274 #ià
defšed
 
__USE_GNU
 && defšed 
__USE_LARGEFILE64


277 
	`sÿndœ64
 (cÚ¡ *
__»¡riù
 
__dœ
,

278 
dœ’t64
 ***
__»¡riù
 
__Çm–i¡
,

279 (*
__£ËùÜ
è(cÚ¡ 
dœ’t64
 *),

280 (*
__cmp
è(cÚ¡ 
dœ’t64
 **,

281 cÚ¡ 
dœ’t64
 **))

282 
	`__nÚnuÎ
 ((1, 2));

285 #ifdeà
__USE_GNU


291 #iâdeà
__USE_FILE_OFFSET64


292 
	`sÿndœ©
 (
__dfd
, cÚ¡ *
__»¡riù
 
__dœ
,

293 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

294 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

295 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

296 cÚ¡ 
dœ’t
 **))

297 
	`__nÚnuÎ
 ((2, 3));

299 #ifdeà
__REDIRECT


300 
	`__REDIRECT
 (
sÿndœ©
,

301 (
__dfd
, cÚ¡ *
__»¡riù
 
__dœ
,

302 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

303 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

304 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

305 cÚ¡ 
dœ’t
 **)),

306 
sÿndœ©64
è
	`__nÚnuÎ
 ((2, 3));

308 
	#sÿndœ©
 
sÿndœ©64


	)

314 
	`sÿndœ©64
 (
__dfd
, cÚ¡ *
__»¡riù
 
__dœ
,

315 
dœ’t64
 ***
__»¡riù
 
__Çm–i¡
,

316 (*
__£ËùÜ
è(cÚ¡ 
dœ’t64
 *),

317 (*
__cmp
è(cÚ¡ 
dœ’t64
 **,

318 cÚ¡ 
dœ’t64
 **))

319 
	`__nÚnuÎ
 ((2, 3));

323 #iâdeà
__USE_FILE_OFFSET64


324 
	$®phasÜt
 (cÚ¡ 
dœ’t
 **
__e1
,

325 cÚ¡ 
dœ’t
 **
__e2
)

326 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

328 #ifdeà
__REDIRECT


329 
	`__REDIRECT_NTH
 (
®phasÜt
,

330 (cÚ¡ 
dœ’t
 **
__e1
,

331 cÚ¡ 
dœ’t
 **
__e2
),

332 
®phasÜt64
è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

334 
	#®phasÜt
 
®phasÜt64


	)

338 #ià
defšed
 
__USE_GNU
 && defšed 
__USE_LARGEFILE64


339 
	$®phasÜt64
 (cÚ¡ 
dœ’t64
 **
__e1
,

340 cÚ¡ 
dœ’t64
 **
__e2
)

341 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

346 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC


351 #iâdeà
__USE_FILE_OFFSET64


352 
__ssize_t
 
	$g‘dœ’Œ›s
 (
__fd
, *
__»¡riù
 
__buf
,

353 
size_t
 
__nby‹s
,

354 
__off_t
 *
__»¡riù
 
__ba£p
)

355 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

357 #ifdeà
__REDIRECT


358 
__ssize_t
 
	`__REDIRECT_NTH
 (
g‘dœ’Œ›s
,

359 (
__fd
, *
__»¡riù
 
__buf
,

360 
size_t
 
__nby‹s
,

361 
__off64_t
 *
__»¡riù
 
__ba£p
),

362 
g‘dœ’Œ›s64
è
	`__nÚnuÎ
 ((2, 4));

364 
	#g‘dœ’Œ›s
 
g‘dœ’Œ›s64


	)

368 #ifdeà
__USE_LARGEFILE64


369 
__ssize_t
 
	$g‘dœ’Œ›s64
 (
__fd
, *
__»¡riù
 
__buf
,

370 
size_t
 
__nby‹s
,

371 
__off64_t
 *
__»¡riù
 
__ba£p
)

372 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

376 #ifdeà
__USE_GNU


378 #iâdeà
__USE_FILE_OFFSET64


379 
	$v”siÚsÜt
 (cÚ¡ 
dœ’t
 **
__e1
,

380 cÚ¡ 
dœ’t
 **
__e2
)

381 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

383 #ifdeà
__REDIRECT


384 
	`__REDIRECT_NTH
 (
v”siÚsÜt
,

385 (cÚ¡ 
dœ’t
 **
__e1
,

386 cÚ¡ 
dœ’t
 **
__e2
),

387 
v”siÚsÜt64
)

388 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

390 
	#v”siÚsÜt
 
v”siÚsÜt64


	)

394 #ifdeà
__USE_LARGEFILE64


395 
	$v”siÚsÜt64
 (cÚ¡ 
dœ’t64
 **
__e1
,

396 cÚ¡ 
dœ’t64
 **
__e2
)

397 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

401 
__END_DECLS


	@/usr/include/dlfcn.h

19 #iâdef 
_DLFCN_H


20 
	#_DLFCN_H
 1

	)

22 
	~<ã©u»s.h
>

23 
	#__Ãed_size_t


	)

24 
	~<¡ddef.h
>

27 
	~<b™s/dlfú.h
>

30 #ifdeà
__USE_GNU


35 
	#RTLD_NEXT
 ((*è-1l)

	)

40 
	#RTLD_DEFAULT
 ((*è0)

	)

44 
	tLmid_t
;

47 
	#LM_ID_BASE
 0

	)

48 
	#LM_ID_NEWLM
 -1

	)

52 
__BEGIN_DECLS


56 *
	$dlİ’
 (cÚ¡ *
__fe
, 
__mode
è
__THROWNL
;

60 
	$dlşo£
 (*
__hªdË
è
__THROWNL
 
	`__nÚnuÎ
 ((1));

64 *
	$dlsym
 (*
__»¡riù
 
__hªdË
,

65 cÚ¡ *
__»¡riù
 
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((2));

67 #ifdeà
__USE_GNU


69 *
	$dlmİ’
 (
Lmid_t
 
__nsid
, cÚ¡ *
__fe
, 
__mode
è
__THROWNL
;

73 *
	$dlvsym
 (*
__»¡riù
 
__hªdË
,

74 cÚ¡ *
__»¡riù
 
__Çme
,

75 cÚ¡ *
__»¡riù
 
__v”siÚ
)

76 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

82 *
	$dË¼Ü
 (è
__THROW
;

85 #ifdeà
__USE_GNU


90 cÚ¡ *
dli_âame
;

91 *
dli_fba£
;

92 cÚ¡ *
dli_¢ame
;

93 *
dli_§ddr
;

94 } 
	tDl_šfo
;

98 
	$dÏddr
 (cÚ¡ *
__add»ss
, 
Dl_šfo
 *
__šfo
)

99 
__THROW
 
	`__nÚnuÎ
 ((2));

102 
	$dÏddr1
 (cÚ¡ *
__add»ss
, 
Dl_šfo
 *
__šfo
,

103 **
__exŒa_šfo
, 
__æags
è
__THROW
 
	`__nÚnuÎ
 ((2));

111 
RTLD_DL_SYMENT
 = 1,

114 
RTLD_DL_LINKMAP
 = 2

123 
	$dlšfo
 (*
__»¡riù
 
__hªdË
,

124 
__»que¡
, *
__»¡riù
 
__¬g
)

125 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

131 
RTLD_DI_LMID
 = 1,

135 
RTLD_DI_LINKMAP
 = 2,

137 
RTLD_DI_CONFIGADDR
 = 3,

144 
RTLD_DI_SERINFO
 = 4,

145 
RTLD_DI_SERINFOSIZE
 = 5,

149 
RTLD_DI_ORIGIN
 = 6,

151 
RTLD_DI_PROFILENAME
 = 7,

152 
RTLD_DI_PROFILEOUT
 = 8,

157 
RTLD_DI_TLS_MODID
 = 9,

163 
RTLD_DI_TLS_DATA
 = 10,

165 
RTLD_DI_MAX
 = 10

173 *
dls_Çme
;

174 
dls_æags
;

175 } 
	tDl_£½©h
;

181 
size_t
 
dls_size
;

182 
dls_út
;

183 
Dl_£½©h
 
dls_£½©h
[1];

184 } 
	tDl_£ršfo
;

188 
__END_DECLS


	@/usr/include/errno.h

22 #iâdef 
_ERRNO_H


26 #iâdef 
__Ãed_Em©h


27 
	#_ERRNO_H
 1

	)

28 
	~<ã©u»s.h
>

31 
	g__BEGIN_DECLS


35 
	~<b™s/”ºo.h
>

36 #undeà
__Ãed_Em©h


38 #ifdef 
_ERRNO_H


45 #iâdef 
”ºo


46 
”ºo
;

49 #ifdeà
__USE_GNU


54 *
´og¿m_švoÿtiÚ_Çme
, *
´og¿m_švoÿtiÚ_shÜt_Çme
;

58 
	g__END_DECLS


66 #ià
defšed
 
__USE_GNU
 || defšed 
__Ãed_”rÜ_t


67 #iâdeà
__”rÜ_t_defšed


68 
	t”rÜ_t
;

69 
	#__”rÜ_t_defšed
 1

	)

71 #undeà
__Ãed_”rÜ_t


	@/usr/include/error.h

19 #iâdeà
_ERROR_H


20 
	#_ERROR_H
 1

	)

22 
	~<ã©u»s.h
>

25 
__BEGIN_DECLS


31 
	$”rÜ
 (
__¡©us
, 
__”ºum
, cÚ¡ *
__fÜm©
, ...)

32 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

34 
	$”rÜ_©_lše
 (
__¡©us
, 
__”ºum
, cÚ¡ *
__âame
,

35 
__lš’o
, cÚ¡ *
__fÜm©
, ...)

36 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 5, 6)));

41 (*
”rÜ_´št_´ogÇme
) ();

44 
”rÜ_mes§ge_couÁ
;

48 
”rÜ_Úe_³r_lše
;

51 #ià
defšed
 
__ex‹º_®ways_šlše
 && defšed 
__va_¬g_·ck


52 
	~<b™s/”rÜ.h
>

55 
__END_DECLS


	@/usr/include/fcntl.h

22 #iâdef 
_FCNTL_H


23 
	#_FCNTL_H
 1

	)

25 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


31 
	~<b™s/ty³s.h
>

35 
	~<b™s/fú.h
>

40 #iâdeà
__mode_t_defšed


41 
__mode_t
 
	tmode_t
;

42 
	#__mode_t_defšed


	)

45 #iâdeà
__off_t_defšed


46 #iâdeà
__USE_FILE_OFFSET64


47 
__off_t
 
	toff_t
;

49 
__off64_t
 
	toff_t
;

51 
	#__off_t_defšed


	)

54 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


55 
__off64_t
 
	toff64_t
;

56 
	#__off64_t_defšed


	)

59 #iâdeà
__pid_t_defšed


60 
__pid_t
 
	tpid_t
;

61 
	#__pid_t_defšed


	)

65 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


66 
	#__Ãed_time¥ec


	)

67 
	~<time.h
>

68 
	~<b™s/¡©.h
>

70 
	#S_IFMT
 
__S_IFMT


	)

71 
	#S_IFDIR
 
__S_IFDIR


	)

72 
	#S_IFCHR
 
__S_IFCHR


	)

73 
	#S_IFBLK
 
__S_IFBLK


	)

74 
	#S_IFREG
 
__S_IFREG


	)

75 #ifdeà
__S_IFIFO


76 
	#S_IFIFO
 
__S_IFIFO


	)

78 #ifdeà
__S_IFLNK


79 
	#S_IFLNK
 
__S_IFLNK


	)

81 #ià(
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8
è&& defšed 
__S_IFSOCK


82 
	#S_IFSOCK
 
__S_IFSOCK


	)

87 
	#S_ISUID
 
__S_ISUID


	)

88 
	#S_ISGID
 
__S_ISGID


	)

90 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


92 
	#S_ISVTX
 
__S_ISVTX


	)

95 
	#S_IRUSR
 
__S_IREAD


	)

96 
	#S_IWUSR
 
__S_IWRITE


	)

97 
	#S_IXUSR
 
__S_IEXEC


	)

99 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

101 
	#S_IRGRP
 (
S_IRUSR
 >> 3è

	)

102 
	#S_IWGRP
 (
S_IWUSR
 >> 3è

	)

103 
	#S_IXGRP
 (
S_IXUSR
 >> 3è

	)

105 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

107 
	#S_IROTH
 (
S_IRGRP
 >> 3è

	)

108 
	#S_IWOTH
 (
S_IWGRP
 >> 3è

	)

109 
	#S_IXOTH
 (
S_IXGRP
 >> 3è

	)

111 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

114 #ifdef 
__USE_MISC


115 #iâdeà
R_OK


118 
	#R_OK
 4

	)

119 
	#W_OK
 2

	)

120 
	#X_OK
 1

	)

121 
	#F_OK
 0

	)

126 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


127 
	#SEEK_SET
 0

	)

128 
	#SEEK_CUR
 1

	)

129 
	#SEEK_END
 2

	)

137 
fú
 (
__fd
, 
__cmd
, ...);

145 #iâdeà
__USE_FILE_OFFSET64


146 
	$İ’
 (cÚ¡ *
__fe
, 
__oæag
, ...è
	`__nÚnuÎ
 ((1));

148 #ifdeà
__REDIRECT


149 
	`__REDIRECT
 (
İ’
, (cÚ¡ *
__fe
, 
__oæag
, ...), 
İ’64
)

150 
	`__nÚnuÎ
 ((1));

152 
	#İ’
 
İ’64


	)

155 #ifdeà
__USE_LARGEFILE64


156 
	$İ’64
 (cÚ¡ *
__fe
, 
__oæag
, ...è
	`__nÚnuÎ
 ((1));

159 #ifdeà
__USE_ATFILE


169 #iâdeà
__USE_FILE_OFFSET64


170 
	$İ’©
 (
__fd
, cÚ¡ *
__fe
, 
__oæag
, ...)

171 
	`__nÚnuÎ
 ((2));

173 #ifdeà
__REDIRECT


174 
	`__REDIRECT
 (
İ’©
, (
__fd
, cÚ¡ *
__fe
, 
__oæag
,

175 ...), 
İ’©64
è
	`__nÚnuÎ
 ((2));

177 
	#İ’©
 
İ’©64


	)

180 #ifdeà
__USE_LARGEFILE64


181 
	$İ’©64
 (
__fd
, cÚ¡ *
__fe
, 
__oæag
, ...)

182 
	`__nÚnuÎ
 ((2));

191 #iâdeà
__USE_FILE_OFFSET64


192 
	$ü—t
 (cÚ¡ *
__fe
, 
mode_t
 
__mode
è
	`__nÚnuÎ
 ((1));

194 #ifdeà
__REDIRECT


195 
	`__REDIRECT
 (
ü—t
, (cÚ¡ *
__fe
, 
mode_t
 
__mode
),

196 
ü—t64
è
	`__nÚnuÎ
 ((1));

198 
	#ü—t
 
ü—t64


	)

201 #ifdeà
__USE_LARGEFILE64


202 
	$ü—t64
 (cÚ¡ *
__fe
, 
mode_t
 
__mode
è
	`__nÚnuÎ
 ((1));

205 #ià!
defšed
 
F_LOCK
 && (defšed 
__USE_MISC
 || (defšed 
__USE_XOPEN_EXTENDED
 \

206 && !
defšed
 
__USE_POSIX
))

215 
	#F_ULOCK
 0

	)

216 
	#F_LOCK
 1

	)

217 
	#F_TLOCK
 2

	)

218 
	#F_TEST
 3

	)

220 #iâdeà
__USE_FILE_OFFSET64


221 
	`lockf
 (
__fd
, 
__cmd
, 
off_t
 
__Ën
);

223 #ifdeà
__REDIRECT


224 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
), 
lockf64
);

226 
	#lockf
 
lockf64


	)

229 #ifdeà
__USE_LARGEFILE64


230 
	`lockf64
 (
__fd
, 
__cmd
, 
off64_t
 
__Ën
);

234 #ifdeà
__USE_XOPEN2K


237 #iâdeà
__USE_FILE_OFFSET64


238 
	$posix_çdvi£
 (
__fd
, 
off_t
 
__off£t
, off_ˆ
__Ën
,

239 
__advi£
è
__THROW
;

241 #ifdeà
__REDIRECT_NTH


242 
	`__REDIRECT_NTH
 (
posix_çdvi£
, (
__fd
, 
__off64_t
 
__off£t
,

243 
__off64_t
 
__Ën
, 
__advi£
),

244 
posix_çdvi£64
);

246 
	#posix_çdvi£
 
posix_çdvi£64


	)

249 #ifdeà
__USE_LARGEFILE64


250 
	$posix_çdvi£64
 (
__fd
, 
off64_t
 
__off£t
, off64_ˆ
__Ën
,

251 
__advi£
è
__THROW
;

259 #iâdeà
__USE_FILE_OFFSET64


260 
	`posix_çÎoÿ‹
 (
__fd
, 
off_t
 
__off£t
, off_ˆ
__Ën
);

262 #ifdeà
__REDIRECT


263 
	`__REDIRECT
 (
posix_çÎoÿ‹
, (
__fd
, 
__off64_t
 
__off£t
,

264 
__off64_t
 
__Ën
),

265 
posix_çÎoÿ‹64
);

267 
	#posix_çÎoÿ‹
 
posix_çÎoÿ‹64


	)

270 #ifdeà
__USE_LARGEFILE64


271 
	`posix_çÎoÿ‹64
 (
__fd
, 
off64_t
 
__off£t
, off64_ˆ
__Ën
);

277 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ
 \

278 && 
defšed
 
__va_¬g_·ck_Ën


279 
	~<b™s/fú2.h
>

282 
__END_DECLS


	@/usr/include/getopt.h

19 #iâdeà
_GETOPT_H


21 #iâdeà
__Ãed_g‘İt


22 
	#_GETOPT_H
 1

	)

32 #ià!
defšed
 
__GNU_LIBRARY__


33 
	~<ùy³.h
>

36 #iâdeà
__THROW


37 #iâdeà
__GNUC_PREREQ


38 
	#__GNUC_PREREQ
(
maj
, 
mš
è(0)

	)

40 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,8)

41 
	#__THROW
 
	`throw
 ()

	)

43 
	#__THROW


	)

47 #ifdef 
__ılu¥lus


57 *
İrg
;

71 
İtšd
;

76 
İ‹¼
;

80 
İtİt
;

82 #iâdeà
__Ãed_g‘İt


104 
	sİtiÚ


106 cÚ¡ *
	gÇme
;

109 
	ghas_¬g
;

110 *
	gæag
;

111 
	gv®
;

116 
	#no_¬gum’t
 0

	)

117 
	#»quœed_¬gum’t
 1

	)

118 
	#İtiÚ®_¬gum’t
 2

	)

146 #ifdeà
__GNU_LIBRARY__


150 
g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
, cÚ¡ *
__shÜtİts
)

151 
__THROW
;

153 #ià
defšed
 
__Ãed_g‘İt
 && defšed 
__USE_POSIX2
 \

154 && !
defšed
 
	g__USE_POSIX_IMPLICITLY
 && !defšed 
	g__USE_GNU


158 #ifdeà
__REDIRECT


159 
__REDIRECT_NTH
 (
g‘İt
, (
___¬gc
, *cÚ¡ *
___¬gv
,

160 cÚ¡ *
__shÜtİts
),

161 
__posix_g‘İt
);

163 
__posix_g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
,

164 cÚ¡ *
__shÜtİts
è
__THROW
;

165 
	#g‘İt
 
__posix_g‘İt


	)

169 
g‘İt
 ();

172 #iâdeà
__Ãed_g‘İt


173 
g‘İt_lÚg
 (
___¬gc
, *cÚ¡ *
___¬gv
,

174 cÚ¡ *
__shÜtİts
,

175 cÚ¡ 
İtiÚ
 *
__lÚgİts
, *
__lÚgšd
)

176 
__THROW
;

177 
g‘İt_lÚg_Úly
 (
___¬gc
, *cÚ¡ *
___¬gv
,

178 cÚ¡ *
__shÜtİts
,

179 cÚ¡ 
İtiÚ
 *
__lÚgİts
, *
__lÚgšd
)

180 
__THROW
;

184 #ifdef 
__ılu¥lus


189 #undeà
__Ãed_g‘İt


	@/usr/include/inttypes.h

22 #iâdeà
_INTTYPES_H


23 
	#_INTTYPES_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	~<¡dšt.h
>

30 #iâdeà
____gwch¬_t_defšed


31 #ifdeà
__ılu¥lus


32 
	#__gwch¬_t
 
wch¬_t


	)

33 #–ià
defšed
 
__WCHAR_TYPE__


34 
__WCHAR_TYPE__
 
	t__gwch¬_t
;

36 
	#__Ãed_wch¬_t


	)

37 
	~<¡ddef.h
>

38 
wch¬_t
 
	t__gwch¬_t
;

40 
	#____gwch¬_t_defšed
 1

	)

43 #ià
__WORDSIZE
 == 64

44 
	#__PRI64_PREFIX
 "l"

	)

45 
	#__PRIPTR_PREFIX
 "l"

	)

47 
	#__PRI64_PREFIX
 "Î"

	)

48 
	#__PRIPTR_PREFIX


	)

54 
	#PRId8
 "d"

	)

55 
	#PRId16
 "d"

	)

56 
	#PRId32
 "d"

	)

57 
	#PRId64
 
__PRI64_PREFIX
 "d"

	)

59 
	#PRIdLEAST8
 "d"

	)

60 
	#PRIdLEAST16
 "d"

	)

61 
	#PRIdLEAST32
 "d"

	)

62 
	#PRIdLEAST64
 
__PRI64_PREFIX
 "d"

	)

64 
	#PRIdFAST8
 "d"

	)

65 
	#PRIdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

66 
	#PRIdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

67 
	#PRIdFAST64
 
__PRI64_PREFIX
 "d"

	)

70 
	#PRIi8
 "i"

	)

71 
	#PRIi16
 "i"

	)

72 
	#PRIi32
 "i"

	)

73 
	#PRIi64
 
__PRI64_PREFIX
 "i"

	)

75 
	#PRIiLEAST8
 "i"

	)

76 
	#PRIiLEAST16
 "i"

	)

77 
	#PRIiLEAST32
 "i"

	)

78 
	#PRIiLEAST64
 
__PRI64_PREFIX
 "i"

	)

80 
	#PRIiFAST8
 "i"

	)

81 
	#PRIiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

82 
	#PRIiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

83 
	#PRIiFAST64
 
__PRI64_PREFIX
 "i"

	)

86 
	#PRIo8
 "o"

	)

87 
	#PRIo16
 "o"

	)

88 
	#PRIo32
 "o"

	)

89 
	#PRIo64
 
__PRI64_PREFIX
 "o"

	)

91 
	#PRIoLEAST8
 "o"

	)

92 
	#PRIoLEAST16
 "o"

	)

93 
	#PRIoLEAST32
 "o"

	)

94 
	#PRIoLEAST64
 
__PRI64_PREFIX
 "o"

	)

96 
	#PRIoFAST8
 "o"

	)

97 
	#PRIoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

98 
	#PRIoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

99 
	#PRIoFAST64
 
__PRI64_PREFIX
 "o"

	)

102 
	#PRIu8
 "u"

	)

103 
	#PRIu16
 "u"

	)

104 
	#PRIu32
 "u"

	)

105 
	#PRIu64
 
__PRI64_PREFIX
 "u"

	)

107 
	#PRIuLEAST8
 "u"

	)

108 
	#PRIuLEAST16
 "u"

	)

109 
	#PRIuLEAST32
 "u"

	)

110 
	#PRIuLEAST64
 
__PRI64_PREFIX
 "u"

	)

112 
	#PRIuFAST8
 "u"

	)

113 
	#PRIuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

114 
	#PRIuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

115 
	#PRIuFAST64
 
__PRI64_PREFIX
 "u"

	)

118 
	#PRIx8
 "x"

	)

119 
	#PRIx16
 "x"

	)

120 
	#PRIx32
 "x"

	)

121 
	#PRIx64
 
__PRI64_PREFIX
 "x"

	)

123 
	#PRIxLEAST8
 "x"

	)

124 
	#PRIxLEAST16
 "x"

	)

125 
	#PRIxLEAST32
 "x"

	)

126 
	#PRIxLEAST64
 
__PRI64_PREFIX
 "x"

	)

128 
	#PRIxFAST8
 "x"

	)

129 
	#PRIxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

130 
	#PRIxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

131 
	#PRIxFAST64
 
__PRI64_PREFIX
 "x"

	)

134 
	#PRIX8
 "X"

	)

135 
	#PRIX16
 "X"

	)

136 
	#PRIX32
 "X"

	)

137 
	#PRIX64
 
__PRI64_PREFIX
 "X"

	)

139 
	#PRIXLEAST8
 "X"

	)

140 
	#PRIXLEAST16
 "X"

	)

141 
	#PRIXLEAST32
 "X"

	)

142 
	#PRIXLEAST64
 
__PRI64_PREFIX
 "X"

	)

144 
	#PRIXFAST8
 "X"

	)

145 
	#PRIXFAST16
 
__PRIPTR_PREFIX
 "X"

	)

146 
	#PRIXFAST32
 
__PRIPTR_PREFIX
 "X"

	)

147 
	#PRIXFAST64
 
__PRI64_PREFIX
 "X"

	)

151 
	#PRIdMAX
 
__PRI64_PREFIX
 "d"

	)

152 
	#PRIiMAX
 
__PRI64_PREFIX
 "i"

	)

153 
	#PRIoMAX
 
__PRI64_PREFIX
 "o"

	)

154 
	#PRIuMAX
 
__PRI64_PREFIX
 "u"

	)

155 
	#PRIxMAX
 
__PRI64_PREFIX
 "x"

	)

156 
	#PRIXMAX
 
__PRI64_PREFIX
 "X"

	)

160 
	#PRIdPTR
 
__PRIPTR_PREFIX
 "d"

	)

161 
	#PRIiPTR
 
__PRIPTR_PREFIX
 "i"

	)

162 
	#PRIoPTR
 
__PRIPTR_PREFIX
 "o"

	)

163 
	#PRIuPTR
 
__PRIPTR_PREFIX
 "u"

	)

164 
	#PRIxPTR
 
__PRIPTR_PREFIX
 "x"

	)

165 
	#PRIXPTR
 
__PRIPTR_PREFIX
 "X"

	)

171 
	#SCNd8
 "hhd"

	)

172 
	#SCNd16
 "hd"

	)

173 
	#SCNd32
 "d"

	)

174 
	#SCNd64
 
__PRI64_PREFIX
 "d"

	)

176 
	#SCNdLEAST8
 "hhd"

	)

177 
	#SCNdLEAST16
 "hd"

	)

178 
	#SCNdLEAST32
 "d"

	)

179 
	#SCNdLEAST64
 
__PRI64_PREFIX
 "d"

	)

181 
	#SCNdFAST8
 "hhd"

	)

182 
	#SCNdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

183 
	#SCNdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

184 
	#SCNdFAST64
 
__PRI64_PREFIX
 "d"

	)

187 
	#SCNi8
 "hhi"

	)

188 
	#SCNi16
 "hi"

	)

189 
	#SCNi32
 "i"

	)

190 
	#SCNi64
 
__PRI64_PREFIX
 "i"

	)

192 
	#SCNiLEAST8
 "hhi"

	)

193 
	#SCNiLEAST16
 "hi"

	)

194 
	#SCNiLEAST32
 "i"

	)

195 
	#SCNiLEAST64
 
__PRI64_PREFIX
 "i"

	)

197 
	#SCNiFAST8
 "hhi"

	)

198 
	#SCNiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

199 
	#SCNiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

200 
	#SCNiFAST64
 
__PRI64_PREFIX
 "i"

	)

203 
	#SCNu8
 "hhu"

	)

204 
	#SCNu16
 "hu"

	)

205 
	#SCNu32
 "u"

	)

206 
	#SCNu64
 
__PRI64_PREFIX
 "u"

	)

208 
	#SCNuLEAST8
 "hhu"

	)

209 
	#SCNuLEAST16
 "hu"

	)

210 
	#SCNuLEAST32
 "u"

	)

211 
	#SCNuLEAST64
 
__PRI64_PREFIX
 "u"

	)

213 
	#SCNuFAST8
 "hhu"

	)

214 
	#SCNuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

215 
	#SCNuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

216 
	#SCNuFAST64
 
__PRI64_PREFIX
 "u"

	)

219 
	#SCNo8
 "hho"

	)

220 
	#SCNo16
 "ho"

	)

221 
	#SCNo32
 "o"

	)

222 
	#SCNo64
 
__PRI64_PREFIX
 "o"

	)

224 
	#SCNoLEAST8
 "hho"

	)

225 
	#SCNoLEAST16
 "ho"

	)

226 
	#SCNoLEAST32
 "o"

	)

227 
	#SCNoLEAST64
 
__PRI64_PREFIX
 "o"

	)

229 
	#SCNoFAST8
 "hho"

	)

230 
	#SCNoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

231 
	#SCNoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

232 
	#SCNoFAST64
 
__PRI64_PREFIX
 "o"

	)

235 
	#SCNx8
 "hhx"

	)

236 
	#SCNx16
 "hx"

	)

237 
	#SCNx32
 "x"

	)

238 
	#SCNx64
 
__PRI64_PREFIX
 "x"

	)

240 
	#SCNxLEAST8
 "hhx"

	)

241 
	#SCNxLEAST16
 "hx"

	)

242 
	#SCNxLEAST32
 "x"

	)

243 
	#SCNxLEAST64
 
__PRI64_PREFIX
 "x"

	)

245 
	#SCNxFAST8
 "hhx"

	)

246 
	#SCNxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

247 
	#SCNxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

248 
	#SCNxFAST64
 
__PRI64_PREFIX
 "x"

	)

252 
	#SCNdMAX
 
__PRI64_PREFIX
 "d"

	)

253 
	#SCNiMAX
 
__PRI64_PREFIX
 "i"

	)

254 
	#SCNoMAX
 
__PRI64_PREFIX
 "o"

	)

255 
	#SCNuMAX
 
__PRI64_PREFIX
 "u"

	)

256 
	#SCNxMAX
 
__PRI64_PREFIX
 "x"

	)

259 
	#SCNdPTR
 
__PRIPTR_PREFIX
 "d"

	)

260 
	#SCNiPTR
 
__PRIPTR_PREFIX
 "i"

	)

261 
	#SCNoPTR
 
__PRIPTR_PREFIX
 "o"

	)

262 
	#SCNuPTR
 
__PRIPTR_PREFIX
 "u"

	)

263 
	#SCNxPTR
 
__PRIPTR_PREFIX
 "x"

	)

266 
	g__BEGIN_DECLS


268 #ià
__WORDSIZE
 == 64

273 
	mquÙ
;

274 
	m»m
;

275 } 
	timaxdiv_t
;

282 
__ex‹nsiÚ__
 
	mquÙ
;

283 
__ex‹nsiÚ__
 
	m»m
;

284 } 
	timaxdiv_t
;

290 
štmax_t
 
	$imaxabs
 (
štmax_t
 
__n
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

293 
imaxdiv_t
 
	$imaxdiv
 (
štmax_t
 
__num”
, iÁmax_ˆ
__d’om
)

294 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

297 
štmax_t
 
	$¡¹oimax
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

298 **
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

301 
uštmax_t
 
	$¡¹oumax
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

302 ** 
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

305 
štmax_t
 
	$wc¡oimax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

306 
__gwch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

307 
__THROW
;

310 
uštmax_t
 
	$wc¡oumax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

311 
__gwch¬_t
 ** 
__»¡riù
 
__’d±r
, 
__ba£
)

312 
__THROW
;

314 #ifdeà
__USE_EXTERN_INLINES


316 #ià
__WORDSIZE
 == 64

318 
	$__¡¹Ş_š‹º®
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

319 **
__»¡riù
 
__’d±r
,

320 
__ba£
, 
__group
)

321 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

323 
__ex‹º_šlše
 
štmax_t


324 
	`__NTH
 (
	$¡¹oimax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

325 
ba£
))

327  
	`__¡¹Ş_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

328 
	}
}

330 
	$__¡¹oul_š‹º®
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

331 ** 
__»¡riù
 
__’d±r
,

332 
__ba£
, 
__group
)

333 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

335 
__ex‹º_šlše
 
uštmax_t


336 
	`__NTH
 (
	$¡¹oumax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

337 
ba£
))

339  
	`__¡¹oul_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

340 
	}
}

342 
	$__wc¡Ş_š‹º®
 (cÚ¡ 
__gwch¬_t
 * 
__»¡riù
 
__ÅŒ
,

343 
__gwch¬_t
 **
__»¡riù
 
__’d±r
,

344 
__ba£
, 
__group
)

345 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

347 
__ex‹º_šlše
 
štmax_t


348 
	`__NTH
 (
	$wc¡oimax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

349 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

351  
	`__wc¡Ş_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

352 
	}
}

354 
	$__wc¡oul_š‹º®
 (cÚ¡ 
__gwch¬_t
 *

355 
__»¡riù
 
__ÅŒ
,

356 
__gwch¬_t
 **

357 
__»¡riù
 
__’d±r
,

358 
__ba£
, 
__group
)

359 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

361 
__ex‹º_šlše
 
uštmax_t


362 
	`__NTH
 (
	$wc¡oumax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

363 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

365  
	`__wc¡oul_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

366 
	}
}

370 
__ex‹nsiÚ__


371 
	$__¡¹Şl_š‹º®
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

372 **
__»¡riù
 
__’d±r
,

373 
__ba£
, 
__group
)

374 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

376 
__ex‹º_šlše
 
štmax_t


377 
	`__NTH
 (
	$¡¹oimax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

378 
ba£
))

380  
	`__¡¹Şl_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

381 
	}
}

383 
__ex‹nsiÚ__


384 
	$__¡¹ouÎ_š‹º®
 (const *

385 
__»¡riù
 
__ÅŒ
,

387 
__»¡riù
 
__’d±r
,

388 
__ba£
,

389 
__group
)

390 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

392 
__ex‹º_šlše
 
uštmax_t


393 
	`__NTH
 (
	$¡¹oumax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

394 
ba£
))

396  
	`__¡¹ouÎ_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

397 
	}
}

399 
__ex‹nsiÚ__


400 
	$__wc¡Şl_š‹º®
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

401 
__gwch¬_t
 **
__»¡riù
 
__’d±r
,

402 
__ba£
, 
__group
)

403 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

405 
__ex‹º_šlše
 
štmax_t


406 
	`__NTH
 (
	$wc¡oimax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

407 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

409  
	`__wc¡Şl_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

410 
	}
}

413 
__ex‹nsiÚ__


414 
	$__wc¡ouÎ_š‹º®
 (cÚ¡ 
__gwch¬_t
 *

415 
__»¡riù
 
__ÅŒ
,

416 
__gwch¬_t
 **

417 
__»¡riù
 
__’d±r
,

418 
__ba£
,

419 
__group
)

420 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

422 
__ex‹º_šlše
 
uštmax_t


423 
	`__NTH
 (
	$wc¡oumax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

424 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

426  
	`__wc¡ouÎ_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

427 
	}
}

432 
	g__END_DECLS


	@/usr/include/limits.h

22 #iâdeà
_LIBC_LIMITS_H_


23 
	#_LIBC_LIMITS_H_
 1

	)

25 
	~<ã©u»s.h
>

31 
	#MB_LEN_MAX
 16

	)

36 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2

41 #iâdeà
_LIMITS_H


42 
	#_LIMITS_H
 1

	)

44 
	~<b™s/wÜdsize.h
>

53 
	#CHAR_BIT
 8

	)

56 
	#SCHAR_MIN
 (-128)

	)

57 
	#SCHAR_MAX
 127

	)

60 
	#UCHAR_MAX
 255

	)

63 #ifdeà
__CHAR_UNSIGNED__


64 
	#CHAR_MIN
 0

	)

65 
	#CHAR_MAX
 
UCHAR_MAX


	)

67 
	#CHAR_MIN
 
SCHAR_MIN


	)

68 
	#CHAR_MAX
 
SCHAR_MAX


	)

72 
	#SHRT_MIN
 (-32768)

	)

73 
	#SHRT_MAX
 32767

	)

76 
	#USHRT_MAX
 65535

	)

79 
	#INT_MIN
 (-
INT_MAX
 - 1)

	)

80 
	#INT_MAX
 2147483647

	)

83 
	#UINT_MAX
 4294967295U

	)

86 #ià
__WORDSIZE
 == 64

87 
	#LONG_MAX
 9223372036854775807L

	)

89 
	#LONG_MAX
 2147483647L

	)

91 
	#LONG_MIN
 (-
LONG_MAX
 - 1L)

	)

94 #ià
__WORDSIZE
 == 64

95 
	#ULONG_MAX
 18446744073709551615UL

	)

97 
	#ULONG_MAX
 4294967295UL

	)

100 #ifdeà
__USE_ISOC99


103 
	#LLONG_MAX
 9223372036854775807LL

	)

104 
	#LLONG_MIN
 (-
LLONG_MAX
 - 1LL)

	)

107 
	#ULLONG_MAX
 18446744073709551615ULL

	)

121 #ià
defšed
 
__GNUC__
 && !defšed 
_GCC_LIMITS_H_


123 #šşude_Ãxˆ<
lim™s
.
h
>

129 #ià
defšed
 
__USE_ISOC99
 && defšed 
__GNUC__


130 #iâdeà
LLONG_MIN


131 
	#LLONG_MIN
 (-
LLONG_MAX
-1)

	)

133 #iâdeà
LLONG_MAX


134 
	#LLONG_MAX
 
__LONG_LONG_MAX__


	)

136 #iâdeà
ULLONG_MAX


137 
	#ULLONG_MAX
 (
LLONG_MAX
 * 2ULL + 1)

	)

141 #ifdef 
__USE_POSIX


143 
	~<b™s/posix1_lim.h
>

146 #ifdef 
__USE_POSIX2


147 
	~<b™s/posix2_lim.h
>

150 #ifdef 
__USE_XOPEN


151 
	~<b™s/xİ’_lim.h
>

	@/usr/include/malloc.h

19 #iâdeà
_MALLOC_H


20 
	#_MALLOC_H
 1

	)

22 
	~<ã©u»s.h
>

23 
	~<¡ddef.h
>

24 
	~<¡dio.h
>

26 #ifdeà
_LIBC


27 
	#__MALLOC_HOOK_VOLATILE


	)

28 
	#__MALLOC_DEPRECATED


	)

30 
	#__MALLOC_HOOK_VOLATILE
 vŞ©e

	)

31 
	#__MALLOC_DEPRECATED
 
__©Œibu‹_d•»ÿ‹d__


	)

35 
__BEGIN_DECLS


38 *
	$m®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

41 *
	$ÿÎoc
 (
size_t
 
__nmemb
, size_ˆ
__size
)

42 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

49 *
	$»®loc
 (*
__±r
, 
size_t
 
__size
)

50 
__THROW
 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

53 
	$ä“
 (*
__±r
è
__THROW
;

56 
	$cä“
 (*
__±r
è
__THROW
;

59 *
	$mem®ign
 (
size_t
 
__®ignm’t
, size_ˆ
__size
)

60 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

63 *
	$v®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

67 *
	$pv®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

71 *(*
__mÜecÜe
è(
±rdiff_t
 
__size
);

74 *
	$__deçuÉ_mÜecÜe
 (
±rdiff_t
 
__size
)

75 
__THROW
 
__©Œibu‹_m®loc__
;

79 
	sm®lšfo


81 
¬’a
;

82 
Üdblks
;

83 
smblks
;

84 
hblks
;

85 
hblkhd
;

86 
usmblks
;

87 
fsmblks
;

88 
uÜdblks
;

89 
fÜdblks
;

90 
k“pco¡
;

94 
m®lšfo
 
	$m®lšfo
 (è
__THROW
;

97 #iâdeà
M_MXFAST


98 
	#M_MXFAST
 1

	)

100 #iâdeà
M_NLBLKS


101 
	#M_NLBLKS
 2

	)

103 #iâdeà
M_GRAIN


104 
	#M_GRAIN
 3

	)

106 #iâdeà
M_KEEP


107 
	#M_KEEP
 4

	)

111 
	#M_TRIM_THRESHOLD
 -1

	)

112 
	#M_TOP_PAD
 -2

	)

113 
	#M_MMAP_THRESHOLD
 -3

	)

114 
	#M_MMAP_MAX
 -4

	)

115 
	#M_CHECK_ACTION
 -5

	)

116 
	#M_PERTURB
 -6

	)

117 
	#M_ARENA_TEST
 -7

	)

118 
	#M_ARENA_MAX
 -8

	)

121 
	$m®lİt
 (
__·¿m
, 
__v®
è
__THROW
;

125 
	$m®loc_Œim
 (
size_t
 
__·d
è
__THROW
;

129 
size_t
 
	$m®loc_u§bË_size
 (*
__±r
è
__THROW
;

132 
	$m®loc_¡©s
 (è
__THROW
;

135 
	$m®loc_šfo
 (
__İtiÚs
, 
FILE
 *
__å
è
__THROW
;

138 *
	$m®loc_g‘_¡©e
 (è
__THROW
;

142 
	$m®loc_£t_¡©e
 (*
__±r
è
__THROW
;

147 (*
__MALLOC_HOOK_VOLATILE
 
__m®loc_š™Ÿlize_hook
) ()

148 
__MALLOC_DEPRECATED
;

150 (*
__MALLOC_HOOK_VOLATILE
 
__ä“_hook
è(*
__±r
,

152 
__MALLOC_DEPRECATED
;

153 *(*
__MALLOC_HOOK_VOLATILE
 
__m®loc_hook
)(
size_t
 
__size
,

155 
__MALLOC_DEPRECATED
;

156 *(*
__MALLOC_HOOK_VOLATILE
 
__»®loc_hook
)(*
__±r
,

157 
size_t
 
__size
,

159 
__MALLOC_DEPRECATED
;

160 *(*
__MALLOC_HOOK_VOLATILE
 
__mem®ign_hook
)(
size_t
 
__®ignm’t
,

161 
size_t
 
__size
,

163 
__MALLOC_DEPRECATED
;

164 (*
__MALLOC_HOOK_VOLATILE
 
__aá”_mÜecÜe_hook
) ();

167 
	$__m®loc_check_š™
 (è
__THROW
 
__MALLOC_DEPRECATED
;

170 
__END_DECLS


	@/usr/include/math.h

23 #iâdef 
_MATH_H


24 
	#_MATH_H
 1

	)

26 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


32 
	~<b™s/huge_v®.h
>

33 #ifdeà
__USE_ISOC99


34 
	~<b™s/huge_v®f.h
>

35 
	~<b™s/huge_v®l.h
>

38 
	~<b™s/šf.h
>

41 
	~<b™s/Çn.h
>

45 
	~<b™s/m©hdef.h
>

52 
	#__MATHCALL
(
funùiÚ
,
suffix
, 
¬gs
) \

53 
	`__MATHDECL
 (
_MdoubË_
,
funùiÚ
,
suffix
, 
¬gs
)

	)

54 
	#__MATHDECL
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

55 
	`__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
); \

56 
	`__MATHDECL_1
(
ty³
, 
	`__CONCAT
(
__
,
funùiÚ
),
suffix
, 
¬gs
)

	)

57 
	#__MATHCALLX
(
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
) \

58 
	`__MATHDECLX
 (
_MdoubË_
,
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
)

	)

59 
	#__MATHDECLX
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
) \

60 
	`__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
è
	`__©Œibu‹__
 (
©Œib
); \

61 
	`__MATHDECL_1
(
ty³
, 
	`__CONCAT
(
__
,
funùiÚ
),
suffix
, 
¬gs
è
	`__©Œibu‹__
 (
©Œib
)

	)

62 
	#__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

63 
ty³
 
	`__MATH_PRECNAME
(
funùiÚ
,
suffix
è
¬gs
 
__THROW


	)

65 
	#_MdoubË_
 

	)

66 
	#__MATH_PRECNAME
(
Çme
,
r
è
	`__CONCAT
Òame,r)

	)

67 
	#_MdoubË_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_STD


	)

68 
	#_MdoubË_END_NAMESPACE
 
__END_NAMESPACE_STD


	)

69 
	~<b™s/m©hÿÎs.h
>

70 #undeà
_MdoubË_


71 #undeà
_MdoubË_BEGIN_NAMESPACE


72 #undeà
_MdoubË_END_NAMESPACE


73 #undeà
__MATH_PRECNAME


75 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ISOC99


81 #iâdeà
_Mæßt_


82 
	#_Mæßt_
 

	)

84 
	#_MdoubË_
 
_Mæßt_


	)

85 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f
##
	)
r

86 
	#_MdoubË_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

87 
	#_MdoubË_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

88 
	~<b™s/m©hÿÎs.h
>

89 #undeà
_MdoubË_


90 #undeà
_MdoubË_BEGIN_NAMESPACE


91 #undeà
_MdoubË_END_NAMESPACE


92 #undeà
__MATH_PRECNAME


94 #ià!(
defšed
 
__NO_LONG_DOUBLE_MATH
 && defšed 
_LIBC
) \

95 || 
defšed
 
__LDBL_COMPAT


96 #ifdeà
__LDBL_COMPAT


98 #ifdeà
__USE_ISOC99


99 
	$__Ædbl_Ãx‰ow¬df
 (
__x
, 
__y
)

100 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

101 #ifdeà
__REDIRECT_NTH


102 
	`__REDIRECT_NTH
 (
Ãx‰ow¬df
, (
__x
, 
__y
),

103 
__Ædbl_Ãx‰ow¬df
)

104 
	`__©Œibu‹__
 ((
__cÚ¡__
));

105 
	`__REDIRECT_NTH
 (
Ãx‰ow¬d
, (
__x
, 
__y
),

106 
Ãxá”
è
	`__©Œibu‹__
 ((
__cÚ¡__
));

107 
	`__REDIRECT_NTH
 (
Ãx‰ow¬dl
,

108 (
__x
, 
__y
),

109 
Ãxá”
è
	`__©Œibu‹__
 ((
__cÚ¡__
));

113 #undeà
__MATHDECL_1


114 
	#__MATHDECL_2
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
®Ÿs
) \

115 
ty³
 
	`__REDIRECT_NTH
(
	`__MATH_PRECNAME
(
funùiÚ
,
suffix
), \

116 
¬gs
, 
®Ÿs
)

	)

117 
	#__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

118 
	`__MATHDECL_2
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
	`__CONCAT
(funùiÚ,suffix))

	)

124 #iâdeà
_MlÚg_doubË_


125 
	#_MlÚg_doubË_
 

	)

127 
	#_MdoubË_
 
_MlÚg_doubË_


	)

128 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
l
##
	)
r

129 
	#_MdoubË_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

130 
	#_MdoubË_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

131 
	#__MATH_DECLARE_LDOUBLE
 1

	)

132 
	~<b™s/m©hÿÎs.h
>

133 #undeà
_MdoubË_


134 #undeà
_MdoubË_BEGIN_NAMESPACE


135 #undeà
_MdoubË_END_NAMESPACE


136 #undeà
__MATH_PRECNAME


141 #undeà
__MATHDECL_1


142 #undeà
__MATHDECL


143 #undeà
__MATHCALL


146 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


148 
signgam
;

153 #ifdeà
__USE_ISOC99


191 
FP_NAN
 =

192 
	#FP_NAN
 0

	)

193 
FP_NAN
,

194 
FP_INFINITE
 =

195 
	#FP_INFINITE
 1

	)

196 
FP_INFINITE
,

197 
FP_ZERO
 =

198 
	#FP_ZERO
 2

	)

199 
FP_ZERO
,

200 
FP_SUBNORMAL
 =

201 
	#FP_SUBNORMAL
 3

	)

202 
FP_SUBNORMAL
,

203 
FP_NORMAL
 =

204 
	#FP_NORMAL
 4

	)

205 
FP_NORMAL


209 #ifdeà
__NO_LONG_DOUBLE_MATH


210 
	#åşassify
(
x
) \

211 ( (
x
è=ğ (è? 
	`__åşassifyf
 (xè: 
	`__åşassify
 (x))

	)

213 
	#åşassify
(
x
) \

214 ( (
x
) ==  () \

215 ? 
	`__åşassifyf
 (
x
) \

216 :  (
x
) ==  () \

217 ? 
	`__åşassify
 (
x
è: 
	`__åşassifyl
 (x))

	)

221 #ifdeà
__NO_LONG_DOUBLE_MATH


222 
	#signb™
(
x
) \

223 ( (
x
è=ğ (è? 
	`__signb™f
 (xè: 
	`__signb™
 (x))

	)

225 
	#signb™
(
x
) \

226 ( (
x
) ==  () \

227 ? 
	`__signb™f
 (
x
) \

228 :  (
x
) ==  () \

229 ? 
	`__signb™
 (
x
è: 
	`__signb™l
 (x))

	)

233 #ifdeà
__NO_LONG_DOUBLE_MATH


234 
	#isfš™e
(
x
) \

235 ( (
x
è=ğ (è? 
	`__fš™ef
 (xè: 
	`__fš™e
 (x))

	)

237 
	#isfš™e
(
x
) \

238 ( (
x
) ==  () \

239 ? 
	`__fš™ef
 (
x
) \

240 :  (
x
) ==  () \

241 ? 
	`__fš™e
 (
x
è: 
	`__fš™–
 (x))

	)

245 
	#i¢Üm®
(
x
è(
	`åşassify
 (xè=ğ
FP_NORMAL
)

	)

249 #ifdeà
__NO_LONG_DOUBLE_MATH


250 
	#i¢ª
(
x
) \

251 ( (
x
è=ğ (è? 
	`__i¢ªf
 (xè: 
	`__i¢ª
 (x))

	)

253 
	#i¢ª
(
x
) \

254 ( (
x
) ==  () \

255 ? 
	`__i¢ªf
 (
x
) \

256 :  (
x
) ==  () \

257 ? 
	`__i¢ª
 (
x
è: 
	`__i¢ªl
 (x))

	)

261 #ifdeà
__NO_LONG_DOUBLE_MATH


262 
	#isšf
(
x
) \

263 ( (
x
è=ğ (è? 
	`__isšff
 (xè: 
	`__isšf
 (x))

	)

265 
	#isšf
(
x
) \

266 ( (
x
) ==  () \

267 ? 
	`__isšff
 (
x
) \

268 :  (
x
) ==  () \

269 ? 
	`__isšf
 (
x
è: 
	`__isšæ
 (x))

	)

273 
	#MATH_ERRNO
 1

	)

274 
	#MATH_ERREXCEPT
 2

	)

279 #iâdeà
__FAST_MATH__


280 
	#m©h_”rhªdlšg
 (
MATH_ERRNO
 | 
MATH_ERREXCEPT
)

	)

285 #ifdeà
__USE_GNU


287 #ifdeà
__NO_LONG_DOUBLE_MATH


288 
	#issigÇlšg
(
x
) \

289 ( (
x
è=ğ (è? 
	`__issigÇlšgf
 (xè: 
	`__issigÇlšg
 (x))

	)

291 
	#issigÇlšg
(
x
) \

292 ( (
x
) ==  () \

293 ? 
	`__issigÇlšgf
 (
x
) \

294 :  (
x
) ==  () \

295 ? 
	`__issigÇlšg
 (
x
è: 
	`__issigÇlšgl
 (x))

	)

299 #ifdef 
__USE_MISC


303 
_IEEE_
 = -1,

304 
_SVID_
,

305 
_XOPEN_
,

306 
_POSIX_
,

307 
_ISOC_


308 } 
	t_LIB_VERSION_TYPE
;

313 
_LIB_VERSION_TYPE
 
_LIB_VERSION
;

317 #ifdeà
__USE_SVID


323 #ifdeà
__ılu¥lus


324 
__exû±iÚ


326 
exû±iÚ


329 
ty³
;

330 *
Çme
;

331 
¬g1
;

332 
¬g2
;

333 
»tv®
;

334 
	}
};

336 #ifdeà
__ılu¥lus


337 
	$m©h”r
 (
__exû±iÚ
 *
__exc
è
	`throw
 ();

339 
	`m©h”r
 (
exû±iÚ
 *
__exc
);

342 
	#X_TLOSS
 1.41484755040568800000e+16

	)

345 
	#DOMAIN
 1

	)

346 
	#SING
 2

	)

347 
	#OVERFLOW
 3

	)

348 
	#UNDERFLOW
 4

	)

349 
	#TLOSS
 5

	)

350 
	#PLOSS
 6

	)

353 
	#HUGE
 3.40282347e+38F

	)

357 #ifdeà
__USE_XOPEN


359 
	#MAXFLOAT
 3.40282347e+38F

	)

366 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN


367 
	#M_E
 2.7182818284590452354

	)

368 
	#M_LOG2E
 1.4426950408889634074

	)

369 
	#M_LOG10E
 0.43429448190325182765

	)

370 
	#M_LN2
 0.69314718055994530942

	)

371 
	#M_LN10
 2.30258509299404568402

	)

372 
	#M_PI
 3.14159265358979323846

	)

373 
	#M_PI_2
 1.57079632679489661923

	)

374 
	#M_PI_4
 0.78539816339744830962

	)

375 
	#M_1_PI
 0.31830988618379067154

	)

376 
	#M_2_PI
 0.63661977236758134308

	)

377 
	#M_2_SQRTPI
 1.12837916709551257390

	)

378 
	#M_SQRT2
 1.41421356237309504880

	)

379 
	#M_SQRT1_2
 0.70710678118654752440

	)

385 #ifdeà
__USE_GNU


386 
	#M_El
 2.718281828459045235360287471352662498L

	)

387 
	#M_LOG2El
 1.442695040888963407359924681001892137L

	)

388 
	#M_LOG10El
 0.434294481903251827651128918916605082L

	)

389 
	#M_LN2l
 0.693147180559945309417232121458176568L

	)

390 
	#M_LN10l
 2.302585092994045684017991454684364208L

	)

391 
	#M_PIl
 3.141592653589793238462643383279502884L

	)

392 
	#M_PI_2l
 1.570796326794896619231321691639751442L

	)

393 
	#M_PI_4l
 0.785398163397448309615660845819875721L

	)

394 
	#M_1_PIl
 0.318309886183790671537767526745028724L

	)

395 
	#M_2_PIl
 0.636619772367581343075535053490057448L

	)

396 
	#M_2_SQRTPIl
 1.128379167095512573896158903121545172L

	)

397 
	#M_SQRT2l
 1.414213562373095048801688724209698079L

	)

398 
	#M_SQRT1_2l
 0.707106781186547524400844362104849039L

	)

405 #ià
defšed
 
__STRICT_ANSI__
 && !defšed 
__NO_MATH_INLINES


406 
	#__NO_MATH_INLINES
 1

	)

409 #ià
defšed
 
__USE_ISOC99
 && 
	`__GNUC_PREREQ
(2,97)

416 
	#isg»©”
(
x
, 
y
è
	`__butš_isg»©”
(x, y)

	)

417 
	#isg»©”equ®
(
x
, 
y
è
	`__butš_isg»©”equ®
(x, y)

	)

418 
	#i¦ess
(
x
, 
y
è
	`__butš_i¦ess
(x, y)

	)

419 
	#i¦es£qu®
(
x
, 
y
è
	`__butš_i¦es£qu®
(x, y)

	)

420 
	#i¦essg»©”
(
x
, 
y
è
	`__butš_i¦essg»©”
(x, y)

	)

421 
	#isunÜd”ed
(
u
, 
v
è
	`__butš_isunÜd”ed
(u, v)

	)

425 #ifdeà
__USE_EXTERN_INLINES


426 
	~<b™s/m©hšlše.h
>

431 #ià
defšed
 
__FINITE_MATH_ONLY__
 && __FINITE_MATH_ONLY__ > 0

432 
	~<b™s/m©h-fš™e.h
>

435 #ifdeà
__USE_ISOC99


439 #iâdeà
isg»©”


440 
	#isg»©”
(
x
, 
y
) \

441 (
__ex‹nsiÚ__
 \

442 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

443 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x > __y; 
	}
}))

	)

447 #iâdeà
isg»©”equ®


448 
	#isg»©”equ®
(
x
, 
y
) \

449 (
__ex‹nsiÚ__
 \

450 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

451 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x >ğ__y; }))

	)

455 #iâdeà
i¦ess


456 
	#i¦ess
(
x
, 
y
) \

457 (
__ex‹nsiÚ__
 \

458 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

459 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x < __y; }))

	)

463 #iâdeà
i¦es£qu®


464 
	#i¦es£qu®
(
x
, 
y
) \

465 (
__ex‹nsiÚ__
 \

466 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

467 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x <ğ__y; }))

	)

471 #iâdeà
i¦essg»©”


472 
	#i¦essg»©”
(
x
, 
y
) \

473 (
__ex‹nsiÚ__
 \

474 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

475 !
	`isunÜd”ed
 (
__x
, 
__y
è&& (__x < __y || __y < __x); }))

	)

479 #iâdeà
isunÜd”ed


480 
	#isunÜd”ed
(
u
, 
v
) \

481 (
__ex‹nsiÚ__
 \

482 ({ 
	`__ty³of__
(
u
è
__u
 = (u); __ty³of__(
v
è
__v
 = (v); \

483 
	`åşassify
 (
__u
è=ğ
FP_NAN
 || fpşassify (
__v
è=ğFP_NAN; }))

	)

488 
	g__END_DECLS


	@/usr/include/netdb.h

22 #iâdef 
_NETDB_H


23 
	#_NETDB_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	~<Ãtš‘/š.h
>

28 
	~<¡dšt.h
>

29 #ifdeà
__USE_MISC


32 
	~<½c/Ãtdb.h
>

35 #ifdeà
__USE_GNU


36 
	#__Ãed_sigev’t_t


	)

37 
	~<b™s/sigšfo.h
>

38 
	#__Ãed_time¥ec


	)

39 
	~<time.h
>

42 
	~<b™s/Ãtdb.h
>

45 
	#_PATH_HEQUIV
 "/‘c/ho¡s.equiv"

	)

46 
	#_PATH_HOSTS
 "/‘c/ho¡s"

	)

47 
	#_PATH_NETWORKS
 "/‘c/ÃtwÜks"

	)

48 
	#_PATH_NSSWITCH_CONF
 "/‘c/nssw™ch.cÚf"

	)

49 
	#_PATH_PROTOCOLS
 "/‘c/´ÙocŞs"

	)

50 
	#_PATH_SERVICES
 "/‘c/£rviûs"

	)

53 
	g__BEGIN_DECLS


55 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8


58 
	#h_”ºo
 (*
	`__h_”ºo_loÿtiÚ
 ())

	)

61 *
	$__h_”ºo_loÿtiÚ
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

65 
	#HOST_NOT_FOUND
 1

	)

66 
	#TRY_AGAIN
 2

	)

68 
	#NO_RECOVERY
 3

	)

70 
	#NO_DATA
 4

	)

73 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


74 
	#NETDB_INTERNAL
 -1

	)

75 
	#NETDB_SUCCESS
 0

	)

76 
	#NO_ADDRESS
 
NO_DATA


	)

79 #ià
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_XOPEN_EXTENDED


81 
	#IPPORT_RESERVED
 1024

	)

84 #ifdeà
__USE_GNU


86 
	#SCOPE_DELIMITER
 '%'

	)

89 #ifdeà
__USE_MISC


92 
	$h”rÜ
 (cÚ¡ *
__¡r
è
__THROW
;

95 cÚ¡ *
	$h¡»¼Ü
 (
__”r_num
è
__THROW
;

100 
	sho¡’t


102 *
h_Çme
;

103 **
h_®Ÿ£s
;

104 
h_add¹y³
;

105 
h_Ëngth
;

106 **
h_addr_li¡
;

107 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


108 
	#h_addr
 
h_addr_li¡
[0]

	)

117 
	`£tho¡’t
 (
__¡ay_İ’
);

123 
	`’dho¡’t
 ();

130 
ho¡’t
 *
	`g‘ho¡’t
 ();

137 
ho¡’t
 *
	`g‘ho¡byaddr
 (cÚ¡ *
__addr
, 
__sockËn_t
 
__Ën
,

138 
__ty³
);

144 
ho¡’t
 *
	`g‘ho¡byÇme
 (cÚ¡ *
__Çme
);

146 #ifdeà
__USE_MISC


155 
ho¡’t
 *
	`g‘ho¡byÇme2
 (cÚ¡ *
__Çme
, 
__af
);

167 
	`g‘ho¡’t_r
 (
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

168 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

169 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

170 *
__»¡riù
 
__h_”ºİ
);

172 
	`g‘ho¡byaddr_r
 (cÚ¡ *
__»¡riù
 
__addr
, 
__sockËn_t
 
__Ën
,

173 
__ty³
,

174 
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

175 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

176 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

177 *
__»¡riù
 
__h_”ºİ
);

179 
	`g‘ho¡byÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

180 
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

181 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

182 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

183 *
__»¡riù
 
__h_”ºİ
);

185 
	`g‘ho¡byÇme2_r
 (cÚ¡ *
__»¡riù
 
__Çme
, 
__af
,

186 
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

187 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

188 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

189 *
__»¡riù
 
__h_”ºİ
);

198 
	`£Š‘’t
 (
__¡ay_İ’
);

204 
	`’dÃ‹Á
 ();

211 
Ã‹Á
 *
	`g‘Ã‹Á
 ();

218 
Ã‹Á
 *
	`g‘Ãtbyaddr
 (
ušt32_t
 
__Ãt
, 
__ty³
);

224 
Ã‹Á
 *
	`g‘ÃtbyÇme
 (cÚ¡ *
__Çme
);

226 #ifdef 
__USE_MISC


237 
	`g‘Ã‹Á_r
 (
Ã‹Á
 *
__»¡riù
 
__»suÉ_buf
,

238 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

239 
Ã‹Á
 **
__»¡riù
 
__»suÉ
,

240 *
__»¡riù
 
__h_”ºİ
);

242 
	`g‘Ãtbyaddr_r
 (
ušt32_t
 
__Ãt
, 
__ty³
,

243 
Ã‹Á
 *
__»¡riù
 
__»suÉ_buf
,

244 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

245 
Ã‹Á
 **
__»¡riù
 
__»suÉ
,

246 *
__»¡riù
 
__h_”ºİ
);

248 
	`g‘ÃtbyÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

249 
Ã‹Á
 *
__»¡riù
 
__»suÉ_buf
,

250 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

251 
Ã‹Á
 **
__»¡riù
 
__»suÉ
,

252 *
__»¡riù
 
__h_”ºİ
);

257 
	s£rv’t


259 *
s_Çme
;

260 **
s_®Ÿ£s
;

261 
s_pÜt
;

262 *
s_´Ùo
;

270 
	`£t£rv’t
 (
__¡ay_İ’
);

276 
	`’d£rv’t
 ();

283 
£rv’t
 *
	`g‘£rv’t
 ();

290 
£rv’t
 *
	`g‘£rvbyÇme
 (cÚ¡ *
__Çme
, cÚ¡ *
__´Ùo
);

297 
£rv’t
 *
	`g‘£rvbypÜt
 (
__pÜt
, cÚ¡ *
__´Ùo
);

300 #ifdef 
__USE_MISC


308 
	`g‘£rv’t_r
 (
£rv’t
 *
__»¡riù
 
__»suÉ_buf
,

309 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

310 
£rv’t
 **
__»¡riù
 
__»suÉ
);

312 
	`g‘£rvbyÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

313 cÚ¡ *
__»¡riù
 
__´Ùo
,

314 
£rv’t
 *
__»¡riù
 
__»suÉ_buf
,

315 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

316 
£rv’t
 **
__»¡riù
 
__»suÉ
);

318 
	`g‘£rvbypÜt_r
 (
__pÜt
, cÚ¡ *
__»¡riù
 
__´Ùo
,

319 
£rv’t
 *
__»¡riù
 
__»suÉ_buf
,

320 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

321 
£rv’t
 **
__»¡riù
 
__»suÉ
);

326 
	s´ÙÛÁ


328 *
p_Çme
;

329 **
p_®Ÿ£s
;

330 
p_´Ùo
;

338 
	`£rÙÛÁ
 (
__¡ay_İ’
);

344 
	`’d´ÙÛÁ
 ();

351 
´ÙÛÁ
 *
	`g‘´ÙÛÁ
 ();

357 
´ÙÛÁ
 *
	`g‘´ÙobyÇme
 (cÚ¡ *
__Çme
);

363 
´ÙÛÁ
 *
	`g‘´Ùobynumb”
 (
__´Ùo
);

366 #ifdef 
__USE_MISC


374 
	`g‘´ÙÛÁ_r
 (
´ÙÛÁ
 *
__»¡riù
 
__»suÉ_buf
,

375 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

376 
´ÙÛÁ
 **
__»¡riù
 
__»suÉ
);

378 
	`g‘´ÙobyÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

379 
´ÙÛÁ
 *
__»¡riù
 
__»suÉ_buf
,

380 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

381 
´ÙÛÁ
 **
__»¡riù
 
__»suÉ
);

383 
	`g‘´Ùobynumb”_r
 (
__´Ùo
,

384 
´ÙÛÁ
 *
__»¡riù
 
__»suÉ_buf
,

385 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

386 
´ÙÛÁ
 **
__»¡riù
 
__»suÉ
);

395 
	`£Š‘g»Á
 (cÚ¡ *
__Ãtgroup
);

403 
	`’dÃtg»Á
 ();

412 
	`g‘Ãtg»Á
 (**
__»¡riù
 
__ho¡p
,

413 **
__»¡riù
 
__u£½
,

414 **
__»¡riù
 
__domašp
);

423 
	`šÃtgr
 (cÚ¡ *
__Ãtgroup
, cÚ¡ *
__ho¡
,

424 cÚ¡ *
__u£r
, cÚ¡ *
__domaš
);

432 
	`g‘Ãtg»Á_r
 (**
__»¡riù
 
__ho¡p
,

433 **
__»¡riù
 
__u£½
,

434 **
__»¡riù
 
__domašp
,

435 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
);

439 #ifdeà
__USE_BSD


451 
	`rcmd
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

452 cÚ¡ *
__»¡riù
 
__locu£r
,

453 cÚ¡ *
__»¡riù
 
__»mu£r
,

454 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
);

463 
	`rcmd_af
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

464 cÚ¡ *
__»¡riù
 
__locu£r
,

465 cÚ¡ *
__»¡riù
 
__»mu£r
,

466 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
,

467 
§_çmy_t
 
__af
);

479 
	`»xec
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

480 cÚ¡ *
__»¡riù
 
__Çme
,

481 cÚ¡ *
__»¡riù
 
__·ss
,

482 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
);

491 
	`»xec_af
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

492 cÚ¡ *
__»¡riù
 
__Çme
,

493 cÚ¡ *
__»¡riù
 
__·ss
,

494 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
,

495 
§_çmy_t
 
__af
);

505 
	`ru£rok
 (cÚ¡ *
__rho¡
, 
__su£r
,

506 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
);

515 
	`ru£rok_af
 (cÚ¡ *
__rho¡
, 
__su£r
,

516 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
,

517 
§_çmy_t
 
__af
);

528 
	`œu£rok
 (
ušt32_t
 
__¿ddr
, 
__su£r
,

529 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
);

539 
	`œu£rok_af
 (cÚ¡ *
__¿ddr
, 
__su£r
,

540 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
,

541 
§_çmy_t
 
__af
);

551 
	`¼esvpÜt
 (*
__®pÜt
);

560 
	`¼esvpÜt_af
 (*
__®pÜt
, 
§_çmy_t
 
__af
);

565 #ifdef 
__USE_POSIX


567 
	saddršfo


569 
ai_æags
;

570 
ai_çmy
;

571 
ai_sockty³
;

572 
ai_´ÙocŞ
;

573 
sockËn_t
 
ai_add¾’
;

574 
sockaddr
 *
ai_addr
;

575 *
ai_ÿnÚÇme
;

576 
addršfo
 *
ai_Ãxt
;

579 #ifdeà
__USE_GNU


581 
	sgaicb


583 cÚ¡ *
¬_Çme
;

584 cÚ¡ *
¬_£rviû
;

585 cÚ¡ 
addršfo
 *
¬_»que¡
;

586 
addršfo
 *
¬_»suÉ
;

588 
__»tuº
;

589 
__glibc_»£rved
[5];

593 
	#GAI_WAIT
 0

	)

594 
	#GAI_NOWAIT
 1

	)

598 
	#AI_PASSIVE
 0x0001

	)

599 
	#AI_CANONNAME
 0x0002

	)

600 
	#AI_NUMERICHOST
 0x0004

	)

601 
	#AI_V4MAPPED
 0x0008

	)

602 
	#AI_ALL
 0x0010

	)

603 
	#AI_ADDRCONFIG
 0x0020

	)

605 #ifdeà
__USE_GNU


606 
	#AI_IDN
 0x0040

	)

609 
	#AI_CANONIDN
 0x0080

	)

610 
	#AI_IDN_ALLOW_UNASSIGNED
 0x0100

	)

612 
	#AI_IDN_USE_STD3_ASCII_RULES
 0x0200

	)

615 
	#AI_NUMERICSERV
 0x0400

	)

618 
	#EAI_BADFLAGS
 -1

	)

619 
	#EAI_NONAME
 -2

	)

620 
	#EAI_AGAIN
 -3

	)

621 
	#EAI_FAIL
 -4

	)

622 
	#EAI_FAMILY
 -6

	)

623 
	#EAI_SOCKTYPE
 -7

	)

624 
	#EAI_SERVICE
 -8

	)

625 
	#EAI_MEMORY
 -10

	)

626 
	#EAI_SYSTEM
 -11

	)

627 
	#EAI_OVERFLOW
 -12

	)

628 #ifdeà
__USE_GNU


629 
	#EAI_NODATA
 -5

	)

630 
	#EAI_ADDRFAMILY
 -9

	)

631 
	#EAI_INPROGRESS
 -100

	)

632 
	#EAI_CANCELED
 -101

	)

633 
	#EAI_NOTCANCELED
 -102

	)

634 
	#EAI_ALLDONE
 -103

	)

635 
	#EAI_INTR
 -104

	)

636 
	#EAI_IDN_ENCODE
 -105

	)

639 #ifdeà
__USE_MISC


640 
	#NI_MAXHOST
 1025

	)

641 
	#NI_MAXSERV
 32

	)

644 
	#NI_NUMERICHOST
 1

	)

645 
	#NI_NUMERICSERV
 2

	)

646 
	#NI_NOFQDN
 4

	)

647 
	#NI_NAMEREQD
 8

	)

648 
	#NI_DGRAM
 16

	)

649 #ifdeà
__USE_GNU


650 
	#NI_IDN
 32

	)

651 
	#NI_IDN_ALLOW_UNASSIGNED
 64

	)

653 
	#NI_IDN_USE_STD3_ASCII_RULES
 128

	)

662 
	`g‘addršfo
 (cÚ¡ *
__»¡riù
 
__Çme
,

663 cÚ¡ *
__»¡riù
 
__£rviû
,

664 cÚ¡ 
addršfo
 *
__»¡riù
 
__»q
,

665 
addršfo
 **
__»¡riù
 
__·i
);

668 
	$ä“addršfo
 (
addršfo
 *
__ai
è
__THROW
;

671 cÚ¡ *
	$gai_¡»¼Ü
 (
__ecode
è
__THROW
;

677 
	`g‘Çmešfo
 (cÚ¡ 
sockaddr
 *
__»¡riù
 
__§
,

678 
sockËn_t
 
__§Ën
, *
__»¡riù
 
__ho¡
,

679 
sockËn_t
 
__ho¡Ën
, *
__»¡riù
 
__£rv
,

680 
sockËn_t
 
__£rvËn
, 
__æags
);

683 #ifdeà
__USE_GNU


692 
	`g‘addršfo_a
 (
__mode
, 
gaicb
 *
__li¡
[
__»¡riù_¬r
],

693 
__’t
, 
sigev’t
 *
__»¡riù
 
__sig
);

703 
	`gai_su¥’d
 (cÚ¡ 
gaicb
 *cÚ¡ 
__li¡
[], 
__’t
,

704 cÚ¡ 
time¥ec
 *
__timeout
);

707 
	$gai_”rÜ
 (
gaicb
 *
__»q
è
__THROW
;

710 
	$gai_ÿnûl
 (
gaicb
 *
__gaicbp
è
__THROW
;

713 
__END_DECLS


	@/usr/include/netinet/in.h

18 #iâdef 
_NETINET_IN_H


19 
	#_NETINET_IN_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<¡dšt.h
>

23 
	~<sys/sock‘.h
>

24 
	~<b™s/ty³s.h
>

27 
__BEGIN_DECLS


30 
ušt32_t
 
	tš_addr_t
;

31 
	sš_addr


33 
š_addr_t
 
	ms_addr
;

37 
	~<b™s/š.h
>

42 
	mIPPROTO_IP
 = 0,

43 
	#IPPROTO_IP
 
IPPROTO_IP


	)

44 
	mIPPROTO_ICMP
 = 1,

45 
	#IPPROTO_ICMP
 
IPPROTO_ICMP


	)

46 
	mIPPROTO_IGMP
 = 2,

47 
	#IPPROTO_IGMP
 
IPPROTO_IGMP


	)

48 
	mIPPROTO_IPIP
 = 4,

49 
	#IPPROTO_IPIP
 
IPPROTO_IPIP


	)

50 
	mIPPROTO_TCP
 = 6,

51 
	#IPPROTO_TCP
 
IPPROTO_TCP


	)

52 
	mIPPROTO_EGP
 = 8,

53 
	#IPPROTO_EGP
 
IPPROTO_EGP


	)

54 
	mIPPROTO_PUP
 = 12,

55 
	#IPPROTO_PUP
 
IPPROTO_PUP


	)

56 
	mIPPROTO_UDP
 = 17,

57 
	#IPPROTO_UDP
 
IPPROTO_UDP


	)

58 
	mIPPROTO_IDP
 = 22,

59 
	#IPPROTO_IDP
 
IPPROTO_IDP


	)

60 
	mIPPROTO_TP
 = 29,

61 
	#IPPROTO_TP
 
IPPROTO_TP


	)

62 
	mIPPROTO_DCCP
 = 33,

63 
	#IPPROTO_DCCP
 
IPPROTO_DCCP


	)

64 
	mIPPROTO_IPV6
 = 41,

65 
	#IPPROTO_IPV6
 
IPPROTO_IPV6


	)

66 
	mIPPROTO_RSVP
 = 46,

67 
	#IPPROTO_RSVP
 
IPPROTO_RSVP


	)

68 
	mIPPROTO_GRE
 = 47,

69 
	#IPPROTO_GRE
 
IPPROTO_GRE


	)

70 
	mIPPROTO_ESP
 = 50,

71 
	#IPPROTO_ESP
 
IPPROTO_ESP


	)

72 
	mIPPROTO_AH
 = 51,

73 
	#IPPROTO_AH
 
IPPROTO_AH


	)

74 
	mIPPROTO_MTP
 = 92,

75 
	#IPPROTO_MTP
 
IPPROTO_MTP


	)

76 
	mIPPROTO_BEETPH
 = 94,

77 
	#IPPROTO_BEETPH
 
IPPROTO_BEETPH


	)

78 
	mIPPROTO_ENCAP
 = 98,

79 
	#IPPROTO_ENCAP
 
IPPROTO_ENCAP


	)

80 
	mIPPROTO_PIM
 = 103,

81 
	#IPPROTO_PIM
 
IPPROTO_PIM


	)

82 
	mIPPROTO_COMP
 = 108,

83 
	#IPPROTO_COMP
 
IPPROTO_COMP


	)

84 
	mIPPROTO_SCTP
 = 132,

85 
	#IPPROTO_SCTP
 
IPPROTO_SCTP


	)

86 
	mIPPROTO_UDPLITE
 = 136,

87 
	#IPPROTO_UDPLITE
 
IPPROTO_UDPLITE


	)

88 
	mIPPROTO_RAW
 = 255,

89 
	#IPPROTO_RAW
 
IPPROTO_RAW


	)

90 
	mIPPROTO_MAX


96 #iâdeà
__USE_KERNEL_IPV6_DEFS


99 
	mIPPROTO_HOPOPTS
 = 0,

100 
	#IPPROTO_HOPOPTS
 
IPPROTO_HOPOPTS


	)

101 
	mIPPROTO_ROUTING
 = 43,

102 
	#IPPROTO_ROUTING
 
IPPROTO_ROUTING


	)

103 
	mIPPROTO_FRAGMENT
 = 44,

104 
	#IPPROTO_FRAGMENT
 
IPPROTO_FRAGMENT


	)

105 
	mIPPROTO_ICMPV6
 = 58,

106 
	#IPPROTO_ICMPV6
 
IPPROTO_ICMPV6


	)

107 
	mIPPROTO_NONE
 = 59,

108 
	#IPPROTO_NONE
 
IPPROTO_NONE


	)

109 
	mIPPROTO_DSTOPTS
 = 60,

110 
	#IPPROTO_DSTOPTS
 
IPPROTO_DSTOPTS


	)

111 
	mIPPROTO_MH
 = 135

112 
	#IPPROTO_MH
 
IPPROTO_MH


	)

117 
ušt16_t
 
	tš_pÜt_t
;

122 
	mIPPORT_ECHO
 = 7,

123 
	mIPPORT_DISCARD
 = 9,

124 
	mIPPORT_SYSTAT
 = 11,

125 
	mIPPORT_DAYTIME
 = 13,

126 
	mIPPORT_NETSTAT
 = 15,

127 
	mIPPORT_FTP
 = 21,

128 
	mIPPORT_TELNET
 = 23,

129 
	mIPPORT_SMTP
 = 25,

130 
	mIPPORT_TIMESERVER
 = 37,

131 
	mIPPORT_NAMESERVER
 = 42,

132 
	mIPPORT_WHOIS
 = 43,

133 
	mIPPORT_MTP
 = 57,

135 
	mIPPORT_TFTP
 = 69,

136 
	mIPPORT_RJE
 = 77,

137 
	mIPPORT_FINGER
 = 79,

138 
	mIPPORT_TTYLINK
 = 87,

139 
	mIPPORT_SUPDUP
 = 95,

142 
	mIPPORT_EXECSERVER
 = 512,

143 
	mIPPORT_LOGINSERVER
 = 513,

144 
	mIPPORT_CMDSERVER
 = 514,

145 
	mIPPORT_EFSSERVER
 = 520,

148 
	mIPPORT_BIFFUDP
 = 512,

149 
	mIPPORT_WHOSERVER
 = 513,

150 
	mIPPORT_ROUTESERVER
 = 520,

153 
	mIPPORT_RESERVED
 = 1024,

156 
	mIPPORT_USERRESERVED
 = 5000

164 
	#IN_CLASSA
(
a
è((((
š_addr_t
)×)è& 0x80000000è=ğ0)

	)

165 
	#IN_CLASSA_NET
 0xff000000

	)

166 
	#IN_CLASSA_NSHIFT
 24

	)

167 
	#IN_CLASSA_HOST
 (0xfffffffà& ~
IN_CLASSA_NET
)

	)

168 
	#IN_CLASSA_MAX
 128

	)

170 
	#IN_CLASSB
(
a
è((((
š_addr_t
)×)è& 0xc0000000è=ğ0x80000000)

	)

171 
	#IN_CLASSB_NET
 0xffff0000

	)

172 
	#IN_CLASSB_NSHIFT
 16

	)

173 
	#IN_CLASSB_HOST
 (0xfffffffà& ~
IN_CLASSB_NET
)

	)

174 
	#IN_CLASSB_MAX
 65536

	)

176 
	#IN_CLASSC
(
a
è((((
š_addr_t
)×)è& 0xe0000000è=ğ0xc0000000)

	)

177 
	#IN_CLASSC_NET
 0xffffff00

	)

178 
	#IN_CLASSC_NSHIFT
 8

	)

179 
	#IN_CLASSC_HOST
 (0xfffffffà& ~
IN_CLASSC_NET
)

	)

181 
	#IN_CLASSD
(
a
è((((
š_addr_t
)×)è& 0xf0000000è=ğ0xe0000000)

	)

182 
	#IN_MULTICAST
(
a
è
	`IN_CLASSD
×)

	)

184 
	#IN_EXPERIMENTAL
(
a
è((((
š_addr_t
)×)è& 0xe0000000è=ğ0xe0000000)

	)

185 
	#IN_BADCLASS
(
a
è((((
š_addr_t
)×)è& 0xf0000000è=ğ0xf0000000)

	)

188 
	#INADDR_ANY
 ((
š_addr_t
è0x00000000)

	)

190 
	#INADDR_BROADCAST
 ((
š_addr_t
è0xffffffff)

	)

192 
	#INADDR_NONE
 ((
š_addr_t
è0xffffffff)

	)

195 
	#IN_LOOPBACKNET
 127

	)

197 #iâdeà
INADDR_LOOPBACK


198 
	#INADDR_LOOPBACK
 ((
š_addr_t
è0x7f000001è

	)

202 
	#INADDR_UNSPEC_GROUP
 ((
š_addr_t
è0xe0000000è

	)

203 
	#INADDR_ALLHOSTS_GROUP
 ((
š_addr_t
è0xe0000001è

	)

204 
	#INADDR_ALLRTRS_GROUP
 ((
š_addr_t
è0xe0000002è

	)

205 
	#INADDR_MAX_LOCAL_GROUP
 ((
š_addr_t
è0xe00000ffè

	)

207 #iâdeà
__USE_KERNEL_IPV6_DEFS


209 
	sš6_addr


213 
ušt8_t
 
	m__u6_addr8
[16];

214 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


215 
ušt16_t
 
	m__u6_addr16
[8];

216 
ušt32_t
 
	m__u6_addr32
[4];

218 } 
	m__š6_u
;

219 
	#s6_addr
 
__š6_u
.
__u6_addr8


	)

220 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


221 
	#s6_addr16
 
__š6_u
.
__u6_addr16


	)

222 
	#s6_addr32
 
__š6_u
.
__u6_addr32


	)

227 cÚ¡ 
š6_addr
 
š6addr_ªy
;

228 cÚ¡ 
š6_addr
 
š6addr_loİback
;

229 
	#IN6ADDR_ANY_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 } } }

	)

230 
	#IN6ADDR_LOOPBACK_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 } } }

	)

232 
	#INET_ADDRSTRLEN
 16

	)

233 
	#INET6_ADDRSTRLEN
 46

	)

237 
	ssockaddr_š


239 
__SOCKADDR_COMMON
 (
sš_
);

240 
š_pÜt_t
 
	msš_pÜt
;

241 
š_addr
 
	msš_addr
;

244 
	msš_z”o
[ (
sockaddr
) -

245 
__SOCKADDR_COMMON_SIZE
 -

246  (
š_pÜt_t
) -

247  (
š_addr
)];

250 #iâdeà
__USE_KERNEL_IPV6_DEFS


252 
	ssockaddr_š6


254 
__SOCKADDR_COMMON
 (
sš6_
);

255 
š_pÜt_t
 
	msš6_pÜt
;

256 
ušt32_t
 
	msš6_æowšfo
;

257 
š6_addr
 
	msš6_addr
;

258 
ušt32_t
 
	msš6_scİe_id
;

262 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


264 
	s_m»q


267 
š_addr
 
	mimr_muÉŸddr
;

270 
š_addr
 
	mimr_š‹rçû
;

273 
	s_m»q_sourû


276 
š_addr
 
	mimr_muÉŸddr
;

279 
š_addr
 
	mimr_š‹rçû
;

282 
š_addr
 
	mimr_sourûaddr
;

286 #iâdeà
__USE_KERNEL_IPV6_DEFS


288 
	sv6_m»q


291 
š6_addr
 
	mv6mr_muÉŸddr
;

294 
	mv6mr_š‹rçû
;

298 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


300 
	sgroup_»q


303 
ušt32_t
 
	mgr_š‹rçû
;

306 
sockaddr_¡Üage
 
	mgr_group
;

309 
	sgroup_sourû_»q


312 
ušt32_t
 
	mg¤_š‹rçû
;

315 
sockaddr_¡Üage
 
	mg¤_group
;

318 
sockaddr_¡Üage
 
	mg¤_sourû
;

323 
	s_msf‹r


326 
š_addr
 
	mimsf_muÉŸddr
;

329 
š_addr
 
	mimsf_š‹rçû
;

332 
ušt32_t
 
	mimsf_fmode
;

335 
ušt32_t
 
	mimsf_num¤c
;

337 
š_addr
 
	mimsf_¦i¡
[1];

340 
	#IP_MSFILTER_SIZE
(
num¤c
è( (
_msf‹r
) \

341 -  (
š_addr
) \

342 + (
num¤c
è*  (
š_addr
))

	)

344 
	sgroup_f‹r


347 
ušt32_t
 
	mgf_š‹rçû
;

350 
sockaddr_¡Üage
 
	mgf_group
;

353 
ušt32_t
 
	mgf_fmode
;

356 
ušt32_t
 
	mgf_num¤c
;

358 
sockaddr_¡Üage
 
	mgf_¦i¡
[1];

361 
	#GROUP_FILTER_SIZE
(
num¤c
è( (
group_f‹r
) \

362 -  (
sockaddr_¡Üage
) \

363 + ((
num¤c
) \

364 *  (
sockaddr_¡Üage
)))

	)

374 
ušt32_t
 
	$Áohl
 (
ušt32_t
 
__ÃÚg
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

375 
ušt16_t
 
	$Áohs
 (
ušt16_t
 
__ÃtshÜt
)

376 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

377 
ušt32_t
 
	$htÚl
 (
ušt32_t
 
__ho¡lÚg
)

378 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

379 
ušt16_t
 
	$htÚs
 (
ušt16_t
 
__ho¡shÜt
)

380 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

382 
	~<’dŸn.h
>

385 
	~<b™s/by‹sw­.h
>

387 #ifdeà
__OPTIMIZE__


391 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


394 
	#Áohl
(
x
è(x)

	)

395 
	#Áohs
(
x
è(x)

	)

396 
	#htÚl
(
x
è(x)

	)

397 
	#htÚs
(
x
è(x)

	)

399 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


400 
	#Áohl
(
x
è
	`__bsw­_32
 (x)

	)

401 
	#Áohs
(
x
è
	`__bsw­_16
 (x)

	)

402 
	#htÚl
(
x
è
	`__bsw­_32
 (x)

	)

403 
	#htÚs
(
x
è
	`__bsw­_16
 (x)

	)

408 #ifdeà
__GNUC__


409 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

410 (
__ex‹nsiÚ__
 \

411 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

412 
__a
->
s6_addr32
[0] == 0 \

413 && 
__a
->
s6_addr32
[1] == 0 \

414 && 
__a
->
s6_addr32
[2] == 0 \

415 && 
__a
->
s6_addr32
[3] =ğ0; 
	}
}))

	)

417 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

418 (
__ex‹nsiÚ__
 \

419 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

420 
__a
->
s6_addr32
[0] == 0 \

421 && 
__a
->
s6_addr32
[1] == 0 \

422 && 
__a
->
s6_addr32
[2] == 0 \

423 && 
__a
->
s6_addr32
[3] =ğ
	`htÚl
 (1); }))

	)

425 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

426 (
__ex‹nsiÚ__
 \

427 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

428 (
__a
->
s6_addr32
[0] & 
	`htÚl
 (0xffc00000)è=ğhtÚÈ(0xã800000); }))

	)

430 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

431 (
__ex‹nsiÚ__
 \

432 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

433 (
__a
->
s6_addr32
[0] & 
	`htÚl
 (0xffc00000)è=ğhtÚÈ(0xãc00000); }))

	)

435 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

436 (
__ex‹nsiÚ__
 \

437 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

438 
__a
->
s6_addr32
[0] == 0 \

439 && 
__a
->
s6_addr32
[1] == 0 \

440 && 
__a
->
s6_addr32
[2] =ğ
	`htÚl
 (0xffff); }))

	)

442 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

443 (
__ex‹nsiÚ__
 \

444 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

445 
__a
->
s6_addr32
[0] == 0 \

446 && 
__a
->
s6_addr32
[1] == 0 \

447 && 
__a
->
s6_addr32
[2] == 0 \

448 && 
	`Áohl
 (
__a
->
s6_addr32
[3]è> 1; }))

	)

450 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

451 (
__ex‹nsiÚ__
 \

452 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

453 cÚ¡ 
š6_addr
 *
__b
 = (cÚ¡ š6_add¸*è(
b
); \

454 
__a
->
s6_addr32
[0] =ğ
__b
->s6_addr32[0] \

455 && 
__a
->
s6_addr32
[1] =ğ
__b
->s6_addr32[1] \

456 && 
__a
->
s6_addr32
[2] =ğ
__b
->s6_addr32[2] \

457 && 
__a
->
s6_addr32
[3] =ğ
__b
->s6_addr32[3]; }))

	)

459 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

460 (((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0 \

461 && ((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0 \

462 && ((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0 \

463 && ((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ0)

	)

465 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

466 (((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0 \

467 && ((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0 \

468 && ((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0 \

469 && ((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ
	`htÚl
 (1))

	)

471 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

472 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] & 
	`htÚl
 (0xffc00000)) \

473 =ğ
	`htÚl
 (0xã800000))

	)

475 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

476 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] & 
	`htÚl
 (0xffc00000)) \

477 =ğ
	`htÚl
 (0xãc00000))

	)

479 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

480 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0) \

481 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0) \

482 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] =ğ
	`htÚl
 (0xffff)))

	)

484 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

485 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0) \

486 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0) \

487 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0) \

488 && (
	`Áohl
 (((cÚ¡ 
ušt32_t
 *è(
a
))[3]è> 1))

	)

490 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

491 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[0]) \

492 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[1]) \

493 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[2]) \

494 && (((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[3]))

	)

497 
	#IN6_IS_ADDR_MULTICAST
(
a
è(((cÚ¡ 
ušt8_t
 *è×))[0] =ğ0xff)

	)

499 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


501 
	$bšd»svpÜt
 (
__sockfd
, 
sockaddr_š
 *
__sock_š
è
__THROW
;

504 
	$bšd»svpÜt6
 (
__sockfd
, 
sockaddr_š6
 *
__sock_š
)

505 
__THROW
;

509 
	#IN6_IS_ADDR_MC_NODELOCAL
(
a
) \

510 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

511 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x1))

	)

513 
	#IN6_IS_ADDR_MC_LINKLOCAL
(
a
) \

514 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

515 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x2))

	)

517 
	#IN6_IS_ADDR_MC_SITELOCAL
(
a
) \

518 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

519 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x5))

	)

521 
	#IN6_IS_ADDR_MC_ORGLOCAL
(
a
) \

522 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

523 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x8))

	)

525 
	#IN6_IS_ADDR_MC_GLOBAL
(
a
) \

526 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

527 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0xe))

	)

530 #ifdeà
__USE_GNU


531 
cmsghdr
;

534 
	sš6_pktšfo


536 
š6_addr
 
i6_addr
;

537 
i6_ifšdex
;

541 
	s6_mtušfo


543 
sockaddr_š6
 
6m_addr
;

544 
ušt32_t
 
6m_mtu
;

549 
	$š‘6_İtiÚ_¥aû
 (
__nby‹s
)

550 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

551 
	$š‘6_İtiÚ_š™
 (*
__bp
, 
cmsghdr
 **
__cmsgp
,

552 
__ty³
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

553 
	$š‘6_İtiÚ_­³nd
 (
cmsghdr
 *
__cmsg
,

554 cÚ¡ 
ušt8_t
 *
__ty³p
, 
__muÉx
,

555 
__¶usy
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

556 
ušt8_t
 *
	$š‘6_İtiÚ_®loc
 (
cmsghdr
 *
__cmsg
, 
__d©®’
,

557 
__muÉx
, 
__¶usy
)

558 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

559 
	$š‘6_İtiÚ_Ãxt
 (cÚ¡ 
cmsghdr
 *
__cmsg
,

560 
ušt8_t
 **
__Œp
)

561 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

562 
	$š‘6_İtiÚ_fšd
 (cÚ¡ 
cmsghdr
 *
__cmsg
,

563 
ušt8_t
 **
__Œp
, 
__ty³
)

564 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

568 
	$š‘6_İt_š™
 (*
__extbuf
, 
sockËn_t
 
__ex’
è
__THROW
;

569 
	$š‘6_İt_­³nd
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

570 
ušt8_t
 
__ty³
, 
sockËn_t
 
__Ën
, ušt8_ˆ
__®ign
,

571 **
__d©abuå
è
__THROW
;

572 
	$š‘6_İt_fšish
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
)

573 
__THROW
;

574 
	$š‘6_İt_£t_v®
 (*
__d©abuf
, 
__off£t
, *
__v®
,

575 
sockËn_t
 
__v®Ën
è
__THROW
;

576 
	$š‘6_İt_Ãxt
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

577 
ušt8_t
 *
__ty³p
, 
sockËn_t
 *
__ËÅ
,

578 **
__d©abuå
è
__THROW
;

579 
	$š‘6_İt_fšd
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

580 
ušt8_t
 
__ty³
, 
sockËn_t
 *
__ËÅ
,

581 **
__d©abuå
è
__THROW
;

582 
	$š‘6_İt_g‘_v®
 (*
__d©abuf
, 
__off£t
, *
__v®
,

583 
sockËn_t
 
__v®Ën
è
__THROW
;

587 
sockËn_t
 
	$š‘6_¹h_¥aû
 (
__ty³
, 
__£gm’ts
è
__THROW
;

588 *
	$š‘6_¹h_š™
 (*
__bp
, 
sockËn_t
 
__bp_Ën
, 
__ty³
,

589 
__£gm’ts
è
__THROW
;

590 
	$š‘6_¹h_add
 (*
__bp
, cÚ¡ 
š6_addr
 *
__addr
è
__THROW
;

591 
	$š‘6_¹h_»v”£
 (cÚ¡ *
__š
, *
__out
è
__THROW
;

592 
	$š‘6_¹h_£gm’ts
 (cÚ¡ *
__bp
è
__THROW
;

593 
š6_addr
 *
	$š‘6_¹h_g‘addr
 (cÚ¡ *
__bp
, 
__šdex
)

594 
__THROW
;

600 
	$g‘v4sourûf‹r
 (
__s
, 
š_addr
 
__š‹rçû_addr
,

601 
š_addr
 
__group
, 
ušt32_t
 *
__fmode
,

602 
ušt32_t
 *
__num¤c
, 
š_addr
 *
__¦i¡
)

603 
__THROW
;

606 
	$£tv4sourûf‹r
 (
__s
, 
š_addr
 
__š‹rçû_addr
,

607 
š_addr
 
__group
, 
ušt32_t
 
__fmode
,

608 
ušt32_t
 
__num¤c
,

609 cÚ¡ 
š_addr
 *
__¦i¡
)

610 
__THROW
;

614 
	$g‘sourûf‹r
 (
__s
, 
ušt32_t
 
__š‹rçû_addr
,

615 cÚ¡ 
sockaddr
 *
__group
,

616 
sockËn_t
 
__grou¶’
, 
ušt32_t
 *
__fmode
,

617 
ušt32_t
 *
__num¤c
,

618 
sockaddr_¡Üage
 *
__¦i¡
è
__THROW
;

621 
	$£tsourûf‹r
 (
__s
, 
ušt32_t
 
__š‹rçû_addr
,

622 cÚ¡ 
sockaddr
 *
__group
,

623 
sockËn_t
 
__grou¶’
, 
ušt32_t
 
__fmode
,

624 
ušt32_t
 
__num¤c
,

625 cÚ¡ 
sockaddr_¡Üage
 *
__¦i¡
è
__THROW
;

628 
__END_DECLS


	@/usr/include/pthread.h

18 #iâdeà
_PTHREAD_H


19 
	#_PTHREAD_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<’dŸn.h
>

23 
	~<sched.h
>

24 
	~<time.h
>

26 
	~<b™s/±h»adty³s.h
>

27 
	~<b™s/£tjmp.h
>

28 
	~<b™s/wÜdsize.h
>

34 
	mPTHREAD_CREATE_JOINABLE
,

35 
	#PTHREAD_CREATE_JOINABLE
 
PTHREAD_CREATE_JOINABLE


	)

36 
	mPTHREAD_CREATE_DETACHED


37 
	#PTHREAD_CREATE_DETACHED
 
PTHREAD_CREATE_DETACHED


	)

44 
	mPTHREAD_MUTEX_TIMED_NP
,

45 
	mPTHREAD_MUTEX_RECURSIVE_NP
,

46 
	mPTHREAD_MUTEX_ERRORCHECK_NP
,

47 
	mPTHREAD_MUTEX_ADAPTIVE_NP


48 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


50 
	mPTHREAD_MUTEX_NORMAL
 = 
PTHREAD_MUTEX_TIMED_NP
,

51 
	mPTHREAD_MUTEX_RECURSIVE
 = 
PTHREAD_MUTEX_RECURSIVE_NP
,

52 
	mPTHREAD_MUTEX_ERRORCHECK
 = 
PTHREAD_MUTEX_ERRORCHECK_NP
,

53 
	mPTHREAD_MUTEX_DEFAULT
 = 
PTHREAD_MUTEX_NORMAL


55 #ifdeà
__USE_GNU


57 , 
	mPTHREAD_MUTEX_FAST_NP
 = 
PTHREAD_MUTEX_TIMED_NP


62 #ifdeà
__USE_XOPEN2K


66 
	mPTHREAD_MUTEX_STALLED
,

67 
	mPTHREAD_MUTEX_STALLED_NP
 = 
PTHREAD_MUTEX_STALLED
,

68 
	mPTHREAD_MUTEX_ROBUST
,

69 
	mPTHREAD_MUTEX_ROBUST_NP
 = 
PTHREAD_MUTEX_ROBUST


74 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


78 
	mPTHREAD_PRIO_NONE
,

79 
	mPTHREAD_PRIO_INHERIT
,

80 
	mPTHREAD_PRIO_PROTECT


86 #ià
__PTHREAD_MUTEX_HAVE_ELISION
 == 1

87 
	#__PTHREAD_SPINS
 0, 0

	)

88 #–ià
__PTHREAD_MUTEX_HAVE_ELISION
 == 2

89 
	#__PTHREAD_SPINS
 { 0, 0 }

	)

91 
	#__PTHREAD_SPINS
 0

	)

94 #ifdeà
__PTHREAD_MUTEX_HAVE_PREV


95 
	#PTHREAD_MUTEX_INITIALIZER
 \

96 { { 0, 0, 0, 0, 0, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

97 #ifdeà
__USE_GNU


98 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

99 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

100 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

101 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

102 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

103 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

104 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

105 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

109 
	#PTHREAD_MUTEX_INITIALIZER
 \

110 { { 0, 0, 0, 0, 0, { 
__PTHREAD_SPINS
 } } }

	)

111 #ifdeà
__USE_GNU


112 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

113 { { 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

114 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

115 { { 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

116 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

117 { { 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

124 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


127 
	mPTHREAD_RWLOCK_PREFER_READER_NP
,

128 
	mPTHREAD_RWLOCK_PREFER_WRITER_NP
,

129 
	mPTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,

130 
	mPTHREAD_RWLOCK_DEFAULT_NP
 = 
PTHREAD_RWLOCK_PREFER_READER_NP


136 #iâdeà
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


137 #ià
__WORDSIZE
 == 64

138 
	#__PTHREAD_RWLOCK_INT_FLAGS_SHARED
 1

	)

143 
	#PTHREAD_RWLOCK_INITIALIZER
 \

144 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } }

	)

145 #ifdeà
__USE_GNU


146 #ifdeà
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


147 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

149 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
 } }

	)

151 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


152 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

153 { { 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
, \

154 0, 0, 0, 0 } }

	)

156 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

157 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,\

158 0 } }

	)

168 
	mPTHREAD_INHERIT_SCHED
,

169 
	#PTHREAD_INHERIT_SCHED
 
PTHREAD_INHERIT_SCHED


	)

170 
	mPTHREAD_EXPLICIT_SCHED


171 
	#PTHREAD_EXPLICIT_SCHED
 
PTHREAD_EXPLICIT_SCHED


	)

178 
	mPTHREAD_SCOPE_SYSTEM
,

179 
	#PTHREAD_SCOPE_SYSTEM
 
PTHREAD_SCOPE_SYSTEM


	)

180 
	mPTHREAD_SCOPE_PROCESS


181 
	#PTHREAD_SCOPE_PROCESS
 
PTHREAD_SCOPE_PROCESS


	)

188 
	mPTHREAD_PROCESS_PRIVATE
,

189 
	#PTHREAD_PROCESS_PRIVATE
 
PTHREAD_PROCESS_PRIVATE


	)

190 
	mPTHREAD_PROCESS_SHARED


191 
	#PTHREAD_PROCESS_SHARED
 
PTHREAD_PROCESS_SHARED


	)

197 
	#PTHREAD_COND_INITIALIZER
 { { 0, 0, 0, 0, 0, (*è0, 0, 0 } }

	)

201 
	s_±h»ad_ş—nup_bufãr


203 (*
	m__routše
) (*);

204 *
	m__¬g
;

205 
	m__ÿnûÉy³
;

206 
_±h»ad_ş—nup_bufãr
 *
	m__´ev
;

212 
	mPTHREAD_CANCEL_ENABLE
,

213 
	#PTHREAD_CANCEL_ENABLE
 
PTHREAD_CANCEL_ENABLE


	)

214 
	mPTHREAD_CANCEL_DISABLE


215 
	#PTHREAD_CANCEL_DISABLE
 
PTHREAD_CANCEL_DISABLE


	)

219 
	mPTHREAD_CANCEL_DEFERRED
,

220 
	#PTHREAD_CANCEL_DEFERRED
 
PTHREAD_CANCEL_DEFERRED


	)

221 
	mPTHREAD_CANCEL_ASYNCHRONOUS


222 
	#PTHREAD_CANCEL_ASYNCHRONOUS
 
PTHREAD_CANCEL_ASYNCHRONOUS


	)

224 
	#PTHREAD_CANCELED
 ((*è-1)

	)

228 
	#PTHREAD_ONCE_INIT
 0

	)

231 #ifdeà
__USE_XOPEN2K


235 
	#PTHREAD_BARRIER_SERIAL_THREAD
 -1

	)

239 
__BEGIN_DECLS


244 
±h»ad_ü—‹
 (
±h»ad_t
 *
__»¡riù
 
__Ãwth»ad
,

245 cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

246 *(*
__¡¬t_routše
) (*),

247 *
__»¡riù
 
__¬g
è
__THROWNL
 
__nÚnuÎ
 ((1, 3));

253 
	$±h»ad_ex™
 (*
__»tv®
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

261 
	`±h»ad_još
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
);

263 #ifdeà
__USE_GNU


266 
	$±h»ad_Œyjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
è
__THROW
;

274 
	`±h»ad_timedjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
,

275 cÚ¡ 
time¥ec
 *
__ab¡ime
);

282 
	$±h»ad_d‘ach
 (
±h»ad_t
 
__th
è
__THROW
;

286 
±h»ad_t
 
	$±h»ad_£lf
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

289 
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
)

290 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

298 
	$±h»ad_©Œ_š™
 (
±h»ad_©Œ_t
 *
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

301 
	$±h»ad_©Œ_de¡roy
 (
±h»ad_©Œ_t
 *
__©Œ
)

302 
__THROW
 
	`__nÚnuÎ
 ((1));

305 
	$±h»ad_©Œ_g‘d‘ach¡©e
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

306 *
__d‘ach¡©e
)

307 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

310 
	$±h»ad_©Œ_£td‘ach¡©e
 (
±h»ad_©Œ_t
 *
__©Œ
,

311 
__d‘ach¡©e
)

312 
__THROW
 
	`__nÚnuÎ
 ((1));

316 
	$±h»ad_©Œ_g‘gu¬dsize
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

317 
size_t
 *
__gu¬dsize
)

318 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

321 
	$±h»ad_©Œ_£tgu¬dsize
 (
±h»ad_©Œ_t
 *
__©Œ
,

322 
size_t
 
__gu¬dsize
)

323 
__THROW
 
	`__nÚnuÎ
 ((1));

327 
	$±h»ad_©Œ_g‘sched·¿m
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

328 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

329 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

332 
	$±h»ad_©Œ_£tsched·¿m
 (
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

333 cÚ¡ 
sched_·¿m
 *
__»¡riù


334 
__·¿m
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

337 
	$±h»ad_©Œ_g‘schedpŞicy
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


338 
__©Œ
, *
__»¡riù
 
__pŞicy
)

339 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

342 
	$±h»ad_©Œ_£tschedpŞicy
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__pŞicy
)

343 
__THROW
 
	`__nÚnuÎ
 ((1));

346 
	$±h»ad_©Œ_g‘šh”™sched
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


347 
__©Œ
, *
__»¡riù
 
__šh”™
)

348 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

351 
	$±h»ad_©Œ_£tšh”™sched
 (
±h»ad_©Œ_t
 *
__©Œ
,

352 
__šh”™
)

353 
__THROW
 
	`__nÚnuÎ
 ((1));

357 
	$±h»ad_©Œ_g‘scİe
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

358 *
__»¡riù
 
__scİe
)

359 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

362 
	$±h»ad_©Œ_£tscİe
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__scİe
)

363 
__THROW
 
	`__nÚnuÎ
 ((1));

366 
	$±h»ad_©Œ_g‘¡ackaddr
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


367 
__©Œ
, **
__»¡riù
 
__¡ackaddr
)

368 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__©Œibu‹_d•»ÿ‹d__
;

374 
	$±h»ad_©Œ_£t¡ackaddr
 (
±h»ad_©Œ_t
 *
__©Œ
,

375 *
__¡ackaddr
)

376 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
;

379 
	$±h»ad_©Œ_g‘¡acksize
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


380 
__©Œ
, 
size_t
 *
__»¡riù
 
__¡acksize
)

381 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

386 
	$±h»ad_©Œ_£t¡acksize
 (
±h»ad_©Œ_t
 *
__©Œ
,

387 
size_t
 
__¡acksize
)

388 
__THROW
 
	`__nÚnuÎ
 ((1));

390 #ifdeà
__USE_XOPEN2K


392 
	$±h»ad_©Œ_g‘¡ack
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

393 **
__»¡riù
 
__¡ackaddr
,

394 
size_t
 *
__»¡riù
 
__¡acksize
)

395 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

400 
	$±h»ad_©Œ_£t¡ack
 (
±h»ad_©Œ_t
 *
__©Œ
, *
__¡ackaddr
,

401 
size_t
 
__¡acksize
è
__THROW
 
	`__nÚnuÎ
 ((1));

404 #ifdeà
__USE_GNU


407 
	$±h»ad_©Œ_£ffš™y_Å
 (
±h»ad_©Œ_t
 *
__©Œ
,

408 
size_t
 
__ıu£tsize
,

409 cÚ¡ 
ıu_£t_t
 *
__ıu£t
)

410 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

414 
	$±h»ad_©Œ_g‘affš™y_Å
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

415 
size_t
 
__ıu£tsize
,

416 
ıu_£t_t
 *
__ıu£t
)

417 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

420 
	$±h»ad_g‘©Œ_deçuÉ_Å
 (
±h»ad_©Œ_t
 *
__©Œ
)

421 
__THROW
 
	`__nÚnuÎ
 ((1));

425 
	$±h»ad_£‰r_deçuÉ_Å
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
)

426 
__THROW
 
	`__nÚnuÎ
 ((1));

431 
	$±h»ad_g‘©Œ_Å
 (
±h»ad_t
 
__th
, 
±h»ad_©Œ_t
 *
__©Œ
)

432 
__THROW
 
	`__nÚnuÎ
 ((2));

440 
	$±h»ad_£tsched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
, 
__pŞicy
,

441 cÚ¡ 
sched_·¿m
 *
__·¿m
)

442 
__THROW
 
	`__nÚnuÎ
 ((3));

445 
	$±h»ad_g‘sched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
,

446 *
__»¡riù
 
__pŞicy
,

447 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

448 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

451 
	$±h»ad_£tsched´io
 (
±h»ad_t
 
__rg‘_th»ad
, 
__´io
)

452 
__THROW
;

455 #ifdeà
__USE_GNU


457 
	$±h»ad_g‘Çme_Å
 (
±h»ad_t
 
__rg‘_th»ad
, *
__buf
,

458 
size_t
 
__buæ’
)

459 
__THROW
 
	`__nÚnuÎ
 ((2));

462 
	$±h»ad_£Šame_Å
 (
±h»ad_t
 
__rg‘_th»ad
, cÚ¡ *
__Çme
)

463 
__THROW
 
	`__nÚnuÎ
 ((2));

467 #ifdeà
__USE_UNIX98


469 
	$±h»ad_g‘cÚcu¼’cy
 (è
__THROW
;

472 
	$±h»ad_£tcÚcu¼’cy
 (
__Ëv–
è
__THROW
;

475 #ifdeà
__USE_GNU


480 
	$±h»ad_y›ld
 (è
__THROW
;

485 
	$±h»ad_£ffš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

486 cÚ¡ 
ıu_£t_t
 *
__ıu£t
)

487 
__THROW
 
	`__nÚnuÎ
 ((3));

490 
	$±h»ad_g‘affš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

491 
ıu_£t_t
 *
__ıu£t
)

492 
__THROW
 
	`__nÚnuÎ
 ((3));

505 
	`±h»ad_Úû
 (
±h»ad_Úû_t
 *
__Úû_cÚŒŞ
,

506 (*
__š™_routše
è()è
	`__nÚnuÎ
 ((1, 2));

517 
	`±h»ad_£tÿnûl¡©e
 (
__¡©e
, *
__Şd¡©e
);

521 
	`±h»ad_£tÿnûÉy³
 (
__ty³
, *
__Şdty³
);

524 
	`±h»ad_ÿnûl
 (
±h»ad_t
 
__th
);

529 
	`±h»ad_‹¡ÿnûl
 ();

538 
__jmp_buf
 
__ÿnûl_jmp_buf
;

539 
__mask_was_§ved
;

540 } 
__ÿnûl_jmp_buf
[1];

541 *
__·d
[4];

542 } 
	t__±h»ad_unwšd_buf_t
 
	t__©Œibu‹__
 ((
	t__®igÃd__
));

545 #iâdeà
__ş—nup_fù_©Œibu‹


546 
	#__ş—nup_fù_©Œibu‹


	)

551 
	s__±h»ad_ş—nup_äame


553 (*
__ÿnûl_routše
) (*);

554 *
__ÿnûl_¬g
;

555 
__do_™
;

556 
__ÿnûl_ty³
;

559 #ià
defšed
 
__GNUC__
 && defšed 
__EXCEPTIONS


560 #ifdeà
__ılu¥lus


562 şas 
	c__±h»ad_ş—nup_şass


564 (*
__ÿnûl_routše
) (*);

565 *
__ÿnûl_¬g
;

566 
__do_™
;

567 
__ÿnûl_ty³
;

569 
public
:

570 
	`__±h»ad_ş—nup_şass
 ((*
__fù
è(*), *
__¬g
)

571 : 
	`__ÿnûl_routše
 (
__fù
), 
	`__ÿnûl_¬g
 (
__¬g
), 
	$__do_™
 (1) { }

572 ~
	$__±h»ad_ş—nup_şass
 (è{ ià(
__do_™
è
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); 
	}
}

573 
	$__£tdo™
 (
__Ãwv®
è{ 
__do_™
 = __Ãwv®; 
	}
}

574 
	$__deãr
 (è{ 
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
,

575 &
__ÿnûl_ty³
); 
	}
}

576 
	$__»¡Üe
 (ècÚ¡ { 
	`±h»ad_£tÿnûÉy³
 (
__ÿnûl_ty³
, 0); 
	}
}

586 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

588 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
)

	)

592 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

593 
__şäame
.
	`__£tdo™
 (
execu‹
); \

594 } 0)

	)

596 #ifdeà
__USE_GNU


600 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

602 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
); \

603 
__şäame
.
	`__deãr
 ()

	)

608 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

609 
__şäame
.
	`__»¡Üe
 (); \

610 
__şäame
.
	`__£tdo™
 (
execu‹
); \

611 } 0)

	)

618 
__ex‹º_šlše
 

619 
	$__±h»ad_ş—nup_routše
 (
__±h»ad_ş—nup_äame
 *
__äame
)

621 ià(
__äame
->
__do_™
)

622 
__äame
->
	`__ÿnûl_routše
 (__äame->
__ÿnûl_¬g
);

623 
	}
}

632 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

634 
__±h»ad_ş—nup_äame
 
__şäame
 \

635 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

636 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

637 .
__do_™
 = 1 };

	)

641 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

642 
__şäame
.
__do_™
 = (
execu‹
); \

643 } 0)

	)

645 #ifdeà
__USE_GNU


649 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

651 
__±h»ad_ş—nup_äame
 
__şäame
 \

652 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

653 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

654 .
__do_™
 = 1 }; \

655 (è
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
, \

656 &
__şäame
.
__ÿnûl_ty³
)

	)

661 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

662 (è
	`±h»ad_£tÿnûÉy³
 (
__şäame
.
__ÿnûl_ty³
, 
NULL
); \

663 
__şäame
.
__do_™
 = (
execu‹
); \

664 } 0)

	)

675 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

677 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

678 (*
__ÿnûl_routše
è(*èğ(
routše
); \

679 *
__ÿnûl_¬g
 = (
¬g
); \

680 
__nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) (*) \

681 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

682 ià(
	`__glibc_uÆik–y
 (
__nÙ_fœ¡_ÿÎ
)) \

684 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

685 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

689 
	`__±h»ad_»gi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

690 dØ{

	)

691 
__±h»ad_»gi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

692 
__ş—nup_fù_©Œibu‹
;

696 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

699 
	`__±h»ad_uÄegi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

700 ià(
execu‹
) \

701 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

702 } 0)

	)

703 
	$__±h»ad_uÄegi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

704 
__ş—nup_fù_©Œibu‹
;

706 #ifdeà
__USE_GNU


710 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

712 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

713 (*
__ÿnûl_routše
è(*èğ(
routše
); \

714 *
__ÿnûl_¬g
 = (
¬g
); \

715 
__nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) (*) \

716 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

717 ià(
	`__glibc_uÆik–y
 (
__nÙ_fœ¡_ÿÎ
)) \

719 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

720 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

724 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (&
__ÿnûl_buf
); \

725 dØ{

	)

726 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

727 
__ş—nup_fù_©Œibu‹
;

732 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

735 
	`__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (&
__ÿnûl_buf
); \

736 ià(
execu‹
) \

737 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

738 
	}
} 0)

	)

739 
	$__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

740 
__ş—nup_fù_©Œibu‹
;

744 
	$__±h»ad_unwšd_Ãxt
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

745 
__ş—nup_fù_©Œibu‹
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
))

746 #iâdeà
SHARED


747 
	`__©Œibu‹__
 ((
__w—k__
))

753 
__jmp_buf_g
;

754 
	$__sig£tjmp
 (
__jmp_buf_g
 *
__’v
, 
__§vemask
è
__THROWNL
;

760 
	$±h»ad_mu‹x_š™
 (
±h»ad_mu‹x_t
 *
__mu‹x
,

761 cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__mu‹x©Œ
)

762 
__THROW
 
	`__nÚnuÎ
 ((1));

765 
	$±h»ad_mu‹x_de¡roy
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

766 
__THROW
 
	`__nÚnuÎ
 ((1));

769 
	$±h»ad_mu‹x_Œylock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

770 
__THROWNL
 
	`__nÚnuÎ
 ((1));

773 
	$±h»ad_mu‹x_lock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

774 
__THROWNL
 
	`__nÚnuÎ
 ((1));

776 #ifdeà
__USE_XOPEN2K


778 
	$±h»ad_mu‹x_timedlock
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

779 cÚ¡ 
time¥ec
 *
__»¡riù


780 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

784 
	$±h»ad_mu‹x_uÆock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

785 
__THROWNL
 
	`__nÚnuÎ
 ((1));

789 
	$±h»ad_mu‹x_g‘´ioûšg
 (cÚ¡ 
±h»ad_mu‹x_t
 *

790 
__»¡riù
 
__mu‹x
,

791 *
__»¡riù
 
__´ioûšg
)

792 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

796 
	$±h»ad_mu‹x_£rioûšg
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

797 
__´ioûšg
,

798 *
__»¡riù
 
__Şd_ûšg
)

799 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

802 #ifdeà
__USE_XOPEN2K8


804 
	$±h»ad_mu‹x_cÚsi¡’t
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

805 
__THROW
 
	`__nÚnuÎ
 ((1));

806 #ifdeà
__USE_GNU


807 
	$±h»ad_mu‹x_cÚsi¡’t_Å
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

808 
__THROW
 
	`__nÚnuÎ
 ((1));

817 
	$±h»ad_mu‹x©Œ_š™
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

818 
__THROW
 
	`__nÚnuÎ
 ((1));

821 
	$±h»ad_mu‹x©Œ_de¡roy
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

822 
__THROW
 
	`__nÚnuÎ
 ((1));

825 
	$±h»ad_mu‹x©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

826 
__»¡riù
 
__©Œ
,

827 *
__»¡riù
 
__psh¬ed
)

828 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

831 
	$±h»ad_mu‹x©Œ_£sh¬ed
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

832 
__psh¬ed
)

833 
__THROW
 
	`__nÚnuÎ
 ((1));

835 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


837 
	$±h»ad_mu‹x©Œ_g‘ty³
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__»¡riù


838 
__©Œ
, *
__»¡riù
 
__kšd
)

839 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

844 
	$±h»ad_mu‹x©Œ_£‰y³
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
, 
__kšd
)

845 
__THROW
 
	`__nÚnuÎ
 ((1));

849 
	$±h»ad_mu‹x©Œ_g‘´ÙocŞ
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

850 
__»¡riù
 
__©Œ
,

851 *
__»¡riù
 
__´ÙocŞ
)

852 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

856 
	$±h»ad_mu‹x©Œ_£rÙocŞ
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

857 
__´ÙocŞ
)

858 
__THROW
 
	`__nÚnuÎ
 ((1));

861 
	$±h»ad_mu‹x©Œ_g‘´ioûšg
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

862 
__»¡riù
 
__©Œ
,

863 *
__»¡riù
 
__´ioûšg
)

864 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

867 
	$±h»ad_mu‹x©Œ_£rioûšg
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

868 
__´ioûšg
)

869 
__THROW
 
	`__nÚnuÎ
 ((1));

871 #ifdeà
__USE_XOPEN2K


873 
	$±h»ad_mu‹x©Œ_g‘robu¡
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

874 *
__robu¡Ãss
)

875 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

876 #ifdeà
__USE_GNU


877 
	$±h»ad_mu‹x©Œ_g‘robu¡_Å
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

878 *
__robu¡Ãss
)

879 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

883 
	$±h»ad_mu‹x©Œ_£Œobu¡
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

884 
__robu¡Ãss
)

885 
__THROW
 
	`__nÚnuÎ
 ((1));

886 #ifdeà
__USE_GNU


887 
	$±h»ad_mu‹x©Œ_£Œobu¡_Å
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

888 
__robu¡Ãss
)

889 
__THROW
 
	`__nÚnuÎ
 ((1));

894 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


899 
	$±h»ad_rwlock_š™
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

900 cÚ¡ 
±h»ad_rwlock©Œ_t
 *
__»¡riù


901 
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

904 
	$±h»ad_rwlock_de¡roy
 (
±h»ad_rwlock_t
 *
__rwlock
)

905 
__THROW
 
	`__nÚnuÎ
 ((1));

908 
	$±h»ad_rwlock_rdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

909 
__THROWNL
 
	`__nÚnuÎ
 ((1));

912 
	$±h»ad_rwlock_Œyrdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

913 
__THROWNL
 
	`__nÚnuÎ
 ((1));

915 #ifdeà
__USE_XOPEN2K


917 
	$±h»ad_rwlock_timedrdlock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

918 cÚ¡ 
time¥ec
 *
__»¡riù


919 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

923 
	$±h»ad_rwlock_w¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

924 
__THROWNL
 
	`__nÚnuÎ
 ((1));

927 
	$±h»ad_rwlock_Œyw¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

928 
__THROWNL
 
	`__nÚnuÎ
 ((1));

930 #ifdeà
__USE_XOPEN2K


932 
	$±h»ad_rwlock_timedw¾ock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

933 cÚ¡ 
time¥ec
 *
__»¡riù


934 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

938 
	$±h»ad_rwlock_uÆock
 (
±h»ad_rwlock_t
 *
__rwlock
)

939 
__THROWNL
 
	`__nÚnuÎ
 ((1));

945 
	$±h»ad_rwlock©Œ_š™
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

946 
__THROW
 
	`__nÚnuÎ
 ((1));

949 
	$±h»ad_rwlock©Œ_de¡roy
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

950 
__THROW
 
	`__nÚnuÎ
 ((1));

953 
	$±h»ad_rwlock©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_rwlock©Œ_t
 *

954 
__»¡riù
 
__©Œ
,

955 *
__»¡riù
 
__psh¬ed
)

956 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

959 
	$±h»ad_rwlock©Œ_£sh¬ed
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

960 
__psh¬ed
)

961 
__THROW
 
	`__nÚnuÎ
 ((1));

964 
	$±h»ad_rwlock©Œ_g‘kšd_Å
 (cÚ¡ 
±h»ad_rwlock©Œ_t
 *

965 
__»¡riù
 
__©Œ
,

966 *
__»¡riù
 
__´ef
)

967 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

970 
	$±h»ad_rwlock©Œ_£tkšd_Å
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

971 
__´ef
è
__THROW
 
	`__nÚnuÎ
 ((1));

979 
	$±h»ad_cÚd_š™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

980 cÚ¡ 
±h»ad_cÚd©Œ_t
 *
__»¡riù
 
__cÚd_©Œ
)

981 
__THROW
 
	`__nÚnuÎ
 ((1));

984 
	$±h»ad_cÚd_de¡roy
 (
±h»ad_cÚd_t
 *
__cÚd
)

985 
__THROW
 
	`__nÚnuÎ
 ((1));

988 
	$±h»ad_cÚd_sigÇl
 (
±h»ad_cÚd_t
 *
__cÚd
)

989 
__THROWNL
 
	`__nÚnuÎ
 ((1));

992 
	$±h»ad_cÚd_brßdÿ¡
 (
±h»ad_cÚd_t
 *
__cÚd
)

993 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1000 
	$±h»ad_cÚd_wa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

1001 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
)

1002 
	`__nÚnuÎ
 ((1, 2));

1011 
	$±h»ad_cÚd_timedwa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

1012 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

1013 cÚ¡ 
time¥ec
 *
__»¡riù
 
__ab¡ime
)

1014 
	`__nÚnuÎ
 ((1, 2, 3));

1019 
	$±h»ad_cÚd©Œ_š™
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

1020 
__THROW
 
	`__nÚnuÎ
 ((1));

1023 
	$±h»ad_cÚd©Œ_de¡roy
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

1024 
__THROW
 
	`__nÚnuÎ
 ((1));

1027 
	$±h»ad_cÚd©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_cÚd©Œ_t
 *

1028 
__»¡riù
 
__©Œ
,

1029 *
__»¡riù
 
__psh¬ed
)

1030 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1033 
	$±h»ad_cÚd©Œ_£sh¬ed
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

1034 
__psh¬ed
è
__THROW
 
	`__nÚnuÎ
 ((1));

1036 #ifdeà
__USE_XOPEN2K


1038 
	$±h»ad_cÚd©Œ_g‘şock
 (cÚ¡ 
±h»ad_cÚd©Œ_t
 *

1039 
__»¡riù
 
__©Œ
,

1040 
__şockid_t
 *
__»¡riù
 
__şock_id
)

1041 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1044 
	$±h»ad_cÚd©Œ_£tşock
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

1045 
__şockid_t
 
__şock_id
)

1046 
__THROW
 
	`__nÚnuÎ
 ((1));

1050 #ifdeà
__USE_XOPEN2K


1055 
	$±h»ad_¥š_š™
 (
±h»ad_¥šlock_t
 *
__lock
, 
__psh¬ed
)

1056 
__THROW
 
	`__nÚnuÎ
 ((1));

1059 
	$±h»ad_¥š_de¡roy
 (
±h»ad_¥šlock_t
 *
__lock
)

1060 
__THROW
 
	`__nÚnuÎ
 ((1));

1063 
	$±h»ad_¥š_lock
 (
±h»ad_¥šlock_t
 *
__lock
)

1064 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1067 
	$±h»ad_¥š_Œylock
 (
±h»ad_¥šlock_t
 *
__lock
)

1068 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1071 
	$±h»ad_¥š_uÆock
 (
±h»ad_¥šlock_t
 *
__lock
)

1072 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1079 
	$±h»ad_b¬r›r_š™
 (
±h»ad_b¬r›r_t
 *
__»¡riù
 
__b¬r›r
,

1080 cÚ¡ 
±h»ad_b¬r›¿‰r_t
 *
__»¡riù


1081 
__©Œ
, 
__couÁ
)

1082 
__THROW
 
	`__nÚnuÎ
 ((1));

1085 
	$±h»ad_b¬r›r_de¡roy
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1086 
__THROW
 
	`__nÚnuÎ
 ((1));

1089 
	$±h»ad_b¬r›r_wa™
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1090 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1094 
	$±h»ad_b¬r›¿‰r_š™
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1095 
__THROW
 
	`__nÚnuÎ
 ((1));

1098 
	$±h»ad_b¬r›¿‰r_de¡roy
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1099 
__THROW
 
	`__nÚnuÎ
 ((1));

1102 
	$±h»ad_b¬r›¿‰r_g‘psh¬ed
 (cÚ¡ 
±h»ad_b¬r›¿‰r_t
 *

1103 
__»¡riù
 
__©Œ
,

1104 *
__»¡riù
 
__psh¬ed
)

1105 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1108 
	$±h»ad_b¬r›¿‰r_£sh¬ed
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
,

1109 
__psh¬ed
)

1110 
__THROW
 
	`__nÚnuÎ
 ((1));

1122 
	`±h»ad_key_ü—‹
 (
±h»ad_key_t
 *
__key
,

1123 (*
__de¡r_funùiÚ
) (*))

1124 
__THROW
 
	`__nÚnuÎ
 ((1));

1127 
	$±h»ad_key_d–‘e
 (
±h»ad_key_t
 
__key
è
__THROW
;

1130 *
	$±h»ad_g‘¥ecific
 (
±h»ad_key_t
 
__key
è
__THROW
;

1133 
	$±h»ad_£t¥ecific
 (
±h»ad_key_t
 
__key
,

1134 cÚ¡ *
__poš‹r
è
__THROW
 ;

1137 #ifdeà
__USE_XOPEN2K


1139 
	$±h»ad_g‘ıuşockid
 (
±h»ad_t
 
__th»ad_id
,

1140 
__şockid_t
 *
__şock_id
)

1141 
__THROW
 
	`__nÚnuÎ
 ((2));

1156 
	`±h»ad_©fÜk
 ((*
__´•¬e
) (),

1157 (*
__·»Á
) (),

1158 (*
__chd
è()è
__THROW
;

1161 #ifdeà
__USE_EXTERN_INLINES


1163 
__ex‹º_šlše
 

1164 
	`__NTH
 (
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
))

1166  
__th»ad1
 =ğ
__th»ad2
;

1167 
	}
}

1170 
	g__END_DECLS


	@/usr/include/sched.h

19 #iâdef 
_SCHED_H


20 
	#_SCHED_H
 1

	)

22 
	~<ã©u»s.h
>

25 
	~<b™s/ty³s.h
>

27 
	#__Ãed_size_t


	)

28 
	~<¡ddef.h
>

30 
	#__Ãed_time_t


	)

31 
	#__Ãed_time¥ec


	)

32 
	~<time.h
>

34 #iâdeà
__pid_t_defšed


35 
__pid_t
 
	tpid_t
;

36 
	#__pid_t_defšed


	)

41 
	~<b™s/sched.h
>

43 
	#sched_´iÜ™y
 
__sched_´iÜ™y


	)

46 
__BEGIN_DECLS


49 
	$sched_£¬am
 (
__pid_t
 
__pid
, cÚ¡ 
sched_·¿m
 *
__·¿m
)

50 
__THROW
;

53 
	$sched_g‘·¿m
 (
__pid_t
 
__pid
, 
sched_·¿m
 *
__·¿m
è
__THROW
;

56 
	$sched_£tscheduËr
 (
__pid_t
 
__pid
, 
__pŞicy
,

57 cÚ¡ 
sched_·¿m
 *
__·¿m
è
__THROW
;

60 
	$sched_g‘scheduËr
 (
__pid_t
 
__pid
è
__THROW
;

63 
	$sched_y›ld
 (è
__THROW
;

66 
	$sched_g‘_´iÜ™y_max
 (
__®gÜ™hm
è
__THROW
;

69 
	$sched_g‘_´iÜ™y_mš
 (
__®gÜ™hm
è
__THROW
;

72 
	$sched_¼_g‘_š‹rv®
 (
__pid_t
 
__pid
, 
time¥ec
 *
__t
è
__THROW
;

75 #ifdeà
__USE_GNU


77 
	#CPU_SETSIZE
 
__CPU_SETSIZE


	)

78 
	#CPU_SET
(
ıu
, 
ıu£
è
	`__CPU_SET_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

79 
	#CPU_CLR
(
ıu
, 
ıu£
è
	`__CPU_CLR_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

80 
	#CPU_ISSET
(
ıu
, 
ıu£
è
	`__CPU_ISSET_S
 (ıu,  (
ıu_£t_t
), \

81 
ıu£
)

	)

82 
	#CPU_ZERO
(
ıu£
è
	`__CPU_ZERO_S
 ( (
ıu_£t_t
), cpu£)

	)

83 
	#CPU_COUNT
(
ıu£
è
	`__CPU_COUNT_S
 ( (
ıu_£t_t
), cpu£)

	)

85 
	#CPU_SET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_SET_S
 (ıu, s‘size, cpu£)

	)

86 
	#CPU_CLR_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_CLR_S
 (ıu, s‘size, cpu£)

	)

87 
	#CPU_ISSET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_ISSET_S
 (cpu, setsize, \

88 
ıu£
)

	)

89 
	#CPU_ZERO_S
(
£tsize
, 
ıu£
è
	`__CPU_ZERO_S
 (£tsize, cpu£)

	)

90 
	#CPU_COUNT_S
(
£tsize
, 
ıu£
è
	`__CPU_COUNT_S
 (£tsize, cpu£)

	)

92 
	#CPU_EQUAL
(
ıu£1
, 
ıu£2
) \

93 
	`__CPU_EQUAL_S
 ( (
ıu_£t_t
), 
ıu£1
, 
ıu£2
)

	)

94 
	#CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

95 
	`__CPU_EQUAL_S
 (
£tsize
, 
ıu£1
, 
ıu£2
)

	)

97 
	#CPU_AND
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

98 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

99 
	#CPU_OR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

100 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

101 
	#CPU_XOR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

102 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

103 
	#CPU_AND_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

104 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

105 
	#CPU_OR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

106 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

107 
	#CPU_XOR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

108 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

110 
	#CPU_ALLOC_SIZE
(
couÁ
è
	`__CPU_ALLOC_SIZE
 (couÁ)

	)

111 
	#CPU_ALLOC
(
couÁ
è
	`__CPU_ALLOC
 (couÁ)

	)

112 
	#CPU_FREE
(
ıu£t
è
	`__CPU_FREE
 (ıu£t)

	)

116 
	$sched_£ffš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

117 cÚ¡ 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

120 
	$sched_g‘affš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

121 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

124 
__END_DECLS


	@/usr/include/signal.h

22 #iâdef 
_SIGNAL_H


24 #ià!
defšed
 
__Ãed_sig_©omic_t
 && !defšed 
__Ãed_sig£t_t


25 
	#_SIGNAL_H


	)

28 
	~<ã©u»s.h
>

30 
	g__BEGIN_DECLS


32 
	~<b™s/sig£t.h
>

36 #ià
defšed
 
__Ãed_sig_©omic_t
 || defšed 
_SIGNAL_H


37 #iâdeà
__sig_©omic_t_defšed


38 
	#__sig_©omic_t_defšed


	)

39 
__BEGIN_NAMESPACE_STD


40 
__sig_©omic_t
 
	tsig_©omic_t
;

41 
	g__END_NAMESPACE_STD


43 #undeà
__Ãed_sig_©omic_t


46 #ià
defšed
 
__Ãed_sig£t_t
 || (defšed 
_SIGNAL_H
 && defšed 
__USE_POSIX
)

47 #iâdeà
__sig£t_t_defšed


48 
	#__sig£t_t_defšed


	)

49 
__sig£t_t
 
	tsig£t_t
;

51 #undeà
__Ãed_sig£t_t


54 #ifdeà
_SIGNAL_H


56 
	~<b™s/ty³s.h
>

57 
	~<b™s/signum.h
>

59 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


60 #iâdeà
__pid_t_defšed


61 
__pid_t
 
	tpid_t
;

62 
	#__pid_t_defšed


	)

64 #ifdeà
__USE_XOPEN


66 #iâdeà
__uid_t_defšed


67 
__uid_t
 
	tuid_t
;

68 
	#__uid_t_defšed


	)

72 #ifdeà
__USE_POSIX199309


74 
	#__Ãed_time¥ec


	)

75 
	~<time.h
>

78 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_XOPEN_EXTENDED


80 
	~<b™s/sigšfo.h
>

85 (*
	t__sighªdËr_t
) ();

90 
__sighªdËr_t
 
	$__sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

91 
__THROW
;

92 #ifdeà
__USE_GNU


93 
__sighªdËr_t
 
	$sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

94 
__THROW
;

100 
__BEGIN_NAMESPACE_STD


101 #ifdeà
__USE_BSD


102 
__sighªdËr_t
 
	$sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

103 
__THROW
;

106 #ifdeà
__REDIRECT_NTH


107 
__sighªdËr_t
 
	`__REDIRECT_NTH
 (
sigÇl
,

108 (
__sig
, 
__sighªdËr_t
 
__hªdËr
),

109 
__sysv_sigÇl
);

111 
	#sigÇl
 
__sysv_sigÇl


	)

114 
__END_NAMESPACE_STD


116 #ifdeà
__USE_XOPEN


119 
__sighªdËr_t
 
	$bsd_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

120 
__THROW
;

126 #ifdeà
__USE_POSIX


127 
	$kl
 (
__pid_t
 
__pid
, 
__sig
è
__THROW
;

130 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


134 
	$kÍg
 (
__pid_t
 
__pg½
, 
__sig
è
__THROW
;

137 
__BEGIN_NAMESPACE_STD


139 
	$¿i£
 (
__sig
è
__THROW
;

140 
__END_NAMESPACE_STD


142 #ifdeà
__USE_SVID


144 
__sighªdËr_t
 
	$ssigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

145 
__THROW
;

146 
	$gsigÇl
 (
__sig
è
__THROW
;

149 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN2K


151 
	`psigÇl
 (
__sig
, cÚ¡ *
__s
);

154 #ifdeà
__USE_XOPEN2K


156 
	`psigšfo
 (cÚ¡ 
sigšfo_t
 *
__pšfo
, cÚ¡ *
__s
);

167 
	`__sig·u£
 (
__sig_Ü_mask
, 
__is_sig
);

169 #ifdeà
__USE_XOPEN


170 #ifdeà
__GNUC__


171 
	$sig·u£
 (
__sig
è
	`__asm__
 ("__xpg_sigpause");

174 
	#sig·u£
(
sig
è
	`__sig·u£
 ((sig), 1)

	)

179 #ifdeà
__USE_BSD


186 
	#sigmask
(
sig
è
	`__sigmask
(sig)

	)

189 
	$sigblock
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

192 
	$sig£tmask
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

195 
	$sigg‘mask
 (è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

199 #ifdeà
__USE_MISC


200 
	#NSIG
 
_NSIG


	)

203 #ifdeà
__USE_GNU


204 
__sighªdËr_t
 
	tsighªdËr_t
;

208 #ifdeà
__USE_BSD


209 
__sighªdËr_t
 
	tsig_t
;

212 #ifdeà
__USE_POSIX


215 
	$sigem±y£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

218 
	$sigfl£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

221 
	$sigadd£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

224 
	$sigd–£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

227 
	$sigismemb”
 (cÚ¡ 
sig£t_t
 *
__£t
, 
__signo
)

228 
__THROW
 
	`__nÚnuÎ
 ((1));

230 #ifdeà
__USE_GNU


232 
	$sigi£m±y£t
 (cÚ¡ 
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

235 
	$sigªd£t
 (
sig£t_t
 *
__£t
, cÚ¡ sig£t_ˆ*
__Ëá
,

236 cÚ¡ 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

239 
	$sigÜ£t
 (
sig£t_t
 *
__£t
, cÚ¡ sig£t_ˆ*
__Ëá
,

240 cÚ¡ 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

245 
	~<b™s/sigaùiÚ.h
>

248 
	$sig´ocmask
 (
__how
, cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
,

249 
sig£t_t
 *
__»¡riù
 
__o£t
è
__THROW
;

256 
	$sigsu¥’d
 (cÚ¡ 
sig£t_t
 *
__£t
è
	`__nÚnuÎ
 ((1));

259 
	$sigaùiÚ
 (
__sig
, cÚ¡ 
sigaùiÚ
 *
__»¡riù
 
__aù
,

260 
sigaùiÚ
 *
__»¡riù
 
__ßù
è
__THROW
;

263 
	$sig³ndšg
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

270 
	$sigwa™
 (cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
, *__»¡riù 
__sig
)

271 
	`__nÚnuÎ
 ((1, 2));

273 #ifdeà
__USE_POSIX199309


278 
	$sigwa™šfo
 (cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
,

279 
sigšfo_t
 *
__»¡riù
 
__šfo
è
	`__nÚnuÎ
 ((1));

286 
	$sigtimedwa™
 (cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
,

287 
sigšfo_t
 *
__»¡riù
 
__šfo
,

288 cÚ¡ 
time¥ec
 *
__»¡riù
 
__timeout
)

289 
	`__nÚnuÎ
 ((1));

293 
	$sigqueue
 (
__pid_t
 
__pid
, 
__sig
, cÚ¡ 
sigv®
 
__v®
)

294 
__THROW
;

299 #ifdeà
__USE_BSD


303 cÚ¡ *cÚ¡ 
_sys_sigli¡
[
_NSIG
];

304 cÚ¡ *cÚ¡ 
sys_sigli¡
[
_NSIG
];

307 
	ssigvec


309 
__sighªdËr_t
 
sv_hªdËr
;

310 
sv_mask
;

312 
sv_æags
;

313 
	#sv_Ú¡ack
 
sv_æags


	)

317 
	#SV_ONSTACK
 (1 << 0)

	)

318 
	#SV_INTERRUPT
 (1 << 1)

	)

319 
	#SV_RESETHAND
 (1 << 2)

	)

327 
	$sigvec
 (
__sig
, cÚ¡ 
sigvec
 *
__vec
,

328 
sigvec
 *
__ovec
è
__THROW
;

332 
	~<b™s/sigcÚ‹xt.h
>

335 
	$sig»tuº
 (
sigcÚ‹xt
 *
__sı
è
__THROW
;

340 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


341 
	#__Ãed_size_t


	)

342 
	~<¡ddef.h
>

347 
	$sigš‹¼u±
 (
__sig
, 
__š‹¼u±
è
__THROW
;

349 
	~<b™s/sig¡ack.h
>

350 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


352 
	~<sys/ucÚ‹xt.h
>

358 
	$sig¡ack
 (
sig¡ack
 *
__ss
, sig¡ack *
__oss
)

359 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

363 
	$sig®t¡ack
 (cÚ¡ 
sig®t¡ack
 *
__»¡riù
 
__ss
,

364 
sig®t¡ack
 *
__»¡riù
 
__oss
è
__THROW
;

368 #ifdeà
__USE_XOPEN_EXTENDED


372 
	$sighŞd
 (
__sig
è
__THROW
;

375 
	$sig»l£
 (
__sig
è
__THROW
;

378 
	$sigignÜe
 (
__sig
è
__THROW
;

381 
__sighªdËr_t
 
	$sig£t
 (
__sig
, 
__sighªdËr_t
 
__di¥
è
__THROW
;

384 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


387 
	~<b™s/±h»adty³s.h
>

388 
	~<b™s/sigth»ad.h
>

395 
	$__libc_cu¼’t_sig¹mš
 (è
__THROW
;

397 
	$__libc_cu¼’t_sig¹max
 (è
__THROW
;

401 
__END_DECLS


	@/usr/include/stdint.h

22 #iâdeà
_STDINT_H


23 
	#_STDINT_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	~<b™s/wch¬.h
>

27 
	~<b™s/wÜdsize.h
>

34 #iâdeà
__št8_t_defšed


35 
	#__št8_t_defšed


	)

36 sigÃd 
	tšt8_t
;

37 
	tšt16_t
;

38 
	tšt32_t
;

39 #ià
__WORDSIZE
 == 64

40 
	tšt64_t
;

42 
__ex‹nsiÚ__


43 
	tšt64_t
;

48 
	tušt8_t
;

49 
	tušt16_t
;

50 #iâdeà
__ušt32_t_defšed


51 
	tušt32_t
;

52 
	#__ušt32_t_defšed


	)

54 #ià
__WORDSIZE
 == 64

55 
	tušt64_t
;

57 
__ex‹nsiÚ__


58 
	tušt64_t
;

65 sigÃd 
	tšt_Ëa¡8_t
;

66 
	tšt_Ëa¡16_t
;

67 
	tšt_Ëa¡32_t
;

68 #ià
__WORDSIZE
 == 64

69 
	tšt_Ëa¡64_t
;

71 
__ex‹nsiÚ__


72 
	tšt_Ëa¡64_t
;

76 
	tušt_Ëa¡8_t
;

77 
	tušt_Ëa¡16_t
;

78 
	tušt_Ëa¡32_t
;

79 #ià
__WORDSIZE
 == 64

80 
	tušt_Ëa¡64_t
;

82 
__ex‹nsiÚ__


83 
	tušt_Ëa¡64_t
;

90 sigÃd 
	tšt_ç¡8_t
;

91 #ià
__WORDSIZE
 == 64

92 
	tšt_ç¡16_t
;

93 
	tšt_ç¡32_t
;

94 
	tšt_ç¡64_t
;

96 
	tšt_ç¡16_t
;

97 
	tšt_ç¡32_t
;

98 
__ex‹nsiÚ__


99 
	tšt_ç¡64_t
;

103 
	tušt_ç¡8_t
;

104 #ià
__WORDSIZE
 == 64

105 
	tušt_ç¡16_t
;

106 
	tušt_ç¡32_t
;

107 
	tušt_ç¡64_t
;

109 
	tušt_ç¡16_t
;

110 
	tušt_ç¡32_t
;

111 
__ex‹nsiÚ__


112 
	tušt_ç¡64_t
;

117 #ià
__WORDSIZE
 == 64

118 #iâdeà
__šŒ_t_defšed


119 
	tšŒ_t
;

120 
	#__šŒ_t_defšed


	)

122 
	tušŒ_t
;

124 #iâdeà
__šŒ_t_defšed


125 
	tšŒ_t
;

126 
	#__šŒ_t_defšed


	)

128 
	tušŒ_t
;

133 #ià
__WORDSIZE
 == 64

134 
	tštmax_t
;

135 
	tuštmax_t
;

137 
__ex‹nsiÚ__


138 
	tštmax_t
;

139 
__ex‹nsiÚ__


140 
	tuštmax_t
;

144 #ià
__WORDSIZE
 == 64

145 
	#__INT64_C
(
c
èø## 
L


	)

146 
	#__UINT64_C
(
c
èø## 
UL


	)

148 
	#__INT64_C
(
c
èø## 
LL


	)

149 
	#__UINT64_C
(
c
èø## 
ULL


	)

155 
	#INT8_MIN
 (-128)

	)

156 
	#INT16_MIN
 (-32767-1)

	)

157 
	#INT32_MIN
 (-2147483647-1)

	)

158 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

160 
	#INT8_MAX
 (127)

	)

161 
	#INT16_MAX
 (32767)

	)

162 
	#INT32_MAX
 (2147483647)

	)

163 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

166 
	#UINT8_MAX
 (255)

	)

167 
	#UINT16_MAX
 (65535)

	)

168 
	#UINT32_MAX
 (4294967295U)

	)

169 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

173 
	#INT_LEAST8_MIN
 (-128)

	)

174 
	#INT_LEAST16_MIN
 (-32767-1)

	)

175 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

176 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

178 
	#INT_LEAST8_MAX
 (127)

	)

179 
	#INT_LEAST16_MAX
 (32767)

	)

180 
	#INT_LEAST32_MAX
 (2147483647)

	)

181 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

184 
	#UINT_LEAST8_MAX
 (255)

	)

185 
	#UINT_LEAST16_MAX
 (65535)

	)

186 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

187 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

191 
	#INT_FAST8_MIN
 (-128)

	)

192 #ià
__WORDSIZE
 == 64

193 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

194 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

196 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

197 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

199 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

201 
	#INT_FAST8_MAX
 (127)

	)

202 #ià
__WORDSIZE
 == 64

203 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

204 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

206 
	#INT_FAST16_MAX
 (2147483647)

	)

207 
	#INT_FAST32_MAX
 (2147483647)

	)

209 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

212 
	#UINT_FAST8_MAX
 (255)

	)

213 #ià
__WORDSIZE
 == 64

214 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

215 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

217 
	#UINT_FAST16_MAX
 (4294967295U)

	)

218 
	#UINT_FAST32_MAX
 (4294967295U)

	)

220 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

224 #ià
__WORDSIZE
 == 64

225 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

226 
	#INTPTR_MAX
 (9223372036854775807L)

	)

227 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

229 
	#INTPTR_MIN
 (-2147483647-1)

	)

230 
	#INTPTR_MAX
 (2147483647)

	)

231 
	#UINTPTR_MAX
 (4294967295U)

	)

236 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

238 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

241 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

247 #ià
__WORDSIZE
 == 64

248 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

249 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

251 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

252 
	#PTRDIFF_MAX
 (2147483647)

	)

256 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

257 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

260 #ià
__WORDSIZE
 == 64

261 
	#SIZE_MAX
 (18446744073709551615UL)

	)

263 
	#SIZE_MAX
 (4294967295U)

	)

267 #iâdeà
WCHAR_MIN


269 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

270 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

274 
	#WINT_MIN
 (0u)

	)

275 
	#WINT_MAX
 (4294967295u)

	)

278 
	#INT8_C
(
c
è
	)
c

279 
	#INT16_C
(
c
è
	)
c

280 
	#INT32_C
(
c
è
	)
c

281 #ià
__WORDSIZE
 == 64

282 
	#INT64_C
(
c
èø## 
L


	)

284 
	#INT64_C
(
c
èø## 
LL


	)

288 
	#UINT8_C
(
c
è
	)
c

289 
	#UINT16_C
(
c
è
	)
c

290 
	#UINT32_C
(
c
èø## 
U


	)

291 #ià
__WORDSIZE
 == 64

292 
	#UINT64_C
(
c
èø## 
UL


	)

294 
	#UINT64_C
(
c
èø## 
ULL


	)

298 #ià
__WORDSIZE
 == 64

299 
	#INTMAX_C
(
c
èø## 
L


	)

300 
	#UINTMAX_C
(
c
èø## 
UL


	)

302 
	#INTMAX_C
(
c
èø## 
LL


	)

303 
	#UINTMAX_C
(
c
èø## 
ULL


	)

	@/usr/include/stdio.h

23 #iâdeà
_STDIO_H


25 #ià!
defšed
 
__Ãed_FILE
 && !defšed 
__Ãed___FILE


26 
	#_STDIO_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	g__BEGIN_DECLS


31 
	#__Ãed_size_t


	)

32 
	#__Ãed_NULL


	)

33 
	~<¡ddef.h
>

35 
	~<b™s/ty³s.h
>

36 
	#__Ãed_FILE


	)

37 
	#__Ãed___FILE


	)

41 #ià!
defšed
 
__FILE_defšed
 && defšed 
__Ãed_FILE


44 
	g_IO_FILE
;

46 
__BEGIN_NAMESPACE_STD


48 
_IO_FILE
 
	tFILE
;

49 
	g__END_NAMESPACE_STD


50 #ià
defšed
 
__USE_LARGEFILE64
 || defšed 
__USE_SVID
 || defšed 
__USE_POSIX
 \

51 || 
defšed
 
	g__USE_BSD
 || defšed 
	g__USE_ISOC99
 || defšed 
	g__USE_XOPEN
 \

52 || 
defšed
 
__USE_POSIX2


53 
	$__USING_NAMESPACE_STD
(
FILE
)

56 
	#__FILE_defšed
 1

	)

58 #undeà
__Ãed_FILE


61 #ià!
defšed
 
____FILE_defšed
 && defšed 
__Ãed___FILE


64 
_IO_FILE
 
	t__FILE
;

66 
	#____FILE_defšed
 1

	)

68 #undeà
__Ãed___FILE


71 #ifdef 
_STDIO_H


72 
	#_STDIO_USES_IOSTREAM


	)

74 
	~<libio.h
>

76 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


77 #ifdeà
__GNUC__


78 #iâdeà
_VA_LIST_DEFINED


79 
_G_va_li¡
 
	tva_li¡
;

80 
	#_VA_LIST_DEFINED


	)

83 
	~<¡d¬g.h
>

87 #ifdeà
__USE_XOPEN2K8


88 #iâdeà
__off_t_defšed


89 #iâdeà
__USE_FILE_OFFSET64


90 
__off_t
 
	toff_t
;

92 
__off64_t
 
	toff_t
;

94 
	#__off_t_defšed


	)

96 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


97 
__off64_t
 
	toff64_t
;

98 
	#__off64_t_defšed


	)

101 #iâdeà
__ssize_t_defšed


102 
__ssize_t
 
	tssize_t
;

103 
	#__ssize_t_defšed


	)

108 
__BEGIN_NAMESPACE_STD


109 #iâdeà
__USE_FILE_OFFSET64


110 
_G_åos_t
 
	tåos_t
;

112 
_G_åos64_t
 
	tåos_t
;

114 
__END_NAMESPACE_STD


115 #ifdeà
__USE_LARGEFILE64


116 
_G_åos64_t
 
	tåos64_t
;

120 
	#_IOFBF
 0

	)

121 
	#_IOLBF
 1

	)

122 
	#_IONBF
 2

	)

126 #iâdeà
BUFSIZ


127 
	#BUFSIZ
 
_IO_BUFSIZ


	)

133 #iâdeà
EOF


134 
	#EOF
 (-1)

	)

140 
	#SEEK_SET
 0

	)

141 
	#SEEK_CUR
 1

	)

142 
	#SEEK_END
 2

	)

143 #ifdeà
__USE_GNU


144 
	#SEEK_DATA
 3

	)

145 
	#SEEK_HOLE
 4

	)

149 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


151 
	#P_tmpdœ
 "/tmp"

	)

164 
	~<b™s/¡dio_lim.h
>

168 
_IO_FILE
 *
¡dš
;

169 
_IO_FILE
 *
¡dout
;

170 
_IO_FILE
 *
¡d”r
;

172 
	#¡dš
 
¡dš


	)

173 
	#¡dout
 
¡dout


	)

174 
	#¡d”r
 
¡d”r


	)

176 
__BEGIN_NAMESPACE_STD


178 
	$»move
 (cÚ¡ *
__f’ame
è
__THROW
;

180 
	$»Çme
 (cÚ¡ *
__Şd
, cÚ¡ *
__Ãw
è
__THROW
;

181 
__END_NAMESPACE_STD


183 #ifdeà
__USE_ATFILE


185 
	$»Çm—t
 (
__Şdfd
, cÚ¡ *
__Şd
, 
__Ãwfd
,

186 cÚ¡ *
__Ãw
è
__THROW
;

189 
__BEGIN_NAMESPACE_STD


194 #iâdeà
__USE_FILE_OFFSET64


195 
FILE
 *
	$tmpfe
 (è
__wur
;

197 #ifdeà
__REDIRECT


198 
FILE
 *
	`__REDIRECT
 (
tmpfe
, (), 
tmpfe64
è
__wur
;

200 
	#tmpfe
 
tmpfe64


	)

204 #ifdeà
__USE_LARGEFILE64


205 
FILE
 *
	$tmpfe64
 (è
__wur
;

209 *
	$tm²am
 (*
__s
è
__THROW
 
__wur
;

210 
__END_NAMESPACE_STD


212 #ifdeà
__USE_MISC


215 *
	$tm²am_r
 (*
__s
è
__THROW
 
__wur
;

219 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


227 *
	$‹m²am
 (cÚ¡ *
__dœ
, cÚ¡ *
__pfx
)

228 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

232 
__BEGIN_NAMESPACE_STD


237 
	`fşo£
 (
FILE
 *
__¡»am
);

242 
	`fæush
 (
FILE
 *
__¡»am
);

243 
__END_NAMESPACE_STD


245 #ifdeà
__USE_MISC


252 
	`fæush_uÆocked
 (
FILE
 *
__¡»am
);

255 #ifdeà
__USE_GNU


262 
	`fşo£®l
 ();

266 
__BEGIN_NAMESPACE_STD


267 #iâdeà
__USE_FILE_OFFSET64


272 
FILE
 *
	$fİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

273 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

278 
FILE
 *
	$äeİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

279 cÚ¡ *
__»¡riù
 
__modes
,

280 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

282 #ifdeà
__REDIRECT


283 
FILE
 *
	`__REDIRECT
 (
fİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

284 cÚ¡ *
__»¡riù
 
__modes
), 
fİ’64
)

285 
__wur
;

286 
FILE
 *
	`__REDIRECT
 (
äeİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

287 cÚ¡ *
__»¡riù
 
__modes
,

288 
FILE
 *
__»¡riù
 
__¡»am
), 
äeİ’64
)

289 
__wur
;

291 
	#fİ’
 
fİ’64


	)

292 
	#äeİ’
 
äeİ’64


	)

295 
__END_NAMESPACE_STD


296 #ifdeà
__USE_LARGEFILE64


297 
FILE
 *
	$fİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

298 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

299 
FILE
 *
	$äeİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

300 cÚ¡ *
__»¡riù
 
__modes
,

301 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

304 #ifdef 
__USE_POSIX


306 
FILE
 *
	$fdİ’
 (
__fd
, cÚ¡ *
__modes
è
__THROW
 
__wur
;

309 #ifdef 
__USE_GNU


312 
FILE
 *
	$fİ’cook›
 (*
__»¡riù
 
__magic_cook›
,

313 cÚ¡ *
__»¡riù
 
__modes
,

314 
_IO_cook›_io_funùiÚs_t
 
__io_funcs
è
__THROW
 
__wur
;

317 #ifdeà
__USE_XOPEN2K8


319 
FILE
 *
	$fmemİ’
 (*
__s
, 
size_t
 
__Ën
, cÚ¡ *
__modes
)

320 
__THROW
 
__wur
;

325 
FILE
 *
	$İ’_mem¡»am
 (**
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
 
__wur
;

329 
__BEGIN_NAMESPACE_STD


332 
	$£tbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
è
__THROW
;

336 
	$£tvbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

337 
__modes
, 
size_t
 
__n
è
__THROW
;

338 
__END_NAMESPACE_STD


340 #ifdef 
__USE_BSD


343 
	$£tbufãr
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

344 
size_t
 
__size
è
__THROW
;

347 
	$£šebuf
 (
FILE
 *
__¡»am
è
__THROW
;

351 
__BEGIN_NAMESPACE_STD


356 
	`årštf
 (
FILE
 *
__»¡riù
 
__¡»am
,

357 cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

362 
	`´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

364 
	$¥rštf
 (*
__»¡riù
 
__s
,

365 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROWNL
;

371 
	`vårštf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

372 
_G_va_li¡
 
__¬g
);

377 
	`v´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
);

379 
	$v¥rštf
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

380 
_G_va_li¡
 
__¬g
è
__THROWNL
;

381 
__END_NAMESPACE_STD


383 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_ISOC99
 || defšed 
__USE_UNIX98


384 
__BEGIN_NAMESPACE_C99


386 
	$¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

387 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

388 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

390 
	$v¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

391 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

392 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

393 
__END_NAMESPACE_C99


396 #ifdeà
__USE_GNU


399 
	$va¥rštf
 (**
__»¡riù
 
__±r
, cÚ¡ *__»¡riù 
__f
,

400 
_G_va_li¡
 
__¬g
)

401 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 0))è
__wur
;

402 
	$__a¥rštf
 (**
__»¡riù
 
__±r
,

403 cÚ¡ *
__»¡riù
 
__fmt
, ...)

404 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

405 
	$a¥rštf
 (**
__»¡riù
 
__±r
,

406 cÚ¡ *
__»¡riù
 
__fmt
, ...)

407 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

410 #ifdeà
__USE_XOPEN2K8


412 
	$vd´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
,

413 
_G_va_li¡
 
__¬g
)

414 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

415 
	$d´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
, ...)

416 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

420 
__BEGIN_NAMESPACE_STD


425 
	$fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

426 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

431 
	$sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

433 
	$ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

434 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

436 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

437 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

438 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

439 #ifdeà
__REDIRECT


443 
	`__REDIRECT
 (
fsÿnf
, (
FILE
 *
__»¡riù
 
__¡»am
,

444 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

445 
__isoc99_fsÿnf
è
__wur
;

446 
	`__REDIRECT
 (
sÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

447 
__isoc99_sÿnf
è
__wur
;

448 
	`__REDIRECT_NTH
 (
ssÿnf
, (cÚ¡ *
__»¡riù
 
__s
,

449 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

450 
__isoc99_ssÿnf
);

452 
	$__isoc99_fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

453 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

454 
	$__isoc99_sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

455 
	$__isoc99_ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

456 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

457 
	#fsÿnf
 
__isoc99_fsÿnf


	)

458 
	#sÿnf
 
__isoc99_sÿnf


	)

459 
	#ssÿnf
 
__isoc99_ssÿnf


	)

463 
__END_NAMESPACE_STD


465 #ifdef 
__USE_ISOC99


466 
__BEGIN_NAMESPACE_C99


471 
	$vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

472 
_G_va_li¡
 
__¬g
)

473 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

479 
	$vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

480 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

483 
	$vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

484 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

485 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

487 #ià!
defšed
 
__USE_GNU
 \

488 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

489 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

490 #ifdeà
__REDIRECT


494 
	`__REDIRECT
 (
vfsÿnf
,

495 (
FILE
 *
__»¡riù
 
__s
,

496 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
),

497 
__isoc99_vfsÿnf
)

498 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

499 
	`__REDIRECT
 (
vsÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
,

500 
_G_va_li¡
 
__¬g
), 
__isoc99_vsÿnf
)

501 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

502 
	`__REDIRECT_NTH
 (
vssÿnf
,

503 (cÚ¡ *
__»¡riù
 
__s
,

504 cÚ¡ *
__»¡riù
 
__fÜm©
,

505 
_G_va_li¡
 
__¬g
), 
__isoc99_vssÿnf
)

506 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

508 
	$__isoc99_vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
,

509 cÚ¡ *
__»¡riù
 
__fÜm©
,

510 
_G_va_li¡
 
__¬g
è
__wur
;

511 
	$__isoc99_vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
,

512 
_G_va_li¡
 
__¬g
è
__wur
;

513 
	$__isoc99_vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

514 cÚ¡ *
__»¡riù
 
__fÜm©
,

515 
_G_va_li¡
 
__¬g
è
__THROW
;

516 
	#vfsÿnf
 
__isoc99_vfsÿnf


	)

517 
	#vsÿnf
 
__isoc99_vsÿnf


	)

518 
	#vssÿnf
 
__isoc99_vssÿnf


	)

522 
__END_NAMESPACE_C99


526 
__BEGIN_NAMESPACE_STD


531 
	`fg‘c
 (
FILE
 *
__¡»am
);

532 
	`g‘c
 (
FILE
 *
__¡»am
);

538 
	`g‘ch¬
 ();

539 
__END_NAMESPACE_STD


543 
	#g‘c
(
_å
è
	`_IO_g‘c
 (_å)

	)

545 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


550 
	`g‘c_uÆocked
 (
FILE
 *
__¡»am
);

551 
	`g‘ch¬_uÆocked
 ();

554 #ifdeà
__USE_MISC


561 
	`fg‘c_uÆocked
 (
FILE
 *
__¡»am
);

565 
__BEGIN_NAMESPACE_STD


573 
	`åutc
 (
__c
, 
FILE
 *
__¡»am
);

574 
	`putc
 (
__c
, 
FILE
 *
__¡»am
);

580 
	`putch¬
 (
__c
);

581 
__END_NAMESPACE_STD


585 
	#putc
(
_ch
, 
_å
è
	`_IO_putc
 (_ch, _å)

	)

587 #ifdeà
__USE_MISC


594 
	`åutc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

597 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


602 
	`putc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

603 
	`putch¬_uÆocked
 (
__c
);

607 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 \

608 || (
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

610 
	`g‘w
 (
FILE
 *
__¡»am
);

613 
	`putw
 (
__w
, 
FILE
 *
__¡»am
);

617 
__BEGIN_NAMESPACE_STD


622 *
	$fg‘s
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

623 
__wur
;

625 #ià!
defšed
 
__USE_ISOC11
 \

626 || (
defšed
 
__ılu¥lus
 && __cplusplus <= 201103L)

638 *
	$g‘s
 (*
__s
è
__wur
 
__©Œibu‹_d•»ÿ‹d__
;

640 
__END_NAMESPACE_STD


642 #ifdeà
__USE_GNU


649 *
	$fg‘s_uÆocked
 (*
__»¡riù
 
__s
, 
__n
,

650 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

654 #ifdef 
__USE_XOPEN2K8


665 
_IO_ssize_t
 
	$__g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

666 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

667 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

668 
_IO_ssize_t
 
	$g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

669 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

670 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

678 
_IO_ssize_t
 
	$g‘lše
 (**
__»¡riù
 
__lš•Œ
,

679 
size_t
 *
__»¡riù
 
__n
,

680 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

684 
__BEGIN_NAMESPACE_STD


689 
	`åuts
 (cÚ¡ *
__»¡riù
 
__s
, 
FILE
 *__»¡riù 
__¡»am
);

695 
	`puts
 (cÚ¡ *
__s
);

702 
	`ung‘c
 (
__c
, 
FILE
 *
__¡»am
);

709 
size_t
 
	$ä—d
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

710 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

715 
size_t
 
	`fwr™e
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

716 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__s
);

717 
__END_NAMESPACE_STD


719 #ifdeà
__USE_GNU


726 
	`åuts_uÆocked
 (cÚ¡ *
__»¡riù
 
__s
,

727 
FILE
 *
__»¡riù
 
__¡»am
);

730 #ifdeà
__USE_MISC


737 
size_t
 
	$ä—d_uÆocked
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

738 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

739 
size_t
 
	`fwr™e_uÆocked
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

740 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
);

744 
__BEGIN_NAMESPACE_STD


749 
	`f£ek
 (
FILE
 *
__¡»am
, 
__off
, 
__wh’û
);

754 
	$á–l
 (
FILE
 *
__¡»am
è
__wur
;

759 
	`»wšd
 (
FILE
 *
__¡»am
);

760 
__END_NAMESPACE_STD


767 #ià
defšed
 
__USE_LARGEFILE
 || defšed 
__USE_XOPEN2K


768 #iâdeà
__USE_FILE_OFFSET64


773 
	`f£eko
 (
FILE
 *
__¡»am
, 
__off_t
 
__off
, 
__wh’û
);

778 
__off_t
 
	$á–lo
 (
FILE
 *
__¡»am
è
__wur
;

780 #ifdeà
__REDIRECT


781 
	`__REDIRECT
 (
f£eko
,

782 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
),

783 
f£eko64
);

784 
__off64_t
 
	`__REDIRECT
 (
á–lo
, (
FILE
 *
__¡»am
), 
á–lo64
);

786 
	#f£eko
 
f£eko64


	)

787 
	#á–lo
 
á–lo64


	)

792 
__BEGIN_NAMESPACE_STD


793 #iâdeà
__USE_FILE_OFFSET64


798 
	`fg‘pos
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos_t
 *__»¡riù 
__pos
);

803 
	`f£os
 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
);

805 #ifdeà
__REDIRECT


806 
	`__REDIRECT
 (
fg‘pos
, (
FILE
 *
__»¡riù
 
__¡»am
,

807 
åos_t
 *
__»¡riù
 
__pos
), 
fg‘pos64
);

808 
	`__REDIRECT
 (
f£os
,

809 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
), 
f£os64
);

811 
	#fg‘pos
 
fg‘pos64


	)

812 
	#f£os
 
f£os64


	)

815 
__END_NAMESPACE_STD


817 #ifdeà
__USE_LARGEFILE64


818 
	`f£eko64
 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
);

819 
__off64_t
 
	$á–lo64
 (
FILE
 *
__¡»am
è
__wur
;

820 
	`fg‘pos64
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos64_t
 *__»¡riù 
__pos
);

821 
	`f£os64
 (
FILE
 *
__¡»am
, cÚ¡ 
åos64_t
 *
__pos
);

824 
__BEGIN_NAMESPACE_STD


826 
	$ş—»¼
 (
FILE
 *
__¡»am
è
__THROW
;

828 
	$ãof
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

830 
	$ã¼Ü
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

831 
__END_NAMESPACE_STD


833 #ifdeà
__USE_MISC


835 
	$ş—»¼_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
;

836 
	$ãof_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

837 
	$ã¼Ü_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

841 
__BEGIN_NAMESPACE_STD


846 
	`³¼Ü
 (cÚ¡ *
__s
);

847 
__END_NAMESPACE_STD


853 
	~<b™s/sys_”¾i¡.h
>

856 #ifdef 
__USE_POSIX


858 
	$f’o
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

861 #ifdeà
__USE_MISC


863 
	$f’o_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

867 #ià(
defšed
 
__USE_POSIX2
 || defšed 
__USE_SVID
 || defšed 
__USE_BSD
 || \

868 
defšed
 
__USE_MISC
)

873 
FILE
 *
	$pİ’
 (cÚ¡ *
__commªd
, cÚ¡ *
__modes
è
__wur
;

879 
	`pşo£
 (
FILE
 *
__¡»am
);

883 #ifdef 
__USE_POSIX


885 *
	$ù”mid
 (*
__s
è
__THROW
;

889 #ifdeà
__USE_XOPEN


891 *
	`cu£rid
 (*
__s
);

895 #ifdef 
__USE_GNU


896 
ob¡ack
;

899 
	$ob¡ack_´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

900 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

901 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

902 
	$ob¡ack_v´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

903 cÚ¡ *
__»¡riù
 
__fÜm©
,

904 
_G_va_li¡
 
__¬gs
)

905 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

909 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


913 
	$æockfe
 (
FILE
 *
__¡»am
è
__THROW
;

917 
	$árylockfe
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

920 
	$fuÆockfe
 (
FILE
 *
__¡»am
è
__THROW
;

923 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


927 
	#__Ãed_g‘İt


	)

928 
	~<g‘İt.h
>

933 #ifdeà
__USE_EXTERN_INLINES


934 
	~<b™s/¡dio.h
>

936 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


937 
	~<b™s/¡dio2.h
>

939 #ifdeà
__LDBL_COMPAT


940 
	~<b™s/¡dio-ldbl.h
>

943 
__END_DECLS


	@/usr/include/stdlib.h

22 #iâdef 
_STDLIB_H


24 
	~<ã©u»s.h
>

27 
	#__Ãed_size_t


	)

28 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


29 
	#__Ãed_wch¬_t


	)

30 
	#__Ãed_NULL


	)

32 
	~<¡ddef.h
>

34 
	g__BEGIN_DECLS


36 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


37 
	#_STDLIB_H
 1

	)

39 #ià(
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8
è&& !defšed 
_SYS_WAIT_H


41 
	~<b™s/wa™æags.h
>

42 
	~<b™s/wa™¡©us.h
>

44 #ifdeà
__USE_BSD


49 #ià
defšed
 
__GNUC__
 && !defšed 
__ılu¥lus


50 
	#__WAIT_INT
(
¡©us
) \

51 (
	`__ex‹nsiÚ__
 (((uniÚ { 
	`__ty³of
(
¡©us
è
__š
; 
__i
; }) \

52 { .
__š
 = (
¡©us
è}).
__i
))

	)

54 
	#__WAIT_INT
(
¡©us
è(*(*è&(¡©us))

	)

62 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2 || defšed 
__ılu¥lus


63 
	#__WAIT_STATUS
 *

	)

64 
	#__WAIT_STATUS_DEFN
 *

	)

69 
wa™
 *
	m__u±r
;

70 *
	m__Œ
;

71 } 
	t__WAIT_STATUS
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

72 
	#__WAIT_STATUS_DEFN
 *

	)

77 
	#__WAIT_INT
(
¡©us
è(¡©us)

	)

78 
	#__WAIT_STATUS
 *

	)

79 
	#__WAIT_STATUS_DEFN
 *

	)

84 
	#WEXITSTATUS
(
¡©us
è
	`__WEXITSTATUS
 (
	`__WAIT_INT
 (¡©us))

	)

85 
	#WTERMSIG
(
¡©us
è
	`__WTERMSIG
 (
	`__WAIT_INT
 (¡©us))

	)

86 
	#WSTOPSIG
(
¡©us
è
	`__WSTOPSIG
 (
	`__WAIT_INT
 (¡©us))

	)

87 
	#WIFEXITED
(
¡©us
è
	`__WIFEXITED
 (
	`__WAIT_INT
 (¡©us))

	)

88 
	#WIFSIGNALED
(
¡©us
è
	`__WIFSIGNALED
 (
	`__WAIT_INT
 (¡©us))

	)

89 
	#WIFSTOPPED
(
¡©us
è
	`__WIFSTOPPED
 (
	`__WAIT_INT
 (¡©us))

	)

90 #ifdeà
__WIFCONTINUED


91 
	#WIFCONTINUED
(
¡©us
è
	`__WIFCONTINUED
 (
	`__WAIT_INT
 (¡©us))

	)

95 
__BEGIN_NAMESPACE_STD


99 
	mquÙ
;

100 
	m»m
;

101 } 
	tdiv_t
;

104 #iâdeà
__ldiv_t_defšed


107 
	mquÙ
;

108 
	m»m
;

109 } 
	tldiv_t
;

110 
	#__ldiv_t_defšed
 1

	)

112 
	g__END_NAMESPACE_STD


114 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__Îdiv_t_defšed


115 
__BEGIN_NAMESPACE_C99


117 
__ex‹nsiÚ__
 struct

119 
	mquÙ
;

120 
	m»m
;

121 } 
	tÎdiv_t
;

122 
	#__Îdiv_t_defšed
 1

	)

123 
	g__END_NAMESPACE_C99


128 
	#RAND_MAX
 2147483647

	)

133 
	#EXIT_FAILURE
 1

	)

134 
	#EXIT_SUCCESS
 0

	)

138 
	#MB_CUR_MAX
 (
	`__ùy³_g‘_mb_cur_max
 ())

	)

139 
size_t
 
	$__ùy³_g‘_mb_cur_max
 (è
__THROW
 
__wur
;

142 
__BEGIN_NAMESPACE_STD


144 
	$©of
 (cÚ¡ *
__ÅŒ
)

145 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

147 
	$©oi
 (cÚ¡ *
__ÅŒ
)

148 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

150 
	$©Ş
 (cÚ¡ *
__ÅŒ
)

151 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

152 
__END_NAMESPACE_STD


154 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_MISC


155 
__BEGIN_NAMESPACE_C99


157 
__ex‹nsiÚ__
 
	$©Şl
 (cÚ¡ *
__ÅŒ
)

158 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

159 
__END_NAMESPACE_C99


162 
__BEGIN_NAMESPACE_STD


164 
	$¡¹od
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

165 **
__»¡riù
 
__’d±r
)

166 
__THROW
 
	`__nÚnuÎ
 ((1));

167 
__END_NAMESPACE_STD


169 #ifdef 
__USE_ISOC99


170 
__BEGIN_NAMESPACE_C99


172 
	$¡¹of
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

173 **
__»¡riù
 
__’d±r
è
__THROW
 
	`__nÚnuÎ
 ((1));

175 
	$¡¹Şd
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

176 **
__»¡riù
 
__’d±r
)

177 
__THROW
 
	`__nÚnuÎ
 ((1));

178 
__END_NAMESPACE_C99


181 
__BEGIN_NAMESPACE_STD


183 
	$¡¹Ş
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

184 **
__»¡riù
 
__’d±r
, 
__ba£
)

185 
__THROW
 
	`__nÚnuÎ
 ((1));

187 
	$¡¹oul
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

188 **
__»¡riù
 
__’d±r
, 
__ba£
)

189 
__THROW
 
	`__nÚnuÎ
 ((1));

190 
__END_NAMESPACE_STD


192 #ifdeà
__USE_BSD


194 
__ex‹nsiÚ__


195 
	$¡¹oq
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

196 **
__»¡riù
 
__’d±r
, 
__ba£
)

197 
__THROW
 
	`__nÚnuÎ
 ((1));

199 
__ex‹nsiÚ__


200 
	$¡¹ouq
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

201 **
__»¡riù
 
__’d±r
, 
__ba£
)

202 
__THROW
 
	`__nÚnuÎ
 ((1));

205 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_MISC


206 
__BEGIN_NAMESPACE_C99


208 
__ex‹nsiÚ__


209 
	$¡¹Şl
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

210 **
__»¡riù
 
__’d±r
, 
__ba£
)

211 
__THROW
 
	`__nÚnuÎ
 ((1));

213 
__ex‹nsiÚ__


214 
	$¡¹ouÎ
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

215 **
__»¡riù
 
__’d±r
, 
__ba£
)

216 
__THROW
 
	`__nÚnuÎ
 ((1));

217 
__END_NAMESPACE_C99


221 #ifdeà
__USE_GNU


235 
	~<xloÿË.h
>

239 
	$¡¹Ş_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

240 **
__»¡riù
 
__’d±r
, 
__ba£
,

241 
__loÿË_t
 
__loc
è
__THROW
 
	`__nÚnuÎ
 ((1, 4));

243 
	$¡¹oul_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

244 **
__»¡riù
 
__’d±r
,

245 
__ba£
, 
__loÿË_t
 
__loc
)

246 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

248 
__ex‹nsiÚ__


249 
	$¡¹Şl_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

250 **
__»¡riù
 
__’d±r
, 
__ba£
,

251 
__loÿË_t
 
__loc
)

252 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

254 
__ex‹nsiÚ__


255 
	$¡¹ouÎ_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

256 **
__»¡riù
 
__’d±r
,

257 
__ba£
, 
__loÿË_t
 
__loc
)

258 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

260 
	$¡¹od_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

261 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

262 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

264 
	$¡¹of_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

265 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

266 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

268 
	$¡¹Şd_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

269 **
__»¡riù
 
__’d±r
,

270 
__loÿË_t
 
__loc
)

271 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

275 #ifdeà
__USE_EXTERN_INLINES


276 
__BEGIN_NAMESPACE_STD


277 
__ex‹º_šlše
 

278 
	`__NTH
 (
	$©oi
 (cÚ¡ *
__ÅŒ
))

280  (è
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

281 
	}
}

282 
__ex‹º_šlše
 

283 
__NTH
 (
	$©Ş
 (cÚ¡ *
__ÅŒ
))

285  
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

286 
	}
}

287 
	g__END_NAMESPACE_STD


289 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ISOC99


290 
__BEGIN_NAMESPACE_C99


291 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

292 
__NTH
 (
	$©Şl
 (cÚ¡ *
__ÅŒ
))

294  
	`¡¹Şl
 (
__ÅŒ
, (**è
NULL
, 10);

295 
	}
}

296 
	g__END_NAMESPACE_C99


301 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED


305 *
	$l64a
 (
__n
è
__THROW
 
__wur
;

308 
	$a64l
 (cÚ¡ *
__s
)

309 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

313 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_BSD


314 
	~<sys/ty³s.h
>

321 
	$¿ndom
 (è
__THROW
;

324 
	$¤ªdom
 (
__£ed
è
__THROW
;

330 *
	$š™¡©e
 (
__£ed
, *
__¡©ebuf
,

331 
size_t
 
__¡©–’
è
__THROW
 
	`__nÚnuÎ
 ((2));

335 *
	$£t¡©e
 (*
__¡©ebuf
è
__THROW
 
	`__nÚnuÎ
 ((1));

338 #ifdeà
__USE_MISC


343 
	s¿ndom_d©a


345 
št32_t
 *
åŒ
;

346 
št32_t
 *
½Œ
;

347 
št32_t
 *
¡©e
;

348 
¿nd_ty³
;

349 
¿nd_deg
;

350 
¿nd_£p
;

351 
št32_t
 *
’d_±r
;

354 
	$¿ndom_r
 (
¿ndom_d©a
 *
__»¡riù
 
__buf
,

355 
št32_t
 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

357 
	$¤ªdom_r
 (
__£ed
, 
¿ndom_d©a
 *
__buf
)

358 
__THROW
 
	`__nÚnuÎ
 ((2));

360 
	$š™¡©e_r
 (
__£ed
, *
__»¡riù
 
__¡©ebuf
,

361 
size_t
 
__¡©–’
,

362 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

363 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

365 
	$£t¡©e_r
 (*
__»¡riù
 
__¡©ebuf
,

366 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

367 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

372 
__BEGIN_NAMESPACE_STD


374 
	$¿nd
 (è
__THROW
;

376 
	$¤ªd
 (
__£ed
è
__THROW
;

377 
__END_NAMESPACE_STD


379 #ifdeà
__USE_POSIX


381 
	$¿nd_r
 (*
__£ed
è
__THROW
;

385 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


389 
	$d¿nd48
 (è
__THROW
;

390 
	$”ªd48
 (
__xsubi
[3]è
__THROW
 
	`__nÚnuÎ
 ((1));

393 
	$Ìªd48
 (è
__THROW
;

394 
	$Äªd48
 (
__xsubi
[3])

395 
__THROW
 
	`__nÚnuÎ
 ((1));

398 
	$m¿nd48
 (è
__THROW
;

399 
	$j¿nd48
 (
__xsubi
[3])

400 
__THROW
 
	`__nÚnuÎ
 ((1));

403 
	$¤ªd48
 (
__£edv®
è
__THROW
;

404 *
	$£ed48
 (
__£ed16v
[3])

405 
__THROW
 
	`__nÚnuÎ
 ((1));

406 
	$lcÚg48
 (
__·¿m
[7]è
__THROW
 
	`__nÚnuÎ
 ((1));

408 #ifdeà
__USE_MISC


412 
	sd¿nd48_d©a


414 
__x
[3];

415 
__Şd_x
[3];

416 
__c
;

417 
__š™
;

418 
__ex‹nsiÚ__
 
__a
;

423 
	$d¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

424 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

425 
	$”ªd48_r
 (
__xsubi
[3],

426 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

427 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

430 
	$Ìªd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

431 *
__»¡riù
 
__»suÉ
)

432 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

433 
	$Äªd48_r
 (
__xsubi
[3],

434 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

435 *
__»¡riù
 
__»suÉ
)

436 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

439 
	$m¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

440 *
__»¡riù
 
__»suÉ
)

441 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

442 
	$j¿nd48_r
 (
__xsubi
[3],

443 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

444 *
__»¡riù
 
__»suÉ
)

445 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

448 
	$¤ªd48_r
 (
__£edv®
, 
d¿nd48_d©a
 *
__bufãr
)

449 
__THROW
 
	`__nÚnuÎ
 ((2));

451 
	$£ed48_r
 (
__£ed16v
[3],

452 
d¿nd48_d©a
 *
__bufãr
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

454 
	$lcÚg48_r
 (
__·¿m
[7],

455 
d¿nd48_d©a
 *
__bufãr
)

456 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

462 #iâdeà
__m®loc_ªd_ÿÎoc_defšed


463 
	#__m®loc_ªd_ÿÎoc_defšed


	)

464 
__BEGIN_NAMESPACE_STD


466 *
	$m®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

468 *
	$ÿÎoc
 (
size_t
 
__nmemb
, size_ˆ
__size
)

469 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

470 
__END_NAMESPACE_STD


473 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


474 
__BEGIN_NAMESPACE_STD


480 *
	$»®loc
 (*
__±r
, 
size_t
 
__size
)

481 
__THROW
 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

483 
	$ä“
 (*
__±r
è
__THROW
;

484 
__END_NAMESPACE_STD


486 #ifdef 
__USE_MISC


488 
	$cä“
 (*
__±r
è
__THROW
;

491 #ià
defšed
 
__USE_GNU
 || defšed 
__USE_BSD
 || defšed 
__USE_MISC


492 
	~<®loÿ.h
>

495 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

496 || 
defšed
 
__USE_BSD


498 *
	$v®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

501 #ifdeà
__USE_XOPEN2K


503 
	$posix_mem®ign
 (**
__mem±r
, 
size_t
 
__®ignm’t
, size_ˆ
__size
)

504 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

507 #ifdeà
__USE_ISOC11


509 *
	$®igÃd_®loc
 (
size_t
 
__®ignm’t
, size_ˆ
__size
)

510 
__THROW
 
__©Œibu‹_m®loc__
 
	`__©Œibu‹_®loc_size__
 ((2)è
__wur
;

513 
__BEGIN_NAMESPACE_STD


515 
	$abÜt
 (è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

519 
	`©ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

521 #ià
defšed
 
__USE_ISOC11
 || defšed 
__USE_ISOCXX11


523 #ifdeà
__ılu¥lus


524 "C++" 
	`©_quick_ex™
 ((*
__func
) ())

525 
__THROW
 
	`__asm
 ("©_quick_ex™"è
	`__nÚnuÎ
 ((1));

527 
	`©_quick_ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

530 
__END_NAMESPACE_STD


532 #ifdef 
__USE_MISC


535 
	`Ú_ex™
 ((*
__func
è(
__¡©us
, *
__¬g
), *__arg)

536 
__THROW
 
	`__nÚnuÎ
 ((1));

539 
__BEGIN_NAMESPACE_STD


543 
	$ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

545 #ià
defšed
 
__USE_ISOC11
 || defšed 
__USE_ISOCXX11


549 
	$quick_ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

551 
__END_NAMESPACE_STD


553 #ifdeà
__USE_ISOC99


554 
__BEGIN_NAMESPACE_C99


557 
	$_Ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

558 
__END_NAMESPACE_C99


562 
__BEGIN_NAMESPACE_STD


564 *
	$g‘’v
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

565 
__END_NAMESPACE_STD


567 #ifdeà
__USE_GNU


570 *
	$£cu»_g‘’v
 (cÚ¡ *
__Çme
)

571 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

574 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


578 
	$pu‹nv
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

581 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


584 
	$£‹nv
 (cÚ¡ *
__Çme
, cÚ¡ *
__v®ue
, 
__»¶aû
)

585 
__THROW
 
	`__nÚnuÎ
 ((2));

588 
	$un£‹nv
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

591 #ifdef 
__USE_MISC


595 
	$ş—»nv
 (è
__THROW
;

599 #ià
defšed
 
__USE_MISC
 \

600 || (
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
)

606 *
	$mk‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1));

609 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 \

610 || 
defšed
 
__USE_XOPEN2K8


619 #iâdeà
__USE_FILE_OFFSET64


620 
	$mk¡emp
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

622 #ifdeà
__REDIRECT


623 
	`__REDIRECT
 (
mk¡emp
, (*
__‹m¶©e
), 
mk¡emp64
)

624 
	`__nÚnuÎ
 ((1)è
__wur
;

626 
	#mk¡emp
 
mk¡emp64


	)

629 #ifdeà
__USE_LARGEFILE64


630 
	$mk¡emp64
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

634 #ifdeà
__USE_MISC


641 #iâdeà
__USE_FILE_OFFSET64


642 
	$mk¡emps
 (*
__‹m¶©e
, 
__suffixËn
è
	`__nÚnuÎ
 ((1)è
__wur
;

644 #ifdeà
__REDIRECT


645 
	`__REDIRECT
 (
mk¡emps
, (*
__‹m¶©e
, 
__suffixËn
),

646 
mk¡emps64
è
	`__nÚnuÎ
 ((1)è
__wur
;

648 
	#mk¡emps
 
mk¡emps64


	)

651 #ifdeà
__USE_LARGEFILE64


652 
	$mk¡emps64
 (*
__‹m¶©e
, 
__suffixËn
)

653 
	`__nÚnuÎ
 ((1)è
__wur
;

657 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K8


663 *
	$mkd‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

666 #ifdeà
__USE_GNU


673 #iâdeà
__USE_FILE_OFFSET64


674 
	$mko¡emp
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

676 #ifdeà
__REDIRECT


677 
	`__REDIRECT
 (
mko¡emp
, (*
__‹m¶©e
, 
__æags
), 
mko¡emp64
)

678 
	`__nÚnuÎ
 ((1)è
__wur
;

680 
	#mko¡emp
 
mko¡emp64


	)

683 #ifdeà
__USE_LARGEFILE64


684 
	$mko¡emp64
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

693 #iâdeà
__USE_FILE_OFFSET64


694 
	$mko¡emps
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

695 
	`__nÚnuÎ
 ((1)è
__wur
;

697 #ifdeà
__REDIRECT


698 
	`__REDIRECT
 (
mko¡emps
, (*
__‹m¶©e
, 
__suffixËn
,

699 
__æags
), 
mko¡emps64
)

700 
	`__nÚnuÎ
 ((1)è
__wur
;

702 
	#mko¡emps
 
mko¡emps64


	)

705 #ifdeà
__USE_LARGEFILE64


706 
	$mko¡emps64
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

707 
	`__nÚnuÎ
 ((1)è
__wur
;

712 
__BEGIN_NAMESPACE_STD


717 
	$sy¡em
 (cÚ¡ *
__commªd
è
__wur
;

718 
__END_NAMESPACE_STD


721 #ifdef 
__USE_GNU


724 *
	$ÿnÚiÿlize_fe_Çme
 (cÚ¡ *
__Çme
)

725 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

728 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


734 *
	$»®·th
 (cÚ¡ *
__»¡riù
 
__Çme
,

735 *
__»¡riù
 
__»sŞved
è
__THROW
 
__wur
;

740 #iâdeà
__COMPAR_FN_T


741 
	#__COMPAR_FN_T


	)

742 (*
	t__com·r_â_t
) (const *, const *);

744 #ifdef 
__USE_GNU


745 
__com·r_â_t
 
	tcom·risÚ_â_t
;

748 #ifdeà
__USE_GNU


749 (*
	t__com·r_d_â_t
) (const *, const *, *);

752 
__BEGIN_NAMESPACE_STD


755 *
	$b£¬ch
 (cÚ¡ *
__key
, cÚ¡ *
__ba£
,

756 
size_t
 
__nmemb
, size_ˆ
__size
, 
__com·r_â_t
 
__com·r
)

757 
	`__nÚnuÎ
 ((1, 2, 5)è
__wur
;

759 #ifdeà
__USE_EXTERN_INLINES


760 
	~<b™s/¡dlib-b£¬ch.h
>

765 
	$qsÜt
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

766 
__com·r_â_t
 
__com·r
è
	`__nÚnuÎ
 ((1, 4));

767 #ifdeà
__USE_GNU


768 
	$qsÜt_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

769 
__com·r_d_â_t
 
__com·r
, *
__¬g
)

770 
	`__nÚnuÎ
 ((1, 4));

775 
	$abs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

776 
	$Ïbs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

777 
__END_NAMESPACE_STD


779 #ifdeà
__USE_ISOC99


780 
__ex‹nsiÚ__
 
	$Îabs
 (
__x
)

781 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

785 
__BEGIN_NAMESPACE_STD


789 
div_t
 
	$div
 (
__num”
, 
__d’om
)

790 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

791 
ldiv_t
 
	$ldiv
 (
__num”
, 
__d’om
)

792 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

793 
__END_NAMESPACE_STD


795 #ifdeà
__USE_ISOC99


796 
__BEGIN_NAMESPACE_C99


797 
__ex‹nsiÚ__
 
Îdiv_t
 
	$Îdiv
 (
__num”
,

798 
__d’om
)

799 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

800 
__END_NAMESPACE_C99


804 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

805 || 
defšed
 
__USE_SVID


812 *
	$ecvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

813 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

818 *
	$fcvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

819 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

824 *
	$gcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

825 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

828 #ifdeà
__USE_MISC


830 *
	$qecvt
 (
__v®ue
, 
__ndig™
,

831 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

832 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

833 *
	$qfcvt
 (
__v®ue
, 
__ndig™
,

834 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

835 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

836 *
	$qgcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

837 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

842 
	$ecvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

843 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

844 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

845 
	$fcvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

846 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

847 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

849 
	$qecvt_r
 (
__v®ue
, 
__ndig™
,

850 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

851 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

852 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

853 
	$qfcvt_r
 (
__v®ue
, 
__ndig™
,

854 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

855 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

856 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

860 
__BEGIN_NAMESPACE_STD


863 
	$mbËn
 (cÚ¡ *
__s
, 
size_t
 
__n
è
__THROW
;

866 
	$mbtowc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

867 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

870 
	$wùomb
 (*
__s
, 
wch¬_t
 
__wch¬
è
__THROW
;

874 
size_t
 
	$mb¡owcs
 (
wch¬_t
 *
__»¡riù
 
__pwcs
,

875 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

877 
size_t
 
	$wc¡ombs
 (*
__»¡riù
 
__s
,

878 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__pwcs
, 
size_t
 
__n
)

879 
__THROW
;

880 
__END_NAMESPACE_STD


883 #ifdeà
__USE_SVID


888 
	$½m©ch
 (cÚ¡ *
__»¥Ú£
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

892 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


899 
	$g‘subİt
 (**
__»¡riù
 
__İtiÚp
,

900 *cÚ¡ *
__»¡riù
 
__tok’s
,

901 **
__»¡riù
 
__v®u•
)

902 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3)è
__wur
;

906 #ifdeà
__USE_XOPEN


908 
	$£tkey
 (cÚ¡ *
__key
è
__THROW
 
	`__nÚnuÎ
 ((1));

914 #ifdeà
__USE_XOPEN2KXSI


916 
	$posix_İ’±
 (
__oæag
è
__wur
;

919 #ifdeà
__USE_XOPEN


924 
	$g¿Á±
 (
__fd
è
__THROW
;

928 
	$uÆock±
 (
__fd
è
__THROW
;

933 *
	$±¢ame
 (
__fd
è
__THROW
 
__wur
;

936 #ifdeà
__USE_GNU


940 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

941 
__THROW
 
	`__nÚnuÎ
 ((2));

944 
	`g‘±
 ();

947 #ifdeà
__USE_BSD


951 
	$g‘lßdavg
 (
__lßdavg
[], 
__ÃËm
)

952 
__THROW
 
	`__nÚnuÎ
 ((1));

955 
	~<b™s/¡dlib-æßt.h
>

958 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


959 
	~<b™s/¡dlib.h
>

961 #ifdeà
__LDBL_COMPAT


962 
	~<b™s/¡dlib-ldbl.h
>

966 #undeà
__Ãed_m®loc_ªd_ÿÎoc


968 
__END_DECLS


	@/usr/include/string.h

22 #iâdef 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


30 
	#__Ãed_size_t


	)

31 
	#__Ãed_NULL


	)

32 
	~<¡ddef.h
>

39 #ià
defšed
 
__ılu¥lus
 && (__ılu¥lu >ğ199711L || 
__GNUC_PREREQ
 (4, 4))

40 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

44 
__BEGIN_NAMESPACE_STD


46 *
	$memıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

47 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

50 *
	$memmove
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
)

51 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

52 
__END_NAMESPACE_STD


57 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN


58 *
	$memcıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

59 
__c
, 
size_t
 
__n
)

60 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

64 
__BEGIN_NAMESPACE_STD


66 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

69 
	$memcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

70 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

73 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


76 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

77 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

78 cÚ¡ *
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

79 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

81 #ifdeà
__OPTIMIZE__


82 
__ex‹º_®ways_šlše
 *

83 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW


85  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

88 
__ex‹º_®ways_šlše
 const *

89 
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
è
__THROW


91  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

94 
	}
}

96 *
	$memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

97 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

99 
__END_NAMESPACE_STD


101 #ifdeà
__USE_GNU


104 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


105 "C++" *
	$¿wmemchr
 (*
__s
, 
__c
)

106 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

107 "C++" cÚ¡ *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

108 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

110 *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

111 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

115 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


116 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

117 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

118 "C++" cÚ¡ *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

119 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

121 *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

122 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

127 
__BEGIN_NAMESPACE_STD


129 *
	$¡rıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

130 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

132 *
	$¡ºıy
 (*
__»¡riù
 
__de¡
,

133 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

134 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

137 *
	$¡rÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

138 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

140 *
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

141 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

144 
	$¡rcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

145 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

147 
	$¡ºcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

148 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

151 
	$¡rcŞl
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

152 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

154 
size_t
 
	$¡rxäm
 (*
__»¡riù
 
__de¡
,

155 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

156 
__THROW
 
	`__nÚnuÎ
 ((2));

157 
__END_NAMESPACE_STD


159 #ifdeà
__USE_XOPEN2K8


163 
	~<xloÿË.h
>

166 
	$¡rcŞl_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
__loÿË_t
 
__l
)

167 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

169 
size_t
 
	$¡rxäm_l
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
,

170 
__loÿË_t
 
__l
è
__THROW
 
	`__nÚnuÎ
 ((2, 4));

173 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 \

174 || 
defšed
 
__USE_XOPEN2K8


176 *
	$¡rdup
 (cÚ¡ *
__s
)

177 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

183 #ià
defšed
 
__USE_XOPEN2K8


184 *
	$¡ºdup
 (cÚ¡ *
__¡ršg
, 
size_t
 
__n
)

185 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

188 #ià
defšed
 
__USE_GNU
 && defšed 
__GNUC__


190 
	#¡rdu·
(
s
) \

191 (
__ex‹nsiÚ__
 \

193 cÚ¡ *
__Şd
 = (
s
); \

194 
size_t
 
__Ën
 = 
	`¡¾’
 (
__Şd
) + 1; \

195 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
); \

196 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

197 
	}
}))

	)

200 
	#¡ºdu·
(
s
, 
n
) \

201 (
__ex‹nsiÚ__
 \

203 cÚ¡ *
__Şd
 = (
s
); \

204 
size_t
 
__Ën
 = 
	`¡ºËn
 (
__Şd
, (
n
)); \

205 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
 + 1); \

206 
__Ãw
[
__Ën
] = '\0'; \

207 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

208 }))

	)

211 
	g__BEGIN_NAMESPACE_STD


213 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


216 *
¡rchr
 (*
__s
, 
__c
)

217 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

218 cÚ¡ *
¡rchr
 (cÚ¡ *
__s
, 
__c
)

219 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

221 #ifdeà
__OPTIMIZE__


222 
__ex‹º_®ways_šlše
 *

223 
¡rchr
 (*
__s
, 
__c
è
	g__THROW


225  
__butš_¡rchr
 (
__s
, 
__c
);

228 
__ex‹º_®ways_šlše
 const *

229 
¡rchr
 (cÚ¡ *
__s
, 
__c
è
	g__THROW


231  
__butš_¡rchr
 (
__s
, 
__c
);

236 *
	$¡rchr
 (cÚ¡ *
__s
, 
__c
)

237 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

240 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


243 *
	`¡¼chr
 (*
__s
, 
__c
)

244 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

245 cÚ¡ *
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
)

246 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

248 #ifdeà
__OPTIMIZE__


249 
__ex‹º_®ways_šlše
 *

250 
	`¡¼chr
 (*
__s
, 
__c
è
__THROW


252  
	`__butš_¡¼chr
 (
__s
, 
__c
);

255 
__ex‹º_®ways_šlše
 const *

256 
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
è
__THROW


258  
	`__butš_¡¼chr
 (
__s
, 
__c
);

261 
	}
}

263 *
	$¡¼chr
 (cÚ¡ *
__s
, 
__c
)

264 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

266 
__END_NAMESPACE_STD


268 #ifdeà
__USE_GNU


271 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


272 "C++" *
	$¡rchºul
 (*
__s
, 
__c
)

273 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

274 "C++" cÚ¡ *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

275 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

277 *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

278 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

282 
__BEGIN_NAMESPACE_STD


285 
size_t
 
	$¡rc¥n
 (cÚ¡ *
__s
, cÚ¡ *
__»jeù
)

286 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

289 
size_t
 
	$¡r¥n
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

290 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

292 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


295 *
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
)

296 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

297 cÚ¡ *
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

298 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

300 #ifdeà
__OPTIMIZE__


301 
__ex‹º_®ways_šlše
 *

302 
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
è
__THROW


304  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

307 
__ex‹º_®ways_šlše
 const *

308 
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
è
__THROW


310  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

313 
	}
}

315 *
	$¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

316 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

319 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


322 *
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

323 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

324 cÚ¡ *
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

325 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

327 #ifdeà
__OPTIMIZE__


328 
__ex‹º_®ways_šlše
 *

329 
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


331  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

334 
__ex‹º_®ways_šlše
 const *

335 
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


337  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

340 
	}
}

342 *
	$¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

343 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

348 *
	$¡¹ok
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
)

349 
__THROW
 
	`__nÚnuÎ
 ((2));

350 
__END_NAMESPACE_STD


354 *
	$__¡¹ok_r
 (*
__»¡riù
 
__s
,

355 cÚ¡ *
__»¡riù
 
__d–im
,

356 **
__»¡riù
 
__§ve_±r
)

357 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

358 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


359 *
	$¡¹ok_r
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
,

360 **
__»¡riù
 
__§ve_±r
)

361 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

364 #ifdeà
__USE_GNU


366 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


367 "C++" *
	$¡rÿ£¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

368 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

369 "C++" cÚ¡ *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
,

370 cÚ¡ *
__ÃedË
)

371 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

373 *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

374 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

378 #ifdeà
__USE_GNU


382 *
	$memmem
 (cÚ¡ *
__hay¡ack
, 
size_t
 
__hay¡ackËn
,

383 cÚ¡ *
__ÃedË
, 
size_t
 
__ÃedËËn
)

384 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 3));

388 *
	$__mempıy
 (*
__»¡riù
 
__de¡
,

389 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

390 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

391 *
	$mempıy
 (*
__»¡riù
 
__de¡
,

392 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

393 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

397 
__BEGIN_NAMESPACE_STD


399 
size_t
 
	$¡¾’
 (cÚ¡ *
__s
)

400 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

401 
__END_NAMESPACE_STD


403 #ifdef 
__USE_XOPEN2K8


406 
size_t
 
	$¡ºËn
 (cÚ¡ *
__¡ršg
, 
size_t
 
__maxËn
)

407 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

411 
__BEGIN_NAMESPACE_STD


413 *
	$¡»¼Ü
 (
__”ºum
è
__THROW
;

414 
__END_NAMESPACE_STD


415 #ià
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_MISC


423 #ià
defšed
 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


426 #ifdeà
__REDIRECT_NTH


427 
	`__REDIRECT_NTH
 (
¡»¼Ü_r
,

428 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
),

429 
__xpg_¡»¼Ü_r
è
	`__nÚnuÎ
 ((2));

431 
	$__xpg_¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

432 
__THROW
 
	`__nÚnuÎ
 ((2));

433 
	#¡»¼Ü_r
 
__xpg_¡»¼Ü_r


	)

438 *
	$¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

439 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

443 #ifdeà
__USE_XOPEN2K8


445 *
	$¡»¼Ü_l
 (
__”ºum
, 
__loÿË_t
 
__l
è
__THROW
;

451 
	$__bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

453 #ifdeà
__USE_BSD


455 
	$bcİy
 (cÚ¡ *
__¤c
, *
__de¡
, 
size_t
 
__n
)

456 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

459 
	$bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

462 
	$bcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

463 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

466 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


469 *
	`šdex
 (*
__s
, 
__c
)

470 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

471 cÚ¡ *
	`šdex
 (cÚ¡ *
__s
, 
__c
)

472 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

474 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


475 
__ex‹º_®ways_šlše
 *

476 
	`šdex
 (*
__s
, 
__c
è
__THROW


478  
	`__butš_šdex
 (
__s
, 
__c
);

481 
__ex‹º_®ways_šlše
 const *

482 
	`šdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


484  
	`__butš_šdex
 (
__s
, 
__c
);

487 
	}
}

489 *
	$šdex
 (cÚ¡ *
__s
, 
__c
)

490 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

494 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


497 *
	`ršdex
 (*
__s
, 
__c
)

498 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

499 cÚ¡ *
	`ršdex
 (cÚ¡ *
__s
, 
__c
)

500 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

502 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


503 
__ex‹º_®ways_šlše
 *

504 
	`ršdex
 (*
__s
, 
__c
è
__THROW


506  
	`__butš_ršdex
 (
__s
, 
__c
);

509 
__ex‹º_®ways_šlše
 const *

510 
	`ršdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


512  
	`__butš_ršdex
 (
__s
, 
__c
);

515 
	}
}

517 *
	$ršdex
 (cÚ¡ *
__s
, 
__c
)

518 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

523 
	$ffs
 (
__i
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

527 #ifdef 
__USE_GNU


528 
	$ff¦
 (
__l
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

529 
__ex‹nsiÚ__
 
	$ff¦l
 (
__Î
)

530 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

534 
	$¡rÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

535 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

538 
	$¡ºÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

539 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

542 #ifdef 
__USE_GNU


545 
	$¡rÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

546 
__loÿË_t
 
__loc
)

547 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

549 
	$¡ºÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

550 
size_t
 
__n
, 
__loÿË_t
 
__loc
)

551 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 4));

554 #ifdef 
__USE_BSD


557 *
	$¡r£p
 (**
__»¡riù
 
__¡ršgp
,

558 cÚ¡ *
__»¡riù
 
__d–im
)

559 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

562 #ifdef 
__USE_XOPEN2K8


564 *
	$¡rsigÇl
 (
__sig
è
__THROW
;

567 *
	$__¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

568 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

569 *
	$¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

570 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

574 *
	$__¡²ıy
 (*
__»¡riù
 
__de¡
,

575 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

576 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

577 *
	$¡²ıy
 (*
__»¡riù
 
__de¡
,

578 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

579 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

582 #ifdef 
__USE_GNU


584 
	$¡rv”scmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

585 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

588 *
	$¡räy
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

591 *
	$memäob
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

593 #iâdeà
ba£Çme


598 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


599 "C++" *
	$ba£Çme
 (*
__f’ame
)

600 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

601 "C++" cÚ¡ *
	$ba£Çme
 (cÚ¡ *
__f’ame
)

602 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

604 *
	$ba£Çme
 (cÚ¡ *
__f’ame
è
__THROW
 
	`__nÚnuÎ
 ((1));

610 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

611 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__OPTIMIZE_SIZE__
 \

612 && !
defšed
 
__NO_INLINE__
 && !defšed 
__ılu¥lus


632 
	~<b™s/¡ršg.h
>

635 
	~<b™s/¡ršg2.h
>

638 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


640 
	~<b™s/¡ršg3.h
>

644 
__END_DECLS


	@/usr/include/strings.h

18 #iâdef 
_STRINGS_H


19 
	#_STRINGS_H
 1

	)

24 #ià!
defšed
 
_STRING_H
 || !defšed 
__USE_BSD


26 
	~<ã©u»s.h
>

27 
	#__Ãed_size_t


	)

28 
	~<¡ddef.h
>

35 #ià
defšed
 
__ılu¥lus
 && (__ılu¥lu >ğ199711L || 
__GNUC_PREREQ
 (4, 4))

36 
	#__CORRECT_ISO_CPP_STRINGS_H_PROTO


	)

39 
	g__BEGIN_DECLS


41 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8


43 
	$bcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

44 
__THROW
 
__©Œibu‹_pu»__
;

47 
	$bcİy
 (cÚ¡ *
__¤c
, *
__de¡
, 
size_t
 
__n
è
__THROW
;

50 
	$bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
;

53 #ifdeà
__CORRECT_ISO_CPP_STRINGS_H_PROTO


56 *
	`šdex
 (*
__s
, 
__c
)

57 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

58 cÚ¡ *
	`šdex
 (cÚ¡ *
__s
, 
__c
)

59 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

61 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRING_H_PROTO


62 
__ex‹º_®ways_šlše
 *

63 
	`šdex
 (*
__s
, 
__c
è
__THROW


65  
	`__butš_šdex
 (
__s
, 
__c
);

68 
__ex‹º_®ways_šlše
 const *

69 
	`šdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


71  
	`__butš_šdex
 (
__s
, 
__c
);

74 
	}
}

76 *
	$šdex
 (cÚ¡ *
__s
, 
__c
)

77 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

81 #ifdeà
__CORRECT_ISO_CPP_STRINGS_H_PROTO


84 *
	`ršdex
 (*
__s
, 
__c
)

85 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

86 cÚ¡ *
	`ršdex
 (cÚ¡ *
__s
, 
__c
)

87 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

89 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRING_H_PROTO


90 
__ex‹º_®ways_šlše
 *

91 
	`ršdex
 (*
__s
, 
__c
è
__THROW


93  
	`__butš_ršdex
 (
__s
, 
__c
);

96 
__ex‹º_®ways_šlše
 const *

97 
	`ršdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


99  
	`__butš_ršdex
 (
__s
, 
__c
);

102 
	}
}

104 *
	$ršdex
 (cÚ¡ *
__s
, 
__c
)

105 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

109 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8
 || defšed 
__USE_XOPEN2K8XSI


112 
	$ffs
 (
__i
è
__THROW
 
	`__©Œibu‹__
 ((const));

116 
	$¡rÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

117 
__THROW
 
__©Œibu‹_pu»__
;

120 
	$¡ºÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

121 
__THROW
 
__©Œibu‹_pu»__
;

123 #ifdef 
__USE_XOPEN2K8


127 
	~<xloÿË.h
>

131 
	$¡rÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
__loÿË_t
 
__loc
)

132 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

134 
	$¡ºÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

135 
size_t
 
__n
, 
__loÿË_t
 
__loc
)

136 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 4));

139 
__END_DECLS


	@/usr/include/time.h

22 #iâdef 
_TIME_H


24 #ià(! 
defšed
 
__Ãed_time_t
 && !defšed 
__Ãed_şock_t
 && \

25 ! 
defšed
 
	g__Ãed_time¥ec
)

26 
	#_TIME_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	g__BEGIN_DECLS


33 #ifdef 
_TIME_H


35 
	#__Ãed_size_t


	)

36 
	#__Ãed_NULL


	)

37 
	~<¡ddef.h
>

41 
	~<b™s/time.h
>

44 #ià!
defšed
 
__STRICT_ANSI__
 && !defšed 
__USE_XOPEN2K


45 #iâdeà
CLK_TCK


46 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

52 #ià!
defšed
 
__şock_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_şock_t
)

53 
	#__şock_t_defšed
 1

	)

55 
	~<b™s/ty³s.h
>

57 
__BEGIN_NAMESPACE_STD


59 
__şock_t
 
	tşock_t
;

60 
	g__END_NAMESPACE_STD


61 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX
 || defšed 
__USE_MISC


62 
	$__USING_NAMESPACE_STD
(
şock_t
)

66 #undeà
__Ãed_şock_t


68 #ià!
defšed
 
__time_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_time_t
)

69 
	#__time_t_defšed
 1

	)

71 
	~<b™s/ty³s.h
>

73 
__BEGIN_NAMESPACE_STD


75 
__time_t
 
	ttime_t
;

76 
__END_NAMESPACE_STD


77 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC
 || defšed 
__USE_SVID


78 
	$__USING_NAMESPACE_STD
(
time_t
)

82 #undeà
__Ãed_time_t


84 #ià!
defšed
 
__şockid_t_defšed
 && \

85 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_şockid_t
)

86 
	#__şockid_t_defšed
 1

	)

88 
	~<b™s/ty³s.h
>

91 
__şockid_t
 
	tşockid_t
;

94 #undeà
__şockid_time_t


96 #ià!
defšed
 
__tim”_t_defšed
 && \

97 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_tim”_t
)

98 
	#__tim”_t_defšed
 1

	)

100 
	~<b™s/ty³s.h
>

103 
__tim”_t
 
	ttim”_t
;

106 #undeà
__Ãed_tim”_t


109 #ià(!
defšed
 
__time¥ec_defšed
 \

110 && ((
defšed
 
_TIME_H
 \

111 && (
defšed
 
__USE_POSIX199309
 || defšed 
__USE_MISC
 \

112 || 
defšed
 
__USE_ISOC11
)) \

113 || 
defšed
 
__Ãed_time¥ec
))

114 
	#__time¥ec_defšed
 1

	)

116 
	~<b™s/ty³s.h
>

120 
	stime¥ec


122 
__time_t
 
tv_£c
;

123 
__sysÿÎ_¦Úg_t
 
tv_n£c
;

127 #undeà
__Ãed_time¥ec


130 #ifdef 
_TIME_H


131 
__BEGIN_NAMESPACE_STD


133 
	stm


135 
tm_£c
;

136 
tm_mš
;

137 
tm_hour
;

138 
tm_mday
;

139 
tm_mÚ
;

140 
tm_y—r
;

141 
tm_wday
;

142 
tm_yday
;

143 
tm_isd¡
;

145 #ifdef 
__USE_BSD


146 
tm_gmtoff
;

147 cÚ¡ *
tm_zÚe
;

149 
__tm_gmtoff
;

150 cÚ¡ *
__tm_zÚe
;

153 
__END_NAMESPACE_STD


154 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX
 || defšed 
__USE_MISC


155 
	$__USING_NAMESPACE_STD
(
tm
)

159 #ifdeà
__USE_POSIX199309


161 
	s™im”¥ec


163 
time¥ec
 
™_š‹rv®
;

164 
time¥ec
 
™_v®ue
;

168 
sigev’t
;

172 #ifdeà
__USE_XOPEN2K


173 #iâdeà
__pid_t_defšed


174 
__pid_t
 
	tpid_t
;

175 
	#__pid_t_defšed


	)

180 #ifdeà
__USE_ISOC11


182 
	#TIME_UTC
 1

	)

186 
__BEGIN_NAMESPACE_STD


189 
şock_t
 
	$şock
 (è
__THROW
;

192 
time_t
 
	$time
 (
time_t
 *
__tim”
è
__THROW
;

195 
	$difáime
 (
time_t
 
__time1
,ime_ˆ
__time0
)

196 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

199 
time_t
 
	$mktime
 (
tm
 *
__
è
__THROW
;

205 
size_t
 
	$¡ráime
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

206 cÚ¡ *
__»¡riù
 
__fÜm©
,

207 cÚ¡ 
tm
 *
__»¡riù
 
__
è
__THROW
;

208 
__END_NAMESPACE_STD


210 #ifdeà
__USE_XOPEN


213 *
	$¡½time
 (cÚ¡ *
__»¡riù
 
__s
,

214 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
)

215 
__THROW
;

218 #ifdeà
__USE_XOPEN2K8


221 
	~<xloÿË.h
>

223 
size_t
 
	$¡ráime_l
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

224 cÚ¡ *
__»¡riù
 
__fÜm©
,

225 cÚ¡ 
tm
 *
__»¡riù
 
__
,

226 
__loÿË_t
 
__loc
è
__THROW
;

229 #ifdeà
__USE_GNU


230 *
	$¡½time_l
 (cÚ¡ *
__»¡riù
 
__s
,

231 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
,

232 
__loÿË_t
 
__loc
è
__THROW
;

236 
__BEGIN_NAMESPACE_STD


239 
tm
 *
	$gmtime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

243 
tm
 *
	$loÿÉime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

244 
__END_NAMESPACE_STD


246 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


249 
tm
 *
	$gmtime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

250 
tm
 *
__»¡riù
 
__
è
__THROW
;

254 
tm
 *
	$loÿÉime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

255 
tm
 *
__»¡riù
 
__
è
__THROW
;

258 
__BEGIN_NAMESPACE_STD


261 *
	$asùime
 (cÚ¡ 
tm
 *
__
è
__THROW
;

264 *
	$ùime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

265 
__END_NAMESPACE_STD


267 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


272 *
	$asùime_r
 (cÚ¡ 
tm
 *
__»¡riù
 
__
,

273 *
__»¡riù
 
__buf
è
__THROW
;

276 *
	$ùime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

277 *
__»¡riù
 
__buf
è
__THROW
;

282 *
__tzÇme
[2];

283 
__daylight
;

284 
__timezÚe
;

287 #ifdef 
__USE_POSIX


289 *
tzÇme
[2];

293 
	$tz£t
 (è
__THROW
;

296 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


297 
daylight
;

298 
timezÚe
;

301 #ifdeà
__USE_SVID


304 
	$¡ime
 (cÚ¡ 
time_t
 *
__wh’
è
__THROW
;

310 
	#__i¦—p
(
y—r
) \

311 ((
y—r
è% 4 =ğ0 && ((y—rè% 100 !ğ0 || (y—rè% 400 =ğ0))

	)

314 #ifdeà
__USE_MISC


319 
time_t
 
	$timegm
 (
tm
 *
__
è
__THROW
;

322 
time_t
 
	$tim–oÿl
 (
tm
 *
__
è
__THROW
;

325 
	$dysize
 (
__y—r
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

329 #ifdeà
__USE_POSIX199309


334 
	`Çno¦“p
 (cÚ¡ 
time¥ec
 *
__»que¡ed_time
,

335 
time¥ec
 *
__»maššg
);

339 
	$şock_g‘»s
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__»s
è
__THROW
;

342 
	$şock_g‘time
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__
è
__THROW
;

345 
	$şock_£‰ime
 (
şockid_t
 
__şock_id
, cÚ¡ 
time¥ec
 *
__
)

346 
__THROW
;

348 #ifdeà
__USE_XOPEN2K


353 
	`şock_Çno¦“p
 (
şockid_t
 
__şock_id
, 
__æags
,

354 cÚ¡ 
time¥ec
 *
__»q
,

355 
time¥ec
 *
__»m
);

358 
	$şock_g‘ıuşockid
 (
pid_t
 
__pid
, 
şockid_t
 *
__şock_id
è
__THROW
;

363 
	$tim”_ü—‹
 (
şockid_t
 
__şock_id
,

364 
sigev’t
 *
__»¡riù
 
__evp
,

365 
tim”_t
 *
__»¡riù
 
__tim”id
è
__THROW
;

368 
	$tim”_d–‘e
 (
tim”_t
 
__tim”id
è
__THROW
;

371 
	$tim”_£‰ime
 (
tim”_t
 
__tim”id
, 
__æags
,

372 cÚ¡ 
™im”¥ec
 *
__»¡riù
 
__v®ue
,

373 
™im”¥ec
 *
__»¡riù
 
__ov®ue
è
__THROW
;

376 
	$tim”_g‘time
 (
tim”_t
 
__tim”id
, 
™im”¥ec
 *
__v®ue
)

377 
__THROW
;

380 
	$tim”_g‘ov”run
 (
tim”_t
 
__tim”id
è
__THROW
;

384 #ifdeà
__USE_ISOC11


386 
	$time¥ec_g‘
 (
time¥ec
 *
__ts
, 
__ba£
)

387 
__THROW
 
	`__nÚnuÎ
 ((1));

391 #ifdeà
__USE_XOPEN_EXTENDED


403 
g‘d©e_”r
;

412 
tm
 *
	`g‘d©e
 (cÚ¡ *
__¡ršg
);

415 #ifdeà
__USE_GNU


426 
	`g‘d©e_r
 (cÚ¡ *
__»¡riù
 
__¡ršg
,

427 
tm
 *
__»¡riù
 
__»sbuå
);

430 
__END_DECLS


	@/usr/include/ucontext.h

20 #iâdeà
_UCONTEXT_H


21 
	#_UCONTEXT_H
 1

	)

23 
	~<ã©u»s.h
>

26 
	~<sys/ucÚ‹xt.h
>

28 
__BEGIN_DECLS


31 
	$g‘cÚ‹xt
 (
ucÚ‹xt_t
 *
__uı
è
__THROWNL
;

34 
	$£tcÚ‹xt
 (cÚ¡ 
ucÚ‹xt_t
 *
__uı
è
__THROWNL
;

38 
	$sw­cÚ‹xt
 (
ucÚ‹xt_t
 *
__»¡riù
 
__ouı
,

39 cÚ¡ 
ucÚ‹xt_t
 *
__»¡riù
 
__uı
è
__THROWNL
;

47 
	`makecÚ‹xt
 (
ucÚ‹xt_t
 *
__uı
, (*
__func
) (),

48 
__¬gc
, ...è
__THROW
;

50 
__END_DECLS


	@/usr/include/unistd.h

22 #iâdef 
_UNISTD_H


23 
	#_UNISTD_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


32 #ifdeà
__USE_XOPEN2K8


34 
	#_POSIX_VERSION
 200809L

	)

35 #–ià
defšed
 
__USE_XOPEN2K


37 
	#_POSIX_VERSION
 200112L

	)

38 #–ià
defšed
 
__USE_POSIX199506


40 
	#_POSIX_VERSION
 199506L

	)

41 #–ià
defšed
 
__USE_POSIX199309


43 
	#_POSIX_VERSION
 199309L

	)

46 
	#_POSIX_VERSION
 199009L

	)

52 #ifdeà
__USE_XOPEN2K8


53 
	#__POSIX2_THIS_VERSION
 200809L

	)

55 #–ià
defšed
 
__USE_XOPEN2K


57 
	#__POSIX2_THIS_VERSION
 200112L

	)

58 #–ià
defšed
 
__USE_POSIX199506


60 
	#__POSIX2_THIS_VERSION
 199506L

	)

63 
	#__POSIX2_THIS_VERSION
 199209L

	)

67 
	#_POSIX2_VERSION
 
__POSIX2_THIS_VERSION


	)

71 
	#_POSIX2_C_BIND
 
__POSIX2_THIS_VERSION


	)

75 
	#_POSIX2_C_DEV
 
__POSIX2_THIS_VERSION


	)

79 
	#_POSIX2_SW_DEV
 
__POSIX2_THIS_VERSION


	)

83 
	#_POSIX2_LOCALEDEF
 
__POSIX2_THIS_VERSION


	)

86 #ifdeà
__USE_XOPEN2K8


87 
	#_XOPEN_VERSION
 700

	)

88 #–ià
defšed
 
__USE_XOPEN2K


89 
	#_XOPEN_VERSION
 600

	)

90 #–ià
defšed
 
__USE_UNIX98


91 
	#_XOPEN_VERSION
 500

	)

93 
	#_XOPEN_VERSION
 4

	)

97 
	#_XOPEN_XCU_VERSION
 4

	)

100 
	#_XOPEN_XPG2
 1

	)

101 
	#_XOPEN_XPG3
 1

	)

102 
	#_XOPEN_XPG4
 1

	)

105 
	#_XOPEN_UNIX
 1

	)

108 
	#_XOPEN_CRYPT
 1

	)

112 
	#_XOPEN_ENH_I18N
 1

	)

115 
	#_XOPEN_LEGACY
 1

	)

202 
	~<b™s/posix_İt.h
>

205 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


206 
	~<b™s/’vœÚm’ts.h
>

210 
	#STDIN_FILENO
 0

	)

211 
	#STDOUT_FILENO
 1

	)

212 
	#STDERR_FILENO
 2

	)

217 
	~<b™s/ty³s.h
>

219 #iâdef 
__ssize_t_defšed


220 
__ssize_t
 
	tssize_t
;

221 
	#__ssize_t_defšed


	)

224 
	#__Ãed_size_t


	)

225 
	#__Ãed_NULL


	)

226 
	~<¡ddef.h
>

228 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


231 #iâdeà
__gid_t_defšed


232 
__gid_t
 
	tgid_t
;

233 
	#__gid_t_defšed


	)

236 #iâdeà
__uid_t_defšed


237 
__uid_t
 
	tuid_t
;

238 
	#__uid_t_defšed


	)

241 #iâdeà
__off_t_defšed


242 #iâdeà
__USE_FILE_OFFSET64


243 
__off_t
 
	toff_t
;

245 
__off64_t
 
	toff_t
;

247 
	#__off_t_defšed


	)

249 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


250 
__off64_t
 
	toff64_t
;

251 
	#__off64_t_defšed


	)

254 #iâdeà
__u£cÚds_t_defšed


255 
__u£cÚds_t
 
	tu£cÚds_t
;

256 
	#__u£cÚds_t_defšed


	)

259 #iâdeà
__pid_t_defšed


260 
__pid_t
 
	tpid_t
;

261 
	#__pid_t_defšed


	)

265 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


266 #iâdeà
__šŒ_t_defšed


267 
__šŒ_t
 
	tšŒ_t
;

268 
	#__šŒ_t_defšed


	)

272 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN


273 #iâdeà
__sockËn_t_defšed


274 
__sockËn_t
 
	tsockËn_t
;

275 
	#__sockËn_t_defšed


	)

281 
	#R_OK
 4

	)

282 
	#W_OK
 2

	)

283 
	#X_OK
 1

	)

284 
	#F_OK
 0

	)

287 
	$acûss
 (cÚ¡ *
__Çme
, 
__ty³
è
__THROW
 
	`__nÚnuÎ
 ((1));

289 #ifdeà
__USE_GNU


292 
	$euidacûss
 (cÚ¡ *
__Çme
, 
__ty³
)

293 
__THROW
 
	`__nÚnuÎ
 ((1));

296 
	$—cûss
 (cÚ¡ *
__Çme
, 
__ty³
)

297 
__THROW
 
	`__nÚnuÎ
 ((1));

300 #ifdeà
__USE_ATFILE


304 
	$çcûs§t
 (
__fd
, cÚ¡ *
__fe
, 
__ty³
, 
__æag
)

305 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

310 #iâdef 
_STDIO_H


311 
	#SEEK_SET
 0

	)

312 
	#SEEK_CUR
 1

	)

313 
	#SEEK_END
 2

	)

314 #ifdeà
__USE_GNU


315 
	#SEEK_DATA
 3

	)

316 
	#SEEK_HOLE
 4

	)

320 #ià
defšed
 
__USE_BSD
 && !defšed 
L_SET


322 
	#L_SET
 
SEEK_SET


	)

323 
	#L_INCR
 
SEEK_CUR


	)

324 
	#L_XTND
 
SEEK_END


	)

333 #iâdeà
__USE_FILE_OFFSET64


334 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__wh’û
è
__THROW
;

336 #ifdeà
__REDIRECT_NTH


337 
__off64_t
 
	`__REDIRECT_NTH
 (
l£ek
,

338 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
),

339 
l£ek64
);

341 
	#l£ek
 
l£ek64


	)

344 #ifdeà
__USE_LARGEFILE64


345 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
)

346 
__THROW
;

353 
	`şo£
 (
__fd
);

360 
ssize_t
 
	$»ad
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
è
__wur
;

366 
ssize_t
 
	$wr™e
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
è
__wur
;

368 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


369 #iâdeà
__USE_FILE_OFFSET64


376 
ssize_t
 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

377 
__off_t
 
__off£t
è
__wur
;

384 
ssize_t
 
	$pwr™e
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

385 
__off_t
 
__off£t
è
__wur
;

387 #ifdeà
__REDIRECT


388 
ssize_t
 
	`__REDIRECT
 (
´—d
, (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

389 
__off64_t
 
__off£t
),

390 
´—d64
è
__wur
;

391 
ssize_t
 
	`__REDIRECT
 (
pwr™e
, (
__fd
, cÚ¡ *
__buf
,

392 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
),

393 
pwr™e64
è
__wur
;

395 
	#´—d
 
´—d64


	)

396 
	#pwr™e
 
pwr™e64


	)

400 #ifdeà
__USE_LARGEFILE64


404 
ssize_t
 
	$´—d64
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

405 
__off64_t
 
__off£t
è
__wur
;

408 
ssize_t
 
	$pwr™e64
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

409 
__off64_t
 
__off£t
è
__wur
;

417 
	$pe
 (
__pedes
[2]è
__THROW
 
__wur
;

419 #ifdeà
__USE_GNU


422 
	$pe2
 (
__pedes
[2], 
__æags
è
__THROW
 
__wur
;

432 
	$®¬m
 (
__£cÚds
è
__THROW
;

444 
	`¦“p
 (
__£cÚds
);

446 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

447 || 
defšed
 
__USE_BSD


452 
__u£cÚds_t
 
	$u®¬m
 (
__u£cÚds_t
 
__v®ue
, __u£cÚds_ˆ
__š‹rv®
)

453 
__THROW
;

460 
	`u¦“p
 (
__u£cÚds_t
 
__u£cÚds
);

469 
	`·u£
 ();

473 
	$chown
 (cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

474 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

476 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


478 
	$fchown
 (
__fd
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
è
__THROW
 
__wur
;

483 
	$lchown
 (cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

484 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

488 #ifdeà
__USE_ATFILE


491 
	$fchowÇt
 (
__fd
, cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
,

492 
__gid_t
 
__group
, 
__æag
)

493 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

497 
	$chdœ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

499 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


501 
	$fchdœ
 (
__fd
è
__THROW
 
__wur
;

511 *
	$g‘cwd
 (*
__buf
, 
size_t
 
__size
è
__THROW
 
__wur
;

513 #ifdef 
__USE_GNU


517 *
	$g‘_cu¼’t_dœ_Çme
 (è
__THROW
;

520 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

521 || 
defšed
 
__USE_BSD


525 *
	$g‘wd
 (*
__buf
)

526 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
 
__wur
;

531 
	$dup
 (
__fd
è
__THROW
 
__wur
;

534 
	$dup2
 (
__fd
, 
__fd2
è
__THROW
;

536 #ifdeà
__USE_GNU


539 
	$dup3
 (
__fd
, 
__fd2
, 
__æags
è
__THROW
;

543 **
__’vœÚ
;

544 #ifdeà
__USE_GNU


545 **
’vœÚ
;

551 
	$execve
 (cÚ¡ *
__·th
, *cÚ¡ 
__¬gv
[],

552 *cÚ¡ 
__’vp
[]è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

554 #ifdeà
__USE_XOPEN2K8


557 
	$ãxecve
 (
__fd
, *cÚ¡ 
__¬gv
[], *cÚ¡ 
__’vp
[])

558 
__THROW
 
	`__nÚnuÎ
 ((2));

563 
	$execv
 (cÚ¡ *
__·th
, *cÚ¡ 
__¬gv
[])

564 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

568 
	$exeşe
 (cÚ¡ *
__·th
, cÚ¡ *
__¬g
, ...)

569 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

573 
	$exeş
 (cÚ¡ *
__·th
, cÚ¡ *
__¬g
, ...)

574 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

578 
	$execvp
 (cÚ¡ *
__fe
, *cÚ¡ 
__¬gv
[])

579 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

584 
	$exeşp
 (cÚ¡ *
__fe
, cÚ¡ *
__¬g
, ...)

585 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

587 #ifdeà
__USE_GNU


590 
	$execv³
 (cÚ¡ *
__fe
, *cÚ¡ 
__¬gv
[],

591 *cÚ¡ 
__’vp
[])

592 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

596 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


598 
	$niû
 (
__šc
è
__THROW
 
__wur
;

603 
	$_ex™
 (
__¡©us
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

609 
	~<b™s/cÚâame.h
>

612 
	$·thcÚf
 (cÚ¡ *
__·th
, 
__Çme
)

613 
__THROW
 
	`__nÚnuÎ
 ((1));

616 
	$å©hcÚf
 (
__fd
, 
__Çme
è
__THROW
;

619 
	$syscÚf
 (
__Çme
è
__THROW
;

621 #ifdef 
__USE_POSIX2


623 
size_t
 
	$cÚf¡r
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
è
__THROW
;

628 
__pid_t
 
	$g‘pid
 (è
__THROW
;

631 
__pid_t
 
	$g‘µid
 (è
__THROW
;

634 
__pid_t
 
	$g‘pg½
 (è
__THROW
;

637 
__pid_t
 
	$__g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

638 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


639 
__pid_t
 
	$g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

646 
	$£gid
 (
__pid_t
 
__pid
, __pid_ˆ
__pgid
è
__THROW
;

648 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


660 
	$£g½
 (è
__THROW
;

667 
__pid_t
 
	$£tsid
 (è
__THROW
;

669 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


671 
__pid_t
 
	$g‘sid
 (
__pid_t
 
__pid
è
__THROW
;

675 
__uid_t
 
	$g‘uid
 (è
__THROW
;

678 
__uid_t
 
	$g‘euid
 (è
__THROW
;

681 
__gid_t
 
	$g‘gid
 (è
__THROW
;

684 
__gid_t
 
	$g‘egid
 (è
__THROW
;

689 
	$g‘groups
 (
__size
, 
__gid_t
 
__li¡
[]è
__THROW
 
__wur
;

691 #ifdef 
__USE_GNU


693 
	$group_memb”
 (
__gid_t
 
__gid
è
__THROW
;

700 
	$£tuid
 (
__uid_t
 
__uid
è
__THROW
 
__wur
;

702 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


705 
	$£Œeuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
è
__THROW
 
__wur
;

708 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


710 
	$£‹uid
 (
__uid_t
 
__uid
è
__THROW
 
__wur
;

717 
	$£tgid
 (
__gid_t
 
__gid
è
__THROW
 
__wur
;

719 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


722 
	$£Œegid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
è
__THROW
 
__wur
;

725 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


727 
	$£‹gid
 (
__gid_t
 
__gid
è
__THROW
 
__wur
;

730 #ifdeà
__USE_GNU


733 
	$g‘»suid
 (
__uid_t
 *
__ruid
, __uid_ˆ*
__euid
, __uid_ˆ*
__suid
)

734 
__THROW
;

738 
	$g‘»sgid
 (
__gid_t
 *
__rgid
, __gid_ˆ*
__egid
, __gid_ˆ*
__sgid
)

739 
__THROW
;

743 
	$£Œesuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
, __uid_ˆ
__suid
)

744 
__THROW
 
__wur
;

748 
	$£Œesgid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
, __gid_ˆ
__sgid
)

749 
__THROW
 
__wur
;

756 
__pid_t
 
	$fÜk
 (è
__THROWNL
;

758 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

759 || 
defšed
 
__USE_BSD


764 
__pid_t
 
	$vfÜk
 (è
__THROW
;

770 *
	$‰yÇme
 (
__fd
è
__THROW
;

774 
	$‰yÇme_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

775 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

779 
	$i§‰y
 (
__fd
è
__THROW
;

781 #ià
defšed
 
__USE_BSD
 \

782 || (
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_UNIX98
)

785 
	$‰y¦Ù
 (è
__THROW
;

790 
	$lšk
 (cÚ¡ *
__äom
, cÚ¡ *
__to
)

791 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

793 #ifdeà
__USE_ATFILE


796 
	$lšk©
 (
__äomfd
, cÚ¡ *
__äom
, 
__tofd
,

797 cÚ¡ *
__to
, 
__æags
)

798 
__THROW
 
	`__nÚnuÎ
 ((2, 4)è
__wur
;

801 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


803 
	$symlšk
 (cÚ¡ *
__äom
, cÚ¡ *
__to
)

804 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

809 
ssize_t
 
	$»adlšk
 (cÚ¡ *
__»¡riù
 
__·th
,

810 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

811 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

814 #ifdeà
__USE_ATFILE


816 
	$symlšk©
 (cÚ¡ *
__äom
, 
__tofd
,

817 cÚ¡ *
__to
è
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

820 
ssize_t
 
	$»adlšk©
 (
__fd
, cÚ¡ *
__»¡riù
 
__·th
,

821 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

822 
__THROW
 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

826 
	$uÆšk
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

828 #ifdeà
__USE_ATFILE


830 
	$uÆšk©
 (
__fd
, cÚ¡ *
__Çme
, 
__æag
)

831 
__THROW
 
	`__nÚnuÎ
 ((2));

835 
	$rmdœ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1));

839 
__pid_t
 
	$tcg‘pg½
 (
__fd
è
__THROW
;

842 
	$tc£g½
 (
__fd
, 
__pid_t
 
__pg½_id
è
__THROW
;

849 *
	`g‘logš
 ();

850 #ià
defšed
 
__USE_REENTRANT
 || defšed 
__USE_POSIX199506


857 
	$g‘logš_r
 (*
__Çme
, 
size_t
 
__Çme_Ën
è
	`__nÚnuÎ
 ((1));

860 #ifdef 
__USE_BSD


862 
	$£ogš
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

866 #ifdef 
__USE_POSIX2


870 
	#__Ãed_g‘İt


	)

871 
	~<g‘İt.h
>

875 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


879 
	$g‘ho¡Çme
 (*
__Çme
, 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((1));

883 #ià
defšed
 
__USE_BSD
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_UNIX98
)

886 
	$£tho¡Çme
 (cÚ¡ *
__Çme
, 
size_t
 
__Ën
)

887 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

891 
	$£tho¡id
 (
__id
è
__THROW
 
__wur
;

897 
	$g‘domašÇme
 (*
__Çme
, 
size_t
 
__Ën
)

898 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

899 
	$£tdomašÇme
 (cÚ¡ *
__Çme
, 
size_t
 
__Ën
)

900 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

906 
	$vhªgup
 (è
__THROW
;

909 
	$»voke
 (cÚ¡ *
__fe
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

917 
	$´of
 (*
__§m¶e_bufãr
, 
size_t
 
__size
,

918 
size_t
 
__off£t
, 
__sÿË
)

919 
__THROW
 
	`__nÚnuÎ
 ((1));

925 
	$acù
 (cÚ¡ *
__Çme
è
__THROW
;

929 *
	$g‘u£rsh–l
 (è
__THROW
;

930 
	$’du£rsh–l
 (è
__THROW
;

931 
	$£tu£rsh–l
 (è
__THROW
;

937 
	$d«mÚ
 (
__nochdœ
, 
__noşo£
è
__THROW
 
__wur
;

941 #ià
defšed
 
__USE_BSD
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

944 
	$chroÙ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

948 *
	$g‘·ss
 (cÚ¡ *
__´om±
è
	`__nÚnuÎ
 ((1));

956 
	`fsync
 (
__fd
);

959 #ifdeà
__USE_GNU


962 
	$syncfs
 (
__fd
è
__THROW
;

966 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


969 
	`g‘ho¡id
 ();

972 
	$sync
 (è
__THROW
;

975 #ià
defšed
 
__USE_BSD
 || !defšed 
__USE_XOPEN2K


978 
	$g‘·gesize
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

983 
	$g‘dbËsize
 (è
__THROW
;

989 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


992 #iâdeà
__USE_FILE_OFFSET64


993 
	$Œunÿ‹
 (cÚ¡ *
__fe
, 
__off_t
 
__Ëngth
)

994 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

996 #ifdeà
__REDIRECT_NTH


997 
	`__REDIRECT_NTH
 (
Œunÿ‹
,

998 (cÚ¡ *
__fe
, 
__off64_t
 
__Ëngth
),

999 
Œunÿ‹64
è
	`__nÚnuÎ
 ((1)è
__wur
;

1001 
	#Œunÿ‹
 
Œunÿ‹64


	)

1004 #ifdeà
__USE_LARGEFILE64


1005 
	$Œunÿ‹64
 (cÚ¡ *
__fe
, 
__off64_t
 
__Ëngth
)

1006 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

1011 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_POSIX199309
 \

1012 || 
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


1015 #iâdeà
__USE_FILE_OFFSET64


1016 
	$árunÿ‹
 (
__fd
, 
__off_t
 
__Ëngth
è
__THROW
 
__wur
;

1018 #ifdeà
__REDIRECT_NTH


1019 
	`__REDIRECT_NTH
 (
árunÿ‹
, (
__fd
, 
__off64_t
 
__Ëngth
),

1020 
árunÿ‹64
è
__wur
;

1022 
	#árunÿ‹
 
árunÿ‹64


	)

1025 #ifdeà
__USE_LARGEFILE64


1026 
	$árunÿ‹64
 (
__fd
, 
__off64_t
 
__Ëngth
è
__THROW
 
__wur
;

1032 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

1033 || 
defšed
 
__USE_MISC


1037 
	$brk
 (*
__addr
è
__THROW
 
__wur
;

1043 *
	$sbrk
 (
šŒ_t
 
__d–
è
__THROW
;

1047 #ifdeà
__USE_MISC


1058 
	$sysÿÎ
 (
__sy¢o
, ...è
__THROW
;

1063 #ià(
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
è&& !defšed 
F_LOCK


1075 
	#F_ULOCK
 0

	)

1076 
	#F_LOCK
 1

	)

1077 
	#F_TLOCK
 2

	)

1078 
	#F_TEST
 3

	)

1080 #iâdeà
__USE_FILE_OFFSET64


1081 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Ën
è
__wur
;

1083 #ifdeà
__REDIRECT


1084 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
),

1085 
lockf64
è
__wur
;

1087 
	#lockf
 
lockf64


	)

1090 #ifdeà
__USE_LARGEFILE64


1091 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
è
__wur
;

1096 #ifdeà
__USE_GNU


1101 
	#TEMP_FAILURE_RETRY
(
ex´essiÚ
) \

1102 (
__ex‹nsiÚ__
 \

1103 ({ 
__»suÉ
; \

1104 dØ
__»suÉ
 = (è(
ex´essiÚ
); \

1105 
__»suÉ
 =ğ-1L && 
”ºo
 =ğ
EINTR
); \

1106 
__»suÉ
; 
	}
}))

	)

1109 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_UNIX98


1112 
fd©async
 (
__fdes
);

1118 #ifdef 
__USE_XOPEN


1120 *
	$üy±
 (cÚ¡ *
__key
, cÚ¡ *
__§É
)

1121 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1125 
	$’üy±
 (*
__glibc_block
, 
__edæag
)

1126 
__THROW
 
	`__nÚnuÎ
 ((1));

1133 
	$swab
 (cÚ¡ *
__»¡riù
 
__äom
, *__»¡riù 
__to
,

1134 
ssize_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1140 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K


1142 *
	$ù”mid
 (*
__s
è
__THROW
;

1147 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


1148 
	~<b™s/uni¡d.h
>

1151 
__END_DECLS


	@/usr/include/values.h

22 #iâdef 
_VALUES_H


23 
	#_VALUES_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	~<lim™s.h
>

29 
	#_TYPEBITS
(
ty³
è( (ty³è* 
CHAR_BIT
)

	)

31 
	#CHARBITS
 
	`_TYPEBITS
 ()

	)

32 
	#SHORTBITS
 
	`_TYPEBITS
 ()

	)

33 
	#INTBITS
 
	`_TYPEBITS
 ()

	)

34 
	#LONGBITS
 
	`_TYPEBITS
 ()

	)

35 
	#PTRBITS
 
	`_TYPEBITS
 (*)

	)

36 
	#DOUBLEBITS
 
	`_TYPEBITS
 ()

	)

37 
	#FLOATBITS
 
	`_TYPEBITS
 ()

	)

39 
	#MINSHORT
 
SHRT_MIN


	)

40 
	#MININT
 
INT_MIN


	)

41 
	#MINLONG
 
LONG_MIN


	)

43 
	#MAXSHORT
 
SHRT_MAX


	)

44 
	#MAXINT
 
INT_MAX


	)

45 
	#MAXLONG
 
LONG_MAX


	)

47 
	#HIBITS
 
MINSHORT


	)

48 
	#HIBITL
 
MINLONG


	)

51 
	~<æßt.h
>

53 
	#MAXDOUBLE
 
DBL_MAX


	)

54 
	#MAXFLOAT
 
FLT_MAX


	)

55 
	#MINDOUBLE
 
DBL_MIN


	)

56 
	#MINFLOAT
 
FLT_MIN


	)

57 
	#DMINEXP
 
DBL_MIN_EXP


	)

58 
	#FMINEXP
 
FLT_MIN_EXP


	)

59 
	#DMAXEXP
 
DBL_MAX_EXP


	)

60 
	#FMAXEXP
 
FLT_MAX_EXP


	)

63 #ifdeà
__USE_MISC


65 
	#BITSPERBYTE
 
CHAR_BIT


	)

	@/usr/include/alloca.h

18 #iâdef 
_ALLOCA_H


19 
	#_ALLOCA_H
 1

	)

21 
	~<ã©u»s.h
>

23 
	#__Ãed_size_t


	)

24 
	~<¡ddef.h
>

26 
	g__BEGIN_DECLS


29 #undeà
®loÿ


32 *
	$®loÿ
 (
size_t
 
__size
è
__THROW
;

34 #ifdef 
__GNUC__


35 
	#®loÿ
(
size
è
	`__butš_®loÿ
 (size)

	)

38 
__END_DECLS


	@/usr/include/endian.h

18 #iâdef 
_ENDIAN_H


19 
	#_ENDIAN_H
 1

	)

21 
	~<ã©u»s.h
>

31 
	#__LITTLE_ENDIAN
 1234

	)

32 
	#__BIG_ENDIAN
 4321

	)

33 
	#__PDP_ENDIAN
 3412

	)

36 
	~<b™s/’dŸn.h
>

40 #iâdeà
__FLOAT_WORD_ORDER


41 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

44 #ifdef 
__USE_BSD


45 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

46 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

47 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

48 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

51 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


52 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èLO, 
	)
HI

53 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


54 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èHI, 
	)
LO

58 #ià
defšed
 
__USE_BSD
 && !defšed 
__ASSEMBLER__


60 
	~<b™s/by‹sw­.h
>

62 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


63 
	#htobe16
(
x
è
	`__bsw­_16
 (x)

	)

64 
	#htŞe16
(
x
è(x)

	)

65 
	#be16toh
(
x
è
	`__bsw­_16
 (x)

	)

66 
	#Ë16toh
(
x
è(x)

	)

68 
	#htobe32
(
x
è
	`__bsw­_32
 (x)

	)

69 
	#htŞe32
(
x
è(x)

	)

70 
	#be32toh
(
x
è
	`__bsw­_32
 (x)

	)

71 
	#Ë32toh
(
x
è(x)

	)

73 
	#htobe64
(
x
è
	`__bsw­_64
 (x)

	)

74 
	#htŞe64
(
x
è(x)

	)

75 
	#be64toh
(
x
è
	`__bsw­_64
 (x)

	)

76 
	#Ë64toh
(
x
è(x)

	)

79 
	#htobe16
(
x
è(x)

	)

80 
	#htŞe16
(
x
è
	`__bsw­_16
 (x)

	)

81 
	#be16toh
(
x
è(x)

	)

82 
	#Ë16toh
(
x
è
	`__bsw­_16
 (x)

	)

84 
	#htobe32
(
x
è(x)

	)

85 
	#htŞe32
(
x
è
	`__bsw­_32
 (x)

	)

86 
	#be32toh
(
x
è(x)

	)

87 
	#Ë32toh
(
x
è
	`__bsw­_32
 (x)

	)

89 
	#htobe64
(
x
è(x)

	)

90 
	#htŞe64
(
x
è
	`__bsw­_64
 (x)

	)

91 
	#be64toh
(
x
è(x)

	)

92 
	#Ë64toh
(
x
è
	`__bsw­_64
 (x)

	)

	@/usr/include/features.h

18 #iâdef 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

101 #undeà
__USE_ISOC11


102 #undeà
__USE_ISOC99


103 #undeà
__USE_ISOC95


104 #undeà
__USE_ISOCXX11


105 #undeà
__USE_POSIX


106 #undeà
__USE_POSIX2


107 #undeà
__USE_POSIX199309


108 #undeà
__USE_POSIX199506


109 #undeà
__USE_XOPEN


110 #undeà
__USE_XOPEN_EXTENDED


111 #undeà
__USE_UNIX98


112 #undeà
__USE_XOPEN2K


113 #undeà
__USE_XOPEN2KXSI


114 #undeà
__USE_XOPEN2K8


115 #undeà
__USE_XOPEN2K8XSI


116 #undeà
__USE_LARGEFILE


117 #undeà
__USE_LARGEFILE64


118 #undeà
__USE_FILE_OFFSET64


119 #undeà
__USE_BSD


120 #undeà
__USE_SVID


121 #undeà
__USE_MISC


122 #undeà
__USE_ATFILE


123 #undeà
__USE_GNU


124 #undeà
__USE_REENTRANT


125 #undeà
__USE_FORTIFY_LEVEL


126 #undeà
__KERNEL_STRICT_NAMES


130 #iâdeà
_LOOSE_KERNEL_NAMES


131 
	#__KERNEL_STRICT_NAMES


	)

141 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


142 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

143 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

145 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

150 #ifdeà
_GNU_SOURCE


151 #undeà
_ISOC95_SOURCE


152 
	#_ISOC95_SOURCE
 1

	)

153 #undeà
_ISOC99_SOURCE


154 
	#_ISOC99_SOURCE
 1

	)

155 #undeà
_ISOC11_SOURCE


156 
	#_ISOC11_SOURCE
 1

	)

157 #undeà
_POSIX_SOURCE


158 
	#_POSIX_SOURCE
 1

	)

159 #undeà
_POSIX_C_SOURCE


160 
	#_POSIX_C_SOURCE
 200809L

	)

161 #undeà
_XOPEN_SOURCE


162 
	#_XOPEN_SOURCE
 700

	)

163 #undeà
_XOPEN_SOURCE_EXTENDED


164 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

165 #undeà
_LARGEFILE64_SOURCE


166 
	#_LARGEFILE64_SOURCE
 1

	)

167 #undeà
_DEFAULT_SOURCE


168 
	#_DEFAULT_SOURCE
 1

	)

169 #undeà
_BSD_SOURCE


170 
	#_BSD_SOURCE
 1

	)

171 #undeà
_SVID_SOURCE


172 
	#_SVID_SOURCE
 1

	)

173 #undeà
_ATFILE_SOURCE


174 
	#_ATFILE_SOURCE
 1

	)

179 #ià(
defšed
 
_DEFAULT_SOURCE
 \

180 || (!
defšed
 
	g__STRICT_ANSI__
 \

181 && !
defšed
 
	g_ISOC99_SOURCE
 \

182 && !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 \

183 && !
defšed
 
	g_XOPEN_SOURCE
 \

184 && !
defšed
 
	g_BSD_SOURCE
 && !defšed 
	g_SVID_SOURCE
))

185 #undeà
_DEFAULT_SOURCE


186 
	#_DEFAULT_SOURCE
 1

	)

187 #undeà
_BSD_SOURCE


188 
	#_BSD_SOURCE
 1

	)

189 #undeà
_SVID_SOURCE


190 
	#_SVID_SOURCE
 1

	)

194 #ià(
defšed
 
_ISOC11_SOURCE
 \

195 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

196 
	#__USE_ISOC11
 1

	)

200 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

201 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

202 
	#__USE_ISOC99
 1

	)

206 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

207 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

208 
	#__USE_ISOC95
 1

	)

215 #ià((
defšed
 
__ılu¥lus
 && __cplusplus >= 201103L) \

216 || 
defšed
 
__GXX_EXPERIMENTAL_CXX0X__
)

217 
	#__USE_ISOCXX11
 1

	)

223 #ifdeà
_DEFAULT_SOURCE


224 #ià!
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE


225 
	#__USE_POSIX_IMPLICITLY
 1

	)

227 #undeà
_POSIX_SOURCE


228 
	#_POSIX_SOURCE
 1

	)

229 #undeà
_POSIX_C_SOURCE


230 
	#_POSIX_C_SOURCE
 200809L

	)

232 #ià((!
defšed
 
__STRICT_ANSI__
 || (
_XOPEN_SOURCE
 - 0) >= 500) && \

233 !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

234 
	#_POSIX_SOURCE
 1

	)

235 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

236 
	#_POSIX_C_SOURCE
 2

	)

237 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

238 
	#_POSIX_C_SOURCE
 199506L

	)

239 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

240 
	#_POSIX_C_SOURCE
 200112L

	)

242 
	#_POSIX_C_SOURCE
 200809L

	)

244 
	#__USE_POSIX_IMPLICITLY
 1

	)

247 #ià
defšed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >ğ1 || defšed 
_XOPEN_SOURCE


248 
	#__USE_POSIX
 1

	)

251 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


252 
	#__USE_POSIX2
 1

	)

255 #ià(
_POSIX_C_SOURCE
 - 0) >= 199309L

256 
	#__USE_POSIX199309
 1

	)

259 #ià(
_POSIX_C_SOURCE
 - 0) >= 199506L

260 
	#__USE_POSIX199506
 1

	)

263 #ià(
_POSIX_C_SOURCE
 - 0) >= 200112L

264 
	#__USE_XOPEN2K
 1

	)

265 #undeà
__USE_ISOC95


266 
	#__USE_ISOC95
 1

	)

267 #undeà
__USE_ISOC99


268 
	#__USE_ISOC99
 1

	)

271 #ià(
_POSIX_C_SOURCE
 - 0) >= 200809L

272 
	#__USE_XOPEN2K8
 1

	)

273 #undeà
_ATFILE_SOURCE


274 
	#_ATFILE_SOURCE
 1

	)

277 #ifdef 
_XOPEN_SOURCE


278 
	#__USE_XOPEN
 1

	)

279 #ià(
_XOPEN_SOURCE
 - 0) >= 500

280 
	#__USE_XOPEN_EXTENDED
 1

	)

281 
	#__USE_UNIX98
 1

	)

282 #undeà
_LARGEFILE_SOURCE


283 
	#_LARGEFILE_SOURCE
 1

	)

284 #ià(
_XOPEN_SOURCE
 - 0) >= 600

285 #ià(
_XOPEN_SOURCE
 - 0) >= 700

286 
	#__USE_XOPEN2K8
 1

	)

287 
	#__USE_XOPEN2K8XSI
 1

	)

289 
	#__USE_XOPEN2K
 1

	)

290 
	#__USE_XOPEN2KXSI
 1

	)

291 #undeà
__USE_ISOC95


292 
	#__USE_ISOC95
 1

	)

293 #undeà
__USE_ISOC99


294 
	#__USE_ISOC99
 1

	)

297 #ifdeà
_XOPEN_SOURCE_EXTENDED


298 
	#__USE_XOPEN_EXTENDED
 1

	)

303 #ifdeà
_LARGEFILE_SOURCE


304 
	#__USE_LARGEFILE
 1

	)

307 #ifdeà
_LARGEFILE64_SOURCE


308 
	#__USE_LARGEFILE64
 1

	)

311 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

312 
	#__USE_FILE_OFFSET64
 1

	)

315 #ià
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE


316 
	#__USE_MISC
 1

	)

319 #ifdef 
_BSD_SOURCE


320 
	#__USE_BSD
 1

	)

323 #ifdef 
_SVID_SOURCE


324 
	#__USE_SVID
 1

	)

327 #ifdef 
_ATFILE_SOURCE


328 
	#__USE_ATFILE
 1

	)

331 #ifdef 
_GNU_SOURCE


332 
	#__USE_GNU
 1

	)

335 #ià
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE


336 
	#__USE_REENTRANT
 1

	)

339 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

340 && 
__GNUC_PREREQ
 (4, 1è&& 
defšed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

341 #ià
_FORTIFY_SOURCE
 > 1

342 
	#__USE_FORTIFY_LEVEL
 2

	)

344 
	#__USE_FORTIFY_LEVEL
 1

	)

347 
	#__USE_FORTIFY_LEVEL
 0

	)

352 
	~<¡dc-´edef.h
>

360 #undeà
__GNU_LIBRARY__


361 
	#__GNU_LIBRARY__
 6

	)

365 
	#__GLIBC__
 2

	)

366 
	#__GLIBC_MINOR__
 19

	)

368 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

369 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

372 #iâdeà
__ASSEMBLER__


373 #iâdeà
_SYS_CDEFS_H


374 
	~<sys/cdefs.h
>

379 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


380 
	#__USE_LARGEFILE
 1

	)

381 
	#__USE_LARGEFILE64
 1

	)

387 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

388 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__
 \

389 && 
defšed
 
	g__ex‹º_šlše


390 
	#__USE_EXTERN_INLINES
 1

	)

398 
	~<gnu/¡ubs.h
>

	@/usr/include/libio.h

28 #iâdeà
_IO_STDIO_H


29 
	#_IO_STDIO_H


	)

31 
	~<_G_cÚfig.h
>

33 
	#_IO_åos_t
 
_G_åos_t


	)

34 
	#_IO_åos64_t
 
_G_åos64_t


	)

35 
	#_IO_size_t
 
size_t


	)

36 
	#_IO_ssize_t
 
__ssize_t


	)

37 
	#_IO_off_t
 
__off_t


	)

38 
	#_IO_off64_t
 
__off64_t


	)

39 
	#_IO_pid_t
 
__pid_t


	)

40 
	#_IO_uid_t
 
__uid_t


	)

41 
	#_IO_icÚv_t
 
_G_icÚv_t


	)

42 
	#_IO_HAVE_ST_BLKSIZE
 
_G_HAVE_ST_BLKSIZE


	)

43 
	#_IO_BUFSIZ
 
_G_BUFSIZ


	)

44 
	#_IO_va_li¡
 
_G_va_li¡


	)

45 
	#_IO_wšt_t
 
wšt_t


	)

48 
	#__Ãed___va_li¡


	)

49 
	~<¡d¬g.h
>

50 #ifdeà
__GNUC_VA_LIST


51 #undeà
_IO_va_li¡


52 
	#_IO_va_li¡
 
__gnuc_va_li¡


	)

55 #iâdeà
__P


56 
	~<sys/cdefs.h
>

59 
	#_IO_UNIFIED_JUMPTABLES
 1

	)

61 #iâdeà
EOF


62 
	#EOF
 (-1)

	)

64 #iâdeà
NULL


65 #ià
defšed
 
__GNUG__
 && \

66 (
	g__GNUC__
 > 2 || (__GNUC__ =ğ2 && 
__GNUC_MINOR__
 >= 8))

67 
	#NULL
 (
__nuÎ
)

	)

69 #ià!
defšed
(
__ılu¥lus
)

70 
	#NULL
 ((*)0)

	)

72 
	#NULL
 (0)

	)

77 
	#_IOS_INPUT
 1

	)

78 
	#_IOS_OUTPUT
 2

	)

79 
	#_IOS_ATEND
 4

	)

80 
	#_IOS_APPEND
 8

	)

81 
	#_IOS_TRUNC
 16

	)

82 
	#_IOS_NOCREATE
 32

	)

83 
	#_IOS_NOREPLACE
 64

	)

84 
	#_IOS_BIN
 128

	)

92 
	#_IO_MAGIC
 0xFBAD0000

	)

93 
	#_OLD_STDIO_MAGIC
 0xFABC0000

	)

94 
	#_IO_MAGIC_MASK
 0xFFFF0000

	)

95 
	#_IO_USER_BUF
 1

	)

96 
	#_IO_UNBUFFERED
 2

	)

97 
	#_IO_NO_READS
 4

	)

98 
	#_IO_NO_WRITES
 8

	)

99 
	#_IO_EOF_SEEN
 0x10

	)

100 
	#_IO_ERR_SEEN
 0x20

	)

101 
	#_IO_DELETE_DONT_CLOSE
 0x40

	)

102 
	#_IO_LINKED
 0x80

	)

103 
	#_IO_IN_BACKUP
 0x100

	)

104 
	#_IO_LINE_BUF
 0x200

	)

105 
	#_IO_TIED_PUT_GET
 0x400

	)

106 
	#_IO_CURRENTLY_PUTTING
 0x800

	)

107 
	#_IO_IS_APPENDING
 0x1000

	)

108 
	#_IO_IS_FILEBUF
 0x2000

	)

109 
	#_IO_BAD_SEEN
 0x4000

	)

110 
	#_IO_USER_LOCK
 0x8000

	)

112 
	#_IO_FLAGS2_MMAP
 1

	)

113 
	#_IO_FLAGS2_NOTCANCEL
 2

	)

114 #ifdeà
_LIBC


115 
	#_IO_FLAGS2_FORTIFY
 4

	)

117 
	#_IO_FLAGS2_USER_WBUF
 8

	)

118 #ifdeà
_LIBC


119 
	#_IO_FLAGS2_SCANF_STD
 16

	)

120 
	#_IO_FLAGS2_NOCLOSE
 32

	)

121 
	#_IO_FLAGS2_CLOEXEC
 64

	)

125 
	#_IO_SKIPWS
 01

	)

126 
	#_IO_LEFT
 02

	)

127 
	#_IO_RIGHT
 04

	)

128 
	#_IO_INTERNAL
 010

	)

129 
	#_IO_DEC
 020

	)

130 
	#_IO_OCT
 040

	)

131 
	#_IO_HEX
 0100

	)

132 
	#_IO_SHOWBASE
 0200

	)

133 
	#_IO_SHOWPOINT
 0400

	)

134 
	#_IO_UPPERCASE
 01000

	)

135 
	#_IO_SHOWPOS
 02000

	)

136 
	#_IO_SCIENTIFIC
 04000

	)

137 
	#_IO_FIXED
 010000

	)

138 
	#_IO_UNITBUF
 020000

	)

139 
	#_IO_STDIO
 040000

	)

140 
	#_IO_DONT_CLOSE
 0100000

	)

141 
	#_IO_BOOLALPHA
 0200000

	)

144 
_IO_jump_t
; 
	g_IO_FILE
;

147 #ifdeà
_IO_MTSAFE_IO


148 #ià
defšed
 
__GLIBC__
 && __GLIBC__ >= 2

149 
	~<b™s/¡dio-lock.h
>

154 
	t_IO_lock_t
;

160 
	s_IO_m¬k”
 {

161 
_IO_m¬k”
 *
	m_Ãxt
;

162 
_IO_FILE
 *
	m_sbuf
;

166 
	m_pos
;

168 
£t_¡»ampos
(
¡»ampos
 
¥
è{ 
	m_¥os
 = sp; }

169 
£t_off£t
(
off£t
è{ 
	m_pos
 = off£t; 
	m_¥os
 = (
¡»ampos
)(-2); }

170 
	mpublic
:

171 
¡»amm¬k”
(
¡»ambuf
 *
sb
);

172 ~
¡»amm¬k”
();

173 
§všg
(è{  
	m_¥os
 == -2; }

174 
d–
(
¡»amm¬k”
&);

175 
d–
();

180 
	e__codecvt_»suÉ


182 
	m__codecvt_ok
,

183 
	m__codecvt_·¹Ÿl
,

184 
	m__codecvt_”rÜ
,

185 
	m__codecvt_nocÚv


188 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


191 
	s_IO_codecvt


193 (*
	m__codecvt_de¡r
è(
	m_IO_codecvt
 *);

194 
__codecvt_»suÉ
 (*
__codecvt_do_out
è(
	m_IO_codecvt
 *,

195 
	m__mb¡©e_t
 *,

196 cÚ¡ 
	mwch¬_t
 *,

197 cÚ¡ 
	mwch¬_t
 *,

198 cÚ¡ 
	mwch¬_t
 **, *,

200 
__codecvt_»suÉ
 (*
__codecvt_do_unshiá
è(
	m_IO_codecvt
 *,

201 
	m__mb¡©e_t
 *, *,

203 
__codecvt_»suÉ
 (*
__codecvt_do_š
è(
	m_IO_codecvt
 *,

204 
	m__mb¡©e_t
 *,

206 cÚ¡ **, 
	mwch¬_t
 *,

207 
	mwch¬_t
 *, wchar_t **);

208 (*
	m__codecvt_do_’codšg
è(
	m_IO_codecvt
 *);

209 (*
	m__codecvt_do_®ways_nocÚv
è(
	m_IO_codecvt
 *);

210 (*
	m__codecvt_do_Ëngth
è(
	m_IO_codecvt
 *, 
	m__mb¡©e_t
 *,

211 cÚ¡ *, cÚ¡ *, 
	m_IO_size_t
);

212 (*
	m__codecvt_do_max_Ëngth
è(
	m_IO_codecvt
 *);

214 
_IO_icÚv_t
 
	m__cd_š
;

215 
_IO_icÚv_t
 
	m__cd_out
;

219 
	s_IO_wide_d©a


221 
wch¬_t
 *
	m_IO_»ad_±r
;

222 
wch¬_t
 *
	m_IO_»ad_’d
;

223 
wch¬_t
 *
	m_IO_»ad_ba£
;

224 
wch¬_t
 *
	m_IO_wr™e_ba£
;

225 
wch¬_t
 *
	m_IO_wr™e_±r
;

226 
wch¬_t
 *
	m_IO_wr™e_’d
;

227 
wch¬_t
 *
	m_IO_buf_ba£
;

228 
wch¬_t
 *
	m_IO_buf_’d
;

230 
wch¬_t
 *
	m_IO_§ve_ba£
;

231 
wch¬_t
 *
	m_IO_backup_ba£
;

233 
wch¬_t
 *
	m_IO_§ve_’d
;

235 
__mb¡©e_t
 
	m_IO_¡©e
;

236 
__mb¡©e_t
 
	m_IO_Ï¡_¡©e
;

237 
_IO_codecvt
 
	m_codecvt
;

239 
wch¬_t
 
	m_shÜtbuf
[1];

241 cÚ¡ 
_IO_jump_t
 *
	m_wide_vbË
;

245 
	s_IO_FILE
 {

246 
	m_æags
;

247 
	#_IO_fe_æags
 
_æags


	)

251 * 
	m_IO_»ad_±r
;

252 * 
	m_IO_»ad_’d
;

253 * 
	m_IO_»ad_ba£
;

254 * 
	m_IO_wr™e_ba£
;

255 * 
	m_IO_wr™e_±r
;

256 * 
	m_IO_wr™e_’d
;

257 * 
	m_IO_buf_ba£
;

258 * 
	m_IO_buf_’d
;

260 *
	m_IO_§ve_ba£
;

261 *
	m_IO_backup_ba£
;

262 *
	m_IO_§ve_’d
;

264 
_IO_m¬k”
 *
	m_m¬k”s
;

266 
_IO_FILE
 *
	m_chaš
;

268 
	m_f’o
;

270 
	m_blksize
;

272 
	m_æags2
;

274 
_IO_off_t
 
	m_Şd_off£t
;

276 
	#__HAVE_COLUMN


	)

278 
	m_cur_cŞumn
;

279 sigÃd 
	m_vbË_off£t
;

280 
	m_shÜtbuf
[1];

284 
_IO_lock_t
 *
	m_lock
;

285 #ifdeà
_IO_USE_OLD_IO_FILE


288 
	s_IO_FILE_com¶‘e


290 
_IO_FILE
 
	m_fe
;

292 #ià
defšed
 
_G_IO_IO_FILE_VERSION
 && _G_IO_IO_FILE_VERSION == 0x20001

293 
_IO_off64_t
 
	m_off£t
;

294 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


296 
_IO_codecvt
 *
	m_codecvt
;

297 
_IO_wide_d©a
 *
	m_wide_d©a
;

298 
_IO_FILE
 *
	m_ä“»s_li¡
;

299 *
	m_ä“»s_buf
;

300 
size_t
 
	m_ä“»s_size
;

302 *
	m__·d1
;

303 *
	m__·d2
;

304 *
	m__·d3
;

305 *
	m__·d4
;

306 
size_t
 
	m__·d5
;

308 
	m_mode
;

310 
	m_unu£d2
[15 *  (è- 4 *  (*è-  (
size_t
)];

314 #iâdeà
__ılu¥lus


315 
_IO_FILE
 
	t_IO_FILE
;

318 
	g_IO_FILE_¶us
;

320 
_IO_FILE_¶us
 
_IO_2_1_¡dš_
;

321 
_IO_FILE_¶us
 
_IO_2_1_¡dout_
;

322 
_IO_FILE_¶us
 
_IO_2_1_¡d”r_
;

323 #iâdeà
_LIBC


324 
	#_IO_¡dš
 ((
_IO_FILE
*)(&
_IO_2_1_¡dš_
))

	)

325 
	#_IO_¡dout
 ((
_IO_FILE
*)(&
_IO_2_1_¡dout_
))

	)

326 
	#_IO_¡d”r
 ((
_IO_FILE
*)(&
_IO_2_1_¡d”r_
))

	)

328 
_IO_FILE
 *
_IO_¡dš
 
©Œibu‹_hidd’
;

329 
_IO_FILE
 *
_IO_¡dout
 
©Œibu‹_hidd’
;

330 
_IO_FILE
 *
_IO_¡d”r
 
©Œibu‹_hidd’
;

338 
__ssize_t
 
	t__io_»ad_â
 (*
	t__cook›
, *
	t__buf
, 
	tsize_t
 
	t__nby‹s
);

346 
__ssize_t
 
	t__io_wr™e_â
 (*
	t__cook›
, cÚ¡ *
	t__buf
,

347 
	tsize_t
 
	t__n
);

355 
	t__io_£ek_â
 (*
	t__cook›
, 
	t_IO_off64_t
 *
	t__pos
, 
	t__w
);

358 
	t__io_şo£_â
 (*
	t__cook›
);

361 #ifdeà
_GNU_SOURCE


363 
__io_»ad_â
 
	tcook›_»ad_funùiÚ_t
;

364 
__io_wr™e_â
 
	tcook›_wr™e_funùiÚ_t
;

365 
__io_£ek_â
 
	tcook›_£ek_funùiÚ_t
;

366 
__io_şo£_â
 
	tcook›_şo£_funùiÚ_t
;

371 
__io_»ad_â
 *
	m»ad
;

372 
__io_wr™e_â
 *
	mwr™e
;

373 
__io_£ek_â
 *
	m£ek
;

374 
__io_şo£_â
 *
	mşo£
;

375 } 
	t_IO_cook›_io_funùiÚs_t
;

376 
_IO_cook›_io_funùiÚs_t
 
	tcook›_io_funùiÚs_t
;

378 
	g_IO_cook›_fe
;

381 
_IO_cook›_š™
 (
_IO_cook›_fe
 *
__cfe
, 
__»ad_wr™e
,

382 *
__cook›
, 
_IO_cook›_io_funùiÚs_t
 
__âs
);

386 #ifdeà
__ılu¥lus


390 
__und”æow
 (
_IO_FILE
 *);

391 
__uæow
 (
_IO_FILE
 *);

392 
__ov”æow
 (
_IO_FILE
 *, );

393 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


394 
_IO_wšt_t
 
__wund”æow
 (
_IO_FILE
 *);

395 
_IO_wšt_t
 
__wuæow
 (
_IO_FILE
 *);

396 
_IO_wšt_t
 
__wov”æow
 (
_IO_FILE
 *, _IO_wint_t);

399 #ià 
__GNUC__
 >= 3

400 
	#_IO_BE
(
ex´
, 
»s
è
	`__butš_ex³ù
 (Óx´),„es)

	)

402 
	#_IO_BE
(
ex´
, 
»s
èÓx´)

	)

405 
	#_IO_g‘c_uÆocked
(
_å
) \

406 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

407 ? 
	`__uæow
 (
_å
è: *(*è(_å)->
_IO_»ad_±r
++)

	)

408 
	#_IO_³ekc_uÆocked
(
_å
) \

409 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

410 && 
	`__und”æow
 (
_å
è=ğ
EOF
 ? EOF \

411 : *(*è(
_å
)->
_IO_»ad_±r
)

	)

412 
	#_IO_putc_uÆocked
(
_ch
, 
_å
) \

413 (
	`_IO_BE
 ((
_å
)->
_IO_wr™e_±r
 >ğ(_å)->
_IO_wr™e_’d
, 0) \

414 ? 
	`__ov”æow
 (
_å
, (è(
_ch
)) \

415 : (è(*(
_å
)->
_IO_wr™e_±r
++ = (
_ch
)))

	)

417 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


418 
	#_IO_g‘wc_uÆocked
(
_å
) \

419 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
 =ğ
NULL
 \

420 || ((
_å
)->
_wide_d©a
->
_IO_»ad_±r
 \

421 >ğ(
_å
)->
_wide_d©a
->
_IO_»ad_’d
), 0) \

422 ? 
	`__wuæow
 (
_å
è: (
_IO_wšt_t
è*(_å)->
_wide_d©a
->
_IO_»ad_±r
++)

	)

423 
	#_IO_putwc_uÆocked
(
_wch
, 
_å
) \

424 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
 =ğ
NULL
 \

425 || ((
_å
)->
_wide_d©a
->
_IO_wr™e_±r
 \

426 >ğ(
_å
)->
_wide_d©a
->
_IO_wr™e_’d
), 0) \

427 ? 
	`__wov”æow
 (
_å
, 
_wch
) \

428 : (
_IO_wšt_t
è(*(
_å
)->
_wide_d©a
->
_IO_wr™e_±r
++ = (
_wch
)))

	)

431 
	#_IO_ãof_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_EOF_SEEN
è!ğ0)

	)

432 
	#_IO_ã¼Ü_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_ERR_SEEN
è!ğ0)

	)

434 
_IO_g‘c
 (
_IO_FILE
 *
__å
);

435 
_IO_putc
 (
__c
, 
_IO_FILE
 *
__å
);

436 
_IO_ãof
 (
_IO_FILE
 *
__å
è
__THROW
;

437 
_IO_ã¼Ü
 (
_IO_FILE
 *
__å
è
__THROW
;

439 
_IO_³ekc_locked
 (
_IO_FILE
 *
__å
);

442 
	#_IO_PENDING_OUTPUT_COUNT
(
_å
) \

443 ((
_å
)->
_IO_wr™e_±r
 - (_å)->
_IO_wr™e_ba£
)

	)

445 
_IO_æockfe
 (
_IO_FILE
 *è
__THROW
;

446 
_IO_fuÆockfe
 (
_IO_FILE
 *è
__THROW
;

447 
_IO_árylockfe
 (
_IO_FILE
 *è
__THROW
;

449 #ifdeà
_IO_MTSAFE_IO


450 
	#_IO_³ekc
(
_å
è
	`_IO_³ekc_locked
 (_å)

	)

451 
	#_IO_æockfe
(
_å
) \

452 ià(((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0è
	`_IO_æockfe
 (_å)

	)

453 
	#_IO_fuÆockfe
(
_å
) \

454 ià(((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0è
	`_IO_fuÆockfe
 (_å)

	)

456 
	#_IO_³ekc
(
_å
è
	`_IO_³ekc_uÆocked
 (_å)

	)

457 
	#_IO_æockfe
(
_å
è

	)

458 
	#_IO_fuÆockfe
(
_å
è

	)

459 
	#_IO_árylockfe
(
_å
è

	)

460 
	#_IO_ş—nup_»giÚ_¡¬t
(
_fù
, 
_å
è

	)

461 
	#_IO_ş—nup_»giÚ_’d
(
_Do™
è

	)

464 
_IO_vfsÿnf
 (
_IO_FILE
 * 
__»¡riù
, const * __restrict,

465 
_IO_va_li¡
, *
__»¡riù
);

466 
_IO_vårštf
 (
_IO_FILE
 *
__»¡riù
, const *__restrict,

467 
_IO_va_li¡
);

468 
_IO_ssize_t
 
_IO_·dn
 (
_IO_FILE
 *, , _IO_ssize_t);

469 
_IO_size_t
 
_IO_sg‘n
 (
_IO_FILE
 *, *, _IO_size_t);

471 
_IO_off64_t
 
_IO_£ekoff
 (
_IO_FILE
 *, _IO_off64_t, , );

472 
_IO_off64_t
 
_IO_£ekpos
 (
_IO_FILE
 *, _IO_off64_t, );

474 
_IO_ä“_backup_¬—
 (
_IO_FILE
 *è
__THROW
;

476 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


477 
_IO_wšt_t
 
_IO_g‘wc
 (
_IO_FILE
 *
__å
);

478 
_IO_wšt_t
 
_IO_putwc
 (
wch¬_t
 
__wc
, 
_IO_FILE
 *
__å
);

479 
_IO_fwide
 (
_IO_FILE
 *
__å
, 
__mode
è
__THROW
;

480 #ià
__GNUC__
 >= 2

483 #ià
defšed
 
_LIBC
 && defšed 
SHARED


484 
	~<shlib-com·t.h
>

485 #ià
SHLIB_COMPAT
 (
libc
, 
GLIBC_2_0
, 
GLIBC_2_1
)

486 
	#_IO_fwide_maybe_šcom·tibË
 \

487 (
	`__butš_ex³ù
 (&
_IO_¡dš_u£d
 =ğ
NULL
, 0))

	)

488 cÚ¡ 
_IO_¡dš_u£d
;

489 
w—k_ex‹º
 (
_IO_¡dš_u£d
);

492 #iâdeà
_IO_fwide_maybe_šcom·tibË


493 
	#_IO_fwide_maybe_šcom·tibË
 (0)

	)

497 
	#_IO_fwide
(
__å
, 
__mode
) \

498 ({ 
__»suÉ
 = (
__mode
); \

499 ià(
__»suÉ
 < 0 && ! 
_IO_fwide_maybe_šcom·tibË
) \

501 ià((
__å
)->
_mode
 == 0) \

503 (
__å
)->
_mode
 = -1; \

504 
__»suÉ
 = (
__å
)->
_mode
; \

506 ià(
	`__butš_cÚ¡ªt_p
 (
__mode
) && (__mode) == 0) \

507 
__»suÉ
 = 
_IO_fwide_maybe_šcom·tibË
 ? -1 : (
__å
)->
_mode
; \

509 
__»suÉ
 = 
	`_IO_fwide
 (
__å
, __result); \

510 
__»suÉ
; })

	)

513 
_IO_vfwsÿnf
 (
_IO_FILE
 * 
__»¡riù
, cÚ¡ 
wch¬_t
 * __restrict,

514 
_IO_va_li¡
, *
__»¡riù
);

515 
_IO_vfw´štf
 (
_IO_FILE
 *
__»¡riù
, cÚ¡ 
wch¬_t
 *__restrict,

516 
_IO_va_li¡
);

517 
_IO_ssize_t
 
_IO_w·dn
 (
_IO_FILE
 *, 
wšt_t
, _IO_ssize_t);

518 
_IO_ä“_wbackup_¬—
 (
_IO_FILE
 *è
__THROW
;

521 #ifdeà
__LDBL_COMPAT


522 
	~<b™s/libio-ldbl.h
>

525 #ifdeà
__ılu¥lus


	@/usr/include/rpc/netdb.h

36 #iâdeà
_RPC_NETDB_H


37 
	#_RPC_NETDB_H
 1

	)

39 
	~<ã©u»s.h
>

41 
	#__Ãed_size_t


	)

42 
	~<¡ddef.h
>

44 
__BEGIN_DECLS


46 
	s½ûÁ


48 *
	mr_Çme
;

49 **
	mr_®Ÿ£s
;

50 
	mr_numb”
;

53 
	$£ŒpûÁ
 (
__¡ayİ’
è
__THROW
;

54 
	$’d½ûÁ
 (è
__THROW
;

55 
½ûÁ
 *
	$g‘½cbyÇme
 (cÚ¡ *
__Çme
è
__THROW
;

56 
½ûÁ
 *
	$g‘½cbynumb”
 (
__numb”
è
__THROW
;

57 
½ûÁ
 *
	$g‘½ûÁ
 (è
__THROW
;

59 #ifdeà
__USE_MISC


60 
	$g‘½cbyÇme_r
 (cÚ¡ *
__Çme
, 
½ûÁ
 *
__»suÉ_buf
,

61 *
__bufãr
, 
size_t
 
__buæ’
,

62 
½ûÁ
 **
__»suÉ
è
__THROW
;

64 
	$g‘½cbynumb”_r
 (
__numb”
, 
½ûÁ
 *
__»suÉ_buf
,

65 *
__bufãr
, 
size_t
 
__buæ’
,

66 
½ûÁ
 **
__»suÉ
è
__THROW
;

68 
	$g‘½ûÁ_r
 (
½ûÁ
 *
__»suÉ_buf
, *
__bufãr
,

69 
size_t
 
__buæ’
, 
½ûÁ
 **
__»suÉ
è
__THROW
;

72 
__END_DECLS


	@/usr/include/xlocale.h

20 #iâdeà
_XLOCALE_H


21 
	#_XLOCALE_H
 1

	)

27 
	s__loÿË_¡ruù


30 
__loÿË_d©a
 *
	m__loÿËs
[13];

33 cÚ¡ *
	m__ùy³_b
;

34 cÚ¡ *
	m__ùy³_tŞow”
;

35 cÚ¡ *
	m__ùy³_touµ”
;

38 cÚ¡ *
	m__Çmes
[13];

39 } *
	t__loÿË_t
;

42 
__loÿË_t
 
	tloÿË_t
;

	@/usr/include/_G_config.h

4 #iâdeà
_G_cÚfig_h


5 
	#_G_cÚfig_h
 1

	)

9 
	~<b™s/ty³s.h
>

10 
	#__Ãed_size_t


	)

11 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


12 
	#__Ãed_wch¬_t


	)

14 
	#__Ãed_NULL


	)

15 
	~<¡ddef.h
>

16 
	#__Ãed_mb¡©e_t


	)

17 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


18 
	#__Ãed_wšt_t


	)

20 
	~<wch¬.h
>

23 
__off_t
 
	m__pos
;

24 
__mb¡©e_t
 
	m__¡©e
;

25 } 
	t_G_åos_t
;

28 
__off64_t
 
	m__pos
;

29 
__mb¡©e_t
 
	m__¡©e
;

30 } 
	t_G_åos64_t
;

31 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


32 
	~<gcÚv.h
>

35 
__gcÚv_šfo
 
	m__cd
;

38 
__gcÚv_šfo
 
	m__cd
;

39 
__gcÚv_¡•_d©a
 
	m__d©a
;

40 } 
	m__combšed
;

41 } 
	t_G_icÚv_t
;

46 
	#_G_va_li¡
 
__gnuc_va_li¡


	)

48 
	#_G_HAVE_MMAP
 1

	)

49 
	#_G_HAVE_MREMAP
 1

	)

51 
	#_G_IO_IO_FILE_VERSION
 0x20001

	)

54 
	#_G_HAVE_ST_BLKSIZE
 
	`defšed
 (
_STATBUF_ST_BLKSIZE
)

	)

56 
	#_G_BUFSIZ
 8192

	)

	@/usr/include/stdc-predef.h

18 #iâdef 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifdeà
__GCC_IEC_559


37 #ià
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifdeà
__GCC_IEC_559_COMPLEX


45 #ià
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

54 
	#__STDC_ISO_10646__
 201103L

	)

57 
	#__STDC_NO_THREADS__
 1

	)

	@/usr/include/gconv.h

22 #iâdeà
_GCONV_H


23 
	#_GCONV_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	#__Ãed_mb¡©e_t


	)

27 
	#__Ãed_wšt_t


	)

28 
	~<wch¬.h
>

29 
	#__Ãed_size_t


	)

30 
	#__Ãed_wch¬_t


	)

31 
	~<¡ddef.h
>

34 
	#__UNKNOWN_10646_CHAR
 ((
wch¬_t
è0xfffd)

	)

39 
	m__GCONV_OK
 = 0,

40 
	m__GCONV_NOCONV
,

41 
	m__GCONV_NODB
,

42 
	m__GCONV_NOMEM
,

44 
	m__GCONV_EMPTY_INPUT
,

45 
	m__GCONV_FULL_OUTPUT
,

46 
	m__GCONV_ILLEGAL_INPUT
,

47 
	m__GCONV_INCOMPLETE_INPUT
,

49 
	m__GCONV_ILLEGAL_DESCRIPTOR
,

50 
	m__GCONV_INTERNAL_ERROR


57 
	m__GCONV_IS_LAST
 = 0x0001,

58 
	m__GCONV_IGNORE_ERRORS
 = 0x0002,

59 
	m__GCONV_SWAP
 = 0x0004

64 
	g__gcÚv_¡•
;

65 
	g__gcÚv_¡•_d©a
;

66 
	g__gcÚv_lßded_objeù
;

67 
	g__gcÚv_Œªs_d©a
;

71 (*
	t__gcÚv_fù
è(
	t__gcÚv_¡•
 *, 
	t__gcÚv_¡•_d©a
 *,

73 **, 
	tsize_t
 *, , );

76 
	$wšt_t
 (*
	t__gcÚv_btowc_fù
è(
	t__gcÚv_¡•
 *, );

79 (*
	t__gcÚv_š™_fù
è(
	t__gcÚv_¡•
 *);

80 (*
	t__gcÚv_’d_fù
è(
	t__gcÚv_¡•
 *);

84 (*
	t__gcÚv_Œªs_fù
è(
	t__gcÚv_¡•
 *,

85 
	t__gcÚv_¡•_d©a
 *, *,

89 
	tsize_t
 *);

92 (*
	t__gcÚv_Œªs_cÚ‹xt_fù
) (*, const *,

97 (*
	t__gcÚv_Œªs_qu”y_fù
) (const *, const ***,

98 
	tsize_t
 *);

101 (*
	t__gcÚv_Œªs_š™_fù
) (**, const *);

102 (*
	t__gcÚv_Œªs_’d_fù
) (*);

104 
	s__gcÚv_Œªs_d©a


107 
__gcÚv_Œªs_fù
 
__Œªs_fù
;

108 
__gcÚv_Œªs_cÚ‹xt_fù
 
__Œªs_cÚ‹xt_fù
;

109 
__gcÚv_Œªs_’d_fù
 
__Œªs_’d_fù
;

110 *
__d©a
;

111 
__gcÚv_Œªs_d©a
 *
__Ãxt
;

116 
	s__gcÚv_¡•


118 
__gcÚv_lßded_objeù
 *
__shlib_hªdË
;

119 cÚ¡ *
__modÇme
;

121 
__couÁ”
;

123 *
__äom_Çme
;

124 *
__to_Çme
;

126 
__gcÚv_fù
 
__fù
;

127 
__gcÚv_btowc_fù
 
__btowc_fù
;

128 
__gcÚv_š™_fù
 
__š™_fù
;

129 
__gcÚv_’d_fù
 
__’d_fù
;

133 
__mš_Ãeded_äom
;

134 
__max_Ãeded_äom
;

135 
__mš_Ãeded_to
;

136 
__max_Ãeded_to
;

139 
__¡©eful
;

141 *
__d©a
;

146 
	s__gcÚv_¡•_d©a


148 *
__outbuf
;

149 *
__outbuãnd
;

153 
__æags
;

157 
__švoÿtiÚ_couÁ”
;

161 
__š‹º®_u£
;

163 
__mb¡©e_t
 *
__¡©•
;

164 
__mb¡©e_t
 
__¡©e
;

168 
__gcÚv_Œªs_d©a
 *
__Œªs
;

173 
	s__gcÚv_šfo


175 
size_t
 
__n¡•s
;

176 
__gcÚv_¡•
 *
__¡•s
;

177 
__ex‹nsiÚ__
 
__gcÚv_¡•_d©a
 
__d©a
 
__æex¬r
;

178 } *
	t__gcÚv_t
;

	@/usr/include/wchar.h

23 #iâdeà
_WCHAR_H


25 #ià!
defšed
 
__Ãed_mb¡©e_t
 && !defšed 
__Ãed_wšt_t


26 
	#_WCHAR_H
 1

	)

27 
	~<ã©u»s.h
>

30 #ifdeà
_WCHAR_H


32 
	#__Ãed___FILE


	)

33 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


34 
	#__Ãed_FILE


	)

36 
	~<¡dio.h
>

38 
	#__Ãed___va_li¡


	)

39 
	~<¡d¬g.h
>

41 
	~<b™s/wch¬.h
>

44 
	#__Ãed_size_t


	)

45 
	#__Ãed_wch¬_t


	)

46 
	#__Ãed_NULL


	)

48 #ià
defšed
 
_WCHAR_H
 || defšed 
__Ãed_wšt_t
 || !defšed 
__WINT_TYPE__


49 #undeà
__Ãed_wšt_t


50 
	#__Ãed_wšt_t


	)

51 
	~<¡ddef.h
>

55 #iâdeà
_WINT_T


60 
	#_WINT_T


	)

61 
	twšt_t
;

65 #ià
defšed
 
__ılu¥lus
 && defšed 
_GLIBCPP_USE_NAMESPACES
 \

66 && 
defšed
 
__WINT_TYPE__


67 
__BEGIN_NAMESPACE_STD


68 
__WINT_TYPE__
 
	twšt_t
;

69 
	g__END_NAMESPACE_STD


74 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

75 
	#__CORRECT_ISO_CPP_WCHAR_H_PROTO


	)

79 #ià(
defšed
 
_WCHAR_H
 || defšed 
__Ãed_mb¡©e_t
è&& !defšed 
____mb¡©e_t_defšed


80 
	#____mb¡©e_t_defšed
 1

	)

84 
	m__couÁ
;

87 #ifdeà
__WINT_TYPE__


88 
__WINT_TYPE__
 
	m__wch
;

90 
wšt_t
 
	m__wch
;

92 
	m__wchb
[4];

93 } 
	m__v®ue
;

94 } 
	t__mb¡©e_t
;

96 #undeà
__Ãed_mb¡©e_t


101 #ifdeà
_WCHAR_H


103 #iâdeà
__mb¡©e_t_defšed


104 
__BEGIN_NAMESPACE_C99


106 
__mb¡©e_t
 
	tmb¡©e_t
;

107 
	g__END_NAMESPACE_C99


108 
	#__mb¡©e_t_defšed
 1

	)

111 #ifdeà
__USE_GNU


112 
	$__USING_NAMESPACE_C99
(
mb¡©e_t
)

115 #iâdeà
WCHAR_MIN


117 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

118 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

121 #iâdeà
WEOF


122 
	#WEOF
 (0xffffffffu)

	)

127 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_UNIX98


128 
	~<wùy³.h
>

132 
__BEGIN_DECLS


134 
__BEGIN_NAMESPACE_STD


137 
tm
;

138 
__END_NAMESPACE_STD


142 
	$__USING_NAMESPACE_STD
(
tm
)

145 
__BEGIN_NAMESPACE_STD


147 
wch¬_t
 *
	$wcsıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

148 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

150 
wch¬_t
 *
	$wc¢ıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

151 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

152 
__THROW
;

155 
wch¬_t
 *
	$wcsÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

156 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

158 
wch¬_t
 *
	$wc¢ÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

159 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

160 
__THROW
;

163 
	$wcscmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
)

164 
__THROW
 
__©Œibu‹_pu»__
;

166 
	$wc¢cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

167 
__THROW
 
__©Œibu‹_pu»__
;

168 
__END_NAMESPACE_STD


170 #ifdeà
__USE_XOPEN2K8


172 
	$wcsÿ£cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

175 
	$wc¢ÿ£cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

176 
size_t
 
__n
è
__THROW
;

180 
	~<xloÿË.h
>

182 
	$wcsÿ£cmp_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

183 
__loÿË_t
 
__loc
è
__THROW
;

185 
	$wc¢ÿ£cmp_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

186 
size_t
 
__n
, 
__loÿË_t
 
__loc
è
__THROW
;

189 
__BEGIN_NAMESPACE_STD


192 
	$wcscŞl
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

196 
size_t
 
	$wcsxäm
 (
wch¬_t
 *
__»¡riù
 
__s1
,

197 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

198 
__END_NAMESPACE_STD


200 #ifdeà
__USE_XOPEN2K8


206 
	$wcscŞl_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

207 
__loÿË_t
 
__loc
è
__THROW
;

212 
size_t
 
	$wcsxäm_l
 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

213 
size_t
 
__n
, 
__loÿË_t
 
__loc
è
__THROW
;

216 
wch¬_t
 *
	$wcsdup
 (cÚ¡ 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_m®loc__
;

219 
__BEGIN_NAMESPACE_STD


221 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


222 "C++" 
wch¬_t
 *
	$wcschr
 (
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

223 
__THROW
 
	`__asm
 ("wcschr"è
__©Œibu‹_pu»__
;

224 "C++" cÚ¡ 
wch¬_t
 *
	$wcschr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

225 
__THROW
 
	`__asm
 ("wcschr"è
__©Œibu‹_pu»__
;

227 
wch¬_t
 *
	$wcschr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

228 
__THROW
 
__©Œibu‹_pu»__
;

231 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


232 "C++" 
wch¬_t
 *
	$wc¤chr
 (
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

233 
__THROW
 
	`__asm
 ("wc¤chr"è
__©Œibu‹_pu»__
;

234 "C++" cÚ¡ 
wch¬_t
 *
	$wc¤chr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

235 
__THROW
 
	`__asm
 ("wc¤chr"è
__©Œibu‹_pu»__
;

237 
wch¬_t
 *
	$wc¤chr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

238 
__THROW
 
__©Œibu‹_pu»__
;

240 
__END_NAMESPACE_STD


242 #ifdeà
__USE_GNU


245 
wch¬_t
 *
	$wcschºul
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__wc
)

246 
__THROW
 
__©Œibu‹_pu»__
;

249 
__BEGIN_NAMESPACE_STD


252 
size_t
 
	$wcsc¥n
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__»jeù
)

253 
__THROW
 
__©Œibu‹_pu»__
;

256 
size_t
 
	$wcs¥n
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

257 
__THROW
 
__©Œibu‹_pu»__
;

259 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


260 "C++" 
wch¬_t
 *
	$wc¥brk
 (
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

261 
__THROW
 
	`__asm
 ("wc¥brk"è
__©Œibu‹_pu»__
;

262 "C++" cÚ¡ 
wch¬_t
 *
	$wc¥brk
 (cÚ¡ 
wch¬_t
 *
__wcs
,

263 cÚ¡ 
wch¬_t
 *
__acû±
)

264 
__THROW
 
	`__asm
 ("wc¥brk"è
__©Œibu‹_pu»__
;

266 
wch¬_t
 *
	$wc¥brk
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

267 
__THROW
 
__©Œibu‹_pu»__
;

270 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


271 "C++" 
wch¬_t
 *
	$wcs¡r
 (
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

272 
__THROW
 
	`__asm
 ("wcs¡r"è
__©Œibu‹_pu»__
;

273 "C++" cÚ¡ 
wch¬_t
 *
	$wcs¡r
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
,

274 cÚ¡ 
wch¬_t
 *
__ÃedË
)

275 
__THROW
 
	`__asm
 ("wcs¡r"è
__©Œibu‹_pu»__
;

277 
wch¬_t
 *
	$wcs¡r
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

278 
__THROW
 
__©Œibu‹_pu»__
;

282 
wch¬_t
 *
	$wc¡ok
 (
wch¬_t
 *
__»¡riù
 
__s
,

283 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__d–im
,

284 
wch¬_t
 **
__»¡riù
 
__±r
è
__THROW
;

287 
size_t
 
	$wc¦’
 (cÚ¡ 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_pu»__
;

288 
__END_NAMESPACE_STD


290 #ifdeà
__USE_XOPEN


292 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


293 "C++" 
wch¬_t
 *
	$wcswcs
 (
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

294 
__THROW
 
	`__asm
 ("wcswcs"è
__©Œibu‹_pu»__
;

295 "C++" cÚ¡ 
wch¬_t
 *
	$wcswcs
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
,

296 cÚ¡ 
wch¬_t
 *
__ÃedË
)

297 
__THROW
 
	`__asm
 ("wcswcs"è
__©Œibu‹_pu»__
;

299 
wch¬_t
 *
	$wcswcs
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

300 
__THROW
 
__©Œibu‹_pu»__
;

304 #ifdeà
__USE_XOPEN2K8


306 
size_t
 
	$wc¢Ën
 (cÚ¡ 
wch¬_t
 *
__s
, 
size_t
 
__maxËn
)

307 
__THROW
 
__©Œibu‹_pu»__
;

311 
__BEGIN_NAMESPACE_STD


313 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


314 "C++" 
wch¬_t
 *
	$wmemchr
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

315 
__THROW
 
	`__asm
 ("wmemchr"è
__©Œibu‹_pu»__
;

316 "C++" cÚ¡ 
wch¬_t
 *
	$wmemchr
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__c
,

317 
size_t
 
__n
)

318 
__THROW
 
	`__asm
 ("wmemchr"è
__©Œibu‹_pu»__
;

320 
wch¬_t
 *
	$wmemchr
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

321 
__THROW
 
__©Œibu‹_pu»__
;

325 
	$wmemcmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

326 
__THROW
 
__©Œibu‹_pu»__
;

329 
wch¬_t
 *
	$wmemıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

330 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

334 
wch¬_t
 *
	$wmemmove
 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

335 
__THROW
;

338 
wch¬_t
 *
	$wmem£t
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
è
__THROW
;

339 
__END_NAMESPACE_STD


341 #ifdeà
__USE_GNU


344 
wch¬_t
 *
	$wmempıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

345 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
)

346 
__THROW
;

350 
__BEGIN_NAMESPACE_STD


353 
wšt_t
 
	$btowc
 (
__c
è
__THROW
;

357 
	$wùob
 (
wšt_t
 
__c
è
__THROW
;

361 
	$mbsš™
 (cÚ¡ 
mb¡©e_t
 *
__ps
è
__THROW
 
__©Œibu‹_pu»__
;

365 
size_t
 
	$mb¹owc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

366 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

367 
mb¡©e_t
 *
__»¡riù
 
__p
è
__THROW
;

370 
size_t
 
	$wütomb
 (*
__»¡riù
 
__s
, 
wch¬_t
 
__wc
,

371 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

374 
size_t
 
	$__mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

375 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

376 
size_t
 
	$mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

377 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

378 
__END_NAMESPACE_STD


380 #ifdeà
__USE_EXTERN_INLINES


386 
wšt_t
 
	$__btowc_®Ÿs
 (
__c
è
	`__asm
 ("btowc");

387 
__ex‹º_šlše
 
wšt_t


388 
	`__NTH
 (
	$btowc
 (
__c
))

389 {  (
	`__butš_cÚ¡ªt_p
 (
__c
) && __c >= '\0' && __c <= '\x7f'

390 ? (
wšt_t
è
__c
 : 
	`__btowc_®Ÿs
 (__c)); 
	}
}

392 
	$__wùob_®Ÿs
 (
wšt_t
 
__c
è
	`__asm
 ("wctob");

393 
__ex‹º_šlše
 

394 
	`__NTH
 (
	$wùob
 (
wšt_t
 
__wc
))

395 {  (
	`__butš_cÚ¡ªt_p
 (
__wc
è&& __wø>ğ
L
'\0' && __wc <= L'\x7f'

396 ? (è
__wc
 : 
	`__wùob_®Ÿs
 (__wc)); 
	}
}

398 
__ex‹º_šlše
 
size_t


399 
__NTH
 (
	$mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

400 
mb¡©e_t
 *
__»¡riù
 
__ps
))

401 {  (
__ps
 !ğ
NULL


402 ? 
	`mb¹owc
 (
NULL
, 
__s
, 
__n
, 
__ps
è: 
	`__mb¾’
 (__s, __n, NULL)); 
	}
}

405 
__BEGIN_NAMESPACE_STD


408 
size_t
 
	$mb¤towcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

409 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

410 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

414 
size_t
 
	$wc¤tombs
 (*
__»¡riù
 
__d¡
,

415 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

416 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

417 
__END_NAMESPACE_STD


420 #ifdef 
__USE_XOPEN2K8


423 
size_t
 
	$mb¢¹owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

424 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

425 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

429 
size_t
 
	$wc¢¹ombs
 (*
__»¡riù
 
__d¡
,

430 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
,

431 
size_t
 
__nwc
, size_ˆ
__Ën
,

432 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

437 #ifdeà
__USE_XOPEN


439 
	$wcwidth
 (
wch¬_t
 
__c
è
__THROW
;

443 
	$wcswidth
 (cÚ¡ 
wch¬_t
 *
__s
, 
size_t
 
__n
è
__THROW
;

447 
__BEGIN_NAMESPACE_STD


450 
	$wc¡od
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

451 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

452 
__END_NAMESPACE_STD


454 #ifdeà
__USE_ISOC99


455 
__BEGIN_NAMESPACE_C99


457 
	$wc¡of
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

458 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

459 
	$wc¡Şd
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

460 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

461 
__END_NAMESPACE_C99


465 
__BEGIN_NAMESPACE_STD


468 
	$wc¡Ş
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

469 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

473 
	$wc¡oul
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

474 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

475 
__THROW
;

476 
__END_NAMESPACE_STD


478 #ifdeà
__USE_ISOC99


479 
__BEGIN_NAMESPACE_C99


482 
__ex‹nsiÚ__


483 
	$wc¡Şl
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

484 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

485 
__THROW
;

489 
__ex‹nsiÚ__


490 
	$wc¡ouÎ
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

491 
wch¬_t
 **
__»¡riù
 
__’d±r
,

492 
__ba£
è
__THROW
;

493 
__END_NAMESPACE_C99


496 #ifdeà
__USE_GNU


499 
__ex‹nsiÚ__


500 
	$wc¡oq
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

501 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

502 
__THROW
;

506 
__ex‹nsiÚ__


507 
	$wc¡ouq
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

508 
wch¬_t
 **
__»¡riù
 
__’d±r
,

509 
__ba£
è
__THROW
;

512 #ifdeà
__USE_GNU


526 
	~<xloÿË.h
>

530 
	$wc¡Ş_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

531 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
,

532 
__loÿË_t
 
__loc
è
__THROW
;

534 
	$wc¡oul_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

535 
wch¬_t
 **
__»¡riù
 
__’d±r
,

536 
__ba£
, 
__loÿË_t
 
__loc
è
__THROW
;

538 
__ex‹nsiÚ__


539 
	$wc¡Şl_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

540 
wch¬_t
 **
__»¡riù
 
__’d±r
,

541 
__ba£
, 
__loÿË_t
 
__loc
è
__THROW
;

543 
__ex‹nsiÚ__


544 
	$wc¡ouÎ_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

545 
wch¬_t
 **
__»¡riù
 
__’d±r
,

546 
__ba£
, 
__loÿË_t
 
__loc
)

547 
__THROW
;

549 
	$wc¡od_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

550 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

551 
__THROW
;

553 
	$wc¡of_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

554 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

555 
__THROW
;

557 
	$wc¡Şd_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

558 
wch¬_t
 **
__»¡riù
 
__’d±r
,

559 
__loÿË_t
 
__loc
è
__THROW
;

563 #ifdeà
__USE_XOPEN2K8


566 
wch¬_t
 *
	$wııy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

567 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

571 
wch¬_t
 *
	$wınıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

572 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

573 
__THROW
;

580 
__FILE
 *
	$İ’_wmem¡»am
 (
wch¬_t
 **
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
;

583 #ià
defšed
 
__USE_ISOC95
 || defšed 
__USE_UNIX98


584 
__BEGIN_NAMESPACE_STD


587 
	$fwide
 (
__FILE
 *
__å
, 
__mode
è
__THROW
;

594 
	`fw´štf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

595 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

601 
	`w´štf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

604 
	$sw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

605 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

606 
__THROW
 ;

612 
	`vfw´štf
 (
__FILE
 *
__»¡riù
 
__s
,

613 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

614 
__gnuc_va_li¡
 
__¬g
)

620 
	`vw´štf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

621 
__gnuc_va_li¡
 
__¬g
)

625 
	$vsw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

626 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

627 
__gnuc_va_li¡
 
__¬g
)

628 
__THROW
 ;

635 
	`fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

636 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

642 
	`wsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

645 
	$swsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

646 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

647 
__THROW
 ;

649 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

650 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

651 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

652 #ifdeà
__REDIRECT


656 
	`__REDIRECT
 (
fwsÿnf
, (
__FILE
 *
__»¡riù
 
__¡»am
,

657 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

658 
__isoc99_fwsÿnf
)

660 
	`__REDIRECT
 (
wsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

661 
__isoc99_wsÿnf
)

663 
	`__REDIRECT_NTH
 (
swsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

664 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

665 ...), 
__isoc99_swsÿnf
)

668 
	`__isoc99_fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

669 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

670 
	`__isoc99_wsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

671 
	$__isoc99_swsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

672 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

673 
__THROW
;

674 
	#fwsÿnf
 
__isoc99_fwsÿnf


	)

675 
	#wsÿnf
 
__isoc99_wsÿnf


	)

676 
	#swsÿnf
 
__isoc99_swsÿnf


	)

680 
__END_NAMESPACE_STD


683 #ifdeà
__USE_ISOC99


684 
__BEGIN_NAMESPACE_C99


689 
	`vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

690 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

691 
__gnuc_va_li¡
 
__¬g
)

697 
	`vwsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

698 
__gnuc_va_li¡
 
__¬g
)

701 
	$vswsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

702 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

703 
__gnuc_va_li¡
 
__¬g
)

704 
__THROW
 ;

706 #ià!
defšed
 
__USE_GNU
 \

707 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

708 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

709 #ifdeà
__REDIRECT


710 
	`__REDIRECT
 (
vfwsÿnf
, (
__FILE
 *
__»¡riù
 
__s
,

711 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

712 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vfwsÿnf
)

714 
	`__REDIRECT
 (
vwsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

715 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vwsÿnf
)

717 
	`__REDIRECT_NTH
 (
vswsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

718 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

719 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vswsÿnf
)

722 
	`__isoc99_vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

723 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

724 
__gnuc_va_li¡
 
__¬g
);

725 
	`__isoc99_vwsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

726 
__gnuc_va_li¡
 
__¬g
);

727 
	$__isoc99_vswsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

728 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

729 
__gnuc_va_li¡
 
__¬g
è
__THROW
;

730 
	#vfwsÿnf
 
__isoc99_vfwsÿnf


	)

731 
	#vwsÿnf
 
__isoc99_vwsÿnf


	)

732 
	#vswsÿnf
 
__isoc99_vswsÿnf


	)

736 
__END_NAMESPACE_C99


740 
__BEGIN_NAMESPACE_STD


745 
wšt_t
 
	`fg‘wc
 (
__FILE
 *
__¡»am
);

746 
wšt_t
 
	`g‘wc
 (
__FILE
 *
__¡»am
);

752 
wšt_t
 
	`g‘wch¬
 ();

759 
wšt_t
 
	`åutwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

760 
wšt_t
 
	`putwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

766 
wšt_t
 
	`putwch¬
 (
wch¬_t
 
__wc
);

774 
wch¬_t
 *
	`fg‘ws
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

775 
__FILE
 *
__»¡riù
 
__¡»am
);

781 
	`åutws
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ws
,

782 
__FILE
 *
__»¡riù
 
__¡»am
);

789 
wšt_t
 
	`ung‘wc
 (wšt_ˆ
__wc
, 
__FILE
 *
__¡»am
);

790 
__END_NAMESPACE_STD


793 #ifdeà
__USE_GNU


801 
wšt_t
 
	`g‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

802 
wšt_t
 
	`g‘wch¬_uÆocked
 ();

810 
wšt_t
 
	`fg‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

818 
wšt_t
 
	`åutwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

827 
wšt_t
 
	`putwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

828 
wšt_t
 
	`putwch¬_uÆocked
 (
wch¬_t
 
__wc
);

837 
wch¬_t
 *
	`fg‘ws_uÆocked
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

838 
__FILE
 *
__»¡riù
 
__¡»am
);

846 
	`åutws_uÆocked
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ws
,

847 
__FILE
 *
__»¡riù
 
__¡»am
);

851 
__BEGIN_NAMESPACE_C99


855 
size_t
 
	$wcsáime
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

856 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

857 cÚ¡ 
tm
 *
__»¡riù
 
__
è
__THROW
;

858 
__END_NAMESPACE_C99


860 #ifdeà
__USE_GNU


861 
	~<xloÿË.h
>

865 
size_t
 
	$wcsáime_l
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

866 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

867 cÚ¡ 
tm
 *
__»¡riù
 
__
,

868 
__loÿË_t
 
__loc
è
__THROW
;

877 #ià
defšed
 
__USE_UNIX98
 && !defšed 
__USE_GNU


878 
	#__Ãed_iswxxx


	)

879 
	~<wùy³.h
>

883 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


884 
	~<b™s/wch¬2.h
>

887 #ifdeà
__LDBL_COMPAT


888 
	~<b™s/wch¬-ldbl.h
>

891 
__END_DECLS


899 #undeà
__Ãed_mb¡©e_t


900 #undeà
__Ãed_wšt_t


	@/usr/include/wctype.h

23 #iâdeà
_WCTYPE_H


25 
	~<ã©u»s.h
>

26 
	~<b™s/ty³s.h
>

28 #iâdeà
__Ãed_iswxxx


29 
	#_WCTYPE_H
 1

	)

32 
	#__Ãed_wšt_t


	)

33 
	~<wch¬.h
>

37 #iâdeà
WEOF


38 
	#WEOF
 (0xffffffffu)

	)

41 #undeà
__Ãed_iswxxx


46 #iâdeà
__iswxxx_defšed


47 
	#__iswxxx_defšed
 1

	)

49 
__BEGIN_NAMESPACE_C99


52 
	twùy³_t
;

53 
	g__END_NAMESPACE_C99


55 #iâdeà
_ISwb™


60 
	~<’dŸn.h
>

61 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


62 
	#_ISwb™
(
b™
è(1 << (b™))

	)

64 
	#_ISwb™
(
b™
) \

65 ((
b™
) < 8 ? () ((1UL << (bit)) << 24) \

66 : ((
b™
) < 16 ? () ((1UL << (bit)) << 8) \

67 : ((
b™
) < 24 ? () ((1UL << (bit)) >> 8) \

68 : (è((1UL << (
b™
)è>> 24))))

	)

73 
	m__ISwuµ”
 = 0,

74 
	m__ISwlow”
 = 1,

75 
	m__ISw®pha
 = 2,

76 
	m__ISwdig™
 = 3,

77 
	m__ISwxdig™
 = 4,

78 
	m__ISw¥aû
 = 5,

79 
	m__ISw´št
 = 6,

80 
	m__ISwg¿ph
 = 7,

81 
	m__ISwbÏnk
 = 8,

82 
	m__ISwúŒl
 = 9,

83 
	m__ISwpunù
 = 10,

84 
	m__ISw®num
 = 11,

86 
	m_ISwuµ”
 = 
_ISwb™
 (
__ISwuµ”
),

87 
	m_ISwlow”
 = 
_ISwb™
 (
__ISwlow”
),

88 
	m_ISw®pha
 = 
_ISwb™
 (
__ISw®pha
),

89 
	m_ISwdig™
 = 
_ISwb™
 (
__ISwdig™
),

90 
	m_ISwxdig™
 = 
_ISwb™
 (
__ISwxdig™
),

91 
	m_ISw¥aû
 = 
_ISwb™
 (
__ISw¥aû
),

92 
	m_ISw´št
 = 
_ISwb™
 (
__ISw´št
),

93 
	m_ISwg¿ph
 = 
_ISwb™
 (
__ISwg¿ph
),

94 
	m_ISwbÏnk
 = 
_ISwb™
 (
__ISwbÏnk
),

95 
	m_ISwúŒl
 = 
_ISwb™
 (
__ISwúŒl
),

96 
	m_ISwpunù
 = 
_ISwb™
 (
__ISwpunù
),

97 
	m_ISw®num
 = 
_ISwb™
 (
__ISw®num
)

102 
__BEGIN_DECLS


104 
__BEGIN_NAMESPACE_C99


111 
	$isw®num
 (
wšt_t
 
__wc
è
__THROW
;

117 
	$isw®pha
 (
wšt_t
 
__wc
è
__THROW
;

120 
	$iswúŒl
 (
wšt_t
 
__wc
è
__THROW
;

124 
	$iswdig™
 (
wšt_t
 
__wc
è
__THROW
;

128 
	$iswg¿ph
 (
wšt_t
 
__wc
è
__THROW
;

133 
	$iswlow”
 (
wšt_t
 
__wc
è
__THROW
;

136 
	$isw´št
 (
wšt_t
 
__wc
è
__THROW
;

141 
	$iswpunù
 (
wšt_t
 
__wc
è
__THROW
;

146 
	$isw¥aû
 (
wšt_t
 
__wc
è
__THROW
;

151 
	$iswuµ”
 (
wšt_t
 
__wc
è
__THROW
;

156 
	$iswxdig™
 (
wšt_t
 
__wc
è
__THROW
;

161 #ifdeà
__USE_ISOC99


162 
	$iswbÏnk
 (
wšt_t
 
__wc
è
__THROW
;

171 
wùy³_t
 
	$wùy³
 (cÚ¡ *
__´İ”ty
è
__THROW
;

175 
	$iswùy³
 (
wšt_t
 
__wc
, 
wùy³_t
 
__desc
è
__THROW
;

176 
__END_NAMESPACE_C99


183 
__BEGIN_NAMESPACE_C99


186 cÚ¡ 
	t__št32_t
 *
	twù¿ns_t
;

187 
__END_NAMESPACE_C99


188 #ifdeà
__USE_GNU


189 
	$__USING_NAMESPACE_C99
(
wù¿ns_t
)

192 
__BEGIN_NAMESPACE_C99


194 
wšt_t
 
	$towlow”
 (
wšt_t
 
__wc
è
__THROW
;

197 
wšt_t
 
	$towuµ”
 (
wšt_t
 
__wc
è
__THROW
;

198 
__END_NAMESPACE_C99


200 
__END_DECLS


207 #ifdeà
_WCTYPE_H


213 
__BEGIN_DECLS


215 
__BEGIN_NAMESPACE_C99


218 
wù¿ns_t
 
	$wù¿ns
 (cÚ¡ *
__´İ”ty
è
__THROW
;

221 
wšt_t
 
	$towù¿ns
 (
wšt_t
 
__wc
, 
wù¿ns_t
 
__desc
è
__THROW
;

222 
__END_NAMESPACE_C99


224 #ifdeà
__USE_XOPEN2K8


226 
	~<xloÿË.h
>

230 
	$isw®num_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

236 
	$isw®pha_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

239 
	$iswúŒl_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

243 
	$iswdig™_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

247 
	$iswg¿ph_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

252 
	$iswlow”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

255 
	$isw´št_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

260 
	$iswpunù_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

265 
	$isw¥aû_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

270 
	$iswuµ”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

275 
	$iswxdig™_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

280 
	$iswbÏnk_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

284 
wùy³_t
 
	$wùy³_l
 (cÚ¡ *
__´İ”ty
, 
__loÿË_t
 
__loÿË
)

285 
__THROW
;

289 
	$iswùy³_l
 (
wšt_t
 
__wc
, 
wùy³_t
 
__desc
, 
__loÿË_t
 
__loÿË
)

290 
__THROW
;

298 
wšt_t
 
	$towlow”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

301 
wšt_t
 
	$towuµ”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

305 
wù¿ns_t
 
	$wù¿ns_l
 (cÚ¡ *
__´İ”ty
, 
__loÿË_t
 
__loÿË
)

306 
__THROW
;

309 
wšt_t
 
	$towù¿ns_l
 (
wšt_t
 
__wc
, 
wù¿ns_t
 
__desc
,

310 
__loÿË_t
 
__loÿË
è
__THROW
;

314 
__END_DECLS


	@
1
.
1
/usr/include
704
24872
debug-shore.cpp
debug_locks.cpp
include/dora.h
include/dora/action.h
include/dora/base_action.h
include/dora/base_partition.h
include/dora/common.h
include/dora/dflusher.h
include/dora/dkey_ranges_map.h
include/dora/dora_env.h
include/dora/dora_error.h
include/dora/key.h
include/dora/lockman.h
include/dora/logical_lock.h
include/dora/part_table.h
include/dora/partition.h
include/dora/range_action.h
include/dora/range_part_table.h
include/dora/range_table_i.h
include/dora/rvp.h
include/dora/tm1/dora_tm1.h
include/dora/tm1/dora_tm1_client.h
include/dora/tm1/dora_tm1_impl.h
include/dora/tpcb/dora_tpcb.h
include/dora/tpcb/dora_tpcb_client.h
include/dora/tpcb/dora_tpcb_impl.h
include/dora/tpcc/dora_delivery.h
include/dora/tpcc/dora_mbench.h
include/dora/tpcc/dora_new_order.h
include/dora/tpcc/dora_order_status.h
include/dora/tpcc/dora_payment.h
include/dora/tpcc/dora_stock_level.h
include/dora/tpcc/dora_tpcc.h
include/dora/tpcc/dora_tpcc_client.h
include/dora/worker.h
include/k_defines.h
include/kits-config.h
include/qpipe.h
include/qpipe/common/int_comparator.h
include/qpipe/common/predicates.h
include/qpipe/common/process_query.h
include/qpipe/common/process_tuple.h
include/qpipe/core.h
include/qpipe/core/cpu_bind.h
include/qpipe/core/dispatcher.h
include/qpipe/core/functors.h
include/qpipe/core/packet.h
include/qpipe/core/query_state.h
include/qpipe/core/stage.h
include/qpipe/core/stage_container.h
include/qpipe/core/tuple.h
include/qpipe/core/tuple_fifo.h
include/qpipe/core/tuple_fifo_directory.h
include/qpipe/qcommon.h
include/qpipe/scheduler.h
include/qpipe/scheduler/cpu.h
include/qpipe/scheduler/cpu_set.h
include/qpipe/scheduler/cpu_set_struct.h
include/qpipe/scheduler/cpu_struct.h
include/qpipe/scheduler/os_support.h
include/qpipe/scheduler/policy.h
include/qpipe/scheduler/policy_os.h
include/qpipe/scheduler/policy_query_cpu.h
include/qpipe/scheduler/policy_rr_cpu.h
include/qpipe/scheduler/policy_rr_module.h
include/qpipe/stages.h
include/qpipe/stages/aggregate.h
include/qpipe/stages/bnl_in.h
include/qpipe/stages/bnl_join.h
include/qpipe/stages/delay_writer.h
include/qpipe/stages/echo.h
include/qpipe/stages/fdump.h
include/qpipe/stages/fscan.h
include/qpipe/stages/func_call.h
include/qpipe/stages/hash_aggregate.h
include/qpipe/stages/hash_join.h
include/qpipe/stages/merge.h
include/qpipe/stages/partial_aggregate.h
include/qpipe/stages/pipe_hash_join.h
include/qpipe/stages/register_stage_containers.h
include/qpipe/stages/sieve.h
include/qpipe/stages/sort.h
include/qpipe/stages/sort_merge_join.h
include/qpipe/stages/sorted_in.h
include/qpipe/stages/tscan.h
include/qpipe/stages/tuple_source.h
include/shore.h
include/sm/shore/common.h
include/sm/shore/shore_asc_sort_buf.h
include/sm/shore/shore_client.h
include/sm/shore/shore_desc_sort_buf.h
include/sm/shore/shore_env.h
include/sm/shore/shore_error.h
include/sm/shore/shore_field.h
include/sm/shore/shore_file_desc.h
include/sm/shore/shore_flusher.h
include/sm/shore/shore_helper_loader.h
include/sm/shore/shore_index.h
include/sm/shore/shore_iter.h
include/sm/shore/shore_msg.h
include/sm/shore/shore_reqs.h
include/sm/shore/shore_row.h
include/sm/shore/shore_row_cache.h
include/sm/shore/shore_shell.h
include/sm/shore/shore_table.h
include/sm/shore/shore_table_man.h
include/sm/shore/shore_tools.h
include/sm/shore/shore_trx_worker.h
include/sm/shore/shore_worker.h
include/sm/shore/srmwqueue.h
include/trace/trace_force.h
include/trace/trace_print_pthread.h
include/trace/trace_stream.h
include/trace/trace_types.h
include/util.h
include/util/acounter.h
include/util/atomic_ops.h
include/util/busy_delay.h
include/util/c_str.h
include/util/cache.h
include/util/chomp.h
include/util/command/command_handler.h
include/util/command/printer.h
include/util/command/tracer.h
include/util/compat.h
include/util/condex.h
include/util/config.h
include/util/confparser.h
include/util/countdown.h
include/util/decimal.h
include/util/envvar.h
include/util/exception.h
include/util/file.h
include/util/fileops.h
include/util/fnv.h
include/util/guard.h
include/util/hash_functions.h
include/util/hashtable.h
include/util/history.h
include/util/linux_procstat.h
include/util/namespace.h
include/util/pool_alloc.h
include/util/prcinfo.h
include/util/procstat.h
include/util/progress.h
include/util/randgen.h
include/util/random_input.h
include/util/resource_declare.h
include/util/resource_pool.h
include/util/resource_releaser.h
include/util/rio.h
include/util/shell.h
include/util/simics-magic-instruction.h
include/util/skewer.h
include/util/static_hash_map.h
include/util/static_hash_map_struct.h
include/util/static_list.h
include/util/static_list_node.h
include/util/static_list_node_struct.h
include/util/static_list_struct.h
include/util/stl_block_alloc.h
include/util/stl_pool.h
include/util/stl_pooled_alloc.h
include/util/stopwatch.h
include/util/store_string.h
include/util/sunos_procstat.h
include/util/sync.h
include/util/tassert.h
include/util/tcp.h
include/util/thread.h
include/util/thread_local.h
include/util/time_util.h
include/util/tmpfile.h
include/util/topinfo.h
include/util/trace.h
include/util/w_strlcpy.h
include/util/zipfian.h
include/workload/ssb/dbgen/bcd2.h
include/workload/ssb/dbgen/config.h
include/workload/ssb/dbgen/dss.h
include/workload/ssb/dbgen/dsstypes.h
include/workload/ssb/dbgen/permute.h
include/workload/ssb/dbgen/rnd.h
include/workload/ssb/dbgen/shared.h
include/workload/ssb/dbgen/tpcd.h
include/workload/ssb/shore_ssb_client.h
include/workload/ssb/shore_ssb_env.h
include/workload/ssb/shore_ssb_schema.h
include/workload/ssb/shore_ssb_schema_man.h
include/workload/ssb/ssb_const.h
include/workload/ssb/ssb_input.h
include/workload/ssb/ssb_random.h
include/workload/ssb/ssb_struct.h
include/workload/ssb/ssb_util.h
include/workload/tm1/shore_tm1_client.h
include/workload/tm1/shore_tm1_env.h
include/workload/tm1/shore_tm1_schema.h
include/workload/tm1/shore_tm1_schema_man.h
include/workload/tm1/tm1_const.h
include/workload/tm1/tm1_input.h
include/workload/tpcb/shore_tpcb_client.h
include/workload/tpcb/shore_tpcb_env.h
include/workload/tpcb/shore_tpcb_schema.h
include/workload/tpcb/shore_tpcb_schema_man.h
include/workload/tpcb/tpcb_input.h
include/workload/tpcc/shore_tpcc_client.h
include/workload/tpcc/shore_tpcc_env.h
include/workload/tpcc/shore_tpcc_schema.h
include/workload/tpcc/shore_tpcc_schema_man.h
include/workload/tpcc/tpcc_const.h
include/workload/tpcc/tpcc_input.h
include/workload/tpcc/tpcc_random.h
include/workload/tpcc/tpcc_struct.h
include/workload/tpce/MEESUT.h
include/workload/tpce/egen/AddressTable.h
include/workload/tpce/egen/BaseLoader.h
include/workload/tpce/egen/BaseLoaderFactory.h
include/workload/tpce/egen/BaseLogFormatter.h
include/workload/tpce/egen/BaseLogger.h
include/workload/tpce/egen/BigMath.h
include/workload/tpce/egen/Brokers.h
include/workload/tpce/egen/CE.h
include/workload/tpce/egen/CESUTInterface.h
include/workload/tpce/egen/CETxnInputGenerator.h
include/workload/tpce/egen/CETxnMixGenerator.h
include/workload/tpce/egen/ChargeTable.h
include/workload/tpce/egen/CommissionRateTable.h
include/workload/tpce/egen/CompanyCompetitorFile.h
include/workload/tpce/egen/CompanyCompetitorTable.h
include/workload/tpce/egen/CompanyFile.h
include/workload/tpce/egen/CompanyTable.h
include/workload/tpce/egen/CustomerAccountsAndPermissionsTable.h
include/workload/tpce/egen/CustomerSelection.h
include/workload/tpce/egen/CustomerTable.h
include/workload/tpce/egen/CustomerTaxratesTable.h
include/workload/tpce/egen/DM.h
include/workload/tpce/egen/DMSUTInterface.h
include/workload/tpce/egen/DailyMarketTable.h
include/workload/tpce/egen/DateTime.h
include/workload/tpce/egen/DriverParamSettings.h
include/workload/tpce/egen/DriverTypes.h
include/workload/tpce/egen/EGenBaseLoader_stdafx.h
include/workload/tpce/egen/EGenError.h
include/workload/tpce/egen/EGenGenerateAndLoad.h
include/workload/tpce/egen/EGenGenerateAndLoadBaseOutput.h
include/workload/tpce/egen/EGenGenerateAndLoadStandardOutput.h
include/workload/tpce/egen/EGenGenerateAndLoad_stdafx.h
include/workload/tpce/egen/EGenLoader_stdafx.h
include/workload/tpce/egen/EGenLogFormatterTab.h
include/workload/tpce/egen/EGenLogger.h
include/workload/tpce/egen/EGenNullLoader_stdafx.h
include/workload/tpce/egen/EGenStandardTypes.h
include/workload/tpce/egen/EGenTables_common.h
include/workload/tpce/egen/EGenTables_stdafx.h
include/workload/tpce/egen/EGenUtilities_stdafx.h
include/workload/tpce/egen/EGenVersion.h
include/workload/tpce/egen/ExchangeTable.h
include/workload/tpce/egen/FinalTransform.h
include/workload/tpce/egen/FinancialTable.h
include/workload/tpce/egen/FixedArray.h
include/workload/tpce/egen/FixedMap.h
include/workload/tpce/egen/FlatAccountPermissionLoad.h
include/workload/tpce/egen/FlatAddressLoad.h
include/workload/tpce/egen/FlatBrokerLoad.h
include/workload/tpce/egen/FlatCashTransactionLoad.h
include/workload/tpce/egen/FlatChargeLoad.h
include/workload/tpce/egen/FlatCommissionRateLoad.h
include/workload/tpce/egen/FlatCompanyCompetitorLoad.h
include/workload/tpce/egen/FlatCompanyLoad.h
include/workload/tpce/egen/FlatCustomerAccountLoad.h
include/workload/tpce/egen/FlatCustomerLoad.h
include/workload/tpce/egen/FlatCustomerTaxrateLoad.h
include/workload/tpce/egen/FlatDailyMarketLoad.h
include/workload/tpce/egen/FlatExchangeLoad.h
include/workload/tpce/egen/FlatFile.h
include/workload/tpce/egen/FlatFileLoad_common.h
include/workload/tpce/egen/FlatFileLoad_stdafx.h
include/workload/tpce/egen/FlatFileLoader.h
include/workload/tpce/egen/FlatFinancialLoad.h
include/workload/tpce/egen/FlatHoldingHistoryLoad.h
include/workload/tpce/egen/FlatHoldingLoad.h
include/workload/tpce/egen/FlatHoldingSummaryLoad.h
include/workload/tpce/egen/FlatIndustryLoad.h
include/workload/tpce/egen/FlatLastTradeLoad.h
include/workload/tpce/egen/FlatLoaderFactory.h
include/workload/tpce/egen/FlatNewsItemLoad.h
include/workload/tpce/egen/FlatNewsXRefLoad.h
include/workload/tpce/egen/FlatSectorLoad.h
include/workload/tpce/egen/FlatSecurityLoad.h
include/workload/tpce/egen/FlatSettlementLoad.h
include/workload/tpce/egen/FlatStatusTypeLoad.h
include/workload/tpce/egen/FlatTaxrateLoad.h
include/workload/tpce/egen/FlatTradeHistoryLoad.h
include/workload/tpce/egen/FlatTradeLoad.h
include/workload/tpce/egen/FlatTradeRequestLoad.h
include/workload/tpce/egen/FlatTradeTypeLoad.h
include/workload/tpce/egen/FlatWatchItemLoad.h
include/workload/tpce/egen/FlatWatchListLoad.h
include/workload/tpce/egen/FlatZipCodeLoad.h
include/workload/tpce/egen/HoldingsAndTradesTable.h
include/workload/tpce/egen/IndustryTable.h
include/workload/tpce/egen/InputFile.h
include/workload/tpce/egen/InputFileNoWeight.h
include/workload/tpce/egen/InputFlatFilesDeclarations.h
include/workload/tpce/egen/InputFlatFilesStructure.h
include/workload/tpce/egen/LastTradeTable.h
include/workload/tpce/egen/MEE.h
include/workload/tpce/egen/MEEPriceBoard.h
include/workload/tpce/egen/MEESUTInterface.h
include/workload/tpce/egen/MEESecurity.h
include/workload/tpce/egen/MEETickerTape.h
include/workload/tpce/egen/MEETradeRequestActions.h
include/workload/tpce/egen/MEETradingFloor.h
include/workload/tpce/egen/MiscConsts.h
include/workload/tpce/egen/Money.h
include/workload/tpce/egen/NewsItemAndXRefTable.h
include/workload/tpce/egen/NullLoad_stdafx.h
include/workload/tpce/egen/NullLoader.h
include/workload/tpce/egen/NullLoaderFactory.h
include/workload/tpce/egen/Person.h
include/workload/tpce/egen/RNGSeeds.h
include/workload/tpce/egen/Random.h
include/workload/tpce/egen/SectorTable.h
include/workload/tpce/egen/SecurityFile.h
include/workload/tpce/egen/SecurityPriceRange.h
include/workload/tpce/egen/SecurityTable.h
include/workload/tpce/egen/StatusTypeTable.h
include/workload/tpce/egen/SyncLockInterface.h
include/workload/tpce/egen/TableConsts.h
include/workload/tpce/egen/TableTemplate.h
include/workload/tpce/egen/Table_Defs.h
include/workload/tpce/egen/TaxrateTable.h
include/workload/tpce/egen/TimerWheel.h
include/workload/tpce/egen/TimerWheelTimer.h
include/workload/tpce/egen/TradeGen.h
include/workload/tpce/egen/TradeTypeIDs.h
include/workload/tpce/egen/TradeTypeTable.h
include/workload/tpce/egen/TxnHarnessBrokerVolume.h
include/workload/tpce/egen/TxnHarnessCustomerPosition.h
include/workload/tpce/egen/TxnHarnessDBInterface.h
include/workload/tpce/egen/TxnHarnessDataMaintenance.h
include/workload/tpce/egen/TxnHarnessMarketFeed.h
include/workload/tpce/egen/TxnHarnessMarketWatch.h
include/workload/tpce/egen/TxnHarnessSecurityDetail.h
include/workload/tpce/egen/TxnHarnessSendToMarketInterface.h
include/workload/tpce/egen/TxnHarnessStructs.h
include/workload/tpce/egen/TxnHarnessTradeCleanup.h
include/workload/tpce/egen/TxnHarnessTradeLookup.h
include/workload/tpce/egen/TxnHarnessTradeOrder.h
include/workload/tpce/egen/TxnHarnessTradeResult.h
include/workload/tpce/egen/TxnHarnessTradeStatus.h
include/workload/tpce/egen/TxnHarnessTradeUpdate.h
include/workload/tpce/egen/WatchListsAndItemsTable.h
include/workload/tpce/egen/Wheel.h
include/workload/tpce/egen/WheelTime.h
include/workload/tpce/egen/ZipCodeTable.h
include/workload/tpce/egen/bucketsimulator.h
include/workload/tpce/egen/error.h
include/workload/tpce/egen/locking.h
include/workload/tpce/egen/progressmeter.h
include/workload/tpce/egen/progressmeterinterface.h
include/workload/tpce/egen/strutil.h
include/workload/tpce/egen/threading.h
include/workload/tpce/egen/threading_pthread.h
include/workload/tpce/egen/threading_single.h
include/workload/tpce/egen/unusedflag.h
include/workload/tpce/shore_tpce_client.h
include/workload/tpce/shore_tpce_egen.h
include/workload/tpce/shore_tpce_env.h
include/workload/tpce/shore_tpce_schema.h
include/workload/tpce/shore_tpce_schema_man.h
include/workload/tpce/tpce_const.h
include/workload/tpce/tpce_input.h
include/workload/tpce/tpce_struct.h
include/workload/tpch/dbgen/bcd2.h
include/workload/tpch/dbgen/config.h
include/workload/tpch/dbgen/dss.h
include/workload/tpch/dbgen/dsstypes.h
include/workload/tpch/dbgen/permute.h
include/workload/tpch/dbgen/release.h
include/workload/tpch/dbgen/rnd.h
include/workload/tpch/dbgen/rng64.h
include/workload/tpch/dbgen/shared.h
include/workload/tpch/dbgen/tpcd.h
include/workload/tpch/shore_tpch_client.h
include/workload/tpch/shore_tpch_env.h
include/workload/tpch/shore_tpch_schema.h
include/workload/tpch/shore_tpch_schema_man.h
include/workload/tpch/tpch_const.h
include/workload/tpch/tpch_input.h
include/workload/tpch/tpch_random.h
include/workload/tpch/tpch_struct.h
include/workload/tpch/tpch_util.h
src/dora/base_action.cpp
src/dora/base_partition.cpp
src/dora/dflusher.cpp
src/dora/dkey_ranges_map.cpp
src/dora/dora_env.cpp
src/dora/logical_lock.cpp
src/dora/part_table.cpp
src/dora/partition.cpp
src/dora/range_part_table.cpp
src/dora/rvp.cpp
src/dora/tm1/dora_tm1.cpp
src/dora/tm1/dora_tm1_client.cpp
src/dora/tm1/dora_tm1_impl.cpp
src/dora/tm1/dora_tm1_xct.cpp
src/dora/tpcb/dora_tpcb.cpp
src/dora/tpcb/dora_tpcb_client.cpp
src/dora/tpcb/dora_tpcb_impl.cpp
src/dora/tpcb/dora_tpcb_xct.cpp
src/dora/tpcc/dora_delivery.cpp
src/dora/tpcc/dora_mbench.cpp
src/dora/tpcc/dora_new_order.cpp
src/dora/tpcc/dora_order_status.cpp
src/dora/tpcc/dora_payment.cpp
src/dora/tpcc/dora_stock_level.cpp
src/dora/tpcc/dora_tpcc.cpp
src/dora/tpcc/dora_tpcc_client.cpp
src/dora/tpcc/dora_tpcc_xct.cpp
src/dora/worker.cpp
src/qpipe/common/predicates.cpp
src/qpipe/common/process_query.cpp
src/qpipe/core/dispatcher.cpp
src/qpipe/core/packet.cpp
src/qpipe/core/stage_container.cpp
src/qpipe/core/tuple.cpp
src/qpipe/core/tuple_fifo.cpp
src/qpipe/core/tuple_fifo_directory.cpp
src/qpipe/scheduler/cpu.cpp
src/qpipe/scheduler/cpu_set.cpp
src/qpipe/stages/aggregate.cpp
src/qpipe/stages/bnl_in.cpp
src/qpipe/stages/bnl_join.cpp
src/qpipe/stages/delay_writer.cpp
src/qpipe/stages/echo.cpp
src/qpipe/stages/fdump.cpp
src/qpipe/stages/fscan.cpp
src/qpipe/stages/func_call.cpp
src/qpipe/stages/hash_aggregate.cpp
src/qpipe/stages/hash_join.cpp
src/qpipe/stages/merge.cpp
src/qpipe/stages/partial_aggregate.cpp
src/qpipe/stages/pipe_hash_join.cpp
src/qpipe/stages/register_stage_containers.cpp
src/qpipe/stages/sieve.cpp
src/qpipe/stages/sort.cpp
src/qpipe/stages/sort_merge_join.cpp
src/qpipe/stages/sorted_in.cpp
src/qpipe/stages/tscan.cpp
src/sm/shore/shore_asc_sort_buf.cpp
src/sm/shore/shore_client.cpp
src/sm/shore/shore_desc_sort_buf.cpp
src/sm/shore/shore_env.cpp
src/sm/shore/shore_field.cpp
src/sm/shore/shore_file_desc.cpp
src/sm/shore/shore_flusher.cpp
src/sm/shore/shore_helper_loader.cpp
src/sm/shore/shore_index.cpp
src/sm/shore/shore_iter.cpp
src/sm/shore/shore_reqs.cpp
src/sm/shore/shore_row.cpp
src/sm/shore/shore_shell.cpp
src/sm/shore/shore_table.cpp
src/sm/shore/shore_trx_worker.cpp
src/sm/shore/shore_worker.cpp
src/tests/shore_kits.cpp
src/trace/trace_force.cpp
src/trace/trace_print_pthread.cpp
src/trace/trace_stream.cpp
src/util/busy_delay.cpp
src/util/c_str.cpp
src/util/chomp.cpp
src/util/command/printer.cpp
src/util/command/tracer.cpp
src/util/confparser.cpp
src/util/countdown.cpp
src/util/envvar.cpp
src/util/fileops.cpp
src/util/fnv.cpp
src/util/hash_functions.cpp
src/util/history.cpp
src/util/linux_procstat.cpp
src/util/pool_alloc.cpp
src/util/prcinfo.cpp
src/util/procstat.cpp
src/util/progress.cpp
src/util/random_input.cpp
src/util/resource_pool.cpp
src/util/rio.cpp
src/util/shell.cpp
src/util/skewer.cpp
src/util/static_hash_map.cpp
src/util/static_list.cpp
src/util/static_list_node.cpp
src/util/stl_pool.cpp
src/util/store_string.cpp
src/util/sunos_procstat.cpp
src/util/tcp.cpp
src/util/thread.cpp
src/util/time_util.cpp
src/util/tmpfile.cpp
src/util/topinfo.cpp
src/util/trace.cpp
src/util/w_strlcpy.cpp
src/workload/ssb/dbgen/driver.cpp
src/workload/ssb/dbgen/ssb_bcd2.cpp
src/workload/ssb/dbgen/ssb_bm_utils.cpp
src/workload/ssb/dbgen/ssb_build.cpp
src/workload/ssb/dbgen/ssb_driver.cpp
src/workload/ssb/dbgen/ssb_load_stub.cpp
src/workload/ssb/dbgen/ssb_permute.cpp
src/workload/ssb/dbgen/ssb_print.cpp
src/workload/ssb/dbgen/ssb_rnd.cpp
src/workload/ssb/dbgen/ssb_speed_seed.cpp
src/workload/ssb/dbgen/ssb_text.cpp
src/workload/ssb/qpipe/qpipe_q1_1.cpp
src/workload/ssb/qpipe/qpipe_q1_2.cpp
src/workload/ssb/qpipe/qpipe_q1_3.cpp
src/workload/ssb/qpipe/qpipe_q2_1.cpp
src/workload/ssb/qpipe/qpipe_q2_2.cpp
src/workload/ssb/qpipe/qpipe_q2_3.cpp
src/workload/ssb/qpipe/qpipe_q3_1.cpp
src/workload/ssb/qpipe/qpipe_q3_2.cpp
src/workload/ssb/qpipe/qpipe_q3_3.cpp
src/workload/ssb/qpipe/qpipe_q3_4.cpp
src/workload/ssb/qpipe/qpipe_q4_1.cpp
src/workload/ssb/qpipe/qpipe_q4_2.cpp
src/workload/ssb/qpipe/qpipe_q4_3.cpp
src/workload/ssb/qpipe/qpipe_qcustomer.cpp
src/workload/ssb/qpipe/qpipe_qdate.cpp
src/workload/ssb/qpipe/qpipe_qlineorder.cpp
src/workload/ssb/qpipe/qpipe_qpart.cpp
src/workload/ssb/qpipe/qpipe_qsupplier.cpp
src/workload/ssb/qpipe/qpipe_qtest.cpp
src/workload/ssb/qpipe_ssb_xct.cpp
src/workload/ssb/shore_ssb_client.cpp
src/workload/ssb/shore_ssb_env.cpp
src/workload/ssb/shore_ssb_schema.cpp
src/workload/ssb/shore_ssb_schema_man.cpp
src/workload/ssb/shore_ssb_xct.cpp
src/workload/ssb/ssb_input.cpp
src/workload/ssb/ssb_random.cpp
src/workload/ssb/ssb_util.cpp
src/workload/tm1/shore_tm1_client.cpp
src/workload/tm1/shore_tm1_env.cpp
src/workload/tm1/shore_tm1_schema.cpp
src/workload/tm1/shore_tm1_schema_man.cpp
src/workload/tm1/shore_tm1_xct.cpp
src/workload/tm1/tm1_input.cpp
src/workload/tpcb/shore_tpcb_client.cpp
src/workload/tpcb/shore_tpcb_env.cpp
src/workload/tpcb/shore_tpcb_schema.cpp
src/workload/tpcb/shore_tpcb_schema_man.cpp
src/workload/tpcb/shore_tpcb_xct.cpp
src/workload/tpcb/tpcb_input.cpp
src/workload/tpcc/shore_tpcc_client.cpp
src/workload/tpcc/shore_tpcc_env.cpp
src/workload/tpcc/shore_tpcc_schema.cpp
src/workload/tpcc/shore_tpcc_schema_man.cpp
src/workload/tpcc/shore_tpcc_xct.cpp
src/workload/tpcc/tpcc_input.cpp
src/workload/tpcc/tpcc_random.cpp
src/workload/tpce/egen/AddressTable.cpp
src/workload/tpce/egen/BaseLogger.cpp
src/workload/tpce/egen/CE.cpp
src/workload/tpce/egen/CETxnInputGenerator.cpp
src/workload/tpce/egen/CETxnMixGenerator.cpp
src/workload/tpce/egen/CustomerSelection.cpp
src/workload/tpce/egen/CustomerTable.cpp
src/workload/tpce/egen/DM.cpp
src/workload/tpce/egen/DateTime.cpp
src/workload/tpce/egen/EGenGenerateAndLoad.cpp
src/workload/tpce/egen/EGenLoader.cpp
src/workload/tpce/egen/EGenLogFormatterTab.cpp
src/workload/tpce/egen/EGenValidate.cpp
src/workload/tpce/egen/EGenVersion.cpp
src/workload/tpce/egen/FlatFileLoader.cpp
src/workload/tpce/egen/InputFlatFilesStructure.cpp
src/workload/tpce/egen/MEE.cpp
src/workload/tpce/egen/MEEPriceBoard.cpp
src/workload/tpce/egen/MEESecurity.cpp
src/workload/tpce/egen/MEETickerTape.cpp
src/workload/tpce/egen/MEETradingFloor.cpp
src/workload/tpce/egen/Money.cpp
src/workload/tpce/egen/Person.cpp
src/workload/tpce/egen/Random.cpp
src/workload/tpce/egen/ReadRowFunctions.cpp
src/workload/tpce/egen/ReadRowFunctions_istream.cpp
src/workload/tpce/egen/ReadRowFunctions_sscanf.cpp
src/workload/tpce/egen/TradeGen.cpp
src/workload/tpce/egen/WheelTime.cpp
src/workload/tpce/egen/bucketsimulator.cpp
src/workload/tpce/egen/error.cpp
src/workload/tpce/egen/locking.cpp
src/workload/tpce/egen/progressmeter.cpp
src/workload/tpce/egen/progressmeterinterface.cpp
src/workload/tpce/egen/strutil.cpp
src/workload/tpce/egen/threading.cpp
src/workload/tpce/shore_tpce_client.cpp
src/workload/tpce/shore_tpce_env.cpp
src/workload/tpce/shore_tpce_schema.cpp
src/workload/tpce/shore_tpce_schema_man.cpp
src/workload/tpce/shore_tpce_xct_broker_volume.cpp
src/workload/tpce/shore_tpce_xct_customer_position.cpp
src/workload/tpce/shore_tpce_xct_data_maintenance.cpp
src/workload/tpce/shore_tpce_xct_market_feed.cpp
src/workload/tpce/shore_tpce_xct_market_watch.cpp
src/workload/tpce/shore_tpce_xct_populate.cpp
src/workload/tpce/shore_tpce_xct_security_detail.cpp
src/workload/tpce/shore_tpce_xct_trade_cleanup.cpp
src/workload/tpce/shore_tpce_xct_trade_lookup.cpp
src/workload/tpce/shore_tpce_xct_trade_order.cpp
src/workload/tpce/shore_tpce_xct_trade_result.cpp
src/workload/tpce/shore_tpce_xct_trade_status.cpp
src/workload/tpce/shore_tpce_xct_trade_update.cpp
src/workload/tpce/tpce_input.cpp
src/workload/tpch/dbgen/bcd2.cpp
src/workload/tpch/dbgen/bm_utils.cpp
src/workload/tpch/dbgen/build.cpp
src/workload/tpch/dbgen/driver.cpp
src/workload/tpch/dbgen/load_stub.cpp
src/workload/tpch/dbgen/permute.cpp
src/workload/tpch/dbgen/print.cpp
src/workload/tpch/dbgen/rnd.cpp
src/workload/tpch/dbgen/rng64.cpp
src/workload/tpch/dbgen/speed_seed.cpp
src/workload/tpch/dbgen/text.cpp
src/workload/tpch/qpipe/qpipe_q1.cpp
src/workload/tpch/qpipe/qpipe_q10.cpp
src/workload/tpch/qpipe/qpipe_q11.cpp
src/workload/tpch/qpipe/qpipe_q12.cpp
src/workload/tpch/qpipe/qpipe_q13.cpp
src/workload/tpch/qpipe/qpipe_q14.cpp
src/workload/tpch/qpipe/qpipe_q15.cpp
src/workload/tpch/qpipe/qpipe_q16.cpp
src/workload/tpch/qpipe/qpipe_q17.cpp
src/workload/tpch/qpipe/qpipe_q18.cpp
src/workload/tpch/qpipe/qpipe_q19.cpp
src/workload/tpch/qpipe/qpipe_q2.cpp
src/workload/tpch/qpipe/qpipe_q20.cpp
src/workload/tpch/qpipe/qpipe_q21.cpp
src/workload/tpch/qpipe/qpipe_q22.cpp
src/workload/tpch/qpipe/qpipe_q3.cpp
src/workload/tpch/qpipe/qpipe_q4.cpp
src/workload/tpch/qpipe/qpipe_q5.cpp
src/workload/tpch/qpipe/qpipe_q6.cpp
src/workload/tpch/qpipe/qpipe_q7.cpp
src/workload/tpch/qpipe/qpipe_q8.cpp
src/workload/tpch/qpipe/qpipe_q9.cpp
src/workload/tpch/qpipe/qpipe_tpch_qcustomer.cpp
src/workload/tpch/qpipe/qpipe_tpch_qlineitem.cpp
src/workload/tpch/qpipe/qpipe_tpch_qnation.cpp
src/workload/tpch/qpipe/qpipe_tpch_qorders.cpp
src/workload/tpch/qpipe/qpipe_tpch_qpart.cpp
src/workload/tpch/qpipe/qpipe_tpch_qpartsupp.cpp
src/workload/tpch/qpipe/qpipe_tpch_qregion.cpp
src/workload/tpch/qpipe/qpipe_tpch_qsupplier.cpp
src/workload/tpch/qpipe_tpch_xct.cpp
src/workload/tpch/shore_tpch_client.cpp
src/workload/tpch/shore_tpch_env.cpp
src/workload/tpch/shore_tpch_schema.cpp
src/workload/tpch/shore_tpch_schema_man.cpp
src/workload/tpch/shore_tpch_xct.cpp
src/workload/tpch/tpch_input.cpp
src/workload/tpch/tpch_random.cpp
src/workload/tpch/tpch_util.cpp
/usr/include/assert.h
/usr/include/ctype.h
/usr/include/dirent.h
/usr/include/dlfcn.h
/usr/include/errno.h
/usr/include/error.h
/usr/include/fcntl.h
/usr/include/getopt.h
/usr/include/inttypes.h
/usr/include/limits.h
/usr/include/malloc.h
/usr/include/math.h
/usr/include/netdb.h
/usr/include/netinet/in.h
/usr/include/pthread.h
/usr/include/sched.h
/usr/include/signal.h
/usr/include/stdint.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/strings.h
/usr/include/time.h
/usr/include/ucontext.h
/usr/include/unistd.h
/usr/include/values.h
/usr/include/alloca.h
/usr/include/endian.h
/usr/include/features.h
/usr/include/libio.h
/usr/include/rpc/netdb.h
/usr/include/xlocale.h
/usr/include/_G_config.h
/usr/include/stdc-predef.h
/usr/include/gconv.h
/usr/include/wchar.h
/usr/include/wctype.h
